"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_content-type-fields_edit-content-type-fields_edit-content-type-fields-974b18"],{4099:(O,u,o)=>{o.r(u),o.d(u,{EditContentTypeFieldsComponent:()=>pt});var c=o(316),s=o(4456),y=o(4175),T=o(5060),C=o(7941),M=o(4950),D=o(3840),R=o(7984),b=o(5175),$=o(852),S=o(5797),r=o(1870),_=o(6647),g=o(271),v=o(1873),F=o(9452),E=o(1567),j=o(1903),X=o(1318),L=o(3143),k=o(2938),B=o(7703),U=o(7693),Y=o(3176),J=o(3758),A=o(5959),h=o(1726),G=o(4202),m=o(4007);const P={Boolean:{label:(0,m.D)(h.O.Boolean),description:"Yes/no or true/false values"},Custom:{label:(0,m.D)(h.O.Custom),description:"Use for things like gps-pickers (which writes into multiple fields) or for custom-data which serializes something exotic into the db like an array, a custom json or anything"},DateTime:{label:(0,m.D)(h.O.DateTime),description:"For date, time or combined values"},Empty:{label:(0,m.D)(h.O.Empty),description:"Use to structure your form"},Entity:{label:(0,m.D)(h.O.Entity),description:"One or more other content-items"},Hyperlink:{label:(0,m.D)(h.O.Hyperlink),description:"Hyperlink or reference to a picture / file"},Number:{label:(0,m.D)(h.O.Number),description:"Any kind of number"},String:{label:(0,m.D)(h.O.String),description:"Any kind of text"}};var H=o(5160),t=o(9148),W=o(2159),w=o(3347);const K=["ngForm"],Q=["autoFocusInputField"],Z=a=>({"eav-input-obsolete":a});function q(a,d){1&a&&t.EFF(0," Fields ")}function tt(a,d){1&a&&t.EFF(0," Add Fields ")}function et(a,d){1&a&&t.EFF(0," Edit Field ")}function nt(a,d){if(1&a&&(t.j41(0,"app-field-hint",19),t.EFF(1),t.k0s()),2&a){const e=t.XpG(4);t.Y8G("isError",!0),t.R7$(),t.JRh(e.fieldNameError)}}function it(a,d){if(1&a&&(t.j41(0,"app-field-hint",19),t.EFF(1),t.k0s()),2&a){t.XpG(2);const e=t.sdS(6);t.Y8G("isError",!0),t.R7$(),t.SpI(" ",e.errors.reservedNames," ")}}function ot(a,d){if(1&a&&t.DNE(0,nt,2,2,"app-field-hint",19)(1,it,2,2,"app-field-hint",19),2&a){t.XpG();const e=t.sdS(6);t.vxM(e.errors.pattern?0:-1),t.R7$(),t.vxM(e.errors.reservedNames?1:-1)}}function st(a,d){if(1&a&&(t.j41(0,"mat-option",16)(1,"mat-icon",15),t.EFF(2),t.k0s(),t.j41(3,"span"),t.EFF(4),t.k0s()()),2&a){const e=d.$implicit;t.Y8G("value",e.name),t.R7$(2),t.JRh(e.icon),t.R7$(2),t.JRh(e.label)}}function at(a,d){if(1&a&&(t.j41(0,"mat-icon",17),t.EFF(1),t.k0s()),2&a){const e=t.XpG().$implicit;t.R7$(),t.JRh(e.icon)}}function lt(a,d){if(1&a&&(t.j41(0,"mat-option",18)(1,"div")(2,"span"),t.EFF(3),t.k0s(),t.DNE(4,at,2,1,"mat-icon",17),t.k0s()()),2&a){const e=d.$implicit;t.Y8G("value",e.inputType)("ngClass",t.eq3(4,Z,e.isObsolete)),t.R7$(3),t.JRh(e.label),t.R7$(),t.vxM(e.icon?4:-1)}}function rt(a,d){if(1&a){const e=t.RV6();t.j41(0,"div",7)(1,"div",11)(2,"mat-form-field",12)(3,"mat-label"),t.EFF(4,"Name"),t.k0s(),t.j41(5,"input",13,1),t.mxI("ngModelChange",function(i){const l=t.eBV(e).$implicit;return t.DH7(l.StaticName,i)||(l.StaticName=i),t.Njj(i)}),t.k0s()(),t.DNE(8,ot,2,2),t.k0s(),t.j41(9,"div",11)(10,"mat-form-field",12)(11,"mat-label"),t.EFF(12,"Data Type"),t.k0s(),t.j41(13,"mat-select",14),t.bIt("selectionChange",function(){const i=t.eBV(e).$index,l=t.XpG(2);return l.filterInputTypeOptions(i),l.resetInputType(i),t.Njj(l.calculateHints(i))}),t.mxI("ngModelChange",function(i){const l=t.eBV(e).$implicit;return t.DH7(l.Type,i)||(l.Type=i),t.Njj(i)}),t.j41(14,"mat-select-trigger")(15,"mat-icon",15),t.EFF(16),t.k0s(),t.j41(17,"span"),t.EFF(18),t.k0s()(),t.Z7z(19,st,5,3,"mat-option",16,t.fX1),t.k0s()(),t.j41(21,"app-field-hint"),t.EFF(22),t.k0s()(),t.j41(23,"div",11)(24,"mat-form-field",12)(25,"mat-label"),t.EFF(26,"Input Type"),t.k0s(),t.j41(27,"mat-select",14),t.bIt("selectionChange",function(){const i=t.eBV(e).$index,l=t.XpG(2);return t.Njj(l.calculateHints(i))}),t.mxI("ngModelChange",function(i){const l=t.eBV(e).$implicit;return t.DH7(l.InputType,i)||(l.InputType=i),t.Njj(i)}),t.j41(28,"mat-select-trigger")(29,"span"),t.EFF(30),t.k0s(),t.j41(31,"mat-icon",17),t.EFF(32),t.k0s()(),t.Z7z(33,lt,5,6,"mat-option",18,t.fX1),t.k0s()(),t.j41(35,"app-field-hint"),t.EFF(36),t.k0s()()()}if(2&a){let e,n;const i=d.$implicit,l=d.$index,I=t.sdS(6),p=t.XpG(2);t.R7$(5),t.Y8G("pattern",p.fieldNamePattern)("appReservedNames",p.reservedNames),t.R50("ngModel",i.StaticName),t.Y8G("name","StaticName"+l)("disabled","inputType"===p.editMode),t.R7$(3),t.vxM(I.touched&&I.errors?8:-1),t.R7$(5),t.R50("ngModel",i.Type),t.Y8G("name","Type"+l)("disabled",null!=p.editMode),t.R7$(3),t.JRh(p.findIcon(i.Type)),t.R7$(2),t.JRh(p.findLabel(i.Type)),t.R7$(),t.Dyx(p.dataTypes),t.R7$(3),t.JRh(p.dataTypeHints[l]),t.R7$(5),t.R50("ngModel",i.InputType),t.Y8G("name","InputType"+l)("disabled","name"===p.editMode),t.R7$(3),t.JRh(null==(e=p.getInputTypeOption(i.InputType))?null:e.label),t.R7$(2),t.JRh(null==(n=p.getInputTypeOption(i.InputType))?null:n.icon),t.R7$(),t.Dyx(p.filteredInputTypeOptions[l]),t.R7$(3),t.JRh(p.inputTypeHints[l])}}function dt(a,d){if(1&a){const e=t.RV6();t.j41(0,"form",5,0),t.bIt("ngSubmit",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.save())}),t.j41(2,"div",6),t.Z7z(3,rt,37,18,"div",7,t.fX1),t.k0s(),t.j41(5,"mat-dialog-actions"),t.nrm(6,"div",8),t.j41(7,"button",9),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.dialog.close())}),t.EFF(8,"Cancel"),t.k0s(),t.j41(9,"button",10),t.nI1(10,"async"),t.EFF(11,"Save"),t.k0s()()()}if(2&a){const e=t.sdS(1),n=t.XpG();t.R7$(3),t.Dyx(n.fields),t.R7$(6),t.Y8G("disabled",!e.form.valid||t.bMT(10,1,n.saving$))}}let pt=(()=>{class a extends Y.${#n;#e;#i;#t;constructor(e,n,i){super(),this.dialog=e,this.route=n,this.snackBar=i,this.hostClass="dialog-component",this.fields=[],this.reservedNames={},this.filteredInputTypeOptions=[],this.dataTypeHints=[],this.inputTypeHints=[],this.fieldNamePattern=B.w,this.fieldNameError=B.s,this.findIcon=m.y,this.findLabel=m.D,this.loading$=new S.t(!0),this.saving$=new S.t(!1),this.#i=(0,k.d)(U.g),this.#t=(0,k.d)(A.h),this.dialog.disableClose=!0,this.subscriptions.add(this.dialog.backdropClick().subscribe(l=>{this.form.dirty&&!confirm("You have unsaved changes. Are you sure you want to close this dialog?")||this.dialog.close()}))}ngAfterViewInit(){this.autoFocusInputField&&setTimeout(()=>{this.autoFocusInputField.first.nativeElement.focus()},250)}trackField(e,n){return n.StaticName}ngOnInit(){this.editMode=this.route.snapshot.paramMap.get("editMode");const e=this.route.snapshot.paramMap.get("contentTypeStaticName"),n=this.#i.retrieveContentType(e).pipe((0,r.u)()),i=n.pipe((0,_.n)(N=>this.#t.getFields(N.StaticName))),l=this.#t.typeListRetrieve().pipe((0,g.T)(N=>function z(a){const d=[];for(const e of a)d.push({name:e,label:P[e].label,icon:(0,m.y)(e),description:P[e].description});return d}(N))),I=this.#t.getInputTypesList(),p=this.#t.getReservedNames();(0,v.p)([n,i,l,I,p]).subscribe(([N,x,ct,mt,ut])=>{if(this.#n=N,this.dataTypes=ct,this.#e=mt,this.reservedNames=H.O.mergeReserved(ut,x),null!=this.editMode){const f=this.route.snapshot.paramMap.get("id")?parseInt(this.route.snapshot.paramMap.get("id"),10):null,V=x.find(ft=>ft.Id===f);"name"===this.editMode&&delete this.reservedNames[V.StaticName],this.fields.push(V)}else for(let f=1;f<=8;f++)this.fields.push({Id:0,Type:h.O.String,InputType:G.u.StringDefault,StaticName:"",IsTitle:0===x.length,SortOrder:x.length+f});for(let f=0;f<this.fields.length;f++)this.filterInputTypeOptions(f),this.calculateHints(f);this.loading$.next(!1)})}ngOnDestroy(){this.loading$.complete(),this.saving$.complete(),super.ngOnDestroy()}filterInputTypeOptions(e){this.filteredInputTypeOptions[e]=this.#e.filter(n=>n.dataType===this.fields[e].Type.toLocaleLowerCase())}resetInputType(e){let n=this.fields[e].Type.toLocaleLowerCase()+G.u.DefaultSuffix;this.filteredInputTypeOptions[e].some(l=>l.inputType===n)||(n=this.filteredInputTypeOptions[e][0].inputType),this.fields[e].InputType=n}calculateHints(e){const n=this.dataTypes.find(l=>l.name===this.fields[e].Type),i=this.#e.find(l=>l.inputType===this.fields[e].InputType);this.dataTypeHints[e]=n?.description??"",this.inputTypeHints[e]=i?.isObsolete?`OBSOLETE - ${i.obsoleteMessage}`:i?.description??""}getInputTypeOption(e){return this.#e.find(n=>n.inputType===e)}save(){this.saving$.next(!0),this.snackBar.open("Saving...");const e=()=>{this.saving$.next(!1),this.snackBar.open("Saved",null,{duration:2e3}),this.dialog.close()};if(null!=this.editMode){const n=this.fields[0];"name"===this.editMode?this.#t.rename(n.Id,this.#n.Id,n.StaticName).subscribe(()=>e()):"inputType"===this.editMode&&this.#t.updateInputType(n.Id,n.StaticName,n.InputType).subscribe(()=>e())}else(0,F.of)(...this.fields).pipe((0,E.p)(n=>!!n.StaticName),(0,j.H)(n=>this.#t.add(n,this.#n.Id).pipe((0,X.W)(i=>(0,F.of)(null)))),(0,L.$)()).subscribe(()=>e())}static{this.\u0275fac=function(n){return new(n||a)(t.rXU(C.CP),t.rXU(W.nX),t.rXU(w.UG))}}static{this.\u0275cmp=t.VBU({type:a,selectors:[["app-edit-content-type-fields"]],viewQuery:function(n,i){if(1&n&&(t.GBs(K,5,s.cV),t.GBs(Q,5)),2&n){let l;t.mGM(l=t.lsd())&&(i.form=l.first),t.mGM(l=t.lsd())&&(i.autoFocusInputField=l)}},hostVars:1,hostBindings:function(n,i){2&n&&t.Mr5("className",i.hostClass)},standalone:!0,features:[t.Vt3,t.aNF],decls:8,vars:6,consts:[["ngForm","ngForm"],["staticName","ngModel","autoFocusInputField",""],[1,"eav-dialog","eav-no-scrollbar"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[3,"ngSubmit"],[1,"eav-dialog-content"],[1,"eav-row-container"],[1,"spacer"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","submit","color","accent",3,"disabled"],[1,"eav-edit-input"],["color","accent",1,"eav-mat-form-field"],["matInput","",3,"ngModelChange","pattern","appReservedNames","ngModel","name","disabled"],[3,"selectionChange","ngModelChange","ngModel","name","disabled"],[1,"eav-type-icon"],[3,"value"],[1,"eav-input-icon"],[3,"value","ngClass"],[3,"isError"]],template:function(n,i){1&n&&(t.j41(0,"div",2)(1,"div",3)(2,"div",4),t.DNE(3,q,1,0)(4,tt,1,0)(5,et,1,0),t.k0s()(),t.DNE(6,dt,12,3,"form"),t.nI1(7,"async"),t.k0s()),2&n&&(t.R7$(3),t.vxM(void 0===i.editMode?3:-1),t.R7$(),t.vxM(null===i.editMode?4:-1),t.R7$(),t.vxM(null!=i.editMode?5:-1),t.R7$(),t.vxM(!1===t.bMT(7,4,i.loading$)?6:-1))},dependencies:[s.YN,s.qT,s.me,s.BC,s.cb,s.R_,s.vS,s.cV,M.RG,M.rl,M.nJ,R.fS,R.fg,H.O,b.Ve,b.VO,b.$2,T.wT,D.m_,D.An,T.Sy,c.YU,C.E7,y.Hl,y.$z,c.Jj,$.h,J.F],styles:[".eav-row-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.eav-edit-input[_ngcontent-%COMP%]{padding-bottom:8px;width:30%}.eav-type-icon[_ngcontent-%COMP%]{width:inherit;height:inherit;margin-right:8px;font-size:inherit;vertical-align:top;line-height:inherit}.eav-input-icon[_ngcontent-%COMP%]{width:inherit;height:inherit;margin-left:8px;font-size:inherit;vertical-align:top;line-height:inherit}.eav-input-obsolete[_ngcontent-%COMP%]{-webkit-text-decoration:black line-through;text-decoration:black line-through;color:#696969}"]})}}return a})()},3758:(O,u,o)=>{o.d(u,{F:()=>S});var c=o(316),s=o(9148),y=o(4950);const T=["*"],C=r=>({"hint-box__short":r});function M(r,_){1&r&&s.eu8(0)}function D(r,_){if(1&r&&(s.j41(0,"mat-hint"),s.DNE(1,M,1,0,"ng-container",2),s.k0s()),2&r){s.XpG();const g=s.sdS(4);s.R7$(),s.Y8G("ngTemplateOutlet",g)}}function R(r,_){1&r&&s.eu8(0)}function b(r,_){if(1&r&&(s.j41(0,"mat-error"),s.DNE(1,R,1,0,"ng-container",2),s.k0s()),2&r){s.XpG();const g=s.sdS(4);s.R7$(),s.Y8G("ngTemplateOutlet",g)}}function $(r,_){1&r&&s.SdG(0)}let S=(()=>{class r{constructor(){this.isError=(0,s.hFB)(!1),this.isShort=!0}toggleIsShort(){this.isShort=!this.isShort}static{this.\u0275fac=function(v){return new(v||r)}}static{this.\u0275cmp=s.VBU({type:r,selectors:[["app-field-hint"]],inputs:{isError:[1,"isError"]},standalone:!0,features:[s.aNF],ngContentSelectors:T,decls:5,vars:4,consts:[["content",""],[1,"hint-box",3,"click","ngClass"],[4,"ngTemplateOutlet"]],template:function(v,F){if(1&v){const E=s.RV6();s.NAR(),s.j41(0,"div",1),s.bIt("click",function(){return s.eBV(E),s.Njj(F.toggleIsShort())}),s.DNE(1,D,2,1,"mat-hint")(2,b,2,1,"mat-error"),s.k0s(),s.DNE(3,$,1,0,"ng-template",null,0,s.C5r)}if(2&v){let E;s.Y8G("ngClass",s.eq3(2,C,F.isShort)),s.R7$(),s.vxM(!1===(E=F.isError())?1:!0===E?2:-1)}},dependencies:[y.RG,y.MV,y.TL,c.YU,c.T3],styles:[".hint-box[_ngcontent-%COMP%]{margin-top:4px}.hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{font-size:12px;display:block}.hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]})}}return r})()},1726:(O,u,o)=>{o.d(u,{O:()=>c});const c={Boolean:"Boolean",Custom:"Custom",DateTime:"DateTime",Empty:"Empty",Entity:"Entity",Hyperlink:"Hyperlink",Number:"Number",String:"String"}},4202:(O,u,o)=>{o.d(u,{u:()=>c});const c={BooleanDefault:"boolean-default",BooleanTristate:"boolean-tristate",CustomDefault:"custom-default",CustomGps:"custom-gps",CustomJsonEditor:"custom-json-editor",DateTimeDefault:"datetime-default",DefaultSuffix:"-default",EmptyDefault:"empty-default",EmptyEnd:"empty-end",EmptyMessage:"empty-message",EntityContentBlocks:"entity-content-blocks",EntityDefault:"entity-default",EntityQuery:"entity-query",ExternalWebComponent:"external-web-component",HyperlinkDefault:"hyperlink-default",HyperlinkLibrary:"hyperlink-library",NumberDefault:"number-default",NumberDropdown:"number-dropdown",StringDefault:"string-default",StringDropdown:"string-dropdown",StringDropdownQuery:"string-dropdown-query",StringFontIconPicker:"string-font-icon-picker",StringJson:"string-json",StringTemplatePicker:"string-template-picker",StringUrlPath:"string-url-path",StringWysiwyg:"string-wysiwyg",EntityPicker:"entity-picker",StringPicker:"string-picker",NumberPicker:"number-picker",Unknown:"unknown"}},9923:(O,u,o)=>{o.d(u,{T:()=>y});var c=o(5392),s=o(819);function y(T,C){return(0,s.N)((0,c.S)(T,C,arguments.length>=2,!1,!0))}}}]);
//# sourceMappingURL=https://sources.2sxc.org/18.03.00/dist/ng-edit/projects_eav-ui_src_app_content-type-fields_edit-content-type-fields_edit-content-type-fields-974b18.2addba76f41eedbb.js.map