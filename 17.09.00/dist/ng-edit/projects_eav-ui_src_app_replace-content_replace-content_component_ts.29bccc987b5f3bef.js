"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_replace-content_replace-content_component_ts"],{3924:(G,h,e)=>{e.r(h),e.d(h,{ReplaceContentComponent:()=>U});var d=e(4844),u=e(5876),C=e(604),O=e(4660),v=e(2816),M=e(5396),t=e(4896),_=e(5204),m=e(600),p=e(4648),y=e(8200),r=e(4672),c=e(2328),E=e(244),B=e(6176),f=e(1904),R=e(9400),A=e(2536),D=e(8766),L=e(5056);function x(s,l){if(1&s&&(t.I0R(0,"mat-option",16),t.OEk(1),t.C$Y()),2&s){const n=l.$implicit;t.E7m("value",n),t.yG2(1),t.cNF(n)}}function K(s,l){if(1&s){const n=t.KQA();t.I0R(0,"div",1)(1,"div",2)(2,"div",3),t.OEk(3),t.C$Y()(),t.I0R(4,"div",4),t.wR5(5,"router-outlet"),t.I0R(6,"p"),t.OEk(7),t.C$Y(),t.I0R(8,"div",5)(9,"mat-form-field",6)(10,"mat-label"),t.OEk(11,"Choose item"),t.C$Y(),t.I0R(12,"input",7),t.qCj("ngModelChange",function(o){t.usT(n);const a=t.GaO();return t.CGJ(a.setFilter(o))}),t.C$Y(),t.I0R(13,"mat-autocomplete",8,9),t.qCj("optionSelected",function(o){t.usT(n);const a=t.GaO();return t.CGJ(a.select(o))}),t.I0R(15,"cdk-virtual-scroll-viewport",10),t.yuY(16,x,2,2,"mat-option",11),t.C$Y()()(),t.I0R(17,"button",12),t.qCj("click",function(){t.usT(n);const o=t.GaO();return t.CGJ(o.copySelected())}),t.I0R(18,"mat-icon"),t.OEk(19,"file_copy"),t.C$Y()()()(),t.I0R(20,"mat-dialog-actions",13)(21,"button",14),t.qCj("click",function(){t.usT(n);const o=t.GaO();return t.CGJ(o.closeDialog())}),t.OEk(22,"Cancel"),t.C$Y(),t.I0R(23,"button",15),t.qCj("click",function(){t.usT(n);const o=t.GaO();return t.CGJ(o.save())}),t.OEk(24,"Save"),t.C$Y()()()}if(2&s){const n=t.Gew(14);t.yG2(3),t.cNF(l.isAddMode?"Add Existing Item":"Replace Content Item"),t.yG2(4),t.oRS("",l.isAddMode?"Select a content-item to add to this list.":"By replacing a content-item you can make other content appear in the slot of the original content."," "),t.yG2(5),t.E7m("matAutocomplete",n)("ngModel",l.filterText),t.yG2(1),t.E7m("hideSingleSelectionIndicator",!0),t.yG2(2),t.m4B("height",l.filteredOptions.length<6?48*l.filteredOptions.length:240,"px"),t.yG2(1),t.E7m("cdkVirtualForOf",l.filteredOptions),t.yG2(1),t.E7m("disabled",!l.isMatch),t.yG2(6),t.E7m("disabled",!l.isMatch)}}let U=(()=>{class s extends v.K{constructor(n,i,o,a,I){super(n,i),this.router=n,this.route=i,this.dialogRef=o,this.contentGroupService=a,this.snackBar=I,this.hostClass="dialog-component"}ngOnInit(){this.guid=this.route.snapshot.paramMap.get("guid"),this.part=this.route.snapshot.paramMap.get("part"),this.index=parseInt(this.route.snapshot.paramMap.get("index"),10),this.add=!!this.route.snapshot.queryParamMap.get("add"),this.filterText$=new d.g(""),this.options$=new d.g([]);const n=(0,u.E)([this.filterText$,this.options$]).pipe((0,C.k)(([i,o])=>o.filter(a=>a.label.toLocaleLowerCase().includes(i.toLocaleLowerCase())).map(a=>a.label)));this.viewModel$=(0,u.E)([this.filterText$,n]).pipe((0,C.k)(([i,o])=>({filterText:i,filteredOptions:o,isAddMode:this.add,isMatch:o.includes(i)}))),this.fetchConfig(!1,null),this.subscription.add(this.refreshOnChildClosedShallow().subscribe(()=>{const o=this.router.getCurrentNavigation().extras?.state,a=o?.[Object.keys(o)[0]];this.fetchConfig(!0,a)}))}ngOnDestroy(){this.filterText$.complete(),this.options$.complete(),super.ngOnDestroy()}closeDialog(){this.dialogRef.close()}setFilter(n){this.filterText$.next(n)}select(n){this.filterText$.next(n.option.value)}copySelected(){const n=this.buildContentGroup(),o=(0,M.K)({items:[{ContentTypeName:this.contentTypeName,DuplicateEntity:n.id}]});this.router.navigate([`edit/${o}`],{relativeTo:this.route})}save(){this.snackBar.open("Saving...");const n=this.buildContentGroup();this.contentGroupService.saveItem(n).subscribe(()=>{this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()})}fetchConfig(n,i){const o=this.buildContentGroup();this.contentGroupService.getItems(o).subscribe(a=>{const I=Object.entries(a.Items).map(([g,P])=>({id:parseInt(g,10),label:`${P} (${g})`}));if(this.options$.next(I),!o.add&&!n||null!=i){const g=n?i:a.SelectedId,P=this.options$.value.find(T=>T.id===g)?.label||"";this.filterText$.next(P)}this.contentTypeName=a.ContentTypeName})}buildContentGroup(){return{id:this.options$.value.find(o=>o.label===this.filterText$.value)?.id??null,guid:this.guid,part:this.part,index:this.index,add:this.add}}static#t=this.\u0275fac=function(i){return new(i||s)(t.GI1(_.E5),t.GI1(_.gV),t.GI1(m.yI),t.GI1(O.e),t.GI1(p.yS))};static#e=this.\u0275cmp=t.In1({type:s,selectors:[["app-replace-content"]],hostVars:1,hostBindings:function(i,o){2&i&&t.SoX("className",o.hostClass)},features:[t.eg9],decls:2,vars:3,consts:[["class","eav-dialog"],[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],[1,"eav-options-box"],["color","accent",1,"eav-form-field"],["matInput","",3,"matAutocomplete","ngModel","ngModelChange"],[3,"hideSingleSelectionIndicator","optionSelected"],["auto","matAutocomplete"],["itemSize","48","minBufferPx","500","maxBufferPx","1000"],[3,"value",4,"cdkVirtualFor","cdkVirtualForOf"],["mat-icon-button","","tippy","Copy",3,"disabled","click"],["align","end"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click"],[3,"value"]],template:function(i,o){if(1&i&&(t.yuY(0,K,25,10,"div",0),t.wVc(1,"async")),2&i){let a;t.C0Y(0,(a=t.kDX(1,1,o.viewModel$))?0:-1,a)}},dependencies:[_.cP,y.Y,m.Yp,r.Gw,r.um,c.qL,E.Up,E.w5,B.I5,f.ot,f.ue,f._G,R.e,R.cG,A.yi,D.UF,D.SR,D.G3,L.a],styles:[".eav-options-box[_ngcontent-%COMP%]{display:flex;align-items:flex-end}"]})}return s})()},2816:(G,h,e)=>{e.d(h,{K:()=>m});var d=e(5204),u=e(6560),C=e(1792),O=e(604),v=e(6536),M=e(6884),t=e(2376),_=e(4896);let m=(()=>{class p extends M.C{constructor(r,c,E){super(),this.router=r,this.route=c,this.log=E,this.log??=new t.W("BaseComponent",!1)}ngOnDestroy(){super.ngOnDestroy()}refreshOnChildClosedShallow(){return this.router.events.pipe((0,u.I)(r=>r instanceof d.cf),(0,C.W)(!!this.route.snapshot.firstChild),(0,O.k)(()=>!!this.route.snapshot.firstChild),(0,v.c)(),(0,u.I)(([r,c])=>r&&!c))}static#t=this.\u0275fac=function(c){return new(c||p)(_.GI1(d.E5),_.GI1(d.gV),_.GI1(t.W))};static#e=this.\u0275dir=_.Sc5({type:p,features:[_.eg9]})}return p})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/17.09.00/dist/ng-edit/projects_eav-ui_src_app_replace-content_replace-content_component_ts.29bccc987b5f3bef.js.map