"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_app-administration_sub-dialogs_edit-content-type_edit-content-type_co-2abec4","projects_eav-ui_src_app_shared_directives_click-stop-propagation_directive_ts"],{410:(O,y,o)=>{o.r(y),o.d(y,{EditContentTypeComponent:()=>U});var c=o(4844),v=o(5876),r=o(604),G=o(8916),C=o(420),h=o(9224);const g=/(^[A-Za-z][A-Za-z0-9]*$)|(^@[A-Za-z][A-Za-z0-9\-]*$)/.toString(),k=g.substring(1,g.toString().length-1);var x=o(692),t=o(4896),$=o(600),N=o(5204),Y=o(4648),R=o(9084),b=o(504),M=o(8200),_=o(4672),A=o(2328),p=o(1904),D=o(2536),f=o(244),P=o(7872),B=o(6176),u=o(6016),j=o(5056);function w(i,l){1&i&&(t.I0R(0,"app-field-hint",21),t.OEk(1,"This field is required"),t.C$Y()),2&i&&t.E7m("isError",!0)}function F(i,l){if(1&i&&(t.I0R(0,"app-field-hint",21),t.OEk(1),t.C$Y()),2&i){const e=t.GaO(4);t.E7m("isError",!0),t.yG2(1),t.cNF(e.contentTypeNameError)}}function J(i,l){if(1&i&&t.yuY(0,w,2,1,"app-field-hint",21)(1,F,2,2,"app-field-hint",21),2&i){t.GaO();const e=t.Gew(9);t.C0Y(0,e.errors.required?0:-1),t.yG2(1),t.C0Y(1,e.errors.pattern?1:-1)}}function V(i,l){if(1&i&&(t.I0R(0,"mat-option",13),t.OEk(1),t.C$Y()),2&i){const e=l.$implicit;t.E7m("value",e.value),t.yG2(1),t.oRS(" ",e.name," ")}}function z(i,l){if(1&i&&(t.I0R(0,"div",7)(1,"h3"),t.OEk(2,"Shared Content Type (Ghost)"),t.C$Y(),t.I0R(3,"p"),t.OEk(4,"Note: this can't be edited in the UI, for now if you really know what you're doing, do it in the DB "),t.C$Y(),t.I0R(5,"p"),t.OEk(6),t.C$Y()()),2&i){const e=t.GaO(2);t.yG2(6),t.oRS("Uses Type Definition of: ",e.contentType.SharedDefId,"")}}function H(i,l){if(1&i){const e=t.KQA();t.I0R(0,"form",4,5),t.qCj("ngSubmit",function(){t.usT(e);const n=t.GaO(2);return t.CGJ(n.save())}),t.I0R(2,"div",6)(3,"div")(4,"div",7)(5,"mat-form-field",8)(6,"mat-label"),t.OEk(7,"Name"),t.C$Y(),t.I0R(8,"input",9,10),t.qCj("ngModelChange",function(n){t.usT(e);const s=t.GaO(2);return t.CGJ(s.changeContentTypeName(n))}),t.C$Y()(),t.yuY(10,J,2,2),t.C$Y(),t.I0R(11,"mat-accordion")(12,"mat-expansion-panel")(13,"mat-expansion-panel-header")(14,"mat-panel-title"),t.OEk(15,"Advanced"),t.C$Y(),t.wR5(16,"mat-panel-description"),t.C$Y(),t.I0R(17,"div",7)(18,"div",11)(19,"mat-form-field",8)(20,"mat-label"),t.OEk(21,"Scope"),t.C$Y(),t.I0R(22,"mat-select",12),t.qCj("ngModelChange",function(n){t.usT(e);const s=t.GaO(2);return t.CGJ(s.changeScope(n))}),t.c53(23,V,2,2,"mat-option",13,t.oxv),t.I0R(25,"mat-option",13),t.OEk(26,"Other..."),t.C$Y()()(),t.I0R(27,"button",14),t.qCj("click",function(){t.usT(e);const n=t.GaO(2);return t.CGJ(n.unlockScope())}),t.I0R(28,"mat-icon"),t.OEk(29),t.C$Y()()(),t.I0R(30,"app-field-hint"),t.OEk(31," The scope should almost never be changed - "),t.I0R(32,"a",15),t.OEk(33,"see help"),t.C$Y()()(),t.I0R(34,"div",7)(35,"mat-form-field",8)(36,"mat-label"),t.OEk(37,"Static Name"),t.C$Y(),t.wR5(38,"input",16),t.C$Y()(),t.yuY(39,z,7,1,"div",17),t.C$Y()()()(),t.I0R(40,"mat-dialog-actions",18)(41,"button",19),t.qCj("click",function(){t.usT(e);const n=t.GaO(2);return t.CGJ(n.closeDialog())}),t.OEk(42,"Cancel"),t.C$Y(),t.I0R(43,"button",20),t.OEk(44," Save "),t.C$Y()()()}if(2&i){const e=t.Gew(1),a=t.Gew(9),n=t.GaO(),s=t.GaO();t.yG2(8),t.E7m("pattern",s.contentTypeNamePattern)("ngModel",n.contentType.Name),t.yG2(2),t.C0Y(10,a.touched&&a.errors?10:-1),t.yG2(1),t.E7m("@.disabled",n.disableAnimation),t.yG2(11),t.E7m("ngModel",n.contentType.Scope)("disabled",n.lockScope),t.yG2(1),t.oho(n.scopeOptions),t.yG2(2),t.E7m("value",s.dropdownInsertValue),t.yG2(2),t.E7m("tippy",n.lockScope?"Unlock":"Lock"),t.yG2(2),t.oRS(" ",n.lockScope?"lock":"lock_open"," "),t.yG2(9),t.E7m("ngModel",n.contentType.StaticName),t.yG2(1),t.C0Y(39,n.contentType.SharedDefId?39:-1),t.yG2(4),t.E7m("disabled",!e.form.valid||n.loading)}}function L(i,l){if(1&i&&(t.I0R(0,"div",1)(1,"div",2)(2,"div",3),t.OEk(3),t.C$Y()(),t.yuY(4,H,45,12,"form"),t.C$Y()),2&i){const e=t.GaO();t.yG2(3),t.cNF(e.contentTypeStaticName?"Edit Content Type":"New Content Type"),t.yG2(1),t.C0Y(4,l.contentType?4:-1)}}let U=(()=>{class i{constructor(e,a,n,s){this.dialogRef=e,this.route=a,this.contentTypesService=n,this.snackBar=s,this.hostClass="dialog-component",this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName"),this.contentTypeNamePattern=k,this.contentTypeNameError="Standard letters and numbers are allowed. Must start with a letter.",this.dropdownInsertValue=C.M,this.contentType$=new c.g(null),this.lockScope$=new c.g(!0),this.scopeOptions$=new c.g(null),this.disableAnimation$=new c.g(!0),this.loading$=new c.g(!1),this.viewModel$=(0,v.E)([this.contentType$,this.lockScope$,this.scopeOptions$,this.disableAnimation$,this.loading$]).pipe((0,r.k)(([m,d,T,X,Z])=>({contentType:m,lockScope:d,scopeOptions:T,disableAnimation:X,loading:Z}))),this.scope=this.route.snapshot.parent.paramMap.get("scope")}ngOnInit(){const e=this.contentTypeStaticName?this.contentTypesService.retrieveContentType(this.contentTypeStaticName).pipe((0,r.k)(n=>({...n,ChangeStaticName:!1,NewStaticName:n.StaticName}))):(0,G.of)({StaticName:"",Name:"",Description:"",Scope:this.scope,ChangeStaticName:!1,NewStaticName:""}),a=this.contentTypesService.getScopes();(0,v.E)([e,a]).subscribe(([n,s])=>{this.contentType$.next(n);const m=[...this.scopeOptions$.value??[]];s.forEach(d=>{m.some(T=>T.value===d.value)||m.push(d)}),m.some(d=>d.value===this.scope)||m.push({name:this.scope,value:this.scope}),this.scopeOptions$.next(m)})}ngOnDestroy(){this.contentType$.complete(),this.lockScope$.complete(),this.scopeOptions$.complete(),this.disableAnimation$.complete(),this.loading$.complete()}ngAfterViewInit(){setTimeout(()=>this.disableAnimation$.next(!1))}closeDialog(){this.dialogRef.close()}changeContentTypeName(e){this.contentType$.next({...this.contentType$.value,Name:e})}changeScope(e){e!==C.M||(e=prompt("This is an advanced feature to show content-types of another scope. Don't use this if you don't know what you're doing, as content-types of other scopes are usually hidden for a good reason.")||h._K.scopes.default.value,this.scopeOptions$.value.some(a=>a.value===e))||this.scopeOptions$.next([{name:e,value:e},...this.scopeOptions$.value]),this.contentType$.next({...this.contentType$.value,Scope:e})}unlockScope(){this.lockScope$.next(!this.lockScope$.value),this.lockScope$.value&&this.contentType$.next({...this.contentType$.value,Scope:this.scope})}save(){this.loading$.next(!0),this.snackBar.open("Saving..."),this.contentTypesService.save(this.contentType$.value).subscribe(e=>{this.loading$.next(!1),this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()}),document.activeElement instanceof HTMLElement&&document.activeElement.blur()}static#t=this.\u0275fac=function(a){return new(a||i)(t.GI1($.yI),t.GI1(N.gV),t.GI1(x.X),t.GI1(Y.yS))};static#e=this.\u0275cmp=t.In1({type:i,selectors:[["app-edit-content-type"]],hostVars:1,hostBindings:function(a,n){2&a&&t.SoX("className",n.hostClass)},decls:2,vars:3,consts:[["class","eav-dialog"],[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[3,"ngSubmit"],["ngForm","ngForm"],[1,"eav-dialog-content"],[1,"eav-edit-input"],["color","accent",1,"eav-form-field"],["matInput","","type","text","required","","name","Name",3,"pattern","ngModel","ngModelChange"],["name","ngModel"],[1,"eav-form-and-button"],["name","Scope",3,"ngModel","disabled","ngModelChange"],[3,"value"],["mat-icon-button","","type","button","matTextSuffix","",1,"eav-scope-button",3,"tippy","click"],["href","https://2sxc.org/help?tag=scope","target","_blank","appClickStopPropagation",""],["matInput","","type","text","name","StaticName","disabled","",3,"ngModel"],["class","eav-edit-input"],["align","end"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","submit","color","accent",3,"disabled"],[3,"isError"]],template:function(a,n){if(1&a&&(t.yuY(0,L,5,2,"div",0),t.wVc(1,"async")),2&a){let s;t.C0Y(0,(s=t.kDX(1,1,n.viewModel$))?0:-1,s)}},dependencies:[R.o,b.c,M.Y,$.Yp,_.Gw,_.um,A.qL,p.sz,p.ot,p.ue,p.u,p.eJ,p.E1,p._G,p.SC,D.yi,f.Up,f.w5,f.Gm,P.kX,B.I5,u._2,u._s,u.nm,u.CM,u._A,j.a],styles:[".eav-edit-input[_ngcontent-%COMP%]{padding-bottom:8px}.eav-form-and-button[_ngcontent-%COMP%]{display:flex;align-items:baseline;justify-content:space-between}.eav-form-and-button[_ngcontent-%COMP%]   .eav-scope-button[_ngcontent-%COMP%]{margin-left:8px}"]})}return i})()},504:(O,y,o)=>{o.d(y,{c:()=>v});var c=o(4896);let v=(()=>{class r{onClick(C){C.stopPropagation()}static#t=this.\u0275fac=function(h){return new(h||r)};static#e=this.\u0275dir=c.Sc5({type:r,selectors:[["","appClickStopPropagation",""]],hostBindings:function(h,E){1&h&&c.qCj("click",function(S){return E.onClick(S)})}})}return r})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/17.09.00/dist/ng-edit/projects_eav-ui_src_app_app-administration_sub-dialogs_edit-content-type_edit-content-type_co-2abec4.cd783d797051cf06.js.map