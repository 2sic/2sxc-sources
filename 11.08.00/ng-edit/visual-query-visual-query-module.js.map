{"version":3,"sources":["./src/app/visual-query/query-result/query-result.component.ts","./src/app/visual-query/query-result/query-result.component.html","./src/app/visual-query/services/query-definition.service.ts","./src/app/visual-query/plumb-editor/plumb-editor.helpers.ts","./src/app/visual-query/run-explorer/run-explorer.helpers.ts","./src/app/visual-query/add-explorer/add-explorer.helpers.ts","./src/app/visual-query/visual-query.component.ts","./src/app/visual-query/plumb-editor/plumb-editor.component.html","./src/app/visual-query/run-explorer/run-explorer.component.html","./src/app/visual-query/run-explorer/run-explorer.component.scss","./src/app/visual-query/add-explorer/add-explorer.component.ts","./src/app/visual-query/services/visual-query.service.ts","./src/app/visual-query/visual-query.module.ts","./src/app/visual-query/plumb-editor/plumber.helper.ts","./src/app/visual-query/add-explorer/add-explorer.component.html","./src/app/visual-query/run-explorer/run-explorer.component.ts","./src/app/visual-query/visual-query.component.scss","./src/app/app-administration/services/index.ts","./src/app/visual-query/query-result/query-result.component.scss","./src/app/visual-query/plumb-editor/plumb-editor.component.scss","./src/app/visual-query/add-explorer/add-explorer.component.scss","./src/app/visual-query/visual-query-routing.module.ts","./src/app/visual-query/visual-query.component.html","./src/app/visual-query/plumb-editor/plumb-editor.component.ts"],"names":[],"mappings":"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","file":"visual-query-visual-query-module.js","sourcesContent":["import { ChangeDetectionStrategy, Component, Inject, OnInit } from '@angular/core';\r\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\r\nimport { PipelineResultQuery, PipelineResultSources, PipelineResultStream } from '../models/pipeline-result.model';\r\nimport { QueryResultDialogData } from './query-result.models';\r\n\r\n@Component({\r\n  selector: 'app-query-result',\r\n  templateUrl: './query-result.component.html',\r\n  styleUrls: ['./query-result.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class QueryResultComponent implements OnInit {\r\n  testParameters: string;\r\n  timeUsed: number;\r\n  ticksUsed: number;\r\n  result: PipelineResultQuery;\r\n  sources: PipelineResultSources;\r\n  streams: PipelineResultStream[];\r\n\r\n  constructor(@Inject(MAT_DIALOG_DATA) public dialogData: QueryResultDialogData, private dialogRef: MatDialogRef<QueryResultComponent>) { }\r\n\r\n  ngOnInit() {\r\n    this.testParameters = this.dialogData.testParameters;\r\n    this.timeUsed = this.dialogData.result.QueryTimer.Milliseconds;\r\n    this.ticksUsed = this.dialogData.result.QueryTimer.Ticks;\r\n    this.result = this.dialogData.result.Query;\r\n    this.sources = this.dialogData.result.Sources;\r\n    this.streams = this.dialogData.result.Streams;\r\n  }\r\n\r\n  closeDialog() {\r\n    this.dialogRef.close();\r\n  }\r\n}\r\n","export default \"<div mat-dialog-title>\\r\\n  <div class=\\\"dialog-title-box\\\">\\r\\n    <div>Query Results</div>\\r\\n    <button mat-icon-button matTooltip=\\\"Close dialog\\\" (click)=\\\"closeDialog()\\\">\\r\\n      <mat-icon>close</mat-icon>\\r\\n    </button>\\r\\n  </div>\\r\\n</div>\\r\\n<p class=\\\"dialog-description\\\">\\r\\n  The Full result was logged to the Browser Console. Further down you'll find more debug-infos.\\r\\n</p>\\r\\n\\r\\n<br />\\r\\n\\r\\n<div mat-dialog-title>\\r\\n  <div class=\\\"dialog-title-box\\\">Parameters & Statistics</div>\\r\\n</div>\\r\\n<p class=\\\"description\\\">\\r\\n  Executed in {{ timeUsed }}ms ({{ ticksUsed }} ticks)\\r\\n</p>\\r\\n<ul class=\\\"description\\\">\\r\\n  <li *ngFor=\\\"let param of testParameters?.split('\\\\n')\\\">{{ param }}</li>\\r\\n</ul>\\r\\n\\r\\n<br />\\r\\n\\r\\n<div mat-dialog-title>\\r\\n  <div class=\\\"dialog-title-box\\\">Query Results</div>\\r\\n</div>\\r\\n<pre>\\r\\n  {{ result | json }}\\r\\n</pre>\\r\\n\\r\\n<br />\\r\\n\\r\\n<div mat-dialog-title>\\r\\n  <div class=\\\"dialog-title-box\\\">Sources</div>\\r\\n</div>\\r\\n<table class=\\\"description\\\">\\r\\n  <tr>\\r\\n    <th>Guid</th>\\r\\n    <th>Type</th>\\r\\n    <th>Configuration</th>\\r\\n    <th>Error</th>\\r\\n  </tr>\\r\\n  <tr *ngFor=\\\"let source of sources | keyvalue\\\">\\r\\n    <td>\\r\\n      <pre>{{ source.value.Guid }}</pre>\\r\\n    </td>\\r\\n    <td>{{ source.value.Type }}</td>\\r\\n    <td>\\r\\n      <ol>\\r\\n        <li *ngFor=\\\"let config of source.value.Configuration | keyvalue\\\">\\r\\n          <b>{{ config.key }}</b>=<em>{{ config.value }}</em></li>\\r\\n      </ol>\\r\\n    </td>\\r\\n    <td>{{ source.value.Error }}</td>\\r\\n  </tr>\\r\\n</table>\\r\\n\\r\\n<br />\\r\\n\\r\\n<div mat-dialog-title>\\r\\n  <div class=\\\"dialog-title-box\\\">Streams</div>\\r\\n</div>\\r\\n<table class=\\\"description\\\">\\r\\n  <tr>\\r\\n    <th>Source</th>\\r\\n    <th>Target</th>\\r\\n    <th>Items</th>\\r\\n    <th>Error</th>\\r\\n  </tr>\\r\\n  <tr *ngFor=\\\"let stream of streams\\\">\\r\\n    <td>\\r\\n      <pre>{{ stream.Source + \\\":\\\" + stream.SourceOut }}</pre>\\r\\n    </td>\\r\\n    <td>\\r\\n      <pre>{{ stream.Target + \\\":\\\" + stream.TargetIn }}</pre>\\r\\n    </td>\\r\\n    <td>{{ stream.Count }}</td>\\r\\n    <td>{{ stream.Error }}</td>\\r\\n  </tr>\\r\\n</table>\\r\\n\";","import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { Observable } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\nimport { webApiQueryDataSources, webApiQueryGet, webApiQueryRun, webApiQuerySave } from '../../app-administration/services';\r\nimport { eavConstants } from '../../shared/constants/eav.constants';\r\nimport { Context } from '../../shared/services/context';\r\nimport { DataSource, PipelineDataSource, PipelineModel, PipelineResult } from '../models';\r\n\r\n@Injectable()\r\nexport class QueryDefinitionService {\r\n  constructor(private http: HttpClient, private context: Context, private dnnContext: DnnContext) { }\r\n\r\n  fetchPipeline(pipelineEntityId: number) {\r\n    const pipelineModel$ = this.http.get(this.dnnContext.$2sxc.http.apiUrl(webApiQueryGet), {\r\n      params: { appId: this.context.appId.toString(), id: pipelineEntityId.toString() }\r\n    }) as Observable<PipelineModel>;\r\n\r\n    return pipelineModel$.pipe(\r\n      map(pipelineModel => {\r\n        // if pipeline is new, populate it with default model\r\n        if (!pipelineModel.DataSources.length) {\r\n          this.buildDefaultModel(pipelineModel);\r\n        }\r\n        this.fixPipelineDataSources(pipelineModel.DataSources);\r\n        return pipelineModel;\r\n      }),\r\n    );\r\n  }\r\n\r\n  private buildDefaultModel(pipelineModel: PipelineModel) {\r\n    const templateDataSources = eavConstants.pipelineDesigner.defaultPipeline.dataSources;\r\n    for (const templateDS of templateDataSources) {\r\n      if (templateDS.visualDesignerData == null) {\r\n        templateDS.visualDesignerData = { Top: 100, Left: 100 };\r\n      }\r\n      const pipelineDataSource: PipelineDataSource = {\r\n        Description: '',\r\n        EntityGuid: templateDS.entityGuid || 'unsaved' + (pipelineModel.DataSources.length + 1),\r\n        EntityId: undefined,\r\n        Name: this.typeNameFilter(templateDS.partAssemblyAndType, 'className'),\r\n        PartAssemblyAndType: templateDS.partAssemblyAndType,\r\n        VisualDesignerData: templateDS.visualDesignerData,\r\n      };\r\n      pipelineModel.DataSources.push(pipelineDataSource);\r\n    }\r\n\r\n    pipelineModel.Pipeline.StreamWiring = eavConstants.pipelineDesigner.defaultPipeline.streamWiring;\r\n  }\r\n\r\n  private fixPipelineDataSources(pipelineDataSources: PipelineDataSource[]) {\r\n    const outDataSourceExists = pipelineDataSources.some(pipelineDS => pipelineDS.EntityGuid === 'Out');\r\n    if (!outDataSourceExists) {\r\n      const outDs = eavConstants.pipelineDesigner.outDataSource;\r\n      const outDsConst: PipelineDataSource = {\r\n        Description: outDs.description,\r\n        EntityGuid: 'Out',\r\n        EntityId: undefined,\r\n        Name: outDs.name,\r\n        PartAssemblyAndType: outDs.className,\r\n        VisualDesignerData: outDs.visualDesignerData,\r\n      };\r\n      pipelineDataSources.push(outDsConst);\r\n    }\r\n\r\n    for (const pipelineDataSource of pipelineDataSources) {\r\n      pipelineDataSource.VisualDesignerData = pipelineDataSource.VisualDesignerData || { Top: 50, Left: 50 };\r\n    }\r\n  }\r\n\r\n  fetchDataSources() {\r\n    const dataSources$ = this.http.get(\r\n      this.dnnContext.$2sxc.http.apiUrl(webApiQueryDataSources)\r\n    ) as Observable<DataSource[]>;\r\n    return dataSources$.pipe(\r\n      map(dataSources => {\r\n        const outDs = eavConstants.pipelineDesigner.outDataSource;\r\n        const outDsConst: DataSource = {\r\n          ContentType: undefined,\r\n          Difficulty: 100,\r\n          DynamicOut: false,\r\n          EnableConfig: undefined,\r\n          HelpLink: undefined,\r\n          Icon: undefined,\r\n          In: outDs.in,\r\n          Name: outDs.name || outDs.className,\r\n          Out: undefined,\r\n          PartAssemblyAndType: outDs.className,\r\n          PrimaryType: 'Target',\r\n          UiHint: undefined,\r\n          allowNew: false,\r\n        };\r\n        dataSources.push(outDsConst);\r\n        return dataSources;\r\n      }),\r\n    );\r\n  }\r\n\r\n  typeNameFilter(input: string, format: string) {\r\n    const globalParts = input.split(', ');\r\n\r\n    switch (format) {\r\n      case 'classFullName':\r\n        const classFullName = globalParts[0];\r\n        return classFullName;\r\n      case 'className':\r\n        const classFullNameParts = globalParts[0].split('.');\r\n        const className = classFullNameParts[classFullNameParts.length - 1];\r\n        return className;\r\n    }\r\n\r\n    return input;\r\n  }\r\n\r\n  /** Save the current query and reload entire definition as returned from server */\r\n  savePipeline(pipelineModel: PipelineModel) {\r\n    const pipeline = pipelineModel.Pipeline;\r\n    const dataSources = pipelineModel.DataSources;\r\n    const pipelineModel$ = this.http.post(\r\n      this.dnnContext.$2sxc.http.apiUrl(webApiQuerySave),\r\n      { pipeline, dataSources },\r\n      { params: { appId: this.context.appId.toString(), Id: pipeline.EntityId.toString() } }\r\n    ) as Observable<PipelineModel>;\r\n\r\n    return pipelineModel$.pipe(\r\n      map(pipeModel => {\r\n        this.fixPipelineDataSources(pipeModel.DataSources);\r\n        return pipeModel;\r\n      }),\r\n    );\r\n  }\r\n\r\n  runPipeline(id: number) {\r\n    return this.http.get(this.dnnContext.$2sxc.http.apiUrl(webApiQueryRun), {\r\n      params: { appId: this.context.appId.toString(), id: id.toString() }\r\n    }) as Observable<PipelineResult>;\r\n  }\r\n\r\n}\r\n","import { DataSource } from '../models/data-sources.model';\r\nimport { PipelineDataSource } from '../models/pipeline.model';\r\nimport { GuiTypes, TypeInfo, TypeInfos } from './plumb-editor.models';\r\n\r\nexport const guiTypes: GuiTypes = {\r\n  Cache: { name: 'Cache', icon: 'history', notes: 'Caching of data' },\r\n  Filter: { name: 'Filter', icon: 'filter_list', notes: 'Filter data - usually returning less items than came in' },\r\n  Logic: { name: 'Logic', icon: 'share', notes: 'Logic operations - usually choosing between different streams' },\r\n  Lookup: { name: 'Lookup', icon: 'search', notes: 'Lookup operation - usually looking for other data based on a criteria' },\r\n  Modify: { name: 'Modify', icon: 'star_half', notes: 'Modify data - usually changing, adding or removing values' },\r\n  Security: { name: 'Security', icon: 'account_circle', notes: 'Security - usually limit what the user sees based on his identity' },\r\n  Sort: { name: 'Sort', icon: 'sort', notes: 'Sort the items' },\r\n  Source: { name: 'Source', icon: 'cloud_upload', notes: 'Source of new data - usually SQL, CSV or similar' },\r\n  Target: { name: 'Target', icon: 'adjust', notes: 'Target - usually just a destination of data' },\r\n  Unknown: { name: 'Unknown', icon: 'fiber_manual_record', notes: 'Unknown type' },\r\n};\r\n\r\nexport function calculateTypeInfos(pipelineDataSources: PipelineDataSource[], dataSources: DataSource[]) {\r\n  const typeInfos: TypeInfos = {};\r\n\r\n  for (const pipelineDataSource of pipelineDataSources) {\r\n    let typeInfo: TypeInfo;\r\n    const dataSource = dataSources.find(ds => ds.PartAssemblyAndType === pipelineDataSource.PartAssemblyAndType);\r\n    if (dataSource) {\r\n      typeInfo = { ...(dataSource.PrimaryType ? guiTypes[dataSource.PrimaryType] : guiTypes.Unknown) };\r\n      if (dataSource.Icon) { typeInfo.icon = dataSource.Icon; }\r\n      if (dataSource.DynamicOut) { typeInfo.dynamicOut = true; }\r\n      if (dataSource.HelpLink) { typeInfo.helpLink = dataSource.HelpLink; }\r\n      if (dataSource.EnableConfig) { typeInfo.config = dataSource.EnableConfig; }\r\n    }\r\n    if (!typeInfo) { typeInfo = guiTypes.Unknown; }\r\n    typeInfos[pipelineDataSource.EntityGuid] = typeInfo;\r\n  }\r\n\r\n  return typeInfos;\r\n}\r\n","import { Context } from '../../shared/services/context';\r\nimport { PipelineModel } from '../models/pipeline.model';\r\n\r\n/**\r\n * Check if there are special warnings the developer should know.\r\n * Typically when the test-module-id is different from the one we're currently\r\n * working on, or if no test-module-id is provided\r\n */\r\nexport function calculateWarnings(pipelineModel: PipelineModel, context: Context) {\r\n  const warnings: string[] = [];\r\n\r\n  try { // catch various not-initialized errors\r\n    const regex = /^\\[module:moduleid\\]=([0-9]*)$/gmi; // capture the mod-id\r\n    const testParams = pipelineModel.Pipeline.TestParameters;\r\n    const matches = regex.exec(testParams);\r\n    const testMid = matches[1];\r\n    const urlMid = context.moduleId.toString();\r\n    if (testMid !== urlMid) {\r\n      warnings.push(`Your test moduleid (${testMid}) is different from the current moduleid (${urlMid}). Note that 2sxc 9.33 automatically provides the moduleid - so you usually do not need to set it any more.`);\r\n    }\r\n  } catch (error) { }\r\n\r\n  return warnings;\r\n}\r\n","import cloneDeep from 'lodash-es/cloneDeep';\r\nimport { DataSource, SortedDataSources } from '../models/data-sources.model';\r\n\r\nexport function filterAndSortDataSources(dataSources: DataSource[], maxDifficulty: number) {\r\n  const cloned = cloneDeep(dataSources);\r\n\r\n  const filtered = cloned.filter(dataSource =>\r\n    (dataSource.Difficulty <= maxDifficulty) && (dataSource.allowNew == null)\r\n  );\r\n\r\n  filtered.sort((a, b) => a.Name.toLocaleLowerCase().localeCompare(b.Name.toLocaleLowerCase()));\r\n\r\n  const sorted: SortedDataSources = {};\r\n  for (const dataSource of filtered) {\r\n    const type = dataSource.PrimaryType;\r\n    sorted[type] ? sorted[type].push(dataSource) : sorted[type] = [dataSource];\r\n  }\r\n\r\n  return sorted;\r\n}\r\n\r\nexport function toggleInArray(item: string, array: string[]) {\r\n  const index = array.indexOf(item);\r\n  if (index === -1) {\r\n    array.push(item);\r\n  } else {\r\n    array.splice(index, 1);\r\n  }\r\n}\r\n","import { ChangeDetectionStrategy, Component, OnInit, ViewChild } from '@angular/core';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { Context } from '../shared/services/context';\r\nimport { PlumbEditorComponent } from './plumb-editor/plumb-editor.component';\r\nimport { VisualQueryService } from './services/visual-query.service';\r\n\r\n@Component({\r\n  selector: 'app-visual-query',\r\n  templateUrl: './visual-query.component.html',\r\n  styleUrls: ['./visual-query.component.scss'],\r\n  providers: [VisualQueryService],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class VisualQueryComponent implements OnInit {\r\n  @ViewChild(PlumbEditorComponent) plumbEditor: PlumbEditorComponent;\r\n\r\n  explorer = {\r\n    run: 'run',\r\n    add: 'add'\r\n  };\r\n  activeExplorer = this.explorer.run;\r\n\r\n  constructor(private context: Context, private route: ActivatedRoute, private visualQueryService: VisualQueryService) {\r\n    this.context.init(this.route);\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.visualQueryService.init();\r\n  }\r\n\r\n  toggleExplorer(explorer: string) {\r\n    this.activeExplorer = (this.activeExplorer === explorer) ? null : explorer;\r\n  }\r\n\r\n  openHelp() {\r\n    window.open('https://2sxc.org/help', '_blank');\r\n  }\r\n\r\n}\r\n","export default \"<div #domRoot id=\\\"pipeline-root\\\" *ngIf=\\\"(templateModel$ | async) as templateModel\\\">\\r\\n  <!-- do not use trackBy, jsPlumb drag stops working properly after delete -->\\r\\n  <ng-container *ngIf=\\\"!hardReset\\\">\\r\\n    <div #domDataSource *ngFor=\\\"let dataSource of templateModel.pipelineDataSources\\\"\\r\\n      [id]=\\\"dataSrcIdPrefix + dataSource.EntityGuid\\\" class=\\\"dataSource\\\" [ngStyle]=\\\"{\\r\\n        'top': dataSource.VisualDesignerData.Top + 'px',\\r\\n        'left': dataSource.VisualDesignerData.Left + 'px',\\r\\n        'min-width': dataSource.VisualDesignerData.Width ? dataSource.VisualDesignerData.Width + 'px' : null\\r\\n      }\\\">\\r\\n\\r\\n      <div class=\\\"configure\\\" title=\\\"Configure data source\\\" appMousedownStopPropagation\\r\\n        *ngIf=\\\"templateModel.allowEdit && templateModel.typeInfos[dataSource.EntityGuid].config\\\"\\r\\n        (click)=\\\"configureDataSource(dataSource)\\\">\\r\\n        <mat-icon class=\\\"eav-icon-settings\\\">settings</mat-icon>\\r\\n      </div>\\r\\n\\r\\n      <mat-icon class=\\\"type-info\\\" [title]=\\\"templateModel.typeInfos[dataSource.EntityGuid].notes\\\">\\r\\n        {{ templateModel.typeInfos[dataSource.EntityGuid].icon }}\\r\\n      </mat-icon>\\r\\n\\r\\n      <div class=\\\"name noselect\\\" title=\\\"Click to edit name\\\" appMousedownStopPropagation\\r\\n        (click)=\\\"templateModel.allowEdit && editName(dataSource)\\\">\\r\\n        <span>{{ dataSource.Name || '(no name)' }}</span>\\r\\n        <mat-icon class=\\\"show-hover-inline eav-icon-pencil\\\">edit</mat-icon>\\r\\n      </div>\\r\\n      <br />\\r\\n\\r\\n      <div class=\\\"description noselect\\\" title=\\\"Click to edit description\\\" appMousedownStopPropagation\\r\\n        (click)=\\\"templateModel.allowEdit && editDescription(dataSource)\\\">\\r\\n        <span>{{ dataSource.Description }}</span>\\r\\n        <mat-icon class=\\\"show-hover-inline eav-icon-pencil\\\">edit</mat-icon>\\r\\n      </div>\\r\\n      <br />\\r\\n\\r\\n      <div class=\\\"typename\\\" [title]=\\\"dataSource.PartAssemblyAndType\\\">\\r\\n        Type: {{ typeNameFilter(dataSource.PartAssemblyAndType, 'className') }}\\r\\n      </div>\\r\\n\\r\\n      <div class=\\\"add-endpoint\\\" title=\\\"Drag a new Out-Connection\\\"\\r\\n        *ngIf=\\\"templateModel.allowEdit && templateModel.typeInfos[dataSource.EntityGuid].dynamicOut\\\">\\r\\n        <mat-icon class=\\\"new-connection eav-icon-up-dir\\\">arrow_drop_up</mat-icon>\\r\\n      </div>\\r\\n\\r\\n      <mat-icon class=\\\"delete eav-icon-cancel\\\" title=\\\"Delete\\\" appMousedownStopPropagation\\r\\n        *ngIf=\\\"templateModel.allowEdit\\\" (click)=\\\"remove(dataSource)\\\">\\r\\n        delete\\r\\n      </mat-icon>\\r\\n\\r\\n      <a class=\\\"help eav-icon-help-circled\\\" title=\\\"Help for this data source\\\"\\r\\n        [href]=\\\"templateModel.typeInfos[dataSource.EntityGuid].helpLink\\\" target=\\\"_blank\\\" appMousedownStopPropagation\\r\\n        *ngIf=\\\"templateModel.typeInfos[dataSource.EntityGuid].helpLink\\\">\\r\\n        <mat-icon>help_outline</mat-icon>\\r\\n      </a>\\r\\n    </div>\\r\\n  </ng-container>\\r\\n</div>\\r\\n\";","export default \"<div class=\\\"editor-active-explorer fancy-scrollbar-dark\\\" *ngIf=\\\"(pipelineModel$ | async) as pipelineModel\\\">\\r\\n\\r\\n  <div class=\\\"wrapper\\\">\\r\\n    <div class=\\\"actions\\\">\\r\\n      <button mat-raised-button class=\\\"action\\\" color=\\\"accent\\\" (click)=\\\"saveAndRunQuery(true, true)\\\">\\r\\n        Save and run\\r\\n      </button>\\r\\n      <button mat-raised-button class=\\\"action\\\" (click)=\\\"saveAndRunQuery(false, true)\\\">\\r\\n        Run\\r\\n      </button>\\r\\n      <button mat-raised-button class=\\\"action\\\" (click)=\\\"saveAndRunQuery(true, false)\\\">\\r\\n        Save\\r\\n      </button>\\r\\n    </div>\\r\\n\\r\\n    <div class=\\\"parameters\\\">\\r\\n      <div class=\\\"title\\\">\\r\\n        <div>Parameters</div>\\r\\n        <div>\\r\\n          <button mat-icon-button matTooltip=\\\"Edit parameters\\\" (click)=\\\"editPipeline()\\\">\\r\\n            <mat-icon>edit</mat-icon>\\r\\n          </button>\\r\\n          <button mat-icon-button matTooltip=\\\"Query Params Docs\\\" (click)=\\\"openParamsHelp()\\\">\\r\\n            <mat-icon>info</mat-icon>\\r\\n          </button>\\r\\n        </div>\\r\\n      </div>\\r\\n      <ul class=\\\"values\\\" *ngIf=\\\"pipelineModel.Pipeline.Params?.length\\\">\\r\\n        <li *ngFor=\\\"let param of pipelineModel.Pipeline.Params?.split('\\\\n')\\\">\\r\\n          {{ param }}\\r\\n        </li>\\r\\n      </ul>\\r\\n    </div>\\r\\n\\r\\n    <div class=\\\"parameters\\\">\\r\\n      <div class=\\\"title\\\">Test Parameters</div>\\r\\n      <ul class=\\\"values\\\" *ngIf=\\\"pipelineModel.Pipeline.TestParameters?.length\\\">\\r\\n        <li *ngFor=\\\"let param of pipelineModel.Pipeline.TestParameters?.split('\\\\n')\\\">\\r\\n          {{ param }}\\r\\n        </li>\\r\\n      </ul>\\r\\n    </div>\\r\\n\\r\\n    <ng-container *ngIf=\\\"(warnings$ | async) as warnings\\\">\\r\\n      <div class=\\\"warnings\\\" *ngIf=\\\"warnings.length\\\">\\r\\n        <div class=\\\"title\\\">\\r\\n          <span>Warnings</span>\\r\\n          <mat-icon style=\\\"color: red\\\">warning</mat-icon>\\r\\n        </div>\\r\\n        <ol class=\\\"values\\\">\\r\\n          <li *ngFor=\\\"let warning of warnings\\\">\\r\\n            {{ warning }}\\r\\n          </li>\\r\\n        </ol>\\r\\n      </div>\\r\\n    </ng-container>\\r\\n\\r\\n    <div class=\\\"description\\\" *ngIf=\\\"pipelineModel.Pipeline.Description\\\">\\r\\n      <div class=\\\"title\\\">Query Description</div>\\r\\n      <div>{{ pipelineModel.Pipeline.Description }}</div>\\r\\n    </div>\\r\\n  </div>\\r\\n</div>\\r\\n\";","export default \".wrapper {\\n  padding: 24px;\\n}\\n\\n.actions {\\n  display: flex;\\n  flex-direction: column;\\n  padding-bottom: 32px;\\n}\\n\\n.actions .action:not(:last-of-type) {\\n  margin-bottom: 8px;\\n}\\n\\n.parameters,\\n.warnings,\\n.description {\\n  margin: 16px 0;\\n}\\n\\n.parameters .title,\\n.warnings .title,\\n.description .title {\\n  height: 40px;\\n  display: flex;\\n  align-items: center;\\n  justify-content: space-between;\\n  font-size: 14px;\\n}\\n\\n.parameters .title .mat-icon,\\n.warnings .title .mat-icon,\\n.description .title .mat-icon {\\n  -webkit-user-select: none;\\n     -moz-user-select: none;\\n          user-select: none;\\n}\\n\\n.parameters .values,\\n.warnings .values {\\n  margin: 0;\\n  padding-left: 16px;\\n}\\n\\n.parameters .values li,\\n.warnings .values li {\\n  padding: 1px 0;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByb2plY3RzL25nLWRpYWxvZ3Mvc3JjL2FwcC92aXN1YWwtcXVlcnkvcnVuLWV4cGxvcmVyL3J1bi1leHBsb3Jlci5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGFBQUE7QUFDRjs7QUFFQTtFQUNFLGFBQUE7RUFDQSxzQkFBQTtFQUNBLG9CQUFBO0FBQ0Y7O0FBQ0U7RUFDRSxrQkFBQTtBQUNKOztBQUdBOzs7RUFHRSxjQUFBO0FBQUY7O0FBRUU7OztFQUNFLFlBQUE7RUFDQSxhQUFBO0VBQ0EsbUJBQUE7RUFDQSw4QkFBQTtFQUNBLGVBQUE7QUFFSjs7QUFBSTs7O0VBQ0UseUJBQUE7S0FBQSxzQkFBQTtVQUFBLGlCQUFBO0FBSU47O0FBR0U7O0VBQ0UsU0FBQTtFQUNBLGtCQUFBO0FBQ0o7O0FBQ0k7O0VBQ0UsY0FBQTtBQUVOIiwiZmlsZSI6InByb2plY3RzL25nLWRpYWxvZ3Mvc3JjL2FwcC92aXN1YWwtcXVlcnkvcnVuLWV4cGxvcmVyL3J1bi1leHBsb3Jlci5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi53cmFwcGVyIHtcclxuICBwYWRkaW5nOiAyNHB4O1xyXG59XHJcblxyXG4uYWN0aW9ucyB7XHJcbiAgZGlzcGxheTogZmxleDtcclxuICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG4gIHBhZGRpbmctYm90dG9tOiAzMnB4O1xyXG5cclxuICAuYWN0aW9uOm5vdCg6bGFzdC1vZi10eXBlKSB7XHJcbiAgICBtYXJnaW4tYm90dG9tOiA4cHg7XHJcbiAgfVxyXG59XHJcblxyXG4ucGFyYW1ldGVycyxcclxuLndhcm5pbmdzLFxyXG4uZGVzY3JpcHRpb24ge1xyXG4gIG1hcmdpbjogMTZweCAwO1xyXG5cclxuICAudGl0bGUge1xyXG4gICAgaGVpZ2h0OiA0MHB4O1xyXG4gICAgZGlzcGxheTogZmxleDtcclxuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XHJcbiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XHJcbiAgICBmb250LXNpemU6IDE0cHg7XHJcblxyXG4gICAgLm1hdC1pY29uIHtcclxuICAgICAgdXNlci1zZWxlY3Q6IG5vbmU7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG4ucGFyYW1ldGVycyxcclxuLndhcm5pbmdzIHtcclxuICAudmFsdWVzIHtcclxuICAgIG1hcmdpbjogMDtcclxuICAgIHBhZGRpbmctbGVmdDogMTZweDtcclxuXHJcbiAgICBsaSB7XHJcbiAgICAgIHBhZGRpbmc6IDFweCAwO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iXX0= */\";","import { ChangeDetectionStrategy, Component, OnDestroy, OnInit } from '@angular/core';\r\nimport { MatSlideToggleChange } from '@angular/material/slide-toggle';\r\nimport { BehaviorSubject, combineLatest, Observable } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\nimport { DataSource } from '../models/data-sources.model';\r\nimport { SortedDataSources } from '../models/data-sources.model';\r\nimport { VisualQueryService } from '../services/visual-query.service';\r\nimport { filterAndSortDataSources, toggleInArray } from './add-explorer.helpers';\r\n\r\n@Component({\r\n  selector: 'app-add-explorer',\r\n  templateUrl: './add-explorer.component.html',\r\n  styleUrls: ['./add-explorer.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class AddExplorerComponent implements OnInit, OnDestroy {\r\n  sorted$: Observable<SortedDataSources>;\r\n  toggledItems: string[] = [];\r\n\r\n  private difficulties = {\r\n    default: 100,\r\n    advanced: 200,\r\n  };\r\n  private difficulty$ = new BehaviorSubject(this.difficulties.default);\r\n\r\n  constructor(private visualQueryService: VisualQueryService) { }\r\n\r\n  ngOnInit() {\r\n    this.sorted$ = combineLatest([this.visualQueryService.dataSources$, this.difficulty$]).pipe(\r\n      map(([dataSources, difficulty]) => {\r\n        if (dataSources == null) { return; }\r\n        const sorted = filterAndSortDataSources(dataSources, difficulty);\r\n        return sorted;\r\n      }),\r\n    );\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.difficulty$.complete();\r\n  }\r\n\r\n  toggleDifficulty(event: MatSlideToggleChange) {\r\n    const difficulty = event.checked ? this.difficulties.advanced : this.difficulties.default;\r\n    this.difficulty$.next(difficulty);\r\n  }\r\n\r\n  addDataSource(dataSource: DataSource) {\r\n    this.visualQueryService.addDataSource(dataSource);\r\n  }\r\n\r\n  toggleItem(item: string) {\r\n    toggleInArray(item, this.toggledItems);\r\n  }\r\n\r\n}\r\n","import { ChangeDetectorRef, Injectable, NgZone, OnDestroy, ViewContainerRef } from '@angular/core';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { Title } from '@angular/platform-browser';\r\nimport { ActivatedRoute, NavigationEnd, Router } from '@angular/router';\r\nimport cloneDeep from 'lodash-es/cloneDeep';\r\nimport { BehaviorSubject, fromEvent, Subject, Subscription } from 'rxjs';\r\nimport { filter, map, pairwise, startWith } from 'rxjs/operators';\r\nimport { ContentTypesService } from '../../app-administration/services/content-types.service';\r\nimport { MetadataService } from '../../permissions/services/metadata.service';\r\nimport { eavConstants } from '../../shared/constants/eav.constants';\r\nimport { convertFormToUrl } from '../../shared/helpers/url-prep.helper';\r\nimport { EditForm } from '../../shared/models/edit-form.model';\r\nimport { DataSource, DataSourceMetadata } from '../models/data-sources.model';\r\nimport { PipelineResult } from '../models/pipeline-result.model';\r\nimport { PipelineDataSource, PipelineModel, StreamWire, VisualDesignerData } from '../models/pipeline.model';\r\nimport { QueryResultComponent } from '../query-result/query-result.component';\r\nimport { QueryResultDialogData } from '../query-result/query-result.models';\r\nimport { QueryDefinitionService } from './query-definition.service';\r\n\r\n@Injectable()\r\nexport class VisualQueryService implements OnDestroy {\r\n  pipelineModel$ = new BehaviorSubject<PipelineModel>(null);\r\n  dataSources$ = new BehaviorSubject<DataSource[]>(null);\r\n  putEntityCountOnConnections$ = new Subject<PipelineResult>();\r\n\r\n  private pipelineId = parseInt(this.route.snapshot.paramMap.get('pipelineId'), 10);\r\n  private doRefresh = false;\r\n  private subscription = new Subscription();\r\n\r\n  constructor(\r\n    private router: Router,\r\n    private route: ActivatedRoute,\r\n    private queryDefinitionService: QueryDefinitionService,\r\n    private titleService: Title,\r\n    private snackBar: MatSnackBar,\r\n    private dialog: MatDialog,\r\n    private viewContainerRef: ViewContainerRef,\r\n    private zone: NgZone,\r\n    private metadataService: MetadataService,\r\n    private contentTypesService: ContentTypesService,\r\n    private changeDetectorRef: ChangeDetectorRef,\r\n  ) { }\r\n\r\n  ngOnDestroy() {\r\n    this.pipelineModel$.complete();\r\n    this.dataSources$.complete();\r\n    this.putEntityCountOnConnections$.complete();\r\n    this.subscription.unsubscribe();\r\n  }\r\n\r\n  init() {\r\n    this.fetchPipeline();\r\n    this.fetchDataSources();\r\n    this.attachKeyboardSave();\r\n    this.refreshOnChildClosed();\r\n  }\r\n\r\n  editPipelineEntity() {\r\n    // save Pipeline, then open Edit Dialog\r\n    this.savePipeline(() => {\r\n      const form: EditForm = {\r\n        items: [{ EntityId: this.pipelineModel$.value.Pipeline.EntityId }],\r\n      };\r\n      const formUrl = convertFormToUrl(form);\r\n      this.doRefresh = true;\r\n      this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route });\r\n    });\r\n  }\r\n\r\n  saveAndRun(save: boolean, run: boolean) {\r\n    if (save && run) {\r\n      this.savePipeline(() => { this.runPipeline(); });\r\n    } else if (save) {\r\n      this.savePipeline();\r\n    } else if (run) {\r\n      this.runPipeline();\r\n    }\r\n  }\r\n\r\n  addDataSource(dataSource: DataSource) {\r\n    const pipelineModel = cloneDeep(this.pipelineModel$.value);\r\n    const newPipelineDataSource: PipelineDataSource = {\r\n      Description: '',\r\n      EntityGuid: 'unsaved' + (pipelineModel.DataSources.length + 1),\r\n      EntityId: undefined,\r\n      Name: this.queryDefinitionService.typeNameFilter(dataSource.PartAssemblyAndType, 'className'),\r\n      PartAssemblyAndType: dataSource.PartAssemblyAndType,\r\n      VisualDesignerData: { Top: 100, Left: 100 },\r\n    };\r\n    pipelineModel.DataSources.push(newPipelineDataSource);\r\n    this.pipelineModel$.next(pipelineModel);\r\n    this.savePipeline();\r\n  }\r\n\r\n  removeDataSource(pipelineDataSourceGuid: string, connections: StreamWire[], streamsOut: string) {\r\n    const pipelineModel = cloneDeep(this.pipelineModel$.value);\r\n    pipelineModel.DataSources = pipelineModel.DataSources.filter(pipelineDS => pipelineDS.EntityGuid !== pipelineDataSourceGuid);\r\n    pipelineModel.Pipeline.StreamWiring = connections;\r\n    pipelineModel.Pipeline.StreamsOut = streamsOut;\r\n    this.pipelineModel$.next(pipelineModel);\r\n  }\r\n\r\n  renameDataSource(pipelineDataSourceGuid: string, name: string) {\r\n    const pipelineModel = cloneDeep(this.pipelineModel$.value);\r\n    const pipelineDataSource = pipelineModel.DataSources.find(pipelineDS => pipelineDS.EntityGuid === pipelineDataSourceGuid);\r\n    pipelineDataSource.Name = name;\r\n    this.pipelineModel$.next(pipelineModel);\r\n  }\r\n\r\n  changeDataSourceDescription(pipelineDataSourceGuid: string, description: string) {\r\n    const pipelineModel = cloneDeep(this.pipelineModel$.value);\r\n    const pipelineDataSource = pipelineModel.DataSources.find(pipelineDS => pipelineDS.EntityGuid === pipelineDataSourceGuid);\r\n    pipelineDataSource.Description = description;\r\n    this.pipelineModel$.next(pipelineModel);\r\n  }\r\n\r\n  changeConnections(connections: StreamWire[], streamsOut: string) {\r\n    const pipelineModel = cloneDeep(this.pipelineModel$.value);\r\n    pipelineModel.Pipeline.StreamWiring = connections;\r\n    pipelineModel.Pipeline.StreamsOut = streamsOut;\r\n    this.pipelineModel$.next(pipelineModel);\r\n  }\r\n\r\n  changeDataSourcePosition(pipelineDataSourceGuid: string, position: VisualDesignerData) {\r\n    const pipelineModel = cloneDeep(this.pipelineModel$.value);\r\n    const pipelineDataSource = pipelineModel.DataSources.find(pipelineDS => pipelineDS.EntityGuid === pipelineDataSourceGuid);\r\n    if (!pipelineDataSource) {\r\n      // spm NOTE: fixes problem where dataSource position can't be updated if dataSource with guid unsavedXX gets saved while dragging.\r\n      // Can happen if dataSource is just added and user drags it and save happens.\r\n      return;\r\n    }\r\n    pipelineDataSource.VisualDesignerData = { ...pipelineDataSource.VisualDesignerData, ...position };\r\n    this.pipelineModel$.next(pipelineModel);\r\n  }\r\n\r\n  editDataSource(pipelineDataSource: PipelineDataSource) {\r\n    const dataSource = this.dataSources$.value.find(ds => ds.PartAssemblyAndType === pipelineDataSource.PartAssemblyAndType);\r\n\r\n    const contentTypeName = dataSource?.ContentType\r\n      ? dataSource.ContentType\r\n      : '|Config ' + this.queryDefinitionService.typeNameFilter(pipelineDataSource.PartAssemblyAndType, 'classFullName');\r\n\r\n    const typeId = eavConstants.metadata.entity.type;\r\n    const keyType = eavConstants.keyTypes.guid;\r\n    const key = pipelineDataSource.EntityGuid;\r\n\r\n    // Query for existing Entity\r\n    this.metadataService.getMetadata(typeId, keyType, key, contentTypeName).subscribe((metadata: DataSourceMetadata[]) => {\r\n      // Edit existing Entity\r\n      if (metadata.length) {\r\n        const form: EditForm = {\r\n          items: [{ EntityId: metadata[0].Id }],\r\n        };\r\n        const formUrl = convertFormToUrl(form);\r\n        this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route });\r\n        return;\r\n      }\r\n\r\n      // Check if the type exists, and if yes, create new Entity\r\n      this.contentTypesService.retrieveContentType(contentTypeName /*, { ignoreErrors: 'true' } */).subscribe({\r\n        next: contentType => {\r\n          const form: EditForm = {\r\n            items: [{\r\n              ContentTypeName: contentTypeName,\r\n              For: {\r\n                Target: eavConstants.metadata.entity.target,\r\n                Guid: key,\r\n              }\r\n            }],\r\n          };\r\n          const formUrl = convertFormToUrl(form);\r\n          this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route });\r\n        },\r\n        error: error => {\r\n          alert('Server reports error - this usually means that this data-source doesn\\'t have any configuration');\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  private savePipeline(callback?: () => void) {\r\n    this.snackBar.open('Saving...');\r\n    this.queryDefinitionService.savePipeline(this.pipelineModel$.value).subscribe({\r\n      next: pipelineModel => {\r\n        this.snackBar.open('Saved', null, { duration: 2000 });\r\n        this.pipelineModel$.next(pipelineModel);\r\n        if (callback != null) { callback(); }\r\n      },\r\n      error: error => {\r\n        this.snackBar.open('Save Pipeline failed', null, { duration: 2000 });\r\n      }\r\n    });\r\n  }\r\n\r\n  private runPipeline() {\r\n    this.snackBar.open('Running query...');\r\n    this.queryDefinitionService.runPipeline(this.pipelineModel$.value.Pipeline.EntityId).subscribe({\r\n      next: pipelineResult => {\r\n        this.snackBar.open('Query worked', null, { duration: 2000 });\r\n        // open modal with the results\r\n        const dialogData: QueryResultDialogData = {\r\n          testParameters: this.pipelineModel$.value.Pipeline.TestParameters,\r\n          result: pipelineResult,\r\n        };\r\n        this.dialog.open(QueryResultComponent, {\r\n          data: dialogData,\r\n          backdropClass: 'dialog-backdrop',\r\n          panelClass: ['dialog-panel', `dialog-panel-medium`, 'no-scrollbar'],\r\n          viewContainerRef: this.viewContainerRef,\r\n          autoFocus: false,\r\n          closeOnNavigation: false,\r\n          // spm NOTE: used to force align-items: flex-start; on cdk-global-overlay-wrapper.\r\n          // Real top margin is overwritten in css e.g. dialog-panel-large\r\n          position: { top: '0' },\r\n        });\r\n        this.changeDetectorRef.markForCheck();\r\n        console.warn(pipelineResult);\r\n        setTimeout(() => { this.putEntityCountOnConnections$.next(pipelineResult); });\r\n      },\r\n      error: error => {\r\n        this.snackBar.open('Query failed', null, { duration: 2000 });\r\n      }\r\n    });\r\n  }\r\n\r\n  private fetchPipeline(reloadingSnackBar = false) {\r\n    if (reloadingSnackBar) {\r\n      this.snackBar.open('Reloading query, please wait...');\r\n    }\r\n    this.queryDefinitionService.fetchPipeline(this.pipelineId).subscribe(pipelineModel => {\r\n      if (reloadingSnackBar) {\r\n        this.snackBar.open('Query reloaded', null, { duration: 2000 });\r\n      }\r\n      this.pipelineModel$.next(pipelineModel);\r\n      this.titleService.setTitle(`${pipelineModel.Pipeline.Name} - Visual Query`);\r\n    });\r\n  }\r\n\r\n  private fetchDataSources() {\r\n    this.queryDefinitionService.fetchDataSources().subscribe(dataSources => {\r\n      this.dataSources$.next(dataSources);\r\n    });\r\n  }\r\n\r\n  private attachKeyboardSave() {\r\n    this.zone.runOutsideAngular(() => {\r\n      this.subscription.add(\r\n        fromEvent(window, 'keydown').pipe(\r\n          filter(() => !this.route.snapshot.firstChild),\r\n          filter((event: KeyboardEvent) => {\r\n            const CTRL_S = (navigator.platform.match('Mac') ? event.metaKey : event.ctrlKey) && event.keyCode === 83;\r\n            return CTRL_S;\r\n          }),\r\n        ).subscribe(event => {\r\n          event.preventDefault();\r\n          this.zone.run(() => { this.savePipeline(); });\r\n        })\r\n      );\r\n    });\r\n  }\r\n\r\n  private refreshOnChildClosed() {\r\n    this.subscription.add(\r\n      this.router.events.pipe(\r\n        filter(event => event instanceof NavigationEnd),\r\n        startWith(!!this.route.snapshot.firstChild),\r\n        map(() => !!this.route.snapshot.firstChild),\r\n        pairwise(),\r\n        filter(([hadChild, hasChild]) => hadChild && !hasChild),\r\n        filter(() => {\r\n          const refresh = this.doRefresh;\r\n          this.doRefresh = false;\r\n          return refresh;\r\n        }),\r\n      ).subscribe(() => {\r\n        this.fetchPipeline(true);\r\n      })\r\n    );\r\n  }\r\n\r\n}\r\n","import { CommonModule } from '@angular/common';\r\nimport { NgModule } from '@angular/core';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatDialogModule } from '@angular/material/dialog';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatSlideToggleModule } from '@angular/material/slide-toggle';\r\nimport { MatSnackBarModule } from '@angular/material/snack-bar';\r\nimport { MatTooltipModule } from '@angular/material/tooltip';\r\nimport { ContentTypesService } from '../app-administration/services/content-types.service';\r\nimport { MetadataService } from '../permissions/services/metadata.service';\r\nimport { Context } from '../shared/services/context';\r\nimport { SharedComponentsModule } from '../shared/shared-components.module';\r\nimport { AddExplorerComponent } from './add-explorer/add-explorer.component';\r\nimport { PlumbEditorComponent } from './plumb-editor/plumb-editor.component';\r\nimport { QueryResultComponent } from './query-result/query-result.component';\r\nimport { RunExplorerComponent } from './run-explorer/run-explorer.component';\r\nimport { QueryDefinitionService } from './services/query-definition.service';\r\nimport { VisualQueryRoutingModule } from './visual-query-routing.module';\r\nimport { VisualQueryComponent } from './visual-query.component';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    VisualQueryComponent,\r\n    RunExplorerComponent,\r\n    AddExplorerComponent,\r\n    PlumbEditorComponent,\r\n    QueryResultComponent,\r\n  ],\r\n  entryComponents: [\r\n    VisualQueryComponent,\r\n    RunExplorerComponent,\r\n    AddExplorerComponent,\r\n    PlumbEditorComponent,\r\n    QueryResultComponent,\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    SharedComponentsModule,\r\n    VisualQueryRoutingModule,\r\n    MatIconModule,\r\n    MatTooltipModule,\r\n    MatButtonModule,\r\n    MatSlideToggleModule,\r\n    MatSnackBarModule,\r\n    MatDialogModule,\r\n  ],\r\n  providers: [\r\n    Context,\r\n    QueryDefinitionService,\r\n    MetadataService,\r\n    ContentTypesService,\r\n  ]\r\n})\r\nexport class VisualQueryModule { }\r\n","import { DataSource } from '../models/data-sources.model';\r\nimport { PipelineResult } from '../models/pipeline-result.model';\r\nimport { PipelineDataSource, PipelineModel, StreamWire, VisualDesignerData } from '../models/pipeline.model';\r\n\r\nexport const dataSrcIdPrefix = 'dataSource_';\r\ntype PlumbType = any;\r\ndeclare const jsPlumb: PlumbType;\r\n\r\nexport class Plumber {\r\n  private instance: PlumbType;\r\n  private lineCount = 0;\r\n  private linePaintDefault = {\r\n    stroke: '#61B7CF',\r\n    strokeWidth: 4,\r\n    outlineStroke: 'white',\r\n    outlineWidth: 2,\r\n  };\r\n  private lineColors = [\r\n    '#009688', '#00bcd4', '#3f51b5', '#9c27b0', '#e91e63',\r\n    '#db4437', '#ff9800', '#60a917', '#60a917', '#008a00',\r\n    '#00aba9', '#1ba1e2', '#0050ef', '#6a00ff', '#aa00ff',\r\n    '#f472d0', '#d80073', '#a20025', '#e51400', '#fa6800',\r\n    '#f0a30a', '#e3c800', '#825a2c', '#6d8764', '#647687',\r\n    '#76608a', '#a0522d',\r\n  ];\r\n  private maxCols = this.lineColors.length - 1;\r\n  private uuidColorMap: { [key: string]: any } = {};\r\n  private bulkDelete = false;\r\n\r\n  constructor(\r\n    private jsPlumbRoot: HTMLElement,\r\n    private pipelineModel: PipelineModel,\r\n    private dataSources: DataSource[],\r\n    private onConnectionsChanged: () => void,\r\n    private onDragend: (pipelineDataSourceGuid: string, position: VisualDesignerData) => void,\r\n    /** Workaround for multiple dblClick listeners */\r\n    private plumbInits: number,\r\n  ) {\r\n    this.instance = jsPlumb.getInstance(this.getInstanceDefaults(this.jsPlumbRoot));\r\n    this.instance.batch(() => {\r\n      this.initDomDataSources();\r\n      this.initWirings();\r\n      this.bindEvents();\r\n    });\r\n    // spm NOTE: repaint after initial paint fixes:\r\n    // Error: <svg> attribute width: Expected length, \"-Infinity\".\r\n    this.instance.repaintEverything();\r\n  }\r\n\r\n  destroy() {\r\n    this.instance.reset();\r\n  }\r\n\r\n  removeEndpointsOnDataSource(pipelineDataSourceGuid: string) {\r\n    const elementId = dataSrcIdPrefix + pipelineDataSourceGuid;\r\n    this.bulkDelete = true;\r\n    this.instance.batch(() => {\r\n      this.instance.selectEndpoints({ element: elementId }).delete();\r\n    });\r\n    this.bulkDelete = false;\r\n  }\r\n\r\n  getAllConnections() {\r\n    const connectionInfos: StreamWire[] = this.instance.getAllConnections().map((connection: PlumbType) => {\r\n      const wire: StreamWire = {\r\n        From: connection.sourceId.replace(dataSrcIdPrefix, ''),\r\n        Out: connection.endpoints[0].getOverlay('endpointLabel').label,\r\n        To: connection.targetId.replace(dataSrcIdPrefix, ''),\r\n        In: connection.endpoints[1].getOverlay('endpointLabel').label,\r\n      };\r\n      return wire;\r\n    });\r\n    return connectionInfos;\r\n  }\r\n\r\n  getStreamsOut() {\r\n    const streamsOut: string[] = [];\r\n    this.instance.selectEndpoints({ target: dataSrcIdPrefix + 'Out' }).each((endpoint: PlumbType) => {\r\n      streamsOut.push(endpoint.getOverlay('endpointLabel').label);\r\n    });\r\n    const streamsOutStr = streamsOut.join(',');\r\n    return streamsOutStr;\r\n  }\r\n\r\n  putEntityCountOnConnections(result: PipelineResult) {\r\n    result.Streams?.forEach(stream => {\r\n      const sourceElementId = dataSrcIdPrefix + stream.Source;\r\n      const outTargets = ['00000000-0000-0000-0000-000000000000', this.pipelineModel.Pipeline.EntityGuid];\r\n      const targetElementId = outTargets.includes(stream.Target) ? dataSrcIdPrefix + 'Out' : dataSrcIdPrefix + stream.Target;\r\n\r\n      const fromUuid = sourceElementId + '_out_' + stream.SourceOut;\r\n      const toUuid = targetElementId + '_in_' + stream.TargetIn;\r\n\r\n      const sEndp: PlumbType = this.instance.getEndpoint(fromUuid);\r\n      sEndp?.connections?.forEach((connection: PlumbType) => {\r\n        if (connection.endpoints[1].getUuid() !== toUuid) { return; }\r\n\r\n        connection.setLabel({ label: stream.Count.toString(), cssClass: 'streamEntitiesCount' });\r\n      });\r\n    });\r\n  }\r\n\r\n  private nextLinePaintStyle(uuid: string) {\r\n    return (\r\n      this.uuidColorMap[uuid] ||\r\n      (this.uuidColorMap[uuid] = Object.assign({}, this.linePaintDefault, { stroke: this.lineColors[this.lineCount++ % this.maxCols] }))\r\n    );\r\n  }\r\n\r\n  private getInstanceDefaults(container: HTMLElement) {\r\n    const defaults = {\r\n      Container: container,\r\n      Connector: ['Bezier', { curviness: 70 }],\r\n      PaintStyle: this.nextLinePaintStyle('dummy'),\r\n      HoverPaintStyle: {\r\n        stroke: '#216477',\r\n        strokeWidth: 4,\r\n        outlineStroke: 'white',\r\n        outlineWidth: 2,\r\n      },\r\n    };\r\n    return defaults;\r\n  }\r\n\r\n  /** Create sources, targets and endpoints */\r\n  private initDomDataSources() {\r\n    for (const pipelineDataSource of this.pipelineModel.DataSources) {\r\n      const domDataSource: HTMLElement = this.jsPlumbRoot.querySelector('#' + dataSrcIdPrefix + pipelineDataSource.EntityGuid);\r\n      if (!domDataSource) { continue; }\r\n      const dataSource = this.dataSources.find(ds => ds.PartAssemblyAndType === pipelineDataSource.PartAssemblyAndType);\r\n      if (!dataSource) { continue; }\r\n\r\n      if (this.pipelineModel.Pipeline.AllowEdit) {\r\n        // WARNING! Must happen before instance.makeSource()\r\n        this.instance.draggable(domDataSource, {\r\n          grid: [20, 20], stop: (event: PlumbType) => {\r\n            const element: HTMLElement = event.el;\r\n            const pipelineDataSourceGuid: string = element.id.replace(dataSrcIdPrefix, '');\r\n            const position: VisualDesignerData = {\r\n              Top: event.finalPos[1],\r\n              Left: event.finalPos[0],\r\n            };\r\n            setTimeout(() => { this.onDragend(pipelineDataSourceGuid, position); });\r\n          }\r\n        });\r\n      }\r\n\r\n      // Add Out-Endpoints from Definition\r\n      dataSource.Out?.forEach(name => {\r\n        this.addEndpoint(domDataSource, name, false, pipelineDataSource);\r\n      });\r\n\r\n      // Add Out-Endpoints from Definition\r\n      dataSource.In?.forEach(name => {\r\n        this.addEndpoint(domDataSource, name, true, pipelineDataSource);\r\n      });\r\n\r\n      // Make DataSource a Target for new Endpoints (if .In is an Array)\r\n      if (dataSource.In) {\r\n        const targetEndpointUnlimited = this.buildTargetEndpoint();\r\n        targetEndpointUnlimited.maxConnections = -1;\r\n        this.instance.makeTarget(domDataSource, targetEndpointUnlimited);\r\n      }\r\n\r\n      if (dataSource.DynamicOut) {\r\n        this.instance.makeSource(domDataSource, this.buildSourceEndpoint(), { filter: '.add-endpoint .new-connection' });\r\n      }\r\n    }\r\n  }\r\n\r\n  /** Create wires */\r\n  private initWirings() {\r\n    this.pipelineModel.Pipeline.StreamWiring?.forEach(wire => {\r\n      // read connections from Pipeline\r\n      const sourceElementId = dataSrcIdPrefix + wire.From;\r\n      const fromUuid = sourceElementId + '_out_' + wire.Out;\r\n      const targetElementId = dataSrcIdPrefix + wire.To;\r\n      const toUuid = targetElementId + '_in_' + wire.In;\r\n\r\n      // Ensure In-Endpoint exist\r\n      if (!this.instance.getEndpoint(fromUuid)) {\r\n        const domDataSource: HTMLElement = this.jsPlumbRoot.querySelector('#' + sourceElementId);\r\n        const guid: string = domDataSource.id.replace(dataSrcIdPrefix, '');\r\n        const pipelineDataSource = this.pipelineModel.DataSources.find(pipeDataSource => pipeDataSource.EntityGuid === guid);\r\n        this.addEndpoint(domDataSource, wire.Out, false, pipelineDataSource);\r\n      }\r\n\r\n      // Ensure Out-Endpoint exist\r\n      if (!this.instance.getEndpoint(toUuid)) {\r\n        const domDataSource: HTMLElement = this.jsPlumbRoot.querySelector('#' + targetElementId);\r\n        const guid: string = domDataSource.id.replace(dataSrcIdPrefix, '');\r\n        const pipelineDataSource = this.pipelineModel.DataSources.find(pipeDataSource => pipeDataSource.EntityGuid === guid);\r\n        this.addEndpoint(domDataSource, wire.In, true, pipelineDataSource);\r\n      }\r\n\r\n      try {\r\n        this.instance.connect({\r\n          uuids: [fromUuid, toUuid],\r\n          paintStyle: this.nextLinePaintStyle(fromUuid),\r\n        });\r\n      } catch (e) {\r\n        console.error({ message: 'Connection failed', from: fromUuid, to: toUuid });\r\n      }\r\n    });\r\n  }\r\n\r\n  private addEndpoint(domDataSource: HTMLElement, name: string, isIn: boolean, pipelineDataSource: PipelineDataSource) {\r\n    const uuid = domDataSource.id + (isIn ? '_in_' : '_out_') + name;\r\n    const model = isIn ? this.buildTargetEndpoint() : this.buildSourceEndpoint();\r\n    // Endpoints on Out-DataSource must be always enabled\r\n    const params = { uuid, enabled: this.pipelineModel.Pipeline.AllowEdit || pipelineDataSource.EntityGuid === 'Out' };\r\n\r\n    const endPoint: PlumbType = this.instance.addEndpoint(domDataSource, model, params);\r\n    endPoint.getOverlay('endpointLabel').setLabel(name);\r\n  }\r\n\r\n  private buildSourceEndpoint() {\r\n    const sourceEndpoint = {\r\n      paintStyle: { fill: 'transparent', radius: 10 },\r\n      cssClass: 'sourceEndpoint',\r\n      maxConnections: -1,\r\n      isSource: true,\r\n      anchor: ['Continuous', { faces: ['top'] }],\r\n      overlays: this.getEndpointOverlays(true)\r\n    };\r\n    return sourceEndpoint;\r\n  }\r\n\r\n  private buildTargetEndpoint() {\r\n    const targetEndpoint = {\r\n      paintStyle: { fill: 'transparent', radius: 10 },\r\n      cssClass: 'targetEndpoint',\r\n      maxConnections: 1,\r\n      isTarget: true,\r\n      anchor: ['Continuous', { faces: ['bottom'] }],\r\n      overlays: this.getEndpointOverlays(false),\r\n      dropOptions: { hoverClass: 'hover', activeClass: 'active' }\r\n    };\r\n    return targetEndpoint;\r\n  }\r\n\r\n  private getEndpointOverlays(isSource: boolean) {\r\n    return [\r\n      [\r\n        'Label', {\r\n          id: 'endpointLabel',\r\n          // location: [0.5, isSource ? -0.5 : 1.5],\r\n          location: [0.5, isSource ? 0 : 1],\r\n          label: 'Default',\r\n          cssClass: 'noselect ' + (isSource ? 'endpointSourceLabel' : 'endpointTargetLabel'),\r\n          events: {\r\n            dblclick: (labelOverlay: PlumbType) => {\r\n              if (!this.pipelineModel.Pipeline.AllowEdit) { return; }\r\n\r\n              // spm NOTE: workaround for multiple dblclick listeners\r\n              if (labelOverlay.dblClickCounter == null || labelOverlay.dblClickCounter >= this.plumbInits) {\r\n                labelOverlay.dblClickCounter = 1;\r\n              } else {\r\n                labelOverlay.dblClickCounter++;\r\n              }\r\n              if (labelOverlay.dblClickCounter > 1) { return; }\r\n\r\n              const newLabel = prompt('Rename stream', labelOverlay.label);\r\n              if (!newLabel) { return; }\r\n              labelOverlay.setLabel(newLabel);\r\n              setTimeout(() => { this.onConnectionsChanged(); });\r\n            }\r\n          }\r\n        }\r\n      ]\r\n    ];\r\n  }\r\n\r\n  private bindEvents() {\r\n    // If connection on Out-DataSource was removed, remove custom Endpoint\r\n    this.instance.bind('connectionDetached', (info: PlumbType) => {\r\n      // spm TODO: custom endpoints were removed only on Out DataSource. Bug?\r\n      // if (info.targetId !== dataSrcIdPrefix + 'Out') { return; }\r\n      if (this.bulkDelete) { return; }\r\n      const domDataSource: HTMLElement = info.target;\r\n      const pipelineDataSource = this.pipelineModel.DataSources.find(\r\n        pipelineDS => pipelineDS.EntityGuid === domDataSource.id.replace(dataSrcIdPrefix, '')\r\n      );\r\n      const dataSource = this.dataSources.find(ds => ds.PartAssemblyAndType === pipelineDataSource.PartAssemblyAndType);\r\n      const fixedEndpoints = dataSource.In;\r\n      const label: string = info.targetEndpoint.getOverlay('endpointLabel').label;\r\n      if (fixedEndpoints.includes(label)) {\r\n        setTimeout(() => { this.onConnectionsChanged(); });\r\n        return;\r\n      }\r\n      this.instance.deleteEndpoint(info.targetEndpoint);\r\n      setTimeout(() => { this.onConnectionsChanged(); });\r\n    });\r\n\r\n    this.instance.bind('connection', (info: PlumbType) => {\r\n      if (info.sourceId === info.targetId) {\r\n        setTimeout(() => {\r\n          this.instance.deleteConnection(info.connection, { fireEvent: false });\r\n          setTimeout(() => { this.onConnectionsChanged(); });\r\n        });\r\n        return;\r\n      }\r\n      const endpointLabel: PlumbType = info.targetEndpoint.getOverlay('endpointLabel');\r\n      const labelPrompt: string = endpointLabel.getLabel();\r\n      const endpoints: PlumbType[] = this.instance.getEndpoints(info.target.id);\r\n      const targetEndpointHasSameLabel = endpoints.some(endpoint => {\r\n        const label: string = endpoint.getOverlay('endpointLabel').getLabel();\r\n        return label === labelPrompt &&\r\n          info.targetEndpoint.id !== endpoint.id &&\r\n          (endpoint.canvas as HTMLCanvasElement).classList.contains('targetEndpoint');\r\n      });\r\n      if (targetEndpointHasSameLabel) {\r\n        endpointLabel.setLabel(`PleaseRename${Math.floor(Math.random() * 99999)}`);\r\n      }\r\n      setTimeout(() => { this.onConnectionsChanged(); });\r\n    });\r\n  }\r\n\r\n}\r\n","export default \"<div class=\\\"editor-active-explorer fancy-scrollbar-dark\\\" *ngIf=\\\"(sorted$ | async) as sorted\\\">\\r\\n\\r\\n  <mat-slide-toggle labelPosition=\\\"before\\\" (change)=\\\"toggleDifficulty($event)\\\">\\r\\n    Show Advanced\\r\\n  </mat-slide-toggle>\\r\\n\\r\\n  <ng-container *ngFor=\\\"let item of sorted | keyvalue\\\">\\r\\n    <div class=\\\"collapsible\\\" [matTooltip]=\\\"item.key\\\" matTooltipShowDelay=\\\"750\\\" (click)=\\\"toggleItem(item.key)\\\">\\r\\n      <mat-icon>{{ toggledItems.includes(item.key) ? 'keyboard_arrow_down' : 'keyboard_arrow_right' }}</mat-icon>\\r\\n      <span>{{ item.key }}</span>\\r\\n    </div>\\r\\n\\r\\n    <div class=\\\"list\\\" *ngIf=\\\"toggledItems.includes(item.key)\\\">\\r\\n      <div class=\\\"list-item\\\" *ngFor=\\\"let value of item.value\\\" [matTooltip]=\\\"value.Name\\\" matTooltipShowDelay=\\\"750\\\"\\r\\n        (click)=\\\"addDataSource(value)\\\">\\r\\n        {{ value.Name }}\\r\\n      </div>\\r\\n    </div>\\r\\n  </ng-container>\\r\\n</div>\\r\\n\";","import { ChangeDetectionStrategy, Component, OnInit } from '@angular/core';\r\nimport { Observable } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\nimport { Context } from '../../shared/services/context';\r\nimport { PipelineModel } from '../models/pipeline.model';\r\nimport { VisualQueryService } from '../services/visual-query.service';\r\nimport { calculateWarnings } from './run-explorer.helpers';\r\n\r\n@Component({\r\n  selector: 'app-run-explorer',\r\n  templateUrl: './run-explorer.component.html',\r\n  styleUrls: ['./run-explorer.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class RunExplorerComponent implements OnInit {\r\n  pipelineModel$: Observable<PipelineModel>;\r\n  warnings$: Observable<string[]>;\r\n\r\n  constructor(private context: Context, private visualQueryService: VisualQueryService) { }\r\n\r\n  ngOnInit() {\r\n    this.pipelineModel$ = this.visualQueryService.pipelineModel$;\r\n    this.warnings$ = this.visualQueryService.pipelineModel$.pipe(\r\n      map(pipelineModel => calculateWarnings(pipelineModel, this.context)),\r\n    );\r\n  }\r\n\r\n  editPipeline() {\r\n    this.visualQueryService.editPipelineEntity();\r\n  }\r\n\r\n  openParamsHelp() {\r\n    window.open('https://r.2sxc.org/QueryParams', '_blank');\r\n  }\r\n\r\n  saveAndRunQuery(save: boolean, run: boolean) {\r\n    this.visualQueryService.saveAndRun(save, run);\r\n  }\r\n\r\n}\r\n","export default \".editor-side-toolbar {\\n  display: flex;\\n  flex-direction: column;\\n}\\n.editor-side-toolbar .spacer {\\n  flex-grow: 1;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByb2plY3RzL25nLWRpYWxvZ3Mvc3JjL2FwcC92aXN1YWwtcXVlcnkvdmlzdWFsLXF1ZXJ5LmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsYUFBQTtFQUNBLHNCQUFBO0FBQ0Y7QUFDRTtFQUNFLFlBQUE7QUFDSiIsImZpbGUiOiJwcm9qZWN0cy9uZy1kaWFsb2dzL3NyYy9hcHAvdmlzdWFsLXF1ZXJ5L3Zpc3VhbC1xdWVyeS5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5lZGl0b3Itc2lkZS10b29sYmFyIHtcclxuICBkaXNwbGF5OiBmbGV4O1xyXG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XHJcblxyXG4gIC5zcGFjZXIge1xyXG4gICAgZmxleC1ncm93OiAxO1xyXG4gIH1cclxufVxyXG4iXX0= */\";","\r\nexport * from './pipelines.service';\r\n","export default \".description {\\n  font-size: 14px;\\n}\\n\\npre {\\n  display: block;\\n  padding: 9.5px;\\n  margin: 0 0 10px;\\n  font-size: 13px;\\n  line-height: 1.42857143;\\n  color: #333;\\n  word-break: break-all;\\n  word-wrap: break-word;\\n  background-color: #f5f5f5;\\n  border: 1px solid #ccc;\\n  border-radius: 4px;\\n  overflow-x: auto;\\n}\\n\\nth {\\n  text-align: left;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByb2plY3RzL25nLWRpYWxvZ3Mvc3JjL2FwcC92aXN1YWwtcXVlcnkvcXVlcnktcmVzdWx0L3F1ZXJ5LXJlc3VsdC5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGVBQUE7QUFDRjs7QUFFQTtFQUNFLGNBQUE7RUFDQSxjQUFBO0VBQ0EsZ0JBQUE7RUFDQSxlQUFBO0VBQ0EsdUJBQUE7RUFDQSxXQUFBO0VBQ0EscUJBQUE7RUFDQSxxQkFBQTtFQUNBLHlCQUFBO0VBQ0Esc0JBQUE7RUFDQSxrQkFBQTtFQUNBLGdCQUFBO0FBQ0Y7O0FBRUE7RUFDRSxnQkFBQTtBQUNGIiwiZmlsZSI6InByb2plY3RzL25nLWRpYWxvZ3Mvc3JjL2FwcC92aXN1YWwtcXVlcnkvcXVlcnktcmVzdWx0L3F1ZXJ5LXJlc3VsdC5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5kZXNjcmlwdGlvbiB7XHJcbiAgZm9udC1zaXplOiAxNHB4O1xyXG59XHJcblxyXG5wcmUge1xyXG4gIGRpc3BsYXk6IGJsb2NrO1xyXG4gIHBhZGRpbmc6IDkuNXB4O1xyXG4gIG1hcmdpbjogMCAwIDEwcHg7XHJcbiAgZm9udC1zaXplOiAxM3B4O1xyXG4gIGxpbmUtaGVpZ2h0OiAxLjQyODU3MTQzO1xyXG4gIGNvbG9yOiAjMzMzO1xyXG4gIHdvcmQtYnJlYWs6IGJyZWFrLWFsbDtcclxuICB3b3JkLXdyYXA6IGJyZWFrLXdvcmQ7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogI2Y1ZjVmNTtcclxuICBib3JkZXI6IDFweCBzb2xpZCAjY2NjO1xyXG4gIGJvcmRlci1yYWRpdXM6IDRweDtcclxuICBvdmVyZmxvdy14OiBhdXRvO1xyXG59XHJcblxyXG50aCB7XHJcbiAgdGV4dC1hbGlnbjogbGVmdDtcclxufVxyXG4iXX0= */\";","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJwcm9qZWN0cy9uZy1kaWFsb2dzL3NyYy9hcHAvdmlzdWFsLXF1ZXJ5L3BsdW1iLWVkaXRvci9wbHVtYi1lZGl0b3IuY29tcG9uZW50LnNjc3MifQ== */\";","export default \".mat-slide-toggle {\\n  margin: 6px;\\n}\\n\\n.collapsible {\\n  display: flex;\\n  align-items: center;\\n  cursor: pointer;\\n  overflow: hidden;\\n  white-space: nowrap;\\n  -webkit-user-select: none;\\n     -moz-user-select: none;\\n          user-select: none;\\n  padding: 3px 0;\\n}\\n\\n.collapsible:hover {\\n  background-color: #2a2d2e;\\n}\\n\\n.collapsible .mat-icon {\\n  width: 18px;\\n  height: 18px;\\n  font-size: 18px;\\n}\\n\\n.list .list-item {\\n  cursor: pointer;\\n  padding: 4px 0 4px 24px;\\n  overflow: hidden;\\n  white-space: nowrap;\\n  text-overflow: ellipsis;\\n}\\n\\n.list .list-item:hover {\\n  background-color: #2a2d2e;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByb2plY3RzL25nLWRpYWxvZ3Mvc3JjL2FwcC92aXN1YWwtcXVlcnkvYWRkLWV4cGxvcmVyL2FkZC1leHBsb3Jlci5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLFdBQUE7QUFDRjs7QUFFQTtFQUNFLGFBQUE7RUFDQSxtQkFBQTtFQUNBLGVBQUE7RUFDQSxnQkFBQTtFQUNBLG1CQUFBO0VBQ0EseUJBQUE7S0FBQSxzQkFBQTtVQUFBLGlCQUFBO0VBQ0EsY0FBQTtBQUNGOztBQUNFO0VBQ0UseUJBQUE7QUFDSjs7QUFFRTtFQUNFLFdBQUE7RUFDQSxZQUFBO0VBQ0EsZUFBQTtBQUFKOztBQUlBO0VBQ0UsZUFBQTtFQUNBLHVCQUFBO0VBQ0EsZ0JBQUE7RUFDQSxtQkFBQTtFQUNBLHVCQUFBO0FBREY7O0FBR0U7RUFDRSx5QkFBQTtBQURKIiwiZmlsZSI6InByb2plY3RzL25nLWRpYWxvZ3Mvc3JjL2FwcC92aXN1YWwtcXVlcnkvYWRkLWV4cGxvcmVyL2FkZC1leHBsb3Jlci5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5tYXQtc2xpZGUtdG9nZ2xlIHtcclxuICBtYXJnaW46IDZweDtcclxufVxyXG5cclxuLmNvbGxhcHNpYmxlIHtcclxuICBkaXNwbGF5OiBmbGV4O1xyXG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XHJcbiAgY3Vyc29yOiBwb2ludGVyO1xyXG4gIG92ZXJmbG93OiBoaWRkZW47XHJcbiAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcclxuICB1c2VyLXNlbGVjdDogbm9uZTtcclxuICBwYWRkaW5nOiAzcHggMDtcclxuXHJcbiAgJjpob3ZlciB7XHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2IoNDIsIDQ1LCA0Nik7XHJcbiAgfVxyXG5cclxuICAubWF0LWljb24ge1xyXG4gICAgd2lkdGg6IDE4cHg7XHJcbiAgICBoZWlnaHQ6IDE4cHg7XHJcbiAgICBmb250LXNpemU6IDE4cHg7XHJcbiAgfVxyXG59XHJcblxyXG4ubGlzdCAubGlzdC1pdGVtIHtcclxuICBjdXJzb3I6IHBvaW50ZXI7XHJcbiAgcGFkZGluZzogNHB4IDAgNHB4IDI0cHg7XHJcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcclxuICB3aGl0ZS1zcGFjZTogbm93cmFwO1xyXG4gIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzO1xyXG5cclxuICAmOmhvdmVyIHtcclxuICAgIGJhY2tncm91bmQtY29sb3I6IHJnYig0MiwgNDUsIDQ2KTtcclxuICB9XHJcbn1cclxuIl19 */\";","import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { edit } from '../../../../edit/edit.matcher';\r\nimport { VisualQueryComponent } from './visual-query.component';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '', component: VisualQueryComponent, children: [\r\n      {\r\n        matcher: edit,\r\n        loadChildren: () => import('../../../../edit/edit.module').then(m => m.EditModule),\r\n        data: { history: false },\r\n      },\r\n    ]\r\n  },\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class VisualQueryRoutingModule { }\r\n","export default \"<router-outlet></router-outlet>\\r\\n\\r\\n<div class=\\\"editor-root\\\">\\r\\n  <div class=\\\"editor-side-toolbar\\\">\\r\\n    <div class=\\\"button\\\" matTooltip=\\\"Run\\\" [ngClass]=\\\"{ 'active': activeExplorer === explorer.run }\\\"\\r\\n      (click)=\\\"toggleExplorer(explorer.run)\\\">\\r\\n      <mat-icon>play_arrow</mat-icon>\\r\\n    </div>\\r\\n    <div class=\\\"button\\\" matTooltip=\\\"Add\\\" [ngClass]=\\\"{ 'active': activeExplorer === explorer.add }\\\"\\r\\n      (click)=\\\"toggleExplorer(explorer.add)\\\">\\r\\n      <mat-icon>add</mat-icon>\\r\\n    </div>\\r\\n    <div class=\\\"spacer\\\"></div>\\r\\n    <div class=\\\"button\\\" matTooltip=\\\"Help\\\" (click)=\\\"openHelp()\\\">\\r\\n      <mat-icon>help_outline</mat-icon>\\r\\n    </div>\\r\\n  </div>\\r\\n\\r\\n  <app-run-explorer [hidden]=\\\"activeExplorer !== explorer.run\\\"></app-run-explorer>\\r\\n\\r\\n  <app-add-explorer [hidden]=\\\"activeExplorer !== explorer.add\\\"></app-add-explorer>\\r\\n\\r\\n  <app-plumb-editor></app-plumb-editor>\\r\\n</div>\\r\\n\";","// tslint:disable-next-line:max-line-length\r\nimport { AfterViewInit, ChangeDetectionStrategy, ChangeDetectorRef, Component, ElementRef, OnDestroy, OnInit, QueryList, ViewChild, ViewChildren } from '@angular/core';\r\nimport { BehaviorSubject, combineLatest, Observable, Subscription } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\nimport { loadScripts } from '../../shared/helpers/load-scripts.helper';\r\nimport { PipelineDataSource, VisualDesignerData } from '../models/pipeline.model';\r\nimport { QueryDefinitionService } from '../services/query-definition.service';\r\nimport { VisualQueryService } from '../services/visual-query.service';\r\nimport { calculateTypeInfos } from './plumb-editor.helpers';\r\nimport { PlumbEditorTemplateModel } from './plumb-editor.models';\r\nimport { dataSrcIdPrefix, Plumber } from './plumber.helper';\r\n\r\nconst jsPlumbUrl = 'https://cdnjs.cloudflare.com/ajax/libs/jsPlumb/2.14.5/js/jsplumb.min.js';\r\n\r\n@Component({\r\n  selector: 'app-plumb-editor',\r\n  templateUrl: './plumb-editor.component.html',\r\n  styles: [':host { display: block; width: 100%; height: 100%; }'],\r\n  styleUrls: ['./plumb-editor.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class PlumbEditorComponent implements OnInit, AfterViewInit, OnDestroy {\r\n  @ViewChild('domRoot') private domRootRef: ElementRef<HTMLDivElement>;\r\n  @ViewChildren('domDataSource') private domDataSourcesRef: QueryList<ElementRef<HTMLDivElement>>;\r\n\r\n  dataSrcIdPrefix = dataSrcIdPrefix;\r\n  templateModel$: Observable<PlumbEditorTemplateModel>;\r\n  hardReset = false;\r\n\r\n  private plumber: Plumber;\r\n  private scriptLoaded$ = new BehaviorSubject(false);\r\n  private subscription = new Subscription();\r\n  private plumbInits = 0;\r\n\r\n  constructor(\r\n    private visualQueryService: VisualQueryService,\r\n    private queryDefinitionService: QueryDefinitionService,\r\n    private changeDetectorRef: ChangeDetectorRef,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    loadScripts([{ test: 'jsPlumb', src: jsPlumbUrl }], () => {\r\n      this.scriptLoaded$.next(true);\r\n    });\r\n\r\n    this.subscription.add(\r\n      this.visualQueryService.putEntityCountOnConnections$.subscribe(result => {\r\n        this.plumber.putEntityCountOnConnections(result);\r\n      })\r\n    );\r\n\r\n    this.templateModel$ = combineLatest([this.visualQueryService.pipelineModel$, this.visualQueryService.dataSources$]).pipe(\r\n      map(([pipelineModel, dataSources]) => {\r\n        if (pipelineModel == null || dataSources == null) { return; }\r\n\r\n        // workaround for jsPlumb not working with dom elements which it initialized on previously.\r\n        // This wipes dom entirely and gives us new elements\r\n        this.hardReset = true;\r\n        this.changeDetectorRef.detectChanges();\r\n        this.hardReset = false;\r\n        const templateModel: PlumbEditorTemplateModel = {\r\n          pipelineDataSources: pipelineModel.DataSources,\r\n          typeInfos: calculateTypeInfos(pipelineModel.DataSources, dataSources),\r\n          allowEdit: pipelineModel.Pipeline.AllowEdit,\r\n        };\r\n        return templateModel;\r\n      }),\r\n    );\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    // https://stackoverflow.com/questions/37087864/execute-a-function-when-ngfor-finished-in-angular-2/37088348#37088348\r\n    const domDataSourcesLoaded$ = this.domDataSourcesRef.changes.pipe(map(() => true));\r\n\r\n    this.subscription.add(\r\n      combineLatest([this.scriptLoaded$, domDataSourcesLoaded$]).subscribe(([scriptLoaded, domDataSourcesLoaded]) => {\r\n        if (!scriptLoaded || !domDataSourcesLoaded) { return; }\r\n\r\n        this.plumber?.destroy();\r\n        this.plumber = new Plumber(\r\n          this.domRootRef.nativeElement,\r\n          this.visualQueryService.pipelineModel$.value,\r\n          this.visualQueryService.dataSources$.value,\r\n          this.onConnectionsChanged.bind(this),\r\n          this.onDragend.bind(this),\r\n          ++this.plumbInits,\r\n        );\r\n      })\r\n    );\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.plumber?.destroy();\r\n    this.scriptLoaded$.complete();\r\n    this.subscription.unsubscribe();\r\n  }\r\n\r\n  onConnectionsChanged() {\r\n    const connections = this.plumber.getAllConnections();\r\n    const streamsOut = this.plumber.getStreamsOut();\r\n    this.visualQueryService.changeConnections(connections, streamsOut);\r\n  }\r\n\r\n  onDragend(pipelineDataSourceGuid: string, position: VisualDesignerData) {\r\n    this.visualQueryService.changeDataSourcePosition(pipelineDataSourceGuid, position);\r\n  }\r\n\r\n  configureDataSource(dataSource: PipelineDataSource) {\r\n    // ensure dataSource entity is saved\r\n    if (dataSource.EntityGuid.includes('unsaved')) {\r\n      this.visualQueryService.saveAndRun(true, false);\r\n    } else {\r\n      this.visualQueryService.editDataSource(dataSource);\r\n    }\r\n  }\r\n\r\n  typeNameFilter(input: string, format: string) {\r\n    const filtered = this.queryDefinitionService.typeNameFilter(input, format);\r\n    return filtered;\r\n  }\r\n\r\n  remove(pipelineDataSource: PipelineDataSource) {\r\n    if (!confirm(`Delete ${pipelineDataSource.Name} data source?`)) { return; }\r\n\r\n    this.plumber.removeEndpointsOnDataSource(pipelineDataSource.EntityGuid);\r\n    const connections = this.plumber.getAllConnections();\r\n    const streamsOut = this.plumber.getStreamsOut();\r\n    this.visualQueryService.removeDataSource(pipelineDataSource.EntityGuid, connections, streamsOut);\r\n  }\r\n\r\n  editName(dataSource: PipelineDataSource) {\r\n    const newName = prompt('Rename data source', dataSource.Name)?.trim();\r\n    if (newName == null || newName === '') { return; }\r\n\r\n    this.visualQueryService.renameDataSource(dataSource.EntityGuid, newName);\r\n  }\r\n\r\n  editDescription(dataSource: PipelineDataSource) {\r\n    const newDescription = prompt('Edit description', dataSource.Description)?.trim();\r\n    if (newDescription == null) { return; }\r\n\r\n    this.visualQueryService.changeDataSourceDescription(dataSource.EntityGuid, newDescription);\r\n  }\r\n\r\n}\r\n"],"sourceRoot":"webpack:///"}