{"version":3,"sources":["./src/app/manage-content-list/manage-content-list.component.html","./src/app/manage-content-list/manage-content-list-routing.module.ts","./src/app/manage-content-list/manage-content-list.component.ts","./src/app/manage-content-list/manage-content-list-dialog.config.ts","./src/app/manage-content-list/manage-content-list.module.ts","./src/app/manage-content-list/manage-content-list.component.scss"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAe,8kBAA+gB,qBAAqB,6hBAA6hB,6QAA6Q,cAAc,IAAI,WAAW,oBAAoB,cAAc,IAAI,WAAW,+gBAA+gB,E;;;;;;;;;;;;;;;;;;;;;ACAj5D;AACc;AACW;AAC8B;AAClB;AAE9E,IAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,EAAE,EAAE,SAAS,EAAE,2GAAoB,EAAE,IAAI,EAAE,EAAE,MAAM,EAAE,0FAAuB,EAAE;QAAE,QAAQ,EAAE;YAC9F;gBACE,OAAO,EAAE,uDAAI;gBACb,YAAY,EAAE,cAAM,8wDAAsC,CAAC,IAAI,CAAC,WAAC,IAAI,QAAC,CAAC,UAAU,EAAZ,CAAY,CAAC,EAA9D,CAA8D;aACnF;YACD;gBACE,OAAO,EAAE,8DAAW;gBACpB,YAAY,EAAE,cAAM,2OAA8C,CAAC,IAAI,CAAC,WAAC,IAAI,QAAC,CAAC,iBAAiB,EAAnB,CAAmB,CAAC,EAA7E,CAA6E;aAClG;SACF;KACF;CACF,CAAC;;;IAM4C,CAAC;IAAlC,8BAA8B;QAJ1C,8DAAQ,CAAC;YACR,OAAO,EAAE,CAAC,4DAAY,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;YACxC,OAAO,EAAE,CAAC,4DAAY,CAAC;SACxB,CAAC;OACW,8BAA8B,CAAI;IAAD,qCAAC;CAAA;AAAJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzB2B;AAC6B;AAC3C;AACE;AACc;AACJ;AACF;AACG;AAIE;;IA0BrE,oCACU,SAAmD,EACnD,mBAAwC,EACxC,KAAqB,EACrB,MAAc,EACd,QAAqB;QAJrB,cAAS,GAAT,SAAS,CAA0C;QACnD,wBAAmB,GAAnB,mBAAmB,CAAqB;QACxC,UAAK,GAAL,KAAK,CAAgB;QACrB,WAAM,GAAN,MAAM,CAAQ;QACd,aAAQ,GAAR,QAAQ,CAAa;QAtBL,cAAS,GAAG,kBAAkB,CAAC;QAEjD,WAAM,GAAG,IAAI,oDAAe,CAAgB,IAAI,CAAC,CAAC;QAClD,YAAO,GAAG,IAAI,oDAAe,CAAc,IAAI,CAAC,CAAC;QACzD,kBAAa,GAAG,0DAAa,CAAC,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,CAC7D,0DAAG,CAAC,UAAC,EAAe;gBAAf,gEAAe,EAAd,KAAK,UAAE,MAAM;YAAM,QAAC,EAAE,KAAK,SAAE,MAAM,UAAE,CAAC;QAAnB,CAAmB,CAAC,CAC9C,CAAC;QAEM,iBAAY,GAAiB;YACnC,EAAE,EAAE,IAAI;YACR,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,GAAG,CAAC,MAAM,CAAC;YAC9C,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,GAAG,CAAC,MAAM,CAAC;YAC9C,KAAK,EAAE,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE,EAAE,CAAC;SAC/D,CAAC;QACM,cAAS,GAAG,KAAK,CAAC;QAClB,iBAAY,GAAG,IAAI,iDAAY,EAAE,CAAC;IAQtC,CAAC;IAEL,6CAAQ,GAAR;QACE,IAAI,CAAC,SAAS,EAAE,CAAC;QACjB,IAAI,CAAC,WAAW,EAAE,CAAC;QACnB,IAAI,CAAC,oBAAoB,EAAE,CAAC;IAC9B,CAAC;IAED,gDAAW,GAAX;QACE,IAAI,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAC;QACvB,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC;QACxB,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC;IAClC,CAAC;IAED,gDAAW,GAAX;QACE,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC;IACzB,CAAC;IAED,6CAAQ,GAAR;QAAA,iBAMC;QALC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;QAChC,IAAI,CAAC,mBAAmB,CAAC,QAAQ,CAAC,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,SAAS,CAAC,aAAG;YACnF,KAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YAC5B,KAAI,CAAC,WAAW,EAAE,CAAC;QACrB,CAAC,CAAC,CAAC;IACL,CAAC;IAED,+CAAU,GAAV;QACE,IAAM,IAAI,GAAa;YACrB,KAAK,EAAE;gBACL;oBACE,KAAK,EAAE;wBACL,IAAI,EAAE,IAAI,CAAC,YAAY,CAAC,IAAI;wBAC5B,KAAK,EAAE,CAAC;wBACR,IAAI,EAAE,aAAa;wBACnB,GAAG,EAAE,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE,KAAK,CAAC;qBACjC;iBACF;gBACD;oBACE,KAAK,EAAE;wBACL,IAAI,EAAE,IAAI,CAAC,YAAY,CAAC,IAAI;wBAC5B,KAAK,EAAE,CAAC;wBACR,IAAI,EAAE,kBAAkB;wBACxB,GAAG,EAAE,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE,KAAK,CAAC;qBACjC;iBACF;aACF;SACF,CAAC;QACF,IAAM,OAAO,GAAG,yFAAgB,CAAC,IAAI,CAAC,CAAC;QACvC,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,UAAQ,OAAS,CAAC,EAAE,EAAE,UAAU,EAAE,IAAI,CAAC,KAAK,EAAE,CAAC,CAAC;IACxE,CAAC;IAED,6CAAQ,GAAR,UAAS,EAAU;QACjB,IAAM,IAAI,GAAa;YACrB,KAAK,EAAE,CAAC,EAAE,QAAQ,EAAE,EAAE,EAAE,CAAC;SAC1B,CAAC;QACF,IAAM,OAAO,GAAG,yFAAgB,CAAC,IAAI,CAAC,CAAC;QACvC,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,UAAQ,OAAS,CAAC,EAAE,EAAE,UAAU,EAAE,IAAI,CAAC,KAAK,EAAE,CAAC,CAAC;IACxE,CAAC;IAED,yCAAI,GAAJ,UAAK,KAAyB;QAC5B,IAAM,KAAK,GAAG,uDAAI,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;QACrC,8EAAe,CAAC,KAAK,EAAE,KAAK,CAAC,aAAa,EAAE,KAAK,CAAC,YAAY,CAAC,CAAC;QAChE,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACxB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;IACxB,CAAC;IAED,8CAAS,GAAT,UAAU,KAAa,EAAE,IAAiB;QACxC,4DAA4D;QAC5D,OAAU,IAAI,CAAC,KAAK,SAAI,IAAI,CAAC,EAAI,CAAC;IACpC,CAAC;IAEO,8CAAS,GAAjB;QAAA,iBAmBC;QAlBC,IAAI,CAAC,mBAAmB,CAAC,OAAO,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,SAAS,CAAC,eAAK;YACjE,IAAI,KAAI,CAAC,SAAS,EAAE;gBAClB,IAAM,QAAM,GAAG,KAAI,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,cAAI,IAAI,WAAI,CAAC,EAAE,EAAP,CAAO,CAAC,CAAC;gBACtD,IAAM,UAAU,GAAG,KAAI,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,KAAK,KAAK,CAAC,MAAM,IAAI,KAAK,CAAC,IAAI,CAAC,cAAI,IAAI,QAAC,QAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC,EAAzB,CAAyB,CAAC,CAAC;gBAC9G,IAAI,CAAC,UAAU,EAAE;oBACf,IAAM,WAAS,GAAG,KAAI,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,cAAI,IAAI,WAAI,CAAC,KAAK,EAAV,CAAU,CAAC,CAAC;oBAC5D,KAAK,CAAC,IAAI,CAAC,UAAC,CAAC,EAAE,CAAC;wBACd,IAAM,MAAM,GAAG,WAAS,CAAC,OAAO,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;wBAC1C,IAAM,MAAM,GAAG,WAAS,CAAC,OAAO,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;wBAC1C,IAAI,MAAM,KAAK,CAAC,CAAC,IAAI,MAAM,KAAK,CAAC,CAAC,EAAE;4BAAE,OAAO,CAAC,CAAC;yBAAE;wBACjD,OAAO,MAAM,GAAG,MAAM,CAAC;oBACzB,CAAC,CAAC,CAAC;iBACJ;qBAAM;oBACL,KAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,+DAA+D,EAAE,IAAI,EAAE,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC,CAAC;iBAC/G;aACF;YACD,KAAI,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAC1B,CAAC,CAAC,CAAC;IACL,CAAC;IAEO,gDAAW,GAAnB;QAAA,iBAIC;QAHC,IAAI,CAAC,mBAAmB,CAAC,SAAS,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,SAAS,CAAC,gBAAM;YACpE,KAAI,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QAC5B,CAAC,CAAC,CAAC;IACL,CAAC;IAEO,yDAAoB,GAA5B;QAAA,iBAaC;QAZC,IAAI,CAAC,YAAY,CAAC,GAAG,CACnB,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CACrB,6DAAM,CAAC,eAAK,IAAI,YAAK,YAAY,6DAAa,EAA9B,CAA8B,CAAC,EAC/C,gEAAS,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,UAAU,CAAC,EAC3C,0DAAG,CAAC,cAAM,QAAC,CAAC,KAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,UAAU,EAAhC,CAAgC,CAAC,EAC3C,+DAAQ,EAAE,EACV,6DAAM,CAAC,UAAC,EAAoB;gBAApB,gEAAoB,EAAnB,QAAQ,UAAE,QAAQ;YAAM,eAAQ,IAAI,CAAC,QAAQ;QAArB,CAAqB,CAAC,CACxD,CAAC,SAAS,CAAC;YACV,KAAI,CAAC,SAAS,EAAE,CAAC;YACjB,KAAI,CAAC,WAAW,EAAE,CAAC;QACrB,CAAC,CAAC,CACH,CAAC;IACJ,CAAC;;gBAxJM,qEAAY;gBASZ,oFAAmB;gBAPnB,8DAAc;gBAAiB,sDAAM;gBADrC,uEAAW;;;4BAiBjB,yDAAW,SAAC,WAAW;;IADb,0BAA0B;QANtC,+DAAS,CAAC;YACT,QAAQ,EAAE,yBAAyB;YACnC,gGAAmD;YAEnD,eAAe,EAAE,qEAAuB,CAAC,MAAM;;SAChD,CAAC;uFAoBqB,qEAAY;YACF,oFAAmB;YACjC,8DAAc;YACb,sDAAM;YACJ,uEAAW;OAvBpB,0BAA0B,CAyItC;IAAD,iCAAC;CAAA;AAzIsC;;;;;;;;;;;;;;;;;ACjBhC,IAAM,uBAAuB,GAAiB;IACnD,IAAI,EAAE,4BAA4B;IAClC,WAAW,EAAE,IAAI;IACjB,SAAS,EAAE,OAAO;IAClB,UAAU,EAAE,IAAI;IAEV,YAAY;;;;;4BACuB,qBAAM,oHAAyC;;wBAA9E,0BAA0B,GAAK,UAA+C,4BAApD;wBAClC,sBAAO,0BAA0B,EAAC;;;;KACnC;CACF,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACZsD;AACT;AACN;AACkB;AACA;AACJ;AACS;AACH;AACR;AACuB;AACU;AACT;AACN;;;IAyBhC,CAAC;IAA3B,uBAAuB;QAvBnC,8DAAQ,CAAC;YACR,YAAY,EAAE;gBACZ,0FAA0B;aAC3B;YACD,eAAe,EAAE;gBACf,0FAA0B;aAC3B;YACD,OAAO,EAAE;gBACP,4DAAY;gBACZ,mGAA8B;gBAC9B,wFAAsB;gBACtB,wEAAe;gBACf,wEAAe;gBACf,oEAAa;gBACb,0EAAgB;gBAChB,qEAAc;gBACd,6EAAiB;aAClB;YACD,SAAS,EAAE;gBACT,gEAAO;gBACP,oFAAmB;aACpB;SACF,CAAC;OACW,uBAAuB,CAAI;IAAD,8BAAC;CAAA;AAAJ;;;;;;;;;;;;;ACrCpC;AAAe,6EAAc,sBAAsB,GAAG,eAAe,mBAAmB,2BAA2B,uBAAuB,qBAAqB,GAAG,eAAe,iBAAiB,iBAAiB,kCAAkC,mBAAmB,kBAAkB,wBAAwB,mCAAmC,sBAAsB,2BAA2B,oBAAoB,GAAG,0BAA0B,iBAAiB,GAAG,sBAAsB,kBAAkB,wBAAwB,qBAAqB,GAAG,2BAA2B,sBAAsB,iBAAiB,GAAG,2BAA2B,qBAAqB,4BAA4B,wBAAwB,GAAG,uBAAuB,2BAA2B,uBAAuB,0HAA0H,GAAG,2BAA2B,eAAe,GAAG,yBAAyB,2DAA2D,GAAG,2EAA2E,2DAA2D,GAAG,6CAA6C,unFAAunF,E","file":"manage-content-list-manage-content-list-module.js","sourcesContent":["export default \"<div mat-dialog-title>\\r\\n  <div class=\\\"dialog-title-box\\\">Manage content-item lists</div>\\r\\n</div>\\r\\n\\r\\n<router-outlet></router-outlet>\\r\\n\\r\\n<div class=\\\"dialog-component-content fancy-scrollbar-light\\\" *ngIf=\\\"(templateVars$ | async) as data\\\">\\r\\n  <ng-container *ngIf=\\\"data.header\\\">\\r\\n    <p class=\\\"dialog-description\\\">\\r\\n      You can manage the list header here (if it is defined):\\r\\n    </p>\\r\\n\\r\\n    <p class=\\\"dialog-description\\\">\\r\\n      <ng-container *ngIf=\\\"data.header.Type\\\">\\r\\n        <span>{{ data.header.Title }}</span>\\r\\n        <button mat-icon-button matTooltip=\\\"Edit header\\\" (click)=\\\"editHeader()\\\">\\r\\n          <mat-icon>edit</mat-icon>\\r\\n        </button>\\r\\n      </ng-container>\\r\\n      <ng-container *ngIf=\\\"!data.header.Type\\\">(this list has no header)</ng-container>\\r\\n    </p>\\r\\n  </ng-container>\\r\\n\\r\\n  <p class=\\\"dialog-description sort-title\\\">Sort the items by dragging as you need, then save:</p>\\r\\n\\r\\n  <div class=\\\"dnd-list\\\" cdkDropList (cdkDropListDropped)=\\\"drop($event)\\\">\\r\\n    <div *ngFor=\\\"let item of data.items; trackBy: trackByFn\\\" class=\\\"dnd-item\\\" cdkDrag>\\r\\n      <div class=\\\"dnd-item__title\\\">\\r\\n        <mat-icon class=\\\"dnd-item__title-icon\\\" matTooltip=\\\"Drag to reorder the list\\\">drag_handle</mat-icon>\\r\\n        <span class=\\\"dnd-item__title-text\\\" matTooltip=\\\"{{ item.Title }} ({{ item.Id }})\\\">\\r\\n          {{ item.Title }} ({{ item.Id }})\\r\\n        </span>\\r\\n      </div>\\r\\n      <div *ngIf=\\\"item.Id !== 0\\\">\\r\\n        <button mat-icon-button matTooltip=\\\"Edit item\\\" appMousedownStopPropagation (click)=\\\"editItem(item.Id)\\\">\\r\\n          <mat-icon>edit</mat-icon>\\r\\n        </button>\\r\\n      </div>\\r\\n    </div>\\r\\n  </div>\\r\\n</div>\\r\\n\\r\\n<div class=\\\"dialog-component-actions\\\">\\r\\n  <button mat-raised-button (click)=\\\"closeDialog()\\\">Cancel</button>\\r\\n  <button mat-raised-button color=\\\"accent\\\" (click)=\\\"saveList()\\\">Save</button>\\r\\n</div>\\r\\n\";","import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { edit, refreshEdit } from '../../../../edit/edit.matcher';\r\nimport { DialogEntryComponent } from '../shared/components/dialog-entry/dialog-entry.component';\r\nimport { manageContentListDialog } from './manage-content-list-dialog.config';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '', component: DialogEntryComponent, data: { dialog: manageContentListDialog }, children: [\r\n      {\r\n        matcher: edit,\r\n        loadChildren: () => import('../../../../edit/edit.module').then(m => m.EditModule)\r\n      },\r\n      {\r\n        matcher: refreshEdit,\r\n        loadChildren: () => import('../../../../edit/refresh-edit.module').then(m => m.RefreshEditModule)\r\n      },\r\n    ]\r\n  },\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class ManageContentListRoutingModule { }\r\n","import { CdkDragDrop, moveItemInArray } from '@angular/cdk/drag-drop';\r\nimport { ChangeDetectionStrategy, Component, HostBinding, OnDestroy, OnInit } from '@angular/core';\r\nimport { MatDialogRef } from '@angular/material/dialog';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { ActivatedRoute, NavigationEnd, Router } from '@angular/router';\r\nimport { BehaviorSubject, combineLatest, Subscription } from 'rxjs';\r\nimport { filter, map, pairwise, startWith } from 'rxjs/operators';\r\nimport { convertFormToUrl } from '../shared/helpers/url-prep.helper';\r\nimport { EditForm } from '../shared/models/edit-form.model';\r\nimport { ContentGroup } from './models/content-group.model';\r\nimport { GroupHeader } from './models/group-header.model';\r\nimport { ContentGroupService } from './services/content-group.service';\r\n\r\n@Component({\r\n  selector: 'app-manage-content-list',\r\n  templateUrl: './manage-content-list.component.html',\r\n  styleUrls: ['./manage-content-list.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class ManageContentListComponent implements OnInit, OnDestroy {\r\n  @HostBinding('className') hostClass = 'dialog-component';\r\n\r\n  private items$ = new BehaviorSubject<GroupHeader[]>(null);\r\n  private header$ = new BehaviorSubject<GroupHeader>(null);\r\n  templateVars$ = combineLatest([this.items$, this.header$]).pipe(\r\n    map(([items, header]) => ({ items, header })),\r\n  );\r\n\r\n  private contentGroup: ContentGroup = {\r\n    id: null,\r\n    guid: this.route.snapshot.paramMap.get('guid'),\r\n    part: this.route.snapshot.paramMap.get('part'),\r\n    index: parseInt(this.route.snapshot.paramMap.get('index'), 10),\r\n  };\r\n  private reordered = false;\r\n  private subscription = new Subscription();\r\n\r\n  constructor(\r\n    private dialogRef: MatDialogRef<ManageContentListComponent>,\r\n    private contentGroupService: ContentGroupService,\r\n    private route: ActivatedRoute,\r\n    private router: Router,\r\n    private snackBar: MatSnackBar,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.fetchList();\r\n    this.fetchHeader();\r\n    this.refreshOnChildClosed();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.items$.complete();\r\n    this.header$.complete();\r\n    this.subscription.unsubscribe();\r\n  }\r\n\r\n  closeDialog() {\r\n    this.dialogRef.close();\r\n  }\r\n\r\n  saveList() {\r\n    this.snackBar.open('Saving...');\r\n    this.contentGroupService.saveList(this.contentGroup, this.items$.value).subscribe(res => {\r\n      this.snackBar.open('Saved');\r\n      this.closeDialog();\r\n    });\r\n  }\r\n\r\n  editHeader() {\r\n    const form: EditForm = {\r\n      items: [\r\n        {\r\n          Group: {\r\n            Guid: this.contentGroup.guid,\r\n            Index: 0,\r\n            Part: 'listcontent',\r\n            Add: this.header$.value.Id === 0,\r\n          },\r\n        },\r\n        {\r\n          Group: {\r\n            Guid: this.contentGroup.guid,\r\n            Index: 0,\r\n            Part: 'listpresentation',\r\n            Add: this.header$.value.Id === 0,\r\n          },\r\n        },\r\n      ],\r\n    };\r\n    const formUrl = convertFormToUrl(form);\r\n    this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route });\r\n  }\r\n\r\n  editItem(id: number) {\r\n    const form: EditForm = {\r\n      items: [{ EntityId: id }],\r\n    };\r\n    const formUrl = convertFormToUrl(form);\r\n    this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route });\r\n  }\r\n\r\n  drop(event: CdkDragDrop<any[]>) {\r\n    const items = [...this.items$.value];\r\n    moveItemInArray(items, event.previousIndex, event.currentIndex);\r\n    this.items$.next(items);\r\n    this.reordered = true;\r\n  }\r\n\r\n  trackByFn(index: number, item: GroupHeader) {\r\n    // we use both Index and Id because all demo items have Id=0\r\n    return `${item.Index}+${item.Id}`;\r\n  }\r\n\r\n  private fetchList() {\r\n    this.contentGroupService.getList(this.contentGroup).subscribe(items => {\r\n      if (this.reordered) {\r\n        const oldIds = this.items$.value.map(item => item.Id);\r\n        const idsChanged = this.items$.value.length !== items.length || items.some(item => !oldIds.includes(item.Id));\r\n        if (!idsChanged) {\r\n          const sortOrder = this.items$.value.map(item => item.Index);\r\n          items.sort((a, b) => {\r\n            const aIndex = sortOrder.indexOf(a.Index);\r\n            const bIndex = sortOrder.indexOf(b.Index);\r\n            if (aIndex === -1 || bIndex === -1) { return 0; }\r\n            return aIndex - bIndex;\r\n          });\r\n        } else {\r\n          this.snackBar.open('List was changed from somewhere else. Order of items is reset', null, { duration: 5000 });\r\n        }\r\n      }\r\n      this.items$.next(items);\r\n    });\r\n  }\r\n\r\n  private fetchHeader() {\r\n    this.contentGroupService.getHeader(this.contentGroup).subscribe(header => {\r\n      this.header$.next(header);\r\n    });\r\n  }\r\n\r\n  private refreshOnChildClosed() {\r\n    this.subscription.add(\r\n      this.router.events.pipe(\r\n        filter(event => event instanceof NavigationEnd),\r\n        startWith(!!this.route.snapshot.firstChild),\r\n        map(() => !!this.route.snapshot.firstChild),\r\n        pairwise(),\r\n        filter(([hadChild, hasChild]) => hadChild && !hasChild),\r\n      ).subscribe(() => {\r\n        this.fetchList();\r\n        this.fetchHeader();\r\n      })\r\n    );\r\n  }\r\n\r\n}\r\n","import { DialogConfig } from '../shared/models/dialog-config.model';\r\n\r\nexport const manageContentListDialog: DialogConfig = {\r\n  name: 'MANAGE_CONTENT_LIST_DIALOG',\r\n  initContext: true,\r\n  panelSize: 'small',\r\n  panelClass: null,\r\n\r\n  async getComponent() {\r\n    const { ManageContentListComponent } = await import('./manage-content-list.component');\r\n    return ManageContentListComponent;\r\n  }\r\n};\r\n","import { DragDropModule } from '@angular/cdk/drag-drop';\r\nimport { CommonModule } from '@angular/common';\r\nimport { NgModule } from '@angular/core';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatDialogModule } from '@angular/material/dialog';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatSnackBarModule } from '@angular/material/snack-bar';\r\nimport { MatTooltipModule } from '@angular/material/tooltip';\r\nimport { Context } from '../shared/services/context';\r\nimport { SharedComponentsModule } from '../shared/shared-components.module';\r\nimport { ManageContentListRoutingModule } from './manage-content-list-routing.module';\r\nimport { ManageContentListComponent } from './manage-content-list.component';\r\nimport { ContentGroupService } from './services/content-group.service';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    ManageContentListComponent,\r\n  ],\r\n  entryComponents: [\r\n    ManageContentListComponent,\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    ManageContentListRoutingModule,\r\n    SharedComponentsModule,\r\n    MatDialogModule,\r\n    MatButtonModule,\r\n    MatIconModule,\r\n    MatTooltipModule,\r\n    DragDropModule,\r\n    MatSnackBarModule,\r\n  ],\r\n  providers: [\r\n    Context,\r\n    ContentGroupService,\r\n  ]\r\n})\r\nexport class ManageContentListModule { }\r\n","export default \".sort-title {\\n  padding-top: 16px;\\n}\\n\\n.dnd-list {\\n  margin: 16px 0;\\n  border: 1px solid #ccc;\\n  border-radius: 4px;\\n  overflow: hidden;\\n}\\n\\n.dnd-item {\\n  cursor: move;\\n  height: 40px;\\n  border-bottom: 1px solid #ccc;\\n  padding: 0 8px;\\n  display: flex;\\n  align-items: center;\\n  justify-content: space-between;\\n  background: white;\\n  box-sizing: border-box;\\n  font-size: 14px;\\n}\\n\\n.dnd-item:last-child {\\n  border: none;\\n}\\n\\n.dnd-item__title {\\n  display: flex;\\n  align-items: center;\\n  overflow: hidden;\\n}\\n\\n.dnd-item__title-icon {\\n  margin-right: 8px;\\n  opacity: 0.4;\\n}\\n\\n.dnd-item__title-text {\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n  white-space: nowrap;\\n}\\n\\n.cdk-drag-preview {\\n  box-sizing: border-box;\\n  border-radius: 4px;\\n  box-shadow: 0 5px 5px -3px rgba(0, 0, 0, 0.2), 0 8px 10px 1px rgba(0, 0, 0, 0.14), 0 3px 14px 2px rgba(0, 0, 0, 0.12);\\n}\\n\\n.cdk-drag-placeholder {\\n  opacity: 0;\\n}\\n\\n.cdk-drag-animating {\\n  transition: transform 250ms cubic-bezier(0, 0, 0.2, 1);\\n}\\n\\n.dnd-list.cdk-drop-list-dragging .dnd-item:not(.cdk-drag-placeholder) {\\n  transition: transform 250ms cubic-bezier(0, 0, 0.2, 1);\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByb2plY3RzL25nLWRpYWxvZ3Mvc3JjL2FwcC9tYW5hZ2UtY29udGVudC1saXN0L21hbmFnZS1jb250ZW50LWxpc3QuY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxpQkFBQTtBQUNGOztBQUVBO0VBQ0UsY0FBQTtFQUNBLHNCQUFBO0VBQ0Esa0JBQUE7RUFDQSxnQkFBQTtBQUNGOztBQUVBO0VBQ0UsWUFBQTtFQUNBLFlBQUE7RUFDQSw2QkFBQTtFQUNBLGNBQUE7RUFDQSxhQUFBO0VBQ0EsbUJBQUE7RUFDQSw4QkFBQTtFQUNBLGlCQUFBO0VBQ0Esc0JBQUE7RUFDQSxlQUFBO0FBQ0Y7O0FBQ0U7RUFDRSxZQUFBO0FBQ0o7O0FBRUU7RUFDRSxhQUFBO0VBQ0EsbUJBQUE7RUFDQSxnQkFBQTtBQUFKOztBQUdFO0VBQ0UsaUJBQUE7RUFDQSxZQUFBO0FBREo7O0FBSUU7RUFDRSxnQkFBQTtFQUNBLHVCQUFBO0VBQ0EsbUJBQUE7QUFGSjs7QUFNQTtFQUNFLHNCQUFBO0VBQ0Esa0JBQUE7RUFDQSxxSEFBQTtBQUhGOztBQVFBO0VBQ0UsVUFBQTtBQUxGOztBQVFBO0VBQ0Usc0RBQUE7QUFMRjs7QUFRQTtFQUNFLHNEQUFBO0FBTEYiLCJmaWxlIjoicHJvamVjdHMvbmctZGlhbG9ncy9zcmMvYXBwL21hbmFnZS1jb250ZW50LWxpc3QvbWFuYWdlLWNvbnRlbnQtbGlzdC5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5zb3J0LXRpdGxlIHtcclxuICBwYWRkaW5nLXRvcDogMTZweDtcclxufVxyXG5cclxuLmRuZC1saXN0IHtcclxuICBtYXJnaW46IDE2cHggMDtcclxuICBib3JkZXI6IDFweCBzb2xpZCAjY2NjO1xyXG4gIGJvcmRlci1yYWRpdXM6IDRweDtcclxuICBvdmVyZmxvdzogaGlkZGVuO1xyXG59XHJcblxyXG4uZG5kLWl0ZW0ge1xyXG4gIGN1cnNvcjogbW92ZTtcclxuICBoZWlnaHQ6IDQwcHg7XHJcbiAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNjY2M7XHJcbiAgcGFkZGluZzogMCA4cHg7XHJcbiAgZGlzcGxheTogZmxleDtcclxuICBhbGlnbi1pdGVtczogY2VudGVyO1xyXG4gIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcclxuICBiYWNrZ3JvdW5kOiB3aGl0ZTtcclxuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xyXG4gIGZvbnQtc2l6ZTogMTRweDtcclxuXHJcbiAgJjpsYXN0LWNoaWxkIHtcclxuICAgIGJvcmRlcjogbm9uZTtcclxuICB9XHJcblxyXG4gICZfX3RpdGxlIHtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xyXG4gICAgb3ZlcmZsb3c6IGhpZGRlbjtcclxuICB9XHJcblxyXG4gICZfX3RpdGxlLWljb24ge1xyXG4gICAgbWFyZ2luLXJpZ2h0OiA4cHg7XHJcbiAgICBvcGFjaXR5OiAwLjQ7XHJcbiAgfVxyXG5cclxuICAmX190aXRsZS10ZXh0IHtcclxuICAgIG92ZXJmbG93OiBoaWRkZW47XHJcbiAgICB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpcztcclxuICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7XHJcbiAgfVxyXG59XHJcblxyXG4uY2RrLWRyYWctcHJldmlldyB7XHJcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcclxuICBib3JkZXItcmFkaXVzOiA0cHg7XHJcbiAgYm94LXNoYWRvdzogMCA1cHggNXB4IC0zcHggcmdiYSgwLCAwLCAwLCAwLjIpLFxyXG4gICAgMCA4cHggMTBweCAxcHggcmdiYSgwLCAwLCAwLCAwLjE0KSxcclxuICAgIDAgM3B4IDE0cHggMnB4IHJnYmEoMCwgMCwgMCwgMC4xMik7XHJcbn1cclxuXHJcbi5jZGstZHJhZy1wbGFjZWhvbGRlciB7XHJcbiAgb3BhY2l0eTogMDtcclxufVxyXG5cclxuLmNkay1kcmFnLWFuaW1hdGluZyB7XHJcbiAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDI1MG1zIGN1YmljLWJlemllcigwLCAwLCAwLjIsIDEpO1xyXG59XHJcblxyXG4uZG5kLWxpc3QuY2RrLWRyb3AtbGlzdC1kcmFnZ2luZyAuZG5kLWl0ZW06bm90KC5jZGstZHJhZy1wbGFjZWhvbGRlcikge1xyXG4gIHRyYW5zaXRpb246IHRyYW5zZm9ybSAyNTBtcyBjdWJpYy1iZXppZXIoMCwgMCwgMC4yLCAxKTtcclxufVxyXG4iXX0= */\";"],"sourceRoot":"webpack:///"}