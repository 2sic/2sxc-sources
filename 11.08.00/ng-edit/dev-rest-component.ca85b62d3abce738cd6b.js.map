{"version":3,"sources":["./src/app/dev-rest/data/access-scenarios.ts","./src/app/dev-rest/data/environments.ts","./src/app/dev-rest/help-popup/help-popup.component.html","./src/app/dev-rest/help-popup/help-popup.component.ts","./src/app/dev-rest/selector-with-help/selector-with-help.component.html","./src/app/dev-rest/selector-with-help/selector-with-help.component.ts","./src/app/dev-rest/dev-rest.component.html","./src/app/dev-rest/dev-rest.component.ts"],"names":["AccessScenarios","key","name","description","notes","Environments","rootPath","dialogRef","dialogData","ngOnInit","closeDialog","this","close","HelpPopupComponent","dialog","valueChange","selectionChange","value","scenario","items","find","item","emit","showHelp","open","width","data","body","autoFocus","SelectorWithHelpComponent","route","snackBar","http","contentTypesService","appDialogConfigService","context","dnnContext","hostClass","environments","scenarios","contentTypeStaticName","snapshot","paramMap","get","contentType$","BehaviorSubject","dialogSettings$","currentEnv$","currentScenario$","modeInternal$","pipe","map","root$","combineLatest","contentType","dialogSettings","internal","replace","Name","Context","App","templateVars$","currentEnv","currentScenario","modeInternal","root","retrieveContentType","subscribe","getDialogSettings","ngOnDestroy","complete","changeEnv","env","next","changeScenario","callApiGet","url","res","console","log","openSnackBar","message","action","duration","DevRestComponent"],"mappings":"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","file":"dev-rest-component.ca85b62d3abce738cd6b.js","sourcesContent":["import { SelectorData } from './selector-data';\r\n\r\nexport const AccessScenarios: Array<SelectorData> = [\r\n  {\r\n    key: 'internal',\r\n    name: 'Internal-Access from an App',\r\n    description: 'Internal access means that your JS code is running in a DNN-module on a DNN-page. This is the default access. In this scenario, various headers are included in the request, incl. the module it\\'s coming from, which allows various automatic things to happen. This results in simpler REST requests.',\r\n    notes: 'This mode also makes it easier to re-distribute your app, as you can perform API calls relative to the module that\\'s hosting it. This means, that even if you export/import the app to another system, the API-calls stay the same.',\r\n  },\r\n  {\r\n    key: 'external',\r\n    name: 'External access',\r\n    description: 'External access means that the JS code could be on another page / module in DNN (which is not the same app), or it could be coming from a mobile App, or another website altogether. In this case, automatic app-detection can\\'t work, as various headers are missing, and you must access the endpoint more explicitly.',\r\n    notes: 'This mode requires you to define the exact, full URL, so if you create copies of this app on another system, the URL must be updated to access that system specifically.',\r\n  },\r\n];\r\n","import { SelectorData } from './selector-data';\r\n\r\nexport interface EnvironmentSelectorData extends SelectorData {\r\n  rootPath: string;\r\n}\r\n\r\nexport const Environments: Array<EnvironmentSelectorData> = [\r\n  {\r\n    key: 'dnn7',\r\n    name: 'DNN 7 or higher',\r\n    rootPath: '/desktopmodules/2sxc/api/',\r\n    description: 'DNN 7 had a longer API-root path, which still works in later versions of DNN',\r\n  },\r\n  {\r\n    key: 'dnn8',\r\n    name: 'DNN 8 or higher',\r\n    rootPath: '/api/2sxc/',\r\n    description: 'DNN 8+ has a shorter root path, with doesn\\'t work in DNN 7',\r\n  },\r\n];\r\n","<div mat-dialog-title>\r\n  <div class=\"dialog-title-box\">\r\n    <div>{{ dialogData.name }}</div>\r\n    <button mat-icon-button matTooltip=\"Close dialog\" (click)=\"closeDialog()\">\r\n      <mat-icon>close</mat-icon>\r\n    </button>\r\n  </div>\r\n</div>\r\n\r\n<div class=\"dialog-component-content fancy-scrollbar-light\">\r\n  <p class=\"dialog-description\">\r\n    {{ dialogData.body }}\r\n  </p>\r\n\r\n  <p class=\"dialog-description\" *ngIf=\"dialogData.notes\">\r\n    <em>{{ dialogData.notes }}</em>\r\n  </p>\r\n</div>\r\n","import { ChangeDetectionStrategy, Component, Inject, OnInit } from '@angular/core';\r\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\r\nimport { HelpPopupData } from './help-popup.models';\r\n\r\n@Component({\r\n  selector: 'app-help-popup',\r\n  templateUrl: './help-popup.component.html',\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class HelpPopupComponent implements OnInit {\r\n\r\n  constructor(private dialogRef: MatDialogRef<HelpPopupComponent>, @Inject(MAT_DIALOG_DATA) public dialogData: HelpPopupData) { }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  closeDialog() {\r\n    this.dialogRef.close();\r\n  }\r\n}\r\n","<mat-form-field color=\"accent\">\r\n  <mat-label>{{ label }}</mat-label>\r\n  <mat-select [value]=\"value\" (selectionChange)=\"selectionChange($event.value)\">\r\n    <mat-option *ngFor=\"let item of items\" [value]=\"item.key\">{{ item.name }}</mat-option>\r\n  </mat-select>\r\n</mat-form-field>\r\n\r\n<button mat-icon-button (click)=\"showHelp()\">\r\n  <mat-icon>help_outline</mat-icon>\r\n</button>\r\n","import { ChangeDetectionStrategy, Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { HelpPopupComponent, SelectorData } from '..';\r\nimport { EnvironmentSelectorData } from '../data/environments';\r\nimport { HelpPopupData } from '../help-popup/help-popup.models';\r\n\r\n@Component({\r\n  selector: 'app-selector-with-help',\r\n  templateUrl: './selector-with-help.component.html',\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class SelectorWithHelpComponent implements OnInit {\r\n  @Input() label: string;\r\n  @Input() items: SelectorData[] | EnvironmentSelectorData[];\r\n  @Input() value: string;\r\n  @Output() private valueChange = new EventEmitter<SelectorData | EnvironmentSelectorData>();\r\n\r\n  constructor(private dialog: MatDialog) { }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  selectionChange(key: string) {\r\n    this.value = key;\r\n    const scenario = this.items.find(item => item.key === this.value);\r\n    this.valueChange.emit(scenario);\r\n  }\r\n\r\n  showHelp() {\r\n    const scenario = this.items.find(item => item.key === this.value);\r\n    const data: HelpPopupData = {\r\n      name: scenario.name,\r\n      body: scenario.description,\r\n      notes: scenario.notes,\r\n    };\r\n\r\n    this.dialog.open(HelpPopupComponent, {\r\n      width: '500px',\r\n      data,\r\n      autoFocus: false,\r\n    });\r\n  }\r\n}\r\n","<ng-container *ngIf=\"templateVars$ | async as data\">\r\n  <div mat-dialog-title>\r\n    <div class=\"dialog-title-box\">\r\n      <div>Using REST with {{ data.contentType?.Name }}</div>\r\n      <button mat-icon-button matTooltip=\"Close dialog\" (click)=\"closeDialog()\">\r\n        <mat-icon>close</mat-icon>\r\n      </button>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"dialog-component-content fancy-scrollbar-light\">\r\n    <p class=\"dialog-description\">\r\n      All data can easily be used in JavaScript using a REST API.\r\n    </p>\r\n\r\n    <p class=\"dialog-description\">\r\n      <em>\r\n        Important: As a host-user you can always access these REST endpoints, but\r\n        if you want to use them in a public UI, you must remember to set the\r\n        permissions to allow this.\r\n      </em>\r\n    </p>\r\n\r\n    <div>\r\n      <app-selector-with-help label=\"Choose Scenario\" [items]=\"scenarios\" [value]=\"data.currentScenario.key\"\r\n        (valueChange)=\"changeScenario($event)\">\r\n      </app-selector-with-help>\r\n\r\n      <app-selector-with-help *ngIf=\"!data.modeInternal\" label=\"Choose DNN Version\" [items]=\"environments\"\r\n        [value]=\"data.currentEnv.key\" (valueChange)=\"changeEnv($event)\">\r\n      </app-selector-with-help>\r\n    </div>\r\n\r\n    <ng-container *ngIf=\"data.modeInternal; then internal; else external\"></ng-container>\r\n  </div>\r\n\r\n\r\n  <ng-template #internal>\r\n    <mat-tab-group color=\"accent\">\r\n      <mat-tab label=\"Virtual REST URLs\">\r\n        <ng-template matTabContent>\r\n          <p class=\"dialog-description\">\r\n            Virtual REST URLs are shorter URLs, which are automatically resolved\r\n            to the full length (based on the dnn-version, current portal, etc.)\r\n            thanks to $2sxc. This happens when you use the\r\n            <a href=\"https://github.com/2sic/2sxc/wiki/javascript-sxc-webapi\" target=\"_blank\">\r\n              $2sxc.webApi(...)\r\n            </a>\r\n            or if you use\r\n            <a href=\"https://www.npmjs.com/package/@2sic.com/dnn-sxc-angular\" target=\"_blank\">\r\n              dnn-sxc-angular (npm package)\r\n            </a>\r\n            (which also passes url-resolving through $2sxc).\r\n          </p>\r\n\r\n          <ng-container *ngTemplateOutlet=\"restUrls\"></ng-container>\r\n        </ng-template>\r\n      </mat-tab>\r\n      <mat-tab label=\"JS Calls using $2sxc\">\r\n        <ng-template matTabContent>\r\n          <p class=\"dialog-description\">\r\n            First you must get the <code>sxc</code> controller for the current module instance.\r\n            The easiest way is to let <code>$2sxc</code> find it, by giving it a html-tag before running any additional\r\n            code.\r\n            $2sxc will then automatically look up everything and return a fully configured controller.\r\n            Note that this is just an example, you will probably do this differently and not use a global variable (bad\r\n            practice).\r\n          </p>\r\n          <pre>\r\n// this assumes a tag like &lt;div id='myGalleryTag'&gt; in your code\r\nvar mySxc = $2sxc(document.getElementById('myGalleryTag'));\r\n        </pre>\r\n\r\n          <p>\r\n            Then...\r\n          </p>\r\n          <pre>\r\n/** get all items - this returns a promise\r\n* so you can do getAll().then(...)\r\n*/\r\nfunction getAll() {{ '{' }}\r\nreturn mySxc.webApi.get('');\r\n{{ '}' }}\r\n\r\nfunction getOne(id) {{ '{' }}\r\nreturn mySxc.webApi.get('' + '/' + id);\r\n{{ '}' }}\r\n        </pre>\r\n        </ng-template>\r\n      </mat-tab>\r\n    </mat-tab-group>\r\n  </ng-template>\r\n\r\n\r\n  <ng-template #external>\r\n    <mat-tab-group color=\"accent\">\r\n      <mat-tab label=\"Full REST URLs\">\r\n        <ng-template matTabContent>\r\n          <ng-container *ngTemplateOutlet=\"restUrls\"></ng-container>\r\n        </ng-template>\r\n      </mat-tab>\r\n      <mat-tab label=\"JS Calls using $2sxc\">\r\n        <ng-template matTabContent>\r\n          todo\r\n        </ng-template>\r\n      </mat-tab>\r\n    </mat-tab-group>\r\n  </ng-template>\r\n\r\n\r\n  <ng-template #restUrls>\r\n    <mat-list>\r\n      <mat-list-item>\r\n        <h3 matLine>Read list of all items</h3>\r\n        <div matLine>\r\n          <code>GET</code>: <code>{{ data.root }}</code>\r\n        </div>\r\n        <button mat-raised-button (click)=\"callApiGet(data.root)\">execute call</button>\r\n        <a *ngIf=\"data.currentScenario?.key === 'external'\" [href]=\"data.root\" target=\"_blank\">open</a>\r\n      </mat-list-item>\r\n      <mat-divider></mat-divider>\r\n      <mat-list-item>\r\n        <h3 matLine>Read a single item #27</h3>\r\n        <div matLine>\r\n          <code>GET</code>: <code>{{ data.root }}/27</code>\r\n        </div>\r\n        <button mat-raised-button (click)=\"callApiGet(data.root)\">execute call</button>\r\n        <a *ngIf=\"data.currentScenario?.key === 'external'\" [href]=\"data.root\" target=\"_blank\">open</a>\r\n      </mat-list-item>\r\n      <mat-divider></mat-divider>\r\n      <mat-list-item>\r\n        <h3 matLine>Create an item</h3>\r\n        <div matLine>\r\n          <code>POST</code>: <code>{{ data.root }}</code>\r\n        </div>\r\n      </mat-list-item>\r\n      <mat-divider></mat-divider>\r\n      <mat-list-item>\r\n        <h3 matLine>Update the item #27</h3>\r\n        <div matLine>\r\n          <code>POST</code>: <code>{{ data.root }}/27</code>\r\n        </div>\r\n      </mat-list-item>\r\n      <mat-divider></mat-divider>\r\n      <mat-list-item>\r\n        <h3 matLine>Delete the item #27</h3>\r\n        <div matLine>\r\n          <code>DELETE</code>: <code>{{ data.root }}/27</code>\r\n        </div>\r\n      </mat-list-item>\r\n    </mat-list>\r\n  </ng-template>\r\n\r\n</ng-container>\r\n","import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { ChangeDetectionStrategy, Component, HostBinding, OnDestroy, OnInit } from '@angular/core';\r\nimport { MatDialogRef } from '@angular/material/dialog';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { BehaviorSubject, combineLatest, Observable } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\nimport { AccessScenarios, Environments, EnvironmentSelectorData, SelectorData } from '.';\r\nimport { ContentType } from '../app-administration/models/content-type.model';\r\nimport { DialogSettings } from '../app-administration/models/dialog-settings.model';\r\nimport { AppDialogConfigService } from '../app-administration/services/app-dialog-config.service';\r\nimport { ContentTypesService } from '../app-administration/services/content-types.service';\r\nimport { Context } from '../shared/services/context';\r\nimport { ItemResult } from './dev-rest.models';\r\n\r\nconst pathToContent = 'app/{appname}/content/{typename}';\r\n\r\n@Component({\r\n  selector: 'app-dev-rest',\r\n  templateUrl: './dev-rest.component.html',\r\n  styleUrls: ['./dev-rest.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class DevRestComponent implements OnInit, OnDestroy {\r\n  @HostBinding('className') hostClass = 'dialog-component dialog-component--no-actions';\r\n\r\n  /** List of all known environments */\r\n  environments = Environments;\r\n\r\n  /** List of scenarios */\r\n  scenarios = AccessScenarios;\r\n\r\n  templateVars$: Observable<{\r\n    contentType: ContentType;\r\n    currentEnv: EnvironmentSelectorData;\r\n    currentScenario: SelectorData;\r\n    modeInternal: boolean;\r\n    root: string;\r\n  }>;\r\n\r\n  private contentTypeStaticName = this.route.snapshot.paramMap.get('contentTypeStaticName');\r\n\r\n  /** Content Type to show REST infos about */\r\n  private contentType$: BehaviorSubject<ContentType>;\r\n\r\n  /** App, language, etc. */\r\n  private dialogSettings$: BehaviorSubject<DialogSettings>;\r\n\r\n  /** Currently selected environment object */\r\n  private currentEnv$: BehaviorSubject<EnvironmentSelectorData>;\r\n\r\n  /** Currently selected scenario */\r\n  private currentScenario$: BehaviorSubject<SelectorData>;\r\n\r\n  private modeInternal$: Observable<boolean>;\r\n\r\n  /** The root path for the current request */\r\n  private root$: Observable<string>;\r\n\r\n  constructor(\r\n    private dialogRef: MatDialogRef<DevRestComponent>,\r\n    private route: ActivatedRoute,\r\n    private snackBar: MatSnackBar,\r\n    private http: HttpClient,\r\n    private contentTypesService: ContentTypesService,\r\n    private appDialogConfigService: AppDialogConfigService,\r\n    /** Context for this dialog. Used for appId, zoneId, tabId, etc. */\r\n    private context: Context,\r\n    /** dnn-sxc-angular context. Used to resolve urls */\r\n    private dnnContext: DnnContext,\r\n  ) {\r\n    this.contentType$ = new BehaviorSubject<ContentType>(null);\r\n    this.dialogSettings$ = new BehaviorSubject<DialogSettings>(null);\r\n    this.currentEnv$ = new BehaviorSubject<EnvironmentSelectorData>(this.environments[0]);\r\n    this.currentScenario$ = new BehaviorSubject<SelectorData>(this.scenarios[0]);\r\n    this.modeInternal$ = this.currentScenario$.pipe(map(scenario => scenario.key === 'internal'));\r\n\r\n    this.root$ = combineLatest([this.contentType$, this.currentEnv$, this.currentScenario$, this.dialogSettings$]).pipe(\r\n      map(([contentType, env, scenario, dialogSettings]) => {\r\n        if (contentType == null || dialogSettings == null) { return ''; }\r\n\r\n        const internal = scenario === AccessScenarios[0];\r\n        const root = internal ? '' : env.rootPath;\r\n        return root + pathToContent\r\n          .replace('{typename}', contentType.Name)\r\n          .replace('{appname}', internal ? 'auto' : dialogSettings.Context.App.Name);\r\n      }),\r\n    );\r\n\r\n    this.templateVars$ = combineLatest([this.contentType$, this.currentEnv$, this.currentScenario$, this.modeInternal$, this.root$]).pipe(\r\n      map(([contentType, currentEnv, currentScenario, modeInternal, root]) => ({\r\n        contentType,\r\n        currentEnv,\r\n        currentScenario,\r\n        modeInternal,\r\n        root,\r\n      })),\r\n    );\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.contentTypesService.retrieveContentType(this.contentTypeStaticName).subscribe(this.contentType$);\r\n    this.appDialogConfigService.getDialogSettings().subscribe(this.dialogSettings$);\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.contentType$.complete();\r\n    this.dialogSettings$.complete();\r\n    this.currentEnv$.complete();\r\n    this.currentScenario$.complete();\r\n  }\r\n\r\n  changeEnv(env: EnvironmentSelectorData) {\r\n    this.currentEnv$.next(env);\r\n  }\r\n\r\n  changeScenario(scenario: SelectorData) {\r\n    this.currentScenario$.next(scenario);\r\n  }\r\n\r\n  closeDialog() {\r\n    this.dialogRef.close();\r\n  }\r\n\r\n  // todo: 2dm - probably open a dialog showing the results etc.\r\n  callApiGet(url: string) {\r\n    this.http.get<ItemResult[]>(url).subscribe(res => {\r\n      console.log(res);\r\n    });\r\n    this.openSnackBar('API call dispatched - to see it, you should have the console (F12) open.', 'API call');\r\n  }\r\n\r\n  openSnackBar(message: string, action: string) {\r\n    this.snackBar.open(message, action, {\r\n      duration: 2000,\r\n    });\r\n  }\r\n}\r\n"],"sourceRoot":"webpack:///"}