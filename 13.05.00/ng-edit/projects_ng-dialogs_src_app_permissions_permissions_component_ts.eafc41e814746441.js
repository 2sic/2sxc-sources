"use strict";(self.webpackChunkng_dialogs=self.webpackChunkng_dialogs||[]).push([["projects_ng-dialogs_src_app_permissions_permissions_component_ts"],{5620:(b,p,e)=>{e.r(p),e.d(p,{PermissionsComponent:()=>G});var u=e(9119),s=e(2977),l=e(6317),g=e(7714),f=e(116),y=e(4874),C=e(635),T=e(679),P=e(5578),c=e(6880),r=e(1825),a=e(5137),t=e(3184),D=e(1130),I=e(785),M=e(5590);let x=(()=>{class d{agInit(i){this.params=i}refresh(i){return!0}deletePermission(){this.params.onDelete(this.params.data)}}return d.\u0275fac=function(i){return new(i||d)},d.\u0275cmp=t.Xpm({type:d,selectors:[["app-permissions-actions"]],decls:4,vars:0,consts:[[1,"actions-component"],["matRipple","","tippy","Delete",1,"like-button","highlight",3,"click"]],template:function(i,o){1&i&&(t.TgZ(0,"div",0)(1,"div",1),t.NdJ("click",function(){return o.deletePermission()}),t.TgZ(2,"mat-icon"),t._uU(3,"delete"),t.qZA()()())},directives:[D.wG,I.$,M.Hw],styles:[""]}),d})();var A=e(7170),Z=e(5758),E=e(2528),U=e(7317),R=e(1350),F=e(6362);let G=(()=>{class d{constructor(i,o,m,v,O){this.dialogRef=i,this.router=o,this.route=m,this.permissionsService=v,this.snackBar=O,this.permissions$=new l.X(void 0),this.modules=u.F$j,this.gridOptions=Object.assign(Object.assign({},c.f),{columnDefs:[{headerName:"ID",field:"Id",width:70,headerClass:"dense",cellClass:"id-action no-padding no-outline".split(" "),cellRenderer:P.m,sortable:!0,filter:"agNumberColumnFilter",valueGetter:n=>n.data.Id,cellRendererParams:{tooltipGetter:n=>`ID: ${n.Id}\nGUID: ${n.Guid}`}},{field:"Name",flex:2,minWidth:250,cellClass:"primary-action highlight".split(" "),sortable:!0,sort:"asc",filter:"agTextColumnFilter",onCellClicked:n=>this.editPermission(n.data),valueGetter:n=>n.data.Title},{field:"Identity",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:n=>n.data.Identity},{field:"Condition",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:n=>n.data.Condition},{field:"Grant",width:70,headerClass:"dense",cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:n=>n.data.Grant},{width:42,cellClass:"secondary-action no-padding".split(" "),cellRenderer:x,pinned:"right",cellRendererParams:{onDelete:n=>this.deletePermission(n)}}]}),this.subscription=new g.w0,this.targetType=parseInt(this.route.snapshot.paramMap.get("targetType"),10),this.keyType=this.route.snapshot.paramMap.get("keyType"),this.key=this.route.snapshot.paramMap.get("key"),this.prefills={[r.Z.metadata.language.targetType]:{PermissionType:"language"}}}ngOnInit(){this.fetchPermissions(),this.refreshOnChildClosed()}ngOnDestroy(){this.permissions$.complete(),this.subscription.unsubscribe()}closeDialog(){this.dialogRef.close()}fetchPermissions(){this.permissionsService.getAll(this.targetType,this.keyType,this.key).subscribe(i=>{this.permissions$.next(i)})}editPermission(i){var o,m;let v;v=null==i?{items:[Object.assign({ContentTypeName:r.Z.contentTypes.permissions,For:Object.assign(Object.assign(Object.assign({Target:null!==(m=null===(o=Object.values(r.Z.metadata).find(n=>n.targetType===this.targetType))||void 0===o?void 0:o.target)&&void 0!==m?m:this.targetType.toString(),TargetType:this.targetType},this.keyType===r.Z.keyTypes.guid&&{Guid:this.key}),this.keyType===r.Z.keyTypes.number&&{Number:parseInt(this.key,10)}),this.keyType===r.Z.keyTypes.string&&{String:this.key})},this.prefills[this.targetType]&&{Prefill:this.prefills[this.targetType]})]}:{items:[{EntityId:i.Id}]};const O=(0,a.f)(v);this.router.navigate([`edit/${O}`],{relativeTo:this.route})}deletePermission(i){!confirm(`Delete '${i.Title}' (${i.Id})?`)||(this.snackBar.open("Deleting..."),this.permissionsService.delete(i.Id).subscribe(()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchPermissions()}))}refreshOnChildClosed(){this.subscription.add(this.router.events.pipe((0,f.h)(i=>i instanceof s.m2),(0,y.O)(!!this.route.snapshot.firstChild),(0,C.U)(()=>!!this.route.snapshot.firstChild),(0,T.G)(),(0,f.h)(([i,o])=>i&&!o)).subscribe(()=>{this.fetchPermissions()}))}}return d.\u0275fac=function(i){return new(i||d)(t.Y36(Z.so),t.Y36(s.F0),t.Y36(s.gz),t.Y36(A.q),t.Y36(E.ux))},d.\u0275cmp=t.Xpm({type:d,selectors:[["app-permissions"]],decls:16,vars:5,consts:[[1,"nav-component-wrapper"],["mat-dialog-title",""],[1,"dialog-title-box"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","modules","gridOptions"],[1,"grid-more-actions-box"],["mat-fab","","mat-elevation-z24","","tippy","Create a new permission",1,"grid-fab",3,"click"]],template:function(i,o){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div"),t._uU(4,"Permissions"),t.qZA(),t.TgZ(5,"button",3),t.NdJ("click",function(){return o.closeDialog()}),t.TgZ(6,"mat-icon"),t._uU(7,"close"),t.qZA()()()(),t._UZ(8,"router-outlet"),t.TgZ(9,"div",4),t._UZ(10,"ag-grid-angular",5),t.ALo(11,"async"),t._UZ(12,"div",6),t.TgZ(13,"button",7),t.NdJ("click",function(){return o.editPermission(null)}),t.TgZ(14,"mat-icon"),t._uU(15,"add"),t.qZA()()()()),2&i&&(t.xp6(10),t.Q6J("rowData",t.lcZ(11,3,o.permissions$))("modules",o.modules)("gridOptions",o.gridOptions))},directives:[Z.uh,U.lW,I.$,M.Hw,s.lC,R.N8],pipes:[F.Ov],styles:[""]}),d})()},5578:(b,p,e)=>{e.d(p,{m:()=>P});var u=e(5388),s=e(3184),l=e(2528),g=e(1130),f=e(785),y=e(6362),C=e(5590);const T=function(c,r){return{"align-start":c,"align-end":r}};let P=(()=>{class c{constructor(a){this.snackBar=a}agInit(a){this.id=a.value,this.align="number"==typeof this.id?"end":"start",this.tooltip=a.tooltipGetter(a.data)}refresh(a){return!0}copy(){(0,u.v)(this.tooltip),this.snackBar.open("Copied to clipboard",null,{duration:2e3})}}return c.\u0275fac=function(a){return new(a||c)(s.Y36(l.ux))},c.\u0275cmp=s.Xpm({type:c,selectors:[["app-id-field"]],decls:5,vars:6,consts:[["matRipple","",1,"id-box","highlight",3,"tippy","ngClass","click"],[1,"id"],[1,"icon"]],template:function(a,t){1&a&&(s.TgZ(0,"div",0),s.NdJ("click",function(){return t.copy()}),s.TgZ(1,"span",1),s._uU(2),s.qZA(),s.TgZ(3,"mat-icon",2),s._uU(4,"file_copy"),s.qZA()()),2&a&&(s.Q6J("tippy",t.tooltip)("ngClass",s.WLB(3,T,"start"===t.align,"end"===t.align)),s.xp6(2),s.Oqu(t.id))},directives:[g.wG,f.$,y.mk,C.Hw],styles:[".id-box[_ngcontent-%COMP%]{padding:0 8px;height:100%;display:flex;align-items:center}.id-box.align-start[_ngcontent-%COMP%]{justify-content:flex-start}.id-box.align-end[_ngcontent-%COMP%]{justify-content:flex-end}.id-box[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{max-width:100%;text-overflow:ellipsis;overflow:hidden}.id-box[_ngcontent-%COMP%]:hover{text-decoration:none}.id-box[_ngcontent-%COMP%]:hover   .id[_ngcontent-%COMP%]{display:none}.id-box[_ngcontent-%COMP%]:not(:hover)   .icon[_ngcontent-%COMP%]{display:none}"]}),c})()},5388:(b,p,e)=>{function u(s){const l=document.createElement("textarea");l.value=s,l.setAttribute("readonly",""),l.style.position="absolute",l.style.left="-9999px",document.body.appendChild(l);const g=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);l.select(),document.execCommand("copy"),document.body.removeChild(l),g&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(g))}e.d(p,{v:()=>u})}}]);
//# sourceMappingURL=https://sources.2sxc.org/13.05.00/ng-edit/projects_ng-dialogs_src_app_permissions_permissions_component_ts.eafc41e814746441.js.map