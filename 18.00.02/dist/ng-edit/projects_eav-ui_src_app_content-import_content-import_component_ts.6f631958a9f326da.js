"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_content-import_content-import_component_ts"],{2743:(O,E,n)=>{n.d(E,{b:()=>C});var a=n(8873),f=n(5506),m=n(6163),g=n(7580);let C=(()=>{class r{constructor(o,p){this.contextSvcShared=o,this.context=p,this.log=new f.B("DialogConfigService",!1)}getCurrent$(){const o=this.context.appId;return this.log.a(`getCurrent$ - appId:${o}`),this.contextSvcShared.getShared$(o)}static#t=this.\u0275fac=function(p){return new(p||r)(g.KVO(m.t),g.KVO(a.o))};static#e=this.\u0275prov=g.jDH({token:r,factory:r.\u0275fac})}return r})()},7693:(O,E,n)=>{n.d(E,{X:()=>_,g:()=>T});var a=n(271),f=n(8873),m=n(7580),g=n(6443),I=n(4821);const _="admin/type/",s="admin/type/scopes";let T=(()=>{class d{constructor(l,v,b){this.http=l,this.context=v,this.dnnContext=b}apiUrl(l){return this.dnnContext.$2sxc.http.apiUrl(l)}retrieveContentType(l){return this.http.get(this.apiUrl("admin/type/get"),{params:{appId:this.context.appId.toString(),contentTypeId:l}})}retrieveContentTypes(l){return this.http.get(this.apiUrl("admin/type/list"),{params:{appId:this.context.appId.toString(),scope:l}})}getScopes(){return this.http.get(this.apiUrl(s),{params:{appId:this.context.appId.toString()}}).pipe((0,a.T)(l=>{const v=l.old;return Object.keys(v).map(x=>({name:v[x],value:x}))}))}getScopesV2(){return this.http.get(this.apiUrl(s),{params:{appId:this.context.appId.toString()}}).pipe((0,a.T)(l=>l.scopes))}save(l){return this.http.post(this.apiUrl("admin/type/save"),l,{params:{appid:this.context.appId.toString()}})}delete(l){return this.http.delete(this.apiUrl("admin/type/delete"),{params:{appid:this.context.appId.toString(),staticName:l.StaticName}})}import(l){const v=new FormData;for(const b of l)v.append("File",b);return this.http.post(this.apiUrl("admin/type/import"),v,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}createGhost(l){return this.http.post(this.apiUrl("admin/type/addghost"),null,{params:{appid:this.context.appId.toString(),sourceStaticName:l}})}static#t=this.\u0275fac=function(v){return new(v||d)(m.KVO(g.Qq),m.KVO(f.o),m.KVO(I.ob))};static#e=this.\u0275prov=m.jDH({token:d,factory:d.\u0275fac})}return d})()},6163:(O,E,n)=>{n.d(E,{t:()=>t});var a=n(6301),f=n(271),m=n(8764),g=n(8873),I=n(5506),_=n(9431),C=n(7580),r=n(6443);let t=(()=>{class h{constructor(d,R,l){this.http=d,this.context=R,this.globalConfigService=l,this.log=new I.B("GlobalDialogConfigService",!1),this.dialogSettings$={},this.log.a(`using context #${this.context.log.svcId}`)}getShared$(d){return this.log.a("getShared$ appId: "+d),this.dialogSettings$[d]??=this.getDialogSettings(d,"getShared$").pipe((0,a.t)({refCount:!1})),this.dialogSettings$[d]}getDialogSettings(d,R){return this.log.a("getDialogSettings",{appId:d,reqBy:R}),this.http.get("admin/dialog/settings",{params:{appId:d??this.context.appId.toString()}}).pipe((0,f.T)(l=>(l.Context.Language.List=l.Context.Language.List.filter(v=>v.IsEnabled),l)),(0,m.M)(l=>{this.globalConfigService.allowDebug(l.Context.Enable.DebugMode)}))}static#t=this.\u0275fac=function(R){return new(R||h)(C.KVO(r.Qq),C.KVO(g.o),C.KVO(_.B))};static#e=this.\u0275prov=C.jDH({token:h,factory:h.\u0275fac,providedIn:"root"})}return h})()},2795:(O,E,n)=>{n.r(E),n.d(E,{ContentImportComponent:()=>z});var a=n(7941),f=n(5797),m=n(9999),g=n(271),I=n(1873),_=n(7693),C=n(4600),r=n(6647),s=n(693),o=n(8873),p=n(9234),t=n(7580),h=n(6443),T=n(4821);let d=(()=>{class i{constructor(e,c,u){this.http=e,this.context=c,this.dnnContext=u}evaluateContent(e){return(0,C.H)((0,s.n)(e.file)).pipe((0,r.n)(c=>{const u={AppId:this.context.appId.toString(),DefaultLanguage:e.defaultLanguage,ContentType:e.contentType,ContentBase64:c,ResourcesReferences:e.resourcesReferences,ClearEntities:e.clearEntities};return this.http.post(this.dnnContext.$2sxc.http.apiUrl(p.gb+"XmlPreview"),u).pipe((0,g.T)(D=>(D.Success||(D.Errors=D.Detail,delete D.Detail),D)))}))}importContent(e){return(0,C.H)((0,s.n)(e.file)).pipe((0,r.n)(c=>{const u={AppId:this.context.appId.toString(),DefaultLanguage:e.defaultLanguage,ContentType:e.contentType,ContentBase64:c,ResourcesReferences:e.resourcesReferences,ClearEntities:e.clearEntities};return this.http.post(this.dnnContext.$2sxc.http.apiUrl(p.gb+"XmlUpload"),u)}))}static#t=this.\u0275fac=function(c){return new(c||i)(t.KVO(h.Qq),t.KVO(o.o),t.KVO(T.ob))};static#e=this.\u0275prov=t.jDH({token:i,factory:i.\u0275fac})}return i})();var R=n(316),l=n(3804),v=n(4175),b=n(4456),x=n(4575),M=n(5437),S=n(2743),P=n(2159);function F(i,y){if(1&i){const e=t.RV6();t.j41(0,"form",null,0)(2,"div",8)(3,"div")(4,"button",9),t.bIt("click",function(){t.eBV(e);const u=t.sdS(8);return t.Njj(u.click())}),t.j41(5,"span"),t.EFF(6),t.k0s()(),t.j41(7,"input",10,1),t.bIt("change",function(u){t.eBV(e);const D=t.XpG(3);return t.Njj(D.fileChange(u))}),t.k0s()(),t.j41(9,"div")(10,"p",11),t.EFF(11,"References to pages / files"),t.k0s(),t.j41(12,"mat-radio-group",12),t.mxI("ngModelChange",function(u){t.eBV(e);const D=t.XpG(3);return t.DH7(D.formValues.resourcesReferences,u)||(D.formValues.resourcesReferences=u),t.Njj(u)}),t.j41(13,"mat-radio-button",13),t.EFF(14," Import links as written in the file (for example /Portals/...) "),t.k0s(),t.j41(15,"mat-radio-button",14),t.EFF(16," Try to resolve paths to references "),t.k0s()()(),t.j41(17,"div")(18,"p",11),t.EFF(19,"Clear all other entities"),t.k0s(),t.j41(20,"mat-radio-group",15),t.mxI("ngModelChange",function(u){t.eBV(e);const D=t.XpG(3);return t.DH7(D.formValues.clearEntities,u)||(D.formValues.clearEntities=u),t.Njj(u)}),t.j41(21,"mat-radio-button",16),t.EFF(22," Keep all entities not found in import "),t.k0s(),t.j41(23,"mat-radio-button",17),t.EFF(24," Remove all entities not found in import "),t.k0s()()(),t.j41(25,"p",18),t.EFF(26,"Remember to backup your DNN first!"),t.k0s()(),t.j41(27,"mat-dialog-actions",19)(28,"button",20),t.bIt("click",function(){t.eBV(e);const u=t.XpG(3);return t.Njj(u.closeDialog())}),t.EFF(29,"Cancel"),t.k0s(),t.j41(30,"button",21),t.bIt("click",function(){t.eBV(e);const u=t.XpG(3);return t.Njj(u.evaluateContent())}),t.EFF(31," Preview Import "),t.k0s()()()}if(2&i){const e=t.XpG(3);t.R7$(6),t.JRh(e.formValues.file?e.formValues.file.name:"Select or drop file"),t.R7$(6),t.R50("ngModel",e.formValues.resourcesReferences),t.R7$(8),t.R50("ngModel",e.formValues.clearEntities),t.R7$(10),t.Y8G("disabled",!e.formValues.file||!e.formValues.file.name)}}function j(i,y){1&i&&(t.j41(0,"div",8)(1,"p"),t.EFF(2,"Please wait while processing..."),t.k0s()())}function A(i,y){if(1&i&&(t.j41(0,"div",8)(1,"p",22),t.EFF(2),t.k0s(),t.j41(3,"p",22),t.EFF(4,"File contains:"),t.k0s(),t.j41(5,"ul",23)(6,"li"),t.EFF(7),t.k0s(),t.j41(8,"li"),t.EFF(9),t.k0s(),t.j41(10,"li"),t.EFF(11),t.k0s()(),t.j41(12,"p",22),t.EFF(13,"If you press Import, it will:"),t.k0s(),t.j41(14,"ul",23)(15,"li"),t.EFF(16),t.k0s(),t.j41(17,"li"),t.EFF(18),t.k0s(),t.j41(19,"li"),t.EFF(20),t.k0s(),t.j41(21,"li"),t.EFF(22),t.k0s()(),t.j41(23,"p",18),t.EFF(24,"Note: The import validates much data and may take several minutes."),t.k0s()()),2&i){const e=t.XpG(4),c=t.XpG();t.R7$(2),t.SpI("Try to import file '",c.formValues.file.name,"'"),t.R7$(5),t.SpI("",e.evaluationResult.Detail.DocumentElementsCount," content-items (records/entities)"),t.R7$(2),t.SpI("",e.evaluationResult.Detail.LanguagesInDocumentCount," languages"),t.R7$(2),t.Lme("",e.evaluationResult.Detail.AttributeNamesInDocument.length," columns: ",e.evaluationResult.Detail.AttributeNamesInDocument.join(", "),""),t.R7$(5),t.SpI("Create ",e.evaluationResult.Detail.AmountOfEntitiesCreated," content-items"),t.R7$(2),t.SpI("Update ",e.evaluationResult.Detail.AmountOfEntitiesUpdated," content-items"),t.R7$(2),t.SpI("Delete ",e.evaluationResult.Detail.AmountOfEntitiesDeleted," content-items"),t.R7$(2),t.Lme("Ignore ",e.evaluationResult.Detail.AttributeNamesNotImported.length," columns: ",e.evaluationResult.Detail.AttributeNamesNotImported.join(", "),"")}}function $(i,y){if(1&i&&(t.j41(0,"div")(1,"i"),t.EFF(2),t.k0s()()),2&i){const e=t.XpG().$implicit;t.R7$(2),t.SpI("Details: ",e.ErrorDetail,"")}}function L(i,y){if(1&i&&(t.j41(0,"div")(1,"i"),t.EFF(2),t.k0s()()),2&i){const e=t.XpG().$implicit;t.R7$(2),t.SpI("Line-no: ",e.LineNumber,"")}}function B(i,y){if(1&i&&(t.j41(0,"div")(1,"i"),t.EFF(2),t.k0s()()),2&i){const e=t.XpG().$implicit;t.R7$(2),t.SpI("Line-details: ",e.LineDetail,"")}}function U(i,y){if(1&i&&(t.j41(0,"li")(1,"div"),t.EFF(2),t.k0s(),t.DNE(3,$,3,1,"div")(4,L,3,1,"div")(5,B,3,1,"div"),t.k0s()),2&i){const e=y.$implicit,c=t.XpG(6);t.R7$(2),t.JRh(c.errors[e.ErrorCode]),t.R7$(),t.vxM(3,e.ErrorDetail?3:-1),t.R7$(),t.vxM(4,e.LineNumber?4:-1),t.R7$(),t.vxM(5,e.LineDetail?5:-1)}}function K(i,y){if(1&i&&(t.j41(0,"div",8)(1,"p",22),t.EFF(2),t.k0s(),t.j41(3,"ul",23),t.Z7z(4,U,6,4,"li",null,t.fX1),t.k0s()()),2&i){const e=t.XpG(4),c=t.XpG();t.R7$(2),t.SpI("Try to import file '",c.formValues.file.name,"'"),t.R7$(2),t.Dyx(e.evaluationResult.Errors)}}function w(i,y){if(1&i){const e=t.RV6();t.DNE(0,A,25,10,"div",8)(1,K,6,1,"div",8),t.j41(2,"mat-dialog-actions",19)(3,"button",20),t.bIt("click",function(){t.eBV(e);const u=t.XpG(4);return t.Njj(u.back())}),t.EFF(4,"Back"),t.k0s(),t.j41(5,"button",21),t.bIt("click",function(){t.eBV(e);const u=t.XpG(4);return t.Njj(u.importContent())}),t.EFF(6," Import "),t.k0s()()}if(2&i){const e=t.XpG(3);t.vxM(0,e.evaluationResult.Success?0:-1),t.R7$(),t.vxM(1,e.evaluationResult.Success?-1:1),t.R7$(4),t.Y8G("disabled",!e.evaluationResult.Success)}}function W(i,y){if(1&i&&t.DNE(0,w,7,3,"mat-dialog-actions",19),2&i){const e=t.XpG(2);t.vxM(0,e.evaluationResult?0:-1)}}function V(i,y){1&i&&(t.j41(0,"p"),t.EFF(1,"Import done."),t.k0s())}function k(i,y){1&i&&(t.j41(0,"p"),t.EFF(1,"Import failed."),t.k0s())}function N(i,y){if(1&i&&(t.j41(0,"div",8),t.DNE(1,V,2,0,"p")(2,k,2,0,"p"),t.k0s()),2&i){const e=t.XpG(3);t.R7$(),t.vxM(1,e.importResult.Success?1:-1),t.R7$(),t.vxM(2,e.importResult.Success?-1:2)}}function X(i,y){if(1&i){const e=t.RV6();t.DNE(0,N,3,2,"div",8),t.j41(1,"mat-dialog-actions",19)(2,"button",24),t.bIt("click",function(){t.eBV(e);const u=t.XpG(3);return t.Njj(u.closeDialog())}),t.EFF(3,"Close"),t.k0s()()}if(2&i){const e=t.XpG(2);t.vxM(0,e.importResult?0:-1)}}function G(i,y){if(1&i&&t.DNE(0,F,32,4)(1,j,3,0)(2,W,1,1)(3,X,4,1),2&i){let e;const c=t.XpG();t.vxM(0,1===(e=c.viewStateSelected)?0:0===e?1:2===e?2:3===e?3:-1)}}function H(i,y){if(1&i){const e=t.RV6();t.j41(0,"div",3),t.bIt("filesDropped",function(u){t.eBV(e);const D=t.XpG();return t.Njj(D.filesDropped(u))}),t.j41(1,"div",4)(2,"div",5),t.EFF(3),t.k0s()(),t.j41(4,"div",6)(5,"p"),t.EFF(6," This will import content-items into 2sxc. It requires that you already defined the content-type before you try importing, and that you created the import-file using the template provided by the Export. Please visit "),t.j41(7,"a",7),t.EFF(8,"https://2sxc.org/help"),t.k0s(),t.EFF(9," for more instructions. "),t.k0s()(),t.DNE(10,G,4,1),t.k0s()}if(2&i){const e=y,c=t.XpG();t.Y8G("allowedFileTypes","xml"),t.R7$(3),t.SpI("",null==e.contentType?null:e.contentType.Name," Import Data"),t.R7$(7),t.vxM(10,null!=c.formValues?10:-1)}}let z=(()=>{class i{constructor(e,c,u){this.dialogData=e,this.dialogRef=c,this.route=u,this.hostClass="dialog-component",this.contentImportService=(0,M.d)(d),this.contentTypesService=(0,M.d)(_.g),this.dialogConfigSvc=(0,M.d)(S.b),this.contentType$=new f.t(null),this.loading$=new f.t(!1),this.viewStates={waiting:0,default:1,evaluated:2,imported:3},this.viewStateSelected$=new f.t(this.viewStates.default),this.evaluationResult$=new f.t(null),this.importResult$=new f.t(null),this.viewModel$=(0,m.z)([this.contentType$,this.loading$,this.viewStateSelected$,this.evaluationResult$,this.importResult$]).pipe((0,g.T)(([D,Q,J,Y,Z])=>({contentType:D,loading:Q,viewStateSelected:J,evaluationResult:Y,importResult:Z}))),this.errors={0:"Unknown error occured.",1:"Selected content-type does not exist.",2:"Document is not a valid XML file.",3:"Selected content-type does not match the content-type in the XML file.",4:"The language is not supported.",5:"The document does not specify all languages for all entities.",6:"Language reference cannot be parsed, the language is not supported.",7:"Language reference cannot be parsed, the read-write protection is not supported.",8:"Value cannot be read, because of it has an invalid format."},this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName")}ngOnInit(){this.loading$.next(!0);const e=this.contentTypesService.retrieveContentType(this.contentTypeStaticName),c=this.dialogConfigSvc.getCurrent$();(0,I.p)([e,c]).subscribe(([u,D])=>{this.contentType$.next(u),this.formValues={defaultLanguage:D.Context.Language.Primary,contentType:this.contentTypeStaticName,file:null!=this.dialogData.files?this.dialogData.files[0]:null,resourcesReferences:"Keep",clearEntities:"None"},this.loading$.next(!1)})}ngOnDestroy(){this.contentType$.complete(),this.loading$.complete(),this.viewStateSelected$.complete(),this.evaluationResult$.complete(),this.importResult$.complete()}closeDialog(){this.dialogRef.close()}evaluateContent(){this.viewStateSelected$.next(this.viewStates.waiting),this.contentImportService.evaluateContent(this.formValues).subscribe(e=>{this.evaluationResult$.next(e),this.viewStateSelected$.next(this.viewStates.evaluated)})}importContent(){this.viewStateSelected$.next(this.viewStates.waiting),this.contentImportService.importContent(this.formValues).subscribe(e=>{this.importResult$.next(e),this.viewStateSelected$.next(this.viewStates.imported)})}back(){this.viewStateSelected$.next(this.viewStates.default),this.evaluationResult$.next(null)}fileChange(e){this.formValues.file=e.target.files[0]}filesDropped(e){this.formValues.file=e[0]}static#t=this.\u0275fac=function(c){return new(c||i)(t.rXU(a.Vh),t.rXU(a.CP),t.rXU(P.nX))};static#e=this.\u0275cmp=t.VBU({type:i,selectors:[["app-content-import"]],hostVars:1,hostBindings:function(c,u){2&c&&t.Mr5("className",u.hostClass)},standalone:!0,features:[t.aNF],decls:2,vars:3,consts:[["ngForm","ngForm"],["fileInput",""],["appDragAndDrop","",1,"eav-dialog",3,"allowedFileTypes"],["appDragAndDrop","",1,"eav-dialog",3,"filesDropped","allowedFileTypes"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-description"],["href","https://2sxc.org/help","target","_blank"],[1,"eav-dialog-content"],["mat-raised-button","","tippy","Open file browser",3,"click"],["type","file",1,"hide",3,"change"],[1,"eav-radio-group-label"],["name","ResourcesReferences",1,"eav-radio-group",3,"ngModelChange","ngModel"],["value","Keep"],["value","Resolve"],["name","ClearEntities",1,"eav-radio-group",3,"ngModelChange","ngModel"],["value","None"],["value","All"],[1,"eav-hint"],["align","end"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"click","disabled"],[1,"eav-evaluation__title"],[1,"eav-evaluation__content"],["mat-raised-button","","color","accent",3,"click"]],template:function(c,u){if(1&c&&(t.DNE(0,H,11,3,"div",2),t.nI1(1,"async")),2&c){let D;t.vxM(0,(D=t.bMT(1,1,u.viewModel$))?0:-1,D)}},dependencies:[b.YN,b.qT,b.BC,b.cb,b.vS,b.cV,v.Hl,v.$z,l.Wk,l.VT,l._g,a.E7,R.Jj,x.S],styles:[".eav-radio-group-label[_ngcontent-%COMP%]{font-size:18px;margin:24px 0 0}.eav-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:8px 0}.eav-hint[_ngcontent-%COMP%]{font-size:18px;margin-top:24px;margin-bottom:16px}.eav-evaluation__title[_ngcontent-%COMP%]{font-size:18px;margin:24px 0 0;font-weight:700}.eav-evaluation__content[_ngcontent-%COMP%]{font-size:14px}.eav-evaluation__content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:2px 0}"]})}return i})()},3140:(O,E,n)=>{n.d(E,{J:()=>m});var a=n(7092),f=n(7580);let m=(()=>{class g{constructor(){this.subscriptions=new a.yU}ngOnDestroy(){this.subscriptions.unsubscribe()}static#t=this.\u0275fac=function(C){return new(C||g)};static#e=this.\u0275dir=f.FsC({type:g})}return g})()},4575:(O,E,n)=>{n.d(E,{S:()=>I});var a=n(7580),f=n(8537),m=n(3140),g=n(3347);let I=(()=>{class _ extends m.J{constructor(r,s,o){super(),this.zone=s,this.snackBar=o,this.markStyle="outline",this.allowedFileTypes="",this.filesDropped=new a.bkB,this.dropAreaClass="eav-droparea",this.dragClass="eav-dragover",this.timeouts=[],this.element=r.nativeElement}ngOnInit(){this.markStyleClass=`eav-droparea-${this.markStyle}`,this.element.classList.add(this.dropAreaClass,this.markStyleClass),this.zone.runOutsideAngular(()=>{this.subscriptions.add((0,f.R)(this.element,"dragover").subscribe(r=>{r.preventDefault(),r.stopPropagation(),this.clearTimeouts(),this.element.classList.add(this.dragClass)})),this.subscriptions.add((0,f.R)(this.element,"dragleave").subscribe(r=>{r.preventDefault(),r.stopPropagation(),this.timeouts.push(window.setTimeout(()=>{this.element.classList.remove(this.dragClass)},50))}))})}ngOnDestroy(){this.clearTimeouts(),this.element.classList.remove(this.dropAreaClass,this.markStyleClass,this.dragClass),super.ngOnDestroy()}onDrop(r){r.preventDefault(),r.stopPropagation(),this.clearTimeouts(),this.element.classList.remove(this.dragClass);let o=Array.from(r.dataTransfer.files);o=this.filterTypes(o,this.allowedFileTypes),o.length>0&&this.filesDropped.emit(o)}clearTimeouts(){for(const r of this.timeouts)clearTimeout(r);this.timeouts=[]}filterTypes(r,s){if(""===s)return r;const o=s.split(",").map(t=>t.toLocaleLowerCase()),p=r.filter(t=>{const h=t.name.lastIndexOf(".");if(h<=0)return!1;const T=t.name.substring(h+1).toLocaleLowerCase();return o.includes(T)});if(r.length!==p.length){const t=this.allowedFileTypes.replace(/\,/g,", ");this.snackBar.open(p.length?"Some files were filtered out. This drop location only accepts file types: "+t:"This drop location only accepts file types: "+t,null,{duration:5e3})}return p}static#t=this.\u0275fac=function(s){return new(s||_)(a.rXU(a.aKT),a.rXU(a.SKi),a.rXU(g.UG))};static#e=this.\u0275dir=a.FsC({type:_,selectors:[["","appDragAndDrop",""]],hostBindings:function(s,o){1&s&&a.bIt("drop",function(t){return o.onDrop(t)})},inputs:{markStyle:"markStyle",allowedFileTypes:"allowedFileTypes"},outputs:{filesDropped:"filesDropped"},standalone:!0,features:[a.Vt3]})}return _})()},693:(O,E,n)=>{function a(m){return new Promise((g,I)=>{const _=new FileReader;_.readAsDataURL(m),_.onload=()=>{g(_.result.split(",")[1])},_.onerror=C=>{I(C)}})}function f(m){return new Promise((g,I)=>{const _=new FileReader;_.readAsText(m),_.onload=()=>{g(_.result)},_.onerror=C=>{I(C)}})}n.d(E,{d:()=>f,n:()=>a})},9234:(O,E,n)=>{n.d(E,{Gg:()=>h,Tr:()=>T,gb:()=>t});var a=n(1567),f=n(6647),m=n(6301),g=n(271),I=n(5506),_=n(4839),C=n(5437),r=n(7580),s=n(6443),o=n(4821);const p={enabled:!1,name:"EntityService",specs:{all:!1,getEntities:!1,getAvailableEntities:!1,delete:!1}},t="admin/entity/",h="admin/entity/list";let T=(()=>{class d{constructor(l,v){this.http=l,this.dnnContext=v,this.queryService=(0,C.d)(_.c),this.log=new I.B(p)}getEntities$(l){return this.log.fnIf("getEntities"),l.pipe((0,a.p)(v=>null!=v),(0,f.n)(v=>this.getAvailableEntities(v.contentTypeName).pipe((0,m.t)(1))))}getAvailableEntities(l,v){return this.log.fnIf("getAvailableEntities"),this.queryService.getEntities({contentTypes:[l],itemIds:v,fields:"Id,Guid,Title",log:"getAvailableEntities"}).pipe((0,g.T)(x=>x.Default))}delete(l,v,b,x,M,S){return this.log.fnIf("delete",{appId:l,contentType:v,entityId:b,force:x,parentId:M,parent}),this.http.delete(this.dnnContext.$2sxc.http.apiUrl(t+"delete"),{params:{contentType:v,id:b.toString(),appId:l,force:x.toString(),...M&&{parentId:M.toString()},...M&&S&&{parentField:S}}})}static#t=this.\u0275fac=function(v){return new(v||d)(r.KVO(s.Qq),r.KVO(o.ob))};static#e=this.\u0275prov=r.jDH({token:d,factory:d.\u0275fac})}return d})()},9431:(O,E,n)=>{n.d(E,{B:()=>I});var a=n(7580),f=n(9074),m=n(8172),g=n(3347);let I=(()=>{class _{constructor(r){this.snackBar=r,this.debugState=(0,a.vPA)(null),this.isDebug=(0,a.EWP)(()=>!!this.debugState()?.allowDebugMode&&!!this.debugState()?.debugEnabled),this.debugEnabled$=(0,f.br)(this.isDebug);const s={id:0,debugEnabled:"true"===sessionStorage.getItem(m.tn),allowDebugMode:!1};this.debugState.set(s)}allowDebug(r){const s=this.debugState();if(s.allowDebugMode===r)return;const o={...s,allowDebugMode:r};this.debugState.set(o)}toggleDebugEnabled(){const r=this.debugState();if(!r.allowDebugMode)return void this.snackBar.open("You do not have permissions to enter developer mode",null,{duration:3e3});const s={...r,debugEnabled:!r.debugEnabled};this.debugState.set(s),this.snackBar.open(s.debugEnabled?"developer mode on":"developer mode off",null,{duration:3e3})}static#t=this.\u0275fac=function(s){return new(s||_)(a.KVO(g.UG))};static#e=this.\u0275prov=a.jDH({token:_,factory:_.\u0275fac,providedIn:"root"})}return _})()},4839:(O,E,n)=>{n.d(E,{c:()=>_});var a=n(5506),f=n(8873),m=n(7580),g=n(6443);const I={enabled:!1,name:"QueryService",specs:{all:!1,getAvailableEntities:!1,getEntities:!1}};let _=(()=>{class C{constructor(s,o){this.http=s,this.context=o,this.log=new a.B(I)}getAvailableEntities(s,o,p,t){this.log.fnIf("getAvailableEntities",{queryUrl:s,params:o,fields:p,entitiesFilter:t});const h=!!o,l=(((o?.toLocaleLowerCase()??"").includes("appid=")?"":`&appId=${this.context.appId}`)+(h?`&${o}`:"")+"&$select="+(p??"")).substring(1);return this.http.post(`app/auto/query/${s}?${l}`,{Guids:t})}getEntities({contentTypes:s,itemIds:o,fields:p,log:t}){this.log.fnIf("getEntities",{log:t,contentTypes:s,itemIds:o,fields:p});const T=("&typeNames="+(s?.join(",")??"")+`&appId=${this.context.appId}&itemIds=`+(o?.join(",")??"")+"&$select="+(p??"")).substring(1);return this.http.post(`app/auto/query/System.EntityPicker/Default?${T}`,{})}static#t=this.\u0275fac=function(o){return new(o||C)(m.KVO(g.Qq),m.KVO(f.o))};static#e=this.\u0275prov=m.jDH({token:C,factory:C.\u0275fac})}return C})()},9074:(O,E,n)=>{n.d(E,{br:()=>C,ot:()=>r});var a=n(7580),f=n(6042);function C(s,o){!o?.injector&&(0,a.Af3)(C);const p=o?.injector??(0,a.WQX)(a.zZn),t=new f.m(1),h=(0,a.QZP)(()=>{let T;try{T=s()}catch(d){return void(0,a.O8t)(()=>t.error(d))}(0,a.O8t)(()=>t.next(T))},{injector:p,manualCleanup:!0});return p.get(a.abz).onDestroy(()=>{h.destroy(),t.complete()}),t.asObservable()}function r(s,o){const p=!o?.manualCleanup;p&&!o?.injector&&(0,a.Af3)(r);const t=p?o?.injector?.get(a.abz)??(0,a.WQX)(a.abz):null;let h;h=(0,a.vPA)(o?.requireSync?{kind:0}:{kind:1,value:o?.initialValue});const T=s.subscribe({next:d=>h.set({kind:1,value:d}),error:d=>{if(o?.rejectErrors)throw d;h.set({kind:2,error:d})}});return t?.onDestroy(T.unsubscribe.bind(T)),(0,a.EWP)(()=>{const d=h();switch(d.kind){case 1:return d.value;case 2:throw d.error;case 0:throw new a.wOt(601,"`toSignal()` called with `requireSync` but `Observable` did not emit synchronously.")}})}}}]);
//# sourceMappingURL=https://sources.2sxc.org/18.00.02/dist/ng-edit/projects_eav-ui_src_app_content-import_content-import_component_ts.6f631958a9f326da.js.map