"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_metadata_metadata_component_ts-projects_eav-ui_src_app_shared_fields_-53fb0d","projects_eav-ui_src_app_permissions_permissions_routing_ts"],{7693:(M,u,e)=>{e.d(u,{X:()=>g,g:()=>r});var t=e(271),m=e(6474),o=e(7580);const g="admin/type/",h="admin/type/scopes";let r=(()=>{class d extends m.D{retrieveContentType(_){return this.http.get(this.apiUrl("admin/type/get"),{params:{appId:this.appId,contentTypeId:_}})}retrieveContentTypes(_){return this.http.get(this.apiUrl("admin/type/list"),{params:{appId:this.appId,scope:_}})}getScopes(){return this.http.get(this.apiUrl(h),{params:{appId:this.appId}}).pipe((0,t.T)(_=>{const D=_.old;return Object.keys(D).map(R=>({name:D[R],value:R}))}))}getScopesV2(){return this.http.get(this.apiUrl(h),{params:{appId:this.appId}}).pipe((0,t.T)(_=>_.scopes))}save(_){return this.http.post(this.apiUrl("admin/type/save"),_,{params:{appid:this.appId}})}delete(_){return this.http.delete(this.apiUrl("admin/type/delete"),{params:{appid:this.appId,staticName:_.StaticName}})}import(_){const D=new FormData;for(const I of _)D.append("File",I);return this.http.post(this.apiUrl("admin/type/import"),D,{params:{appId:this.appId,zoneId:this.zoneId}})}createGhost(_){return this.http.post(this.apiUrl("admin/type/addghost"),null,{params:{appid:this.appId,sourceStaticName:_}})}static#t=this.\u0275fac=(()=>{let _;return function(I){return(_||(_=o.xGo(d)))(I||d)}})();static#e=this.\u0275prov=o.jDH({token:d,factory:d.\u0275fac})}return d})()},1475:(M,u,e)=>{e.d(u,{j:()=>c});var t=e(8873),m=e(8624),o=e(7580),g=e(6443),l=e(4821);let c=(()=>{class h{constructor(v,f,p){this.http=v,this.context=f,this.dnnContext=p}getContentInfo(v){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(m.Q+"Get"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),scope:v}})}exportParts(v,f,p){const r=this.dnnContext.$2sxc.http.apiUrl(m.Q+"Export")+"?appId="+this.context.appId.toString()+"&zoneId="+this.context.zoneId.toString()+"&contentTypeIdsString="+v.join(";")+"&entityIdsString="+f.join(";")+"&templateIdsString="+p.join(";");window.open(r,"_blank","")}static#t=this.\u0275fac=function(f){return new(f||h)(o.KVO(g.Qq),o.KVO(t.o),o.KVO(l.ob))};static#e=this.\u0275prov=o.jDH({token:h,factory:h.\u0275fac})}return h})()},320:(M,u,e)=>{e.d(u,{t:()=>c});var t=e(1772),m=e(8873),o=e(7580),g=e(6443),l=e(4821);let c=(()=>{class h{constructor(v,f,p){this.http=v,this.context=f,this.dnnContext=p}getAppInfo(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(t.u+"Statistics"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}exportAppUrl(){return`${this.dnnContext.$2sxc.http.apiUrl(`${t.u}Export`)}?appId=${this.context.appId}&zoneId=${this.context.zoneId}`}exportForVersionControl({includeContentGroups:v,resetAppGuid:f,withFiles:p}){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(t.u+"SaveData"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),includeContentGroups:v.toString(),resetAppGuid:f.toString(),withPortalFiles:p.toString()}})}static#t=this.\u0275fac=function(f){return new(f||h)(o.KVO(g.Qq),o.KVO(m.o),o.KVO(l.ob))};static#e=this.\u0275prov=o.jDH({token:h,factory:h.\u0275fac})}return h})()},8624:(M,u,e)=>{e.d(u,{Q:()=>c,S:()=>h});var t=e(1772),m=e(8873),o=e(7580),g=e(6443),l=e(4821);const c="admin/appParts/";let h=(()=>{class E{constructor(f,p,r){this.http=f,this.context=p,this.dnnContext=r}importAppParts(f){const p=new FormData;return p.append("File",f),this.http.post(this.dnnContext.$2sxc.http.apiUrl(c+"Import"),p,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}resetApp(f){return this.http.post(this.dnnContext.$2sxc.http.apiUrl(t.u+"Reset"),{},{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),withPortalFiles:f.toString()}})}static#t=this.\u0275fac=function(p){return new(p||E)(o.KVO(g.Qq),o.KVO(m.o),o.KVO(l.ob))};static#e=this.\u0275prov=o.jDH({token:E,factory:E.\u0275fac})}return E})()},5445:(M,u,e)=>{e.d(u,{Cu:()=>c.Cu,JL:()=>c.JL,Mk:()=>c.Mk,ei:()=>c.ei,gs:()=>m.g,tr:()=>t.t,vN:()=>c.vN,xR:()=>c.xR,y0:()=>h.y});var t=e(1479),m=e(7693),c=(e(1475),e(320),e(8624),e(6460)),h=e(2570)},6460:(M,u,e)=>{e.d(u,{Cu:()=>_,JL:()=>D,Mk:()=>d,ei:()=>C,vN:()=>I,xR:()=>R});var t=e(4600),m=e(6647),o=e(271),g=e(693),l=e(8873),c=e(9234),h=e(7580),E=e(6443),v=e(4821);const d="admin/query/Run",C="admin/query/DebugStream",_="admin/query/Save",D="admin/query/Get",I="admin/query/DataSources";let R=(()=>{class F{constructor(P,T,U){this.http=P,this.context=T,this.dnnContext=U}getAll(P){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(c.Gg),{params:{appId:this.context.appId.toString(),contentType:P}})}importQuery(P){return(0,t.H)((0,g.n)(P)).pipe((0,m.n)(T=>this.http.post(this.dnnContext.$2sxc.http.apiUrl("admin/query/import"),{AppId:this.context.appId.toString(),ContentBase64:T})),(0,o.T)(T=>({Success:T,Messages:[]})))}clonePipeline(P){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/query/Clone"),{params:{Id:P.toString(),appId:this.context.appId.toString()}})}delete(P){return this.http.delete(this.dnnContext.$2sxc.http.apiUrl("admin/query/Delete"),{params:{appId:this.context.appId.toString(),Id:P.toString()}})}static#t=this.\u0275fac=function(T){return new(T||F)(h.KVO(E.Qq),h.KVO(l.o),h.KVO(v.ob))};static#e=this.\u0275prov=h.jDH({token:F,factory:F.\u0275fac})}return F})()},2570:(M,u,e)=>{e.d(u,{y:()=>p});var t=e(8873),m=e(7580),o=e(6443),g=e(4821);const l="admin/view/",c=l+"all",h=l+"delete",E=l+"import",v=l+"polymorphism",f=l+"usage";let p=(()=>{class r{constructor(C,_,D){this.http=C,this.context=_,this.dnnContext=D}getAll(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(c),{params:{appId:this.context.appId.toString()}})}delete(C){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(h),{params:{appId:this.context.appId.toString(),Id:C.toString()}})}import(C){const _=new FormData;return _.append("File",C),this.http.post(this.dnnContext.$2sxc.http.apiUrl(E),_,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}export(C){const _=this.dnnContext.$2sxc.http.apiUrl(l+"json")+"?appId="+this.context.appId+"&viewId="+C;window.open(_,"_blank","")}getPolymorphism(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(v),{params:{appId:this.context.appId.toString()}})}getUsage(C){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(f),{params:{appId:this.context.appId.toString(),guid:C}})}static#t=this.\u0275fac=function(_){return new(_||r)(m.KVO(o.Qq),m.KVO(t.o),m.KVO(g.ob))};static#e=this.\u0275prov=m.jDH({token:r,factory:r.\u0275fac})}return r})()},4305:(M,u,e)=>{e.r(u),e.d(u,{MetadataComponent:()=>Et});var t=e(7580),m=e(7941),o=e(2159),g=e(4334),l=e(271),c=e(336),h=e(6817),E=e(4096),v=e(251),f=e(3216),p=e(334),r=e(4175),d=e(3777),C=e(9914);function _(a,y){if(1&a&&(t.nrm(0,"mat-card-subtitle",0),t.nI1(1,"safeHtml")),2&a){const n=t.XpG();t.Y8G("innerHtml",t.bMT(1,1,n.dialogData.message),t.npT)}}let D=(()=>{class a{constructor(n,s){this.dialogData=n,this.dialogRef=s,this.hostClass="dialog-component"}closeDialog(n){this.dialogRef.close(n)}static#t=this.\u0275fac=function(s){return new(s||a)(t.rXU(m.Vh),t.rXU(m.CP))};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["app-confirm-delete-dialog"]],hostVars:1,hostBindings:function(s,i){2&s&&t.Mr5("className",i.hostClass)},standalone:!0,features:[t.aNF],decls:10,vars:3,consts:[[3,"innerHtml"],["align","end"],["mat-raised-button","",1,"eav-card-action-button",3,"click"]],template:function(s,i){1&s&&(t.j41(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),t.EFF(3),t.k0s(),t.DNE(4,_,2,3,"mat-card-subtitle",0),t.k0s(),t.j41(5,"mat-card-actions",1)(6,"button",2),t.bIt("click",function(){return i.closeDialog()}),t.EFF(7,"Cancel"),t.k0s(),t.j41(8,"button",2),t.bIt("click",function(){return i.closeDialog(!0)}),t.EFF(9,"Delete"),t.k0s()()()),2&s&&(t.R7$(3),t.Lme("Delete ",i.dialogData.entityTitle," (",i.dialogData.entityId,")?"),t.R7$(),t.vxM(4,i.dialogData.message?4:-1))},dependencies:[d.Hu,d.RN,d.YY,d.MM,d.Lc,d.dh,r.Hl,r.$z,C.$],styles:[".eav-card-action-button[_ngcontent-%COMP%]{margin-left:8px}"]})}return a})();var I=e(3840),R=e(5060);let F=(()=>{class a{agInit(n){this.params=n}refresh(n){return!0}deleteMetadata(){this.params.onDelete(this.params.data)}static#t=this.\u0275fac=function(s){return new(s||a)};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["app-metadata-actions"]],standalone:!0,features:[t.aNF],decls:4,vars:0,consts:[[1,"actions-component"],["matRipple","","tippy","Delete",1,"eav-grid-action-button","highlight",3,"click"]],template:function(s,i){1&s&&(t.j41(0,"div",0)(1,"div",1),t.bIt("click",function(){return i.deleteMetadata()}),t.j41(2,"mat-icon"),t.EFF(3,"delete"),t.k0s()()())},dependencies:[R.pZ,R.r6,I.m_,I.An]})}return a})();var Y=e(7896);let P=(()=>{class a{agInit(n){this.value=n.value,this.metadata=n.data}refresh(n){return!0}static#t=this.\u0275fac=function(s){return new(s||a)};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["app-metadata-content-type"]],standalone:!0,features:[t.aNF],decls:2,vars:3,consts:[[1,"container",3,"tippy","tippyDisabled"]],template:function(s,i){1&s&&(t.j41(0,"div",0),t.EFF(1),t.k0s()),2&s&&(t.Y8G("tippy",i.metadata._Type.Description)("tippyDisabled",!i.metadata._Type.Description),t.R7$(),t.SpI(" ",i.value,"\n"))},dependencies:[Y.e],styles:[".container[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content}"]})}return a})();var T=e(4456),U=e(8827),X=e(3037),H=e(1817),z=e(5445),K=e(5858),$=e(52),L=e(316),G=e(7984),W=e(5175),B=e(5944),Q=e(3758),J=e(9333),A=e(5437);const N=a=>({active:a});function Z(a,y){if(1&a&&(t.j41(0,"mat-option",14),t.EFF(1),t.k0s()),2&a){const n=y.$implicit;t.Y8G("value",n.value),t.R7$(),t.SpI(" ",n.name," ")}}function w(a,y){if(1&a&&(t.j41(0,"mat-form-field",2)(1,"mat-label"),t.EFF(2,"Scope"),t.k0s(),t.j41(3,"mat-select",13),t.Z7z(4,Z,2,2,"mat-option",14,t.fX1),t.j41(6,"mat-option",14),t.EFF(7,"Other..."),t.k0s()()(),t.j41(8,"app-field-hint"),t.EFF(9," The scope should almost never be changed - "),t.j41(10,"a",15),t.EFF(11,"see help"),t.k0s()()),2&a){const n=t.XpG();t.R7$(3),t.Y8G("placeholder",n.scopeOptions().length?"":"No items found"),t.R7$(),t.Dyx(n.scopeOptions()),t.R7$(2),t.Y8G("value",n.dropdownInsertValue)}}function q(a,y){if(1&a&&(t.j41(0,"mat-option",14),t.EFF(1),t.k0s()),2&a){const n=y.$implicit;t.Y8G("value",n.StaticName),t.R7$(),t.SpI(" ",n.Label," ")}}function tt(a,y){if(1&a&&(t.j41(0,"mat-select",3),t.Z7z(1,q,2,2,"mat-option",14,t.fX1),t.k0s()),2&a){const n=t.XpG();t.Y8G("placeholder",n.contentTypes().length?"":"No items found"),t.R7$(),t.Dyx(n.contentTypes())}}function et(a,y){1&a&&t.nrm(0,"input",4)}function nt(a,y){1&a&&(t.j41(0,"app-field-hint",8),t.EFF(1," This field is required "),t.k0s()),2&a&&t.Y8G("isError",!0)}let at=(()=>{class a{constructor(n){this.dialogRef=n,this.hostClass="dialog-component",this.dropdownInsertValue=K.O,this.guidedContentType=!0,this.advancedMode=!1,this.contentTypes=(0,t.vPA)([]),this.scopeOptions=(0,t.vPA)([]),this.contentTypesService=(0,A.d)(z.gs)}ngOnInit(){this.buildForm(),this.fetchScopes()}closeDialog(n){this.dialogRef.close(n)}toggleGuidedContentType(n){this.guidedContentType=n}toggleAdvancedMode(n){this.advancedMode=n.checked}confirm(){const n=this.form.getRawValue();this.closeDialog(n.contentType)}buildForm(){this.form=new T.J3({}),this.form.addControl("contentType",new T.hs(null,[T.k0.required])),this.form.addControl("scope",new T.hs($.YX.scopes.default.value)),this.form.controls.scope.valueChanges.pipe((0,X.Z)(this.form.controls.scope.value),(0,H.F)()).subscribe(n=>{null!=this.form.controls.contentType.value&&this.form.controls.contentType.patchValue(null),n===K.O?(n=prompt("This is an advanced feature to show content-types of another scope. Don't use this if you don't know what you're doing, as content-types of other scopes are usually hidden for a good reason.")||$.YX.scopes.default.value,this.scopeOptions().some(s=>s.value===n)||this.scopeOptions.set([{name:n,value:n},...this.scopeOptions()]),this.form.controls.scope.patchValue(n)):this.fetchContentTypes(n)})}fetchContentTypes(n){this.contentTypesService.retrieveContentTypes(n).subscribe(s=>{this.contentTypes.set(s)})}fetchScopes(){this.contentTypesService.getScopes().subscribe(n=>{this.scopeOptions.set(n)})}static#t=this.\u0275fac=function(s){return new(s||a)(t.rXU(m.CP))};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["app-metadata-save-dialog"]],hostVars:1,hostBindings:function(s,i){2&s&&t.Mr5("className",i.hostClass)},standalone:!0,features:[t.aNF],decls:33,vars:14,consts:[["href","https://go.2sxc.org/metadata","target","_blank"],[3,"formGroup"],["color","accent",1,"eav-mat-form-field"],["formControlName","contentType","required","",3,"placeholder"],["matInput","","type","text","formControlName","contentType","required",""],["matTextSuffix",""],["mat-icon-button","","type","button","tippy","Pick existing value",3,"click","ngClass"],["mat-icon-button","","type","button","tippy","Manual entry",3,"click","ngClass"],[3,"isError"],[1,"eav-card-actions"],["color","accent",3,"change","checked"],["mat-raised-button","",1,"eav-card-action-button",3,"click"],["mat-raised-button","","color","accent",1,"eav-card-action-button",3,"click","disabled"],["formControlName","scope",3,"placeholder"],[3,"value"],["href","https://2sxc.org/help?tag=scope","target","_blank","appClickStopPropagation",""]],template:function(s,i){1&s&&(t.j41(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),t.EFF(3,"Create Metadata"),t.k0s(),t.j41(4,"mat-card-subtitle"),t.EFF(5," This is a special operation to add an item which is metadata for another item, see "),t.j41(6,"a",0),t.EFF(7,"docs"),t.k0s(),t.EFF(8,". "),t.k0s()(),t.j41(9,"mat-card-content")(10,"form",1),t.DNE(11,w,12,2),t.j41(12,"mat-form-field",2)(13,"mat-label"),t.EFF(14,"Content Type"),t.k0s(),t.DNE(15,tt,3,1,"mat-select",3)(16,et,1,0,"input",4),t.j41(17,"div",5)(18,"button",6),t.bIt("click",function(){return i.toggleGuidedContentType(!0)}),t.j41(19,"mat-icon"),t.EFF(20,"search"),t.k0s()(),t.j41(21,"button",7),t.bIt("click",function(){return i.toggleGuidedContentType(!1)}),t.j41(22,"mat-icon"),t.EFF(23,"text_fields"),t.k0s()()()(),t.DNE(24,nt,2,1,"app-field-hint",8),t.k0s()(),t.j41(25,"mat-card-actions",9)(26,"mat-slide-toggle",10),t.bIt("change",function(x){return i.toggleAdvancedMode(x)}),t.EFF(27),t.k0s(),t.j41(28,"div")(29,"button",11),t.bIt("click",function(){return i.closeDialog()}),t.EFF(30,"Cancel"),t.k0s(),t.j41(31,"button",12),t.bIt("click",function(){return i.confirm()}),t.EFF(32," Confirm "),t.k0s()()()()),2&s&&(t.R7$(10),t.Y8G("formGroup",i.form),t.R7$(),t.vxM(11,i.advancedMode&&i.guidedContentType?11:-1),t.R7$(4),t.vxM(15,i.guidedContentType?15:-1),t.R7$(),t.vxM(16,i.guidedContentType?-1:16),t.R7$(2),t.Y8G("ngClass",t.eq3(10,N,i.guidedContentType)),t.R7$(3),t.Y8G("ngClass",t.eq3(12,N,!i.guidedContentType)),t.R7$(3),t.vxM(24,i.form.controls.contentType.touched&&null!=i.form.controls.contentType.errors&&i.form.controls.contentType.errors.required?24:-1),t.R7$(2),t.Y8G("checked",i.advancedMode),t.R7$(),t.SpI(" ",i.advancedMode?"Advanced":"Simple"," "),t.R7$(4),t.Y8G("disabled",!i.form.valid))},dependencies:[d.Hu,d.RN,d.YY,d.m2,d.MM,d.Lc,d.dh,T.YN,T.qT,T.me,T.BC,T.cb,T.YS,T.X1,T.j4,T.JD,B.RG,B.rl,B.nJ,B.yw,W.Ve,W.VO,R.wT,R.Sy,G.fS,G.fg,r.Hl,r.$z,r.iY,L.YU,I.m_,I.An,U.mV,U.sG,Q.F,J.c],styles:[".eav-card-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.eav-card-action-button[_ngcontent-%COMP%]{margin-left:8px}"]})}return a})();var ot=e(5541),V=e(6256),j=e(3183),it=e(7037),b=e(1828),st=e(1897),rt=e(8471),pt=e(4435),lt=e(3347),dt=e(9841);const ct=a=>({"fab-opened":a});function mt(a,y){1&a&&t.EFF(0," This item is not metadata for anything else. ")}function ht(a,y){if(1&a&&(t.nrm(0,"br"),t.EFF(1)),2&a){const n=t.XpG(2);t.R7$(),t.SpI("Key Number: ",n.itemFor().KeyNumber," ")}}function _t(a,y){if(1&a&&(t.nrm(0,"br"),t.EFF(1)),2&a){const n=t.XpG(2);t.R7$(),t.SpI("Key Guid: ",n.itemFor().KeyGuid," ")}}function ut(a,y){if(1&a&&(t.nrm(0,"br"),t.EFF(1)),2&a){const n=t.XpG(2);t.R7$(),t.SpI("Key String: ",n.itemFor().KeyString," ")}}function gt(a,y){if(1&a&&(t.nrm(0,"br"),t.EFF(1)),2&a){const n=t.XpG(2);t.R7$(),t.SpI("Title: ",n.itemFor().Title," ")}}function ft(a,y){if(1&a&&(t.EFF(0," This item is metadata for: "),t.nrm(1,"br"),t.EFF(2),t.nrm(3,"br"),t.EFF(4),t.DNE(5,ht,2,1)(6,_t,2,1)(7,ut,2,1)(8,gt,2,1)),2&a){const n=t.XpG();t.R7$(2),t.SpI("Target: ",n.itemFor().Target," "),t.R7$(2),t.SpI("TargetType: ",n.itemFor().TargetType," "),t.R7$(),t.vxM(5,n.itemFor().KeyNumber?5:-1),t.R7$(),t.vxM(6,n.itemFor().KeyGuid?6:-1),t.R7$(),t.vxM(7,n.itemFor().KeyString?7:-1),t.R7$(),t.vxM(8,n.itemFor().Title?8:-1)}}function vt(a,y){if(1&a){const n=t.RV6();t.j41(0,"button",10),t.bIt("click",function(){t.eBV(n);const i=t.XpG();return t.Njj(i.createMetadata())}),t.j41(1,"mat-icon"),t.EFF(2,"add"),t.k0s()()}}function Ct(a,y){if(1&a&&(t.nrm(0,"div",19),t.nI1(1,"safeHtml")),2&a){const n=t.XpG().$implicit;t.Y8G("innerHTML",t.bMT(1,2,n.Icon),t.npT)("matBadgeHidden",n.Enabled)}}function Tt(a,y){1&a&&(t.j41(0,"mat-icon"),t.EFF(1,"add"),t.k0s())}function It(a,y){if(1&a){const n=t.RV6();t.j41(0,"button",18),t.bIt("click",function(){const i=t.eBV(n).$implicit,O=t.XpG(2);return t.Njj(O.createMetadata(i))}),t.DNE(1,Ct,2,4,"div",19)(2,Tt,2,0),t.k0s()}if(2&a){const n=y.$implicit;t.BMQ("label",n.Title),t.R7$(),t.vxM(1,n.Icon?1:2)}}function yt(a,y){if(1&a){const n=t.RV6();t.j41(0,"eco-fab-speed-dial",11),t.bIt("openChange",function(i){t.eBV(n);const O=t.XpG();return t.Njj(O.openChange(i))}),t.j41(1,"eco-fab-speed-dial-trigger",12)(2,"button",13)(3,"mat-icon",14),t.EFF(4),t.k0s()()(),t.j41(5,"eco-fab-speed-dial-actions",15)(6,"button",16),t.bIt("click",function(){t.eBV(n);const i=t.XpG();return t.Njj(i.createMetadata())}),t.j41(7,"mat-icon"),t.EFF(8,"search"),t.k0s()(),t.Z7z(9,It,3,2,"button",17,t.fX1),t.k0s()()}if(2&a){const n=t.XpG();t.Y8G("ngClass",t.eq3(3,ct,n.fabOpen())),t.R7$(),t.Y8G("spin",!0),t.R7$(3),t.JRh(n.fabOpen()?"close":"add"),t.R7$(5),t.Dyx(n.recommendations())}}let Et=(()=>{class a{#t;#e;#i;#a;constructor(n,s,i,O,x){this.dialogRef=n,this.snackBar=s,this.dialog=i,this.viewContainerRef=O,this.changeDetectorRef=x,this.log=(0,pt.T)({MetadataComponent:a}),this.#t=(0,A.d)(h.R),this.#e=(0,A.d)(E.TI),this.#i=(0,A.d)(c.F),this.#a=(0,A.d)(rt.c),this.gridOptions=this.#l(),this.fabOpen=(0,t.vPA)(!1),this.itemFor=(0,t.vPA)(void 0),this.metadataSet=(0,t.vPA)({Items:[],Recommendations:[]}),this.recommendations=(0,t.EWP)(()=>{const S=this.metadataSet();return S.Recommendations.filter(k=>S.Items.filter(Dt=>Dt._Type.Id===k.Id).length<k.Count)}),this.#n=(0,st.C)(this.#a.getParams(["targetType","keyType","key","title","contentTypeStaticName"]),S=>({targetType:parseInt(S.targetType,10),keyType:S.keyType,key:S.key,contentTypeStaticName:S.contentTypeStaticName})),this.title=decodeURIComponent(this.#a.getParam("title")??"")}#n;ngOnInit(){this.#r(),this.#o(),this.#a.doOnDialogClosed(()=>this.#o())}closeDialog(){this.dialogRef.close()}openChange(n){this.fabOpen.set(n)}createMetadata(n){if(n)return n.Enabled?void(n.CreateEmpty?(this.snackBar.open(`Creating ${n.Name}...`),this.#t.create(n.Id,{For:this.calculateItemFor("dummy").For}).subscribe({error:()=>{this.snackBar.open(`Creating ${n.Name} failed. Please check console for more info`,void 0,{duration:3e3}),this.#o()},next:()=>{this.snackBar.open(`Created ${n.Name}`,void 0,{duration:3e3}),this.#o()}})):this.createMetadataForm(n.Id)):void(0,ot.j)(this.dialog,n.MissingFeature,this.viewContainerRef,this.changeDetectorRef);this.dialog.open(at,{autoFocus:!1,viewContainerRef:this.viewContainerRef,width:"650px"}).afterClosed().subscribe(i=>{null!=i&&this.createMetadataForm(i)})}createMetadataForm(n){const s={items:[this.calculateItemFor(n)]},i=(0,f.s)(s);this.#a.navRelative([`edit/${i}`]),this.changeDetectorRef.markForCheck()}calculateItemFor(n){const s=p.c.constructMetadataInfo(this.#n.targetType,this.#n.keyType,this.#n.key);return p.c.newMetadataFromInfo(n,s)}#r(){this.#n.contentTypeStaticName&&this.#i.getAll(this.#n.contentTypeStaticName).subscribe(n=>{const s=n.find(i=>i.Guid===this.#n.key);s?.For&&this.itemFor.set(s.For)})}#o(){const n=this.log.rxTap("getMetadata");this.#e.getMetadata(this.#n.targetType,this.#n.keyType,this.#n.key).pipe(n.pipe(),(0,g.s)(1),(0,l.T)(s=>(s.Recommendations.forEach(i=>{i.Icon?.startsWith("base64:")&&(i.Icon=i.Icon.replace("base64:",""),i.Icon=window.atob(i.Icon),i.Icon=i.Icon.replace('fill="#000000"','fill="#ffffff"'))}),s)),n.map()).subscribe(s=>{this.metadataSet.set(s)})}#p(n){const s={items:[p.c.editId(n.Id)]},i=(0,f.s)(s);this.#a.navRelative([`edit/${i}`])}#s(n,s=!1){if(s)this.snackBar.open("Deleting..."),this.#t.delete(n._Type.Id,n.Id,!1).subscribe({next:()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.#o()},error:()=>{this.snackBar.open("Delete failed. Please check console for more information",null,{duration:3e3})}});else{const i={entityId:n.Id,entityTitle:n.Title,message:this.metadataSet().Recommendations.find(x=>x.Id===n._Type.Id)?.DeleteWarning};this.dialog.open(D,{autoFocus:!1,data:i,viewContainerRef:this.viewContainerRef,width:"400px"}).afterClosed().subscribe(x=>{x&&this.#s(n,!0)})}}#l(){return{...v.C,columnDefs:[{...b.r.IdWithDefaultRenderer,cellRendererParams:b.r.idFieldParamsTooltipGetter()},{...b.r.TextWide,field:"Title",onCellClicked:s=>this.#p(s.data)},{...b.r.TextWide,headerName:"Content Type",field:"ContentType",valueGetter:s=>`${s.data._Type.Name}${s.data._Type.Title!==s.data._Type.Name?` (${s.data._Type.Title})`:""}`,cellRenderer:P},{...b.r.ActionsPinnedRight1,cellRenderer:F,cellRendererParams:{onDelete:s=>this.#s(s)}}]}}static#d=this.\u0275fac=function(s){return new(s||a)(t.rXU(m.CP),t.rXU(lt.UG),t.rXU(m.bZ),t.rXU(t.c1b),t.rXU(t.gRc))};static#c=this.\u0275cmp=t.VBU({type:a,selectors:[["app-metadata"]],standalone:!0,features:[t.aNF],decls:17,vars:6,consts:[[1,"eav-dialog","nav-component-wrapper"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"eav-dialog-content","nav-component-wrapper"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","gridOptions"],["align","end"],["mat-fab","","mat-elevation-z24","","tippy","Create a new metadata for this item",1,"grid-fab"],[1,"eav-eco-fab-speed-dial",3,"ngClass"],["mat-fab","","mat-elevation-z24","","tippy","Create a new metadata for this item",1,"grid-fab",3,"click"],[1,"eav-eco-fab-speed-dial",3,"openChange","ngClass"],[3,"spin"],["mat-fab",""],[1,"spin180"],[1,"eav-eco-fab-speed-dial-actions"],["mat-mini-fab","","label","Other Content Type",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["mat-mini-fab","",1,"eav-eco-fab-speed-dial-action-button"],["mat-mini-fab","",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["matBadgeColor","accent","matBadgeSize","small","matBadge","\u{1f48e}","matBadgePosition","below after","aria-hidden","false",2,"color","white","fill","white",3,"innerHTML","matBadgeHidden"]],template:function(s,i){1&s&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.EFF(3),t.k0s(),t.j41(4,"button",3),t.bIt("click",function(){return i.closeDialog()}),t.j41(5,"mat-icon"),t.EFF(6,"close"),t.k0s()()(),t.j41(7,"div",4)(8,"p"),t.DNE(9,mt,1,0)(10,ft,9,6),t.k0s(),t.nrm(11,"router-outlet"),t.j41(12,"div",5),t.nrm(13,"ag-grid-angular",6),t.k0s()(),t.j41(14,"mat-dialog-actions",7),t.DNE(15,vt,3,0,"button",8)(16,yt,11,5,"eco-fab-speed-dial",9),t.k0s()()),2&s&&(t.R7$(3),t.SpI(" ",i.title||"Metadata"," "),t.R7$(6),t.vxM(9,i.itemFor()?10:9),t.R7$(4),t.Y8G("rowData",i.metadataSet().Items)("gridOptions",i.gridOptions),t.R7$(2),t.vxM(15,0===i.recommendations().length?15:-1),t.R7$(),t.vxM(16,i.recommendations().length>0?16:-1))},dependencies:[r.Hl,r.iY,r.$0,r.Sr,I.m_,I.An,o.n3,it.p,dt.xs,m.E7,j.TE,L.YU,j.p1,j.yf,V.Y,V.k,C.$],styles:["[_nghost-%COMP%]     .mat-button-wrapper div svg *:not([fill]){fill:#fff}"]})}return a})()},2437:(M,u,e)=>{e.d(u,{k:()=>m});var t=e(52);let m=(()=>{class o{static#t=this.route={path:"permissions/:targetType/:keyType/:key",loadChildren:()=>e.e("projects_eav-ui_src_app_permissions_permissions_routing_ts").then(e.bind(e,3516)).then(l=>l.permissionRoutes),data:{title:"Permissions"}};static getUrl(l,c,h){return`permissions/${l}/${c}/${h}`}static getUrlApp(l){return this.getUrl(t.YX.metadata.app.targetType,t.YX.metadata.app.keyType,l.toString())}static getUrlAttribute(l){return this.getUrl(t.YX.metadata.attribute.targetType,t.YX.metadata.attribute.keyType,l.toString())}static getUrlContentType(l){return this.getUrlEntity(l)}static getUrlEntity(l){return this.getUrl(t.YX.metadata.entity.targetType,t.YX.metadata.entity.keyType,l)}static getUrlLanguage(l){return this.getUrl(t.YX.metadata.language.targetType,t.YX.metadata.language.keyType,l)}}return o})()},4096:(M,u,e)=>{e.d(u,{Kn:()=>c.K,TI:()=>l.T,k4:()=>t.k});var t=e(2437),l=(e(2365),e(3516),e(2458),e(401)),c=e(4900)},2365:(M,u,e)=>{e.d(u,{v:()=>m});var t=e(9204);const m={name:"SET_PERMISSIONS_DIALOG",initContext:!0,panelSize:"large",panelClass:null,getComponent:()=>(0,t.A)(function*(){const{PermissionsComponent:o}=yield Promise.all([e.e("default-node_modules_angular_forms_fesm2022_forms_mjs"),e.e("default-projects_eav-ui_src_app_shared_directives_tippy_directive_ts"),e.e("default-node_modules_angular_material_fesm2022_radio_mjs"),e.e("default-projects_eav-ui_src_app_shared_constants_default-grid-options_constants_ts-projects_e-814394"),e.e("default-projects_eav-ui_src_app_permissions_permissions_component_ts")]).then(e.bind(e,2458));return o})()}},3516:(M,u,e)=>{e.r(u),e.d(u,{permissionRoutes:()=>g});var t=e(5544),m=e(2365),o=e(1195);const g=[{path:"",component:t.DialogEntryComponent,data:{dialog:m.v},children:o.RD}]},3758:(M,u,e)=>{e.d(u,{F:()=>p});var t=e(316),m=e(5944),o=e(7580);const g=["*"],l=r=>({"hint-box__short":r});function c(r,d){1&r&&o.eu8(0)}function h(r,d){if(1&r&&(o.j41(0,"mat-hint"),o.DNE(1,c,1,0,"ng-container",2),o.k0s()),2&r){o.XpG();const C=o.sdS(4);o.R7$(),o.Y8G("ngTemplateOutlet",C)}}function E(r,d){1&r&&o.eu8(0)}function v(r,d){if(1&r&&(o.j41(0,"mat-error"),o.DNE(1,E,1,0,"ng-container",2),o.k0s()),2&r){o.XpG();const C=o.sdS(4);o.R7$(),o.Y8G("ngTemplateOutlet",C)}}function f(r,d){1&r&&o.SdG(0)}let p=(()=>{class r{constructor(){this.isError=!1,this.isShort=!0}toggleIsShort(){this.isShort=!this.isShort}static#t=this.\u0275fac=function(_){return new(_||r)};static#e=this.\u0275cmp=o.VBU({type:r,selectors:[["app-field-hint"]],inputs:{isError:"isError"},standalone:!0,features:[o.aNF],ngContentSelectors:g,decls:5,vars:4,consts:[["content",""],[1,"hint-box",3,"click","ngClass"],[4,"ngTemplateOutlet"]],template:function(_,D){if(1&_){const I=o.RV6();o.NAR(),o.j41(0,"div",1),o.bIt("click",function(){return o.eBV(I),o.Njj(D.toggleIsShort())}),o.DNE(1,h,2,1)(2,v,2,1),o.k0s(),o.DNE(3,f,1,0,"ng-template",null,0,o.C5r)}if(2&_){let I;o.Y8G("ngClass",o.eq3(2,l,D.isShort)),o.R7$(),o.vxM(1,!1===(I=D.isError)?1:!0===I?2:-1)}},dependencies:[m.RG,m.MV,m.TL,t.YU,t.T3],styles:[".hint-box[_ngcontent-%COMP%]{margin-top:4px}.hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{font-size:12px;display:block}.hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]})}return r})()},5858:(M,u,e)=>{e.d(u,{O:()=>t});const t="DROPDOWN_INSERT_VALUE"},9333:(M,u,e)=>{e.d(u,{c:()=>o});var t=e(4435),m=e(7580);let o=(()=>{class g{constructor(){this.log=(0,t.T)({ClickStopPropagationDirective:g}),this.log.a("constructor")}onClick(c){this.log.a("onClick",{event:c}),c.stopPropagation(),c.preventDefault()}static#t=this.\u0275fac=function(h){return new(h||g)};static#e=this.\u0275dir=m.FsC({type:g,selectors:[["","appClickStopPropagation",""]],hostBindings:function(h,E){1&h&&m.bIt("click",function(f){return E.onClick(f)})},standalone:!0})}return g})()},5959:(M,u,e)=>{e.d(u,{h6:()=>E,zZ:()=>c});var t=e(271),m=e(7693),o=e(6474),g=e(7580);const l="admin/field/",c="admin/field/all",h="admin/field/GetSharedFields";let E=(()=>{class v extends o.D{typeListRetrieve(){return this.http.get(this.apiUrl(l+"DataTypes"),{params:{appid:this.appId}})}getInputTypesList(){return this.http.get(this.apiUrl(l+"InputTypes"),{params:{appid:this.appId}}).pipe((0,t.T)(p=>p.map(d=>({dataType:d.Type.substring(0,d.Type.indexOf("-")),inputType:d.Type,label:d.Label,description:d.Description,isDefault:d.IsDefault,isObsolete:d.IsObsolete,isRecommended:d.IsRecommended,obsoleteMessage:d.ObsoleteMessage,icon:d.IsDefault?"star":d.IsRecommended?"star_outline":null}))))}getReservedNames(){return this.http.get(this.apiUrl(l+"ReservedNames"))}getFields(p){return this.http.get(this.apiUrl(c),{params:{appid:this.appId,staticName:p}}).pipe((0,t.T)(r=>{if(r)for(const d of r){if(!d.Metadata)continue;const C=d.Metadata;C.merged={...C.All,...C[d.Type],...C[d.InputType]}}return r}))}getShareableFields(){return this.http.get(this.apiUrl(h),{params:{appid:this.appId}})}getShareableFieldsFor(p){return this.http.get(this.apiUrl(h),{params:{appid:this.appId,attributeId:p.toString()}})}addInheritedField(p,r,d,C){return this.http.post(this.apiUrl(l+"AddInheritedField"),null,{params:{AppId:this.appId,ContentTypeId:p.toString(),SourceType:r,SourceField:d,name:C}})}share(p,r=!0){return this.http.post(this.apiUrl(l+"Share"),null,{params:{appid:this.appId,attributeId:p.toString(),share:r}})}inherit(p,r){return this.http.post(this.apiUrl(l+"Inherit"),null,{params:{appid:this.appId,attributeId:p.toString(),inheritMetadataOf:r}})}reOrder(p,r){return this.http.post(this.apiUrl(l+"Sort"),null,{params:{appid:this.appId,contentTypeId:r.Id.toString(),order:JSON.stringify(p)}})}setTitle(p,r){return this.http.post(this.apiUrl(m.X+"SetTitle"),null,{params:{appid:this.appId,contentTypeId:r.Id.toString(),attributeId:p.Id.toString()}})}rename(p,r,d){return this.http.post(this.apiUrl(l+"Rename"),null,{params:{appid:this.appId,contentTypeId:r.toString(),attributeId:p.toString(),newName:d}})}delete(p,r){if(p.IsTitle)throw new Error("Can't delete Title");return this.http.delete(this.apiUrl(l+"Delete"),{params:{appid:this.appId,contentTypeId:r.Id.toString(),attributeId:p.Id.toString()}})}add(p,r){return this.http.post(this.apiUrl(l+"Add"),null,{params:{AppId:this.appId,ContentTypeId:r.toString(),Id:p.Id.toString(),Type:p.Type,InputType:p.InputType,StaticName:p.StaticName,IsTitle:p.IsTitle.toString(),Index:p.SortOrder.toString()}})}updateInputType(p,r,d){return this.http.post(this.apiUrl(l+"InputType"),null,{params:{appId:this.appId,attributeId:p.toString(),field:r,inputType:d}})}static#t=this.\u0275fac=(()=>{let p;return function(d){return(p||(p=g.xGo(v)))(d||v)}})();static#e=this.\u0275prov=g.jDH({token:v,factory:v.\u0275fac})}return v})()},693:(M,u,e)=>{function t(o){return new Promise((g,l)=>{const c=new FileReader;c.readAsDataURL(o),c.onload=()=>{g(c.result.split(",")[1])},c.onerror=h=>{l(h)}})}function m(o){return new Promise((g,l)=>{const c=new FileReader;c.readAsText(o),c.onload=()=>{g(c.result)},c.onerror=h=>{l(h)}})}e.d(u,{d:()=>m,n:()=>t})}}]);
//# sourceMappingURL=https://sources.2sxc.org/18.00.02/dist/ng-edit/projects_eav-ui_src_app_metadata_metadata_component_ts-projects_eav-ui_src_app_shared_fields_-53fb0d.b3a2c3b35b8dbb6d.js.map