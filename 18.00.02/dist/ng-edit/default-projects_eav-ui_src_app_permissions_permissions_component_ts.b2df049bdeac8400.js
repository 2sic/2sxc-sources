"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["default-projects_eav-ui_src_app_permissions_permissions_component_ts"],{2871:(D,m,t)=>{t.d(m,{J:()=>a});var p=t(3840),c=t(7580);let a=(()=>{class u{constructor(){this.trueIcon="check_circle",this.falseIcon="circle"}agInit(d){let s=d.value;d.reverse&&(s=!s),d.trueIcon&&(this.trueIcon=d.trueIcon),d.falseIcon&&(this.falseIcon=d.falseIcon),this.icon=s?this.trueIcon:this.falseIcon}refresh(d){return!0}static#e=this.\u0275fac=function(s){return new(s||u)};static#t=this.\u0275cmp=c.VBU({type:u,selectors:[["app-rest-api-true-false"]],standalone:!0,features:[c.aNF],decls:3,vars:1,consts:[[1,"icon-container"]],template:function(s,h){1&s&&(c.j41(0,"div",0)(1,"mat-icon"),c.EFF(2),c.k0s()()),2&s&&(c.R7$(2),c.JRh(h.icon))},dependencies:[p.m_,p.An],encapsulation:2})}return u})()},2458:(D,m,t)=>{t.r(m),t.d(m,{PermissionsComponent:()=>B});var p=t(7941),c=t(2159),a=t(5797),u=t(271),n=t(251),d=t(52),s=t(3216),h=t(334),o=t(3840),i=t(5060),e=t(7580);let r=(()=>{class O{agInit(g){this.params=g}refresh(g){return!0}deletePermission(){this.params.onDelete(this.params.data)}static#e=this.\u0275fac=function(E){return new(E||O)};static#t=this.\u0275cmp=e.VBU({type:O,selectors:[["app-permissions-actions"]],standalone:!0,features:[e.aNF],decls:4,vars:0,consts:[[1,"actions-component"],["matRipple","","tippy","Delete",1,"eav-grid-action-button","highlight",3,"click"]],template:function(E,C){1&E&&(e.j41(0,"div",0)(1,"div",1),e.bIt("click",function(){return C.deletePermission()}),e.j41(2,"mat-icon"),e.EFF(3,"delete"),e.k0s()()())},dependencies:[i.pZ,i.r6,o.m_,o.An]})}return O})();var _=t(4900),l=t(1828),f=t(316),M=t(4175),P=t(7037),v=t(5437),y=t(8471),I=t(3347),T=t(9841);function R(O,x){if(1&O){const g=e.RV6();e.j41(0,"div",0)(1,"div",1)(2,"div",2),e.EFF(3,"Permissions"),e.k0s(),e.j41(4,"button",3),e.bIt("click",function(){e.eBV(g);const C=e.XpG();return e.Njj(C.closeDialog())}),e.j41(5,"mat-icon"),e.EFF(6,"close"),e.k0s()()(),e.j41(7,"div",4),e.nrm(8,"router-outlet"),e.j41(9,"div",5),e.nrm(10,"ag-grid-angular",6),e.k0s(),e.j41(11,"mat-dialog-actions",7)(12,"button",8),e.bIt("click",function(){e.eBV(g);const C=e.XpG();return e.Njj(C.editPermission(null))}),e.j41(13,"mat-icon"),e.EFF(14,"add"),e.k0s()()()()()}if(2&O){const g=e.XpG();e.R7$(10),e.Y8G("rowData",x.permissions)("gridOptions",g.gridOptions)}}let B=(()=>{class O{#e;#t;constructor(g,E){this.dialogRef=g,this.snackBar=E,this.permissions$=new a.t(void 0),this.gridOptions=this.buildGridOptions(),this.#e=(0,v.d)(_.K),this.#t=(0,v.d)(y.c),this.targetType=parseInt(this.#t.snapshot.paramMap.get("targetType"),10),this.keyType=this.#t.snapshot.paramMap.get("keyType"),this.key=this.#t.snapshot.paramMap.get("key"),this.prefills={[d.YX.metadata.language.targetType]:{PermissionType:"language"}}}ngOnInit(){this.fetchPermissions(),this.#t.doOnDialogClosed(()=>this.fetchPermissions()),this.viewModel$=this.permissions$.pipe((0,u.T)(g=>({permissions:g})))}ngOnDestroy(){this.permissions$.complete()}closeDialog(){this.dialogRef.close()}fetchPermissions(){this.#e.getAll(this.targetType,this.keyType,this.key).subscribe(g=>{this.permissions$.next(g)})}editPermission(g){let E;E=null==g?{items:[{...h.c.newMetadataFromInfo(d.YX.contentTypes.permissions,h.c.constructMetadataInfo(this.targetType,this.keyType,this.key)),...this.prefills[this.targetType]&&{Prefill:this.prefills[this.targetType]}}]}:{items:[h.c.editId(g.Id)]};const C=(0,s.s)(E);this.#t.navRelative([`edit/${C}`])}deletePermission(g){confirm(`Delete '${g.Title}' (${g.Id})?`)&&(this.snackBar.open("Deleting..."),this.#e.delete(g.Id).subscribe(()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchPermissions()}))}buildGridOptions(){return{...n.C,columnDefs:[{...l.r.Id,cellRendererParams:l.r.idFieldParamsTooltipGetter()},{...l.r.TextWide,headerName:"Name",field:"Title",sort:"asc",onCellClicked:E=>{this.editPermission(E.data)}},{...l.r.TextWide,field:"Identity"},{...l.r.TextWide,field:"Condition"},{...l.r.Character,field:"Grant"},{...l.r.ActionsPinnedRight1,cellRenderer:r,cellRendererParams:{onDelete:C=>this.deletePermission(C)}}]}}static#n=this.\u0275fac=function(E){return new(E||O)(e.rXU(p.CP),e.rXU(I.UG))};static#s=this.\u0275cmp=e.VBU({type:O,selectors:[["app-permissions"]],standalone:!0,features:[e.aNF],decls:2,vars:3,consts:[[1,"eav-dialog","nav-component-wrapper"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"eav-dialog-content","nav-component-wrapper"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","gridOptions"],["align","end"],["mat-fab","","mat-elevation-z24","","tippy","Create a new permission",1,"grid-fab",3,"click"]],template:function(E,C){if(1&E&&(e.DNE(0,R,15,2,"div",0),e.nI1(1,"async")),2&E){let A;e.vxM(0,(A=e.bMT(1,1,C.viewModel$))?0:-1,A)}},dependencies:[M.Hl,M.iY,M.Sr,o.m_,o.An,c.n3,p.E7,f.Jj,P.p,T.xs]})}return O})()},401:(D,m,t)=>{t.d(m,{T:()=>d});var p=t(8873),c=t(7580),a=t(6443),u=t(4821);let d=(()=>{class s{constructor(o,i,e){this.http=o,this.context=i,this.dnnContext=e}getMetadata(o,i,e,r){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/metadata/get"),{params:{appId:this.context.appId.toString(),targetType:o.toString(),keyType:i,key:e.toString(),...r&&{contentType:r}}})}static#e=this.\u0275fac=function(i){return new(i||s)(c.KVO(a.Qq),c.KVO(p.o),c.KVO(u.ob))};static#t=this.\u0275prov=c.jDH({token:s,factory:s.\u0275fac})}return s})()},4900:(D,m,t)=>{t.d(m,{K:()=>s});var p=t(271),c=t(6817),a=t(52),u=t(401),n=t(5437),d=t(7580);let s=(()=>{class h{constructor(){this.metadataService=(0,n.d)(u.T),this.entitiesService=(0,n.d)(c.R)}getAll(i,e,r){return this.metadataService.getMetadata(i,e,r,a.YX.contentTypes.permissions).pipe((0,p.T)(_=>_.Items))}delete(i){return this.entitiesService.delete(a.YX.contentTypes.permissions,i,!1)}static#e=this.\u0275fac=function(e){return new(e||h)};static#t=this.\u0275prov=d.jDH({token:h,factory:h.\u0275fac})}return h})()},8991:(D,m,t)=>{t.d(m,{N:()=>e});const p={states:{true:{tooltip:"true/on",icon:"radio_button_checked"},false:{tooltip:"false/off",icon:"radio_button_unchecked"}}};var c=t(7896),a=t(3840),u=t(316),n=t(7580);const d=r=>({clickable:r});function s(r,_){1&r&&n.eu8(0)}function h(r,_){if(1&r&&(n.j41(0,"a",2),n.DNE(1,s,1,0,"ng-container",3),n.k0s()),2&r){const l=n.XpG(),f=n.sdS(4);n.Y8G("href",l.data.url,n.B4B),n.R7$(),n.Y8G("ngTemplateOutlet",f)}}function o(r,_){if(1&r&&(n.j41(0,"div",4)(1,"mat-icon"),n.EFF(2),n.k0s()()),2&r){const l=n.XpG();n.Y8G("ngClass",n.eq3(3,d,l.data.clickable))("tippy",l.data.tooltip),n.R7$(2),n.JRh(l.data.icon)}}function i(r,_){if(1&r&&(n.j41(0,"div",4)(1,"mat-icon"),n.EFF(2),n.k0s()()),2&r){const l=n.XpG();n.Y8G("ngClass",n.eq3(3,d,l.data.clickable))("tippy",l.data.tooltip),n.R7$(2),n.JRh(l.data.icon)}}let e=(()=>{class r{agInit(l){this.value=l.value,this.allSettings=l.settings?.(l.data)??p;const f=this.allSettings.states[this.value?"true":"false"];this.data={...f,url:f.url??f.getUrl?.(l.data)}}refresh(l){return!0}static#e=this.\u0275fac=function(f){return new(f||r)};static#t=this.\u0275cmp=n.VBU({type:r,selectors:[["app-ag-bool-icon-renderer"]],standalone:!0,features:[n.aNF],decls:5,vars:1,consts:[["showIcon",""],[1,"icon-container"],["target","_blank",3,"href"],[4,"ngTemplateOutlet"],[1,"icon-cell","icon",3,"ngClass","tippy"]],template:function(f,M){1&f&&(n.j41(0,"div",1),n.DNE(1,h,2,2,"a",2)(2,o,3,5),n.k0s(),n.DNE(3,i,3,5,"ng-template",null,0,n.C5r)),2&f&&(n.R7$(),n.vxM(1,M.data.url?1:2))},dependencies:[c.e,a.m_,a.An,u.YU],encapsulation:2})}return r})()},1828:(D,m,t)=>{t.d(m,{r:()=>h});var p=t(1960),c=t(8991),a=t(2871),u=t(6378);const n="secondary-action no-padding".split(" "),d={cellClass:n,pinned:"right"},s={sortable:!0,filter:"agTextColumnFilter"};class h{static#e=this.ActionsPinnedRight1={width:42,...d};static#t=this.ActionsPinnedRight3={width:122,...d};static#n=this.ActionsPinnedRight4={width:162,...d};static#s=this.ActionsPinnedRight5={width:202,...d};static#i=this.ActionsPinnedRight6={width:82,...d};static#a=this.ActionsPinnedRight7={width:62,cellClass:n+" no-outline",pinned:"right"};static#o=this.IconShow={headerName:"Show",width:70,headerClass:"dense",cellClass:"icons no-outline".split(" "),sortable:!0,filter:p.y,valueGetter:i=>!i.data.IsHidden,cellRenderer:c.N};static#l=this.Items={width:102,headerClass:"dense",cellClass:n,sortable:!0,filter:"agNumberColumnFilter"};static#r=this.Fields={width:94,headerClass:"dense",cellClass:n,sortable:!0,filter:"agNumberColumnFilter"};static#c=this.Character={width:70,headerClass:"dense",cellClass:"no-outline",...s};static#d=this.Id={headerName:"ID",field:"Id",width:70,headerClass:"dense",cellClass:"id-action no-padding no-outline".split(" "),sortable:!0,filter:"agNumberColumnFilter"};static#h=this.IdWithDefaultRenderer={...h.Id,cellRenderer:u.L};static#_=this.Boolean={width:70,headerClass:"dense",cellClass:"number-cell no-outline".split(" "),sortable:!0};static#p=this.Boolean2={width:100,sortable:!0,cellClass:"no-outline",filter:p.y};static#u=this.Boolean3={headerClass:"dense",width:80,cellClass:"no-outline",cellRenderer:a.J,cellRendererParams:{reverse:!1}};static#g=this.Number={width:70,headerClass:"dense",cellClass:"number-cell no-outline".split(" "),...s};static#m=this.TextWideType={flex:3,minWidth:250,cellClass:"primary-action highlight".split(" "),...s};static#f=this.TextWide={flex:2,minWidth:250,cellClass:"no-outline",...s};static#E=this.TextWideMin100={flex:1,minWidth:100,...s};static#v=this.TextWideFlex3={flex:3,minWidth:250,cellClass:"no-outline",...s};static#P=this.TextNarrow={flex:1,minWidth:150,cellClass:"no-outline",...s};static#C=this.TextWideActionClass={flex:2,minWidth:250,cellClass:"primary-action no-padding no-outline".split(" "),...s};static idFieldParamsTooltipGetter(i){return{tooltipGetter:r=>`ID: ${r.Id}\nGUID: ${r[i||"Guid"]}`}}}},1960:(D,m,t)=>{t.d(m,{y:()=>u});var p=t(4456),c=t(3804),a=t(7580);let u=(()=>{class n{constructor(){this.filter=""}agInit(s){this.filterParams=s}isFilterActive(){return""!==this.filter}doesFilterPass(s){const o=this.filterParams.valueGetter({api:this.filterParams.api,colDef:this.filterParams.colDef,column:this.filterParams.column,columnApi:this.filterParams.columnApi,context:this.filterParams.context,data:s.node.data,getValue:i=>s.node.data[i],node:s.node});return null!=o&&o.toString()===this.filter}getModel(){if(this.isFilterActive())return{filterType:"boolean",filter:this.filter}}setModel(s){this.filter=s?s.filter:""}afterGuiAttached(s){}filterChanged(){this.filterParams.filterChangedCallback()}static#e=this.\u0275fac=function(h){return new(h||n)};static#t=this.\u0275cmp=a.VBU({type:n,selectors:[["app-boolean-filter"]],standalone:!0,features:[a.aNF],decls:7,vars:1,consts:[[3,"ngModelChange","ngModel"],["value",""],["value","true"],["value","false"]],template:function(h,o){1&h&&(a.j41(0,"mat-radio-group",0),a.mxI("ngModelChange",function(e){return a.DH7(o.filter,e)||(o.filter=e),e}),a.bIt("ngModelChange",function(){return o.filterChanged()}),a.j41(1,"mat-radio-button",1),a.EFF(2,"All"),a.k0s(),a.j41(3,"mat-radio-button",2),a.EFF(4,"True"),a.k0s(),a.j41(5,"mat-radio-button",3),a.EFF(6,"False"),a.k0s()()),2&h&&a.R50("ngModel",o.filter)},dependencies:[p.YN,p.BC,p.vS,c.Wk,c.VT,c._g],styles:[".mat-mdc-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;overflow:hidden;padding:12px;width:160px;height:104px}"]})}return n})()},6378:(D,m,t)=>{t.d(m,{L:()=>h});var p=t(519),c=t(316),a=t(3840),u=t(7896),n=t(7580),d=t(3347);const s=(o,i)=>({"align-start":o,"align-end":i});let h=(()=>{class o{constructor(e){this.snackBar=e}agInit(e){this.id=e.value,this.align="number"==typeof this.id?"end":"start",this.tooltip=e.tooltipGetter(e.data)}refresh(e){return!0}copy(){(0,p.l)(this.tooltip),this.snackBar.open("Copied to clipboard",null,{duration:2e3})}static#e=this.\u0275fac=function(r){return new(r||o)(n.rXU(d.UG))};static#t=this.\u0275cmp=n.VBU({type:o,selectors:[["app-id-field"]],standalone:!0,features:[n.aNF],decls:5,vars:6,consts:[["matRipple","",1,"id-box","highlight",3,"click","tippy","ngClass"],[1,"id"],[1,"icon"]],template:function(r,_){1&r&&(n.j41(0,"div",0),n.bIt("click",function(){return _.copy()}),n.j41(1,"span",1),n.EFF(2),n.k0s(),n.j41(3,"mat-icon",2),n.EFF(4,"file_copy"),n.k0s()()),2&r&&(n.Y8G("tippy",_.tooltip)("ngClass",n.l_i(3,s,"start"===_.align,"end"===_.align)),n.R7$(2),n.JRh(_.id))},dependencies:[c.YU,a.m_,a.An,u.e],styles:[".id-box[_ngcontent-%COMP%]{padding:0 8px;height:100%;display:flex;align-items:center}.id-box.align-start[_ngcontent-%COMP%]{justify-content:flex-start}.id-box.align-end[_ngcontent-%COMP%]{justify-content:flex-end}.id-box[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{max-width:100%;text-overflow:ellipsis;overflow:hidden}.id-box[_ngcontent-%COMP%]:hover{text-decoration:none}.id-box[_ngcontent-%COMP%]:hover   .id[_ngcontent-%COMP%]{display:none}.id-box[_ngcontent-%COMP%]:not(:hover)   .icon[_ngcontent-%COMP%]{display:none}"]})}return o})()},8471:(D,m,t)=>{t.d(m,{c:()=>i});var p=t(2159),c=t(1567),a=t(3037),u=t(271),n=t(5057),d=t(5506),s=t(4979),h=t(7580);const o={enabled:!1,name:"DialogRoutingService",specs:{doOnDialogClosed:!0}};let i=(()=>{class e extends s.V{constructor(_,l){super(),this.router=_,this.route=l,this.log=new d.B(o)}ngOnDestroy(){super.destroy()}get snapshot(){return this.route.snapshot}get url(){return this.router.url}state(){return this.router.getCurrentNavigation().extras?.state}doOnDialogClosed(_){const l=this.log.fnIf("doOnDialogClosed");this.subscriptions.add(this.childDialogClosed$().subscribe(()=>{_()})),l.end()}navPath(_,l){return this.router.navigate([_],l)}navRelative(_,l){return this.router.navigate(_,{...l,relativeTo:this.route})}navParentFirstChild(_,l){return this.router.navigate(_,{...l,relativeTo:this.route.parent.firstChild})}childDialogClosed$(){return this.router.events.pipe((0,c.p)(_=>_ instanceof p.wF),(0,a.Z)(!!this.route.snapshot.firstChild),(0,u.T)(()=>!!this.route.snapshot.firstChild),(0,n.J)(),(0,c.p)(([_,l])=>_&&!l))}static#e=this.\u0275fac=function(l){return new(l||e)(h.KVO(p.Ix),h.KVO(p.nX))};static#t=this.\u0275prov=h.jDH({token:e,factory:e.\u0275fac})}return e})()},6817:(D,m,t)=>{t.d(m,{R:()=>d});var p=t(8873),c=t(9234),a=t(7580),u=t(6443),n=t(4821);let d=(()=>{class s{constructor(o,i,e){this.http=o,this.context=i,this.dnnContext=e}create(o,i){return this.http.post(`app/auto/data/${o}`,i,{params:{appId:this.context.appId,zoneId:this.context.zoneId}})}update(o,i,e){return this.http.post(`app/auto/data/${o}/${i}`,e,{params:{appId:this.context.appId,zoneId:this.context.zoneId}})}delete(o,i,e){return this.http.delete(this.dnnContext.$2sxc.http.apiUrl(c.gb+"delete"),{params:{contentType:o,id:i.toString(),appId:this.context.appId.toString(),force:e.toString()}})}static#e=this.\u0275fac=function(i){return new(i||s)(a.KVO(u.Qq),a.KVO(p.o),a.KVO(n.ob))};static#t=this.\u0275prov=a.jDH({token:s,factory:s.\u0275fac})}return s})()},9234:(D,m,t)=>{t.d(m,{Gg:()=>_,Tr:()=>l,gb:()=>r});var p=t(1567),c=t(6647),a=t(6301),u=t(271),n=t(5506),d=t(4839),s=t(5437),h=t(7580),o=t(6443),i=t(4821);const e={enabled:!1,name:"EntityService",specs:{all:!1,getEntities:!1,getAvailableEntities:!1,delete:!1}},r="admin/entity/",_="admin/entity/list";let l=(()=>{class f{constructor(P,v){this.http=P,this.dnnContext=v,this.queryService=(0,s.d)(d.c),this.log=new n.B(e)}getEntities$(P){return this.log.fnIf("getEntities"),P.pipe((0,p.p)(v=>null!=v),(0,c.n)(v=>this.getAvailableEntities(v.contentTypeName).pipe((0,a.t)(1))))}getAvailableEntities(P,v){return this.log.fnIf("getAvailableEntities"),this.queryService.getEntities({contentTypes:[P],itemIds:v,fields:"Id,Guid,Title",log:"getAvailableEntities"}).pipe((0,u.T)(I=>I.Default))}delete(P,v,y,I,T,R){return this.log.fnIf("delete",{appId:P,contentType:v,entityId:y,force:I,parentId:T,parent}),this.http.delete(this.dnnContext.$2sxc.http.apiUrl(r+"delete"),{params:{contentType:v,id:y.toString(),appId:P,force:I.toString(),...T&&{parentId:T.toString()},...T&&R&&{parentField:R}}})}static#e=this.\u0275fac=function(v){return new(v||f)(h.KVO(o.Qq),h.KVO(i.ob))};static#t=this.\u0275prov=h.jDH({token:f,factory:f.\u0275fac})}return f})()},4839:(D,m,t)=>{t.d(m,{c:()=>d});var p=t(5506),c=t(8873),a=t(7580),u=t(6443);const n={enabled:!1,name:"QueryService",specs:{all:!1,getAvailableEntities:!1,getEntities:!1}};let d=(()=>{class s{constructor(o,i){this.http=o,this.context=i,this.log=new p.B(n)}getAvailableEntities(o,i,e,r){this.log.fnIf("getAvailableEntities",{queryUrl:o,params:i,fields:e,entitiesFilter:r});const _=!!i,P=(((i?.toLocaleLowerCase()??"").includes("appid=")?"":`&appId=${this.context.appId}`)+(_?`&${i}`:"")+"&$select="+(e??"")).substring(1);return this.http.post(`app/auto/query/${o}?${P}`,{Guids:r})}getEntities({contentTypes:o,itemIds:i,fields:e,log:r}){this.log.fnIf("getEntities",{log:r,contentTypes:o,itemIds:i,fields:e});const l=("&typeNames="+(o?.join(",")??"")+`&appId=${this.context.appId}&itemIds=`+(i?.join(",")??"")+"&$select="+(e??"")).substring(1);return this.http.post(`app/auto/query/System.EntityPicker/Default?${l}`,{})}static#e=this.\u0275fac=function(i){return new(i||s)(a.KVO(u.Qq),a.KVO(c.o))};static#t=this.\u0275prov=a.jDH({token:s,factory:s.\u0275fac})}return s})()},4979:(D,m,t)=>{t.d(m,{V:()=>a});var p=t(7092),c=t(7580);let a=(()=>{class u{constructor(){this.subscriptions=new p.yU}ngOnDestroy(){this.destroy()}destroy(){this.subscriptions.unsubscribe()}static#e=this.\u0275fac=function(s){return new(s||u)};static#t=this.\u0275prov=c.jDH({token:u,factory:u.\u0275fac})}return u})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/18.00.02/dist/ng-edit/default-projects_eav-ui_src_app_permissions_permissions_component_ts.b2df049bdeac8400.js.map