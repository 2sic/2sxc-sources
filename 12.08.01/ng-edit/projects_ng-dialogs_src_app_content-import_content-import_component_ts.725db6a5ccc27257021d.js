(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_ng-dialogs_src_app_content-import_content-import_component_ts"],{3089:function(e,t,n){"use strict";n.r(t),n.d(t,{ContentImportComponent:function(){return M}});var i=n(4762),o=n(2935),a=n(8512),l=n(1305),s=n(3148),r=n(9996),u=n(1785),c=n(1282),p=n(7342),g=n(2887),f=n(2832),d=n(1116),m=n(5921),v=n(1041),h=n(4369),Z=n(7512),x=n(7436);function T(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"form",11,12),u.TgZ(2,"div",13),u.TgZ(3,"div"),u.TgZ(4,"button",14),u.NdJ("click",function(){return u.CHM(n),u.MAs(8).click()}),u.TgZ(5,"span"),u._uU(6),u.qZA(),u.qZA(),u.TgZ(7,"input",15,16),u.NdJ("change",function(e){return u.CHM(n),u.oxw(3).fileChange(e)}),u.qZA(),u.qZA(),u.TgZ(9,"div"),u.TgZ(10,"p",17),u._uU(11,"References to pages / files"),u.qZA(),u.TgZ(12,"mat-radio-group",18),u.NdJ("ngModelChange",function(e){return u.CHM(n),u.oxw(3).formValues.resourcesReferences=e}),u.TgZ(13,"mat-radio-button",19),u._uU(14," Import links as written in the file (for example /Portals/...) "),u.qZA(),u.TgZ(15,"mat-radio-button",20),u._uU(16," Try to resolve paths to references "),u.qZA(),u.qZA(),u.qZA(),u.TgZ(17,"div"),u.TgZ(18,"p",17),u._uU(19,"Clear all other entities"),u.qZA(),u.TgZ(20,"mat-radio-group",21),u.NdJ("ngModelChange",function(e){return u.CHM(n),u.oxw(3).formValues.clearEntities=e}),u.TgZ(21,"mat-radio-button",22),u._uU(22," Keep all entities not found in import "),u.qZA(),u.TgZ(23,"mat-radio-button",23),u._uU(24," Remove all entities not found in import "),u.qZA(),u.qZA(),u.qZA(),u.TgZ(25,"p",24),u._uU(26,"Remember to backup your DNN first!"),u.qZA(),u.qZA(),u.TgZ(27,"div",25),u.TgZ(28,"button",26),u.NdJ("click",function(){return u.CHM(n),u.oxw(3).closeDialog()}),u._uU(29,"Cancel"),u.qZA(),u.TgZ(30,"button",27),u.NdJ("click",function(){return u.CHM(n),u.oxw(3).evaluateContent()}),u._uU(31," Preview Import "),u.qZA(),u.qZA(),u.qZA()}if(2&e){var i=u.oxw(3);u.xp6(6),u.Oqu(i.formValues.file?i.formValues.file.name:"Select or drop file"),u.xp6(6),u.Q6J("ngModel",i.formValues.resourcesReferences),u.xp6(8),u.Q6J("ngModel",i.formValues.clearEntities),u.xp6(10),u.Q6J("disabled",!i.formValues.file||!i.formValues.file.name)}}function w(e,t){1&e&&(u.TgZ(0,"p",28),u._uU(1,"Please wait while processing..."),u.qZA())}function A(e,t){if(1&e&&(u.TgZ(0,"div",31),u.TgZ(1,"p",32),u._uU(2),u.qZA(),u.TgZ(3,"p",32),u._uU(4,"File contains:"),u.qZA(),u.TgZ(5,"ul",33),u.TgZ(6,"li"),u._uU(7),u.qZA(),u.TgZ(8,"li"),u._uU(9),u.qZA(),u.TgZ(10,"li"),u._uU(11),u.qZA(),u.qZA(),u.TgZ(12,"p",32),u._uU(13,"If you press Import, it will:"),u.qZA(),u.TgZ(14,"ul",33),u.TgZ(15,"li"),u._uU(16),u.qZA(),u.TgZ(17,"li"),u._uU(18),u.qZA(),u.TgZ(19,"li"),u._uU(20),u.qZA(),u.TgZ(21,"li"),u._uU(22),u.qZA(),u.qZA(),u.TgZ(23,"p",24),u._uU(24,"Note: The import validates much data and may take several minutes."),u.qZA(),u.qZA()),2&e){var n=u.oxw(4).ngIf,i=u.oxw();u.xp6(2),u.hij("Try to import file '",i.formValues.file.name,"'"),u.xp6(5),u.hij("",n.evaluationResult.Detail.DocumentElementsCount," content-items (records/entities)"),u.xp6(2),u.hij("",n.evaluationResult.Detail.LanguagesInDocumentCount," languages"),u.xp6(2),u.AsE("",n.evaluationResult.Detail.AttributeNamesInDocument.length," columns: ",n.evaluationResult.Detail.AttributeNamesInDocument.join(", "),""),u.xp6(5),u.hij("Create ",n.evaluationResult.Detail.AmountOfEntitiesCreated," content-items"),u.xp6(2),u.hij("Update ",n.evaluationResult.Detail.AmountOfEntitiesUpdated," content-items"),u.xp6(2),u.hij("Delete ",n.evaluationResult.Detail.AmountOfEntitiesDeleted," content-items"),u.xp6(2),u.AsE("Ignore ",n.evaluationResult.Detail.AttributeNamesNotImported.length," columns: ",n.evaluationResult.Detail.AttributeNamesNotImported.join(", "),"")}}function _(e,t){if(1&e&&(u.TgZ(0,"div"),u.TgZ(1,"i"),u._uU(2),u.qZA(),u.qZA()),2&e){var n=u.oxw().$implicit;u.xp6(2),u.hij("Details: ",n.ErrorDetail,"")}}function q(e,t){if(1&e&&(u.TgZ(0,"div"),u.TgZ(1,"i"),u._uU(2),u.qZA(),u.qZA()),2&e){var n=u.oxw().$implicit;u.xp6(2),u.hij("Line-no: ",n.LineNumber,"")}}function C(e,t){if(1&e&&(u.TgZ(0,"div"),u.TgZ(1,"i"),u._uU(2),u.qZA(),u.qZA()),2&e){var n=u.oxw().$implicit;u.xp6(2),u.hij("Line-details: ",n.LineDetail,"")}}function y(e,t){if(1&e&&(u.TgZ(0,"li"),u.TgZ(1,"div"),u._uU(2),u.qZA(),u.YNc(3,_,3,1,"div",6),u.YNc(4,q,3,1,"div",6),u.YNc(5,C,3,1,"div",6),u.qZA()),2&e){var n=t.$implicit,i=u.oxw(6);u.xp6(2),u.Oqu(i.errors[n.ErrorCode]),u.xp6(1),u.Q6J("ngIf",n.ErrorDetail),u.xp6(1),u.Q6J("ngIf",n.LineNumber),u.xp6(1),u.Q6J("ngIf",n.LineDetail)}}function S(e,t){if(1&e&&(u.TgZ(0,"div",31),u.TgZ(1,"p",32),u._uU(2),u.qZA(),u.TgZ(3,"ul",33),u.YNc(4,y,6,4,"li",34),u.qZA(),u.qZA()),2&e){var n=u.oxw(4).ngIf,i=u.oxw();u.xp6(2),u.hij("Try to import file '",i.formValues.file.name,"'"),u.xp6(2),u.Q6J("ngForOf",n.evaluationResult.Errors)}}function b(e,t){if(1&e){var n=u.EpF();u.ynx(0),u.YNc(1,A,25,10,"div",29),u.YNc(2,S,5,2,"div",29),u.TgZ(3,"div",30),u.TgZ(4,"button",26),u.NdJ("click",function(){return u.CHM(n),u.oxw(4).back()}),u._uU(5,"Back"),u.qZA(),u.TgZ(6,"button",27),u.NdJ("click",function(){return u.CHM(n),u.oxw(4).importContent()}),u._uU(7," Import "),u.qZA(),u.qZA(),u.BQk()}if(2&e){var i=u.oxw(3).ngIf;u.xp6(1),u.Q6J("ngIf",i.evaluationResult.Success),u.xp6(1),u.Q6J("ngIf",!i.evaluationResult.Success),u.xp6(4),u.Q6J("disabled",!i.evaluationResult.Success)}}function I(e,t){if(1&e&&(u.ynx(0),u.YNc(1,b,8,3,"ng-container",6),u.BQk()),2&e){var n=u.oxw(2).ngIf;u.xp6(1),u.Q6J("ngIf",n.evaluationResult)}}function N(e,t){1&e&&(u.TgZ(0,"p"),u._uU(1,"Import done."),u.qZA())}function D(e,t){1&e&&(u.TgZ(0,"p"),u._uU(1,"Import failed."),u.qZA())}function R(e,t){if(1&e&&(u.TgZ(0,"div",28),u.YNc(1,N,2,0,"p",6),u.YNc(2,D,2,0,"p",6),u.qZA()),2&e){var n=u.oxw(3).ngIf;u.xp6(1),u.Q6J("ngIf",n.importResult.Success),u.xp6(1),u.Q6J("ngIf",!n.importResult.Success)}}function U(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"div"),u.YNc(1,R,3,2,"div",35),u.TgZ(2,"div",30),u.TgZ(3,"button",36),u.NdJ("click",function(){return u.CHM(n),u.oxw(3).closeDialog()}),u._uU(4,"Close"),u.qZA(),u.qZA(),u.qZA()}if(2&e){var i=u.oxw(2).ngIf;u.xp6(1),u.Q6J("ngIf",i.importResult)}}function J(e,t){if(1&e&&(u.ynx(0),u.ynx(1,7),u.YNc(2,T,32,4,"form",8),u.YNc(3,w,2,0,"p",9),u.YNc(4,I,2,1,"ng-container",10),u.YNc(5,U,5,1,"div",10),u.BQk(),u.BQk()),2&e){var n=u.oxw().ngIf;u.xp6(1),u.Q6J("ngSwitch",n.viewStateSelected),u.xp6(1),u.Q6J("ngSwitchCase",1),u.xp6(1),u.Q6J("ngSwitchCase",0),u.xp6(1),u.Q6J("ngSwitchCase",2),u.xp6(1),u.Q6J("ngSwitchCase",3)}}function $(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"div",1),u.NdJ("filesDropped",function(e){return u.CHM(n),u.oxw().filesDropped(e)}),u.TgZ(1,"div",2),u.TgZ(2,"div",3),u._uU(3),u.qZA(),u.qZA(),u.TgZ(4,"p",4),u._uU(5," This will import content-items into 2sxc. It requires that you already defined the content-type before you try importing, and that you created the import-file using the template provided by the Export. Please visit "),u.TgZ(6,"a",5),u._uU(7,"https://2sxc.org/help"),u.qZA(),u._uU(8," for more instructions. "),u.qZA(),u.YNc(9,J,6,5,"ng-container",6),u.qZA()}if(2&e){var i=t.ngIf,o=u.oxw();u.Q6J("allowedFileTypes","xml"),u.xp6(3),u.hij("",null==i.contentType?null:i.contentType.Name," Import Data"),u.xp6(6),u.Q6J("ngIf",null!=o.formValues)}}var M=function(){function e(e,t,n,o,s,u){this.dialogData=e,this.dialogRef=t,this.route=n,this.contentImportService=o,this.appDialogConfigService=s,this.contentTypesService=u,this.hostClass="dialog-component",this.contentType$=new a.X(null),this.loading$=new a.X(!1),this.viewStates={waiting:0,default:1,evaluated:2,imported:3},this.viewStateSelected$=new a.X(this.viewStates.default),this.evaluationResult$=new a.X(null),this.importResult$=new a.X(null),this.templateVars$=(0,l.aj)([this.contentType$,this.loading$,this.viewStateSelected$,this.evaluationResult$,this.importResult$]).pipe((0,r.U)(function(e){var t=(0,i.CR)(e,5);return{contentType:t[0],loading:t[1],viewStateSelected:t[2],evaluationResult:t[3],importResult:t[4]}})),this.errors={0:"Unknown error occured.",1:"Selected content-type does not exist.",2:"Document is not a valid XML file.",3:"Selected content-type does not match the content-type in the XML file.",4:"The language is not supported.",5:"The document does not specify all languages for all entities.",6:"Language reference cannot be parsed, the language is not supported.",7:"Language reference cannot be parsed, the read-write protection is not supported.",8:"Value cannot be read, because of it has an invalid format."},this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName")}return e.prototype.ngOnInit=function(){var e=this;this.loading$.next(!0);var t=this.contentTypesService.retrieveContentType(this.contentTypeStaticName),n=this.appDialogConfigService.getDialogSettings();(0,s.D)([t,n]).subscribe(function(t){var n=(0,i.CR)(t,2),o=n[1];e.contentType$.next(n[0]),e.formValues={defaultLanguage:o.Context.Language.Primary,contentType:e.contentTypeStaticName,file:null!=e.dialogData.files?e.dialogData.files[0]:null,resourcesReferences:"Keep",clearEntities:"None"},e.loading$.next(!1)})},e.prototype.ngOnDestroy=function(){this.contentType$.complete(),this.loading$.complete(),this.viewStateSelected$.complete(),this.evaluationResult$.complete(),this.importResult$.complete()},e.prototype.closeDialog=function(){this.dialogRef.close()},e.prototype.evaluateContent=function(){var e=this;this.viewStateSelected$.next(this.viewStates.waiting),this.contentImportService.evaluateContent(this.formValues).subscribe(function(t){e.evaluationResult$.next(t),e.viewStateSelected$.next(e.viewStates.evaluated)})},e.prototype.importContent=function(){var e=this;this.viewStateSelected$.next(this.viewStates.waiting),this.contentImportService.importContent(this.formValues).subscribe(function(t){e.importResult$.next(t),e.viewStateSelected$.next(e.viewStates.imported)})},e.prototype.back=function(){this.viewStateSelected$.next(this.viewStates.default),this.evaluationResult$.next(null)},e.prototype.fileChange=function(e){this.formValues.file=e.target.files[0]},e.prototype.filesDropped=function(e){this.formValues.file=e[0]},e.\u0275fac=function(t){return new(t||e)(u.Y36(o.WI),u.Y36(o.so),u.Y36(c.gz),u.Y36(p.B),u.Y36(g.K),u.Y36(f.s))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-content-import"]],hostVars:1,hostBindings:function(e,t){2&e&&u.Ikx("className",t.hostClass)},decls:2,vars:3,consts:[["class","dialog-form-wrapper","appDragAndDrop","",3,"allowedFileTypes","filesDropped",4,"ngIf"],["appDragAndDrop","",1,"dialog-form-wrapper",3,"allowedFileTypes","filesDropped"],["mat-dialog-title",""],[1,"dialog-title-box"],[1,"dialog-description"],["href","https://2sxc.org/help","target","_blank"],[4,"ngIf"],[3,"ngSwitch"],["class","dialog-form",4,"ngSwitchCase"],["class","progress-message",4,"ngSwitchCase"],[4,"ngSwitchCase"],[1,"dialog-form"],["ngForm","ngForm"],[1,"dialog-form-content","fancy-scrollbar-light"],["mat-raised-button","","tippy","Open file browser",3,"click"],["type","file",1,"hide",3,"change"],["fileInput",""],[1,"field-label"],["name","ResourcesReferences",3,"ngModel","ngModelChange"],["value","Keep"],["value","Resolve"],["name","ClearEntities",3,"ngModel","ngModelChange"],["value","None"],["value","All"],[1,"hint"],[1,"dialog-form-actions"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click"],[1,"progress-message"],["class","dialog-component-content fancy-scrollbar-light",4,"ngIf"],[1,"dialog-component-actions"],[1,"dialog-component-content","fancy-scrollbar-light"],[1,"evaluation__title"],[1,"evaluation__content"],[4,"ngFor","ngForOf"],["class","progress-message",4,"ngIf"],["mat-raised-button","","color","accent",3,"click"]],template:function(e,t){1&e&&(u.YNc(0,$,10,3,"div",0),u.ALo(1,"async")),2&e&&u.Q6J("ngIf",u.lcZ(1,1,t.templateVars$))},directives:[d.O5,m.z,o.uh,d.RF,d.n9,v._Y,v.JL,v.F,h.lW,Z.$,x.VQ,v.JJ,v.On,x.U0,d.sg],pipes:[d.Ov],styles:[".field-label[_ngcontent-%COMP%]{font-size:18px;margin:24px 0 0}.mat-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:8px 0}.mat-radio-button[_ngcontent-%COMP%]{margin:5px;font-size:14px}.hint[_ngcontent-%COMP%]{margin-top:24px;margin-bottom:16px}.hint[_ngcontent-%COMP%], .progress-message[_ngcontent-%COMP%]{font-size:18px}.evaluation__title[_ngcontent-%COMP%]{font-size:18px;margin:24px 0 0;font-weight:700}.evaluation__content[_ngcontent-%COMP%]{font-size:14px}.evaluation__content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:2px 0}"]}),e}()}}]);
//# sourceMappingURL=https://sources.2sxc.org/12.08.00/ng-edit/projects_ng-dialogs_src_app_content-import_content-import_component_ts.725db6a5ccc27257021d.js.map