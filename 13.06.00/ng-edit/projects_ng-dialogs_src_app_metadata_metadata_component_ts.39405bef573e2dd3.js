"use strict";(self.webpackChunkng_dialogs=self.webpackChunkng_dialogs||[]).push([["projects_ng-dialogs_src_app_metadata_metadata_component_ts","projects_ng-dialogs_src_app_shared_directives_click-stop-propagation_directive_ts","projects_ng-dialogs_src_app_app-administration_services_app-dialog-config_service_ts-_ad200","projects_ng-dialogs_src_app_app-administration_services_app-dialog-config_service_ts-_ad201"],{6886:(I,x,n)=>{n.d(x,{K:()=>_});var i=n(635),d=n(9337),r=n(5266),f=n(8598),p=n(3184),s=n(8784),c=n(2425);let _=(()=>{class g{constructor(l,C,v,M){this.http=l,this.context=C,this.dnnContext=v,this.globalConfigService=M}getDialogSettings(l){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/dialog/settings"),{params:{appId:null!=l?l:this.context.appId.toString()}}).pipe((0,i.U)(C=>(C.Context.Language.List=C.Context.Language.List.filter(v=>v.IsEnabled),C)),(0,d.b)(C=>{this.globalConfigService.allowDebug(C.Context.Enable.DebugMode)}))}}return g.\u0275fac=function(l){return new(l||g)(p.LFG(s.eN),p.LFG(f._),p.LFG(c._y),p.LFG(r.bE))},g.\u0275prov=p.Yz7({token:g,factory:g.\u0275fac}),g})()},1025:(I,x,n)=>{n.d(x,{T:()=>s});var i=n(8598),d=n(7003),r=n(3184),f=n(8784),p=n(2425);let s=(()=>{class c{constructor(_,g,h){this.http=_,this.context=g,this.dnnContext=h}getContentInfo(_){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(d.v+"Get"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),scope:_}})}exportParts(_,g,h){const l=this.dnnContext.$2sxc.http.apiUrl(d.v+"Export")+"?appId="+this.context.appId.toString()+"&zoneId="+this.context.zoneId.toString()+"&contentTypeIdsString="+_.join(";")+"&entityIdsString="+g.join(";")+"&templateIdsString="+h.join(";");window.open(l,"_blank","")}}return c.\u0275fac=function(_){return new(_||c)(r.LFG(f.eN),r.LFG(i._),r.LFG(p._y))},c.\u0275prov=r.Yz7({token:c,factory:c.\u0275fac}),c})()},2372:(I,x,n)=>{n.d(x,{v:()=>s});var i=n(8854),d=n(8598),r=n(3184),f=n(8784),p=n(2425);let s=(()=>{class c{constructor(_,g,h){this.http=_,this.context=g,this.dnnContext=h}getAppInfo(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(i.H+"Statistics"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}exportApp(_,g){const h=this.dnnContext.$2sxc.http.apiUrl(i.H+"Export")+"?appId="+this.context.appId+"&zoneId="+this.context.zoneId+"&includeContentGroups="+_+"&resetAppGuid="+g;window.open(h,"_blank","")}exportForVersionControl(_,g){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(i.H+"SaveData"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),includeContentGroups:_.toString(),resetAppGuid:g.toString()}})}}return c.\u0275fac=function(_){return new(_||c)(r.LFG(f.eN),r.LFG(d._),r.LFG(p._y))},c.\u0275prov=r.Yz7({token:c,factory:c.\u0275fac}),c})()},7003:(I,x,n)=>{n.d(x,{v:()=>s,z:()=>c});var i=n(8854),d=n(8598),r=n(3184),f=n(8784),p=n(2425);const s="admin/appParts/";let c=(()=>{class T{constructor(g,h,l){this.http=g,this.context=h,this.dnnContext=l}importAppParts(g){const h=new FormData;return h.append("File",g),this.http.post(this.dnnContext.$2sxc.http.apiUrl(s+"Import"),h,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}resetApp(){return this.http.post(this.dnnContext.$2sxc.http.apiUrl(i.H+"Reset"),{},{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}}return T.\u0275fac=function(g){return new(g||T)(r.LFG(f.eN),r.LFG(d._),r.LFG(p._y))},T.\u0275prov=r.Yz7({token:T,factory:T.\u0275fac}),T})()},7854:(I,x,n)=>{n.d(x,{Kw:()=>i.K,sF:()=>d.s,vG:()=>s.vG,bf:()=>s.bf,Az:()=>s.Az,TB:()=>s.TB,cv:()=>s.cv,nt:()=>s.nt,h3:()=>c.h});var i=n(6886),d=n(5005),s=(n(1025),n(2372),n(7003),n(6805)),c=n(6559)},6805:(I,x,n)=>{n.d(x,{cv:()=>C,Az:()=>v,nt:()=>M,TB:()=>S,bf:()=>t,vG:()=>Z});var i=n(7400),d=n(9525),r=n(7638),f=n(7396),p=n(8598),s=n(3184),c=n(8784),T=n(2425);const _="admin/query/",C=_+"Run",v=_+"DebugStream",M=_+"Save",S=_+"Get",t=_+"DataSources";let Z=(()=>{class O{constructor(y,L,A){this.http=y,this.context=L,this.dnnContext=A}getAll(y){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(r.PS),{params:{appId:this.context.appId.toString(),contentType:y}})}importQuery(y){return(0,i.D)((0,f.s)(y)).pipe((0,d.z)(L=>this.http.post(this.dnnContext.$2sxc.http.apiUrl("admin/query/import"),{AppId:this.context.appId.toString(),ContentBase64:L})))}clonePipeline(y){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/query/Clone"),{params:{Id:y.toString(),appId:this.context.appId.toString()}})}delete(y){return this.http.delete(this.dnnContext.$2sxc.http.apiUrl("admin/query/Delete"),{params:{appId:this.context.appId.toString(),Id:y.toString()}})}}return O.\u0275fac=function(y){return new(y||O)(s.LFG(c.eN),s.LFG(p._),s.LFG(T._y))},O.\u0275prov=s.Yz7({token:O,factory:O.\u0275fac}),O})()},6559:(I,x,n)=>{n.d(x,{h:()=>h});var i=n(8598),d=n(3184),r=n(8784),f=n(2425);let h=(()=>{class l{constructor(v,M,S){this.http=v,this.context=M,this.dnnContext=S}getAll(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/view/all"),{params:{appId:this.context.appId.toString()}})}delete(v){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/view/delete"),{params:{appId:this.context.appId.toString(),Id:v.toString()}})}import(v){const M=new FormData;return M.append("File",v),this.http.post(this.dnnContext.$2sxc.http.apiUrl("admin/view/import"),M,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}export(v){const M=this.dnnContext.$2sxc.http.apiUrl("admin/view/json")+"?appId="+this.context.appId+"&viewId="+v;window.open(M,"_blank","")}getPolymorphism(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/view/polymorphism"),{params:{appId:this.context.appId.toString()}})}getUsage(v){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/view/usage"),{params:{appId:this.context.appId.toString(),guid:v}})}}return l.\u0275fac=function(v){return new(v||l)(d.LFG(r.eN),d.LFG(i._),d.LFG(f._y))},l.\u0275prov=d.Yz7({token:l,factory:l.\u0275fac}),l})()},803:(I,x,n)=>{n.d(x,{l:()=>g});var i=n(7400),d=n(9525),r=n(7638),f=n(4722),p=n(7396),s=n(8598),c=n(3184),T=n(8784),_=n(2425);let g=(()=>{class h{constructor(C,v,M){this.http=C,this.context=v,this.dnnContext=M}getAll(C){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(r.PS),{params:{appId:this.context.appId.toString(),contentType:C}})}getColumns(C){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(f.jt),{params:{appId:this.context.appId.toString(),staticName:C}})}importItem(C){return(0,i.D)((0,p.s)(C)).pipe((0,d.z)(v=>this.http.post(this.dnnContext.$2sxc.http.apiUrl(r.Uo+"upload"),{AppId:this.context.appId.toString(),ContentBase64:v})))}}return h.\u0275fac=function(C){return new(C||h)(c.LFG(T.eN),c.LFG(s._),c.LFG(_._y))},h.\u0275prov=c.Yz7({token:h,factory:h.\u0275fac}),h})()},8854:(I,x,n)=>{n.d(x,{H:()=>p,a:()=>s});var i=n(8598),d=n(3184),r=n(8784),f=n(2425);const p="admin/app/";let s=(()=>{class c{constructor(_,g,h){this.http=_,this.context=g,this.dnnContext=h}importApp(_,g){const h=new FormData;return h.append("File",_),h.append("Name",g||""),this.http.post(this.dnnContext.$2sxc.http.apiUrl(p+"Import"),h,{params:{zoneId:this.context.zoneId.toString()}})}}return c.\u0275fac=function(_){return new(_||c)(d.LFG(r.eN),d.LFG(i._),d.LFG(f._y))},c.\u0275prov=d.Yz7({token:c,factory:c.\u0275fac}),c})()},969:(I,x,n)=>{n.r(x),n.d(x,{MetadataComponent:()=>Tt});var i=n(9119),d=n(2977),r=n(6317),f=n(7714),p=n(6562),s=n(635),c=n(116),T=n(4874),_=n(679),g=n(803),h=n(8130),l=n(6307),C=n(5578),v=n(6880),M=n(1825),S=n(5137),t=n(3184),Z=n(1130),O=n(785),R=n(5590);let y=(()=>{class o{agInit(e){this.params=e}refresh(e){return!0}deleteMetadata(){this.params.onDelete(this.params.data)}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-metadata-actions"]],decls:4,vars:0,consts:[[1,"actions-component"],["matRipple","","tippy","Delete",1,"like-button","highlight",3,"click"]],template:function(e,a){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.NdJ("click",function(){return a.deleteMetadata()}),t.TgZ(2,"mat-icon"),t._uU(3,"delete"),t.qZA()()())},directives:[Z.wG,O.$,R.Hw],styles:[""]}),o})(),L=(()=>{class o{agInit(e){this.value=e.value,this.metadata=e.data}refresh(e){return!0}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-metadata-content-type"]],decls:2,vars:3,consts:[[1,"container",3,"tippy","tippyDisabled"]],template:function(e,a){1&e&&(t.TgZ(0,"div",0),t._uU(1),t.qZA()),2&e&&(t.Q6J("tippy",a.metadata._Type.Description)("tippyDisabled",!a.metadata._Type.Description),t.xp6(1),t.hij(" ",a.value,"\n"))},directives:[O.$],styles:[".container[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content}"]}),o})();var A=n(5758),U=n(6362),N=n(7317),J=n(845);function Y(o,m){if(1&o&&(t._UZ(0,"div",5),t.ALo(1,"safeHtml")),2&o){const e=t.oxw();t.Q6J("innerHtml",t.lcZ(1,1,e.dialogData.message),t.oJD)}}let w=(()=>{class o{constructor(e,a){this.dialogData=e,this.dialogRef=a,this.hostClass="dialog-component"}closeDialog(e){this.dialogRef.close(e)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(A.WI),t.Y36(A.so))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-confirm-delete-dialog"]],hostVars:1,hostBindings:function(e,a){2&e&&t.Ikx("className",a.hostClass)},decls:9,vars:3,consts:[["mat-dialog-title",""],[1,"dialog-title-box"],["class","dialog-component-content fancy-scrollbar-light",3,"innerHtml",4,"ngIf"],[1,"dialog-component-actions"],["mat-raised-button","",3,"click"],[1,"dialog-component-content","fancy-scrollbar-light",3,"innerHtml"]],template:function(e,a){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t._uU(2),t.qZA()(),t.YNc(3,Y,2,3,"div",2),t.TgZ(4,"div",3)(5,"button",4),t.NdJ("click",function(){return a.closeDialog()}),t._uU(6,"Cancel"),t.qZA(),t.TgZ(7,"button",4),t.NdJ("click",function(){return a.closeDialog(!0)}),t._uU(8,"Delete"),t.qZA()()),2&e&&(t.xp6(2),t.AsE("Delete ",a.dialogData.entityTitle," (",a.dialogData.entityId,")?"),t.xp6(1),t.Q6J("ngIf",a.dialogData.message))},directives:[A.uh,U.O5,N.lW],pipes:[J.z],styles:[".dialog-component-content[_ngcontent-%COMP%]{font-size:14px}"]}),o})();var P=n(587),H=n(8977),z=n(7854),Q=n(9670),$=n(4770),k=n(1434),j=n(3135),V=n(491),X=n(4683),q=n(6623);function tt(o,m){if(1&o&&(t.TgZ(0,"mat-option",21),t._uU(1),t.qZA()),2&o){const e=m.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",e.name," ")}}function et(o,m){if(1&o&&(t.ynx(0),t.TgZ(1,"mat-form-field",7)(2,"mat-label"),t._uU(3,"Scope"),t.qZA(),t.TgZ(4,"mat-select",19),t.YNc(5,tt,2,2,"mat-option",20),t.TgZ(6,"mat-option",21),t._uU(7,"Other..."),t.qZA()()(),t.TgZ(8,"app-field-hint"),t._uU(9," The scope should almost never be changed - "),t.TgZ(10,"a",22),t._uU(11,"see help"),t.qZA()(),t.BQk()),2&o){const e=t.oxw().ngIf,a=t.oxw();t.xp6(4),t.Q6J("placeholder",e.scopeOptions.length?"":"No items found"),t.xp6(1),t.Q6J("ngForOf",e.scopeOptions),t.xp6(1),t.Q6J("value",a.dropdownInsertValue)}}function nt(o,m){if(1&o&&(t.TgZ(0,"mat-option",21),t._uU(1),t.qZA()),2&o){const e=m.$implicit;t.Q6J("value",e.StaticName),t.xp6(1),t.hij(" ",e.Label," ")}}function ot(o,m){if(1&o&&(t.TgZ(0,"mat-select",23),t.YNc(1,nt,2,2,"mat-option",20),t.qZA()),2&o){const e=t.oxw().ngIf;t.Q6J("placeholder",e.contentTypes.length?"":"No items found"),t.xp6(1),t.Q6J("ngForOf",e.contentTypes)}}function at(o,m){1&o&&t._UZ(0,"input",24)}function it(o,m){1&o&&(t.TgZ(0,"app-field-hint",25),t._uU(1," This field is required "),t.qZA()),2&o&&t.Q6J("isError",!0)}const G=function(o){return{active:o}};function st(o,m){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",1)(2,"div",2),t._uU(3,"Create Metadata"),t.qZA()(),t.TgZ(4,"p",3),t._uU(5," This is a special operation to add an item which is metadata for another item, see "),t.TgZ(6,"a",4),t._uU(7,"docs"),t.qZA(),t._uU(8,". "),t.qZA(),t.TgZ(9,"form",5)(10,"div",6),t.YNc(11,et,12,3,"ng-container",0),t.TgZ(12,"mat-form-field",7)(13,"mat-label"),t._uU(14,"Content Type"),t.qZA(),t.YNc(15,ot,2,2,"mat-select",8),t.YNc(16,at,1,0,"input",9),t.TgZ(17,"div",10)(18,"button",11),t.NdJ("click",function(){return t.CHM(e),t.oxw().toggleGuidedContentType(!0)}),t.TgZ(19,"mat-icon"),t._uU(20,"search"),t.qZA()(),t.TgZ(21,"button",12),t.NdJ("click",function(){return t.CHM(e),t.oxw().toggleGuidedContentType(!1)}),t.TgZ(22,"mat-icon"),t._uU(23,"text_fields"),t.qZA()()()(),t.YNc(24,it,2,1,"app-field-hint",13),t.qZA(),t.TgZ(25,"div",14)(26,"mat-slide-toggle",15),t.NdJ("change",function(u){return t.CHM(e),t.oxw().toggleAdvancedMode(u)}),t._uU(27),t.qZA(),t._UZ(28,"div",16),t.TgZ(29,"button",17),t.NdJ("click",function(){return t.CHM(e),t.oxw().closeDialog()}),t._uU(30,"Cancel"),t.qZA(),t.TgZ(31,"button",18),t.NdJ("click",function(){return t.CHM(e),t.oxw().confirm()}),t._uU(32," Confirm "),t.qZA()()(),t.BQk()}if(2&o){const e=t.oxw();t.xp6(9),t.Q6J("formGroup",e.form),t.xp6(2),t.Q6J("ngIf",e.advancedMode&&e.guidedContentType),t.xp6(4),t.Q6J("ngIf",e.guidedContentType),t.xp6(1),t.Q6J("ngIf",!e.guidedContentType),t.xp6(2),t.Q6J("ngClass",t.VKq(10,G,e.guidedContentType)),t.xp6(3),t.Q6J("ngClass",t.VKq(12,G,!e.guidedContentType)),t.xp6(3),t.Q6J("ngIf",e.form.controls.contentType.touched&&(null==e.form.controls.contentType.errors?null:e.form.controls.contentType.errors.required)),t.xp6(2),t.Q6J("checked",e.advancedMode),t.xp6(1),t.hij(" ",e.advancedMode?"Advanced":"Simple"," "),t.xp6(4),t.Q6J("disabled",!e.form.valid)}}let rt=(()=>{class o{constructor(e,a){this.dialogRef=e,this.contentTypesService=a,this.hostClass="dialog-component",this.dropdownInsertValue=Q.G,this.guidedContentType=!0,this.advancedMode=!1}ngOnInit(){this.contentTypes$=new r.X([]),this.scopeOptions$=new r.X([]),this.buildForm(),this.fetchScopes(),this.templateVars$=(0,p.a)([this.contentTypes$,this.scopeOptions$]).pipe((0,s.U)(([e,a])=>({contentTypes:e,scopeOptions:a})))}ngOnDestroy(){this.contentTypes$.complete(),this.scopeOptions$.complete()}closeDialog(e){this.dialogRef.close(e)}toggleGuidedContentType(e){this.guidedContentType=e}toggleAdvancedMode(e){this.advancedMode=e.checked}confirm(){const e=this.form.getRawValue();this.closeDialog(e.contentType)}buildForm(){this.form=new P.cw({}),this.form.addControl("contentType",new P.NI(null,[P.kI.required])),this.form.addControl("scope",new P.NI(M.Z.scopes.default.value)),this.form.controls.scope.valueChanges.pipe((0,T.O)(this.form.controls.scope.value),(0,H.x)()).subscribe(e=>{null!=this.form.controls.contentType.value&&this.form.controls.contentType.patchValue(null),e===Q.G?(e=prompt("This is an advanced feature to show content-types of another scope. Don't use this if you don't know what you're doing, as content-types of other scopes are usually hidden for a good reason.")||M.Z.scopes.default.value,this.scopeOptions$.value.some(a=>a.value===e)||this.scopeOptions$.next([{name:e,value:e},...this.scopeOptions$.value]),this.form.controls.scope.patchValue(e)):this.fetchContentTypes(e)})}fetchContentTypes(e){this.contentTypesService.retrieveContentTypes(e).subscribe(a=>{this.contentTypes$.next(a)})}fetchScopes(){this.contentTypesService.getScopes().subscribe(e=>{this.scopeOptions$.next(e)})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(A.so),t.Y36(z.sF))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-metadata-save-dialog"]],hostVars:1,hostBindings:function(e,a){2&e&&t.Ikx("className",a.hostClass)},decls:2,vars:3,consts:[[4,"ngIf"],["mat-dialog-title",""],[1,"dialog-title-box"],[1,"dialog-description"],["href","http://r.2sxc.org/metadata","target","_blank"],[1,"dialog-form",3,"formGroup"],[1,"dialog-form-content","fancy-scrollbar-light"],["appearance","standard","color","accent"],["formControlName","contentType","required","",3,"placeholder",4,"ngIf"],["matInput","","type","text","formControlName","contentType","required","",4,"ngIf"],["matSuffix","",1,"selection-suffix"],["mat-icon-button","","type","button","tippy","Pick existing value",3,"ngClass","click"],["mat-icon-button","","type","button","tippy","Manual entry",3,"ngClass","click"],[3,"isError",4,"ngIf"],[1,"dialog-form-actions"],["color","accent",3,"checked","change"],[1,"spacer"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],["formControlName","scope",3,"placeholder"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["href","https://2sxc.org/help?tag=scope","target","_blank","appClickStopPropagation",""],["formControlName","contentType","required","",3,"placeholder"],["matInput","","type","text","formControlName","contentType","required",""],[3,"isError"]],template:function(e,a){1&e&&(t.YNc(0,st,33,14,"ng-container",0),t.ALo(1,"async")),2&e&&t.Q6J("ngIf",t.lcZ(1,1,a.templateVars$))},directives:[U.O5,A.uh,P._Y,P.JL,P.sg,$.KE,$.hX,k.gD,P.JJ,P.u,U.sg,Z.ey,j.Y,V.E,P.Q7,X.Nt,P.Fj,$.R9,N.lW,O.$,U.mk,R.Hw,q.Rr],pipes:[U.Ov],styles:[".dialog-form-content[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]:not(:first-of-type){margin-top:8px}"]}),o})();var ct=n(2528),pt=n(1350),W=n(7465);function lt(o,m){1&o&&(t.ynx(0),t._uU(1,"This item is not metadata for anything else."),t.BQk())}function _t(o,m){if(1&o&&(t.ynx(0),t._UZ(1,"br"),t._uU(2),t.BQk()),2&o){const e=t.oxw(2).ngIf;t.xp6(2),t.hij("Number: ",e.itemFor.Number,"")}}function dt(o,m){if(1&o&&(t.ynx(0),t._UZ(1,"br"),t._uU(2),t.BQk()),2&o){const e=t.oxw(2).ngIf;t.xp6(2),t.hij("Guid: ",e.itemFor.Guid,"")}}function mt(o,m){if(1&o&&(t.ynx(0),t._UZ(1,"br"),t._uU(2),t.BQk()),2&o){const e=t.oxw(2).ngIf;t.xp6(2),t.hij("String: ",e.itemFor.String,"")}}function gt(o,m){if(1&o&&(t.ynx(0),t._UZ(1,"br"),t._uU(2),t.BQk()),2&o){const e=t.oxw(2).ngIf;t.xp6(2),t.hij("Title: ",e.itemFor.String,"")}}function ht(o,m){if(1&o&&(t.ynx(0),t._uU(1," This item is metadata for: "),t._UZ(2,"br"),t._uU(3),t._UZ(4,"br"),t._uU(5),t.YNc(6,_t,3,1,"ng-container",0),t.YNc(7,dt,3,1,"ng-container",0),t.YNc(8,mt,3,1,"ng-container",0),t.YNc(9,gt,3,1,"ng-container",0),t.BQk()),2&o){const e=t.oxw().ngIf;t.xp6(3),t.hij("Target: ",e.itemFor.Target," "),t.xp6(2),t.hij("TargetType: ",e.itemFor.TargetType," "),t.xp6(1),t.Q6J("ngIf",e.itemFor.Number),t.xp6(1),t.Q6J("ngIf",e.itemFor.Guid),t.xp6(1),t.Q6J("ngIf",e.itemFor.String),t.xp6(1),t.Q6J("ngIf",e.itemFor.Title)}}function ut(o,m){if(1&o){const e=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).createMetadata()}),t.TgZ(1,"mat-icon"),t._uU(2,"add"),t.qZA()()}}function ft(o,m){if(1&o){const e=t.EpF();t.TgZ(0,"button",18),t.NdJ("click",function(){const D=t.CHM(e).$implicit;return t.oxw(3).createMetadata(D)}),t.TgZ(1,"mat-icon"),t._uU(2),t.qZA()()}if(2&o){const e=m.$implicit;t.uIk("label",e.Title),t.xp6(2),t.Oqu(e.Icon||"add")}}const vt=function(o){return{"fab-opened":o}};function Ct(o,m){if(1&o){const e=t.EpF();t.TgZ(0,"eco-fab-speed-dial",12),t.NdJ("openChange",function(u){return t.CHM(e),t.oxw(2).openChange(u)}),t.TgZ(1,"eco-fab-speed-dial-trigger",13)(2,"button",14)(3,"mat-icon",15),t._uU(4),t.qZA()()(),t.TgZ(5,"eco-fab-speed-dial-actions")(6,"button",16),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).createMetadata()}),t.TgZ(7,"mat-icon"),t._uU(8,"search"),t.qZA()(),t.YNc(9,ft,3,2,"button",17),t.qZA()()}if(2&o){const e=t.oxw().ngIf;t.Q6J("ngClass",t.VKq(4,vt,e.fabOpen)),t.xp6(1),t.Q6J("spin",!0),t.xp6(3),t.Oqu(e.fabOpen?"close":"add"),t.xp6(5),t.Q6J("ngForOf",e.recommendations)}}function xt(o,m){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"div"),t._uU(5),t.qZA(),t.TgZ(6,"button",4),t.NdJ("click",function(){return t.CHM(e),t.oxw().closeDialog()}),t.TgZ(7,"mat-icon"),t._uU(8,"close"),t.qZA()()()(),t.TgZ(9,"p",5),t.YNc(10,lt,2,0,"ng-container",0),t.YNc(11,ht,10,6,"ng-container",0),t.qZA(),t._UZ(12,"router-outlet"),t.TgZ(13,"div",6),t._UZ(14,"ag-grid-angular",7)(15,"div",8),t.YNc(16,ut,3,0,"button",9),t.YNc(17,Ct,10,6,"eco-fab-speed-dial",10),t.qZA()(),t.BQk()}if(2&o){const e=m.ngIf,a=t.oxw();t.xp6(5),t.Oqu(a.title||"Metadata"),t.xp6(5),t.Q6J("ngIf",!e.itemFor),t.xp6(1),t.Q6J("ngIf",e.itemFor),t.xp6(3),t.Q6J("rowData",e.metadata)("modules",a.modules)("gridOptions",a.gridOptions),t.xp6(2),t.Q6J("ngIf",0===e.recommendations.length),t.xp6(1),t.Q6J("ngIf",e.recommendations.length>0)}}let Tt=(()=>{class o{constructor(e,a,u,D,F,b,Mt,Dt,It,yt){var K;this.dialogRef=e,this.router=a,this.route=u,this.metadataService=D,this.snackBar=F,this.entitiesService=b,this.contentItemsService=Mt,this.dialog=Dt,this.viewContainerRef=It,this.changeDetectorRef=yt,this.modules=i.F$j,this.gridOptions=Object.assign(Object.assign({},v.f),{columnDefs:[{headerName:"ID",field:"Id",width:70,headerClass:"dense",cellClass:"id-action no-padding no-outline".split(" "),cellRenderer:C.m,sortable:!0,filter:"agNumberColumnFilter",valueGetter:E=>E.data.Id,cellRendererParams:{tooltipGetter:E=>`ID: ${E.Id}\nGUID: ${E.Guid}`}},{field:"Title",flex:2,minWidth:250,cellClass:"primary-action highlight".split(" "),valueGetter:E=>E.data.Title,sortable:!0,sort:"asc",filter:"agTextColumnFilter",onCellClicked:E=>this.editMetadata(E.data)},{headerName:"Content Type",field:"ContentType",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,cellRenderer:L,filter:"agTextColumnFilter",valueGetter:E=>{const B=E.data;return`${B._Type.Name}${B._Type.Title!==B._Type.Name?` (${B._Type.Title})`:""}`}},{width:42,cellClass:"secondary-action no-padding".split(" "),cellRenderer:y,pinned:"right",cellRendererParams:{onDelete:E=>this.deleteMetadata(E)}}]}),this.metadata$=new r.X([]),this.recommendations$=new r.X([]),this.itemFor$=new r.X(void 0),this.fabOpen$=new r.X(!1),this.subscription=new f.w0,this.targetType=parseInt(this.route.snapshot.paramMap.get("targetType"),10),this.keyType=this.route.snapshot.paramMap.get("keyType"),this.key=this.route.snapshot.paramMap.get("key"),this.title=decodeURIComponent(null!==(K=this.route.snapshot.paramMap.get("title"))&&void 0!==K?K:""),this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName")}ngOnInit(){this.fetchFor(),this.fetchMetadata(),this.refreshOnChildClosed();const e=(0,p.a)([this.metadata$,this.recommendations$]).pipe((0,s.U)(([a,u])=>u.filter(D=>1===D.Count&&!a.some(F=>F._Type.Id===D.Id))));this.templateVars$=(0,p.a)([this.metadata$,e,this.itemFor$,this.fabOpen$]).pipe((0,s.U)(([a,u,D,F])=>({metadata:a,recommendations:u,itemFor:D,fabOpen:F})))}ngOnDestroy(){this.metadata$.complete(),this.recommendations$.complete(),this.itemFor$.complete(),this.fabOpen$.complete(),this.subscription.unsubscribe()}closeDialog(){this.dialogRef.close()}openChange(e){this.fabOpen$.next(e)}createMetadata(e){e?e.CreateEmpty?(this.snackBar.open(`Creating ${e.Name}...`),this.entitiesService.create(e.Id,{For:this.calculateItemFor()}).subscribe({error:()=>{this.snackBar.open(`Creating ${e.Name} failed. Please check console for more info`,void 0,{duration:3e3}),this.fetchMetadata()},next:()=>{this.snackBar.open(`Created ${e.Name}`,void 0,{duration:3e3}),this.fetchMetadata()}})):this.createMetadataForm(e.Id):this.dialog.open(rt,{autoFocus:!1,viewContainerRef:this.viewContainerRef,width:"650px"}).afterClosed().subscribe(u=>{null!=u&&this.createMetadataForm(u)})}createMetadataForm(e){const a={items:[{ContentTypeName:e,For:this.calculateItemFor()}]},u=(0,S.f)(a);this.router.navigate([`edit/${u}`],{relativeTo:this.route}),this.changeDetectorRef.markForCheck()}calculateItemFor(){var e,a;return Object.assign(Object.assign(Object.assign({Target:null!==(a=null===(e=Object.values(M.Z.metadata).find(D=>D.targetType===this.targetType))||void 0===e?void 0:e.target)&&void 0!==a?a:this.targetType.toString(),TargetType:this.targetType},this.keyType===M.Z.keyTypes.guid&&{Guid:this.key}),this.keyType===M.Z.keyTypes.number&&{Number:parseInt(this.key,10)}),this.keyType===M.Z.keyTypes.string&&{String:this.key})}fetchFor(){!this.contentTypeStaticName||this.contentItemsService.getAll(this.contentTypeStaticName).subscribe(e=>{const a=e.find(u=>u.Guid===this.key);(null==a?void 0:a.For)&&this.itemFor$.next(a.For)})}fetchMetadata(){this.metadataService.getMetadata(this.targetType,this.keyType,this.key).subscribe(e=>{this.metadata$.next(e.Items),this.recommendations$.next(e.Recommendations)})}editMetadata(e){const u=(0,S.f)({items:[{EntityId:e.Id}]});this.router.navigate([`edit/${u}`],{relativeTo:this.route})}deleteMetadata(e,a=!1){var u;if(a)this.snackBar.open("Deleting..."),this.entitiesService.delete(e._Type.Id,e.Id,!1).subscribe({next:()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchMetadata()},error:()=>{this.snackBar.open("Delete failed. Please check console for more information",null,{duration:3e3})}});else{const D={entityId:e.Id,entityTitle:e.Title,message:null===(u=this.recommendations$.value.find(b=>b.Id===e._Type.Id))||void 0===u?void 0:u.DeleteWarning};this.dialog.open(w,{autoFocus:!1,data:D,viewContainerRef:this.viewContainerRef,width:"650px"}).afterClosed().subscribe(b=>{b&&this.deleteMetadata(e,!0)})}}refreshOnChildClosed(){this.subscription.add(this.router.events.pipe((0,c.h)(e=>e instanceof d.m2),(0,T.O)(!!this.route.snapshot.firstChild),(0,s.U)(()=>!!this.route.snapshot.firstChild),(0,_.G)(),(0,c.h)(([e,a])=>e&&!a)).subscribe(()=>{this.fetchMetadata()}))}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(A.so),t.Y36(d.F0),t.Y36(d.gz),t.Y36(l.Do),t.Y36(ct.ux),t.Y36(h.g),t.Y36(g.l),t.Y36(A.uw),t.Y36(t.s_b),t.Y36(t.sBO))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-metadata"]],decls:2,vars:3,consts:[[4,"ngIf"],[1,"nav-component-wrapper"],["mat-dialog-title",""],[1,"dialog-title-box"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"dialog-description"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","modules","gridOptions"],[1,"grid-more-actions-box"],["mat-fab","","mat-elevation-z24","","class","grid-fab","tippy","Create a new metadata for this item",3,"click",4,"ngIf"],["class","grid-fab",3,"ngClass","openChange",4,"ngIf"],["mat-fab","","mat-elevation-z24","","tippy","Create a new metadata for this item",1,"grid-fab",3,"click"],[1,"grid-fab",3,"ngClass","openChange"],[3,"spin"],["mat-fab",""],[1,"spin180"],["mat-mini-fab","","label","Other Content Type",3,"click"],["mat-mini-fab","",3,"click",4,"ngFor","ngForOf"],["mat-mini-fab","",3,"click"]],template:function(e,a){1&e&&(t.YNc(0,xt,18,8,"ng-container",0),t.ALo(1,"async")),2&e&&t.Q6J("ngIf",t.lcZ(1,1,a.templateVars$))},directives:[U.O5,A.uh,N.lW,O.$,R.Hw,d.lC,pt.N8,W.W7,U.mk,W.YI,W.Lp,U.sg],pipes:[U.Ov],styles:[""]}),o})()},3135:(I,x,n)=>{n.d(x,{Y:()=>h});var i=n(3184),d=n(6362),r=n(4770);function f(l,C){1&l&&i.GkF(0)}function p(l,C){if(1&l&&(i.TgZ(0,"mat-hint"),i.YNc(1,f,1,0,"ng-container",3),i.qZA()),2&l){i.oxw();const v=i.MAs(4);i.xp6(1),i.Q6J("ngTemplateOutlet",v)}}function s(l,C){1&l&&i.GkF(0)}function c(l,C){if(1&l&&(i.TgZ(0,"mat-error"),i.YNc(1,s,1,0,"ng-container",3),i.qZA()),2&l){i.oxw();const v=i.MAs(4);i.xp6(1),i.Q6J("ngTemplateOutlet",v)}}function T(l,C){1&l&&i.Hsn(0)}const _=function(l){return{"hint-box__short":l}},g=["*"];let h=(()=>{class l{constructor(){this.isError=!1,this.isShort=!0}toggleIsShort(){this.isShort=!this.isShort}}return l.\u0275fac=function(v){return new(v||l)},l.\u0275cmp=i.Xpm({type:l,selectors:[["app-field-hint"]],inputs:{isError:"isError"},ngContentSelectors:g,decls:5,vars:6,consts:[[1,"hint-box",3,"ngClass","ngSwitch","click"],[4,"ngSwitchCase"],["content",""],[4,"ngTemplateOutlet"]],template:function(v,M){1&v&&(i.F$t(),i.TgZ(0,"div",0),i.NdJ("click",function(){return M.toggleIsShort()}),i.YNc(1,p,2,1,"mat-hint",1),i.YNc(2,c,2,1,"mat-error",1),i.qZA(),i.YNc(3,T,1,0,"ng-template",null,2,i.W1O)),2&v&&(i.Q6J("ngClass",i.VKq(4,_,M.isShort))("ngSwitch",M.isError),i.xp6(1),i.Q6J("ngSwitchCase",!1),i.xp6(1),i.Q6J("ngSwitchCase",!0))},directives:[d.mk,d.RF,d.n9,r.bx,d.tP,r.TO],styles:[".hint-box[_ngcontent-%COMP%]{margin-top:4px}.hint-box[_ngcontent-%COMP%]   .mat-hint[_ngcontent-%COMP%], .hint-box[_ngcontent-%COMP%]   .mat-error[_ngcontent-%COMP%]{font-size:12px;display:block}.hint-box__short[_ngcontent-%COMP%]   .mat-hint[_ngcontent-%COMP%], .hint-box__short[_ngcontent-%COMP%]   .mat-error[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]}),l})()},491:(I,x,n)=>{n.d(x,{E:()=>d});var i=n(3184);let d=(()=>{class r{onClick(p){p.stopPropagation()}}return r.\u0275fac=function(p){return new(p||r)},r.\u0275dir=i.lG2({type:r,selectors:[["","appClickStopPropagation",""]],hostBindings:function(p,s){1&p&&i.NdJ("click",function(T){return s.onClick(T)})}}),r})()},7396:(I,x,n)=>{function i(r){return new Promise((f,p)=>{const s=new FileReader;s.readAsDataURL(r),s.onload=()=>{f(s.result.split(",")[1])},s.onerror=c=>{p(c)}})}function d(r){return new Promise((f,p)=>{const s=new FileReader;s.readAsText(r),s.onload=()=>{f(s.result)},s.onerror=c=>{p(c)}})}n.d(x,{s:()=>i,B:()=>d})},845:(I,x,n)=>{n.d(x,{z:()=>r});var i=n(3184),d=n(318);let r=(()=>{class f{constructor(s){this.sanitizer=s}transform(s){return this.sanitizer.bypassSecurityTrustHtml(s)}}return f.\u0275fac=function(s){return new(s||f)(i.Y36(d.H7,16))},f.\u0275pipe=i.Yjl({name:"safeHtml",type:f,pure:!0}),f})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/13.06.00/ng-edit/projects_ng-dialogs_src_app_metadata_metadata_component_ts.39405bef573e2dd3.js.map