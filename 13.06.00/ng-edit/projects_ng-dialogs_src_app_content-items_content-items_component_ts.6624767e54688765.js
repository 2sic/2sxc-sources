"use strict";(self.webpackChunkng_dialogs=self.webpackChunkng_dialogs||[]).push([["projects_ng-dialogs_src_app_content-items_content-items_component_ts","projects_ng-dialogs_src_app_shared_directives_click-stop-propagation_directive_ts","projects_ng-dialogs_src_app_app-administration_services_app-dialog-config_service_ts-_ad200","projects_ng-dialogs_src_app_app-administration_services_app-dialog-config_service_ts-_ad201"],{6886:(Z,x,i)=>{i.d(x,{K:()=>m});var l=i(635),p=i(9337),c=i(5266),y=i(8598),_=i(3184),u=i(8784),g=i(2425);let m=(()=>{class h{constructor(d,M,E,P){this.http=d,this.context=M,this.dnnContext=E,this.globalConfigService=P}getDialogSettings(d){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/dialog/settings"),{params:{appId:null!=d?d:this.context.appId.toString()}}).pipe((0,l.U)(M=>(M.Context.Language.List=M.Context.Language.List.filter(E=>E.IsEnabled),M)),(0,p.b)(M=>{this.globalConfigService.allowDebug(M.Context.Enable.DebugMode)}))}}return h.\u0275fac=function(d){return new(d||h)(_.LFG(u.eN),_.LFG(y._),_.LFG(g._y),_.LFG(c.bE))},h.\u0275prov=_.Yz7({token:h,factory:h.\u0275fac}),h})()},1025:(Z,x,i)=>{i.d(x,{T:()=>u});var l=i(8598),p=i(7003),c=i(3184),y=i(8784),_=i(2425);let u=(()=>{class g{constructor(m,h,v){this.http=m,this.context=h,this.dnnContext=v}getContentInfo(m){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(p.v+"Get"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),scope:m}})}exportParts(m,h,v){const d=this.dnnContext.$2sxc.http.apiUrl(p.v+"Export")+"?appId="+this.context.appId.toString()+"&zoneId="+this.context.zoneId.toString()+"&contentTypeIdsString="+m.join(";")+"&entityIdsString="+h.join(";")+"&templateIdsString="+v.join(";");window.open(d,"_blank","")}}return g.\u0275fac=function(m){return new(m||g)(c.LFG(y.eN),c.LFG(l._),c.LFG(_._y))},g.\u0275prov=c.Yz7({token:g,factory:g.\u0275fac}),g})()},2372:(Z,x,i)=>{i.d(x,{v:()=>u});var l=i(8854),p=i(8598),c=i(3184),y=i(8784),_=i(2425);let u=(()=>{class g{constructor(m,h,v){this.http=m,this.context=h,this.dnnContext=v}getAppInfo(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(l.H+"Statistics"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}exportApp(m,h){const v=this.dnnContext.$2sxc.http.apiUrl(l.H+"Export")+"?appId="+this.context.appId+"&zoneId="+this.context.zoneId+"&includeContentGroups="+m+"&resetAppGuid="+h;window.open(v,"_blank","")}exportForVersionControl(m,h){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(l.H+"SaveData"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),includeContentGroups:m.toString(),resetAppGuid:h.toString()}})}}return g.\u0275fac=function(m){return new(m||g)(c.LFG(y.eN),c.LFG(p._),c.LFG(_._y))},g.\u0275prov=c.Yz7({token:g,factory:g.\u0275fac}),g})()},7003:(Z,x,i)=>{i.d(x,{v:()=>u,z:()=>g});var l=i(8854),p=i(8598),c=i(3184),y=i(8784),_=i(2425);const u="admin/appParts/";let g=(()=>{class D{constructor(h,v,d){this.http=h,this.context=v,this.dnnContext=d}importAppParts(h){const v=new FormData;return v.append("File",h),this.http.post(this.dnnContext.$2sxc.http.apiUrl(u+"Import"),v,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}resetApp(){return this.http.post(this.dnnContext.$2sxc.http.apiUrl(l.H+"Reset"),{},{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}}return D.\u0275fac=function(h){return new(h||D)(c.LFG(y.eN),c.LFG(p._),c.LFG(_._y))},D.\u0275prov=c.Yz7({token:D,factory:D.\u0275fac}),D})()},7854:(Z,x,i)=>{i.d(x,{Kw:()=>l.K,sF:()=>p.s,vG:()=>u.vG,bf:()=>u.bf,Az:()=>u.Az,TB:()=>u.TB,cv:()=>u.cv,nt:()=>u.nt,h3:()=>g.h});var l=i(6886),p=i(5005),u=(i(1025),i(2372),i(7003),i(6805)),g=i(6559)},6805:(Z,x,i)=>{i.d(x,{cv:()=>M,Az:()=>E,nt:()=>P,TB:()=>t,bf:()=>N,vG:()=>B});var l=i(7400),p=i(9525),c=i(7638),y=i(7396),_=i(8598),u=i(3184),g=i(8784),D=i(2425);const m="admin/query/",M=m+"Run",E=m+"DebugStream",P=m+"Save",t=m+"Get",N=m+"DataSources";let B=(()=>{class I{constructor(U,k,W){this.http=U,this.context=k,this.dnnContext=W}getAll(U){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(c.PS),{params:{appId:this.context.appId.toString(),contentType:U}})}importQuery(U){return(0,l.D)((0,y.s)(U)).pipe((0,p.z)(k=>this.http.post(this.dnnContext.$2sxc.http.apiUrl("admin/query/import"),{AppId:this.context.appId.toString(),ContentBase64:k})))}clonePipeline(U){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/query/Clone"),{params:{Id:U.toString(),appId:this.context.appId.toString()}})}delete(U){return this.http.delete(this.dnnContext.$2sxc.http.apiUrl("admin/query/Delete"),{params:{appId:this.context.appId.toString(),Id:U.toString()}})}}return I.\u0275fac=function(U){return new(U||I)(u.LFG(g.eN),u.LFG(_._),u.LFG(D._y))},I.\u0275prov=u.Yz7({token:I,factory:I.\u0275fac}),I})()},6559:(Z,x,i)=>{i.d(x,{h:()=>v});var l=i(8598),p=i(3184),c=i(8784),y=i(2425);let v=(()=>{class d{constructor(E,P,t){this.http=E,this.context=P,this.dnnContext=t}getAll(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/view/all"),{params:{appId:this.context.appId.toString()}})}delete(E){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/view/delete"),{params:{appId:this.context.appId.toString(),Id:E.toString()}})}import(E){const P=new FormData;return P.append("File",E),this.http.post(this.dnnContext.$2sxc.http.apiUrl("admin/view/import"),P,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}export(E){const P=this.dnnContext.$2sxc.http.apiUrl("admin/view/json")+"?appId="+this.context.appId+"&viewId="+E;window.open(P,"_blank","")}getPolymorphism(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/view/polymorphism"),{params:{appId:this.context.appId.toString()}})}getUsage(E){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/view/usage"),{params:{appId:this.context.appId.toString(),guid:E}})}}return d.\u0275fac=function(E){return new(E||d)(p.LFG(c.eN),p.LFG(l._),p.LFG(y._y))},d.\u0275prov=p.Yz7({token:d,factory:d.\u0275fac}),d})()},2386:(Z,x,i)=>{i.r(x),i.d(x,{ContentItemsComponent:()=>me});var l=i(9119),p=i(2977),c=i(6317),y=i(7714),_=i(116),u=i(9295),g=i(4874),D=i(635),m=i(679),h=i(5266),v=i(5005),d=i(6488),M=i(9702),E=i(9230),P=i(1361),t=i(3184),N=i(4770),B=i(4683),I=i(587);const Y=["valueInput"];let U=(()=>{class o{constructor(){this.filter="",this.idFilterString=""}agInit(e){this.filterParams=e}isFilterActive(){return""!==this.filter||this.idFilter.length>0}doesFilterPass(e){var n;if(""!==this.filter){const r=this.filterParams.valueGetter({api:this.filterParams.api,colDef:this.filterParams.colDef,column:this.filterParams.column,columnApi:this.filterParams.columnApi,context:this.filterParams.context,data:e.node.data,getValue:T=>e.node.data[T],node:e.node});if(null==r||!r.some(T=>!!T&&T.includes(this.filter)))return!1}if(this.idFilter.length>0){const a=null===(n=e.data[this.filterParams.colDef.headerName])||void 0===n?void 0:n[0];if(null==a||!this.idFilter.includes(a.Id))return!1}return!0}getModel(){return this.isFilterActive()?{filterType:"entity",filter:this.filter,idFilter:this.idFilter}:void 0}setModel(e){var n,a,r,T;this.filter=null!==(n=null==e?void 0:e.filter)&&void 0!==n?n:"",this.idFilter=null!==(a=null==e?void 0:e.idFilter)&&void 0!==a?a:[],this.idFilterString=null!==(T=null===(r=null==e?void 0:e.idFilter)||void 0===r?void 0:r.join(","))&&void 0!==T?T:""}afterGuiAttached(e){this.valueInputRef.nativeElement.focus()}updateIdFilter(){this.idFilter=this.idFilterString.split(",").map(e=>parseInt(e,10)).filter(e=>!isNaN(e))}filterChanged(){this.filterParams.filterChangedCallback()}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-entity-filter"]],viewQuery:function(e,n){if(1&e&&t.Gf(Y,5),2&e){let a;t.iGM(a=t.CRH())&&(n.valueInputRef=a.first)}},decls:9,vars:2,consts:[["appearance","standard","color","accent"],["matInput","","type","text",3,"ngModel","ngModelChange"],["valueInput",""]],template:function(e,n){1&e&&(t.TgZ(0,"mat-form-field",0)(1,"mat-label"),t._uU(2,"Value"),t.qZA(),t.TgZ(3,"input",1,2),t.NdJ("ngModelChange",function(r){return n.filter=r})("ngModelChange",function(){return n.filterChanged()}),t.qZA()(),t.TgZ(5,"mat-form-field",0)(6,"mat-label"),t._uU(7,"IDs (comma separated)"),t.qZA(),t.TgZ(8,"input",1),t.NdJ("ngModelChange",function(r){return n.idFilterString=r})("ngModelChange",function(){return n.updateIdFilter(),n.filterChanged()}),t.qZA()()),2&e&&(t.xp6(3),t.Q6J("ngModel",n.filter),t.xp6(5),t.Q6J("ngModel",n.idFilterString))},directives:[N.KE,N.hX,B.Nt,I.Fj,I.JJ,I.On],styles:["[_nghost-%COMP%]{display:block;padding:16px 12px 2px}.mat-form-field[_ngcontent-%COMP%]{display:block;width:150px}"]}),o})();var k=i(5578),W=i(6880),b=i(1825),et=i(8254),nt=i(5738),H=i(5137),V=i(1130),R=i(785),w=i(5590),K=i(2796);function ot(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",7),t.NdJ("click",function(){return t.CHM(e),t.oxw().deleteItem()}),t.TgZ(1,"mat-icon"),t._uU(2,"delete"),t.qZA(),t.TgZ(3,"span"),t._uU(4,"Delete"),t.qZA()()}if(2&o){const e=t.oxw();t.Q6J("disabled",e.item._EditInfo.ReadOnly)}}let it=(()=>{class o{constructor(){}agInit(e){this.params=e,this.item=e.data}refresh(e){return!0}clone(){this.params.onClone(this.item)}export(){this.params.onExport(this.item)}deleteItem(){this.params.onDelete(this.item)}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-content-items-actions"]],decls:13,vars:1,consts:[[1,"actions-component"],["matRipple","","tippy","Copy",1,"like-button","highlight",3,"click"],["matRipple","","tippy","Export",1,"like-button","highlight",3,"click"],["matRipple","","tippy","More",1,"like-button","highlight",3,"matMenuTriggerFor"],[1,"grid-more-menu"],["menu","matMenu"],["matMenuContent",""],["mat-menu-item","",3,"disabled","click"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.NdJ("click",function(){return n.clone()}),t.TgZ(2,"mat-icon"),t._uU(3,"file_copy"),t.qZA()(),t.TgZ(4,"div",2),t.NdJ("click",function(){return n.export()}),t.TgZ(5,"mat-icon"),t._uU(6,"cloud_download"),t.qZA()(),t.TgZ(7,"div",3)(8,"mat-icon"),t._uU(9,"more_horiz"),t.qZA()()(),t.TgZ(10,"mat-menu",4,5),t.YNc(12,ot,5,1,"ng-template",6),t.qZA()),2&e){const a=t.MAs(11);t.xp6(7),t.Q6J("matMenuTriggerFor",a)}},directives:[V.wG,R.$,w.Hw,K.p6,K.VK,K.KA,K.OP],styles:[""]}),o})();var S=i(6362);function at(o,s){if(1&o&&(t.TgZ(0,"span",2),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Oqu(e.entities)}}let rt=(()=>{class o{agInit(e){!Array.isArray(e.value)||(this.encodedValue=this.htmlEncode(e.value.join(", ")),e.colDef.allowMultiValue&&(this.entities=e.value.length))}refresh(e){return!0}htmlEncode(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-content-items-entity"]],decls:3,vars:3,consts:[[3,"tippy"],["class","more-entities",4,"ngIf"],[1,"more-entities"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.YNc(1,at,2,1,"span",1),t._uU(2),t.qZA()),2&e&&(t.Q6J("tippy",n.encodedValue),t.xp6(1),t.Q6J("ngIf",n.entities),t.xp6(1),t.hij(" ",n.encodedValue,"\n"))},directives:[R.$,S.O5],styles:[".more-entities[_ngcontent-%COMP%]{padding:0 8px;border-radius:10px;border:1px solid rgba(29,39,61,.44);-webkit-user-select:none;user-select:none}"]}),o})();var st=i(178);const lt=function(o){return{"hide-until-row-hover":o}};function pt(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",4),t.NdJ("click",function(){return t.CHM(e),t.oxw().openMetadata()}),t.TgZ(1,"mat-icon",5),t._uU(2),t.qZA()()}if(2&o){const e=t.oxw();t.Q6J("ngClass",t.VKq(5,lt,!e.metadataCount&&!e.value.metadata))("tippy",e.metadataTooltip),t.xp6(1),t.Q6J("matBadge",e.metadataCount)("matBadgeHidden",!e.metadataCount),t.xp6(1),t.hij(" ",e.value.metadata?"loyalty":"local_offer"," ")}}function ct(o,s){if(1&o&&(t.TgZ(0,"div",6)(1,"mat-icon",7),t._uU(2),t.qZA()()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("matBadge",e.metadataCount)("matBadgeHidden",!e.metadataCount),t.xp6(1),t.hij(" ",e.value.metadata?"loyalty":"local_offer"," ")}}let dt=(()=>{class o{agInit(e){var n,a;this.value=e.value,this.params=e,this.item=e.data,this.readOnly=this.item._EditInfo.ReadOnly,this.metadataCount=null!==(a=null===(n=this.item.Metadata)||void 0===n?void 0:n.length)&&void 0!==a?a:0,this.metadataTooltip=this.item.For?`This item is metadata for:\nTarget: ${this.item.For.Target}\nTargetType: ${this.item.For.TargetType}`+(this.item.For.Number?`\nNumber: ${this.item.For.Number}`:"")+(this.item.For.String?`\nString: ${this.item.For.String}`:"")+(this.item.For.Guid?`\nGuid: ${this.item.For.Guid}`:"")+(this.item.For.Title?`\nTitle: ${this.item.For.Title}`:""):"This item is not metadata.",this.metadataTooltip+=`\n\nThis item has ${this.metadataCount>0?this.metadataCount:"no"} other metadata ${1===this.metadataCount?"item":"items"} attached to it.`}refresh(e){return!0}openMetadata(){this.params.onOpenMetadata(this.item)}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-content-items-status"]],decls:6,vars:4,consts:[[1,"actions-component"],[1,"like-button","icon",3,"tippy"],["class","like-button highlight","matRipple","",3,"ngClass","tippy","click",4,"ngIf"],["class","like-button disabled",4,"ngIf"],["matRipple","",1,"like-button","highlight",3,"ngClass","tippy","click"],["matBadgeColor","accent","matBadgeSize","small",3,"matBadge","matBadgeHidden"],[1,"like-button","disabled"],["matBadgeColor","accent","matBadgeSize","small","matBadgeDisabled","true",3,"matBadge","matBadgeHidden"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"mat-icon"),t._uU(3),t.qZA()(),t.YNc(4,pt,3,7,"div",2),t.YNc(5,ct,3,3,"div",3),t.qZA()),2&e&&(t.xp6(1),t.Q6J("tippy",n.value.published?"Published":"Not published"),t.xp6(2),t.Oqu(n.value.published?"visibility":"visibility_off"),t.xp6(1),t.Q6J("ngIf",!n.readOnly),t.xp6(1),t.Q6J("ngIf",n.readOnly&&!(!n.metadataCount&&!n.value.metadata)))},directives:[R.$,w.Hw,S.O5,V.wG,S.mk,st.k],styles:[".hide-until-row-hover[_ngcontent-%COMP%]{visibility:hidden}  .ag-row-hover .hide-until-row-hover{visibility:visible}"]}),o})();var j=i(8390);let ut=(()=>{class o{constructor(){this.published="",this.metadata="",this.hasMetadata=""}agInit(e){this.filterParams=e}isFilterActive(){return""!==this.published||""!==this.metadata||""!==this.hasMetadata}doesFilterPass(e){let n=!1,a=!1,r=!1;const C=this.filterParams.valueGetter({api:this.filterParams.api,colDef:this.filterParams.colDef,column:this.filterParams.column,columnApi:this.filterParams.columnApi,context:this.filterParams.context,data:e.node.data,getValue:A=>e.node.data[A],node:e.node});return n=""===this.published||null!=C.published&&C.published.toString()===this.published,a=""===this.metadata||null!=C.metadata&&C.metadata.toString()===this.metadata,r=""===this.hasMetadata||null!=C.hasMetadata&&C.hasMetadata.toString()===this.hasMetadata,n&&a&&r}getModel(){return this.isFilterActive()?{filterType:"pub-meta",published:this.published,metadata:this.metadata,hasMetadata:this.hasMetadata}:void 0}setModel(e){this.published=e?e.published:"",this.metadata=e?e.metadata:"",this.hasMetadata=e?e.hasMetadata:""}afterGuiAttached(e){}filterChanged(){this.filterParams.filterChangedCallback()}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-pub-meta-filter"]],decls:27,vars:3,consts:[[1,"title"],[3,"ngModel","ngModelChange"],["value",""],["value","true"],["value","false"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t._uU(1,"Published"),t.qZA(),t.TgZ(2,"mat-radio-group",1),t.NdJ("ngModelChange",function(r){return n.published=r})("ngModelChange",function(){return n.filterChanged()}),t.TgZ(3,"mat-radio-button",2),t._uU(4,"All"),t.qZA(),t.TgZ(5,"mat-radio-button",3),t._uU(6,"Published"),t.qZA(),t.TgZ(7,"mat-radio-button",4),t._uU(8,"Not published"),t.qZA()(),t.TgZ(9,"div",0),t._uU(10,"Is Metadata"),t.qZA(),t.TgZ(11,"mat-radio-group",1),t.NdJ("ngModelChange",function(r){return n.metadata=r})("ngModelChange",function(){return n.filterChanged()}),t.TgZ(12,"mat-radio-button",2),t._uU(13,"All"),t.qZA(),t.TgZ(14,"mat-radio-button",3),t._uU(15,"Is metadata"),t.qZA(),t.TgZ(16,"mat-radio-button",4),t._uU(17,"Is not metadata"),t.qZA()(),t.TgZ(18,"div",0),t._uU(19,"Has Metadata"),t.qZA(),t.TgZ(20,"mat-radio-group",1),t.NdJ("ngModelChange",function(r){return n.hasMetadata=r})("ngModelChange",function(){return n.filterChanged()}),t.TgZ(21,"mat-radio-button",2),t._uU(22,"All"),t.qZA(),t.TgZ(23,"mat-radio-button",3),t._uU(24,"Has metadata"),t.qZA(),t.TgZ(25,"mat-radio-button",4),t._uU(26,"Has no metadata"),t.qZA()()),2&e&&(t.xp6(2),t.Q6J("ngModel",n.published),t.xp6(9),t.Q6J("ngModel",n.metadata),t.xp6(9),t.Q6J("ngModel",n.hasMetadata))},directives:[j.VQ,I.JJ,I.On,j.U0],styles:[".title[_ngcontent-%COMP%]{padding:12px 12px 0}.mat-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;overflow:hidden;padding:12px;width:160px;height:104px}"]}),o})();var $=i(5656),_t=i(6646),G=i(6562),J=i(8977),gt=i(7854),z=i(9670),ht=i(8598),X=i(803),ft=i(8398);function Ct(o){return s=>{if(!s.value)return null;const e=o.controls.keyType.value,n=s.value.toString();switch(e){case b.Z.keyTypes.number:return/^[0-9]+$/.test(n)?null:{patternWholeNumber:!0};case b.Z.keyTypes.guid:const r=["{","}"].some(A=>n.includes(A)),T=n.substring(r?1:0,r?n.length-1:n.length);return(0,ft.M)().test(T)?null:{patternGuid:!0};default:return null}}}var L=i(5758),yt=i(1434),Tt=i(3135),vt=i(491),q=i(7317),xt=i(6623);function It(o,s){if(1&o&&(t.TgZ(0,"mat-option",26),t._uU(1),t.qZA()),2&o){const e=s.$implicit;t.Q6J("value",e.targetType),t.xp6(1),t.hij(" ",e.label," ")}}function Mt(o,s){if(1&o&&(t.TgZ(0,"mat-option",26),t._uU(1),t.qZA()),2&o){const e=t.oxw(2).ngIf;t.Q6J("value",e.formValues.targetType),t.xp6(1),t.hij(" ",e.formValues.targetType," ")}}function Dt(o,s){if(1&o&&(t.TgZ(0,"mat-select",24),t.YNc(1,It,2,2,"mat-option",12),t.YNc(2,Mt,2,2,"mat-option",25),t.qZA()),2&o){const e=t.oxw().ngIf,n=t.oxw();t.xp6(1),t.Q6J("ngForOf",n.targetTypeOptions),t.xp6(1),t.Q6J("ngIf",e.unknownTargetType)}}function Et(o,s){1&o&&t._UZ(0,"input",27)}function At(o,s){1&o&&(t.TgZ(0,"app-field-hint",28),t._uU(1," Warning: you entered an unknown target type. This may work or may not. Please be sure you know what you're doing "),t.qZA()),2&o&&t.Q6J("isError",!1)}function bt(o,s){if(1&o&&(t.TgZ(0,"app-field-hint",28),t._uU(1),t.qZA()),2&o){const e=t.oxw().ngIf;t.Q6J("isError",!1),t.xp6(1),t.Oqu(e.targetTypeHint)}}function Ot(o,s){1&o&&(t.TgZ(0,"app-field-hint",28),t._uU(1," This field is required "),t.qZA()),2&o&&t.Q6J("isError",!0)}function Pt(o,s){1&o&&(t.TgZ(0,"app-field-hint",28),t._uU(1," Must be a whole number "),t.qZA()),2&o&&t.Q6J("isError",!0)}function Zt(o,s){if(1&o&&(t.TgZ(0,"mat-option",26),t._uU(1),t.qZA()),2&o){const e=s.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e," ")}}function Ut(o,s){1&o&&(t.TgZ(0,"app-field-hint",28),t._uU(1," This field is required "),t.qZA()),2&o&&t.Q6J("isError",!0)}function St(o,s){if(1&o&&(t.TgZ(0,"mat-option",26),t._uU(1),t.qZA()),2&o){const e=s.$implicit;t.Q6J("value",e.StaticName),t.xp6(1),t.hij(" ",e.Label," ")}}function Ft(o,s){if(1&o&&(t.TgZ(0,"mat-form-field",7)(1,"mat-label"),t._uU(2,"Content Type"),t.qZA(),t.TgZ(3,"mat-select",29),t.YNc(4,St,2,2,"mat-option",12),t.qZA()()),2&o){const e=t.oxw().ngIf;t.xp6(3),t.Q6J("placeholder",e.contentTypes.length?"":"No items found"),t.xp6(1),t.Q6J("ngForOf",e.contentTypes)}}function Nt(o,s){if(1&o&&(t.TgZ(0,"mat-option",26),t._uU(1),t.qZA()),2&o){const e=s.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",e.name," ")}}function kt(o,s){if(1&o&&(t.TgZ(0,"mat-form-field",7)(1,"mat-label"),t._uU(2,"Scope"),t.qZA(),t.TgZ(3,"mat-select",30),t.YNc(4,Nt,2,2,"mat-option",12),t.TgZ(5,"mat-option",26),t._uU(6,"Other..."),t.qZA()()()),2&o){const e=t.oxw().ngIf,n=t.oxw();t.xp6(3),t.Q6J("placeholder",e.scopeOptions.length?"":"No items found"),t.xp6(1),t.Q6J("ngForOf",e.scopeOptions),t.xp6(1),t.Q6J("value",n.dropdownInsertValue)}}function Rt(o,s){1&o&&t.GkF(0)}function $t(o,s){if(1&o&&(t.TgZ(0,"mat-option",26),t._uU(1),t.qZA()),2&o){const e=s.$implicit;t.Q6J("value",e.Guid),t.xp6(1),t.AsE(" ",e.Title," (",e.Id,") ")}}function Jt(o,s){if(1&o&&(t.TgZ(0,"mat-select",36),t.YNc(1,$t,2,3,"mat-option",12),t.qZA()),2&o){const e=t.oxw(3).ngIf;t.Q6J("placeholder",e.contentItems.length?"":"No items found"),t.xp6(1),t.Q6J("ngForOf",e.contentItems)}}function Lt(o,s){1&o&&t._UZ(0,"input",37)}function Qt(o,s){if(1&o&&(t.ynx(0),t.YNc(1,Jt,2,2,"mat-select",34),t.YNc(2,Lt,1,0,"input",35),t.BQk()),2&o){const e=t.oxw(2).ngIf;t.xp6(1),t.Q6J("ngIf",e.guidedKey),t.xp6(1),t.Q6J("ngIf",!e.guidedKey)}}function Bt(o,s){if(1&o&&(t.TgZ(0,"mat-option",26),t._uU(1),t.qZA()),2&o){const e=s.$implicit;t.Q6J("value",e.StaticName),t.xp6(1),t.hij(" ",e.Label," ")}}function wt(o,s){if(1&o&&(t.TgZ(0,"mat-select",36),t.YNc(1,Bt,2,2,"mat-option",12),t.qZA()),2&o){const e=t.oxw(3).ngIf;t.Q6J("placeholder",e.contentTypes.length?"":"No items found"),t.xp6(1),t.Q6J("ngForOf",e.contentTypes)}}function Kt(o,s){1&o&&t._UZ(0,"input",37)}function Gt(o,s){if(1&o&&(t.ynx(0),t.YNc(1,wt,2,2,"mat-select",34),t.YNc(2,Kt,1,0,"input",35),t.BQk()),2&o){const e=t.oxw(2).ngIf;t.xp6(1),t.Q6J("ngIf",e.guidedKey),t.xp6(1),t.Q6J("ngIf",!e.guidedKey)}}function Yt(o,s){1&o&&t.GkF(0)}function Wt(o,s){if(1&o&&(t.ynx(0),t.YNc(1,Yt,1,0,"ng-container",38),t.BQk()),2&o){t.oxw(2);const e=t.MAs(39);t.xp6(1),t.Q6J("ngTemplateOutlet",e)}}function Ht(o,s){if(1&o&&(t.ynx(0,31),t.YNc(1,Qt,3,2,"ng-container",32),t.YNc(2,Gt,3,2,"ng-container",32),t.YNc(3,Wt,2,1,"ng-container",33),t.BQk()),2&o){const e=t.oxw().ngIf,n=t.oxw();t.Q6J("ngSwitch",e.formValues.targetType),t.xp6(1),t.Q6J("ngSwitchCase",n.eavConstants.metadata.entity.targetType),t.xp6(1),t.Q6J("ngSwitchCase",n.eavConstants.metadata.contentType.targetType)}}function Vt(o,s){1&o&&t._UZ(0,"input",37)}function jt(o,s){1&o&&t._UZ(0,"input",40)}function zt(o,s){if(1&o&&(t.YNc(0,Vt,1,0,"input",35),t.YNc(1,jt,1,0,"input",39)),2&o){const e=t.oxw().ngIf,n=t.oxw();t.Q6J("ngIf",e.formValues.keyType!==n.eavConstants.keyTypes.number),t.xp6(1),t.Q6J("ngIf",e.formValues.keyType===n.eavConstants.keyTypes.number)}}const tt=function(o){return{active:o}};function Xt(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",41)(1,"button",42),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).toggleGuidedKey(!0)}),t.TgZ(2,"mat-icon"),t._uU(3,"search"),t.qZA()(),t.TgZ(4,"button",43),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).toggleGuidedKey(!1)}),t.TgZ(5,"mat-icon"),t._uU(6,"text_fields"),t.qZA()()()}if(2&o){const e=t.oxw().ngIf;t.xp6(1),t.Q6J("ngClass",t.VKq(2,tt,e.guidedKey)),t.xp6(3),t.Q6J("ngClass",t.VKq(4,tt,!e.guidedKey))}}function qt(o,s){1&o&&(t.TgZ(0,"app-field-hint",28),t._uU(1," This field is required "),t.qZA()),2&o&&t.Q6J("isError",!0)}function te(o,s){1&o&&(t.TgZ(0,"app-field-hint",28),t._uU(1," Must be a whole number "),t.qZA()),2&o&&t.Q6J("isError",!0)}function ee(o,s){1&o&&(t.TgZ(0,"app-field-hint",28),t._uU(1," Must be a valid GUID "),t.qZA()),2&o&&t.Q6J("isError",!0)}function ne(o,s){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",1)(2,"div",2),t._uU(3,"Create Metadata"),t.qZA()(),t.TgZ(4,"p",3),t._uU(5," This is a special operation to add an item which is metadata for another item, see "),t.TgZ(6,"a",4),t._uU(7,"docs"),t.qZA(),t._uU(8,". "),t.qZA(),t.TgZ(9,"form",5)(10,"div",6)(11,"mat-form-field",7)(12,"mat-label"),t._uU(13,"Target"),t.qZA(),t.YNc(14,Dt,3,2,"mat-select",8),t.YNc(15,Et,1,0,"input",9),t.qZA(),t.YNc(16,At,2,1,"app-field-hint",10),t.YNc(17,bt,2,2,"app-field-hint",10),t.YNc(18,Ot,2,1,"app-field-hint",10),t.YNc(19,Pt,2,1,"app-field-hint",10),t.TgZ(20,"mat-form-field",7)(21,"mat-label"),t._uU(22,"Key type"),t.qZA(),t.TgZ(23,"mat-select",11),t.YNc(24,Zt,2,2,"mat-option",12),t.qZA()(),t.YNc(25,Ut,2,1,"app-field-hint",10),t.YNc(26,Ft,5,2,"mat-form-field",13),t.YNc(27,kt,7,3,"mat-form-field",13),t.TgZ(28,"app-field-hint"),t._uU(29," The scope should almost never be changed - "),t.TgZ(30,"a",14),t._uU(31,"see help"),t.qZA()(),t.TgZ(32,"mat-form-field",7)(33,"mat-label"),t._uU(34,"Key"),t.qZA(),t.YNc(35,Rt,1,0,"ng-container",15),t.YNc(36,Ht,4,3,"ng-template",null,16,t.W1O),t.YNc(38,zt,2,2,"ng-template",null,17,t.W1O),t.YNc(40,Xt,7,6,"div",18),t.qZA(),t.YNc(41,qt,2,1,"app-field-hint",10),t.YNc(42,te,2,1,"app-field-hint",10),t.YNc(43,ee,2,1,"app-field-hint",10),t.qZA(),t.TgZ(44,"div",19)(45,"mat-slide-toggle",20),t.NdJ("change",function(a){return t.CHM(e),t.oxw().toggleGuidedMode(a)}),t._uU(46),t.qZA(),t._UZ(47,"div",21),t.TgZ(48,"button",22),t.NdJ("click",function(){return t.CHM(e),t.oxw().closeDialog()}),t._uU(49,"Cancel"),t.qZA(),t.TgZ(50,"button",23),t.NdJ("click",function(){return t.CHM(e),t.oxw().confirm()}),t._uU(51," Confirm "),t.qZA()()(),t.BQk()}if(2&o){const e=s.ngIf,n=t.MAs(37),a=t.MAs(39),r=t.oxw();t.xp6(9),t.Q6J("formGroup",r.form),t.xp6(5),t.Q6J("ngIf",e.guidedMode),t.xp6(1),t.Q6J("ngIf",!e.guidedMode),t.xp6(1),t.Q6J("ngIf",r.form.controls.targetType.touched&&!r.form.controls.targetType.invalid&&e.unknownTargetType),t.xp6(1),t.Q6J("ngIf",e.targetTypeHint),t.xp6(1),t.Q6J("ngIf",r.form.controls.targetType.touched&&(null==r.form.controls.targetType.errors?null:r.form.controls.targetType.errors.required)),t.xp6(1),t.Q6J("ngIf",r.form.controls.targetType.touched&&(null==r.form.controls.targetType.errors?null:r.form.controls.targetType.errors.pattern)),t.xp6(5),t.Q6J("ngForOf",e.keyTypeOptions),t.xp6(1),t.Q6J("ngIf",r.form.controls.keyType.touched&&(null==r.form.controls.keyType.errors?null:r.form.controls.keyType.errors.required)),t.xp6(1),t.Q6J("ngIf",e.guidedMode&&e.formValues.targetType===r.eavConstants.metadata.entity.targetType),t.xp6(1),t.Q6J("ngIf",e.guidedMode&&(e.formValues.targetType===r.eavConstants.metadata.entity.targetType||e.formValues.targetType===r.eavConstants.metadata.contentType.targetType)),t.xp6(8),t.Q6J("ngIf",e.guidedMode)("ngIfThen",n)("ngIfElse",a),t.xp6(5),t.Q6J("ngIf",e.guidedMode&&e.guidedKeyExists),t.xp6(1),t.Q6J("ngIf",r.form.controls.key.touched&&(null==r.form.controls.key.errors?null:r.form.controls.key.errors.required)),t.xp6(1),t.Q6J("ngIf",r.form.controls.key.touched&&(null==r.form.controls.key.errors?null:r.form.controls.key.errors.patternWholeNumber)),t.xp6(1),t.Q6J("ngIf",r.form.controls.key.touched&&(null==r.form.controls.key.errors?null:r.form.controls.key.errors.patternGuid)),t.xp6(2),t.Q6J("tippy",e.guidedMode?"Guided mode helps you select options that work":"Manual mode is for advanced uses and allows you to insert any values")("checked",e.guidedMode),t.xp6(1),t.hij(" ",e.guidedMode?"Guided":"Manual"," "),t.xp6(4),t.Q6J("disabled",!r.form.valid)}}let oe=(()=>{class o{constructor(e,n,a,r){this.dialogRef=e,this.context=n,this.contentItemsService=a,this.contentTypesService=r,this.hostClass="dialog-component",this.eavConstants=b.Z,this.dropdownInsertValue=z.G}ngOnInit(){this.subscription=new y.w0,this.targetTypeOptions=Object.values(b.Z.metadata).map(n=>Object.assign({},n)),this.keyTypeOptions=Object.values(b.Z.keyTypes),this.keyTypeOptions$=new c.X([]),this.scopeOptions$=new c.X([]),this.guidedMode$=new c.X(!0),this.contentItems$=new c.X([]),this.contentTypes$=new c.X([]),this.guidedKey$=new c.X(!0),this.fetchScopes(),this.form=new I.cw({}),this.form.addControl("targetType",new I.NI(b.Z.metadata.entity.targetType,[I.kI.required,I.kI.pattern(/^[0-9]+$/)])),this.form.addControl("keyType",new I.NI(b.Z.metadata.entity.keyType,[I.kI.required])),this.form.addControl("contentTypeForContentItems",new I.NI(null)),this.form.addControl("scopeForContentTypes",new I.NI(b.Z.scopes.default.value)),this.form.addControl("key",new I.NI(null,[I.kI.required,Ct(this.form)])),this.subscription.add(this.form.controls.scopeForContentTypes.valueChanges.pipe((0,g.O)(this.form.controls.scopeForContentTypes.value),(0,J.x)()).subscribe(n=>{null!=this.form.controls.contentTypeForContentItems.value&&this.form.controls.contentTypeForContentItems.patchValue(null),n===z.G?(n=prompt("This is an advanced feature to show content-types of another scope. Don't use this if you don't know what you're doing, as content-types of other scopes are usually hidden for a good reason.")||b.Z.scopes.default.value,this.scopeOptions$.value.some(a=>a.value===n)||this.scopeOptions$.next([{name:n,value:n},...this.scopeOptions$.value]),this.form.controls.scopeForContentTypes.patchValue(n)):this.fetchContentTypes(n)})),this.subscription.add((0,_t.T)(this.form.controls.targetType.valueChanges.pipe((0,J.x)()),this.form.controls.keyType.valueChanges.pipe((0,J.x)())).subscribe(()=>{this.guidedKey$.next(!0),null!=this.form.getRawValue().key&&this.form.patchValue({key:null})})),this.subscription.add(this.form.controls.contentTypeForContentItems.valueChanges.pipe((0,g.O)(this.form.controls.contentTypeForContentItems.value),(0,J.x)()).subscribe(n=>{const a=this.form.getRawValue();a.targetType===b.Z.metadata.entity.targetType&&null!=a.key&&this.form.patchValue({key:null}),this.contentItemsService.getAll(n).subscribe(r=>{this.contentItems$.next(r)})}));const e=this.form.valueChanges.pipe((0,g.O)(this.form.getRawValue()),(0,D.U)(()=>this.form.getRawValue()),(0,J.x)($.iX.objectsEqual));this.subscription.add((0,G.a)([e,this.guidedMode$]).subscribe(([n,a])=>{const r=this.targetTypeOptions.find(f=>f.targetType===n.targetType),T=a&&r?[r.keyType]:[...this.keyTypeOptions];$.iX.arraysEqual(T,this.keyTypeOptions$.value)||this.keyTypeOptions$.next(T);const C={};this.keyTypeOptions$.value.includes(n.keyType)||(C.keyType=this.keyTypeOptions$.value[0]);const A=a&&n.targetType===b.Z.metadata.app.targetType;A&&n.key!==this.context.appId&&(C.key=this.context.appId),Object.keys(C).length&&this.form.patchValue(C),$.iX.disableControl(this.form.controls.keyType,a&&this.keyTypeOptions$.value.length<=1),$.iX.disableControl(this.form.controls.key,A)})),this.templateVars$=(0,G.a)([(0,G.a)([this.guidedMode$,this.keyTypeOptions$,this.scopeOptions$,this.contentItems$,this.contentTypes$]),(0,G.a)([e,this.guidedKey$])]).pipe((0,D.U)(([[n,a,r,T,C],[A,F]])=>{var f;return{guidedMode:n,unknownTargetType:!this.targetTypeOptions.some(Q=>Q.targetType===A.targetType),targetTypeHint:n&&(null===(f=this.targetTypeOptions.find(Q=>Q.targetType===A.targetType))||void 0===f?void 0:f.hint),keyTypeOptions:a,scopeOptions:r,guidedKey:F,guidedKeyExists:[b.Z.metadata.entity.targetType,b.Z.metadata.contentType.targetType].includes(A.targetType),formValues:A,contentItems:T,contentTypes:C}}))}ngOnDestroy(){this.guidedMode$.complete(),this.keyTypeOptions$.complete(),this.contentItems$.complete(),this.contentTypes$.complete(),this.guidedKey$.complete(),this.subscription.unsubscribe()}closeDialog(e){this.dialogRef.close(e)}toggleGuidedKey(e){this.guidedKey$.next(e)}toggleGuidedMode(e){this.guidedMode$.next(e.checked)}confirm(){var e;const n=this.form.getRawValue(),a={target:null===(e=this.targetTypeOptions.find(r=>r.targetType===n.targetType))||void 0===e?void 0:e.target,targetType:n.targetType,keyType:n.keyType,key:n.keyType===b.Z.keyTypes.guid?n.key.replace(/{|}/g,""):n.key.toString()};this.closeDialog(a)}fetchContentTypes(e){this.contentTypesService.retrieveContentTypes(e).subscribe(n=>{this.contentTypes$.next(n)})}fetchScopes(){this.contentTypesService.getScopes().subscribe(e=>{this.scopeOptions$.next(e)})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(L.so),t.Y36(ht._),t.Y36(X.l),t.Y36(gt.sF))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-create-metadata-dialog"]],hostVars:1,hostBindings:function(e,n){2&e&&t.Ikx("className",n.hostClass)},decls:2,vars:3,consts:[[4,"ngIf"],["mat-dialog-title",""],[1,"dialog-title-box"],[1,"dialog-description"],["href","http://r.2sxc.org/metadata","target","_blank"],[1,"dialog-form",3,"formGroup"],[1,"dialog-form-content","fancy-scrollbar-light"],["appearance","standard","color","accent"],["formControlName","targetType","required","",4,"ngIf"],["matInput","","type","number","min","0","formControlName","targetType","required","",4,"ngIf"],[3,"isError",4,"ngIf"],["formControlName","keyType","required",""],[3,"value",4,"ngFor","ngForOf"],["appearance","standard","color","accent",4,"ngIf"],["href","https://2sxc.org/help?tag=scope","target","_blank","appClickStopPropagation",""],[4,"ngIf","ngIfThen","ngIfElse"],["specialKeyInputs",""],["defaultKeyInput",""],["matSuffix","","class","selection-suffix",4,"ngIf"],[1,"dialog-form-actions"],["color","accent",3,"tippy","checked","change"],[1,"spacer"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],["formControlName","targetType","required",""],[3,"value",4,"ngIf"],[3,"value"],["matInput","","type","number","min","0","formControlName","targetType","required",""],[3,"isError"],["formControlName","contentTypeForContentItems",3,"placeholder"],["formControlName","scopeForContentTypes",3,"placeholder"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["formControlName","key","required","",3,"placeholder",4,"ngIf"],["matInput","","type","text","formControlName","key","required","",4,"ngIf"],["formControlName","key","required","",3,"placeholder"],["matInput","","type","text","formControlName","key","required",""],[4,"ngTemplateOutlet"],["matInput","","type","number","formControlName","key","required","",4,"ngIf"],["matInput","","type","number","formControlName","key","required",""],["matSuffix","",1,"selection-suffix"],["mat-icon-button","","type","button","tippy","Pick existing value",3,"ngClass","click"],["mat-icon-button","","type","button","tippy","Manual entry",3,"ngClass","click"]],template:function(e,n){1&e&&(t.YNc(0,ne,52,22,"ng-container",0),t.ALo(1,"async")),2&e&&t.Q6J("ngIf",t.lcZ(1,1,n.templateVars$))},directives:[S.O5,L.uh,I._Y,I.JL,I.sg,N.KE,N.hX,yt.gD,I.JJ,I.u,I.Q7,S.sg,V.ey,B.Nt,I.qQ,I.wV,I.Fj,Tt.Y,vt.E,S.RF,S.n9,S.ED,S.tP,N.R9,q.lW,R.$,S.mk,w.Hw,xt.Rr],pipes:[S.Ov],styles:[".dialog-form-content[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]:not(:first-of-type){margin-top:8px}"]}),o})();var ie=i(8130),ae=i(2528),re=i(5469),se=i(1350),le=i(1529),pe=i(845);function ce(o,s){if(1&o&&(t.ynx(0),t._uU(1),t.BQk()),2&o){const e=s.ngIf;t.xp6(1),t.hij(" ",e.Label||e.Name," ")}}function de(o,s){1&o&&(t._UZ(0,"div",15),t.ALo(1,"safeHtml")),2&o&&t.Q6J("innerHTML",t.lcZ(1,1,s.ngIf),t.oJD)}function ue(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"button",16),t.NdJ("click",function(){return t.CHM(e),t.oxw().debugFilter()}),t.TgZ(1,"mat-icon"),t._uU(2,"filter_list"),t.qZA(),t.TgZ(3,"span"),t._uU(4,"Filter"),t.qZA()()}}let me=(()=>{class o{constructor(e,n,a,r,T,C,A,F,f,O,Q,_e){this.dialogRef=e,this.contentTypesService=n,this.router=a,this.route=r,this.contentItemsService=T,this.entitiesService=C,this.contentExportService=A,this.snackBar=F,this.globalConfigService=f,this.dialog=O,this.viewContainerRef=Q,this.changeDetectorRef=_e,this.contentType$=new c.X(void 0),this.items$=new c.X(void 0),this.debugEnabled$=this.globalConfigService.getDebugEnabled$(),this.modules=l.F$j,this.gridOptions=Object.assign({},W.f),this.gridApi$=new c.X(null),this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName"),this.subscription=new y.w0}ngOnInit(){this.fetchContentType(),this.fetchItems(),this.fetchColumns(),this.refreshOnChildClosed()}ngOnDestroy(){this.contentType$.complete(),this.items$.complete(),this.gridApi$.complete(),this.subscription.unsubscribe()}closeDialog(){this.dialogRef.close()}onGridReady(e){this.gridApi$.next(e.api)}fetchContentType(){this.contentTypesService.retrieveContentType(this.contentTypeStaticName).subscribe(e=>{this.contentType$.next(e)})}fetchItems(){this.contentItemsService.getAll(this.contentTypeStaticName).subscribe(e=>{this.items$.next(e)})}fetchColumns(){this.contentItemsService.getColumns(this.contentTypeStaticName).subscribe(e=>{const n=this.buildColumnDefs(e),a=function mt(o,s){var e,n;if(!o)return;let a;"="===o.charAt(o.length-1)&&(o=atob(o));try{a=JSON.parse(o)}catch(T){console.error("Can't parse JSON with filters from url:",o)}if(!a)return;const r={};if(a.IsPublished||a.IsMetadata){const T={filterType:"pub-meta",published:null!==(e=a.IsPublished)&&void 0!==e?e:"",metadata:null!==(n=a.IsMetadata)&&void 0!==n?n:"",hasMetadata:""};r.Status=T}return Object.entries(a).filter(([T,C])=>"IsPublished"!==T&&"IsMetadata"!==T).forEach(([T,C])=>{var A;const F=s.find(f=>f.headerName===T);if("entityFilterComponent"!==(null==F?void 0:F.filter)){if("string"==typeof C)r[T]={filterType:"text",type:"equals",filter:C};else if("number"==typeof C)r[T]={filterType:"number",type:"equals",filter:C,filterTo:null};else if("boolean"==typeof C){const f={filterType:"boolean",filter:C.toString()};r[T]=f}}else{const f={filterType:"entity",filter:"string"==typeof(C=null!==(A=$.iX.tryParse(C))&&void 0!==A?A:C)?C:void 0,idFilter:"number"==typeof C?[C]:Array.isArray(C)?C.filter(O=>"number"==typeof O):void 0};r[T]=f}}),r}(sessionStorage.getItem(et.JA),n);this.gridApi$.value?this.setColumnDefs(n,a):this.gridApi$.pipe((0,_.h)(r=>null!=r),(0,u.q)(1)).subscribe(r=>{this.setColumnDefs(n,a)})})}setColumnDefs(e,n){this.gridApi$.value.setColumnDefs(e),n&&((0,nt.P)("Will try to apply filter:",n),this.gridApi$.value.setFilterModel(n))}openMetadata(e){const n=E.U.getUrlEntity(e.Guid,`Metadata for Entity: ${e._Title} (${e.Id})`,this.contentTypeStaticName);this.router.navigate([n],{relativeTo:this.route})}editItem(e){const a=(0,H.f)({items:[null==e?{ContentTypeName:this.contentTypeStaticName}:{EntityId:e.Id}]});this.router.navigate([`edit/${a}`],{relativeTo:this.route})}exportContent(){const e=this.gridApi$.value.getFilterModel(),n=Object.keys(e).length>0,a=[];n&&this.gridApi$.value.forEachNodeAfterFilterAndSort(r=>{a.push(r.data.Id)}),this.router.navigate([`export/${this.contentTypeStaticName}${a.length>0?`/${a}`:""}`],{relativeTo:this.route})}filesDropped(e){const n=e[0];switch(n.name.substring(n.name.lastIndexOf(".")+1).toLocaleLowerCase()){case"xml":this.importContent(e);break;case"json":this.importItem(e)}}importContent(e){this.router.navigate([`${this.contentTypeStaticName}/import`],{relativeTo:this.route,state:{files:e}})}importItem(e){this.router.navigate(["import"],{relativeTo:this.route,state:{files:e}})}createMetadata(){this.dialog.open(oe,{autoFocus:!1,viewContainerRef:this.viewContainerRef,width:"650px"}).afterClosed().subscribe(n=>{var a;if(null==n)return;const r={items:[{ContentTypeName:this.contentTypeStaticName,For:Object.assign(Object.assign(Object.assign({Target:null!==(a=n.target)&&void 0!==a?a:n.targetType.toString(),TargetType:n.targetType},n.keyType===b.Z.keyTypes.guid&&{Guid:n.key}),n.keyType===b.Z.keyTypes.number&&{Number:parseInt(n.key,10)}),n.keyType===b.Z.keyTypes.string&&{String:n.key})}]},T=(0,H.f)(r);this.router.navigate([`edit/${T}`],{relativeTo:this.route}),this.changeDetectorRef.markForCheck()})}debugFilter(){console.warn("Current filter:",this.gridApi$.value.getFilterModel()),this.snackBar.open("Check console for filter information",void 0,{duration:3e3})}refreshOnChildClosed(){this.subscription.add(this.router.events.pipe((0,_.h)(e=>e instanceof p.m2),(0,g.O)(!!this.route.snapshot.firstChild),(0,D.U)(()=>!!this.route.snapshot.firstChild),(0,m.G)(),(0,_.h)(([e,n])=>e&&!n)).subscribe(()=>{this.fetchItems()}))}buildColumnDefs(e){var n,a,r,T,C,A;const F=[{headerName:"ID",field:"Id",width:70,headerClass:"dense",cellClass:f=>((f.data._EditInfo.ReadOnly?"disabled":"")+" id-action no-padding no-outline").split(" "),cellRenderer:k.m,sortable:!0,filter:"agNumberColumnFilter",valueGetter:f=>f.data.Id,cellRendererParams:{tooltipGetter:f=>`ID: ${f.Id}\nRepoID: ${f._RepositoryId}\nGUID: ${f.Guid}`}},{field:"Status",width:82,headerClass:"dense",cellClass:"secondary-action no-padding".split(" "),filter:ut,cellRenderer:dt,valueGetter:this.valueGetterStatus,cellRendererParams:{onOpenMetadata:f=>this.openMetadata(f)}},{headerName:"Item (Entity)",field:"_Title",flex:2,minWidth:250,cellClass:"primary-action highlight".split(" "),sortable:!0,filter:"agTextColumnFilter",onCellClicked:f=>this.editItem(f.data),valueGetter:f=>f.data._Title},{headerName:"Stats",headerTooltip:"Used by others / uses others",field:"_Used",width:70,headerClass:"dense",cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:this.valueGetterUsage},{cellClass:"secondary-action no-padding".split(" "),width:122,cellRenderer:it,pinned:"right",cellRendererParams:{onClone:f=>this.clone(f),onExport:f=>this.export(f),onDelete:f=>this.delete(f)}}];for(const f of e){const O={headerName:f.StaticName,field:f.StaticName,flex:2,minWidth:250,cellClass:"no-outline",sortable:!0};switch(f.Type){case M.Q.Entity:O.allowMultiValue=null===(r=null===(a=null===(n=f.Metadata)||void 0===n?void 0:n.Entity)||void 0===a?void 0:a.AllowMultiValue)||void 0===r||r,O.cellRenderer=rt,O.valueGetter=this.valueGetterEntityField,O.filter=U;break;case M.Q.DateTime:O.useTimePicker=null!==(A=null===(C=null===(T=f.Metadata)||void 0===T?void 0:T.DateTime)||void 0===C?void 0:C.UseTimePicker)&&void 0!==A&&A,O.valueGetter=this.valueGetterDateTime,O.filter="agTextColumnFilter";break;case M.Q.Boolean:O.valueGetter=this.valueGetterBoolean,O.filter=P.U;break;case M.Q.Number:O.filter="agNumberColumnFilter";break;default:O.filter="agTextColumnFilter"}F.push(O)}return F}clone(e){const a=(0,H.f)({items:[{ContentTypeName:this.contentTypeStaticName,DuplicateEntity:e.Id}]});this.router.navigate([`edit/${a}`],{relativeTo:this.route})}export(e){this.contentExportService.exportEntity(e.Id,this.contentTypeStaticName,!0)}delete(e){!confirm(`Delete '${e._Title}' (${e._RepositoryId})?`)||(this.snackBar.open("Deleting..."),this.entitiesService.delete(this.contentTypeStaticName,e._RepositoryId,!1).subscribe({next:()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchItems()},error:n=>{this.snackBar.dismiss(),confirm(`${n.error.ExceptionMessage}\n\nDo you want to force delete '${e._Title}' (${e._RepositoryId})?`)&&(this.snackBar.open("Deleting..."),this.entitiesService.delete(this.contentTypeStaticName,e._RepositoryId,!0).subscribe(()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchItems()}))}}))}valueGetterStatus(e){const n=e.data;return{published:n.IsPublished,metadata:!!n.For,hasMetadata:!!n.Metadata&&n.Metadata.length>0}}valueGetterUsage(e){const n=e.data;return`${n._Used} / ${n._Uses}`}valueGetterEntityField(e){const n=e.data[e.colDef.field];return 0===n.length?null:n.map(a=>a.Title)}valueGetterDateTime(e){const n=e.data[e.colDef.field];return n?e.colDef.useTimePicker?n.replace("T"," ").replace("Z",""):n.split("T")[0]:null}valueGetterBoolean(e){const n=e.data[e.colDef.field];return"boolean"!=typeof n?null:n.toString()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(L.so),t.Y36(v.s),t.Y36(p.F0),t.Y36(p.gz),t.Y36(X.l),t.Y36(ie.g),t.Y36(d.i),t.Y36(ae.ux),t.Y36(h.bE),t.Y36(L.uw),t.Y36(t.s_b),t.Y36(t.sBO))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-content-items"]],decls:42,vars:15,consts:[["appToggleDebug","",1,"nav-component-wrapper"],["mat-dialog-title",""],[1,"dialog-title-box"],[4,"ngIf"],["mat-icon-button","","tippy","Close dialog",3,"click"],[3,"innerHTML",4,"ngIf"],[1,"grid-wrapper"],["appDragAndDrop","",1,"ag-theme-material",3,"rowData","modules","gridOptions","allowedFileTypes","gridReady","filesDropped"],[1,"grid-more-actions-box"],["mat-button","","tippy","Export xml list",3,"click"],["mat-button","","tippy","Import xml list",3,"click"],["mat-button","","tippy","Import single json item",3,"click"],["mat-button","","tippy","Create metadata",3,"click"],["mat-button","","color","accent","tippy","Print filter to console",3,"click",4,"ngIf"],["mat-fab","","mat-elevation-z24","","tippy","Add item",1,"grid-fab",3,"click"],[3,"innerHTML"],["mat-button","","color","accent","tippy","Print filter to console",3,"click"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div"),t.YNc(4,ce,2,1,"ng-container",3),t.ALo(5,"async"),t._uU(6," Data "),t.qZA(),t.TgZ(7,"button",4),t.NdJ("click",function(){return n.closeDialog()}),t.TgZ(8,"mat-icon"),t._uU(9,"close"),t.qZA()()()(),t._UZ(10,"router-outlet"),t.YNc(11,de,2,3,"div",5),t.ALo(12,"async"),t.TgZ(13,"div",6)(14,"ag-grid-angular",7),t.NdJ("gridReady",function(r){return n.onGridReady(r)})("filesDropped",function(r){return n.filesDropped(r)}),t.ALo(15,"async"),t.qZA(),t.TgZ(16,"div",8)(17,"button",9),t.NdJ("click",function(){return n.exportContent()}),t.TgZ(18,"mat-icon"),t._uU(19,"cloud_download"),t.qZA(),t.TgZ(20,"span"),t._uU(21,"Data"),t.qZA()(),t.TgZ(22,"button",10),t.NdJ("click",function(){return n.importContent()}),t.TgZ(23,"mat-icon"),t._uU(24,"cloud_upload"),t.qZA(),t.TgZ(25,"span"),t._uU(26,"Data"),t.qZA()(),t.TgZ(27,"button",11),t.NdJ("click",function(){return n.importItem()}),t.TgZ(28,"mat-icon"),t._uU(29,"cloud_upload"),t.qZA(),t.TgZ(30,"span"),t._uU(31,"Item"),t.qZA()(),t.TgZ(32,"button",12),t.NdJ("click",function(){return n.createMetadata()}),t.TgZ(33,"mat-icon"),t._uU(34,"local_offer"),t.qZA(),t.TgZ(35,"span"),t._uU(36,"Create Metadata"),t.qZA()(),t.YNc(37,ue,5,0,"button",13),t.ALo(38,"async"),t.qZA(),t.TgZ(39,"button",14),t.NdJ("click",function(){return n.editItem(null)}),t.TgZ(40,"mat-icon"),t._uU(41,"add"),t.qZA()()()()),2&e){let a;t.xp6(4),t.Q6J("ngIf",t.lcZ(5,7,n.contentType$)),t.xp6(7),t.Q6J("ngIf",null==(a=t.lcZ(12,9,n.contentType$))||null==a.Properties?null:a.Properties.ListInstructions),t.xp6(3),t.Q6J("rowData",t.lcZ(15,11,n.items$))("modules",n.modules)("gridOptions",n.gridOptions)("allowedFileTypes","xml,json"),t.xp6(23),t.Q6J("ngIf",t.lcZ(38,13,n.debugEnabled$))}},directives:[re.D,L.uh,S.O5,q.lW,R.$,w.Hw,p.lC,se.N8,le.z],pipes:[S.Ov,pe.z],styles:[""]}),o})()},8854:(Z,x,i)=>{i.d(x,{H:()=>_,a:()=>u});var l=i(8598),p=i(3184),c=i(8784),y=i(2425);const _="admin/app/";let u=(()=>{class g{constructor(m,h,v){this.http=m,this.context=h,this.dnnContext=v}importApp(m,h){const v=new FormData;return v.append("File",m),v.append("Name",h||""),this.http.post(this.dnnContext.$2sxc.http.apiUrl(_+"Import"),v,{params:{zoneId:this.context.zoneId.toString()}})}}return g.\u0275fac=function(m){return new(m||g)(p.LFG(c.eN),p.LFG(l._),p.LFG(y._y))},g.\u0275prov=p.Yz7({token:g,factory:g.\u0275fac}),g})()},3135:(Z,x,i)=>{i.d(x,{Y:()=>v});var l=i(3184),p=i(6362),c=i(4770);function y(d,M){1&d&&l.GkF(0)}function _(d,M){if(1&d&&(l.TgZ(0,"mat-hint"),l.YNc(1,y,1,0,"ng-container",3),l.qZA()),2&d){l.oxw();const E=l.MAs(4);l.xp6(1),l.Q6J("ngTemplateOutlet",E)}}function u(d,M){1&d&&l.GkF(0)}function g(d,M){if(1&d&&(l.TgZ(0,"mat-error"),l.YNc(1,u,1,0,"ng-container",3),l.qZA()),2&d){l.oxw();const E=l.MAs(4);l.xp6(1),l.Q6J("ngTemplateOutlet",E)}}function D(d,M){1&d&&l.Hsn(0)}const m=function(d){return{"hint-box__short":d}},h=["*"];let v=(()=>{class d{constructor(){this.isError=!1,this.isShort=!0}toggleIsShort(){this.isShort=!this.isShort}}return d.\u0275fac=function(E){return new(E||d)},d.\u0275cmp=l.Xpm({type:d,selectors:[["app-field-hint"]],inputs:{isError:"isError"},ngContentSelectors:h,decls:5,vars:6,consts:[[1,"hint-box",3,"ngClass","ngSwitch","click"],[4,"ngSwitchCase"],["content",""],[4,"ngTemplateOutlet"]],template:function(E,P){1&E&&(l.F$t(),l.TgZ(0,"div",0),l.NdJ("click",function(){return P.toggleIsShort()}),l.YNc(1,_,2,1,"mat-hint",1),l.YNc(2,g,2,1,"mat-error",1),l.qZA(),l.YNc(3,D,1,0,"ng-template",null,2,l.W1O)),2&E&&(l.Q6J("ngClass",l.VKq(4,m,P.isShort))("ngSwitch",P.isError),l.xp6(1),l.Q6J("ngSwitchCase",!1),l.xp6(1),l.Q6J("ngSwitchCase",!0))},directives:[p.mk,p.RF,p.n9,c.bx,p.tP,c.TO],styles:[".hint-box[_ngcontent-%COMP%]{margin-top:4px}.hint-box[_ngcontent-%COMP%]   .mat-hint[_ngcontent-%COMP%], .hint-box[_ngcontent-%COMP%]   .mat-error[_ngcontent-%COMP%]{font-size:12px;display:block}.hint-box__short[_ngcontent-%COMP%]   .mat-hint[_ngcontent-%COMP%], .hint-box__short[_ngcontent-%COMP%]   .mat-error[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]}),d})()},5578:(Z,x,i)=>{i.d(x,{m:()=>m});var l=i(5388),p=i(3184),c=i(2528),y=i(1130),_=i(785),u=i(6362),g=i(5590);const D=function(h,v){return{"align-start":h,"align-end":v}};let m=(()=>{class h{constructor(d){this.snackBar=d}agInit(d){this.id=d.value,this.align="number"==typeof this.id?"end":"start",this.tooltip=d.tooltipGetter(d.data)}refresh(d){return!0}copy(){(0,l.v)(this.tooltip),this.snackBar.open("Copied to clipboard",null,{duration:2e3})}}return h.\u0275fac=function(d){return new(d||h)(p.Y36(c.ux))},h.\u0275cmp=p.Xpm({type:h,selectors:[["app-id-field"]],decls:5,vars:6,consts:[["matRipple","",1,"id-box","highlight",3,"tippy","ngClass","click"],[1,"id"],[1,"icon"]],template:function(d,M){1&d&&(p.TgZ(0,"div",0),p.NdJ("click",function(){return M.copy()}),p.TgZ(1,"span",1),p._uU(2),p.qZA(),p.TgZ(3,"mat-icon",2),p._uU(4,"file_copy"),p.qZA()()),2&d&&(p.Q6J("tippy",M.tooltip)("ngClass",p.WLB(3,D,"start"===M.align,"end"===M.align)),p.xp6(2),p.Oqu(M.id))},directives:[y.wG,_.$,u.mk,g.Hw],styles:[".id-box[_ngcontent-%COMP%]{padding:0 8px;height:100%;display:flex;align-items:center}.id-box.align-start[_ngcontent-%COMP%]{justify-content:flex-start}.id-box.align-end[_ngcontent-%COMP%]{justify-content:flex-end}.id-box[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{max-width:100%;text-overflow:ellipsis;overflow:hidden}.id-box[_ngcontent-%COMP%]:hover{text-decoration:none}.id-box[_ngcontent-%COMP%]:hover   .id[_ngcontent-%COMP%]{display:none}.id-box[_ngcontent-%COMP%]:not(:hover)   .icon[_ngcontent-%COMP%]{display:none}"]}),h})()},8398:(Z,x,i)=>{function l(){return/^[a-f0-9]{8}(?:-[a-f0-9]{4}){3}-[a-f0-9]{12}$/i}i.d(x,{M:()=>l})},491:(Z,x,i)=>{i.d(x,{E:()=>p});var l=i(3184);let p=(()=>{class c{onClick(_){_.stopPropagation()}}return c.\u0275fac=function(_){return new(_||c)},c.\u0275dir=l.lG2({type:c,selectors:[["","appClickStopPropagation",""]],hostBindings:function(_,u){1&_&&l.NdJ("click",function(D){return u.onClick(D)})}}),c})()},5469:(Z,x,i)=>{i.d(x,{D:()=>c});var l=i(5266),p=i(3184);let c=(()=>{class y{constructor(u){this.globalConfigService=u}onClick(u){(navigator.platform.match("Mac")?u.metaKey:u.ctrlKey)&&u.shiftKey&&u.altKey&&(this.globalConfigService.toggleDebugEnabled(),window.getSelection().removeAllRanges())}}return y.\u0275fac=function(u){return new(u||y)(p.Y36(l.bE))},y.\u0275dir=p.lG2({type:y,selectors:[["","appToggleDebug",""]],hostBindings:function(u,g){1&u&&p.NdJ("click",function(m){return g.onClick(m)})}}),y})()},5388:(Z,x,i)=>{function l(p){const c=document.createElement("textarea");c.value=p,c.setAttribute("readonly",""),c.style.position="absolute",c.style.left="-9999px",document.body.appendChild(c);const y=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);c.select(),document.execCommand("copy"),document.body.removeChild(c),y&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(y))}i.d(x,{v:()=>l})},845:(Z,x,i)=>{i.d(x,{z:()=>c});var l=i(3184),p=i(318);let c=(()=>{class y{constructor(u){this.sanitizer=u}transform(u){return this.sanitizer.bypassSecurityTrustHtml(u)}}return y.\u0275fac=function(u){return new(u||y)(l.Y36(p.H7,16))},y.\u0275pipe=l.Yjl({name:"safeHtml",type:y,pure:!0}),y})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/13.06.00/ng-edit/projects_ng-dialogs_src_app_content-items_content-items_component_ts.6624767e54688765.js.map