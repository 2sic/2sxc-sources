"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_content-items_content-items_component_ts"],{336:(x,T,i)=>{i.d(T,{F:()=>j});var d=i(46443),M=i(14600),u=i(36647),l=i(70271),f=i(78742),g=i(70693),h=i(34435),y=i(9234),P=i(24467),_=i(99293),E=i(44444);const I={getAll:!0,getAllLive:!0,getAllOnce:!0};let j=(()=>{class D extends P.B{constructor(){super(...arguments),this.log=(0,h.Tq)({ContentItemsService:D},I)}getAllPromise(p){return this.log.fnIf("getAll",{contentTypeStaticName:p}),this.fetchPromise(y.Gg,{params:{appId:this.appId,contentType:p}})}getAllOnce(p){return this.log.fnIf("getAllOnce",{contentTypeStaticName:p}),(0,d.fx)(()=>({url:this.apiUrl(y.Gg),params:{appId:this.appId,contentType:p}}))}getAllLive(p,F){return this.log.fnIf("getAllLive",{contentTypeStaticName:p,refresh:F}),(0,d.fx)(()=>(F(),{url:this.apiUrl(y.Gg),params:{appId:this.appId,contentType:p}}))}getColumnsPromise(p){return this.fetchPromise(f.z,{params:{appId:this.appId,staticName:p}})}importItem(p){return(0,M.H)((0,g.n)(p)).pipe((0,u.n)(F=>this.http.post(this.apiUrl(y.gb+"upload"),{AppId:this.appId,ContentBase64:F})),(0,l.T)(F=>({Success:F,Messages:[]})))}static#t=this.\u0275fac=(()=>{let p;return function(k){return(p||(p=_.xGo(D)))(k||D)}})();static#n=this.\u0275prov=E.jDH({token:D,factory:D.\u0275fac})}return D})()},5858:(x,T,i)=>{i.d(T,{O:()=>d});const d="DROPDOWN_INSERT_VALUE"},21183:(x,T,i)=>{i.d(T,{f:()=>d});class d{static cellLink(u,l,f){return`<a class="default-link fill-cell ${f}" href="${u}">${l}</a>`}}},39333:(x,T,i)=>{i.d(T,{c:()=>u});var d=i(34435),M=i(99293);let u=(()=>{class l{constructor(){this.log=(0,d.Tq)({ClickStopPropagationDirective:l}),this.log.a("constructor")}onClick(g){this.log.a("onClick",{event:g}),g.stopPropagation()}static#t=this.\u0275fac=function(h){return new(h||l)};static#n=this.\u0275dir=M.FsC({type:l,selectors:[["","appClickStopPropagation",""]],hostBindings:function(h,y){1&h&&M.bIt("click",function(_){return y.onClick(_)})}})}return l})()},43758:(x,T,i)=>{i.d(T,{F:()=>D});var d=i(87945),M=i(37580),u=i(31016),l=i(99293),f=i(44444),g=i(87698);const h=["*"],y=v=>({"hint-box__short":v});function P(v,p){1&v&&l.eu8(0)}function _(v,p){if(1&v&&(l.j41(0,"mat-hint"),l.DNE(1,P,1,0,"ng-container",2),l.k0s()),2&v){l.XpG();const F=l.sdS(4);l.R7$(),l.Y8G("ngTemplateOutlet",F)}}function E(v,p){1&v&&l.eu8(0)}function I(v,p){if(1&v&&(l.j41(0,"mat-error"),l.DNE(1,E,1,0,"ng-container",2),l.k0s()),2&v){l.XpG();const F=l.sdS(4);l.R7$(),l.Y8G("ngTemplateOutlet",F)}}function j(v,p){1&v&&l.SdG(0)}let D=(()=>{class v{constructor(){this.isError=(0,M.hFB)(!1),this.isShort=!0}toggleIsShort(){this.isShort=!this.isShort}static#t=this.\u0275fac=function(k){return new(k||v)};static#n=this.\u0275cmp=l.VBU({type:v,selectors:[["app-field-hint"]],inputs:{isError:[1,"isError"]},ngContentSelectors:h,decls:5,vars:4,consts:[["content",""],[1,"hint-box",3,"click","ngClass"],[4,"ngTemplateOutlet"]],template:function(k,O){if(1&k){const t=l.RV6();l.NAR(),l.j41(0,"div",1),l.bIt("click",function(){return f.eBV(t),f.Njj(O.toggleIsShort())}),l.nVh(1,_,2,1,"mat-hint")(2,I,2,1,"mat-error"),l.k0s(),l.DNE(3,j,1,0,"ng-template",null,0,l.C5r)}if(2&k){let t;l.Y8G("ngClass",l.eq3(2,y,O.isShort)),l.R7$(),l.vxM(!1===(t=O.isError())?1:!0===t?2:-1)}},dependencies:[u.M,g.c,g.b,d.YU,d.T3],styles:[".hint-box[_ngcontent-%COMP%]{margin-top:4px}.hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{font-size:12px;display:block}.hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]})}return v})()},77730:(x,T,i)=>{i.r(T),i.d(T,{ContentItemsComponent:()=>je});var d=i(44444),M=i(64173),u=i(84175),l=i(81863),f=i(93840),g=i(29658),h=i(12938),y=i(17693),P=i(6663),_=i(56360),E=i(93454),I=i(21183),j=i(11828),D=i(68163),v=i(91960),p=i(34456),F=i(53804),k=i(31016),O=i(59791),t=i(99293),G=i(87698);const it=["valueInput"];let W=(()=>{class a{constructor(){this.filter="",this.idFilterString="",this.idFilter=[]}agInit(e){this.filterParams=e}isFilterActive(){return""!==this.filter||this.idFilter.length>0}doesFilterPass(e){if(""!==this.filter){const o=this.filterParams.valueGetter({api:this.filterParams.api,colDef:this.filterParams.colDef,column:this.filterParams.column,columnApi:this.filterParams.columnApi,context:this.filterParams.context,data:e.node.data,getValue:s=>e.node.data[s],node:e.node});if(null==o||!o.some(s=>!!s&&s.includes(this.filter)))return!1}if(this.idFilter.length>0){const n=e.data[this.filterParams.colDef.headerName];if(null==n||!this.idFilter.some(o=>n.some(s=>s.Id===o)))return!1}return!0}getModel(){return this.isFilterActive()?{filterType:"entity",filter:this.filter,idFilter:this.idFilter}:void 0}setModel(e){this.filter=e?.filter??"",this.idFilter=e?.idFilter??[],this.idFilterString=e?.idFilter?.join(",")??""}afterGuiAttached(e){this.valueInputRef.nativeElement.focus()}updateIdFilter(){this.idFilter=this.idFilterString.split(",").map(e=>parseInt(e,10)).filter(e=>!isNaN(e))}filterChanged(){this.filterParams.filterChangedCallback()}static#t=this.\u0275fac=function(n){return new(n||a)};static#n=this.\u0275cmp=t.VBU({type:a,selectors:[["app-entity-filter"]],viewQuery:function(n,o){if(1&n&&t.GBs(it,5),2&n){let s;t.mGM(s=t.lsd())&&(o.valueInputRef=s.first)}},decls:9,vars:2,consts:[["valueInput",""],["color","accent",1,"eav-mat-form-field"],["matInput","","type","text",3,"ngModelChange","ngModel"]],template:function(n,o){if(1&n){const s=t.RV6();t.j41(0,"mat-form-field",1)(1,"mat-label"),t.EFF(2,"Value"),t.k0s(),t.j41(3,"input",2,0),t.mxI("ngModelChange",function(c){return d.eBV(s),t.DH7(o.filter,c)||(o.filter=c),d.Njj(c)}),t.bIt("ngModelChange",function(){return d.eBV(s),d.Njj(o.filterChanged())}),t.k0s()(),t.j41(5,"mat-form-field",1)(6,"mat-label"),t.EFF(7,"IDs (comma separated)"),t.k0s(),t.j41(8,"input",2),t.mxI("ngModelChange",function(c){return d.eBV(s),t.DH7(o.idFilterString,c)||(o.idFilterString=c),d.Njj(c)}),t.bIt("ngModelChange",function(){return d.eBV(s),o.updateIdFilter(),d.Njj(o.filterChanged())}),t.k0s()()}2&n&&(t.R7$(3),t.R50("ngModel",o.filter),t.R7$(5),t.R50("ngModel",o.idFilterString))},dependencies:[p.YN,p.me,p.BC,p.vS,F.Wk,k.M,G.j,G.M,O.fS,O.fg],styles:["[_nghost-%COMP%]{display:block;padding:16px 12px 2px}.mat-mdc-form-field[_ngcontent-%COMP%]{display:block;width:175px}"]})}return a})();var st=i(60251),lt=i(38172),rt=i(34575),V=i(34601),dt=i(95699),Y=i(1726),S=i(43216),ct=i(34435),$=i(70334),pt=i(67037),mt=i(69914),ut=i(60852),ht=i(96817),gt=i(39431),ft=i(67993),w=i(89061),A=i(31034),z=i(29968);function _t(a,r){if(1&a){const e=t.RV6();t.j41(0,"button",7),t.bIt("click",function(){d.eBV(e);const o=t.XpG();return d.Njj(o.do("delete"))}),t.j41(1,"mat-icon"),t.EFF(2,"delete"),t.k0s(),t.j41(3,"span"),t.EFF(4,"Delete"),t.k0s()()}if(2&a){const e=t.XpG();t.Y8G("disabled",e.item._EditInfo.DisableDelete)}}let Ct=(()=>{class a{agInit(e){this.params=e,this.item=e.data}refresh(e){return!0}do(e){this.params.do(e,this.item)}static#t=this.\u0275fac=function(n){return new(n||a)};static#n=this.\u0275cmp=t.VBU({type:a,selectors:[["app-data-bundle-actions"]],decls:13,vars:2,consts:[["menu","matMenu"],[1,"actions-component"],["matRipple","","tippy","Clone",1,"eav-grid-action-button","default-link","highlight",3,"href"],["matRipple","","tippy","Export",1,"eav-grid-action-button","highlight",3,"click"],["matRipple","","tippy","More",1,"eav-grid-action-button","highlight",3,"matMenuTriggerFor"],[1,"grid-more-menu"],["matMenuContent",""],["mat-menu-item","",3,"click","disabled"]],template:function(n,o){if(1&n){const s=t.RV6();t.j41(0,"div",1)(1,"a",2)(2,"mat-icon"),t.EFF(3,"file_copy"),t.k0s()(),t.j41(4,"div",3),t.bIt("click",function(){return d.eBV(s),d.Njj(o.do("export"))}),t.j41(5,"mat-icon"),t.EFF(6,"cloud_download"),t.k0s()(),t.j41(7,"div",4)(8,"mat-icon"),t.EFF(9,"more_horiz"),t.k0s()()(),t.j41(10,"mat-menu",5,0),t.DNE(12,_t,5,1,"ng-template",6),t.k0s()}if(2&n){const s=t.sdS(11);t.R7$(),t.Y8G("href",o.params.urlTo("clone",o.item),t.B4B),t.R7$(6),t.Y8G("matMenuTriggerFor",s)}},dependencies:[w.M,z.M,f.m_,f.An,A.Cn,A.kk,A.fb,A.z8,A.Cp,V.e],encapsulation:2})}return a})();function yt(a,r){if(1&a&&(t.j41(0,"span",1),t.EFF(1),t.k0s()),2&a){const e=t.XpG();t.R7$(),t.JRh(e.entities)}}let vt=(()=>{class a{agInit(e){Array.isArray(e.value)&&(this.encodedValue=this.htmlEncode(e.value.join(", ")),e.colDef.allowMultiValue&&(this.entities=e.value.length))}refresh(e){return!0}htmlEncode(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}static#t=this.\u0275fac=function(n){return new(n||a)};static#n=this.\u0275cmp=t.VBU({type:a,selectors:[["app-content-items-entity"]],decls:3,vars:3,consts:[[3,"tippy"],[1,"more-entities"]],template:function(n,o){1&n&&(t.j41(0,"div",0),t.nVh(1,yt,2,1,"span",1),t.EFF(2),t.k0s()),2&n&&(t.Y8G("tippy",o.encodedValue),t.R7$(),t.vxM(o.entities?1:-1),t.R7$(),t.SpI(" ",o.encodedValue,"\n"))},dependencies:[V.e],styles:[".more-entities[_ngcontent-%COMP%]{padding:0 8px;border-radius:10px;border:1px solid rgba(29,39,61,.44);-webkit-user-select:none;user-select:none}"]})}return a})();var N=i(87945),Z=i(16256);const Tt=a=>({"hide-until-row-hover":a});function Ft(a,r){if(1&a&&(t.j41(0,"a",2)(1,"mat-icon",4),t.EFF(2),t.k0s()()),2&a){const e=t.XpG();t.Y8G("tippy",e.metadataTooltip)("href",e.params.urlTo("openMetadata",e.item),t.B4B)("ngClass",t.eq3(6,Tt,!e.metadataCount&&!e.value.metadata)),t.R7$(),t.Y8G("matBadge",e.metadataCount)("matBadgeHidden",!e.metadataCount),t.R7$(),t.SpI("",e.value.metadata?"loyalty":"local_offer"," ")}}function Mt(a,r){if(1&a&&(t.j41(0,"div",3)(1,"mat-icon",5),t.EFF(2),t.k0s()()),2&a){const e=t.XpG();t.R7$(),t.Y8G("matBadge",e.metadataCount)("matBadgeHidden",!e.metadataCount),t.R7$(),t.SpI("",e.value.metadata?"loyalty":"local_offer"," ")}}let bt=(()=>{class a{agInit(e){this.params=e,this.value=e.value,this.item=e.data,this.disableMetadata=this.item._EditInfo.DisableMetadata,this.metadataCount=this.item.Metadata?.length??0;const n=this.item.For;this.metadataTooltip=n?`This item is metadata for:\nTarget: ${n.Target}\nTargetType: ${n.TargetType}`+(n.KeyNumber?`\nNumber: ${n.KeyNumber}`:"")+(n.KeyString?`\nString: ${n.KeyString}`:"")+(n.KeyGuid?`\nGuid: ${n.KeyGuid}`:"")+(n.Title?`\nTitle: ${n.Title}`:""):"This item is not metadata.",this.metadataTooltip+=`\n\nThis item has ${this.metadataCount>0?this.metadataCount:"no"} other metadata ${1===this.metadataCount?"item":"items"} attached to it.`}refresh(e){return!0}static#t=this.\u0275fac=function(n){return new(n||a)};static#n=this.\u0275cmp=t.VBU({type:a,selectors:[["app-content-items-status"]],decls:6,vars:3,consts:[[1,"actions-component"],[1,"eav-grid-action-button","icon",3,"tippy"],["matRipple","",1,"eav-grid-action-button","default-link","highlight",3,"tippy","href","ngClass"],[1,"eav-grid-action-button","disabled"],["matBadgeColor","accent","matBadgeSize","small","matBadgePosition","below after","aria-hidden","false",3,"matBadge","matBadgeHidden"],["matBadgeColor","accent","matBadgeSize","small","matBadgeDisabled","true","matBadgePosition","below after","aria-hidden","false",3,"matBadge","matBadgeHidden"]],template:function(n,o){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"mat-icon"),t.EFF(3),t.k0s()(),t.nVh(4,Ft,3,8,"a",2)(5,Mt,3,3,"div",3),t.k0s()),2&n&&(t.R7$(),t.Y8G("tippy",o.value.published?"Published":"Not published"),t.R7$(2),t.JRh(o.value.published?"visibility":"visibility_off"),t.R7$(),t.vxM(o.disableMetadata?o.disableMetadata&&(o.metadataCount||o.value.metadata)?5:-1:4))},dependencies:[f.m_,f.An,w.M,z.M,N.YU,Z.Y,Z.k,V.e],styles:[".hide-until-row-hover[_ngcontent-%COMP%]{visibility:hidden}  .ag-row-hover .hide-until-row-hover{visibility:visible}"]})}return a})();var Et=i(4038),Dt=i(31403),J=i(64043),Q=i(8827),B=i(75797),L=i(63037),X=i(91817),kt=i(63617),q=i(70271),U=i(19999),Rt=i(75445),xt=i(32760),tt=i(88857),Pt=i(43176),jt=i(43758),et=i(5858),b=i(50052),Ot=i(39333),$t=i(99277),Gt=i(48021),Bt=i(93826),Vt=i(68873),nt=i(336),St=i(49417);function At(a){return r=>{if(!r.value)return null;const e=a.controls.keyType.value,n=r.value.toString();switch(e){case b.YX.keyTypes.number:return/^[0-9]+$/.test(n)?null:{patternWholeNumber:!0};case b.YX.keyTypes.guid:const s=["{","}"].some(C=>n.includes(C)),m=n.substring(s?1:0,s?n.length-1:n.length);return(0,St.L)().test(m)?null:{patternGuid:!0};default:return null}}}var Yt=i(23731),at=i(88622);const ot=a=>({active:a});function Nt(a,r){if(1&a&&(t.j41(0,"mat-option",13),t.EFF(1),t.k0s()),2&a){const e=r.$implicit;t.Y8G("value",e.targetType),t.R7$(),t.SpI(" ",e.label," ")}}function Xt(a,r){if(1&a&&(t.j41(0,"mat-option",13),t.EFF(1),t.k0s()),2&a){const e=t.XpG(2);t.Y8G("value",e.formValues.targetType),t.R7$(),t.SpI(" ",e.formValues.targetType," ")}}function Ut(a,r){if(1&a&&(t.j41(0,"mat-select",9),t.Z7z(1,Nt,2,2,"mat-option",13,t.fX1),t.nVh(3,Xt,2,2,"mat-option",13),t.k0s()),2&a){const e=t.XpG(),n=t.XpG();t.R7$(),t.Dyx(n.targetTypeOptions),t.R7$(2),t.vxM(e.unknownTargetType?3:-1)}}function Kt(a,r){1&a&&t.nrm(0,"input",10)}function Lt(a,r){1&a&&(t.j41(0,"app-field-hint",11),t.EFF(1," Warning: you entered an unknown target type. This may work or may not. Please be sure you know what you're doing "),t.k0s()),2&a&&t.Y8G("isError",!1)}function Ht(a,r){if(1&a&&(t.j41(0,"app-field-hint",11),t.EFF(1),t.k0s()),2&a){const e=t.XpG();t.Y8G("isError",!1),t.R7$(),t.JRh(e.targetTypeHint)}}function Wt(a,r){1&a&&(t.j41(0,"app-field-hint",11),t.EFF(1," This field is required "),t.k0s()),2&a&&t.Y8G("isError",!0)}function wt(a,r){1&a&&(t.j41(0,"app-field-hint",11),t.EFF(1," Must be a whole number "),t.k0s()),2&a&&t.Y8G("isError",!0)}function zt(a,r){if(1&a&&(t.j41(0,"mat-option",13),t.EFF(1),t.k0s()),2&a){const e=r.$implicit;t.Y8G("value",e),t.R7$(),t.SpI(" ",e," ")}}function Zt(a,r){1&a&&(t.j41(0,"app-field-hint",11),t.EFF(1," This field is required "),t.k0s()),2&a&&t.Y8G("isError",!0)}function Jt(a,r){if(1&a&&(t.j41(0,"mat-option",13),t.EFF(1),t.k0s()),2&a){const e=r.$implicit;t.Y8G("value",e.NameId),t.R7$(),t.SpI(" ",e.Label," ")}}function Qt(a,r){if(1&a&&(t.j41(0,"mat-form-field",8)(1,"mat-label"),t.EFF(2,"Content Type"),t.k0s(),t.j41(3,"mat-select",19),t.Z7z(4,Jt,2,2,"mat-option",13,t.fX1),t.k0s()()),2&a){const e=t.XpG();t.R7$(3),t.Y8G("placeholder",e.contentTypes.length?"":"No items found"),t.R7$(),t.Dyx(e.contentTypes)}}function qt(a,r){if(1&a&&(t.j41(0,"mat-option",13),t.EFF(1),t.k0s()),2&a){const e=r.$implicit;t.Y8G("value",e.value),t.R7$(),t.SpI(" ",e.name," ")}}function te(a,r){if(1&a&&(t.j41(0,"mat-form-field",8)(1,"mat-label"),t.EFF(2,"Scope"),t.k0s(),t.j41(3,"mat-select",20),t.Z7z(4,qt,2,2,"mat-option",13,t.fX1),t.j41(6,"mat-option",13),t.EFF(7,"Other..."),t.k0s()()()),2&a){const e=t.XpG(),n=t.XpG();t.R7$(3),t.Y8G("placeholder",e.scopeOptions.length?"":"No items found"),t.R7$(),t.Dyx(e.scopeOptions),t.R7$(2),t.Y8G("value",n.dropdownInsertValue)}}function ee(a,r){if(1&a&&(t.j41(0,"mat-option",13),t.EFF(1),t.k0s()),2&a){const e=r.$implicit;t.Y8G("value",e.Guid),t.R7$(),t.Lme(" ",e.Title," (",e.Id,") ")}}function ne(a,r){if(1&a&&(t.j41(0,"mat-select",21),t.Z7z(1,ee,2,3,"mat-option",13,t.fX1),t.k0s()),2&a){const e=t.XpG(3);t.Y8G("placeholder",e.contentItems.length?"":"No items found"),t.R7$(),t.Dyx(e.contentItems)}}function ae(a,r){1&a&&t.nrm(0,"input",22)}function oe(a,r){if(1&a&&t.nVh(0,ne,3,1,"mat-select",21)(1,ae,1,0,"input",22),2&a){const e=t.XpG(2);t.vxM(e.guidedKey?0:1)}}function ie(a,r){if(1&a&&(t.j41(0,"mat-option",13),t.EFF(1),t.k0s()),2&a){const e=r.$implicit;t.Y8G("value",e.NameId),t.R7$(),t.SpI(" ",e.Label," ")}}function se(a,r){if(1&a&&(t.j41(0,"mat-select",21),t.Z7z(1,ie,2,2,"mat-option",13,t.fX1),t.k0s()),2&a){const e=t.XpG(3);t.Y8G("placeholder",e.contentTypes.length?"":"No items found"),t.R7$(),t.Dyx(e.contentTypes)}}function le(a,r){1&a&&t.nrm(0,"input",22)}function re(a,r){if(1&a&&t.nVh(0,se,3,1,"mat-select",21)(1,le,1,0,"input",22),2&a){const e=t.XpG(2);t.vxM(e.guidedKey?0:1)}}function de(a,r){1&a&&t.eu8(0)}function ce(a,r){if(1&a&&t.DNE(0,de,1,0,"ng-container",23),2&a){t.XpG(2);const e=t.sdS(44);t.Y8G("ngTemplateOutlet",e)}}function pe(a,r){if(1&a&&t.nVh(0,oe,2,1)(1,re,2,1)(2,ce,1,1,"ng-container"),2&a){let e;const n=t.XpG(),o=t.XpG();t.vxM((e=n.formValues.targetType)===o.eavConstants.metadata.entity.targetType?0:e===o.eavConstants.metadata.contentType.targetType?1:2)}}function me(a,r){1&a&&t.nrm(0,"input",22)}function ue(a,r){1&a&&t.nrm(0,"input",24)}function he(a,r){if(1&a&&(t.nVh(0,me,1,0,"input",22),t.nVh(1,ue,1,0,"input",24)),2&a){const e=t.XpG(),n=t.XpG();t.vxM(e.formValues.keyType!==n.eavConstants.keyTypes.number?0:-1),t.R7$(),t.vxM(e.formValues.keyType===n.eavConstants.keyTypes.number?1:-1)}}function ge(a,r){1&a&&t.nrm(0,"input",22)}function fe(a,r){1&a&&t.nrm(0,"input",24)}function _e(a,r){if(1&a&&(t.nVh(0,ge,1,0,"input",22),t.nVh(1,fe,1,0,"input",24)),2&a){const e=t.XpG(),n=t.XpG();t.vxM(e.formValues.keyType!==n.eavConstants.keyTypes.number?0:-1),t.R7$(),t.vxM(e.formValues.keyType===n.eavConstants.keyTypes.number?1:-1)}}function Ce(a,r){if(1&a){const e=t.RV6();t.j41(0,"div",16)(1,"button",25),t.bIt("click",function(){d.eBV(e);const o=t.XpG(2);return d.Njj(o.toggleGuidedKey(!0))}),t.j41(2,"mat-icon",26),t.EFF(3,"search"),t.k0s()(),t.j41(4,"button",27),t.bIt("click",function(){d.eBV(e);const o=t.XpG(2);return d.Njj(o.toggleGuidedKey(!1))}),t.j41(5,"mat-icon",26),t.EFF(6,"text_fields"),t.k0s()()()}if(2&a){const e=t.XpG();t.R7$(),t.Y8G("ngClass",t.eq3(2,ot,e.guidedKey)),t.R7$(3),t.Y8G("ngClass",t.eq3(4,ot,!e.guidedKey))}}function ye(a,r){1&a&&(t.j41(0,"app-field-hint",11),t.EFF(1," This field is required "),t.k0s()),2&a&&t.Y8G("isError",!0)}function ve(a,r){1&a&&(t.j41(0,"app-field-hint",11),t.EFF(1," Must be a whole number "),t.k0s()),2&a&&t.Y8G("isError",!0)}function Te(a,r){1&a&&(t.j41(0,"app-field-hint",11),t.EFF(1," Must be a valid GUID "),t.k0s()),2&a&&t.Y8G("isError",!0)}function Fe(a,r){if(1&a){const e=t.RV6();t.j41(0,"div",1)(1,"div",2)(2,"div",3),t.EFF(3," Create Metadata "),t.k0s(),t.j41(4,"button",4),t.bIt("click",function(){d.eBV(e);const o=t.XpG();return d.Njj(o.closeDialog())}),t.j41(5,"mat-icon"),t.EFF(6,"close"),t.k0s()()(),t.j41(7,"div",5)(8,"p"),t.EFF(9," This is a special operation to add an item which is metadata for another item, see "),t.j41(10,"a",6),t.EFF(11,"docs"),t.k0s(),t.EFF(12,". "),t.k0s(),t.j41(13,"form",7)(14,"mat-form-field",8)(15,"mat-label"),t.EFF(16,"Target"),t.k0s(),t.nVh(17,Ut,4,1,"mat-select",9),t.nVh(18,Kt,1,0,"input",10),t.k0s(),t.nVh(19,Lt,2,1,"app-field-hint",11),t.nVh(20,Ht,2,2,"app-field-hint",11),t.nVh(21,Wt,2,1,"app-field-hint",11),t.nVh(22,wt,2,1,"app-field-hint",11),t.j41(23,"mat-form-field",8)(24,"mat-label"),t.EFF(25,"Key type"),t.k0s(),t.j41(26,"mat-select",12),t.Z7z(27,zt,2,2,"mat-option",13,t.fX1),t.k0s()(),t.nVh(29,Zt,2,1,"app-field-hint",11),t.j41(30,"mat-slide-toggle",14),t.bIt("change",function(o){d.eBV(e);const s=t.XpG();return d.Njj(s.toggleGuidedMode(o))}),t.EFF(31),t.k0s(),t.nVh(32,Qt,6,1,"mat-form-field",8),t.nVh(33,te,8,2,"mat-form-field",8),t.j41(34,"app-field-hint"),t.EFF(35," The scope should almost never be changed - "),t.j41(36,"a",15),t.EFF(37,"see help"),t.k0s()(),t.j41(38,"mat-form-field",8)(39,"mat-label"),t.EFF(40,"Key"),t.k0s(),t.nVh(41,pe,3,1)(42,he,2,2),t.DNE(43,_e,2,2,"ng-template",null,0,t.C5r),t.nVh(45,Ce,7,6,"div",16),t.k0s(),t.nVh(46,ye,2,1,"app-field-hint",11),t.nVh(47,ve,2,1,"app-field-hint",11),t.nVh(48,Te,2,1,"app-field-hint",11),t.k0s()(),t.j41(49,"mat-dialog-actions",17)(50,"app-save-close-button-fab",18),t.bIt("action",function(){d.eBV(e);const o=t.XpG();return d.Njj(o.saveAndClose())}),t.k0s()()()}if(2&a){const e=r,n=t.XpG();t.R7$(13),t.Y8G("formGroup",n.ngForm),t.R7$(4),t.vxM(e.guidedMode?17:-1),t.R7$(),t.vxM(e.guidedMode?-1:18),t.R7$(),t.vxM(n.ngForm.controls.targetType.touched&&!n.ngForm.controls.targetType.invalid&&e.unknownTargetType?19:-1),t.R7$(),t.vxM(e.targetTypeHint?20:-1),t.R7$(),t.vxM(n.ngForm.controls.targetType.touched&&null!=n.ngForm.controls.targetType.errors&&n.ngForm.controls.targetType.errors.required?21:-1),t.R7$(),t.vxM(n.ngForm.controls.targetType.touched&&null!=n.ngForm.controls.targetType.errors&&n.ngForm.controls.targetType.errors.pattern?22:-1),t.R7$(5),t.Dyx(e.keyTypeOptions),t.R7$(2),t.vxM(n.ngForm.controls.keyType.touched&&null!=n.ngForm.controls.keyType.errors&&n.ngForm.controls.keyType.errors.required?29:-1),t.R7$(),t.Y8G("tippy",e.guidedMode?"Guided mode helps you select options that work":"Manual mode is for advanced uses and allows you to insert any values")("checked",e.guidedMode),t.R7$(),t.SpI(" ",e.guidedMode?"Guided":"Manual"," "),t.R7$(),t.vxM(e.guidedMode&&e.formValues.targetType===n.eavConstants.metadata.entity.targetType?32:-1),t.R7$(),t.vxM(!e.guidedMode||e.formValues.targetType!==n.eavConstants.metadata.entity.targetType&&e.formValues.targetType!==n.eavConstants.metadata.contentType.targetType?-1:33),t.R7$(8),t.vxM(e.guidedMode?41:42),t.R7$(4),t.vxM(e.guidedMode&&e.guidedKeyExists?45:-1),t.R7$(),t.vxM(n.ngForm.controls.key.touched&&null!=n.ngForm.controls.key.errors&&n.ngForm.controls.key.errors.required?46:-1),t.R7$(),t.vxM(n.ngForm.controls.key.touched&&null!=n.ngForm.controls.key.errors&&n.ngForm.controls.key.errors.patternWholeNumber?47:-1),t.R7$(),t.vxM(n.ngForm.controls.key.touched&&null!=n.ngForm.controls.key.errors&&n.ngForm.controls.key.errors.patternGuid?48:-1),t.R7$(2),t.Y8G("ngClass",n.canSave()?"":"disabled")("disabled",!n.canSave())}}let Me=(()=>{class a extends Pt.${constructor(e,n){super(),this.dialog=e,this.context=n,this.hostClass="dialog-component",this.eavConstants=b.YX,this.dropdownInsertValue=et.O,this.formValid=(0,d.vPA)(!1),this.canSave=(0,M.EW)(()=>this.formValid()),this.contentItemsService=(0,h.d)(nt.F),this.contentTypesService=(0,h.d)(Rt.gs)}ngOnInit(){this.#t(),this.targetTypeOptions=Object.values(b.YX.metadata).map(n=>({...n})),this.keyTypeOptions=Object.values(b.YX.keyTypes),this.keyTypeOptions$=new B.t([]),this.scopeOptions$=new B.t([]),this.guidedMode$=new B.t(!0),this.contentItems$=new B.t([]),this.contentTypes$=new B.t([]),this.guidedKey$=new B.t(!0),this.fetchScopes(),this.ngForm=new p.J3({}),this.ngForm.addControl("targetType",new p.hs(b.YX.metadata.entity.targetType,[p.k0.required,p.k0.pattern(/^[0-9]+$/)])),this.ngForm.addControl("keyType",new p.hs(b.YX.metadata.entity.keyType,[p.k0.required])),this.ngForm.addControl("contentTypeForContentItems",new p.hs(null)),this.ngForm.addControl("scopeForContentTypes",new p.hs(b.YX.scopes.default.value)),this.ngForm.addControl("key",new p.hs(null,[p.k0.required,At(this.ngForm)])),this.subscriptions.add(this.ngForm.controls.scopeForContentTypes.valueChanges.pipe((0,L.Z)(this.ngForm.controls.scopeForContentTypes.value),(0,X.F)()).subscribe(n=>{null!=this.ngForm.controls.contentTypeForContentItems.value&&this.ngForm.controls.contentTypeForContentItems.patchValue(null),n===et.O?(n=prompt("This is an advanced feature to show content-types of another scope. Don't use this if you don't know what you're doing, as content-types of other scopes are usually hidden for a good reason.")||b.YX.scopes.default.value,this.scopeOptions$.value.some(o=>o.value===n)||this.scopeOptions$.next([{name:n,value:n},...this.scopeOptions$.value]),this.ngForm.controls.scopeForContentTypes.patchValue(n)):this.fetchContentTypes(n)})),this.subscriptions.add((0,kt.h)(this.ngForm.controls.targetType.valueChanges.pipe((0,X.F)()),this.ngForm.controls.keyType.valueChanges.pipe((0,X.F)())).subscribe(()=>{this.guidedKey$.next(!0),null!=this.ngForm.getRawValue().key&&this.ngForm.patchValue({key:null})})),this.subscriptions.add(this.ngForm.controls.contentTypeForContentItems.valueChanges.pipe((0,L.Z)(this.ngForm.controls.contentTypeForContentItems.value),(0,X.F)()).subscribe(n=>{const o=this.ngForm.getRawValue();o.targetType===b.YX.metadata.entity.targetType&&null!=o.key&&this.ngForm.patchValue({key:null}),this.contentItemsService.getAllPromise(n).then(s=>{this.contentItems$.next(s)})}));const e=this.ngForm.valueChanges.pipe((0,L.Z)(this.ngForm.getRawValue()),(0,q.T)(()=>this.ngForm.getRawValue()),(0,Gt.A)(n=>n));this.subscriptions.add((0,U.z)([e,this.guidedMode$]).subscribe(([n,o])=>{const s=this.targetTypeOptions.find(K=>K.targetType===n.targetType),m=o&&s?[s.keyType]:[...this.keyTypeOptions];Bt.a.arraysEqual(m,this.keyTypeOptions$.value)||this.keyTypeOptions$.next(m);const c={};this.keyTypeOptions$.value.includes(n.keyType)||(c.keyType=this.keyTypeOptions$.value[0]);const C=o&&n.targetType===b.YX.metadata.app.targetType;C&&n.key!==this.context.appId&&(c.key=this.context.appId),Object.keys(c).length&&this.ngForm.patchValue(c),tt.a.disable(this.ngForm.controls.keyType,o&&this.keyTypeOptions$.value.length<=1),tt.a.disable(this.ngForm.controls.key,C)})),this.viewModel$=(0,U.z)([(0,U.z)([this.guidedMode$,this.keyTypeOptions$,this.scopeOptions$,this.contentItems$,this.contentTypes$]),(0,U.z)([e,this.guidedKey$])]).pipe((0,q.T)(([[n,o,s,m,c],[C,R]])=>({guidedMode:n,unknownTargetType:!this.targetTypeOptions.some(H=>H.targetType===C.targetType),targetTypeHint:n&&this.targetTypeOptions.find(H=>H.targetType===C.targetType)?.hint,keyTypeOptions:o,scopeOptions:s,guidedKey:R,guidedKeyExists:[b.YX.metadata.entity.targetType,b.YX.metadata.contentType.targetType].includes(C.targetType),formValues:C,contentItems:m,contentTypes:c})))}ngAfterViewInit(){this.ngForm?.statusChanges.subscribe(()=>{this.formValid.set(this.ngForm?.valid??!1)})}ngOnDestroy(){this.guidedMode$.complete(),this.keyTypeOptions$.complete(),this.contentItems$.complete(),this.contentTypes$.complete(),this.guidedKey$.complete(),super.ngOnDestroy()}closeDialog(e){this.dialog.close(e)}toggleGuidedKey(e){this.guidedKey$.next(e)}toggleGuidedMode(e){this.guidedMode$.next(e.checked)}saveAndClose(){const e=this.ngForm.getRawValue(),n={target:this.targetTypeOptions.find(o=>o.targetType===e.targetType)?.target,targetType:e.targetType,keyType:e.keyType,key:e.keyType===b.YX.keyTypes.guid?e.key.replace(/{|}/g,""):e.key.toString()};this.closeDialog(n)}#t(){this.dialog.keydownEvents().subscribe(e=>{(0,xt.YU)(e)&&this.canSave()&&(e.preventDefault(),this.saveAndClose())})}fetchContentTypes(e){this.contentTypesService.retrieveContentTypesPromise(e).then(n=>{this.contentTypes$.next(n)})}fetchScopes(){this.contentTypesService.getScopesPromise().then(e=>{this.scopeOptions$.next(e)})}static#n=this.\u0275fac=function(n){return new(n||a)(t.rXU(l.k),t.rXU(Vt.o))};static#s=this.\u0275cmp=t.VBU({type:a,selectors:[["app-create-metadata-dialog"]],hostVars:1,hostBindings:function(n,o){2&n&&t.Avn("className",o.hostClass)},features:[t.Vt3],decls:2,vars:3,consts:[["defaultKeyInput",""],[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"eav-dialog-content"],["href","https://go.2sxc.org/metadata","target","_blank"],[3,"formGroup"],["color","accent",2,"width","100%","margin-bottom","8px"],["formControlName","targetType","required",""],["matInput","","type","number","min","0","formControlName","targetType","required",""],[3,"isError"],["formControlName","keyType","required",""],[3,"value"],["color","accent",3,"change","tippy","checked"],["href","https://2sxc.org/help?tag=scope","target","_blank","appClickStopPropagation",""],["matTextSuffix","",1,"eav-selection-suffix"],["align","end"],[3,"action","ngClass","disabled"],["formControlName","contentTypeForContentItems",3,"placeholder"],["formControlName","scopeForContentTypes",3,"placeholder"],["formControlName","key","required","",3,"placeholder"],["matInput","","type","text","formControlName","key","required",""],[4,"ngTemplateOutlet"],["matInput","","type","number","formControlName","key","required",""],["mat-icon-button","","type","button","tippy","Pick existing value",1,"eav-selection-suffix-button",3,"click","ngClass"],[1,"eav-icon"],["mat-icon-button","","type","button","tippy","Manual entry",1,"eav-selection-suffix-button",3,"click","ngClass"]],template:function(n,o){if(1&n&&(t.nVh(0,Fe,51,20,"div",1),t.nI1(1,"async")),2&n){let s;t.vxM((s=t.bMT(1,1,o.viewModel$))?0:-1,s)}},dependencies:[p.YN,p.qT,p.me,p.Q0,p.BC,p.cb,p.YS,p.VZ,p.X1,p.j4,p.JD,k.M,G.j,G.M,G.g,J.M,J.g,Yt.M,Dt.M,O.fS,O.fg,N.T3,u.Hl,at.M,N.YU,f.m_,f.An,l.M,Q.mV,Q.sG,N.Jj,jt.F,Ot.c,V.e,$t.i],styles:["mat-slide-toggle[_ngcontent-%COMP%]{margin:16px 0}"]})}return a})(),be=(()=>{class a{constructor(){this.published="",this.metadata="",this.hasMetadata=""}agInit(e){this.filterParams=e}isFilterActive(){return""!==this.published||""!==this.metadata||""!==this.hasMetadata}doesFilterPass(e){let n=!1,o=!1,s=!1;const c=this.filterParams.valueGetter({api:this.filterParams.api,colDef:this.filterParams.colDef,column:this.filterParams.column,columnApi:this.filterParams.columnApi,context:this.filterParams.context,data:e.node.data,getValue:C=>e.node.data[C],node:e.node});return n=""===this.published||null!=c.published&&c.published.toString()===this.published,o=""===this.metadata||null!=c.metadata&&c.metadata.toString()===this.metadata,s=""===this.hasMetadata||null!=c.hasMetadata&&c.hasMetadata.toString()===this.hasMetadata,n&&o&&s}getModel(){return this.isFilterActive()?{filterType:"pub-meta",published:this.published,metadata:this.metadata,hasMetadata:this.hasMetadata}:void 0}setModel(e){this.published=e?e.published:"",this.metadata=e?e.metadata:"",this.hasMetadata=e?e.hasMetadata:""}afterGuiAttached(e){}filterChanged(){this.filterParams.filterChangedCallback()}static#t=this.\u0275fac=function(n){return new(n||a)};static#n=this.\u0275cmp=t.VBU({type:a,selectors:[["app-pub-meta-filter"]],decls:27,vars:3,consts:[[1,"title"],[3,"ngModelChange","ngModel"],["value",""],["value","true"],["value","false"]],template:function(n,o){1&n&&(t.j41(0,"div",0),t.EFF(1,"Published"),t.k0s(),t.j41(2,"mat-radio-group",1),t.mxI("ngModelChange",function(m){return t.DH7(o.published,m)||(o.published=m),m}),t.bIt("ngModelChange",function(){return o.filterChanged()}),t.j41(3,"mat-radio-button",2),t.EFF(4,"All"),t.k0s(),t.j41(5,"mat-radio-button",3),t.EFF(6,"Published"),t.k0s(),t.j41(7,"mat-radio-button",4),t.EFF(8,"Not published"),t.k0s()(),t.j41(9,"div",0),t.EFF(10,"Is Metadata"),t.k0s(),t.j41(11,"mat-radio-group",1),t.mxI("ngModelChange",function(m){return t.DH7(o.metadata,m)||(o.metadata=m),m}),t.bIt("ngModelChange",function(){return o.filterChanged()}),t.j41(12,"mat-radio-button",2),t.EFF(13,"All"),t.k0s(),t.j41(14,"mat-radio-button",3),t.EFF(15,"Is metadata"),t.k0s(),t.j41(16,"mat-radio-button",4),t.EFF(17,"Is not metadata"),t.k0s()(),t.j41(18,"div",0),t.EFF(19,"Has Metadata"),t.k0s(),t.j41(20,"mat-radio-group",1),t.mxI("ngModelChange",function(m){return t.DH7(o.hasMetadata,m)||(o.hasMetadata=m),m}),t.bIt("ngModelChange",function(){return o.filterChanged()}),t.j41(21,"mat-radio-button",2),t.EFF(22,"All"),t.k0s(),t.j41(23,"mat-radio-button",3),t.EFF(24,"Has metadata"),t.k0s(),t.j41(25,"mat-radio-button",4),t.EFF(26,"Has no metadata"),t.k0s()()),2&n&&(t.R7$(2),t.R50("ngModel",o.published),t.R7$(9),t.R50("ngModel",o.metadata),t.R7$(9),t.R50("ngModel",o.hasMetadata))},dependencies:[F.Wk,F.VT,F._g,p.YN,p.BC,p.vS],styles:[".title[_ngcontent-%COMP%]{padding:12px 12px 0}.mat-mdc-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;overflow:hidden;padding:12px;width:160px;height:104px}"]})}return a})();var Ee=i(37580),Ie=i(3347),De=i(29841);function ke(a,r){1&a&&(t.nrm(0,"div",6),t.nI1(1,"safeHtml")),2&a&&t.Y8G("innerHTML",t.bMT(1,1,r),t.npT)}function Re(a,r){if(1&a){const e=t.RV6();t.j41(0,"ag-grid-angular",17),t.bIt("gridReady",function(o){d.eBV(e);const s=t.XpG();return d.Njj(s.onGridReady(o))})("filesDropped",function(o){d.eBV(e);const s=t.XpG();return d.Njj(s.filesDropped(o))}),t.k0s()}if(2&a){const e=t.XpG();t.Y8G("rowData",e.items())("gridOptions",e.gridOptions)("allowedFileTypes","xml,json")}}function xe(a,r){if(1&a){const e=t.RV6();t.j41(0,"button",18),t.bIt("click",function(){d.eBV(e);const o=t.XpG();return d.Njj(o.debugFilter())}),t.j41(1,"mat-icon",11),t.EFF(2,"filter_list"),t.k0s(),t.j41(3,"span"),t.EFF(4,"Filter"),t.k0s()()}}const Pe={all:!1,items:!0};let je=(()=>{class a{#t;#n;#s;#d;#a;constructor(e,n,o,s,m){this.dialog=e,this.snackBar=n,this.matDialog=o,this.viewContainerRef=s,this.changeDetectorRef=m,this.log=(0,ct.Tq)({ContentItemsComponent:a},Pe),this.isDebug=(0,d.WQX)(gt.B).isDebug,this.#t=(0,h.d)(ht.R),this.#n=(0,h.d)(_.D),this.#s=(0,h.d)(nt.F),this.#d=(0,h.d)(y.g),this.#a=(0,h.d)(ut.c),this.gridOptions={...st.C,onFilterChanged:c=>this.#l.update(C=>C+1)},this.#l=(0,d.vPA)(0),this.refresh=(0,d.vPA)(0),this.#r={empty:{description:"<p><b>This is where you manage data items</b></p>",hint:"<p>Click the (+) in the bottom right corner to create your first item (think: record / entity).</p>"},content:{description:"<p><b>Each row shows a data item</b> <br>They contain the data, similar to a database row.</p>",hint:"<p>Click on the title to edit. <br>You can also do much more - best hover over the row and icons to discover the possibilities. <br><br>You can also do data import/export (one or many), copy items, and do advanced stuff like assigning metadata.</p>"}},this.uxHelpText=(0,M.EW)(()=>0===this.items()?.length?this.#r.empty:this.#r.content),this.#o=(0,d.vPA)(null),this.#e=this.#a.getParam("contentTypeStaticName"),this.contentType=this.#d.getType(this.#e).value,this.#c=this.#s.getAllLive(this.#e,this.refresh).value,this.items=(0,M.EW)(()=>{const c=this.#c();return this.log.aIf("items",{data:c}),c}),this.urlToExportContent=(0,ft.bo)("urlToExportContent",()=>{const c=this.#o();if(!c)return"";this.#l();const C=Object.keys(c.getFilterModel()).length>0,R=[];return C&&c.forEachNodeAfterFilterAndSort(K=>R.push(K.data.Id)),this.#i(`export/${this.#e}${R.length>0?`/${R.join(",")}`:""}`)})}#l;#r;#o;#e;#c;ngOnInit(){this.urlToExportContent(),this.#a.doOnDialogClosed(()=>this.fetchItems())}closeDialog(){this.dialog.close()}onGridReady(e){this.#o.set(e.api),this.fetchColumns(),this.urlToExportContent()}fetchItems(){this.refresh.update(e=>++e)}fetchColumns(){this.#s.getColumnsPromise(this.#e).then(e=>{const n=e.filter(m=>!m.IsEphemeral),o=this.#h(n),s=function It(a,r){if(!a)return;let e;"="===a.charAt(a.length-1)&&(a=atob(a));try{e=JSON.parse(a)}catch{console.error("Can't parse JSON with filters from url:",a)}if(!e)return;const n={};return(e.IsPublished||e.IsMetadata)&&(n.Status={filterType:"pub-meta",published:e.IsPublished??"",metadata:e.IsMetadata??"",hasMetadata:""}),Object.entries(e).filter(([o,s])=>"IsPublished"!==o&&"IsMetadata"!==o).forEach(([o,s])=>{if(r.find(c=>c.headerName===o)?.filter!==W){if("string"==typeof s)n[o]={filterType:"text",type:"equals",filter:s};else if("number"==typeof s)n[o]={filterType:"number",type:"equals",filter:s,filterTo:null};else if("boolean"==typeof s){const c={filterType:"boolean",filter:s.toString()};n[o]=c}}else{const c={filterType:"entity",filter:"string"==typeof(s=Et.i.tryParse(s)??s)?s:void 0,idFilter:"number"==typeof s?[s]:Array.isArray(s)?s.filter(C=>"number"==typeof C):void 0};n[o]=c}}),n}(sessionStorage.getItem(lt.bo),o);this.#o()&&this.setColumnDefs(o,s)})}setColumnDefs(e,n){this.#o().setColumnDefs(e),n&&(this.log.a("Will try to apply filter:",n),this.#o().setFilterModel(n))}#i(e){return"#"+this.#a.urlSubRoute(e)}#m(e){return this.#a.urlSubRoute(E.H.getUrlEntity(e.Guid,`Metadata for Entity: ${e._Title} (${e.Id})`,this.#e))}editItem(e){const n={items:[null==e?$.c.newFromType(this.#e):$.c.editId(e.Id)]},o=(0,S.s)(n);this.#a.navRelative([`edit/${o}`])}#u(e){return this.#i(`edit/${(0,S.s)({items:[null==e?$.c.newFromType(this.#e):$.c.editId(e.Id)]})}`)}urlToNewItem(e){return this.#i(`edit/${(0,S.s)({items:[null==e?$.c.newFromType(this.#e):$.c.editId(e.Id)]})}`)}filesDropped(e){const n=e[0];switch(n.name.substring(n.name.lastIndexOf(".")+1).toLocaleLowerCase()){case"xml":this.urlToImportContent(e);break;case"json":this.importItem(e)}}urlToImportContent(e){return this.#i(`${this.#e}${e?`/${e.map(n=>n.name).join(",")}`:""}/import`)}importItem(e){this.#a.navRelative(["import"],{state:{files:e}})}urlToImportItem(){return this.#i("import")}createMetadata(){this.matDialog.open(Me,{autoFocus:!1,viewContainerRef:this.viewContainerRef,width:"650px"}).afterClosed().subscribe(n=>{if(null==n)return;const o={items:[$.c.newMetadataFromInfo(this.#e,n)]},s=(0,S.s)(o);this.#a.navRelative([`edit/${s}`]),this.changeDetectorRef.markForCheck()})}debugFilter(){console.warn("Current filter:",this.#o().getFilterModel()),this.snackBar.open("Check console for filter information",void 0,{duration:3e3})}#h(e){const n=[{...j.r.IdWithDefaultRenderer,cellClass:o=>("id-action no-padding no-outline "+(o.data._EditInfo.ReadOnly?"disabled":"")).split(" "),cellRendererParams:j.r.idFieldParamsTooltipGetter()},{field:"Status",width:82,headerClass:"dense",cellClass:"secondary-action no-padding".split(" "),filter:be,valueGetter:o=>{const s=o.data;return{published:s.IsPublished,metadata:!!s.For,hasMetadata:!!s.Metadata&&s.Metadata.length>0}},cellRenderer:bt,cellRendererParams:{urlTo:(o,s)=>"#"+this.#m(s)}},{...j.r.TextWidePrimary,headerName:"Item (Entity)",field:"_Title",flex:2,cellRenderer:o=>I.f.cellLink(this.#u(o.data),o.data._Title)},{headerName:"Stats",headerTooltip:"Used by others / uses others",field:"_Used",width:70,headerClass:"dense",cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:o=>`${o.data._Used} / ${o.data._Uses}`},{...j.r.ActionsPinnedRight3,cellRenderer:Ct,cellRendererParams:{urlTo:(s,m)=>"#"+this.#g(m),do:(s,m)=>{switch(s){case"export":this.#f(m);break;case"delete":this.#_(m)}}}}];for(const o of e){const s={headerName:o.StaticName,field:o.StaticName,flex:2,minWidth:250,cellClass:"no-outline",sortable:!0};switch(o.Type){case Y.O.Entity:s.allowMultiValue=o.Metadata?.Entity?.AllowMultiValue??!0,s.cellRenderer=vt,s.valueGetter=this.valueGetterEntityField,s.filter=W;break;case Y.O.DateTime:s.useTimePicker=o.Metadata?.DateTime?.UseTimePicker??!1,s.valueGetter=this.valueGetterDateTime,s.filter="agTextColumnFilter";break;case Y.O.Boolean:s.valueGetter=this.valueGetterBoolean,s.filter=v.y;break;case Y.O.Number:s.filter="agNumberColumnFilter";break;default:s.filter="agTextColumnFilter"}n.push(s)}return n}#g(e){return this.#a.urlSubRoute(`edit/${(0,S.s)({items:[$.c.copy(this.#e,e.Id)]})}`)}#f(e){this.#n.exportEntity(e.Id,this.#e,!0)}#_(e){this.snackBar.open("Deleting..."),this.#p(e,"Delete Item?",!1)}#p(e,n,o,s,m){this.matDialog.open(P.F,{autoFocus:!1,data:{entityId:e._RepositoryId,entityTitle:e._Title,message:n,title:s,confirmTranslateKey:m,hasDeleteSnackbar:!0},viewContainerRef:this.viewContainerRef,width:"400px"}).afterClosed().subscribe(C=>{C&&this.#t.delete(this.#e,e._RepositoryId,o).subscribe({next:()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchItems()},error:R=>{o||(this.snackBar.dismiss(),this.#p(e,`${R.error.ExceptionMessage} \n\nDo you want to force delete`,!0,"Force Delete","Force"))}})})}valueGetterEntityField(e){const n=e.data[e.colDef.field];return 0===n.length?null:n.map(o=>o.Title)}valueGetterDateTime(e){const n=e.data[e.colDef.field];return n?e.colDef.useTimePicker?n.replace("T"," ").replace("Z",""):n.split("T")[0]:null}valueGetterBoolean(e){const n=e.data[e.colDef.field];return"boolean"!=typeof n?null:n.toString()}static#C=this.\u0275fac=function(n){return new(n||a)(t.rXU(l.k),t.rXU(Ie.UG),t.rXU(l.h),t.rXU(t.c1b),t.rXU(Ee.gRc))};static#y=this.\u0275cmp=t.VBU({type:a,selectors:[["app-content-items"]],decls:38,vars:11,consts:[["appToggleDebug","",1,"eav-dialog","nav-component-wrapper"],[2,"height","100%",3,"helpText","refresh","rowLength"],["eav-dialog-header","",1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog",3,"click"],["eav-dialog-content","",1,"eav-dialog-content"],[3,"innerHTML"],["appDragAndDrop","",1,"ag-theme-material","eav-dialog-content",3,"rowData","gridOptions","allowedFileTypes"],[1,"eav-dialog-actions"],[1,"eav-dialog-actions-div"],["mat-button","","tippy","Export xml list","tippyPlacement","top",1,"eav-button__with-icon",3,"href"],[1,"eav-icon"],["mat-button","","tippy","Import xml list","tippyPlacement","top",1,"eav-button__with-icon",3,"href"],["mat-button","","tippy","Import single json item","tippyPlacement","top",1,"eav-button__with-icon",3,"href"],["mat-button","","tippy","Create metadata","tippyPlacement","top",1,"eav-button__with-icon",3,"click"],["mat-button","","color","accent","tippy","Print filter to console","tippyPlacement","top",1,"eav-button__with-icon"],["mat-fab","","mat-elevation-z24","","tippy","Add item",1,"grid-fab",3,"href"],["appDragAndDrop","",1,"ag-theme-material","eav-dialog-content",3,"gridReady","filesDropped","rowData","gridOptions","allowedFileTypes"],["mat-button","","color","accent","tippy","Print filter to console","tippyPlacement","top",1,"eav-button__with-icon",3,"click"]],template:function(n,o){if(1&n&&(t.j41(0,"div",0)(1,"app-grid-with-help",1)(2,"div",2)(3,"div",3),t.EFF(4),t.k0s(),t.j41(5,"button",4),t.bIt("click",function(){return o.closeDialog()}),t.j41(6,"mat-icon"),t.EFF(7,"close"),t.k0s()()(),t.j41(8,"div",5),t.nVh(9,ke,2,3,"div",6),t.k0s(),t.nVh(10,Re,1,3,"ag-grid-angular",7),t.j41(11,"mat-dialog-actions",8)(12,"div",9)(13,"a",10)(14,"mat-icon",11),t.EFF(15,"cloud_download"),t.k0s(),t.j41(16,"span"),t.EFF(17,"Data"),t.k0s()(),t.j41(18,"a",12)(19,"mat-icon",11),t.EFF(20,"cloud_upload"),t.k0s(),t.j41(21,"span"),t.EFF(22,"Data"),t.k0s()(),t.j41(23,"a",13)(24,"mat-icon",11),t.EFF(25,"cloud_upload"),t.k0s(),t.j41(26,"span"),t.EFF(27,"Item"),t.k0s()(),t.j41(28,"button",14),t.bIt("click",function(){return o.createMetadata()}),t.j41(29,"mat-icon",11),t.EFF(30,"local_offer"),t.k0s(),t.j41(31,"span"),t.EFF(32,"Create Metadata"),t.k0s()(),t.nVh(33,xe,5,0,"button",15),t.k0s(),t.j41(34,"a",16)(35,"mat-icon"),t.EFF(36,"add"),t.k0s()()()()(),t.nrm(37,"router-outlet")),2&n){let s,m,c,C;t.R7$(),t.Y8G("helpText",o.uxHelpText())("refresh",o.refresh())("rowLength",null==(s=o.items())?null:s.length),t.R7$(3),t.SpI("",(null==(m=o.contentType())?null:m.Label)||(null==(m=o.contentType())?null:m.Name)," Data"),t.R7$(5),t.vxM((c=null==(c=o.contentType())||null==c.Properties?null:c.Properties.ListInstructions)?9:-1,c),t.R7$(),t.vxM((null==(C=o.items())?null:C.length)>0?10:-1),t.R7$(3),t.Y8G("href",o.urlToExportContent(),t.B4B),t.R7$(5),t.Y8G("href",o.urlToImportContent(),t.B4B),t.R7$(5),t.Y8G("href",o.urlToImportItem(),t.B4B),t.R7$(10),t.vxM(o.isDebug()?33:-1),t.R7$(),t.Y8G("href",o.urlToNewItem(),t.B4B)}},dependencies:[u.Hl,u.$z,at.M,u.Sr,f.m_,f.An,g.n3,l.M,mt.$,rt.S,dt.V,pt.p,De.xs,V.e,D.v],styles:["[_nghost-%COMP%]     .ag-row-hover .ag-cell a, [_nghost-%COMP%]     .ag-row-hover .ag-cell .id-box *, [_nghost-%COMP%]     .ag-row-hover .ag-cell .eav-grid-action-button, .eav-button__with-icon[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{color:#85283b!important}"]})}return a})()},93826:(x,T,i)=>{i.d(T,{a:()=>d});class d{static boolEquals(u,l){return u===l}static stringEquals(u,l){return u===l}static valueEquals(u,l){return u===l}static objectsEqual(u,l){if(null==u||null==l)return u===l;const f=u,g=l,h=Object.keys(f),y=Object.keys(g);return h.length===y.length&&h.every(_=>!!g.hasOwnProperty(_)&&f[_]===g[_])}static arraysEqual(u,l){return null==u||null==l?u===l:u.length===l.length&&u.every((g,h)=>u[h]===l[h])}static distinct(u,l,f){return f.indexOf(u)===l}}},95699:(x,T,i)=>{i.d(T,{V:()=>u});var d=i(99293),M=i(39431);let u=(()=>{class l{constructor(g){this.globalConfigService=g}onClick(g){(navigator.platform.match("Mac")?g.metaKey:g.ctrlKey)&&g.shiftKey&&g.altKey&&(this.globalConfigService.toggleDebugEnabled(),window.getSelection().removeAllRanges())}static#t=this.\u0275fac=function(h){return new(h||l)(d.rXU(M.B))};static#n=this.\u0275dir=d.FsC({type:l,selectors:[["","appToggleDebug",""]],hostBindings:function(h,y){1&h&&d.bIt("click",function(_){return y.onClick(_)})}})}return l})()},96817:(x,T,i)=>{i.d(T,{R:()=>h});var d=i(47215),M=i(85837),u=i(9234),l=i(24467),f=i(99293),g=i(44444);let h=(()=>{class y extends l.B{create(_,E){return this.http.post(`app/auto/data/${_}`,E,{params:{appId:this.appId,zoneId:this.zoneId}})}update(_,E,I){return this.http.post(`app/auto/data/${_}/${E}`,I,{params:{appId:this.appId,zoneId:this.zoneId}})}delete(_,E,I){return this.http.delete(this.apiUrl(u.gb+"delete"),{params:{contentType:_,id:E.toString(),appId:this.appId,force:I.toString()},context:(new d._y).set(M.g,[400])})}static#t=this.\u0275fac=(()=>{let _;return function(I){return(_||(_=f.xGo(y)))(I||y)}})();static#n=this.\u0275prov=g.jDH({token:y,factory:y.\u0275fac})}return y})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/20.00.05/dist/ng-edit/projects_eav-ui_src_app_content-items_content-items_component_ts.26e9ee2eee37f004.js.map