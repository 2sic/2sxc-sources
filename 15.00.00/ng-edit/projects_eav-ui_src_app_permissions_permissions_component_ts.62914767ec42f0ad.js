"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_permissions_permissions_component_ts"],{61:(T,m,t)=>{t.r(m),t.d(m,{PermissionsComponent:()=>I});var c=t(6317),n=t(60),a=t(2087),h=t(4153),u=t(941),v=t(2225),e=t(3184),C=t(1130),g=t(6190),d=t(5590);let l=(()=>{class p{agInit(i){this.params=i}refresh(i){return!0}deletePermission(){this.params.onDelete(this.params.data)}}return p.\u0275fac=function(i){return new(i||p)},p.\u0275cmp=e.Xpm({type:p,selectors:[["app-permissions-actions"]],decls:4,vars:0,consts:[[1,"actions-component"],["matRipple","","tippy","Delete",1,"like-button","highlight",3,"click"]],template:function(i,s){1&i&&(e.TgZ(0,"div",0)(1,"div",1),e.NdJ("click",function(){return s.deletePermission()}),e.TgZ(2,"mat-icon"),e._uU(3,"delete"),e.qZA()()())},directives:[C.wG,g.$,d.Hw],styles:[""]}),p})();var r=t(2023),f=t(5758),O=t(2977),D=t(2528),E=t(7317),M=t(1350),b=t(6362);let I=(()=>{class p extends n.H{constructor(i,s,o,P,_){super(s,o),this.dialogRef=i,this.permissionsService=P,this.snackBar=_,this.permissions$=new c.X(void 0),this.gridOptions=this.buildGridOptions(),this.targetType=parseInt(this.route.snapshot.paramMap.get("targetType"),10),this.keyType=this.route.snapshot.paramMap.get("keyType"),this.key=this.route.snapshot.paramMap.get("key"),this.prefills={[u.Z.metadata.language.targetType]:{PermissionType:"language"}}}ngOnInit(){this.fetchPermissions(),this.subscription.add(this.refreshOnChildClosed().subscribe(()=>{this.fetchPermissions()}))}ngOnDestroy(){this.permissions$.complete(),super.ngOnDestroy()}closeDialog(){this.dialogRef.close()}fetchPermissions(){this.permissionsService.getAll(this.targetType,this.keyType,this.key).subscribe(i=>{this.permissions$.next(i)})}editPermission(i){var s,o;let P;P=null==i?{items:[Object.assign({ContentTypeName:u.Z.contentTypes.permissions,For:Object.assign(Object.assign(Object.assign({Target:null!==(o=null===(s=Object.values(u.Z.metadata).find(x=>x.targetType===this.targetType))||void 0===s?void 0:s.target)&&void 0!==o?o:this.targetType.toString(),TargetType:this.targetType},this.keyType===u.Z.keyTypes.guid&&{Guid:this.key}),this.keyType===u.Z.keyTypes.number&&{Number:parseInt(this.key,10)}),this.keyType===u.Z.keyTypes.string&&{String:this.key})},this.prefills[this.targetType]&&{Prefill:this.prefills[this.targetType]})]}:{items:[{EntityId:i.Id}]};const _=(0,v.f)(P);this.router.navigate([`edit/${_}`],{relativeTo:this.route})}deletePermission(i){!confirm(`Delete '${i.Title}' (${i.Id})?`)||(this.snackBar.open("Deleting..."),this.permissionsService.delete(i.Id).subscribe(()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchPermissions()}))}buildGridOptions(){return Object.assign(Object.assign({},h.f),{columnDefs:[{headerName:"ID",field:"Id",width:70,headerClass:"dense",cellClass:"id-action no-padding no-outline".split(" "),sortable:!0,filter:"agNumberColumnFilter",valueGetter:s=>s.data.Id,cellRenderer:a.m,cellRendererParams:{tooltipGetter:o=>`ID: ${o.Id}\nGUID: ${o.Guid}`}},{field:"Name",flex:2,minWidth:250,cellClass:"primary-action highlight".split(" "),sortable:!0,sort:"asc",filter:"agTextColumnFilter",onCellClicked:s=>{this.editPermission(s.data)},valueGetter:s=>s.data.Title},{field:"Identity",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:s=>s.data.Identity},{field:"Condition",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:s=>s.data.Condition},{field:"Grant",width:70,headerClass:"dense",cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:s=>s.data.Grant},{width:42,cellClass:"secondary-action no-padding".split(" "),pinned:"right",cellRenderer:l,cellRendererParams:(()=>({onDelete:o=>this.deletePermission(o)}))()}]})}}return p.\u0275fac=function(i){return new(i||p)(e.Y36(f.so),e.Y36(O.F0),e.Y36(O.gz),e.Y36(r.q),e.Y36(D.ux))},p.\u0275cmp=e.Xpm({type:p,selectors:[["app-permissions"]],features:[e.qOj],decls:16,vars:4,consts:[[1,"nav-component-wrapper"],["mat-dialog-title",""],[1,"dialog-title-box"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","gridOptions"],[1,"grid-more-actions-box"],["mat-fab","","mat-elevation-z24","","tippy","Create a new permission",1,"grid-fab",3,"click"]],template:function(i,s){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div"),e._uU(4,"Permissions"),e.qZA(),e.TgZ(5,"button",3),e.NdJ("click",function(){return s.closeDialog()}),e.TgZ(6,"mat-icon"),e._uU(7,"close"),e.qZA()()()(),e._UZ(8,"router-outlet"),e.TgZ(9,"div",4),e._UZ(10,"ag-grid-angular",5),e.ALo(11,"async"),e._UZ(12,"div",6),e.TgZ(13,"button",7),e.NdJ("click",function(){return s.editPermission(null)}),e.TgZ(14,"mat-icon"),e._uU(15,"add"),e.qZA()()()()),2&i&&(e.xp6(10),e.Q6J("rowData",e.lcZ(11,2,s.permissions$))("gridOptions",s.gridOptions))},directives:[f.uh,E.lW,g.$,d.Hw,O.lC,M.N8],pipes:[b.Ov],styles:[""]}),p})()},60:(T,m,t)=>{t.d(m,{H:()=>C});var c=t(2977),n=t(7714),a=t(116),h=t(4874),u=t(635),v=t(679),e=t(3184);let C=(()=>{class g{constructor(l,r){this.router=l,this.route=r,this.subscription=new n.w0}ngOnDestroy(){this.subscription.unsubscribe()}refreshOnChildClosed(){return this.router.events.pipe((0,a.h)(l=>l instanceof c.m2),(0,h.O)(!!this.route.snapshot.firstChild.firstChild),(0,u.U)(()=>!!this.route.snapshot.firstChild.firstChild),(0,v.G)(),(0,a.h)(([l,r])=>l&&!r))}}return g.\u0275fac=function(l){return new(l||g)(e.Y36(c.F0),e.Y36(c.gz))},g.\u0275dir=e.lG2({type:g}),g})()},2087:(T,m,t)=>{t.d(m,{m:()=>g});var c=t(9673),n=t(3184),a=t(2528),h=t(1130),u=t(6190),v=t(6362),e=t(5590);const C=function(d,l){return{"align-start":d,"align-end":l}};let g=(()=>{class d{constructor(r){this.snackBar=r}agInit(r){this.id=r.value,this.align="number"==typeof this.id?"end":"start",this.tooltip=r.tooltipGetter(r.data)}refresh(r){return!0}copy(){(0,c.v)(this.tooltip),this.snackBar.open("Copied to clipboard",null,{duration:2e3})}}return d.\u0275fac=function(r){return new(r||d)(n.Y36(a.ux))},d.\u0275cmp=n.Xpm({type:d,selectors:[["app-id-field"]],decls:5,vars:6,consts:[["matRipple","",1,"id-box","highlight",3,"tippy","ngClass","click"],[1,"id"],[1,"icon"]],template:function(r,f){1&r&&(n.TgZ(0,"div",0),n.NdJ("click",function(){return f.copy()}),n.TgZ(1,"span",1),n._uU(2),n.qZA(),n.TgZ(3,"mat-icon",2),n._uU(4,"file_copy"),n.qZA()()),2&r&&(n.Q6J("tippy",f.tooltip)("ngClass",n.WLB(3,C,"start"===f.align,"end"===f.align)),n.xp6(2),n.Oqu(f.id))},directives:[h.wG,u.$,v.mk,e.Hw],styles:[".id-box[_ngcontent-%COMP%]{padding:0 8px;height:100%;display:flex;align-items:center}.id-box.align-start[_ngcontent-%COMP%]{justify-content:flex-start}.id-box.align-end[_ngcontent-%COMP%]{justify-content:flex-end}.id-box[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{max-width:100%;text-overflow:ellipsis;overflow:hidden}.id-box[_ngcontent-%COMP%]:hover{text-decoration:none}.id-box[_ngcontent-%COMP%]:hover   .id[_ngcontent-%COMP%]{display:none}.id-box[_ngcontent-%COMP%]:not(:hover)   .icon[_ngcontent-%COMP%]{display:none}"]}),d})()},4153:(T,m,t)=>{t.d(m,{f:()=>c});const c={accentedSort:!0,animateRows:!0,enableCellTextSelection:!0,headerHeight:32,suppressScrollOnNewData:!0,valueCache:!0,defaultColDef:{filterParams:{newRowsAction:"keep"}},tooltipShowDelay:0,tooltipHideDelay:1e5,suppressMovableColumns:!0}},9673:(T,m,t)=>{function c(n){const a=document.createElement("textarea");a.value=n,a.setAttribute("readonly",""),a.style.position="absolute",a.style.left="-9999px",document.body.appendChild(a);const h=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);a.select(),document.execCommand("copy"),document.body.removeChild(a),h&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(h))}t.d(m,{v:()=>c})}}]);
//# sourceMappingURL=https://sources.2sxc.org/15.00.00/ng-edit/projects_eav-ui_src_app_permissions_permissions_component_ts.62914767ec42f0ad.js.map