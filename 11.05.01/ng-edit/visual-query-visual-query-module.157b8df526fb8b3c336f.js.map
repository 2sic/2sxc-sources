{"version":3,"sources":["./src/app/visual-query/plumb-editor/plumber.helper.ts","./src/app/visual-query/plumb-editor/plumb-editor.helpers.ts","./src/app/visual-query/query-result/query-result.component.html","./src/app/visual-query/query-result/query-result.component.ts","./src/app/visual-query/services/query-definition.service.ts","./src/app/visual-query/services/visual-query.service.ts","./src/app/visual-query/plumb-editor/plumb-editor.component.html","./src/app/visual-query/plumb-editor/plumb-editor.component.ts","./src/app/visual-query/run-explorer/run-explorer.component.html","./src/app/visual-query/run-explorer/run-explorer.component.ts","./src/app/visual-query/run-explorer/run-explorer.helpers.ts","./src/app/visual-query/add-explorer/add-explorer.component.html","./src/app/visual-query/add-explorer/add-explorer.component.ts","./src/app/visual-query/add-explorer/add-explorer.helpers.ts","./src/app/visual-query/visual-query-routing.module.ts","./src/app/visual-query/visual-query.component.ts","./src/app/visual-query/visual-query.component.html","./src/app/visual-query/visual-query.module.ts"],"names":["jsPlumbRoot","pipelineModel","dataSources","onConnectionsChanged","onDragend","plumbInits","lineCount","linePaintDefault","stroke","strokeWidth","outlineStroke","outlineWidth","lineColors","maxCols","this","length","uuidColorMap","bulkDelete","instance","jsPlumb","getInstance","getInstanceDefaults","batch","initDomDataSources","initWirings","bindEvents","repaintEverything","destroy","reset","removeEndpointsOnDataSource","pipelineDataSourceGuid","elementId","selectEndpoints","element","delete","getAllConnections","map","connection","From","sourceId","replace","Out","endpoints","getOverlay","label","To","targetId","In","getStreamsOut","streamsOut","target","dataSrcIdPrefix","each","endpoint","push","join","putEntityCountOnConnections","result","Streams","forEach","stream","sourceElementId","Source","toUuid","Pipeline","EntityGuid","includes","Target","TargetIn","sEndp","getEndpoint","SourceOut","connections","getUuid","setLabel","Count","toString","cssClass","nextLinePaintStyle","uuid","Object","assign","container","Container","Connector","curviness","PaintStyle","HoverPaintStyle","pipelineDataSource","domDataSource","querySelector","dataSource","find","ds","PartAssemblyAndType","AllowEdit","draggable","grid","stop","event","el","id","position","Top","finalPos","Left","setTimeout","name","addEndpoint","targetEndpointUnlimited","buildTargetEndpoint","maxConnections","makeTarget","DynamicOut","makeSource","buildSourceEndpoint","filter","DataSources","StreamWiring","wire","fromUuid","targetElementId","pipeDataSource","connect","uuids","paintStyle","e","console","error","message","from","to","isIn","model","enabled","fill","radius","isSource","anchor","faces","overlays","getEndpointOverlays","isTarget","dropOptions","hoverClass","activeClass","location","events","dblclick","labelOverlay","dblClickCounter","newLabel","prompt","bind","info","pipelineDS","fixedEndpoints","targetEndpoint","deleteEndpoint","endpointLabel","labelPrompt","getLabel","getEndpoints","some","canvas","classList","contains","Math","floor","random","guiTypes","Cache","icon","notes","Filter","Logic","Lookup","Modify","Security","Sort","Unknown","calculateTypeInfos","pipelineDataSources","typeInfos","typeInfo","PrimaryType","Icon","dynamicOut","HelpLink","helpLink","EnableConfig","config","data","dialogRef","ngOnInit","testParameters","timeUsed","QueryTimer","Milliseconds","ticksUsed","Ticks","Query","sources","Sources","streams","closeDialog","close","QueryResultComponent","http","context","dnnContext","fetchPipeline","pipelineEntityId","get","$2sxc","apiUrl","params","appId","pipe","buildDefaultModel","fixPipelineDataSources","templateDataSources","pipelineDesigner","defaultPipeline","templateDS","visualDesignerData","Description","entityGuid","EntityId","undefined","Name","typeNameFilter","partAssemblyAndType","VisualDesignerData","streamWiring","outDs","outDataSource","description","className","fetchDataSources","ContentType","Difficulty","in","UiHint","allowNew","input","format","globalParts","split","classFullNameParts","savePipeline","pipeline","post","Id","pipeModel","runPipeline","QueryDefinitionService","router","route","queryDefinitionService","titleService","snackBar","dialog","viewContainerRef","zone","metadataService","contentTypesService","pipelineModel$","BehaviorSubject","dataSources$","putEntityCountOnConnections$","Subject","pipelineId","parseInt","snapshot","paramMap","doRefresh","subscription","Subscription","ngOnDestroy","complete","unsubscribe","init","attachKeyboardSave","refreshOnChildClosed","editPipelineEntity","form","items","value","formUrl","navigate","relativeTo","saveAndRun","save","run","addDataSource","cloneDeep","newPipelineDataSource","next","removeDataSource","StreamsOut","renameDataSource","changeDataSourceDescription","changeConnections","changeDataSourcePosition","editDataSource","contentTypeName","key","getMetadata","metadata","entity","type","keyTypes","guid","subscribe","getDetails","ignoreErrors","contentType","ContentTypeName","For","Guid","alert","callback","open","duration","pipelineResult","TestParameters","backdropClass","panelClass","autoFocus","closeOnNavigation","top","warn","reloadingSnackBar","setTitle","runOutsideAngular","add","fromEvent","window","firstChild","navigator","platform","match","metaKey","ctrlKey","keyCode","preventDefault","startWith","pairwise","refresh","VisualQueryService","visualQueryService","cd","hardReset","scriptLoaded$","test","src","plumber","templateModel$","combineLatest","detectChanges","allowEdit","ngAfterViewInit","domDataSourcesLoaded$","domDataSourcesRef","changes","domRootRef","nativeElement","configureDataSource","remove","confirm","editName","newName","trim","editDescription","newDescription","PlumbEditorComponent","warnings$","warnings","testMid","exec","urlMid","moduleId","calculateWarnings","editPipeline","openParamsHelp","saveAndRunQuery","RunExplorerComponent","toggledItems","difficulties","default","advanced","difficulty$","sorted$","maxDifficulty","filtered","sort","a","b","toLocaleLowerCase","localeCompare","sorted","filterAndSortDataSources","toggleDifficulty","checked","toggleItem","item","array","index","indexOf","splice","toggleInArray","AddExplorerComponent","routes","path","component","explorer","activeExplorer","toggleExplorer","openHelp","VisualQueryComponent","children","matcher","loadChildren","then","m","EditModule","VisualQueryRoutingModule","forChild","VisualQueryModule"],"mappings":"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","file":"visual-query-visual-query-module.157b8df526fb8b3c336f.js","sourcesContent":["import { DataSource } from '../models/data-sources.model';\r\nimport { PipelineDataSource, PipelineModel, StreamWire, VisualDesignerData } from '../models/pipeline.model';\r\nimport { PipelineResult } from '../models/pipeline-result.model';\r\nexport const dataSrcIdPrefix = 'dataSource_';\r\ntype PlumbType = any;\r\ndeclare const jsPlumb: PlumbType;\r\n\r\nexport class Plumber {\r\n  private instance: PlumbType;\r\n  private lineCount = 0;\r\n  private linePaintDefault = {\r\n    stroke: '#61B7CF',\r\n    strokeWidth: 4,\r\n    outlineStroke: 'white',\r\n    outlineWidth: 2,\r\n  };\r\n  private lineColors = [\r\n    '#009688', '#00bcd4', '#3f51b5', '#9c27b0', '#e91e63',\r\n    '#db4437', '#ff9800', '#60a917', '#60a917', '#008a00',\r\n    '#00aba9', '#1ba1e2', '#0050ef', '#6a00ff', '#aa00ff',\r\n    '#f472d0', '#d80073', '#a20025', '#e51400', '#fa6800',\r\n    '#f0a30a', '#e3c800', '#825a2c', '#6d8764', '#647687',\r\n    '#76608a', '#a0522d',\r\n  ];\r\n  private maxCols = this.lineColors.length - 1;\r\n  private uuidColorMap: { [key: string]: any } = {};\r\n  private bulkDelete = false;\r\n\r\n  constructor(\r\n    private jsPlumbRoot: HTMLElement,\r\n    private pipelineModel: PipelineModel,\r\n    private dataSources: DataSource[],\r\n    private onConnectionsChanged: () => void,\r\n    private onDragend: (pipelineDataSourceGuid: string, position: VisualDesignerData) => void,\r\n    /** Workaround for multiple dblClick listeners */\r\n    private plumbInits: number,\r\n  ) {\r\n    this.instance = jsPlumb.getInstance(this.getInstanceDefaults(this.jsPlumbRoot));\r\n    this.instance.batch(() => {\r\n      this.initDomDataSources();\r\n      this.initWirings();\r\n      this.bindEvents();\r\n    });\r\n    // spm NOTE: repaint after initial paint fixes:\r\n    // Error: <svg> attribute width: Expected length, \"-Infinity\".\r\n    this.instance.repaintEverything();\r\n  }\r\n\r\n  destroy() {\r\n    this.instance.reset();\r\n  }\r\n\r\n  removeEndpointsOnDataSource(pipelineDataSourceGuid: string) {\r\n    const elementId = dataSrcIdPrefix + pipelineDataSourceGuid;\r\n    this.bulkDelete = true;\r\n    this.instance.batch(() => {\r\n      this.instance.selectEndpoints({ element: elementId }).delete();\r\n    });\r\n    this.bulkDelete = false;\r\n  }\r\n\r\n  getAllConnections() {\r\n    const connectionInfos: StreamWire[] = this.instance.getAllConnections().map((connection: PlumbType) => {\r\n      const wire: StreamWire = {\r\n        From: connection.sourceId.replace(dataSrcIdPrefix, ''),\r\n        Out: connection.endpoints[0].getOverlay('endpointLabel').label,\r\n        To: connection.targetId.replace(dataSrcIdPrefix, ''),\r\n        In: connection.endpoints[1].getOverlay('endpointLabel').label,\r\n      };\r\n      return wire;\r\n    });\r\n    return connectionInfos;\r\n  }\r\n\r\n  getStreamsOut() {\r\n    const streamsOut: string[] = [];\r\n    this.instance.selectEndpoints({ target: dataSrcIdPrefix + 'Out' }).each((endpoint: PlumbType) => {\r\n      streamsOut.push(endpoint.getOverlay('endpointLabel').label);\r\n    });\r\n    const streamsOutStr = streamsOut.join(',');\r\n    return streamsOutStr;\r\n  }\r\n\r\n  putEntityCountOnConnections(result: PipelineResult) {\r\n    result.Streams?.forEach(stream => {\r\n      const sourceElementId = dataSrcIdPrefix + stream.Source;\r\n      const outTargets = ['00000000-0000-0000-0000-000000000000', this.pipelineModel.Pipeline.EntityGuid];\r\n      const targetElementId = outTargets.includes(stream.Target) ? dataSrcIdPrefix + 'Out' : dataSrcIdPrefix + stream.Target;\r\n\r\n      const fromUuid = sourceElementId + '_out_' + stream.SourceOut;\r\n      const toUuid = targetElementId + '_in_' + stream.TargetIn;\r\n\r\n      const sEndp: PlumbType = this.instance.getEndpoint(fromUuid);\r\n      sEndp?.connections?.forEach((connection: PlumbType) => {\r\n        if (connection.endpoints[1].getUuid() !== toUuid) { return; }\r\n\r\n        connection.setLabel({ label: stream.Count.toString(), cssClass: 'streamEntitiesCount' });\r\n      });\r\n    });\r\n  }\r\n\r\n  private nextLinePaintStyle(uuid: string) {\r\n    return (\r\n      this.uuidColorMap[uuid] ||\r\n      (this.uuidColorMap[uuid] = Object.assign({}, this.linePaintDefault, { stroke: this.lineColors[this.lineCount++ % this.maxCols] }))\r\n    );\r\n  }\r\n\r\n  private getInstanceDefaults(container: HTMLElement) {\r\n    const defaults = {\r\n      Container: container,\r\n      Connector: ['Bezier', { curviness: 70 }],\r\n      PaintStyle: this.nextLinePaintStyle('dummy'),\r\n      HoverPaintStyle: {\r\n        stroke: '#216477',\r\n        strokeWidth: 4,\r\n        outlineStroke: 'white',\r\n        outlineWidth: 2,\r\n      },\r\n    };\r\n    return defaults;\r\n  }\r\n\r\n  /** Create sources, targets and endpoints */\r\n  private initDomDataSources() {\r\n    for (const pipelineDataSource of this.pipelineModel.DataSources) {\r\n      const domDataSource: HTMLElement = this.jsPlumbRoot.querySelector('#' + dataSrcIdPrefix + pipelineDataSource.EntityGuid);\r\n      const dataSource = this.dataSources.find(ds => ds.PartAssemblyAndType === pipelineDataSource.PartAssemblyAndType);\r\n      if (!dataSource) { continue; }\r\n\r\n      if (this.pipelineModel.Pipeline.AllowEdit) {\r\n        // WARNING! Must happen before instance.makeSource()\r\n        this.instance.draggable(domDataSource, {\r\n          grid: [20, 20], stop: (event: PlumbType) => {\r\n            const element: HTMLElement = event.el;\r\n            const pipelineDataSourceGuid: string = element.id.replace(dataSrcIdPrefix, '');\r\n            const position: VisualDesignerData = {\r\n              Top: event.finalPos[1],\r\n              Left: event.finalPos[0],\r\n            };\r\n            setTimeout(() => { this.onDragend(pipelineDataSourceGuid, position); });\r\n          }\r\n        });\r\n      }\r\n\r\n      // Add Out-Endpoints from Definition\r\n      dataSource.Out?.forEach(name => {\r\n        this.addEndpoint(domDataSource, name, false, pipelineDataSource);\r\n      });\r\n\r\n      // Add Out-Endpoints from Definition\r\n      dataSource.In?.forEach(name => {\r\n        this.addEndpoint(domDataSource, name, true, pipelineDataSource);\r\n      });\r\n\r\n      // Make DataSource a Target for new Endpoints (if .In is an Array)\r\n      if (dataSource.In) {\r\n        const targetEndpointUnlimited = this.buildTargetEndpoint();\r\n        targetEndpointUnlimited.maxConnections = -1;\r\n        this.instance.makeTarget(domDataSource, targetEndpointUnlimited);\r\n      }\r\n\r\n      if (dataSource.DynamicOut) {\r\n        this.instance.makeSource(domDataSource, this.buildSourceEndpoint(), { filter: '.add-endpoint .new-connection' });\r\n      }\r\n    }\r\n  }\r\n\r\n  /** Create wires */\r\n  private initWirings() {\r\n    this.pipelineModel.Pipeline.StreamWiring?.forEach(wire => {\r\n      // read connections from Pipeline\r\n      const sourceElementId = dataSrcIdPrefix + wire.From;\r\n      const fromUuid = sourceElementId + '_out_' + wire.Out;\r\n      const targetElementId = dataSrcIdPrefix + wire.To;\r\n      const toUuid = targetElementId + '_in_' + wire.In;\r\n\r\n      // Ensure In-Endpoint exist\r\n      if (!this.instance.getEndpoint(fromUuid)) {\r\n        const domDataSource: HTMLElement = this.jsPlumbRoot.querySelector('#' + sourceElementId);\r\n        const guid: string = domDataSource.id.replace(dataSrcIdPrefix, '');\r\n        const pipelineDataSource = this.pipelineModel.DataSources.find(pipeDataSource => pipeDataSource.EntityGuid === guid);\r\n        this.addEndpoint(domDataSource, wire.Out, false, pipelineDataSource);\r\n      }\r\n\r\n      // Ensure Out-Endpoint exist\r\n      if (!this.instance.getEndpoint(toUuid)) {\r\n        const domDataSource: HTMLElement = this.jsPlumbRoot.querySelector('#' + targetElementId);\r\n        const guid: string = domDataSource.id.replace(dataSrcIdPrefix, '');\r\n        const pipelineDataSource = this.pipelineModel.DataSources.find(pipeDataSource => pipeDataSource.EntityGuid === guid);\r\n        this.addEndpoint(domDataSource, wire.In, true, pipelineDataSource);\r\n      }\r\n\r\n      try {\r\n        this.instance.connect({\r\n          uuids: [fromUuid, toUuid],\r\n          paintStyle: this.nextLinePaintStyle(fromUuid),\r\n        });\r\n      } catch (e) {\r\n        console.error({ message: 'Connection failed', from: fromUuid, to: toUuid });\r\n      }\r\n    });\r\n  }\r\n\r\n  private addEndpoint(domDataSource: HTMLElement, name: string, isIn: boolean, pipelineDataSource: PipelineDataSource) {\r\n    const uuid = domDataSource.id + (isIn ? '_in_' : '_out_') + name;\r\n    const model = isIn ? this.buildTargetEndpoint() : this.buildSourceEndpoint();\r\n    // Endpoints on Out-DataSource must be always enabled\r\n    const params = { uuid, enabled: this.pipelineModel.Pipeline.AllowEdit || pipelineDataSource.EntityGuid === 'Out' };\r\n\r\n    const endPoint: PlumbType = this.instance.addEndpoint(domDataSource, model, params);\r\n    endPoint.getOverlay('endpointLabel').setLabel(name);\r\n  }\r\n\r\n  private buildSourceEndpoint() {\r\n    const sourceEndpoint = {\r\n      paintStyle: { fill: 'transparent', radius: 10 },\r\n      cssClass: 'sourceEndpoint',\r\n      maxConnections: -1,\r\n      isSource: true,\r\n      anchor: ['Continuous', { faces: ['top'] }],\r\n      overlays: this.getEndpointOverlays(true)\r\n    };\r\n    return sourceEndpoint;\r\n  }\r\n\r\n  private buildTargetEndpoint() {\r\n    const targetEndpoint = {\r\n      paintStyle: { fill: 'transparent', radius: 10 },\r\n      cssClass: 'targetEndpoint',\r\n      maxConnections: 1,\r\n      isTarget: true,\r\n      anchor: ['Continuous', { faces: ['bottom'] }],\r\n      overlays: this.getEndpointOverlays(false),\r\n      dropOptions: { hoverClass: 'hover', activeClass: 'active' }\r\n    };\r\n    return targetEndpoint;\r\n  }\r\n\r\n  private getEndpointOverlays(isSource: boolean) {\r\n    return [\r\n      [\r\n        'Label', {\r\n          id: 'endpointLabel',\r\n          // location: [0.5, isSource ? -0.5 : 1.5],\r\n          location: [0.5, isSource ? 0 : 1],\r\n          label: 'Default',\r\n          cssClass: 'noselect ' + (isSource ? 'endpointSourceLabel' : 'endpointTargetLabel'),\r\n          events: {\r\n            dblclick: (labelOverlay: PlumbType) => {\r\n              if (!this.pipelineModel.Pipeline.AllowEdit) { return; }\r\n\r\n              // spm NOTE: workaround for multiple dblclick listeners\r\n              if (labelOverlay.dblClickCounter == null || labelOverlay.dblClickCounter >= this.plumbInits) {\r\n                labelOverlay.dblClickCounter = 1;\r\n              } else {\r\n                labelOverlay.dblClickCounter++;\r\n              }\r\n              if (labelOverlay.dblClickCounter > 1) { return; }\r\n\r\n              const newLabel = prompt('Rename stream', labelOverlay.label);\r\n              if (!newLabel) { return; }\r\n              labelOverlay.setLabel(newLabel);\r\n              setTimeout(() => { this.onConnectionsChanged(); });\r\n            }\r\n          }\r\n        }\r\n      ]\r\n    ];\r\n  }\r\n\r\n  private bindEvents() {\r\n    // If connection on Out-DataSource was removed, remove custom Endpoint\r\n    this.instance.bind('connectionDetached', (info: PlumbType) => {\r\n      // spm TODO: custom endpoints were removed only on Out DataSource. Bug?\r\n      // if (info.targetId !== dataSrcIdPrefix + 'Out') { return; }\r\n      if (this.bulkDelete) { return; }\r\n      const domDataSource: HTMLElement = info.target;\r\n      const pipelineDataSource = this.pipelineModel.DataSources.find(\r\n        pipelineDS => pipelineDS.EntityGuid === domDataSource.id.replace(dataSrcIdPrefix, '')\r\n      );\r\n      const dataSource = this.dataSources.find(ds => ds.PartAssemblyAndType === pipelineDataSource.PartAssemblyAndType);\r\n      const fixedEndpoints = dataSource.In;\r\n      const label: string = info.targetEndpoint.getOverlay('endpointLabel').label;\r\n      if (fixedEndpoints.includes(label)) {\r\n        setTimeout(() => { this.onConnectionsChanged(); });\r\n        return;\r\n      }\r\n      this.instance.deleteEndpoint(info.targetEndpoint);\r\n      setTimeout(() => { this.onConnectionsChanged(); });\r\n    });\r\n\r\n    this.instance.bind('connection', (info: PlumbType) => {\r\n      const endpointLabel: PlumbType = info.targetEndpoint.getOverlay('endpointLabel');\r\n      const labelPrompt: string = endpointLabel.getLabel();\r\n      const endpoints: PlumbType[] = this.instance.getEndpoints(info.target.id);\r\n      const targetEndpointHasSameLabel = endpoints.some(endpoint => {\r\n        const label: string = endpoint.getOverlay('endpointLabel').getLabel();\r\n        return label === labelPrompt &&\r\n          info.targetEndpoint.id !== endpoint.id &&\r\n          (endpoint.canvas as HTMLCanvasElement).classList.contains('targetEndpoint');\r\n      });\r\n      if (targetEndpointHasSameLabel) {\r\n        endpointLabel.setLabel(`PleaseRename${Math.floor(Math.random() * 99999)}`);\r\n      }\r\n      setTimeout(() => { this.onConnectionsChanged(); });\r\n    });\r\n  }\r\n\r\n}\r\n","import { GuiTypes, TypeInfos, TypeInfo } from './plumb-editor.models';\r\nimport { PipelineDataSource } from '../models/pipeline.model';\r\nimport { DataSource } from '../models/data-sources.model';\r\n\r\nexport const guiTypes: GuiTypes = {\r\n  Cache: { name: 'Cache', icon: 'history', notes: 'Caching of data' },\r\n  Filter: { name: 'Filter', icon: 'filter_list', notes: 'Filter data - usually returning less items than came in' },\r\n  Logic: { name: 'Logic', icon: 'share', notes: 'Logic operations - usually choosing between different streams' },\r\n  Lookup: { name: 'Lookup', icon: 'search', notes: 'Lookup operation - usually looking for other data based on a criteria' },\r\n  Modify: { name: 'Modify', icon: 'star_half', notes: 'Modify data - usually changing, adding or removing values' },\r\n  Security: { name: 'Security', icon: 'account_circle', notes: 'Security - usually limit what the user sees based on his identity' },\r\n  Sort: { name: 'Sort', icon: 'sort', notes: 'Sort the items' },\r\n  Source: { name: 'Source', icon: 'cloud_upload', notes: 'Source of new data - usually SQL, CSV or similar' },\r\n  Target: { name: 'Target', icon: 'adjust', notes: 'Target - usually just a destination of data' },\r\n  Unknown: { name: 'Unknown', icon: 'fiber_manual_record', notes: 'Unknown type' },\r\n};\r\n\r\nexport function calculateTypeInfos(pipelineDataSources: PipelineDataSource[], dataSources: DataSource[]) {\r\n  const typeInfos: TypeInfos = {};\r\n\r\n  for (const pipelineDataSource of pipelineDataSources) {\r\n    let typeInfo: TypeInfo;\r\n    const dataSource = dataSources.find(ds => ds.PartAssemblyAndType === pipelineDataSource.PartAssemblyAndType);\r\n    if (dataSource) {\r\n      typeInfo = { ...(dataSource.PrimaryType ? guiTypes[dataSource.PrimaryType] : guiTypes.Unknown) };\r\n      if (dataSource.Icon) { typeInfo.icon = dataSource.Icon; }\r\n      if (dataSource.DynamicOut) { typeInfo.dynamicOut = true; }\r\n      if (dataSource.HelpLink) { typeInfo.helpLink = dataSource.HelpLink; }\r\n      if (dataSource.EnableConfig) { typeInfo.config = dataSource.EnableConfig; }\r\n    }\r\n    if (!typeInfo) { typeInfo = guiTypes.Unknown; }\r\n    typeInfos[pipelineDataSource.EntityGuid] = typeInfo;\r\n  }\r\n\r\n  return typeInfos;\r\n}\r\n","<div mat-dialog-title>\r\n  <div class=\"dialog-title-box\">\r\n    <div>Query Results</div>\r\n    <button mat-icon-button matTooltip=\"Close dialog\" (click)=\"closeDialog()\">\r\n      <mat-icon>close</mat-icon>\r\n    </button>\r\n  </div>\r\n</div>\r\n<p class=\"dialog-description\">\r\n  The Full result was logged to the Browser Console. Further down you'll find more debug-infos.\r\n</p>\r\n\r\n<br />\r\n\r\n<div mat-dialog-title>\r\n  <div class=\"dialog-title-box\">Parameters & Statistics</div>\r\n</div>\r\n<p class=\"description\">\r\n  Executed in {{ timeUsed }}ms ({{ ticksUsed }} ticks)\r\n</p>\r\n<ul class=\"description\">\r\n  <li *ngFor=\"let param of testParameters?.split('\\n')\">{{ param }}</li>\r\n</ul>\r\n\r\n<br />\r\n\r\n<div mat-dialog-title>\r\n  <div class=\"dialog-title-box\">Query Results</div>\r\n</div>\r\n<pre>\r\n  {{ result | json }}\r\n</pre>\r\n\r\n<br />\r\n\r\n<div mat-dialog-title>\r\n  <div class=\"dialog-title-box\">Sources</div>\r\n</div>\r\n<table class=\"description\">\r\n  <tr>\r\n    <th>Guid</th>\r\n    <th>Type</th>\r\n    <th>Configuration</th>\r\n    <th>Error</th>\r\n  </tr>\r\n  <tr *ngFor=\"let source of sources | keyvalue\">\r\n    <td>\r\n      <pre>{{ source.value.Guid }}</pre>\r\n    </td>\r\n    <td>{{ source.value.Type }}</td>\r\n    <td>\r\n      <ol>\r\n        <li *ngFor=\"let config of source.value.Configuration | keyvalue\">\r\n          <b>{{ config.key }}</b>=<em>{{ config.value }}</em></li>\r\n      </ol>\r\n    </td>\r\n    <td>{{ source.value.Error }}</td>\r\n  </tr>\r\n</table>\r\n\r\n<br />\r\n\r\n<div mat-dialog-title>\r\n  <div class=\"dialog-title-box\">Streams</div>\r\n</div>\r\n<table class=\"description\">\r\n  <tr>\r\n    <th>Source</th>\r\n    <th>Target</th>\r\n    <th>Items</th>\r\n    <th>Error</th>\r\n  </tr>\r\n  <tr *ngFor=\"let stream of streams\">\r\n    <td>\r\n      <pre>{{ stream.Source + \":\" + stream.SourceOut }}</pre>\r\n    </td>\r\n    <td>\r\n      <pre>{{ stream.Target + \":\" + stream.TargetIn }}</pre>\r\n    </td>\r\n    <td>{{ stream.Count }}</td>\r\n    <td>{{ stream.Error }}</td>\r\n  </tr>\r\n</table>\r\n","import { Component, OnInit, Inject, ChangeDetectionStrategy } from '@angular/core';\r\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\r\n\r\nimport { QueryResultDialogData } from './query-result.models';\r\nimport { PipelineResultQuery, PipelineResultSources, PipelineResultStream } from '../models/pipeline-result.model';\r\n\r\n@Component({\r\n  selector: 'app-query-result',\r\n  templateUrl: './query-result.component.html',\r\n  styleUrls: ['./query-result.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class QueryResultComponent implements OnInit {\r\n  testParameters: string;\r\n  timeUsed: number;\r\n  ticksUsed: number;\r\n  result: PipelineResultQuery;\r\n  sources: PipelineResultSources;\r\n  streams: PipelineResultStream[];\r\n\r\n  constructor(@Inject(MAT_DIALOG_DATA) public data: QueryResultDialogData, private dialogRef: MatDialogRef<QueryResultComponent>) { }\r\n\r\n  ngOnInit() {\r\n    this.testParameters = this.data.testParameters;\r\n    this.timeUsed = this.data.result.QueryTimer.Milliseconds;\r\n    this.ticksUsed = this.data.result.QueryTimer.Ticks;\r\n    this.result = this.data.result.Query;\r\n    this.sources = this.data.result.Sources;\r\n    this.streams = this.data.result.Streams;\r\n  }\r\n\r\n  closeDialog() {\r\n    this.dialogRef.close();\r\n  }\r\n\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { Observable } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\n\r\nimport { Context } from '../../shared/services/context';\r\nimport { eavConstants } from '../../shared/constants/eav.constants';\r\nimport { PipelineModel, PipelineDataSource } from '../models/pipeline.model';\r\nimport { DataSource } from '../models/data-sources.model';\r\nimport { PipelineResult } from '../models/pipeline-result.model';\r\n\r\n@Injectable()\r\nexport class QueryDefinitionService {\r\n  constructor(private http: HttpClient, private context: Context, private dnnContext: DnnContext) { }\r\n\r\n  fetchPipeline(pipelineEntityId: number) {\r\n    const pipelineModel$ = this.http.get(this.dnnContext.$2sxc.http.apiUrl('eav/PipelineDesigner/GetPipeline'), {\r\n      params: { appId: this.context.appId.toString(), id: pipelineEntityId.toString() }\r\n    }) as Observable<PipelineModel>;\r\n\r\n    return pipelineModel$.pipe(\r\n      map(pipelineModel => {\r\n        // if pipeline is new, populate it with default model\r\n        if (!pipelineModel.DataSources.length) {\r\n          this.buildDefaultModel(pipelineModel);\r\n        }\r\n        this.fixPipelineDataSources(pipelineModel.DataSources);\r\n        return pipelineModel;\r\n      }),\r\n    );\r\n  }\r\n\r\n  private buildDefaultModel(pipelineModel: PipelineModel) {\r\n    const templateDataSources = eavConstants.pipelineDesigner.defaultPipeline.dataSources;\r\n    for (const templateDS of templateDataSources) {\r\n      if (templateDS.visualDesignerData == null) {\r\n        templateDS.visualDesignerData = { Top: 100, Left: 100 };\r\n      }\r\n      const pipelineDataSource: PipelineDataSource = {\r\n        Description: '',\r\n        EntityGuid: templateDS.entityGuid || 'unsaved' + (pipelineModel.DataSources.length + 1),\r\n        EntityId: undefined,\r\n        Name: this.typeNameFilter(templateDS.partAssemblyAndType, 'className'),\r\n        PartAssemblyAndType: templateDS.partAssemblyAndType,\r\n        VisualDesignerData: templateDS.visualDesignerData,\r\n      };\r\n      pipelineModel.DataSources.push(pipelineDataSource);\r\n    }\r\n\r\n    pipelineModel.Pipeline.StreamWiring = eavConstants.pipelineDesigner.defaultPipeline.streamWiring;\r\n  }\r\n\r\n  private fixPipelineDataSources(pipelineDataSources: PipelineDataSource[]) {\r\n    const outDataSourceExists = pipelineDataSources.some(pipelineDS => pipelineDS.EntityGuid === 'Out');\r\n    if (!outDataSourceExists) {\r\n      const outDs = eavConstants.pipelineDesigner.outDataSource;\r\n      const outDsConst: PipelineDataSource = {\r\n        Description: outDs.description,\r\n        EntityGuid: 'Out',\r\n        EntityId: undefined,\r\n        Name: outDs.name,\r\n        PartAssemblyAndType: outDs.className,\r\n        VisualDesignerData: outDs.visualDesignerData,\r\n      };\r\n      pipelineDataSources.push(outDsConst);\r\n    }\r\n\r\n    for (const pipelineDataSource of pipelineDataSources) {\r\n      pipelineDataSource.VisualDesignerData = pipelineDataSource.VisualDesignerData || { Top: 50, Left: 50 };\r\n    }\r\n  }\r\n\r\n  fetchDataSources() {\r\n    const dataSources$ = this.http.get(\r\n      this.dnnContext.$2sxc.http.apiUrl('eav/PipelineDesigner/GetInstalledDataSources')\r\n    ) as Observable<DataSource[]>;\r\n    return dataSources$.pipe(\r\n      map(dataSources => {\r\n        const outDs = eavConstants.pipelineDesigner.outDataSource;\r\n        const outDsConst: DataSource = {\r\n          ContentType: undefined,\r\n          Difficulty: 100,\r\n          DynamicOut: false,\r\n          EnableConfig: undefined,\r\n          HelpLink: undefined,\r\n          Icon: undefined,\r\n          In: outDs.in,\r\n          Name: outDs.name || outDs.className,\r\n          Out: undefined,\r\n          PartAssemblyAndType: outDs.className,\r\n          PrimaryType: 'Target',\r\n          UiHint: undefined,\r\n          allowNew: false,\r\n        };\r\n        dataSources.push(outDsConst);\r\n        return dataSources;\r\n      }),\r\n    );\r\n  }\r\n\r\n  typeNameFilter(input: string, format: string) {\r\n    const globalParts = input.split(', ');\r\n\r\n    switch (format) {\r\n      case 'classFullName':\r\n        const classFullName = globalParts[0];\r\n        return classFullName;\r\n      case 'className':\r\n        const classFullNameParts = globalParts[0].split('.');\r\n        const className = classFullNameParts[classFullNameParts.length - 1];\r\n        return className;\r\n    }\r\n\r\n    return input;\r\n  }\r\n\r\n  /** Save the current query and reload entire definition as returned from server */\r\n  savePipeline(pipelineModel: PipelineModel) {\r\n    const pipeline = pipelineModel.Pipeline;\r\n    const dataSources = pipelineModel.DataSources;\r\n    const pipelineModel$ = this.http.post(\r\n      this.dnnContext.$2sxc.http.apiUrl('eav/PipelineDesigner/SavePipeline'),\r\n      { pipeline, dataSources },\r\n      { params: { appId: this.context.appId.toString(), Id: pipeline.EntityId.toString() } }\r\n    ) as Observable<PipelineModel>;\r\n\r\n    return pipelineModel$.pipe(\r\n      map(pipeModel => {\r\n        this.fixPipelineDataSources(pipeModel.DataSources);\r\n        return pipeModel;\r\n      }),\r\n    );\r\n  }\r\n\r\n  runPipeline(id: number) {\r\n    return this.http.get(this.dnnContext.$2sxc.http.apiUrl('eav/PipelineDesigner/QueryPipeline'), {\r\n      params: { appId: this.context.appId.toString(), id: id.toString() }\r\n    }) as Observable<PipelineResult>;\r\n  }\r\n\r\n}\r\n","import { Injectable, ViewContainerRef, NgZone, OnDestroy } from '@angular/core';\r\nimport { Title } from '@angular/platform-browser';\r\nimport { Router, ActivatedRoute, NavigationEnd } from '@angular/router';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { BehaviorSubject, Subscription, fromEvent, Subject } from 'rxjs';\r\nimport { filter, startWith, map, pairwise } from 'rxjs/operators';\r\nimport cloneDeep from 'lodash-es/cloneDeep';\r\n\r\nimport { PipelineModel, PipelineDataSource, StreamWire, VisualDesignerData } from '../models/pipeline.model';\r\nimport { QueryDefinitionService } from './query-definition.service';\r\nimport { DataSource, DataSourceMetadata } from '../models/data-sources.model';\r\nimport { EditForm } from '../../shared/models/edit-form.model';\r\nimport { convertFormToUrl } from '../../shared/helpers/url-prep.helper';\r\nimport { QueryResultDialogData } from '../query-result/query-result.models';\r\nimport { QueryResultComponent } from '../query-result/query-result.component';\r\nimport { eavConstants } from '../../shared/constants/eav.constants';\r\nimport { MetadataService } from '../../permissions/services/metadata.service';\r\nimport { ContentTypesService } from '../../app-administration/services/content-types.service';\r\nimport { PipelineResult } from '../models/pipeline-result.model';\r\n\r\n@Injectable()\r\nexport class VisualQueryService implements OnDestroy {\r\n  pipelineModel$ = new BehaviorSubject<PipelineModel>(null);\r\n  dataSources$ = new BehaviorSubject<DataSource[]>(null);\r\n  putEntityCountOnConnections$ = new Subject<PipelineResult>();\r\n\r\n  private pipelineId = parseInt(this.route.snapshot.paramMap.get('pipelineId'), 10);\r\n  private doRefresh = false;\r\n  private subscription = new Subscription();\r\n\r\n  constructor(\r\n    private router: Router,\r\n    private route: ActivatedRoute,\r\n    private queryDefinitionService: QueryDefinitionService,\r\n    private titleService: Title,\r\n    private snackBar: MatSnackBar,\r\n    private dialog: MatDialog,\r\n    private viewContainerRef: ViewContainerRef,\r\n    private zone: NgZone,\r\n    private metadataService: MetadataService,\r\n    private contentTypesService: ContentTypesService,\r\n  ) { }\r\n\r\n  ngOnDestroy() {\r\n    this.pipelineModel$.complete();\r\n    this.dataSources$.complete();\r\n    this.putEntityCountOnConnections$.complete();\r\n    this.subscription.unsubscribe();\r\n  }\r\n\r\n  init() {\r\n    this.fetchPipeline();\r\n    this.fetchDataSources();\r\n    this.attachKeyboardSave();\r\n    this.refreshOnChildClosed();\r\n  }\r\n\r\n  editPipelineEntity() {\r\n    // save Pipeline, then open Edit Dialog\r\n    this.savePipeline(() => {\r\n      const form: EditForm = {\r\n        items: [{ EntityId: this.pipelineModel$.value.Pipeline.EntityId }],\r\n      };\r\n      const formUrl = convertFormToUrl(form);\r\n      this.doRefresh = true;\r\n      this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route });\r\n    });\r\n  }\r\n\r\n  saveAndRun(save: boolean, run: boolean) {\r\n    if (save && run) {\r\n      this.savePipeline(() => { this.runPipeline(); });\r\n    } else if (save) {\r\n      this.savePipeline();\r\n    } else if (run) {\r\n      this.runPipeline();\r\n    }\r\n  }\r\n\r\n  addDataSource(dataSource: DataSource) {\r\n    const pipelineModel = cloneDeep(this.pipelineModel$.value);\r\n    const newPipelineDataSource: PipelineDataSource = {\r\n      Description: '',\r\n      EntityGuid: 'unsaved' + (pipelineModel.DataSources.length + 1),\r\n      EntityId: undefined,\r\n      Name: this.queryDefinitionService.typeNameFilter(dataSource.PartAssemblyAndType, 'className'),\r\n      PartAssemblyAndType: dataSource.PartAssemblyAndType,\r\n      VisualDesignerData: { Top: 100, Left: 100 },\r\n    };\r\n    pipelineModel.DataSources.push(newPipelineDataSource);\r\n    this.pipelineModel$.next(pipelineModel);\r\n    this.savePipeline();\r\n  }\r\n\r\n  removeDataSource(pipelineDataSourceGuid: string, connections: StreamWire[], streamsOut: string) {\r\n    const pipelineModel = cloneDeep(this.pipelineModel$.value);\r\n    pipelineModel.DataSources = pipelineModel.DataSources.filter(pipelineDS => pipelineDS.EntityGuid !== pipelineDataSourceGuid);\r\n    pipelineModel.Pipeline.StreamWiring = connections;\r\n    pipelineModel.Pipeline.StreamsOut = streamsOut;\r\n    this.pipelineModel$.next(pipelineModel);\r\n  }\r\n\r\n  renameDataSource(pipelineDataSourceGuid: string, name: string) {\r\n    const pipelineModel = cloneDeep(this.pipelineModel$.value);\r\n    const pipelineDataSource = pipelineModel.DataSources.find(pipelineDS => pipelineDS.EntityGuid === pipelineDataSourceGuid);\r\n    pipelineDataSource.Name = name;\r\n    this.pipelineModel$.next(pipelineModel);\r\n  }\r\n\r\n  changeDataSourceDescription(pipelineDataSourceGuid: string, description: string) {\r\n    const pipelineModel = cloneDeep(this.pipelineModel$.value);\r\n    const pipelineDataSource = pipelineModel.DataSources.find(pipelineDS => pipelineDS.EntityGuid === pipelineDataSourceGuid);\r\n    pipelineDataSource.Description = description;\r\n    this.pipelineModel$.next(pipelineModel);\r\n  }\r\n\r\n  changeConnections(connections: StreamWire[], streamsOut: string) {\r\n    const pipelineModel = cloneDeep(this.pipelineModel$.value);\r\n    pipelineModel.Pipeline.StreamWiring = connections;\r\n    pipelineModel.Pipeline.StreamsOut = streamsOut;\r\n    this.pipelineModel$.next(pipelineModel);\r\n  }\r\n\r\n  changeDataSourcePosition(pipelineDataSourceGuid: string, position: VisualDesignerData) {\r\n    const pipelineModel = cloneDeep(this.pipelineModel$.value);\r\n    const pipelineDataSource = pipelineModel.DataSources.find(pipelineDS => pipelineDS.EntityGuid === pipelineDataSourceGuid);\r\n    pipelineDataSource.VisualDesignerData = { ...pipelineDataSource.VisualDesignerData, ...position };\r\n    this.pipelineModel$.next(pipelineModel);\r\n  }\r\n\r\n  editDataSource(pipelineDataSource: PipelineDataSource) {\r\n    const dataSource = this.dataSources$.value.find(ds => ds.PartAssemblyAndType === pipelineDataSource.PartAssemblyAndType);\r\n\r\n    const contentTypeName = dataSource?.ContentType\r\n      ? dataSource.ContentType\r\n      : '|Config ' + this.queryDefinitionService.typeNameFilter(pipelineDataSource.PartAssemblyAndType, 'classFullName');\r\n\r\n    const typeId = eavConstants.metadata.entity.type;\r\n    const keyType = eavConstants.keyTypes.guid;\r\n    const key = pipelineDataSource.EntityGuid;\r\n\r\n    // Query for existing Entity\r\n    this.metadataService.getMetadata(typeId, keyType, key, contentTypeName).subscribe((metadata: DataSourceMetadata[]) => {\r\n      // Edit existing Entity\r\n      if (metadata.length) {\r\n        const form: EditForm = {\r\n          items: [{ EntityId: metadata[0].Id }],\r\n        };\r\n        const formUrl = convertFormToUrl(form);\r\n        this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route });\r\n        return;\r\n      }\r\n\r\n      // Check if the type exists, and if yes, create new Entity\r\n      this.contentTypesService.getDetails(contentTypeName, { ignoreErrors: 'true' }).subscribe({\r\n        next: contentType => {\r\n          const form: EditForm = {\r\n            items: [{\r\n              ContentTypeName: contentTypeName,\r\n              For: {\r\n                Target: eavConstants.metadata.entity.target,\r\n                Guid: key,\r\n              }\r\n            }],\r\n          };\r\n          const formUrl = convertFormToUrl(form);\r\n          this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route });\r\n        },\r\n        error: error => {\r\n          alert('Server reports error - this usually means that this data-source doesn\\'t have any configuration');\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  private savePipeline(callback?: () => void) {\r\n    this.snackBar.open('Saving...');\r\n    this.queryDefinitionService.savePipeline(this.pipelineModel$.value).subscribe({\r\n      next: pipelineModel => {\r\n        this.snackBar.open('Saved', null, { duration: 2000 });\r\n        this.pipelineModel$.next(pipelineModel);\r\n        if (callback != null) { callback(); }\r\n      },\r\n      error: error => {\r\n        this.snackBar.open('Save Pipeline failed', null, { duration: 2000 });\r\n      }\r\n    });\r\n  }\r\n\r\n  private runPipeline() {\r\n    this.snackBar.open('Running query...');\r\n    this.queryDefinitionService.runPipeline(this.pipelineModel$.value.Pipeline.EntityId).subscribe({\r\n      next: pipelineResult => {\r\n        this.snackBar.open('Query worked', null, { duration: 2000 });\r\n        // open modal with the results\r\n        const dialogData: QueryResultDialogData = {\r\n          testParameters: this.pipelineModel$.value.Pipeline.TestParameters,\r\n          result: pipelineResult,\r\n        };\r\n        this.dialog.open(QueryResultComponent, {\r\n          data: dialogData,\r\n          backdropClass: 'dialog-backdrop',\r\n          panelClass: ['dialog-panel', `dialog-panel-medium`, 'no-scrollbar'],\r\n          viewContainerRef: this.viewContainerRef,\r\n          autoFocus: false,\r\n          closeOnNavigation: false,\r\n          // spm NOTE: used to force align-items: flex-start; on cdk-global-overlay-wrapper.\r\n          // Real top margin is overwritten in css e.g. dialog-panel-large\r\n          position: { top: '0' },\r\n        });\r\n        console.warn(pipelineResult);\r\n        setTimeout(() => { this.putEntityCountOnConnections$.next(pipelineResult); });\r\n      },\r\n      error: error => {\r\n        this.snackBar.open('Query failed', null, { duration: 2000 });\r\n      }\r\n    });\r\n  }\r\n\r\n  private fetchPipeline(reloadingSnackBar = false) {\r\n    if (reloadingSnackBar) {\r\n      this.snackBar.open('Reloading query, please wait...');\r\n    }\r\n    this.queryDefinitionService.fetchPipeline(this.pipelineId).subscribe(pipelineModel => {\r\n      if (reloadingSnackBar) {\r\n        this.snackBar.open('Query reloaded', null, { duration: 2000 });\r\n      }\r\n      this.pipelineModel$.next(pipelineModel);\r\n      this.titleService.setTitle(`${pipelineModel.Pipeline.Name} - Visual Query`);\r\n    });\r\n  }\r\n\r\n  private fetchDataSources() {\r\n    this.queryDefinitionService.fetchDataSources().subscribe(dataSources => {\r\n      this.dataSources$.next(dataSources);\r\n    });\r\n  }\r\n\r\n  private attachKeyboardSave() {\r\n    this.zone.runOutsideAngular(() => {\r\n      this.subscription.add(\r\n        fromEvent(window, 'keydown').pipe(\r\n          filter(() => !this.route.snapshot.firstChild),\r\n          filter((event: KeyboardEvent) => {\r\n            const CTRL_S = (navigator.platform.match('Mac') ? event.metaKey : event.ctrlKey) && event.keyCode === 83;\r\n            return CTRL_S;\r\n          }),\r\n        ).subscribe(event => {\r\n          event.preventDefault();\r\n          this.zone.run(() => { this.savePipeline(); });\r\n        })\r\n      );\r\n    });\r\n  }\r\n\r\n  private refreshOnChildClosed() {\r\n    this.subscription.add(\r\n      this.router.events.pipe(\r\n        filter(event => event instanceof NavigationEnd),\r\n        startWith(!!this.route.snapshot.firstChild),\r\n        map(() => !!this.route.snapshot.firstChild),\r\n        pairwise(),\r\n        filter(([hadChild, hasChild]) => hadChild && !hasChild),\r\n        filter(() => {\r\n          const refresh = this.doRefresh;\r\n          this.doRefresh = false;\r\n          return refresh;\r\n        }),\r\n      ).subscribe(() => {\r\n        this.fetchPipeline(true);\r\n      })\r\n    );\r\n  }\r\n\r\n}\r\n","<div #domRoot id=\"pipeline-root\" *ngIf=\"(templateModel$ | async) as templateModel\">\r\n  <!-- do not use trackBy, jsPlumb drag stops working properly after delete -->\r\n  <ng-container *ngIf=\"!hardReset\">\r\n    <div #domDataSource *ngFor=\"let dataSource of templateModel.pipelineDataSources\"\r\n      [id]=\"dataSrcIdPrefix + dataSource.EntityGuid\" class=\"dataSource\" [ngStyle]=\"{\r\n        'top': dataSource.VisualDesignerData.Top + 'px',\r\n        'left': dataSource.VisualDesignerData.Left + 'px',\r\n        'min-width': dataSource.VisualDesignerData.Width ? dataSource.VisualDesignerData.Width + 'px' : null\r\n      }\">\r\n\r\n      <div class=\"configure\" title=\"Configure data source\" appMousedownStopPropagation\r\n        *ngIf=\"templateModel.allowEdit && templateModel.typeInfos[dataSource.EntityGuid].config\"\r\n        (click)=\"configureDataSource(dataSource)\">\r\n        <mat-icon class=\"eav-icon-settings\">settings</mat-icon>\r\n      </div>\r\n\r\n      <mat-icon class=\"type-info\" [title]=\"templateModel.typeInfos[dataSource.EntityGuid].notes\">\r\n        {{ templateModel.typeInfos[dataSource.EntityGuid].icon }}\r\n      </mat-icon>\r\n\r\n      <div class=\"name noselect\" title=\"Click to edit name\" appMousedownStopPropagation\r\n        (click)=\"templateModel.allowEdit && editName(dataSource)\">\r\n        <span>{{ dataSource.Name || '(no name)' }}</span>\r\n        <mat-icon class=\"show-hover-inline eav-icon-pencil\">edit</mat-icon>\r\n      </div>\r\n      <br />\r\n\r\n      <div class=\"description noselect\" title=\"Click to edit description\" appMousedownStopPropagation\r\n        (click)=\"templateModel.allowEdit && editDescription(dataSource)\">\r\n        <span>{{ dataSource.Description }}</span>\r\n        <mat-icon class=\"show-hover-inline eav-icon-pencil\">edit</mat-icon>\r\n      </div>\r\n      <br />\r\n\r\n      <div class=\"typename\" [title]=\"dataSource.PartAssemblyAndType\">\r\n        Type: {{ typeNameFilter(dataSource.PartAssemblyAndType, 'className') }}\r\n      </div>\r\n\r\n      <div class=\"add-endpoint\" title=\"Drag a new Out-Connection\"\r\n        *ngIf=\"templateModel.allowEdit && templateModel.typeInfos[dataSource.EntityGuid].dynamicOut\">\r\n        <mat-icon class=\"new-connection eav-icon-up-dir\">arrow_drop_up</mat-icon>\r\n      </div>\r\n\r\n      <mat-icon class=\"delete eav-icon-cancel\" title=\"Delete\" appMousedownStopPropagation\r\n        *ngIf=\"templateModel.allowEdit\" (click)=\"remove(dataSource)\">\r\n        delete\r\n      </mat-icon>\r\n\r\n      <a class=\"help eav-icon-help-circled\" title=\"Help for this data source\"\r\n        [href]=\"templateModel.typeInfos[dataSource.EntityGuid].helpLink\" target=\"_blank\" appMousedownStopPropagation\r\n        *ngIf=\"templateModel.typeInfos[dataSource.EntityGuid].helpLink\">\r\n        <mat-icon>help_outline</mat-icon>\r\n      </a>\r\n    </div>\r\n  </ng-container>\r\n</div>\r\n","// tslint:disable-next-line:max-line-length\r\nimport { Component, OnInit, AfterViewInit, ViewChildren, QueryList, ElementRef, ChangeDetectionStrategy, ViewChild, OnDestroy, ChangeDetectorRef } from '@angular/core';\r\nimport { Subscription, combineLatest, BehaviorSubject, Observable } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\n\r\nimport { QueryDefinitionService } from '../services/query-definition.service';\r\nimport { PipelineDataSource, VisualDesignerData } from '../models/pipeline.model';\r\nimport { loadScripts } from '../../shared/helpers/load-scripts.helper';\r\nimport { PlumbEditorTemplateModel } from './plumb-editor.models';\r\nimport { Plumber, dataSrcIdPrefix } from './plumber.helper';\r\nimport { VisualQueryService } from '../services/visual-query.service';\r\nimport { calculateTypeInfos } from './plumb-editor.helpers';\r\n\r\nconst jsPlumbUrl = 'https://cdnjs.cloudflare.com/ajax/libs/jsPlumb/2.14.5/js/jsplumb.min.js';\r\n\r\n@Component({\r\n  selector: 'app-plumb-editor',\r\n  templateUrl: './plumb-editor.component.html',\r\n  styles: [':host { display: block; width: 100%; height: 100%; }'],\r\n  styleUrls: ['./plumb-editor.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class PlumbEditorComponent implements OnInit, AfterViewInit, OnDestroy {\r\n  @ViewChild('domRoot') private domRootRef: ElementRef<HTMLDivElement>;\r\n  @ViewChildren('domDataSource') private domDataSourcesRef: QueryList<ElementRef<HTMLDivElement>>;\r\n\r\n  dataSrcIdPrefix = dataSrcIdPrefix;\r\n  templateModel$: Observable<PlumbEditorTemplateModel>;\r\n  hardReset = false;\r\n\r\n  private plumber: Plumber;\r\n  private scriptLoaded$ = new BehaviorSubject(false);\r\n  private subscription = new Subscription();\r\n  private plumbInits = 0;\r\n\r\n  constructor(\r\n    private visualQueryService: VisualQueryService,\r\n    private queryDefinitionService: QueryDefinitionService,\r\n    private cd: ChangeDetectorRef,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    loadScripts([{ test: 'jsPlumb', src: jsPlumbUrl }], () => {\r\n      this.scriptLoaded$.next(true);\r\n    });\r\n\r\n    this.subscription.add(\r\n      this.visualQueryService.putEntityCountOnConnections$.subscribe(result => {\r\n        this.plumber.putEntityCountOnConnections(result);\r\n      })\r\n    );\r\n\r\n    this.templateModel$ = combineLatest([this.visualQueryService.pipelineModel$, this.visualQueryService.dataSources$]).pipe(\r\n      map(([pipelineModel, dataSources]) => {\r\n        if (pipelineModel == null || dataSources == null) { return; }\r\n\r\n        // workaround for jsPlumb not working with dom elements which it initialized on previously.\r\n        // This wipes dom entirely and gives us new elements\r\n        this.hardReset = true;\r\n        this.cd.detectChanges();\r\n        this.hardReset = false;\r\n        const templateModel: PlumbEditorTemplateModel = {\r\n          pipelineDataSources: pipelineModel.DataSources,\r\n          typeInfos: calculateTypeInfos(pipelineModel.DataSources, dataSources),\r\n          allowEdit: pipelineModel.Pipeline.AllowEdit,\r\n        };\r\n        return templateModel;\r\n      }),\r\n    );\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    // https://stackoverflow.com/questions/37087864/execute-a-function-when-ngfor-finished-in-angular-2/37088348#37088348\r\n    const domDataSourcesLoaded$ = this.domDataSourcesRef.changes.pipe(map(() => true));\r\n\r\n    this.subscription.add(\r\n      combineLatest([this.scriptLoaded$, domDataSourcesLoaded$]).subscribe(([scriptLoaded, domDataSourcesLoaded]) => {\r\n        if (!scriptLoaded || !domDataSourcesLoaded) { return; }\r\n\r\n        this.plumber?.destroy();\r\n        this.plumber = new Plumber(\r\n          this.domRootRef.nativeElement,\r\n          this.visualQueryService.pipelineModel$.value,\r\n          this.visualQueryService.dataSources$.value,\r\n          this.onConnectionsChanged.bind(this),\r\n          this.onDragend.bind(this),\r\n          ++this.plumbInits,\r\n        );\r\n      })\r\n    );\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.plumber?.destroy();\r\n    this.scriptLoaded$.complete();\r\n    this.subscription.unsubscribe();\r\n  }\r\n\r\n  onConnectionsChanged() {\r\n    const connections = this.plumber.getAllConnections();\r\n    const streamsOut = this.plumber.getStreamsOut();\r\n    this.visualQueryService.changeConnections(connections, streamsOut);\r\n  }\r\n\r\n  onDragend(pipelineDataSourceGuid: string, position: VisualDesignerData) {\r\n    this.visualQueryService.changeDataSourcePosition(pipelineDataSourceGuid, position);\r\n  }\r\n\r\n  configureDataSource(dataSource: PipelineDataSource) {\r\n    // ensure dataSource entity is saved\r\n    if (dataSource.EntityGuid.includes('unsaved')) {\r\n      this.visualQueryService.saveAndRun(true, false);\r\n    } else {\r\n      this.visualQueryService.editDataSource(dataSource);\r\n    }\r\n  }\r\n\r\n  typeNameFilter(input: string, format: string) {\r\n    const filtered = this.queryDefinitionService.typeNameFilter(input, format);\r\n    return filtered;\r\n  }\r\n\r\n  remove(pipelineDataSource: PipelineDataSource) {\r\n    if (!confirm(`Delete ${pipelineDataSource.Name} data source?`)) { return; }\r\n\r\n    this.plumber.removeEndpointsOnDataSource(pipelineDataSource.EntityGuid);\r\n    const connections = this.plumber.getAllConnections();\r\n    const streamsOut = this.plumber.getStreamsOut();\r\n    this.visualQueryService.removeDataSource(pipelineDataSource.EntityGuid, connections, streamsOut);\r\n  }\r\n\r\n  editName(dataSource: PipelineDataSource) {\r\n    const newName = prompt('Rename data source', dataSource.Name)?.trim();\r\n    if (newName == null || newName === '') { return; }\r\n\r\n    this.visualQueryService.renameDataSource(dataSource.EntityGuid, newName);\r\n  }\r\n\r\n  editDescription(dataSource: PipelineDataSource) {\r\n    const newDescription = prompt('Edit description', dataSource.Description)?.trim();\r\n    if (newDescription == null) { return; }\r\n\r\n    this.visualQueryService.changeDataSourceDescription(dataSource.EntityGuid, newDescription);\r\n  }\r\n\r\n}\r\n","<div class=\"editor-active-explorer fancy-scrollbar-dark\" *ngIf=\"(pipelineModel$ | async) as pipelineModel\">\r\n\r\n  <div class=\"wrapper\">\r\n    <div class=\"actions\">\r\n      <button mat-raised-button class=\"action\" color=\"accent\" (click)=\"saveAndRunQuery(true, true)\">\r\n        Save and run\r\n      </button>\r\n      <button mat-raised-button class=\"action\" (click)=\"saveAndRunQuery(false, true)\">\r\n        Run\r\n      </button>\r\n      <button mat-raised-button class=\"action\" (click)=\"saveAndRunQuery(true, false)\">\r\n        Save\r\n      </button>\r\n    </div>\r\n\r\n    <div class=\"parameters\">\r\n      <div class=\"title\">\r\n        <div>Parameters</div>\r\n        <div>\r\n          <button mat-icon-button matTooltip=\"Edit parameters\" (click)=\"editPipeline()\">\r\n            <mat-icon>edit</mat-icon>\r\n          </button>\r\n          <button mat-icon-button matTooltip=\"Query Params Docs\" (click)=\"openParamsHelp()\">\r\n            <mat-icon>info</mat-icon>\r\n          </button>\r\n        </div>\r\n      </div>\r\n      <ul class=\"values\" *ngIf=\"pipelineModel.Pipeline.Params?.length\">\r\n        <li *ngFor=\"let param of pipelineModel.Pipeline.Params?.split('\\n')\">\r\n          {{ param }}\r\n        </li>\r\n      </ul>\r\n    </div>\r\n\r\n    <div class=\"parameters\">\r\n      <div class=\"title\">Test Parameters</div>\r\n      <ul class=\"values\" *ngIf=\"pipelineModel.Pipeline.TestParameters?.length\">\r\n        <li *ngFor=\"let param of pipelineModel.Pipeline.TestParameters?.split('\\n')\">\r\n          {{ param }}\r\n        </li>\r\n      </ul>\r\n    </div>\r\n\r\n    <ng-container *ngIf=\"(warnings$ | async) as warnings\">\r\n      <div class=\"warnings\" *ngIf=\"warnings.length\">\r\n        <div class=\"title\">\r\n          <span>Warnings</span>\r\n          <mat-icon style=\"color: red\">warning</mat-icon>\r\n        </div>\r\n        <ol class=\"values\">\r\n          <li *ngFor=\"let warning of warnings\">\r\n            {{ warning }}\r\n          </li>\r\n        </ol>\r\n      </div>\r\n    </ng-container>\r\n\r\n    <div class=\"description\" *ngIf=\"pipelineModel.Pipeline.Description\">\r\n      <div class=\"title\">Query Description</div>\r\n      <div>{{ pipelineModel.Pipeline.Description }}</div>\r\n    </div>\r\n  </div>\r\n</div>\r\n","import { Component, OnInit, ChangeDetectionStrategy } from '@angular/core';\r\nimport { Observable } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\n\r\nimport { Context } from '../../shared/services/context';\r\nimport { calculateWarnings } from './run-explorer.helpers';\r\nimport { VisualQueryService } from '../services/visual-query.service';\r\nimport { PipelineModel } from '../models/pipeline.model';\r\n\r\n@Component({\r\n  selector: 'app-run-explorer',\r\n  templateUrl: './run-explorer.component.html',\r\n  styleUrls: ['./run-explorer.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class RunExplorerComponent implements OnInit {\r\n  pipelineModel$: Observable<PipelineModel>;\r\n  warnings$: Observable<string[]>;\r\n\r\n  constructor(private context: Context, private visualQueryService: VisualQueryService) { }\r\n\r\n  ngOnInit() {\r\n    this.pipelineModel$ = this.visualQueryService.pipelineModel$;\r\n    this.warnings$ = this.visualQueryService.pipelineModel$.pipe(\r\n      map(pipelineModel => calculateWarnings(pipelineModel, this.context)),\r\n    );\r\n  }\r\n\r\n  editPipeline() {\r\n    this.visualQueryService.editPipelineEntity();\r\n  }\r\n\r\n  openParamsHelp() {\r\n    window.open('https://r.2sxc.org/QueryParams', '_blank');\r\n  }\r\n\r\n  saveAndRunQuery(save: boolean, run: boolean) {\r\n    this.visualQueryService.saveAndRun(save, run);\r\n  }\r\n\r\n}\r\n","import { Context } from '../../shared/services/context';\r\nimport { PipelineModel } from '../models/pipeline.model';\r\n\r\n/**\r\n * Check if there are special warnings the developer should know.\r\n * Typically when the test-module-id is different from the one we're currently\r\n * working on, or if no test-module-id is provided\r\n */\r\nexport function calculateWarnings(pipelineModel: PipelineModel, context: Context) {\r\n  const warnings: string[] = [];\r\n\r\n  try { // catch various not-initialized errors\r\n    const regex = /^\\[module:moduleid\\]=([0-9]*)$/gmi; // capture the mod-id\r\n    const testParams = pipelineModel.Pipeline.TestParameters;\r\n    const matches = regex.exec(testParams);\r\n    const testMid = matches[1];\r\n    const urlMid = context.moduleId.toString();\r\n    if (testMid !== urlMid) {\r\n      warnings.push(`Your test moduleid (${testMid}) is different from the current moduleid (${urlMid}). Note that 2sxc 9.33 automatically provides the moduleid - so you usually do not need to set it any more.`);\r\n    }\r\n  } catch (error) { }\r\n\r\n  return warnings;\r\n}\r\n","<div class=\"editor-active-explorer fancy-scrollbar-dark\" *ngIf=\"(sorted$ | async) as sorted\">\r\n\r\n  <mat-slide-toggle labelPosition=\"before\" (change)=\"toggleDifficulty($event)\">\r\n    Show Advanced\r\n  </mat-slide-toggle>\r\n\r\n  <ng-container *ngFor=\"let item of sorted | keyvalue\">\r\n    <div class=\"collapsible\" [matTooltip]=\"item.key\" matTooltipShowDelay=\"750\" (click)=\"toggleItem(item.key)\">\r\n      <mat-icon>{{ toggledItems.includes(item.key) ? 'keyboard_arrow_down' : 'keyboard_arrow_right' }}</mat-icon>\r\n      <span>{{ item.key }}</span>\r\n    </div>\r\n\r\n    <div class=\"list\" *ngIf=\"toggledItems.includes(item.key)\">\r\n      <div class=\"list-item\" *ngFor=\"let value of item.value\" [matTooltip]=\"value.Name\" matTooltipShowDelay=\"750\"\r\n        (click)=\"addDataSource(value)\">\r\n        {{ value.Name }}\r\n      </div>\r\n    </div>\r\n  </ng-container>\r\n</div>\r\n","import { Component, OnInit, ChangeDetectionStrategy, OnDestroy } from '@angular/core';\r\nimport { MatSlideToggleChange } from '@angular/material/slide-toggle';\r\nimport { Observable, BehaviorSubject, combineLatest } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\n\r\nimport { filterAndSortDataSources, toggleInArray } from './add-explorer.helpers';\r\nimport { DataSource } from '../models/data-sources.model';\r\nimport { SortedDataSources } from '../models/data-sources.model';\r\nimport { VisualQueryService } from '../services/visual-query.service';\r\n\r\n@Component({\r\n  selector: 'app-add-explorer',\r\n  templateUrl: './add-explorer.component.html',\r\n  styleUrls: ['./add-explorer.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class AddExplorerComponent implements OnInit, OnDestroy {\r\n  sorted$: Observable<SortedDataSources>;\r\n  toggledItems: string[] = [];\r\n\r\n  private difficulties = {\r\n    default: 100,\r\n    advanced: 200,\r\n  };\r\n  private difficulty$ = new BehaviorSubject(this.difficulties.default);\r\n\r\n  constructor(private visualQueryService: VisualQueryService) { }\r\n\r\n  ngOnInit() {\r\n    this.sorted$ = combineLatest([this.visualQueryService.dataSources$, this.difficulty$]).pipe(\r\n      map(([dataSources, difficulty]) => {\r\n        if (dataSources == null) { return; }\r\n        const sorted = filterAndSortDataSources(dataSources, difficulty);\r\n        return sorted;\r\n      }),\r\n    );\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.difficulty$.complete();\r\n  }\r\n\r\n  toggleDifficulty(event: MatSlideToggleChange) {\r\n    const difficulty = event.checked ? this.difficulties.advanced : this.difficulties.default;\r\n    this.difficulty$.next(difficulty);\r\n  }\r\n\r\n  addDataSource(dataSource: DataSource) {\r\n    this.visualQueryService.addDataSource(dataSource);\r\n  }\r\n\r\n  toggleItem(item: string) {\r\n    toggleInArray(item, this.toggledItems);\r\n  }\r\n\r\n}\r\n","import cloneDeep from 'lodash-es/cloneDeep';\r\nimport { DataSource, SortedDataSources } from '../models/data-sources.model';\r\n\r\nexport function filterAndSortDataSources(dataSources: DataSource[], maxDifficulty: number) {\r\n  const cloned = cloneDeep(dataSources);\r\n\r\n  const filtered = cloned.filter(dataSource =>\r\n    (dataSource.Difficulty <= maxDifficulty) && (dataSource.allowNew == null)\r\n  );\r\n\r\n  filtered.sort((a, b) => a.Name.toLocaleLowerCase().localeCompare(b.Name.toLocaleLowerCase()));\r\n\r\n  const sorted: SortedDataSources = {};\r\n  for (const dataSource of filtered) {\r\n    const type = dataSource.PrimaryType;\r\n    sorted[type] ? sorted[type].push(dataSource) : sorted[type] = [dataSource];\r\n  }\r\n\r\n  return sorted;\r\n}\r\n\r\nexport function toggleInArray(item: string, array: string[]) {\r\n  const index = array.indexOf(item);\r\n  if (index === -1) {\r\n    array.push(item);\r\n  } else {\r\n    array.splice(index, 1);\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { VisualQueryComponent } from './visual-query.component';\r\nimport { edit } from '../../../../edit/edit.matcher';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '', component: VisualQueryComponent, children: [\r\n      {\r\n        matcher: edit,\r\n        loadChildren: () => import('../../../../edit/edit.module').then(m => m.EditModule)\r\n      },\r\n    ]\r\n  },\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class VisualQueryRoutingModule { }\r\n","import { Component, OnInit, ViewChild, ChangeDetectionStrategy } from '@angular/core';\r\nimport { ActivatedRoute } from '@angular/router';\r\n\r\nimport { Context } from '../shared/services/context';\r\nimport { PlumbEditorComponent } from './plumb-editor/plumb-editor.component';\r\nimport { VisualQueryService } from './services/visual-query.service';\r\n\r\n@Component({\r\n  selector: 'app-visual-query',\r\n  templateUrl: './visual-query.component.html',\r\n  styleUrls: ['./visual-query.component.scss'],\r\n  providers: [VisualQueryService],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class VisualQueryComponent implements OnInit {\r\n  @ViewChild(PlumbEditorComponent) plumbEditor: PlumbEditorComponent;\r\n\r\n  explorer = {\r\n    run: 'run',\r\n    add: 'add'\r\n  };\r\n  activeExplorer = this.explorer.run;\r\n\r\n  constructor(private context: Context, private route: ActivatedRoute, private visualQueryService: VisualQueryService) {\r\n    this.context.init(this.route);\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.visualQueryService.init();\r\n  }\r\n\r\n  toggleExplorer(explorer: string) {\r\n    this.activeExplorer = (this.activeExplorer === explorer) ? null : explorer;\r\n  }\r\n\r\n  openHelp() {\r\n    window.open('http://2sxc.org/help', '_blank');\r\n  }\r\n\r\n}\r\n","<router-outlet></router-outlet>\r\n\r\n<div class=\"editor-root\">\r\n  <div class=\"editor-side-toolbar\">\r\n    <div class=\"button\" matTooltip=\"Run\" [ngClass]=\"{ 'active': activeExplorer === explorer.run }\"\r\n      (click)=\"toggleExplorer(explorer.run)\">\r\n      <mat-icon>play_arrow</mat-icon>\r\n    </div>\r\n    <div class=\"button\" matTooltip=\"Add\" [ngClass]=\"{ 'active': activeExplorer === explorer.add }\"\r\n      (click)=\"toggleExplorer(explorer.add)\">\r\n      <mat-icon>add</mat-icon>\r\n    </div>\r\n    <div class=\"spacer\"></div>\r\n    <div class=\"button\" matTooltip=\"Help\" (click)=\"openHelp()\">\r\n      <mat-icon>help_outline</mat-icon>\r\n    </div>\r\n  </div>\r\n\r\n  <app-run-explorer [hidden]=\"activeExplorer !== explorer.run\"></app-run-explorer>\r\n\r\n  <app-add-explorer [hidden]=\"activeExplorer !== explorer.add\"></app-add-explorer>\r\n\r\n  <app-plumb-editor></app-plumb-editor>\r\n</div>\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatTooltipModule } from '@angular/material/tooltip';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatSlideToggleModule } from '@angular/material/slide-toggle';\r\nimport { MatSnackBarModule } from '@angular/material/snack-bar';\r\nimport { MatDialogModule } from '@angular/material/dialog';\r\n\r\nimport { VisualQueryRoutingModule } from './visual-query-routing.module';\r\nimport { VisualQueryComponent } from './visual-query.component';\r\nimport { Context } from '../shared/services/context';\r\nimport { QueryDefinitionService } from './services/query-definition.service';\r\nimport { RunExplorerComponent } from './run-explorer/run-explorer.component';\r\nimport { AddExplorerComponent } from './add-explorer/add-explorer.component';\r\nimport { PlumbEditorComponent } from './plumb-editor/plumb-editor.component';\r\nimport { MetadataService } from '../permissions/services/metadata.service';\r\nimport { ContentTypesService } from '../app-administration/services/content-types.service';\r\nimport { SharedComponentsModule } from '../shared/shared-components.module';\r\nimport { QueryResultComponent } from './query-result/query-result.component';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    VisualQueryComponent,\r\n    RunExplorerComponent,\r\n    AddExplorerComponent,\r\n    PlumbEditorComponent,\r\n    QueryResultComponent,\r\n  ],\r\n  entryComponents: [\r\n    VisualQueryComponent,\r\n    RunExplorerComponent,\r\n    AddExplorerComponent,\r\n    PlumbEditorComponent,\r\n    QueryResultComponent,\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    SharedComponentsModule,\r\n    VisualQueryRoutingModule,\r\n    MatIconModule,\r\n    MatTooltipModule,\r\n    MatButtonModule,\r\n    MatSlideToggleModule,\r\n    MatSnackBarModule,\r\n    MatDialogModule,\r\n  ],\r\n  providers: [\r\n    Context,\r\n    QueryDefinitionService,\r\n    MetadataService,\r\n    ContentTypesService,\r\n  ]\r\n})\r\nexport class VisualQueryModule { }\r\n"],"sourceRoot":"webpack:///"}