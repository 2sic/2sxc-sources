"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_content-type-fields_edit-content-type-fields_edit-content-type-fields-974b18"],{5604:(x,c,n)=>{n.r(c),n.d(c,{EditContentTypeFieldsComponent:()=>ot});var m=n(316),t=n(7580),p=n(4456),h=n(4175),E=n(4646),D=n(7941),T=n(4950),P=n(3840),I=n(7984),v=n(5175),S=n(852),r=n(9452),g=n(1567),u=n(1903),C=n(1318),M=n(3143),f=n(2938),B=n(7703),L=n(7693),A=n(3176),U=n(3758),$=n(8742),W=n(1726),N=n(4202),F=n(7993),b=n(4007),j=n(5160),K=n(2159),k=n(3347);const G=["ngForm"],V=["autoFocusInputField"],X=(o,_)=>_.SortOrder,Y=o=>({"eav-input-obsolete":o});function H(o,_){1&o&&t.EFF(0," Fields ")}function J(o,_){1&o&&t.EFF(0," Add Fields ")}function z(o,_){1&o&&t.EFF(0," Edit Field ")}function w(o,_){if(1&o&&(t.j41(0,"app-field-hint",20),t.EFF(1),t.k0s()),2&o){const e=t.XpG(4);t.Y8G("isError",!0),t.R7$(),t.JRh(e.fieldNameError)}}function Q(o,_){if(1&o&&(t.j41(0,"app-field-hint",20),t.EFF(1),t.k0s()),2&o){t.XpG(2);const e=t.sdS(6);t.Y8G("isError",!0),t.R7$(),t.SpI(" ",e.errors.reservedNames," ")}}function Z(o,_){if(1&o&&t.DNE(0,w,2,2,"app-field-hint",20)(1,Q,2,2,"app-field-hint",20),2&o){t.XpG();const e=t.sdS(6);t.vxM(e.errors.pattern?0:-1),t.R7$(),t.vxM(e.errors.reservedNames?1:-1)}}function q(o,_){if(1&o&&(t.j41(0,"mat-option",16),t.EFF(1),t.j41(2,"mat-icon",15),t.EFF(3),t.k0s()()),2&o){const e=_.$implicit;t.Y8G("value",e.name),t.R7$(),t.SpI(" ",e.label," "),t.R7$(2),t.JRh(e.icon)}}function tt(o,_){if(1&o&&(t.j41(0,"span")(1,"mat-icon",18),t.EFF(2),t.k0s()()),2&o){const e=t.XpG().$implicit;t.R7$(2),t.JRh(e.icon)}}function et(o,_){if(1&o&&(t.j41(0,"mat-option",19),t.EFF(1),t.DNE(2,tt,3,1,"span"),t.k0s()),2&o){const e=_.$implicit;t.Y8G("value",e.inputType)("ngClass",t.eq3(4,Y,e.isObsolete)),t.R7$(),t.SpI(" ",e.label," "),t.R7$(),t.vxM(e.icon?2:-1)}}function nt(o,_){if(1&o){const e=t.RV6();t.j41(0,"div",7)(1,"div",11)(2,"mat-form-field",12)(3,"mat-label"),t.EFF(4,"Name"),t.k0s(),t.j41(5,"input",13,1),t.mxI("ngModelChange",function(a){const s=t.eBV(e).$implicit;return t.DH7(s.StaticName,a)||(s.StaticName=a),t.Njj(a)}),t.k0s()(),t.DNE(8,Z,2,2),t.k0s(),t.j41(9,"div",11)(10,"mat-form-field",12)(11,"mat-label"),t.EFF(12,"Data Type"),t.k0s(),t.j41(13,"mat-select",14),t.bIt("selectionChange",function(a){const s=t.eBV(e).$index,l=t.XpG(2);return t.Njj(l.setFieldType(s,a.value))}),t.j41(14,"mat-select-trigger")(15,"mat-icon",15),t.EFF(16),t.k0s(),t.j41(17,"span"),t.EFF(18),t.k0s()(),t.Z7z(19,q,4,3,"mat-option",16,t.fX1),t.k0s()(),t.j41(21,"app-field-hint"),t.EFF(22),t.k0s()(),t.j41(23,"div",11)(24,"mat-form-field",12)(25,"mat-label"),t.EFF(26,"Input Type"),t.k0s(),t.j41(27,"mat-select",17),t.bIt("selectionChange",function(a){const s=t.eBV(e).$index,l=t.XpG(2);return t.Njj(l.updateFieldPart(s,{InputType:a.value}))}),t.j41(28,"mat-select-trigger")(29,"span"),t.EFF(30),t.k0s(),t.j41(31,"mat-icon",18),t.EFF(32),t.k0s()(),t.Z7z(33,et,3,6,"mat-option",19,t.fX1),t.k0s()(),t.j41(35,"app-field-hint"),t.EFF(36),t.k0s()()()}if(2&o){let e,i;const a=_.$implicit,s=_.$index,l=t.sdS(6),d=t.XpG(2);t.R7$(5),t.Y8G("pattern",d.fieldNamePattern)("appReservedNames",d.reservedNames()),t.R50("ngModel",a.StaticName),t.Y8G("name","StaticName"+s)("disabled","inputType"===d.editMode),t.R7$(3),t.vxM(l.touched&&l.errors?8:-1),t.R7$(5),t.Y8G("ngModel",a.Type)("name","Type"+s)("disabled",null!=d.editMode),t.R7$(3),t.JRh(d.findIcon(a.Type)),t.R7$(2),t.JRh(d.findLabel(a.Type)),t.R7$(),t.Dyx(d.dataTypes()),t.R7$(3),t.JRh(d.hints()[s].data),t.R7$(5),t.Y8G("ngModel",a.InputType)("name","InputType"+s)("disabled","name"===d.editMode),t.R7$(3),t.JRh(null==(e=d.getInputTypeOption(a.InputType))?null:e.label),t.R7$(2),t.JRh(null==(i=d.getInputTypeOption(a.InputType))?null:i.icon),t.R7$(),t.Dyx(d.inputTypeOptions()[s]),t.R7$(3),t.JRh(d.hints()[s].input)}}function it(o,_){if(1&o){const e=t.RV6();t.j41(0,"form",5,0),t.bIt("ngSubmit",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.save())}),t.j41(2,"div",6),t.Z7z(3,nt,37,18,"div",7,X),t.k0s(),t.j41(5,"mat-dialog-actions"),t.nrm(6,"div",8),t.j41(7,"button",9),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.dialog.close())}),t.EFF(8,"Cancel"),t.k0s(),t.j41(9,"button",10),t.EFF(10,"Save"),t.k0s()()()}if(2&o){const e=t.sdS(1),i=t.XpG();t.R7$(3),t.Dyx(i.fields()),t.R7$(6),t.Y8G("disabled",!e.form.valid||i.saving())}}let ot=(()=>{class o extends A.${#i;#t;constructor(e,i,a){super(),this.dialog=e,this.route=i,this.snackBar=a,this.hostClass="dialog-component",this.#i=(0,f.d)(L.g),this.#t=(0,f.d)($.h),this.fieldNamePattern=B.w,this.fieldNameError=B.s,this.findIcon=b.y,this.findLabel=b.D,this.editMode=this.route.snapshot.paramMap.get("editMode"),this.filteredInputTypeOptions=[],this.saving=(0,t.vPA)(!1),this.dataTypes=this.#t.dataTypes(),this.#e=this.#t.getInputTypes(),this.#n=this.#i.retrieveContentTypeSig(this.route.snapshot.paramMap.get("contentTypeStaticName"),null),this.existingFieldsLazy=(0,F.bo)("rawFields",()=>{const s=this.#n();return s?this.#t.getFieldsSig(s.NameId):(0,t.vPA)([])}),this.fields=(()=>{const s=(0,F.bo)("fields",()=>{const l=this.existingFieldsLazy()();if(null!=this.editMode){if(0===l.length)return[];const d=this.route.snapshot.paramMap.get("id"),R=d?parseInt(d,10):null;return[l.find(O=>O.Id===R)]}return this.#s(l.length)});return(0,t.uuI)({source:s,computation:l=>l})})(),this.#o=this.#t.reservedNames(),this.reservedNames=(0,F.bo)("reservedNamesAll",()=>{const s=this.existingFieldsLazy()(),l=this.#o();if(0===s.length)return l;const d=j.O.mergeReserved(l,s);return"name"===this.editMode&&delete d[s[0].StaticName],d}),this.inputTypeOptions=(0,F.bo)("inputTypeOptions",()=>{const s=this.#e();return this.fields().map((d,R)=>s.filter(y=>y.dataType===d.Type.toLocaleLowerCase()))}),this.hints=(0,F.bo)("hints",()=>this.fields().map((l,d)=>{const R=this.dataTypes().find(O=>O.name===l.Type),y=this.#e().find(O=>O.inputType===l.InputType);return{data:R?.description??"",input:y?.isObsolete?`OBSOLETE - ${y.obsoleteMessage}`:y?.description??""}})),this.dialog.disableClose=!0,this.subscriptions.add(this.dialog.backdropClick().subscribe(s=>{this.form.dirty&&!confirm("You have unsaved changes. Are you sure you want to close this dialog?")||this.dialog.close()}))}#e;#n;#o;ngAfterViewInit(){this.autoFocusInputField&&setTimeout(()=>this.autoFocusInputField.first?.nativeElement?.focus(),250)}#s(e){return[...Array(8).keys()].map(i=>({Id:0,Type:W.O.String,InputType:N.u.StringDefault,StaticName:"",IsTitle:0===e&&0===i,SortOrder:e+i+1}))}updateFieldPart(e,i){this.fields.update(a=>[...a].map((s,l)=>l!==e?s:{...s,...i}))}setFieldType(e,i){this.updateFieldPart(e,{Type:i});const a=i.toLocaleLowerCase()+N.u.DefaultSuffix,s=this.inputTypeOptions()[e],l=s.find(d=>d.inputType===a)?.inputType??s[0].inputType;this.updateFieldPart(e,{InputType:l})}getInputTypeOption(e){return this.#e().find(i=>i.inputType===e)}save(){this.saving.set(!0),this.snackBar.open("Saving...");const e=()=>{this.saving.set(!1),this.snackBar.open("Saved",null,{duration:2e3}),this.dialog.close()};if(null!=this.editMode){const i=this.fields()[0];"name"===this.editMode?this.#t.rename(i.Id,this.#n().Id,i.StaticName).subscribe(()=>e()):"inputType"===this.editMode&&this.#t.updateInputType(i.Id,i.StaticName,i.InputType).subscribe(()=>e())}else(0,r.of)(...this.fields()).pipe((0,g.p)(i=>!!i.StaticName),(0,u.H)(i=>this.#t.add(i,this.#n().Id).pipe((0,C.W)(a=>(0,r.of)(null)))),(0,M.$)()).subscribe(()=>e())}static{this.\u0275fac=function(i){return new(i||o)(t.rXU(D.CP),t.rXU(K.nX),t.rXU(k.UG))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["app-edit-content-type-fields"]],viewQuery:function(i,a){if(1&i&&(t.GBs(G,5,p.cV),t.GBs(V,5)),2&i){let s;t.mGM(s=t.lsd())&&(a.form=s.first),t.mGM(s=t.lsd())&&(a.autoFocusInputField=s)}},hostVars:1,hostBindings:function(i,a){2&i&&t.Mr5("className",a.hostClass)},features:[t.Vt3],decls:7,vars:4,consts:[["ngForm","ngForm"],["staticName","ngModel","autoFocusInputField",""],[1,"eav-dialog","eav-no-scrollbar"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[3,"ngSubmit"],[1,"eav-dialog-content"],[1,"eav-row-container"],[1,"spacer"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","submit","color","accent",3,"disabled"],[1,"eav-edit-input"],["color","accent",1,"eav-mat-form-field"],["matInput","",3,"ngModelChange","pattern","appReservedNames","ngModel","name","disabled"],["panelClass","eav-type-field-type-select","panelWidth","",3,"selectionChange","ngModel","name","disabled"],[1,"eav-type-icon"],[3,"value"],["panelClass","eav-type-field-input-type-select","panelWidth","",3,"selectionChange","ngModel","name","disabled"],[1,"eav-input-icon"],[3,"value","ngClass"],[3,"isError"]],template:function(i,a){1&i&&(t.j41(0,"div",2)(1,"div",3)(2,"div",4),t.DNE(3,H,1,0)(4,J,1,0)(5,z,1,0),t.k0s()(),t.DNE(6,it,11,1,"form"),t.k0s()),2&i&&(t.R7$(3),t.vxM(void 0===a.editMode?3:-1),t.R7$(),t.vxM(null===a.editMode?4:-1),t.R7$(),t.vxM(null!=a.editMode?5:-1),t.R7$(),t.vxM(a.fields().length?6:-1))},dependencies:[p.YN,p.qT,p.me,p.BC,p.cb,p.R_,p.vS,p.cV,T.RG,T.rl,T.nJ,I.fS,I.fg,j.O,v.Ve,v.VO,v.$2,E.wT,P.m_,P.An,E.Sy,m.YU,D.E7,h.Hl,h.$z,S.h,U.F],styles:[".eav-row-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.eav-edit-input[_ngcontent-%COMP%]{padding-bottom:8px;width:30%}.eav-type-icon[_ngcontent-%COMP%]{width:inherit;height:inherit;margin-right:8px;font-size:inherit;vertical-align:top;line-height:inherit}.eav-input-icon[_ngcontent-%COMP%]{width:inherit;height:inherit;margin-left:8px;font-size:inherit;vertical-align:top;line-height:inherit}.eav-input-obsolete[_ngcontent-%COMP%]{-webkit-text-decoration:black line-through;text-decoration:black line-through;color:#696969}  .mdc-menu-surface.mat-mdc-select-panel.eav-type-field-input-type-select,   .mdc-menu-surface.mat-mdc-select-panel.eav-type-field-type-select{max-height:500px}"]})}}return o})()},3758:(x,c,n)=>{n.d(c,{F:()=>S});var m=n(316),t=n(7580),p=n(4950);const h=["*"],E=r=>({"hint-box__short":r});function D(r,g){1&r&&t.eu8(0)}function T(r,g){if(1&r&&(t.j41(0,"mat-hint"),t.DNE(1,D,1,0,"ng-container",2),t.k0s()),2&r){t.XpG();const u=t.sdS(4);t.R7$(),t.Y8G("ngTemplateOutlet",u)}}function P(r,g){1&r&&t.eu8(0)}function I(r,g){if(1&r&&(t.j41(0,"mat-error"),t.DNE(1,P,1,0,"ng-container",2),t.k0s()),2&r){t.XpG();const u=t.sdS(4);t.R7$(),t.Y8G("ngTemplateOutlet",u)}}function v(r,g){1&r&&t.SdG(0)}let S=(()=>{class r{constructor(){this.isError=(0,t.hFB)(!1),this.isShort=!0}toggleIsShort(){this.isShort=!this.isShort}static{this.\u0275fac=function(C){return new(C||r)}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-field-hint"]],inputs:{isError:[1,"isError"]},ngContentSelectors:h,decls:5,vars:4,consts:[["content",""],[1,"hint-box",3,"click","ngClass"],[4,"ngTemplateOutlet"]],template:function(C,M){if(1&C){const f=t.RV6();t.NAR(),t.j41(0,"div",1),t.bIt("click",function(){return t.eBV(f),t.Njj(M.toggleIsShort())}),t.DNE(1,T,2,1,"mat-hint")(2,I,2,1,"mat-error"),t.k0s(),t.DNE(3,v,1,0,"ng-template",null,0,t.C5r)}if(2&C){let f;t.Y8G("ngClass",t.eq3(2,E,M.isShort)),t.R7$(),t.vxM(!1===(f=M.isError())?1:!0===f?2:-1)}},dependencies:[p.RG,p.MV,p.TL,m.YU,m.T3],styles:[".hint-box[_ngcontent-%COMP%]{margin-top:4px}.hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{font-size:12px;display:block}.hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]})}}return r})()},4202:(x,c,n)=>{n.d(c,{u:()=>m});const m={BooleanDefault:"boolean-default",BooleanTristate:"boolean-tristate",CustomDefault:"custom-default",CustomGps:"custom-gps",CustomJsonEditor:"custom-json-editor",DateTimeDefault:"datetime-default",DefaultSuffix:"-default",EmptyDefault:"empty-default",EmptyEnd:"empty-end",EmptyMessage:"empty-message",EntityContentBlocks:"entity-content-blocks",EntityDefault:"entity-default",EntityQuery:"entity-query",ExternalWebComponent:"external-web-component",HyperlinkDefault:"hyperlink-default",HyperlinkLibrary:"hyperlink-library",NumberDefault:"number-default",NumberDropdown:"number-dropdown",StringDefault:"string-default",StringDropdown:"string-dropdown",StringDropdownQuery:"string-dropdown-query",StringFontIconPicker:"string-font-icon-picker",StringJson:"string-json",StringTemplatePicker:"string-template-picker",StringUrlPath:"string-url-path",StringWysiwyg:"string-wysiwyg",EntityPicker:"entity-picker",StringPicker:"string-picker",NumberPicker:"number-picker",Unknown:"unknown"}},9923:(x,c,n)=>{n.d(c,{T:()=>p});var m=n(5392),t=n(819);function p(h,E){return(0,t.N)((0,m.S)(h,E,arguments.length>=2,!1,!0))}}}]);
//# sourceMappingURL=https://sources.2sxc.org/19.02.00/dist/ng-edit/projects_eav-ui_src_app_content-type-fields_edit-content-type-fields_edit-content-type-fields-974b18.5c186c0a18609981.js.map