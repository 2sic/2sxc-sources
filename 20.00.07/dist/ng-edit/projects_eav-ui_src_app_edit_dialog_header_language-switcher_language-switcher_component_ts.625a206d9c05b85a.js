"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_edit_dialog_header_language-switcher_language-switcher_component_ts"],{17870:(Q,S,l)=>{l.r(S),l.d(S,{LanguageSwitcherComponent:()=>W});var B=l(37580),T=l(64173),g=l(84175),u=l(93840),h=l(90852),L=l(7167),b=l(12938),p=l(34601),D=l(34435),R=l(8265),E=l(32093),C=l(9977),r=l(44444),d=l(81863),w=l(31016),v=l(64043),X=l(99277),F=l(32760);function y(i){const s=[],e={};return i.forEach(n=>{const o=_(n.Culture);e[o]?e[o]++:e[o]=1}),i.forEach(n=>{const o=_(n.Culture);s.push({...n,label:e[o]>1?`${o} (${n.NameId})`:o})}),s}function _(i){return i.substring(0,i.includes("(")?i.indexOf("(")-1:100).toLocaleUpperCase()}var t=l(99293),M=l(87698),k=l(23731);function I(i,s){if(1&i&&(t.j41(0,"mat-option",3),t.EFF(1),t.k0s()),2&i){const e=s.$implicit;t.Y8G("value",e.Code.toLocaleLowerCase()),t.R7$(),t.JRh(e.label)}}let O=(()=>{class i{constructor(){}get selectedValue(){return this.userLanguageSvc.isForced(this.optionType)?this.userLanguageSvc.value(this.optionType):this.userLanguageSvc.stored(this.optionType)}onSelectionChange(e){this.userLanguageSvc.save(this.optionType,e.value)}static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275cmp=t.VBU({type:i,selectors:[["app-language-dropdown"]],inputs:{label:"label",tooltip:"tooltip",optionType:"optionType",options:"options",userLanguageSvc:"userLanguageSvc"},decls:11,vars:12,consts:[["appearance","fill","color","accent",3,"tippy"],[3,"selectionChange","value","disabled"],["value",""],[3,"value"]],template:function(n,o){1&n&&(t.j41(0,"mat-form-field",0),t.nI1(1,"translate"),t.j41(2,"mat-label"),t.EFF(3),t.nI1(4,"translate"),t.k0s(),t.j41(5,"mat-select",1),t.bIt("selectionChange",function(c){return o.onSelectionChange(c)}),t.j41(6,"mat-option",2),t.EFF(7),t.nI1(8,"translate"),t.k0s(),t.Z7z(9,I,2,2,"mat-option",3,t.fX1),t.k0s()()),2&n&&(t.Y8G("tippy",t.bMT(1,6,o.tooltip)),t.R7$(3),t.Lme(" ",t.bMT(4,8,o.label)," ",o.userLanguageSvc.isForced(o.optionType)?"(disabled)":""," "),t.R7$(2),t.Y8G("value",o.selectedValue)("disabled",o.userLanguageSvc.isForced(o.optionType)),t.R7$(2),t.SpI(" ",t.bMT(8,10,"LanguageSettings.UseCurrentLanguage")," "),t.R7$(2),t.Dyx(o.options))},dependencies:[w.M,M.j,M.M,d.l,u.m_,g.Hl,p.e,v.M,v.g,k.M,h.h,h.D9],encapsulation:2})}return i})();var P=l(88622);let j=(()=>{class i{#t;constructor(){this.#t=(0,r.WQX)(C.g),this.userLanguageSvc=(0,b.d)(L.L),this.dialog=(0,r.WQX)(d.k),this.options=y(this.#t.getAll())}ngOnInit(){this.#e()}closeDialog(){this.dialog.close()}#e(){this.dialog.keydownEvents().subscribe(e=>{(0,F.YU)(e)&&(e.preventDefault(),this.closeDialog())})}static#n=this.\u0275fac=function(n){return new(n||i)};static#o=this.\u0275cmp=t.VBU({type:i,selectors:[["app-separate-languages-header"]],decls:19,vars:19,consts:[[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"eav-dialog-content"],[2,"margin-right","24px",3,"label","tooltip","optionType","options","userLanguageSvc"],[3,"label","tooltip","optionType","options","userLanguageSvc"],["align","end"],[3,"action"]],template:function(n,o){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.EFF(3),t.nI1(4,"translate"),t.k0s(),t.j41(5,"button",3),t.bIt("click",function(){return o.closeDialog()}),t.j41(6,"mat-icon"),t.EFF(7,"close"),t.k0s()()(),t.j41(8,"div",4)(9,"p"),t.EFF(10),t.nI1(11,"translate"),t.k0s(),t.j41(12,"h3"),t.EFF(13),t.nI1(14,"translate"),t.k0s(),t.nrm(15,"app-language-dropdown",5)(16,"app-language-dropdown",6),t.k0s(),t.j41(17,"mat-dialog-actions",7)(18,"app-save-close-button-fab",8),t.bIt("action",function(){return o.closeDialog()}),t.k0s()()()),2&n&&(t.R7$(3),t.JRh(t.bMT(4,13,"LanguageSettings.Title")),t.R7$(7),t.JRh(t.bMT(11,15,"LanguageSettings.Intro")),t.R7$(3),t.JRh(t.bMT(14,17,"LanguageSettings.Subtitle")),t.R7$(2),t.Y8G("label","LanguageSettings.LabelsAndTextsOptionLabel")("tooltip","LanguageSettings.LabelsAndTextsTooltip")("optionType","form")("options",o.options)("userLanguageSvc",o.userLanguageSvc),t.R7$(),t.Y8G("label","LanguageSettings.ButtonsAndControlsOptionLabel")("tooltip","LanguageSettings.ButtonsAndControlsTooltip")("optionType","ui")("options",o.options)("userLanguageSvc",o.userLanguageSvc))},dependencies:[d.l,d.M,u.m_,u.An,g.Hl,P.M,p.e,w.M,v.M,O,h.h,h.D9,X.i],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}"]})}return i})();class G{constructor(s,e){this.ngZone=s,this.header=e,this.moveThreshold=2,this.stopClick=!1,this.eventListeners=[],this.ngZone.runOutsideAngular(()=>{const n=o=>{this.checkIfMouseMoved(o)};document.addEventListener("mouseup",n,{passive:!0}),this.eventListeners.push({element:document,type:"mouseup",listener:n})})}lngButtonDown(s){this.ngZone.runOutsideAngular(()=>{this.saveInitialPosition(s)})}lngButtonClick(s){this.ngZone.runOutsideAngular(()=>{this.doMove(s)})}stopClickIfMouseMoved(){return this.stopClick}destroy(){this.ngZone.runOutsideAngular(()=>{this.eventListeners.forEach(({element:s,type:e,listener:n})=>{s.removeEventListener(e,n)}),this.eventListeners=null})}saveInitialPosition(s){this.stopClick=!1,this.positionX=s.pageX,this.positionY=s.pageY}checkIfMouseMoved(s){this.positionX&&this.positionY?(this.stopClick=Math.abs(this.positionX+this.positionY-(s.pageX+s.pageY))>this.moveThreshold,this.positionX=null,this.positionY=null):this.stopClick=!1}doMove(s){if(this.stopClick)return;const e=s.target,n=e.getBoundingClientRect().left,o=e.getBoundingClientRect().width,a=this.header.getBoundingClientRect().left,c=this.header.getBoundingClientRect().width;this.header.scrollLeft+=n+o/2-(a+c/2)}}class ${constructor(s,e,n){this.ngZone=s,this.header=e,this.areButtonsDisabled=n,this.eventListeners=[],this.ngZone.runOutsideAngular(()=>{const o=this.registerScroll.bind(this);this.header.addEventListener("pointerdown",o,{passive:!0}),this.headerDownListener={element:this.header,type:"pointerdown",listener:o}})}destroy(){this.ngZone.runOutsideAngular(()=>{this.headerDownListener.element.removeEventListener(this.headerDownListener.type,this.headerDownListener.listener),this.headerDownListener=null,this.eventListeners.forEach(({element:s,type:e,listener:n})=>{s.removeEventListener(e,n)}),this.eventListeners=null}),this.ngZone=null,this.header=null,this.areButtonsDisabled=null}registerScroll(s){if(this.areButtonsDisabled()||0!==s.button)return;window.getSelection().removeAllRanges(),this.oldScrollBehavior=getComputedStyle(this.header).getPropertyValue("scroll-behavior"),this.header.style.scrollBehavior="auto",this.positionX=s.pageX;const n=a=>{this.doScroll(a)},o=()=>{this.removeScroll()};document.addEventListener("pointermove",n,{passive:!0}),document.addEventListener("pointerup",o,{passive:!0}),document.addEventListener("pointerleave",o,{passive:!0}),this.eventListeners.push({element:document,type:"pointermove",listener:n},{element:document,type:"pointerup",listener:o},{element:document,type:"pointerleave",listener:o})}removeScroll(){this.header.style.scrollBehavior=this.oldScrollBehavior,this.eventListeners.forEach(({element:s,type:e,listener:n})=>{s.removeEventListener(e,n)}),this.eventListeners.splice(0,this.eventListeners.length)}doScroll(s){const e=s.pageX;e<this.positionX?this.header.scrollLeft+=this.positionX-e:e>this.positionX&&(this.header.scrollLeft+=-(e-this.positionX)),this.positionX=e}}class x{constructor(s,e,n,o){this.ngZone=s,this.header=e,this.leftShadow=n,this.rightShadow=o,this.hidden="hidden",this.eventListeners=[],this.ngZone.runOutsideAngular(()=>{this.calculateShadows();const a=()=>{this.calculateShadows()};this.header.addEventListener("scroll",a,{passive:!0}),window.addEventListener("resize",a,{passive:!0}),this.eventListeners.push({element:this.header,type:"scroll",listener:a},{element:window,type:"resize",listener:a})})}destroy(){this.ngZone.runOutsideAngular(()=>{this.eventListeners.forEach(({element:s,type:e,listener:n})=>{s.removeEventListener(e,n)}),this.eventListeners=null}),this.ngZone=null,this.header=null,this.leftShadow=null,this.rightShadow=null}calculateShadows(){this.maxScrollLeft=this.header.scrollWidth-this.header.clientWidth,0===this.maxScrollLeft?this.hideBoth():0===this.header.scrollLeft?this.hideLeft():this.header.scrollLeft===this.maxScrollLeft?this.hideRight():this.showBoth()}hideBoth(){this.leftShadow.classList.add(this.hidden),this.rightShadow.classList.add(this.hidden)}hideLeft(){this.leftShadow.classList.add(this.hidden),this.rightShadow.classList.remove(this.hidden)}hideRight(){this.leftShadow.classList.remove(this.hidden),this.rightShadow.classList.add(this.hidden)}showBoth(){this.leftShadow.classList.remove(this.hidden),this.rightShadow.classList.remove(this.hidden)}}var Z=l(3347);const A=["scrollable"],Y=["leftShadow"],H=["rightShadow"];function U(i,s){if(1&i){const e=t.RV6();t.j41(0,"mat-icon",10),t.nI1(1,"translate"),t.bIt("click",function(){r.eBV(e);const o=t.XpG(3);return r.Njj(o.languageSettings())}),t.EFF(2,"settings"),t.k0s()}2&i&&t.Y8G("tippy",t.bMT(1,1,"LanguageSettings.Title"))}function V(i,s){if(1&i&&(t.j41(0,"button",7),t.EFF(1),t.nVh(2,U,3,3,"mat-icon",9),t.k0s()),2&i){const e=t.XpG().$implicit,n=t.XpG();t.Y8G("tippy",e.Culture)("tippyDisabled",n.disabled()),t.R7$(),t.SpI(" ",e.label," "),t.R7$(),t.vxM(n.userLanguageSvc.userConfigurable()?2:-1)}}function z(i,s){if(1&i){const e=t.RV6();t.j41(0,"button",11),t.bIt("mousedown",function(o){r.eBV(e);const a=t.XpG(2);return r.Njj(a.lngButtonMouseDown(o))})("click",function(o){r.eBV(e);const a=t.XpG().$implicit,c=t.XpG();return r.Njj(c.lngButtonClick(o,a))}),t.EFF(1),t.k0s()}if(2&i){const e=t.XpG().$implicit,n=t.XpG();t.Y8G("tippy",e.Culture)("tippyDisabled",n.disabled()),t.R7$(),t.SpI(" ",e.label," ")}}function N(i,s){if(1&i&&t.nVh(0,V,3,4,"button",7)(1,z,2,3,"button",8),2&i){const e=s.$implicit,n=t.XpG();t.vxM(n.current()===e.NameId?0:1)}}let W=(()=>{class i{constructor(e,n,o,a,c,f,m,J){this.languageService=e,this.languageInstanceService=n,this.ngZone=o,this.formConfig=a,this.snackBar=c,this.translate=f,this.matDialog=m,this.viewContainerRef=J,this.log=(0,D.Tq)({LanguageSwitcherComponent:i}),this.disabled=(0,B.hFB)(),this.current=(0,T.EW)(()=>this.formConfig.language().current),this.buttons=y(this.languageService.getAll()),this.userLanguageSvc=(0,b.d)(L.L)}ngAfterViewInit(){this.showShadowsHelper=new x(this.ngZone,this.headerRef.nativeElement,this.leftShadowRef.nativeElement,this.rightShadowRef.nativeElement),this.mouseScrollHelper=new $(this.ngZone,this.headerRef.nativeElement,()=>this.disabled()),this.centerSelectedHelper=new G(this.ngZone,this.headerRef.nativeElement)}ngOnDestroy(){this.centerSelectedHelper?.destroy(),this.mouseScrollHelper?.destroy(),this.showShadowsHelper?.destroy()}lngButtonMouseDown(e){this.centerSelectedHelper.lngButtonDown(e)}lngButtonClick(e,n){const o=this.log.fn("lngButtonClick");if(this.disabled())return this.snackBar.open(this.translate.instant("Message.CantSwitchLanguage"),null,{duration:3e3,verticalPosition:"top"}),o.end("disabled");if(this.centerSelectedHelper.lngButtonClick(e),!this.centerSelectedHelper.stopClickIfMouseMoved()){this.languageInstanceService.setCurrent(this.formConfig.config.formId,n.NameId);const a=this.userLanguageSvc.uiCode(n.NameId);this.translate.use(a)}}languageSettings(){this.matDialog.open(j,{autoFocus:!1,viewContainerRef:this.viewContainerRef,width:"750px",position:{top:"50px"}})}static#t=this.\u0275fac=function(n){return new(n||i)(t.rXU(C.g),t.rXU(E.A),t.rXU(t.SKi),t.rXU(R.S),t.rXU(Z.UG),t.rXU(h.c$),t.rXU(d.h),t.rXU(t.c1b))};static#e=this.\u0275cmp=t.VBU({type:i,selectors:[["app-language-switcher"]],viewQuery:function(n,o){if(1&n&&(t.GBs(A,5),t.GBs(Y,5),t.GBs(H,5)),2&n){let a;t.mGM(a=t.lsd())&&(o.headerRef=a.first),t.mGM(a=t.lsd())&&(o.leftShadowRef=a.first),t.mGM(a=t.lsd())&&(o.rightShadowRef=a.first)}},inputs:{disabled:[1,"disabled"]},decls:9,vars:1,consts:[["leftShadow",""],["rightShadow",""],["scrollable",""],[1,"scrollable__overlay"],[1,"scrollable__overlay--left-shadow"],[1,"scrollable__overlay--right-shadow"],["tippyTranslate","Message.CantSwitchLanguage",1,"scrollable","lang-switch",3,"tippyDisabled"],["mat-flat-button","","color","accent",1,"lang-switch__button","hover-area",3,"tippy","tippyDisabled"],["mat-flat-button","","color","white",1,"lang-switch__button",3,"tippy","tippyDisabled"],["iconPositionEnd","",1,"hover-only",3,"tippy"],["iconPositionEnd","",1,"hover-only",3,"click","tippy"],["mat-flat-button","","color","white",1,"lang-switch__button",3,"mousedown","click","tippy","tippyDisabled"]],template:function(n,o){1&n&&(t.j41(0,"div",3),t.nrm(1,"div",4,0)(3,"div",5,1),t.j41(5,"div",6,2),t.Z7z(7,N,2,1,null,null,t.fX1),t.k0s()()),2&n&&(t.R7$(5),t.Y8G("tippyDisabled",!o.disabled()),t.R7$(2),t.Dyx(o.buttons))},dependencies:[g.Hl,g.$z,u.An,p.e,h.h,h.D9],styles:['.scrollable__overlay[_ngcontent-%COMP%]{position:relative;height:100%}.scrollable__overlay--left-shadow[_ngcontent-%COMP%], .scrollable__overlay--right-shadow[_ngcontent-%COMP%]{content:"";position:absolute;top:0;display:block;z-index:1;pointer-events:none;height:100%;width:80px;background-image:linear-gradient(90deg,#fff 8px,#fff0)}@media (max-width: 600px){.scrollable__overlay--left-shadow[_ngcontent-%COMP%], .scrollable__overlay--right-shadow[_ngcontent-%COMP%]{width:24px}}.scrollable__overlay--right-shadow[_ngcontent-%COMP%]{right:0;background-image:linear-gradient(270deg,#fff 8px,#fff0)}.scrollable[_ngcontent-%COMP%]{overflow:hidden;scroll-behavior:smooth;height:100%;touch-action:none}.lang-switch[_ngcontent-%COMP%]{display:flex}.lang-switch__button[_ngcontent-%COMP%]{height:100%;flex-shrink:0;border-radius:0;margin-left:0!important;color:#0006;border-bottom:none;font-size:12px;line-height:54px;padding:0 6px;background-color:#fff!important}.lang-switch__button.mat-accent[_ngcontent-%COMP%]{color:#85283b;border-bottom:2px solid #85283B;background-color:inherit}.hidden[_ngcontent-%COMP%]{visibility:hidden}.hover-area[_ngcontent-%COMP%]   .hover-only[_ngcontent-%COMP%]{display:none}.hover-area[_ngcontent-%COMP%]:hover   .hover-only[_ngcontent-%COMP%]{display:block}']})}return i})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/20.00.07/dist/ng-edit/projects_eav-ui_src_app_edit_dialog_header_language-switcher_language-switcher_component_ts.625a206d9c05b85a.js.map