"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_replace-content_replace-content_component_ts"],{9271:(U,C,e)=>{e.r(C),e.d(C,{ReplaceContentComponent:()=>Z});var p=e(8071),d=e(3839),h=e(9736),g=e(712),E=e(6041),f=e(2957),t=e(1699),m=e(91),_=e(6861),v=e(9409),M=e(6575),s=e(9498),c=e(895),B=e(6515),A=e(1268),K=e(257),D=e(8849),R=e(9892),L=e(9674),T=e(5918);function y(r,u){if(1&r&&(t.TgZ(0,"mat-option",16),t._uU(1),t.qZA()),2&r){const a=u.$implicit;t.Q6J("value",a),t.xp6(1),t.Oqu(a)}}function W(r,u){if(1&r){const a=t.EpF();t.ynx(0),t.TgZ(1,"div",1)(2,"div",2)(3,"div",3),t._uU(4),t.qZA()(),t.TgZ(5,"div",4),t._UZ(6,"router-outlet"),t.TgZ(7,"p"),t._uU(8),t.qZA(),t.TgZ(9,"div",5)(10,"mat-form-field",6)(11,"mat-label"),t._uU(12,"Choose item"),t.qZA(),t.TgZ(13,"input",7),t.NdJ("ngModelChange",function(o){t.CHM(a);const i=t.oxw();return t.KtG(i.setFilter(o))}),t.qZA(),t.TgZ(14,"mat-autocomplete",8,9),t.NdJ("optionSelected",function(o){t.CHM(a);const i=t.oxw();return t.KtG(i.select(o))}),t.TgZ(16,"cdk-virtual-scroll-viewport",10),t.YNc(17,y,2,2,"mat-option",11),t.qZA()()(),t.TgZ(18,"button",12),t.NdJ("click",function(){t.CHM(a);const o=t.oxw();return t.KtG(o.copySelected())}),t.TgZ(19,"mat-icon"),t._uU(20,"file_copy"),t.qZA()()()(),t.TgZ(21,"mat-dialog-actions",13)(22,"button",14),t.NdJ("click",function(){t.CHM(a);const o=t.oxw();return t.KtG(o.closeDialog())}),t._uU(23,"Cancel"),t.qZA(),t.TgZ(24,"button",15),t.NdJ("click",function(){t.CHM(a);const o=t.oxw();return t.KtG(o.save())}),t._uU(25,"Save"),t.qZA()()(),t.BQk()}if(2&r){const a=u.ngIf,n=t.MAs(15);t.xp6(4),t.Oqu(a.isAddMode?"Add Existing Item":"Replace Content Item"),t.xp6(4),t.hij("",a.isAddMode?"Select a content-item to add to this list.":"By replacing a content-item you can make other content appear in the slot of the original content."," "),t.xp6(5),t.Q6J("matAutocomplete",n)("ngModel",a.filterText),t.xp6(3),t.Udp("height",a.filteredOptions.length<6?48*a.filteredOptions.length:240,"px"),t.xp6(1),t.Q6J("cdkVirtualForOf",a.filteredOptions),t.xp6(1),t.Q6J("disabled",!a.isMatch),t.xp6(6),t.Q6J("disabled",!a.isMatch)}}let Z=(()=>{var r;class u extends E.H{constructor(n,o,i,l,P){super(n,o),this.router=n,this.route=o,this.dialogRef=i,this.contentGroupService=l,this.snackBar=P,this.hostClass="dialog-component"}ngOnInit(){this.guid=this.route.snapshot.paramMap.get("guid"),this.part=this.route.snapshot.paramMap.get("part"),this.index=parseInt(this.route.snapshot.paramMap.get("index"),10),this.add=!!this.route.snapshot.queryParamMap.get("add"),this.filterText$=new p.X(""),this.options$=new p.X([]);const n=(0,d.a)([this.filterText$,this.options$]).pipe((0,h.U)(([o,i])=>i.filter(l=>l.label.toLocaleLowerCase().includes(o.toLocaleLowerCase())).map(l=>l.label)));this.viewModel$=(0,d.a)([this.filterText$,n]).pipe((0,h.U)(([o,i])=>({filterText:o,filteredOptions:i,isAddMode:this.add,isMatch:i.includes(o)}))),this.fetchConfig(!1,null),this.subscription.add(this.refreshOnChildClosedShallow().subscribe(()=>{const i=this.router.getCurrentNavigation().extras?.state,l=i?.[Object.keys(i)[0]];this.fetchConfig(!0,l)}))}ngOnDestroy(){this.filterText$.complete(),this.options$.complete(),super.ngOnDestroy()}closeDialog(){this.dialogRef.close()}setFilter(n){this.filterText$.next(n)}select(n){this.filterText$.next(n.option.value)}copySelected(){const n=this.buildContentGroup(),i=(0,f.f)({items:[{ContentTypeName:this.contentTypeName,DuplicateEntity:n.id}]});this.router.navigate([`edit/${i}`],{relativeTo:this.route})}save(){this.snackBar.open("Saving...");const n=this.buildContentGroup();this.contentGroupService.saveItem(n).subscribe(()=>{this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()})}fetchConfig(n,o){const i=this.buildContentGroup();this.contentGroupService.getItems(i).subscribe(l=>{const P=Object.entries(l.Items).map(([O,x])=>({id:parseInt(O,10),label:`${x} (${O})`}));if(this.options$.next(P),!i.add&&!n||null!=o){const O=n?o:l.SelectedId,x=this.options$.value.find(I=>I.id===O)?.label||"";this.filterText$.next(x)}this.contentTypeName=l.ContentTypeName})}buildContentGroup(){return{id:this.options$.value.find(i=>i.label===this.filterText$.value)?.id??null,guid:this.guid,part:this.part,index:this.index,add:this.add}}}return(r=u).\u0275fac=function(n){return new(n||r)(t.Y36(m.F0),t.Y36(m.gz),t.Y36(_.so),t.Y36(g.e),t.Y36(v.ux))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-replace-content"]],hostVars:1,hostBindings:function(n,o){2&n&&t.Ikx("className",o.hostClass)},features:[t.qOj],decls:2,vars:3,consts:[[4,"ngIf"],[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],[1,"eav-options-box"],["color","accent",1,"eav-form-field"],["matInput","",3,"matAutocomplete","ngModel","ngModelChange"],[3,"optionSelected"],["auto","matAutocomplete"],["itemSize","48","minBufferPx","500","maxBufferPx","1000"],[3,"value",4,"cdkVirtualFor","cdkVirtualForOf"],["mat-icon-button","","tippy","Copy",3,"disabled","click"],["align","end"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click"],[3,"value"]],template:function(n,o){1&n&&(t.YNc(0,W,26,9,"ng-container",0),t.ALo(1,"async")),2&n&&t.Q6J("ngIf",t.lcZ(1,1,o.viewModel$))},dependencies:[M.O5,m.lC,s.$,_.H8,c.lW,c.RK,B.Hw,A.KE,A.hX,K.ey,D.Fj,D.JJ,D.On,R.XC,R.ZL,L.Nt,T.xd,T.x0,T.N7,M.Ov],styles:[".eav-options-box[_ngcontent-%COMP%]{display:flex;align-items:flex-end}"]}),u})()},6041:(U,C,e)=>{e.d(C,{H:()=>m});var p=e(91),d=e(4520),h=e(5043),g=e(9736),E=e(9422),f=e(9097),t=e(1699);let m=(()=>{var _;class v extends f.f{constructor(s,c){super(),this.router=s,this.route=c}ngOnDestroy(){super.ngOnDestroy()}refreshOnChildClosedDeep(){return this.router.events.pipe((0,d.h)(s=>s instanceof p.m2),(0,h.O)(!!this.route.snapshot.firstChild.firstChild),(0,g.U)(()=>!!this.route.snapshot.firstChild.firstChild),(0,E.G)(),(0,d.h)(([s,c])=>s&&!c))}refreshOnChildClosedShallow(){return this.router.events.pipe((0,d.h)(s=>s instanceof p.m2),(0,h.O)(!!this.route.snapshot.firstChild),(0,g.U)(()=>!!this.route.snapshot.firstChild),(0,E.G)(),(0,d.h)(([s,c])=>s&&!c))}}return(_=v).\u0275fac=function(s){return new(s||_)(t.Y36(p.F0),t.Y36(p.gz))},_.\u0275dir=t.lG2({type:_,features:[t.qOj]}),v})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/16.17.00/dist/ng-edit/projects_eav-ui_src_app_replace-content_replace-content_component_ts.25c66398948620a4.js.map