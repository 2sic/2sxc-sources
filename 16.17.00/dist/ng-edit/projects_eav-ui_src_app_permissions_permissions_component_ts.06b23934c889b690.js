"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_permissions_permissions_component_ts"],{8660:(_,u,t)=>{t.r(u),t.d(u,{PermissionsComponent:()=>Z});var m=t(8071),i=t(3839),l=t(9736),g=t(6041),y=t(5253),P=t(6433),c=t(196),T=t(2957),e=t(1699),p=t(9498),v=t(6515),r=t(257);let o=(()=>{var d;class C{agInit(n){this.params=n}refresh(n){return!0}deletePermission(){this.params.onDelete(this.params.data)}}return(d=C).\u0275fac=function(n){return new(n||d)},d.\u0275cmp=e.Xpm({type:d,selectors:[["app-permissions-actions"]],decls:4,vars:0,consts:[[1,"actions-component"],["matRipple","","tippy","Delete",1,"eav-grid-action-button","highlight",3,"click"]],template:function(n,s){1&n&&(e.TgZ(0,"div",0)(1,"div",1),e.NdJ("click",function(){return s.deletePermission()}),e.TgZ(2,"mat-icon"),e._uU(3,"delete"),e.qZA()()())},dependencies:[p.$,v.Hw,r.wG]}),C})();var f=t(7782),O=t(91),M=t(6861),x=t(9409),E=t(6575),I=t(895),A=t(8621);function R(d,C){if(1&d){const h=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"div",3),e._uU(3,"Permissions"),e.qZA(),e.TgZ(4,"button",4),e.NdJ("click",function(){e.CHM(h);const s=e.oxw();return e.KtG(s.closeDialog())}),e.TgZ(5,"mat-icon"),e._uU(6,"close"),e.qZA()()(),e.TgZ(7,"div",5),e._UZ(8,"router-outlet"),e.TgZ(9,"div",6),e._UZ(10,"ag-grid-angular",7),e.qZA(),e.TgZ(11,"mat-dialog-actions",8)(12,"button",9),e.NdJ("click",function(){e.CHM(h);const s=e.oxw();return e.KtG(s.editPermission(null))}),e.TgZ(13,"mat-icon"),e._uU(14,"add"),e.qZA()()()()()}if(2&d){const h=C.ngIf,n=e.oxw();e.xp6(10),e.Q6J("rowData",h.permissions)("gridOptions",n.gridOptions)}}let Z=(()=>{var d;class C extends g.H{constructor(n,s,a,D,U){super(n,s),this.router=n,this.route=s,this.dialogRef=a,this.permissionsService=D,this.snackBar=U,this.permissions$=new m.X(void 0),this.gridOptions=this.buildGridOptions(),this.targetType=parseInt(this.route.snapshot.paramMap.get("targetType"),10),this.keyType=this.route.snapshot.paramMap.get("keyType"),this.key=this.route.snapshot.paramMap.get("key"),this.prefills={[c.Zy.metadata.language.targetType]:{PermissionType:"language"}}}ngOnInit(){this.fetchPermissions(),this.subscription.add(this.refreshOnChildClosedShallow().subscribe(()=>{this.fetchPermissions()})),this.viewModel$=(0,i.a)([this.permissions$]).pipe((0,l.U)(([n])=>({permissions:n})))}ngOnDestroy(){this.permissions$.complete(),super.ngOnDestroy()}closeDialog(){this.dialogRef.close()}fetchPermissions(){this.permissionsService.getAll(this.targetType,this.keyType,this.key).subscribe(n=>{this.permissions$.next(n)})}editPermission(n){let s;s=null==n?{items:[{ContentTypeName:c.Zy.contentTypes.permissions,For:{Target:Object.values(c.Zy.metadata).find(D=>D.targetType===this.targetType)?.target??this.targetType.toString(),TargetType:this.targetType,...this.keyType===c.Zy.keyTypes.guid&&{Guid:this.key},...this.keyType===c.Zy.keyTypes.number&&{Number:parseInt(this.key,10)},...this.keyType===c.Zy.keyTypes.string&&{String:this.key}},...this.prefills[this.targetType]&&{Prefill:this.prefills[this.targetType]}}]}:{items:[{EntityId:n.Id}]};const a=(0,T.f)(s);this.router.navigate([`edit/${a}`],{relativeTo:this.route})}deletePermission(n){confirm(`Delete '${n.Title}' (${n.Id})?`)&&(this.snackBar.open("Deleting..."),this.permissionsService.delete(n.Id).subscribe(()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchPermissions()}))}buildGridOptions(){return{...P.f,columnDefs:[{headerName:"ID",field:"Id",width:70,headerClass:"dense",cellClass:"id-action no-padding no-outline".split(" "),sortable:!0,filter:"agNumberColumnFilter",valueGetter:s=>s.data.Id,cellRenderer:y.m,cellRendererParams:{tooltipGetter:a=>`ID: ${a.Id}\nGUID: ${a.Guid}`}},{field:"Name",flex:2,minWidth:250,cellClass:"primary-action highlight".split(" "),sortable:!0,sort:"asc",filter:"agTextColumnFilter",onCellClicked:s=>{this.editPermission(s.data)},valueGetter:s=>s.data.Title},{field:"Identity",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:s=>s.data.Identity},{field:"Condition",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:s=>s.data.Condition},{field:"Grant",width:70,headerClass:"dense",cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:s=>s.data.Grant},{width:42,cellClass:"secondary-action no-padding".split(" "),pinned:"right",cellRenderer:o,cellRendererParams:(()=>({onDelete:a=>this.deletePermission(a)}))()}]}}}return(d=C).\u0275fac=function(n){return new(n||d)(e.Y36(O.F0),e.Y36(O.gz),e.Y36(M.so),e.Y36(f.q),e.Y36(x.ux))},d.\u0275cmp=e.Xpm({type:d,selectors:[["app-permissions"]],features:[e.qOj],decls:2,vars:3,consts:[["class","eav-dialog nav-component-wrapper",4,"ngIf"],[1,"eav-dialog","nav-component-wrapper"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"eav-dialog-content","nav-component-wrapper"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","gridOptions"],["align","end"],["mat-fab","","mat-elevation-z24","","tippy","Create a new permission",1,"grid-fab",3,"click"]],template:function(n,s){1&n&&(e.YNc(0,R,15,2,"div",0),e.ALo(1,"async")),2&n&&e.Q6J("ngIf",e.lcZ(1,1,s.viewModel$))},dependencies:[E.O5,O.lC,p.$,M.H8,I.RK,I.cs,v.Hw,A.N8,E.Ov]}),C})()},6041:(_,u,t)=>{t.d(u,{H:()=>T});var m=t(91),i=t(4520),l=t(5043),g=t(9736),y=t(9422),P=t(9097),c=t(1699);let T=(()=>{var e;class p extends P.f{constructor(r,o){super(),this.router=r,this.route=o}ngOnDestroy(){super.ngOnDestroy()}refreshOnChildClosedDeep(){return this.router.events.pipe((0,i.h)(r=>r instanceof m.m2),(0,l.O)(!!this.route.snapshot.firstChild.firstChild),(0,g.U)(()=>!!this.route.snapshot.firstChild.firstChild),(0,y.G)(),(0,i.h)(([r,o])=>r&&!o))}refreshOnChildClosedShallow(){return this.router.events.pipe((0,i.h)(r=>r instanceof m.m2),(0,l.O)(!!this.route.snapshot.firstChild),(0,g.U)(()=>!!this.route.snapshot.firstChild),(0,y.G)(),(0,i.h)(([r,o])=>r&&!o))}}return(e=p).\u0275fac=function(r){return new(r||e)(c.Y36(m.F0),c.Y36(m.gz))},e.\u0275dir=c.lG2({type:e,features:[c.qOj]}),p})()},5253:(_,u,t)=>{t.d(u,{m:()=>e});var m=t(4472),i=t(1699),l=t(9409),g=t(6575),y=t(257),P=t(6515),c=t(9498);const T=function(p,v){return{"align-start":p,"align-end":v}};let e=(()=>{var p;class v{constructor(o){this.snackBar=o}agInit(o){this.id=o.value,this.align="number"==typeof this.id?"end":"start",this.tooltip=o.tooltipGetter(o.data)}refresh(o){return!0}copy(){(0,m.v)(this.tooltip),this.snackBar.open("Copied to clipboard",null,{duration:2e3})}}return(p=v).\u0275fac=function(o){return new(o||p)(i.Y36(l.ux))},p.\u0275cmp=i.Xpm({type:p,selectors:[["app-id-field"]],decls:5,vars:6,consts:[["matRipple","",1,"id-box","highlight",3,"tippy","ngClass","click"],[1,"id"],[1,"icon"]],template:function(o,f){1&o&&(i.TgZ(0,"div",0),i.NdJ("click",function(){return f.copy()}),i.TgZ(1,"span",1),i._uU(2),i.qZA(),i.TgZ(3,"mat-icon",2),i._uU(4,"file_copy"),i.qZA()()),2&o&&(i.Q6J("tippy",f.tooltip)("ngClass",i.WLB(3,T,"start"===f.align,"end"===f.align)),i.xp6(2),i.Oqu(f.id))},dependencies:[g.mk,y.wG,P.Hw,c.$],styles:[".id-box[_ngcontent-%COMP%]{padding:0 8px;height:100%;display:flex;align-items:center}.id-box.align-start[_ngcontent-%COMP%]{justify-content:flex-start}.id-box.align-end[_ngcontent-%COMP%]{justify-content:flex-end}.id-box[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{max-width:100%;text-overflow:ellipsis;overflow:hidden}.id-box[_ngcontent-%COMP%]:hover{text-decoration:none}.id-box[_ngcontent-%COMP%]:hover   .id[_ngcontent-%COMP%]{display:none}.id-box[_ngcontent-%COMP%]:not(:hover)   .icon[_ngcontent-%COMP%]{display:none}"]}),v})()},6433:(_,u,t)=>{t.d(u,{f:()=>m});const m={accentedSort:!0,animateRows:!0,enableCellTextSelection:!0,headerHeight:32,suppressScrollOnNewData:!0,valueCache:!0,defaultColDef:{filterParams:{newRowsAction:"keep"}},tooltipShowDelay:0,tooltipHideDelay:1e5,suppressMovableColumns:!0}},4472:(_,u,t)=>{function m(i){const l=document.createElement("textarea");l.value=i,l.setAttribute("readonly",""),l.style.position="absolute",l.style.left="-9999px",document.body.appendChild(l);const g=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);l.select(),document.execCommand("copy"),document.body.removeChild(l),g&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(g))}t.d(u,{v:()=>m})}}]);
//# sourceMappingURL=https://sources.2sxc.org/16.17.00/dist/ng-edit/projects_eav-ui_src_app_permissions_permissions_component_ts.06b23934c889b690.js.map