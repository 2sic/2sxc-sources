"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_manage-content-list_manage-content-list_component_ts"],{3620:(D,u,i)=>{function _(t,d){return d(t)}function h(t,d){return d(t)}i.d(u,{C:()=>_,z:()=>h})},5026:(D,u,i)=>{i.r(u),i.d(u,{ManageContentListComponent:()=>$});var _=i(6571),h=i(2275),t=i(7580),d=i(4175),M=i(7941),E=i(3840),f=i(2159),g=i(852),P=i(2938),x=i(3620),m=i(4699),b=i(1459),s=i(4601),r=i(3216),c=i(334),C=i(8471),I=i(7993),R=i(9669),B=i(3347);const j=(a,p)=>p.Index+"+"+p.Id;function F(a,p){if(1&a){const e=t.RV6();t.j41(0,"span"),t.EFF(1),t.k0s(),t.j41(2,"button",13),t.bIt("click",function(){t.eBV(e);const o=t.XpG(3);return t.Njj(o.editHeader())}),t.j41(3,"mat-icon"),t.EFF(4,"edit"),t.k0s()()}if(2&a){const e=t.XpG(3);t.R7$(),t.JRh(e.header()().Title)}}function k(a,p){1&a&&(t.EFF(0),t.nI1(1,"translate")),2&a&&t.SpI(" ",t.bMT(1,1,"ManageContentList.NoHeader")," ")}function U(a,p){if(1&a&&(t.j41(0,"p"),t.EFF(1),t.nI1(2,"translate"),t.k0s(),t.j41(3,"p"),t.DNE(4,F,5,1)(5,k,2,3),t.k0s()),2&a){const e=t.XpG(2);t.R7$(),t.SpI(" ",t.bMT(2,2,"ManageContentList.Description")," "),t.R7$(3),t.vxM(e.header()().Type?4:5)}}function y(a,p){if(1&a&&(t.j41(0,"p",5),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&a){let e;const n=t.XpG(2);t.R7$(),t.SpI(" ",t.bMT(2,1,"ManageContentList."+(n.reordered()?"ListHasBeenReordered":(null==(e=n.items())?null:e.length)<25?"SortItems":"SortLotsOfItems"))," ")}}function A(a,p){if(1&a){const e=t.RV6();t.j41(0,"div",7)(1,"div",14)(2,"mat-icon",15),t.EFF(3,"drag_handle"),t.k0s(),t.j41(4,"span",16),t.EFF(5),t.k0s()(),t.j41(6,"div")(7,"button",17),t.bIt("click",function(){const o=t.eBV(e).$implicit,l=t.XpG(2);return t.Njj(l.addFromExisting(o.Index))}),t.j41(8,"mat-icon"),t.EFF(9,"playlist_add"),t.k0s()(),t.j41(10,"button",18),t.bIt("click",function(){const o=t.eBV(e).$implicit,l=t.XpG(2);return t.Njj(l.addBelow(o.Index))}),t.j41(11,"mat-icon"),t.EFF(12,"add"),t.k0s()(),t.j41(13,"button",19),t.bIt("click",function(){const o=t.eBV(e).$implicit,l=t.XpG(2);return t.Njj(l.remove(o))}),t.j41(14,"mat-icon"),t.EFF(15,"remove"),t.k0s()(),t.j41(16,"button",20),t.bIt("click",function(){const o=t.eBV(e).$implicit,l=t.XpG(2);return t.Njj(l.editItem(o.Id))}),t.j41(17,"mat-icon"),t.EFF(18,"edit"),t.k0s()()()()}if(2&a){const e=p.$implicit,n=t.XpG(2);t.R7$(4),t.FCK("tippy","",e.Title," (",e.Id,")"),t.R7$(),t.Lme(" ",e.Title," (",e.Id,") "),t.R7$(2),t.Y8G("disabled",0===e.Id),t.R7$(3),t.Y8G("disabled",0===e.Id||n.reordered()),t.R7$(3),t.Y8G("disabled",n.reordered()),t.R7$(3),t.Y8G("disabled",0===e.Id)}}function K(a,p){if(1&a){const e=t.RV6();t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.EFF(3),t.nI1(4,"translate"),t.k0s()(),t.j41(5,"div",3),t.nrm(6,"router-outlet"),t.j41(7,"div",4),t.DNE(8,U,6,4)(9,y,3,3,"p",5),t.j41(10,"div",6),t.bIt("cdkDropListDropped",function(o){t.eBV(e);const l=t.XpG();return t.Njj(l.drop(o))}),t.Z7z(11,A,19,9,"div",7,j),t.k0s()()(),t.j41(13,"mat-dialog-actions",8)(14,"button",9),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.closeDialog())}),t.EFF(15),t.nI1(16,"translate"),t.k0s(),t.j41(17,"button",10),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.saveList())}),t.EFF(18),t.nI1(19,"translate"),t.k0s(),t.j41(20,"button",11),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.saveAndCloseList())}),t.j41(21,"mat-icon",12),t.EFF(22,"done"),t.k0s()()()()}if(2&a){const e=t.XpG();t.R7$(3),t.JRh(t.bMT(4,5,"ManageContentList.Title")),t.R7$(5),t.vxM(e.header()()?8:-1),t.R7$(),t.vxM(e.items()?9:-1),t.R7$(2),t.Dyx(e.items()),t.R7$(4),t.JRh(t.bMT(16,7,"General.Buttons.Cancel")),t.R7$(3),t.JRh(t.bMT(19,9,"General.Buttons.Save"))}}let $=(()=>{class a{#e;#n;#o;constructor(e,n,o){this.dialog=e,this.snackBar=n,this.translate=o,this.hostClass="dialog-component",this.#e=(0,P.d)(C.c),this.#n=(0,P.d)(R.y),this.#o=(0,P.d)(m.L),this.items=(0,I.KX)("items",null),this.#t=(0,x.C)(this.#e.getParams(["guid","part","index"]),l=>({id:null,guid:l.guid,part:l.part,index:parseInt(l.index,10)})),this.refresh=(0,t.vPA)(0),this.header=(0,t.EWP)(()=>(this.refresh(),this.#n.getHeader(this.#t,void 0))),this.reordered=(0,I.KX)("reordered",!1)}#t;ngOnInit(){this.#i(),this.#a(),this.#e.doOnDialogClosed(()=>{this.#i(!0),this.#s()})}#a(){this.#o.getCurrent$().subscribe(e=>{this.translate.setDefaultLang(e.Context.Language.Primary.split("-")[0]),this.translate.use(e.Context.Language.Current.split("-")[0])})}closeDialog(){this.dialog.close()}saveList(){this.snackBar.open("Saving..."),this.#n.saveList(this.#t,this.items()).subscribe(()=>{this.snackBar.open("Saved",null,{duration:2e3}),this.#i(),this.#s()})}saveAndCloseList(){this.snackBar.open("Saving..."),this.#n.saveList(this.#t,this.items()).subscribe(()=>{this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()})}editHeader(){const e={items:[c.c.relationship(this.#t.guid,"listcontent",0,0===this.header()().Id),c.c.relationship(this.#t.guid,"listpresentation",0,0===this.header()().Id)]},n=(0,r.s)(e);this.#e.navRelative([`edit/${n}`])}editItem(e){const n={items:[c.c.editId(e)]},o=(0,r.s)(n);this.#e.navRelative([`edit/${o}`])}addFromExisting(e){this.#e.navRelative([`${this.#t.guid}/${this.#t.part}/${e+1}/replace`],{queryParams:{add:!0}})}addBelow(e){const n={items:[c.c.relationship(this.#t.guid,this.#t.part,e+1,!0)]},o=(0,r.s)(n);this.#e.navRelative([`edit/${o}`])}remove(e){confirm(this.translate.instant("ManageContentList.ConfirmRemove"))&&(this.snackBar.open("Removing..."),this.#n.removeItem(this.#t,e.Index).subscribe(()=>{this.snackBar.open("Removed",null,{duration:2e3}),this.#i()}))}drop(e){const n=[...this.items()];(0,_.HD)(n,e.previousIndex,e.currentIndex),this.items.set(n),this.reordered.set(!0)}#i(e=!1){this.#n.getList(this.#t).subscribe(n=>{if(this.reordered()){const o=this.items().map(v=>v.Id);if(this.items().length===n.length&&!n.some(v=>!o.includes(v.Id))&&e){const v=this.items().map(O=>O.Index);n.sort((O,W)=>{const L=v.indexOf(O.Index),T=v.indexOf(W.Index);return-1===L||-1===T?0:L-T})}else e&&this.snackBar.open("List was changed from somewhere else. Order of items is reset",null,{duration:5e3})}this.items.set(n),this.reordered.set(!1)})}#s(){this.refresh.set(this.refresh()+1)}static{this.\u0275fac=function(n){return new(n||a)(t.rXU(M.CP),t.rXU(B.UG),t.rXU(g.c$))}}static{this.\u0275cmp=t.VBU({type:a,selectors:[["app-manage-content-list"]],hostVars:1,hostBindings:function(n,o){2&n&&t.Mr5("className",o.hostClass)},decls:1,vars:1,consts:[[1,"eav-dialog","eav-no-scrollbar"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],["cdkScrollable","",1,"dialog-component-content","fancy-scrollbar-light"],[1,"eav-sort-title"],["cdkDropList","",1,"eav-dnd-list",3,"cdkDropListDropped"],["cdkDrag","",1,"eav-dnd-item"],["align","end"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"click"],["mat-raised-button","","color","accent","tippyTranslate","Form.Buttons.SaveAndClose",3,"click"],[1,"eav-raised-button-icon"],["mat-icon-button","","tippy","Edit header",3,"click"],[1,"eav-dnd-item__title"],["tippy","Drag to reorder the list",1,"eav-dnd-item__title-icon"],[1,"eav-dnd-item__title-text",3,"tippy"],["mat-icon-button","","tippyTranslate","Fields.Picker.AddExistingItem","appMousedownStopPropagation","",3,"click","disabled"],["mat-icon-button","","tippyTranslate","Fields.Picker.AddItemBelow","appMousedownStopPropagation","",3,"click","disabled"],["mat-icon-button","","tippyTranslate","Fields.Picker.Remove","appMousedownStopPropagation","",3,"click","disabled"],["mat-icon-button","","tippyTranslate","Fields.Picker.Edit","appMousedownStopPropagation","",3,"click","disabled"]],template:function(n,o){1&n&&t.DNE(0,K,23,11,"div",0),2&n&&t.vxM(o.header()&&o.items()?0:-1)},dependencies:[f.n3,h.uv,d.Hl,d.$z,d.iY,E.m_,E.An,_.O7,_.T1,M.E7,g.h,g.D9,M.hM,s.e,b.z],styles:[".eav-sort-title[_ngcontent-%COMP%]{padding-top:16px}.eav-dnd-list[_ngcontent-%COMP%]{margin:16px 0;border:1px solid #ccc;border-radius:4px;overflow:hidden}.eav-dnd-item[_ngcontent-%COMP%]{cursor:move;height:40px;border-bottom:1px solid #ccc;padding:0 8px;display:flex;align-items:center;justify-content:space-between;background:#fff;box-sizing:border-box;font-size:14px}.eav-dnd-item[_ngcontent-%COMP%]:last-child{border:none}.eav-dnd-item__title[_ngcontent-%COMP%]{display:flex;align-items:center;overflow:hidden;max-width:80%}.eav-dnd-item__title-icon[_ngcontent-%COMP%]{margin-right:8px;opacity:.4}.eav-dnd-item__title-text[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.dnd-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .dnd-item[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}"]})}}return a})()},8471:(D,u,i)=>{i.d(u,{c:()=>x});var _=i(2159),h=i(1567),t=i(3037),d=i(271),M=i(5057),E=i(4435),f=i(4979),g=i(7580);const P={doOnDialogClosed:!0};let x=(()=>{class m extends f.V{constructor(s,r){super(),this.router=s,this.route=r,this.log=(0,E.Tq)({DialogRoutingService:m},P)}get snapshot(){return this.route.snapshot}get url(){return this.router.url}getParam(s){return this.route.snapshot.paramMap.get(s)}getParams(s){const r=this.route.snapshot.paramMap;return s.reduce((c,C)=>(c[C]=r.get(C),c),{})}getQueryParam(s){return this.route.snapshot.queryParamMap.get(s)}getQueryParams(s){const r=this.route.snapshot.queryParamMap;return s.reduce((c,C)=>(c[C]=r.get(C),c),{})}state(){return this.router.getCurrentNavigation().extras?.state}doOnDialogClosed(s){const r=this.log.fnIf("doOnDialogClosed");this.subscriptions.add(this.childDialogClosed$().subscribe(()=>s())),r.end()}urlSubRoute(s){const r=this.router.createUrlTree([s],{relativeTo:this.route});return this.router.serializeUrl(r)}navPath(s,r){return this.router.navigate([s],r)}navRelative(s,r){return this.router.navigate(s,{...r,relativeTo:this.route})}childDialogClosed$(){return this.router.events.pipe((0,h.p)(s=>s instanceof _.wF),(0,t.Z)(!!this.route.snapshot.firstChild),(0,d.T)(()=>!!this.route.snapshot.firstChild),(0,M.J)(),(0,h.p)(([s,r])=>s&&!r))}static{this.\u0275fac=function(r){return new(r||m)(g.KVO(_.Ix),g.KVO(_.nX))}}static{this.\u0275prov=g.jDH({token:m,factory:m.\u0275fac})}}return m})()},4979:(D,u,i)=>{i.d(u,{V:()=>t});var _=i(7092),h=i(7580);let t=(()=>{class d{constructor(){this.subscriptions=new _.yU}ngOnDestroy(){this.destroy()}destroy(){this.subscriptions.unsubscribe()}static{this.\u0275fac=function(f){return new(f||d)}}static{this.\u0275prov=h.jDH({token:d,factory:d.\u0275fac})}}return d})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/19.03.00/dist/ng-edit/projects_eav-ui_src_app_manage-content-list_manage-content-list_component_ts.2a5ec7a7599e8413.js.map