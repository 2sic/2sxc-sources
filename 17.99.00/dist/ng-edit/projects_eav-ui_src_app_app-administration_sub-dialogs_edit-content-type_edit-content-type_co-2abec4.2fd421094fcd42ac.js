"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_app-administration_sub-dialogs_edit-content-type_edit-content-type_co-2abec4"],{8407:(R,S,o)=>{o.r(S),o.d(S,{EditContentTypeComponent:()=>w});var h=o(7941),p=o(5797),n=o(9999),r=o(271),k=o(9452),d=o(5858),g=o(52);const x=/(^[A-Za-z][A-Za-z0-9]*$)|(^@[A-Za-z][A-Za-z0-9\-]*$)/.toString(),b=x.substring(1,x.toString().length-1);var E=o(7693),C=o(316),v=o(3840),_=o(4175),T=o(5060),O=o(5175),$=o(353),D=o(7984),M=o(5944),m=o(4456),P=o(3758),G=o(9333),I=o(4601),B=o(5437),t=o(8559),A=o(9184),X=o(3347);function Y(a,u){1&a&&(t.j41(0,"app-field-hint",19),t.EFF(1,"This field is required"),t.k0s()),2&a&&t.Y8G("isError",!0)}function V(a,u){if(1&a&&(t.j41(0,"app-field-hint",19),t.EFF(1),t.k0s()),2&a){const e=t.XpG(4);t.Y8G("isError",!0),t.R7$(),t.JRh(e.contentTypeNameError)}}function H(a,u){if(1&a&&t.DNE(0,Y,2,1,"app-field-hint",19)(1,V,2,2,"app-field-hint",19),2&a){t.XpG();const e=t.sdS(9);t.vxM(0,e.errors.required?0:-1),t.R7$(),t.vxM(1,e.errors.pattern?1:-1)}}function U(a,u){if(1&a&&(t.j41(0,"mat-option",12),t.EFF(1),t.k0s()),2&a){const e=u.$implicit;t.Y8G("value",e.value),t.R7$(),t.SpI(" ",e.name," ")}}function z(a,u){if(1&a&&(t.j41(0,"div",7)(1,"h3"),t.EFF(2,"Shared Content Type (Ghost)"),t.k0s(),t.j41(3,"p"),t.EFF(4,"Note: this can't be edited in the UI, for now if you really know what you're doing, do it in the DB "),t.k0s(),t.j41(5,"p"),t.EFF(6),t.k0s()()),2&a){const e=t.XpG(2);t.R7$(6),t.SpI("Uses Type Definition of: ",e.contentType.SharedDefId,"")}}function L(a,u){if(1&a){const e=t.RV6();t.j41(0,"form",5,0),t.bIt("ngSubmit",function(){t.eBV(e);const i=t.XpG(2);return t.Njj(i.save())}),t.j41(2,"div",6)(3,"div")(4,"div",7)(5,"mat-form-field",8)(6,"mat-label"),t.EFF(7,"Name"),t.k0s(),t.j41(8,"input",9,1),t.bIt("ngModelChange",function(i){t.eBV(e);const l=t.XpG(2);return t.Njj(l.changeContentTypeName(i))}),t.k0s()(),t.DNE(10,H,2,2),t.k0s(),t.j41(11,"mat-accordion")(12,"mat-expansion-panel")(13,"mat-expansion-panel-header")(14,"mat-panel-title"),t.EFF(15,"Advanced"),t.k0s(),t.nrm(16,"mat-panel-description"),t.k0s(),t.j41(17,"div",7)(18,"div",10)(19,"mat-form-field",8)(20,"mat-label"),t.EFF(21,"Scope"),t.k0s(),t.j41(22,"mat-select",11),t.bIt("ngModelChange",function(i){t.eBV(e);const l=t.XpG(2);return t.Njj(l.changeScope(i))}),t.Z7z(23,U,2,2,"mat-option",12,t.fX1),t.j41(25,"mat-option",12),t.EFF(26,"Other..."),t.k0s()()(),t.j41(27,"button",13),t.bIt("click",function(){t.eBV(e);const i=t.XpG(2);return t.Njj(i.unlockScope())}),t.j41(28,"mat-icon"),t.EFF(29),t.k0s()()(),t.j41(30,"app-field-hint"),t.EFF(31," The scope should almost never be changed - "),t.j41(32,"a",14),t.EFF(33,"see help"),t.k0s()()(),t.j41(34,"div",7)(35,"mat-form-field",8)(36,"mat-label"),t.EFF(37,"Static Name"),t.k0s(),t.nrm(38,"input",15),t.k0s()(),t.DNE(39,z,7,1,"div",7),t.k0s()()()(),t.j41(40,"mat-dialog-actions",16)(41,"button",17),t.bIt("click",function(){t.eBV(e);const i=t.XpG(2);return t.Njj(i.closeDialog())}),t.EFF(42,"Cancel"),t.k0s(),t.j41(43,"button",18),t.EFF(44," Save "),t.k0s()()()}if(2&a){const e=t.sdS(1),s=t.sdS(9),i=t.XpG(),l=t.XpG();t.R7$(8),t.Y8G("pattern",l.contentTypeNamePattern)("ngModel",i.contentType.Name),t.R7$(2),t.vxM(10,s.touched&&s.errors?10:-1),t.R7$(),t.Y8G("@.disabled",i.disableAnimation),t.R7$(11),t.Y8G("ngModel",i.contentType.Scope)("disabled",i.lockScope),t.R7$(),t.Dyx(i.scopeOptions),t.R7$(2),t.Y8G("value",l.dropdownInsertValue),t.R7$(2),t.Y8G("tippy",i.lockScope?"Unlock":"Lock"),t.R7$(2),t.SpI(" ",i.lockScope?"lock":"lock_open"," "),t.R7$(9),t.Y8G("ngModel",i.contentType.StaticName),t.R7$(),t.vxM(39,i.contentType.SharedDefId?39:-1),t.R7$(4),t.Y8G("disabled",!e.form.valid||i.loading)}}function Z(a,u){if(1&a&&(t.j41(0,"div",2)(1,"div",3)(2,"div",4),t.EFF(3),t.k0s()(),t.DNE(4,L,45,12,"form"),t.k0s()),2&a){const e=t.XpG();t.R7$(3),t.JRh(e.contentTypeStaticName?"Edit Content Type":"New Content Type"),t.R7$(),t.vxM(4,u.contentType?4:-1)}}let w=(()=>{class a{constructor(e,s,i){this.dialogRef=e,this.route=s,this.snackBar=i,this.hostClass="dialog-component",this.contentTypesService=(0,B.d)(E.g),this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName"),this.contentTypeNamePattern=b,this.contentTypeNameError="Standard letters and numbers are allowed. Must start with a letter.",this.dropdownInsertValue=d.O,this.contentType$=new p.t(null),this.lockScope$=new p.t(!0),this.scopeOptions$=new p.t(null),this.disableAnimation$=new p.t(!0),this.loading$=new p.t(!1),this.viewModel$=(0,n.z)([this.contentType$,this.lockScope$,this.scopeOptions$,this.disableAnimation$,this.loading$]).pipe((0,r.T)(([l,y,f,j,K])=>({contentType:l,lockScope:y,scopeOptions:f,disableAnimation:j,loading:K}))),this.scope=this.route.snapshot.parent.paramMap.get("scope")}ngOnInit(){const e=this.contentTypeStaticName?this.contentTypesService.retrieveContentType(this.contentTypeStaticName).pipe((0,r.T)(i=>({...i,ChangeStaticName:!1,NewStaticName:i.StaticName}))):(0,k.of)({StaticName:"",Name:"",Description:"",Scope:this.scope,ChangeStaticName:!1,NewStaticName:""}),s=this.contentTypesService.getScopes();(0,n.z)([e,s]).subscribe(([i,l])=>{this.contentType$.next(i);const y=[...this.scopeOptions$.value??[]];l.forEach(f=>{y.some(j=>j.value===f.value)||y.push(f)}),y.some(f=>f.value===this.scope)||y.push({name:this.scope,value:this.scope}),this.scopeOptions$.next(y)})}ngOnDestroy(){this.contentType$.complete(),this.lockScope$.complete(),this.scopeOptions$.complete(),this.disableAnimation$.complete(),this.loading$.complete()}ngAfterViewInit(){setTimeout(()=>this.disableAnimation$.next(!1))}closeDialog(){this.dialogRef.close()}changeContentTypeName(e){this.contentType$.next({...this.contentType$.value,Name:e})}changeScope(e){e!==d.O||(e=prompt("This is an advanced feature to show content-types of another scope. Don't use this if you don't know what you're doing, as content-types of other scopes are usually hidden for a good reason.")||g.YX.scopes.default.value,this.scopeOptions$.value.some(s=>s.value===e))||this.scopeOptions$.next([{name:e,value:e},...this.scopeOptions$.value]),this.contentType$.next({...this.contentType$.value,Scope:e})}unlockScope(){this.lockScope$.next(!this.lockScope$.value),this.lockScope$.value&&this.contentType$.next({...this.contentType$.value,Scope:this.scope})}save(){this.loading$.next(!0),this.snackBar.open("Saving..."),this.contentTypesService.save(this.contentType$.value).subscribe(e=>{this.loading$.next(!1),this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()}),document.activeElement instanceof HTMLElement&&document.activeElement.blur()}static#t=this.\u0275fac=function(s){return new(s||a)(t.rXU(h.CP),t.rXU(A.nX),t.rXU(X.UG))};static#n=this.\u0275cmp=t.VBU({type:a,selectors:[["app-edit-content-type"]],hostVars:1,hostBindings:function(s,i){2&s&&t.Mr5("className",i.hostClass)},standalone:!0,features:[t.aNF],decls:2,vars:3,consts:[["ngForm","ngForm"],["name","ngModel"],[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[3,"ngSubmit"],[1,"eav-dialog-content"],[1,"eav-edit-input"],["color","accent",1,"eav-mat-form-field"],["matInput","","type","text","required","","name","Name",3,"ngModelChange","pattern","ngModel"],[1,"eav-form-and-button"],["name","Scope",3,"ngModelChange","ngModel","disabled"],[3,"value"],["mat-icon-button","","type","button","matTextSuffix","",1,"eav-scope-button",3,"click","tippy"],["href","https://2sxc.org/help?tag=scope","target","_blank","appClickStopPropagation",""],["matInput","","type","text","name","StaticName","disabled","",3,"ngModel"],["align","end"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","submit","color","accent",3,"disabled"],[3,"isError"]],template:function(s,i){if(1&s&&(t.DNE(0,Z,5,2,"div",2),t.nI1(1,"async")),2&s){let l;t.vxM(0,(l=t.bMT(1,1,i.viewModel$))?0:-1,l)}},dependencies:[m.YN,m.qT,m.me,m.BC,m.cb,m.YS,m.R_,m.vS,m.cV,M.RG,M.rl,M.nJ,M.yw,D.fS,D.fg,$.MY,$.BS,$.GK,$.Z2,$.WN,$.Q6,O.Ve,O.VO,T.wT,T.Sy,_.Hl,_.$z,_.iY,v.m_,v.An,h.E7,C.Jj,P.F,G.c,I.e],styles:[".eav-edit-input[_ngcontent-%COMP%]{padding-bottom:8px}.eav-form-and-button[_ngcontent-%COMP%]{display:flex;align-items:baseline;justify-content:space-between}.eav-form-and-button[_ngcontent-%COMP%]   .eav-scope-button[_ngcontent-%COMP%]{margin-left:8px}"]})}return a})()},3758:(R,S,o)=>{o.d(S,{F:()=>b});var h=o(316),p=o(5944),n=o(8559);const r=["*"],k=c=>({"hint-box__short":c});function d(c,E){1&c&&n.eu8(0)}function g(c,E){if(1&c&&(n.j41(0,"mat-hint"),n.DNE(1,d,1,0,"ng-container",2),n.k0s()),2&c){n.XpG();const C=n.sdS(4);n.R7$(),n.Y8G("ngTemplateOutlet",C)}}function N(c,E){1&c&&n.eu8(0)}function x(c,E){if(1&c&&(n.j41(0,"mat-error"),n.DNE(1,N,1,0,"ng-container",2),n.k0s()),2&c){n.XpG();const C=n.sdS(4);n.R7$(),n.Y8G("ngTemplateOutlet",C)}}function F(c,E){1&c&&n.SdG(0)}let b=(()=>{class c{constructor(){this.isError=!1,this.isShort=!0}toggleIsShort(){this.isShort=!this.isShort}static#t=this.\u0275fac=function(v){return new(v||c)};static#n=this.\u0275cmp=n.VBU({type:c,selectors:[["app-field-hint"]],inputs:{isError:"isError"},standalone:!0,features:[n.aNF],ngContentSelectors:r,decls:5,vars:4,consts:[["content",""],[1,"hint-box",3,"click","ngClass"],[4,"ngTemplateOutlet"]],template:function(v,_){if(1&v){const T=n.RV6();n.NAR(),n.j41(0,"div",1),n.bIt("click",function(){return n.eBV(T),n.Njj(_.toggleIsShort())}),n.DNE(1,g,2,1)(2,x,2,1),n.k0s(),n.DNE(3,F,1,0,"ng-template",null,0,n.C5r)}if(2&v){let T;n.Y8G("ngClass",n.eq3(2,k,_.isShort)),n.R7$(),n.vxM(1,!1===(T=_.isError)?1:!0===T?2:-1)}},dependencies:[p.RG,p.MV,p.TL,h.YU,h.T3],styles:[".hint-box[_ngcontent-%COMP%]{margin-top:4px}.hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{font-size:12px;display:block}.hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]})}return c})()},9333:(R,S,o)=>{o.d(S,{c:()=>n});var h=o(8559);let n=(()=>{class r{constructor(){}onClick(d){d.stopPropagation()}static#t=this.\u0275fac=function(g){return new(g||r)};static#n=this.\u0275dir=h.FsC({type:r,selectors:[["","appClickStopPropagation",""]],hostBindings:function(g,N){1&g&&h.bIt("click",function(F){return N.onClick(F)})},standalone:!0})}return r})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/17.99.00/dist/ng-edit/projects_eav-ui_src_app_app-administration_sub-dialogs_edit-content-type_edit-content-type_co-2abec4.2fd421094fcd42ac.js.map