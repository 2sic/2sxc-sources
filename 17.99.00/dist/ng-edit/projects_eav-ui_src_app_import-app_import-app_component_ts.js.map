{"version":3,"file":"projects_eav-ui_src_app_import-app_import-app_component_ts.js","mappings":";;;;;;;;;;;;;;;;;AAC2D;AAC4D;AACtD;;;AAc3D,MAAOI,kBAAkB;EAI7BC,YAAqCC,UAAgC,EAAEC,gBAAkC;IAFzG,KAAAC,UAAU,GAAGN,8EAAW,CAACO,GAAG;IAG1BH,UAAU,CAACI,KAAK,KAAK,YAAY;IACjCJ,UAAU,CAACK,WAAW,KAAK;;;;KAI1B;IACDL,UAAU,CAACM,gBAAgB,KAAK,KAAK;IACrCN,UAAU,CAACO,OAAO,KAAMC,KAAK,IAAKP,gBAAgB,CAACQ,SAAS,CAACD,KAAK,CAAC,CAAC,CAAC,EAAEE,SAAS,EAAE,IAAI,CAAC;EACzF;EAAC,QAAAC,CAAA;qBAbUb,kBAAkB,EAAAc,+DAAA,CAITlB,qEAAe,GAAAkB,+DAAA,CAAAE,0EAAA;EAAA;EAAA,QAAAC,EAAA;UAJxBjB,kBAAkB;IAAAkB,SAAA;IAAAC,UAAA;IAAAC,QAAA,GAAAN,gEAAA,CAJlB,CACTf,0EAAgB,CACjB,GAAAe,iEAAA;IAAAS,KAAA;IAAAC,IAAA;IAAAC,MAAA;IAAAC,QAAA,WAAAC,4BAAAC,EAAA,EAAAC,GAAA;MAAA,IAAAD,EAAA;QCfHd,uDAAA,gCAA2E;;;QAAnDA,wDAAA,eAAAe,GAAA,CAAAzB,UAAA,CAAyB;;;mBDW7CP,4FAAyB;IAAAmC,MAAA;EAAA;;;;;;;;;;;;;;;;;;;;;;;AEXiC;AACZ;AAED;AACqD;AAC9C;;;;;AAEjD,MAAMO,aAAa,GAAG,YAAY;AAGnC,MAAOxC,gBAAgB;EAC3BE,YAAoBuC,IAAgB,EAAUC,OAAgB,EAAUC,UAAsB;IAA1E,KAAAF,IAAI,GAAJA,IAAI;IAAsB,KAAAC,OAAO,GAAPA,OAAO;IAAmB,KAAAC,UAAU,GAAVA,UAAU;EAAgB;EAElG/B,SAASA,CAACgC,IAAU,EAAEC,WAAmB,EAAEC,gBAAgB,GAAG,KAAK;IACjE,MAAMC,QAAQ,GAAG,IAAIC,QAAQ,EAAE;IAC/BD,QAAQ,CAACE,MAAM,CAAC,MAAM,EAAEL,IAAI,CAAC;IAC7BG,QAAQ,CAACE,MAAM,CAAC,MAAM,EAAEJ,WAAW,IAAI,EAAE,CAAC;IAC1C,OAAO,IAAI,CAACJ,IAAI,CAACS,IAAI,CAAmB,IAAI,CAACP,UAAU,CAACQ,KAAK,CAACV,IAAI,CAACW,MAAM,CAACZ,aAAa,GAAG,QAAQ,CAAC,EAAEO,QAAQ,EAAE;MAC7GM,MAAM,EAAE;QAAEC,MAAM,EAAE,IAAI,CAACZ,OAAO,CAACY,MAAM,CAACC,QAAQ;MAAE;KACjD,CAAC,CAACC,IAAI,CACLlB,+CAAS,CAACmB,MAAM,IAAG;MACjB,IAAIX,gBAAgB,IAAIW,MAAM,CAACC,QAAQ,CAAC,CAAC,CAAC,EAAEC,WAAW,KAAKpB,yFAAsB,CAACqB,OAAO,EAAE;QAC1F,MAAMC,UAAU,GAAGC,MAAM,CAACL,MAAM,CAACC,QAAQ,CAAC,CAAC,CAAC,CAACK,IAAI,GAAG,0DAA0D,CAAC;QAC/G,IAAIF,UAAU,EAAE;UACd,OAAO,IAAI,CAACjD,SAAS,CAACgC,IAAI,EAAEiB,UAAU,EAAE,IAAI,CAAC;;;MAGjD,OAAOxB,wCAAE,CAACoB,MAAM,CAAC;IACnB,CAAC,CAAC,CACH;EACH;EAAC,QAAA3C,CAAA;qBApBUd,gBAAgB,EAAAe,sDAAA,CAAAE,4DAAA,GAAAF,sDAAA,CAAAkD,6DAAA,GAAAlD,sDAAA,CAAAmD,0DAAA;EAAA;EAAA,QAAAhD,EAAA;WAAhBlB,gBAAgB;IAAAmE,OAAA,EAAhBnE,gBAAgB,CAAAoE;EAAA","sources":["./projects/eav-ui/src/app/import-app/import-app.component.ts","./projects/eav-ui/src/app/import-app/import-app.component.html","./projects/eav-ui/src/app/import-app/services/import-app.service.ts"],"sourcesContent":["import { Component, Inject } from '@angular/core';\r\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\r\nimport { FileUploadDialogComponent, FileUploadDialogData, UploadTypes } from '../shared/components/file-upload-dialog';\r\nimport { ImportAppService } from './services/import-app.service';\r\n\r\n@Component({\r\n  selector: 'app-import-app',\r\n  templateUrl: './import-app.component.html',\r\n  styleUrls: ['./import-app.component.scss'],\r\n  standalone: true,\r\n  imports: [\r\n    FileUploadDialogComponent,\r\n  ],\r\n  providers: [\r\n    ImportAppService,\r\n  ],\r\n})\r\nexport class ImportAppComponent {\r\n\r\n  uploadType = UploadTypes.App;\r\n\r\n  constructor(@Inject(MAT_DIALOG_DATA) dialogData: FileUploadDialogData, importAppService: ImportAppService) {\r\n    dialogData.title ??= `Import App`;\r\n    dialogData.description ??= `\r\n    Select an app package (zip) from your computer to import an app. New apps can be downloaded on\r\n    <a href=\"https://2sxc.org/apps\" target=\"_blank\">https://2sxc.org/apps</a>.\r\n    For further help visit <a href=\"https://2sxc.org/en/help?tag=import-app\" target=\"_blank\">2sxc Help</a>.\r\n    `;\r\n    dialogData.allowedFileTypes ??= 'zip';\r\n    dialogData.upload$ ??= (files) => importAppService.importApp(files[0], undefined, true);\r\n  }\r\n\r\n}\r\n","<app-file-upload-dialog [uploadType]=\"uploadType\"></app-file-upload-dialog>\r\n","import { Context as DnnContext } from '@2sic.com/sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { Observable, of, switchMap } from 'rxjs';\r\nimport { FileUploadMessageTypes, FileUploadResult } from '../../shared/components/file-upload-dialog';\r\nimport { Context } from '../../shared/services/context';\r\n\r\nexport const webApiAppRoot = 'admin/app/';\r\n\r\n@Injectable()\r\nexport class ImportAppService {\r\n  constructor(private http: HttpClient, private context: Context, private dnnContext: DnnContext) { }\r\n\r\n  importApp(file: File, changedName: string, retryOnDuplicate = false): Observable<FileUploadResult> {\r\n    const formData = new FormData();\r\n    formData.append('File', file);\r\n    formData.append('Name', changedName ?? '');\r\n    return this.http.post<FileUploadResult>(this.dnnContext.$2sxc.http.apiUrl(webApiAppRoot + 'Import'), formData, {\r\n      params: { zoneId: this.context.zoneId.toString() }\r\n    }).pipe(\r\n      switchMap(result => {\r\n        if (retryOnDuplicate && result.Messages[0]?.MessageType === FileUploadMessageTypes.Warning) {\r\n          const folderName = prompt(result.Messages[0].Text + ' Would you like to install it using another folder name?');\r\n          if (folderName) {\r\n            return this.importApp(file, folderName, true);\r\n          }\r\n        }\r\n        return of(result);\r\n      }),\r\n    );\r\n  }\r\n}\r\n"],"names":["MAT_DIALOG_DATA","FileUploadDialogComponent","UploadTypes","ImportAppService","ImportAppComponent","constructor","dialogData","importAppService","uploadType","App","title","description","allowedFileTypes","upload$","files","importApp","undefined","_","i0","ɵɵdirectiveInject","i1","_2","selectors","standalone","features","ɵɵProvidersFeature","ɵɵStandaloneFeature","decls","vars","consts","template","ImportAppComponent_Template","rf","ctx","ɵɵelement","ɵɵproperty","styles","Context","DnnContext","HttpClient","of","switchMap","FileUploadMessageTypes","webApiAppRoot","http","context","dnnContext","file","changedName","retryOnDuplicate","formData","FormData","append","post","$2sxc","apiUrl","params","zoneId","toString","pipe","result","Messages","MessageType","Warning","folderName","prompt","Text","ɵɵinject","i2","i3","factory","ɵfac"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}