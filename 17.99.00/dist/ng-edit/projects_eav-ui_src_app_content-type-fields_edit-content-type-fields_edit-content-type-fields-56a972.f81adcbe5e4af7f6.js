"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_content-type-fields_edit-content-type-fields_edit-content-type-fields-56a972"],{4525:(X,b,l)=>{l.r(b),l.d(b,{EditContentTypeFieldsComponent:()=>ze});var r=l(4456),m=l(7941),d=l(5797),S=l(1870),k=l(6647),G=l(271),A=l(1873),E=l(9452),M=l(1567),j=l(1903),D=l(1318),c=l(5392),C=l(819);const N=(n,a)=>(n.push(a),n);function R(){return(0,C.N)((n,a)=>{(function F(n,a){return(0,C.N)((0,c.S)(n,a,arguments.length>=2,!1,!0))})(N,[])(n).subscribe(a)})}const y=/^[A-Za-z][A-Za-z0-9]+$/,V="Standard letters and numbers are allowed. Must start with a letter.";var ne=l(7693),w=l(3176),_=l(2220),H=l(8170),u=l(4007),Y=l(3051);const U={Boolean:{label:(0,u.D)(_.m.Boolean),description:"Yes/no or true/false values"},Custom:{label:(0,u.D)(_.m.Custom),description:"Use for things like gps-pickers (which writes into multiple fields) or for custom-data which serializes something exotic into the db like an array, a custom json or anything"},DateTime:{label:(0,u.D)(_.m.DateTime),description:"For date, time or combined values"},Empty:{label:(0,u.D)(_.m.Empty),description:"Use to structure your form"},Entity:{label:(0,u.D)(_.m.Entity),description:"One or more other content-items"},Hyperlink:{label:(0,u.D)(_.m.Hyperlink),description:"Hyperlink or reference to a picture / file"},Number:{label:(0,u.D)(_.m.Number),description:"Any kind of number"},String:{label:(0,u.D)(_.m.String),description:"Any kind of text"}};var oe=l(4902),e=l(8559),h=l(906),se=l(4858),J=l(8136),ae=l(6838),$=l(852),P=l(316);let L=(()=>{class n{constructor(){this.reservedNames={}}validate(t){if(!t.value)return null;const o=t.value.toLocaleLowerCase(),i=Object.keys(this.reservedNames).find(s=>s.toLocaleLowerCase()===o);return i?{reservedNames:this.reservedNames[i]}:null}static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275dir=e.FsC({type:n,selectors:[["","appReservedNames",""]],inputs:{reservedNames:[e.Mj6.None,"appReservedNames","reservedNames"]},standalone:!0,features:[e.Jv_([{provide:r.cz,useExisting:n,multi:!0}])]})}return n})();var I=l(7984),x=l(5944),O=l(4175),z=l(3777),le=l(3703),Z=l(3758),de=l(5943),W=l(3347);const re=["ngForm"];function ce(n,a){1&n&&(e.j41(0,"th",27)(1,"b"),e.EFF(2,"Content Type"),e.k0s()())}function pe(n,a){if(1&n&&(e.j41(0,"td",28),e.EFF(1),e.k0s()),2&n){const t=a.$implicit;e.R7$(),e.SpI(" ",t.ContentType.Name," ")}}function me(n,a){1&n&&(e.j41(0,"th",27)(1,"b"),e.EFF(2,"Name"),e.k0s()())}function he(n,a){if(1&n&&(e.j41(0,"td",28),e.EFF(1),e.k0s()),2&n){const t=a.$implicit;e.R7$(),e.SpI(" ",t.StaticName," ")}}function fe(n,a){1&n&&(e.j41(0,"th",27)(1,"b"),e.EFF(2,"Type"),e.k0s()())}function ue(n,a){if(1&n&&(e.j41(0,"td",28),e.EFF(1),e.k0s()),2&n){const t=a.$implicit;e.R7$(),e.SpI(" ",t.Type," ")}}function ge(n,a){1&n&&(e.j41(0,"th",27)(1,"b"),e.EFF(2,"Share"),e.k0s()())}function _e(n,a){if(1&n){const t=e.RV6();e.j41(0,"td",28)(1,"button",23),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.selectField(i))}),e.EFF(2,"Select"),e.k0s()()}}function ve(n,a){1&n&&e.nrm(0,"tr",29)}function Ce(n,a){1&n&&e.nrm(0,"tr",30)}function Fe(n,a){1&n&&(e.j41(0,"th",27)(1,"b"),e.EFF(2,"New Name"),e.k0s()())}function ye(n,a){if(1&n&&(e.j41(0,"app-field-hint",33),e.EFF(1),e.k0s()),2&n){const t=e.XpG(3);e.Y8G("isError",!0),e.R7$(),e.JRh(t.fieldNameError)}}function Te(n,a){if(1&n&&(e.j41(0,"app-field-hint",33),e.EFF(1),e.k0s()),2&n){e.XpG(2);const t=e.sdS(5);e.Y8G("isError",!0),e.R7$(),e.SpI(" ",t.errors.reservedNames," ")}}function be(n,a){if(1&n&&e.DNE(0,ye,2,2,"app-field-hint",33)(1,Te,2,2,"app-field-hint",33),2&n){e.XpG();const t=e.sdS(5);e.vxM(0,t.errors.pattern?0:-1),e.R7$(),e.vxM(1,t.errors.reservedNames?1:-1)}}function Se(n,a){if(1&n){const t=e.RV6();e.j41(0,"td",28)(1,"mat-form-field",31)(2,"mat-label"),e.EFF(3,"New Name"),e.k0s(),e.j41(4,"input",32,1),e.mxI("ngModelChange",function(i){const s=e.eBV(t).$implicit;return e.DH7(s.newName,i)||(s.newName=i),e.Njj(i)}),e.k0s()(),e.DNE(6,be,2,2),e.k0s()}if(2&n){const t=a.$implicit,o=a.index,i=e.sdS(5),s=e.XpG();e.R7$(4),e.Y8G("pattern",s.fieldNamePattern),e.R50("ngModel",t.newName),e.Y8G("name","StaticName"+o)("appReservedNames",s.reservedNames),e.R7$(2),e.vxM(6,i.errors?6:-1)}}function Ee(n,a){1&n&&(e.j41(0,"th",27)(1,"b"),e.EFF(2,"Source"),e.k0s()())}function Ne(n,a){if(1&n&&(e.j41(0,"td",34),e.EFF(1),e.k0s()),2&n){const t=a.$implicit;e.R7$(),e.E5c(" ",t.field.ContentType.Name,"/",t.field.StaticName," (",t.field.Type,") ")}}function Re(n,a){1&n&&(e.j41(0,"th",27)(1,"b"),e.EFF(2,"Remove"),e.k0s()())}function xe(n,a){if(1&n){const t=e.RV6();e.j41(0,"td",28)(1,"button",23),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.removeField(i))}),e.EFF(2,"Remove"),e.k0s()()}}function Me(n,a){1&n&&e.nrm(0,"tr",29)}function je(n,a){1&n&&e.nrm(0,"tr",30)}let De=(()=>{class n extends w.${constructor(t,o,i,s,g,p,v){super(),this.dialogData=t,this.dialogRef=o,this.contentTypesFieldsService=i,this.snackBar=s,this.dialog=g,this.viewContainerRef=p,this.changeDetectorRef=v,this.hostClass="dialog-component",this.displayedShareableFieldsColumns=["contentType","name","type","share"],this.displayedSelectedFieldsColumns=["newName","source","remove"],this.shareableFields=new h.I6([]),this.selectedFields=new h.I6([]),this.fieldNamePattern=y,this.fieldNameError=V,this.saving$=new d.t(!1),this.features=(0,e.WQX)(se.D),this.fieldShareConfigManagement=this.features.isEnabled(J.T.FieldShareConfigManagement),this.dialogRef.disableClose=!0,this.subscriptions.add(this.dialogRef.backdropClick().subscribe(()=>{(this.form.dirty||this.selectedFields.data.length>0)&&!confirm("You have unsaved changes. Are you sure you want to close this dialog?")||this.closeDialog()}))}ngOnInit(){this.subscriptions.add(this.contentTypesFieldsService.getShareableFields().subscribe(t=>{this.shareableFields.data=t})),this.subscriptions.add(this.contentTypesFieldsService.getReservedNames().subscribe(t=>{const o={};this.dialogData.existingFields.forEach(i=>{o[i.StaticName]="Field with this name already exists"}),this.reservedNames={...t,...o}}))}ngOnDestroy(){this.saving$.complete(),super.ngOnDestroy()}selectField(t){const o=this.selectedFields.data;o.push({newName:t.StaticName,field:t}),this.selectedFields.data=o}removeField(t){const o=this.selectedFields.data;o.splice(o.indexOf(t),1),this.selectedFields.data=o}save(){this.fieldShareConfigManagement()?(this.saving$.next(!0),this.snackBar.open("Saving..."),(0,E.of)(...this.selectedFields.data).pipe((0,M.p)(t=>!!t.newName),(0,j.H)(t=>this.contentTypesFieldsService.addInheritedField(this.dialogData.contentType.Id,t.field.ContentType.Id,t.field.Guid,t.newName).pipe((0,D.W)(o=>(0,E.of)(null)))),R()).subscribe(t=>{this.saving$.next(!1),this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()})):(0,ae.jr)(this.dialog,J.T.FieldShareConfigManagement,this.viewContainerRef,this.changeDetectorRef)}closeDialog(){this.dialogRef.close()}static#e=this.\u0275fac=function(o){return new(o||n)(e.rXU(m.Vh),e.rXU(m.CP),e.rXU(Y.h6),e.rXU(W.UG),e.rXU(m.bZ),e.rXU(e.c1b),e.rXU(e.gRc))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-add-sharing-fields"]],viewQuery:function(o,i){if(1&o&&e.GBs(re,5,r.cV),2&o){let s;e.mGM(s=e.lsd())&&(i.form=s.first)}},hostVars:1,hostBindings:function(o,i){2&o&&e.Mr5("className",i.hostClass)},standalone:!0,features:[e.Jv_([de.N]),e.Vt3,e.aNF],decls:50,vars:16,consts:[["ngForm","ngForm"],["newName","ngModel"],[1,"eav-dialog","eav-no-scrollbar"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],[1,"eav-tables-div"],[1,"eav-table-div-left"],["mat-table","",1,"eav-fields-table",3,"dataSource"],["matColumnDef","contentType"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","eav-table-cell",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","type"],["matColumnDef","share"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"eav-table-div-right"],["matColumnDef","newName"],["matColumnDef","source"],["mat-cell","","style","word-break:break-all;","class","eav-table-cell",4,"matCellDef"],["matColumnDef","remove"],["align","end"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","submit","color","accent",3,"click","disabled"],[1,"eav-button-feature"],[1,"eav-button-feature-icon",3,"featureNameId"],["mat-header-cell",""],["mat-cell","",1,"eav-table-cell"],["mat-header-row",""],["mat-row",""],["color","accent",1,"eav-mat-form-field"],["matInput","",3,"ngModelChange","pattern","ngModel","name","appReservedNames"],[3,"isError"],["mat-cell","",1,"eav-table-cell",2,"word-break","break-all"]],template:function(o,i){if(1&o){const s=e.RV6();e.j41(0,"div",2)(1,"div",3)(2,"div",4),e.EFF(3),e.nI1(4,"translate"),e.k0s()(),e.j41(5,"div",5)(6,"span"),e.EFF(7),e.nI1(8,"translate"),e.k0s(),e.j41(9,"div",6)(10,"mat-card",7)(11,"table",8),e.qex(12,9),e.DNE(13,ce,3,0,"th",10)(14,pe,2,1,"td",11),e.bVm(),e.qex(15,12),e.DNE(16,me,3,0,"th",10)(17,he,2,1,"td",11),e.bVm(),e.qex(18,13),e.DNE(19,fe,3,0,"th",10)(20,ue,2,1,"td",11),e.bVm(),e.qex(21,14),e.DNE(22,ge,3,0,"th",10)(23,_e,3,0,"td",11),e.bVm(),e.DNE(24,ve,1,0,"tr",15)(25,Ce,1,0,"tr",16),e.k0s()(),e.j41(26,"mat-card",17)(27,"form",null,0)(29,"table",8),e.qex(30,18),e.DNE(31,Fe,3,0,"th",10)(32,Se,7,5,"td",11),e.bVm(),e.qex(33,19),e.DNE(34,Ee,3,0,"th",10)(35,Ne,2,3,"td",20),e.bVm(),e.qex(36,21),e.DNE(37,Re,3,0,"th",10)(38,xe,3,0,"td",11),e.bVm(),e.DNE(39,Me,1,0,"tr",15)(40,je,1,0,"tr",16),e.k0s()()()(),e.j41(41,"mat-dialog-actions",22)(42,"button",23),e.bIt("click",function(){return e.eBV(s),e.Njj(i.closeDialog())}),e.EFF(43,"Cancel"),e.k0s(),e.j41(44,"button",24),e.nI1(45,"async"),e.bIt("click",function(){return e.eBV(s),e.Njj(i.save())}),e.j41(46,"div",25)(47,"span"),e.EFF(48,"Save"),e.k0s(),e.nrm(49,"app-feature-icon-indicator",26),e.k0s()()()()()}if(2&o){const s=e.sdS(28);e.R7$(3),e.SpI(" ",e.bMT(4,10,"SharingOrInheriting.TitleAddFieldsWhichInherit")," "),e.R7$(4),e.JRh(e.bMT(8,12,"SharingOrInheriting.PickFieldsToInheritFrom")),e.R7$(4),e.Y8G("dataSource",i.shareableFields),e.R7$(13),e.Y8G("matHeaderRowDef",i.displayedShareableFieldsColumns),e.R7$(),e.Y8G("matRowDefColumns",i.displayedShareableFieldsColumns),e.R7$(4),e.Y8G("dataSource",i.selectedFields),e.R7$(10),e.Y8G("matHeaderRowDef",i.displayedSelectedFieldsColumns),e.R7$(),e.Y8G("matRowDefColumns",i.displayedSelectedFieldsColumns),e.R7$(4),e.Y8G("disabled",!s.form.valid||0==i.selectedFields.data.length||e.bMT(45,14,i.saving$)),e.R7$(5),e.Y8G("featureNameId","FieldShareConfigManagement")}},dependencies:[z.Hu,z.RN,h.tP,h.Zl,h.tL,h.ji,h.cC,h.YV,h.iL,h.KS,h.$R,h.YZ,h.NB,O.Hl,O.$z,r.YN,r.qT,r.me,r.BC,r.cb,r.R_,r.vS,r.cV,x.RG,x.rl,x.nJ,I.fS,I.fg,L,m.E7,P.Jj,$.h,$.D9,le.s,Z.F],styles:[".eav-tables-div[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;margin-top:4px;padding-top:4px;height:400px}.eav-tables-div[_ngcontent-%COMP%]   .eav-table-div-left[_ngcontent-%COMP%]{width:50%;height:100%;margin-right:4px;overflow-y:auto;border:1px solid rgba(0,0,0,.1)}.eav-tables-div[_ngcontent-%COMP%]   .eav-table-div-right[_ngcontent-%COMP%]{width:50%;height:100%;margin-left:4px;overflow-y:auto;border:1px solid rgba(0,0,0,.1)}.eav-tables-div[_ngcontent-%COMP%]   .eav-table-div-right[_ngcontent-%COMP%]   .eav-mat-form-field[_ngcontent-%COMP%]{max-width:150px}.eav-tables-div[_ngcontent-%COMP%]   .eav-table-cell[_ngcontent-%COMP%]{border-bottom:1px solid rgba(0,0,0,.1)}.eav-tables-div[_ngcontent-%COMP%]   .mat-column-source[_ngcontent-%COMP%]{min-width:150px}.eav-button-feature[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.eav-button-feature[_ngcontent-%COMP%]   .eav-button-feature-icon[_ngcontent-%COMP%]{margin-left:4px;margin-top:6px}"]})}return n})();var Q=l(5060),K=l(3840),B=l(5175),$e=l(5699),Ie=l(9184);const Oe=["ngForm"],ke=n=>({"eav-input-obsolete":n});function Ge(n,a){1&n&&e.EFF(0," Fields ")}function Ae(n,a){1&n&&e.EFF(0," Add Fields ")}function Ve(n,a){1&n&&e.EFF(0," Edit Field ")}function Pe(n,a){if(1&n&&(e.j41(0,"app-field-hint",20),e.EFF(1),e.k0s()),2&n){const t=e.XpG(4);e.Y8G("isError",!0),e.R7$(),e.JRh(t.fieldNameError)}}function Be(n,a){if(1&n&&(e.j41(0,"app-field-hint",20),e.EFF(1),e.k0s()),2&n){e.XpG(2);const t=e.sdS(6);e.Y8G("isError",!0),e.R7$(),e.SpI(" ",t.errors.reservedNames," ")}}function Xe(n,a){if(1&n&&e.DNE(0,Pe,2,2,"app-field-hint",20)(1,Be,2,2,"app-field-hint",20),2&n){e.XpG();const t=e.sdS(6);e.vxM(0,t.errors.pattern?0:-1),e.R7$(),e.vxM(1,t.errors.reservedNames?1:-1)}}function we(n,a){if(1&n&&(e.j41(0,"mat-option",17)(1,"mat-icon",16),e.EFF(2),e.k0s(),e.j41(3,"span"),e.EFF(4),e.k0s()()),2&n){const t=a.$implicit;e.Y8G("value",t.name),e.R7$(2),e.JRh(t.icon),e.R7$(2),e.JRh(t.label)}}function He(n,a){if(1&n&&(e.j41(0,"mat-icon",18),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.icon)}}function Ye(n,a){if(1&n&&(e.j41(0,"mat-option",19)(1,"div")(2,"span"),e.EFF(3),e.k0s(),e.DNE(4,He,2,1,"mat-icon",18),e.k0s()()),2&n){const t=a.$implicit;e.Y8G("value",t.inputType)("ngClass",e.eq3(4,ke,t.isObsolete)),e.R7$(3),e.JRh(t.label),e.R7$(),e.vxM(4,t.icon?4:-1)}}function Ue(n,a){if(1&n){const t=e.RV6();e.j41(0,"div",7)(1,"div",12)(2,"mat-form-field",13)(3,"mat-label"),e.EFF(4,"Name"),e.k0s(),e.j41(5,"input",14,1),e.mxI("ngModelChange",function(i){const s=e.eBV(t).$implicit;return e.DH7(s.StaticName,i)||(s.StaticName=i),e.Njj(i)}),e.k0s()(),e.DNE(7,Xe,2,2),e.k0s(),e.j41(8,"div",12)(9,"mat-form-field",13)(10,"mat-label"),e.EFF(11,"Data Type"),e.k0s(),e.j41(12,"mat-select",15),e.bIt("selectionChange",function(){const i=e.eBV(t).$index,s=e.XpG(2);return s.filterInputTypeOptions(i),s.resetInputType(i),e.Njj(s.calculateHints(i))}),e.mxI("ngModelChange",function(i){const s=e.eBV(t).$implicit;return e.DH7(s.Type,i)||(s.Type=i),e.Njj(i)}),e.j41(13,"mat-select-trigger")(14,"mat-icon",16),e.EFF(15),e.k0s(),e.j41(16,"span"),e.EFF(17),e.k0s()(),e.Z7z(18,we,5,3,"mat-option",17,e.fX1),e.k0s()(),e.j41(20,"app-field-hint"),e.EFF(21),e.k0s()(),e.j41(22,"div",12)(23,"mat-form-field",13)(24,"mat-label"),e.EFF(25,"Input Type"),e.k0s(),e.j41(26,"mat-select",15),e.bIt("selectionChange",function(){const i=e.eBV(t).$index,s=e.XpG(2);return e.Njj(s.calculateHints(i))}),e.mxI("ngModelChange",function(i){const s=e.eBV(t).$implicit;return e.DH7(s.InputType,i)||(s.InputType=i),e.Njj(i)}),e.j41(27,"mat-select-trigger")(28,"span"),e.EFF(29),e.k0s(),e.j41(30,"mat-icon",18),e.EFF(31),e.k0s()(),e.Z7z(32,Ye,5,6,"mat-option",19,e.fX1),e.k0s()(),e.j41(34,"app-field-hint"),e.EFF(35),e.k0s()()()}if(2&n){let t,o;const i=a.$implicit,s=a.$index,g=e.sdS(6),p=e.XpG(2);e.R7$(5),e.Y8G("pattern",p.fieldNamePattern)("appReservedNames",p.reservedNames),e.R50("ngModel",i.StaticName),e.Y8G("name","StaticName"+s)("disabled","inputType"===p.editMode),e.R7$(2),e.vxM(7,g.touched&&g.errors?7:-1),e.R7$(5),e.R50("ngModel",i.Type),e.Y8G("name","Type"+s)("disabled",null!=p.editMode),e.R7$(3),e.JRh(p.findIcon(i.Type)),e.R7$(2),e.JRh(p.findLabel(i.Type)),e.R7$(),e.Dyx(p.dataTypes),e.R7$(3),e.JRh(p.dataTypeHints[s]),e.R7$(5),e.R50("ngModel",i.InputType),e.Y8G("name","InputType"+s)("disabled","name"===p.editMode),e.R7$(3),e.JRh(null==(t=p.getInputTypeOption(i.InputType))?null:t.label),e.R7$(2),e.JRh(null==(o=p.getInputTypeOption(i.InputType))?null:o.icon),e.R7$(),e.Dyx(p.filteredInputTypeOptions[s]),e.R7$(3),e.JRh(p.inputTypeHints[s])}}function Je(n,a){if(1&n){const t=e.RV6();e.j41(0,"button",10),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.addSharedField())}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}2&n&&(e.R7$(),e.JRh(e.bMT(2,1,"SharingOrInheriting.AddSharedField")))}function Le(n,a){if(1&n){const t=e.RV6();e.j41(0,"form",5,0),e.bIt("ngSubmit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.save())}),e.j41(2,"div",6),e.Z7z(3,Ue,36,18,"div",7,e.fX1),e.k0s(),e.j41(5,"mat-dialog-actions"),e.DNE(6,Je,3,3,"button",8),e.nI1(7,"async"),e.nrm(8,"div",9),e.j41(9,"button",10),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.closeDialog())}),e.EFF(10,"Cancel"),e.k0s(),e.j41(11,"button",11),e.nI1(12,"async"),e.EFF(13," Save "),e.k0s()()()}if(2&n){const t=e.sdS(1),o=e.XpG();e.R7$(3),e.Dyx(o.fields),e.R7$(3),e.vxM(6,e.bMT(7,2,o.debugEnabled$)?6:-1),e.R7$(5),e.Y8G("disabled",!t.form.valid||e.bMT(12,4,o.saving$))}}let ze=(()=>{class n extends w.${constructor(t,o,i,s,g,p,v){super(),this.dialogRef=t,this.route=o,this.contentTypesService=i,this.contentTypesFieldsService=s,this.globalConfigService=g,this.snackBar=p,this.dialog=v,this.hostClass="dialog-component",this.fields=[],this.existingFields=[],this.filteredInputTypeOptions=[],this.dataTypeHints=[],this.inputTypeHints=[],this.fieldNamePattern=y,this.fieldNameError=V,this.findIcon=u.y,this.findLabel=u.D,this.loading$=new d.t(!0),this.saving$=new d.t(!1),this.debugEnabled$=this.globalConfigService.getDebugEnabled$(),this.dialogRef.disableClose=!0,this.subscriptions.add(this.dialogRef.backdropClick().subscribe(T=>{this.form.dirty&&!confirm("You have unsaved changes. Are you sure you want to close this dialog?")||this.closeDialog()}))}ngOnInit(){this.editMode=this.route.snapshot.paramMap.get("editMode");const t=this.route.snapshot.paramMap.get("contentTypeStaticName"),o=this.contentTypesService.retrieveContentType(t).pipe((0,S.u)()),i=o.pipe((0,k.n)(v=>this.contentTypesFieldsService.getFields(v.StaticName))),s=this.contentTypesFieldsService.typeListRetrieve().pipe((0,G.T)(v=>function ie(n){const a=[];for(const t of n)a.push({name:t,label:U[t].label,icon:(0,u.y)(t),description:U[t].description});return a}(v))),g=this.contentTypesFieldsService.getInputTypesList(),p=this.contentTypesFieldsService.getReservedNames();(0,A.p)([o,i,s,g,p]).subscribe(([v,T,q,Ze,We])=>{this.contentType=v,this.dataTypes=q,this.inputTypeOptions=Ze,this.existingFields=T;const ee={};if(T.forEach(f=>{ee[f.StaticName]="Field with this name already exists"}),this.reservedNames={...We,...ee},null!=this.editMode){const f=this.route.snapshot.paramMap.get("id")?parseInt(this.route.snapshot.paramMap.get("id"),10):null,te=T.find(Qe=>Qe.Id===f);"name"===this.editMode&&delete this.reservedNames[te.StaticName],this.fields.push(te)}else for(let f=1;f<=8;f++)this.fields.push({Id:0,Type:_.m.String,InputType:H.I.StringDefault,StaticName:"",IsTitle:0===T.length,SortOrder:T.length+f});for(let f=0;f<this.fields.length;f++)this.filterInputTypeOptions(f),this.calculateHints(f);this.loading$.next(!1)})}ngOnDestroy(){this.loading$.complete(),this.saving$.complete(),super.ngOnDestroy()}closeDialog(){this.dialogRef.close()}filterInputTypeOptions(t){this.filteredInputTypeOptions[t]=this.inputTypeOptions.filter(o=>o.dataType===this.fields[t].Type.toLocaleLowerCase())}resetInputType(t){let o=this.fields[t].Type.toLocaleLowerCase()+H.I.DefaultSuffix;this.filteredInputTypeOptions[t].some(s=>s.inputType===o)||(o=this.filteredInputTypeOptions[t][0].inputType),this.fields[t].InputType=o}calculateHints(t){const o=this.dataTypes.find(s=>s.name===this.fields[t].Type),i=this.inputTypeOptions.find(s=>s.inputType===this.fields[t].InputType);this.dataTypeHints[t]=o?.description??"",this.inputTypeHints[t]=i?.isObsolete?`OBSOLETE - ${i.obsoleteMessage}`:i?.description??""}getInputTypeOption(t){return this.inputTypeOptions.find(o=>o.inputType===t)}addSharedField(){this.dialog.open(De,{autoFocus:!1,width:"1600px",data:{contentType:this.contentType,existingFields:this.existingFields}})}save(){if(this.saving$.next(!0),this.snackBar.open("Saving..."),null!=this.editMode){const t=this.fields[0];"name"===this.editMode?this.contentTypesFieldsService.rename(t.Id,this.contentType.Id,t.StaticName).subscribe(()=>{this.saving$.next(!1),this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()}):"inputType"===this.editMode&&this.contentTypesFieldsService.updateInputType(t.Id,t.StaticName,t.InputType).subscribe(()=>{this.saving$.next(!1),this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()})}else(0,E.of)(...this.fields).pipe((0,M.p)(t=>!!t.StaticName),(0,j.H)(t=>this.contentTypesFieldsService.add(t,this.contentType.Id).pipe((0,D.W)(o=>(0,E.of)(null)))),R()).subscribe(t=>{this.saving$.next(!1),this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()})}static#e=this.\u0275fac=function(o){return new(o||n)(e.rXU(m.CP),e.rXU(Ie.nX),e.rXU(ne.g),e.rXU(Y.h6),e.rXU(oe.Bj),e.rXU(W.UG),e.rXU(m.bZ))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-edit-content-type-fields"]],viewQuery:function(o,i){if(1&o&&e.GBs(Oe,5,r.cV),2&o){let s;e.mGM(s=e.lsd())&&(i.form=s.first)}},hostVars:1,hostBindings:function(o,i){2&o&&e.Mr5("className",i.hostClass)},standalone:!0,features:[e.Vt3,e.aNF],decls:8,vars:6,consts:[["ngForm","ngForm"],["staticName","ngModel"],["appToggleDebug","",1,"eav-dialog","eav-no-scrollbar"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[3,"ngSubmit"],[1,"eav-dialog-content"],[1,"eav-row-container"],["mat-raised-button","","type","button"],[1,"spacer"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","submit","color","accent",3,"disabled"],[1,"eav-edit-input"],["color","accent",1,"eav-mat-form-field"],["matInput","",3,"ngModelChange","pattern","appReservedNames","ngModel","name","disabled"],[3,"selectionChange","ngModelChange","ngModel","name","disabled"],[1,"eav-type-icon"],[3,"value"],[1,"eav-input-icon"],[3,"value","ngClass"],[3,"isError"]],template:function(o,i){1&o&&(e.j41(0,"div",2)(1,"div",3)(2,"div",4),e.DNE(3,Ge,1,0)(4,Ae,1,0)(5,Ve,1,0),e.k0s()(),e.DNE(6,Le,14,6,"form"),e.nI1(7,"async"),e.k0s()),2&o&&(e.R7$(3),e.vxM(3,void 0===i.editMode?3:-1),e.R7$(),e.vxM(4,null===i.editMode?4:-1),e.R7$(),e.vxM(5,null!=i.editMode?5:-1),e.R7$(),e.vxM(6,!1===e.bMT(7,4,i.loading$)?6:-1))},dependencies:[r.YN,r.qT,r.me,r.BC,r.cb,r.R_,r.vS,r.cV,x.RG,x.rl,x.nJ,I.fS,I.fg,L,B.Ve,B.VO,B.$2,Q.wT,K.m_,K.An,Q.Sy,P.YU,m.E7,O.Hl,O.$z,P.Jj,$.h,$.D9,Z.F,$e.V],styles:[".eav-row-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.eav-edit-input[_ngcontent-%COMP%]{padding-bottom:8px;width:30%}.eav-type-icon[_ngcontent-%COMP%]{width:inherit;height:inherit;margin-right:8px;font-size:inherit;vertical-align:top;line-height:inherit}.eav-input-icon[_ngcontent-%COMP%]{width:inherit;height:inherit;margin-left:8px;font-size:inherit;vertical-align:top;line-height:inherit}.eav-input-obsolete[_ngcontent-%COMP%]{-webkit-text-decoration:black line-through;text-decoration:black line-through;color:#696969}"]})}return n})()},3758:(X,b,l)=>{l.d(b,{F:()=>D});var r=l(316),m=l(5944),d=l(8559);const S=["*"],k=c=>({"hint-box__short":c});function G(c,C){1&c&&d.eu8(0)}function A(c,C){if(1&c&&(d.j41(0,"mat-hint"),d.DNE(1,G,1,0,"ng-container",2),d.k0s()),2&c){d.XpG();const F=d.sdS(4);d.R7$(),d.Y8G("ngTemplateOutlet",F)}}function E(c,C){1&c&&d.eu8(0)}function M(c,C){if(1&c&&(d.j41(0,"mat-error"),d.DNE(1,E,1,0,"ng-container",2),d.k0s()),2&c){d.XpG();const F=d.sdS(4);d.R7$(),d.Y8G("ngTemplateOutlet",F)}}function j(c,C){1&c&&d.SdG(0)}let D=(()=>{class c{constructor(){this.isError=!1,this.isShort=!0}toggleIsShort(){this.isShort=!this.isShort}static#e=this.\u0275fac=function(N){return new(N||c)};static#t=this.\u0275cmp=d.VBU({type:c,selectors:[["app-field-hint"]],inputs:{isError:"isError"},standalone:!0,features:[d.aNF],ngContentSelectors:S,decls:5,vars:4,consts:[["content",""],[1,"hint-box",3,"click","ngClass"],[4,"ngTemplateOutlet"]],template:function(N,R){if(1&N){const y=d.RV6();d.NAR(),d.j41(0,"div",1),d.bIt("click",function(){return d.eBV(y),d.Njj(R.toggleIsShort())}),d.DNE(1,A,2,1)(2,M,2,1),d.k0s(),d.DNE(3,j,1,0,"ng-template",null,0,d.C5r)}if(2&N){let y;d.Y8G("ngClass",d.eq3(2,k,R.isShort)),d.R7$(),d.vxM(1,!1===(y=R.isError)?1:!0===y?2:-1)}},dependencies:[m.RG,m.MV,m.TL,r.YU,r.T3],styles:[".hint-box[_ngcontent-%COMP%]{margin-top:4px}.hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{font-size:12px;display:block}.hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]})}return c})()},519:(X,b,l)=>{function r(m){const d=document.createElement("textarea");d.value=m,d.setAttribute("readonly",""),d.style.position="absolute",d.style.left="-9999px",document.body.appendChild(d);const S=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);d.select(),document.execCommand("copy"),document.body.removeChild(d),S&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(S))}l.d(b,{l:()=>r})}}]);
//# sourceMappingURL=https://sources.2sxc.org/17.99.00/dist/ng-edit/projects_eav-ui_src_app_content-type-fields_edit-content-type-fields_edit-content-type-fields-56a972.f81adcbe5e4af7f6.js.map