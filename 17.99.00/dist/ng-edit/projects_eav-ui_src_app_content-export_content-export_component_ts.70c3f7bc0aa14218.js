"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_content-export_content-export_component_ts"],{2743:(P,E,e)=>{e.d(E,{b:()=>_});var d=e(271),C=e(6301),m=e(8764),f=e(4902),x=e(8873),v=e(4858),O=e(4979),M=e(3472),c=e(8559),D=e(6443);let _=(()=>{class t extends O.V{constructor(r,n,i,g){super(new M.B("AppDialogConfigService",!1)),this.http=r,this.context=n,this.globalConfigService=i,this.dialogSettings$={},this.log.a(`using context #${this.context.log.svcId}`),g.loadFromService(this)}ngOnDestroy(){super.destroy()}getCurrent$(){const r=this.context.appId;return this.log.a(`getCurrent$ - appId:${r}`),this.getShared$(r)}getSitePrimaryApp$(){return this.getCurrent$().pipe((0,d.T)(r=>r?.Context.Site.PrimaryApp))}getGlobalPrimaryApp$(){return this.getCurrent$().pipe((0,d.T)(r=>r?.Context.System.PrimaryApp))}getShared$(r){return this.log.a("getShared$ appId: "+r),this.dialogSettings$[r]??=this.getDialogSettings(r,"getShared$").pipe((0,C.t)({refCount:!1})),this.dialogSettings$[r]}getDialogSettings(r,n){return this.log.a("getDialogSettings",{appId:r,reqBy:n}),this.http.get("admin/dialog/settings",{params:{appId:r??this.context.appId.toString()}}).pipe((0,d.T)(i=>(i.Context.Language.List=i.Context.Language.List.filter(g=>g.IsEnabled),i)),(0,m.M)(i=>{this.globalConfigService.allowDebug(i.Context.Enable.DebugMode)}))}static#t=this.\u0275fac=function(n){return new(n||t)(c.KVO(D.Qq),c.KVO(x.o),c.KVO(f.Bj),c.KVO(v.D))};static#e=this.\u0275prov=c.jDH({token:t,factory:t.\u0275fac})}return t})()},7693:(P,E,e)=>{e.d(E,{X:()=>v,g:()=>t});var d=e(271),C=e(8873),m=e(8559),f=e(6443),x=e(4821);const v="admin/type/",c="admin/type/scopes";let t=(()=>{class u{constructor(n,i,g){this.http=n,this.context=i,this.dnnContext=g}apiUrl(n){return this.dnnContext.$2sxc.http.apiUrl(n)}retrieveContentType(n){return this.http.get(this.apiUrl("admin/type/get"),{params:{appId:this.context.appId.toString(),contentTypeId:n}})}retrieveContentTypes(n){return this.http.get(this.apiUrl("admin/type/list"),{params:{appId:this.context.appId.toString(),scope:n}})}getScopes(){return this.http.get(this.apiUrl(c),{params:{appId:this.context.appId.toString()}}).pipe((0,d.T)(n=>{const i=n.old;return Object.keys(i).map(p=>({name:i[p],value:p}))}))}getScopesV2(){return this.http.get(this.apiUrl(c),{params:{appId:this.context.appId.toString()}}).pipe((0,d.T)(n=>n.scopes))}save(n){return this.http.post(this.apiUrl("admin/type/save"),n,{params:{appid:this.context.appId.toString()}})}delete(n){return this.http.delete(this.apiUrl("admin/type/delete"),{params:{appid:this.context.appId.toString(),staticName:n.StaticName}})}import(n){const i=new FormData;for(const g of n)i.append("File",g);return this.http.post(this.apiUrl("admin/type/import"),i,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}createGhost(n){return this.http.post(this.apiUrl("admin/type/addghost"),null,{params:{appid:this.context.appId.toString(),sourceStaticName:n}})}static#t=this.\u0275fac=function(i){return new(i||u)(m.KVO(f.Qq),m.KVO(C.o),m.KVO(x.ob))};static#e=this.\u0275prov=m.jDH({token:u,factory:u.\u0275fac})}return u})()},5727:(P,E,e)=>{e.r(E),e.d(E,{ContentExportComponent:()=>g});var d=e(7941),C=e(5797),m=e(1873),f=e(2743),x=e(7693),v=e(6360),O=e(316),M=e(4175),c=e(3804),D=e(5060),I=e(5175),h=e(5944),_=e(4456),t=e(8559),u=e(9184);function r(p,T){if(1&p&&(t.j41(0,"mat-option",10),t.EFF(1),t.k0s()),2&p){const s=T.$implicit;t.Y8G("value",s.NameId),t.R7$(),t.JRh(s.NameId)}}function n(p,T){if(1&p&&(t.j41(0,"mat-radio-button",15),t.EFF(1),t.k0s()),2&p){const s=t.XpG(2);t.R7$(),t.SpI(" Export selected ",s.itemIds.length," items ")}}function i(p,T){if(1&p){const s=t.RV6();t.j41(0,"form",null,0)(2,"div",4)(3,"p"),t.EFF(4," This will generate an XML file which you can edit in Excel. If you just want to import new data, use this to export the schema that you can then fill in using Excel. Please visit "),t.j41(5,"a",5),t.EFF(6,"https://2sxc.org/help"),t.k0s(),t.EFF(7," for more instructions. "),t.k0s(),t.j41(8,"div",6)(9,"div")(10,"mat-form-field",7)(11,"mat-label"),t.EFF(12,"Languages"),t.k0s(),t.j41(13,"mat-select",8),t.mxI("ngModelChange",function(o){t.eBV(s);const l=t.XpG();return t.DH7(l.formValues.language,o)||(l.formValues.language=o),t.Njj(o)}),t.j41(14,"mat-option",9),t.EFF(15,"All"),t.k0s(),t.Z7z(16,r,2,2,"mat-option",10,t.fX1),t.k0s()()(),t.j41(18,"div")(19,"p",11),t.EFF(20,"Export data"),t.k0s(),t.j41(21,"mat-radio-group",12),t.mxI("ngModelChange",function(o){t.eBV(s);const l=t.XpG();return t.DH7(l.formValues.recordExport,o)||(l.formValues.recordExport=o),t.Njj(o)}),t.j41(22,"mat-radio-button",13),t.EFF(23,"No, just export blank data schema (for new data import) "),t.k0s(),t.j41(24,"mat-radio-button",14),t.EFF(25,"Yes, export all content-items"),t.k0s(),t.DNE(26,n,2,1,"mat-radio-button",15),t.k0s()(),t.j41(27,"div")(28,"p",11),t.EFF(29,"Value references to other languages"),t.k0s(),t.j41(30,"mat-radio-group",16),t.mxI("ngModelChange",function(o){t.eBV(s);const l=t.XpG();return t.DH7(l.formValues.languageReferences,o)||(l.formValues.languageReferences=o),t.Njj(o)}),t.j41(31,"mat-radio-button",17),t.EFF(32,"Keep references to other languages (for re-import) "),t.k0s(),t.j41(33,"mat-radio-button",18),t.EFF(34,"Replace references with values"),t.k0s()()(),t.j41(35,"div")(36,"p",11),t.EFF(37,"File / page references"),t.k0s(),t.j41(38,"mat-radio-group",19),t.mxI("ngModelChange",function(o){t.eBV(s);const l=t.XpG();return t.DH7(l.formValues.resourcesReferences,o)||(l.formValues.resourcesReferences=o),t.Njj(o)}),t.j41(39,"mat-radio-button",17),t.EFF(40,"Keep references (for re-import, for example Page:4711) "),t.k0s(),t.j41(41,"mat-radio-button",18),t.EFF(42,"Replace references with real URLs (for example /Portals/0...) "),t.k0s()()()()(),t.j41(43,"mat-dialog-actions",20)(44,"button",21),t.bIt("click",function(){t.eBV(s);const o=t.XpG();return t.Njj(o.closeDialog())}),t.EFF(45,"Cancel"),t.k0s(),t.j41(46,"button",22),t.bIt("click",function(){t.eBV(s);const o=t.XpG();return t.Njj(o.exportContent())}),t.EFF(47," Export Data "),t.k0s()()()}if(2&p){const s=t.sdS(1),a=t.XpG();t.R7$(13),t.R50("ngModel",a.formValues.language),t.R7$(3),t.Dyx(a.languages),t.R7$(5),t.R50("ngModel",a.formValues.recordExport),t.R7$(5),t.vxM(26,a.hasIdList?26:-1),t.R7$(4),t.R50("ngModel",a.formValues.languageReferences),t.Y8G("disabled","Blank"===a.formValues.recordExport),t.R7$(8),t.R50("ngModel",a.formValues.resourcesReferences),t.Y8G("disabled","Blank"===a.formValues.recordExport),t.R7$(8),t.Y8G("disabled",!s.form.valid)}}let g=(()=>{class p{constructor(s,a,o,l,y){this.dialogRef=s,this.route=a,this.contentExportService=o,this.appDialogConfigService=l,this.contentTypesService=y,this.hostClass="dialog-component",this.hasIdList=!1,this.loading$=new C.t(!1),this.contentType$=new C.t(null),this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName");const R=this.route.snapshot.paramMap.get("selectedIds");this.hasIdList=!!R,this.hasIdList&&(this.itemIds=R.split(",").map(L=>parseInt(L,10)))}ngOnInit(){this.loading$.next(!0);const s=this.contentTypesService.retrieveContentType(this.contentTypeStaticName),a=this.appDialogConfigService.getCurrent$();(0,m.p)([s,a]).subscribe(([o,l])=>{this.contentType$.next(o),this.languages=l.Context.Language.List,this.formValues={defaultLanguage:l.Context.Language.Primary,contentTypeStaticName:this.contentTypeStaticName,language:"",recordExport:this.hasIdList?"Selection":"All",languageReferences:"Link",resourcesReferences:"Link"},this.loading$.next(!1)})}ngOnDestroy(){this.contentType$.complete(),this.loading$.complete()}closeDialog(){this.dialogRef.close()}exportContent(){this.contentExportService.exportContent(this.formValues,this.hasIdList&&"Selection"===this.formValues.recordExport?this.itemIds:null)}static#t=this.\u0275fac=function(a){return new(a||p)(t.rXU(d.CP),t.rXU(u.nX),t.rXU(v.D),t.rXU(f.b),t.rXU(x.g))};static#e=this.\u0275cmp=t.VBU({type:p,selectors:[["app-content-export"]],hostVars:1,hostBindings:function(a,o){2&a&&t.Mr5("className",o.hostClass)},standalone:!0,features:[t.Jv_([v.D,x.g,f.b]),t.aNF],decls:7,vars:6,consts:[["ngForm","ngForm"],[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],["href","https://2sxc.org/help","target","_blank"],[1,"dialog-form-content","fancy-scrollbar-light"],["color","accent",1,"eav-mat-form-field"],["name","Language",3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"eav-radio-group-label"],["name","RecordExport",1,"eav-radio-group",3,"ngModelChange","ngModel"],["value","Blank"],["value","All"],["value","Selection"],["name","LanguageReferences",1,"eav-radio-group",3,"ngModelChange","ngModel","disabled"],["value","Link"],["value","Resolve"],["name","ResourcesReferences",1,"eav-radio-group",3,"ngModelChange","ngModel","disabled"],["align","end"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"click","disabled"]],template:function(a,o){if(1&a&&(t.j41(0,"div",1)(1,"div",2)(2,"div",3),t.EFF(3),t.nI1(4,"async"),t.k0s()(),t.DNE(5,i,48,8,"form"),t.nI1(6,"async"),t.k0s()),2&a){let l;t.R7$(3),t.SpI("Export ",null==(l=t.bMT(4,2,o.contentType$))?null:l.Name,""),t.R7$(2),t.vxM(5,!1===t.bMT(6,4,o.loading$)?5:-1)}},dependencies:[_.YN,_.qT,_.BC,_.cb,_.vS,_.cV,h.RG,h.rl,h.nJ,I.Ve,I.VO,D.wT,D.Sy,c.Wk,c.VT,c._g,d.E7,M.Hl,M.$z,O.Jj],styles:[".eav-radio-group-label[_ngcontent-%COMP%]{font-size:18px;margin:24px 0 0}.eav-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:8px 0}"]})}return p})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/17.99.00/dist/ng-edit/projects_eav-ui_src_app_content-export_content-export_component_ts.70c3f7bc0aa14218.js.map