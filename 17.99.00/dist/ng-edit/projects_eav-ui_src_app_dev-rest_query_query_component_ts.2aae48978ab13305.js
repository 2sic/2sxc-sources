"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_dev-rest_query_query_component_ts"],{3791:(lt,F,n)=>{n.r(F),n.d(F,{DevRestQueryComponent:()=>nt});var $=n(9184),R=n(5797),v=n(9999),x=n(271),I=n(1870),l=n(1961),C=n(5445),j=n(4096),S=n(52),w=n(8873),M=n(1091);function G(a,r,e,s,i,d,o){const u="/"!==s[0]&&!s.startsWith("http");o&&o.length&&"?"!==o[0]&&(o="?"+o);const m=u?`${o}${o?"&":"?"}PageId=${e.tabId}&ModuleId=${e.moduleId}`:"",p=a.http.apiUrl(s)+m,y=s+o,c=`${s}/${d??"Default"}${o}`;return[new l.b2(u,"GET",y,"read all query streams","Read list of all items",!0,E(r,y,e),p),new l.b2(u,"GET",c,"read only Stream Default","Read list of all items",!0,E(r,c,e),p)]}function E(a,r,e,s){const i=e.moduleId,d="/"!==r[0],o=[],u=`${r}?PageId=${e.tabId}&ModuleId=${i}`;a.inSameContext&&o.push(new l.EI("Example with global $2sxc and event-context","This example finds the context information from the HTML where an action started.",`\n<button onclick="$2sxc(this).webApi.get('${r}').then(data => console.log(data))">\n  get it\n</button>`,!1,[l.Ms])),a.in2sxc&&o.push(new l.EI(`Example with global $2sxc and a Module-Id ${i}`,"This is how you get the context when your code doesn't start with a DOM context, so you need the moduleId.",`\n// get the sxc-controller for this module\nvar sxc = $2sxc(${i});\n// now get the data in the promise\nsxc.webApi.get('${r}')\n  .then(data => {\n    console.log(data)\n  });`,!1,[l.Ms]),new l.EI("Same example as one-liner","This is the same as above, but as a one-liner so you can run it directly in the F12 console right now.",`$2sxc(${i}).webApi.get('${r}').then(data => console.log('just got:', data));`,!0)),a.in2sxc&&a.inSameContext&&o.push(new l.EI("Example where you get the Module-Id from Razor","This example doesn't use a fixed moduleId but let's the Razor add the current moduleId when the page is rendered.",`\n// this will be replaced on the server with the ID\nvar moduleId = @Dnn.Module.ModuleID;\nvar sxc = $2sxc(moduleId);\nvar promise = sxc.webApi.get('${r}');`,!1,[l.Ms]));const m=d?`$2sxc.http.apiUrl('${r}')`:`'${r}'`,p=d?`$2sxc.http.apiUrl('${u}')`:`'${u}'`;return a.inSameSite?(o.push(new l.EI("Using jQuery inside DNN","This example uses jQuery instead of the $2sxc to do the AJAX call.\n      It shows you how to resolve the virtual path for use in other ways.",`\nvar endpoint = ${m};\n$.ajax({\n  url:endpoint,\n  beforeSend: $.dnnSF(${i}).setModuleHeaders\n}).then(data => {\n  console.log('Got this data:', data);\n})`,!1,[])),o.push(new l.EI("Using jQuery as single-liner","The same example as above, just as single-liner so you can test it directly in the F12 console.\n      This will only work if you're on a DNN page with this module.",`$.ajax({url: ${m}, beforeSend: $.dnnSF(${i}).setModuleHeaders }).then(data => console.log(data))`,!1,[])),o.push(new l.EI("Using jQuery and add Context in URL","This example uses jQuery instead of the $2sxc to do the AJAX call.\n      But instead of using the DNN Services Framework it adds relevant headers to the url.",`\n$.ajax(${p}).then(data => {\n  console.log('Got this data:', data);\n})`,!1,[])),o.push(new l.EI("Using jQuery with url-context as single-liner","The same example as above, just as single-liner so you can test it directly in the F12 console.\n      This will work on a DNN page which has jQuery activated. ",`$.ajax(${p}).then(data => console.log(data))`,!1,[]))):(o.push(new l.EI("Using jQuery in another Site or External","This example uses jQuery and doesn't use $2sxc or the DNN ServicesFramework,\n      because they would be either missing, or give wrong context-headers.",`\n$.ajax('${r}').then(data => {\n  console.log('Got this data:', data);\n})`,!1,[l.Qd])),o.push(new l.EI("Using jQuery with Context in URL","This example uses jQuery and includes a module-context. This is unusual for external access, but may be needed sometime.",`\n$.ajax('${u}').then(data => {\n  console.log('Got this data:', data);\n})`,!1,[l.Qd]))),o}var P=n(316),U=n(1585),X=n(1426),A=n(5630),Q=n(7984),T=n(5944),k=n(2422),O=n(6768),t=n(8559);let V=(()=>{class a{constructor(){this.scenarios=l.vm}ngOnInit(){}static#t=this.\u0275fac=function(s){return new(s||a)};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["app-dev-query-introduction"]],inputs:{data:"data"},standalone:!0,features:[t.aNF],decls:12,vars:0,consts:[["href","https://docs.2sxc.org/index.html","target","_blank"],["href","https://docs.2sxc.org/basics/query/index.html","target","_blank"],["href","https://docs.2sxc.org/web-api/query-rest-web-api.html","target","_blank"]],template:function(s,i){1&s&&(t.j41(0,"p"),t.EFF(1," To learn more about queries you may want to read these "),t.j41(2,"a",0),t.EFF(3,"docs"),t.k0s(),t.EFF(4,":\n"),t.k0s(),t.j41(5,"ul")(6,"li")(7,"a",1),t.EFF(8,"Queries in 2sxc"),t.k0s()(),t.j41(9,"li")(10,"a",2),t.EFF(11,"Query REST API"),t.k0s()()())},encapsulation:2})}return a})();var f=n(8223),Y=n(1708),D=n(3840),N=n(4175),B=n(7319),L=n(4601),H=n(5437),z=n(7941),J=n(4821);function W(a,r){if(1&a){const e=t.RV6();t.j41(0,"button",16),t.bIt("click",function(){t.eBV(e);const i=t.XpG(2);return t.Njj(i.closeDialog())}),t.j41(1,"mat-icon"),t.EFF(2,"close"),t.k0s()()}}function K(a,r){1&a&&(t.j41(0,"div",17)(1,"mat-icon"),t.EFF(2,"emoji_objects"),t.k0s(),t.j41(3,"span"),t.EFF(4,"Introduction"),t.k0s()())}function _(a,r){if(1&a&&(t.j41(0,"div",18)(1,"mat-icon"),t.EFF(2,"code_curly"),t.k0s(),t.j41(3,"span"),t.EFF(4),t.k0s()()),2&a){const e=t.XpG();t.Y8G("tippy",(e.scenario.useVirtual?"Virtual ":"Absolute ")+"REST URLs"),t.R7$(4),t.SpI("Call ",e.scenario.useVirtual?"Virtual":"Absolute"," REST URLs")}}function Z(a,r){1&a&&(t.j41(0,"mat-icon"),t.EFF(1,"warning"),t.k0s())}function q(a,r){if(1&a&&(t.j41(0,"div",19)(1,"mat-icon"),t.EFF(2,"person"),t.k0s(),t.j41(3,"span"),t.EFF(4),t.k0s(),t.DNE(5,Z,2,0,"mat-icon"),t.k0s()),2&a){const e=t.XpG();t.R7$(4),t.SpI("Permissions (",e.permissions.length,")"),t.R7$(),t.vxM(5,e.permissions.length?-1:5)}}function tt(a,r){1&a&&(t.j41(0,"div",20)(1,"mat-icon"),t.EFF(2,"perm_device_information"),t.k0s(),t.j41(3,"span"),t.EFF(4,"HTTP headers & \xa0"),t.j41(5,"code"),t.EFF(6,"/auto/"),t.k0s()()())}function et(a,r){if(1&a){const e=t.RV6();t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.EFF(3,"Using REST with Query:\xa0 "),t.j41(4,"code"),t.EFF(5),t.k0s()(),t.DNE(6,W,3,0,"button",3),t.k0s(),t.j41(7,"div",4),t.nrm(8,"router-outlet"),t.j41(9,"app-selector-with-help",5),t.bIt("valueChange",function(i){t.eBV(e);const d=t.XpG();return t.Njj(d.changeScenario(i))}),t.k0s(),t.j41(10,"mat-tab-group",6)(11,"mat-tab"),t.DNE(12,K,5,0,"div",7),t.nrm(13,"app-dev-query-introduction",8)(14,"app-dev-rest-tab-introduction",8),t.k0s(),t.j41(15,"mat-tab"),t.DNE(16,_,5,2,"div",9),t.nrm(17,"app-dev-rest-tab-examples-intro",8),t.j41(18,"div",10)(19,"mat-form-field",11)(20,"mat-label"),t.EFF(21,"Stream Name(s) to Limit, comma-separated"),t.k0s(),t.j41(22,"input",12),t.bIt("input",function(i){t.eBV(e);const d=t.XpG();return t.Njj(d.updateStreams(i))}),t.k0s()(),t.j41(23,"mat-form-field",11)(24,"mat-label"),t.EFF(25,"Additional Url Parameters"),t.k0s(),t.j41(26,"input",13),t.bIt("input",function(i){t.eBV(e);const d=t.XpG();return t.Njj(d.updateParams(i))}),t.k0s()()(),t.nrm(27,"app-dev-rest-urls-and-code",8),t.k0s(),t.j41(28,"mat-tab"),t.DNE(29,q,6,2,"div",14),t.nrm(30,"app-dev-rest-tab-permissions",8),t.k0s(),t.j41(31,"mat-tab"),t.DNE(32,tt,7,0,"div",15),t.nrm(33,"app-dev-rest-tab-headers",8),t.k0s()()()()}if(2&a){const e=r,s=t.XpG();t.R7$(5),t.JRh(e.name),t.R7$(),t.vxM(6,s.isSideNavContent?-1:6),t.R7$(3),t.Y8G("items",s.scenarios)("value",e.scenario.key),t.R7$(4),t.Y8G("data",e),t.R7$(),t.Y8G("data",e),t.R7$(3),t.Y8G("data",e),t.R7$(5),t.Y8G("value",s.streamNames$.value),t.R7$(4),t.Y8G("value",s.urlParams$.value),t.R7$(),t.Y8G("data",e),t.R7$(3),t.Y8G("data",e),t.R7$(3),t.Y8G("data",e)}}let nt=(()=>{class a extends M.n{constructor(e,s,i,d,o,u,m){super(e,s,i,m,d,o,u),this.hostClass="dialog-component",this.pipelinesService=(0,H.d)(C.xR),this.urlParams$=new R.t(""),this.streamNames$=new R.t("Default"),this.isSideNavContent=this.router.url.includes(l.N5.routeQuery);const p=(0,v.z)([o.paramMap.pipe((0,x.T)(c=>c.get(l.N5.paramQuery))),this.pipelinesService.getAll(S.YX.contentTypes.query).pipe((0,I.u)())]).pipe((0,x.T)(([c,h])=>h.find(g=>g.Guid===c)),(0,I.u)());this.permissions$=this.buildPermissionStream(l.N5.paramQuery);const y=(0,v.z)([p,this.scenario$,this.dialogSettings$]).pipe((0,x.T)(([c,h,g])=>{const b="app/{appname}/query/{queryname}".replace("{queryname}",c.Name).replace("{appname}",h.inSameContext?"auto":encodeURI(g.Context.App.Folder));return this.rootBasedOnScenario(b,h)}));this.viewModel$=(0,v.z)([(0,v.z)([p,this.scenario$,this.permissions$]),(0,v.z)([y,this.dialogSettings$]),(0,v.z)([this.streamNames$,this.urlParams$])]).pipe((0,x.T)(([[c,h,g],[b,st],[ot,it]])=>({...this.buildBaseViewModel(c.Name,c.Guid,st,g,b,h),query:c,apiCalls:G(m.$2sxc,h,s,b,0,ot,it)})))}updateStreams(e){this.streamNames$.next(e.target.value)}updateParams(e){this.urlParams$.next(e.target.value)}static#t=this.\u0275fac=function(s){return new(s||a)(t.rXU(C.bd),t.rXU(w.o),t.rXU(z.CP),t.rXU($.Ix),t.rXU($.nX),t.rXU(j.Kn),t.rXU(J.ob))};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["app-dev-rest-query"]],hostVars:1,hostBindings:function(s,i){2&s&&t.Mr5("className",i.hostClass)},standalone:!0,features:[t.Jv_([j.Kn,B.T,C.bd,j.TI]),t.Vt3,t.aNF],decls:2,vars:3,consts:[[1,"eav-dialog","eav-no-scrollbar"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog"],[1,"eav-dialog-content"],["label","Choose Scenario",3,"valueChange","items","value"],["dynamicHeight","","color","accent",1,"mat-tab-group-fit-height","mat-tab-group-fancy-scrollbar","default-fonts"],["class","mat-tab-label-box","tippy","Introduction",4,"matTabLabel"],[3,"data"],["class","mat-tab-label-box",3,"tippy",4,"matTabLabel"],[1,"params-form"],["color","accent",1,"eav-mat-form-field"],["matInput","","placeholder","Default",3,"input","value"],["matInput","","placeholder","?id=27",3,"input","value"],["class","mat-tab-label-box","tippy","Permissions",4,"matTabLabel"],["class","mat-tab-label-box","tippy","HTTP headers and auto",4,"matTabLabel"],["mat-icon-button","","tippy","Close dialog",3,"click"],["tippy","Introduction",1,"mat-tab-label-box"],[1,"mat-tab-label-box",3,"tippy"],["tippy","Permissions",1,"mat-tab-label-box"],["tippy","HTTP headers and auto",1,"mat-tab-label-box"]],template:function(s,i){if(1&s&&(t.DNE(0,et,34,12,"div",0),t.nI1(1,"async")),2&s){let d;t.vxM(0,(d=t.bMT(1,1,i.viewModel$))?0:-1,d)}},dependencies:[N.Hl,N.iY,L.e,D.m_,D.An,$.n3,Y.Y,f.RI,f.ES,f.mq,f.T8,V,O.M,k.R,T.RG,T.rl,T.nJ,Q.fS,Q.fg,A.X,X.Q,U.J,P.Jj],styles:["[_nghost-%COMP%]     code, code[_ngcontent-%COMP%], pre[_ngcontent-%COMP%]{padding-left:2px;padding-right:2px;background-color:#eee}pre[_ngcontent-%COMP%]{white-space:pre-wrap;word-break:keep-all}.rest-urls-accordion[_ngcontent-%COMP%]{display:block;margin:8px}.rest-urls-title[_ngcontent-%COMP%]{display:flex;align-items:center}.code-example[_ngcontent-%COMP%]{position:relative}.code-example__text[_ngcontent-%COMP%]{min-height:40px}.code-example__copy[_ngcontent-%COMP%]{position:absolute;top:0;right:0}.params-form[_ngcontent-%COMP%]{display:flex;max-width:600px}.params-form[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]:not(:first-of-type){margin-left:8px}.form-with-textarea[_ngcontent-%COMP%]{max-width:600px}"]})}return a})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/17.99.00/dist/ng-edit/projects_eav-ui_src_app_dev-rest_query_query_component_ts.2aae48978ab13305.js.map