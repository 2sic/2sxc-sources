import"./chunk-HGGQ62BE.js";import{a as oe}from"./chunk-XVKX7JBO.js";import{a as ie}from"./chunk-WO7E65AC.js";import{a as ne}from"./chunk-SXZJT35J.js";import{a as X,e as u}from"./chunk-RAUQWANF.js";import{a as Y}from"./chunk-3S44UA6M.js";import{b as ee,d as te}from"./chunk-S7Y6G6OZ.js";import"./chunk-T2Q2H5HY.js";import{a as Q}from"./chunk-6N3NJCWN.js";import{a as J}from"./chunk-CZKIDW24.js";import"./chunk-LOXR3JJX.js";import"./chunk-56YE37V6.js";import{a as $}from"./chunk-V5UC4TMG.js";import"./chunk-U657U553.js";import"./chunk-QFYVXC4V.js";import"./chunk-T7AKPKMZ.js";import"./chunk-JNRBLGLU.js";import"./chunk-ZBQC6E3M.js";import"./chunk-AO43RQAG.js";import"./chunk-SCB2MVKQ.js";import"./chunk-4SMJHLGZ.js";import"./chunk-MQM7DF2M.js";import{a as S,b as q,c as y,d as x,e as R}from"./chunk-TH3YUOZ2.js";import"./chunk-564RKXG7.js";import"./chunk-HJXR3IL7.js";import"./chunk-K5FCDENP.js";import"./chunk-VT6LNH6I.js";import"./chunk-Z7VBWKZ3.js";import"./chunk-NVCP7HH3.js";import"./chunk-YHKI2L7W.js";import"./chunk-ODL7UGWI.js";import"./chunk-R3Y7P2GW.js";import"./chunk-LPOE4446.js";import"./chunk-QOHQY66K.js";import"./chunk-37NMTDTM.js";import"./chunk-WAPW5AUJ.js";import"./chunk-ENHI5GWA.js";import"./chunk-DAEXUMJT.js";import"./chunk-IGMB27B5.js";import"./chunk-ME7PJXWA.js";import"./chunk-GL2SUH6T.js";import"./chunk-3M22BTAM.js";import{c as L}from"./chunk-HCPBPEHV.js";import{c as P,g as j,i as H,l as z}from"./chunk-QVLOO535.js";import{c as K}from"./chunk-XREQECMQ.js";import"./chunk-RPJBZPSB.js";import"./chunk-UMOPET3G.js";import"./chunk-4LV77BQU.js";import"./chunk-RGKBOUPL.js";import"./chunk-EZZQWHAZ.js";import{b as w,c as T}from"./chunk-23CS2WID.js";import{a as A}from"./chunk-OIHIMR2W.js";import"./chunk-BDMUNOAA.js";import{c as G,d as N,e as B}from"./chunk-OYQCZWOE.js";import{d as U,g as Z}from"./chunk-G33ZJSCE.js";import"./chunk-DX662RXJ.js";import"./chunk-N5GZ74QQ.js";import"./chunk-XASILSQS.js";import{$a as O,$b as _,Aa as F,Cb as g,Db as n,Eb as a,Fb as b,Gc as V,Nb as M,Pb as C,Rb as I,Sa as c,Za as d,db as v,ec as m,jb as E,oa as h,pa as f,wb as W,yb as D}from"./chunk-46QINP2S.js";import{a as p,b as l}from"./chunk-BDOJB7O2.js";function le(o,k){if(o&1){let e=M();n(0,"div",7),C("click",function(){h(e);let i=I();return f(i.openCode())}),n(1,"mat-icon"),m(2,"code"),a()()}}function ce(o,k){o&1&&(n(0,"div",3)(1,"mat-icon"),m(2,"code"),a()())}function de(o,k){if(o&1){let e=M();n(0,"button",8),C("click",function(){h(e);let i=I();return f(i.openRestApi())}),b(1,"mat-icon",9),n(2,"span"),m(3,"REST API"),a()()}}var re=(()=>{class o{constructor(e,t){this.router=e,this.route=t}agInit(e){this.params=e,this.enableCode=this.params.enableCodeGetter()}refresh(e){return!0}openCode(){let e=this.params.data;this.params.onOpenCode(e)}openRestApi(){let e=this.params.data,t=this.router.url.split("/");t[t.length-1]=ie.routeWebApi,t.push(encodeURIComponent(e.path));let i=t.join("/");this.router.navigate([i])}static{this.\u0275fac=function(t){return new(t||o)(d(B),d(G))}}static{this.\u0275cmp=v({type:o,selectors:[["app-web-api-actions"]],decls:9,vars:3,consts:[["menu","matMenu"],[1,"actions-component"],["matRipple","","tippy","Code",1,"eav-grid-action-button","highlight"],[1,"eav-grid-action-button","disabled"],["matRipple","","tippy","More",1,"eav-grid-action-button","highlight",3,"matMenuTriggerFor"],[1,"grid-more-menu"],["matMenuContent",""],["matRipple","","tippy","Code",1,"eav-grid-action-button","highlight",3,"click"],["mat-menu-item","",3,"click"],["svgIcon","code-curly"]],template:function(t,i){if(t&1&&(n(0,"div",1),W(1,le,3,0,"div",2),W(2,ce,3,0,"div",3),n(3,"div",4)(4,"mat-icon"),m(5,"more_horiz"),a()()(),n(6,"mat-menu",5,0),E(8,de,4,0,"ng-template",6),a()),t&2){let r=_(7);c(),D(i.enableCode?1:-1),c(),D(i.enableCode?-1:2),c(),g("matMenuTriggerFor",r)}},dependencies:[j,P,T,w,R,y,S,q,x,K],encapsulation:2})}}return o})();var $e=(()=>{class o{#i;#e;#t;constructor(e,t,i){this.snackBar=e,this.matDialog=t,this.viewContainerRef=i,this.#i=A(oe),this.#e=A(J),this.refresh=F(0),this.webApis=this.#e.getWebApisLive(this.refresh),this.gridOptions=this.buildGridOptions(),this.dialogConfigSvc=A($),this.#t={empty:{description:"<p><b>This is where you manage Web APIs</b><br>They are custom C# code which do anything you want.</p>",hint:"<p>WebApi Controllers are listed automatically. <br>Click the (+) in the bottom right corner to create your first Web API from a template file.</p>"},content:{description:"<p><b>This is where you manage Web APIs</b><br>They are custom C# code which do anything you want.</p>",hint:""}},this.uxHelpText=V(()=>this.webApis()?.length===0?this.#t.empty:this.#t.content)}ngOnInit(){this.dialogConfigSvc.getCurrent$().subscribe(e=>{this.enableCode=e.Context.Enable.CodeEditor})}createController(e){let t={folder:"api",global:e,purpose:"Api"};this.matDialog.open(Q,{autoFocus:!1,data:t,viewContainerRef:this.viewContainerRef,width:"650px"}).afterClosed().subscribe(r=>{if(r){if(r.name.endsWith("Controller.cs")){let s=r.name.substring(r.name.lastIndexOf("/")+1);if(!/^[A-Z][a-zA-Z0-9]*Controller\.cs$/g.test(s)){let ae=`"${s}" is invalid controller name. Should be something like "MyController.cs"`;this.snackBar.open(ae,null,{duration:5e3});return}}this.snackBar.open("Saving..."),this.#e.create(r.name,e,r.templateKey).subscribe(()=>{this.snackBar.open("Saved",null,{duration:2e3}),this.refresh.update(s=>++s)})}})}enableCodeGetter(){return this.enableCode}openCode(e){this.#i.openCodeFile(e.path,e.isShared)}buildGridOptions(){return l(p({},Y),{columnDefs:[l(p({},u.ItemsText),{headerName:"Endpoint",field:"endpointPath",flex:2,minWidth:250}),l(p({},u.TextWideMin100),{headerName:"Edition",field:"edition",sort:"asc"}),l(p({},u.TextWideMin100),{headerName:"Folder",field:"folder",sort:"asc"}),l(p({},u.TextWide),{headerName:"Name",field:"name"}),l(p({},u.Boolean2),{headerName:"Compiled",field:"isCompiled",cellRenderer:X}),l(p({},u.ActionsPinnedRight6),{cellRenderer:re,cellRendererParams:{enableCodeGetter:()=>this.enableCodeGetter(),onOpenCode:i=>this.openCode(i)}})]})}static{this.\u0275fac=function(t){return new(t||o)(d(L),d(U),d(O))}}static{this.\u0275cmp=v({type:o,selectors:[["app-web-api"]],decls:15,vars:6,consts:[["menu","matMenu"],[3,"helpText","refresh","rowLength"],[1,"ag-theme-material",3,"rowData","gridOptions"],["align","end"],["mat-fab","","mat-elevation-z24","","tippy","Create a new controller","tippyPlacement","left",1,"grid-fab",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"]],template:function(t,i){if(t&1){let r=M();n(0,"app-grid-with-help",1),b(1,"ag-grid-angular",2),n(2,"mat-dialog-actions",3)(3,"button",4)(4,"mat-icon"),m(5,"add"),a()(),n(6,"mat-menu",null,0)(8,"button",5),C("click",function(){return h(r),f(i.createController(!1))}),n(9,"span"),m(10,"App"),a()(),n(11,"button",5),C("click",function(){return h(r),f(i.createController(!0))}),n(12,"span"),m(13,"Shared (global)"),a()()()()(),b(14,"router-outlet")}if(t&2){let r,s=_(7);g("helpText",i.uxHelpText())("refresh",i.refresh())("rowLength",(r=i.webApis())==null?null:r.length),c(),g("rowData",i.webApis())("gridOptions",i.gridOptions),c(2),g("matMenuTriggerFor",s)}},dependencies:[te,ee,Z,z,H,R,y,S,x,T,w,N,ne],encapsulation:2})}}return o})();export{$e as WebApiComponent};
//# sourceMappingURL=https://sources.2sxc.org/21.00.00/dist/ng-edit/web-api-IJY5OPNL.js.map
