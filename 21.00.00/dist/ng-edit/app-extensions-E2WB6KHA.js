import{a as K,b as Q}from"./chunk-ZRG4FHCH.js";import{a as X}from"./chunk-V7RAQGUV.js";import{a as J}from"./chunk-SXZJT35J.js";import"./chunk-HW433KCS.js";import"./chunk-GLFISIX2.js";import"./chunk-MBSXBYF5.js";import{a as q}from"./chunk-AAMPB3UT.js";import{a as G}from"./chunk-3S44UA6M.js";import{b as Z,d as W}from"./chunk-S7Y6G6OZ.js";import"./chunk-E2PCXKCE.js";import"./chunk-BKBBHERO.js";import{b as j}from"./chunk-NKT65OQW.js";import"./chunk-NIPOW2E2.js";import{a as V}from"./chunk-ORK43FFD.js";import"./chunk-56YE37V6.js";import"./chunk-T7AKPKMZ.js";import{a as B}from"./chunk-L77E4UL2.js";import"./chunk-JNRBLGLU.js";import"./chunk-4YE3E6NH.js";import"./chunk-SCB2MVKQ.js";import"./chunk-4SMJHLGZ.js";import{c as H}from"./chunk-JEQANFI7.js";import{a as F}from"./chunk-564RKXG7.js";import"./chunk-HJXR3IL7.js";import"./chunk-ODL7UGWI.js";import"./chunk-R3Y7P2GW.js";import"./chunk-LPOE4446.js";import"./chunk-HYUOS4CI.js";import"./chunk-ENHI5GWA.js";import"./chunk-DAEXUMJT.js";import"./chunk-ME7PJXWA.js";import"./chunk-GL2SUH6T.js";import"./chunk-3M22BTAM.js";import"./chunk-HCPBPEHV.js";import{f as I,i as $,l as k}from"./chunk-QVLOO535.js";import{c as S}from"./chunk-XREQECMQ.js";import"./chunk-RPJBZPSB.js";import"./chunk-UMOPET3G.js";import"./chunk-4LV77BQU.js";import"./chunk-EZZQWHAZ.js";import{b as _,c as E}from"./chunk-23CS2WID.js";import{a as y}from"./chunk-OIHIMR2W.js";import"./chunk-BDMUNOAA.js";import{d as P,e as O}from"./chunk-OYQCZWOE.js";import{d as U,g as N}from"./chunk-G33ZJSCE.js";import"./chunk-DX662RXJ.js";import"./chunk-N5GZ74QQ.js";import"./chunk-XASILSQS.js";import{Aa as f,Cb as d,Db as o,Eb as r,Fb as m,Gc as L,M as D,Pa as b,Pb as c,Rb as x,Sa as l,bc as C,db as v,ec as a,ja as R,p as T,qa as z,wb as h,yb as g}from"./chunk-46QINP2S.js";import{a as w,b as A}from"./chunk-BDOJB7O2.js";var Y='<?xml version="1.0" encoding="UTF-8"?><svg id="a" xmlns="http://www.w3.org/2000/svg" width="48" height="47.99" viewBox="0 0 48 47.99"><defs><style>.b{fill:#fff;}</style></defs><path d="M.02,47.96V15.99C.02,11.73,1.68,7.72,4.7,4.7,7.72,1.69,11.73.02,15.99.02h31.97v31.96l-4.16,4.16,3.64,3.64c.7.7.7,1.83,0,2.53-.34.34-.79.52-1.27.52s-.93-.19-1.27-.52l-3.64-3.64-2.59,2.59,3.64,3.64c.34.34.52.79.52,1.27s-.19.93-.52,1.27-.79.52-1.27.52-.93-.19-1.27-.52l-3.64-3.64-4.17,4.17H.02Z"/><path class="b" d="M47.94.05v31.93l-4.13,4.13-.03.03.03.03,3.62,3.62c.69.69.69,1.81,0,2.5-.33.33-.78.52-1.25.52s-.92-.18-1.25-.52l-3.62-3.62-.03-.03-.03.03-2.56,2.56-.03.03.03.03,3.62,3.62c.69.69.69,1.81,0,2.5-.33.33-.78.52-1.25.52s-.92-.18-1.25-.52l-3.62-3.62-.03-.03-.03.03-4.15,4.15H.05V15.99c0-2.15.42-4.24,1.25-6.21.8-1.9,1.95-3.6,3.42-5.07,1.46-1.47,3.17-2.61,5.07-3.42C11.75.47,13.84.05,15.99.05h31.95M47.99,0H15.99C7.16,0,0,7.16,0,15.99v31.99h31.99l4.16-4.16,3.62,3.62c.35.35.82.53,1.28.53s.93-.18,1.28-.53c.71-.71.71-1.86,0-2.57l-3.62-3.62,2.56-2.56,3.62,3.62c.35.35.82.53,1.28.53s.93-.18,1.28-.53h0c.71-.71.71-1.86,0-2.57l-3.62-3.62,4.15-4.15V0h0Z"/></svg>';var ie=(()=>{class n{constructor(){this.canEditExtension=f(!1),this.extHasConfig=f(!1),this.hasSettings=f(!1),this.hasResources=f(!1)}agInit(e){this.params=e,this.ext=e.data,this.canEditExtension.set(!this.ext.configuration.isInstalled),this.extHasConfig.set(!!this.ext.configuration),this.hasSettings.set(!!this.ext.configuration?.settingsContentType),this.hasResources.set(!!this.ext.configuration?.resourcesContentType)}refresh(e){return!0}do(e){this.params.do(e,this.ext)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=v({type:n,selectors:[["app-extension-actions"]],decls:21,vars:12,consts:[[1,"actions-component"],[1,"actions-row"],["matRipple","","tippy","Edit Extension configuration",1,"eav-grid-action-button","default-link","highlight",3,"click"],["matRipple","","tippy","Download Extension ZIP",1,"eav-grid-action-button","default-link","highlight",3,"click"],["matRipple","","tippy","Delete Extension",1,"eav-grid-action-button","default-link","highlight",3,"click"],["matRipple","","tippy","Edit Extension Settings",1,"eav-grid-action-button","default-link","highlight",3,"click"],["matRipple","","tippy","Edit Extension Resources",1,"eav-grid-action-button","default-link","highlight",3,"click"],["matRipple","","tippy","Inspect Extension",1,"eav-grid-action-button","default-link","highlight",3,"click"]],template:function(i,t){i&1&&(o(0,"div",0)(1,"div",1)(2,"a",2),c("click",function(){return t.do("edit")}),o(3,"mat-icon"),a(4,"edit"),r()(),o(5,"a",3),c("click",function(){return t.do("download")}),o(6,"mat-icon"),a(7,"cloud_download"),r()(),o(8,"a",4),c("click",function(){return t.do("delete")}),o(9,"mat-icon"),a(10,"delete"),r()()(),o(11,"div",1)(12,"a",5),c("click",function(){return t.do("openSettings")}),o(13,"mat-icon"),a(14,"settings"),r()(),o(15,"a",6),c("click",function(){return t.do("openResources")}),o(16,"mat-icon"),a(17,"translate"),r()(),o(18,"a",7),c("click",function(){return t.do("inspect")}),o(19,"mat-icon"),a(20,"frame_inspect"),r()()()()),i&2&&(l(2),C("disabled",!t.canEditExtension()),l(3),C("disabled",!t.canEditExtension()||!t.extHasConfig()),l(3),C("disabled",t.canEditExtension()),l(4),C("disabled",!t.hasSettings()),l(3),C("disabled",!t.hasResources()),l(3),C("disabled",t.canEditExtension()))},dependencies:[E,_,k,j,S],styles:[`.actions-component[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;gap:8px}.actions-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:4px}.disabled[_ngcontent-%COMP%]{opacity:.5;pointer-events:none}
/*# sourceMappingURL=extension-actions-WD4ZVE2V.css.map */`]})}}return n})();function ae(n,p){if(n&1&&(o(0,"a",1)(1,"mat-icon"),a(2,"extension"),r()()),n&2){let e=x();d("href",e.mainLink||"#",b)}}function le(n,p){n&1&&m(0,"div")}function ce(n,p){if(n&1&&(o(0,"a",2)(1,"mat-icon"),a(2,"description"),r()()),n&2){let e=x();d("href",e.docsLink||"#",b)}}function pe(n,p){n&1&&m(0,"div")}function de(n,p){if(n&1&&(o(0,"a",3)(1,"mat-icon"),a(2,"smart_display"),r()()),n&2){let e=x();d("href",e.demosLink||"#",b)}}function me(n,p){n&1&&m(0,"div")}function ue(n,p){if(n&1&&(o(0,"a",4),z(),o(1,"svg",5),m(2,"path",6),r()()),n&2){let e=x();d("href",e.sourceCodeLink||"#",b)}}function fe(n,p){n&1&&m(0,"div")}var ne=(()=>{class n{agInit(e){this.mainLink=e.mainLink,this.docsLink=e.docsLink,this.demosLink=e.demosLink,this.sourceCodeLink=e.sourceCodeLink}refresh(e){return e&&(this.mainLink=e.mainLink,this.docsLink=e.docsLink,this.demosLink=e.demosLink,this.sourceCodeLink=e.sourceCodeLink),!0}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=v({type:n,selectors:[["app-extensions-link"]],decls:9,vars:4,consts:[[1,"grid-container"],["mat-icon-button","","target","_blank","rel","noopener","title","Main Link",1,"small-icon-button",3,"href"],["mat-icon-button","","target","_blank","rel","noopener","title","Link to Documentation",1,"small-icon-button",3,"href"],["mat-icon-button","","target","_blank","rel","noopener","title","Link to Demo",1,"small-icon-button",3,"href"],["mat-icon-button","","target","_blank","rel","noopener","title","Link to Source Code",1,"small-icon-button",3,"href"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 640 640"],["d","M237.9 461.4C237.9 463.4 235.6 465 232.7 465C229.4 465.3 227.1 463.7 227.1 461.4C227.1 459.4 229.4 457.8 232.3 457.8C235.3 457.5 237.9 459.1 237.9 461.4zM206.8 456.9C206.1 458.9 208.1 461.2 211.1 461.8C213.7 462.8 216.7 461.8 217.3 459.8C217.9 457.8 216 455.5 213 454.6C210.4 453.9 207.5 454.9 206.8 456.9zM251 455.2C248.1 455.9 246.1 457.8 246.4 460.1C246.7 462.1 249.3 463.4 252.3 462.7C255.2 462 257.2 460.1 256.9 458.1C256.6 456.2 253.9 454.9 251 455.2zM316.8 72C178.1 72 72 177.3 72 316C72 426.9 141.8 521.8 241.5 555.2C254.3 557.5 258.8 549.6 258.8 543.1C258.8 536.9 258.5 502.7 258.5 481.7C258.5 481.7 188.5 496.7 173.8 451.9C173.8 451.9 162.4 422.8 146 415.3C146 415.3 123.1 399.6 147.6 399.9C147.6 399.9 172.5 401.9 186.2 425.7C208.1 464.3 244.8 453.2 259.1 446.6C261.4 430.6 267.9 419.5 275.1 412.9C219.2 406.7 162.8 398.6 162.8 302.4C162.8 274.9 170.4 261.1 186.4 243.5C183.8 237 175.3 210.2 189 175.6C209.9 169.1 258 202.6 258 202.6C278 197 299.5 194.1 320.8 194.1C342.1 194.1 363.6 197 383.6 202.6C383.6 202.6 431.7 169 452.6 175.6C466.3 210.3 457.8 237 455.2 243.5C471.2 261.2 481 275 481 302.4C481 398.9 422.1 406.6 366.2 412.9C375.4 420.8 383.2 435.8 383.2 459.3C383.2 493 382.9 534.7 382.9 542.9C382.9 549.4 387.5 557.3 400.2 555C500.2 521.8 568 426.9 568 316C568 177.3 455.5 72 316.8 72zM169.2 416.9C167.9 417.9 168.2 420.2 169.9 422.1C171.5 423.7 173.8 424.4 175.1 423.1C176.4 422.1 176.1 419.8 174.4 417.9C172.8 416.3 170.5 415.6 169.2 416.9zM158.4 408.8C157.7 410.1 158.7 411.7 160.7 412.7C162.3 413.7 164.3 413.4 165 412C165.7 410.7 164.7 409.1 162.7 408.1C160.7 407.5 159.1 407.8 158.4 408.8zM190.8 444.4C189.2 445.7 189.8 448.7 192.1 450.6C194.4 452.9 197.3 453.2 198.6 451.6C199.9 450.3 199.3 447.3 197.3 445.4C195.1 443.1 192.1 442.8 190.8 444.4zM179.4 429.7C177.8 430.7 177.8 433.3 179.4 435.6C181 437.9 183.7 438.9 185 437.9C186.6 436.6 186.6 434 185 431.7C183.6 429.4 181 428.4 179.4 429.7z"]],template:function(i,t){i&1&&(o(0,"div",0),h(1,ae,3,1,"a",1)(2,le,1,0,"div"),h(3,ce,3,1,"a",2)(4,pe,1,0,"div"),h(5,de,3,1,"a",3)(6,me,1,0,"div"),h(7,ue,3,1,"a",4)(8,fe,1,0,"div"),r()),i&2&&(l(),g(t.mainLink?1:2),l(2),g(t.docsLink?3:4),l(2),g(t.demosLink?5:6),l(2),g(t.sourceCodeLink?7:8))},dependencies:[E,_,k,I],styles:[`.small-icon-button[_ngcontent-%COMP%]{width:24px;height:24px;line-height:24px;padding:0;display:inline-flex;align-items:center;justify-content:center}.small-icon-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .small-icon-button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px;line-height:20px;display:flex;align-items:center;justify-content:center}.grid-container[_ngcontent-%COMP%]{margin-top:15px;display:grid;grid-template-columns:repeat(2,1fr);grid-template-rows:repeat(2,1fr);gap:4px}
/*# sourceMappingURL=extensions-link-AZMXN2UJ.css.map */`]})}}return n})();function he(n,p){n&1&&(o(0,"p"),a(1," Create an extension by placing an "),o(2,"code"),a(3,"extension.json"),r(),a(4," file in the "),o(5,"code"),a(6,"app/extensions"),r(),a(7," folder. "),r())}function ge(n,p){if(n&1&&m(0,"ag-grid-angular",2),n&2){let e=x();d("rowData",e.extensions())("gridOptions",e.gridOptions)}}var Qe=(()=>{class n{constructor(){this.extensionsSvc=y(X),this.router=R(O),this.#i=y(V),this.dialog=y(U),this.entitySvc=y(H),this.fabOpen=f(!1),this.refresh=f(0),this.#o=this.extensionsSvc.getAllLive(this.refresh).value,this.extensions=L(()=>this.#o()?.extensions??[]),this.#t=null,this.gridOptions=A(w({},G),{rowHeight:80,columnDefs:this.#p()}),this.#n={empty:{description:"<p><b>App Extensions</b><br>Install extensions to add extra functionality or input types to apps.</p>",hint:"<p>Create an extension by placing an <code>extension.json</code> file in the <code>app/extensions</code> folder.</p>"},content:{description:"<p><b>App Extensions</b><br>Installed extensions are shown here.</p>",hint:"<p>Use the Upload button to add an extension folder.</p>"}},this.uxHelpText=L(()=>this.extensions()?.length===0?this.#n.empty:this.#n.content)}#i;#o;#t;ngOnInit(){this.#i.doOnDialogClosedWithData(e=>{if(e?.objData&&this.#t){let i=this.#t;this.#t=null,this.extensionsSvc.updateConfiguration(i,JSON.stringify(e.objData)).subscribe(()=>{this.fetchExtensions()})}else this.fetchExtensions()})}openChange(e){this.fabOpen.set(e)}browseCatalog(){window.open("https://2sxc.org/apps","_blank")}importExtension(e){let s=this.#e("import").replace(/^#\/?/,"").replace(/^\//,"").split("/").filter(Boolean);this.router.navigate(s,{state:{returnValue:!0}})}#a(e){let i="a0f44af0-6750-40c9-9ad9-4a07b6eda8b3",t=[w({},e?.configuration??{})],s=this.#r(i),oe=this.#e(`edit/${s}`).replace(/^#\/?/,"").replace(/^\//,"").split("/").filter(Boolean);this.#t=e?.folder??null,this.router.navigate(oe,{state:{returnValue:!0,overrideContents:t}})}#s(e){e&&this.entitySvc.getEntities$(T({contentTypeName:e})).subscribe(i=>{let t=i?i[0].Id:this.#r(e),M=this.#e(`edit/${t}`).replace(/^#\/?/,"").replace(/^\//,"").split("/").filter(Boolean);this.router.navigate(M,{state:{returnValue:!0}})})}#l(e,i){let u=this.#e("inspect/"+e).replace(/^#\/?/,"").replace(/^\//,"").split("/").filter(Boolean);this.router.navigate(u,{state:{returnValue:!0},queryParams:i?{edition:i}:void 0})}#c(e,i){let u=this.#e("delete/"+e).replace(/^#\/?/,"").replace(/^\//,"").split("/").filter(Boolean);this.router.navigate(u,{state:{returnValue:!0},queryParams:i?{edition:i}:void 0})}filesDropped(e){this.dialog.open(Q,{data:{file:e[0],allowedFileTypes:"zip",multiple:!0,title:"Import Extension",description:"Select Extension folder from your computer to import.",upload$:t=>this.extensionsSvc.uploadExtensions(t)}}).afterClosed().pipe(D(1)).subscribe(t=>{t&&this.fetchExtensions()})}fetchExtensions(){this.refresh.update(e=>++e)}#e(e){return`#${this.#i.urlSubRoute(e)}`}#r(e){return B({items:[F.newFromType(e)]})}#n;cellTextRenderer(e,i,t,s){return e=e||"",i=i||"",t=t||"100%",`
      <div style="display: flex; align-items: center; gap: 8px;">
        ${s??""}
        <div style="display: flex; flex-direction: column;">
          <span title="${e}" style="font-weight:bold; white-space: nowrap; width: ${t}; overflow: hidden; text-overflow: ellipsis;">${e}</span>
          <span title="${i}" style="margin-top: -15px; white-space: nowrap; width: ${t}; overflow: hidden; text-overflow: ellipsis;">
            ${i??""}
          </span>
        </div>
      </div>
    `}iconAndTitleCellRenderer(e,i,t,s){let M=s?`<img src="${s}" alt="${e}" style="mask-image: url('data:image/svg+xml;utf8,${encodeURIComponent(Y)}'); width:48px; height:48px;">`:'<div style="flex:0 0 48px; height:48px;"></div>';return this.cellTextRenderer(e,i,t,M)}#p(){return[{headerName:"Extension",field:"folder",flex:1,sortable:!0,sort:"asc",filter:"agTextColumnFilter",cellRenderer:e=>{let i=e.data;return this.iconAndTitleCellRenderer(i?.folder,i?.configuration?.nameId?.toString(),void 0,i?.icon)}},{headerName:"Name",field:"configuration.name",sortable:!0,filter:"agTextColumnFilter",flex:1,cellRenderer:e=>{let i=e.data?.configuration;return this.cellTextRenderer(i?.name,i?.teaser)}},{headerName:"Edition",field:"edition",sortable:!0,filter:"agTextColumnFilter",cellRenderer:e=>`
            <mat-chip-set>
              <mat-chip>
                ${e.data?.edition||"Default"}
              </mat-chip>
            </mat-chip-set>
          `},{headerName:"Creator",field:"configuration.createdBy",maxWidth:175,sortable:!0,filter:"agTextColumnFilter",cellRenderer:e=>{let i=e.data?.configuration;return this.cellTextRenderer(i?.createdBy,i?.copyright,"150px")}},{headerName:"Links",sortable:!1,field:"configuration.link",width:125,cellRenderer:ne,cellRendererParams:e=>({mainLink:e.data?.configuration?.linkMain,docsLink:e.data?.configuration?.linkDocs,demosLink:e.data?.configuration?.linkDemo,sourceCodeLink:e.data?.configuration?.linkSource})},{headerName:"Actions",width:150,pinned:"right",cellRenderer:ie,cellRendererParams:{urlTo:(i,t)=>"#"+this.#e(t.folder),do:(i,t)=>{switch(i){case"edit":return this.#a(t);case"download":return this.extensionsSvc.downloadExtension(t.folder);case"delete":return this.#c(t.folder,t.edition);case"inspect":return this.#l(t.folder,t.edition);case"openSettings":return this.#s(t.configuration?.settingsContentType);case"openResources":return this.#s(t.configuration?.resourcesContentType)}}}}]}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=v({type:n,selectors:[["app-extensions"]],decls:9,vars:5,consts:[["appDragAndDrop","",1,"container",3,"filesDropped","allowedFileTypes"],[3,"helpText","refresh","rowLength"],[1,"ag-theme-material",3,"rowData","gridOptions"],["align","end",1,"eav-dialog-actions"],["mat-fab","","mat-elevation-z24","","tippy","Add Extension","tippyPlacement","top",1,"grid-fab",3,"click"]],template:function(i,t){if(i&1&&(o(0,"div",0),c("filesDropped",function(u){return t.filesDropped(u)}),o(1,"app-grid-with-help",1),h(2,he,8,0,"p")(3,ge,1,2,"ag-grid-angular",2),o(4,"mat-dialog-actions",3)(5,"button",4),c("click",function(){return t.importExtension()}),o(6,"mat-icon"),a(7,"add"),r()()()()(),m(8,"router-outlet")),i&2){let s;d("allowedFileTypes","zip"),l(),d("helpText",t.uxHelpText())("refresh",t.refresh())("rowLength",(s=t.extensions())==null?null:s.length),l(),g(t.extensions().length===0?2:3)}},dependencies:[E,_,N,P,k,$,W,Z,q,J,S,K],styles:[`[_nghost-%COMP%]     .ag-row-hover .ag-cell a{color:#85283b!important}.container[_ngcontent-%COMP%]{height:100%}
/*# sourceMappingURL=app-extensions-CMS6MF4L.css.map */`]})}}return n})();export{Qe as AppExtensions};
//# sourceMappingURL=https://sources.2sxc.org/21.00.00/dist/ng-edit/app-extensions-E2WB6KHA.js.map
