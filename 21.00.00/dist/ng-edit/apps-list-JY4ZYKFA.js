import{a as Ce}from"./chunk-5IKHYRJB.js";import{a as Ae}from"./chunk-FRCLG6YK.js";import{a as ge,b as be,c as _e}from"./chunk-F52GPHRJ.js";import{a as ve}from"./chunk-5E3KZM3P.js";import{a as fe}from"./chunk-MBSXBYF5.js";import{a as he}from"./chunk-AAMPB3UT.js";import{b as se,d as pe,e as u}from"./chunk-RAUQWANF.js";import{a as le}from"./chunk-3S44UA6M.js";import{a as de,b as me,c as ce,d as ue}from"./chunk-S7Y6G6OZ.js";import{a as y}from"./chunk-LKTKDGC2.js";import{b as re}from"./chunk-OI3ZGSUF.js";import{b as A}from"./chunk-NKT65OQW.js";import"./chunk-NIPOW2E2.js";import{a as ee}from"./chunk-ORK43FFD.js";import"./chunk-56YE37V6.js";import{a as J}from"./chunk-OYXWEFHA.js";import"./chunk-V5UC4TMG.js";import"./chunk-U657U553.js";import"./chunk-QFYVXC4V.js";import{a as Y}from"./chunk-L77E4UL2.js";import"./chunk-JNRBLGLU.js";import"./chunk-MWYLUFVP.js";import"./chunk-FYQJ654R.js";import"./chunk-ZKDKEYV7.js";import"./chunk-4YE3E6NH.js";import{a as te,b as ie,c as oe,d as ne,e as ae}from"./chunk-TH3YUOZ2.js";import"./chunk-564RKXG7.js";import"./chunk-HJXR3IL7.js";import"./chunk-BTK5NHS7.js";import"./chunk-K5FCDENP.js";import"./chunk-R3Y7P2GW.js";import"./chunk-37NMTDTM.js";import"./chunk-WAPW5AUJ.js";import"./chunk-ENHI5GWA.js";import"./chunk-IGMB27B5.js";import"./chunk-ME7PJXWA.js";import"./chunk-GL2SUH6T.js";import"./chunk-3M22BTAM.js";import{c as q}from"./chunk-HCPBPEHV.js";import{c as j,g as U,i as W,j as z,l as X}from"./chunk-QVLOO535.js";import{c as Z}from"./chunk-XREQECMQ.js";import"./chunk-RPJBZPSB.js";import"./chunk-UMOPET3G.js";import"./chunk-RGKBOUPL.js";import"./chunk-EZZQWHAZ.js";import{b as v,c as C}from"./chunk-23CS2WID.js";import{a as k}from"./chunk-OIHIMR2W.js";import"./chunk-BDMUNOAA.js";import{d as G}from"./chunk-OYQCZWOE.js";import{d as K,g as Q}from"./chunk-G33ZJSCE.js";import{aa as V,ca as H}from"./chunk-DX662RXJ.js";import"./chunk-N5GZ74QQ.js";import"./chunk-XASILSQS.js";import{$a as T,$b as x,Aa as I,Cb as c,Db as o,Eb as a,Fb as b,Nb as B,Pb as l,Rb as _,Sa as s,Tc as $,Za as f,db as g,ec as r,fd as N,gc as O,ja as R,jb as E,oa as S,pa as M,tc as P,wb as w,yb as D}from"./chunk-46QINP2S.js";import{a as d,b as m,g as L}from"./chunk-BDOJB7O2.js";var Se={states:{true:{tooltip:"Show this app to users",icon:"visibility"},false:{tooltip:"Hide this app from users",icon:"visibility_off"}}},Me={states:{true:{clickable:!0,tooltip:"This App uses obsolete code which will cause problems on future upgrades. Click to see details.",icon:"bug_report",getUrl:n=>window.$2sxc.http.apiUrl("sys/insights/logs?key=warnings-obsolete&filter=AppId="+n.Id)},false:{tooltip:"Hide this app from users",icon:""}}};function ke(n,F){n&1&&(o(0,"mat-icon"),r(1,"foundation"),a())}function ye(n,F){n&1&&(o(0,"mat-icon"),r(1,"holiday_village"),a())}function Fe(n,F){if(n&1){let t=B();o(0,"button",7),l("click",function(){S(t);let e=_();return M(e.do("flushCache"))}),o(1,"mat-icon"),r(2,"cached"),a(),o(3,"span"),r(4,"Flush cache"),a()(),o(5,"button",8),l("click",function(){S(t);let e=_();return M(e.do("deleteApp"))}),o(6,"mat-icon"),r(7,"delete"),a(),o(8,"span"),r(9,"Delete"),a()()}if(n&2){let t=_();s(5),c("disabled",!t.app.IsApp)}}var Ie=(()=>{class n{agInit(t){this.params=t,this.app=t.data}refresh(t){return!0}do(t){this.params.do(t,this.app)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=g({type:n,selectors:[["app-apps-list-actions"]],decls:11,vars:8,consts:[["menu","matMenu"],[1,"actions-component"],[1,"eav-grid-action-button","icon",3,"tippy","tippyDisabled"],[3,"lightSpeedOwner","params","lightSpeed"],["matRipple","","tippy","More",1,"eav-grid-action-button","highlight",3,"matMenuTriggerFor"],[1,"grid-more-menu"],["matMenuContent",""],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click","disabled"]],template:function(i,e){if(i&1&&(o(0,"div",1)(1,"div",2),w(2,ke,2,0,"mat-icon"),w(3,ye,2,0,"mat-icon"),a(),b(4,"app-lightspeed-action",3),o(5,"div",4)(6,"mat-icon"),r(7,"more_horiz"),a()()(),o(8,"mat-menu",5,0),E(10,Fe,10,1,"ng-template",6),a()),i&2){let p=x(9);s(),c("tippy",e.app.IsGlobal?"This app is global":e.app.IsInherited?"This app is inherited":"")("tippyDisabled",!e.app.IsGlobal&&!e.app.IsInherited),s(),D(e.app.IsGlobal?2:-1),s(),D(e.app.IsInherited?3:-1),s(),c("lightSpeedOwner",e.app)("params",e.params)("lightSpeed",e.app.lightSpeed),s(),c("matMenuTriggerFor",p)}},dependencies:[Z,C,v,A,U,j,ae,oe,te,ie,ne,Ce],encapsulation:2})}}return n})();var Le=n=>({"fab-opened":n}),Dt=(()=>{class n{#t;#e;constructor(t,i,e,p,h){this.snackBar=t,this.context=i,this.matDialog=e,this.viewContainerRef=p,this.changeDetectorRef=h,this.log=V({AppsListComponent:n}),this.gridOptions=this.#s(),this.features=R(J),this.isAddFromFolderEnabled=this.features.isEnabled[y.AppSyncWithSiteFiles],this.#t=k(fe),this.#e=k(ee),this.fabOpen=I(!1),this.#i=I(0),this.apps=this.#t.getAllLive(this.#i).value,de.registerModules([ce])}#i;ngOnInit(){this.#e.doOnDialogClosed(()=>this.#o())}openChange(t){this.fabOpen.set(t)}browseCatalog(){window.open("https://2sxc.org/apps","_blank")}createApp(){this.#e.navRelative(["create"])}createInheritedApp(){this.#e.navRelative(["create-inherited"])}addFromFolder(){this.#e.navRelative(["add-app-from-folder"])}importApp(t){this.#e.navRelative(["import"],{state:{files:t}})}#n(t){let i=prompt(`This cannot be undone. To really delete this app, type 'yes!' or type/paste the app-name here. Are you sure want to delete '${t.Name}' (${t.Id})?`);i!==null&&(i===t.Name||i==="yes!"?(this.snackBar.open("Deleting..."),this.#t.delete(t.Id).subscribe({error:()=>{this.snackBar.open("Delete failed. Please check console for more information",void 0,{duration:3e3}),this.#o()},next:()=>{this.snackBar.open("Deleted",void 0,{duration:2e3}),this.#o()}})):alert("Input did not match - will not delete"))}#a(t){return L(this,null,function*(){if(confirm(`Flush the App Cache for ${t.Name} (${t.Id})?`)){this.snackBar.open("Flushing cache...");try{let i=yield this.#t.flushCache(t.Id);i>=200&&i<300&&this.snackBar.open("Cache flushed",void 0,{duration:2e3})}catch(i){this.snackBar.open("Cache flush failed. Please check console.",void 0,{duration:3e3}),console.error("Export error:",i)}}})}#r(t){let i=Y(Ae.getLightSpeedEditParams(t.Id)),e=`${this.context.zoneId}/${t.Id}/edit/${i}`;return this.#e.urlSubRoute(e)}openLightSpeedFeatInfo(){re(this.matDialog,y.LightSpeed,this.viewContainerRef,this.changeDetectorRef)}#s(){return m(d({},le),{columnDefs:[m(d({},u.IdWithDefaultRenderer),{cellRendererParams:u.idFieldParamsTooltipGetter()}),m(d({},u.IconShow),{cellRendererParams:{settings:()=>Se}}),m(d({},u.TextWide),{field:"Name",cellClass:"apps-list-primary-action highlight".split(" "),sort:"asc",cellRenderer:i=>{let e=i.data;return`
              <a class="default-link fill-cell" href="#${this.#e.urlSubRoute(e.Id.toString())}">
                <div class="container">
                  ${e.Thumbnail?`<img class="image logo" src="${e.Thumbnail}?w=40&h=40&mode=crop"></img>`:'<div class="image logo"><span class="material-symbols-outlined">star</span></div>'}
                  ${i.value}
                </div>
              </a>
            `}}),m(d({},u.TextWide),{field:"Folder"}),m(d({},u.Character),{field:"Version",width:78}),m(d({},u.Number),{field:"Items"}),m(d({},u.Boolean),{field:"HasCodeWarnings",headerName:"Code",filter:se,cellRenderer:pe,cellRendererParams:{settings:()=>Me}}),m(d({},u.ActionsPinnedRight3),{cellRenderer:Ie,cellRendererParams:{lightSpeedLink:i=>this.#r(i),openLightspeedFeatureInfo:()=>this.openLightSpeedFeatInfo(),do:(i,e)=>{switch(i){case"deleteApp":this.#n(e);break;case"flushCache":this.#a(e);break}}}})]})}#o(){this.#i.update(t=>++t)}static{this.\u0275fac=function(i){return new(i||n)(f(q),f(H),f(K),f(T),f($))}}static{this.\u0275cmp=g({type:n,selectors:[["app-apps-list"]],decls:25,vars:9,consts:[[1,"grid-wrapper","mat-tab-grid-wrapper"],["appDragAndDrop","",1,"ag-theme-material",3,"filesDropped","rowData","gridOptions","allowedFileTypes"],["align","end"],[1,"eav-eco-fab-speed-dial",3,"openChange","ngClass"],[3,"spin"],["mat-fab","",1,"grid-fab"],[1,"spin180"],[1,"eav-eco-fab-speed-dial-actions"],["mat-mini-fab","","label","Find more apps",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["mat-mini-fab","","label","Create inherited app",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["mat-mini-fab","","label","Add from folder",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["matBadgeColor","accent","matBadgeSize","small","matBadgeIcon","diamond","matBadgePosition","below after","aria-hidden","false",3,"matBadgeHidden"],["mat-mini-fab","","label","Import app",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["mat-mini-fab","","label","Create app",1,"eav-eco-fab-speed-dial-action-button",3,"click"]],template:function(i,e){i&1&&(o(0,"div",0)(1,"ag-grid-angular",1),l("filesDropped",function(h){return e.importApp(h)}),a(),o(2,"mat-dialog-actions",2)(3,"eco-fab-speed-dial",3),l("openChange",function(h){return e.openChange(h)}),o(4,"eco-fab-speed-dial-trigger",4)(5,"button",5)(6,"mat-icon",6),r(7),a()()(),o(8,"eco-fab-speed-dial-actions",7)(9,"button",8),l("click",function(){return e.browseCatalog()}),o(10,"mat-icon"),r(11,"search"),a()(),o(12,"button",9),l("click",function(){return e.createInheritedApp()}),o(13,"mat-icon"),r(14,"holiday_village"),a()(),o(15,"button",10),l("click",function(){return e.addFromFolder()}),o(16,"mat-icon",11),r(17," add "),a()(),o(18,"button",12),l("click",function(){return e.importApp()}),o(19,"mat-icon"),r(20,"cloud_upload"),a()(),o(21,"button",13),l("click",function(){return e.createApp()}),o(22,"mat-icon"),r(23,"add"),a()()()()()(),b(24,"router-outlet")),i&2&&(s(),c("rowData",e.apps())("gridOptions",e.gridOptions)("allowedFileTypes","zip"),s(2),c("ngClass",P(7,Le,e.fabOpen())),s(),c("spin",!0),s(3),O(" ",e.fabOpen()?"close":"add"," "),s(9),c("matBadgeHidden",e.isAddFromFolderEnabled()))},dependencies:[ue,me,Q,be,N,_e,X,z,W,C,v,ge,A,ve,G,he],styles:[`[_nghost-%COMP%]     .ag-row-hover .ag-cell a, [_nghost-%COMP%]     .ag-row-hover .ag-cell .id-box *, [_nghost-%COMP%]     .ag-row-hover .ag-cell .eav-grid-action-button{color:#85283b!important}
/*# sourceMappingURL=apps-list-7IXWHLUE.css.map */`]})}}return n})();export{Dt as AppsListComponent};
//# sourceMappingURL=https://sources.2sxc.org/21.00.00/dist/ng-edit/apps-list-JY4ZYKFA.js.map
