{
  "version": 3,
  "sources": ["projects/eav-ui/src/app/app-administration/services/dialog-config-global.service.ts"],
  "sourcesContent": ["import { Injectable } from '@angular/core';\r\nimport { map, Observable, shareReplay, tap } from 'rxjs';\r\nimport { classLog } from '../../shared/logging';\r\nimport { DialogSettings } from '../../shared/models/dialog-settings.model';\r\nimport { GlobalConfigService } from '../../shared/services/global-config.service';\r\nimport { HttpServiceBase } from '../../shared/services/http-service-base';\r\n\r\nconst webApiSettings = 'admin/dialog/settings';\r\n\r\n/**\r\n * Service for getting dialog settings for the current app.\r\n *\r\n * Note that it should normally be shared, to save resources / network calls.\r\n */\r\n@Injectable({ providedIn: 'root' })\r\nexport class DialogConfigGlobalService extends HttpServiceBase {\r\n\r\n  log = classLog({ DialogConfigGlobalService });\r\n\r\n  constructor(private globalConfigService: GlobalConfigService,) {\r\n    super();\r\n    this.log.a(`using context #${this.context.log.svcId}`);\r\n  }\r\n\r\n  private dialogSettings$: Record<number, Observable<DialogSettings>> = {};\r\n  // TODO: @2dg, ask 2dm \r\n  getShared$(appId: number): Observable<DialogSettings> {\r\n    this.log.a('getShared$ appId: ' + appId);\r\n    this.dialogSettings$[appId] ??= this.#getDialogSettings(appId, 'getShared$')\r\n      .pipe(\r\n        shareReplay({ refCount: false })\r\n      );\r\n    return this.dialogSettings$[appId];\r\n  }\r\n\r\n  #getDialogSettings(appId?: number, reqBy?: string): Observable<DialogSettings> {\r\n    this.log.a('getDialogSettings', { appId, reqBy });\r\n    return this.getHttpApiUrl<DialogSettings>(webApiSettings, {\r\n      params: { appId: appId ?? this.appId },\r\n    }).pipe(\r\n      map(dlgSettings => {\r\n        dlgSettings.Context.Language.List = dlgSettings.Context.Language.List.filter(language => language.IsEnabled);\r\n        return dlgSettings;\r\n      }),\r\n      tap(dlgSettings => {\r\n        this.globalConfigService.allowDebug(dlgSettings.Context.Enable.DebugMode);\r\n      }),\r\n    );\r\n  }\r\n}\r\n"],
  "mappings": "+LAOA,IAAMA,EAAiB,wBAQVC,GAA0B,IAAA,CAAjC,MAAOA,UAAkCC,CAAe,CAI5DC,YAAoBC,EAAwC,CAC1D,MAAK,EADa,KAAAA,oBAAAA,EAFpB,KAAAC,IAAMC,EAAS,CAAEL,0BAAAA,CAAyB,CAAE,EAOpC,KAAAM,gBAA8D,CAAA,EAHpE,KAAKF,IAAIG,EAAE,kBAAkB,KAAKC,QAAQJ,IAAIK,KAAK,EAAE,CACvD,CAIAC,WAAWC,EAAa,CACtB,YAAKP,IAAIG,EAAE,qBAAuBI,CAAK,EACvC,KAAKL,gBAAgBK,CAAK,IAAM,KAAKC,GAAmBD,EAAO,YAAY,EACxEE,KACCC,EAAY,CAAEC,SAAU,EAAK,CAAE,CAAC,EAE7B,KAAKT,gBAAgBK,CAAK,CACnC,CAEAC,GAAmBD,EAAgBK,EAAc,CAC/C,YAAKZ,IAAIG,EAAE,oBAAqB,CAAEI,MAAAA,EAAOK,MAAAA,CAAK,CAAE,EACzC,KAAKC,cAA8BlB,EAAgB,CACxDmB,OAAQ,CAAEP,MAAOA,GAAS,KAAKA,KAAK,EACrC,EAAEE,KACDM,EAAIC,IACFA,EAAYC,QAAQC,SAASC,KAAOH,EAAYC,QAAQC,SAASC,KAAKC,OAAOC,GAAYA,EAASC,SAAS,EACpGN,EACR,EACDO,EAAIP,GAAc,CAChB,KAAKjB,oBAAoByB,WAAWR,EAAYC,QAAQQ,OAAOC,SAAS,CAC1E,CAAC,CAAC,CAEN,iDAjCW9B,GAAyB+B,EAAAC,CAAA,CAAA,CAAA,CAAA,iCAAzBhC,EAAyBiC,QAAzBjC,EAAyBkC,UAAAC,WADZ,MAAM,CAAA,CAAA,SACnBnC,CAA0B,GAAA",
  "names": ["webApiSettings", "DialogConfigGlobalService", "HttpServiceBase", "constructor", "globalConfigService", "log", "classLog", "dialogSettings$", "a", "context", "svcId", "getShared$", "appId", "#getDialogSettings", "pipe", "shareReplay", "refCount", "reqBy", "getHttpApiUrl", "params", "map", "dlgSettings", "Context", "Language", "List", "filter", "language", "IsEnabled", "tap", "allowDebug", "Enable", "DebugMode", "\u0275\u0275inject", "GlobalConfigService", "factory", "\u0275fac", "providedIn"]
}
