{
  "version": 3,
  "sources": ["projects/eav-ui/src/app/app-administration/services/content-types.service.ts"],
  "sourcesContent": ["import { httpResource } from '@angular/common/http';\r\nimport { computed, Injectable, Signal } from '@angular/core';\r\nimport { FileUploadResult } from '../../shared/components/file-upload-dialog';\r\nimport { ScopeOption } from '../../shared/constants/eav.constants';\r\nimport { HttpServiceBase } from '../../shared/services/http-service-base';\r\nimport { ContentType, ContentTypeEdit } from '../models/content-type.model';\r\nimport { ScopeDetailsDto } from '../models/scopedetails.dto';\r\n\r\n// We should list all the \"full\" paths here, so it's easier to find when searching for API calls\r\nexport const webApiTypeRoot = 'admin/type/';\r\nconst webApiTypeGet = 'admin/type/get';\r\nconst webApiTypes = 'admin/type/list';\r\nconst webApiTypeScopes = 'admin/type/scopes';\r\nconst webApiTypeSave = 'admin/type/save';\r\nconst webApiTypeDelete = 'admin/type/delete';\r\nconst webApiTypeImport = 'admin/type/import';\r\nconst webApiTypeAddGhost = 'admin/type/addghost';\r\n@Injectable()\r\nexport class ContentTypesService extends HttpServiceBase {\r\n\r\n  // TODO: @2dg, ask 2dm \r\n  // content-export.component.ts\r\n  // content-import.component.ts\r\n  // data.component.ts\r\n  retrieveContentType(nameId: string) {\r\n    return this.getHttpApiUrl<ContentType>(webApiTypeGet, {\r\n      params: { appId: this.appId, contentTypeId: nameId }\r\n    });\r\n  }\r\n\r\n  getType(nameId: string) {\r\n    return httpResource<ContentType>(() => ({\r\n      url: this.apiUrl(webApiTypeGet),\r\n      params: { appId: this.appId, contentTypeId: nameId }\r\n    }));\r\n  }\r\n\r\n  getTypes(scope: Signal<string>) {\r\n    return httpResource<ContentType[]>(() => ({\r\n      url: this.apiUrl(webApiTypes),\r\n      params: { appId: this.appId, scope: scope() }\r\n    }), {defaultValue: []});\r\n  }\r\n\r\n  retrieveContentTypesPromise(scope: string): Promise<ContentType[]> {\r\n    return this.fetchPromise<ContentType[]>(webApiTypes, {\r\n      params: { appId: this.appId, scope }\r\n    });\r\n  }\r\n\r\n  getScopesPromise(): Promise<ScopeOption[]> {\r\n    return this.fetchPromise<{ old: Record<string, string>, scopes: ScopeDetailsDto[] }>(webApiTypeScopes, {\r\n      params: { appId: this.appId }\r\n    }).then(scopesData => {\r\n      const scopes = scopesData.old;\r\n      const scopeOptions: ScopeOption[] = Object.keys(scopes).map(key => ({\r\n        name: scopes[key],\r\n        value: key,\r\n      }));\r\n      return scopeOptions;\r\n    });\r\n  }\r\n\r\n  getScopesSig() {\r\n    const scopesSignal = httpResource<{ old: Record<string, string>, scopes: ScopeDetailsDto[] }>(() => ({\r\n      url: this.apiUrl(webApiTypeScopes),\r\n      params: { appid: this.appId },\r\n    }));\r\n\r\n    const scopeOptionsSignal = computed(() => {\r\n      // Access the value property directly without calling scopesSignal as a function\r\n      const value = scopesSignal.value;\r\n      const scopesData = value();\r\n\r\n      // Add null/undefined check here\r\n      if (!scopesData || !scopesData.old) {\r\n        return []; // Return an empty array or handle this case as appropriate\r\n      }\r\n\r\n      const scopes = scopesData.old;\r\n      return Object.keys(scopes).map(key => ({ name: scopes[key], value: key }));\r\n    });\r\n\r\n    return scopeOptionsSignal;\r\n  }\r\n\r\n  getScopesV2Promise(): Promise<ScopeDetailsDto[]> {\r\n    return this.fetchPromise<{ old: Record<string, string>, scopes: ScopeDetailsDto[] }>(webApiTypeScopes, {\r\n      params: { appId: this.appId }\r\n    }).then(scopesData => scopesData.scopes);\r\n  }\r\n\r\n  save(contentType: ContentTypeEdit) {\r\n    return this.http.post<boolean>(this.apiUrl(webApiTypeSave), contentType, {\r\n      params: { appid: this.appId },\r\n    });\r\n  }\r\n\r\n  delete(contentType: ContentType) {\r\n    return this.http.delete<boolean>(this.apiUrl(webApiTypeDelete), {\r\n      params: { appid: this.appId, staticName: contentType.NameId }, // TODO: @2pp - replace staticName with NameId\r\n    });\r\n  }\r\n\r\n  import(files: File[]) {\r\n    const formData = new FormData();\r\n    for (const file of files) {\r\n      formData.append('File', file);\r\n    }\r\n    return this.http.post<FileUploadResult>(this.apiUrl(webApiTypeImport), formData, {\r\n      params: { appId: this.appId, zoneId: this.zoneId },\r\n    });\r\n  }\r\n\r\n  createGhost(sourceNameId: string) {\r\n    return this.http.post<boolean>(this.apiUrl(webApiTypeAddGhost), null, {\r\n      params: { appid: this.appId, sourceNameId },\r\n    });\r\n  }\r\n}\r\n"],
  "mappings": "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",
  "names": ["webApiTypeRoot", "webApiTypeGet", "webApiTypes", "webApiTypeScopes", "webApiTypeSave", "webApiTypeDelete", "webApiTypeImport", "webApiTypeAddGhost", "ContentTypesService", "HttpServiceBase", "retrieveContentType", "nameId", "getHttpApiUrl", "params", "appId", "contentTypeId", "getType", "httpResource", "url", "apiUrl", "getTypes", "scope", "defaultValue", "retrieveContentTypesPromise", "fetchPromise", "getScopesPromise", "then", "scopesData", "scopes", "old", "Object", "keys", "map", "key", "name", "value", "getScopesSig", "scopesSignal", "appid", "computed", "getScopesV2Promise", "save", "contentType", "http", "post", "delete", "staticName", "NameId", "import", "files", "formData", "FormData", "file", "append", "zoneId", "createGhost", "sourceNameId", "__ngFactoryType__", "factory", "\u0275fac"]
}
