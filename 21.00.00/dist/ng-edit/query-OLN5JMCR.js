import{a as Re}from"./chunk-X2MVCWDY.js";import{a as $e,b as De,c as Ee,d as Ie}from"./chunk-MVZE4EY4.js";import{a as ge,b as _e,c as Ce,d as Se}from"./chunk-GKCVCYTH.js";import{a as be,c as Te,d as k,e as u,g as N,i as G,j as Me}from"./chunk-OPPDVHDF.js";import{a as A}from"./chunk-WO7E65AC.js";import"./chunk-Z7CBEHUH.js";import"./chunk-Q5UOKVIL.js";import{f as we}from"./chunk-VSMYOUA2.js";import"./chunk-O3YSC345.js";import"./chunk-LTBMRGUR.js";import"./chunk-Q7SYXYTY.js";import"./chunk-HW433KCS.js";import"./chunk-GLFISIX2.js";import"./chunk-MBSXBYF5.js";import"./chunk-AAMPB3UT.js";import"./chunk-DDUEZMYJ.js";import{b as ye}from"./chunk-43T4DH5V.js";import"./chunk-J5KNE364.js";import"./chunk-RAUQWANF.js";import"./chunk-3S44UA6M.js";import"./chunk-S7Y6G6OZ.js";import"./chunk-RRABFPYC.js";import"./chunk-JZD2T5W2.js";import"./chunk-GEYEBE5H.js";import"./chunk-EDOMTBDN.js";import"./chunk-M6AZRTKS.js";import"./chunk-NKT65OQW.js";import"./chunk-NIPOW2E2.js";import"./chunk-ORK43FFD.js";import"./chunk-56YE37V6.js";import"./chunk-V5UC4TMG.js";import"./chunk-U657U553.js";import"./chunk-QFYVXC4V.js";import{a as ee,b as te}from"./chunk-T7AKPKMZ.js";import"./chunk-L77E4UL2.js";import"./chunk-JNRBLGLU.js";import"./chunk-MWYLUFVP.js";import"./chunk-4YE3E6NH.js";import"./chunk-ZBQC6E3M.js";import"./chunk-AO43RQAG.js";import"./chunk-SCB2MVKQ.js";import"./chunk-4SMJHLGZ.js";import"./chunk-JEQANFI7.js";import"./chunk-564RKXG7.js";import{c as he}from"./chunk-HJXR3IL7.js";import"./chunk-BTK5NHS7.js";import"./chunk-K5FCDENP.js";import{b as fe,c as ve}from"./chunk-ODL7UGWI.js";import"./chunk-R3Y7P2GW.js";import"./chunk-LPOE4446.js";import"./chunk-WAPW5AUJ.js";import"./chunk-GVW7AWVE.js";import"./chunk-HYUOS4CI.js";import{a as Z}from"./chunk-ENHI5GWA.js";import"./chunk-DAEXUMJT.js";import"./chunk-IGMB27B5.js";import"./chunk-ME7PJXWA.js";import"./chunk-GL2SUH6T.js";import"./chunk-3M22BTAM.js";import"./chunk-HCPBPEHV.js";import{f as pe,l as ce}from"./chunk-QVLOO535.js";import{c as xe}from"./chunk-XREQECMQ.js";import"./chunk-RPJBZPSB.js";import"./chunk-UMOPET3G.js";import{b as le,i as me,j as de}from"./chunk-4LV77BQU.js";import"./chunk-EZZQWHAZ.js";import{b as oe,c as re}from"./chunk-23CS2WID.js";import{a as L}from"./chunk-OIHIMR2W.js";import"./chunk-BDMUNOAA.js";import{c as ie,d as ne,e as ae}from"./chunk-OYQCZWOE.js";import{b as ue}from"./chunk-G33ZJSCE.js";import{ca as se}from"./chunk-DX662RXJ.js";import"./chunk-N5GZ74QQ.js";import"./chunk-XASILSQS.js";import{Ac as J,Cb as c,Db as n,Eb as o,Fb as v,Gb as D,Hb as E,Lc as K,Nb as V,Ob as O,Pb as I,Rb as x,Sa as d,U,Za as _,db as M,ec as s,fc as X,g as P,gc as F,ib as q,id as Y,jb as T,oa as w,pa as $,u as S,v as g,wb as Q,xb as W,yb as j,zc as z}from"./chunk-46QINP2S.js";import{a as B,b as H}from"./chunk-BDOJB7O2.js";var Qe=(()=>{class t{constructor(){this.data=K(),this.scenarios=Me}ngOnInit(){}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=M({type:t,selectors:[["app-dev-query-introduction"]],inputs:{data:[1,"data"]},decls:12,vars:0,consts:[["href","https://docs.2sxc.org/index.html","target","_blank"],["href","https://docs.2sxc.org/basics/query/index.html","target","_blank"],["href","https://docs.2sxc.org/web-api/query-rest-web-api.html","target","_blank"]],template:function(i,r){i&1&&(D(0,"p"),s(1," To learn more about queries you may want to read these "),D(2,"a",0),s(3,"docs"),E(),s(4,`:
`),E(),D(5,"ul")(6,"li")(7,"a",1),s(8,"Queries in 2sxc"),E()(),D(9,"li")(10,"a",2),s(11,"Query REST API"),E()()())},encapsulation:2})}}return t})();function Ae(t,l,e,i,r,m,a){let f=i[0]!=="/"&&!i.startsWith("http");a&&a.length&&a[0]!=="?"&&(a="?"+a);let y=f?`${a}${a?"&":"?"}PageId=${e.tabId}&ModuleId=${e.moduleId}`:"",b=t.http.apiUrl(i)+y,p=i+a,h=`${i}/${m??"Default"}${a}`;return[new k(f,"GET",p,"read all query streams","Read list of all items",!0,je(l,p,e),b),new k(f,"GET",h,"read only Stream Default","Read list of all items",!0,je(l,h,e),b)]}function je(t,l,e,i){let r=e.moduleId,m=l[0]!=="/",a=[],f=`${l}?PageId=${e.tabId}&ModuleId=${r}`;t.inSameContext&&a.push(new u("Example with global $2sxc and event-context","This example finds the context information from the HTML where an action started.",`
<button onclick="$2sxc(this).webApi.get('${l}').then(data => console.log(data))">
  get it
</button>`,!1,[N])),t.in2sxc&&a.push(new u(`Example with global $2sxc and a Module-Id ${r}`,"This is how you get the context when your code doesn't start with a DOM context, so you need the moduleId.",`
// get the sxc-controller for this module
var sxc = $2sxc(${r});
// now get the data in the promise
sxc.webApi.get('${l}')
  .then(data => {
    console.log(data)
  });`,!1,[N]),new u("Same example as one-liner","This is the same as above, but as a one-liner so you can run it directly in the F12 console right now.",`$2sxc(${r}).webApi.get('${l}').then(data => console.log('just got:', data));`,!0)),t.in2sxc&&t.inSameContext&&a.push(new u("Example where you get the Module-Id from Razor","This example doesn't use a fixed moduleId but let's the Razor add the current moduleId when the page is rendered.",`
// this will be replaced on the server with the ID
var moduleId = @Dnn.Module.ModuleID;
var sxc = $2sxc(moduleId);
var promise = sxc.webApi.get('${l}');`,!1,[N]));let y=m?`$2sxc.http.apiUrl('${l}')`:`'${l}'`,b=m?`$2sxc.http.apiUrl('${f}')`:`'${f}'`;return t.inSameSite?(a.push(new u("Using jQuery inside DNN",`This example uses jQuery instead of the $2sxc to do the AJAX call.
      It shows you how to resolve the virtual path for use in other ways.`,`
var endpoint = ${y};
$.ajax({
  url:endpoint,
  beforeSend: $.dnnSF(${r}).setModuleHeaders
}).then(data => {
  console.log('Got this data:', data);
})`,!1,[])),a.push(new u("Using jQuery as single-liner",`The same example as above, just as single-liner so you can test it directly in the F12 console.
      This will only work if you're on a DNN page with this module.`,`$.ajax({url: ${y}, beforeSend: $.dnnSF(${r}).setModuleHeaders }).then(data => console.log(data))`,!1,[])),a.push(new u("Using jQuery and add Context in URL",`This example uses jQuery instead of the $2sxc to do the AJAX call.
      But instead of using the DNN Services Framework it adds relevant headers to the url.`,`
$.ajax(${b}).then(data => {
  console.log('Got this data:', data);
})`,!1,[])),a.push(new u("Using jQuery with url-context as single-liner",`The same example as above, just as single-liner so you can test it directly in the F12 console.
      This will work on a DNN page which has jQuery activated. `,`$.ajax(${b}).then(data => console.log(data))`,!1,[]))):(a.push(new u("Using jQuery in another Site or External",`This example uses jQuery and doesn't use $2sxc or the DNN ServicesFramework,
      because they would be either missing, or give wrong context-headers.`,`
$.ajax('${l}').then(data => {
  console.log('Got this data:', data);
})`,!1,[G])),a.push(new u("Using jQuery with Context in URL","This example uses jQuery and includes a module-context. This is unusual for external access, but may be needed sometime.",`
$.ajax('${f}').then(data => {
  console.log('Got this data:', data);
})`,!1,[G]))),a}function Fe(t,l){if(t&1){let e=V();n(0,"button",16),I("click",function(){w(e);let r=x(2);return $(r.closeDialog())}),n(1,"mat-icon"),s(2,"close"),o()()}}function Le(t,l){t&1&&(n(0,"div",17)(1,"mat-icon"),s(2,"emoji_objects"),o(),n(3,"span"),s(4,"Introduction"),o()())}function ke(t,l){if(t&1&&(n(0,"div",18)(1,"mat-icon"),s(2,"code_curly"),o(),n(3,"span"),s(4),o()()),t&2){let e=x();c("tippy",(e.scenario.useVirtual?"Virtual ":"Absolute ")+"REST URLs"),d(4),F("Call ",e.scenario.useVirtual?"Virtual":"Absolute"," REST URLs")}}function Ge(t,l){t&1&&(n(0,"mat-icon"),s(1,"warning"),o())}function Be(t,l){if(t&1&&(n(0,"div",19)(1,"mat-icon"),s(2,"person"),o(),n(3,"span"),s(4),o(),Q(5,Ge,2,0,"mat-icon"),o()),t&2){let e=x();d(4),F("Permissions (",e.permissions.length,")"),d(),j(e.permissions.length?-1:5)}}function He(t,l){t&1&&(n(0,"div",20)(1,"mat-icon"),s(2,"perm_device_information"),o(),n(3,"span"),s(4,"HTTP headers & \xA0"),n(5,"code"),s(6,"/auto/"),o()()())}function qe(t,l){if(t&1){let e=V();n(0,"div",0)(1,"div",1)(2,"div",2),s(3,"Using REST with Query:\xA0 "),n(4,"code"),s(5),o()(),Q(6,Fe,3,0,"button",3),o(),n(7,"div",4),v(8,"router-outlet"),n(9,"app-selector-with-help",5),I("valueChange",function(r){w(e);let m=x();return $(m.changeScenario(r))}),o(),n(10,"mat-tab-group",6)(11,"mat-tab"),T(12,Le,5,0,"div",7),v(13,"app-dev-query-introduction",8)(14,"app-dev-rest-tab-introduction",8),o(),n(15,"mat-tab"),T(16,ke,5,2,"div",9),v(17,"app-dev-rest-tab-examples-intro",8),n(18,"div",10)(19,"mat-form-field",11)(20,"mat-label"),s(21,"Stream Name(s) to Limit, comma-separated"),o(),n(22,"input",12),I("input",function(r){w(e);let m=x();return $(m.updateStreams(r))}),o()(),n(23,"mat-form-field",11)(24,"mat-label"),s(25,"Additional Url Parameters"),o(),n(26,"input",13),I("input",function(r){w(e);let m=x();return $(m.updateParams(r))}),o()()(),v(27,"app-dev-rest-urls-and-code",8),o(),n(28,"mat-tab"),T(29,Be,6,2,"div",14),v(30,"app-dev-rest-tab-permissions",8),o(),n(31,"mat-tab"),T(32,He,7,0,"div",15),v(33,"app-dev-rest-tab-headers",8),o()()()()}if(t&2){let e=l,i=x();d(5),X(e.name),d(),j(i.isSideNavContent?-1:6),d(3),c("items",i.scenarios)("valueInput",e.scenario.key),d(4),c("data",e),d(),c("data",e),d(3),c("data",e),d(5),c("value",i.streamNames$.value),d(4),c("value",i.urlParams$.value),d(),c("data",e),d(3),c("data",e),d(3),c("data",e)}}function We(t,l){t&1&&v(0,"mat-spinner")}var Oe="app/{appname}/query/{queryname}",Vt=(()=>{class t extends be{#e;constructor(e,i,r,m,a){let f=L(ye);super(e,i,a,r,m,f),this.hostClass="dialog-component",this.urlParams$=new P(""),this.streamNames$=new P("Default"),this.#e=L(we),this.isSideNavContent=this.router.url.includes(A.routeQuery);let y=g([m.paramMap.pipe(S(p=>p.get(A.paramQuery))),this.#e.getAll(he.contentTypes.query).pipe(U())]).pipe(S(([p,h])=>h.find(C=>C.Guid===p)),U());this.permissions$=this.buildPermissionStream(A.paramQuery);let b=g([y,this.scenario$,this.dialogSettings$]).pipe(S(([p,h,C])=>{let R=Oe.replace("{queryname}",p.Name).replace("{appname}",h.inSameContext?"auto":encodeURI(C.Context.App.Folder));return this.rootBasedOnScenario(R,h)}));this.viewModel$=g([g([y,this.scenario$,this.permissions$]),g([b,this.dialogSettings$]),g([this.streamNames$,this.urlParams$])]).pipe(S(([[p,h,C],[R,Ne],[Pe,Ue]])=>H(B({},this.buildBaseViewModel(p.Name,p.Guid,Ne,C,R,h)),{query:p,apiCalls:Ae(a.$2sxc,h,e,R,0,Pe,Ue)})))}updateStreams(e){this.streamNames$.next(e.target.value)}updateParams(e){this.urlParams$.next(e.target.value)}static{this.\u0275fac=function(i){return new(i||t)(_(se),_(ue),_(ae),_(ie),_(Z))}}static{this.\u0275cmp=M({type:t,selectors:[["app-dev-rest-query"]],hostVars:1,hostBindings:function(i,r){i&2&&O("className",r.hostClass)},features:[q],decls:3,vars:3,consts:[[1,"eav-dialog","eav-no-scrollbar"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog"],[1,"eav-dialog-content"],["label","Choose Scenario",3,"valueChange","items","valueInput"],["dynamicHeight","","color","accent",1,"mat-tab-group-fit-height","mat-tab-group-fancy-scrollbar","default-fonts"],["class","mat-tab-label-box","tippy","Introduction",4,"matTabLabel"],[3,"data"],["class","mat-tab-label-box",3,"tippy",4,"matTabLabel"],[1,"params-form"],["color","accent",1,"eav-mat-form-field"],["matInput","","placeholder","Default",3,"input","value"],["matInput","","placeholder","?id=27",3,"input","value"],["class","mat-tab-label-box","tippy","Permissions",4,"matTabLabel"],["class","mat-tab-label-box","tippy","HTTP headers and auto",4,"matTabLabel"],["mat-icon-button","","tippy","Close dialog",3,"click"],["tippy","Introduction",1,"mat-tab-label-box"],[1,"mat-tab-label-box",3,"tippy"],["tippy","Permissions",1,"mat-tab-label-box"],["tippy","HTTP headers and auto",1,"mat-tab-label-box"]],template:function(i,r){if(i&1&&(Q(0,qe,34,12,"div",0),z(1,"async"),W(2,We,1,0,"mat-spinner")),i&2){let m;j((m=J(1,1,r.viewModel$))?0:2,m)}},dependencies:[ce,pe,xe,re,oe,ne,Te,te,ee,Se,ge,_e,Ce,Qe,Ie,De,de,me,le,ve,fe,$e,Re,Ee,Y],styles:[`mat-spinner[_ngcontent-%COMP%]{margin:50px auto;display:block}
/*# sourceMappingURL=query-SE5SVX5E.css.map */`]})}}return t})();export{Vt as DevRestQueryComponent};
//# sourceMappingURL=https://sources.2sxc.org/21.00.00/dist/ng-edit/query-OLN5JMCR.js.map
