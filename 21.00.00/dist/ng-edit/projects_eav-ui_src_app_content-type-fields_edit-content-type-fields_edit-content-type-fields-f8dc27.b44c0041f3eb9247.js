"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_content-type-fields_edit-content-type-fields_edit-content-type-fields-f8dc27"],{63628(U,y,e){e.d(y,{i:()=>R});var I=e(79748),r=e(85309),f=e(93840),c=e(90852),g=e(34601),C=e(18759),v=e(56884),s=e(36124),O=e(82272),F=e(74390),E=e(18934),T=e(17828);function h(u,B){if(1&u){const m=s.RV6();s.j41(0,"button",1),s.nI1(1,"translate"),s.nI1(2,"translate"),s.bIt("click",function(M){v.eBV(m);const L=s.XpG();return v.Njj(L.onClick(M))}),s.j41(3,"span"),s.EFF(4),s.nI1(5,"translate"),s.k0s(),s.j41(6,"span",2)(7,"kbd"),s.EFF(8,"\u2303"),s.k0s(),s.j41(9,"kbd"),s.EFF(10,"\u23ce"),s.k0s()(),s.j41(11,"mat-icon"),s.EFF(12),s.k0s()()}if(2&u){const m=s.XpG();s.Y8G("type",m.triggerOnFormSubmit()?"submit":"button")("tippy",s.bMT(1,6,m.label())+" ("+s.bMT(2,8,"Form.Buttons.ActionAndCloseShortcut")+")")("ngClass",m.ngClass())("disabled",m.isDisabled),s.R7$(4),s.JRh(s.bMT(5,10,m.label())),s.R7$(8),s.JRh(m.icon())}}let R=(()=>{class u extends C.d{static{this.\u0275fac=(()=>{let m;return function(M){return(m||(m=s.xGo(u)))(M||u)}})()}static{this.\u0275cmp=s.VBU({type:u,selectors:[["app-save-close-button-fab"]],features:[s.Vt3],decls:2,vars:0,consts:[["extendedFabSpeedDialTriggerContent",""],["tippyShowDelay","500","extended-fab-speed-dial-trigger","","matRipple","",3,"click","type","tippy","ngClass","disabled"],[1,"keybinding-hint"]],template:function(D,M){1&D&&(s.j41(0,"extended-fab-speed-dial"),s.DNE(1,h,13,12,"ng-template",0),s.k0s())},dependencies:[I.YU,f.m_,f.An,O.d,F.t,E.Q,r.p,T.r6,c.h,g.e,c.D9],styles:[".disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:.5}.keybinding-hint[_ngcontent-%COMP%]{display:inline-flex;align-items:center;font-size:.75rem;line-height:1.5}.keybinding-hint[_ngcontent-%COMP%]   kbd[_ngcontent-%COMP%] + kbd[_ngcontent-%COMP%]{margin-left:3px}"]})}}return u})()},76882(U,y,e){e.d(y,{T:()=>c});var I=e(91687),f=e(50819);function c(g,C){return(0,f.N)(function r(g,C,v,s,O){return(F,E)=>{let T=v,h=C,R=0;F.subscribe((0,I._)(E,u=>{const B=R++;h=T?g(h,u,B):(T=!0,u),s&&E.next(h)},O&&(()=>{T&&E.next(h),E.complete()})))}}(g,C,arguments.length>=2,!1,!0))}},98629(U,y,e){e.r(y),e.d(y,{EditContentTypeFieldsComponent:()=>pt});var I=e(79748),r=e(56884),f=e(36664),c=e(34456),g=e(84175),C=e(20762),v=e(87941),s=e(24950),O=e(93840),F=e(59791),E=e(25175),T=e(90852),h=e(59452),R=e(61318),u=e(51903),B=e(51567),m=e(43143),D=e(12938),M=e(47703),L=e(17693),N=e(32760),$=e(30281),V=e(11855),G=e(78742),X=e(1726),W=e(4202),Y=e(63628),A=e(67993),S=e(14007),j=e(35160),t=e(36124),J=e(69393),k=e(3347),K=e(80423),z=e(96462),H=e(55326);const Q=["ngForm"],Z=["autoFocusInputField"],w=o=>({"eav-input-obsolete":o}),q=(o,p)=>p.SortOrder;function tt(o,p){1&o&&t.EFF(0," Fields ")}function et(o,p){1&o&&t.EFF(0," Add Fields ")}function nt(o,p){1&o&&t.EFF(0," Edit Field ")}function it(o,p){if(1&o&&(t.j41(0,"app-field-hint",20),t.EFF(1),t.k0s()),2&o){const n=t.XpG(4);t.Y8G("isError",!0),t.R7$(),t.JRh(n.fieldNameError)}}function at(o,p){if(1&o&&(t.j41(0,"app-field-hint",20),t.EFF(1),t.k0s()),2&o){t.XpG(2);const n=t.sdS(6);t.Y8G("isError",!0),t.R7$(),t.SpI(" ",n.errors.reservedNames," ")}}function st(o,p){if(1&o&&(t.nVh(0,it,2,2,"app-field-hint",20),t.nVh(1,at,2,2,"app-field-hint",20)),2&o){t.XpG();const n=t.sdS(6);t.vxM(n.errors.pattern?0:-1),t.R7$(),t.vxM(n.errors.reservedNames?1:-1)}}function ot(o,p){if(1&o&&(t.j41(0,"mat-option",16),t.EFF(1),t.j41(2,"mat-icon",15),t.EFF(3),t.k0s()()),2&o){const n=p.$implicit;t.Y8G("value",n.name),t.R7$(),t.SpI(" ",n.label," "),t.R7$(2),t.JRh(n.icon)}}function lt(o,p){if(1&o&&(t.j41(0,"span")(1,"mat-icon",18),t.EFF(2),t.k0s()()),2&o){const n=t.XpG().$implicit;t.R7$(2),t.JRh(n.icon)}}function _t(o,p){if(1&o&&(t.j41(0,"mat-option",19),t.EFF(1),t.nVh(2,lt,3,1,"span"),t.k0s()),2&o){const n=p.$implicit;t.Y8G("value",n.inputType)("ngClass",t.eq3(4,w,n.isObsolete)),t.R7$(),t.SpI(" ",n.label," "),t.R7$(),t.vxM(n.icon?2:-1)}}function dt(o,p){if(1&o){const n=t.RV6();t.j41(0,"div",8)(1,"div",11)(2,"mat-form-field",12)(3,"mat-label"),t.EFF(4,"Name"),t.k0s(),t.j41(5,"input",13,1),t.mxI("ngModelChange",function(l){const i=r.eBV(n).$implicit;return t.DH7(i.StaticName,l)||(i.StaticName=l),r.Njj(l)}),t.k0s()(),t.nVh(8,st,2,2),t.k0s(),t.j41(9,"div",11)(10,"mat-form-field",12)(11,"mat-label"),t.EFF(12,"Data Type"),t.k0s(),t.j41(13,"mat-select",14),t.bIt("selectionChange",function(l){const i=r.eBV(n).$index,_=t.XpG(2);return r.Njj(_.setFieldType(i,l.value))}),t.j41(14,"mat-select-trigger")(15,"mat-icon",15),t.EFF(16),t.k0s(),t.j41(17,"span"),t.EFF(18),t.k0s()(),t.Z7z(19,ot,4,3,"mat-option",16,t.fX1),t.k0s()(),t.j41(21,"app-field-hint"),t.EFF(22),t.k0s()(),t.j41(23,"div",11)(24,"mat-form-field",12)(25,"mat-label"),t.EFF(26,"Input Type"),t.k0s(),t.j41(27,"mat-select",17),t.bIt("selectionChange",function(l){const i=r.eBV(n).$index,_=t.XpG(2);return r.Njj(_.updateFieldPart(i,{InputType:l.value}))}),t.j41(28,"mat-select-trigger")(29,"span"),t.EFF(30),t.k0s(),t.j41(31,"mat-icon",18),t.EFF(32),t.k0s()(),t.Z7z(33,_t,3,6,"mat-option",19,t.fX1),t.k0s()(),t.j41(35,"app-field-hint"),t.EFF(36),t.k0s()()()}if(2&o){let n,a;const l=p.$implicit,i=p.$index,_=t.sdS(6),d=t.XpG(2);t.R7$(5),t.Y8G("pattern",d.fieldNamePattern)("appReservedNames",d.reservedNames()),t.R50("ngModel",l.StaticName),t.Y8G("name","StaticName"+i)("disabled","inputType"===d.editMode),t.R7$(3),t.vxM(_.touched&&_.errors?8:-1),t.R7$(5),t.Y8G("ngModel",l.Type)("name","Type"+i)("disabled",null!=d.editMode),t.R7$(3),t.JRh(d.findIcon(l.Type)),t.R7$(2),t.JRh(d.findLabel(l.Type)),t.R7$(),t.Dyx(d.dataTypes()),t.R7$(3),t.JRh(d.hints()[i].data),t.R7$(5),t.Y8G("ngModel",l.InputType)("name","InputType"+i)("disabled","name"===d.editMode),t.R7$(3),t.JRh(null==(n=d.getInputTypeOption(l.InputType))?null:n.label),t.R7$(2),t.JRh(null==(a=d.getInputTypeOption(l.InputType))?null:a.icon),t.R7$(),t.Dyx(d.inputTypeOptions()[i]),t.R7$(3),t.JRh(d.hints()[i].input)}}function rt(o,p){if(1&o){const n=t.RV6();t.j41(0,"form",6,0),t.bIt("ngSubmit",function(){r.eBV(n);const l=t.XpG();return r.Njj(l.saveAndClose())}),t.j41(2,"div",7),t.Z7z(3,dt,37,18,"div",8,q),t.k0s(),t.j41(5,"mat-dialog-actions",9)(6,"app-save-close-button-fab",10),t.bIt("action",function(){r.eBV(n);const l=t.XpG();return r.Njj(l.saveAndClose())}),t.k0s()()()}if(2&o){const n=t.XpG();t.R7$(3),t.Dyx(n.fields()),t.R7$(3),t.Y8G("triggerOnFormSubmit",!0)("ngClass",n.canSave()?"":"disabled")("disabled",!n.canSave())}}let pt=(()=>{class o extends $.${#a;#t;constructor(n,a,l){super(),this.dialog=n,this.route=a,this.snackBar=l,this.hostClass="dialog-component",this.formValid=(0,r.vPA)(!1),this.canSave=(0,f.EW)(()=>this.formValid()&&!this.saving()),this.#a=(0,D.d)(L.g),this.#t=(0,D.d)(G.h),this.fieldNamePattern=M.w,this.fieldNameError=M.s,this.findIcon=S.y,this.findLabel=S.D,this.editMode=this.route.snapshot.paramMap.get("editMode"),this.filteredInputTypeOptions=[],this.saving=(0,r.vPA)(!1),this.dataTypes=this.#t.dataTypes().value,this.#e=this.#t.getInputTypes().value,this.#n=this.#a.getType(this.route.snapshot.paramMap.get("contentTypeStaticName")).value,this.#i=(0,f.EW)(()=>{const i=this.#n();return(0,r.O8t)(()=>this.#t.getFieldsLive((0,r.vPA)(0),i?.NameId))}),this.fields=(()=>{const i=(0,A.bo)("fields",()=>{const _=this.#i()();if(null!=this.editMode){if(0===_.length)return[];const d=this.route.snapshot.paramMap.get("id"),x=d?parseInt(d,10):null;return[_.find(b=>b.Id===x)]}return this.#o(_.length)});return(0,f.uu)({source:i,computation:_=>_})})(),this.#s=this.#t.getReservedNames().value,this.reservedNames=(0,A.bo)("reservedNamesAll",()=>{const i=this.#i()(),_=this.#s();if(0===i.length)return _;const d=j.O.mergeReserved(_,i);return"name"===this.editMode&&delete d[i[0].StaticName],d}),this.inputTypeOptions=(0,A.bo)("inputTypeOptions",()=>{const i=this.#e();return this.fields().map((d,x)=>i.filter(P=>P.dataType===d.Type.toLocaleLowerCase()))}),this.hints=(0,A.bo)("hints",()=>this.fields().map((_,d)=>{const x=this.dataTypes().find(b=>b.name===_.Type),P=this.#e().find(b=>b.inputType===_.InputType);return{data:x?.description??"",input:P?.isObsolete?`OBSOLETE - ${P.obsoleteMessage}`:P?.description??""}})),this.dialog.disableClose=!0,this.subscriptions.add(this.dialog.backdropClick().subscribe(i=>{this.ngForm?.dirty&&!confirm("You have unsaved changes. Are you sure you want to close this dialog?")||this.closeDialog()}))}#e;#n;#i;#s;ngAfterViewInit(){this.fields().length&&this.ngForm?(this.formValid.set(this.ngForm?.form.valid??!1),this.ngForm?.form.statusChanges.subscribe(()=>{this.formValid.set(this.ngForm?.form.valid??!1)}),this.autoFocusInputField&&setTimeout(()=>this.autoFocusInputField.first?.nativeElement?.focus(),250)):setTimeout(()=>this.ngAfterViewInit(),250)}ngOnInit(){this.#l()}#o(n){return[...Array(8).keys()].map(a=>({Id:0,Type:X.O.String,InputType:W.u.StringDefault,StaticName:"",IsTitle:0===n&&0===a,SortOrder:n+a+1}))}updateFieldPart(n,a){this.fields.update(l=>[...l].map((i,_)=>_!==n?i:{...i,...a}))}setFieldType(n,a){this.updateFieldPart(n,{Type:a});const l=a.toLocaleLowerCase()+W.u.DefaultSuffix,i=this.inputTypeOptions()[n],_=i.find(d=>d.inputType===l)?.inputType??i[0].inputType;this.updateFieldPart(n,{InputType:_})}getInputTypeOption(n){return this.#e().find(a=>a.inputType===n)}closeDialog(){this.dialog.close()}saveAndClose(){this.saving.set(!0),this.snackBar.open("Saving...");const n=()=>{this.saving.set(!1),this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()};if(null!=this.editMode){const a=this.fields()[0];"name"===this.editMode?this.#t.rename(a.Id,this.#n().Id,a.StaticName).subscribe(()=>n()):"inputType"===this.editMode&&this.#t.updateInputType(a.Id,a.StaticName,a.InputType).subscribe(()=>n())}else(0,h.of)(...this.fields()).pipe((0,B.p)(a=>!!a.StaticName),(0,u.H)(a=>this.#t.add(a,this.#n().Id).pipe((0,R.W)(l=>(0,h.of)(null)))),(0,m.$)()).subscribe(()=>n())}#l(){this.dialog.keydownEvents().subscribe(n=>{(0,N.YU)(n)&&this.canSave()&&(n.preventDefault(),this.saveAndClose())})}static{this.\u0275fac=function(a){return new(a||o)(t.rXU(v.CP),t.rXU(J.nX),t.rXU(k.UG))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["app-edit-content-type-fields"]],viewQuery:function(a,l){if(1&a&&t.GBs(Q,5,c.cV)(Z,5),2&a){let i;t.mGM(i=t.lsd())&&(l.ngForm=i.first),t.mGM(i=t.lsd())&&(l.autoFocusInputField=i)}},hostVars:1,hostBindings:function(a,l){2&a&&t.Avn("className",l.hostClass)},features:[t.Vt3],decls:10,vars:4,consts:[["ngForm","ngForm"],["staticName","ngModel","autoFocusInputField",""],[1,"eav-dialog","eav-no-scrollbar"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog",3,"click"],[3,"ngSubmit"],[1,"eav-dialog-content"],[1,"eav-row-container"],["align","end"],[3,"action","triggerOnFormSubmit","ngClass","disabled"],[1,"eav-edit-input"],["color","accent",1,"eav-mat-form-field"],["matInput","",3,"ngModelChange","pattern","appReservedNames","ngModel","name","disabled"],["panelClass","eav-type-field-type-select","panelWidth","",3,"selectionChange","ngModel","name","disabled"],[1,"eav-type-icon"],[3,"value"],["panelClass","eav-type-field-input-type-select","panelWidth","",3,"selectionChange","ngModel","name","disabled"],[1,"eav-input-icon"],[3,"value","ngClass"],[3,"isError"]],template:function(a,l){if(1&a&&(t.j41(0,"div",2)(1,"div",3)(2,"div",4),t.nVh(3,tt,1,0),t.nVh(4,et,1,0),t.nVh(5,nt,1,0),t.k0s(),t.j41(6,"button",5),t.bIt("click",function(){return l.closeDialog()}),t.j41(7,"mat-icon"),t.EFF(8,"close"),t.k0s()()(),t.nVh(9,rt,7,3,"form"),t.k0s()),2&a){let i;t.R7$(3),t.vxM(void 0===l.editMode?3:-1),t.R7$(),t.vxM(null===l.editMode?4:-1),t.R7$(),t.vxM(null!=l.editMode?5:-1),t.R7$(4),t.vxM(null!=(i=l.fields())&&i.length?9:-1)}},dependencies:[c.YN,c.qT,c.me,c.BC,c.cb,c.R_,c.vS,c.cV,s.RG,K.rl,K.nJ,F.fS,F.fg,j.O,E.Ve,E.VO,E.$2,z.wT,O.m_,O.An,C.S,I.YU,v.E7,g.Hl,H.iY,T.h,V.F,Y.i],styles:[".eav-row-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.eav-edit-input[_ngcontent-%COMP%]{padding-bottom:8px;width:30%}.eav-type-icon[_ngcontent-%COMP%]{width:inherit;height:inherit;margin-right:8px;font-size:inherit;vertical-align:top;line-height:inherit}.eav-input-icon[_ngcontent-%COMP%]{width:inherit;height:inherit;margin-left:8px;font-size:inherit;vertical-align:top;line-height:inherit}.eav-input-obsolete[_ngcontent-%COMP%]{-webkit-text-decoration:black line-through;text-decoration:black line-through;color:#696969}  .mdc-menu-surface.mat-mdc-select-panel.eav-type-field-input-type-select,   .mdc-menu-surface.mat-mdc-select-panel.eav-type-field-type-select{max-height:500px}"]})}}return o})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/21.00.00/dist/ng-edit/projects_eav-ui_src_app_content-type-fields_edit-content-type-fields_edit-content-type-fields-f8dc27.b44c0041f3eb9247.js.map