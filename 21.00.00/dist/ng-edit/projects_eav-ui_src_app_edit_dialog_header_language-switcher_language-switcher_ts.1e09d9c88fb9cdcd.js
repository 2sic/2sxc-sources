"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_edit_dialog_header_language-switcher_language-switcher_ts"],{66674(K,M,l){l.d(M,{LanguageSwitcherComponent:()=>J});var R=l(37580),D=l(36664),g=l(84175),u=l(93840),c=l(90852),L=l(7167),b=l(12938),m=l(34601),F=l(34435),k=l(8265),B=l(32093),C=l(9977),r=l(56884),d=l(87941),w=l(24950),p=l(25175),E=l(63628),I=l(32760);function y(o){const s=[],t={};return o.forEach(i=>{const n=_(i.Culture);t[n]?t[n]++:t[n]=1}),o.forEach(i=>{const n=_(i.Culture);s.push({...i,label:t[n]>1?`${n} (${i.NameId})`:n})}),s}function _(o){return o.substring(0,o.includes("(")?o.indexOf("(")-1:100).toLocaleUpperCase()}var O=l(38604),e=l(36124),v=l(80423),T=l(96462);function X(o,s){if(1&o&&(e.j41(0,"mat-option",3),e.EFF(1),e.k0s()),2&o){const t=s.$implicit;e.Y8G("value",t.Code.toLocaleLowerCase()),e.R7$(),e.JRh(t.label)}}let P=(()=>{class o{constructor(){}get selectedValue(){return this.userLanguageSvc.isForced(this.optionType)?this.userLanguageSvc.value(this.optionType):this.userLanguageSvc.stored(this.optionType)}onSelectionChange(t){this.userLanguageSvc.save(this.optionType,t.value)}static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-language-dropdown"]],inputs:{label:"label",tooltip:"tooltip",optionType:"optionType",options:"options",userLanguageSvc:"userLanguageSvc"},decls:11,vars:12,consts:[["appearance","fill","color","accent",3,"tippy"],[3,"selectionChange","value","disabled"],["value",""],[3,"value"]],template:function(i,n){1&i&&(e.j41(0,"mat-form-field",0),e.nI1(1,"translate"),e.j41(2,"mat-label"),e.EFF(3),e.nI1(4,"translate"),e.k0s(),e.j41(5,"mat-select",1),e.bIt("selectionChange",function(h){return n.onSelectionChange(h)}),e.j41(6,"mat-option",2),e.EFF(7),e.nI1(8,"translate"),e.k0s(),e.Z7z(9,X,2,2,"mat-option",3,e.fX1),e.k0s()()),2&i&&(e.Y8G("tippy",e.bMT(1,6,n.tooltip)),e.R7$(3),e.Lme(" ",e.bMT(4,8,n.label)," ",n.userLanguageSvc.isForced(n.optionType)?"(disabled)":""," "),e.R7$(2),e.Y8G("value",n.selectedValue)("disabled",n.userLanguageSvc.isForced(n.optionType)),e.R7$(2),e.SpI(" ",e.bMT(8,10,"LanguageSettings.UseCurrentLanguage")," "),e.R7$(2),e.Dyx(n.options))},dependencies:[w.RG,v.rl,v.nJ,d.hM,u.m_,g.Hl,m.e,p.Ve,p.VO,T.wT,c.h,c.D9],encapsulation:2})}}return o})();var $=l(55326);let j=(()=>{class o{#e;constructor(){this.#e=(0,r.WQX)(C.g),this.LanguagePart=O.a,this.userLanguageSvc=(0,b.d)(L.L),this.dialog=(0,r.WQX)(d.CP),this.options=y(this.#e.getAll())}ngOnInit(){this.#t()}get selectedValue(){return!!this.userLanguageSvc.primaryTranslatableEnabled()}onSelectionChange(t){this.userLanguageSvc.savePrimaryTranslatable(!!t.value)}closeDialog(){this.dialog.close()}#t(){this.dialog.keydownEvents().subscribe(t=>{(0,I.YU)(t)&&(t.preventDefault(),this.closeDialog())})}static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-separate-languages-header"]],decls:32,vars:34,consts:[[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"eav-dialog-content"],[1,"language-dropdowns"],[3,"label","tooltip","optionType","options","userLanguageSvc"],["appearance","fill","color","accent",3,"tippy"],[3,"selectionChange","value"],[3,"value"],["align","end"],[3,"action"]],template:function(i,n){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2),e.EFF(3),e.nI1(4,"translate"),e.k0s(),e.j41(5,"button",3),e.bIt("click",function(){return n.closeDialog()}),e.j41(6,"mat-icon"),e.EFF(7,"close"),e.k0s()()(),e.j41(8,"div",4)(9,"p"),e.EFF(10),e.nI1(11,"translate"),e.k0s(),e.j41(12,"h3"),e.EFF(13),e.nI1(14,"translate"),e.k0s(),e.j41(15,"div",5),e.nrm(16,"app-language-dropdown",6)(17,"app-language-dropdown",6),e.k0s(),e.j41(18,"mat-form-field",7),e.nI1(19,"translate"),e.j41(20,"mat-label"),e.EFF(21),e.nI1(22,"translate"),e.k0s(),e.j41(23,"mat-select",8),e.bIt("selectionChange",function(h){return n.onSelectionChange(h)}),e.j41(24,"mat-option",9),e.EFF(25),e.nI1(26,"translate"),e.k0s(),e.j41(27,"mat-option",9),e.EFF(28),e.nI1(29,"translate"),e.k0s()()()(),e.j41(30,"mat-dialog-actions",10)(31,"app-save-close-button-fab",11),e.bIt("action",function(){return n.closeDialog()}),e.k0s()()()),2&i&&(e.R7$(3),e.JRh(e.bMT(4,20,"LanguageSettings.Title")),e.R7$(7),e.JRh(e.bMT(11,22,"LanguageSettings.Intro")),e.R7$(3),e.JRh(e.bMT(14,24,"LanguageSettings.Subtitle")),e.R7$(3),e.Y8G("label","LanguageSettings.LabelsAndTextsOptionLabel")("tooltip","LanguageSettings.LabelsAndTextsTooltip")("optionType",n.LanguagePart.Form)("options",n.options)("userLanguageSvc",n.userLanguageSvc),e.R7$(),e.Y8G("label","LanguageSettings.ButtonsAndControlsOptionLabel")("tooltip","LanguageSettings.ButtonsAndControlsTooltip")("optionType",n.LanguagePart.UI)("options",n.options)("userLanguageSvc",n.userLanguageSvc),e.R7$(),e.Y8G("tippy",e.bMT(19,26,"LanguageSettings.TranslatePrimaryTooltip")),e.R7$(3),e.SpI(" ",e.bMT(22,28,"LanguageSettings.TranslatePrimaryOptionLabel")," "),e.R7$(2),e.Y8G("value",n.selectedValue),e.R7$(),e.Y8G("value",!1),e.R7$(),e.SpI(" ",e.bMT(26,30,"LanguageSettings.DeactivatedOption")," "),e.R7$(2),e.Y8G("value",!0),e.R7$(),e.SpI(" ",e.bMT(29,32,"LanguageSettings.ActivatedOption")," "))},dependencies:[d.hM,d.E7,u.m_,u.An,g.Hl,$.iY,m.e,w.RG,v.rl,v.nJ,p.Ve,p.VO,T.wT,P,c.h,E.i,c.D9],styles:["mat-form-field[_ngcontent-%COMP%]{width:50%}.language-dropdowns[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:100%;gap:1rem;margin-bottom:1rem}"]})}}return o})();class G{constructor(s,t){this.ngZone=s,this.header=t,this.moveThreshold=2,this.stopClick=!1,this.eventListeners=[],this.ngZone.runOutsideAngular(()=>{const i=n=>{this.checkIfMouseMoved(n)};document.addEventListener("mouseup",i,{passive:!0}),this.eventListeners.push({element:document,type:"mouseup",listener:i})})}lngButtonDown(s){this.ngZone.runOutsideAngular(()=>{this.saveInitialPosition(s)})}lngButtonClick(s){this.ngZone.runOutsideAngular(()=>{this.doMove(s)})}stopClickIfMouseMoved(){return this.stopClick}destroy(){this.ngZone.runOutsideAngular(()=>{this.eventListeners.forEach(({element:s,type:t,listener:i})=>{s.removeEventListener(t,i)}),this.eventListeners=null})}saveInitialPosition(s){this.stopClick=!1,this.positionX=s.pageX,this.positionY=s.pageY}checkIfMouseMoved(s){this.positionX&&this.positionY?(this.stopClick=Math.abs(this.positionX+this.positionY-(s.pageX+s.pageY))>this.moveThreshold,this.positionX=null,this.positionY=null):this.stopClick=!1}doMove(s){if(this.stopClick)return;const t=s.target,i=t.getBoundingClientRect().left,n=t.getBoundingClientRect().width,a=this.header.getBoundingClientRect().left,h=this.header.getBoundingClientRect().width;this.header.scrollLeft+=i+n/2-(a+h/2)}}class Y{constructor(s,t,i){this.ngZone=s,this.header=t,this.areButtonsDisabled=i,this.eventListeners=[],this.ngZone.runOutsideAngular(()=>{const n=this.registerScroll.bind(this);this.header.addEventListener("pointerdown",n,{passive:!0}),this.headerDownListener={element:this.header,type:"pointerdown",listener:n}})}destroy(){this.ngZone.runOutsideAngular(()=>{this.headerDownListener.element.removeEventListener(this.headerDownListener.type,this.headerDownListener.listener),this.headerDownListener=null,this.eventListeners.forEach(({element:s,type:t,listener:i})=>{s.removeEventListener(t,i)}),this.eventListeners=null}),this.ngZone=null,this.header=null,this.areButtonsDisabled=null}registerScroll(s){if(this.areButtonsDisabled()||0!==s.button)return;window.getSelection().removeAllRanges(),this.oldScrollBehavior=getComputedStyle(this.header).getPropertyValue("scroll-behavior"),this.header.style.scrollBehavior="auto",this.positionX=s.pageX;const i=a=>{this.doScroll(a)},n=()=>{this.removeScroll()};document.addEventListener("pointermove",i,{passive:!0}),document.addEventListener("pointerup",n,{passive:!0}),document.addEventListener("pointerleave",n,{passive:!0}),this.eventListeners.push({element:document,type:"pointermove",listener:i},{element:document,type:"pointerup",listener:n},{element:document,type:"pointerleave",listener:n})}removeScroll(){this.header.style.scrollBehavior=this.oldScrollBehavior,this.eventListeners.forEach(({element:s,type:t,listener:i})=>{s.removeEventListener(t,i)}),this.eventListeners.splice(0,this.eventListeners.length)}doScroll(s){const t=s.pageX;t<this.positionX?this.header.scrollLeft+=this.positionX-t:t>this.positionX&&(this.header.scrollLeft+=-(t-this.positionX)),this.positionX=t}}class A{constructor(s,t,i,n){this.ngZone=s,this.header=t,this.leftShadow=i,this.rightShadow=n,this.hidden="hidden",this.eventListeners=[],this.ngZone.runOutsideAngular(()=>{this.calculateShadows();const a=()=>{this.calculateShadows()};this.header.addEventListener("scroll",a,{passive:!0}),window.addEventListener("resize",a,{passive:!0}),this.eventListeners.push({element:this.header,type:"scroll",listener:a},{element:window,type:"resize",listener:a})})}destroy(){this.ngZone.runOutsideAngular(()=>{this.eventListeners.forEach(({element:s,type:t,listener:i})=>{s.removeEventListener(t,i)}),this.eventListeners=null}),this.ngZone=null,this.header=null,this.leftShadow=null,this.rightShadow=null}calculateShadows(){this.maxScrollLeft=this.header.scrollWidth-this.header.clientWidth,0===this.maxScrollLeft?this.hideBoth():0===this.header.scrollLeft?this.hideLeft():this.header.scrollLeft===this.maxScrollLeft?this.hideRight():this.showBoth()}hideBoth(){this.leftShadow.classList.add(this.hidden),this.rightShadow.classList.add(this.hidden)}hideLeft(){this.leftShadow.classList.add(this.hidden),this.rightShadow.classList.remove(this.hidden)}hideRight(){this.leftShadow.classList.remove(this.hidden),this.rightShadow.classList.add(this.hidden)}showBoth(){this.leftShadow.classList.remove(this.hidden),this.rightShadow.classList.remove(this.hidden)}}var V=l(3347);const Z=["scrollable"],x=["leftShadow"],U=["rightShadow"];function H(o,s){if(1&o){const t=e.RV6();e.j41(0,"mat-icon",10),e.nI1(1,"translate"),e.bIt("click",function(){r.eBV(t);const n=e.XpG(3);return r.Njj(n.languageSettings())}),e.EFF(2,"settings"),e.k0s()}2&o&&e.Y8G("tippy",e.bMT(1,1,"LanguageSettings.Title"))}function N(o,s){if(1&o&&(e.j41(0,"button",7),e.EFF(1),e.nVh(2,H,3,3,"mat-icon",9),e.k0s()),2&o){const t=e.XpG().$implicit,i=e.XpG();e.Y8G("tippy",t.Culture)("tippyDisabled",i.disabled()),e.R7$(),e.SpI(" ",t.label," "),e.R7$(),e.vxM(i.userLanguageSvc.userConfigurable()?2:-1)}}function z(o,s){if(1&o){const t=e.RV6();e.j41(0,"button",11),e.bIt("mousedown",function(n){r.eBV(t);const a=e.XpG(2);return r.Njj(a.lngButtonMouseDown(n))})("click",function(n){r.eBV(t);const a=e.XpG().$implicit,h=e.XpG();return r.Njj(h.lngButtonClick(n,a))}),e.EFF(1),e.k0s()}if(2&o){const t=e.XpG().$implicit,i=e.XpG();e.Y8G("tippy",t.Culture)("tippyDisabled",i.disabled()),e.R7$(),e.SpI(" ",t.label," ")}}function W(o,s){if(1&o&&e.nVh(0,N,3,4,"button",7)(1,z,2,3,"button",8),2&o){const t=s.$implicit,i=e.XpG();e.vxM(i.current()===t.NameId?0:1)}}let J=(()=>{class o{constructor(t,i,n,a,h,f,S,Q){this.languageService=t,this.languageInstanceService=i,this.ngZone=n,this.formConfig=a,this.snackBar=h,this.translate=f,this.matDialog=S,this.viewContainerRef=Q,this.log=(0,F.Tq)({LanguageSwitcherComponent:o}),this.disabled=(0,R.hFB)(),this.current=(0,D.EW)(()=>this.formConfig.language().current),this.buttons=y(this.languageService.getAll()),this.userLanguageSvc=(0,b.d)(L.L)}ngAfterViewInit(){this.showShadowsHelper=new A(this.ngZone,this.headerRef.nativeElement,this.leftShadowRef.nativeElement,this.rightShadowRef.nativeElement),this.mouseScrollHelper=new Y(this.ngZone,this.headerRef.nativeElement,()=>this.disabled()),this.centerSelectedHelper=new G(this.ngZone,this.headerRef.nativeElement)}ngOnDestroy(){this.centerSelectedHelper?.destroy(),this.mouseScrollHelper?.destroy(),this.showShadowsHelper?.destroy()}lngButtonMouseDown(t){this.centerSelectedHelper.lngButtonDown(t)}lngButtonClick(t,i){const n=this.log.fn("lngButtonClick");if(this.disabled())return this.snackBar.open(this.translate.instant("Message.CantSwitchLanguage"),null,{duration:3e3,verticalPosition:"top"}),n.end("disabled");if(this.centerSelectedHelper.lngButtonClick(t),!this.centerSelectedHelper.stopClickIfMouseMoved()){this.languageInstanceService.setCurrent(this.formConfig.config.formId,i.NameId);const a=this.userLanguageSvc.uiCode(i.NameId);this.translate.use(a)}}languageSettings(){this.matDialog.open(j,{autoFocus:!1,viewContainerRef:this.viewContainerRef,width:"750px",position:{top:"50px"}})}static{this.\u0275fac=function(i){return new(i||o)(e.rXU(C.g),e.rXU(B.A),e.rXU(r.SKi),e.rXU(k.S),e.rXU(V.UG),e.rXU(c.c$),e.rXU(d.bZ),e.rXU(e.c1b))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-language-switcher"]],viewQuery:function(i,n){if(1&i&&e.GBs(Z,5)(x,5)(U,5),2&i){let a;e.mGM(a=e.lsd())&&(n.headerRef=a.first),e.mGM(a=e.lsd())&&(n.leftShadowRef=a.first),e.mGM(a=e.lsd())&&(n.rightShadowRef=a.first)}},inputs:{disabled:[1,"disabled"]},decls:9,vars:1,consts:[["leftShadow",""],["rightShadow",""],["scrollable",""],[1,"scrollable__overlay"],[1,"scrollable__overlay--left-shadow"],[1,"scrollable__overlay--right-shadow"],["tippyTranslate","Message.CantSwitchLanguage",1,"scrollable","lang-switch",3,"tippyDisabled"],["mat-flat-button","","color","accent",1,"lang-switch__button","hover-area",3,"tippy","tippyDisabled"],["mat-flat-button","","color","white",1,"lang-switch__button",3,"tippy","tippyDisabled"],["iconPositionEnd","",1,"hover-only",3,"tippy"],["iconPositionEnd","",1,"hover-only",3,"click","tippy"],["mat-flat-button","","color","white",1,"lang-switch__button",3,"mousedown","click","tippy","tippyDisabled"]],template:function(i,n){1&i&&(e.j41(0,"div",3),e.nrm(1,"div",4,0)(3,"div",5,1),e.j41(5,"div",6,2),e.Z7z(7,W,2,1,null,null,e.fX1),e.k0s()()),2&i&&(e.R7$(5),e.Y8G("tippyDisabled",!n.disabled()),e.R7$(2),e.Dyx(n.buttons))},dependencies:[g.Hl,g.$z,u.An,m.e,c.h,c.D9],styles:['.scrollable__overlay[_ngcontent-%COMP%]{position:relative;height:100%}.scrollable__overlay--left-shadow[_ngcontent-%COMP%], .scrollable__overlay--right-shadow[_ngcontent-%COMP%]{content:"";position:absolute;top:0;display:block;z-index:1;pointer-events:none;height:100%;width:80px;background-image:linear-gradient(90deg,#fff 8px,#fff0)}@media(max-width:600px){.scrollable__overlay--left-shadow[_ngcontent-%COMP%], .scrollable__overlay--right-shadow[_ngcontent-%COMP%]{width:24px}}.scrollable__overlay--right-shadow[_ngcontent-%COMP%]{right:0;background-image:linear-gradient(270deg,#fff 8px,#fff0)}.scrollable[_ngcontent-%COMP%]{overflow:hidden;scroll-behavior:smooth;height:100%;touch-action:none}.lang-switch[_ngcontent-%COMP%]{display:flex}.lang-switch__button[_ngcontent-%COMP%]{height:100%;flex-shrink:0;border-radius:0;margin-left:0!important;color:#0006;border-bottom:none;font-size:12px;line-height:54px;padding:0 6px;background-color:#fff!important}.lang-switch__button.mat-accent[_ngcontent-%COMP%]{color:#85283b;border-bottom:2px solid #85283B;background-color:inherit}.hidden[_ngcontent-%COMP%]{visibility:hidden}.hover-area[_ngcontent-%COMP%]   .hover-only[_ngcontent-%COMP%]{display:none}.hover-area[_ngcontent-%COMP%]:hover   .hover-only[_ngcontent-%COMP%]{display:block}']})}}return o})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/21.00.00/dist/ng-edit/projects_eav-ui_src_app_edit_dialog_header_language-switcher_language-switcher_ts.1e09d9c88fb9cdcd.js.map