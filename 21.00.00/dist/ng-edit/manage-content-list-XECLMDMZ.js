import{a as gt}from"./chunk-HVAYI7O5.js";import{a as rt,b as dt,d as lt,e as ct}from"./chunk-2ZI3YLWR.js";import{a as pt}from"./chunk-VESINTPJ.js";import{a as st}from"./chunk-ORK43FFD.js";import{a as J}from"./chunk-V5UC4TMG.js";import"./chunk-U657U553.js";import"./chunk-QFYVXC4V.js";import{a as I}from"./chunk-L77E4UL2.js";import"./chunk-JNRBLGLU.js";import{a as it,b as nt,c as ot,d as at}from"./chunk-AO43RQAG.js";import{b as mt,c as _t}from"./chunk-SCB2MVKQ.js";import"./chunk-4SMJHLGZ.js";import{a as M}from"./chunk-564RKXG7.js";import"./chunk-HJXR3IL7.js";import"./chunk-R3Y7P2GW.js";import"./chunk-WAPW5AUJ.js";import"./chunk-ENHI5GWA.js";import"./chunk-IGMB27B5.js";import"./chunk-ME7PJXWA.js";import"./chunk-GL2SUH6T.js";import{c as Z}from"./chunk-HCPBPEHV.js";import{f as K,l as Q}from"./chunk-QVLOO535.js";import{c as et}from"./chunk-XREQECMQ.js";import"./chunk-RPJBZPSB.js";import{a as D}from"./chunk-RGKBOUPL.js";import{b as G,c as N,d as q}from"./chunk-EZZQWHAZ.js";import{b as z,c as U}from"./chunk-23CS2WID.js";import{a as k,b as j}from"./chunk-OIHIMR2W.js";import"./chunk-BDMUNOAA.js";import{d as H}from"./chunk-OYQCZWOE.js";import{b as W,g as Y,h as tt}from"./chunk-G33ZJSCE.js";import"./chunk-DX662RXJ.js";import{n as X}from"./chunk-N5GZ74QQ.js";import"./chunk-XASILSQS.js";import{Aa as E,Ab as V,Ac as h,Bb as F,Cb as g,Db as o,Eb as a,Fb as O,Nb as u,Ob as R,Pb as _,Rb as d,Sa as r,Za as S,db as P,ec as s,fc as w,gc as b,hc as A,jb as B,oa as p,pa as m,qc as $,wb as f,yb as v,zc as x}from"./chunk-46QINP2S.js";import"./chunk-BDOJB7O2.js";var ut=(i,c)=>c.Index+"+"+c.Id;function xt(i,c){if(i&1){let t=u();o(0,"span"),s(1),a(),o(2,"button",12),_("click",function(){p(t);let n=d(3);return m(n.editHeader())}),o(3,"mat-icon"),s(4,"edit"),a()()}if(i&2){let t=d(3);r(),w(t.header().Title)}}function ht(i,c){i&1&&(s(0),x(1,"translate")),i&2&&b(" ",h(1,1,"ManageContentList.NoHeader")," ")}function ft(i,c){if(i&1&&(o(0,"p"),s(1),x(2,"translate"),a(),o(3,"p"),f(4,xt,5,1)(5,ht,2,3),a()),i&2){let t=d(2);r(),b(" ",h(2,2,"ManageContentList.Description")," "),r(3),v(t.header().Type?4:5)}}function vt(i,c){if(i&1&&(o(0,"p",6),s(1),x(2,"translate"),a()),i&2){let t,e=d(2);r(),b(" ",h(2,1,"ManageContentList."+(e.reordered()?"ListHasBeenReordered":((t=e.items())==null?null:t.length)<25?"SortItems":"SortLotsOfItems"))," ")}}function bt(i,c){if(i&1){let t=u();o(0,"div",8)(1,"div",13)(2,"mat-icon",14),s(3,"drag_handle"),a(),o(4,"span",15),s(5),a()(),o(6,"div")(7,"button",16),_("click",function(){let n=p(t).$implicit,l=d(2);return m(l.addFromExisting(n.Index))}),o(8,"mat-icon"),s(9,"playlist_add"),a()(),o(10,"button",17),_("click",function(){let n=p(t).$implicit,l=d(2);return m(l.addBelow(n.Index))}),o(11,"mat-icon"),s(12,"add"),a()(),o(13,"button",18),_("click",function(){let n=p(t).$implicit,l=d(2);return m(l.remove(n))}),o(14,"mat-icon"),s(15,"remove"),a()(),o(16,"button",19),_("click",function(){let n=p(t).$implicit,l=d(2);return m(l.editItem(n.Id))}),o(17,"mat-icon"),s(18,"edit"),a()()()()}if(i&2){let t=c.$implicit,e=d(2);r(4),g("tippy",$("",t.Title," (",t.Id,")")),r(),A(" ",t.Title," (",t.Id,") "),r(2),g("disabled",t.Id===0),r(3),g("disabled",t.Id===0||e.reordered()),r(3),g("disabled",e.reordered()),r(3),g("disabled",t.Id===0)}}function Mt(i,c){if(i&1){let t=u();o(0,"app-save-close-button",20),_("action",function(){p(t);let n=d(2);return m(n.saveAndCloseList())}),a()}i&2&&g("label","Form.Buttons.SaveAndClose")}function St(i,c){if(i&1){let t=u();o(0,"button",21),_("click",function(){p(t);let n=d(2);return m(n.saveList())}),o(1,"span"),s(2),x(3,"translate"),a(),o(4,"mat-icon"),s(5,"save"),a()()}i&2&&(r(2),w(h(3,1,"Form.Buttons.Save")))}function kt(i,c){if(i&1){let t=u();o(0,"div",0)(1,"div",1)(2,"div",2),s(3),x(4,"translate"),a(),o(5,"button",3),_("click",function(){p(t);let n=d();return m(n.closeDialog())}),o(6,"mat-icon"),s(7,"close"),a()()(),o(8,"div",4),O(9,"router-outlet"),o(10,"div",5),f(11,ft,6,4),f(12,vt,3,3,"p",6),o(13,"div",7),_("cdkDropListDropped",function(n){p(t);let l=d();return m(l.drop(n))}),V(14,bt,19,9,"div",8,ut),a()()(),o(16,"mat-dialog-actions",9)(17,"extended-fab-speed-dial"),B(18,Mt,1,1,"ng-template",10)(19,St,6,3,"ng-template",11),a()()()}if(i&2){let t=d();r(3),b(" ",h(4,3,"ManageContentList.Title")," "),r(8),v(t.header()?11:-1),r(),v(t.items()?12:-1),r(2),F(t.items())}}var re=(()=>{class i{#e;#i;#a;constructor(t,e,n){this.dialog=t,this.snackBar=e,this.translate=n,this.hostClass="dialog-component",this.#e=k(st),this.#i=k(gt),this.#a=k(J),this.items=D("items",null),this.#t=j(this.#e.getParams(["guid","part","index"]),l=>({id:null,guid:l.guid,part:l.part,index:parseInt(l.index,10)})),this.#n=E(0),this.header=this.#i.getAllLive(this.#t,this.#n).value,this.reordered=D("reordered",!1)}#t;#n;ngOnInit(){this.#d(),this.#o(),this.#s(),this.#e.doOnDialogClosed(()=>{this.#o(!0),this.#r()})}#s(){this.#a.getCurrent$().subscribe(t=>{this.translate.setDefaultLang(t.Context.Language.Primary.split("-")[0]),this.translate.use(t.Context.Language.Current.split("-")[0])})}closeDialog(){this.dialog.close()}saveList(){this.snackBar.open("Saving..."),this.#i.saveList(this.#t,this.items()).subscribe(()=>{this.snackBar.open("Saved",null,{duration:2e3}),this.#o(),this.#r()})}saveAndCloseList(){this.snackBar.open("Saving..."),this.#i.saveList(this.#t,this.items()).subscribe(()=>{this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()})}#d(){this.dialog.keydownEvents().subscribe(t=>{mt(t)&&(t.preventDefault(),this.saveList()),_t(t)&&(t.preventDefault(),this.saveAndCloseList())})}editHeader(){let t={items:[M.relationship(this.#t.guid,"listcontent",0,this.header().Id===0),M.relationship(this.#t.guid,"listpresentation",0,this.header().Id===0)]},e=I(t);this.#e.navRelative([`edit/${e}`])}editItem(t){let e={items:[M.editId(t)]},n=I(e);this.#e.navRelative([`edit/${n}`])}addFromExisting(t){let e={add:!0};this.#e.navRelative([`${this.#t.guid}/${this.#t.part}/${t+1}/replace`],{queryParams:e})}addBelow(t){let e={items:[M.relationship(this.#t.guid,this.#t.part,t+1,!0)]},n=I(e);this.#e.navRelative([`edit/${n}`])}remove(t){confirm(this.translate.instant("ManageContentList.ConfirmRemove"))&&(this.snackBar.open("Removing..."),this.#i.removeItem(this.#t,t.Index).subscribe(()=>{this.snackBar.open("Removed",null,{duration:2e3}),this.#o()}))}drop(t){let e=[...this.items()];dt(e,t.previousIndex,t.currentIndex),this.items.set(e),this.reordered.set(!0)}#o(t=!1){this.#i.getListPromise(this.#t).then(e=>{if(this.reordered()){let n=this.items().map(C=>C.Id);if(!(this.items().length!==e.length||e.some(C=>!n.includes(C.Id)))&&t){let C=this.items().map(L=>L.Index);e.sort((L,Ct)=>{let T=C.indexOf(L.Index),y=C.indexOf(Ct.Index);return T===-1||y===-1?0:T-y})}else t&&this.snackBar.open("List was changed from somewhere else. Order of items is reset",null,{duration:5e3})}this.items.set(e),this.reordered.set(!1)})}#r(){this.#n.set(this.#n()+1)}static{this.\u0275fac=function(e){return new(e||i)(S(W),S(Z),S(G))}}static{this.\u0275cmp=P({type:i,selectors:[["app-manage-content-list"]],hostVars:1,hostBindings:function(e,n){e&2&&R("className",n.hostClass)},decls:1,vars:1,consts:[[1,"eav-dialog","eav-no-scrollbar"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"eav-dialog-content"],["cdkScrollable","",1,"dialog-component-content","fancy-scrollbar-light"],[1,"eav-sort-title"],["cdkDropList","",1,"eav-dnd-list",3,"cdkDropListDropped"],["cdkDrag","",1,"eav-dnd-item"],["align","end"],["extendedFabSpeedDialTriggerContent",""],["extendedFabSpeedDialActionsContent",""],["mat-icon-button","","tippy","Edit header",3,"click"],[1,"eav-dnd-item__title"],["tippy","Drag to reorder the list",1,"eav-dnd-item__title-icon"],[1,"eav-dnd-item__title-text",3,"tippy"],["mat-icon-button","","tippyTranslate","Fields.Picker.AddExistingItem","appMousedownStopPropagation","",3,"click","disabled"],["mat-icon-button","","tippyTranslate","Fields.Picker.AddItemBelow","appMousedownStopPropagation","",3,"click","disabled"],["mat-icon-button","","tippyTranslate","Fields.Picker.Remove","appMousedownStopPropagation","",3,"click","disabled"],["mat-icon-button","","tippyTranslate","Fields.Picker.Edit","appMousedownStopPropagation","",3,"click","disabled"],[3,"action","label"],["extended-fab-speed-dial-action","","matRipple","",3,"click"]],template:function(e,n){e&1&&f(0,kt,20,5,"div",0),e&2&&v(n.items()?0:-1)},dependencies:[H,X,Q,K,U,z,ct,lt,Y,q,tt,et,pt,at,it,ot,nt,rt,N],styles:[`.eav-sort-title[_ngcontent-%COMP%]{padding-top:16px}.eav-dnd-list[_ngcontent-%COMP%]{margin:16px 0;border:1px solid #ccc;border-radius:4px;overflow:hidden}.eav-dnd-item[_ngcontent-%COMP%]{cursor:move;height:40px;border-bottom:1px solid #ccc;padding:0 8px;display:flex;align-items:center;justify-content:space-between;background:#fff;box-sizing:border-box;font-size:14px}.eav-dnd-item[_ngcontent-%COMP%]:last-child{border:none}.eav-dnd-item__title[_ngcontent-%COMP%]{display:flex;align-items:center;overflow:hidden;max-width:80%}.eav-dnd-item__title-icon[_ngcontent-%COMP%]{margin-right:8px;opacity:.4}.eav-dnd-item__title-text[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}extended-fab-speed-dial[_ngcontent-%COMP%]  .extended-fab-speed-dial-actions{right:24px;bottom:54px}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.dnd-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .dnd-item[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}
/*# sourceMappingURL=manage-content-list-QHAOXHBZ.css.map */`]})}}return i})();export{re as ManageContentListComponent};
//# sourceMappingURL=https://sources.2sxc.org/21.00.00/dist/ng-edit/manage-content-list-XECLMDMZ.js.map
