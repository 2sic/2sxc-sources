import{a as Mt}from"./chunk-J5KNE364.js";import{a as _t}from"./chunk-ORK43FFD.js";import{a as ut}from"./chunk-L77E4UL2.js";import"./chunk-4YE3E6NH.js";import"./chunk-ZBQC6E3M.js";import"./chunk-AO43RQAG.js";import"./chunk-SCB2MVKQ.js";import"./chunk-4SMJHLGZ.js";import{a as gt,b as ht,c as vt,e as xt,f as yt,h as Et}from"./chunk-MQM7DF2M.js";import{c as Ct}from"./chunk-JEQANFI7.js";import{a as j}from"./chunk-564RKXG7.js";import"./chunk-HJXR3IL7.js";import"./chunk-R3Y7P2GW.js";import"./chunk-LPOE4446.js";import"./chunk-ENHI5GWA.js";import{a as bt,b as wt,c as St}from"./chunk-DAEXUMJT.js";import"./chunk-IGMB27B5.js";import{e as ft}from"./chunk-ME7PJXWA.js";import"./chunk-GL2SUH6T.js";import"./chunk-3M22BTAM.js";import{c as ct}from"./chunk-HCPBPEHV.js";import{f as st,h as pt,l as dt}from"./chunk-QVLOO535.js";import"./chunk-XREQECMQ.js";import"./chunk-RPJBZPSB.js";import"./chunk-UMOPET3G.js";import{b as at,d as rt,i as lt}from"./chunk-4LV77BQU.js";import"./chunk-EZZQWHAZ.js";import{b as it,c as nt}from"./chunk-23CS2WID.js";import{a as f}from"./chunk-OIHIMR2W.js";import"./chunk-BDMUNOAA.js";import{c as tt,d as et}from"./chunk-OYQCZWOE.js";import{d as mt}from"./chunk-G33ZJSCE.js";import{aa as ot,ca as B}from"./chunk-DX662RXJ.js";import"./chunk-N5GZ74QQ.js";import"./chunk-XASILSQS.js";import{$a as Q,Aa as J,Ab as T,Ac as M,Bb as D,Cb as u,Db as n,Eb as o,Fb as d,Lc as W,M as F,Nb as b,Oa as q,Pb as w,Rb as c,Sa as l,V as O,Za as z,bc as X,db as G,ea as N,ec as r,fc as y,gc as h,hc as K,ia as P,id as Y,ja as U,lc as I,mc as k,nc as R,nd as Z,oa as v,p as L,pa as x,u as m,wb as _,xd as V,yb as g,zb as $,zc as S}from"./chunk-46QINP2S.js";import{a as E,b as A}from"./chunk-BDOJB7O2.js";var Tt,H=(()=>{class i{static{this.webApiEditions="admin/code/getEditions"}static{this.webApiGeneratedCode="admin/code/generateDataModels"}constructor(t,e){this.http=t,this.context=e,this.log=ot({CopilotService:i}),this.specs=this.#t()}getEditions(){return this.specs.pipe(m(t=>t.editions))}getDefaultEdition(){return this.specs.pipe(m(t=>t.editions.find(e=>e.isDefault)))}getGenerators(){return this.specs.pipe(m(t=>t.generators))}#t(){return this.http.get(Tt.webApiEditions,{params:{appId:this.context.appId.toString()}}).pipe(m(t=>{let e=this.#e(t.editions),a=t.editions.map(s=>{let C=s==e;return A(E({},s),{isDefault:C,description:(s.description||"no description provided")+(C?" \u2705":""),label:`/${s.name}/AppCode/Data`.replace(/\/\//g,"/")})});return A(E({},t),{editions:a})}),O(1))}#e(t){return t.find(e=>e.isDefault)??t.find(e=>e.name==="")??t[0]}static{this.\u0275fac=function(e){return new(e||i)(P(V),P(B))}}static{this.\u0275prov=N({token:i,factory:i.\u0275fac})}}return i})();Tt=H;var It=(i,p)=>p.Id;function kt(i,p){if(i&1&&(n(0,"mat-option",9)(1,"strong"),r(2),o(),d(3,"br"),r(4),o()),i&2){let t=p.$implicit;u("value",t.name),l(2),K("",t.name," v",t.version),l(2),h(" ",t.description," ")}}function Rt(i,p){i&1&&d(0,"mat-hint",10),i&2&&u("innerHTML",p.descriptionHtml,q)}function Vt(i,p){if(i&1){let t=b();n(0,"mat-form-field",3)(1,"mat-label"),r(2,"Generator"),o(),n(3,"mat-select",8),R("valueChange",function(a){v(t);let s=c();return k(s.selectedGenerator,a)||(s.selectedGenerator=a),x(a)}),n(4,"mat-select-trigger"),r(5),o(),T(6,kt,5,4,"mat-option",9,$),o(),_(8,Rt,1,1,"mat-hint",10),S(9,"async"),o(),d(10,"br")}if(i&2){let t,e=c();l(3),I("value",e.selectedGenerator),l(2),h(" ",e.selectedGenerator," "),l(),D(p.sort()),l(2),g((t=M(9,3,e.selectedGenerator$))?8:-1,t)}}function Bt(i,p){if(i&1&&(n(0,"mat-option",9)(1,"strong"),r(2),o(),r(3),o()),i&2){let t=p.$implicit;u("value",t.name),l(2),y(t.label),l(),h(" (",t.description,") ")}}function At(i,p){if(i&1){let t=b();n(0,"mat-form-field",3)(1,"mat-label"),r(2,"Select an Edition to generate code for"),o(),n(3,"mat-select",8),R("valueChange",function(a){v(t);let s=c();return k(s.selectedEdition,a)||(s.selectedEdition=a),x(a)}),T(4,Bt,4,3,"mat-option",9,$),o(),n(6,"mat-hint"),r(7," Editions are managed in the "),n(8,"code"),r(9,"/App_Data/app.json"),o(),r(10," file. See "),n(11,"a",11),r(12,"docs"),o(),r(13,". "),o()()}if(i&2){let t=c();l(3),I("value",t.selectedEdition),l(),D(p.sort())}}function Ft(i,p){if(i&1&&(n(0,"mat-option",9),r(1),o()),i&2){let t=p.$implicit;u("value",t),l(),h(" ",t.Title," ")}}function Pt(i,p){i&1&&T(0,Ft,2,2,"mat-option",9,It),i&2&&D(p)}function $t(i,p){if(i&1){let t=b();n(0,"button",16),w("click",function(){v(t);let a=c(2);return x(a.deleteConfiguration())}),n(1,"mat-icon"),r(2,"delete"),o()()}}function Wt(i,p){if(i&1){let t=b();d(0,"br"),n(1,"div",12)(2,"mat-form-field",3)(3,"mat-label"),r(4,"Select a Configuration"),o(),n(5,"mat-select",13),R("valueChange",function(a){v(t);let s=c();return k(s.selectedEntity,a)||(s.selectedEntity=a),x(a)}),n(6,"mat-option",9),r(7," Empty (press + to create new) "),o(),_(8,Pt,2,0),S(9,"async"),o(),n(10,"mat-hint"),r(11," Reusable configuration for the Data Copilot generator. "),o()(),n(12,"button",14),w("click",function(){v(t);let a=c();return x(a.editConfig())}),n(13,"mat-icon"),r(14),o()(),_(15,$t,3,0,"button",15),o()}if(i&2){let t,e=c();l(5),I("value",e.selectedEntity),l(),u("value",void 0),l(2),g((t=M(9,5,e.entities$))?8:-1,t),l(6),y(e.selectedEntity?"edit":"add"),l(),g(e.selectedEntity?15:-1)}}var Dt=(()=>{class i{constructor(){this.outputType=W(),this.title=W("Copilot Generator"),this.#t=f(H),this.#e=f(Ct),this.#o=f(_t),this.#r=f(mt),this.#i=f(ct),this.#a=f(B),this.#l=f(V),this.#s=U(Q),this.#n="b08dcd23-2eb0-4a5e-a3d0-3178d2aae451",this.webApiGeneratedCode="admin/code/generateDataModels",this.editions$=this.#t.getEditions(),this.showConfigurationDropdown=J(!1),this.generators$=this.#t.getGenerators().pipe(m(t=>t.filter(e=>e.outputType===this.outputType()))),this.selectedGenerator$=this.generators$.pipe(m(t=>t.find(e=>e.name===this.selectedGenerator))),this.selectedGenerator="",this.selectedEdition=""}#t;#e;#o;#r;#i;#a;#l;#s;#n;ngOnInit(){this.generators$.pipe(F(1)).subscribe(t=>{this.selectedGenerator=t[0]?.name??""}),this.#t.specs.pipe(F(1)).subscribe(t=>{this.selectedEdition=t.editions.find(e=>e.isDefault)?.name??""}),this.fetchEntities(),this.#o.doOnDialogClosed(()=>this.fetchEntities())}fetchEntities(){this.entities$=this.#e.getEntities$(L({contentTypeName:this.#n}))}editConfig(){let t={items:[this.selectedEntity?j.editId(this.selectedEntity.Id):j.newFromType(this.#n)]},e=ut(t);this.#o.navRelative([`edit/${e}`])}deleteConfiguration(){let t=this.selectedEntity,e={entityId:t.Id,entityTitle:t.Title,message:"Are you sure you want to delete?  ",hasDeleteSnackbar:!0};this.#r.open(Mt,{autoFocus:!1,data:e,viewContainerRef:this.#s,width:"400px"}).afterClosed().subscribe(s=>{s&&this.#e.delete(this.#a.appId,this.#n,t.Id,!1).subscribe({next:()=>{this.#i.open("Deleted",null,{duration:2e3}),this.fetchEntities()},error:C=>{console.error("Error deleting configuration:",C),this.#i.open("Error deleting configuration",null,{duration:3e3})}})})}toggleConfigurationDropdown(){this.showConfigurationDropdown.set(!this.showConfigurationDropdown())}autoGeneratedCode(){this.#l.get(this.webApiGeneratedCode,{params:E({appId:this.#a.appId,edition:this.selectedEdition,generator:this.selectedGenerator},this.selectedEntity?{configurationId:this.selectedEntity.Id}:{})}).subscribe(t=>{this.#i.open(t.message+`
 (this took ${t.timeTaken}ms)`,null,{duration:5e3})})}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275cmp=G({type:i,selectors:[["app-copilot-generator"]],inputs:{outputType:[1,"outputType"],title:[1,"title"]},decls:28,vars:10,consts:[[1,"eav-cards-box"],[1,"eav-card"],[1,"eav-card-header"],["color","accent",1,"eav-mat-form-field"],[1,"eav-card-space-div"],["align","end"],["mat-button","",1,"eav-button__with-icon",3,"click"],[1,"eav-icon"],["required","",3,"valueChange","value"],[3,"value"],[3,"innerHTML"],["href","https://go.2sxc.org/app-json","target","_blank"],[1,"configuration-select"],[3,"valueChange","value"],["mat-icon-button","","aria-label","Create",1,"eav-icon",3,"click"],["mat-icon-button","","aria-label","Delete",1,"eav-icon"],["mat-icon-button","","aria-label","Delete",1,"eav-icon",3,"click"]],template:function(e,a){if(e&1&&(n(0,"div",0)(1,"mat-card",1)(2,"mat-card-header",2)(3,"mat-card-title"),r(4),o(),n(5,"mat-icon"),r(6,"support_agent"),o()(),n(7,"mat-card-content"),d(8,"br"),_(9,Vt,11,5),S(10,"async"),d(11,"br"),_(12,At,14,1,"mat-form-field",3),S(13,"async"),d(14,"br"),_(15,Wt,16,7),o(),d(16,"div",4),n(17,"mat-card-actions",5)(18,"button",6),w("click",function(){return a.toggleConfigurationDropdown()}),n(19,"mat-icon",7),r(20,"discover_tune"),o(),n(21,"span"),r(22,"Use Configuration"),o()(),n(23,"button",6),w("click",function(){return a.autoGeneratedCode()}),n(24,"mat-icon",7),r(25,"code"),o(),n(26,"span"),r(27,"Generate Code"),o()()()()()),e&2){let s,C;X("eav-cards-box-expanded",a.showConfigurationDropdown()),l(4),y(a.title()),l(5),g((s=M(10,6,a.generators$))?9:-1,s),l(3),g((C=M(13,8,a.editions$))?12:-1,C),l(3),g(a.showConfigurationDropdown()?15:-1)}},dependencies:[St,lt,at,rt,bt,wt,ft,dt,pt,st,Et,gt,xt,vt,yt,ht,nt,it,Z,Y],styles:[`mat-card-actions[_ngcontent-%COMP%]{display:flex;width:100%;justify-content:space-between}.eav-cards-box-expanded[_ngcontent-%COMP%]{min-height:200px;transition:min-height .2s}.configuration-select[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}
/*# sourceMappingURL=copilot-generator-X3JAMQG3.css.map */`]})}}return i})();var Se=(()=>{class i{constructor(t){this.data=t.snapshot.data}static{this.\u0275fac=function(e){return new(e||i)(z(tt))}}static{this.\u0275cmp=G({type:i,selectors:[["app-data-copilot"]],decls:7,vars:4,consts:[[1,"outer-container"],[3,"outputType","title"]],template:function(e,a){e&1&&(n(0,"div",0)(1,"h1"),r(2),o(),n(3,"p"),r(4),o()(),d(5,"app-copilot-generator",1)(6,"router-outlet")),e&2&&(l(2),y(a.data.heading),l(2),h(" ",a.data.intro," "),l(),u("outputType",a.data.outputType)("title",a.data.title))},dependencies:[Dt,et],styles:[`.outer-container[_ngcontent-%COMP%]{padding:10px 20px}
/*# sourceMappingURL=copilot-page-3J5WI743.css.map */`]})}}return i})();export{Se as CopilotPageComponent};
//# sourceMappingURL=https://sources.2sxc.org/21.00.00/dist/ng-edit/copilot-page-YQJZSGU7.js.map
