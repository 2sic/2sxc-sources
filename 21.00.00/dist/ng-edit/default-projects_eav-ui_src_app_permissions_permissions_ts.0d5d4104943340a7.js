"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["default-projects_eav-ui_src_app_permissions_permissions_ts"],{25286(y,v,t){t.d(v,{F:()=>d});var E=t(56884),u=t(84175),p=t(87941),l=t(93840),f=t(3347),m=t(32760),P=t(63628),e=t(69914),a=t(36124),r=t(55326);function s(g,M){if(1&g&&(a.nrm(0,"p",5),a.nI1(1,"safeHtml")),2&g){const i=a.XpG();a.Y8G("innerHtml",a.bMT(1,1,i.dialogData.message),a.npT)}}let d=(()=>{class g{#e;constructor(i,D){this.dialogData=i,this.dialog=D,this.hostClass="dialog-component",this.#e=(0,E.WQX)(f.UG)}ngOnInit(){this.dialogData.hasDeleteSnackbar&&this.#e.open("Deleting...",void 0,{duration:5e3}),this.#a()}#a(){this.dialog.keydownEvents().subscribe(i=>{(0,m.YU)(i)&&(i.preventDefault(),this.dialog.close(!0))})}closeDialog(i){this.#e.dismiss(),i?this.dialog.close(i):this.dialog.close()}saveAndClose(i){this.closeDialog(i),this.dialogData.hasDeleteSnackbar&&this.#e.dismiss()}static{this.\u0275fac=function(D){return new(D||g)(a.rXU(p.Vh),a.rXU(p.CP))}}static{this.\u0275cmp=a.VBU({type:g,selectors:[["app-confirm-delete-dialog"]],hostVars:1,hostBindings:function(D,o){2&D&&a.Avn("className",o.hostClass)},decls:11,vars:5,consts:[[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"eav-dialog-content"],[3,"innerHtml"],["align","end"],[3,"action","label"]],template:function(D,o){1&D&&(a.j41(0,"div",0)(1,"div",1)(2,"div",2),a.EFF(3),a.k0s(),a.j41(4,"button",3),a.bIt("click",function(){return o.closeDialog()}),a.j41(5,"mat-icon"),a.EFF(6,"close"),a.k0s()()(),a.j41(7,"div",4),a.nVh(8,s,2,3,"p",5),a.k0s(),a.j41(9,"mat-dialog-actions",6)(10,"app-save-close-button-fab",7),a.bIt("action",function(){return o.saveAndClose(!0)}),a.k0s()()()),2&D&&(a.R7$(3),a.E5c(" ",o.dialogData.title??"Delete"," ",o.dialogData.entityTitle," (",o.dialogData.entityId,") "),a.R7$(5),a.vxM(o.dialogData.message?8:-1),a.R7$(2),a.Y8G("label","Delete and close (ctrl + enter)"))},dependencies:[u.Hl,r.iY,l.m_,l.An,p.E7,P.i,e.$],styles:[".eav-card-action-button[_ngcontent-%COMP%]{margin-left:8px}"]})}}return g})()},40448(y,v,t){t.r(v),t.d(v,{PermissionsComponent:()=>F});var E=t(56884),u=t(84175),p=t(87941),l=t(93840),f=t(69393),m=t(12938),P=t(13620),e=t(25286),a=t(11828),r=t(60251),s=t(50052),d=t(91922),g=t(70334),M=t(67037),i=t(60852),D=t(85309),o=t(34601),n=t(36124),O=t(17828);let R=(()=>{class C{agInit(c){this.params=c}refresh(c){return!0}deletePermission(){this.params.onDelete(this.params.data)}static{this.\u0275fac=function(_){return new(_||C)}}static{this.\u0275cmp=n.VBU({type:C,selectors:[["app-permissions-actions"]],decls:4,vars:0,consts:[[1,"actions-component"],["matRipple","","tippy","Delete",1,"eav-grid-action-button","highlight",3,"click"]],template:function(_,h){1&_&&(n.j41(0,"div",0)(1,"div",1),n.bIt("click",function(){return h.deletePermission()}),n.j41(2,"mat-icon"),n.EFF(3,"delete"),n.k0s()()())},dependencies:[D.p,O.r6,l.m_,l.An,o.e],encapsulation:2})}}return C})();var A=t(44900),B=t(3347),U=t(55326),W=t(58857);let F=(()=>{class C{#e;#a;#t;#n;#s;constructor(c,_,h,T){this.dialog=c,this.snackBar=_,this.viewContainerRef=h,this.matDialog=T,this.gridOptions=this.buildGridOptions(),this.#e=(0,m.d)(A.K),this.#a=(0,m.d)(i.c),this.#t=(0,P.C)(this.#a.getParams(["targetType","keyType","key"]),I=>({targetType:parseInt(I.targetType,10),keyType:I.keyType,key:I.key})),this.#n=(0,E.vPA)(0),this.permissions=this.#e.getAllLive(this.#t.targetType,this.#t.keyType,this.#t.key,this.#n),this.#s={[s.YX.metadata.language.targetType]:{PermissionType:"language"}}}ngOnInit(){this.#a.doOnDialogClosed(()=>this.#n.update(c=>c+1))}closeDialog(){this.dialog.close()}editPermission(c){let _;_=null==c?{items:[{...g.c.newMetadataFromInfo(s.YX.contentTypes.permissions,g.c.constructMetadataInfo(this.#t.targetType,this.#t.keyType,this.#t.key)),...this.#s[this.#t.targetType]&&{Prefill:this.#s[this.#t.targetType]}}]}:{items:[g.c.editId(c.Id)]};const h=(0,d.s)(_);this.#a.navRelative([`edit/${h}`])}#i(c){this.matDialog.open(e.F,{autoFocus:!1,data:{entityId:c.Id,entityTitle:c.Title,message:"Delete this permission?",hasDeleteSnackbar:!0},viewContainerRef:this.viewContainerRef,width:"400px"}).afterClosed().subscribe(T=>{T&&this.#e.delete(c.Id).subscribe(()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.#n.update(I=>I+1)})})}buildGridOptions(){return{...r.C,columnDefs:[{...a.r.Id,cellRendererParams:a.r.idFieldParamsTooltipGetter()},{...a.r.TextWide,headerName:"Name",field:"Title",sort:"asc",onCellClicked:_=>{this.editPermission(_.data)}},{...a.r.TextWide,field:"Identity"},{...a.r.TextWide,field:"Condition"},{...a.r.Character,field:"Grant"},{...a.r.ActionsPinnedRight1,cellRenderer:R,cellRendererParams:{onDelete:h=>this.#i(h)}}]}}static{this.\u0275fac=function(_){return new(_||C)(n.rXU(p.CP),n.rXU(B.UG),n.rXU(n.c1b),n.rXU(p.bZ))}}static{this.\u0275cmp=n.VBU({type:C,selectors:[["app-permissions"]],decls:15,vars:2,consts:[[1,"eav-dialog","nav-component-wrapper"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"eav-dialog-content","nav-component-wrapper"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","gridOptions"],["align","end"],["mat-fab","","mat-elevation-z24","","tippy","Create a new permission",1,"grid-fab",3,"click"]],template:function(_,h){1&_&&(n.j41(0,"div",0)(1,"div",1)(2,"div",2),n.EFF(3,"Permissions"),n.k0s(),n.j41(4,"button",3),n.bIt("click",function(){return h.closeDialog()}),n.j41(5,"mat-icon"),n.EFF(6,"close"),n.k0s()()(),n.j41(7,"div",4),n.nrm(8,"router-outlet"),n.j41(9,"div",5),n.nrm(10,"ag-grid-angular",6),n.k0s(),n.j41(11,"mat-dialog-actions",7)(12,"button",8),n.bIt("click",function(){return h.editPermission(null)}),n.j41(13,"mat-icon"),n.EFF(14,"add"),n.k0s()()()()()),2&_&&(n.R7$(10),n.Y8G("rowData",h.permissions())("gridOptions",h.gridOptions))},dependencies:[u.Hl,U.iY,u.Sr,l.m_,l.An,f.n3,p.E7,M.p,W.xs],encapsulation:2})}}return C})()},44900(y,v,t){t.d(v,{K:()=>e});var E=t(36664),u=t(70271),p=t(12938),l=t(50052),f=t(96817),m=t(80401),P=t(56884);let e=(()=>{class a{constructor(){this.metadataService=(0,p.d)(m.T),this.entitiesService=(0,p.d)(f.R)}getAll(s,d,g){return this.metadataService.getMetadata(s,d,g,l.YX.contentTypes.permissions).pipe((0,u.T)(M=>M.Items))}getAllLive(s,d,g,M){const i=this.metadataService.getMetadataLive(M,s,d,g,l.YX.contentTypes.permissions).value;return(0,E.EW)(()=>i()?.Items??[])}delete(s){return this.entitiesService.delete(l.YX.contentTypes.permissions,s,!1)}static{this.\u0275fac=function(d){return new(d||a)}}static{this.\u0275prov=P.jDH({token:a,factory:a.\u0275fac})}}return a})()},63628(y,v,t){t.d(v,{i:()=>M});var E=t(79748),u=t(85309),p=t(93840),l=t(90852),f=t(34601),m=t(18759),P=t(56884),e=t(36124),a=t(82272),r=t(74390),s=t(18934),d=t(17828);function g(i,D){if(1&i){const o=e.RV6();e.j41(0,"button",1),e.nI1(1,"translate"),e.nI1(2,"translate"),e.bIt("click",function(O){P.eBV(o);const R=e.XpG();return P.Njj(R.onClick(O))}),e.j41(3,"span"),e.EFF(4),e.nI1(5,"translate"),e.k0s(),e.j41(6,"span",2)(7,"kbd"),e.EFF(8,"\u2303"),e.k0s(),e.j41(9,"kbd"),e.EFF(10,"\u23ce"),e.k0s()(),e.j41(11,"mat-icon"),e.EFF(12),e.k0s()()}if(2&i){const o=e.XpG();e.Y8G("type",o.triggerOnFormSubmit()?"submit":"button")("tippy",e.bMT(1,6,o.label())+" ("+e.bMT(2,8,"Form.Buttons.ActionAndCloseShortcut")+")")("ngClass",o.ngClass())("disabled",o.isDisabled),e.R7$(4),e.JRh(e.bMT(5,10,o.label())),e.R7$(8),e.JRh(o.icon())}}let M=(()=>{class i extends m.d{static{this.\u0275fac=(()=>{let o;return function(O){return(o||(o=e.xGo(i)))(O||i)}})()}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-save-close-button-fab"]],features:[e.Vt3],decls:2,vars:0,consts:[["extendedFabSpeedDialTriggerContent",""],["tippyShowDelay","500","extended-fab-speed-dial-trigger","","matRipple","",3,"click","type","tippy","ngClass","disabled"],[1,"keybinding-hint"]],template:function(n,O){1&n&&(e.j41(0,"extended-fab-speed-dial"),e.DNE(1,g,13,12,"ng-template",0),e.k0s())},dependencies:[E.YU,p.m_,p.An,a.d,r.t,s.Q,u.p,d.r6,l.h,f.e,l.D9],styles:[".disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:.5}.keybinding-hint[_ngcontent-%COMP%]{display:inline-flex;align-items:center;font-size:.75rem;line-height:1.5}.keybinding-hint[_ngcontent-%COMP%]   kbd[_ngcontent-%COMP%] + kbd[_ngcontent-%COMP%]{margin-left:3px}"]})}}return i})()},80401(y,v,t){t.d(v,{T:()=>f});var E=t(96474),u=t(56884),p=t(36124);const l="admin/metadata/get";let f=(()=>{class m extends E.D{getMetadata(e,a,r,s){return this.getHttpApiUrl(l,{params:{appId:this.appId,targetType:e.toString(),keyType:a,key:r.toString(),...s&&{contentType:s}}})}getMetadataLive(e,a,r,s,d){return this.newHttpResource(()=>(e(),{url:this.apiUrl(l),params:{appId:this.appId,targetType:a.toString(),keyType:r,key:s.toString(),...d&&{contentType:d}}}))}getMetadataPromise(e,a,r,s){return this.fetchPromise(l,{params:{appId:this.appId,targetType:e.toString(),keyType:a,key:r.toString(),...s&&{contentType:s}}})}static{this.\u0275fac=(()=>{let e;return function(r){return(e||(e=p.xGo(m)))(r||m)}})()}static{this.\u0275prov=u.jDH({token:m,factory:m.\u0275fac})}}return m})()},96817(y,v,t){t.d(v,{R:()=>P});var E=t(50698),u=t(85837),p=t(9234),l=t(24467),f=t(56884),m=t(36124);let P=(()=>{class e extends l.B{create(r,s){return this.http.post(`app/auto/data/${r}`,s,{params:{appId:this.appId,zoneId:this.zoneId}})}update(r,s,d){return this.http.post(`app/auto/data/${r}/${s}`,d,{params:{appId:this.appId,zoneId:this.zoneId}})}delete(r,s,d){return this.http.delete(this.apiUrl(p.gb+"delete"),{params:{contentType:r,id:s.toString(),appId:this.appId,force:d.toString()},context:(new E._y).set(u.g,[400])})}static{this.\u0275fac=(()=>{let r;return function(d){return(r||(r=m.xGo(e)))(d||e)}})()}static{this.\u0275prov=f.jDH({token:e,factory:e.\u0275fac})}}return e})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/21.00.00/dist/ng-edit/default-projects_eav-ui_src_app_permissions_permissions_ts.0d5d4104943340a7.js.map