{
  "version": 3,
  "sources": ["projects/eav-ui/src/app/apps-management/services/features-config.service.ts"],
  "sourcesContent": ["import { httpResource } from '@angular/common/http';\r\nimport { Injectable, Signal } from '@angular/core';\r\nimport { map, Observable } from 'rxjs';\r\nimport { FeatureState } from '../../features/models';\r\nimport { FileUploadMessageTypes, FileUploadResult } from '../../shared/components/file-upload-dialog';\r\nimport { HttpServiceBaseSignal } from '../../shared/services/http-service-base-signal';\r\nimport { License, LicenseDownloadInfo, LicenseUploadInfo } from '../models/license.model';\r\n\r\nconst webAPiLicenseRetrieve = 'sys/license/Retrieve';\r\nconst webApiFeatSaveNew = 'admin/feature/SaveNew';\r\nconst webApiLicSummary = 'sys/license/Summary';\r\nconst webApiUpload = 'sys/license/Upload';\r\n\r\n@Injectable()\r\nexport class FeaturesConfigService extends HttpServiceBaseSignal {\r\n\r\n  saveFeatures(featuresStates: FeatureState[]): Observable<null> {\r\n    return this.http.post<null>(this.apiUrl(webApiFeatSaveNew), featuresStates);\r\n  }\r\n\r\n  getLicensesLive(refresh: Signal<unknown>) {\r\n    return httpResource<License[]>(() => {\r\n      refresh();\r\n      return this.apiUrl(webApiLicSummary);\r\n    });\r\n  }\r\n\r\n  uploadLicense(file: File): Observable<FileUploadResult> {\r\n    const formData = new FormData();\r\n    formData.append('File', file);\r\n    return this.http.post<LicenseUploadInfo>(this.apiUrl(webApiUpload), formData)\r\n      .pipe(\r\n        map(info => ({\r\n          Success: info.Success,\r\n          Messages: [{\r\n            MessageType: info.Success ? FileUploadMessageTypes.Success : FileUploadMessageTypes.Error,\r\n            Text: `License ${info.Success ? 'uploaded' : 'upload failed'}: ${info.Message}`,\r\n          }],\r\n        } satisfies FileUploadResult)),\r\n      );\r\n  }\r\n\r\n  retrieveLicensePromise(): Promise<LicenseDownloadInfo> {\r\n    return this.fetchPromise<LicenseDownloadInfo>(webAPiLicenseRetrieve, {\r\n    });\r\n  }\r\n}\r\n"],
  "mappings": "gJAQA,IAAMA,EAAwB,uBACxBC,EAAoB,wBACpBC,EAAmB,sBACnBC,EAAe,qBAGRC,GAAsB,IAAA,CAA7B,MAAOA,UAA8BC,CAAqB,CAE9DC,aAAaC,EAA8B,CACzC,OAAO,KAAKC,KAAKC,KAAW,KAAKC,OAAOT,CAAiB,EAAGM,CAAc,CAC5E,CAEAI,gBAAgBC,EAAwB,CACtC,OAAOC,EAAwB,KAC7BD,EAAO,EACA,KAAKF,OAAOR,CAAgB,EACpC,CACH,CAEAY,cAAcC,EAAU,CACtB,IAAMC,EAAW,IAAIC,SACrBD,OAAAA,EAASE,OAAO,OAAQH,CAAI,EACrB,KAAKP,KAAKC,KAAwB,KAAKC,OAAOP,CAAY,EAAGa,CAAQ,EACzEG,KACCC,EAAIC,IAAS,CACXC,QAASD,EAAKC,QACdC,SAAU,CAAC,CACTC,YAAaH,EAAKC,QAAUG,EAAuBH,QAAUG,EAAuBC,MACpFC,KAAM,WAAWN,EAAKC,QAAU,WAAa,eAAe,KAAKD,EAAKO,OAAO,GAC9E,GAC0B,CAAC,CAEpC,CAEAC,wBAAsB,CACpB,OAAO,KAAKC,aAAkC9B,EAAuB,CAAA,CACpE,CACH,qEA/BWI,CAAqB,IAAA2B,GAArB3B,CAAqB,CAAA,CAAA,GAAA,CAAA,iCAArBA,EAAqB4B,QAArB5B,EAAqB6B,SAAA,CAAA,CAAA,SAArB7B,CAAsB,GAAA",
  "names": ["webAPiLicenseRetrieve", "webApiFeatSaveNew", "webApiLicSummary", "webApiUpload", "FeaturesConfigService", "HttpServiceBaseSignal", "saveFeatures", "featuresStates", "http", "post", "apiUrl", "getLicensesLive", "refresh", "httpResource", "uploadLicense", "file", "formData", "FormData", "append", "pipe", "map", "info", "Success", "Messages", "MessageType", "FileUploadMessageTypes", "Error", "Text", "Message", "retrieveLicensePromise", "fetchPromise", "__ngFactoryType__", "factory", "\u0275fac"]
}
