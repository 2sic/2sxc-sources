import{ca as I}from"./chunk-DX662RXJ.js";import{Aa as b,Ad as $,ea as u,ia as v,ja as l,sa as x,t as d,wd as y,xd as w}from"./chunk-46QINP2S.js";import{a as s,b as p}from"./chunk-BDOJB7O2.js";var f={edition:"edition",apiEdition:"api-edition",antiForgeryToken:"anti-forgery-token",moduleId:"module-id",tabId:"tab-id",contentBlockId:"content-block-id",angularPath:"angular-path"},g=class{appElement;constructor(a){this.appElement=a}getAttribute(a){return this.appElement.nativeElement.getAttribute(a)}},M={addHttpHeaders:!0},P=0,m=(()=>{class o{$2sxc;sxc;addHttpHeaders;appNameInPath;edition;apiEdition;moduleId;contentBlockId;angularPath;appTagService;preConfiguration;constructor(){if(this.$2sxc=window.$2sxc,this.$2sxc===void 0)throw new Error("window.$2sxc is null - you probably forgot to include the script before loading angular");this.check2sxcVersion(),P++,P>1&&console.warn("The Context object of sxc-angular was created more than once. This is unexpected, and will probably lead to problems with the api calls.")}check2sxcVersion(){let e=[10,25,1],t=this.$2sxc.sysinfo.version.split(".").map(n=>parseInt(n));if(e.reduce((n,i,c)=>n!=0?n:Math.sign(t[c]-e[c]),0)<0)throw new Error(`Installed 2sxc version is ${t.join(".")} but ${e.join(".")} is required for sxc-angular.`)}preConfigure(e){return this.preConfiguration=e,this}autoConfigure(e){this.appTagService=new g(e);let t=s(s(s({},M),this.getContextFromAppTag()),this.preConfiguration);if(t.sxc=t.sxc||(t.moduleId?this.$2sxc(t.moduleId,t.contentBlockId):this.$2sxc(e.nativeElement)),!t.sxc)throw new Error("couldn't get sxc instance - reason unknown");this.sxc=t.sxc,this.addHttpHeaders=t.addHttpHeaders,this.appNameInPath=t.appNameInPath,this.edition=t.edition,this.apiEdition=t.apiEdition,t.angularPath&&(this.angularPath=t.angularPath,console.log("will set webpcak base to: "+t.angularPath),__webpack_public_path__=t.angularPath,console.log("done setting"))}getAppAttribute(e){return this.appTagService.getAttribute(e)}getContextFromAppTag(){return{edition:this.appTagService.getAttribute(f.edition),apiEdition:this.appTagService.getAttribute(f.apiEdition),angularPath:this.appTagService.getAttribute(f.angularPath)}}static \u0275fac=function(t){return new(t||o)};static \u0275prov=u({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var E="api",C="content",D="query",h="app/auto/",H=`${h}${E}`,U=`${h}${D}`,q=`${h}${C}`;var S=(()=>{class o{context;constructor(e){this.context=e}intercept(e,t){if(!this.isSameOrigin(e))return t.handle(e);let r=e.url,n=this.context;n.$2sxc&&(r=n.$2sxc.http.apiUrl(e.url)),n.apiEdition&&(r=r.replace(H,h+n.apiEdition+"/"+E)),n.appNameInPath&&(r=r.replace(h,`app/${n.appNameInPath}/`));let i={};n.addHttpHeaders&&n.sxc&&(i=n.sxc.webApi.headers(),i=this.convertAllPropertiesToString(i));let c=e.clone({url:r,setHeaders:i});return t.handle(c)}isSameOrigin(e){let t=e.url.toLowerCase(),r=!0;return t.startsWith("https://")||t.startsWith("http://")?r=!1:t.startsWith("//")&&(r=!1,t=window.location.protocol+t),!!(r||t.startsWith(`${window.location.protocol}//${window.location.host}`))}convertAllPropertiesToString(e){return Object.keys(e).reduce((t,r)=>p(s({},t),{[r]:e[r].toString()}),{})}static \u0275fac=function(t){return new(t||o)(v(m))};static \u0275prov=u({token:o,factory:o.\u0275fac})}return o})(),V={provide:y,useClass:S,multi:!0};var T=class{constructor(a,e,t){e.autoConfigure(a),t||a.nativeElement.addEventListener("keydown",r=>{r.target.tagName.toLowerCase()==="input"&&r.keyCode===13&&r.preventDefault()})}};var Y=(()=>{class o{constructor(){this.http=l(w),this.context=l(I),this.injector=l(x),this.#t=l(m)}#t;apiUrl(e){return this.#t.$2sxc.http.apiUrl(e)}get appId(){return this.context.appId.toString()}get zoneId(){return this.context.zoneId.toString()}newHttpResource(e){return $(e,{injector:this.injector})}postSignal(e,t,r,n){let i=b(n);return this.http.post(this.apiUrl(e),t,r).subscribe(c=>{i.set(c)}),i}getStatusPromise(e,t){try{let r=p(s({},t),{observe:"response"});return d(this.http.get(this.apiUrl(e),r)).then(n=>n.status).catch(n=>(console.error("HTTP error in getStatusPromise:",n),n?.status??500))}catch(r){return console.error("Error in getStatusPromise:",r),Promise.resolve(500)}}fetchPromise(e,t){try{let r=p(s({},t),{observe:"body"});return d(this.http.get(this.apiUrl(e),r)).catch(n=>{throw console.error("HTTP error in fetchPromise:",n),n})}catch(r){return console.error("Error in fetchPromise:",r),Promise.reject(r)}}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275prov=u({token:o,factory:o.\u0275fac})}}return o})();export{m as a,V as b,T as c,Y as d};
//# sourceMappingURL=https://sources.2sxc.org/21.00.00/dist/ng-edit/chunk-ENHI5GWA.js.map
