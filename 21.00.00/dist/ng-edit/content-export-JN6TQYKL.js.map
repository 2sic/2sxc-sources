{
  "version": 3,
  "sources": ["projects/eav-ui/src/app/content-export/content-export.ts", "projects/eav-ui/src/app/content-export/content-export.html"],
  "sourcesContent": ["import { AsyncPipe } from '@angular/common';\r\nimport { Component, HostBinding, OnDestroy, OnInit } from '@angular/core';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatOptionModule } from '@angular/material/core';\r\nimport { MatDialogActions, MatDialogRef } from '@angular/material/dialog';\r\nimport { MatFormFieldModule } from '@angular/material/form-field';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatRadioModule } from '@angular/material/radio';\r\nimport { MatSelectModule } from '@angular/material/select';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { BehaviorSubject, forkJoin } from 'rxjs';\r\nimport { transient } from '../../../../core';\r\nimport { ContentType } from '../app-administration/models/content-type.model';\r\nimport { ContentTypesService } from '../app-administration/services/content-types.service';\r\nimport { DialogConfigAppService } from '../app-administration/services/dialog-config-app.service';\r\nimport { isCtrlEnter } from '../edit/dialog/main/keyboard-shortcuts';\r\nimport { Language } from '../shared/models/language.model';\r\nimport { ContentExport } from './models/content-export.model';\r\nimport { ContentExportService } from './services/content-export.service';\r\n\r\n@Component({\r\n    selector: 'app-content-export',\r\n    templateUrl: './content-export.html',\r\n    styleUrls: ['./content-export.scss'],\r\n    imports: [\r\n        FormsModule,\r\n        MatFormFieldModule,\r\n        MatIconModule,\r\n        MatSelectModule,\r\n        MatOptionModule,\r\n        MatRadioModule,\r\n        MatDialogActions,\r\n        MatButtonModule,\r\n        AsyncPipe,\r\n    ]\r\n})\r\nexport class ContentExportComponent implements OnInit, OnDestroy {\r\n  @HostBinding('className') hostClass = 'dialog-component';\r\n\r\n  private contentExportService = transient(ContentExportService);\r\n  private contentTypesService = transient(ContentTypesService);\r\n  private dialogConfigSvc = transient(DialogConfigAppService);\r\n\r\n  formValues: ContentExport;\r\n  languages: Language[];\r\n  itemIds: number[];\r\n  hasIdList = false;\r\n  loading$ = new BehaviorSubject(false);\r\n  contentType$ = new BehaviorSubject<ContentType>(null);\r\n\r\n  private contentTypeStaticName = this.route.snapshot.paramMap.get('contentTypeStaticName');\r\n\r\n  constructor(\r\n    private dialog: MatDialogRef<ContentExportComponent>,\r\n    private route: ActivatedRoute,\r\n  ) {\r\n    const selectedIds = this.route.snapshot.paramMap.get('selectedIds');\r\n    this.hasIdList = !!selectedIds;\r\n    if (this.hasIdList) {\r\n      this.itemIds = selectedIds.split(',').map(id => parseInt(id, 10));\r\n    }\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.#watchKeyboardShortcuts();\r\n    \r\n    this.loading$.next(true);\r\n    const contentType$ = this.contentTypesService.retrieveContentType(this.contentTypeStaticName);\r\n    const dialogSettings$ = this.dialogConfigSvc.getCurrent$();\r\n    forkJoin([contentType$, dialogSettings$]).subscribe(([contentType, dialogSettings]) => {\r\n      this.contentType$.next(contentType);\r\n      this.languages = dialogSettings.Context.Language.List;\r\n\r\n      this.formValues = {\r\n        defaultLanguage: dialogSettings.Context.Language.Primary,\r\n        contentTypeStaticName: this.contentTypeStaticName,\r\n        language: '',\r\n        recordExport: this.hasIdList ? 'Selection' : 'All',\r\n        languageReferences: 'Link',\r\n        resourcesReferences: 'Link',\r\n      };\r\n      this.loading$.next(false);\r\n    });\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.contentType$.complete();\r\n    this.loading$.complete();\r\n  }\r\n\r\n  closeDialog() {\r\n    this.dialog.close();\r\n  }\r\n\r\n  exportContent() {\r\n    this.contentExportService.exportContent(this.formValues,\r\n      this.hasIdList && this.formValues.recordExport === 'Selection' ? this.itemIds : null);\r\n  }\r\n  \r\n  #watchKeyboardShortcuts(): void {\r\n    this.dialog.keydownEvents().subscribe(event => {\r\n      if (isCtrlEnter(event)) {\r\n        event.preventDefault();\r\n        this.exportContent();\r\n      }\r\n    });\r\n  }\r\n}\r\n", "<div class=\"eav-dialog\">\r\n  <div class=\"eav-dialog-header\">\r\n    <div class=\"eav-dialog-header__title\">\r\n      Export {{ (contentType$ | async)?.Name }}\r\n    </div>\r\n    <button mat-icon-button tippy=\"Close dialog\" (click)=\"closeDialog()\">\r\n      <mat-icon>close</mat-icon>\r\n    </button>\r\n  </div>\r\n  @if ((loading$ | async) === false) {\r\n    <form #ngForm=\"ngForm\">\r\n      <div class=\"eav-dialog-content\">\r\n        <p>\r\n          This will generate an XML file which you can edit in Excel. If you just want to import new data, use this to export the schema\r\n          that you can then fill in using Excel. Please visit\r\n          <a href=\"https://2sxc.org/help\" target=\"_blank\">https://2sxc.org/help</a> for more instructions.\r\n        </p>\r\n        <div class=\"dialog-form-content fancy-scrollbar-light\">\r\n          <div>\r\n            <mat-form-field color=\"accent\" class=\"eav-mat-form-field\">\r\n              <mat-label>Languages</mat-label>\r\n              <mat-select [(ngModel)]=\"formValues.language\" name=\"Language\">\r\n                <mat-option value=\"\">All</mat-option>\r\n                @for (lang of languages; track lang) {\r\n                  <mat-option [value]=\"lang.NameId\">{{ lang.NameId }}</mat-option>\r\n                }\r\n              </mat-select>\r\n            </mat-form-field>\r\n          </div>\r\n          <div>\r\n            <p class=\"eav-radio-group-label\">Export data</p>\r\n            <mat-radio-group [(ngModel)]=\"formValues.recordExport\" name=\"RecordExport\" class=\"eav-radio-group\">\r\n              <mat-radio-button value=\"Blank\">No, just export blank data schema (for new data import) </mat-radio-button>\r\n              <mat-radio-button value=\"All\">Yes, export all content-items</mat-radio-button>\r\n              @if (hasIdList) {\r\n                <mat-radio-button value=\"Selection\"> Export selected {{ itemIds.length }} items </mat-radio-button>\r\n              }\r\n            </mat-radio-group>\r\n          </div>\r\n          <div>\r\n            <p class=\"eav-radio-group-label\">Value references to other languages</p>\r\n            <mat-radio-group\r\n              [(ngModel)]=\"formValues.languageReferences\"\r\n              name=\"LanguageReferences\"\r\n              [disabled]=\"formValues.recordExport === 'Blank'\"\r\n              class=\"eav-radio-group\"\r\n            >\r\n              <mat-radio-button value=\"Link\">Keep references to other languages (for re-import) </mat-radio-button>\r\n              <mat-radio-button value=\"Resolve\">Replace references with values</mat-radio-button>\r\n            </mat-radio-group>\r\n          </div>\r\n          <div>\r\n            <p class=\"eav-radio-group-label\">File / page references</p>\r\n            <mat-radio-group\r\n              [(ngModel)]=\"formValues.resourcesReferences\"\r\n              name=\"ResourcesReferences\"\r\n              [disabled]=\"formValues.recordExport === 'Blank'\"\r\n              class=\"eav-radio-group\"\r\n            >\r\n              <mat-radio-button value=\"Link\">Keep references (for re-import, for example Page:4711) </mat-radio-button>\r\n              <mat-radio-button value=\"Resolve\">Replace references with real URLs (for example /Portals/0...) </mat-radio-button>\r\n            </mat-radio-group>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <mat-dialog-actions align=\"end\">\r\n        <button\r\n          mat-raised-button\r\n          class=\"eav-action-button\"\r\n          [disabled]=\"!ngForm.form.valid\"\r\n          (click)=\"exportContent()\"\r\n        >\r\n          Export Data\r\n        </button>\r\n      </mat-dialog-actions>\r\n    </form>\r\n  }\r\n</div>\r\n"],
  "mappings": "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",
  "names": ["\u0275\u0275elementStart", "\u0275\u0275text", "\u0275\u0275elementEnd", "\u0275\u0275property", "lang_r3", "NameId", "\u0275\u0275advance", "\u0275\u0275textInterpolate", "\u0275\u0275textInterpolate1", "ctx_r1", "itemIds", "length", "\u0275\u0275twoWayListener", "$event", "\u0275\u0275restoreView", "_r1", "\u0275\u0275nextContext", "i0", "\u0275\u0275twoWayBindingSet", "formValues", "language", "\u0275\u0275resetView", "\u0275\u0275repeaterCreate", "ContentExportComponent_Conditional_8_For_17_Template", "\u0275\u0275repeaterTrackByIdentity", "recordExport", "\u0275\u0275conditionalCreate", "ContentExportComponent_Conditional_8_Conditional_26_Template", "languageReferences", "resourcesReferences", "\u0275\u0275listener", "exportContent", "\u0275\u0275twoWayProperty", "\u0275\u0275repeater", "languages", "\u0275\u0275conditional", "hasIdList", "ngForm_r4", "form", "valid", "ContentExportComponent", "constructor", "dialog", "route", "hostClass", "contentExportService", "transient", "ContentExportService", "contentTypesService", "ContentTypesService", "dialogConfigSvc", "DialogConfigAppService", "loading$", "BehaviorSubject", "contentType$", "contentTypeStaticName", "snapshot", "paramMap", "get", "selectedIds", "split", "map", "id", "parseInt", "ngOnInit", "#watchKeyboardShortcuts", "next", "retrieveContentType", "dialogSettings$", "getCurrent$", "forkJoin", "subscribe", "contentType", "dialogSettings", "Context", "Language", "List", "defaultLanguage", "Primary", "ngOnDestroy", "complete", "closeDialog", "close", "keydownEvents", "event", "isCtrlEnter", "preventDefault", "\u0275\u0275directiveInject", "MatDialogRef", "ActivatedRoute", "selectors", "hostVars", "hostBindings", "rf", "ctx", "\u0275\u0275domProperty", "ContentExportComponent_Conditional_8_Template", "tmp_0_0", "\u0275\u0275pipeBind1", "Name", "FormsModule", "\u0275NgNoValidate", "NgControlStatus", "NgControlStatusGroup", "NgModel", "NgForm", "MatFormFieldModule", "MatFormField", "MatLabel", "MatIconModule", "MatIcon", "MatSelectModule", "MatSelect", "MatOption", "MatOptionModule", "MatRadioModule", "MatRadioGroup", "MatRadioButton", "MatDialogActions", "MatButtonModule", "MatButton", "MatIconButton", "AsyncPipe", "styles"]
}
