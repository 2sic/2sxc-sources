import{c as u,e as d}from"./chunk-OYQCZWOE.js";import{d as m}from"./chunk-G33ZJSCE.js";import{aa as f,ca as r}from"./chunk-DX662RXJ.js";import{$a as c,Tc as g,Za as n,db as h,rc as p,sa as l}from"./chunk-46QINP2S.js";var y=(()=>{class a{#e;#t;constructor(t,e,i,o,s,v,C){this.matDialog=t,this.viewContainerRef=e,this.router=i,this.route=o,this.context=s,this.changeDetectorRef=v,this.injector=C,this.log=f({DialogEntryComponent:a});let D=this.router.currentNavigation();this.#e=D?.extras?.state||{}}ngOnInit(){let t=this.log.fn("ngOnInit"),e=this.route.snapshot.data.dialog;if(e==null)throw new Error("Could not find config for dialog. Did you forget to add DialogConfig to route data?");t.a("Open dialog: "+e.name,{id:this.context.id,context:this.context}),e.getComponent(this.injector).then(i=>{let o=this.matDialog;o._dialogAnimatingOpen&&o._lastDialogRef?o._lastDialogRef.afterOpened().subscribe(()=>this.openDialogComponent(e,i)):this.openDialogComponent(e,i)})}ngOnDestroy(){this.#t.close()}openDialogComponent(t,e){this.log.a(`Open dialog(initContext: ${t.initContext})`,{name:t.name,"Contextid:":this.context.log.svcId,"Context:":this.context}),t.initContext&&this.context.init(this.route),this.#t=this.matDialog.open(e,{autoFocus:!1,backdropClass:"dialog-backdrop",closeOnNavigation:!1,data:this.#e,panelClass:["dialog-panel",`dialog-panel-${t.panelSize}`,t.showScrollbar?"show-scrollbar":"no-scrollbar",...t.panelClass?t.panelClass:[]],position:{top:"0"},viewContainerRef:this.viewContainerRef}),this.#t.afterClosed().subscribe(i=>{this.log.a("Dialog was closed - name:"+t.name,{data:i});let o=i;if(o?.navigateUrl!=null){this.router.navigate([o.navigateUrl]);return}if(this.route.pathFromRoot.length<=3){try{window.parent.$2sxc.totalPopup.close()}catch{}return}this.route.snapshot.url.length>0?this.router.navigate(["./"],{relativeTo:this.route.parent,state:i}):this.router.navigate(["./"],{relativeTo:this.route.parent.parent,state:i})}),this.changeDetectorRef.markForCheck()}static{this.\u0275fac=function(e){return new(e||a)(n(m),n(c),n(d),n(u),n(r),n(g),n(l))}}static{this.\u0275cmp=h({type:a,selectors:[["app-dialog-entry"]],features:[p([r])],decls:0,vars:0,template:function(e,i){},encapsulation:2})}}return a})();export{y as a};
//# sourceMappingURL=https://sources.2sxc.org/21.00.00/dist/ng-edit/chunk-GVW7AWVE.js.map
