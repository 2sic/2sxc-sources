import{a as Rt}from"./chunk-FRCLG6YK.js";import{a as It}from"./chunk-XVKX7JBO.js";import{a as at}from"./chunk-KQM4ITOM.js";import{a as Mt}from"./chunk-PSAFKHUD.js";import{a as O}from"./chunk-O4YQRNMZ.js";import{a as Et}from"./chunk-5E3KZM3P.js";import{a as ot}from"./chunk-HHOXP7ZE.js";import"./chunk-ZRGOAEF3.js";import"./chunk-Q5UOKVIL.js";import"./chunk-VSMYOUA2.js";import"./chunk-O3YSC345.js";import"./chunk-LTBMRGUR.js";import"./chunk-Q7SYXYTY.js";import"./chunk-HW433KCS.js";import"./chunk-GLFISIX2.js";import"./chunk-MBSXBYF5.js";import"./chunk-AAMPB3UT.js";import{b as Tt}from"./chunk-DDUEZMYJ.js";import{a as At}from"./chunk-JZD2T5W2.js";import"./chunk-T2Q2H5HY.js";import{a as vt}from"./chunk-H6SOZQOZ.js";import{a as D}from"./chunk-LKTKDGC2.js";import"./chunk-OI3ZGSUF.js";import{a as it,b as nt}from"./chunk-NKT65OQW.js";import"./chunk-NIPOW2E2.js";import{a as Z}from"./chunk-ORK43FFD.js";import"./chunk-56YE37V6.js";import{a as xt}from"./chunk-OYXWEFHA.js";import{a as yt}from"./chunk-V5UC4TMG.js";import"./chunk-U657U553.js";import"./chunk-QFYVXC4V.js";import"./chunk-T7AKPKMZ.js";import{a as R}from"./chunk-L77E4UL2.js";import"./chunk-JNRBLGLU.js";import"./chunk-MWYLUFVP.js";import"./chunk-FYQJ654R.js";import"./chunk-ZKDKEYV7.js";import"./chunk-4YE3E6NH.js";import"./chunk-4SMJHLGZ.js";import{a as Y,b as J,c as K,e as X,f as tt,h as et}from"./chunk-MQM7DF2M.js";import"./chunk-QUYVM733.js";import"./chunk-JEQANFI7.js";import{a as I}from"./chunk-564RKXG7.js";import{a as g,c as _}from"./chunk-HJXR3IL7.js";import{a as bt}from"./chunk-BTK5NHS7.js";import"./chunk-K5FCDENP.js";import"./chunk-ODL7UGWI.js";import"./chunk-R3Y7P2GW.js";import"./chunk-LPOE4446.js";import"./chunk-37NMTDTM.js";import{b as _t}from"./chunk-WAPW5AUJ.js";import{d as Ct}from"./chunk-ENHI5GWA.js";import"./chunk-GL2SUH6T.js";import"./chunk-3M22BTAM.js";import{c as ht}from"./chunk-HCPBPEHV.js";import{f as St,h as j,l as Q}from"./chunk-QVLOO535.js";import{c as W}from"./chunk-XREQECMQ.js";import"./chunk-RPJBZPSB.js";import"./chunk-UMOPET3G.js";import"./chunk-4LV77BQU.js";import"./chunk-RGKBOUPL.js";import"./chunk-EZZQWHAZ.js";import{b as $,c as q}from"./chunk-23CS2WID.js";import{a as E}from"./chunk-OIHIMR2W.js";import"./chunk-BDMUNOAA.js";import{d as ft}from"./chunk-OYQCZWOE.js";import"./chunk-G33ZJSCE.js";import{ca as H}from"./chunk-DX662RXJ.js";import"./chunk-N5GZ74QQ.js";import"./chunk-XASILSQS.js";import{$b as U,Aa as M,Ad as gt,Cb as l,Db as n,Dc as rt,Ea as mt,Eb as a,Fb as c,Gc as T,Lb as P,Lc as G,Nb as L,Pa as C,Pb as b,Rb as m,Sa as s,Za as N,db as F,ea as pt,ec as o,f as lt,fc as V,gc as z,hd as ut,ja as ct,jb as B,oa as y,oc as dt,pa as x,wb as v,yb as A}from"./chunk-46QINP2S.js";import{a as st}from"./chunk-BDOJB7O2.js";var Vt="admin/appinternals/get",kt=(()=>{class r extends Ct{getAppInternalsLive(t){return gt(()=>(t(),{url:this.apiUrl(Vt),params:{appid:this.appId}}))}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=mt(r)))(i||r)}})()}static{this.\u0275prov=pt({token:r,factory:r.\u0275fac})}}return r})();var Pt={Settings:"Settings",Resources:"Resources"};function Ft(r,f){if(r&1){let t=L();n(0,"mat-card",0)(1,"mat-card-header",1)(2,"mat-card-title"),o(3,"Configuration"),a(),n(4,"mat-icon"),o(5,"redeem"),a()(),n(6,"mat-card-content"),c(7,"p"),n(8,"div",2)(9,"div",3),o(10,"Name:"),a(),n(11,"div",4)(12,"span",5),b("click",function(){y(t);let i=m();return x(i.clipboard.copyToClipboard(i.contentItem()[0].DisplayName))}),o(13),a()()(),n(14,"div",2)(15,"div",3),o(16,"Folder:"),a(),n(17,"div",4)(18,"span",5),b("click",function(){y(t);let i=m();return x(i.clipboard.copyToClipboard(i.contentItem()[0].Folder))}),o(19),a()()(),n(20,"div",2)(21,"div",3),o(22,"Version:"),a(),n(23,"div",4)(24,"span",5),b("click",function(){y(t);let i=m();return x(i.clipboard.copyToClipboard(i.contentItem()[0].Version))}),o(25),a()()(),n(26,"div",2)(27,"div",3),o(28,"For"),a(),n(29,"div",4)(30,"b"),o(31,"2sxc: "),a(),n(32,"span",5),b("click",function(){y(t);let i=m();return x(i.clipboard.copyToClipboard(i.contentItem()[0].RequiredVersion))}),o(33),a(),n(34,"b"),o(35," DNN: "),a(),n(36,"span",5),b("click",function(){y(t);let i=m();return x(i.clipboard.copyToClipboard(i.contentItem()[0].RequiredDnnVersion))}),o(37),a(),n(38,"b"),o(39," Oqt: "),a(),n(40,"span",5),b("click",function(){y(t);let i=m();return x(i.clipboard.copyToClipboard(i.contentItem()[0].RequiredOqtaneVersion))}),o(41),a()()()(),c(42,"div",6),n(43,"mat-card-actions",7),c(44,"app-docs-link-helper",8),n(45,"a",9)(46,"mat-icon",10),o(47,"edit"),a(),n(48,"span"),o(49,"Edit"),a()(),n(50,"a",11)(51,"mat-icon",10),o(52,"local_offer"),a(),n(53,"span"),o(54,"Metadata"),a()()()()}if(r&2){let t,e,i,p,h,d,S,w,u=m();s(12),l("tippy","Click to copy to clipboard"),s(),V(u.formatValue((t=u.contentItem()[0])==null?null:t.DisplayName)),s(5),l("tippy","Click to copy to clipboard"),s(),V(u.formatValue((e=u.contentItem()[0])==null?null:e.Folder)),s(5),l("tippy","Click to copy to clipboard"),s(),V(u.formatValue((i=u.contentItem()[0])==null?null:i.Version)),s(7),l("tippy","Click to copy to clipboard"),s(),z(" ",u.formatValue((p=u.contentItem()[0])==null?null:p.RequiredVersion)," "),s(3),l("tippy","Click to copy to clipboard"),s(),z(" ",u.formatValue((h=u.contentItem()[0])==null?null:h.RequiredDnnVersion)," "),s(3),l("tippy","Click to copy to clipboard"),s(),z(" ",u.formatValue((d=u.contentItem()[0])==null?null:d.RequiredOqtaneVersion)," "),s(3),l("link","https://docs.2sxc.org/basics/app/configuration.html"),s(),l("href",u.appConfigurationUrl(),C),s(),l("matBadge",((S=u.appSettingsInternal())==null||S.EntityLists==null?null:S.EntityLists.ToSxcContentApp.length)||null),s(4),l("href",u.urlToOpenMetadata(),C),s(),l("matBadge",((w=u.appSettingsInternal())==null?null:w.MetadataList.Items.length)||null)}}var Ut=(()=>{class r{#e;#n;constructor(t,e){this.context=t,this.snackBar=e,this.dialogSettings=G.required(),this.appSettingsInternal=G.required(),this.refresh=G.required(),this.#e=E(ot),this.#n=E(Z),this.appConfigurationUrl=M(""),this.appConfigAvailable=M(!1),this.contentItem=this.#e.getAllLive(_.contentTypes.appConfiguration,this.refresh).value,this.clipboard=E(bt),this.appConfigurationUrl=this.urlToEdit()}ngOnDestroy(){this.snackBar.dismiss()}#i(t,e,i){let p="#"+this.#n.urlSubRoute(t);return e&&(p+=`?${new URLSearchParams(e).toString()}`),i&&(p+=`&errComponent=${i}`),p}urlToEdit(){let t=M("");return this.#e.getAllPromise(_.contentTypes.appConfiguration).then(e=>{if(e.length!==1)return t.set(this.#i("message/e",{error:"AppAdmin.ErrorTooManyAppSettings",errComponent:"App-Specifications",openUrl:"/data/System.App"})),t;this.appConfigAvailable.set(!0),t.set(this.#i(`edit/${R({items:[I.editId(e[0].Id)]})}`))}),t}urlToOpenMetadata(){return this.#i(Mt.getUrlApp(this.context.appId,`Metadata for App: ${this.dialogSettings().Context.App.Name} (${this.context.appId})`))}formatValue(t){return t===""?"-":t??"-"}static{this.\u0275fac=function(e){return new(e||r)(N(H),N(ht))}}static{this.\u0275cmp=F({type:r,selectors:[["app-app-configuration-card"]],inputs:{dialogSettings:[1,"dialogSettings"],appSettingsInternal:[1,"appSettingsInternal"],refresh:[1,"refresh"]},decls:1,vars:1,consts:[[1,"eav-card"],[1,"eav-card-header"],[1,"eav-info-row"],[1,"eav-info-row__label"],[1,"eav-info-row__value"],[3,"click","tippy"],[1,"eav-card-space-div"],["align","start"],[3,"link","label","icon"],["mat-button","","tippy","Edit app system resources",1,"eav-button__with-icon",3,"href"],["matBadgeColor","accent","matBadgeSize","small","matBadgePosition","below after","aria-hidden","false",1,"eav-icon",3,"matBadge"],["mat-button","",1,"eav-button__with-icon",3,"href"]],template:function(e,i){e&1&&v(0,Ft,55,17,"mat-card",0),e&2&&A(i.contentItem()?0:-1)},dependencies:[et,Y,X,K,tt,J,q,$,Q,j,nt,it,W,at],styles:[`.eav-card-space-div[_ngcontent-%COMP%]{min-height:30px}.eav-button__with-icon[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{color:#85283b!important}
/*# sourceMappingURL=app-configuration-card-TWVBWQQE.css.map */`]})}}return r})();function zt(r,f){r&1&&o(0," This is the Global App. Anything configured here will affect all Sites and Apps in this installation. ")}function Gt(r,f){r&1&&o(0," This is the Primary App of this Site. You can also configure site wide settings and resources here. ")}function $t(r,f){if(r&1&&(n(0,"div",2),v(1,zt,1,0),v(2,Gt,1,0),o(3," See "),n(4,"a",6),o(5,"docs"),a(),o(6,". "),a()),r&2){let t=m(2);s(),A(t.isGlobal()?1:-1),s(),A(t.isSite()?2:-1)}}function qt(r,f){r&1&&P(0)}function Ht(r,f){if(r&1&&B(0,qt,1,0,"ng-container",23),r&2){m();let t=U(91);l("ngTemplateOutlet",t)}}function jt(r,f){r&1&&P(0)}function Qt(r,f){r&1&&P(0)}function Wt(r,f){if(r&1&&B(0,jt,1,0,"ng-container",23)(1,Qt,1,0,"ng-container",23),r&2){m();let t=U(91),e=U(93);l("ngTemplateOutlet",e),s(),l("ngTemplateOutlet",t)}}function Zt(r,f){r&1&&P(0)}function Yt(r,f){if(r&1&&B(0,Zt,1,0,"ng-container",23),r&2){m();let t=U(91);l("ngTemplateOutlet",t)}}function Jt(r,f){r&1&&P(0)}function Kt(r,f){r&1&&P(0)}function Xt(r,f){if(r&1&&B(0,Jt,1,0,"ng-container",23)(1,Kt,1,0,"ng-container",23),r&2){m();let t=U(91),e=U(93);l("ngTemplateOutlet",e),s(),l("ngTemplateOutlet",t)}}function te(r,f){if(r&1){let t=L();n(0,"tr")(1,"th"),o(2,"Global"),a(),n(3,"td")(4,"button",24),b("click",function(){y(t);let i=m(2);return x(i.openGlobalSettings())}),n(5,"mat-icon"),o(6,"open_in_new"),a()()()()}}function ee(r,f){if(r&1){let t=L();n(0,"tr")(1,"th"),o(2,"Site"),a(),n(3,"td")(4,"button",25),b("click",function(){y(t);let i=m(2);return x(i.openSiteSettings())}),n(5,"mat-icon"),o(6,"open_in_new"),a()()()()}}function ie(r,f){r&1&&o(0," (not on Global App) ")}function ne(r,f){r&1&&o(0," (not on Content) ")}function oe(r,f){if(r&1&&(v(0,ie,1,0),v(1,ne,1,0)),r&2){let t=m(2);A(t.isGlobal()?0:-1),s(),A(t.isApp()?1:-1)}}function ae(r,f){if(r&1){let t=L();v(0,$t,7,2,"div",2),n(1,"div",3)(2,"mat-card",4)(3,"mat-card-header",5)(4,"mat-card-title"),o(5,"Settings"),a(),n(6,"mat-icon"),o(7,"settings"),a()(),n(8,"mat-card-content")(9,"p"),o(10,' Settings are things like SQL-connection strings, default "items-to-show" numbers and similar. If necessary, settings like a link to an RSS-Feed could be different in each language. '),n(11,"a",6),o(12,"docs"),a()(),n(13,"table",7)(14,"thead")(15,"tr"),c(16,"th"),n(17,"th"),o(18,"System Settings"),a(),n(19,"th"),o(20,"Custom Settings"),a()()(),n(21,"tbody")(22,"tr")(23,"th"),o(24),a(),n(25,"td")(26,"a",8)(27,"mat-icon",9),o(28,"edit"),a()()(),n(29,"td")(30,"a",10),b("click",function(i){y(t);let p=m();return x(p.fixContentTypeIfNecessary(p.buttons().customSettings.url,p.buttons().customSettingsType,i))}),n(31,"mat-icon",9),o(32,"edit"),a()(),n(33,"a",10),b("click",function(i){y(t);let p=m();return x(p.fixContentTypeIfNecessary(p.buttons().customSettings.url,p.buttons().customSettingsType,i))}),n(34,"mat-icon",9),o(35,"dns"),a()()()(),v(36,Ht,1,1,"ng-container")(37,Wt,2,2),a()()(),c(38,"div",11),n(39,"mat-card-actions",12),c(40,"app-docs-link-helper",13),n(41,"a",14)(42,"mat-icon",15),o(43,"manage_search"),a(),n(44,"span"),o(45,"Analyze Combined Settings"),a()()()(),n(46,"mat-card",4)(47,"mat-card-header",5)(48,"mat-card-title"),o(49,"Language Resources (i18n)"),a(),n(50,"mat-icon"),o(51,"translate"),a()(),n(52,"mat-card-content")(53,"p"),o(54," Resources are used for labels and things like that in the App. They are usually needed to create multi-lingual views and such, and should not be used for App-Settings. "),n(55,"a",6),o(56,"docs"),a()(),n(57,"table",7)(58,"thead")(59,"tr"),c(60,"th"),n(61,"th"),o(62,"System Resources"),a(),n(63,"th"),o(64,"Custom Resources"),a()()(),n(65,"tbody")(66,"tr")(67,"th"),o(68),a(),n(69,"td")(70,"a",8)(71,"mat-icon",9),o(72,"edit"),a()()(),n(73,"td")(74,"a",10),b("click",function(i){y(t);let p=m();return x(p.fixContentTypeIfNecessary(p.buttons().customResources.url,p.buttons().customResourcesType,i))}),n(75,"mat-icon",9),o(76,"edit"),a()(),n(77,"a",10),b("click",function(i){y(t);let p=m();return x(p.fixContentTypeIfNecessary(p.buttons().customResources.url,p.buttons().customResourcesType,i))}),n(78,"mat-icon",9),o(79,"dns"),a()()()(),v(80,Yt,1,1,"ng-container")(81,Xt,2,2),a()()(),c(82,"div",11),n(83,"mat-card-actions",12),c(84,"app-docs-link-helper",13),n(85,"a",16)(86,"mat-icon",15),o(87,"manage_search"),a(),n(88,"span"),o(89,"Analyze Combined Resources"),a()()()(),B(90,te,7,0,"ng-template",null,0,rt)(92,ee,7,0,"ng-template",null,1,rt),a(),n(94,"div",3),c(95,"app-app-configuration-card",17),n(96,"mat-card",4)(97,"mat-card-header",5)(98,"mat-card-title"),o(99,"Performance"),a(),n(100,"mat-icon"),o(101,"bolt"),a()(),n(102,"mat-card-content")(103,"p"),o(104,"LightSpeed Output Cache to speed up page by 50-90%"),a(),c(105,"app-feature-text-info",18),a(),c(106,"div",11),n(107,"mat-card-actions",12),c(108,"app-docs-link-helper",13),n(109,"a",19)(110,"mat-icon",20),o(111,"bolt"),a(),n(112,"span"),o(113,"Edit LightSpeed"),a()()()(),n(114,"mat-card",4)(115,"mat-card-header",5)(116,"mat-card-title"),o(117,"Security"),a(),n(118,"mat-icon"),o(119,"local_police"),a()(),n(120,"mat-card-content")(121,"p"),o(122,"ContentSecurityPolicy (CSP) features in this App - for maximum control."),a(),c(123,"app-feature-text-info",18),a(),c(124,"div",11),n(125,"mat-card-actions",12),c(126,"app-docs-link-helper",13),a()(),n(127,"mat-card",4)(128,"mat-card-header",5)(129,"mat-card-title"),o(130,"Permissions"),a(),n(131,"mat-icon"),o(132,"person"),a()(),n(133,"mat-card-content")(134,"p"),o(135,"Give access to the entire app (all data). Use with care."),a()(),c(136,"div",11),n(137,"mat-card-actions",12),c(138,"app-docs-link-helper",13),n(139,"a",19)(140,"mat-icon",20),o(141,"person"),a(),n(142,"span"),o(143," Edit Permissions "),v(144,oe,2,2),a()(),c(145,"app-docs-link-helper",13),n(146,"a",21)(147,"mat-icon",22),o(148," person "),a(),n(149,"span"),o(150,"Language Permissions"),a()()()()()}if(r&2){let t=m();A(t.isGlobal()||t.isSite()?0:-1),s(24),V(t.buttons().topRowLabel),s(2),l("href",t.buttons().systemSettings.url,C)("tippy",t.buttons().systemSettings.tooltip),s(),l("matBadge",t.buttons().systemSettings.count),s(3),l("href",t.buttons().customSettings.url,C)("tippy",t.buttons().customSettings.tooltip),s(),l("matBadge",t.buttons().customSettings.count),s(2),l("href",t.buttons().customSettingsFields.url,C)("tippy",t.buttons().customSettingsFields.tooltip),s(),l("matBadge",t.buttons().customSettingsFields.count),s(2),A(t.isSite()?36:t.isApp()?37:-1),s(4),l("link","https://go.2sxc.org/settings"),s(),l("href",t.urlToAnalyze(t.AnalyzeParts.Settings),C),s(27),V(t.buttons().topRowLabel),s(2),l("href",t.buttons().systemResources.url,C)("tippy",t.buttons().systemResources.tooltip),s(),l("matBadge",t.buttons().systemResources.count),s(3),l("href",t.buttons().customResources.url,C)("tippy",t.buttons().customResources.tooltip),s(),l("matBadge",t.buttons().customResources.count),s(2),l("href",t.buttons().customResourcesFields.url,C)("tippy",t.buttons().customResourcesFields.tooltip),s(),l("matBadge",t.buttons().customResourcesFields.count),s(2),A(t.isSite()?80:t.isApp()?81:-1),s(4),l("link","https://go.2sxc.org/settings"),s(),l("href",t.urlToAnalyze(t.AnalyzeParts.Resources),C),s(10),l("dialogSettings",t.dialogSettings())("appSettingsInternal",t.appSpecsLazy())("refresh",t.refresh()),s(10),l("featureNameId",t.LightSpeedOutputCache)("asInfo",!0),s(3),l("link","https://go.2sxc.org/lightspeed"),s(),l("disabled",dt(!t.lightSpeedEnabled()))("href",t.buttons().lightspeed.url,C),s(),l("matBadge",t.buttons().lightspeed.count),s(13),l("featureNameId",t.ContentSecurityPolicy)("asInfo",!0),s(3),l("link","https://go.2sxc.org/csp"),s(12),l("link","https://docs.2sxc.org/basics/app/permissions.html"),s(),l("href",t.urlToOpenPermissions(),C)("disabled",!t.dialogSettings().Context.Enable.AppPermissions),s(),l("matBadge",t.dialogSettings().Context.App.Permissions.Count||null),s(4),A(t.dialogSettings().Context.Enable.AppPermissions?-1:144),s(),l("link","https://patrons.2sxc.org/features/feat/PermissionsByLanguage"),s(),l("href",t.urlToOpenLanguagePermissions(t.langPermsEnabled()),C),s(),l("matBadgeHidden",t.langPermsEnabled())}}var pi=(()=>{class r{#e;#n;#i;#s;#o;#l;#r;constructor(t){this.context=t,this.#e=ct(xt),this.#n=E(It),this.#i=E(Tt),this.#s=E(kt),this.#o=E(ot),this.#l=E(yt),this.#r=E(Z),this.eavConstants=_,this.AnalyzeParts=Pt,this.SystemSettingsScopes=g,this.AppScopes=O,this.LightSpeedOutputCache=D.LightSpeed,this.ContentSecurityPolicy=D.ContentSecurityPolicy,this.dialogSettings=_t(this.#l.getCurrent$()),this.#a=T(()=>this.dialogSettings()?.Context.App.SettingsScope),this.isGlobal=T(()=>{let e=this.#a();return e==null?null:e===O.Global}),this.isSite=T(()=>{let e=this.#a();return e==null?null:e===O.Site}),this.isApp=T(()=>{let e=this.#a();return e==null?null:e===O.App}),this.appSystemSettingsUrl=T(()=>{let e=this.isGlobal(),i=this.isSite();return e==null||i==null?null:(this.#p??=this.urlToEditSystem(_.contentTypes.systemSettings,e?g.App:i?g.Site:g.App),this.#p())}),this.appSystemResourcesUrl=T(()=>{let e=this.isGlobal(),i=this.isSite();return e==null||i==null?null:(this.#c??=this.urlToEditSystem(_.contentTypes.systemResources,e?g.App:i?g.Site:g.App),this.#c())}),this.appCustomSettingsUrl=T(()=>{let e=this.isGlobal(),i=this.isSite();return e==null||i==null?null:(this.#m??=this.urlToEditSystem(e?_.contentTypes.customSettings:i?_.contentTypes.customSettings:_.contentTypes.settings,e?g.App:i?g.Site:g.App),this.#m())}),this.appCustomResourcesUrl=T(()=>{let e=this.isGlobal(),i=this.isSite();return e==null||i==null?null:(this.#d??=this.urlToEditSystem(e?_.contentTypes.customResources:i?_.contentTypes.customResources:_.contentTypes.resources,e?g.App:i?g.Site:g.App),this.#d())}),this.appSettingsInternal$=new lt,this.appStateAdvanced=!1,this.lightSpeedEnabled=this.#e.isEnabled[D.LightSpeed],this.cspEnabled=this.#e.isEnabled[D.ContentSecurityPolicy],this.langPermsEnabled=this.#e.isEnabled[D.PermissionsByLanguage],this.refresh=M(0),this.appSpecsLazy=this.#s.getAppInternalsLive(this.refresh).value,this.#u=T(()=>{let e=this.appSpecsLazy();if(!e)return null;let i=e?.EntityLists,p=_.appMetadata.LightSpeed.ContentTypeName,h=this.isSite();return{appLightSpeedCount:e.MetadataList.Items.filter(S=>S._Type.Name===p).length,systemSettingsCount:h?i.SettingsSystem.filter(S=>S.SettingsEntityScope===g.Site).length:i.SettingsSystem.filter(S=>!S.SettingsEntityScope).length,customSettingsCount:i.AppSettings?.length,customSettingsFieldsCount:e.FieldAll.AppSettings?.length,systemResourcesCount:h?i.ResourcesSystem.filter(S=>S.SettingsEntityScope===g.Site).length:i.ResourcesSystem.filter(S=>!S.SettingsEntityScope).length,customResourcesCount:i.AppResources?.length,customResourcesFieldsCount:e?.FieldAll.AppResources?.length}}),this.#g=T(()=>{let e=this.appSpecsLazy();return e?{settings:e.FieldAll.AppSettings!=null,resources:e.FieldAll.AppResources!=null}:{settings:!1,resources:!1}}),this.buttons=T(()=>{if(!(this.dialogSettings()!=null)){let k={tooltip:"",url:"",count:null};return{topRowLabel:"loading...",customSettingsType:"",customResourcesType:"",systemSettings:k,customSettings:k,customSettingsFields:k,systemResources:k,customResources:k,customResourcesFields:k,lightspeed:k}}let i=!!this.isApp(),p=this.dialogSettings().Context.App.SettingsScope,h=this.#u(),d=_.contentTypes,S=i?d.settings:d.customSettings,w=i?d.resources:d.customResources,u=this.#g();return{topRowLabel:p,customSettingsType:S,customResourcesType:w,systemSettings:{tooltip:`Edit ${p} system settings`,url:this.appSystemSettingsUrl(),count:h?.systemSettingsCount||null},customSettings:{tooltip:`Edit ${p} custom settings`,url:u.settings?this.appCustomSettingsUrl():null,count:h?.customSettingsCount||null},customSettingsFields:{tooltip:`Configure fields of the custom ${p} settings`,url:u.settings?this.urlToConfig(S):null,count:h?.customSettingsFieldsCount||null},systemResources:{tooltip:`Edit ${p} system resources`,url:this.appSystemResourcesUrl(),count:h?.systemResourcesCount||null},customResources:{tooltip:`Edit ${p} custom resources`,url:u.resources?this.appCustomResourcesUrl():null,count:h?.customResourcesCount||null},customResourcesFields:{tooltip:`Edit ${p} custom resources fields`,url:this.urlToConfig(w),count:h?.customResourcesFieldsCount||null},lightspeed:{tooltip:`Edit ${p} LightSpeed`,url:this.urlToGetLightSpeedLink(),count:h?.appLightSpeedCount||null}}})}#a;#p;#c;#m;#d;#u;#g;ngOnInit(){this.#r.doOnDialogClosed(()=>{this.refresh.update(t=>++t)})}#t(t,e,i){let p="#"+this.#r.urlSubRoute(t);return e&&(p+=`?${new URLSearchParams(e).toString()}`),i&&(p+=`&errComponent=${i}`),p}urlToEditSystem(t,e){let i=M("");return this.#o.getAllPromise(t).then(p=>{let h=p.filter(d=>e===g.App?!d.SettingsEntityScope:d.SettingsEntityScope===g.Site);if(h.length>1)i.set(this.#t("message/e",{error:"AppAdmin.ErrorTooManyAppSettings",openUrl:"/data/System.App"},t));else{let d=h[0];i.set(this.#t(`edit/${R({items:[d==null?I.newFromType(t,st({},e===g.Site&&{SettingsEntityScope:g.Site})):I.editId(d.Id)]})}`))}}),i}urlToEditCustom(t){let e=M("");return this.#o.getAllPromise(t).then(i=>{if(i.length>1)e.set(this.#t("message/e",{error:"AppAdmin.ErrorTooManyAppSettings",openUrl:"/data/System.App"},t));else{let p=i[0];e.set(this.#t(`edit/${R({items:[p==null?I.newFromType(t):I.editId(p.Id)]})}`))}}),e}urlToEditDefault(t){let e=M("");return this.#o.getAllPromise(t).then(i=>{i.length<1?e.set(this.#t("message/e",{error:"AppAdmin.ErrorNoAppSettings",openUrl:"/data/System.App"},t)):i.length>1?e.set(this.#t("message/e",{error:"AppAdmin.ErrorTooManyAppSettings",openUrl:"/data/System.App"},t)):e.set(this.#t(`edit/${R({items:[I.editId(i[0].Id)]})}`))}),e}urlToGetLightSpeedLink(){return this.#t(`edit/${R(Rt.getLightSpeedEditParams(this.context.appId))}`)}openSiteSettings(){let t=this.dialogSettings().Context.Site.PrimaryApp;this.#n.openAppAdministration(t.ZoneId,t.AppId,"app")}openGlobalSettings(){let t=this.dialogSettings().Context.System.PrimaryApp;this.#n.openAppAdministration(t.ZoneId,t.AppId,"app")}urlToConfig(t){return this.#t(`fields/${t}`)}urlToOpenPermissions(){return this.#t(At.getUrlApp(this.context.appId))}urlToOpenLanguagePermissions(t){return t?this.#t("language-permissions"):this.#t("edit-language-permissions")}urlToAnalyze(t){return this.#t(`analyze/${t}`)}fixContentTypeIfNecessary(t,e,i){t||(i.preventDefault(),i.stopPropagation(),this.#i.retrieveContentTypesPromise(_.scopes.configuration.value).then(p=>{if(p.some(d=>d.Name===e)){let d=this.#t(`edit/${R({items:[I.newFromType(e)]})}`);if(d){window.open(d,"_self");return}else return}else{let d={StaticName:"",Name:e,Description:"",Scope:_.scopes.configuration.value,ChangeNameId:!1,NewNameId:""};return this.#i.save(d).subscribe(S=>{S&&(this.refresh.update(w=>++w),alert("Created a new Content Type. Please try again \u{1F44D}\u{1F3FC}."))}),!1}}))}static{this.\u0275fac=function(e){return new(e||r)(N(H))}}static{this.\u0275cmp=F({type:r,selectors:[["app-app-configuration"]],decls:2,vars:1,consts:[["goToGlobal",""],["goToSite",""],[1,"alert","alert-info","scope-info"],[1,"eav-cards-box"],[1,"eav-card"],[1,"eav-card-header"],["href","https://go.2sxc.org/settings","target","_blank"],[1,"eav-settings-and-resources-table"],["mat-icon-button","",3,"href","tippy"],["matBadgeSize","small","matBadgePosition","below after","aria-hidden","false",3,"matBadge"],["mat-icon-button","",3,"click","href","tippy"],[1,"eav-card-space-div"],["align","start"],[3,"link","label","icon"],["mat-button","","tippy","See the result of combining all settings",1,"eav-button__with-icon",3,"href"],[1,"eav-icon"],["mat-button","","tippy","See the result of combining all resources",1,"eav-button__with-icon",3,"href"],[3,"dialogSettings","appSettingsInternal","refresh"],[3,"featureNameId","asInfo"],["mat-button","",1,"eav-button__with-icon",3,"href","disabled"],["matBadgeSize","small","matBadgePosition","below after","aria-hidden","false",1,"eav-icon",3,"matBadge"],["mat-button","",1,"eav-button__with-icon",3,"href"],["matBadgeSize","small","matBadgeIcon","diamond","matBadgePosition","below after","aria-hidden","false",1,"eav-icon",3,"matBadgeHidden"],[4,"ngTemplateOutlet"],["mat-icon-button","","tippy","Go to global",3,"click"],["mat-icon-button","","tippy","Go to site",3,"click"]],template:function(e,i){e&1&&(v(0,ae,151,48),c(1,"router-outlet")),e&2&&A(i.isGlobal()||i.isSite()||i.isApp()?0:-1)},dependencies:[et,Y,X,K,tt,J,q,$,Q,j,St,nt,it,Et,ut,Ut,vt,ft,W,at],styles:[`a[_ngcontent-%COMP%]{color:#465da3!important}a[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .eav-button__with-icon[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{color:#85283b!important}a.mat-mdc-button.mat-mdc-button-disabled[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{color:#00000061!important}.eav-settings-and-resources-table[_ngcontent-%COMP%]{width:100%}.eav-settings-and-resources-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-align:center}.eav-settings-and-resources-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:left}
/*# sourceMappingURL=app-configuration-5QTCRIEP.css.map */`]})}}return r})();export{pi as AppConfiguration};
//# sourceMappingURL=https://sources.2sxc.org/21.00.00/dist/ng-edit/app-configuration-HSPBE5YO.js.map
