"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_app-administration_web-api-rest-api_web-api-rest-api_ts"],{61215(b,T,s){s.d(T,{WebApiRestApiComponent:()=>h});var u=s(56884),D=s(36664),_=s(34456),O=s(84175),M=s(53777),v=s(93840),E=s(25175),P=s(69393),I=s(12938),C=s(79996),g=s(75669),f=s(34435),R=s(67037),W=s(60852),t=s(36124),U=s(80423),e=s(96462);function a(r,c){if(1&r&&(t.j41(0,"mat-option",4),t.EFF(1),t.k0s()),2&r){const o=c.$implicit;t.Y8G("value",o.path),t.R7$(),t.SpI(" ",o.name," ")}}function p(r,c){if(1&r&&t.Z7z(0,a,2,2,"mat-option",4,t.fX1),2&r){const o=t.XpG();t.Dyx(o.webApisTypes().sort())}}function i(r,c){1&r&&t.nrm(0,"app-rest-api-help-text",3),2&r&&t.Y8G("apiTitle","Web Api")}const n={all:!1,webApisTypes:!0,syncUrl:!0};let h=(()=>{class r{#e;#t;#s;constructor(){this.log=(0,f.Tq)({WebApiRestApiComponent:r},n),this.#e=(0,I.d)(C.F),this.#t=(0,I.d)(W.c),this.#s=(0,u.WQX)(_.ok),this.#a=(0,u.vPA)(0),this.#p=this.#e.getWebApisLive(this.#a),this.webApisTypes=(0,D.EW)(()=>this.#p()),this.webApiTypeForm=this.#s.group({webApiType:[""]}),(0,u.QZP)(()=>{const o=this.log.fnIf("syncUrl"),l=this.webApisTypes();if(0===l.length)return o.end();const d=this.#t.urlSegments.at(-1);var m=d.replace(/%252F/g,"/");const A=l.find(L=>L.path===m);o.a("status:",{webApis:l,webApi:A,urlPath:d,encodedUrlPath:m}),A&&this.webApiTypeForm.get("webApiType").setValue(A.path),o.end()})}#a;#p;openRestApi(o){o&&this.#t.navRelative([encodeURIComponent(o)])}static{this.\u0275fac=function(l){return new(l||r)}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-web-api-rest-api"]],decls:8,vars:3,consts:[[3,"formGroup"],["color","accent",1,"eav-mat-form-field"],["formControlName","webApiType",3,"valueChange"],[3,"apiTitle"],[3,"value"]],template:function(l,d){if(1&l&&(t.j41(0,"form",0)(1,"mat-form-field",1)(2,"mat-label"),t.EFF(3,"Endpoint"),t.k0s(),t.j41(4,"mat-select",2),t.bIt("valueChange",function(A){return d.openRestApi(A)}),t.nVh(5,p,2,0),t.k0s()()(),t.nVh(6,i,1,1,"app-rest-api-help-text",3),t.nrm(7,"router-outlet")),2&l){let m;t.Y8G("formGroup",d.webApiTypeForm),t.R7$(5),t.vxM(d.webApisTypes()?5:-1),t.R7$(),t.vxM(null!=(m=d.webApiTypeForm.get("webApiType"))&&m.value?-1:6)}},dependencies:[E.Ve,U.rl,U.nJ,E.VO,e.wT,O.Hl,M.Hu,v.m_,_.X1,_.qT,_.BC,_.cb,_.j4,_.JD,P.n3,R.p,g.q],encapsulation:2})}}return r})()},79996(b,T,s){s.d(T,{F:()=>W});var u=s(46443),D=s(36664),_=s(70271),O=s(96474),M=s(56884),v=s(36124);const P="admin/AppFiles/asset",g="admin/ApiExplorer/AppApiFiles";let W=(()=>{class t extends O.D{get(e,a,p){return this.getHttpApiUrl(P,{params:{appId:this.appId,global:a,...this.templateIdOrPath(e,a,p)}}).pipe((0,_.T)(i=>{if("auto"===i.Type.toLocaleLowerCase())switch(i.Extension.toLocaleLowerCase()){case".cs":case".cshtml":i.Type="Razor";break;case".html":case".css":case".js":i.Type="Token"}return i}))}save(e,a,p,i){return this.http.post(this.apiUrl(P),p,{params:{appId:this.appId,global:a,...this.templateIdOrPath(e,a,i)}})}getAllPromise(e){return this.fetchPromise("admin/AppFiles/AppFiles",{params:{appId:this.appId,...e&&{mask:e}}}).then(({Files:a})=>(a.forEach(p=>{p.Shared??=!1}),a))}getWebApis(){return this.getHttpApiUrl(g,{params:{appId:this.appId}}).pipe((0,_.T)(({files:e})=>(e.forEach(a=>{a.isShared??=!1,a.isCompiled??=!1}),e))).pipe((0,_.T)(e=>e.map(p=>{const i=p.path.lastIndexOf("/"),n=p.path.lastIndexOf("."),h=p.path.substring(0,i),r=p.path.substring(i+1,n);return{path:p.path,folder:h,name:r,isShared:p.isShared,endpointPath:p.endpointPath,isCompiled:p.isCompiled,edition:p.edition}})))}getWebApisLive(e){const a=(0,u.fx)(()=>(e(),{url:this.apiUrl(g),params:{appId:this.appId}}));return(0,D.EW)(()=>{const i=a.value()?.files;return i?(i.forEach(n=>{n.isShared??=!1,n.isCompiled??=!1}),i.map(n=>{const h=n.path.lastIndexOf("/"),r=n.path.lastIndexOf("."),c=n.path.substring(0,h),o=n.path.substring(h+1,r);return{path:n.path,folder:c,name:o,isShared:n.isShared,endpointPath:n.endpointPath,isCompiled:n.isCompiled,edition:n.edition}})):[]})}getWebApiDetails(e){return this.getHttpApiUrl("admin/ApiExplorer/inspect",{params:{appId:this.appId,zoneId:this.zoneId,path:e}})}getPredefinedTemplates(e,a){return this.fetchPromise("admin/AppFiles/GetTemplates",{params:{...e&&{purpose:e},...a&&{type:a}}})}getPreview(e,a,p){return this.getHttpApiUrl("admin/AppFiles/preview",{params:{appId:this.appId,path:e,templateKey:p,global:a}})}create(e,a,p){return this.http.post(this.apiUrl("admin/AppFiles/create"),{},{params:{appId:this.appId,global:a,purpose:"auto",path:e,templateKey:p}})}templateIdOrPath(e,a,p){if(/^[0-9]*$/g.test(e)){const i=p.find(n=>n.EntityId?.toString()===e&&n.IsShared===a)?.Path;return{templateId:e,...null!=i&&{path:i}}}return{path:e}}static{this.\u0275fac=(()=>{let e;return function(p){return(e||(e=v.xGo(t)))(p||t)}})()}static{this.\u0275prov=M.jDH({token:t,factory:t.\u0275fac})}}return t})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/21.00.00/dist/ng-edit/projects_eav-ui_src_app_app-administration_web-api-rest-api_web-api-rest-api_ts.cd808ed0656ced9e.js.map