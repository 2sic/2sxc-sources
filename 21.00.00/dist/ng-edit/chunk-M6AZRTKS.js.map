{
  "version": 3,
  "sources": ["projects/eav-ui/src/app/shared/interceptors/handle-errors.interceptor.ts"],
  "sourcesContent": ["import { HttpContextToken, HttpErrorResponse, HttpEvent, HttpHandler, HttpInterceptor, HttpRequest } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { catchError, Observable, throwError } from 'rxjs';\r\n\r\nexport const IGNORED_STATUSES = new HttpContextToken<number[]>(() => []);\r\n\r\n@Injectable()\r\nexport class HandleErrorsInterceptor implements HttpInterceptor {\r\n  /** URLs excluded from detailed error alert  */\r\n  private excludedUrls = [\r\n    'dist/ng-edit/i18n',\r\n  ];\r\n\r\n  constructor() { }\r\n\r\n  intercept(req: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\r\n    const ignoredStatuses = req.context.get(IGNORED_STATUSES);\r\n    return next.handle(req).pipe(\r\n\r\n      catchError((error: HttpErrorResponse) => {\r\n\r\n        // If Status is in the ignored list, just use the error custom im component (example: content-items.component 400 Error Deleting Item)\r\n        if (ignoredStatuses?.includes(error.status)) {\r\n          return throwError(() => error);\r\n        }\r\n\r\n        if (!this.checkIfExcluded(error.url)) {\r\n          this.showDetailedHttpError(error);\r\n        }\r\n        return throwError(error);\r\n      })\r\n    );\r\n  }\r\n\r\n  private checkIfExcluded(url: string) {\r\n    for (const excludedUrl of this.excludedUrls) {\r\n      if (url.includes(excludedUrl)) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  private showDetailedHttpError(error: HttpErrorResponse) {\r\n    let infoText = 'Had an error talking to the server (status ' + error.status + ').';\r\n    const srvResp = error.error;\r\n    if (srvResp) {\r\n      const msg = srvResp.Message;\r\n      if (msg)\r\n        infoText += '\\nMessage: ' + msg;\r\n      const msgDet = srvResp.MessageDetail || srvResp.ExceptionMessage;\r\n      if (msgDet)\r\n        infoText += '\\nDetail: ' + msgDet;\r\n\r\n      if (msgDet && msgDet.indexOf('No action was found') === 0) {\r\n        if (msgDet.indexOf('that matches the name') > 0)\r\n          infoText += '\\n\\nTip from 2sxc: you probably got the action-name wrong in your JS.';\r\n        else if (msgDet.indexOf('that matches the request.') > 0)\r\n          infoText += '\\n\\nTip from 2sxc: Seems like the parameters are the wrong amount or type.';\r\n      }\r\n\r\n      if (msg && msg.indexOf('Controller') === 0 && msg.indexOf('not found') > 0) {\r\n        infoText += '\\n\\nTip from 2sxc: you probably spelled the controller name wrong or forgot to remove the word \\'controller\\' from the call in JS. To call a controller called \\'DemoController\\' only use \\'Demo\\'.';\r\n      }\r\n      infoText += '\\n\\nif you are an advanced user you can learn more about what went wrong - discover how on 2sxc.org/help?tag=debug';\r\n    }\r\n\r\n    alert(infoText);\r\n  }\r\n}\r\n"],
  "mappings": "+DAIO,IAAMA,EAAmB,IAAIC,EAA2B,IAAM,CAAA,CAAE,EAG1DC,GAAuB,IAAA,CAA9B,MAAOA,CAAuB,CAMlCC,aAAA,CAJQ,KAAAC,aAAe,CACrB,mBAAmB,CAGL,CAEhBC,UAAUC,EAAuBC,EAAiB,CAChD,IAAMC,EAAkBF,EAAIG,QAAQC,IAAIV,CAAgB,EACxD,OAAOO,EAAKI,OAAOL,CAAG,EAAEM,KAEtBC,EAAYC,GAGNN,GAAiBO,SAASD,EAAME,MAAM,EACjCC,EAAW,IAAMH,CAAK,GAG1B,KAAKI,gBAAgBJ,EAAMK,GAAG,GACjC,KAAKC,sBAAsBN,CAAK,EAE3BG,EAAWH,CAAK,EACxB,CAAC,CAEN,CAEQI,gBAAgBC,EAAW,CACjC,QAAWE,KAAe,KAAKjB,aAC7B,GAAIe,EAAIJ,SAASM,CAAW,EAC1B,MAAO,GAGX,MAAO,EACT,CAEQD,sBAAsBN,EAAwB,CACpD,IAAIQ,EAAW,8CAAgDR,EAAME,OAAS,KACxEO,EAAUT,EAAMA,MACtB,GAAIS,EAAS,CACX,IAAMC,EAAMD,EAAQE,QAChBD,IACFF,GAAY;WAAgBE,GAC9B,IAAME,EAASH,EAAQI,eAAiBJ,EAAQK,iBAC5CF,IACFJ,GAAY;UAAeI,GAEzBA,GAAUA,EAAOG,QAAQ,qBAAqB,IAAM,IAClDH,EAAOG,QAAQ,uBAAuB,EAAI,EAC5CP,GAAY;;mEACLI,EAAOG,QAAQ,2BAA2B,EAAI,IACrDP,GAAY;;0EAGZE,GAAOA,EAAIK,QAAQ,YAAY,IAAM,GAAKL,EAAIK,QAAQ,WAAW,EAAI,IACvEP,GAAY;;6LAEdA,GAAY;;+GACd,CAEAQ,MAAMR,CAAQ,CAChB,iDA7DWpB,EAAuB,CAAA,iCAAvBA,EAAuB6B,QAAvB7B,EAAuB8B,SAAA,CAAA,CAAA,SAAvB9B,CAAuB,GAAA",
  "names": ["IGNORED_STATUSES", "HttpContextToken", "HandleErrorsInterceptor", "constructor", "excludedUrls", "intercept", "req", "next", "ignoredStatuses", "context", "get", "handle", "pipe", "catchError", "error", "includes", "status", "throwError", "checkIfExcluded", "url", "showDetailedHttpError", "excludedUrl", "infoText", "srvResp", "msg", "Message", "msgDet", "MessageDetail", "ExceptionMessage", "indexOf", "alert", "factory", "\u0275fac"]
}
