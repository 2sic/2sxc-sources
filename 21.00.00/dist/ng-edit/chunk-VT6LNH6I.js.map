{
  "version": 3,
  "sources": ["projects/eav-ui/src/app/edit/fields/field-state.ts", "projects/eav-ui/src/app/edit/form/form-config.service.ts", "projects/eav-ui/src/app/edit/shared/helpers/field-mask.helper.ts", "projects/eav-ui/src/app/edit/form/form-languages.model.ts", "projects/eav-ui/src/app/edit/localization/dimension-reader.ts", "projects/eav-ui/src/app/edit/localization/field-reader.ts", "projects/eav-ui/src/app/edit/state/fields-settings.helpers.ts", "projects/eav-ui/src/app/edit/shared/helpers/entity-reader.ts", "projects/eav-ui/src/app/edit/shared/adam/file-type.helpers.ts", "projects/eav-ui/src/app/edit/shared/input-types/input-field.helpers.ts", "projects/eav-ui/src/app/edit/fields/page-picker/page-picker.helpers.ts", "projects/eav-ui/src/app/edit/fields/page-picker/page-picker.ts", "projects/eav-ui/src/app/edit/fields/page-picker/page-picker.html", "projects/eav-ui/src/app/edit/fields/page-picker/page-picker.helper.ts", "projects/eav-ui/src/app/edit/shared/helpers/sanitize.helper.ts", "projects/eav-ui/src/app/edit/shared/store/signal-store-base.ts", "projects/eav-ui/src/app/edit/shared/store/signal-store-observable-base.ts", "projects/eav-ui/src/app/edit/form/form-language.service.ts"],
  "sourcesContent": ["import { effect, Injector, Signal } from '@angular/core';\r\nimport { UntypedFormGroup } from '@angular/forms';\r\nimport { Of } from '../../../../../core';\r\nimport { BasicControlSettings } from '../../../../../edit-types/src/BasicControlSettings';\r\nimport { FieldSettings } from '../../../../../edit-types/src/FieldSettings';\r\nimport { FieldValue } from '../../../../../edit-types/src/FieldValue';\r\nimport { FeatureNames } from '../../features/feature-names';\r\nimport { FeaturesService } from '../../features/features.service';\r\nimport { computedObj, signalObj } from '../../shared/signals/signal.utilities';\r\nimport { TranslationState } from '../localization/translate-state.model';\r\nimport { UiControl } from '../shared/controls/ui-control';\r\nimport { FieldConfigSet } from './field-config-set.model';\r\nimport { PickerData } from './picker/picker-data';\r\n\r\n/**\r\n * This is provided / injected at the fields-builder for every single field.\r\n * So any control or service within that field, which requests this service, will get one containing exactly that fields.\r\n */\r\nexport class FieldState<TValue extends FieldValue = FieldValue, TSettings extends FieldSettings = FieldSettings> {\r\n  constructor(\r\n    /** The fields technical name to access settings etc. */\r\n    public name: string,\r\n\r\n    /** Field configuration, incl. a lot of unchanging values and access to adam, dropzone etc. */\r\n    public config: FieldConfigSet,\r\n\r\n    /** The form group containing the field - rarely relevant, as you should use the control in most cases */\r\n    public group: UntypedFormGroup,\r\n\r\n    // TODO: @2pp try to find out where this is used just to create a signal for a property\r\n    /** The settings as a signal - use this for most cases */\r\n    public settings: Signal<TSettings>,\r\n\r\n    /** The basic settings - use this for most cases as it will change less than the settings signal */\r\n    public basics: Signal<BasicControlSettings>,\r\n\r\n    /**\r\n     * The UI control (actually it's the virtual UI control), since it's a reactive form control.\r\n     * Note: e just introduced uiValue below, which should be used in most cases\r\n     */\r\n    public ui: Signal<UiControl>,\r\n\r\n    /** The value of the field in the UI control as a signal */\r\n    public uiValue: Signal<TValue>,\r\n\r\n    public translationState: Signal<TranslationState>,\r\n\r\n    /** Signal if a dialog (popup) of this field is open, like a hyperlink-dialog */\r\n    public isOpen: Signal<boolean>,\r\n\r\n    pickerData: PickerData,\r\n\r\n    featuresSvc: FeaturesService,\r\n\r\n    injectorForEffects: Injector,\r\n  ) {\r\n    this.#pickerData = pickerData;\r\n\r\n    // Required Features Transfer\r\n    effect(() => {\r\n      const reqFeaturesFromSettings = this.requiredFeatures();\r\n      if (reqFeaturesFromSettings.length == 0)\r\n        return;\r\n      for (const feature of reqFeaturesFromSettings)\r\n        featuresSvc.requireFeature(feature, `Used in field ${this.name}`);\r\n    }, { injector: injectorForEffects });\r\n\r\n  }\r\n\r\n  /**\r\n   * Picker Data - will throw an error if accessed on a field which doesn't have PickerData\r\n   * @readonly\r\n   * @type {PickerData}\r\n   */\r\n  get pickerData(): PickerData {\r\n    if (this.#pickerData)\r\n      return this.#pickerData;\r\n    throw new Error(`PickerData was not initialized for the field: ${this.name}`);\r\n  }\r\n  #pickerData: PickerData;\r\n\r\n  /**\r\n   * Cool helper to just get a single value-signal from the settings.\r\n   * It will automatically\r\n   * - ensure that you only use valid keys\r\n   * - return a signal with that name\r\n   * - the signal will be correctly typed as the setting value is typed\r\n   * @param name property name of a FieldSettings\r\n   * @returns the signal for that property, with isEqual change detection and name\r\n   */\r\n  setting<K extends keyof FieldSettings>(name: K): Signal<FieldSettings[K]> {\r\n    return computedObj(name as string, () => this.settings()[name]);\r\n  }\r\n\r\n  settingExt<K extends keyof TSettings>(name: K): Signal<TSettings[K]> {\r\n    return computedObj(name as string, () => this.settings()[name]);\r\n  }\r\n\r\n  // settingExt<TSet extends FieldSettings, K extends keyof TSet>(name: K): Signal<TSet[K]> {\r\n  //   return computedObj(name as string, () => (this.settings() as unknown as TSet)[name]);\r\n  // }\r\n\r\n  //#region Required Features\r\n\r\n  #reqFeaturesMy = signalObj<Of<typeof FeatureNames>[]>('requiredFeatures', []);\r\n  #reqFeaturesFromSettings = this.setting('requiredFeatures');\r\n\r\n  requiredFeatures = computedObj('requiredFeatures', () => {\r\n    const merged = [\r\n      ...this.#reqFeaturesMy(),\r\n      ...this.#reqFeaturesFromSettings() ?? [],\r\n    ];\r\n    // make distinct\r\n    return Array.from(new Set(merged));\r\n  });\r\n\r\n  requireFeature(feature: Of<typeof FeatureNames>) {\r\n    const current = this.#reqFeaturesMy();\r\n    if (!current.includes(feature))\r\n      this.#reqFeaturesMy.set([...current, feature]);\r\n  }\r\n\r\n  //#endregion\r\n\r\n  //#region Detectors for Showing-Default-When-Custom-Not-Found\r\n\r\n  /**\r\n   * The [typename]-default is also used when a custom [typename]-* is not found.\r\n   * So the *-default fields will use this to have a value if they are being shown in the fallback scenario.\r\n   * Otherwise the result will be null/empty/falsy.\r\n   * @param correctNames The correct type names which are not fallbacks\r\n   */\r\n  isNotExpectedType(correctNames: string[]): Signal<string | null> {\r\n    return computedObj('isFallbackForField', () => {\r\n      const inputType = this.settings().InputType;\r\n      return correctNames.includes(inputType)\r\n        ? null\r\n        : inputType || null; // make sure falsy values are null\r\n    });\r\n  }\r\n\r\n  //#endregion\r\n}\r\n", "import { Injectable, Signal, inject, signal } from '@angular/core';\r\nimport { Observable } from 'rxjs';\r\nimport { DialogContext } from '../../app-administration/models';\r\nimport { keyPartOfPage, keyPublishing, keySettings, partOfPageDefault } from '../../shared/constants/session.constants';\r\nimport { classLog } from '../../shared/logging';\r\nimport { Context } from '../../shared/services/context';\r\nimport { EditSettings } from '../dialog/main/edit-dialog-main.models';\r\nimport { FormConfiguration, VersioningOptions } from './form-configuration.model';\r\nimport { FormLanguageService } from './form-language.service';\r\nimport { FormLanguageComplete, FormLanguagesConfig } from './form-languages.model';\r\n\r\n/**\r\n * Service which tell us about a single edit-form configuration.\r\n * It contains multiple entities.\r\n *\r\n * Things such as language, IDs shown on it, edit-settings etc.\r\n */\r\n@Injectable()\r\nexport class FormConfigService {\r\n  \r\n  log = classLog({FormConfigService});\r\n  \r\n  /** no constructor */\r\n  constructor() { }\r\n\r\n  /**\r\n   * Important! These are constants that form was loaded with.\r\n   * They are initialized in the main edit-form.\r\n   * They do not change while form is running\r\n   */\r\n  config: FormConfiguration;\r\n\r\n  // WIP, null at first\r\n  configSignal = signal<FormConfiguration>(null);\r\n\r\n  /**\r\n   * Current form language information\r\n   */\r\n  language: Signal<FormLanguageComplete>;\r\n\r\n  /**\r\n   * Current edit settings\r\n   * Note: Clean use - only used by classes that inject this themselves\r\n   */\r\n  settings: EditSettings;\r\n\r\n  /**\r\n   * Form language configuration, not meant to change during runtime...\r\n   */\r\n  languages: FormLanguagesConfig;\r\n\r\n  /** Used to fetch form data and fill up eavConfig. Do not use anywhere else */\r\n  private context = inject(Context);\r\n  private languageService = inject(FormLanguageService);\r\n\r\n  /** Create EavConfiguration from sessionStorage */\r\n  initFormConfig(\r\n    dialogContext: DialogContext,\r\n    formId: number,\r\n    isParentDialog: boolean,\r\n    itemGuids: string[],\r\n    createMode: boolean,\r\n    isCopy: boolean,\r\n    enableHistory: boolean,\r\n    settings: EditSettings\r\n  ) {\r\n    this.settings = settings;\r\n    this.languages = {\r\n      initial: dialogContext.Language.Current,\r\n      primary: dialogContext.Language.Primary,\r\n      list: dialogContext.Language.List,\r\n    };\r\n\r\n\r\n    const saveSettingsFromUrl = sessionStorage.getItem(keySettings);\r\n    const saveSettingsData = saveSettingsFromUrl ? JSON.parse(saveSettingsFromUrl) : null as {\r\n      save: string | boolean;\r\n    } | null;\r\n    const saveValue = saveSettingsData?.save;\r\n    const save = (saveValue == null)\r\n      ? { mode: true }\r\n      : (saveValue === 'false' || saveValue === false)\r\n        ? { mode: false }\r\n        : { mode: true, path: saveValue };\r\n\r\n    // console.log('2dm:save mode', save);\r\n    this.config = {\r\n      zoneId: this.context.zoneId,\r\n      appId: this.context.appId,\r\n      appRoot: dialogContext.App.Url,\r\n      appSharedRoot: dialogContext.App.SharedUrl,\r\n      moduleId: this.context.moduleId?.toString(),\r\n      partOfPage: sessionStorage.getItem(keyPartOfPage) ?? partOfPageDefault,\r\n      portalRoot: dialogContext.Site.Url,\r\n      tabId: this.context.tabId?.toString(),\r\n      systemRoot: window.location.pathname.split('/dist/')[0] + '/',\r\n      versioningOptions: this.getVersioningOptions(\r\n        sessionStorage.getItem(keyPartOfPage) === 'true',\r\n        sessionStorage.getItem(keyPublishing)\r\n      ),\r\n      formId,\r\n      isParentDialog,\r\n      itemGuids,\r\n      createMode,\r\n      isCopy,\r\n      enableHistory,\r\n      enableFormulaSave: dialogContext.Enable.FormulaSave ?? false,\r\n      removeEditRestrictions: dialogContext.Enable.OverrideEditRestrictions ?? false,\r\n      dialogContext,\r\n      settings,\r\n      save,\r\n    };\r\n    this.configSignal.set(this.config);\r\n    this.language = this.languageService.getSignal(this.config.formId);\r\n  }\r\n\r\n  private getVersioningOptions(\r\n    partOfPage: boolean,\r\n    publishing: string\r\n  ): VersioningOptions {\r\n\r\n    const allowAll: VersioningOptions = { show: true, hide: true, branch: true };\r\n\r\n    if (!partOfPage)\r\n      return allowAll;\r\n\r\n    const publish = publishing || '';\r\n    switch (publish) {\r\n      case '':\r\n      case 'DraftOptional':\r\n        return allowAll;\r\n      case 'DraftRequired':\r\n        // Note: the key 'show' should not be added, as the code later picks the first property to set the default\r\n        // Branch should also be first, as it's the preferred option\r\n        return { branch: true, hide: true };\r\n      case 'DraftForbidden':\r\n        return { show: true };\r\n      default: {\r\n        console.error(`Invalid versioning requirements: ${publish}`);\r\n        return {};\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get the language observable for the form - it will keep track of the current language as it changes.\r\n   */\r\n  get language$(): Observable<FormLanguageComplete> {\r\n    return this._language$ ??= this.languageService.getLanguage$(this.config.formId);\r\n  }\r\n  private _language$: Observable<FormLanguageComplete>;\r\n\r\n}\r\n", "import { Injectable, Injector, Signal, computed, effect, inject, signal } from '@angular/core';\r\nimport { IFieldMask } from '../../../../../../edit-types/src/IFieldMask';\r\nimport { classLog } from '../../../shared/logging';\r\nimport { ServiceBase } from '../../../shared/services/service-base';\r\nimport { FieldState } from '../../fields/field-state';\r\nimport { FormConfigService } from '../../form/form-config.service';\r\n\r\nconst logSpecs = {\r\n  all: false,\r\n  initSignal: false,\r\n  watchAllFields: true,\r\n}\r\n\r\nconst dataPrefix = 'data';\r\nconst FieldsFindNoPrefix = /\\[.*?\\]/ig;\r\nconst FieldsFindPrefix = /\\[[a-zA-Z]+\\:.*?\\]/ig;\r\nconst FieldUnwrap = /[\\[\\]]/ig;\r\n\r\n/**\r\n * Create a new FieldMask instance and access result with resolve\r\n * @example\r\n * const mask = new FieldMask(\"[FirstName]\", formGroup.controls);\r\n * const maskValue = mask.resolve();\r\n *\r\n * @param mask a string like \"[FirstName] [LastName]\"\r\n * @param model usually FormGroup controls, passed into here\r\n * @param overloadPreCleanValues a function which will \"scrub\" the found field-values\r\n */\r\n\r\n@Injectable()\r\nexport class FieldMask extends ServiceBase implements IFieldMask /* for field-change subscription */ {\r\n  \r\n  log = classLog({FieldMask}, logSpecs);\r\n\r\n  #fieldState = inject(FieldState);\r\n  #formConfig = inject(FormConfigService);\r\n\r\n  constructor(private injector: Injector) {\r\n    super();\r\n    this.log.a('constructor');\r\n  }\r\n\r\n  /**\r\n   * The result of the mask as a signal, for external use/subscribing.\r\n   */\r\n  public result = signal<string>('');\r\n\r\n  #controls = this.#fieldState.group.controls;\r\n  #fieldConfig = this.#fieldState.config;\r\n  #requirePrefix = false;\r\n\r\n  /**\r\n   * The mask as a signal.\r\n   * This allows us to use a simple value or a possibly runtime-changing mask. \r\n   */\r\n  #maskSignal = signal<Signal<string>>(signal<string>(''));\r\n\r\n  /**\r\n   * The final mask to use - either picking the signal or the text\r\n   * TODO: we should be able to simplify this to just use a signal\r\n   */\r\n  #mask = computed(() => this.#maskSignal()());\r\n\r\n  /** Fields used in the mask */\r\n  #fieldsUsedInMask = computed(() => this.#extractFieldNames(this.#mask()));\r\n\r\n  // #fieldValuesSignals = inject(FieldsSettingsService).fieldValues;\r\n\r\n  // // TODO create a multi-field signal?\r\n\r\n  // public result2 = computed(() => {\r\n  //   // listen to all the fields for changes\r\n  //   this.#fieldsUsedInMask().forEach(field => {\r\n\r\n  //   });\r\n  // });\r\n\r\n\r\n  /**\r\n   * Attach any processing events before the mask is resolved the first time\r\n   */\r\n  public initPreClean(overloadPreCleanValues: (key: string, value: string) => string): this {\r\n    this.log.a('initPreClean');\r\n    this.preClean = overloadPreCleanValues;\r\n    return this;\r\n  }\r\n\r\n  public init(name: string, mask: string, requirePrefix: boolean = false): this {\r\n    return this.initSignal(name, signal(mask));\r\n  }\r\n\r\n  public initSignal(name: string, mask: Signal<string>): this {\r\n    this.log.extendName(`-${name}`);\r\n    const l = this.log.fnIf('initSignal', { name, mask });\r\n    this.#maskSignal.set(mask);\r\n    this.#updateMaskFinal();\r\n    return l.r(this, 'first result:' + this.result());\r\n  }\r\n\r\n  /**\r\n   * Activate an aggressive change logger to debug what's happening.\r\n   * Should only be used in development, as it will log a lot of data to the console.\r\n   */\r\n  public logChanges(): this {\r\n    // use logger, but if not enabled, create new just for this\r\n    const l = this.log.enabled ? this.log : classLog({FieldMask});\r\n    effect(() => l.a(`Mask '${this.#mask()}' value changed to: ${this.result()}`), { injector: this.injector });\r\n    return this;\r\n  }\r\n\r\n  #updateMaskFinal() {\r\n    // bind auto-watch only if needed...\r\n    // otherwise it's just on-demand\r\n    this.#watchAllFields();\r\n    this.#onChange();\r\n  }\r\n\r\n\r\n\r\n  /**\r\n   * Process a mask to the get the final value\r\n   */\r\n  #process(): string {\r\n\r\n    // if no mask, exit early\r\n    if (!hasPlaceholders(this.#mask()))\r\n      return this.#mask();\r\n\r\n    let value = lowercaseInsideSquareBrackets(this.#mask());\r\n\r\n    // If we have form info (which we usually do), replace the placeholders\r\n    if (this.#formConfig != null)\r\n      value = value\r\n        .replace('[app:appid]', this.#formConfig.config.appId.toString())\r\n        .replace('[app:zoneid]', this.#formConfig.config.zoneId.toString());\r\n\r\n    // If we have field info (which we usually do), replace the placeholders\r\n    if (this.#fieldConfig != null)\r\n      value = value\r\n        .replace('[guid]', this.#fieldConfig.entityGuid)\r\n        .replace('[data:guid]', this.#fieldConfig.entityGuid)\r\n        .replace('[id]', this.#fieldConfig.entityId.toString())\r\n        .replace('[data:id]', this.#fieldConfig.entityId.toString());\r\n\r\n    const dataPlaceholders = this.#fieldsUsedInMask().data;\r\n    if (!dataPlaceholders)\r\n      return value;\r\n\r\n    dataPlaceholders.forEach((e, i) => {\r\n      const replaceValue = this.#controls?.[e]?.value ?? '';\r\n      const cleaned = this.preClean(e, replaceValue);\r\n      // New with prefix 'data:'\r\n      value = value.replace('[data:' + e.toLowerCase() + ']', cleaned);\r\n      // Old without prefix - only if allowed (for compatibility)\r\n      value = value.replace('[' + e.toLowerCase() + ']', cleaned);\r\n    });\r\n    return value;\r\n  }\r\n\r\n  /** Retrieves a list of all fields used in the mask */\r\n  #extractFieldNames(mask: string): Record<string, string[]> {\r\n    // exit early if mask very simple or not a mask\r\n    if (!mask || !hasPlaceholders(mask))\r\n      return {};\r\n\r\n    const matches = mask.match(FieldsFindNoPrefix);\r\n    \r\n    if (!matches)\r\n      return {};\r\n    \r\n    const fields: string[] = matches.map(token => token.replace(FieldUnwrap, ''));\r\n    return { data: fields };\r\n  }\r\n\r\n  /**\r\n   * Default preClean function, if no other function was specified for this\r\n   * Will be replaced if need be.\r\n   */\r\n  private preClean(key: string, value: string): string { return value; }\r\n\r\n  /** Change-event - will only fire if it really changes */\r\n  #onChange() {\r\n    const maybeNew = this.#process();\r\n    this.result.set(maybeNew);\r\n  }\r\n\r\n  /**\r\n   * Add watcher and execute onChange.\r\n   * Uses observables, since that's what angular provides on valueChanges.\r\n   */\r\n  #watchAllFields() {\r\n    const l = this.log.fnIf('watchAllFields');\r\n    const dataPlaceholders = this.#fieldsUsedInMask().data;\r\n    if (!dataPlaceholders)\r\n      return l.end('no data placeholders');\r\n\r\n    // add a watch for each field in the field-mask\r\n    const controls = dataPlaceholders\r\n      .map(f => this.#controls[f])\r\n      .filter(f => f != null);\r\n\r\n    if (controls.length == 0)\r\n      return l.end('no fields to watch');\r\n\r\n    controls.forEach(c => this.subscriptions.add(c.valueChanges.subscribe(_ => this.#onChange())));\r\n    l.end();\r\n  }\r\n}\r\n\r\n\r\nfunction hasPlaceholders(mask: string): boolean {\r\n  return (mask ?? '').includes('[');\r\n}\r\n\r\n/** used for query parameters */\r\nfunction lowercaseInsideSquareBrackets(value: string) {\r\n  return value.replace(/\\[([^\\]]+)\\]/g, (_, group) => `[${group.toLowerCase()}]`);\r\n}\r\n", "import { Language } from '../../shared/models/language.model';\r\n\r\nexport { Language } from '../../shared/models/language.model';\r\n\r\nexport class FormLanguage\r\n{\r\n  /** The current language of the system / UI. */\r\n  current: string;\r\n\r\n  /** The primary language of the system.\r\n   * Important, because the primary language must be filled in before all other languages.\r\n   */\r\n  primary: string;\r\n\r\n  /**\r\n   * In some cases we want both to be primary, but it's not clear why.\r\n   * I think it's just because we want certain tests to only use one value, but the test is meant for 2 values.\r\n   */\r\n  static bothPrimary(original: FormLanguage): FormLanguage {\r\n    return {\r\n      current: original.primary,\r\n      primary: original.primary\r\n    };\r\n  }\r\n\r\n  static diffCurrent(original: FormLanguage, current: string): FormLanguage {\r\n    return {\r\n      current: current,\r\n      primary: original.primary\r\n    };\r\n  }\r\n\r\n  static empty(): FormLanguageComplete {\r\n    return {\r\n      current: '',\r\n      primary: '',\r\n      initial: '',\r\n    };\r\n  }\r\n}\r\n\r\nexport class FormLanguageComplete extends FormLanguage {\r\n  /** initial language of the UI */\r\n  initial: string;\r\n}\r\n\r\nexport interface FormLanguagesConfig\r\n{\r\n  initial: string;\r\n  primary: string;\r\n  list: Language[];\r\n}\r\n\r\n", "import { FormLanguage } from '../form/form-languages.model';\r\nimport { EavDimension } from '../shared/models/eav';\r\n\r\n\r\nexport class DimensionReader {\r\n  constructor(private dimensions: EavDimension[], private language: FormLanguage) { }\r\n\r\n  get hasCurrentWrite(): boolean {\r\n    const match = this.dimensions.find(d => d.dimCode === this.language.current\r\n      || (this.language.current === this.language.primary && d.dimCode === '*'));\r\n    return !!match;\r\n  }\r\n\r\n  get hasCurrentReadOnly(): boolean {\r\n    const currentRO = `~${this.language.current}`;\r\n    return this.dimensions.find(d => d.dimCode === currentRO) !== undefined;\r\n  }\r\n\r\n  get hasCurrent(): boolean {\r\n    const match = this.dimensions.find(d => d.dimCode === this.language.current\r\n      || d.dimCode === `~${this.language.current}`\r\n      || (this.language.current === this.language.primary && d.dimCode === '*'));\r\n    return !!match;\r\n  }\r\n}\r\n", "import { classLog } from '../../shared/logging';\r\nimport { FormLanguage } from '../form/form-languages.model';\r\nimport { EavField, EavFieldValue } from '../shared/models/eav';\r\nimport { DimensionReader } from './dimension-reader';\r\n\r\nconst logSpecs = {\r\n  all: false,\r\n  constructor: false,\r\n};\r\n\r\nexport class FieldReader<T = any> {\r\n  \r\n  log = classLog({FieldReader}, logSpecs);\r\n\r\n  constructor(field: EavField<T>, language: string);\r\n  constructor(field: EavField<T>, language: FormLanguage);\r\n  constructor(field: EavField<T>, language: FormLanguage | string) {\r\n    this.log.fnIf('constructor', { field, language });\r\n    this.#field = field;\r\n    this.#language = typeof language === 'string' ? { current: language, primary: language } : language;\r\n    this.#values = field?.Values ?? [];\r\n    this.#noData = !field || !field.Values || field.Values.length === 0;\r\n  }\r\n\r\n  #noData = true;\r\n\r\n  #field: EavField<T>;\r\n  /** Values - never empty for read-safety */\r\n  #values: EavFieldValue<T>[];\r\n  #language: FormLanguage;\r\n\r\n  get current(): EavFieldValue<T> | null {\r\n    return this.ofLanguage(this.#language); // first match if any is the one we're looking for\r\n  }\r\n\r\n  /**\r\n   *\r\n   * Priority:\r\n   * 1. value for current language\r\n   * 2. value for all languages\r\n   * 3. value for default language\r\n   *\r\n   * @readonly\r\n   * @type {EavFieldValue<T>}\r\n   * @memberof FieldReader\r\n   */\r\n  get currentOrDefault(): EavFieldValue<T> {\r\n    if (this.#noData) return null;\r\n    return this.current\r\n      // note that having both languages primary will also result in checking the '*' dimension\r\n      ?? this.ofLanguage(FormLanguage.bothPrimary(this.#language));\r\n  }\r\n\r\n  /**\r\n   * Priority:\r\n   * 1. value for current language\r\n   * 2. value for all languages\r\n   * 3. value for default language\r\n   * 4. first/any value in the system\r\n   */\r\n  get currentOrDefaultOrAny(): EavFieldValue<T> | null {\r\n    if (this.#noData) return null;\r\n    return this.currentOrDefault ?? this.#values[0] ?? null;\r\n  }\r\n\r\n\r\n  ofLanguage(language: FormLanguage): EavFieldValue<T> | null {\r\n    if (this.#noData) return null;\r\n    return this.#values.filter(val => new DimensionReader(val.dimensions, language).hasCurrent)[0] ?? null;\r\n  }\r\n\r\n  /** Check if there is a value on the specified primary language or on the '*' dimension */\r\n  get hasPrimary(): boolean {\r\n    if (this.#noData) return false;\r\n    const primary = this.#language.primary;\r\n    return this.#values.filter(val => val.dimensions.find(d => d.dimCode === primary || d.dimCode === '*')).length > 0;\r\n  }\r\n\r\n  get hasCurrentReadonly(): boolean {\r\n    if (this.#noData) return false;\r\n    return this.#values.filter(val => new DimensionReader(val.dimensions, this.#language).hasCurrentReadOnly).length > 0;\r\n  }\r\n\r\n  /** A value in specified Language is editable, if assigned to current language or to '*' (but only when on default-language) */\r\n  get hasEditableValues(): boolean {\r\n    if (this.#noData) return false;\r\n    return this.#valuesEditableOf().length > 0;\r\n  }\r\n\r\n  /** Number of editable translatable fields that */\r\n  countEditable(): number {\r\n    return this.#valuesEditableOf().length;\r\n  }\r\n\r\n  /** Number of editable translatable fields that have some content (not empty/null) */\r\n  countEditableWithContents(): number {\r\n    return this.#valuesEditableOf().filter(v => v.value != \"\" && v.value != null)?.length;\r\n  }\r\n\r\n  /**\r\n   * Values of a field are for the current language,\r\n   * if they are assigned to the current language or to '*' (but only when the current-language is also the primary-language)\r\n   */\r\n  #valuesEditableOf(language?: FormLanguage): EavFieldValue<T>[] {\r\n    if (this.#noData) return [];\r\n    language ??= this.#language;\r\n    return this.#values.filter(val => new DimensionReader(val.dimensions, language).hasCurrentWrite);\r\n  }\r\n\r\n  /** Value of current language which is editable. `null` if not found. */\r\n  get currentEditable(): EavFieldValue<T> {\r\n    if (this.#noData) return null;\r\n    const dimension = this.#language.current;\r\n    return this.#values.find(v => v.dimensions.find(x => x.dimCode === dimension)) ?? null;\r\n  }\r\n\r\n  isEditableOrReadonlyTranslationExist(): boolean {\r\n    if (this.#noData) return false;\r\n    return this.#valuesEditableOf().length > 0;\r\n  }\r\n\r\n}\r\n", "import { ItemIdentifierEditConfig } from '../../shared/models/edit-form.model';\r\nimport { FormLanguage } from '../form/form-languages.model';\r\nimport { FieldReader } from '../localization/field-reader';\r\nimport { EntityReader } from '../shared/helpers';\r\nimport { EavContentType } from '../shared/models/eav';\r\nimport { ContentTypeSettings } from './content-type-settings.model';\r\n\r\nexport class ContentTypeSettingsHelpers {\r\n\r\n  /**\r\n   * Initialize the default settings of a ContentType to ensure everything is set or empty-string etc.\r\n   * @returns \r\n   */\r\n  static getDefaultSettings(reader: EntityReader, contentType: EavContentType, itemHeader: ItemIdentifierEditConfig): ContentTypeSettings {\r\n    const metadata = reader.flatten<ContentTypeSettings>(contentType.Metadata);\r\n    const defaultSettings = { ...metadata };\r\n    defaultSettings.Description ??= '';\r\n    defaultSettings.EditInstructions ??= '';\r\n    defaultSettings.Features ??= '';\r\n    defaultSettings.Label ??= '';\r\n    defaultSettings.ListInstructions ??= '';\r\n    defaultSettings.Notes ??= '';\r\n    defaultSettings.Icon ??= '';\r\n    defaultSettings.Link ??= '';\r\n    defaultSettings._itemTitle = this.getTitle(contentType, reader);\r\n    defaultSettings._slotCanBeEmpty = itemHeader.IsEmptyAllowed ?? false;\r\n    defaultSettings._slotIsEmpty = itemHeader.IsEmpty ?? false;\r\n    return defaultSettings;\r\n  }\r\n\r\n  static getTitle(contentType: EavContentType, language: FormLanguage): string {\r\n    try {\r\n      // xx ContentType is a historic bug and should be fixed when JSONs are rechecked\r\n      const type = contentType.Metadata.find(metadata => metadata.Type.Name === 'ContentType' || metadata.Type.Name === 'xx ContentType');\r\n      let label = (type)\r\n        ? new FieldReader(type.Attributes.Label, language).currentOrDefault?.value\r\n        : null;\r\n      label = label || contentType.Name;\r\n      return label;\r\n    } catch (error) {\r\n      return contentType.Name;\r\n    }\r\n  }\r\n\r\n}\r\n\r\n\r\n", "import { classLog } from '../../../shared/logging';\r\nimport { FormLanguage } from '../../form/form-languages.model';\r\nimport { FieldReader } from '../../localization/field-reader';\r\nimport { ItemValuesOfLanguage } from '../../state/item-values-of-language.model';\r\nimport { EavEntity, EavEntityAttributes, EavField } from '../models/eav';\r\n\r\nconst logSpecs = {\r\n  all: false,\r\n  constructor: false,\r\n};\r\n\r\nexport class EntityReader implements FormLanguage {\r\n\r\n  log = classLog({ EntityReader }, logSpecs);\r\n\r\n  /** @inheritdoc */\r\n  public current: string;\r\n  /** @inheritdoc */\r\n  public primary: string;\r\n\r\n  constructor(formLanguage: FormLanguage);\r\n  constructor(current: string, primary: string);\r\n  constructor(current: FormLanguage | string, primary?: string) {\r\n    this.log.fnIf('constructor', { current, primary });\r\n    if (typeof current === 'string') {\r\n      this.current = current;\r\n      this.primary = primary;\r\n    } else {\r\n      this.current = current.current;\r\n      this.primary = current.primary;\r\n    }\r\n  }\r\n\r\n  // WIP - to make code clearer, this is what should be used from now on\r\n  // But we'll probably end up calling this from the EntityReader only, so it should be straight forward\r\n  getBestValue<T>(attributeValues: EavField<T>, defaultValue: T = null): T {\r\n    const fieldReader = new FieldReader<T>(attributeValues, this);\r\n    return fieldReader.currentOrDefaultOrAny?.value ?? defaultValue;\r\n    // return LocalizationHelpers.translate<T>(this, attributeValues as EavField<T>, defaultValue);\r\n  }\r\n\r\n  public flatten<T>(metadata: EavEntity | EavEntity[]): T {\r\n    if (metadata == null)\r\n      return {} as T;\r\n\r\n    const metadataItems = Array.isArray(metadata) ? metadata : [metadata];\r\n    if (metadataItems.length === 0 || metadataItems[0] == null)\r\n      return {} as T;\r\n\r\n    const merged: Record<string, any> = {};\r\n    // copy metadata settings which are not @All\r\n    for (const item of metadataItems) {\r\n      if (item.Type.Id === '@All') continue;\r\n\r\n      for (const [name, values] of Object.entries(item.Attributes)) {\r\n        const value = this.getBestValue(values);\r\n        merged[name] = value;\r\n      }\r\n    }\r\n\r\n    // copy @All metadata settings, overwriting previous settings\r\n    for (const item of metadataItems) {\r\n      if (item.Type.Id !== '@All') continue;\r\n\r\n      for (const [name, values] of Object.entries(item.Attributes)) {\r\n        const value = this.getBestValue(values);\r\n        // do not overwrite previous settings if @All is empty\r\n        const exists = merged[name] != null;\r\n        const emptyAll = value == null || value === '';\r\n        if (exists && emptyAll) continue;\r\n\r\n        merged[name] = value;\r\n      }\r\n    }\r\n\r\n    return merged as T;\r\n  }\r\n\r\n  currentValues(itemAttributes: EavEntityAttributes): ItemValuesOfLanguage {\r\n    const formValues: ItemValuesOfLanguage = Object.entries(itemAttributes)\r\n      .reduce((acc, [name, values]) => {\r\n        acc[name] = this.getBestValue(values);\r\n        return acc;\r\n      }, {} as ItemValuesOfLanguage);\r\n    return formValues;\r\n  }\r\n}\r\n", "export class FileTypeHelpers {\r\n  private static defaultIcon = 'file';\r\n  private static customExtensions: Record<string, string> = {\r\n    doc: 'file-word',\r\n    docx: 'file-word',\r\n    xls: 'file-excel',\r\n    xlsx: 'file-excel',\r\n    ppt: 'file-powerpoint',\r\n    pptx: 'file-powerpoint',\r\n    pdf: 'file-pdf',\r\n    mp3: 'file-audio',\r\n    avi: 'file-video',\r\n    mpg: 'file-video',\r\n    mpeg: 'file-video',\r\n    mov: 'file-video',\r\n    mp4: 'file-video',\r\n    zip: 'file-archive',\r\n    rar: 'file-archive',\r\n    txt: 'file-text',\r\n    html: 'file-code',\r\n    css: 'file-code',\r\n    xml: 'file-code',\r\n    xsl: 'file-code',\r\n  };\r\n  private static matExtensions: Record<string, string> = {\r\n    vcf: 'person',\r\n  };\r\n\r\n  static getExtension(filename: string) {\r\n    return filename.substring(filename.lastIndexOf('.') + 1).toLocaleLowerCase();\r\n  }\r\n\r\n  static getIconClass(filename: string) {\r\n    const ext = this.getExtension(filename);\r\n    return this.matExtensions[ext] || this.customExtensions[ext] || this.defaultIcon;\r\n  }\r\n\r\n  static isKnownType(filename: string) {\r\n    return this.matExtensions[this.getExtension(filename)] != null;\r\n  }\r\n\r\n  static isImage(filename: string) {\r\n    return this.isImgRegex().test(filename);\r\n  }\r\n\r\n  private static isImgRegex() {\r\n    return /(?:([^:\\/?#]+):)?(?:\\/\\/([^\\/?#]*))?([^?#]*\\.(?:jpg|jpeg|gif|png|webp))(?:\\?([^#]*))?(?:#(.*))?/i;\r\n  }\r\n}\r\n", "import { Of } from '../../../../../../core';\r\nimport { FieldSettings } from '../../../../../../edit-types/src/FieldSettings';\r\nimport { FieldValue } from '../../../../../../edit-types/src/FieldValue';\r\nimport { InputTypeCatalog } from '../../../shared/fields/input-type-catalog';\r\nimport { classLog } from '../../../shared/logging';\r\nimport { ItemIdentifierShared } from '../../../shared/models/edit-form.model';\r\n\r\n/**\r\n * Get the field initial / default value, incl. the prefilled value if available.\r\n */\r\nexport class FieldDefaults {\r\n\r\n  log = classLog({FieldDefaults});\r\n\r\n  constructor(\r\n    private name: string,\r\n    private inputType: Of<typeof InputTypeCatalog>,\r\n    private settings: FieldSettings,\r\n    private itemHeader?: Pick<ItemIdentifierShared, \"Prefill\">,\r\n  ) { }\r\n\r\n  /** Include itemHeader if you need data from prefill, and set onlyPrefill if you only need parsed prefill */\r\n  getDefaultOrPrefillValue(onlyPrefill?: boolean): FieldValue {\r\n\r\n    const inputType = this.inputType;\r\n    const name = this.name;\r\n    const settings = this.settings;\r\n    const itemHeader = this.itemHeader;\r\n    const l = this.log.fn('parseDefaultValue', { name, inputType, settings, itemHeader, onlyPrefill });\r\n\r\n    const prefillRaw = itemHeader?.Prefill?.[name];\r\n    if (onlyPrefill && prefillRaw === undefined)\r\n      return l.rNull('only prefill, but no prefill data found');\r\n\r\n    let defaultValue = prefillRaw?.toString() ?? settings.DefaultValue;\r\n\r\n    l.values({ defaultValue });\r\n\r\n    switch (inputType) {\r\n      case InputTypeCatalog.BooleanDefault:\r\n        return defaultValue?.toLowerCase() === 'true';\r\n      case InputTypeCatalog.BooleanTristate:\r\n        return defaultValue != null && defaultValue !== ''\r\n          ? defaultValue.toLowerCase() === 'true'\r\n          : null;\r\n      case InputTypeCatalog.DateTimeDefault:\r\n        return defaultValue != null && defaultValue !== ''\r\n          ? new Date(defaultValue).toJSON()\r\n          : null;\r\n      case InputTypeCatalog.NumberDefault:\r\n      case InputTypeCatalog.NumberDropdown:\r\n      case InputTypeCatalog.NumberPicker:\r\n        return defaultValue != null && defaultValue !== ''\r\n          ? !isNaN(Number(defaultValue)) ? Number(defaultValue) : null\r\n          : null;\r\n      case InputTypeCatalog.EntityDefault:\r\n      case InputTypeCatalog.EntityQuery:\r\n      case InputTypeCatalog.EntityContentBlocks:\r\n      case InputTypeCatalog.EntityPicker:\r\n        // Empty - return []\r\n        if (defaultValue == null || defaultValue === '')\r\n          return [];\r\n\r\n        // string has { } characters, we must switch them to quotes for parsing below\r\n        // 2024-06-01 2dm not sure why this is an option..., maybe some interim encoding?\r\n        if (defaultValue.includes('{'))\r\n          defaultValue = defaultValue.replace(/[\\{\\}]/g, '\\\"');\r\n\r\n        // list but no array, add brackets\r\n        if (defaultValue.includes(',') && !defaultValue.includes('[')) {\r\n          const guids = defaultValue.split(',').map(guid => guid.trim());\r\n          defaultValue = JSON.stringify(guids);\r\n        }\r\n\r\n        // Finally parse\r\n        return defaultValue.startsWith('[') // an array with guid strings\r\n          ? JSON.parse(defaultValue) // if it's a string containing an array\r\n          : [defaultValue.replace(/\"/g, '')]; // just a guid string, but might have quotes\r\n      default:\r\n        return defaultValue ?? '';\r\n    }\r\n  }\r\n}\r\n", "import { PageEntity, PageSearchItem, PageTreeItem } from './page-picker.models';\r\n\r\nexport function buildPageSearch(pages: PageEntity[]): PageSearchItem[] {\r\n  if (!pages) { return []; }\r\n\r\n  const items = pages.map(page => {\r\n    let path = page.Path.trim().replace(/\\\\/g, '/').replace(/\\/\\//g, '/');\r\n    if (path.startsWith('/')) {\r\n      path = path.substring(1);\r\n    }\r\n    path = path.split('/').slice(0, -1).join(' > ');\r\n\r\n    const item: PageSearchItem = {\r\n      id: page.Id,\r\n      name: page.Name,\r\n      path,\r\n      isNavigation: page.IsNavigation,\r\n      isClickable: page.IsClickable,\r\n    };\r\n    return item;\r\n  });\r\n\r\n  return items;\r\n}\r\n\r\nexport function buildPageTree(pages: PageEntity[]): PageTreeItem[] {\r\n  if (!pages) { return []; }\r\n\r\n  const items = pages.map(page => {\r\n    const item: PageTreeItem = {\r\n      children: [],\r\n      id: page.Id,\r\n      name: page.Name,\r\n      parentId: page.ParentId,\r\n      isNavigation: page.IsNavigation,\r\n      isClickable: page.IsClickable,\r\n    };\r\n    return item;\r\n  });\r\n\r\n  const tree: PageTreeItem[] = [];\r\n  for (const item of items) {\r\n    if (item.parentId === -1) {\r\n      tree.push(item);\r\n      continue;\r\n    }\r\n\r\n    const parent = items.find(i => i.id === item.parentId);\r\n    if (!parent) {\r\n      tree.push(item);\r\n    } else {\r\n      parent.children.push(item);\r\n    }\r\n  }\r\n\r\n  return tree;\r\n}\r\n", "import { NgClass, NgTemplateOutlet } from '@angular/common';\r\nimport { Component, computed, Inject, OnInit, signal } from '@angular/core';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { MAT_DIALOG_DATA, MatDialogActions, MatDialogRef } from '@angular/material/dialog';\r\nimport { MatFormFieldModule } from '@angular/material/form-field';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatInputModule } from '@angular/material/input';\r\nimport { TranslateModule, TranslateService } from '@ngx-translate/core';\r\nimport { transient } from '../../../../../../core';\r\nimport { FieldValue } from '../../../../../../edit-types/src/FieldValue';\r\nimport { PagePickerResult } from '../../../../../../edit-types/src/PagePickerResult';\r\nimport { TippyDirective } from '../../../shared/directives/tippy.directive';\r\nimport { ArrayHelpers } from '../../../shared/helpers/array.helpers';\r\nimport { QueryService } from '../../../shared/services/query.service';\r\nimport { buildPageSearch, buildPageTree } from './page-picker.helpers';\r\nimport { PageEntity, PagePickerDialogData, PageSearchItem, PageTreeItem } from './page-picker.models';\r\n\r\n@Component({\r\n    selector: 'app-page-picker',\r\n    templateUrl: './page-picker.html',\r\n    styleUrls: ['./page-picker.scss'],\r\n    imports: [\r\n        MatFormFieldModule,\r\n        MatInputModule,\r\n        FormsModule,\r\n        NgTemplateOutlet,\r\n        NgClass,\r\n        MatIconModule,\r\n        MatDialogActions,\r\n        TranslateModule,\r\n        TippyDirective,\r\n    ]\r\n})\r\nexport class PagePickerComponent implements OnInit {\r\n  selected: number;\r\n  toggled: number[];\r\n\r\n  filterText = signal<string>('');\r\n  searchItems = signal<PageSearchItem[]>([]);\r\n  tree = signal<PageTreeItem[]>([]);\r\n\r\n  filteredSearch = computed(() => {\r\n    const filterText = this.filterText();\r\n    const searchItems = this.searchItems();\r\n    return searchItems.filter(item => item.name.toLocaleLowerCase().includes(filterText.toLocaleLowerCase()));\r\n  });\r\n\r\n  private queryService = transient(QueryService);\r\n\r\n  constructor(\r\n    @Inject(MAT_DIALOG_DATA) private dialogData: PagePickerDialogData,\r\n    private dialog: MatDialogRef<PagePickerComponent>,\r\n    private translate: TranslateService,\r\n  ) { }\r\n\r\n  ngOnInit(): void {\r\n    this.selected = this.parseSelectedPageId();\r\n    this.toggled = [];\r\n\r\n    this.fetchPages();\r\n  }\r\n\r\n  setFilter(filterText: string): void {\r\n    this.filterText.set(filterText);\r\n  }\r\n\r\n  select(page: PageTreeItem | PageSearchItem): void {\r\n    // filters out pages without parent (broken)\r\n    if (page.id == null) return;\r\n    if (!page.isClickable || !page.isNavigation) {\r\n      const ok = window.confirm(this.translate.instant('Fields.Hyperlink.PagePicker.HiddenOrSystemPageWarning'));\r\n      if (!ok) return;\r\n    }\r\n    this.closeDialog(page.id);\r\n  }\r\n\r\n  toggle(pageId: number): void {\r\n    ArrayHelpers.toggleInArray(pageId, this.toggled);\r\n  }\r\n\r\n  private closeDialog(pageId?: number): void {\r\n    if (pageId == null) {\r\n      this.dialog.close();\r\n      return;\r\n    }\r\n\r\n    const page = this.searchItems().find(i => i.id === pageId);\r\n    const result: PagePickerResult = {\r\n      id: page.id.toString(),\r\n      name: page.name,\r\n    };\r\n    this.dialog.close(result);\r\n  }\r\n\r\n  private fetchPages(): void {\r\n    const stream = 'Default';\r\n    const params = 'includehidden=true';\r\n    this.queryService.getFromQuery(`System.Pages/Default`, params, null).subscribe({\r\n      next: (data) => {\r\n        if (!data) {\r\n          console.error(this.translate.instant('Fields.Picker.QueryErrorNoData'));\r\n          return;\r\n        }\r\n        if (!data[stream]) {\r\n          console.error(this.translate.instant('Fields.Picker.QueryStreamNotFound') + ' ' + stream);\r\n          return;\r\n        }\r\n        const pages = data[stream] as PageEntity[];\r\n        const searchItems = buildPageSearch(pages);\r\n        this.searchItems.set(searchItems);\r\n        const tree = buildPageTree(pages);\r\n        this.tree.set(tree);\r\n      },\r\n      error: (error) => {\r\n        console.error(error);\r\n        console.error(`${this.translate.instant('Fields.Picker.QueryError')} - ${error.data}`);\r\n      }\r\n    });\r\n  }\r\n\r\n  private parseSelectedPageId(): number {\r\n    const prefix = 'page:';\r\n    let fieldValue: FieldValue = this.dialogData.group.controls[this.dialogData.config.fieldName].value;\r\n    if (typeof fieldValue !== 'string') return;\r\n\r\n    fieldValue = fieldValue.trim().toLocaleLowerCase();\r\n    if (!fieldValue.startsWith(prefix)) return;\r\n\r\n    try {\r\n      const id = parseInt(fieldValue.split(prefix)[1], 10);\r\n      return id;\r\n    } catch {\r\n      return;\r\n    }\r\n  }\r\n}\r\n", "<div class=\"eav-dialog\">\r\n  <div class=\"eav-dialog-header\">\r\n    <div class=\"eav-dialog-header__title\">{{ 'Fields.Hyperlink.PagePicker.Title' | translate }}</div>\r\n  </div>\r\n  <div class=\"eav-dialog-content\">\r\n    <div class=\"page-search-box\">\r\n      <mat-form-field color=\"accent\" class=\"eav-mat-form-field\">\r\n        <mat-label>Search</mat-label>\r\n        <input matInput [ngModel]=\"filterText()\" (ngModelChange)=\"setFilter($event)\">\r\n      </mat-form-field>\r\n    </div>\r\n    <div class=\"page-tree-box\">\r\n      @if (!filterText()) {\r\n      <ul>\r\n        @for (page of tree(); track page) {\r\n        <ng-container *ngTemplateOutlet=\"pageAndChildren; context: {page: page}\"></ng-container>\r\n        }\r\n      </ul>\r\n      }\r\n      @if (filterText()) {\r\n      <ul>\r\n        @if (filteredSearch().length === 0) {\r\n        <li>\r\n          <div class=\"page-row\">\r\n            <div class=\"no-toggle\"></div>\r\n            <div>No results</div>\r\n          </div>\r\n        </li>\r\n        }\r\n        @for (page of filteredSearch(); track page) {\r\n        <li>\r\n          <div class=\"page-row\">\r\n            <div class=\"no-toggle\"></div>\r\n            <div class=\"page-label\" [ngClass]=\"page.id === selected ? 'selected' : ''\" (click)=\"select(page)\">\r\n              <div class=\"page-icon-and-text\">\r\n                <mat-icon class=\"page-icon\" svgIcon=\"file\"></mat-icon>\r\n                @if (page.path) {\r\n                <span class=\"page-path\" [tippy]=\"page.path\">{{ page.path }}&nbsp;>&nbsp;</span>\r\n                }\r\n                <span class=\"page-name\" [tippy]=\"page.name\">{{ page.name }}</span>\r\n              </div>\r\n              <div class=\"page-icons\">\r\n                @if (!page.isNavigation) {\r\n                <mat-icon class=\"page-visible-clickable-icon\">visibility_off</mat-icon>\r\n                }\r\n                @if (!page.isClickable) {\r\n                <mat-icon class=\"page-visible-clickable-icon\">cancel</mat-icon>\r\n                }\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </li>\r\n        }\r\n      </ul>\r\n      }\r\n    </div>\r\n    <ng-template #pageAndChildren let-page=\"page\">\r\n      <li>\r\n        <div class=\"page-row\">\r\n          @if (page.children.length === 0) {\r\n          <div class=\"no-toggle\"></div>\r\n          }\r\n          @if (page.children.length > 0) {\r\n          <mat-icon class=\"page-toggle\" (click)=\"toggle(page.id)\">\r\n            {{ toggled.includes(page.id) ? 'keyboard_arrow_down' : 'keyboard_arrow_right' }}\r\n          </mat-icon>\r\n          }\r\n          <div class=\"page-label\" [ngClass]=\"page.id === selected ? 'selected' : ''\" (click)=\"select(page)\">\r\n            <div class=\"page-icon-and-text\">\r\n              <mat-icon class=\"page-icon\" svgIcon=\"file\"></mat-icon>\r\n              <span>{{ page.name }}</span>\r\n            </div>\r\n            <div class=\"page-icons\">\r\n              @if (!page.isVisible) {\r\n              <mat-icon class=\"page-visible-clickable-icon\">visibility_off</mat-icon>\r\n              }\r\n              @if (!page.isClickable) {\r\n              <mat-icon class=\"page-visible-clickable-icon\">cancel</mat-icon>\r\n              }\r\n            </div>\r\n          </div>\r\n        </div>\r\n        @if (page.children.length > 0 && toggled.includes(page.id)) {\r\n        <ul>\r\n          @for (child of page.children; track child) {\r\n          <ng-container *ngTemplateOutlet=\"pageAndChildren; context: {page: child}\"></ng-container>\r\n          }\r\n        </ul>\r\n        }\r\n      </li>\r\n    </ng-template>\r\n  </div>\r\n  <mat-dialog-actions>\r\n  </mat-dialog-actions>\r\n</div>\r\n", "import { ChangeDetectorRef, ViewContainerRef } from '@angular/core';\r\nimport { UntypedFormGroup } from '@angular/forms';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { take } from 'rxjs';\r\nimport { PagePickerResult } from '../../../../../../edit-types/src/PagePickerResult';\r\nimport { FieldConfigSet } from '../field-config-set.model';\r\nimport { PagePickerComponent } from './page-picker';\r\nimport { PagePickerDialogData } from './page-picker.models';\r\n\r\nexport class PagePicker {\r\n  static open(\r\n    config: FieldConfigSet,\r\n    group: UntypedFormGroup,\r\n    matDialog: MatDialog,\r\n    viewContainerRef: ViewContainerRef,\r\n    changeDetectorRef: ChangeDetectorRef,\r\n    callback: (value: PagePickerResult) => void,\r\n  ): void {\r\n    const dialogData: PagePickerDialogData = {\r\n      config,\r\n      group,\r\n    };\r\n    const dialogRef = matDialog.open(PagePickerComponent, {\r\n      autoFocus: false,\r\n      data: dialogData,\r\n      viewContainerRef,\r\n      height: '80%',\r\n      width: '650px',\r\n    });\r\n\r\n    dialogRef.afterClosed().pipe(take(1)).subscribe((value: PagePickerResult) => {\r\n      callback(value);\r\n    });\r\n\r\n    changeDetectorRef.markForCheck();\r\n  }\r\n}\r\n", "export class SanitizeHelper {\r\n\r\n  private static removeFromStart(sanitized: string, charToRemove: string): string {\r\n    // check for undefined\r\n    if (!sanitized) { return sanitized; }\r\n\r\n    while (sanitized.substring(0, 1) === charToRemove) {\r\n      sanitized = sanitized.substring(1);\r\n    }\r\n    return sanitized;\r\n  }\r\n\r\n  private static removeFromEnd(sanitized: string, charToRemove: string): string {\r\n    // check for undefined\r\n    if (!sanitized) { return sanitized; }\r\n\r\n    while (sanitized.substring(sanitized.length - 1, sanitized.length) === charToRemove) {\r\n      sanitized = sanitized.substring(0, sanitized.length - 1);\r\n    }\r\n    return sanitized;\r\n  }\r\n\r\n  private static cleanBadPath(sanitized: string): string {\r\n    // check for undefined\r\n    if (!sanitized) { return sanitized; }\r\n\r\n    const goodChar = '_';\r\n    const illegalRe = /[\\?<>\\\\:\\*\\|\":]/g;\r\n    const controlRe = /[\\x00-\\x1f\\x80-\\x9f]/g;\r\n    const reservedRe = /^\\.+$/;\r\n    const windowsReservedRe = /^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\\..*)?$/i;\r\n    const windowsTrailingRe = /[\\. ]+$/;\r\n    return sanitized\r\n      .replace(illegalRe, goodChar)\r\n      .replace(controlRe, goodChar)\r\n      .replace(reservedRe, goodChar)\r\n      .replace(windowsReservedRe, goodChar)\r\n      .replace(windowsTrailingRe, goodChar);\r\n  }\r\n\r\n  // sanitize path\r\n  static sanitizePath(sanitized: string): string {\r\n    // check for undefined\r\n    if (!sanitized) { return sanitized; }\r\n\r\n    // remove slashes form start of path\r\n    sanitized = this.removeFromStart(sanitized, '\\/');\r\n\r\n    // remove slashed form end of path\r\n    sanitized = this.removeFromEnd(sanitized, '\\/');\r\n\r\n    // remove backslashes form start of path\r\n    sanitized = this.removeFromStart(sanitized, '\\\\');\r\n\r\n    // remove backslashes form end of path\r\n    sanitized = this.removeFromEnd(sanitized, '\\\\');\r\n\r\n    // replace bad\r\n    sanitized = this.cleanBadPath(sanitized);\r\n\r\n    return sanitized;\r\n  }\r\n\r\n  // sanitize file or folder name\r\n  static sanitizeName(sanitized: string): string {\r\n    // check for undefined\r\n    if (!sanitized) { return sanitized; }\r\n\r\n    // in addition to all path validation rules\r\n    // slashes are not valid in file or folder name\r\n    const replacement = '_';\r\n    const illegalRe = /\\//g;\r\n    return this.sanitizePath(sanitized).replace(illegalRe, replacement);\r\n  }\r\n}\r\n", "import { Signal } from '@angular/core';\r\nimport { ComputedCacheHelper } from '../../../shared/signals/computed-cache';\r\nimport { computedObj, signalObj } from '../../../shared/signals/signal.utilities';\r\nimport { classLog, ClassLogger } from '../../../shared/logging';\r\n\r\n/**\r\n * Signal based store for any kind of data which is accessed by a key.\r\n * - The data type is generic.\r\n * - The key type can be customized.\r\n * - Standard get/add/remove methods exist, and can be augmented by the inheriting store.\r\n */\r\nexport abstract class SignalStoreBase<TKey extends string | number, TValue> {\r\n  \r\n  protected log: ClassLogger;\r\n\r\n  constructor(log: ClassLogger) {\r\n    this.log = log ?? classLog({SignalStoreBase});\r\n    this.log.a('SignalStoreBase created');\r\n    this.name = this.log.name;\r\n  }\r\n  \r\n  /** Main Cache */\r\n  #cache = signalObj<Record<TKey, TValue>>('cache', {} as Record<TKey, TValue>);\r\n\r\n  /** Cached version of the list, with the latest object-values */\r\n  #list = computedObj('list', () => Object.values(this.#cache()) as TValue[]);\r\n\r\n  /** Cache for the inheriting classes, but as read-only */\r\n  protected get cache(): Signal<Record<TKey, TValue>> { return this.#cache; }\r\n\r\n  /** List for the inheriting classes, but as read-only */\r\n  protected get list(): Signal<TValue[]> { return this.#list; }\r\n\r\n  /**\r\n   * Function to get the key / id for storing in the cache.\r\n   * Default is to get the 'id' property of the item.\r\n   * This should be overriden in the inheriting class.\r\n   */\r\n  protected getId: (item: TValue) => TKey = (item) => (item as any).id as TKey;\r\n\r\n  protected sanitizeAdd: (item: TValue) => TValue = (item) => item;\r\n\r\n  name: string;\r\n\r\n\r\n  //#region Add / Update / Remove / Clear Cache\r\n\r\n  add(item: TValue): void {\r\n    const l = this.log.fn('add', { item });\r\n    if (!item)\r\n      return l.end('item is null');\r\n\r\n    // add to signal\r\n    this.#cache.set({\r\n      ...this.#cache(),\r\n      [this.getId(item)]: this.sanitizeAdd(item)\r\n    });\r\n    l.end('added');\r\n  }\r\n\r\n  addMany(items: TValue[]): void {\r\n    var l = this.log.fn('addMany', { items });\r\n    if (!items || items.length == 0)\r\n      return l.end('items is null or empty');\r\n\r\n    // also add to signal, but in one go\r\n    const result = items.reduce((acc, item) => ({\r\n      ...acc,\r\n      [this.getId(item)]: this.sanitizeAdd(item)\r\n    }), { ...this.#cache() });\r\n    \r\n    this.#cache.set(result);\r\n    l.end('added');\r\n  }\r\n\r\n  update(id: TKey, item: Partial<TValue>): void {\r\n    const l = this.log.fn('update', { id, item });\r\n    if (!id || !item)\r\n      return l.end('id or item is null');\r\n\r\n    const before = this.get(id);\r\n    if (!before)\r\n      return l.end(`Item with id ${id} not found in store`);\r\n\r\n    // merge\r\n    const newItem = { ...before, ...item };\r\n\r\n    // add to signal\r\n    this.#cache.set({\r\n      ...this.#cache(),\r\n      [id]: newItem\r\n    });\r\n    l.end('updated');\r\n  }\r\n\r\n  remove(id: TKey): void {\r\n    const l = this.log.fn('remove', { id });\r\n    const { [id]: _, ...updatedStore } = this.#cache();\r\n    this.#cache.set(updatedStore as Record<TKey, TValue>);\r\n    l.end('removed');\r\n  }\r\n\r\n  clearCache(): void {\r\n    const l = this.log.fn('clearCache');\r\n    this.#cache.set({} as Record<TKey, TValue>);\r\n    l.end('cleared');\r\n  }\r\n\r\n  //#endregion\r\n\r\n  //#region Now-Getters\r\n\r\n  get(id: TKey): TValue {\r\n    const result = this.#cache()[id];\r\n    this.log.a(`get(${id}) - ` + (result == null ? 'not' : '') + 'found');\r\n    return result;\r\n  }\r\n\r\n  getAll(): TValue[] {\r\n    const result = this.#list();\r\n    this.log.a('getAll() - ' + `found ${result.length} items`);\r\n    return result;\r\n  }\r\n\r\n  getMany(ids: TKey[]): TValue[] {\r\n    const l = this.log.fn('getMany', { ids });\r\n    const result = ids\r\n      .map(id => this.#cache()[id])\r\n      .filter(item => item != null);\r\n    return l.r(result, `found ${result.length} items`);\r\n  }\r\n\r\n  //#endregion\r\n\r\n  //#region Signal Getters\r\n\r\n  getSignal(id: TKey): Signal<TValue> {\r\n    const result = this.#itemSignalsCache.getOrCreateWithInfo(id, () => this.get(id));\r\n    this.log.a(`getSignal(${id})`, { isNew: result.isNew });\r\n    return result.signal;\r\n  }\r\n  #itemSignalsCache = new ComputedCacheHelper<TKey, TValue>('item');\r\n\r\n\r\n  getManySignal(ids: TKey[]): Signal<TValue[]> {\r\n    const sig = computedObj('getMany', () => ids.map(id => this.get(id)).filter(item => item != null));\r\n    this.log.a('getManySignal()', { ids });\r\n    return sig;\r\n  }\r\n\r\n  getAllSignal(): Signal<TValue[]> {\r\n    const list = this.#list;\r\n    this.log.a(`getAllSignal() - found ${list().length} items`);\r\n    return list;\r\n  }\r\n\r\n  //#endregion\r\n\r\n}\r\n", "import { toObservable } from '@angular/core/rxjs-interop';\r\nimport { SignalStoreBase } from './signal-store-base';\r\nimport { Observable } from 'rxjs';\r\nimport { mapUntilChanged } from '../../../shared/rxJs/mapUntilChanged';\r\n\r\nexport abstract class SignalStoreObservableBase<TKey extends string | number, TValue> extends SignalStoreBase<TKey, TValue> {\r\n\r\n  /** Old / existing functionality with observables */\r\n  #cache$ = toObservable(this.cache);\r\n\r\n  #list$ = toObservable(this.list);\r\n\r\n  // publish only as a read-only signal\r\n  protected get cache$(): Observable<Record<TKey, TValue>> {\r\n    return this.#cache$;\r\n  }\r\n\r\n  protected get list$(): Observable<TValue[]> {\r\n    return this.#list$;\r\n  }\r\n\r\n  getList$(): Observable<TValue[]> {\r\n    return this.list$;\r\n  }\r\n\r\n  getMany$(ids?: TKey[]): Observable<TValue[]> {\r\n    return this.cache$.pipe(\r\n      mapUntilChanged(obj => ids.map(id => obj[id]).filter(m => m != null)),\r\n    );\r\n  }\r\n\r\n}", "import { Injectable, Signal } from '@angular/core';\r\nimport { map, Observable, shareReplay } from 'rxjs';\r\nimport { classLog } from '../../shared/logging';\r\nimport { mapUntilChanged } from '../../shared/rxJs/mapUntilChanged';\r\nimport { ComputedCacheHelper } from '../../shared/signals/computed-cache';\r\nimport { EntityReader } from '../shared/helpers';\r\nimport { SignalStoreObservableBase } from '../shared/store/signal-store-observable-base';\r\nimport { FormLanguage, FormLanguageComplete } from './form-languages.model';\r\n\r\nconst logSpecs = {\r\n  getReader: false,\r\n  getLanguage: false,\r\n  getReaderSignal: false,\r\n};\r\n\r\n@Injectable({ providedIn: 'root' })\r\nexport class FormLanguageService extends SignalStoreObservableBase<number, FormLanguageInStore> {\r\n\r\n  constructor() {\r\n    super(classLog({FormLanguageService}, logSpecs));\r\n  }\r\n\r\n  protected override getId = (item: FormLanguageInStore) => item.formId;\r\n\r\n  protected override sanitizeAdd = (item: FormLanguageInStore) => ({\r\n    ...FormLanguage.empty,\r\n    initial: item.current,\r\n    ...item\r\n  });\r\n\r\n  addForm(formId: number, primary: string, current: string, hideHeader: boolean): void {\r\n    this.add({\r\n      formId,\r\n      current,\r\n      initial: current,\r\n      primary,\r\n      hideHeader,\r\n    } satisfies FormLanguageInStore);\r\n  }\r\n\r\n  setCurrent(formId: number, newLanguage: string): void {\r\n    this.update(formId, { current: newLanguage } satisfies Partial<FormLanguageInStore>);\r\n  }\r\n\r\n  /**\r\n   * Get an EntityReader for the current form.\r\n   * ATM used in fields settings service.\r\n   * \r\n   * If the form doesn't exist, the reader returned will not have the correct languages specified.\r\n   * This is to avoid errors when the form is not yet loaded or is being unloaded.\r\n   */\r\n  getEntityReader(formId: number): Signal<EntityReader> {\r\n    const l = this.log.fnIf('getReader', { formId });\r\n    // Place creation of the language signal here to avoid creating it multiple times\r\n    const sig = this.#entityReaderCache.getOrCreateWithInfo(formId, () => {\r\n      const language = this.getSignal(formId)() ?? FormLanguage.empty();\r\n      const l2 = this.log.fnIf('getReaderSignal', { language });\r\n      return new EntityReader(language);\r\n    });\r\n    return l.rSilent(sig.signal, `isNew: ${sig.isNew}`);\r\n  }\r\n  #entityReaderCache = new ComputedCacheHelper<number, EntityReader>('entityReader');\r\n\r\n  // use in form config service for language$()\r\n  getLanguage$(formId: number): Observable<FormLanguageComplete> {\r\n    return this.cache$.pipe(\r\n      map(languageInstances => languageInstances[formId]),\r\n      mapUntilChanged(m => m),\r\n      shareReplay(1)\r\n    );\r\n  }\r\n\r\n  /** Get hideHeader for the form. Fix for safari and mobile browsers */\r\n  getHideHeaderSignal(formId: number): Signal<boolean> {\r\n    return this.#signalsHideHeaderCache.getOrCreate(formId, () => this.cache()[formId]?.hideHeader ?? false);\r\n  }\r\n  #signalsHideHeaderCache = new ComputedCacheHelper<number, boolean>('hideHeader');\r\n\r\n\r\n  /** Update hideHeader for the form. Fix for safari and mobile browsers */\r\n  updateHideHeader(formId: number, hideHeader: boolean): void {\r\n    this.update(formId, { hideHeader } satisfies Partial<FormLanguageInStore>);\r\n  }\r\n}\r\n\r\nexport interface FormLanguageInStore extends FormLanguageComplete {\r\n  formId: number;\r\n  hideHeader: boolean;\r\n}\r\n"],
  "mappings": "+tCAkBM,IAAOA,EAAP,KAAiB,CACrBC,YAESC,EAGAC,EAGAC,EAIAC,EAGAC,EAMAC,EAGAC,EAEAC,EAGAC,EAEPC,EAEAC,GAEAC,EAA4B,CAjCrB,KAAAX,KAAAA,EAGA,KAAAC,OAAAA,EAGA,KAAAC,MAAAA,EAIA,KAAAC,SAAAA,EAGA,KAAAC,OAAAA,EAMA,KAAAC,GAAAA,EAGA,KAAAC,QAAAA,EAEA,KAAAC,iBAAAA,EAGA,KAAAC,OAAAA,EAwDT,KAAAI,GAAiBC,EAAqC,mBAAoB,CAAA,CAAE,EAC5E,KAAAC,GAA2B,KAAKC,QAAQ,kBAAkB,EAE1D,KAAAC,iBAAmBC,EAAY,mBAAoB,IAAK,CACtD,IAAMC,EAAS,CACb,GAAG,KAAKN,GAAc,EACtB,GAAG,KAAKE,GAAwB,GAAM,CAAA,CAAE,EAG1C,OAAOK,MAAMC,KAAK,IAAIC,IAAIH,CAAM,CAAC,CACnC,CAAC,EA1DC,KAAKI,GAAcb,EAGnBc,EAAO,IAAK,CACV,IAAMC,EAA0B,KAAKR,iBAAgB,EACrD,GAAIQ,EAAwBC,QAAU,EAEtC,QAAWC,MAAWF,EACpBd,GAAYiB,eAAeD,GAAS,iBAAiB,KAAK1B,IAAI,EAAE,CACpE,EAAG,CAAE4B,SAAUjB,CAAkB,CAAE,CAErC,CAOA,IAAIF,YAAU,CACZ,GAAI,KAAKa,GACP,OAAO,KAAKA,GACd,MAAM,IAAIO,MAAM,iDAAiD,KAAK7B,IAAI,EAAE,CAC9E,CACAsB,GAWAP,QAAuCf,EAAO,CAC5C,OAAOiB,EAAYjB,EAAgB,IAAM,KAAKG,SAAQ,EAAGH,CAAI,CAAC,CAChE,CAEA8B,WAAsC9B,EAAO,CAC3C,OAAOiB,EAAYjB,EAAgB,IAAM,KAAKG,SAAQ,EAAGH,CAAI,CAAC,CAChE,CAQAY,GACAE,GAWAa,eAAeD,EAAgC,CAC7C,IAAMK,EAAU,KAAKnB,GAAc,EAC9BmB,EAAQC,SAASN,CAAO,GAC3B,KAAKd,GAAeqB,IAAI,CAAC,GAAGF,EAASL,CAAO,CAAC,CACjD,CAYAQ,kBAAkBC,EAAsB,CACtC,OAAOlB,EAAY,qBAAsB,IAAK,CAC5C,IAAMmB,EAAY,KAAKjC,SAAQ,EAAGkC,UAClC,OAAOF,EAAaH,SAASI,CAAS,EAClC,KACAA,GAAa,IACnB,CAAC,CACH,GCzHF,IAAaE,IAAiB,IAAA,CAAxB,MAAOA,CAAiB,CAK5BC,aAAA,CAHA,KAAAC,IAAMC,EAAS,CAACH,kBAAAA,CAAiB,CAAC,EAalC,KAAAI,aAAeC,EAA0B,IAAI,EAmBrC,KAAAC,QAAUC,EAAOC,EAAO,EACxB,KAAAC,gBAAkBF,EAAOG,EAAmB,CA9BpC,CAiChBC,eACEC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EAAsB,CAEtB,KAAKA,SAAWA,EAChB,KAAKC,UAAY,CACfC,QAAST,EAAcU,SAASC,QAChCC,QAASZ,EAAcU,SAASG,QAChCC,KAAMd,EAAcU,SAASK,MAI/B,IAAMC,EAAsBC,eAAeC,QAAQC,EAAW,EAIxDC,GAHmBJ,EAAsBK,KAAKC,MAAMN,CAAmB,EAAI,OAG7CO,KAC9BA,EAAQH,GAAa,KACvB,CAAEI,KAAM,EAAI,EACXJ,IAAc,SAAWA,IAAc,GACtC,CAAEI,KAAM,EAAK,EACb,CAAEA,KAAM,GAAMC,KAAML,CAAS,EAGnC,KAAKM,OAAS,CACZC,OAAQ,KAAKjC,QAAQiC,OACrBC,MAAO,KAAKlC,QAAQkC,MACpBC,QAAS7B,EAAc8B,IAAIC,IAC3BC,cAAehC,EAAc8B,IAAIG,UACjCC,SAAU,KAAKxC,QAAQwC,UAAUC,SAAQ,EACzCC,WAAYnB,eAAeC,QAAQmB,EAAa,GAAKC,GACrDC,WAAYvC,EAAcwC,KAAKT,IAC/BU,MAAO,KAAK/C,QAAQ+C,OAAON,SAAQ,EACnCO,WAAYC,OAAOC,SAASC,SAASC,MAAM,QAAQ,EAAE,CAAC,EAAI,IAC1DC,kBAAmB,KAAKC,qBACtB/B,eAAeC,QAAQmB,EAAa,IAAM,OAC1CpB,eAAeC,QAAQ+B,EAAa,CAAC,EAEvChD,OAAAA,EACAC,eAAAA,EACAC,UAAAA,EACAC,WAAAA,EACAC,OAAAA,EACAC,cAAAA,EACA4C,kBAAmBlD,EAAcmD,OAAOC,aAAe,GACvDC,uBAAwBrD,EAAcmD,OAAOG,0BAA4B,GACzEtD,cAAAA,EACAO,SAAAA,EACAgB,KAAAA,GAEF,KAAK/B,aAAa+D,IAAI,KAAK7B,MAAM,EACjC,KAAK8B,SAAW,KAAK3D,gBAAgB4D,UAAU,KAAK/B,OAAOzB,MAAM,CACnE,CAEQ+C,qBACNZ,EACAsB,EAAkB,CAGlB,IAAMC,EAA8B,CAAEC,KAAM,GAAMC,KAAM,GAAMC,OAAQ,EAAI,EAE1E,GAAI,CAAC1B,EACH,OAAOuB,EAET,IAAMI,EAAUL,GAAc,GAC9B,OAAQK,EAAO,CACb,IAAK,GACL,IAAK,gBACH,OAAOJ,EACT,IAAK,gBAGH,MAAO,CAAEG,OAAQ,GAAMD,KAAM,EAAI,EACnC,IAAK,iBACH,MAAO,CAAED,KAAM,EAAI,EACrB,QACEI,eAAQC,MAAM,oCAAoCF,CAAO,EAAE,EACpD,CAAA,CAEX,CACF,CAKA,IAAIG,WAAS,CACX,OAAO,KAAKC,aAAe,KAAKtE,gBAAgBuE,aAAa,KAAK1C,OAAOzB,MAAM,CACjF,iDAnIWb,EAAiB,CAAA,iCAAjBA,EAAiBiF,QAAjBjF,EAAiBkF,SAAA,CAAA,CAAA,SAAjBlF,CAAiB,GAAA,ECX9B,IAAMmF,GAAW,CACfC,IAAK,GACLC,WAAY,GACZC,eAAgB,IAIlB,IAAMC,GAAqB,YAE3B,IAAMC,GAAc,WAcPC,IAAU,IAAA,CAAjB,MAAOA,UAAkBC,EAAW,CAIxCC,GACAC,GAEAC,YAAoBC,EAAkB,CACpC,MAAK,EADa,KAAAA,SAAAA,EALpB,KAAAC,IAAMC,EAAS,CAACP,UAAAA,CAAS,EAAGQ,EAAQ,EAEpC,KAAAN,GAAcO,EAAOC,CAAU,EAC/B,KAAAP,GAAcM,EAAOE,EAAiB,EAU/B,KAAAC,OAASC,EAAe,EAAE,EAEjC,KAAAC,GAAY,KAAKZ,GAAYa,MAAMC,SACnC,KAAAC,GAAe,KAAKf,GAAYgB,OAChC,KAAAC,GAAiB,GAMjB,KAAAC,GAAcP,EAAuBA,EAAe,EAAE,CAAC,EAMvD,KAAAQ,GAAQC,EAAS,IAAM,KAAKF,GAAW,EAAE,CAAE,EAG3C,KAAAG,GAAoBD,EAAS,IAAM,KAAKE,GAAmB,KAAKH,GAAK,CAAE,CAAC,EAzBtE,KAAKf,IAAImB,EAAE,aAAa,CAC1B,CAOAX,GACAG,GACAE,GAMAC,GAMAC,GAGAE,GAiBOG,aAAaC,EAA8D,CAChF,YAAKrB,IAAImB,EAAE,cAAc,EACzB,KAAKG,SAAWD,EACT,IACT,CAEOE,KAAKC,EAAcC,EAAcC,EAAyB,GAAK,CACpE,OAAO,KAAKC,WAAWH,EAAMjB,EAAOkB,CAAI,CAAC,CAC3C,CAEOE,WAAWH,EAAcC,EAAoB,CAClD,KAAKzB,IAAI4B,WAAW,IAAIJ,CAAI,EAAE,EAC9B,IAAMK,EAAI,KAAK7B,IAAI8B,KAAK,aAAc,CAAEN,KAAAA,EAAMC,KAAAA,CAAI,CAAE,EACpD,YAAKX,GAAYiB,IAAIN,CAAI,EACzB,KAAKO,GAAgB,EACdH,EAAEI,EAAE,KAAM,gBAAkB,KAAK3B,OAAM,CAAE,CAClD,CAMO4B,YAAU,CAEf,IAAML,EAAI,KAAK7B,IAAImC,QAAU,KAAKnC,IAAMC,EAAS,CAACP,UAAAA,CAAS,CAAC,EAC5D0C,OAAAA,EAAO,IAAMP,EAAEV,EAAE,SAAS,KAAKJ,GAAK,CAAE,uBAAuB,KAAKT,OAAM,CAAE,EAAE,EAAG,CAAEP,SAAU,KAAKA,QAAQ,CAAE,EACnG,IACT,CAEAiC,IAAgB,CAGd,KAAKK,GAAe,EACpB,KAAKC,GAAS,CAChB,CAOAC,IAAQ,CAGN,GAAI,CAACC,GAAgB,KAAKzB,GAAK,CAAE,EAC/B,OAAO,KAAKA,GAAK,EAEnB,IAAI0B,EAAQC,GAA8B,KAAK3B,GAAK,CAAE,EAGlD,KAAKlB,IAAe,OACtB4C,EAAQA,EACLE,QAAQ,cAAe,KAAK9C,GAAYe,OAAOgC,MAAMC,SAAQ,CAAE,EAC/DF,QAAQ,eAAgB,KAAK9C,GAAYe,OAAOkC,OAAOD,SAAQ,CAAE,GAGlE,KAAKlC,IAAgB,OACvB8B,EAAQA,EACLE,QAAQ,SAAU,KAAKhC,GAAaoC,UAAU,EAC9CJ,QAAQ,cAAe,KAAKhC,GAAaoC,UAAU,EACnDJ,QAAQ,OAAQ,KAAKhC,GAAaqC,SAASH,SAAQ,CAAE,EACrDF,QAAQ,YAAa,KAAKhC,GAAaqC,SAASH,SAAQ,CAAE,GAE/D,IAAMI,EAAmB,KAAKhC,GAAiB,EAAGiC,KAClD,OAAKD,GAGLA,EAAiBE,QAAQ,CAACC,EAAGC,IAAK,CAChC,IAAMC,EAAe,KAAK9C,KAAY4C,CAAC,GAAGX,OAAS,GAC7Cc,EAAU,KAAKjC,SAAS8B,EAAGE,CAAY,EAE7Cb,EAAQA,EAAME,QAAQ,SAAWS,EAAEI,YAAW,EAAK,IAAKD,CAAO,EAE/Dd,EAAQA,EAAME,QAAQ,IAAMS,EAAEI,YAAW,EAAK,IAAKD,CAAO,CAC5D,CAAC,EACMd,CACT,CAGAvB,GAAmBO,EAAY,CAE7B,GAAI,CAACA,GAAQ,CAACe,GAAgBf,CAAI,EAChC,MAAO,CAAA,EAET,IAAMgC,EAAUhC,EAAKiC,MAAMC,EAAkB,EAE7C,OAAKF,EAIE,CAAEP,KADgBO,EAAQG,IAAIC,GAASA,EAAMlB,QAAQlD,GAAa,EAAE,CAAC,CACvD,EAHZ,CAAA,CAIX,CAMQ6B,SAASwC,EAAarB,EAAa,CAAY,OAAOA,CAAO,CAGrEH,IAAS,CACP,IAAMyB,EAAW,KAAKxB,GAAQ,EAC9B,KAAKjC,OAAOyB,IAAIgC,CAAQ,CAC1B,CAMA1B,IAAe,CACb,IAAMR,EAAI,KAAK7B,IAAI8B,KAAK,gBAAgB,EAClCmB,EAAmB,KAAKhC,GAAiB,EAAGiC,KAClD,GAAI,CAACD,EACH,OAAOpB,EAAEmC,IAAI,sBAAsB,EAGrC,IAAMtD,EAAWuC,EACdW,IAAIK,GAAK,KAAKzD,GAAUyD,CAAC,CAAC,EAC1BC,OAAOD,GAAKA,GAAK,IAAI,EAExB,GAAIvD,EAASyD,QAAU,EACrB,OAAOtC,EAAEmC,IAAI,oBAAoB,EAEnCtD,EAASyC,QAAQiB,GAAK,KAAKC,cAAcC,IAAIF,EAAEG,aAAaC,UAAUC,GAAK,KAAKnC,GAAS,CAAE,CAAC,CAAC,EAC7FT,EAAEmC,IAAG,CACP,iDAhLWtE,GAASgF,GAAAC,EAAA,CAAA,CAAA,CAAA,iCAATjF,EAASkF,QAATlF,EAASmF,SAAA,CAAA,CAAA,SAATnF,CAAU,GAAA,EAoLvB,SAAS8C,GAAgBf,EAAY,CACnC,OAAQA,GAAQ,IAAIqD,SAAS,GAAG,CAClC,CAGA,SAASpC,GAA8BD,EAAa,CAClD,OAAOA,EAAME,QAAQ,gBAAiB,CAAC8B,EAAGhE,IAAU,IAAIA,EAAM+C,YAAW,CAAE,GAAG,CAChF,CCrNM,IAAOuB,EAAP,KAAmB,CAcvB,OAAOC,YAAYC,EAAsB,CACvC,MAAO,CACLC,QAASD,EAASE,QAClBA,QAASF,EAASE,QAEtB,CAEA,OAAOC,YAAYH,EAAwBC,EAAe,CACxD,MAAO,CACLA,QAASA,EACTC,QAASF,EAASE,QAEtB,CAEA,OAAOE,OAAK,CACV,MAAO,CACLH,QAAS,GACTC,QAAS,GACTG,QAAS,GAEb,GClCI,IAAOC,EAAP,KAAsB,CAC1BC,YAAoBC,EAAoCC,EAAsB,CAA1D,KAAAD,WAAAA,EAAoC,KAAAC,SAAAA,CAA0B,CAElF,IAAIC,iBAAe,CAGjB,MAAO,CAAC,CAFM,KAAKF,WAAWG,KAAKC,GAAKA,EAAEC,UAAY,KAAKJ,SAASK,SAC9D,KAAKL,SAASK,UAAY,KAAKL,SAASM,SAAWH,EAAEC,UAAY,GAAI,CAE7E,CAEA,IAAIG,oBAAkB,CACpB,IAAMC,EAAY,IAAI,KAAKR,SAASK,OAAO,GAC3C,OAAO,KAAKN,WAAWG,KAAKC,GAAKA,EAAEC,UAAYI,CAAS,IAAMC,MAChE,CAEA,IAAIC,YAAU,CAIZ,MAAO,CAAC,CAHM,KAAKX,WAAWG,KAAKC,GAAKA,EAAEC,UAAY,KAAKJ,SAASK,SAC/DF,EAAEC,UAAY,IAAI,KAAKJ,SAASK,OAAO,IACtC,KAAKL,SAASK,UAAY,KAAKL,SAASM,SAAWH,EAAEC,UAAY,GAAI,CAE7E,GClBF,IAAMO,GAAW,CACfC,IAAK,GACLC,YAAa,IAGFC,EAAP,MAAOA,CAAW,CAMtBD,YAAYE,EAAoBC,EAA+B,CAJ/D,KAAAC,IAAMC,EAAS,CAACJ,YAAAA,CAAW,EAAGH,EAAQ,EAYtC,KAAAQ,GAAU,GAPR,KAAKF,IAAIG,KAAK,cAAe,CAAEL,MAAAA,EAAOC,SAAAA,CAAQ,CAAE,EAChD,KAAKK,GAASN,EACd,KAAKO,GAAY,OAAON,GAAa,SAAW,CAAEO,QAASP,EAAUQ,QAASR,CAAQ,EAAKA,EAC3F,KAAKS,GAAUV,GAAOW,QAAU,CAAA,EAChC,KAAKP,GAAU,CAACJ,GAAS,CAACA,EAAMW,QAAUX,EAAMW,OAAOC,SAAW,CACpE,CAEAR,GAEAE,GAEAI,GACAH,GAEA,IAAIC,SAAO,CACT,OAAO,KAAKK,WAAW,KAAKN,EAAS,CACvC,CAaA,IAAIO,kBAAgB,CAClB,OAAI,KAAKV,GAAgB,KAClB,KAAKI,SAEP,KAAKK,WAAWE,EAAaC,YAAY,KAAKT,EAAS,CAAC,CAC/D,CASA,IAAIU,uBAAqB,CACvB,OAAI,KAAKb,GAAgB,KAClB,KAAKU,kBAAoB,KAAKJ,GAAQ,CAAC,GAAK,IACrD,CAGAG,WAAWZ,EAAsB,CAC/B,OAAI,KAAKG,GAAgB,KAClB,KAAKM,GAAQQ,OAAOC,GAAO,IAAIC,EAAgBD,EAAIE,WAAYpB,CAAQ,EAAEqB,UAAU,EAAE,CAAC,GAAK,IACpG,CAGA,IAAIC,YAAU,CACZ,GAAI,KAAKnB,GAAS,MAAO,GACzB,IAAMK,EAAU,KAAKF,GAAUE,QAC/B,OAAO,KAAKC,GAAQQ,OAAOC,GAAOA,EAAIE,WAAWG,KAAKC,GAAKA,EAAEC,UAAYjB,GAAWgB,EAAEC,UAAY,GAAG,CAAC,EAAEd,OAAS,CACnH,CAEA,IAAIe,oBAAkB,CACpB,OAAI,KAAKvB,GAAgB,GAClB,KAAKM,GAAQQ,OAAOC,GAAO,IAAIC,EAAgBD,EAAIE,WAAY,KAAKd,EAAS,EAAEqB,kBAAkB,EAAEhB,OAAS,CACrH,CAGA,IAAIiB,mBAAiB,CACnB,OAAI,KAAKzB,GAAgB,GAClB,KAAK0B,GAAiB,EAAGlB,OAAS,CAC3C,CAGAmB,eAAa,CACX,OAAO,KAAKD,GAAiB,EAAGlB,MAClC,CAGAoB,2BAAyB,CACvB,OAAO,KAAKF,GAAiB,EAAGZ,OAAOe,GAAKA,EAAEC,OAAS,IAAMD,EAAEC,OAAS,IAAI,GAAGtB,MACjF,CAMAkB,GAAkB7B,EAAuB,CACvC,OAAI,KAAKG,GAAgB,CAAA,GACzBH,IAAa,KAAKM,GACX,KAAKG,GAAQQ,OAAOC,GAAO,IAAIC,EAAgBD,EAAIE,WAAYpB,CAAQ,EAAEkC,eAAe,EACjG,CAGA,IAAIC,iBAAe,CACjB,GAAI,KAAKhC,GAAS,OAAO,KACzB,IAAMiC,EAAY,KAAK9B,GAAUC,QACjC,OAAO,KAAKE,GAAQc,KAAKS,GAAKA,EAAEZ,WAAWG,KAAKc,GAAKA,EAAEZ,UAAYW,CAAS,CAAC,GAAK,IACpF,CAEAE,sCAAoC,CAClC,OAAI,KAAKnC,GAAgB,GAClB,KAAK0B,GAAiB,EAAGlB,OAAS,CAC3C,GChHI,IAAO4B,GAAP,KAAiC,CAMrC,OAAOC,mBAAmBC,EAAsBC,EAA6BC,EAAoC,CAC/G,IAAMC,EAAWH,EAAOI,QAA6BH,EAAYI,QAAQ,EACnEC,EAAkBC,EAAA,GAAKJ,GAC7BG,OAAAA,EAAgBE,cAAgB,GAChCF,EAAgBG,mBAAqB,GACrCH,EAAgBI,WAAa,GAC7BJ,EAAgBK,QAAU,GAC1BL,EAAgBM,mBAAqB,GACrCN,EAAgBO,QAAU,GAC1BP,EAAgBQ,OAAS,GACzBR,EAAgBS,OAAS,GACzBT,EAAgBU,WAAa,KAAKC,SAAShB,EAAaD,CAAM,EAC9DM,EAAgBY,gBAAkBhB,EAAWiB,gBAAkB,GAC/Db,EAAgBc,aAAelB,EAAWmB,SAAW,GAC9Cf,CACT,CAEA,OAAOW,SAAShB,EAA6BqB,EAAsB,CACjE,GAAI,CAEF,IAAMC,EAAOtB,EAAYI,SAASmB,KAAKrB,GAAYA,EAASsB,KAAKC,OAAS,eAAiBvB,EAASsB,KAAKC,OAAS,gBAAgB,EAC9HC,EAASJ,EACT,IAAIK,EAAYL,EAAKM,WAAWlB,MAAOW,CAAQ,EAAEQ,kBAAkBC,MACnE,KACJJ,OAAAA,EAAQA,GAAS1B,EAAYyB,KACtBC,CACT,MAAgB,CACd,OAAO1B,EAAYyB,IACrB,CACF,GCpCF,IAAMM,GAAW,CACfC,IAAK,GACLC,YAAa,IAGFC,EAAP,MAAOA,CAAY,CAWvBD,YAAYE,EAAgCC,EAAgB,CAT5D,KAAAC,IAAMC,EAAS,CAAEJ,aAAAA,CAAY,EAAIH,EAAQ,EAUvC,KAAKM,IAAIE,KAAK,cAAe,CAAEJ,QAAAA,EAASC,QAAAA,CAAO,CAAE,EAC7C,OAAOD,GAAY,UACrB,KAAKA,QAAUA,EACf,KAAKC,QAAUA,IAEf,KAAKD,QAAUA,EAAQA,QACvB,KAAKC,QAAUD,EAAQC,QAE3B,CAIAI,aAAgBC,EAA8BC,EAAkB,KAAI,CAElE,OADoB,IAAIC,EAAeF,EAAiB,IAAI,EACzCG,uBAAuBC,OAASH,CAErD,CAEOI,QAAWC,EAAiC,CACjD,GAAIA,GAAY,KACd,MAAO,CAAA,EAET,IAAMC,EAAgBC,MAAMC,QAAQH,CAAQ,EAAIA,EAAW,CAACA,CAAQ,EACpE,GAAIC,EAAcG,SAAW,GAAKH,EAAc,CAAC,GAAK,KACpD,MAAO,CAAA,EAET,IAAMI,EAA8B,CAAA,EAEpC,QAAWC,KAAQL,EACjB,GAAIK,EAAKC,KAAKC,KAAO,OAErB,OAAW,CAACC,EAAMC,CAAM,IAAKC,OAAOC,QAAQN,EAAKO,UAAU,EAAG,CAC5D,IAAMf,EAAQ,KAAKL,aAAaiB,CAAM,EACtCL,EAAOI,CAAI,EAAIX,CACjB,CAIF,QAAWQ,KAAQL,EACjB,GAAIK,EAAKC,KAAKC,KAAO,OAErB,OAAW,CAACC,EAAMC,CAAM,IAAKC,OAAOC,QAAQN,EAAKO,UAAU,EAAG,CAC5D,IAAMf,EAAQ,KAAKL,aAAaiB,CAAM,EAEhCI,EAAST,EAAOI,CAAI,GAAK,KACzBM,EAAWjB,GAAS,MAAQA,IAAU,GACxCgB,GAAUC,IAEdV,EAAOI,CAAI,EAAIX,EACjB,CAGF,OAAOO,CACT,CAEAW,cAAcC,EAAmC,CAM/C,OALyCN,OAAOC,QAAQK,CAAc,EACnEC,OAAO,CAACC,EAAK,CAACV,EAAMC,CAAM,KACzBS,EAAIV,CAAI,EAAI,KAAKhB,aAAaiB,CAAM,EAC7BS,GACN,CAAA,CAA0B,CAEjC,GCrFF,IAAaC,IAAe,IAAA,CAAtB,MAAOA,CAAe,QACX,KAAAC,YAAc,MAAO,QACrB,KAAAC,iBAA2C,CACxDC,IAAK,YACLC,KAAM,YACNC,IAAK,aACLC,KAAM,aACNC,IAAK,kBACLC,KAAM,kBACNC,IAAK,WACLC,IAAK,aACLC,IAAK,aACLC,IAAK,aACLC,KAAM,aACNC,IAAK,aACLC,IAAK,aACLC,IAAK,eACLC,IAAK,eACLC,IAAK,YACLC,KAAM,YACNC,IAAK,YACLC,IAAK,YACLC,IAAK,YACL,QACa,KAAAC,cAAwC,CACrDC,IAAK,SACL,CAEF,OAAOC,aAAaC,EAAgB,CAClC,OAAOA,EAASC,UAAUD,EAASE,YAAY,GAAG,EAAI,CAAC,EAAEC,kBAAiB,CAC5E,CAEA,OAAOC,aAAaJ,EAAgB,CAClC,IAAMK,EAAM,KAAKN,aAAaC,CAAQ,EACtC,OAAO,KAAKH,cAAcQ,CAAG,GAAK,KAAK7B,iBAAiB6B,CAAG,GAAK,KAAK9B,WACvE,CAEA,OAAO+B,YAAYN,EAAgB,CACjC,OAAO,KAAKH,cAAc,KAAKE,aAAaC,CAAQ,CAAC,GAAK,IAC5D,CAEA,OAAOO,QAAQP,EAAgB,CAC7B,OAAO,KAAKQ,WAAU,EAAGC,KAAKT,CAAQ,CACxC,CAEQ,OAAOQ,YAAU,CACvB,MAAO,kGACT,SA/CWlC,CAAe,GAAA,ECUtB,IAAOoC,GAAP,MAAOA,CAAa,CAIxBC,YACUC,EACAC,EACAC,EACAC,EAAkD,CAHlD,KAAAH,KAAAA,EACA,KAAAC,UAAAA,EACA,KAAAC,SAAAA,EACA,KAAAC,WAAAA,EANV,KAAAC,IAAMC,EAAS,CAACP,cAAAA,CAAa,CAAC,CAO1B,CAGJQ,yBAAyBC,EAAqB,CAE5C,IAAMN,EAAY,KAAKA,UACjBD,EAAO,KAAKA,KACZE,EAAW,KAAKA,SAChBC,EAAa,KAAKA,WAClBK,EAAI,KAAKJ,IAAIK,GAAG,oBAAqB,CAAET,KAAAA,EAAMC,UAAAA,EAAWC,SAAAA,EAAUC,WAAAA,EAAYI,YAAAA,CAAW,CAAE,EAE3FG,EAAaP,GAAYQ,UAAUX,CAAI,EAC7C,GAAIO,GAAeG,IAAeE,OAChC,OAAOJ,EAAEK,MAAM,yCAAyC,EAE1D,IAAIC,EAAeJ,GAAYK,SAAQ,GAAMb,EAASc,aAItD,OAFAR,EAAES,OAAO,CAAEH,aAAAA,CAAY,CAAE,EAEjBb,EAAS,CACf,KAAKiB,EAAiBC,eACpB,OAAOL,GAAcM,YAAW,IAAO,OACzC,KAAKF,EAAiBG,gBACpB,OAAOP,GAAgB,MAAQA,IAAiB,GAC5CA,EAAaM,YAAW,IAAO,OAC/B,KACN,KAAKF,EAAiBI,gBACpB,OAAOR,GAAgB,MAAQA,IAAiB,GAC5C,IAAIS,KAAKT,CAAY,EAAEU,OAAM,EAC7B,KACN,KAAKN,EAAiBO,cACtB,KAAKP,EAAiBQ,eACtB,KAAKR,EAAiBS,aACpB,OAAOb,GAAgB,MAAQA,IAAiB,GAC3Cc,MAAMC,OAAOf,CAAY,CAAC,EAA2B,KAAvBe,OAAOf,CAAY,EAClD,KACN,KAAKI,EAAiBY,cACtB,KAAKZ,EAAiBa,YACtB,KAAKb,EAAiBc,oBACtB,KAAKd,EAAiBe,aAEpB,GAAInB,GAAgB,MAAQA,IAAiB,GAC3C,MAAO,CAAA,EAQT,GAJIA,EAAaoB,SAAS,GAAG,IAC3BpB,EAAeA,EAAaqB,QAAQ,UAAW,GAAI,GAGjDrB,EAAaoB,SAAS,GAAG,GAAK,CAACpB,EAAaoB,SAAS,GAAG,EAAG,CAC7D,IAAME,EAAQtB,EAAauB,MAAM,GAAG,EAAEC,IAAIC,GAAQA,EAAKC,KAAI,CAAE,EAC7D1B,EAAe2B,KAAKC,UAAUN,CAAK,CACrC,CAGA,OAAOtB,EAAa6B,WAAW,GAAG,EAC9BF,KAAKG,MAAM9B,CAAY,EACvB,CAACA,EAAaqB,QAAQ,KAAM,EAAE,CAAC,EACrC,QACE,OAAOrB,GAAgB,EAC3B,CACF,GC/EI,SAAU+B,GAAgBC,EAAmB,CACjD,OAAKA,EAESA,EAAMC,IAAIC,GAAO,CAC7B,IAAIC,EAAOD,EAAKE,KAAKC,KAAI,EAAGC,QAAQ,MAAO,GAAG,EAAEA,QAAQ,QAAS,GAAG,EACpE,OAAIH,EAAKI,WAAW,GAAG,IACrBJ,EAAOA,EAAKK,UAAU,CAAC,GAEzBL,EAAOA,EAAKM,MAAM,GAAG,EAAEC,MAAM,EAAG,EAAE,EAAEC,KAAK,KAAK,EAEjB,CAC3BC,GAAIV,EAAKW,GACTC,KAAMZ,EAAKa,KACXZ,KAAAA,EACAa,aAAcd,EAAKe,aACnBC,YAAahB,EAAKiB,YAGtB,CAAC,EAjBoB,CAAA,CAoBvB,CAEM,SAAUC,GAAcpB,EAAmB,CAC/C,GAAI,CAACA,EAAS,MAAO,CAAA,EAErB,IAAMqB,EAAQrB,EAAMC,IAAIC,IACK,CACzBoB,SAAU,CAAA,EACVV,GAAIV,EAAKW,GACTC,KAAMZ,EAAKa,KACXQ,SAAUrB,EAAKsB,SACfR,aAAcd,EAAKe,aACnBC,YAAahB,EAAKiB,aAGrB,EAEKM,EAAuB,CAAA,EAC7B,QAAWC,KAAQL,EAAO,CACxB,GAAIK,EAAKH,WAAa,GAAI,CACxBE,EAAKE,KAAKD,CAAI,EACd,QACF,CAEA,IAAME,EAASP,EAAMQ,KAAKC,GAAKA,EAAElB,KAAOc,EAAKH,QAAQ,EAChDK,EAGHA,EAAON,SAASK,KAAKD,CAAI,EAFzBD,EAAKE,KAAKD,CAAI,CAIlB,CAEA,OAAOD,CACT,4CEzCQM,EAAA,CAAA,2BAAAC,EAAA,EAAAC,GAAA,EAAA,EAAA,eAAA,CAAA,0CAAeC,EAAA,mBAAAC,CAAA,EAAmC,0BAAAC,GAAA,EAAAC,GAAAC,CAAA,CAAA,6BAFpDC,EAAA,EAAA,IAAA,EACEC,EAAA,EAAAC,GAAA,EAAA,EAAA,eAAA,KAAAC,CAAA,EAGFC,EAAA,kBAHEC,EAAA,EAAAC,EAAAC,EAAAC,KAAA,CAAM,0BAQNR,EAAA,EAAA,IAAA,EAAI,EAAA,MAAA,EAAA,EAEAS,EAAA,EAAA,MAAA,EAAA,EACAT,EAAA,EAAA,KAAA,EAAKU,EAAA,EAAA,YAAA,EAAUN,EAAA,EAAM,EACjB,6BAWAJ,EAAA,EAAA,OAAA,EAAA,EAA4CU,EAAA,CAAA,EAA4BN,EAAA,4BAAhDT,EAAA,QAAAgB,EAAAC,IAAA,EAAoBP,EAAA,EAAAQ,GAAA,GAAAF,EAAAC,KAAA,WAAA,0BAM5CZ,EAAA,EAAA,WAAA,EAAA,EAA8CU,EAAA,EAAA,gBAAA,EAAcN,EAAA,0BAG5DJ,EAAA,EAAA,WAAA,EAAA,EAA8CU,EAAA,EAAA,QAAA,EAAMN,EAAA,sCAhB5DJ,EAAA,EAAA,IAAA,EAAI,EAAA,MAAA,EAAA,EAEAS,EAAA,EAAA,MAAA,EAAA,EACAT,EAAA,EAAA,MAAA,EAAA,EAA2Ec,EAAA,QAAA,UAAA,CAAA,IAAAH,EAAAI,EAAAC,CAAA,EAAAC,UAAAV,EAAAW,EAAA,CAAA,EAAA,OAAAC,EAASZ,EAAAa,OAAAT,CAAA,CAAY,CAAA,CAAA,EAC9FX,EAAA,EAAA,MAAA,EAAA,EACES,EAAA,EAAA,WAAA,EAAA,EACAY,EAAA,EAAAC,GAAA,EAAA,EAAA,OAAA,EAAA,EAGAtB,EAAA,EAAA,OAAA,EAAA,EAA4CU,EAAA,CAAA,EAAeN,EAAA,EAAO,EAEpEJ,EAAA,EAAA,MAAA,EAAA,EACEqB,EAAA,GAAAE,GAAA,EAAA,EAAA,WAAA,EAAA,EAGAF,EAAA,GAAAG,GAAA,EAAA,EAAA,WAAA,EAAA,EAGFpB,EAAA,EAAM,EACF,EACF,mCAjBoBC,EAAA,CAAA,EAAAV,EAAA,UAAAgB,EAAAc,KAAAlB,EAAAmB,SAAA,WAAA,EAAA,EAGpBrB,EAAA,CAAA,EAAAsB,EAAAhB,EAAAC,KAAA,EAAA,EAAA,EAGwBP,EAAA,EAAAV,EAAA,QAAAgB,EAAAiB,IAAA,EAAoBvB,EAAA,EAAAwB,EAAAlB,EAAAiB,IAAA,EAG5CvB,EAAA,CAAA,EAAAsB,EAAAhB,EAAAmB,aAAA,GAAA,EAAA,EAGAzB,EAAA,EAAAsB,EAAAhB,EAAAoB,YAAA,GAAA,EAAA,6BAzBV/B,EAAA,EAAA,IAAA,EACEqB,EAAA,EAAAW,GAAA,EAAA,EAAA,IAAA,EAQA/B,EAAA,EAAAgC,GAAA,GAAA,EAAA,KAAA,KAAA9B,CAAA,EAwBFC,EAAA,kBAhCEC,EAAA,EAAAsB,EAAApB,EAAA2B,eAAA,EAAAC,SAAA,EAAA,EAAA,EAAA,EAQA9B,EAAA,EAAAC,EAAAC,EAAA2B,eAAA,CAAgB,yBA+BdzB,EAAA,EAAA,MAAA,EAAA,qCAGAT,EAAA,EAAA,WAAA,EAAA,EAA8Bc,EAAA,QAAA,UAAA,CAAAC,EAAAqB,CAAA,EAAA,IAAAC,EAAAnB,EAAA,EAAAoB,KAAA/B,EAAAW,EAAA,EAAA,OAAAC,EAASZ,EAAAgC,OAAAF,EAAAZ,EAAA,CAAe,CAAA,CAAA,EACpDf,EAAA,CAAA,EACFN,EAAA,+BADEC,EAAA,EAAAQ,GAAA,IAAAN,EAAAiC,QAAAC,SAAAJ,EAAAZ,EAAA,EAAA,sBAAA,uBAAA,GAAA,0BAUEzB,EAAA,EAAA,WAAA,EAAA,EAA8CU,EAAA,EAAA,gBAAA,EAAcN,EAAA,0BAG5DJ,EAAA,EAAA,WAAA,EAAA,EAA8CU,EAAA,EAAA,QAAA,EAAMN,EAAA,yBAQxDZ,EAAA,CAAA,2BAAAC,EAAA,EAAAiD,GAAA,EAAA,EAAA,eAAA,CAAA,0CAAe/C,EAAA,mBAAAC,CAAA,EAAmC,0BAAAC,GAAA,EAAAC,GAAA6C,CAAA,CAAA,6BAFpD3C,EAAA,EAAA,IAAA,EACEC,EAAA,EAAA2C,GAAA,EAAA,EAAA,eAAA,KAAAzC,CAAA,EAGFC,EAAA,uBAHEC,EAAA,EAAAC,EAAA+B,EAAAQ,QAAA,sCA3BJ7C,EAAA,EAAA,IAAA,EAAI,EAAA,MAAA,EAAA,EAEAqB,EAAA,EAAAyB,GAAA,EAAA,EAAA,MAAA,EAAA,EAGAzB,EAAA,EAAA0B,GAAA,EAAA,EAAA,WAAA,EAAA,EAKA/C,EAAA,EAAA,MAAA,EAAA,EAA2Ec,EAAA,QAAA,UAAA,CAAA,IAAAuB,EAAAtB,EAAAiC,CAAA,EAAAV,KAAA/B,EAAAW,EAAA,EAAA,OAAAC,EAASZ,EAAAa,OAAAiB,CAAA,CAAY,CAAA,CAAA,EAC9FrC,EAAA,EAAA,MAAA,EAAA,EACES,EAAA,EAAA,WAAA,EAAA,EACAT,EAAA,EAAA,MAAA,EAAMU,EAAA,CAAA,EAAeN,EAAA,EAAO,EAE9BJ,EAAA,EAAA,MAAA,EAAA,EACEqB,EAAA,GAAA4B,GAAA,EAAA,EAAA,WAAA,EAAA,EAGA5B,EAAA,GAAA6B,GAAA,EAAA,EAAA,WAAA,EAAA,EAGF9C,EAAA,EAAM,EACF,EAERiB,EAAA,GAAA8B,GAAA,EAAA,EAAA,IAAA,EAOF/C,EAAA,6BA9BIC,EAAA,CAAA,EAAAsB,EAAAU,EAAAQ,SAAAV,SAAA,EAAA,EAAA,EAAA,EAGA9B,EAAA,EAAAsB,EAAAU,EAAAQ,SAAAV,OAAA,EAAA,EAAA,EAAA,EAKwB9B,EAAA,EAAAV,EAAA,UAAA0C,EAAAZ,KAAAlB,EAAAmB,SAAA,WAAA,EAAA,EAGdrB,EAAA,CAAA,EAAAwB,EAAAQ,EAAAT,IAAA,EAGNvB,EAAA,CAAA,EAAAsB,EAAAU,EAAAe,UAAA,GAAA,EAAA,EAGA/C,EAAA,EAAAsB,EAAAU,EAAAN,YAAA,GAAA,EAAA,EAMN1B,EAAA,EAAAsB,EAAAU,EAAAQ,SAAAV,OAAA,GAAA5B,EAAAiC,QAAAC,SAAAJ,EAAAZ,EAAA,EAAA,GAAA,EAAA,GDjDR,IAAa4B,IAAmB,IAAA,CAA1B,MAAOA,CAAmB,CAgB9BC,YACmCC,EACzBC,EACAC,EAA2B,CAFF,KAAAF,WAAAA,EACzB,KAAAC,OAAAA,EACA,KAAAC,UAAAA,EAfV,KAAAC,WAAaC,EAAe,EAAE,EAC9B,KAAAC,YAAcD,EAAyB,CAAA,CAAE,EACzC,KAAAnD,KAAOmD,EAAuB,CAAA,CAAE,EAEhC,KAAAzB,eAAiB2B,EAAS,IAAK,CAC7B,IAAMH,EAAa,KAAKA,WAAU,EAElC,OADoB,KAAKE,YAAW,EACjBE,OAAOC,GAAQA,EAAKnC,KAAKoC,kBAAiB,EAAGvB,SAASiB,EAAWM,kBAAiB,CAAE,CAAC,CAC1G,CAAC,EAEO,KAAAC,aAAeC,GAAUC,EAAY,CAMzC,CAEJC,UAAQ,CACN,KAAK1C,SAAW,KAAK2C,oBAAmB,EACxC,KAAK7B,QAAU,CAAA,EAEf,KAAK8B,WAAU,CACjB,CAEAC,UAAUb,EAAkB,CAC1B,KAAKA,WAAWc,IAAId,CAAU,CAChC,CAEAtC,OAAOkB,EAAmC,CAEpCA,EAAKb,IAAM,QACX,CAACa,EAAKP,aAAe,CAACO,EAAKR,eAEzB,CADO2C,OAAOC,QAAQ,KAAKjB,UAAUkB,QAAQ,uDAAuD,CAAC,GAG3G,KAAKC,YAAYtC,EAAKb,EAAE,EAC1B,CAEAc,OAAOsC,EAAc,CACnBC,GAAaC,cAAcF,EAAQ,KAAKrC,OAAO,CACjD,CAEQoC,YAAYC,EAAe,CACjC,GAAIA,GAAU,KAAM,CAClB,KAAKrB,OAAOwB,MAAK,EACjB,MACF,CAEA,IAAM1C,EAAO,KAAKsB,YAAW,EAAGqB,KAAKC,GAAKA,EAAEzD,KAAOoD,CAAM,EACnDM,EAA2B,CAC/B1D,GAAIa,EAAKb,GAAG2D,SAAQ,EACpBxD,KAAMU,EAAKV,MAEb,KAAK4B,OAAOwB,MAAMG,CAAM,CAC1B,CAEQb,YAAU,CAChB,IAAMe,EAAS,UAEf,KAAKpB,aAAaqB,aAAa,uBADhB,qBACgD,IAAI,EAAEC,UAAU,CAC7EC,KAAOC,GAAQ,CACb,GAAI,CAACA,EAAM,CACTC,QAAQC,MAAM,KAAKlC,UAAUkB,QAAQ,gCAAgC,CAAC,EACtE,MACF,CACA,GAAI,CAACc,EAAKJ,CAAM,EAAG,CACjBK,QAAQC,MAAM,KAAKlC,UAAUkB,QAAQ,mCAAmC,EAAI,IAAMU,CAAM,EACxF,MACF,CACA,IAAMO,EAAQH,EAAKJ,CAAM,EACnBzB,EAAciC,GAAgBD,CAAK,EACzC,KAAKhC,YAAYY,IAAIZ,CAAW,EAChC,IAAMpD,EAAOsF,GAAcF,CAAK,EAChC,KAAKpF,KAAKgE,IAAIhE,CAAI,CACpB,EACAmF,MAAQA,GAAS,CACfD,QAAQC,MAAMA,CAAK,EACnBD,QAAQC,MAAM,GAAG,KAAKlC,UAAUkB,QAAQ,0BAA0B,CAAC,MAAMgB,EAAMF,IAAI,EAAE,CACvF,EACD,CACH,CAEQpB,qBAAmB,CACzB,IAAM0B,EAAS,QACXC,EAAyB,KAAKzC,WAAW0C,MAAMC,SAAS,KAAK3C,WAAW4C,OAAOC,SAAS,EAAEC,MAC9F,GAAI,OAAOL,GAAe,WAE1BA,EAAaA,EAAWM,KAAI,EAAGtC,kBAAiB,EAC5C,EAACgC,EAAWO,WAAWR,CAAM,GAEjC,GAAI,CAEF,OADWS,SAASR,EAAWS,MAAMV,CAAM,EAAE,CAAC,EAAG,EAAE,CAErD,MAAQ,CACN,MACF,CACF,iDArGW1C,GAAmBqD,EAiBpBC,EAAe,EAAAD,EAAAE,EAAA,EAAAF,EAAAG,EAAA,CAAA,CAAA,CAAA,gCAjBdxD,EAAmByD,UAAA,CAAA,CAAA,iBAAA,CAAA,EAAAC,MAAA,GAAAC,KAAA,EAAAC,OAAA,CAAA,CAAA,kBAAA,EAAA,EAAA,CAAA,EAAA,YAAA,EAAA,CAAA,EAAA,mBAAA,EAAA,CAAA,EAAA,0BAAA,EAAA,CAAA,EAAA,oBAAA,EAAA,CAAA,EAAA,iBAAA,EAAA,CAAA,QAAA,SAAA,EAAA,oBAAA,EAAA,CAAA,WAAA,GAAA,EAAA,gBAAA,SAAA,EAAA,CAAA,EAAA,eAAA,EAAA,CAAA,EAAA,mBAAA,yBAAA,EAAA,CAAA,EAAA,UAAA,EAAA,CAAA,EAAA,WAAA,EAAA,CAAA,EAAA,aAAA,EAAA,QAAA,SAAA,EAAA,CAAA,EAAA,oBAAA,EAAA,CAAA,UAAA,OAAA,EAAA,WAAA,EAAA,CAAA,EAAA,YAAA,EAAA,OAAA,EAAA,CAAA,EAAA,YAAA,EAAA,OAAA,EAAA,CAAA,EAAA,YAAA,EAAA,CAAA,EAAA,6BAAA,EAAA,CAAA,EAAA,aAAA,EAAA,CAAA,EAAA,cAAA,EAAA,OAAA,CAAA,EAAAC,SAAA,SAAAC,EAAAC,EAAA,CAAA,GAAAD,EAAA,EAAA,WCjChCnH,EAAA,EAAA,MAAA,CAAA,EAAwB,EAAA,MAAA,CAAA,EACS,EAAA,MAAA,CAAA,EACSU,EAAA,CAAA,oBAAqDN,EAAA,EAAM,EAEnGJ,EAAA,EAAA,MAAA,CAAA,EAAgC,EAAA,MAAA,CAAA,EACD,EAAA,iBAAA,CAAA,EAC+B,EAAA,WAAA,EAC7CU,EAAA,EAAA,QAAA,EAAMN,EAAA,EACjBJ,EAAA,GAAA,QAAA,CAAA,EAAyCc,EAAA,gBAAA,SAAAuG,EAAA,CAAAC,OAAAvG,EAAAwG,CAAA,EAAApG,EAAiBiG,EAAA7C,UAAA8C,CAAA,CAAiB,CAAA,CAAA,EAA3EjH,EAAA,EAA6E,EAC9D,EAEnBJ,EAAA,GAAA,MAAA,CAAA,EACEqB,EAAA,GAAAmG,GAAA,EAAA,EAAA,IAAA,EAOAnG,EAAA,GAAAoG,GAAA,EAAA,EAAA,IAAA,EAoCFrH,EAAA,EACAX,EAAA,GAAAiI,GAAA,GAAA,EAAA,cAAA,KAAA,EAAAC,EAAA,EAmCFvH,EAAA,EACAK,EAAA,GAAA,oBAAA,EAEFL,EAAA,QA5F0CC,EAAA,CAAA,EAAAwB,EAAA+F,GAAA,EAAA,EAAA,mCAAA,CAAA,EAMlBvH,EAAA,CAAA,EAAAV,EAAA,UAAAyH,EAAA1D,WAAA,CAAA,EAIlBrD,EAAA,CAAA,EAAAsB,EAAAyF,EAAA1D,WAAA,EAAA,GAAA,EAAA,EAOArD,EAAA,EAAAsB,EAAAyF,EAAA1D,WAAA,EAAA,GAAA,EAAA,kBDGEmE,GAAkBC,GAAAC,GAClBC,GAAcC,GACdC,GAAWC,GAAAC,GAAAC,GACXC,GACAC,GACAC,GAAaC,GACbC,GACAC,GACAC,GAAcC,EAAA,EAAAC,OAAA,CAAA;qDAAA,CAAA,CAAA,CAAA,SAGTzF,CAAmB,GAAA,EExB1B,IAAO0F,GAAP,KAAiB,CACrB,OAAOC,KACLC,EACAC,EACAC,EACAC,EACAC,EACAC,EAA2C,CAE3C,IAAMC,EAAmC,CACvCN,OAAAA,EACAC,MAAAA,GAEgBC,EAAUH,KAAKQ,GAAqB,CACpDC,UAAW,GACXC,KAAMH,EACNH,iBAAAA,EACAO,OAAQ,MACRC,MAAO,QACR,EAESC,YAAW,EAAGC,KAAKC,GAAK,CAAC,CAAC,EAAEC,UAAWC,GAA2B,CAC1EX,EAASW,CAAK,CAChB,CAAC,EAEDZ,EAAkBa,aAAY,CAChC,GCnCI,IAAOC,GAAP,KAAqB,CAEjB,OAAOC,gBAAgBC,EAAmBC,EAAoB,CAEpE,GAAI,CAACD,EAAa,OAAOA,EAEzB,KAAOA,EAAUE,UAAU,EAAG,CAAC,IAAMD,GACnCD,EAAYA,EAAUE,UAAU,CAAC,EAEnC,OAAOF,CACT,CAEQ,OAAOG,cAAcH,EAAmBC,EAAoB,CAElE,GAAI,CAACD,EAAa,OAAOA,EAEzB,KAAOA,EAAUE,UAAUF,EAAUI,OAAS,EAAGJ,EAAUI,MAAM,IAAMH,GACrED,EAAYA,EAAUE,UAAU,EAAGF,EAAUI,OAAS,CAAC,EAEzD,OAAOJ,CACT,CAEQ,OAAOK,aAAaL,EAAiB,CAE3C,GAAI,CAACA,EAAa,OAAOA,EAEzB,IAAMM,EAAW,IACXC,EAAY,mBACZC,EAAY,wBACZC,EAAa,QACbC,EAAoB,gDACpBC,EAAoB,UAC1B,OAAOX,EACJY,QAAQL,EAAWD,CAAQ,EAC3BM,QAAQJ,EAAWF,CAAQ,EAC3BM,QAAQH,EAAYH,CAAQ,EAC5BM,QAAQF,EAAmBJ,CAAQ,EACnCM,QAAQD,EAAmBL,CAAQ,CACxC,CAGA,OAAOO,aAAab,EAAiB,CAEnC,OAAKA,IAGLA,EAAY,KAAKD,gBAAgBC,EAAW,GAAI,EAGhDA,EAAY,KAAKG,cAAcH,EAAW,GAAI,EAG9CA,EAAY,KAAKD,gBAAgBC,EAAW,IAAI,EAGhDA,EAAY,KAAKG,cAAcH,EAAW,IAAI,EAG9CA,EAAY,KAAKK,aAAaL,CAAS,EAEhCA,EACT,CAGA,OAAOc,aAAad,EAAiB,CAEnC,GAAI,CAACA,EAAa,OAAOA,EAIzB,IAAMe,EAAc,IACdR,EAAY,MAClB,OAAO,KAAKM,aAAab,CAAS,EAAEY,QAAQL,EAAWQ,CAAW,CACpE,GC9DI,IAAgBC,EAAhB,MAAgBA,CAAe,CAInCC,YAAYC,EAAgB,CAO5B,KAAAC,GAASC,EAAgC,QAAS,CAAA,CAA0B,EAG5E,KAAAC,GAAQC,EAAY,OAAQ,IAAMC,OAAOC,OAAO,KAAKL,GAAM,CAAE,CAAa,EAahE,KAAAM,MAAiCC,GAAUA,EAAaC,GAExD,KAAAC,YAAyCF,GAASA,EAqG5D,KAAAG,GAAoB,IAAIC,EAAkC,MAAM,EA7H9D,KAAKZ,IAAMA,GAAOa,EAAS,CAACf,gBAAAA,CAAe,CAAC,EAC5C,KAAKE,IAAIc,EAAE,yBAAyB,EACpC,KAAKC,KAAO,KAAKf,IAAIe,IACvB,CAGAd,GAGAE,GAGA,IAAca,OAAK,CAAmC,OAAO,KAAKf,EAAQ,CAG1E,IAAcgB,MAAI,CAAuB,OAAO,KAAKd,EAAO,CAgB5De,IAAIV,EAAY,CACd,IAAMW,EAAI,KAAKnB,IAAIoB,GAAG,MAAO,CAAEZ,KAAAA,CAAI,CAAE,EACrC,GAAI,CAACA,EACH,OAAOW,EAAEE,IAAI,cAAc,EAG7B,KAAKpB,GAAOqB,IAAIC,EAAAC,EAAA,GACX,KAAKvB,GAAM,GADA,CAEd,CAAC,KAAKM,MAAMC,CAAI,CAAC,EAAG,KAAKE,YAAYF,CAAI,GAC1C,EACDW,EAAEE,IAAI,OAAO,CACf,CAEAI,QAAQC,EAAe,CACrB,IAAIP,EAAI,KAAKnB,IAAIoB,GAAG,UAAW,CAAEM,MAAAA,CAAK,CAAE,EACxC,GAAI,CAACA,GAASA,EAAMC,QAAU,EAC5B,OAAOR,EAAEE,IAAI,wBAAwB,EAGvC,IAAMO,EAASF,EAAMG,OAAO,CAACC,EAAKtB,IAAUe,EAAAC,EAAA,GACvCM,GADuC,CAE1C,CAAC,KAAKvB,MAAMC,CAAI,CAAC,EAAG,KAAKE,YAAYF,CAAI,IACvCgB,EAAA,GAAK,KAAKvB,GAAM,EAAI,EAExB,KAAKA,GAAOqB,IAAIM,CAAM,EACtBT,EAAEE,IAAI,OAAO,CACf,CAEAU,OAAOtB,EAAUD,EAAqB,CACpC,IAAMW,EAAI,KAAKnB,IAAIoB,GAAG,SAAU,CAAEX,GAAAA,EAAID,KAAAA,CAAI,CAAE,EAC5C,GAAI,CAACC,GAAM,CAACD,EACV,OAAOW,EAAEE,IAAI,oBAAoB,EAEnC,IAAMW,EAAS,KAAKC,IAAIxB,CAAE,EAC1B,GAAI,CAACuB,EACH,OAAOb,EAAEE,IAAI,gBAAgBZ,CAAE,qBAAqB,EAGtD,IAAMyB,EAAUV,IAAA,GAAKQ,GAAWxB,GAGhC,KAAKP,GAAOqB,IAAIC,EAAAC,EAAA,GACX,KAAKvB,GAAM,GADA,CAEd,CAACQ,CAAE,EAAGyB,GACP,EACDf,EAAEE,IAAI,SAAS,CACjB,CAEAc,OAAO1B,EAAQ,CACb,IAAMU,EAAI,KAAKnB,IAAIoB,GAAG,SAAU,CAAEX,GAAAA,CAAE,CAAE,EACD2B,EAAA,KAAKnC,GAAM,EAAvCQ,CAhGb,CAgGaA,GAAK4B,CAhGlB,EAgGyCD,EAAjBE,EAAAA,GAAiBF,EAAjBE,CAAX7B,GAAAA,KACT,KAAKR,GAAOqB,IAAIgB,CAAoC,EACpDnB,EAAEE,IAAI,SAAS,CACjB,CAEAkB,YAAU,CACR,IAAMpB,EAAI,KAAKnB,IAAIoB,GAAG,YAAY,EAClC,KAAKnB,GAAOqB,IAAI,CAAA,CAA0B,EAC1CH,EAAEE,IAAI,SAAS,CACjB,CAMAY,IAAIxB,EAAQ,CACV,IAAMmB,EAAS,KAAK3B,GAAM,EAAGQ,CAAE,EAC/B,YAAKT,IAAIc,EAAE,OAAOL,CAAE,QAAUmB,GAAU,KAAO,MAAQ,IAAM,OAAO,EAC7DA,CACT,CAEAY,QAAM,CACJ,IAAMZ,EAAS,KAAKzB,GAAK,EACzB,YAAKH,IAAIc,EAAE,oBAAyBc,EAAOD,MAAM,QAAQ,EAClDC,CACT,CAEAa,QAAQC,EAAW,CACjB,IAAMvB,EAAI,KAAKnB,IAAIoB,GAAG,UAAW,CAAEsB,IAAAA,CAAG,CAAE,EAClCd,EAASc,EACZC,IAAIlC,GAAM,KAAKR,GAAM,EAAGQ,CAAE,CAAC,EAC3BmC,OAAOpC,GAAQA,GAAQ,IAAI,EAC9B,OAAOW,EAAE0B,EAAEjB,EAAQ,SAASA,EAAOD,MAAM,QAAQ,CACnD,CAMAmB,UAAUrC,EAAQ,CAChB,IAAMmB,EAAS,KAAKjB,GAAkBoC,oBAAoBtC,EAAI,IAAM,KAAKwB,IAAIxB,CAAE,CAAC,EAChF,YAAKT,IAAIc,EAAE,aAAaL,CAAE,IAAK,CAAEuC,MAAOpB,EAAOoB,KAAK,CAAE,EAC/CpB,EAAOqB,MAChB,CACAtC,GAGAuC,cAAcR,EAAW,CACvB,IAAMS,EAAM/C,EAAY,UAAW,IAAMsC,EAAIC,IAAIlC,GAAM,KAAKwB,IAAIxB,CAAE,CAAC,EAAEmC,OAAOpC,GAAQA,GAAQ,IAAI,CAAC,EACjG,YAAKR,IAAIc,EAAE,kBAAmB,CAAE4B,IAAAA,CAAG,CAAE,EAC9BS,CACT,CAEAC,cAAY,CACV,IAAMnC,EAAO,KAAKd,GAClB,YAAKH,IAAIc,EAAE,0BAA0BG,EAAI,EAAGU,MAAM,QAAQ,EACnDV,CACT,GCrJI,IAAgBoC,EAAhB,cAAwFC,CAA6B,CAGzHC,GAAUC,GAAa,KAAKC,KAAK,EAEjCC,GAASF,GAAa,KAAKG,IAAI,EAG/B,IAAcC,QAAM,CAClB,OAAO,KAAKL,EACd,CAEA,IAAcM,OAAK,CACjB,OAAO,KAAKH,EACd,CAEAI,UAAQ,CACN,OAAO,KAAKD,KACd,CAEAE,SAASC,EAAY,CACnB,OAAO,KAAKJ,OAAOK,KACjBC,EAAgBC,GAAOH,EAAII,IAAIC,GAAMF,EAAIE,CAAE,CAAC,EAAEC,OAAOC,GAAKA,GAAK,IAAI,CAAC,CAAC,CAEzE,GCpBF,IAAMC,GAAW,CACfC,UAAW,GACXC,YAAa,GACbC,gBAAiB,IAINC,IAAoB,IAAA,CAA3B,MAAOA,UAA4BC,CAAsD,CAE7FC,aAAA,CACE,MAAMC,EAAS,CAACH,oBAAAA,CAAmB,EAAGJ,EAAQ,CAAC,EAG9B,KAAAQ,MAASC,GAA8BA,EAAKC,OAE5C,KAAAC,YAAeF,GAA+BG,EAAAC,EAAAD,EAAA,GAC5DE,EAAaC,OAD+C,CAE/DC,QAASP,EAAKQ,UACXR,GAkCL,KAAAS,GAAqB,IAAIC,EAA0C,cAAc,EAejF,KAAAC,GAA0B,IAAID,EAAqC,YAAY,CAxD/E,CAUAE,QAAQX,EAAgBY,EAAiBL,EAAiBM,EAAmB,CAC3E,KAAKC,IAAI,CACPd,OAAAA,EACAO,QAAAA,EACAD,QAASC,EACTK,QAAAA,EACAC,WAAAA,EAC6B,CACjC,CAEAE,WAAWf,EAAgBgB,EAAmB,CAC5C,KAAKC,OAAOjB,EAAQ,CAAEO,QAASS,CAAW,CAAyC,CACrF,CASAE,gBAAgBlB,EAAc,CAC5B,IAAMmB,EAAI,KAAKC,IAAIC,KAAK,YAAa,CAAErB,OAAAA,CAAM,CAAE,EAEzCsB,EAAM,KAAKd,GAAmBe,oBAAoBvB,EAAQ,IAAK,CACnE,IAAMwB,EAAW,KAAKC,UAAUzB,CAAM,EAAC,GAAMI,EAAaC,MAAK,EACzDqB,EAAK,KAAKN,IAAIC,KAAK,kBAAmB,CAAEG,SAAAA,CAAQ,CAAE,EACxD,OAAO,IAAIG,EAAaH,CAAQ,CAClC,CAAC,EACD,OAAOL,EAAES,QAAQN,EAAIO,OAAQ,UAAUP,EAAIQ,KAAK,EAAE,CACpD,CACAtB,GAGAuB,aAAa/B,EAAc,CACzB,OAAO,KAAKgC,OAAOC,KACjBC,GAAIC,GAAqBA,EAAkBnC,CAAM,CAAC,EAClDoC,EAAgBC,GAAKA,CAAC,EACtBC,GAAY,CAAC,CAAC,CAElB,CAGAC,oBAAoBvC,EAAc,CAChC,OAAO,KAAKU,GAAwB8B,YAAYxC,EAAQ,IAAM,KAAKyC,MAAK,EAAGzC,CAAM,GAAGa,YAAc,EAAK,CACzG,CACAH,GAIAgC,iBAAiB1C,EAAgBa,EAAmB,CAClD,KAAKI,OAAOjB,EAAQ,CAAEa,WAAAA,CAAU,CAAyC,CAC3E,iDAlEWnB,EAAmB,CAAA,iCAAnBA,EAAmBiD,QAAnBjD,EAAmBkD,UAAAC,WADN,MAAM,CAAA,CAAA,SACnBnD,CAAoB,GAAA",
  "names": ["FieldState", "constructor", "name", "config", "group", "settings", "basics", "ui", "uiValue", "translationState", "isOpen", "pickerData", "featuresSvc", "injectorForEffects", "#reqFeaturesMy", "signalObj", "#reqFeaturesFromSettings", "setting", "requiredFeatures", "computedObj", "merged", "Array", "from", "Set", "#pickerData", "effect", "reqFeaturesFromSettings", "length", "feature", "requireFeature", "injector", "Error", "settingExt", "current", "includes", "set", "isNotExpectedType", "correctNames", "inputType", "InputType", "FormConfigService", "constructor", "log", "classLog", "configSignal", "signal", "context", "inject", "Context", "languageService", "FormLanguageService", "initFormConfig", "dialogContext", "formId", "isParentDialog", "itemGuids", "createMode", "isCopy", "enableHistory", "settings", "languages", "initial", "Language", "Current", "primary", "Primary", "list", "List", "saveSettingsFromUrl", "sessionStorage", "getItem", "keySettings", "saveValue", "JSON", "parse", "save", "mode", "path", "config", "zoneId", "appId", "appRoot", "App", "Url", "appSharedRoot", "SharedUrl", "moduleId", "toString", "partOfPage", "keyPartOfPage", "partOfPageDefault", "portalRoot", "Site", "tabId", "systemRoot", "window", "location", "pathname", "split", "versioningOptions", "getVersioningOptions", "keyPublishing", "enableFormulaSave", "Enable", "FormulaSave", "removeEditRestrictions", "OverrideEditRestrictions", "set", "language", "getSignal", "publishing", "allowAll", "show", "hide", "branch", "publish", "console", "error", "language$", "_language$", "getLanguage$", "factory", "\u0275fac", "logSpecs", "all", "initSignal", "watchAllFields", "FieldsFindNoPrefix", "FieldUnwrap", "FieldMask", "ServiceBase", "#fieldState", "#formConfig", "constructor", "injector", "log", "classLog", "logSpecs", "inject", "FieldState", "FormConfigService", "result", "signal", "#controls", "group", "controls", "#fieldConfig", "config", "#requirePrefix", "#maskSignal", "#mask", "computed", "#fieldsUsedInMask", "#extractFieldNames", "a", "initPreClean", "overloadPreCleanValues", "preClean", "init", "name", "mask", "requirePrefix", "initSignal", "extendName", "l", "fnIf", "set", "#updateMaskFinal", "r", "logChanges", "enabled", "effect", "#watchAllFields", "#onChange", "#process", "hasPlaceholders", "value", "lowercaseInsideSquareBrackets", "replace", "appId", "toString", "zoneId", "entityGuid", "entityId", "dataPlaceholders", "data", "forEach", "e", "i", "replaceValue", "cleaned", "toLowerCase", "matches", "match", "FieldsFindNoPrefix", "map", "token", "key", "maybeNew", "end", "f", "filter", "length", "c", "subscriptions", "add", "valueChanges", "subscribe", "_", "\u0275\u0275inject", "Injector", "factory", "\u0275fac", "includes", "FormLanguage", "bothPrimary", "original", "current", "primary", "diffCurrent", "empty", "initial", "DimensionReader", "constructor", "dimensions", "language", "hasCurrentWrite", "find", "d", "dimCode", "current", "primary", "hasCurrentReadOnly", "currentRO", "undefined", "hasCurrent", "logSpecs", "all", "constructor", "FieldReader", "field", "language", "log", "classLog", "#noData", "fnIf", "#field", "#language", "current", "primary", "#values", "Values", "length", "ofLanguage", "currentOrDefault", "FormLanguage", "bothPrimary", "currentOrDefaultOrAny", "filter", "val", "DimensionReader", "dimensions", "hasCurrent", "hasPrimary", "find", "d", "dimCode", "hasCurrentReadonly", "hasCurrentReadOnly", "hasEditableValues", "#valuesEditableOf", "countEditable", "countEditableWithContents", "v", "value", "hasCurrentWrite", "currentEditable", "dimension", "x", "isEditableOrReadonlyTranslationExist", "ContentTypeSettingsHelpers", "getDefaultSettings", "reader", "contentType", "itemHeader", "metadata", "flatten", "Metadata", "defaultSettings", "__spreadValues", "Description", "EditInstructions", "Features", "Label", "ListInstructions", "Notes", "Icon", "Link", "_itemTitle", "getTitle", "_slotCanBeEmpty", "IsEmptyAllowed", "_slotIsEmpty", "IsEmpty", "language", "type", "find", "Type", "Name", "label", "FieldReader", "Attributes", "currentOrDefault", "value", "logSpecs", "all", "constructor", "EntityReader", "current", "primary", "log", "classLog", "fnIf", "getBestValue", "attributeValues", "defaultValue", "FieldReader", "currentOrDefaultOrAny", "value", "flatten", "metadata", "metadataItems", "Array", "isArray", "length", "merged", "item", "Type", "Id", "name", "values", "Object", "entries", "Attributes", "exists", "emptyAll", "currentValues", "itemAttributes", "reduce", "acc", "FileTypeHelpers", "defaultIcon", "customExtensions", "doc", "docx", "xls", "xlsx", "ppt", "pptx", "pdf", "mp3", "avi", "mpg", "mpeg", "mov", "mp4", "zip", "rar", "txt", "html", "css", "xml", "xsl", "matExtensions", "vcf", "getExtension", "filename", "substring", "lastIndexOf", "toLocaleLowerCase", "getIconClass", "ext", "isKnownType", "isImage", "isImgRegex", "test", "FieldDefaults", "constructor", "name", "inputType", "settings", "itemHeader", "log", "classLog", "getDefaultOrPrefillValue", "onlyPrefill", "l", "fn", "prefillRaw", "Prefill", "undefined", "rNull", "defaultValue", "toString", "DefaultValue", "values", "InputTypeCatalog", "BooleanDefault", "toLowerCase", "BooleanTristate", "DateTimeDefault", "Date", "toJSON", "NumberDefault", "NumberDropdown", "NumberPicker", "isNaN", "Number", "EntityDefault", "EntityQuery", "EntityContentBlocks", "EntityPicker", "includes", "replace", "guids", "split", "map", "guid", "trim", "JSON", "stringify", "startsWith", "parse", "buildPageSearch", "pages", "map", "page", "path", "Path", "trim", "replace", "startsWith", "substring", "split", "slice", "join", "id", "Id", "name", "Name", "isNavigation", "IsNavigation", "isClickable", "IsClickable", "buildPageTree", "items", "children", "parentId", "ParentId", "tree", "item", "push", "parent", "find", "i", "\u0275\u0275elementContainer", "\u0275\u0275template", "PagePickerComponent_Conditional_12_For_2_ng_container_0_Template", "\u0275\u0275property", "pageAndChildren_r3", "\u0275\u0275pureFunction1", "_c0", "page_r2", "\u0275\u0275elementStart", "\u0275\u0275repeaterCreate", "PagePickerComponent_Conditional_12_For_2_Template", "\u0275\u0275repeaterTrackByIdentity", "\u0275\u0275elementEnd", "\u0275\u0275advance", "\u0275\u0275repeater", "ctx_r3", "tree", "\u0275\u0275element", "\u0275\u0275text", "page_r6", "path", "\u0275\u0275textInterpolate1", "\u0275\u0275listener", "\u0275\u0275restoreView", "_r5", "$implicit", "\u0275\u0275nextContext", "\u0275\u0275resetView", "select", "\u0275\u0275conditionalCreate", "PagePickerComponent_Conditional_13_For_3_Conditional_6_Template", "PagePickerComponent_Conditional_13_For_3_Conditional_10_Template", "PagePickerComponent_Conditional_13_For_3_Conditional_11_Template", "id", "selected", "\u0275\u0275conditional", "name", "\u0275\u0275textInterpolate", "isNavigation", "isClickable", "PagePickerComponent_Conditional_13_Conditional_1_Template", "PagePickerComponent_Conditional_13_For_3_Template", "filteredSearch", "length", "_r8", "page_r9", "page", "toggle", "toggled", "includes", "PagePickerComponent_ng_template_14_Conditional_12_For_2_ng_container_0_Template", "child_r10", "PagePickerComponent_ng_template_14_Conditional_12_For_2_Template", "children", "PagePickerComponent_ng_template_14_Conditional_2_Template", "PagePickerComponent_ng_template_14_Conditional_3_Template", "_r7", "PagePickerComponent_ng_template_14_Conditional_10_Template", "PagePickerComponent_ng_template_14_Conditional_11_Template", "PagePickerComponent_ng_template_14_Conditional_12_Template", "isVisible", "PagePickerComponent", "constructor", "dialogData", "dialog", "translate", "filterText", "signal", "searchItems", "computed", "filter", "item", "toLocaleLowerCase", "queryService", "transient", "QueryService", "ngOnInit", "parseSelectedPageId", "fetchPages", "setFilter", "set", "window", "confirm", "instant", "closeDialog", "pageId", "ArrayHelpers", "toggleInArray", "close", "find", "i", "result", "toString", "stream", "getFromQuery", "subscribe", "next", "data", "console", "error", "pages", "buildPageSearch", "buildPageTree", "prefix", "fieldValue", "group", "controls", "config", "fieldName", "value", "trim", "startsWith", "parseInt", "split", "\u0275\u0275directiveInject", "MAT_DIALOG_DATA", "MatDialogRef", "TranslateService", "selectors", "decls", "vars", "consts", "template", "rf", "ctx", "$event", "i0", "_r1", "PagePickerComponent_Conditional_12_Template", "PagePickerComponent_Conditional_13_Template", "PagePickerComponent_ng_template_14_Template", "\u0275\u0275templateRefExtractor", "\u0275\u0275pipeBind1", "MatFormFieldModule", "MatFormField", "MatLabel", "MatInputModule", "MatInput", "FormsModule", "DefaultValueAccessor", "NgControlStatus", "NgModel", "NgTemplateOutlet", "NgClass", "MatIconModule", "MatIcon", "MatDialogActions", "TranslateModule", "TippyDirective", "TranslatePipe", "styles", "PagePicker", "open", "config", "group", "matDialog", "viewContainerRef", "changeDetectorRef", "callback", "dialogData", "PagePickerComponent", "autoFocus", "data", "height", "width", "afterClosed", "pipe", "take", "subscribe", "value", "markForCheck", "SanitizeHelper", "removeFromStart", "sanitized", "charToRemove", "substring", "removeFromEnd", "length", "cleanBadPath", "goodChar", "illegalRe", "controlRe", "reservedRe", "windowsReservedRe", "windowsTrailingRe", "replace", "sanitizePath", "sanitizeName", "replacement", "SignalStoreBase", "constructor", "log", "#cache", "signalObj", "#list", "computedObj", "Object", "values", "getId", "item", "id", "sanitizeAdd", "#itemSignalsCache", "ComputedCacheHelper", "classLog", "a", "name", "cache", "list", "add", "l", "fn", "end", "set", "__spreadProps", "__spreadValues", "addMany", "items", "length", "result", "reduce", "acc", "update", "before", "get", "newItem", "remove", "_a", "_", "updatedStore", "clearCache", "getAll", "getMany", "ids", "map", "filter", "r", "getSignal", "getOrCreateWithInfo", "isNew", "signal", "getManySignal", "sig", "getAllSignal", "SignalStoreObservableBase", "SignalStoreBase", "#cache$", "toObservable", "cache", "#list$", "list", "cache$", "list$", "getList$", "getMany$", "ids", "pipe", "mapUntilChanged", "obj", "map", "id", "filter", "m", "logSpecs", "getReader", "getLanguage", "getReaderSignal", "FormLanguageService", "SignalStoreObservableBase", "constructor", "classLog", "getId", "item", "formId", "sanitizeAdd", "__spreadValues", "__spreadProps", "FormLanguage", "empty", "initial", "current", "#entityReaderCache", "ComputedCacheHelper", "#signalsHideHeaderCache", "addForm", "primary", "hideHeader", "add", "setCurrent", "newLanguage", "update", "getEntityReader", "l", "log", "fnIf", "sig", "getOrCreateWithInfo", "language", "getSignal", "l2", "EntityReader", "rSilent", "signal", "isNew", "getLanguage$", "cache$", "pipe", "map", "languageInstances", "mapUntilChanged", "m", "shareReplay", "getHideHeaderSignal", "getOrCreate", "cache", "updateHideHeader", "factory", "\u0275fac", "providedIn"]
}
