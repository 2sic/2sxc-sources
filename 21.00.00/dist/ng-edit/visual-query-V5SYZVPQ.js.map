{
  "version": 3,
  "sources": ["projects/eav-ui/src/app/visual-query/plumb-editor/datasource.helpers.ts", "projects/eav-ui/src/app/visual-query/plumb-editor/plumb-editor.helpers.ts", "projects/eav-ui/src/app/visual-query/services/query-definition.service.ts", "projects/eav-ui/src/app/visual-query/query-result/query-result.ts", "projects/eav-ui/src/app/visual-query/query-result/query-result.html", "projects/eav-ui/src/app/visual-query/stream-error-result/stream-error-result.ts", "projects/eav-ui/src/app/visual-query/stream-error-result/stream-error-result.html", "projects/eav-ui/src/app/visual-query/services/visual-query.service.ts", "projects/eav-ui/src/app/visual-query/add-explorer/add-explorer.helpers.ts", "projects/eav-ui/src/app/visual-query/add-explorer/add-explorer.ts", "projects/eav-ui/src/app/visual-query/add-explorer/add-explorer.html", "projects/eav-ui/src/app/visual-query/plumb-editor/plumber-constants.ts", "projects/eav-ui/src/app/visual-query/plumb-editor/connection-line-colors.ts", "projects/eav-ui/src/app/visual-query/plumb-editor/connections-manager.ts", "projects/eav-ui/src/app/visual-query/plumb-editor/rename-stream/rename-stream.ts", "projects/eav-ui/src/app/visual-query/plumb-editor/rename-stream/rename-stream.html", "projects/eav-ui/src/app/visual-query/plumb-editor/endpoint-definitions.ts", "projects/eav-ui/src/app/visual-query/plumb-editor/endpoints-manager.ts", "projects/eav-ui/src/app/visual-query/plumb-editor/jsplumb-instance-manager.ts", "projects/eav-ui/src/app/visual-query/plumb-editor/lines-decorator.ts", "projects/eav-ui/src/app/visual-query/plumb-editor/query-data-manager.ts", "projects/eav-ui/src/app/visual-query/plumb-editor/wirings.helper.ts", "projects/eav-ui/src/app/visual-query/plumb-editor/plumber.helper.ts", "projects/eav-ui/src/app/visual-query/plumb-editor/plumb-editor.ts", "projects/eav-ui/src/app/visual-query/plumb-editor/plumb-editor.html", "projects/eav-ui/src/app/visual-query/run-explorer/run-explorer.helpers.ts", "projects/eav-ui/src/app/visual-query/run-explorer/run-explorer.ts", "projects/eav-ui/src/app/visual-query/run-explorer/run-explorer.html", "projects/eav-ui/src/app/visual-query/visual-query.ts", "projects/eav-ui/src/app/visual-query/visual-query.html"],
  "sourcesContent": ["import { DataSource } from '../models';\r\nimport { JsPlumbEndpoint } from './jsplumb.models';\r\n\r\nexport function findDefByType(dataSources: DataSource [], partAssemblyAndType: string): DataSource | undefined {\r\n  return dataSources.find(ds => ds.PartAssemblyAndType === partAssemblyAndType)\r\n}\r\n\r\nexport function getEndpointLabel(endpoint: JsPlumbEndpoint) : string {\r\n  return endpoint.getOverlay('endpointLabel').label\r\n}", "import { DataSource, PipelineDataSource } from '../models';\r\nimport { findDefByType } from './datasource.helpers';\r\nimport { GuiTypes, TypeInfo, TypeInfos } from './plumb-editor.models';\r\n\r\nexport const guiTypes: GuiTypes = {\r\n  App: { Name: 'App', Label: 'App DataSources', Icon: 'star', UiHint: 'DataSources from the current App' },\r\n  Cache: { Name: 'Cache', Icon: 'history', UiHint: 'Caching of data' },\r\n  Filter: { Name: 'Filter', Icon: 'filter_list', UiHint: 'Filter data - usually returning less items than came in' },\r\n  Logic: { Name: 'Logic', Icon: 'share', UiHint: 'Logic operations - usually choosing between different streams' },\r\n  Lookup: { Name: 'Lookup', Icon: 'search', UiHint: 'Lookup operation - usually looking for other data based on a criteria' },\r\n  Modify: { Name: 'Modify', Icon: 'edit_attributes', UiHint: 'Modify data - usually changing, adding or removing values' },\r\n  Security: { Name: 'Security', Icon: 'account_circle', UiHint: 'Security - usually limit what the user sees based on his identity' },\r\n  Sort: { Name: 'Sort', Icon: 'sort', UiHint: 'Sort the items' },\r\n  Source: { Name: 'Source', Icon: 'cloud_upload', UiHint: 'Source of new data - usually SQL, CSV or similar' },\r\n  Target: { Name: 'Target', Icon: 'adjust', UiHint: 'Target - usually just a destination of data' },\r\n  Unknown: { Name: 'Unknown', Icon: 'fiber_manual_record', UiHint: 'Unknown type' },\r\n  Debug: { Name: 'Debug', Icon: 'bug_report', UiHint: 'Debugging Tools' },\r\n  System: { Name: 'System', Icon: 'military_tech', UiHint: 'System Data' },\r\n};\r\n\r\nexport function calculateTypeInfos(pipelineDataSources: PipelineDataSource[], dataSources: DataSource[]) {\r\n  const typeInfos: TypeInfos = {};\r\n\r\n  for (const pipelineDataSource of pipelineDataSources) {\r\n    const ds = findDefByType(dataSources, pipelineDataSource.PartAssemblyAndType);\r\n    const typeInfo: TypeInfo = (ds)\r\n      ? {\r\n        ...(ds.PrimaryType ? guiTypes[ds.PrimaryType] : guiTypes.Unknown),\r\n\r\n        DynamicIn: ds.DynamicIn ?? false,\r\n        DynamicOut: ds.OutMode != 'static',\r\n        Icon: ds.Icon,\r\n        UiHint: ds.UiHint,\r\n        HelpLink: ds.HelpLink,\r\n        outMode: ds.OutMode,\r\n        // ...(ds.Icon ? { Icon: ds.Icon } : {}),\r\n        // ...(ds.UiHint ? { UiHint: ds.UiHint } : {}),\r\n        // ...(ds.OutMode != null ? { OutMode: ds.OutMode } : {}),\r\n        // ...(ds.HelpLink != null ? { HelpLink: ds.HelpLink } : {}),\r\n        ...(ds.EnableConfig != null ? { EnableConfig: ds.EnableConfig } : {}),\r\n      } satisfies TypeInfo\r\n      : {\r\n        ...guiTypes.Unknown,\r\n        DynamicOut: false,\r\n        DynamicIn: false,\r\n        outMode: 'static',\r\n      };\r\n      // console.log(\"2dm test\", pipelineDataSource, ds, typeInfo);\r\n    \r\n    typeInfos[pipelineDataSource.EntityGuid] = typeInfo;\r\n  }\r\n\r\n  return typeInfos;\r\n}\r\n", "import { Injectable } from '@angular/core';\r\nimport { map } from 'rxjs';\r\nimport { webApiQueryDataSources, webApiQueryDebugStream, webApiQueryGet, webApiQueryRun, webApiQuerySave } from '../../app-administration/services';\r\nimport { eavConstants } from '../../shared/constants/eav.constants';\r\nimport { HttpServiceBaseSignal } from '../../shared/services/http-service-base-signal';\r\nimport { DataSource, PipelineDataSource, PipelineModel, PipelineResult } from '../models';\r\nimport { findDefByType } from '../plumb-editor/datasource.helpers';\r\n\r\n@Injectable()\r\nexport class QueryDefinitionService extends HttpServiceBaseSignal {\r\n\r\n  fetchPipelinePromise(pipelineEntityId: number, dataSources: DataSource[]): Promise<PipelineModel> {\r\n    return this.fetchPromise<PipelineModel>(webApiQueryGet, {\r\n      params: { appId: this.appId, id: pipelineEntityId.toString() }\r\n    }).then(pipelineModel => {\r\n      // if pipeline is new, populate it with default model\r\n      if (!pipelineModel.DataSources.length) {\r\n        this.#buildDefaultModel(pipelineModel, dataSources);\r\n      }\r\n      this.#fixPipelineDataSources(pipelineModel.DataSources);\r\n      return pipelineModel;\r\n    })\r\n  }\r\n\r\n  #buildDefaultModel(pipelineModel: PipelineModel, dataSources: DataSource[]) {\r\n    const templateDataSources = eavConstants.pipelineDesigner.defaultPipeline.dataSources;\r\n    for (const templateDS of templateDataSources) {\r\n      const dataSource = findDefByType(dataSources, templateDS.PartAssemblyAndType);\r\n      const pipelineDataSource: PipelineDataSource = {\r\n        Description: '',\r\n        EntityGuid: templateDS.EntityGuid,\r\n        EntityId: undefined,\r\n        Name: dataSource.Name,\r\n        PartAssemblyAndType: templateDS.PartAssemblyAndType,\r\n        VisualDesignerData: templateDS.VisualDesignerData,\r\n      };\r\n      pipelineModel.DataSources.push(pipelineDataSource);\r\n    }\r\n\r\n    pipelineModel.Pipeline.StreamWiring = eavConstants.pipelineDesigner.defaultPipeline.streamWiring;\r\n  }\r\n\r\n  #fixPipelineDataSources(pipelineDataSources: PipelineDataSource[]) {\r\n    const outDataSourceExists = pipelineDataSources.some(\r\n      pipelineDS => pipelineDS.EntityGuid === eavConstants.pipelineDesigner.outDataSource.EntityGuid\r\n    );\r\n    if (!outDataSourceExists) {\r\n      const outDs = eavConstants.pipelineDesigner.outDataSource;\r\n      const outDsConst: PipelineDataSource = {\r\n        Description: outDs.Description,\r\n        EntityGuid: outDs.EntityGuid,\r\n        EntityId: undefined,\r\n        Name: outDs.Name,\r\n        PartAssemblyAndType: outDs.PartAssemblyAndType,\r\n        VisualDesignerData: outDs.VisualDesignerData,\r\n      };\r\n      pipelineDataSources.push(outDsConst);\r\n    }\r\n\r\n    for (const pipelineDataSource of pipelineDataSources) {\r\n      pipelineDataSource.VisualDesignerData ??= { Top: 50, Left: 50 };\r\n    }\r\n  }\r\n\r\n  fetchDataSourcesPromise(): Promise<DataSource[]> {\r\n    return this.fetchPromise<DataSource[]>(webApiQueryDataSources, {\r\n      params: {\r\n        appid: this.appId,\r\n        zoneId: this.zoneId,\r\n      },\r\n    }).then(dataSources => {\r\n      // Add the final target DataSource to the list of DataSources\r\n      dataSources.push(eavConstants.pipelineDesigner.outFinalTarget);\r\n      return dataSources;\r\n    })\r\n  };\r\n\r\n  typeNameFilter(input: string, format: 'className' | 'classFullName') {\r\n    const globalParts = input.split(', ');\r\n\r\n    switch (format) {\r\n      case 'classFullName':\r\n        const classFullName = globalParts[0];\r\n        return classFullName;\r\n      case 'className':\r\n        const classFullNameParts = globalParts[0].split('.');\r\n        const className = classFullNameParts[classFullNameParts.length - 1];\r\n        return className;\r\n      default:\r\n        return input;\r\n    }\r\n  }\r\n\r\n  /** Save the current query and reload entire definition as returned from server */\r\n  savePipeline(pipelineModel: PipelineModel) {\r\n    const pipeline = pipelineModel.Pipeline;\r\n    const dataSources = pipelineModel.DataSources;\r\n\r\n    return this.http.post<PipelineModel>(\r\n      webApiQuerySave,\r\n      { pipeline, dataSources },\r\n      { params: { appId: this.appId, Id: pipeline.EntityId.toString() } }\r\n    ).pipe(\r\n      map(newPipelineModel => {\r\n        this.#fixPipelineDataSources(newPipelineModel.DataSources);\r\n        return newPipelineModel;\r\n      }),\r\n    );\r\n  }\r\n\r\n  /** `top` - fetch first X items */\r\n  runPipelinePromise(id: number, top: number): Promise<PipelineResult> {\r\n    return this.fetchPromise<PipelineResult>(webApiQueryRun, {\r\n      params: { appId: this.appId, id: id.toString(), top: top.toString() }\r\n    });\r\n  }\r\n\r\n  /** `top` - fetch first X items */\r\n  debugStreamPromise(id: number, source: string, sourceOut: string, top: number): Promise<PipelineResult> {\r\n    return this.fetchPromise<PipelineResult>(webApiQueryDebugStream, {\r\n      params: { appId: this.appId, id: id.toString(), from: source, out: sourceOut, top: top.toString() }\r\n    });\r\n  }\r\n\r\n}\r\n", "import { JsonPipe, KeyValuePipe } from '@angular/common';\r\nimport { Component, Inject, OnInit } from '@angular/core';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatTabsModule } from '@angular/material/tabs';\r\nimport { DebugStreamInfo, PipelineResultQuery, PipelineResultSources, PipelineResultStream } from '../models';\r\nimport { VisualQueryStateService } from '../services/visual-query.service';\r\nimport { QueryResultDialogData } from './query-result.models';\r\n\r\n@Component({\r\n    selector: 'app-query-result',\r\n    templateUrl: './query-result.html',\r\n    styleUrls: ['./query-result.scss'],\r\n    imports: [\r\n        MatButtonModule,\r\n        MatIconModule,\r\n        MatTabsModule,\r\n        JsonPipe,\r\n        KeyValuePipe,\r\n    ]\r\n})\r\nexport class QueryResultComponent implements OnInit {\r\n  parameters: string[];\r\n  timeUsed: number;\r\n  ticksUsed: number;\r\n  top: number;\r\n  optionsForTop: number[];\r\n  result: PipelineResultQuery;\r\n  debugStream: DebugStreamInfo;\r\n  sources: PipelineResultSources;\r\n  streams: PipelineResultStream[];\r\n\r\n  constructor(\r\n    @Inject(MAT_DIALOG_DATA) private dialogData: QueryResultDialogData,\r\n    private dialog: MatDialogRef<QueryResultComponent>,\r\n    private visualQueryService: VisualQueryStateService,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    const pipeline = this.visualQueryService.pipelineModel().Pipeline;\r\n    const params = (pipeline.Params?.split('\\n') ?? []).filter(el => !!el);\r\n    const testParams = (pipeline.TestParameters?.split('\\n') ?? []).filter(el => !!el);\r\n    this.parameters = [].concat(params, testParams);\r\n    this.timeUsed = this.dialogData.result.QueryTimer.Milliseconds;\r\n    this.ticksUsed = this.dialogData.result.QueryTimer.Ticks;\r\n    this.top = this.dialogData.top;\r\n    this.optionsForTop = [25, 100, 1000, 0];\r\n    this.result = this.dialogData.result.Query;\r\n    this.debugStream = this.dialogData.debugStream;\r\n    this.sources = this.dialogData.result.Sources;\r\n    this.streams = this.dialogData.result.Streams;\r\n  }\r\n\r\n  closeDialog() {\r\n    this.dialog.close();\r\n  }\r\n\r\n  show(top: number) {\r\n    if (top === this.top) return;\r\n\r\n    if (this.debugStream) {\r\n      this.visualQueryService.debugStream(this.debugStream.original, top);\r\n    } else {\r\n      this.visualQueryService.runPipeline(top);\r\n    }\r\n\r\n    this.closeDialog();\r\n  }\r\n}\r\n", "<div class=\"eav-dialog\">\r\n  <div class=\"eav-dialog-header\">\r\n    <div class=\"eav-dialog-header__title\">\r\n      Query Results\r\n      @if (debugStream) {\r\n        for Stream: \"{{ debugStream.name }}\" on Source: \"{{ debugStream.sourceName }}\"\r\n      }\r\n    </div>\r\n    <button mat-icon-button tippy=\"Close dialog\" (click)=\"closeDialog()\">\r\n      <mat-icon>close</mat-icon>\r\n    </button>\r\n  </div>\r\n\r\n  <div class=\"eav-dialog-content\">\r\n    <p>\r\n      The Full result was logged to the Browser Console. Further down you'll find more debug-infos. Executed in {{ timeUsed }}ms ({{\r\n        ticksUsed\r\n      }}\r\n      ticks)\r\n    </p>\r\n\r\n    <mat-tab-group dynamicHeight color=\"accent\" class=\"eav-tab-group\">\r\n      <!-- Results -->\r\n      <mat-tab>\r\n        <div *matTabLabel class=\"mat-tab-label-box\" tippy=\"Results\">\r\n          <span>Results</span>\r\n        </div>\r\n        <div class=\"eav-tab-content\">\r\n          <div class=\"eav-tab-description\">\r\n            <div>\r\n              @if (top === 0) {\r\n                Showing All results\r\n              }\r\n              @if (top !== 0) {\r\n                Showing top {{ top }} results\r\n              }\r\n            </div>\r\n            <div>\r\n              @for (option of optionsForTop; track option) {\r\n                <button mat-button (click)=\"show(option)\">\r\n                  Show\r\n                  @if (option === 0) {\r\n                    All\r\n                  }\r\n                  @if (option !== 0) {\r\n                    {{ option }}\r\n                  }\r\n                </button>\r\n              }\r\n            </div>\r\n          </div>\r\n          <pre class=\"query-result\">{{ result | json }}</pre>\r\n        </div>\r\n      </mat-tab>\r\n\r\n      @if (parameters?.length) {\r\n        <!-- Parameters -->\r\n        <mat-tab>\r\n          <div *matTabLabel class=\"mat-tab-label-box\" tippy=\"Parameters\">\r\n            <span>Parameters</span>\r\n          </div>\r\n\r\n          <div class=\"eav-tab-content\">\r\n            <ul>\r\n              @for (param of parameters; track param) {\r\n                <li>{{ param }}</li>\r\n              }\r\n            </ul>\r\n          </div>\r\n        </mat-tab>\r\n      }\r\n\r\n      <!-- Sources -->\r\n      <mat-tab>\r\n        <div *matTabLabel class=\"mat-tab-label-box\" tippy=\"Sources\">\r\n          <span>Sources</span>\r\n        </div>\r\n\r\n        <div class=\"eav-tab-content\">\r\n          <table>\r\n            <tr>\r\n              <th>Name and Guid</th>\r\n              <th>Type</th>\r\n              <th>Configuration</th>\r\n              <th>Error</th>\r\n            </tr>\r\n            @for (source of sources | keyvalue; track source) {\r\n              <tr>\r\n                <td>\r\n                  @if (source.value.Definition?.Name) {\r\n                    <div>{{ source.value.Definition?.Name }}</div>\r\n                  }\r\n                  <pre>{{ source.value.Guid }}</pre>\r\n                </td>\r\n                <td>{{ source.value.Type }}</td>\r\n                <td>\r\n                  <ol>\r\n                    @for (config of source.value.Configuration | keyvalue; track config) {\r\n                      <li>\r\n                        <b>{{ config.key }}</b\r\n                        >=<em>{{ config.value }}</em>\r\n                      </li>\r\n                    }\r\n                  </ol>\r\n                </td>\r\n                <td>{{ source.value.Error }}</td>\r\n              </tr>\r\n            }\r\n          </table>\r\n        </div>\r\n      </mat-tab>\r\n\r\n      <!-- Streams -->\r\n      <mat-tab>\r\n        <div *matTabLabel class=\"mat-tab-label-box\" tippy=\"Streams\">\r\n          <span>Streams</span>\r\n        </div>\r\n\r\n        <div class=\"eav-tab-content\">\r\n          <table>\r\n            <tr>\r\n              <th>Source</th>\r\n              <th>Target</th>\r\n              <th>Items</th>\r\n              <th>Error</th>\r\n            </tr>\r\n            @for (stream of streams; track stream) {\r\n              <tr>\r\n                <td>\r\n                  <pre>{{ stream.Source + ':' + stream.SourceOut }}</pre>\r\n                </td>\r\n                <td>\r\n                  <pre>{{ stream.Target + ':' + stream.TargetIn }}</pre>\r\n                </td>\r\n                <td>{{ stream.Count }}</td>\r\n                <td>{{ stream.Error }}</td>\r\n              </tr>\r\n            }\r\n          </table>\r\n        </div>\r\n      </mat-tab>\r\n    </mat-tab-group>\r\n  </div>\r\n</div>\r\n", "import { JsonPipe } from '@angular/common';\r\nimport { Component, Inject, OnInit } from '@angular/core';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MAT_DIALOG_DATA, MatDialogActions, MatDialogRef } from '@angular/material/dialog';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { EavWindow } from '../../shared/models/eav-window.model';\r\nimport { StreamErrorData } from '../models';\r\nimport { StreamErrorResultDialogData } from './stream-error-result.models';\r\n\r\ndeclare const window: EavWindow;\r\n\r\n@Component({\r\n    selector: 'app-stream-error-result',\r\n    templateUrl: './stream-error-result.html',\r\n    styleUrls: ['./stream-error-result.scss'],\r\n    imports: [\r\n        MatButtonModule,\r\n        MatIconModule,\r\n        MatDialogActions,\r\n        JsonPipe,\r\n    ]\r\n})\r\nexport class StreamErrorResultComponent implements OnInit {\r\n  errorData: StreamErrorData;\r\n\r\n  constructor(\r\n    @Inject(MAT_DIALOG_DATA) private dialogData: StreamErrorResultDialogData,\r\n    private dialog: MatDialogRef<StreamErrorResultComponent>,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.errorData = this.dialogData.errorData;\r\n  }\r\n\r\n  closeDialog() {\r\n    this.dialog.close();\r\n  }\r\n\r\n  openInsights() {\r\n    window.open(window.$2sxc.http.apiUrl('sys/insights/logs?key=web-api-query'), '_blank');\r\n  }\r\n}\r\n", "<div class=\"eav-dialog\">\r\n  <div class=\"eav-dialog-header\">\r\n    <div class=\"eav-dialog-header__title\">Stream Error Results</div>\r\n    <button mat-icon-button tippy=\"Close dialog\" (click)=\"closeDialog()\">\r\n      <mat-icon>close</mat-icon>\r\n    </button>\r\n  </div>\r\n  <div class=\"eav-dialog-content\">\r\n    <pre>{{ errorData | json }}</pre>\r\n  </div>\r\n  <mat-dialog-actions align=\"end\">\r\n    <button mat-button class=\"eav-button__with-icon\" tippy=\"Open 2sxc Insights\" (click)=\"openInsights()\">\r\n      <mat-icon class=\"eav-icon\">speed</mat-icon>\r\n      <span>Insights</span>\r\n    </button>\r\n  </mat-dialog-actions>\r\n</div>\r\n", "import { HttpErrorResponse } from '@angular/common/http';\r\nimport { ChangeDetectorRef, Injectable, NgZone, OnDestroy, signal, ViewContainerRef } from '@angular/core';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { Title } from '@angular/platform-browser';\r\nimport cloneDeep from 'lodash-es/cloneDeep';\r\nimport { filter, fromEvent, Subject } from 'rxjs';\r\nimport { ContentTypesService } from '../../app-administration/services/content-types.service';\r\nimport { MetadataService } from '../../permissions/services/metadata.service';\r\nimport { eavConstants } from '../../shared/constants/eav.constants';\r\nimport { convertFormToUrl } from '../../shared/helpers/url-prep.helper';\r\nimport { EditForm, EditPrep } from '../../shared/models/edit-form.model';\r\nimport { QueryDefinitionService } from './query-definition.service';\r\n// tslint:disable-next-line:max-line-length\r\nimport { transient } from '../../../../../core';\r\nimport { isCtrlS } from '../../edit/dialog/main/keyboard-shortcuts';\r\nimport { JsonHelpers } from '../../shared/helpers/json.helpers';\r\nimport { DialogRoutingService } from '../../shared/routing/dialog-routing.service';\r\nimport { ServiceBase } from '../../shared/services/service-base';\r\nimport { DataSource, DataSourceConfig, DataSourceConfigs, DebugStreamInfo, PipelineDataSource, PipelineModel, PipelineResult, PipelineResultStream, StreamWire, VisualDesignerData } from '../models';\r\nimport { findDefByType } from '../plumb-editor/datasource.helpers';\r\nimport { QueryResultComponent } from '../query-result/query-result';\r\nimport { QueryResultDialogData } from '../query-result/query-result.models';\r\nimport { StreamErrorResultComponent } from '../stream-error-result/stream-error-result';\r\nimport { StreamErrorResultDialogData } from '../stream-error-result/stream-error-result.models';\r\n\r\n/**\r\n * Service containing the state for the visual query.\r\n * It's shared, so should not be used with transient(...);\r\n */\r\n@Injectable()\r\nexport class VisualQueryStateService extends ServiceBase implements OnDestroy {\r\n\r\n  #contentTypesSvc = transient(ContentTypesService);\r\n  #metadataSvc = transient(MetadataService);\r\n  #queryDefSvc = transient(QueryDefinitionService);\r\n  #dialogRoute = transient(DialogRoutingService);\r\n  #titleSvc = transient(Title);\r\n\r\n  pipelineModel = signal<PipelineModel>(null);\r\n  dataSources = signal<DataSource[]>(null);\r\n  dataSourceConfigs = signal<DataSourceConfigs>({});\r\n\r\n  putEntityCountOnConnections$ = new Subject<PipelineResult>();\r\n\r\n  queryResult?: PipelineResult;\r\n\r\n  #pipelineId = parseInt(this.#dialogRoute.getParam('pipelineId'), 10);\r\n  #refreshPipeline = false;\r\n  #refreshDataSourceConfigs = false;\r\n\r\n  constructor(\r\n    private snackBar: MatSnackBar,\r\n    private matDialog: MatDialog,\r\n    private viewContainerRef: ViewContainerRef,\r\n    private zone: NgZone,\r\n    private changeDetectorRef: ChangeDetectorRef,\r\n  ) {\r\n    super();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.putEntityCountOnConnections$.complete();\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  init() {\r\n    this.#fetchDataSources(() => this.#fetchPipeline(true, true, false));\r\n    this.#attachKeyboardSave();\r\n    this.#dialogRoute.doOnDialogClosed(() => {\r\n      if (this.#refreshPipeline || this.#refreshDataSourceConfigs)\r\n        this.#fetchPipeline(this.#refreshPipeline, this.#refreshDataSourceConfigs, this.#refreshPipeline);\r\n      this.#refreshPipeline = false;\r\n      this.#refreshDataSourceConfigs = false;\r\n    });\r\n  }\r\n\r\n  public editPipelineEntity() {\r\n    // save Pipeline, then open Edit Dialog\r\n    this.#savePipeline(() => {\r\n      const form: EditForm = {\r\n        items: [EditPrep.editId(this.pipelineModel().Pipeline.EntityId)],\r\n      };\r\n      const formUrl = convertFormToUrl(form);\r\n      this.#dialogRoute.navRelative([`edit/${formUrl}`]);\r\n      this.#refreshPipeline = true;\r\n    });\r\n  }\r\n\r\n  public saveAndRun(save: boolean, run: boolean): void {\r\n    if (save && run)\r\n      return this.#savePipeline(() => this.runPipeline());\r\n\r\n    if (save)\r\n      return this.#savePipeline();\r\n\r\n    if (run)\r\n      return this.runPipeline();\r\n  }\r\n\r\n  showDataSourceDetails(showDetails: boolean) {\r\n    const query = cloneDeep(this.pipelineModel());\r\n    const designerData: Record<string, any> = JsonHelpers.tryParse(query.Pipeline.VisualDesignerData) ?? {};\r\n    designerData.ShowDataSourceDetails = showDetails;\r\n    query.Pipeline.VisualDesignerData = JSON.stringify(designerData);\r\n    this.pipelineModel.set(query);\r\n  }\r\n\r\n  addDataSource(dataSource: DataSource) {\r\n    const query = cloneDeep(this.pipelineModel());\r\n    const newSource: PipelineDataSource = {\r\n      Description: '',\r\n      EntityGuid: 'unsaved' + (query.DataSources.length + 1),\r\n      EntityId: undefined,\r\n      Name: dataSource.Name,\r\n      PartAssemblyAndType: dataSource.PartAssemblyAndType,\r\n      VisualDesignerData: { Top: 100, Left: 100 },\r\n    };\r\n    query.DataSources.push(newSource);\r\n    this.pipelineModel.set(query);\r\n    this.#savePipeline();\r\n  }\r\n\r\n  removeDataSource(pipelineDataSourceGuid: string, connections: StreamWire[], streamsOut: string) {\r\n    const query = cloneDeep(this.pipelineModel());\r\n    query.DataSources = query.DataSources.filter(pipelineDS => pipelineDS.EntityGuid !== pipelineDataSourceGuid);\r\n    query.Pipeline.StreamWiring = connections;\r\n    query.Pipeline.StreamsOut = streamsOut;\r\n    this.pipelineModel.set(query);\r\n  }\r\n\r\n  renameDataSource(pipelineDataSourceGuid: string, name: string) {\r\n    const query = cloneDeep(this.pipelineModel());\r\n    const dataSource = query.DataSources.find(pipelineDS => pipelineDS.EntityGuid === pipelineDataSourceGuid);\r\n    dataSource.Name = name;\r\n    this.pipelineModel.set(query);\r\n  }\r\n\r\n  changeDataSourceDescription(pipelineDataSourceGuid: string, description: string) {\r\n    const query = cloneDeep(this.pipelineModel());\r\n    const dataSource = query.DataSources.find(pipelineDS => pipelineDS.EntityGuid === pipelineDataSourceGuid);\r\n    dataSource.Description = description;\r\n    this.pipelineModel.set(query);\r\n  }\r\n\r\n  changeConnections(connections: StreamWire[], streamsOut: string) {\r\n    const query = cloneDeep(this.pipelineModel());\r\n    query.Pipeline.StreamWiring = connections;\r\n    query.Pipeline.StreamsOut = streamsOut;\r\n    this.pipelineModel.set(query);\r\n  }\r\n\r\n  changeDataSourcePosition(pipelineDataSourceGuid: string, position: VisualDesignerData) {\r\n    const query = cloneDeep(this.pipelineModel());\r\n    const dataSource = query.DataSources.find(pipelineDS => pipelineDS.EntityGuid === pipelineDataSourceGuid);\r\n    if (!dataSource) {\r\n      // spm NOTE: fixes problem where dataSource position can't be updated if dataSource with guid unsavedXX gets saved while dragging.\r\n      // Can happen if dataSource is just added and user drags it and save happens.\r\n      return;\r\n    }\r\n    dataSource.VisualDesignerData = { ...dataSource.VisualDesignerData, ...position };\r\n    this.pipelineModel.set(query);\r\n  }\r\n\r\n  #calculateDataSourceConfigs(dataSources: PipelineDataSource[]) {\r\n    const dataSourceConfigs: DataSourceConfigs = {};\r\n    dataSources.forEach(dataSource => {\r\n      if (dataSource.EntityId == null)\r\n        return;\r\n      dataSourceConfigs[dataSource.EntityId] = [];\r\n      dataSource.Metadata?.forEach(metadataItem => {\r\n        Object.entries(metadataItem).forEach(([attributeName, attributeValue]) => {\r\n          if (attributeValue == null || attributeValue === '')\r\n            return;\r\n          if (['Created', 'Guid', 'Id', 'Modified', 'Title', '_Type'].includes(attributeName))\r\n            return;\r\n          if (Array.isArray(attributeValue) && attributeValue[0]?.Title !== null && attributeValue[0]?.Id !== null) {\r\n            attributeValue = `${attributeValue[0].Title} (${attributeValue[0].Id})`;\r\n          }\r\n          const dataSourceConfig: DataSourceConfig = {\r\n            name: attributeName,\r\n            value: attributeValue,\r\n          };\r\n          dataSourceConfigs[dataSource.EntityId].push(dataSourceConfig);\r\n        });\r\n      });\r\n    });\r\n    this.dataSourceConfigs.set(dataSourceConfigs);\r\n  }\r\n\r\n  editDataSource(pipelineDataSource: PipelineDataSource) {\r\n    const dataSource = findDefByType(this.dataSources(), pipelineDataSource.PartAssemblyAndType);\r\n    const contentTypeName = dataSource.ContentType;\r\n    const { targetType, keyType } = eavConstants.metadata.entity;\r\n    const key = pipelineDataSource.EntityGuid;\r\n\r\n    // query for existing Entity\r\n    this.#metadataSvc.getMetadataPromise(targetType, keyType, key, contentTypeName).then(metadata => {\r\n      // edit existing Entity\r\n      if (metadata.Items.length) {\r\n        const form: EditForm = {\r\n          items: [EditPrep.editId(metadata.Items[0].Id)],\r\n        };\r\n        const formUrl = convertFormToUrl(form);\r\n        this.#dialogRoute.navRelative([`edit/${formUrl}`]);\r\n        this.#refreshDataSourceConfigs = true;\r\n        return;\r\n      }\r\n\r\n      // Check if the type exists, and if yes, create new Entity\r\n      this.#contentTypesSvc.retrieveContentType(contentTypeName).subscribe({\r\n        next: contentType => {\r\n          if (contentType == null) {\r\n            this.snackBar.open('DataSource doesn\\'t have any configuration', undefined, { duration: 3000 });\r\n            return;\r\n          }\r\n          const form: EditForm = {\r\n            items: [EditPrep.newMetadata(key, contentTypeName, eavConstants.metadata.entity)],\r\n          };\r\n          const formUrl = convertFormToUrl(form);\r\n          this.#dialogRoute.navRelative([`edit/${formUrl}`]);\r\n          this.#refreshDataSourceConfigs = true;\r\n        },\r\n        error: (error: HttpErrorResponse) => {\r\n          const message = 'Server reports error - this usually means that this DataSource doesn\\'t have any configuration';\r\n          this.snackBar.open(message, undefined, { duration: 3000 });\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  #savePipeline(callback?: () => void) {\r\n    this.snackBar.open('Saving...');\r\n    this.#queryDefSvc.savePipeline(this.pipelineModel()).subscribe({\r\n      next: pipelineModel => {\r\n        this.snackBar.open('Saved', null, { duration: 2000 });\r\n        this.pipelineModel.set(pipelineModel);\r\n        if (callback != null) { callback(); }\r\n      },\r\n      error: (error: HttpErrorResponse) => {\r\n        this.snackBar.open('Save Pipeline failed', null, { duration: 2000 });\r\n      }\r\n    });\r\n  }\r\n\r\n  runPipeline(top = 25) {\r\n    this.snackBar.open('Running query...');\r\n    this.#queryDefSvc.runPipelinePromise(this.pipelineModel().Pipeline.EntityId, top)\r\n      .then(pipelineResult => {\r\n        this.snackBar.open('Query worked', null, { duration: 2000 });\r\n        this.queryResult = pipelineResult;\r\n        this.#showQueryResult(pipelineResult, top);\r\n        console.warn(pipelineResult);\r\n        this.pipelineModel.set(cloneDeep(this.pipelineModel()));\r\n        setTimeout(() => { this.putEntityCountOnConnections$.next(pipelineResult); });\r\n      })\r\n      .catch((error: HttpErrorResponse) => {\r\n        this.snackBar.open('Query failed', null, { duration: 2000 });\r\n      });\r\n  }\r\n\r\n  debugStream(stream: PipelineResultStream, top = 25): void {\r\n    if (stream.Error)\r\n      return this.#showStreamErrorResult(stream);\r\n\r\n    if (stream.Count === 0)\r\n      return;\r\n\r\n    this.snackBar.open('Running stream...');\r\n    const pipelineId = this.pipelineModel().Pipeline.EntityId;\r\n\r\n    this.#queryDefSvc.debugStreamPromise(pipelineId, stream.Source, stream.SourceOut, top)\r\n      .then(streamResult => {\r\n        this.snackBar.open('Stream worked', null, { duration: 2000 });\r\n        const pipelineDataSource = this.pipelineModel().DataSources.find(ds => ds.EntityGuid === stream.Source);\r\n        const debugStream: DebugStreamInfo = {\r\n          name: stream.SourceOut,\r\n          source: stream.Source,\r\n          sourceName: pipelineDataSource?.Name,\r\n          original: stream,\r\n        };\r\n        this.#showQueryResult(streamResult, top, debugStream);\r\n        console.warn(streamResult);\r\n      })\r\n      .catch((_error: HttpErrorResponse) => {\r\n        this.snackBar.open('Stream failed', null, { duration: 2000 });\r\n      });\r\n  }\r\n\r\n\r\n  #fetchPipeline(refreshPipeline: boolean, refreshDataSourceConfigs: boolean, showSnackBar: boolean) {\r\n    if (showSnackBar)\r\n      this.snackBar.open('Reloading query, please wait...');\r\n\r\n    this.#queryDefSvc.fetchPipelinePromise(this.#pipelineId, this.dataSources()).then(pipelineModel => {\r\n      if (showSnackBar)\r\n        this.snackBar.open('Query reloaded', null, { duration: 2000 });\r\n\r\n      this.#titleSvc.setTitle(`${pipelineModel.Pipeline.Name} - Visual Query`);\r\n\r\n      if (refreshPipeline)\r\n        this.pipelineModel.set(pipelineModel);\r\n\r\n      if (refreshDataSourceConfigs)\r\n        this.#calculateDataSourceConfigs(pipelineModel.DataSources);\r\n    });\r\n  }\r\n\r\n  #showQueryResult(result: PipelineResult, top: number, debugStream?: DebugStreamInfo) {\r\n    const dialogData: QueryResultDialogData = {\r\n      result,\r\n      debugStream,\r\n      top,\r\n    };\r\n    this.matDialog.open(QueryResultComponent, {\r\n      autoFocus: false,\r\n      backdropClass: 'dialog-backdrop',\r\n      closeOnNavigation: false,\r\n      data: dialogData,\r\n      panelClass: ['dialog-panel', `dialog-panel-medium`, 'no-scrollbar'],\r\n      // spm NOTE: position used to force align-items: flex-start; on cdk-global-overlay-wrapper.\r\n      // Real top margin is overwritten in css e.g. dialog-panel-large\r\n      position: { top: '0' },\r\n      viewContainerRef: this.viewContainerRef,\r\n    });\r\n    this.changeDetectorRef.markForCheck();\r\n  }\r\n\r\n  #showStreamErrorResult(stream: PipelineResultStream) {\r\n    const dialogData: StreamErrorResultDialogData = {\r\n      errorData: stream.ErrorData,\r\n    };\r\n    this.matDialog.open(StreamErrorResultComponent, {\r\n      autoFocus: false,\r\n      backdropClass: 'dialog-backdrop',\r\n      closeOnNavigation: false,\r\n      data: dialogData,\r\n      panelClass: ['dialog-panel', `dialog-panel-medium`, 'no-scrollbar'],\r\n      // spm NOTE: position used to force align-items: flex-start; on cdk-global-overlay-wrapper.\r\n      // Real top margin is overwritten in css e.g. dialog-panel-large\r\n      position: { top: '0' },\r\n      viewContainerRef: this.viewContainerRef,\r\n    });\r\n    this.changeDetectorRef.markForCheck();\r\n  }\r\n\r\n  #fetchDataSources(callback?: () => void) {\r\n    this.#queryDefSvc.fetchDataSourcesPromise().then(dataSources => {\r\n      this.dataSources.set(dataSources);\r\n      callback();\r\n    });\r\n  }\r\n\r\n  #attachKeyboardSave() {\r\n    this.zone.runOutsideAngular(() => {\r\n      this.subscriptions.add(\r\n        fromEvent<KeyboardEvent>(window, 'keydown').pipe(\r\n          filter(() => !this.#dialogRoute.snapshot.firstChild),\r\n          filter(event => isCtrlS(event)),\r\n        ).subscribe(event => {\r\n          event.preventDefault();\r\n          this.zone.run(() => { this.#savePipeline(); });\r\n        })\r\n      );\r\n    });\r\n  }\r\n}\r\n", "import cloneDeep from 'lodash-es/cloneDeep';\r\nimport { eavConstants } from '../../shared/constants/eav.constants';\r\nimport { DataSource, SortedDataSources } from '../models';\r\n\r\nexport function filterAndSortDataSources(dataSources: DataSource[], maxDifficulty: number) {\r\n  if (!dataSources) return;\r\n\r\n  const cloned = cloneDeep(dataSources);\r\n\r\n  const filtered = cloned.filter(dataSource =>\r\n    dataSource.Difficulty <= maxDifficulty\r\n    && dataSource.PartAssemblyAndType !== eavConstants.pipelineDesigner.outDataSource.PartAssemblyAndType\r\n  );\r\n\r\n  filtered.sort((a, b) => a.Name.toLocaleLowerCase().localeCompare(b.Name.toLocaleLowerCase()));\r\n\r\n  const sorted: SortedDataSources = {};\r\n  for (const dataSource of filtered) {\r\n    const type = dataSource.PrimaryType;\r\n    if (sorted[type]) {\r\n      sorted[type].push(dataSource);\r\n    } else {\r\n      sorted[type] = [dataSource];\r\n    }\r\n  }\r\n\r\n  return sorted;\r\n}\r\n", "import { KeyValue, KeyValuePipe } from '@angular/common';\r\nimport { Component, computed, signal } from '@angular/core';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatSlideToggleChange, MatSlideToggleModule } from '@angular/material/slide-toggle';\r\nimport { eavConstants } from '../../shared/constants/eav.constants';\r\nimport { TippyDirective } from '../../shared/directives/tippy.directive';\r\nimport { ArrayHelpers } from '../../shared/helpers/array.helpers';\r\nimport { DataSource } from '../models';\r\nimport { guiTypes } from '../plumb-editor/plumb-editor.helpers';\r\nimport { VisualQueryStateService } from '../services/visual-query.service';\r\nimport { filterAndSortDataSources } from './add-explorer.helpers';\r\n\r\n@Component({\r\n    selector: 'app-add-explorer',\r\n    templateUrl: './add-explorer.html',\r\n    styleUrls: ['./add-explorer.scss'],\r\n    imports: [\r\n        MatSlideToggleModule,\r\n        MatIconModule,\r\n        KeyValuePipe,\r\n        TippyDirective,\r\n    ]\r\n})\r\nexport class AddExplorerComponent {\r\n  toggledItems: string[] = [];\r\n  guiTypes = guiTypes;\r\n\r\n  #difficulties = eavConstants.pipelineDesigner.dataSourceDifficulties;\r\n\r\n  #difficulty = signal(this.#difficulties.default);\r\n\r\n  sorted = computed(() => filterAndSortDataSources(this.visualQueryService.dataSources(), this.#difficulty()));\r\n\r\n  constructor(private visualQueryService: VisualQueryStateService) { }\r\n\r\n  toggleDifficulty(event: MatSlideToggleChange) {\r\n    const difficulty = event.checked ? this.#difficulties.advanced : this.#difficulties.default;\r\n    this.#difficulty.set(difficulty);\r\n  }\r\n\r\n  addDataSource(dataSource: DataSource) {\r\n    this.visualQueryService.addDataSource(dataSource);\r\n  }\r\n\r\n  toggleItem(item: string) {\r\n    ArrayHelpers.toggleInArray(item, this.toggledItems);\r\n  }\r\n\r\n  trackGroups(index: number, type: KeyValue<string, DataSource[]>) {\r\n    return type.key;\r\n  }\r\n\r\n  trackDataSources(index: number, dataSource: DataSource) {\r\n    return dataSource.PartAssemblyAndType;\r\n  }\r\n}\r\n", "@if (sorted()) {\r\n  <div class=\"editor-active-explorer fancy-scrollbar-dark\">\r\n    <div class=\"eav-show-advanced\">\r\n      <span class=\"eav-slide-toggle-label\">Show Advanced</span>\r\n      <mat-slide-toggle color=\"primary\" (change)=\"toggleDifficulty($event)\" />\r\n    </div>\r\n    @for (group of sorted() | keyvalue; track trackGroups($index, group)) {\r\n      <div class=\"collapsible\" [tippy]=\"guiTypes[group.key].UiHint || group.key\" tippyShowDelay=\"750\"\r\n        (click)=\"toggleItem(group.key)\">\r\n        <mat-icon>{{ guiTypes[group.key].Icon || guiTypes.Unknown.Icon }}</mat-icon>\r\n        <span>{{ guiTypes[group.key].Label ?? guiTypes[group.key].Name ?? group.key }}</span>\r\n      </div>\r\n      @if (toggledItems.includes(group.key)) {\r\n        <div class=\"list\">\r\n          @for (dataSource of group.value; track trackDataSources($index, dataSource)) {\r\n            <div class=\"list-item\"\r\n              [tippy]=\"dataSource.UiHint || dataSource.Name\" tippyShowDelay=\"750\" (click)=\"addDataSource(dataSource)\">\r\n              <mat-icon>{{ dataSource.Icon || guiTypes.Unknown.Icon }}</mat-icon>\r\n              <span>{{ dataSource.Name }}</span>\r\n            </div>\r\n          }\r\n        </div>\r\n      }\r\n    }\r\n  </div>\r\n}\r\n", "\r\nexport const dataSrcIdPrefix = 'dataSource_';\r\n\r\nexport function domIdOfGuid(guid: string): string {\r\n  return dataSrcIdPrefix + guid;\r\n}\r\n\r\nexport function guidOfDomId(domId: string): string {\r\n  return domId.replace(dataSrcIdPrefix, '');\r\n}", "import { classLog } from '../../shared/logging';\r\n\r\nconst logSpecs = {\r\n  all: false,\r\n}\r\n\r\n/**\r\n * Helper to manage the line colors on each connection\r\n */\r\nexport class ConnectionLineColors {\r\n  log = classLog({ConnectionLineColors}, logSpecs);\r\n\r\n  constructor() { }\r\n\r\n  #lineCount = 0;\r\n  #linePaintDefault = {\r\n    stroke: '#61B7CF',\r\n    strokeWidth: 4,\r\n    outlineStroke: 'white',\r\n    outlineWidth: 2,\r\n  };\r\n  #lineColors = [\r\n    '#009688', '#00bcd4', '#3f51b5', '#9c27b0', '#e91e63',\r\n    '#db4437', '#ff9800', '#60a917', '#60a917', '#008a00',\r\n    '#00aba9', '#1ba1e2', '#0050ef', '#6a00ff', '#aa00ff',\r\n    '#f472d0', '#d80073', '#a20025', '#e51400', '#fa6800',\r\n    '#f0a30a', '#e3c800', '#825a2c', '#6d8764', '#647687',\r\n    '#76608a', '#a0522d',\r\n  ];\r\n  #maxCols = this.#lineColors.length - 1;\r\n  #uuidColorMap: Record<string, any> = {};\r\n\r\n\r\n  nextLinePaintStyle(uuid: string) {\r\n    return this.#uuidColorMap[uuid] ??= this.#nextLineColor();\r\n  }\r\n\r\n  #nextLineColor() {\r\n    return {\r\n      ...this.#linePaintDefault,\r\n      stroke: this.#lineColors[this.#lineCount++ % this.#maxCols],\r\n    };\r\n  }\r\n\r\n}", "import { classLog } from '../../shared/logging';\r\nimport { DataSource, PipelineModel, StreamWire } from '../models';\r\nimport { findDefByType, getEndpointLabel } from './datasource.helpers';\r\nimport { EndpointDefinitionsService } from './endpoint-definitions';\r\nimport { JsPlumbConnection, JsPlumbInstance } from './jsplumb.models';\r\nimport { guidOfDomId } from './plumber-constants';\r\n\r\nconst logSpecs = {\r\n  all: false,\r\n  eventConnectionDetached: false,\r\n  eventConnectionAttached: false,\r\n}\r\n\r\nexport class ConnectionsManager {\r\n  log = classLog({ConnectionsManager}, logSpecs);\r\n  bulkDelete: boolean = false;\r\n\r\n  constructor(\r\n    private instance: JsPlumbInstance, \r\n    private pipelineModel: PipelineModel,\r\n    private dataSources: DataSource[],\r\n    private endpointsSvc: EndpointDefinitionsService,\r\n    private onConnectionsChanged: () => void,\r\n  ) { }\r\n\r\n  /**\r\n   * Handle attach/detach of connections\r\n   */\r\n  setup(): void{\r\n    this.instance.bind('connectionDetached', (info: JsPlumbConnection) => this.handleDetached(info));\r\n    this.instance.bind('connection', (info: JsPlumbConnection) => this.handleAttached(info));\r\n  }\r\n\r\n  getAll(): StreamWire[] {\r\n    const connectionInfos: StreamWire[] = this.instance.getAllConnections()\r\n      .map((connection: JsPlumbConnection) => ({\r\n        From: guidOfDomId(connection.sourceId),\r\n        Out: getEndpointLabel(connection.endpoints[0]),\r\n        To: guidOfDomId(connection.targetId),\r\n        In: getEndpointLabel(connection.endpoints[1]),\r\n      } satisfies StreamWire)\r\n    );\r\n    return connectionInfos;\r\n  }\r\n  \r\n  \r\n  handleDetached(info: JsPlumbConnection) {\r\n    const l = this.log.fnIf('eventConnectionDetached');\r\n    if (this.bulkDelete)\r\n      return l.end('in bulk-delete mode, exit');\r\n\r\n    const domDataSource = info.target;\r\n    const pipelineDataSource = this.pipelineModel.DataSources.find(\r\n      pipelineDS => pipelineDS.EntityGuid === guidOfDomId(domDataSource.id)\r\n    );\r\n    const dataSource = findDefByType(this.dataSources, pipelineDataSource.PartAssemblyAndType);\r\n    const label = getEndpointLabel(info.targetEndpoint);\r\n    const isDynamic = !dataSource.In.some(name => this.endpointsSvc.getInfo(name, false).name === label);\r\n    if (isDynamic)\r\n      this.instance.deleteEndpoint(info.targetEndpoint);\r\n    setTimeout(() => this.onConnectionsChanged());\r\n    l.end('done');\r\n  }\r\n\r\n  handleAttached(info: JsPlumbConnection) {\r\n    const l = this.log.fnIf('eventConnectionAttached');\r\n    // This seems to handle a special detach case, but ATM 2025-04-03 I can't see where it would ever hit\r\n    if (info.sourceId === info.targetId) {\r\n      setTimeout(() => {\r\n        this.instance.deleteConnection(info.connection, { fireEvent: false });\r\n        setTimeout(() => this.onConnectionsChanged());\r\n      });\r\n      return l.end('self-connection, will delete and exit');\r\n    }\r\n    const targetEndpointOverlay = info.targetEndpoint.getOverlay('endpointLabel');\r\n    const targetLabel = targetEndpointOverlay.getLabel();\r\n    const endpoints = this.instance.getEndpoints(info.target.id);\r\n    const targetHasSameLabel = endpoints.some(ep => {\r\n      const label = getEndpointLabel(ep);\r\n      return label === targetLabel && info.targetEndpoint.id !== ep.id && ep.canvas.classList.contains('targetEndpoint');\r\n    });\r\n\r\n    // If label already exists, create a PleaseRename label\r\n    if (targetHasSameLabel)\r\n      targetEndpointOverlay.setLabel(`PleaseRename${Math.floor(Math.random() * 99999)}`);\r\n    setTimeout(() => this.onConnectionsChanged());\r\n    l.end('done', { targetLabel, targetHasSameLabel });\r\n  }\r\n\r\n\r\n}\r\n\r\n", "import { NgClass } from '@angular/common';\r\nimport { ChangeDetectorRef, Component, HostBinding, Inject, OnInit } from '@angular/core';\r\nimport { FormsModule, ReactiveFormsModule, UntypedFormControl, UntypedFormGroup, Validators } from '@angular/forms';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatOptionModule } from '@angular/material/core';\r\nimport { MAT_DIALOG_DATA, MatDialogActions, MatDialogRef } from '@angular/material/dialog';\r\nimport { MatFormFieldModule } from '@angular/material/form-field';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatInputModule } from '@angular/material/input';\r\nimport { MatSelectModule } from '@angular/material/select';\r\nimport { MatSlideToggleChange, MatSlideToggleModule } from '@angular/material/slide-toggle';\r\nimport { distinctUntilChanged, startWith } from 'rxjs';\r\nimport { transient } from '../../../../../../core';\r\nimport { ContentTypesService } from '../../../app-administration/services';\r\nimport { isCtrlEnter } from '../../../edit/dialog/main/keyboard-shortcuts';\r\nimport { BaseComponent } from '../../../shared/components/base';\r\nimport { FieldHintComponent } from '../../../shared/components/field-hint/field-hint';\r\nimport { eavConstants, ScopeOption } from '../../../shared/constants/eav.constants';\r\nimport { ClickStopPropagationDirective } from '../../../shared/directives/click-stop-propagation.directive';\r\nimport { SaveCloseButtonFabComponent } from '../../../shared/modules/save-close-button-fab/save-close-button-fab';\r\nimport { VisualQueryStateService } from '../../services/visual-query.service';\r\nimport { RenameStreamDialogControls, RenameStreamDialogData, RenameStreamDialogFormValue } from './rename-stream.models';\r\n\r\n@Component({\r\n  selector: 'app-rename-stream',\r\n  templateUrl: './rename-stream.html',\r\n  imports: [\r\n    MatButtonModule,\r\n    MatIconModule,\r\n    FormsModule,\r\n    ReactiveFormsModule,\r\n    MatFormFieldModule,\r\n    MatInputModule,\r\n    MatSelectModule,\r\n    MatOptionModule,\r\n    NgClass,\r\n    MatDialogActions,\r\n    MatSlideToggleModule,\r\n    FieldHintComponent,\r\n    ClickStopPropagationDirective,\r\n    SaveCloseButtonFabComponent,\r\n  ]\r\n})\r\nexport class RenameStreamComponent extends BaseComponent implements OnInit {\r\n  @HostBinding('className') hostClass = 'dialog-component';\r\n\r\n  form: UntypedFormGroup;\r\n  controls: RenameStreamDialogControls;\r\n  isSource = this.dialogData.isSource;\r\n  pipelineResultExists = this.visualQueryService.queryResult != null;\r\n  scopeOptions: ScopeOption[] = [];\r\n  labelOptions: string[] = [];\r\n  guidedLabel = true;\r\n  advancedMode = false;\r\n\r\n  #contentTypesSvc = transient(ContentTypesService);\r\n\r\n  constructor(\r\n    @Inject(MAT_DIALOG_DATA) private dialogData: RenameStreamDialogData,\r\n    private dialog: MatDialogRef<RenameStreamComponent>,\r\n    private visualQueryService: VisualQueryStateService,\r\n    private changeDetectorRef: ChangeDetectorRef,\r\n  ) {\r\n    super();\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.#buildForm();\r\n    this.#watchKeyboardShortcuts();\r\n  }\r\n\r\n  closeDialog(label?: string): void {\r\n    this.dialog.close(label);\r\n  }\r\n\r\n  toggleGuidedLabel(guidedLabel: boolean): void {\r\n    this.guidedLabel = guidedLabel;\r\n  }\r\n\r\n  toggleAdvancedMode(event: MatSlideToggleChange): void {\r\n    this.advancedMode = event.checked;\r\n  }\r\n\r\n  saveAndClose(): void {\r\n    const formValue: RenameStreamDialogFormValue = this.form.getRawValue();\r\n    this.closeDialog(formValue.label);\r\n  }\r\n\r\n  #buildForm(): void {\r\n    this.form = new UntypedFormGroup({\r\n      label: new UntypedFormControl(this.dialogData.label, Validators.required),\r\n      scope: new UntypedFormControl(eavConstants.scopes.default.value),\r\n    });\r\n    this.controls = this.form.controls as any;\r\n\r\n    if (!this.isSource || !this.pipelineResultExists)\r\n      return;\r\n\r\n    this.subscriptions.add(\r\n      this.controls.scope.valueChanges.pipe(\r\n        startWith<string>(this.controls.scope.value),\r\n        distinctUntilChanged(),\r\n      ).subscribe(scope => {\r\n        this.labelOptions = Object.values(this.visualQueryService.queryResult.Sources)\r\n          .find(source => source.Guid === this.dialogData.pipelineDataSourceGuid).Out\r\n          .filter(out => out.Scope === scope)\r\n          .map(out => out.Name);\r\n\r\n        if (!this.labelOptions.includes(this.controls.label.value) && this.controls.label.value != null)\r\n          this.controls.label.patchValue(null);\r\n      })\r\n    );\r\n\r\n    this.#contentTypesSvc.getScopesPromise().then(scopes => {\r\n      const sourceOut = Object.values(this.visualQueryService.queryResult.Sources)\r\n        .find(source => source.Guid === this.dialogData.pipelineDataSourceGuid).Out;\r\n      const filtered = scopes.filter(s => sourceOut.some(o => o.Scope === s.value));\r\n      this.scopeOptions = filtered;\r\n      this.changeDetectorRef.markForCheck();\r\n    });\r\n  }\r\n  \r\n  #watchKeyboardShortcuts(): void {\r\n    this.dialog.keydownEvents().subscribe(event => {\r\n      if (isCtrlEnter(event) && this.form.valid) {\r\n        event.preventDefault();\r\n        this.saveAndClose();\r\n      }\r\n    });\r\n  }\r\n}\r\n", "<div class=\"eav-dialog\">\r\n  <div class=\"eav-dialog-header\">\r\n    <div class=\"eav-dialog-header__title\">Rename stream</div>\r\n    <button\r\n      mat-icon-button\r\n      tippy=\"Close dialog\"\r\n      (click)=\"closeDialog()\"\r\n    >\r\n      <mat-icon>close</mat-icon>\r\n    </button>\r\n  </div>\r\n  <div class=\"eav-dialog-content\">\r\n    <form [formGroup]=\"form\">\r\n      <!-- Simple form -->\r\n      @if (!isSource || !pipelineResultExists) {\r\n        <!-- Label -->\r\n        <mat-form-field color=\"accent\" class=\"eav-mat-form-field\">\r\n          <mat-label>Label</mat-label>\r\n          <input matInput type=\"text\" formControlName=\"label\" required>\r\n        </mat-form-field>\r\n        @if (isSource && !pipelineResultExists) {\r\n          <app-field-hint>\r\n            You will get suggestions for out-streams after you run query\r\n          </app-field-hint>\r\n        }\r\n        @if (controls.label.touched && controls.label.errors?.required) {\r\n          <app-field-hint [isError]=\"true\">\r\n            This field is required\r\n          </app-field-hint>\r\n        }\r\n      }\r\n\r\n      <!-- Rich form -->\r\n      @if (isSource && pipelineResultExists) {\r\n        <!-- Scope -->\r\n        @if (advancedMode && guidedLabel) {\r\n          <mat-form-field color=\"accent\" class=\"eav-mat-form-field\">\r\n            <mat-label>Scope</mat-label>\r\n            <mat-select\r\n              formControlName=\"scope\"\r\n              [placeholder]=\"!scopeOptions.length\r\n                ? 'No items found'\r\n                : ''\"\r\n            >\r\n              @for (scopeOption of scopeOptions; track scopeOption) {\r\n                <mat-option [value]=\"scopeOption.value\">\r\n                  {{ scopeOption.name }}\r\n                </mat-option>\r\n              }\r\n            </mat-select>\r\n          </mat-form-field>\r\n          <app-field-hint>\r\n            The scope should almost never be changed -\r\n            <a href=\"https://2sxc.org/help?tag=scope\" target=\"_blank\" appClickStopPropagation>see help</a>\r\n          </app-field-hint>\r\n        }\r\n        <!-- Label -->\r\n        <mat-form-field color=\"accent\" class=\"eav-mat-form-field\">\r\n          <mat-label>Label</mat-label>\r\n          @if (guidedLabel) {\r\n            <mat-select formControlName=\"label\" required\r\n              [placeholder]=\"!labelOptions.length ? 'No items found' : ''\">\r\n              @for (labelOption of labelOptions; track labelOption) {\r\n                <mat-option [value]=\"labelOption\">\r\n                  {{ labelOption }}\r\n                </mat-option>\r\n              }\r\n            </mat-select>\r\n          }\r\n          @if (!guidedLabel) {\r\n            <input matInput type=\"text\" formControlName=\"label\" required>\r\n          }\r\n          <div matTextSuffix class=\"eav-selection-suffix\">\r\n            <button\r\n              mat-icon-button\r\n              class=\"eav-selection-suffix-button\"\r\n              type=\"button\"\r\n              [ngClass]=\"{ 'active': guidedLabel }\"\r\n              tippy=\"Pick existing value\"\r\n              (click)=\"toggleGuidedLabel(true)\"\r\n            >\r\n              <mat-icon class=\"eav-icon\">\r\n                search\r\n              </mat-icon>\r\n            </button>\r\n            <button\r\n              mat-icon-button\r\n              class=\"eav-selection-suffix-button\"\r\n              type=\"button\"\r\n              [ngClass]=\"{ 'active': !guidedLabel }\"\r\n              tippy=\"Manual entry\"\r\n              (click)=\"toggleGuidedLabel(false)\"\r\n              >\r\n                <mat-icon class=\"eav-icon\">\r\n                  text_fields\r\n                </mat-icon>\r\n            </button>\r\n          </div>\r\n        </mat-form-field>\r\n        @if (controls.label.touched && controls.label.errors?.required) {\r\n          <app-field-hint [isError]=\"true\">\r\n            This field is required\r\n          </app-field-hint>\r\n        }\r\n      }\r\n    </form>\r\n  </div>\r\n  <mat-dialog-actions class=\"eav-dialog-actions\">\r\n    <!-- Extra button for rich form -->\r\n    <div>\r\n      @if (isSource && pipelineResultExists) {\r\n        <mat-slide-toggle\r\n          color=\"accent\"\r\n          [checked]=\"advancedMode\"\r\n          (change)=\"toggleAdvancedMode($event)\"\r\n        >\r\n          {{ advancedMode ? 'Advanced' : 'Simple' }}\r\n        </mat-slide-toggle>\r\n      }\r\n    </div>\r\n    <app-save-close-button-fab\r\n      [label]=\"'Rename and close (ctrl + enter)'\"\r\n      (action)=\"saveAndClose()\"\r\n      [disabled]=\"!form.valid\"\r\n      [ngClass]=\"!form.valid ? 'disabled' : ''\"\r\n    />\r\n  </mat-dialog-actions>\r\n</div>\r\n", "import { classLog } from '../../shared/logging';\r\nimport { PipelineModel } from '../models';\r\nimport { EndpointLabelRenameParts } from './endpoint-label-rename.model';\r\nimport { JsPlumbEndpoint, JsPlumbOverlay } from './jsplumb.models';\r\nimport { EndpointInfo } from './plumb-editor.models';\r\nimport { RenameStreamComponent } from './rename-stream/rename-stream';\r\nimport { RenameStreamDialogData } from './rename-stream/rename-stream.models';\r\n\r\nconst logSpecs = {\r\n  all: true,\r\n  getEndpointOverlays: true,\r\n  getEndpointInfo: true,\r\n  buildSourceDef: true,\r\n  buildTargetDef: true,\r\n}\r\n\r\n/**\r\n * Trivial helper to get endpoint definitions and similar things\r\n */\r\nexport class EndpointDefinitionsService {\r\n\r\n  log = classLog({EndpointDefinitionsService}, logSpecs);\r\n\r\n  constructor(\r\n    private pipelineModel: PipelineModel,\r\n    private renameDialogParts: EndpointLabelRenameParts,\r\n  ) { }\r\n\r\n  #getEndpointOverlays(isSource: boolean) {\r\n    const l = this.log.fnIf('getEndpointOverlays', {isSource});\r\n    const result = [\r\n      [\r\n        'Label', {\r\n          id: 'endpointLabel',\r\n          location: [0.5, isSource ? 0 : 1],\r\n          label: 'Default',\r\n          cssClass: isSource ? 'endpointSourceLabel' : 'endpointTargetLabel',\r\n        },\r\n      ],\r\n    ];\r\n    return l.r(result);\r\n  }\r\n\r\n  getInfo(endpointName: string, isDynamic: boolean): EndpointInfo {\r\n    const l = this.log.fnIf('getEndpointInfo', {endpointName, isDynamic});\r\n    // let name: string;\r\n    // let required: boolean;\r\n\r\n    // Trim name and see if it's required - marked with a trailing '*'\r\n    const trimmed = endpointName.trim();\r\n    const required = trimmed.endsWith('*');\r\n    const name = !required\r\n      ? trimmed\r\n      : trimmed.substring(0, trimmed.length - 1);\r\n\r\n    if (isDynamic)\r\n      return l.r({\r\n        name,\r\n        required: false\r\n      } satisfies EndpointInfo, 'isDynamic');\r\n\r\n    return l.r({ name, required } satisfies EndpointInfo, 'notDynamic');\r\n  }\r\n\r\n  buildSourceDef(dsGuid: string, style?: string) {\r\n    const l = this.log.fnIf('buildSourceDef', {pipelineDataSourceGuid: dsGuid, style});\r\n    const isSource = true;\r\n    const sourceEndpoint = {\r\n      paintStyle: { fill: 'transparent', radius: 10 },\r\n      cssClass: 'sourceEndpoint ' + (style ?? ''),\r\n      maxConnections: -1,\r\n      isSource,\r\n      anchor: ['Continuous', { faces: ['top'] }],\r\n      overlays: this.#getEndpointOverlays(isSource),\r\n      events: {\r\n        click: (endpointOrOverlay: JsPlumbOverlay) => this.onChangeLabel(endpointOrOverlay, isSource, dsGuid),\r\n      },\r\n    };\r\n    return l.r(sourceEndpoint);\r\n  }\r\n\r\n  buildTargetDef(dsGuid: string, style?: string) {\r\n    const l = this.log.fnIf('buildTargetDef', {pipelineDataSourceGuid: dsGuid, style});\r\n    const isSource = false;\r\n    const targetEndpoint = {\r\n      paintStyle: { fill: 'transparent', radius: 10 },\r\n      cssClass: 'targetEndpoint ' + (style ?? ' '), // + (angled ? 'angled' : ''),\r\n      maxConnections: 1,\r\n      isTarget: !isSource,\r\n      anchor: ['Continuous', { faces: ['bottom'] }],\r\n      overlays: this.#getEndpointOverlays(isSource),\r\n      dropOptions: { hoverClass: 'hover', activeClass: 'active' },\r\n      events: {\r\n        click: (endpointOrOverlay: JsPlumbOverlay) => this.onChangeLabel(endpointOrOverlay, isSource, dsGuid),\r\n      },\r\n    };\r\n    return l.r(targetEndpoint);\r\n  }\r\n\r\n\r\n  onChangeLabel(endpointOrOverlay: JsPlumbEndpoint | JsPlumbOverlay, isSource: boolean, pipelineDataSourceGuid: string) {\r\n    if (!this.pipelineModel.Pipeline.AllowEdit)\r\n      return;\r\n\r\n    debugger;\r\n    const overlay: JsPlumbOverlay = (endpointOrOverlay as JsPlumbEndpoint)?.getOverlay?.('endpointLabel')\r\n      ?? endpointOrOverlay as JsPlumbOverlay;\r\n\r\n    this.renameDialogParts.matDialog\r\n      .open(RenameStreamComponent, {\r\n        autoFocus: false,\r\n        data: {\r\n          pipelineDataSourceGuid,\r\n          isSource,\r\n          label: overlay.label,\r\n        } satisfies RenameStreamDialogData,\r\n        viewContainerRef: this.renameDialogParts.viewContainerRef,\r\n        width: '650px',\r\n      })\r\n      .afterClosed().subscribe(newLabel => {\r\n        if (!newLabel)\r\n          return;\r\n        overlay.setLabel(newLabel);\r\n        setTimeout(() => this.renameDialogParts.onConnectionsChanged());\r\n      });\r\n\r\n    this.renameDialogParts.changeDetectorRef.markForCheck();\r\n  }\r\n\r\n\r\n  // public onChangeLabel(endpointOrOverlay: JsPlumbEndpoint | JsPlumbOverlay, isSource: boolean, pipelineDataSourceGuid: string) {\r\n  //   if (!this.pipelineModel.Pipeline.AllowEdit)\r\n  //     return;\r\n\r\n  //   const overlay: JsPlumbOverlay = (endpointOrOverlay as JsPlumbEndpoint)?.getOverlay('endpointLabel')\r\n  //     ?? endpointOrOverlay as JsPlumbOverlay;\r\n\r\n  //   this.matDialog\r\n  //     .open(RenameStreamComponent, {\r\n  //       autoFocus: false,\r\n  //       data: {\r\n  //         pipelineDataSourceGuid,\r\n  //         isSource,\r\n  //         label: overlay.label,\r\n  //       } satisfies RenameStreamDialogData,\r\n  //       viewContainerRef: this.viewContainerRef,\r\n  //       width: '650px',\r\n  //     })\r\n  //     .afterClosed().subscribe(newLabel => {\r\n  //       if (!newLabel)\r\n  //         return;\r\n  //       overlay.setLabel(newLabel);\r\n  //       setTimeout(() => this.onConnectionsChanged());\r\n  //     });\r\n\r\n  //   this.changeDetectorRef.markForCheck();\r\n  // }\r\n\r\n}\r\n", "import { eavConstants } from '../../shared/constants/eav.constants';\r\nimport { classLog } from '../../shared/logging';\r\nimport { PipelineDataSource } from '../models';\r\nimport { ConnectionsManager } from './connections-manager';\r\nimport { findDefByType, getEndpointLabel } from './datasource.helpers';\r\nimport { EndpointDefinitionsService } from './endpoint-definitions';\r\nimport { JsPlumbEndpoint, JsPlumbInstance } from './jsplumb.models';\r\nimport { domIdOfGuid } from './plumber-constants';\r\nimport { QueryDataManager } from './query-data-manager';\r\n\r\nconst logSpecs = {\r\n  all: false,\r\n  addEndpoint: false,\r\n  reOrientAllLabels: false,\r\n  updateAfterChanges: false,\r\n  wireHasConnection: false,\r\n  mirrorEndpoints: false,\r\n  fields: ['TestIn2', 'Default'],\r\n}\r\n\r\nconst endPointsWhereWeRotate = 3;\r\nconst maxLabelLengthToRotate = 30;\r\n\r\nexport class EndpointsManager {\r\n  log = classLog({EndpointsManager}, logSpecs);\r\n\r\n  constructor(\r\n    private instance: JsPlumbInstance, \r\n    private endpointDefs: EndpointDefinitionsService,\r\n    private connections: ConnectionsManager,\r\n    private queryData: QueryDataManager,\r\n  ) { }\r\n\r\n  \r\n  addEndpoint(domDataSource: HTMLElement, endpointName: string, isIn: boolean, queryDs: PipelineDataSource, extraStyling?: string) {\r\n    const l = this.log.fnIfInList('addEndpoint', 'fields', endpointName, { endpointName, isIn, queryDs });\r\n    const dsDefinition = findDefByType(this.queryData.dataSources, queryDs.PartAssemblyAndType);\r\n    const connectionList = isIn\r\n      ? dsDefinition.In\r\n      : dsDefinition.Out;\r\n    const hasDynamic = connectionList?.some(name => this.endpointDefs.getInfo(name, false).required === false);\r\n    const endpointInfo = this.endpointDefs.getInfo(endpointName, hasDynamic);\r\n\r\n    l.a(`endpointInfo`, { dataSource: dsDefinition, connectionList, hasDynamic, endpointInfo });\r\n\r\n    // if (endpointName === \"DEBUG\") debugger;\r\n\r\n    // Figure out additional styling based on the endpoint type\r\n    const style = hasDynamic\r\n      ? 'dynamic' // dynamic endpoints are not required\r\n      : !endpointInfo.required\r\n        ? ''      // not required\r\n        : this.#wireHasConnection(domDataSource, endpointInfo.name, isIn) ? '' : 'required'; // required - check if it's populated; otherwise make red\r\n\r\n\r\n    const uuid = domDataSource.id + (isIn ? '_in_' : '_out_') + endpointInfo.name;\r\n    const model = isIn\r\n      ? this.endpointDefs.buildTargetDef(queryDs.EntityGuid, `${style} ${extraStyling}`)\r\n      : this.endpointDefs.buildSourceDef(queryDs.EntityGuid, `${style} ${extraStyling}`);\r\n    // Endpoints on Out-DataSource must be always enabled\r\n    const params = {\r\n      uuid,\r\n      enabled: this.queryData.query.Pipeline.AllowEdit\r\n        || queryDs.EntityGuid === eavConstants.pipelineDesigner.outDataSource.EntityGuid\r\n    };\r\n\r\n    // Add endpoint and add label and css in case it must be angled\r\n    const endpoint = this.instance.addEndpoint(domDataSource, model, params);\r\n    const overlay = endpoint.getOverlay('endpointLabel');\r\n    overlay.setLabel(endpointInfo.name);\r\n    l.end(\"end\", {overlay});\r\n  }\r\n\r\n  /**\r\n   * Check if a specific endpoint has a connection\r\n   * Note that it uses the query model to check, not the DOM.\r\n   * So in certain cases where a change is just being made, it could be wrong.\r\n   */\r\n  #wireHasConnection(domDataSource: HTMLElement, name: string, isIn: boolean = true) {\r\n    const l = this.log.fnIf('wireHasConnection', { domDataSource, name, isIn });\r\n    const wireExists = this.queryData.query.Pipeline.StreamWiring?.some(wire => isIn\r\n        ? domIdOfGuid(wire.To) === domDataSource.id && wire.In === name\r\n        : domIdOfGuid(wire.From) === domDataSource.id && wire.Out === name\r\n    );\r\n    return l.r(wireExists, 'wireExists' + wireExists);\r\n  }\r\n\r\n  #isDoingUpdate = false;\r\n\r\n  updateAfterChanges() {\r\n    const l = this.log.fnIf('updateAfterChanges', { query: this.queryData.query, isDoing: this.#isDoingUpdate });\r\n\r\n    // Prevent loops\r\n    if (this.#isDoingUpdate)\r\n      return l.end('already doing update, exit');\r\n    this.#isDoingUpdate = true;\r\n\r\n    this.#mirrorEndpoints();\r\n\r\n    this.#reOrientAllLabels();\r\n\r\n    this.#isDoingUpdate = false;\r\n    this.instance.repaintEverything();\r\n    l.end('done');\r\n  }\r\n\r\n  #mirrorEndpoints() {\r\n    const l = this.log.fnIf('mirrorEndpoints', { query: this.queryData.query });\r\n    // Get all parts which have mirror-in mode\r\n    const partsMirrorIn = this.queryData.query.DataSources\r\n    .map(ds => {\r\n      const def = findDefByType(this.queryData.dataSources, ds.PartAssemblyAndType);\r\n      return (def.OutMode === 'mirror-in') ? { def, guid: ds.EntityGuid } : null;\r\n    })\r\n    .filter(d => d !== null);\r\n    \r\n    // Check if we need to mirror anything\r\n    partsMirrorIn.forEach(ds => {\r\n      const { inPoints, outPoints } = this.#getEndpointsByType(ds.guid);\r\n\r\n      const inLabels = inPoints.map(p => ({ point: p, label: getEndpointLabel(p)}));\r\n      const outLabels = outPoints.map(p => ({ point: p, label: getEndpointLabel(p)}));\r\n\r\n      // Get mismatching lists of out and in\r\n      const missingInOut = inLabels.filter(inP => !outLabels.some(outP => outP.label === inP.label));\r\n      const outWithoutIn = outLabels.filter(outP => !inLabels.some(inP => inP.label === outP.label));\r\n      l.a('inMissingInOut', { inPoints, outPoints, missingInOut, outWithoutIn });\r\n\r\n      // Add missing labels to out\r\n      const { domDataSource, dataSource } = this.queryData.findDataSourceAndDom(ds.guid);\r\n      if (missingInOut.length) {\r\n        missingInOut.forEach(p => this.addEndpoint(domDataSource, p.label, false, dataSource, 'mirror-in'));\r\n      }\r\n\r\n      // Remove excessive labels\r\n      // Only consider the ones which have a `mirror-in` class and remove them\r\n      outWithoutIn.forEach(p => {\r\n        if (p.point.canvas.classList.contains('mirror-in')) {\r\n          const hasConnection = p.point.connections?.length;\r\n          if (!hasConnection)\r\n            this.instance.deleteEndpoint(p.point);\r\n        }\r\n      });\r\n    });  \r\n  }\r\n\r\n  /**\r\n   * Ugly way to get the endpoints by type in/out. Not elegant, but don't know a better method ATM\r\n   */\r\n  #getEndpointsByType(guid: string) {\r\n    const endpoints = this.instance.selectEndpoints({ element: domIdOfGuid(guid) });\r\n    const inPoints: JsPlumbEndpoint[] = [];\r\n    const outPoints: JsPlumbEndpoint[] = [];\r\n    endpoints.each((ep: JsPlumbEndpoint) => (ep.isTarget ? inPoints : outPoints).push(ep));\r\n    return { inPoints, outPoints };\r\n  }\r\n\r\n  /**\r\n   * Check all labels and if there are too many, rotate them at an angle\r\n   */\r\n  #reOrientAllLabels() {\r\n    const l = this.log.fnIf('reOrientAllLabels');\r\n    const parts = this.queryData.query.DataSources.map(ds => ds.EntityGuid);\r\n\r\n    parts.forEach(guid => {\r\n      const {inPoints, outPoints} = this.#getEndpointsByType(guid);\r\n      this.#reorientListOfEndpoints(inPoints);\r\n      this.#reorientListOfEndpoints(outPoints);\r\n    });\r\n    l.end();\r\n  }\r\n\r\n  #reorientListOfEndpoints(endpoints: JsPlumbEndpoint[]) {\r\n    const countExceeded = endpoints.length > endPointsWhereWeRotate;\r\n\r\n    const labels = endpoints.map(endpoint => getEndpointLabel(endpoint)).join(',');\r\n\r\n    if (countExceeded || labels.length > maxLabelLengthToRotate)\r\n      endpoints.forEach(element => element.addClass('angled'));\r\n    else\r\n      endpoints.forEach(element => element.removeClass('angled'));\r\n  }\r\n\r\n\r\n  removeAllEndpoints(dataSourceGuid: string) {\r\n    const elementId = domIdOfGuid(dataSourceGuid);\r\n    this.connections.bulkDelete = true;\r\n    this.instance.batch(() => {\r\n      this.instance.selectEndpoints({ element: elementId }).delete();\r\n    });\r\n    this.connections.bulkDelete = false;\r\n  }\r\n\r\n}\r\n\r\n", "import { WindowWithJsPlumb } from '../window';\r\nimport { ConnectionLineColors } from './connection-line-colors';\r\nimport { JsPlumbInstance } from './jsplumb.models';\r\n\r\ndeclare const window: WindowWithJsPlumb;\r\n\r\nexport class JsPlumbInstanceManager {\r\n  constructor(private jsPlumbRoot: HTMLElement, private lineColors: ConnectionLineColors) {\r\n    this.instance = window.jsPlumb.getInstance(this.createInstanceDefaults(this.jsPlumbRoot));\r\n  }\r\n\r\n  instance: JsPlumbInstance;\r\n\r\n  createInstanceDefaults(container: HTMLElement) {\r\n    const defaults = {\r\n      Container: container,\r\n      Connector: ['Bezier', { curviness: 70 }],\r\n      PaintStyle: this.lineColors.nextLinePaintStyle('dummy'),\r\n      HoverPaintStyle: {\r\n        stroke: '#216477',\r\n        strokeWidth: 4,\r\n        outlineStroke: 'white',\r\n        outlineWidth: 2,\r\n      },\r\n    };\r\n    return defaults;\r\n  }\r\n\r\n  destroy() {\r\n    this.instance.reset();\r\n    this.instance.unbindContainer();\r\n    this.instance = null;\r\n  }\r\n}", "import { classLog } from '../../shared/logging';\r\nimport { PipelineModel, PipelineResult, PipelineResultStream } from '../models';\r\nimport { JsPlumbEndpoint, JsPlumbInstance } from './jsplumb.models';\r\nimport { domIdOfGuid } from './plumber-constants';\r\n\r\nconst logSpecs = {\r\n  all: false,\r\n  putEntityCountOnConnections: false,\r\n}\r\n\r\nexport class LinesDecorator {\r\n  log = classLog({LinesDecorator}, logSpecs);\r\n\r\n  constructor(\r\n    private instance: JsPlumbInstance, \r\n    private pipelineModel: PipelineModel,\r\n    private onDebugStream: (stream: PipelineResultStream) => void,\r\n  ) { }\r\n  \r\n  /**\r\n   * Updates the entity count on each connections based on the provided result.\r\n   * @param result PipelineResult\r\n   */\r\n  addEntityCount(result: PipelineResult) {\r\n    const l = this.log.fnIf('putEntityCountOnConnections');\r\n    result.Streams?.forEach(stream => {\r\n      const outDomId = domIdOfGuid(stream.Source);\r\n      const outTargets = ['00000000-0000-0000-0000-000000000000', this.pipelineModel.Pipeline.EntityGuid];\r\n      const inDomId = outTargets.includes(stream.Target)\r\n        ? domIdOfGuid('Out')\r\n        : domIdOfGuid(stream.Target);\r\n\r\n      const fromUuid = outDomId + '_out_' + stream.SourceOut;\r\n      const toUuid = inDomId + '_in_' + stream.TargetIn;\r\n\r\n      const endpoint: JsPlumbEndpoint = this.instance.getEndpoint(fromUuid);\r\n      endpoint?.connections\r\n        ?.filter((connection) => connection.endpoints[1].getUuid() === toUuid)\r\n        ?.forEach((connection) => {\r\n          const label = !stream.Error ? stream.Count.toString() : '';\r\n          const cssClass = 'streamEntitiesCount ' + (!stream.Error ? '' : 'streamEntitiesError');\r\n          connection.setLabel({\r\n            label,\r\n            cssClass,\r\n            events: {\r\n              click: () => {\r\n                if (!this.pipelineModel.Pipeline.AllowEdit)\r\n                  return;\r\n                this.onDebugStream(stream);\r\n              },\r\n            },\r\n          });\r\n        });\r\n    });\r\n    l.end('done');\r\n  }\r\n}", "import { classLog } from '../../shared/logging';\r\nimport { DataSource, PipelineModel } from '../models';\r\nimport { DataSourceSet } from './data-source-set.model';\r\nimport { findDefByType } from './datasource.helpers';\r\nimport { domIdOfGuid, guidOfDomId } from './plumber-constants';\r\n\r\nconst logSpecs = {\r\n  all: false,\r\n  findDataSourceAndDom: false,\r\n  // fields: ['TestIn2', 'Default'],\r\n}\r\n\r\nexport class QueryDataManager {\r\n  log = classLog({QueryDataManager}, logSpecs);\r\n\r\n  constructor(\r\n    private jsPlumbRoot: HTMLElement, \r\n    public query: PipelineModel,\r\n    public dataSources: DataSource[]\r\n  ) { }\r\n\r\n  findDomAndDef(guid: string, partAssemblyAndType: string): (DataSourceSet & { definition: DataSource }) | null {\r\n    const dsSet = this.findDataSourceAndDom(guid);\r\n    if (!dsSet)\r\n      return null;\r\n    const dsDef = findDefByType(this.dataSources, partAssemblyAndType);\r\n    if (!dsDef)\r\n      return null;\r\n    return { ...dsSet, definition: dsDef };\r\n  }\r\n\r\n  findDataSourceAndDom(sourceElementId: string) : DataSourceSet | null {\r\n    const l = this.log.fnIf('findDataSourceAndDom', { sourceElementId });\r\n\r\n    // if DOM doesn't exist, do nothing\r\n    const domDataSource = this.jsPlumbRoot.querySelector<HTMLElement>('#' + domIdOfGuid(sourceElementId));\r\n    if (!domDataSource)\r\n      return l.r(null, \"DOM not found, exit\");\r\n\r\n    const guid = guidOfDomId(domDataSource.id);\r\n    const dataSource = this.query.DataSources.find(pipeDs => pipeDs.EntityGuid === guid);\r\n    return l.r({ domDataSource, dataSource }, \"returning data source\");\r\n  }\r\n}\r\n\r\n", "import { classLog } from '../../shared/logging';\r\nimport { DataSourceSet } from './data-source-set.model';\r\nimport { JsPlumbInstance } from './jsplumb.models';\r\nimport { domIdOfGuid } from './plumber-constants';\r\nimport { Plumber } from './plumber.helper';\r\nimport { QueryDataManager } from './query-data-manager';\r\n\r\nconst logSpecs = {\r\n  all: false,\r\n  initWirings: true,\r\n  ensureWireEndpointExists: true,\r\n  findDataSourceInDom: true,\r\n  fields: ['TestIn2', '*'],\r\n}\r\n\r\nexport class WiringsHelper {\r\n  log = classLog({WiringsHelper}, logSpecs);\r\n\r\n  constructor(\r\n    private plumber: Plumber,\r\n    private instance: JsPlumbInstance,\r\n    private queryData: QueryDataManager,\r\n  ) { }\r\n\r\n  initWirings() {\r\n    const l = this.log.fnIf('initWirings');\r\n    const wiringsRaw = this.queryData.query.Pipeline.StreamWiring;\r\n    if (!wiringsRaw)\r\n      return l.end('no wirings');\r\n\r\n    const wirings = wiringsRaw.map(wire => {\r\n      // read connections from Pipeline\r\n      const outDsDomId = domIdOfGuid(wire.From);\r\n      const outPointDomId = outDsDomId + '_out_' + wire.Out;\r\n      const inDsDomId = domIdOfGuid(wire.To);\r\n      const inPointDomId = inDsDomId + '_in_' + wire.In;\r\n      return {\r\n        outPointDomId,\r\n        inPointDomId,\r\n        wire\r\n      };\r\n    });\r\n\r\n    l.a('wirings', { wireDetails: wirings });\r\n\r\n    // Build all the Endpoints which don't exist yet based on the wirings\r\n    wirings.forEach(w => {\r\n      // Ensure Out-Endpoint exist\r\n      this.#ensureWireEndpointExists(w.outPointDomId, w.wire.From, w.wire.Out, false);\r\n\r\n      // Ensure In-Endpoint exist\r\n      this.#ensureWireEndpointExists(w.inPointDomId, w.wire.To, w.wire.In, true);\r\n    });\r\n\r\n    // Connect all the wirings\r\n    wirings.forEach(w => this.#connect(w.outPointDomId, w.inPointDomId));\r\n\r\n    this.instance.repaintEverything();\r\n\r\n    l.end();\r\n  }\r\n\r\n  #connect(outDomId: string, inDomId: string) {\r\n    try {\r\n      this.instance.connect({\r\n        uuids: [outDomId, inDomId],\r\n        paintStyle: this.plumber.lineColors.nextLinePaintStyle(outDomId),\r\n      });\r\n    } catch (e) {\r\n      console.error({ message: 'Connection failed', from: outDomId, to: inDomId });\r\n    }\r\n  }\r\n  \r\n\r\n  #ensureWireEndpointExists(endpointId: string, sourceGuid: string, name: string, isIn: boolean) : DataSourceSet | null {\r\n    const l = this.log.fnIfInList('ensureWireEndpointExists', 'fields', name, { endpointId, sourceGuid, name, isIn });\r\n    // Find data source infos & DOM, if not found, do nothing\r\n    const set = this.#findDataSourceInDom(endpointId, sourceGuid, name);\r\n    if (set == null)\r\n      return l.r(set, \"set null\");\r\n\r\n    // const name = isIn ? wire.In : wire.Out;\r\n    this.plumber.endpoints.addEndpoint(set.domDataSource, name, isIn, set.dataSource);\r\n    return l.r(set, 'ok');\r\n  }\r\n\r\n  #findDataSourceInDom(endpointId: string, sourceGuid: string, name: string) : DataSourceSet | null {\r\n    const l = this.log.fnIfInList('findDataSourceInDom', 'fields', name, { endpointId, sourceGuid, name });\r\n    // if exists, do nothing\r\n    if (this.instance.getEndpoint(endpointId))\r\n      return l.r(null, \"endpoint exists, exit\");\r\n\r\n    const result = this.queryData.findDataSourceAndDom(sourceGuid);\r\n    return l.r(result, `found: ${result != null}`);\r\n  }\r\n\r\n}\r\n\r\n\r\n\r\n\r\n// https://stackoverflow.com/questions/14446511/most-efficient-method-to-groupby-on-an-array-of-objects\r\nconst groupBy = <T, K extends keyof any>(arr: T[], key: (i: T) => K) =>\r\n  arr.reduce((groups, item) => {\r\n    (groups[key(item)] ||= []).push(item);\r\n    return groups;\r\n  }, {} as Record<K, T[]>);\r\n\r\n\r\n      // 2025-04-02 2dm standardized / reduced the code old\r\n      // leave commented out portions in for a few weeks, to ensure we know what happened if something breaks\r\n      // Ensure In-Endpoint exist\r\n      // if (!this.#instance.getEndpoint(fromUuid)) {\r\n      //   const domDataSource = this.jsPlumbRoot.querySelector<HTMLElement>('#' + sourceElementId);\r\n      //   if (!domDataSource)\r\n      //     return;\r\n      //   const guid: string = domDataSource.id.replace(dataSrcIdPrefix, '');\r\n      //   const dataSource = this.pipelineModel.DataSources.find(pipeDataSource => pipeDataSource.EntityGuid === guid);\r\n      //   this.#addEndpoint(domDataSource, wire.Out, false, dataSource, outGroups[wire.From].length);\r\n      // }\r\n      // Ensure Out-Endpoint exist\r\n      // if (!this.#instance.getEndpoint(toUuid)) {\r\n      //   const domDataSource = this.jsPlumbRoot.querySelector<HTMLElement>('#' + targetElementId);\r\n      //   if (!domDataSource)\r\n      //     return;\r\n      //   const guid: string = domDataSource.id.replace(dataSrcIdPrefix, '');\r\n      //   const dataSource = this.pipelineModel.DataSources.find(pipeDataSource => pipeDataSource.EntityGuid === guid);\r\n      //   // if (wire.In === \"DEBUG\") debugger;\r\n      //   this.#addEndpoint(domDataSource, wire.In, true, dataSource, inGroups[wire.To].length);\r\n      // }\r\n\r\n      // this.#connect(w.outPointDomId, w.inPointDomId);\r\n", "import { classLog } from '../../shared/logging';\r\nimport { DataSource, PipelineModel, PipelineResultStream, VisualDesignerData } from '../models';\r\nimport { ConnectionLineColors } from './connection-line-colors';\r\nimport { ConnectionsManager } from './connections-manager';\r\nimport { getEndpointLabel } from './datasource.helpers';\r\nimport { EndpointDefinitionsService } from './endpoint-definitions';\r\nimport { EndpointLabelRenameParts } from './endpoint-label-rename.model';\r\nimport { EndpointsManager } from './endpoints-manager';\r\nimport { JsPlumbInstanceManager } from './jsplumb-instance-manager';\r\nimport { JsPlumbEndpoint, JsPlumbInstance } from './jsplumb.models';\r\nimport { LinesDecorator } from './lines-decorator';\r\nimport { domIdOfGuid, guidOfDomId } from './plumber-constants';\r\nimport { QueryDataManager } from './query-data-manager';\r\nimport { WiringsHelper } from './wirings.helper';\r\n\r\nconst logSpecs = {\r\n  all: false,\r\n  addEndpoint: true,\r\n  initDomDataSources: false,\r\n  eventConnectionDetached: true,\r\n  eventConnectionAttached: true,\r\n  fields: ['TestIn2'],\r\n}\r\n\r\nexport class Plumber {\r\n\r\n  log = classLog({Plumber}, logSpecs);\r\n\r\n  #instance: JsPlumbInstance;\r\n\r\n  lineColors = new ConnectionLineColors();\r\n\r\n  #endpointDefs: EndpointDefinitionsService;\r\n\r\n  lineDecorator: LinesDecorator;\r\n\r\n  connections: ConnectionsManager;\r\n\r\n  #instanceManager: JsPlumbInstanceManager;\r\n\r\n  endpoints: EndpointsManager;\r\n\r\n  queryData: QueryDataManager;\r\n\r\n  constructor(\r\n    private jsPlumbRoot: HTMLElement,\r\n    private query: PipelineModel,\r\n    private dataSources: DataSource[],\r\n    private onConnectionsChangedParent: () => void,\r\n    private onDragend: (pipelineDataSourceGuid: string, position: VisualDesignerData) => void,\r\n    private onDebugStream: (stream: PipelineResultStream) => void,\r\n    renameDialogParts: EndpointLabelRenameParts,\r\n  ) {\r\n    this.queryData = new QueryDataManager(this.jsPlumbRoot, this.query, this.dataSources);\r\n    this.#endpointDefs = new EndpointDefinitionsService(query, { ...renameDialogParts, onConnectionsChanged: () => this.#onConnectionsChanged() });\r\n    this.#instanceManager = new JsPlumbInstanceManager(this.jsPlumbRoot, this.lineColors);\r\n    this.#instance = this.#instanceManager.instance;\r\n    // requires instance, so must happen after that\r\n    this.lineDecorator = new LinesDecorator(this.#instance, this.query, this.onDebugStream);\r\n    this.connections = new ConnectionsManager(this.#instance, this.query, this.dataSources, this.#endpointDefs, () => this.#onConnectionsChanged());\r\n    this.endpoints = new EndpointsManager(this.#instance, this.#endpointDefs, this.connections, this.queryData);\r\n\r\n    // Suspend drawing while initializing\r\n    this.#instance.batch(() => {\r\n      this.#initDomDataSources();\r\n      new WiringsHelper(this, this.#instance, this.queryData).initWirings();\r\n      this.connections.setup();\r\n      this.endpoints.updateAfterChanges();\r\n    });\r\n\r\n    // spm NOTE: repaint after initial paint fixes:\r\n    // Error: <svg> attribute width: Expected length, \"-Infinity\".\r\n    this.#instance.repaintEverything();\r\n\r\n  }\r\n  #onConnectionsChanged() {\r\n    // After connection changes, re-check if we need to slant the labels\r\n    this.endpoints.updateAfterChanges();\r\n    // call the parent for storing the data etc.\r\n    this.onConnectionsChangedParent();\r\n  }\r\n\r\n  destroy() {\r\n    this.#instanceManager.destroy();\r\n  }\r\n\r\n  removeAllEndpoints(pipelineDataSourceGuid: string) {\r\n    const elementId = domIdOfGuid(pipelineDataSourceGuid);\r\n    this.connections.bulkDelete = true;\r\n    this.#instance.batch(() => {\r\n      this.#instance.selectEndpoints({ element: elementId }).delete();\r\n    });\r\n    this.connections.bulkDelete = false;\r\n  }\r\n\r\n  getStreamsOut() {\r\n    const streamsOut: string[] = [];\r\n    this.#instance\r\n      .selectEndpoints({ target: domIdOfGuid('Out') })\r\n      .each((endpoint: JsPlumbEndpoint) => {\r\n        streamsOut.push(getEndpointLabel(endpoint));\r\n      });\r\n    const streamsOutStr = streamsOut.join(',');\r\n    return streamsOutStr;\r\n  }\r\n\r\n  /** Create sources, targets and endpoints */\r\n  #initDomDataSources() {\r\n    const l = this.log.fnIf('initDomDataSources');\r\n    for (const queryDs of this.query.DataSources) {\r\n      const { domDataSource: domDs, definition: dataSource } = this.queryData.findDomAndDef(queryDs.EntityGuid, queryDs.PartAssemblyAndType);\r\n      if (!domDs)\r\n        continue;\r\n\r\n      if (this.query.Pipeline.AllowEdit) {\r\n        // WARNING! Must happen before instance.makeSource()\r\n        this.#instance.draggable(domDs, {\r\n          grid: [20, 20],\r\n          stop: (event: { el: HTMLElement, finalPos: number[] }) => {\r\n            const element: HTMLElement = event.el;\r\n            const queryDsGuid: string = guidOfDomId(element.id);\r\n            const position: VisualDesignerData = {\r\n              Top: event.finalPos[1],\r\n              Left: event.finalPos[0],\r\n            };\r\n            setTimeout(() => this.onDragend(queryDsGuid, position));\r\n          }\r\n        });\r\n      }\r\n\r\n      // Add Out-Endpoints from Definition\r\n      const outCount = dataSource.Out?.length ?? 0;\r\n      l.a('dataSource.Out', { outCount, out: dataSource.Out });\r\n      dataSource.Out?.forEach(name => {\r\n        this.endpoints.addEndpoint(domDs, name, false, queryDs);\r\n      });\r\n\r\n      // Add dynamic Out-Endpoints (if .OutMode is not static)\r\n      if (dataSource.OutMode != 'static') {\r\n        const dynOut = this.#endpointDefs.buildSourceDef(queryDs.EntityGuid);\r\n        this.#instance.makeSource(domDs, dynOut, { filter: '.add-endpoint' });\r\n      }\r\n\r\n      // Add In-Endpoints from Definition\r\n      const inCount = dataSource.In?.length ?? 0;\r\n      l.a('dataSource.In', { inCount, in: dataSource.In });\r\n      dataSource.In?.forEach(name => {\r\n        this.endpoints.addEndpoint(domDs, name, true, queryDs);\r\n      });\r\n\r\n      // Make DataSource a Target for new Endpoints (if .In is an Array)\r\n      if (dataSource.In) {\r\n        const targetEndpointUnlimited = this.#endpointDefs.buildTargetDef(queryDs.EntityGuid);\r\n        targetEndpointUnlimited.maxConnections = -1;\r\n        this.#instance.makeTarget(domDs, targetEndpointUnlimited);\r\n      }\r\n\r\n    }\r\n    l.end();\r\n  }\r\n\r\n\r\n}\r\n", "// tslint:disable-next-line:max-line-length\r\nimport { NgClass, NgStyle } from '@angular/common';\r\nimport { AfterViewInit, ChangeDetectorRef, Component, computed, ElementRef, OnDestroy, OnInit, QueryList, ViewChild, ViewChildren, ViewContainerRef } from '@angular/core';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { BehaviorSubject, combineLatest, map } from 'rxjs';\r\nimport { transient } from '../../../../../core';\r\nimport { BaseComponent } from '../../shared/components/base';\r\nimport { eavConstants } from '../../shared/constants/eav.constants';\r\nimport { MousedownStopPropagationDirective } from '../../shared/directives/mousedown-stop-propagation.directive';\r\nimport { JsonHelpers } from '../../shared/helpers/json.helpers';\r\nimport { loadScripts } from '../../shared/helpers/load-scripts.helper';\r\nimport { classLog } from '../../shared/logging';\r\nimport { PipelineDataSource, PipelineResultStream, VisualDesignerData } from '../models';\r\nimport { QueryDefinitionService } from '../services/query-definition.service';\r\nimport { VisualQueryStateService } from '../services/visual-query.service';\r\nimport { findDefByType } from './datasource.helpers';\r\nimport { calculateTypeInfos } from './plumb-editor.helpers';\r\nimport { domIdOfGuid } from './plumber-constants';\r\nimport { Plumber } from './plumber.helper';\r\n\r\nconst logSpecs = {\r\n  all: false,\r\n  ngAfterViewInit: false,\r\n}\r\n\r\nconst jsPlumbUrl = 'https://cdnjs.cloudflare.com/ajax/libs/jsPlumb/2.14.5/js/jsplumb.min.js';\r\n\r\n@Component({\r\n    selector: 'app-plumb-editor',\r\n    templateUrl: './plumb-editor.html',\r\n    styles: [':host { display: block; width: 100%; height: 100%; }'],\r\n    imports: [\r\n        NgStyle,\r\n        NgClass,\r\n        MatIconModule,\r\n        MousedownStopPropagationDirective,\r\n    ]\r\n})\r\nexport class PlumbEditorComponent extends BaseComponent implements OnInit, AfterViewInit, OnDestroy {\r\n\r\n  log = classLog({ PlumbEditorComponent }, logSpecs);\r\n\r\n  @ViewChild('domRoot') private domRootRef: ElementRef<HTMLDivElement>;\r\n  @ViewChildren('domDataSource') private domDataSourcesRef: QueryList<ElementRef<HTMLDivElement>>;\r\n\r\n  /** provide this fn to the UI */\r\n  domIdOfGuid = domIdOfGuid;\r\n  hardReset = false;\r\n\r\n  #plumber: Plumber;\r\n  #scriptLoaded$ = new BehaviorSubject(false);\r\n\r\n\r\n  #queryDefinitionSvc = transient(QueryDefinitionService);\r\n\r\n  showDataSourceDetails = computed(() => {\r\n    const result = JsonHelpers.tryParse(this.visQuerySvc.pipelineModel()?.Pipeline.VisualDesignerData) ?? {};\r\n    return result.ShowDataSourceDetails ?? false;\r\n  });\r\n\r\n  typeInfos = computed(() =>\r\n    calculateTypeInfos(this.visQuerySvc.pipelineModel()?.DataSources ?? [], this.visQuerySvc.dataSources()\r\n    ));\r\n\r\n  constructor(\r\n    public visQuerySvc: VisualQueryStateService, // Check if this not with transient better\r\n    private changeDetectorRef: ChangeDetectorRef,\r\n    private matDialog: MatDialog,\r\n    private viewContainerRef: ViewContainerRef,\r\n  ) { super(); }\r\n\r\n  ngOnInit() {\r\n    loadScripts([{ test: 'jsPlumb', src: jsPlumbUrl }], () => {\r\n      this.#scriptLoaded$.next(true);\r\n    });\r\n\r\n    this.subscriptions.add(\r\n      this.visQuerySvc.putEntityCountOnConnections$.subscribe(result => {\r\n        this.#plumber.lineDecorator.addEntityCount(result);\r\n      })\r\n    );\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    const l = this.log.fnIf('ngAfterViewInit');\r\n    // https://stackoverflow.com/questions/37087864/execute-a-function-when-ngfor-finished-in-angular-2/37088348#37088348\r\n    const domDataSourcesLoaded$ = this.domDataSourcesRef.changes.pipe(map(() => true));\r\n\r\n    this.subscriptions.add(\r\n      combineLatest([this.#scriptLoaded$, domDataSourcesLoaded$]).subscribe(([scriptLoaded, domDataSourcesLoaded]) => {\r\n        if (!scriptLoaded || !domDataSourcesLoaded)\r\n          return;\r\n\r\n        l.a('scriptLoaded and domDataSourcesLoaded', { scriptLoaded, domDataSourcesLoaded });\r\n\r\n        this.#plumber?.destroy();\r\n        this.#plumber = new Plumber(\r\n          this.domRootRef.nativeElement,\r\n          this.visQuerySvc.pipelineModel(),\r\n          this.visQuerySvc.dataSources(),\r\n          () => this.onConnectionsChanged(),\r\n          this.onDragend.bind(this),\r\n          this.onDebugStream.bind(this),\r\n          {\r\n            matDialog: this.matDialog,\r\n            viewContainerRef: this.viewContainerRef,\r\n            changeDetectorRef: this.changeDetectorRef,\r\n            onConnectionsChanged: () => this.onConnectionsChanged(),\r\n          },\r\n        );\r\n      })\r\n    );\r\n    l.end();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.#plumber?.destroy();\r\n    this.#scriptLoaded$.complete();\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  onConnectionsChanged() {\r\n    const connections = this.#plumber.connections.getAll();\r\n    const streamsOut = this.#plumber.getStreamsOut();\r\n    this.visQuerySvc.changeConnections(connections, streamsOut);\r\n  }\r\n\r\n  onDragend(pipelineDataSourceGuid: string, position: VisualDesignerData) {\r\n    this.visQuerySvc.changeDataSourcePosition(pipelineDataSourceGuid, position);\r\n  }\r\n\r\n  onDebugStream(stream: PipelineResultStream) {\r\n    this.visQuerySvc.debugStream(stream);\r\n  }\r\n\r\n  configureDataSource(dataSource: PipelineDataSource): void {\r\n    // ensure dataSource entity is saved\r\n    if (dataSource.EntityGuid.includes('unsaved'))\r\n      return this.visQuerySvc.saveAndRun(true, false);\r\n\r\n    this.visQuerySvc.editDataSource(dataSource);\r\n  }\r\n\r\n  getTypeName(partAssemblyAndType: string) {\r\n    const dataSource = findDefByType(this.visQuerySvc.dataSources(), partAssemblyAndType);\r\n    return this.#queryDefinitionSvc.typeNameFilter(dataSource?.TypeNameForUi || partAssemblyAndType, 'className');\r\n  }\r\n\r\n  isOutDataSource(pipelineDataSource: PipelineDataSource) {\r\n    return pipelineDataSource.PartAssemblyAndType === eavConstants.pipelineDesigner.outDataSource.PartAssemblyAndType;\r\n  }\r\n\r\n  remove(pipelineDataSource: PipelineDataSource) {\r\n    if (!confirm(`Delete ${pipelineDataSource.Name} data source?`))\r\n      return;\r\n\r\n    // Update UI\r\n    this.#plumber.removeAllEndpoints(pipelineDataSource.EntityGuid);\r\n\r\n    // Tell backend to clean up\r\n    const connections = this.#plumber.connections.getAll();\r\n    const streamsOut = this.#plumber.getStreamsOut();\r\n    this.visQuerySvc.removeDataSource(pipelineDataSource.EntityGuid, connections, streamsOut);\r\n  }\r\n\r\n  openHelp(url: string) {\r\n    window.open(url, '_blank');\r\n  }\r\n\r\n  editName(dataSource: PipelineDataSource) {\r\n    const newName = prompt('Rename data source', dataSource.Name)?.trim();\r\n    if (newName == null || newName === '')\r\n      return;\r\n\r\n    this.visQuerySvc.renameDataSource(dataSource.EntityGuid, newName);\r\n  }\r\n\r\n  editDescription(dataSource: PipelineDataSource) {\r\n    const newDescription = prompt('Edit description', dataSource.Description)?.trim();\r\n    if (newDescription == null)\r\n      return;\r\n\r\n    this.visQuerySvc.changeDataSourceDescription(dataSource.EntityGuid, newDescription);\r\n  }\r\n\r\n}\r\n", "@if (visQuerySvc.pipelineModel()) {\r\n  <div #domRoot id=\"pipeline-root\">\r\n    <!-- do not use trackBy, jsPlumb drag stops working properly after delete -->\r\n    @if (!hardReset) {\r\n      @for (dataSource of visQuerySvc.pipelineModel().DataSources; track dataSource) {\r\n        <div\r\n          #domDataSource\r\n          [id]=\"domIdOfGuid(dataSource.EntityGuid)\"\r\n          class=\"dataSource\"\r\n          [ngStyle]=\"{\r\n            top: dataSource.VisualDesignerData.Top + 'px',\r\n            left: dataSource.VisualDesignerData.Left + 'px',\r\n            'min-width': dataSource.VisualDesignerData.Width ? dataSource.VisualDesignerData.Width + 'px' : null,\r\n          }\"\r\n          [ngClass]=\"{\r\n            'show-details': showDataSourceDetails() && visQuerySvc.dataSourceConfigs()[dataSource.EntityId]?.length,\r\n          }\"\r\n        >\r\n          <div class=\"actions left\">\r\n            <mat-icon class=\"type-info\" [title]=\"typeInfos()[dataSource.EntityGuid].UiHint\">\r\n              {{ typeInfos()[dataSource.EntityGuid].Icon }}\r\n            </mat-icon>\r\n            @if (visQuerySvc.pipelineModel().Pipeline.AllowEdit && typeInfos()[dataSource.EntityGuid].EnableConfig) {\r\n              <mat-icon\r\n                class=\"configure\"\r\n                title=\"Configure data source\"\r\n                appMousedownStopPropagation\r\n                (click)=\"configureDataSource(dataSource)\"\r\n              >\r\n                settings\r\n              </mat-icon>\r\n            }\r\n            @if (typeInfos()[dataSource.EntityGuid].HelpLink) {\r\n              <mat-icon\r\n                class=\"help\"\r\n                title=\"Help for this data source\"\r\n                appMousedownStopPropagation\r\n                (click)=\"openHelp(typeInfos()[dataSource.EntityGuid].HelpLink)\"\r\n              >\r\n                help_outline\r\n              </mat-icon>\r\n            }\r\n          </div>\r\n          <div class=\"actions right\">\r\n            @if (visQuerySvc.pipelineModel().Pipeline.AllowEdit && !isOutDataSource(dataSource)) {\r\n              <mat-icon class=\"delete\" title=\"Delete\" appMousedownStopPropagation (click)=\"remove(dataSource)\"> delete </mat-icon>\r\n            }\r\n          </div>\r\n          <div\r\n            class=\"name\"\r\n            title=\"Click to edit name\"\r\n            appMousedownStopPropagation\r\n            (click)=\"visQuerySvc.pipelineModel().Pipeline.AllowEdit && editName(dataSource)\"\r\n          >\r\n            <span>{{ dataSource.Name || '(no name)' }}</span>\r\n            <mat-icon class=\"show-hover-inline\">edit</mat-icon>\r\n          </div>\r\n          <br />\r\n          <div\r\n            class=\"description\"\r\n            title=\"Click to edit description\"\r\n            appMousedownStopPropagation\r\n            (click)=\"visQuerySvc.pipelineModel().Pipeline.AllowEdit && editDescription(dataSource)\"\r\n          >\r\n            <span>{{ dataSource.Description }}</span>\r\n            <mat-icon class=\"show-hover-inline\">edit</mat-icon>\r\n          </div>\r\n          <br />\r\n          @if (showDataSourceDetails() && visQuerySvc.dataSourceConfigs()[dataSource.EntityId]?.length) {\r\n            <hr style=\"margin: 0\" />\r\n            <table class=\"configs\">\r\n              @for (config of visQuerySvc.dataSourceConfigs()[dataSource.EntityId]; track config) {\r\n                <tr class=\"config\">\r\n                  <td class=\"config-name\" [title]=\"config.name\">{{ config.name }}</td>\r\n                  <td class=\"config-value\" [title]=\"config.value\">{{ config.value }}</td>\r\n                </tr>\r\n              }\r\n            </table>\r\n          }\r\n          <div class=\"typename\" [title]=\"dataSource.PartAssemblyAndType\">Type: {{ getTypeName(dataSource.PartAssemblyAndType) }}</div>\r\n          @if (visQuerySvc.pipelineModel().Pipeline.AllowEdit && typeInfos()[dataSource.EntityGuid].DynamicOut) {\r\n            <div class=\"add-endpoint sourceEndpoint dynamic\" title=\"Drag a new Out-Connection\"></div>\r\n          }\r\n          @if (visQuerySvc.pipelineModel().Pipeline.AllowEdit && typeInfos()[dataSource.EntityGuid].DynamicIn) {\r\n            <div class=\"many-in targetEndpoint dynamic\" title=\"This data source supports multiple In-Connections\"></div>\r\n          }\r\n        </div>\r\n      }\r\n    }\r\n  </div>\r\n}\r\n", "import { Context } from '../../shared/services/context';\r\nimport { PipelineModel } from '../models';\r\n\r\n/**\r\n * Check if there are special warnings the developer should know.\r\n * Typically when the test ModuleId is different from the one we're currently working on\r\n */\r\nexport function calculateWarnings(pipelineModel: PipelineModel, context: Context) {\r\n  if(!pipelineModel) return [];\r\n  const warnings: string[] = [];\r\n\r\n  try {\r\n    const queryParams = pipelineModel.Pipeline.Params?.split(/\\r?\\n/) || [];\r\n    const testParams = pipelineModel.Pipeline.TestParameters?.split(/\\r?\\n/) || [];\r\n\r\n    queryParams.forEach(param => {\r\n      param = param?.trim();\r\n      if (!param) return;\r\n\r\n      // Check if the syntax on Query Parameters is off.\r\n      // It should contain [...]=...\r\n      // But it's easy to forget the [ and ] brackets\r\n      const paramSyntax = /^[a-zA-Z0-9]+=(.*)$/gmi;\r\n      const matched = paramSyntax.test(param);\r\n      if (!matched) {\r\n        warnings.push(`\r\n          A <em>Query Parameter</em> seems wrong: <br>\r\n          <code>${param}</code> <br>\r\n          It should use the syntax: <br>\r\n          <code>key=value</code> <br>\r\n          or resolve to a token like: <br>\r\n          <code>key=[source:key]</code>\r\n        `);\r\n      }\r\n    });\r\n\r\n    testParams.forEach(param => {\r\n      param = param?.trim();\r\n      if (!param) return;\r\n\r\n      // Check if the syntax on Test Parameters is off.\r\n      // It should contain [...]=...\r\n      // But it's easy to forget the [ and ] brackets\r\n      const testParamSyntax = /^\\[[a-zA-Z]+:[a-zA-Z0-9]+\\]=(.*)$/gmi;\r\n      const matched = testParamSyntax.test(param);\r\n      if (!matched) {\r\n        warnings.push(`\r\n          A <em>Test Parameter</em> seems wrong: <br>\r\n          <code>${param}</code> <br>\r\n          It should use the syntax: <br>\r\n          <code>[source:key]=value</code>\r\n        `);\r\n      }\r\n\r\n      // Check if we should show the warning about the test ModuleId.\r\n      // This is because in the old days, the ModuleId wasn't auto-filled, so people had to add it as a test value.\r\n      // Now it's not necessary any more\r\n      const midRegex = /^\\[module:id\\]=([0-9]*)$/gmi;\r\n      const midMatch = midRegex.exec(param);\r\n      if (midMatch) {\r\n        const testMid = midMatch[1];\r\n        const urlMid = context.moduleId?.toString();\r\n        if (testMid !== urlMid) {\r\n          warnings.push(`\r\n            Your test ModuleId (${testMid}) is different from the current ModuleId (${urlMid}).<br>\r\n            Note that 2sxc automatically provides the ModuleId - so you usually do not need to set it\r\n          `);\r\n        }\r\n      }\r\n\r\n      const oldMidRegex = /^\\[module:moduleid\\]=([0-9]*)$/gmi;\r\n      const oldMidMatch = oldMidRegex.exec(param);\r\n      if (oldMidMatch) {\r\n        warnings.push(`\r\n          You are using deprecated [Module:ModuleId] test parameter.<br>\r\n          Please use [Module:Id]\r\n        `);\r\n      }\r\n    });\r\n  } catch (error) {\r\n    console.error('Something went wrong in calculateWarnings for params', error);\r\n  }\r\n\r\n  return warnings;\r\n}\r\n", "import { Component, signal } from '@angular/core';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatSlideToggleChange, MatSlideToggleModule } from '@angular/material/slide-toggle';\r\nimport { transient } from '../../../../../core';\r\nimport { GoToDevRest } from '../../dev-rest';\r\nimport { JsonHelpers } from '../../shared/helpers/json.helpers';\r\nimport { DialogRoutingService } from '../../shared/routing/dialog-routing.service';\r\nimport { Context } from '../../shared/services/context';\r\nimport { VisualQueryStateService } from '../services/visual-query.service';\r\nimport { calculateWarnings } from './run-explorer.helpers';\r\n\r\n@Component({\r\n    selector: 'app-run-explorer',\r\n    templateUrl: './run-explorer.html',\r\n    styleUrls: ['./run-explorer.scss'],\r\n    imports: [\r\n        MatButtonModule,\r\n        MatIconModule,\r\n        MatSlideToggleModule,\r\n    ]\r\n})\r\nexport class RunExplorerComponent {\r\n\r\n  warningSig = signal<string[]>(\r\n    calculateWarnings(this.vsSvc?.pipelineModel() ?? null, this.context)\r\n  );\r\n\r\n  visualDesignerDataSig = signal<Record<string, any>>(\r\n    JsonHelpers.tryParse(this.vsSvc?.pipelineModel()?.Pipeline.VisualDesignerData) ?? {}\r\n  );\r\n\r\n  #dialogRouter = transient(DialogRoutingService);\r\n\r\n  constructor(\r\n    private context: Context,\r\n    public vsSvc: VisualQueryStateService,\r\n  ) { }\r\n\r\n  editPipeline() {\r\n    this.vsSvc.editPipelineEntity();\r\n  }\r\n\r\n  openParamsHelp() {\r\n    window.open('https://go.2sxc.org/QueryParams', '_blank');\r\n  }\r\n\r\n  saveAndRunQuery(save: boolean, run: boolean) {\r\n    this.vsSvc.saveAndRun(save, run);\r\n  }\r\n\r\n  showDataSourceDetails(event: MatSlideToggleChange): void {\r\n    this.vsSvc.showDataSourceDetails(event.checked);\r\n  }\r\n\r\n  openRestApi() {\r\n    const queryGuid = this.vsSvc.pipelineModel().Pipeline.EntityGuid;\r\n    this.#dialogRouter.navRelative([GoToDevRest.getUrlQueryDialog(queryGuid)]);\r\n  }\r\n}\r\n", "@if (vsSvc.pipelineModel()) {\r\n  <div class=\"editor-active-explorer fancy-scrollbar-dark\">\r\n    <div class=\"wrapper\">\r\n      <div class=\"actions\">\r\n        <button\r\n          mat-raised-button\r\n          class=\"eav-action-button action\"\r\n          style=\"border: 1px #adadad solid\"\r\n          (click)=\"saveAndRunQuery(true, true)\"\r\n          >\r\n            Save and run\r\n          </button>\r\n        <button\r\n          mat-raised-button\r\n          class=\"action\"\r\n          (click)=\"saveAndRunQuery(false, true)\"\r\n        >\r\n            Run\r\n        </button>\r\n        <button\r\n          mat-raised-button\r\n          class=\"action\"\r\n          (click)=\"saveAndRunQuery(true, false)\"\r\n        >\r\n        Save\r\n        </button>\r\n      </div>\r\n      <div class=\"parameters\">\r\n        <div class=\"title\">\r\n          <div>Query Parameters</div>\r\n          <div>\r\n            <button mat-icon-button tippy=\"Edit parameters\" (click)=\"editPipeline()\">\r\n              <mat-icon>edit</mat-icon>\r\n            </button>\r\n            <button mat-icon-button tippy=\"Query Params Docs\" (click)=\"openParamsHelp()\">\r\n              <mat-icon>info</mat-icon>\r\n            </button>\r\n          </div>\r\n        </div>\r\n        @if (vsSvc.pipelineModel().Pipeline.Params?.length) {\r\n          <ul class=\"values\">\r\n            @for (\r\n              param of vsSvc.pipelineModel().Pipeline.Params?.split('\\n');\r\n              track param;\r\n            ) {\r\n              <li>\r\n                {{ param }}\r\n              </li>\r\n            }\r\n          </ul>\r\n        }\r\n      </div>\r\n      <div class=\"parameters\">\r\n        <div class=\"title\">Test Parameters</div>\r\n        @if (vsSvc.pipelineModel().Pipeline.TestParameters?.length) {\r\n          <ul class=\"values\">\r\n            @for (\r\n              param of vsSvc.pipelineModel().Pipeline.TestParameters?.split('\\n');\r\n              track param;\r\n            ) {\r\n              <li>\r\n                {{ param }}\r\n              </li>\r\n            }\r\n          </ul>\r\n        }\r\n      </div>\r\n      @if (visualDesignerDataSig()) {\r\n        <div class=\"parameters\">\r\n          <span class=\"eav-slide-toggle-label\">Show DataSource Params</span>\r\n          <mat-slide-toggle\r\n            color=\"primary\"\r\n            [checked]=\"visualDesignerDataSig().ShowDataSourceDetails\"\r\n            (change)=\"showDataSourceDetails($event)\"\r\n          />\r\n        </div>\r\n      }\r\n      @if (warningSig()) {\r\n        @if (warningSig().length) {\r\n          <div class=\"warnings\">\r\n            <div class=\"title\">\r\n              <span>Warnings</span>\r\n              <mat-icon style=\"color: red\">warning</mat-icon>\r\n            </div>\r\n            <ol class=\"values\">\r\n              @for (warning of warningSig(); track warning) {\r\n                <li [innerHTML]=\"warning\"></li>\r\n              }\r\n            </ol>\r\n          </div>\r\n        }\r\n      }\r\n      @if (vsSvc.pipelineModel().Pipeline.Description) {\r\n        <div class=\"description\">\r\n          <div class=\"title\">Query Description</div>\r\n          <div>{{ vsSvc.pipelineModel().Pipeline.Description }}</div>\r\n        </div>\r\n      }\r\n      <div class=\"footer-actions\">\r\n        <button mat-raised-button class=\"action\" (click)=\"openRestApi()\">\r\n          <span>Use in JSON / REST API</span>\r\n          <mat-icon>code_curly</mat-icon>\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n}\r\n", "import { NgClass } from '@angular/common';\r\nimport { Component, OnInit, ViewChild } from '@angular/core';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { ActivatedRoute, RouterOutlet } from '@angular/router';\r\nimport { Context } from '../shared/services/context';\r\nimport { AddExplorerComponent } from './add-explorer/add-explorer';\r\nimport { PlumbEditorComponent } from './plumb-editor/plumb-editor';\r\nimport { RunExplorerComponent } from './run-explorer/run-explorer';\r\nimport { VisualQueryStateService } from './services/visual-query.service';\r\n\r\n@Component({\r\n    selector: 'app-visual-query',\r\n    templateUrl: './visual-query.html',\r\n    styleUrls: ['./visual-query.scss'],\r\n    imports: [\r\n        RouterOutlet,\r\n        NgClass,\r\n        MatIconModule,\r\n        RunExplorerComponent,\r\n        AddExplorerComponent,\r\n        PlumbEditorComponent,\r\n    ],\r\n    providers: [\r\n        VisualQueryStateService, // Shared State for the entire Visual Query, - init run here\r\n    ]\r\n})\r\nexport class VisualQueryComponent implements OnInit {\r\n  @ViewChild(PlumbEditorComponent) plumbEditor: PlumbEditorComponent;\r\n\r\n  explorer = {\r\n    run: 'run',\r\n    add: 'add'\r\n  };\r\n  activeExplorer = this.explorer.run;\r\n\r\n  constructor(\r\n    private context: Context,\r\n    private route: ActivatedRoute,\r\n    private visualQueryService: VisualQueryStateService\r\n  ) {\r\n    this.context.init(this.route);\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.visualQueryService.init();\r\n  }\r\n\r\n  toggleExplorer(explorer: string) {\r\n    this.activeExplorer = (this.activeExplorer === explorer) ? null : explorer;\r\n  }\r\n\r\n  openHelp() {\r\n    window.open('https://go.2sxc.org/visual-query', '_blank');\r\n  }\r\n\r\n}\r\n", "<router-outlet></router-outlet>\r\n\r\n<div class=\"editor-root\">\r\n  <div class=\"editor-side-toolbar\">\r\n    <div class=\"button\" tippy=\"Run\" [ngClass]=\"{ 'active': activeExplorer === explorer.run }\"\r\n      (click)=\"toggleExplorer(explorer.run)\">\r\n      <mat-icon>play_arrow</mat-icon>\r\n    </div>\r\n    <div class=\"button\" tippy=\"Add\" [ngClass]=\"{ 'active': activeExplorer === explorer.add }\"\r\n      (click)=\"toggleExplorer(explorer.add)\">\r\n      <mat-icon>add</mat-icon>\r\n    </div>\r\n    <div class=\"spacer\"></div>\r\n    <div class=\"button\" tippy=\"Help\" (click)=\"openHelp()\">\r\n      <mat-icon>help_outline</mat-icon>\r\n    </div>\r\n  </div>\r\n\r\n  <app-run-explorer [hidden]=\"activeExplorer !== explorer.run\"></app-run-explorer>\r\n\r\n  <app-add-explorer [hidden]=\"activeExplorer !== explorer.add\"></app-add-explorer>\r\n\r\n  <app-plumb-editor></app-plumb-editor>\r\n</div>\r\n"],
  "mappings": "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",
  "names": ["findDefByType", "dataSources", "partAssemblyAndType", "find", "ds", "PartAssemblyAndType", "getEndpointLabel", "endpoint", "getOverlay", "label", "guiTypes", "App", "Name", "Label", "Icon", "UiHint", "Cache", "Filter", "Logic", "Lookup", "Modify", "Security", "Sort", "Source", "Target", "Unknown", "Debug", "System", "calculateTypeInfos", "pipelineDataSources", "dataSources", "typeInfos", "pipelineDataSource", "ds", "findDefByType", "PartAssemblyAndType", "typeInfo", "__spreadValues", "__spreadProps", "PrimaryType", "DynamicIn", "DynamicOut", "OutMode", "HelpLink", "outMode", "EnableConfig", "EntityGuid", "QueryDefinitionService", "HttpServiceBaseSignal", "fetchPipelinePromise", "pipelineEntityId", "dataSources", "fetchPromise", "webApiQueryGet", "params", "appId", "id", "toString", "then", "pipelineModel", "DataSources", "length", "#buildDefaultModel", "#fixPipelineDataSources", "templateDataSources", "eavConstants", "pipelineDesigner", "defaultPipeline", "templateDS", "dataSource", "findDefByType", "PartAssemblyAndType", "pipelineDataSource", "Description", "EntityGuid", "EntityId", "undefined", "Name", "VisualDesignerData", "push", "Pipeline", "StreamWiring", "streamWiring", "pipelineDataSources", "some", "pipelineDS", "outDataSource", "outDs", "outDsConst", "Top", "Left", "fetchDataSourcesPromise", "webApiQueryDataSources", "appid", "zoneId", "outFinalTarget", "typeNameFilter", "input", "format", "globalParts", "split", "classFullNameParts", "savePipeline", "pipeline", "http", "post", "webApiQuerySave", "Id", "pipe", "map", "newPipelineModel", "runPipelinePromise", "top", "webApiQueryRun", "debugStreamPromise", "source", "sourceOut", "webApiQueryDebugStream", "from", "out", "__ngFactoryType__", "factory", "\u0275fac", "\u0275\u0275text", "\u0275\u0275textInterpolate2", "ctx_r0", "debugStream", "name", "sourceName", "\u0275\u0275elementStart", "\u0275\u0275elementEnd", "\u0275\u0275textInterpolate1", "top", "option_r3", "\u0275\u0275listener", "\u0275\u0275restoreView", "_r2", "$implicit", "\u0275\u0275nextContext", "\u0275\u0275resetView", "show", "\u0275\u0275conditionalCreate", "QueryResultComponent_For_21_Conditional_2_Template", "QueryResultComponent_For_21_Conditional_3_Template", "\u0275\u0275advance", "\u0275\u0275conditional", "\u0275\u0275textInterpolate", "param_r4", "\u0275\u0275template", "QueryResultComponent_Conditional_25_div_1_Template", "\u0275\u0275repeaterCreate", "QueryResultComponent_Conditional_25_For_5_Template", "\u0275\u0275repeaterTrackByIdentity", "\u0275\u0275repeater", "parameters", "source_r5", "value", "Definition", "Name", "config_r6", "key", "QueryResultComponent_For_40_Conditional_2_Template", "QueryResultComponent_For_40_For_10_Template", "Guid", "Type", "\u0275\u0275pipeBind1", "Configuration", "Error", "stream_r7", "Source", "SourceOut", "Target", "TargetIn", "Count", "QueryResultComponent", "constructor", "dialogData", "dialog", "visualQueryService", "ngOnInit", "pipeline", "pipelineModel", "Pipeline", "params", "Params", "split", "filter", "el", "testParams", "TestParameters", "concat", "timeUsed", "result", "QueryTimer", "Milliseconds", "ticksUsed", "Ticks", "optionsForTop", "Query", "sources", "Sources", "streams", "Streams", "closeDialog", "close", "original", "runPipeline", "\u0275\u0275directiveInject", "MAT_DIALOG_DATA", "MatDialogRef", "VisualQueryStateService", "selectors", "decls", "vars", "consts", "template", "rf", "ctx", "QueryResultComponent_Conditional_4_Template", "QueryResultComponent_div_13_Template", "QueryResultComponent_Conditional_17_Template", "QueryResultComponent_Conditional_18_Template", "QueryResultComponent_For_21_Template", "QueryResultComponent_Conditional_25_Template", "QueryResultComponent_div_27_Template", "QueryResultComponent_For_40_Template", "QueryResultComponent_div_43_Template", "QueryResultComponent_For_56_Template", "length", "MatButtonModule", "MatButton", "MatIconButton", "MatIconModule", "MatIcon", "MatTabsModule", "MatTabLabel", "MatTab", "MatTabGroup", "JsonPipe", "KeyValuePipe", "styles", "StreamErrorResultComponent", "constructor", "dialogData", "dialog", "ngOnInit", "errorData", "closeDialog", "close", "openInsights", "window", "open", "$2sxc", "http", "apiUrl", "\u0275\u0275directiveInject", "MAT_DIALOG_DATA", "MatDialogRef", "selectors", "decls", "vars", "consts", "template", "rf", "ctx", "\u0275\u0275elementStart", "\u0275\u0275text", "\u0275\u0275elementEnd", "\u0275\u0275listener", "\u0275\u0275advance", "\u0275\u0275textInterpolate", "\u0275\u0275pipeBind1", "MatButtonModule", "MatButton", "MatIconButton", "MatIconModule", "MatIcon", "MatDialogActions", "JsonPipe", "styles", "VisualQueryStateService", "ServiceBase", "#contentTypesSvc", "#metadataSvc", "#queryDefSvc", "#dialogRoute", "#titleSvc", "#pipelineId", "#refreshPipeline", "#refreshDataSourceConfigs", "constructor", "snackBar", "matDialog", "viewContainerRef", "zone", "changeDetectorRef", "transient", "ContentTypesService", "MetadataService", "QueryDefinitionService", "DialogRoutingService", "Title", "pipelineModel", "signal", "dataSources", "dataSourceConfigs", "putEntityCountOnConnections$", "Subject", "parseInt", "getParam", "ngOnDestroy", "complete", "init", "#fetchDataSources", "#fetchPipeline", "#attachKeyboardSave", "doOnDialogClosed", "editPipelineEntity", "#savePipeline", "form", "items", "EditPrep", "editId", "Pipeline", "EntityId", "formUrl", "convertFormToUrl", "navRelative", "saveAndRun", "save", "run", "runPipeline", "showDataSourceDetails", "showDetails", "query", "cloneDeep", "designerData", "JsonHelpers", "tryParse", "VisualDesignerData", "ShowDataSourceDetails", "JSON", "stringify", "set", "addDataSource", "dataSource", "newSource", "Description", "EntityGuid", "DataSources", "length", "undefined", "Name", "PartAssemblyAndType", "Top", "Left", "push", "removeDataSource", "pipelineDataSourceGuid", "connections", "streamsOut", "filter", "pipelineDS", "StreamWiring", "StreamsOut", "renameDataSource", "name", "find", "changeDataSourceDescription", "description", "changeConnections", "changeDataSourcePosition", "position", "__spreadValues", "#calculateDataSourceConfigs", "forEach", "Metadata", "metadataItem", "Object", "entries", "attributeName", "attributeValue", "includes", "Array", "isArray", "Id", "dataSourceConfig", "value", "editDataSource", "pipelineDataSource", "contentTypeName", "findDefByType", "ContentType", "targetType", "keyType", "eavConstants", "metadata", "entity", "key", "getMetadataPromise", "then", "Items", "retrieveContentType", "subscribe", "next", "contentType", "open", "duration", "newMetadata", "error", "callback", "savePipeline", "top", "runPipelinePromise", "pipelineResult", "queryResult", "#showQueryResult", "console", "warn", "setTimeout", "catch", "debugStream", "stream", "Error", "#showStreamErrorResult", "Count", "pipelineId", "debugStreamPromise", "Source", "SourceOut", "streamResult", "ds", "source", "sourceName", "original", "_error", "refreshPipeline", "refreshDataSourceConfigs", "showSnackBar", "fetchPipelinePromise", "setTitle", "result", "dialogData", "QueryResultComponent", "autoFocus", "backdropClass", "closeOnNavigation", "data", "panelClass", "markForCheck", "errorData", "ErrorData", "StreamErrorResultComponent", "fetchDataSourcesPromise", "runOutsideAngular", "subscriptions", "add", "fromEvent", "window", "pipe", "snapshot", "firstChild", "event", "isCtrlS", "preventDefault", "\u0275\u0275inject", "MatSnackBar", "MatDialog", "ViewContainerRef", "NgZone", "ChangeDetectorRef", "factory", "\u0275fac", "filterAndSortDataSources", "dataSources", "maxDifficulty", "filtered", "cloneDeep", "filter", "dataSource", "Difficulty", "PartAssemblyAndType", "eavConstants", "pipelineDesigner", "outDataSource", "sort", "a", "b", "Name", "toLocaleLowerCase", "localeCompare", "sorted", "type", "PrimaryType", "push", "\u0275\u0275elementStart", "\u0275\u0275listener", "dataSource_r6", "\u0275\u0275restoreView", "_r5", "$implicit", "ctx_r1", "\u0275\u0275nextContext", "\u0275\u0275resetView", "addDataSource", "\u0275\u0275text", "\u0275\u0275elementEnd", "\u0275\u0275property", "UiHint", "Name", "\u0275\u0275advance", "\u0275\u0275textInterpolate", "Icon", "guiTypes", "Unknown", "\u0275\u0275repeaterCreate", "AddExplorerComponent_Conditional_0_For_6_Conditional_5_For_2_Template", "\u0275\u0275componentInstance", "trackDataSources", "\u0275\u0275repeater", "group_r4", "value", "_r3", "toggleItem", "key", "\u0275\u0275conditionalCreate", "AddExplorerComponent_Conditional_0_For_6_Conditional_5_Template", "Label", "\u0275\u0275conditional", "toggledItems", "includes", "$event", "_r1", "toggleDifficulty", "AddExplorerComponent_Conditional_0_For_6_Template", "trackGroups", "\u0275\u0275pipeBind1", "sorted", "AddExplorerComponent", "#difficulties", "#difficulty", "constructor", "visualQueryService", "eavConstants", "pipelineDesigner", "dataSourceDifficulties", "signal", "default", "computed", "filterAndSortDataSources", "dataSources", "event", "difficulty", "checked", "advanced", "set", "dataSource", "item", "ArrayHelpers", "toggleInArray", "index", "type", "PartAssemblyAndType", "\u0275\u0275directiveInject", "VisualQueryStateService", "selectors", "decls", "vars", "consts", "template", "rf", "ctx", "AddExplorerComponent_Conditional_0_Template", "MatSlideToggleModule", "MatSlideToggle", "MatIconModule", "MatIcon", "TippyDirective", "KeyValuePipe", "styles", "dataSrcIdPrefix", "domIdOfGuid", "guid", "guidOfDomId", "domId", "replace", "logSpecs", "all", "ConnectionLineColors", "constructor", "log", "classLog", "#lineCount", "#linePaintDefault", "stroke", "strokeWidth", "outlineStroke", "outlineWidth", "#lineColors", "#maxCols", "length", "#uuidColorMap", "nextLinePaintStyle", "uuid", "#nextLineColor", "__spreadProps", "__spreadValues", "logSpecs", "all", "eventConnectionDetached", "eventConnectionAttached", "ConnectionsManager", "constructor", "instance", "pipelineModel", "dataSources", "endpointsSvc", "onConnectionsChanged", "log", "classLog", "bulkDelete", "setup", "bind", "info", "handleDetached", "handleAttached", "getAll", "getAllConnections", "map", "connection", "From", "guidOfDomId", "sourceId", "Out", "getEndpointLabel", "endpoints", "To", "targetId", "In", "l", "fnIf", "end", "domDataSource", "target", "pipelineDataSource", "DataSources", "find", "pipelineDS", "EntityGuid", "id", "dataSource", "findDefByType", "PartAssemblyAndType", "label", "targetEndpoint", "some", "name", "getInfo", "deleteEndpoint", "setTimeout", "deleteConnection", "fireEvent", "targetEndpointOverlay", "getOverlay", "targetLabel", "getLabel", "targetHasSameLabel", "getEndpoints", "ep", "canvas", "classList", "contains", "setLabel", "Math", "floor", "random", "\u0275\u0275elementStart", "\u0275\u0275text", "\u0275\u0275elementEnd", "\u0275\u0275property", "\u0275\u0275element", "\u0275\u0275conditionalCreate", "RenameStreamComponent_Conditional_9_Conditional_4_Template", "RenameStreamComponent_Conditional_9_Conditional_5_Template", "\u0275\u0275advance", "\u0275\u0275conditional", "ctx_r0", "isSource", "pipelineResultExists", "controls", "label", "touched", "errors", "required", "scopeOption_r3", "value", "\u0275\u0275textInterpolate1", "name", "\u0275\u0275repeaterCreate", "RenameStreamComponent_Conditional_10_Conditional_0_For_5_Template", "\u0275\u0275repeaterTrackByIdentity", "scopeOptions", "length", "\u0275\u0275repeater", "labelOption_r4", "RenameStreamComponent_Conditional_10_Conditional_4_For_2_Template", "labelOptions", "RenameStreamComponent_Conditional_10_Conditional_0_Template", "RenameStreamComponent_Conditional_10_Conditional_4_Template", "RenameStreamComponent_Conditional_10_Conditional_5_Template", "\u0275\u0275listener", "\u0275\u0275restoreView", "_r2", "\u0275\u0275nextContext", "\u0275\u0275resetView", "toggleGuidedLabel", "RenameStreamComponent_Conditional_10_Conditional_13_Template", "advancedMode", "guidedLabel", "\u0275\u0275pureFunction1", "_c0", "$event", "_r5", "toggleAdvancedMode", "RenameStreamComponent", "BaseComponent", "#contentTypesSvc", "constructor", "dialogData", "dialog", "visualQueryService", "changeDetectorRef", "hostClass", "queryResult", "transient", "ContentTypesService", "ngOnInit", "#buildForm", "#watchKeyboardShortcuts", "closeDialog", "close", "event", "checked", "saveAndClose", "formValue", "form", "getRawValue", "UntypedFormGroup", "UntypedFormControl", "Validators", "scope", "eavConstants", "scopes", "default", "subscriptions", "add", "valueChanges", "pipe", "startWith", "distinctUntilChanged", "subscribe", "Object", "values", "Sources", "find", "source", "Guid", "pipelineDataSourceGuid", "Out", "filter", "out", "Scope", "map", "Name", "includes", "patchValue", "getScopesPromise", "then", "sourceOut", "filtered", "s", "some", "o", "markForCheck", "keydownEvents", "isCtrlEnter", "valid", "preventDefault", "\u0275\u0275directiveInject", "MAT_DIALOG_DATA", "MatDialogRef", "VisualQueryStateService", "ChangeDetectorRef", "selectors", "hostVars", "hostBindings", "rf", "ctx", "\u0275\u0275domProperty", "RenameStreamComponent_Conditional_9_Template", "RenameStreamComponent_Conditional_10_Template", "RenameStreamComponent_Conditional_13_Template", "MatButtonModule", "MatIconButton", "MatIconModule", "MatIcon", "FormsModule", "\u0275NgNoValidate", "DefaultValueAccessor", "NgControlStatus", "NgControlStatusGroup", "RequiredValidator", "ReactiveFormsModule", "FormGroupDirective", "FormControlName", "MatFormFieldModule", "MatFormField", "MatLabel", "MatSuffix", "MatInputModule", "MatInput", "MatSelectModule", "MatSelect", "MatOption", "MatOptionModule", "NgClass", "MatDialogActions", "MatSlideToggleModule", "MatSlideToggle", "FieldHintComponent", "ClickStopPropagationDirective", "SaveCloseButtonFabComponent", "encapsulation", "logSpecs", "all", "getEndpointOverlays", "getEndpointInfo", "buildSourceDef", "buildTargetDef", "EndpointDefinitionsService", "constructor", "pipelineModel", "renameDialogParts", "log", "classLog", "#getEndpointOverlays", "isSource", "l", "fnIf", "result", "id", "location", "label", "cssClass", "r", "getInfo", "endpointName", "isDynamic", "trimmed", "trim", "required", "endsWith", "name", "substring", "length", "dsGuid", "style", "pipelineDataSourceGuid", "sourceEndpoint", "paintStyle", "fill", "radius", "maxConnections", "anchor", "faces", "overlays", "events", "click", "endpointOrOverlay", "onChangeLabel", "targetEndpoint", "isTarget", "dropOptions", "hoverClass", "activeClass", "Pipeline", "AllowEdit", "overlay", "getOverlay", "matDialog", "open", "RenameStreamComponent", "autoFocus", "data", "viewContainerRef", "width", "afterClosed", "subscribe", "newLabel", "setLabel", "setTimeout", "onConnectionsChanged", "changeDetectorRef", "markForCheck", "logSpecs", "all", "addEndpoint", "reOrientAllLabels", "updateAfterChanges", "wireHasConnection", "mirrorEndpoints", "fields", "endPointsWhereWeRotate", "maxLabelLengthToRotate", "EndpointsManager", "constructor", "instance", "endpointDefs", "connections", "queryData", "log", "classLog", "#isDoingUpdate", "domDataSource", "endpointName", "isIn", "queryDs", "extraStyling", "l", "fnIfInList", "dsDefinition", "findDefByType", "dataSources", "PartAssemblyAndType", "connectionList", "In", "Out", "hasDynamic", "some", "name", "getInfo", "required", "endpointInfo", "a", "dataSource", "style", "#wireHasConnection", "uuid", "id", "model", "buildTargetDef", "EntityGuid", "buildSourceDef", "params", "enabled", "query", "Pipeline", "AllowEdit", "eavConstants", "pipelineDesigner", "outDataSource", "overlay", "getOverlay", "setLabel", "end", "fnIf", "wireExists", "StreamWiring", "wire", "domIdOfGuid", "To", "From", "r", "isDoing", "#mirrorEndpoints", "#reOrientAllLabels", "repaintEverything", "DataSources", "map", "ds", "def", "OutMode", "guid", "filter", "d", "forEach", "inPoints", "outPoints", "#getEndpointsByType", "inLabels", "p", "point", "label", "getEndpointLabel", "outLabels", "missingInOut", "inP", "outP", "outWithoutIn", "findDataSourceAndDom", "length", "canvas", "classList", "contains", "deleteEndpoint", "endpoints", "selectEndpoints", "element", "each", "ep", "isTarget", "push", "#reorientListOfEndpoints", "countExceeded", "labels", "endpoint", "join", "addClass", "removeClass", "removeAllEndpoints", "dataSourceGuid", "elementId", "bulkDelete", "batch", "delete", "JsPlumbInstanceManager", "constructor", "jsPlumbRoot", "lineColors", "instance", "window", "jsPlumb", "getInstance", "createInstanceDefaults", "container", "Container", "Connector", "curviness", "PaintStyle", "nextLinePaintStyle", "HoverPaintStyle", "stroke", "strokeWidth", "outlineStroke", "outlineWidth", "destroy", "reset", "unbindContainer", "logSpecs", "all", "putEntityCountOnConnections", "LinesDecorator", "constructor", "instance", "pipelineModel", "onDebugStream", "log", "classLog", "addEntityCount", "result", "l", "fnIf", "Streams", "forEach", "stream", "outDomId", "domIdOfGuid", "Source", "inDomId", "Pipeline", "EntityGuid", "includes", "Target", "fromUuid", "SourceOut", "toUuid", "TargetIn", "getEndpoint", "connections", "filter", "connection", "endpoints", "getUuid", "label", "Error", "Count", "toString", "cssClass", "setLabel", "events", "click", "AllowEdit", "end", "logSpecs", "all", "findDataSourceAndDom", "QueryDataManager", "constructor", "jsPlumbRoot", "query", "dataSources", "log", "classLog", "findDomAndDef", "guid", "partAssemblyAndType", "dsSet", "dsDef", "findDefByType", "__spreadProps", "__spreadValues", "definition", "sourceElementId", "l", "fnIf", "domDataSource", "querySelector", "domIdOfGuid", "r", "guidOfDomId", "id", "dataSource", "DataSources", "find", "pipeDs", "EntityGuid", "logSpecs", "all", "initWirings", "ensureWireEndpointExists", "findDataSourceInDom", "fields", "WiringsHelper", "constructor", "plumber", "instance", "queryData", "log", "classLog", "l", "fnIf", "wiringsRaw", "query", "Pipeline", "StreamWiring", "end", "wirings", "map", "wire", "outPointDomId", "domIdOfGuid", "From", "Out", "inPointDomId", "To", "In", "a", "wireDetails", "forEach", "w", "#ensureWireEndpointExists", "#connect", "repaintEverything", "outDomId", "inDomId", "connect", "uuids", "paintStyle", "lineColors", "nextLinePaintStyle", "console", "error", "message", "from", "to", "endpointId", "sourceGuid", "name", "isIn", "fnIfInList", "set", "#findDataSourceInDom", "r", "endpoints", "addEndpoint", "domDataSource", "dataSource", "getEndpoint", "result", "findDataSourceAndDom", "logSpecs", "all", "addEndpoint", "initDomDataSources", "eventConnectionDetached", "eventConnectionAttached", "fields", "Plumber", "#instance", "#endpointDefs", "#instanceManager", "constructor", "jsPlumbRoot", "query", "dataSources", "onConnectionsChangedParent", "onDragend", "onDebugStream", "renameDialogParts", "log", "classLog", "lineColors", "ConnectionLineColors", "queryData", "QueryDataManager", "EndpointDefinitionsService", "__spreadProps", "__spreadValues", "onConnectionsChanged", "#onConnectionsChanged", "JsPlumbInstanceManager", "instance", "lineDecorator", "LinesDecorator", "connections", "ConnectionsManager", "endpoints", "EndpointsManager", "batch", "#initDomDataSources", "WiringsHelper", "initWirings", "setup", "updateAfterChanges", "repaintEverything", "destroy", "removeAllEndpoints", "pipelineDataSourceGuid", "elementId", "domIdOfGuid", "bulkDelete", "selectEndpoints", "element", "delete", "getStreamsOut", "streamsOut", "target", "each", "endpoint", "push", "getEndpointLabel", "join", "l", "fnIf", "queryDs", "DataSources", "domDataSource", "domDs", "definition", "dataSource", "findDomAndDef", "EntityGuid", "PartAssemblyAndType", "Pipeline", "AllowEdit", "draggable", "grid", "stop", "event", "el", "queryDsGuid", "guidOfDomId", "id", "position", "Top", "finalPos", "Left", "setTimeout", "outCount", "Out", "length", "a", "out", "forEach", "name", "OutMode", "dynOut", "buildSourceDef", "makeSource", "filter", "inCount", "In", "in", "targetEndpointUnlimited", "buildTargetDef", "maxConnections", "makeTarget", "end", "\u0275\u0275elementStart", "\u0275\u0275listener", "\u0275\u0275restoreView", "_r2", "dataSource_r3", "\u0275\u0275nextContext", "$implicit", "ctx_r3", "\u0275\u0275resetView", "configureDataSource", "\u0275\u0275text", "\u0275\u0275elementEnd", "_r5", "openHelp", "typeInfos", "EntityGuid", "HelpLink", "_r6", "remove", "\u0275\u0275advance", "\u0275\u0275property", "config_r7", "name", "\u0275\u0275textInterpolate", "value", "\u0275\u0275element", "\u0275\u0275repeaterCreate", "PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_21_For_3_Template", "\u0275\u0275repeaterTrackByIdentity", "\u0275\u0275repeater", "visQuerySvc", "dataSourceConfigs", "EntityId", "\u0275\u0275conditionalCreate", "PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_5_Template", "PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_6_Template", "PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_8_Template", "_r1", "pipelineModel", "Pipeline", "AllowEdit", "editName", "editDescription", "PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_21_Template", "PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_24_Template", "PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_25_Template", "domIdOfGuid", "\u0275\u0275pureFunction3", "_c2", "VisualDesignerData", "Top", "Left", "Width", "\u0275\u0275pureFunction1", "_c3", "showDataSourceDetails", "tmp_16_0", "length", "UiHint", "\u0275\u0275textInterpolate1", "Icon", "\u0275\u0275conditional", "EnableConfig", "isOutDataSource", "Name", "Description", "tmp_24_0", "PartAssemblyAndType", "getTypeName", "DynamicOut", "DynamicIn", "PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Template", "DataSources", "PlumbEditorComponent_Conditional_0_Conditional_2_Template", "hardReset", "logSpecs", "all", "ngAfterViewInit", "jsPlumbUrl", "PlumbEditorComponent", "BaseComponent", "#plumber", "#scriptLoaded$", "#queryDefinitionSvc", "constructor", "changeDetectorRef", "matDialog", "viewContainerRef", "log", "classLog", "BehaviorSubject", "transient", "QueryDefinitionService", "computed", "JsonHelpers", "tryParse", "ShowDataSourceDetails", "calculateTypeInfos", "dataSources", "ngOnInit", "loadScripts", "test", "src", "next", "subscriptions", "add", "putEntityCountOnConnections$", "subscribe", "result", "lineDecorator", "addEntityCount", "l", "fnIf", "domDataSourcesLoaded$", "domDataSourcesRef", "changes", "pipe", "map", "combineLatest", "scriptLoaded", "domDataSourcesLoaded", "a", "destroy", "Plumber", "domRootRef", "nativeElement", "onConnectionsChanged", "onDragend", "bind", "onDebugStream", "end", "ngOnDestroy", "complete", "connections", "getAll", "streamsOut", "getStreamsOut", "changeConnections", "pipelineDataSourceGuid", "position", "changeDataSourcePosition", "stream", "debugStream", "dataSource", "includes", "saveAndRun", "editDataSource", "partAssemblyAndType", "findDefByType", "typeNameFilter", "TypeNameForUi", "pipelineDataSource", "eavConstants", "pipelineDesigner", "outDataSource", "confirm", "removeAllEndpoints", "removeDataSource", "url", "window", "open", "newName", "prompt", "trim", "renameDataSource", "newDescription", "changeDataSourceDescription", "\u0275\u0275directiveInject", "VisualQueryStateService", "ChangeDetectorRef", "MatDialog", "ViewContainerRef", "selectors", "viewQuery", "rf", "ctx", "PlumbEditorComponent_Conditional_0_Template", "NgStyle", "NgClass", "MatIconModule", "MatIcon", "MousedownStopPropagationDirective", "styles", "calculateWarnings", "pipelineModel", "context", "warnings", "queryParams", "Pipeline", "Params", "split", "testParams", "TestParameters", "forEach", "param", "trim", "test", "push", "midMatch", "exec", "testMid", "urlMid", "moduleId", "toString", "error", "console", "\u0275\u0275elementStart", "\u0275\u0275text", "\u0275\u0275elementEnd", "\u0275\u0275advance", "\u0275\u0275textInterpolate1", "param_r3", "\u0275\u0275repeaterCreate", "RunExplorerComponent_Conditional_0_Conditional_20_For_2_Template", "\u0275\u0275repeaterTrackByIdentity", "\u0275\u0275repeater", "tmp_2_0", "ctx_r1", "vsSvc", "pipelineModel", "Pipeline", "Params", "split", "param_r4", "RunExplorerComponent_Conditional_0_Conditional_24_For_2_Template", "TestParameters", "\u0275\u0275listener", "$event", "\u0275\u0275restoreView", "_r5", "\u0275\u0275nextContext", "\u0275\u0275resetView", "showDataSourceDetails", "\u0275\u0275property", "visualDesignerDataSig", "ShowDataSourceDetails", "\u0275\u0275element", "warning_r6", "\u0275\u0275sanitizeHtml", "RunExplorerComponent_Conditional_0_Conditional_26_Conditional_0_For_8_Template", "warningSig", "\u0275\u0275conditionalCreate", "RunExplorerComponent_Conditional_0_Conditional_26_Conditional_0_Template", "\u0275\u0275conditional", "length", "\u0275\u0275textInterpolate", "Description", "_r1", "saveAndRunQuery", "editPipeline", "openParamsHelp", "RunExplorerComponent_Conditional_0_Conditional_20_Template", "RunExplorerComponent_Conditional_0_Conditional_24_Template", "RunExplorerComponent_Conditional_0_Conditional_25_Template", "RunExplorerComponent_Conditional_0_Conditional_26_Template", "RunExplorerComponent_Conditional_0_Conditional_27_Template", "openRestApi", "tmp_1_0", "RunExplorerComponent", "#dialogRouter", "constructor", "context", "signal", "calculateWarnings", "JsonHelpers", "tryParse", "VisualDesignerData", "transient", "DialogRoutingService", "editPipelineEntity", "window", "open", "save", "run", "saveAndRun", "event", "checked", "queryGuid", "EntityGuid", "navRelative", "GoToDevRest", "getUrlQueryDialog", "\u0275\u0275directiveInject", "Context", "VisualQueryStateService", "selectors", "decls", "vars", "consts", "template", "rf", "ctx", "RunExplorerComponent_Conditional_0_Template", "MatButtonModule", "MatButton", "MatIconButton", "MatIconModule", "MatIcon", "MatSlideToggleModule", "MatSlideToggle", "styles", "VisualQueryComponent", "constructor", "context", "route", "visualQueryService", "explorer", "run", "add", "activeExplorer", "init", "ngOnInit", "toggleExplorer", "openHelp", "window", "open", "\u0275\u0275directiveInject", "Context", "ActivatedRoute", "VisualQueryStateService", "selectors", "viewQuery", "rf", "ctx", "PlumbEditorComponent", "decls", "vars", "consts", "template", "\u0275\u0275element", "\u0275\u0275elementStart", "\u0275\u0275listener", "\u0275\u0275text", "\u0275\u0275elementEnd", "\u0275\u0275advance", "\u0275\u0275property", "\u0275\u0275pureFunction1", "_c0", "RouterOutlet", "NgClass", "MatIconModule", "MatIcon", "RunExplorerComponent", "AddExplorerComponent", "styles"]
}
