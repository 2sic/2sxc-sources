"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["default-projects_eav-ui_src_app_permissions_index_ts","projects_eav-ui_src_app_permissions_permissions_module_ts"],{4328:(E,m,t)=>{t.d(m,{q:()=>p});var o=t(4172),l=t(6028),d=t(4896),h=t(1332),n=t(3392);let p=(()=>{class e{constructor(s,a,c){this.http=s,this.context=a,this.dnnContext=c}create(s,a){return this.http.post(`app/auto/data/${s}`,a,{params:{appId:this.context.appId,zoneId:this.context.zoneId}})}update(s,a,c){return this.http.post(`app/auto/data/${s}/${a}`,c,{params:{appId:this.context.appId,zoneId:this.context.zoneId}})}delete(s,a,c){return this.http.delete(this.dnnContext.$2sxc.http.apiUrl(o.ue+"delete"),{params:{contentType:s,id:a.toString(),appId:this.context.appId.toString(),force:c.toString()}})}static#t=this.\u0275fac=function(a){return new(a||e)(d.CoB(h.KK),d.CoB(l.e),d.CoB(n.es))};static#s=this.\u0275prov=d.wxM({token:e,factory:e.\u0275fac})}return e})()},4720:(E,m,t)=>{t.d(m,{N:()=>l});var o=t(9224);let l=(()=>{class d{static#t=this.route={path:"permissions/:targetType/:keyType/:key",loadChildren:()=>t.e("projects_eav-ui_src_app_permissions_permissions_module_ts").then(t.bind(t,680)).then(n=>n.PermissionsModule),data:{title:"Permissions"}};static getUrl(n,p,e){return`permissions/${n}/${p}/${e}`}static getUrlApp(n){return this.getUrl(o._K.metadata.app.targetType,o._K.metadata.app.keyType,n.toString())}static getUrlAttribute(n){return this.getUrl(o._K.metadata.attribute.targetType,o._K.metadata.attribute.keyType,n.toString())}static getUrlContentType(n){return this.getUrlEntity(n)}static getUrlEntity(n){return this.getUrl(o._K.metadata.entity.targetType,o._K.metadata.entity.keyType,n)}static getUrlLanguage(n){return this.getUrl(o._K.metadata.language.targetType,o._K.metadata.language.keyType,n)}}return d})()},2876:(E,m,t)=>{t.d(m,{NL:()=>o.N,WU:()=>e.W,yM:()=>p.y});var o=t(4720),p=(t(376),t(1628),t(724),t(680),t(7368)),e=t(896)},376:(E,m,t)=>{t.d(m,{r:()=>l});var o=t(5392);const l={name:"SET_PERMISSIONS_DIALOG",initContext:!0,panelSize:"large",panelClass:null,getComponent:()=>(0,o.c)(function*(){const{PermissionsComponent:d}=yield t.e("projects_eav-ui_src_app_permissions_permissions_component_ts").then(t.bind(t,724));return d})()}},1628:(E,m,t)=>{t.d(m,{a:()=>e});var o=t(5204),l=t(404),d=t(6232),h=t(376),n=t(4896);const p=[{path:"",component:d.Y,data:{dialog:h.r},children:[{matcher:l.aM,loadChildren:()=>Promise.all([t.e("default-projects_eav-ui_src_app_create-file-dialog_index_ts"),t.e("default-node_modules_angular_material_fesm2022_autocomplete_mjs"),t.e("default-node_modules_angular_material_fesm2022_card_mjs"),t.e("default-projects_eav-ui_src_app_edit_edit_module_ts"),t.e("default-node_modules_angular_cdk_fesm2022_drag-drop_mjs"),t.e("default-node_modules_angular_material_fesm2022_menu_mjs"),t.e("default-node_modules_angular_material_fesm2022_slide-toggle_mjs"),t.e("common"),t.e("projects_eav-ui_src_app_features_feature-names_ts-projects_eav-ui_src_app_features_feature-te-8bd3ae")]).then(t.bind(t,9948)).then(g=>g.EditModule)},{matcher:l.CK,loadChildren:()=>t.e("projects_eav-ui_src_app_edit_refresh-edit_module_ts").then(t.bind(t,320)).then(g=>g.RefreshEditModule)}]}];let e=(()=>{class g{static#t=this.\u0275fac=function(c){return new(c||g)};static#s=this.\u0275mod=n.a4G({type:g});static#e=this.\u0275inj=n.s3X({imports:[o.qQ.forChild(p),o.qQ]})}return g})()},724:(E,m,t)=>{t.r(m),t.d(m,{PermissionsComponent:()=>U});var o=t(4844),l=t(5876),d=t(604),h=t(2816),n=t(5760),p=t(1743),e=t(9224),g=t(5396),s=t(4896),a=t(8200),c=t(2328),v=t(6176);let T=(()=>{class u{agInit(i){this.params=i}refresh(i){return!0}deletePermission(){this.params.onDelete(this.params.data)}static#t=this.\u0275fac=function(r){return new(r||u)};static#s=this.\u0275cmp=s.In1({type:u,selectors:[["app-permissions-actions"]],decls:4,vars:0,consts:[[1,"actions-component"],["matRipple","","tippy","Delete",1,"eav-grid-action-button","highlight",3,"click"]],template:function(r,_){1&r&&(s.I0R(0,"div",0)(1,"div",1),s.qCj("click",function(){return _.deletePermission()}),s.I0R(2,"mat-icon"),s.OEk(3,"delete"),s.C$Y()()())},dependencies:[a.Y,c.qL,v.UZ]})}return u})();var M=t(896),P=t(9972),y=t(5204),C=t(600),f=t(4648),D=t(4672),I=t(4072),K=t(5056);function R(u,B){if(1&u){const i=s.KQA();s.I0R(0,"div",1)(1,"div",2)(2,"div",3),s.OEk(3,"Permissions"),s.C$Y(),s.I0R(4,"button",4),s.qCj("click",function(){s.usT(i);const _=s.GaO();return s.CGJ(_.closeDialog())}),s.I0R(5,"mat-icon"),s.OEk(6,"close"),s.C$Y()()(),s.I0R(7,"div",5),s.wR5(8,"router-outlet"),s.I0R(9,"div",6),s.wR5(10,"ag-grid-angular",7),s.C$Y(),s.I0R(11,"mat-dialog-actions",8)(12,"button",9),s.qCj("click",function(){s.usT(i);const _=s.GaO();return s.CGJ(_.editPermission(null))}),s.I0R(13,"mat-icon"),s.OEk(14,"add"),s.C$Y()()()()()}if(2&u){const i=s.GaO();s.yG2(10),s.E7m("rowData",B.permissions)("gridOptions",i.gridOptions)}}let U=(()=>{class u extends h.K{constructor(i,r,_,O,A){super(i,r),this.router=i,this.route=r,this.dialogRef=_,this.permissionsService=O,this.snackBar=A,this.permissions$=new o.g(void 0),this.gridOptions=this.buildGridOptions(),this.targetType=parseInt(this.route.snapshot.paramMap.get("targetType"),10),this.keyType=this.route.snapshot.paramMap.get("keyType"),this.key=this.route.snapshot.paramMap.get("key"),this.prefills={[e._K.metadata.language.targetType]:{PermissionType:"language"}}}ngOnInit(){this.fetchPermissions(),this.subscription.add(this.refreshOnChildClosedShallow().subscribe(()=>{this.fetchPermissions()})),this.viewModel$=(0,l.E)([this.permissions$]).pipe((0,d.k)(([i])=>({permissions:i})))}ngOnDestroy(){this.permissions$.complete(),super.ngOnDestroy()}closeDialog(){this.dialogRef.close()}fetchPermissions(){this.permissionsService.getAll(this.targetType,this.keyType,this.key).subscribe(i=>{this.permissions$.next(i)})}editPermission(i){let r;r=null==i?{items:[{ContentTypeName:e._K.contentTypes.permissions,For:{Target:Object.values(e._K.metadata).find(O=>O.targetType===this.targetType)?.target??this.targetType.toString(),TargetType:this.targetType,...this.keyType===e._K.keyTypes.guid&&{Guid:this.key},...this.keyType===e._K.keyTypes.number&&{Number:parseInt(this.key,10)},...this.keyType===e._K.keyTypes.string&&{String:this.key}},...this.prefills[this.targetType]&&{Prefill:this.prefills[this.targetType]}}]}:{items:[{EntityId:i.Id}]};const _=(0,g.K)(r);this.router.navigate([`edit/${_}`],{relativeTo:this.route})}deletePermission(i){confirm(`Delete '${i.Title}' (${i.Id})?`)&&(this.snackBar.open("Deleting..."),this.permissionsService.delete(i.Id).subscribe(()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchPermissions()}))}buildGridOptions(){return{...p.A,columnDefs:[{...P.y.Id,cellRenderer:n.q,cellRendererParams:{tooltipGetter:_=>`ID: ${_.Id}\nGUID: ${_.Guid}`}},{...P.y.TextWide,headerName:"Name",field:"Title",sort:"asc",onCellClicked:r=>{this.editPermission(r.data)}},{...P.y.TextWide,field:"Identity"},{...P.y.TextWide,field:"Condition"},{...P.y.Character,field:"Grant"},{...P.y.ActionsPinnedRight1,cellRenderer:T,cellRendererParams:{onDelete:_=>this.deletePermission(_)}}]}}static#t=this.\u0275fac=function(r){return new(r||u)(s.GI1(y.E5),s.GI1(y.gV),s.GI1(C.yI),s.GI1(M.W),s.GI1(f.yS))};static#s=this.\u0275cmp=s.In1({type:u,selectors:[["app-permissions"]],features:[s.eg9],decls:2,vars:3,consts:[["class","eav-dialog nav-component-wrapper"],[1,"eav-dialog","nav-component-wrapper"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"eav-dialog-content","nav-component-wrapper"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","gridOptions"],["align","end"],["mat-fab","","mat-elevation-z24","","tippy","Create a new permission",1,"grid-fab",3,"click"]],template:function(r,_){if(1&r&&(s.yuY(0,R,15,2,"div",0),s.wVc(1,"async")),2&r){let O;s.C0Y(0,(O=s.kDX(1,1,_.viewModel$))?0:-1,O)}},dependencies:[y.cP,a.Y,C.Yp,D.um,D.uw,c.qL,I.U5,K.a]})}return u})()},680:(E,m,t)=>{t.r(m),t.d(m,{PermissionsModule:()=>P});var o=t(5056),l=t(4672),d=t(6176),h=t(600),n=t(2328),p=t(4648),e=t(4328),g=t(4612),s=t(6028),a=t(988),c=t(1628),v=t(7368),T=t(896),M=t(4896);let P=(()=>{class y{static#t=this.\u0275fac=function(D){return new(D||y)};static#s=this.\u0275mod=M.a4G({type:y});static#e=this.\u0275inj=M.s3X({providers:[s.e,T.W,v.y,e.q],imports:[o.MD,c.a,a.q,h.sr,l.oJ,n.oB,g.c,d.KE,p.uE]})}return y})()},7368:(E,m,t)=>{t.d(m,{y:()=>p});var o=t(6028),l=t(4896),d=t(1332),h=t(3392);let p=(()=>{class e{constructor(s,a,c){this.http=s,this.context=a,this.dnnContext=c}getMetadata(s,a,c,v){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/metadata/get"),{params:{appId:this.context.appId.toString(),targetType:s.toString(),keyType:a,key:c.toString(),...v&&{contentType:v}}})}static#t=this.\u0275fac=function(a){return new(a||e)(l.CoB(d.KK),l.CoB(o.e),l.CoB(h.es))};static#s=this.\u0275prov=l.wxM({token:e,factory:e.\u0275fac})}return e})()},896:(E,m,t)=>{t.d(m,{W:()=>p});var o=t(604),l=t(4328),d=t(9224),h=t(7368),n=t(4896);let p=(()=>{class e{constructor(s,a){this.metadataService=s,this.entitiesService=a}getAll(s,a,c){return this.metadataService.getMetadata(s,a,c,d._K.contentTypes.permissions).pipe((0,o.k)(v=>v.Items))}delete(s){return this.entitiesService.delete(d._K.contentTypes.permissions,s,!1)}static#t=this.\u0275fac=function(a){return new(a||e)(n.CoB(h.y),n.CoB(l.q))};static#s=this.\u0275prov=n.wxM({token:e,factory:e.\u0275fac})}return e})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/17.10.00/dist/ng-edit/default-projects_eav-ui_src_app_permissions_index_ts.38878314921cd548.js.map