"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_permissions_permissions_component_ts"],{724:(P,h,e)=>{e.r(h),e.d(h,{PermissionsComponent:()=>x});var s=e(4844),t=e(5876),r=e(604),C=e(2816),f=e(5760),y=e(1743),l=e(9224),p=e(5396),n=e(4896),d=e(8200),v=e(2328),i=e(6176);let g=(()=>{class _{agInit(o){this.params=o}refresh(o){return!0}deletePermission(){this.params.onDelete(this.params.data)}static#t=this.\u0275fac=function(c){return new(c||_)};static#e=this.\u0275cmp=n.In1({type:_,selectors:[["app-permissions-actions"]],decls:4,vars:0,consts:[[1,"actions-component"],["matRipple","","tippy","Delete",1,"eav-grid-action-button","highlight",3,"click"]],template:function(c,u){1&c&&(n.I0R(0,"div",0)(1,"div",1),n.qCj("click",function(){return u.deletePermission()}),n.I0R(2,"mat-icon"),n.OEk(3,"delete"),n.C$Y()()())},dependencies:[d.Y,v.qL,i.UZ]})}return _})();var a=e(896),m=e(9972),O=e(5204),E=e(600),D=e(4648),T=e(4672),R=e(4072),M=e(5056);function A(_,B){if(1&_){const o=n.KQA();n.I0R(0,"div",1)(1,"div",2)(2,"div",3),n.OEk(3,"Permissions"),n.C$Y(),n.I0R(4,"button",4),n.qCj("click",function(){n.usT(o);const u=n.GaO();return n.CGJ(u.closeDialog())}),n.I0R(5,"mat-icon"),n.OEk(6,"close"),n.C$Y()()(),n.I0R(7,"div",5),n.wR5(8,"router-outlet"),n.I0R(9,"div",6),n.wR5(10,"ag-grid-angular",7),n.C$Y(),n.I0R(11,"mat-dialog-actions",8)(12,"button",9),n.qCj("click",function(){n.usT(o);const u=n.GaO();return n.CGJ(u.editPermission(null))}),n.I0R(13,"mat-icon"),n.OEk(14,"add"),n.C$Y()()()()()}if(2&_){const o=n.GaO();n.yG2(10),n.E7m("rowData",B.permissions)("gridOptions",o.gridOptions)}}let x=(()=>{class _ extends C.K{constructor(o,c,u,I,b){super(o,c),this.router=o,this.route=c,this.dialogRef=u,this.permissionsService=I,this.snackBar=b,this.permissions$=new s.g(void 0),this.gridOptions=this.buildGridOptions(),this.targetType=parseInt(this.route.snapshot.paramMap.get("targetType"),10),this.keyType=this.route.snapshot.paramMap.get("keyType"),this.key=this.route.snapshot.paramMap.get("key"),this.prefills={[l._K.metadata.language.targetType]:{PermissionType:"language"}}}ngOnInit(){this.fetchPermissions(),this.subscription.add(this.refreshOnChildClosedShallow().subscribe(()=>{this.fetchPermissions()})),this.viewModel$=(0,t.E)([this.permissions$]).pipe((0,r.k)(([o])=>({permissions:o})))}ngOnDestroy(){this.permissions$.complete(),super.ngOnDestroy()}closeDialog(){this.dialogRef.close()}fetchPermissions(){this.permissionsService.getAll(this.targetType,this.keyType,this.key).subscribe(o=>{this.permissions$.next(o)})}editPermission(o){let c;c=null==o?{items:[{ContentTypeName:l._K.contentTypes.permissions,For:{Target:Object.values(l._K.metadata).find(I=>I.targetType===this.targetType)?.target??this.targetType.toString(),TargetType:this.targetType,...this.keyType===l._K.keyTypes.guid&&{Guid:this.key},...this.keyType===l._K.keyTypes.number&&{Number:parseInt(this.key,10)},...this.keyType===l._K.keyTypes.string&&{String:this.key}},...this.prefills[this.targetType]&&{Prefill:this.prefills[this.targetType]}}]}:{items:[{EntityId:o.Id}]};const u=(0,p.K)(c);this.router.navigate([`edit/${u}`],{relativeTo:this.route})}deletePermission(o){confirm(`Delete '${o.Title}' (${o.Id})?`)&&(this.snackBar.open("Deleting..."),this.permissionsService.delete(o.Id).subscribe(()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchPermissions()}))}buildGridOptions(){return{...y.A,columnDefs:[{...m.y.Id,cellRenderer:f.q,cellRendererParams:{tooltipGetter:u=>`ID: ${u.Id}\nGUID: ${u.Guid}`}},{...m.y.TextWide,headerName:"Name",field:"Title",sort:"asc",onCellClicked:c=>{this.editPermission(c.data)}},{...m.y.TextWide,field:"Identity"},{...m.y.TextWide,field:"Condition"},{...m.y.Character,field:"Grant"},{...m.y.ActionsPinnedRight1,cellRenderer:g,cellRendererParams:{onDelete:u=>this.deletePermission(u)}}]}}static#t=this.\u0275fac=function(c){return new(c||_)(n.GI1(O.E5),n.GI1(O.gV),n.GI1(E.yI),n.GI1(a.W),n.GI1(D.yS))};static#e=this.\u0275cmp=n.In1({type:_,selectors:[["app-permissions"]],features:[n.eg9],decls:2,vars:3,consts:[["class","eav-dialog nav-component-wrapper"],[1,"eav-dialog","nav-component-wrapper"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"eav-dialog-content","nav-component-wrapper"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","gridOptions"],["align","end"],["mat-fab","","mat-elevation-z24","","tippy","Create a new permission",1,"grid-fab",3,"click"]],template:function(c,u){if(1&c&&(n.yuY(0,A,15,2,"div",0),n.wVc(1,"async")),2&c){let I;n.C0Y(0,(I=n.kDX(1,1,u.viewModel$))?0:-1,I)}},dependencies:[O.cP,d.Y,E.Yp,T.um,T.uw,v.qL,R.U5,M.a]})}return _})()},1584:(P,h,e)=>{e.d(h,{e:()=>v});const s={states:{true:{tooltip:"true/on",icon:"radio_button_checked"},false:{tooltip:"false/off",icon:"radio_button_unchecked"}}};var t=e(4896),r=e(5056),C=e(2328),f=e(8200);function y(i,g){1&i&&t.C_f(0)}function l(i,g){if(1&i&&(t.I0R(0,"a",1),t.yuY(1,y,1,0,"ng-container",3),t.C$Y()),2&i){const a=t.GaO(),m=t.Gew(4);t.E7m("href",a.data.url,t.K6U),t.yG2(1),t.E7m("ngTemplateOutlet",m)}}const p=i=>({clickable:i});function n(i,g){if(1&i&&(t.I0R(0,"div",4)(1,"mat-icon"),t.OEk(2),t.C$Y()()),2&i){const a=t.GaO();t.E7m("ngClass",t.S45(3,p,a.data.clickable))("tippy",a.data.tooltip),t.yG2(2),t.cNF(a.data.icon)}}function d(i,g){if(1&i&&(t.I0R(0,"div",4)(1,"mat-icon"),t.OEk(2),t.C$Y()()),2&i){const a=t.GaO();t.E7m("ngClass",t.S45(3,p,a.data.clickable))("tippy",a.data.tooltip),t.yG2(2),t.cNF(a.data.icon)}}let v=(()=>{class i{agInit(a){this.value=a.value,this.allSettings=a.settings?.(a.data)??s;const m=this.allSettings.states[this.value?"true":"false"];this.data={...m,url:m.url??m.getUrl?.(a.data)}}refresh(a){return!0}static#t=this.\u0275fac=function(m){return new(m||i)};static#e=this.\u0275cmp=t.In1({type:i,selectors:[["app-ag-bool-icon-renderer"]],decls:5,vars:1,consts:[[1,"icon-container"],["target","_blank",3,"href"],["showIcon",""],[4,"ngTemplateOutlet"],[1,"icon-cell","icon",3,"ngClass","tippy"]],template:function(m,O){1&m&&(t.I0R(0,"div",0),t.yuY(1,l,2,2,"a",1)(2,n,3,5),t.C$Y(),t.yuY(3,d,3,5,"ng-template",null,2,t.gJz)),2&m&&(t.yG2(1),t.C0Y(1,O.data.url?1:2))},dependencies:[r.QF,r.XV,C.qL,f.Y],encapsulation:2})}return i})()},9972:(P,h,e)=>{e.d(h,{y:()=>r});var s=e(5960),t=e(1584);class r{static#t=this.ActionsPinnedRight1={width:42,cellClass:"secondary-action no-padding".split(" "),pinned:"right"};static#e=this.ActionsPinnedRight3={width:122,cellClass:"secondary-action no-padding".split(" "),pinned:"right"};static#n=this.ActionsPinnedRight4={width:162,cellClass:"secondary-action no-padding".split(" "),pinned:"right"};static#i=this.ActionsPinnedRight5={width:202,cellClass:"secondary-action no-padding".split(" "),pinned:"right"};static#s=this.IconShow={headerName:"Show",width:70,headerClass:"dense",cellClass:"icons no-outline".split(" "),sortable:!0,filter:s.s,valueGetter:f=>!f.data.IsHidden,cellRenderer:t.e};static#o=this.Character={width:70,headerClass:"dense",cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter"};static#a=this.Id={headerName:"ID",field:"Id",width:70,headerClass:"dense",cellClass:"id-action no-padding no-outline".split(" "),sortable:!0,filter:"agNumberColumnFilter"};static#l=this.Number={width:70,headerClass:"dense",cellClass:"number-cell no-outline".split(" "),sortable:!0,filter:"agNumberColumnFilter"};static#r=this.TextWide={flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter"};static#c=this.TextNarrow={flex:1,minWidth:150,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter"}}},2816:(P,h,e)=>{e.d(h,{K:()=>n});var s=e(5204),t=e(6560),r=e(1792),C=e(604),f=e(6536),y=e(6884),l=e(6936),p=e(4896);let n=(()=>{class d extends y.C{constructor(i,g,a){super(),this.router=i,this.route=g,this.log=a,this.log??=new l.W("BaseComponent",!1)}ngOnDestroy(){super.ngOnDestroy()}refreshOnChildClosedShallow(){return this.router.events.pipe((0,t.I)(i=>i instanceof s.cf),(0,r.W)(!!this.route.snapshot.firstChild),(0,C.k)(()=>!!this.route.snapshot.firstChild),(0,f.c)(),(0,t.I)(([i,g])=>i&&!g))}static#t=this.\u0275fac=function(g){return new(g||d)(p.GI1(s.E5),p.GI1(s.gV),p.GI1(l.W))};static#e=this.\u0275dir=p.Sc5({type:d,features:[p.eg9]})}return d})()},5960:(P,h,e)=>{e.d(h,{s:()=>C});var s=e(4896),t=e(1904),r=e(1232);let C=(()=>{class f{constructor(){this.filter=""}agInit(l){this.filterParams=l}isFilterActive(){return""!==this.filter}doesFilterPass(l){const n=this.filterParams.valueGetter({api:this.filterParams.api,colDef:this.filterParams.colDef,column:this.filterParams.column,columnApi:this.filterParams.columnApi,context:this.filterParams.context,data:l.node.data,getValue:d=>l.node.data[d],node:l.node});return null!=n&&n.toString()===this.filter}getModel(){if(this.isFilterActive())return{filterType:"boolean",filter:this.filter}}setModel(l){this.filter=l?l.filter:""}afterGuiAttached(l){}filterChanged(){this.filterParams.filterChangedCallback()}static#t=this.\u0275fac=function(p){return new(p||f)};static#e=this.\u0275cmp=s.In1({type:f,selectors:[["app-boolean-filter"]],decls:7,vars:1,consts:[[3,"ngModel","ngModelChange"],["value",""],["value","true"],["value","false"]],template:function(p,n){1&p&&(s.I0R(0,"mat-radio-group",0),s.qCj("ngModelChange",function(v){return n.filter=v})("ngModelChange",function(){return n.filterChanged()}),s.I0R(1,"mat-radio-button",1),s.OEk(2,"All"),s.C$Y(),s.I0R(3,"mat-radio-button",2),s.OEk(4,"True"),s.C$Y(),s.I0R(5,"mat-radio-button",3),s.OEk(6,"False"),s.C$Y()()),2&p&&s.E7m("ngModel",n.filter)},dependencies:[t.ue,t._G,r.cv,r.cT],styles:[".mat-mdc-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;overflow:hidden;padding:12px;width:160px;height:104px}"]})}return f})()},5760:(P,h,e)=>{e.d(h,{q:()=>n});var s=e(2556),t=e(4896),r=e(4648),C=e(5056),f=e(6176),y=e(2328),l=e(8200);const p=(d,v)=>({"align-start":d,"align-end":v});let n=(()=>{class d{constructor(i){this.snackBar=i}agInit(i){this.id=i.value,this.align="number"==typeof this.id?"end":"start",this.tooltip=i.tooltipGetter(i.data)}refresh(i){return!0}copy(){(0,s.y)(this.tooltip),this.snackBar.open("Copied to clipboard",null,{duration:2e3})}static#t=this.\u0275fac=function(g){return new(g||d)(t.GI1(r.yS))};static#e=this.\u0275cmp=t.In1({type:d,selectors:[["app-id-field"]],decls:5,vars:6,consts:[["matRipple","",1,"id-box","highlight",3,"tippy","ngClass","click"],[1,"id"],[1,"icon"]],template:function(g,a){1&g&&(t.I0R(0,"div",0),t.qCj("click",function(){return a.copy()}),t.I0R(1,"span",1),t.OEk(2),t.C$Y(),t.I0R(3,"mat-icon",2),t.OEk(4,"file_copy"),t.C$Y()()),2&g&&(t.E7m("tippy",a.tooltip)("ngClass",t.IBC(3,p,"start"===a.align,"end"===a.align)),t.yG2(2),t.cNF(a.id))},dependencies:[C.QF,f.UZ,y.qL,l.Y],styles:[".id-box[_ngcontent-%COMP%]{padding:0 8px;height:100%;display:flex;align-items:center}.id-box.align-start[_ngcontent-%COMP%]{justify-content:flex-start}.id-box.align-end[_ngcontent-%COMP%]{justify-content:flex-end}.id-box[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{max-width:100%;text-overflow:ellipsis;overflow:hidden}.id-box[_ngcontent-%COMP%]:hover{text-decoration:none}.id-box[_ngcontent-%COMP%]:hover   .id[_ngcontent-%COMP%]{display:none}.id-box[_ngcontent-%COMP%]:not(:hover)   .icon[_ngcontent-%COMP%]{display:none}"]})}return d})()},1743:(P,h,e)=>{e.d(h,{A:()=>s});const s={accentedSort:!0,animateRows:!0,enableCellTextSelection:!0,headerHeight:32,suppressScrollOnNewData:!0,valueCache:!0,defaultColDef:{filterParams:{newRowsAction:"keep"}},tooltipShowDelay:0,tooltipHideDelay:1e5,suppressMovableColumns:!0}},2556:(P,h,e)=>{function s(t){const r=document.createElement("textarea");r.value=t,r.setAttribute("readonly",""),r.style.position="absolute",r.style.left="-9999px",document.body.appendChild(r);const C=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);r.select(),document.execCommand("copy"),document.body.removeChild(r),C&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(C))}e.d(h,{y:()=>s})}}]);
//# sourceMappingURL=https://sources.2sxc.org/17.10.00/dist/ng-edit/projects_eav-ui_src_app_permissions_permissions_component_ts.2fa4a6e326b5d6cc.js.map