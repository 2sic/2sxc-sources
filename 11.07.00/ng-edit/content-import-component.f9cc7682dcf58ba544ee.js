(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{SL64:function(e,t,n){"use strict";n.r(t),n.d(t,"ContentImportComponent",(function(){return _}));var i=n("D57K"),o=n("BLjT"),a=n("LiEJ"),c=n("3riI"),l=n("cQOC"),s=n("Jg5f"),r=n("1C3z"),u=n("5/c3"),b=n("GX8n"),p=n("KoVM"),f=n("S36y"),d=n("8AiQ"),g=n("8/3+"),m=n("ZSGP"),h=n("9HSk"),v=n("Qc/f"),V=n("+raR");function S(e,t){if(1&e){var n=r.Wb();r.Vb(0,"form",11,12),r.Vb(2,"div",13),r.Vb(3,"div"),r.Vb(4,"button",14),r.dc("click",(function(){return r.Dc(n),r.Bc(8).click()})),r.Vb(5,"span"),r.Oc(6),r.Ub(),r.Ub(),r.Vb(7,"input",15,16),r.dc("change",(function(e){return r.Dc(n),r.hc(3).fileChange(e)})),r.Ub(),r.Ub(),r.Vb(9,"div"),r.Vb(10,"p",17),r.Oc(11,"References to pages / files"),r.Ub(),r.Vb(12,"mat-radio-group",18),r.dc("ngModelChange",(function(e){return r.Dc(n),r.hc(3).formValues.resourcesReferences=e})),r.Vb(13,"mat-radio-button",19),r.Oc(14," Import links as written in the file (for example /Portals/...) "),r.Ub(),r.Vb(15,"mat-radio-button",20),r.Oc(16," Try to resolve paths to references "),r.Ub(),r.Ub(),r.Ub(),r.Vb(17,"div"),r.Vb(18,"p",17),r.Oc(19,"Clear all other entities"),r.Ub(),r.Vb(20,"mat-radio-group",21),r.dc("ngModelChange",(function(e){return r.Dc(n),r.hc(3).formValues.clearEntities=e})),r.Vb(21,"mat-radio-button",22),r.Oc(22," Keep all entities not found in import "),r.Ub(),r.Vb(23,"mat-radio-button",23),r.Oc(24," Remove all entities not found in import "),r.Ub(),r.Ub(),r.Ub(),r.Vb(25,"p",24),r.Oc(26,"Remember to backup your DNN first!"),r.Ub(),r.Ub(),r.Vb(27,"div",25),r.Vb(28,"button",26),r.dc("click",(function(){return r.Dc(n),r.hc(3).closeDialog()})),r.Oc(29,"Cancel"),r.Ub(),r.Vb(30,"button",27),r.dc("click",(function(){return r.Dc(n),r.hc(3).evaluateContent()})),r.Oc(31," Preview Import "),r.Ub(),r.Ub(),r.Ub()}if(2&e){var i=r.hc(3);r.Bb(6),r.Pc(i.formValues.file?i.formValues.file.name:"Select or drop file"),r.Bb(6),r.nc("ngModel",i.formValues.resourcesReferences),r.Bb(8),r.nc("ngModel",i.formValues.clearEntities),r.Bb(10),r.nc("disabled",!i.formValues.file||!i.formValues.file.name)}}function U(e,t){1&e&&(r.Vb(0,"p",28),r.Oc(1,"Please wait while processing..."),r.Ub())}function O(e,t){if(1&e&&(r.Vb(0,"div",31),r.Vb(1,"p",32),r.Oc(2),r.Ub(),r.Vb(3,"p",32),r.Oc(4,"File contains:"),r.Ub(),r.Vb(5,"ul",33),r.Vb(6,"li"),r.Oc(7),r.Ub(),r.Vb(8,"li"),r.Oc(9),r.Ub(),r.Vb(10,"li"),r.Oc(11),r.Ub(),r.Ub(),r.Vb(12,"p",32),r.Oc(13,"If you press Import, it will:"),r.Ub(),r.Vb(14,"ul",33),r.Vb(15,"li"),r.Oc(16),r.Ub(),r.Vb(17,"li"),r.Oc(18),r.Ub(),r.Vb(19,"li"),r.Oc(20),r.Ub(),r.Vb(21,"li"),r.Oc(22),r.Ub(),r.Ub(),r.Vb(23,"p",24),r.Oc(24,"Note: The import validates much data and may take several minutes."),r.Ub(),r.Ub()),2&e){var n=r.hc(4).ngIf,i=r.hc();r.Bb(2),r.Qc("Try to import file '",i.formValues.file.name,"'"),r.Bb(5),r.Qc("",n.evaluationResult.Detail.DocumentElementsCount," content-items (records/entities)"),r.Bb(2),r.Qc("",n.evaluationResult.Detail.LanguagesInDocumentCount," languages"),r.Bb(2),r.Rc("",n.evaluationResult.Detail.AttributeNamesInDocument.length," columns: ",n.evaluationResult.Detail.AttributeNamesInDocument.join(", "),""),r.Bb(5),r.Qc("Create ",n.evaluationResult.Detail.AmountOfEntitiesCreated," content-items"),r.Bb(2),r.Qc("Update ",n.evaluationResult.Detail.AmountOfEntitiesUpdated," content-items"),r.Bb(2),r.Qc("Delete ",n.evaluationResult.Detail.AmountOfEntitiesDeleted," content-items"),r.Bb(2),r.Rc("Ignore ",n.evaluationResult.Detail.AttributeNamesNotImported.length," columns: ",n.evaluationResult.Detail.AttributeNamesNotImported.join(", "),"")}}function w(e,t){if(1&e&&(r.Vb(0,"div"),r.Vb(1,"i"),r.Oc(2),r.Ub(),r.Ub()),2&e){var n=r.hc().$implicit;r.Bb(2),r.Qc("Details: ",n.ErrorDetail,"")}}function D(e,t){if(1&e&&(r.Vb(0,"div"),r.Vb(1,"i"),r.Oc(2),r.Ub(),r.Ub()),2&e){var n=r.hc().$implicit;r.Bb(2),r.Qc("Line-no: ",n.LineNumber,"")}}function y(e,t){if(1&e&&(r.Vb(0,"div"),r.Vb(1,"i"),r.Oc(2),r.Ub(),r.Ub()),2&e){var n=r.hc().$implicit;r.Bb(2),r.Qc("Line-details: ",n.LineDetail,"")}}function C(e,t){if(1&e&&(r.Vb(0,"li"),r.Vb(1,"div"),r.Oc(2),r.Ub(),r.Mc(3,w,3,1,"div",6),r.Mc(4,D,3,1,"div",6),r.Mc(5,y,3,1,"div",6),r.Ub()),2&e){var n=t.$implicit,i=r.hc(6);r.Bb(2),r.Pc(i.errors[n.ErrorCode]),r.Bb(1),r.nc("ngIf",n.ErrorDetail),r.Bb(1),r.nc("ngIf",n.LineNumber),r.Bb(1),r.nc("ngIf",n.LineDetail)}}function I(e,t){if(1&e&&(r.Vb(0,"div",31),r.Vb(1,"p",32),r.Oc(2),r.Ub(),r.Vb(3,"ul",33),r.Mc(4,C,6,4,"li",34),r.Ub(),r.Ub()),2&e){var n=r.hc(4).ngIf,i=r.hc();r.Bb(2),r.Qc("Try to import file '",i.formValues.file.name,"'"),r.Bb(2),r.nc("ngForOf",n.evaluationResult.Detail)}}function R(e,t){if(1&e){var n=r.Wb();r.Tb(0),r.Mc(1,O,25,10,"div",29),r.Mc(2,I,5,2,"div",29),r.Vb(3,"div",30),r.Vb(4,"button",26),r.dc("click",(function(){return r.Dc(n),r.hc(4).back()})),r.Oc(5,"Back"),r.Ub(),r.Vb(6,"button",27),r.dc("click",(function(){return r.Dc(n),r.hc(4).importContent()})),r.Oc(7," Import "),r.Ub(),r.Ub(),r.Sb()}if(2&e){var i=r.hc(3).ngIf;r.Bb(1),r.nc("ngIf",i.evaluationResult.Success),r.Bb(1),r.nc("ngIf",!i.evaluationResult.Success),r.Bb(4),r.nc("disabled",!i.evaluationResult.Success)}}function B(e,t){if(1&e&&(r.Tb(0),r.Mc(1,R,8,3,"ng-container",6),r.Sb()),2&e){var n=r.hc(2).ngIf;r.Bb(1),r.nc("ngIf",n.evaluationResult)}}function M(e,t){1&e&&(r.Vb(0,"p"),r.Oc(1,"Import done."),r.Ub())}function x(e,t){1&e&&(r.Vb(0,"p"),r.Oc(1,"Import failed."),r.Ub())}function $(e,t){if(1&e&&(r.Vb(0,"div",28),r.Mc(1,M,2,0,"p",6),r.Mc(2,x,2,0,"p",6),r.Ub()),2&e){var n=r.hc(3).ngIf;r.Bb(1),r.nc("ngIf",n.importResult.Success),r.Bb(1),r.nc("ngIf",!n.importResult.Success)}}function T(e,t){if(1&e){var n=r.Wb();r.Vb(0,"div"),r.Mc(1,$,3,2,"div",35),r.Vb(2,"div",30),r.Vb(3,"button",36),r.dc("click",(function(){return r.Dc(n),r.hc(3).closeDialog()})),r.Oc(4,"Close"),r.Ub(),r.Ub(),r.Ub()}if(2&e){var i=r.hc(2).ngIf;r.Bb(1),r.nc("ngIf",i.importResult)}}function P(e,t){if(1&e&&(r.Tb(0),r.Tb(1,7),r.Mc(2,S,32,4,"form",8),r.Mc(3,U,2,0,"p",9),r.Mc(4,B,2,1,"ng-container",10),r.Mc(5,T,5,1,"div",10),r.Sb(),r.Sb()),2&e){var n=r.hc().ngIf;r.Bb(1),r.nc("ngSwitch",n.viewStateSelected),r.Bb(1),r.nc("ngSwitchCase",1),r.Bb(1),r.nc("ngSwitchCase",0),r.Bb(1),r.nc("ngSwitchCase",2),r.Bb(1),r.nc("ngSwitchCase",3)}}function k(e,t){if(1&e){var n=r.Wb();r.Vb(0,"div",1),r.dc("filesDropped",(function(e){return r.Dc(n),r.hc().filesDropped(e)})),r.Vb(1,"div",2),r.Vb(2,"div",3),r.Oc(3),r.Ub(),r.Ub(),r.Vb(4,"p",4),r.Oc(5," This will import content-items into 2sxc. It requires that you already defined the content-type before you try importing, and that you created the import-file using the template provided by the Export. Please visit "),r.Vb(6,"a",5),r.Oc(7,"https://2sxc.org/help"),r.Ub(),r.Oc(8," for more instructions. "),r.Ub(),r.Mc(9,P,6,5,"ng-container",6),r.Ub()}if(2&e){var i=t.ngIf,o=r.hc();r.nc("allowedFileTypes","xml"),r.Bb(3),r.Qc("",null==i.contentType?null:i.contentType.Name," Import Data"),r.Bb(6),r.nc("ngIf",null!=o.formValues)}}var _=function(){function e(e,t,n,o,l,r){this.dialogData=e,this.dialogRef=t,this.route=n,this.contentImportService=o,this.appDialogConfigService=l,this.contentTypesService=r,this.hostClass="dialog-component",this.contentType$=new a.a(null),this.loading$=new a.a(!1),this.viewStates={waiting:0,default:1,evaluated:2,imported:3},this.viewStateSelected$=new a.a(this.viewStates.default),this.evaluationResult$=new a.a(null),this.importResult$=new a.a(null),this.templateVars$=Object(c.a)([this.contentType$,this.loading$,this.viewStateSelected$,this.evaluationResult$,this.importResult$]).pipe(Object(s.a)((function(e){var t=Object(i.f)(e,5);return{contentType:t[0],loading:t[1],viewStateSelected:t[2],evaluationResult:t[3],importResult:t[4]}}))),this.errors={0:"Unknown error occured.",1:"Selected content-type does not exist.",2:"Document is not a valid XML file.",3:"Selected content-type does not match the content-type in the XML file.",4:"The language is not supported.",5:"The document does not specify all languages for all entities.",6:"Language reference cannot be parsed, the language is not supported.",7:"Language reference cannot be parsed, the read-write protection is not supported.",8:"Value cannot be read, because of it has an invalid format."},this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName")}return e.prototype.ngOnInit=function(){var e=this;this.loading$.next(!0);var t=this.contentTypesService.retrieveContentType(this.contentTypeStaticName),n=this.appDialogConfigService.getDialogSettings();Object(l.a)([t,n]).subscribe((function(t){var n=Object(i.f)(t,2),o=n[1];e.contentType$.next(n[0]),e.formValues={defaultLanguage:o.Context.Language.Primary,contentType:e.contentTypeStaticName,file:null!=e.dialogData.files?e.dialogData.files[0]:null,resourcesReferences:"Keep",clearEntities:"None"},e.loading$.next(!1)}))},e.prototype.ngOnDestroy=function(){this.contentType$.complete(),this.loading$.complete(),this.viewStateSelected$.complete(),this.evaluationResult$.complete(),this.importResult$.complete()},e.prototype.closeDialog=function(){this.dialogRef.close()},e.prototype.evaluateContent=function(){var e=this;this.viewStateSelected$.next(this.viewStates.waiting),this.contentImportService.evaluateContent(this.formValues).subscribe((function(t){e.evaluationResult$.next(t),e.viewStateSelected$.next(e.viewStates.evaluated)}))},e.prototype.importContent=function(){var e=this;this.viewStateSelected$.next(this.viewStates.waiting),this.contentImportService.importContent(this.formValues).subscribe((function(t){e.importResult$.next(t),e.viewStateSelected$.next(e.viewStates.imported)}))},e.prototype.back=function(){this.viewStateSelected$.next(this.viewStates.default),this.evaluationResult$.next(null)},e.prototype.fileChange=function(e){this.formValues.file=e.target.files[0]},e.prototype.filesDropped=function(e){this.formValues.file=e[0]},e.\u0275fac=function(t){return new(t||e)(r.Pb(o.a),r.Pb(o.g),r.Pb(u.a),r.Pb(b.a),r.Pb(p.a),r.Pb(f.a))},e.\u0275cmp=r.Jb({type:e,selectors:[["app-content-import"]],hostVars:1,hostBindings:function(e,t){2&e&&r.Yb("className",t.hostClass)},decls:2,vars:3,consts:[["class","dialog-form-wrapper","appDragAndDrop","",3,"allowedFileTypes","filesDropped",4,"ngIf"],["appDragAndDrop","",1,"dialog-form-wrapper",3,"allowedFileTypes","filesDropped"],["mat-dialog-title",""],[1,"dialog-title-box"],[1,"dialog-description"],["href","https://2sxc.org/help","target","_blank"],[4,"ngIf"],[3,"ngSwitch"],["class","dialog-form",4,"ngSwitchCase"],["class","progress-message",4,"ngSwitchCase"],[4,"ngSwitchCase"],[1,"dialog-form"],["ngForm","ngForm"],[1,"dialog-form-content","fancy-scrollbar-light"],["mat-raised-button","","matTooltip","Open file browser",3,"click"],["type","file",1,"hide",3,"change"],["fileInput",""],[1,"field-label"],["name","ResourcesReferences",3,"ngModel","ngModelChange"],["value","Keep"],["value","Resolve"],["name","ClearEntities",3,"ngModel","ngModelChange"],["value","None"],["value","All"],[1,"hint"],[1,"dialog-form-actions"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click"],[1,"progress-message"],["class","dialog-component-content fancy-scrollbar-light",4,"ngIf"],[1,"dialog-component-actions"],[1,"dialog-component-content","fancy-scrollbar-light"],[1,"evaluation__title"],[1,"evaluation__content"],[4,"ngFor","ngForOf"],["class","progress-message",4,"ngIf"],["mat-raised-button","","color","accent",3,"click"]],template:function(e,t){1&e&&(r.Mc(0,k,10,3,"div",0),r.ic(1,"async")),2&e&&r.nc("ngIf",r.jc(1,1,t.templateVars$))},directives:[d.m,g.a,o.h,d.o,d.p,m.u,m.m,m.n,h.a,v.a,V.b,m.l,m.o,V.a,d.l],pipes:[d.b],styles:[".field-label[_ngcontent-%COMP%]{font-size:18px;margin:24px 0 0}.mat-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:8px 0}.mat-radio-button[_ngcontent-%COMP%]{margin:5px;font-size:14px}.hint[_ngcontent-%COMP%]{margin-top:24px;margin-bottom:16px}.hint[_ngcontent-%COMP%], .progress-message[_ngcontent-%COMP%]{font-size:18px}.evaluation__title[_ngcontent-%COMP%]{font-size:18px;margin:24px 0 0;font-weight:700}.evaluation__content[_ngcontent-%COMP%]{font-size:14px}.evaluation__content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:2px 0}"],changeDetection:0}),e}()}}]);
//# sourceMappingURL=https://sources.2sxc.org/11.07.00/ng-edit/content-import-component.f9cc7682dcf58ba544ee.js.map