{"version":3,"sources":["../edit/shared/services/edit-routing.service.ts","../edit/shared/services/global-configuration.service.ts","../edit/assets/icons/2sxc/Material-Icon-Adam-48-filled.svg","../edit/shared/services/load-icons.service.ts","../edit/assets/icons/2sxc/Material-Icon-Adam-48.svg","../edit/assets/icons/font-awesome/draft-branch.svg","../edit/assets/icons/font-awesome/file.svg","../edit/assets/icons/font-awesome/file-archive.svg","../edit/assets/icons/font-awesome/file-audio.svg","../edit/assets/icons/font-awesome/file-code.svg","../edit/assets/icons/font-awesome/file-excel.svg","../edit/assets/icons/font-awesome/file-image.svg","../edit/assets/icons/font-awesome/file-pdf.svg","../edit/assets/icons/font-awesome/file-powerpoint.svg","../edit/assets/icons/font-awesome/file-text.svg","../edit/assets/icons/font-awesome/file-video.svg","../edit/assets/icons/font-awesome/file-word.svg","../edit/assets/icons/font-awesome/folder.svg","../edit/assets/icons/font-awesome/folder-plus.svg","../edit/assets/icons/font-awesome/sitemap.svg","./src/app/shared/pipes/safe-resource-url.ts","../edit/shared/services/assets.service.ts","../edit/shared/services/file-type.service.ts","../edit/shared/services/eav.service.ts","../edit/shared/services/edit-routing.helpers.ts","../edit/shared/services/scripts-loader.service.ts","../edit/shared/services/entity.service.ts","../edit/shared/store/actions/item.actions.ts","../edit/shared/services/query.service.ts","../edit/eav-material-controls/input-types/dnn-bridge/dnn-bridge.component.ts","../edit/eav-material-controls/input-types/dnn-bridge/dnn-bridge.component.html","../edit/shared/services/dnn-bridge.service.ts","../edit/shared/services/dropzone-dragging.helper.ts","../edit/shared/store/ngrx-data/language-instance.service.ts"],"names":["router","languageInstanceService","ngOnDestroy","this","childFormResult$","complete","subscription","unsubscribe","init","route","formId","dialogRef","initHideHeader","initChildFormResult","refreshOnChildVersionsClosed","isExpanded","fieldId","entityGuid","fieldIndex","toString","params","pipe","detailsEntityGuid","detailsFieldId","childFormResult","childResult","updateEntityGuid","updateFieldId","result","childFormClosed","expand","componentTag","snapshot","oldEditUrl","items","newEditUrl","currentUrl","lastIndex","lastIndexOf","newUrl","substring","replace","navigate","state","open","form","formUrl","relativeTo","add","subscribe","hasDetails","updateHideHeader","events","event","firstChild","editResult","getCurrentNavigation","extras","parseInt","formResult","next","versionsResult","refreshEdit","close","navigateUrl","EditRoutingService","store","snackBar","loadDebugEnabled","debugEnabled","dispatch","toggleDebugEnabled","select","enabled","duration","getDebugEnabled","GlobalConfigService","matIconRegistry","domSanitizer","icons","name","html","load","forEach","icon","addSvgIconLiteral","bypassSecurityTrustHtml","LoadIconsService","sanitizer","transform","resourceUrl","bypassSecurityTrustResourceUrl","SafeResourceUrlPipe","webApiAppFilesAll","webApiAppFilesRoot","webApiAppFile","webApiAppFileCreate","http","eavService","dnnContext","getAll","global","get","$2sxc","apiUrl","appId","eavConfig","withSubfolders","create","path","post","AssetsService","defaultIcon","checkImgRegEx","customExtensions","doc","docx","xls","xlsx","ppt","pptx","pdf","mp3","avi","mpg","mpeg","mov","mp4","zip","rar","txt","css","xml","xsl","matExtensions","vcf","getExtension","filename","substr","toLowerCase","getIconClass","ext","isKnownType","isImage","test","FileTypeService","webApiEditRoot","context","forceConnectorSave$","formValueChange$","formDisabledChange$","setEavConfig","editDialogContext","zoneId","appRoot","App","Url","lang","Language","Current","langPri","Primary","langs","All","moduleId","partOfPage","sessionStorage","getItem","portalRoot","tabId","systemRoot","window","location","pathname","split","versioningOptions","getVersioningOptions","fetchFormData","saveItem","item","saveItemSuccess","data","saveItemError","error","saveFormData","body","publishing","show","hide","branch","publish","console","EavService","calculatePathFromRoot","lastChild","pathFromRoot","url","length","urlSegment","FileTypeConstants","loadedFiles","scripts","callback","sortedFiles","sortByType","insertToDom","cssFiles","jsFiles","script","file","resolveSpecialPaths","type","loaded","domEl","endsWith","push","concat","files","increment","sxcVersion","existing","find","loadedFile","removeEventListener","addEventListener","document","createElement","rel","href","src","querySelector","appendChild","getUrlPrefix","ScriptsLoaderService","webApiEntityRoot","webApiEntityList","getAvailableEntities","filterText","contentTypeName","reactiveEntities","p","filter","delete","contentType","entityId","force","id","EntityService","SAVE_ITEM_ATTRIBUTES_VALUES","SAVE_ITEM_ATTRIBUTES_VALUES_SUCCESS","SAVE_ITEM_ATTRIBUTES_VALUES_ERROR","queryUrl","includeGuid","QueryService","dialogData","ngOnInit","connector","iframeSrc","dialogType","paramKeys","Object","keys","key","value","encodeURIComponent","iframeLoaded","iframe","target","w","contentWindow","connectBridge","alert","DnnBridgeComponent","dialog","valueChanged","width","getUrlOfId","guid","field","hyperlink","appid","DnnBridgeService","zone","eventListeners","attach","htmlEl","runOutsideAngular","dragoverListener","timeoutsArray","clearTimeout","splice","clearTimeouts","windowBodyTimeouts","classList","draggingClass","dropListener","remove","passive","element","listener","detach","eventListener","serviceElementsFactory","localizationWrapperMenuChangeSource","localizationWrapperMenuChange$","asObservable","addLanguageInstance","currentLanguage","defaultLanguage","uiLanguage","hideHeader","addOneToCache","getCurrentLanguage","entities$","languageInstances","langInstance","oldLang","newLang","getDefaultLanguage","getHideHeader","oldHide","newHide","updateCurrentLanguage","newLanguage","updateOneInCache","removeLanguageInstance","removeOneFromCache","triggerLocalizationWrapperMenuChange","LanguageInstanceService"],"mappings":"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","file":"default~app-administration-app-administration-module~code-editor-code-editor-module~content-items-co~556c2cae.0d2ae165b6dd32e2a265.js","sourcesContent":["import { Injectable, OnDestroy } from '@angular/core';\r\nimport { MatDialogRef } from '@angular/material/dialog';\r\nimport { ActivatedRoute, NavigationEnd, Router } from '@angular/router';\r\nimport { Subject, Subscription } from 'rxjs';\r\nimport { distinctUntilChanged, filter, map, pairwise, startWith } from 'rxjs/operators';\r\nimport { ItemHistoryResult } from '../../../ng-dialogs/src/app/item-history/models/item-history-result.model';\r\nimport { convertFormToUrl } from '../../../ng-dialogs/src/app/shared/helpers/url-prep.helper';\r\nimport { EditForm } from '../../../ng-dialogs/src/app/shared/models/edit-form.model';\r\nimport { MultiItemEditFormComponent } from '../../eav-item-dialog/multi-item-edit-form/multi-item-edit-form.component';\r\nimport { EditParams } from '../../edit-matcher.models';\r\nimport { LanguageInstanceService } from '../store/ngrx-data/language-instance.service';\r\nimport { calculatePathFromRoot } from './edit-routing.helpers';\r\nimport { ChildFormResult, NavigateFormResult } from './edit-routing.models';\r\n\r\n@Injectable()\r\nexport class EditRoutingService implements OnDestroy {\r\n  private route: ActivatedRoute;\r\n  private subscription: Subscription;\r\n  private childFormResult$: Subject<ChildFormResult>;\r\n  private dialogRef: MatDialogRef<MultiItemEditFormComponent>;\r\n\r\n  constructor(private router: Router, private languageInstanceService: LanguageInstanceService) { }\r\n\r\n  // spm TODO: ngOnDestroy only fires in services provided in component\r\n  ngOnDestroy() {\r\n    this.childFormResult$.complete();\r\n    this.subscription.unsubscribe();\r\n  }\r\n\r\n  init(route: ActivatedRoute, formId: number, dialogRef: MatDialogRef<MultiItemEditFormComponent>) {\r\n    this.route = route;\r\n    this.dialogRef = dialogRef;\r\n    this.subscription = new Subscription();\r\n    this.childFormResult$ = new Subject<ChildFormResult>();\r\n    this.initHideHeader(formId);\r\n    this.initChildFormResult();\r\n    this.refreshOnChildVersionsClosed();\r\n  }\r\n\r\n  /** Tells if field with this index should be expanded */\r\n  isExpanded(fieldId: number, entityGuid: string) {\r\n    const fieldIndex = fieldId.toString();\r\n    return this.route.params.pipe(\r\n      map((params: EditParams) => params.detailsEntityGuid === entityGuid && params.detailsFieldId === fieldIndex),\r\n      distinctUntilChanged()\r\n    );\r\n  }\r\n\r\n  /** Fires when child form is closed and has a result, new entity was added */\r\n  childFormResult(fieldId: number, entityGuid: string) {\r\n    return this.childFormResult$.pipe(\r\n      filter(\r\n        childResult => childResult.updateEntityGuid === entityGuid && childResult.updateFieldId === fieldId && childResult.result != null\r\n      ),\r\n      map(childResult => childResult.result)\r\n    );\r\n  }\r\n\r\n  /** Fires when child form is closed */\r\n  childFormClosed() {\r\n    return this.childFormResult$.pipe(map(childResult => null));\r\n  }\r\n\r\n  expand(expand: boolean, fieldId: number, entityGuid: string, componentTag?: string) {\r\n    const params = this.route.snapshot.params as EditParams;\r\n    const oldHasDetails = params.detailsEntityGuid != null && params.detailsFieldId != null;\r\n    const oldEditUrl = `edit/${params.items}` + (oldHasDetails ? `/details/${params.detailsEntityGuid}/${params.detailsFieldId}` : '');\r\n    const newEditUrl = `edit/${params.items}` + (expand ? `/details/${entityGuid}/${fieldId}` : '');\r\n\r\n    const currentUrl = calculatePathFromRoot(this.route);\r\n    const lastIndex = currentUrl.lastIndexOf(oldEditUrl);\r\n    if (lastIndex <= 0) { return; }\r\n    const newUrl = currentUrl.substring(0, lastIndex) + currentUrl.substring(lastIndex).replace(oldEditUrl, newEditUrl);\r\n    this.router.navigate([newUrl], { state: componentTag && { componentTag } });\r\n  }\r\n\r\n  /** Opens child dialog and stores update entityGuid and fieldId in the url, if field is not expanded already */\r\n  open(fieldId: number, entityGuid: string, form: EditForm) {\r\n    const formUrl = convertFormToUrl(form);\r\n    const params = this.route.snapshot.params as EditParams;\r\n    const hasDetails = params.detailsEntityGuid != null && params.detailsFieldId != null;\r\n    // if field is expanded, just open child because that info will be used for field update\r\n    if (hasDetails) {\r\n      this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route });\r\n      return;\r\n    }\r\n\r\n    // otherwise add /update/:entityGuid/:fieldId to the url\r\n    const oldEditUrl = `edit/${params.items}`;\r\n    const newEditUrl = `edit/${params.items}/update/${entityGuid}/${fieldId}/edit/${formUrl}`;\r\n\r\n    const currentUrl = calculatePathFromRoot(this.route);\r\n    const lastIndex = currentUrl.lastIndexOf(oldEditUrl);\r\n    if (lastIndex <= 0) { return; }\r\n    const newUrl = currentUrl.substring(0, lastIndex) + currentUrl.substring(lastIndex).replace(oldEditUrl, newEditUrl);\r\n    this.router.navigate([newUrl]);\r\n  }\r\n\r\n  /** Update hideHeader for the form. Fix for safari and mobile browsers */\r\n  private initHideHeader(formId: number) {\r\n    this.subscription.add(\r\n      this.route.params\r\n        .pipe(\r\n          map((params: EditParams) => params.detailsEntityGuid != null && params.detailsFieldId != null),\r\n          distinctUntilChanged()\r\n        )\r\n        .subscribe(hasDetails => {\r\n          this.languageInstanceService.updateHideHeader(formId, hasDetails);\r\n        })\r\n    );\r\n  }\r\n\r\n  private initChildFormResult() {\r\n    this.subscription.add(\r\n      this.router.events.pipe(\r\n        filter(event => event instanceof NavigationEnd),\r\n        startWith(!!this.route.snapshot.firstChild),\r\n        map(() => !!this.route.snapshot.firstChild),\r\n        pairwise(),\r\n        filter(([hadChild, hasChild]) => hadChild && !hasChild),\r\n        map(() => {\r\n          const params = this.route.snapshot.params as EditParams;\r\n          const hasDetails = params.detailsEntityGuid != null && params.detailsFieldId != null;\r\n          const updateEntityGuid = hasDetails ? params.detailsEntityGuid : params.updateEntityGuid;\r\n          const updateFieldId = hasDetails ? params.detailsFieldId : params.updateFieldId;\r\n          const navigation = this.router.getCurrentNavigation();\r\n          const editResult = navigation.extras?.state;\r\n          const formResult: ChildFormResult = {\r\n            updateEntityGuid,\r\n            updateFieldId: parseInt(updateFieldId, 10),\r\n            result: editResult,\r\n          };\r\n          return formResult;\r\n        }),\r\n      ).subscribe(formResult => {\r\n        // alert subscribers that child form closed\r\n        this.childFormResult$.next(formResult);\r\n\r\n        // clear update ids from url (leave expanded/details)\r\n        const params = this.route.snapshot.params as EditParams;\r\n        const hasUpdate = params.updateEntityGuid != null && params.updateFieldId != null;\r\n        if (!hasUpdate) { return; }\r\n\r\n        const oldEditUrl = `edit/${params.items}/update/${params.updateEntityGuid}/${params.updateFieldId}`;\r\n        const newEditUrl = `edit/${params.items}`;\r\n\r\n        const currentUrl = calculatePathFromRoot(this.route);\r\n        const lastIndex = currentUrl.lastIndexOf(oldEditUrl);\r\n        if (lastIndex <= 0) { return; }\r\n        const newUrl = currentUrl.substring(0, lastIndex) + currentUrl.substring(lastIndex).replace(oldEditUrl, newEditUrl);\r\n        this.router.navigate([newUrl]);\r\n      })\r\n    );\r\n  }\r\n\r\n  private refreshOnChildVersionsClosed() {\r\n    this.subscription.add(\r\n      this.router.events.pipe(\r\n        filter(event => event instanceof NavigationEnd),\r\n        startWith(!!this.route.snapshot.firstChild),\r\n        map(() => !!this.route.snapshot.firstChild),\r\n        pairwise(),\r\n        filter(([hadChild, hasChild]) => hadChild && !hasChild),\r\n        map(() => {\r\n          const navigation = this.router.getCurrentNavigation();\r\n          const versionsResult = navigation.extras?.state as ItemHistoryResult;\r\n          return versionsResult;\r\n        }),\r\n        filter(versionsResult => versionsResult?.refreshEdit != null),\r\n      ).subscribe(result => {\r\n        if (!result.refreshEdit) { return; }\r\n        const params = this.route.snapshot.params as EditParams;\r\n        const oldEditUrl = `edit/${params.items}`;\r\n        const newEditUrl = `edit/refresh/${params.items}`;\r\n\r\n        const currentUrl = calculatePathFromRoot(this.route);\r\n        const lastIndex = currentUrl.lastIndexOf(oldEditUrl);\r\n        if (lastIndex <= 0) { return; }\r\n        const newUrl = currentUrl.substring(0, lastIndex) + currentUrl.substring(lastIndex).replace(oldEditUrl, newEditUrl);\r\n        const navRes: NavigateFormResult = {\r\n          navigateUrl: newUrl,\r\n        };\r\n        this.dialogRef.close(navRes);\r\n      })\r\n    );\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { Store } from '@ngrx/store';\r\nimport { Observable } from 'rxjs';\r\nimport { take } from 'rxjs/operators';\r\nimport * as fromStore from '../store';\r\nimport * as GlobalConfigurationActions from '../store/actions/global-configuration.actions';\r\n\r\n@Injectable({ providedIn: 'root' })\r\nexport class GlobalConfigService {\r\n  constructor(private store: Store<fromStore.EavState>, private snackBar: MatSnackBar) { }\r\n\r\n  loadDebugEnabled(debugEnabled: boolean) {\r\n    this.store.dispatch(GlobalConfigurationActions.loadDebugEnabled({ debugEnabled }));\r\n  }\r\n\r\n  toggleDebugEnabled() {\r\n    this.store.dispatch(GlobalConfigurationActions.toggleDebugEnabled());\r\n    let debugEnabled: boolean;\r\n    this.store.select(fromStore.selectDebugEnabled).pipe(take(1)).subscribe(enabled => {\r\n      debugEnabled = enabled;\r\n    });\r\n    if (debugEnabled) {\r\n      this.snackBar.open('debug mode enabled', null, {\r\n        duration: 3000,\r\n      });\r\n    } else {\r\n      this.snackBar.open('debug mode disabled', null, {\r\n        duration: 3000,\r\n      });\r\n    }\r\n  }\r\n\r\n  getDebugEnabled(): Observable<boolean> {\r\n    return this.store.select(fromStore.selectDebugEnabled);\r\n  }\r\n}\r\n","export default \"<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?>\\r\\n<!-- Generator: Adobe Illustrator 23.0.3, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->\\r\\n<svg version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" x=\\\"0px\\\" y=\\\"0px\\\"\\r\\n\\t viewBox=\\\"0 0 48 48\\\" style=\\\"enable-background:new 0 0 48 48;\\\" xml:space=\\\"preserve\\\">\\r\\n<style type=\\\"text/css\\\">\\r\\n\\t.st0{display:none;}\\r\\n\\t.st1{display:inline;}\\r\\n</style>\\r\\n<g id=\\\"Layer_1\\\">\\r\\n\\t<path d=\\\"M32,4c-6,0-10,4-10,10C28,14,32,10,32,4z\\\"/>\\r\\n</g>\\r\\n<g id=\\\"Layer_3\\\" class=\\\"st0\\\">\\r\\n</g>\\r\\n<g id=\\\"Icon\\\">\\r\\n\\t<path d=\\\"M32,16c-4,0-8,2.06-8,2.06S20,16,16,16c-6,0-10,4.01-10,9.47C6,34.74,12,44,18,44c2,0,4-1.85,6-1.85S28,44,30,44\\r\\n\\t\\tc6,0,12-9.26,12-18.53C42,20.01,38,16,32,16L32,16z\\\"/>\\r\\n</g>\\r\\n</svg>\\r\\n\";","import appleFilled from '!raw-loader!../../assets/icons/2sxc/Material-Icon-Adam-48-filled.svg';\r\nimport apple from '!raw-loader!../../assets/icons/2sxc/Material-Icon-Adam-48.svg';\r\nimport draftBranch from '!raw-loader!../../assets/icons/font-awesome/draft-branch.svg';\r\nimport fileArchive from '!raw-loader!../../assets/icons/font-awesome/file-archive.svg';\r\nimport fileAudio from '!raw-loader!../../assets/icons/font-awesome/file-audio.svg';\r\nimport fileCode from '!raw-loader!../../assets/icons/font-awesome/file-code.svg';\r\nimport fileExcel from '!raw-loader!../../assets/icons/font-awesome/file-excel.svg';\r\nimport fileImage from '!raw-loader!../../assets/icons/font-awesome/file-image.svg';\r\nimport filePdf from '!raw-loader!../../assets/icons/font-awesome/file-pdf.svg';\r\nimport filePowerpoint from '!raw-loader!../../assets/icons/font-awesome/file-powerpoint.svg';\r\nimport fileText from '!raw-loader!../../assets/icons/font-awesome/file-text.svg';\r\nimport fileVideo from '!raw-loader!../../assets/icons/font-awesome/file-video.svg';\r\nimport fileWord from '!raw-loader!../../assets/icons/font-awesome/file-word.svg';\r\nimport file from '!raw-loader!../../assets/icons/font-awesome/file.svg';\r\nimport folderPlus from '!raw-loader!../../assets/icons/font-awesome/folder-plus.svg';\r\nimport folder from '!raw-loader!../../assets/icons/font-awesome/folder.svg';\r\nimport sitemap from '!raw-loader!../../assets/icons/font-awesome/sitemap.svg';\r\nimport { Injectable } from '@angular/core';\r\nimport { MatIconRegistry } from '@angular/material/icon';\r\nimport { DomSanitizer } from '@angular/platform-browser';\r\n\r\n@Injectable()\r\nexport class LoadIconsService {\r\n  private icons = [\r\n    { name: 'apple', html: apple },\r\n    { name: 'appleFilled', html: appleFilled },\r\n    { name: 'draft-branch', html: draftBranch },\r\n    { name: 'file', html: file },\r\n    { name: 'file-archive', html: fileArchive },\r\n    { name: 'file-audio', html: fileAudio },\r\n    { name: 'file-code', html: fileCode },\r\n    { name: 'file-excel', html: fileExcel },\r\n    { name: 'file-image', html: fileImage },\r\n    { name: 'file-pdf', html: filePdf },\r\n    { name: 'file-powerpoint', html: filePowerpoint },\r\n    { name: 'file-text', html: fileText },\r\n    { name: 'file-video', html: fileVideo },\r\n    { name: 'file-word', html: fileWord },\r\n    { name: 'folder', html: folder },\r\n    { name: 'folder-plus', html: folderPlus },\r\n    { name: 'sitemap', html: sitemap },\r\n  ];\r\n\r\n  constructor(private matIconRegistry: MatIconRegistry, private domSanitizer: DomSanitizer) { }\r\n\r\n  load() {\r\n    this.icons.forEach(icon => {\r\n      this.matIconRegistry.addSvgIconLiteral(\r\n        icon.name,\r\n        this.domSanitizer.bypassSecurityTrustHtml(icon.html),\r\n      );\r\n    });\r\n  }\r\n}\r\n","export default \"<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?>\\r\\n<!-- Generator: Adobe Illustrator 23.0.3, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->\\r\\n<svg version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" x=\\\"0px\\\" y=\\\"0px\\\"\\r\\n\\t viewBox=\\\"0 0 48 48\\\" style=\\\"enable-background:new 0 0 48 48;\\\" xml:space=\\\"preserve\\\">\\r\\n<style type=\\\"text/css\\\">\\r\\n\\t.st0{display:none;}\\r\\n\\t.st1{display:inline;}\\r\\n</style>\\r\\n<g id=\\\"Layer_1\\\">\\r\\n\\t<path d=\\\"M32,4c-6,0-10,4-10,10C28,14,32,10,32,4z\\\"/>\\r\\n</g>\\r\\n<g id=\\\"Layer_3\\\" class=\\\"st0\\\">\\r\\n</g>\\r\\n<g id=\\\"Icon\\\">\\r\\n\\t<path d=\\\"M32,20c3.7,0,6,2.1,6,5.47C38,33.21,33.01,40,30.06,40c-0.25-0.04-0.93-0.35-1.38-0.56c-1.25-0.58-2.8-1.3-4.68-1.3\\r\\n\\t\\ts-3.43,0.72-4.68,1.3C18.87,39.65,18.19,39.97,18,40c-3.01,0-8-6.79-8-14.53C10,22.1,12.3,20,16,20c2.44,0,5.29,1.17,6.17,1.62\\r\\n\\t\\tL24,22.56l1.83-0.94C26.64,21.2,29.53,20,32,20 M32,16c-4,0-8,2.06-8,2.06S20,16,16,16c-6,0-10,4.01-10,9.47C6,34.74,12,44,18,44\\r\\n\\t\\tc2,0,4-1.85,6-1.85S28,44,30,44c6,0,12-9.26,12-18.53C42,20.01,38,16,32,16L32,16z\\\"/>\\r\\n</g>\\r\\n</svg>\\r\\n\";","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 384 512\\\"><path d=\\\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 39.2 28.2 71.8 65.5 78.7-.8 17.2-5 30.4-12.7 40-17.5 21.8-53.1 25.2-90.7 28.7-28.2 2.6-57.4 5.4-80.4 16.9-3.4 1.7-6.7 3.6-9.7 5.7V158.4c36.5-7.4 64-39.7 64-78.4 0-44.2-35.8-80-80-80S0 35.8 0 80c0 38.7 27.5 71 64 78.4v195.2C27.5 361 0 393.3 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-36.9-24.9-67.9-58.9-77.2 5-9.6 12.3-14.6 19-18 17.5-8.8 42.5-11.2 68.9-13.7 42.6-4 86.7-8.1 112.7-40.5 12.4-15.5 19-35.5 19.8-60.7C357.3 214 384 182.1 384 144zM32 80c0-26.5 21.5-48 48-48s48 21.5 48 48-21.5 48-48 48-48-21.5-48-48zm96 352c0 26.5-21.5 48-48 48s-48-21.5-48-48c0-26.4 21.4-47.9 47.8-48h.6c26.3.2 47.6 21.7 47.6 48zm187.8-241.5L304 192c-26.5 0-48-21.5-48-48s21.5-48 48-48 48 21.5 48 48c0 22.4-15.4 41.2-36.2 46.5z\\\"/></svg>\";","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 384 512\\\"><path d=\\\"M369.9 97.9L286 14C277 5 264.8-.1 252.1-.1H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V131.9c0-12.7-5.1-25-14.1-34zm-22.6 22.7c2.1 2.1 3.5 4.6 4.2 7.4H256V32.5c2.8.7 5.3 2.1 7.4 4.2l83.9 83.9zM336 480H48c-8.8 0-16-7.2-16-16V48c0-8.8 7.2-16 16-16h176v104c0 13.3 10.7 24 24 24h104v304c0 8.8-7.2 16-16 16z\\\"/></svg>\";","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 384 512\\\"><path d=\\\"M128 96v32h32V96zm65.9 169.6c-1.1-5.6-6-9.6-11.8-9.6H160v-32h-32v32l-19.4 97.2c-6.5 32.5 18.3 62.8 51.4 62.8s57.9-30.3 51.4-62.8zm-33.6 124.5c-17.9 0-32.4-12.1-32.4-27s14.5-27 32.4-27 32.4 12.1 32.4 27-14.5 27-32.4 27zM128 160v32h32v-32zm64-96h-32v32h32zm177.9 33.9L286 14C277 5 264.8-.1 252.1-.1H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V131.9c0-12.7-5.1-25-14.1-34zM256 32.5c2.8.7 5.4 2.1 7.4 4.2l83.9 83.9c2 2 3.5 4.6 4.2 7.4H256zM352 464c0 8.8-7.2 16-16 16H48c-8.8 0-16-7.2-16-16V48c0-8.8 7.2-16 16-16h79.7v32h32V32H224v104c0 13.3 10.7 24 24 24h104zM192 192h-32v32h32zm0-64h-32v32h32z\\\"/></svg>\";","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 384 512\\\"><path d=\\\"M369.9 97.9L286 14C277 5 264.8-.1 252.1-.1H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V131.9c0-12.7-5.1-25-14.1-34zm-22.6 22.7c2.1 2.1 3.5 4.6 4.2 7.4H256V32.5c2.8.7 5.3 2.1 7.4 4.2l83.9 83.9zM336 480H48c-8.8 0-16-7.2-16-16V48c0-8.8 7.2-16 16-16h176v104c0 13.3 10.7 24 24 24h104v304c0 8.8-7.2 16-16 16zm-77.6-66.6c38.5-26 61.6-69.3 61.6-115.7 0-24.7-6.5-48.9-18.9-70.1-12-20.6-29.1-37.8-49.6-50-7.1-4.2-16.3-1.9-20.6 5.2-4.2 7.1-1.9 16.3 5.2 20.6 33.1 19.7 53.7 55.8 53.7 94.3 0 36.5-18.1 70.4-48.3 90.9-6.9 4.6-8.7 14-4 20.8 2.9 4.3 7.6 6.6 12.4 6.6 3.1 0 6-.8 8.5-2.6zm-26.6-38.3c26-17.3 41.5-46.2 41.5-77.4 0-32.9-17.7-63.7-46.2-80.3-7.2-4.2-16.3-1.7-20.5 5.4-4.2 7.2-1.7 16.3 5.4 20.5 19.3 11.2 31.3 32 31.3 54.3 0 21.1-10.5 40.7-28.1 52.4-6.9 4.6-8.8 13.9-4.2 20.8 2.9 4.4 7.7 6.7 12.5 6.7 2.8.1 5.7-.7 8.3-2.4zm-27-38.2c13.7-8.5 21.8-23.1 21.8-39.2 0-17-9.3-32.5-24.2-40.6-7.3-3.9-16.4-1.2-20.3 6.1-3.9 7.3-1.2 16.4 6.1 20.3 5.2 2.8 8.5 8.3 8.5 14.2 0 5.6-2.9 10.8-7.6 13.7-7 4.4-9.2 13.6-4.8 20.7 2.8 4.6 7.7 7.1 12.8 7.1 2.5 0 5.2-.7 7.7-2.3zM138 266.7v74.7L112 322H94v-36h18l26-19.3m17.9-50.7c-2.9 0-6 1.1-8.4 3.5L104 256H76c-6.6 0-12 5.4-12 12v72c0 6.6 5.4 12 12 12h28l43.5 36.5c2.4 2.4 5.4 3.5 8.4 3.5 6.2 0 12.1-4.8 12.1-12V228c0-7.2-5.9-12-12.1-12z\\\"/></svg>\";","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 384 512\\\"><path d=\\\"M369.941 97.941l-83.882-83.882A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v416c0 26.51 21.49 48 48 48h288c26.51 0 48-21.49 48-48V131.882a48 48 0 0 0-14.059-33.941zm-22.627 22.628a15.89 15.89 0 0 1 4.195 7.431H256V32.491a15.88 15.88 0 0 1 7.431 4.195l83.883 83.883zM336 480H48c-8.837 0-16-7.163-16-16V48c0-8.837 7.163-16 16-16h176v104c0 13.255 10.745 24 24 24h104v304c0 8.837-7.163 16-16 16zm-161.471-67.404l-25.928-7.527a5.1 5.1 0 0 1-3.476-6.32l58.027-199.869a5.1 5.1 0 0 1 6.32-3.476l25.927 7.527a5.1 5.1 0 0 1 3.476 6.32L180.849 409.12a5.1 5.1 0 0 1-6.32 3.476zm-48.446-47.674l18.492-19.724a5.101 5.101 0 0 0-.351-7.317L105.725 304l38.498-33.881a5.1 5.1 0 0 0 .351-7.317l-18.492-19.724a5.1 5.1 0 0 0-7.209-.233L57.61 300.279a5.1 5.1 0 0 0 0 7.441l61.263 57.434a5.1 5.1 0 0 0 7.21-.232zm139.043.232l61.262-57.434a5.1 5.1 0 0 0 0-7.441l-61.262-57.434a5.1 5.1 0 0 0-7.209.233l-18.492 19.724a5.101 5.101 0 0 0 .351 7.317L278.275 304l-38.499 33.881a5.1 5.1 0 0 0-.351 7.317l18.492 19.724a5.1 5.1 0 0 0 7.209.232z\\\"/></svg>\";","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 384 512\\\"><path d=\\\"M369.9 97.9L286 14C277 5 264.8-.1 252.1-.1H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V131.9c0-12.7-5.1-25-14.1-34zm-22.6 22.7c2.1 2.1 3.5 4.6 4.2 7.4H256V32.5c2.8.7 5.3 2.1 7.4 4.2l83.9 83.9zM336 480H48c-8.8 0-16-7.2-16-16V48c0-8.8 7.2-16 16-16h176v104c0 13.3 10.7 24 24 24h104v304c0 8.8-7.2 16-16 16zM211.7 308l50.5-81.8c4.8-8-.9-18.2-10.3-18.2h-4.1c-4.1 0-7.9 2.1-10.1 5.5-31 48.5-36.4 53.5-45.7 74.5-17.2-32.2-8.4-16-45.8-74.5-2.2-3.4-6-5.5-10.1-5.5H132c-9.4 0-15.1 10.3-10.2 18.2L173 308l-59.1 89.5c-5.1 8 .6 18.5 10.1 18.5h3.5c4.1 0 7.9-2.1 10.1-5.5 37.2-58 45.3-62.5 54.4-82.5 31.5 56.7 44.3 67.2 54.4 82.6 2.2 3.4 6 5.4 10 5.4h3.6c9.5 0 15.2-10.4 10.1-18.4L211.7 308z\\\"/></svg>\";","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 384 512\\\"><path d=\\\"M159 336l-39.5-39.5c-4.7-4.7-12.3-4.7-17 0l-39 39L63 448h256V304l-55.5-55.5c-4.7-4.7-12.3-4.7-17 0L159 336zm96-50.7l32 32V416H95.1l.3-67.2 15.6-15.6 48 48c20.3-20.3 77.7-77.6 96-95.9zM127 256c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm0-96c17.6 0 32 14.4 32 32s-14.4 32-32 32-32-14.4-32-32 14.4-32 32-32zm242.9-62.1L286 14C277 5 264.8-.1 252.1-.1H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V131.9c0-12.7-5.1-25-14.1-34zM256 32.5c2.8.7 5.3 2.1 7.4 4.2l83.9 83.9c2.1 2.1 3.5 4.6 4.2 7.4H256V32.5zM352 464c0 8.8-7.2 16-16 16H48c-8.8 0-16-7.2-16-16V48c0-8.8 7.2-16 16-16h176v104c0 13.3 10.7 24 24 24h104v304z\\\"/></svg>\";","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 384 512\\\"><path d=\\\"M369.9 97.9L286 14C277 5 264.8-.1 252.1-.1H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V131.9c0-12.7-5.1-25-14.1-34zm-22.6 22.7c2.1 2.1 3.5 4.6 4.2 7.4H256V32.5c2.8.7 5.3 2.1 7.4 4.2l83.9 83.9zM336 480H48c-8.8 0-16-7.2-16-16V48c0-8.8 7.2-16 16-16h176v104c0 13.3 10.7 24 24 24h104v304c0 8.8-7.2 16-16 16zm-22-171.2c-13.5-13.3-55-9.2-73.7-6.7-21.2-12.8-35.2-30.4-45.1-56.6 4.3-18 12-47.2 6.4-64.9-4.4-28.1-39.7-24.7-44.6-6.8-5 18.3-.3 44.4 8.4 77.8-11.9 28.4-29.7 66.9-42.1 88.6-20.8 10.7-54.1 29.3-58.8 52.4-3.5 16.8 22.9 39.4 53.1 6.4 9.1-9.9 19.3-24.8 31.3-45.5 26.7-8.8 56.1-19.8 82-24 21.9 12 47.6 19.9 64.6 19.9 27.7.1 28.9-30.2 18.5-40.6zm-229.2 89c5.9-15.9 28.6-34.4 35.5-40.8-22.1 35.3-35.5 41.5-35.5 40.8zM180 175.5c8.7 0 7.8 37.5 2.1 47.6-5.2-16.3-5-47.6-2.1-47.6zm-28.4 159.3c11.3-19.8 21-43.2 28.8-63.7 9.7 17.7 22.1 31.7 35.1 41.5-24.3 4.7-45.4 15.1-63.9 22.2zm153.4-5.9s-5.8 7-43.5-9.1c41-3 47.7 6.4 43.5 9.1z\\\"/></svg>\";","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 384 512\\\"><path d=\\\"M369.9 97.9L286 14C277 5 264.8-.1 252.1-.1H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V131.9c0-12.7-5.1-25-14.1-34zm-22.6 22.7c2.1 2.1 3.5 4.6 4.2 7.4H256V32.5c2.8.7 5.3 2.1 7.4 4.2l83.9 83.9zM336 480H48c-8.8 0-16-7.2-16-16V48c0-8.8 7.2-16 16-16h176v104c0 13.3 10.7 24 24 24h104v304c0 8.8-7.2 16-16 16zM204.3 208H140c-6.6 0-12 5.4-12 12v184c0 6.6 5.4 12 12 12h8c6.6 0 12-5.4 12-12v-60.4h44.3c38.7 0 67.7-27.3 67.7-69 0-38.6-23.8-66.6-67.7-66.6zm26 97.7c-7.5 7.6-17.8 11.4-31 11.4H160V233h39.7c12.9 0 23.1 3.7 30.6 11.1 15.3 15.1 15 46.5 0 61.6z\\\"/></svg>\";","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 384 512\\\"><path d=\\\"M369.9 97.9L286 14C277 5 264.8-.1 252.1-.1H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V131.9c0-12.7-5.1-25-14.1-34zm-22.6 22.7c2.1 2.1 3.5 4.6 4.2 7.4H256V32.5c2.8.7 5.3 2.1 7.4 4.2l83.9 83.9zM336 480H48c-8.8 0-16-7.2-16-16V48c0-8.8 7.2-16 16-16h176v104c0 13.3 10.7 24 24 24h104v304c0 8.8-7.2 16-16 16zm-48-244v8c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12zm0 64v8c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12zm0 64v8c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12z\\\"/></svg>\";","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 384 512\\\"><path d=\\\"M224 280.593C224 267.01 212.989 256 199.407 256H88.593C75.011 256 64 267.01 64 280.593v110.815C64 404.99 75.011 416 88.593 416h110.814C212.989 416 224 404.99 224 391.407V381l27.971 27.971a23.998 23.998 0 0 0 16.97 7.029H296c13.255 0 24-10.745 24-24V280c0-13.255-10.745-24-24-24h-27.059a24.003 24.003 0 0 0-16.97 7.029L224 291v-10.407zM192 384H96v-96h96v96zm80.255-96H288v96h-15.745L224 342.826v-13.652L272.255 288zm97.686-190.059l-83.883-83.882A47.996 47.996 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v416c0 26.51 21.49 48 48 48h288c26.51 0 48-21.49 48-48V131.882a48 48 0 0 0-14.059-33.941zM256 32.491a15.888 15.888 0 0 1 7.432 4.195l83.882 83.882a15.882 15.882 0 0 1 4.195 7.431H256V32.491zM352 464c0 8.837-7.164 16-16 16H48c-8.836 0-16-7.163-16-16V48c0-8.837 7.164-16 16-16h176v104c0 13.255 10.745 24 24 24h104v304z\\\"/></svg>\";","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 384 512\\\"><path d=\\\"M369.9 97.9L286 14C277 5 264.8-.1 252.1-.1H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V131.9c0-12.7-5.1-25-14.1-34zm-22.6 22.7c2.1 2.1 3.5 4.6 4.2 7.4H256V32.5c2.8.7 5.3 2.1 7.4 4.2l83.9 83.9zM336 480H48c-8.8 0-16-7.2-16-16V48c0-8.8 7.2-16 16-16h176v104c0 13.3 10.7 24 24 24h104v304c0 8.8-7.2 16-16 16zm-53.6-246.5c-6.8 32.8-32.5 139.7-33.4 150.3-5.8-29.1-.7 1.6-41.8-150.9-1.4-5.2-6.2-8.9-11.6-8.9h-6.4c-5.4 0-10.2 3.6-11.6 8.9-38.3 142.3-37.4 140.6-39.4 154.7-4.1-23.9 2.1-2.9-34.4-154.4-1.3-5.4-6.1-9.2-11.7-9.2h-7.2c-7.8 0-13.5 7.3-11.6 14.9 9.5 38 34.5 137.4 42.2 168 1.3 5.3 6.1 9.1 11.6 9.1h17c5.4 0 10.2-3.7 11.6-8.9 34.2-127.7 33.5-123.4 36.7-142.9 6.5 31.1.2 7 36.7 142.9 1.4 5.2 6.2 8.9 11.6 8.9h14c5.5 0 13.7-3.7 15.1-9l42.8-168c1.9-7.6-3.8-15-11.6-15h-6.8c-5.7 0-10.6 4-11.8 9.5z\\\"/></svg>\";","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 512 512\\\"><path d=\\\"M194.74 96l54.63 54.63c6 6 14.14 9.37 22.63 9.37h192c8.84 0 16 7.16 16 16v224c0 8.84-7.16 16-16 16H48c-8.84 0-16-7.16-16-16V112c0-8.84 7.16-16 16-16h146.74M48 64C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V176c0-26.51-21.49-48-48-48H272l-54.63-54.63c-6-6-14.14-9.37-22.63-9.37H48z\\\"/></svg>\";","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 512 512\\\"><path d=\\\"M344 272h-72v-72c0-4.42-3.58-8-8-8h-16c-4.42 0-8 3.58-8 8v72h-72c-4.42 0-8 3.58-8 8v16c0 4.42 3.58 8 8 8h72v72c0 4.42 3.58 8 8 8h16c4.42 0 8-3.58 8-8v-72h72c4.42 0 8-3.58 8-8v-16c0-4.42-3.58-8-8-8zM194.74 96l54.63 54.63c6 6 14.14 9.37 22.63 9.37h192c8.84 0 16 7.16 16 16v224c0 8.84-7.16 16-16 16H48c-8.84 0-16-7.16-16-16V112c0-8.84 7.16-16 16-16h146.74M48 64C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V176c0-26.51-21.49-48-48-48H272l-54.63-54.63c-6-6-14.14-9.37-22.63-9.37H48z\\\"/></svg>\";","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 640 512\\\"><path d=\\\"M608 352h-32v-97.59c0-16.77-13.62-30.41-30.41-30.41H336v-64h48c17.67 0 32-14.33 32-32V32c0-17.67-14.33-32-32-32H256c-17.67 0-32 14.33-32 32v96c0 17.67 14.33 32 32 32h48v64H94.41C77.62 224 64 237.64 64 254.41V352H32c-17.67 0-32 14.33-32 32v96c0 17.67 14.33 32 32 32h96c17.67 0 32-14.33 32-32v-96c0-17.67-14.33-32-32-32H96v-96h208v96h-32c-17.67 0-32 14.33-32 32v96c0 17.67 14.33 32 32 32h96c17.67 0 32-14.33 32-32v-96c0-17.67-14.33-32-32-32h-32v-96h208v96h-32c-17.67 0-32 14.33-32 32v96c0 17.67 14.33 32 32 32h96c17.67 0 32-14.33 32-32v-96c0-17.67-14.33-32-32-32zm-480 32v96H32v-96h96zm240 0v96h-96v-96h96zM256 128V32h128v96H256zm352 352h-96v-96h96v96z\\\"/></svg>\";","import { Pipe, PipeTransform } from '@angular/core';\r\nimport { DomSanitizer } from '@angular/platform-browser';\r\n\r\n@Pipe({ name: 'safeResourceUrl' })\r\nexport class SafeResourceUrlPipe implements PipeTransform {\r\n\r\n  constructor(private sanitizer: DomSanitizer) { }\r\n\r\n  transform(resourceUrl: string) {\r\n    return this.sanitizer.bypassSecurityTrustResourceUrl(resourceUrl);\r\n  }\r\n}\r\n","import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { Observable } from 'rxjs';\r\nimport { EavService } from './eav.service';\r\n\r\nconst webApiAppFilesRoot = 'admin/appfiles/';\r\nexport const webApiAppFilesAll = webApiAppFilesRoot + 'all';\r\nexport const webApiAppFile = webApiAppFilesRoot + 'asset';\r\nexport const webApiAppFileCreate = webApiAppFilesRoot + 'create';\r\n\r\n@Injectable()\r\nexport class AssetsService {\r\n  constructor(private http: HttpClient, private eavService: EavService, private dnnContext: DnnContext) { }\r\n\r\n  getAll(global: boolean) {\r\n    return this.http.get(this.dnnContext.$2sxc.http.apiUrl(webApiAppFilesAll), {\r\n      params: { appId: this.eavService.eavConfig.appId.toString(), global: global.toString(), withSubfolders: 'true' },\r\n    }) as Observable<string[]>;\r\n  }\r\n\r\n  create(path: string, global: boolean) {\r\n    return this.http.post(\r\n      this.dnnContext.$2sxc.http.apiUrl(webApiAppFileCreate), {}, {\r\n      params: { appId: this.eavService.eavConfig.appId.toString(), global: global.toString(), path }\r\n    }) as Observable<boolean>;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\n\r\n@Injectable()\r\nexport class FileTypeService {\r\n\r\n  constructor() { }\r\n\r\n  private defaultIcon = 'file';\r\n  private checkImgRegEx = /(?:([^:\\/?#]+):)?(?:\\/\\/([^\\/?#]*))?([^?#]*\\.(?:jpg|jpeg|gif|png))(?:\\?([^#]*))?(?:#(.*))?/i;\r\n  private customExtensions: { [key: string]: string } = {\r\n    doc: 'file-word',\r\n    docx: 'file-word',\r\n    xls: 'file-excel',\r\n    xlsx: 'file-excel',\r\n    ppt: 'file-powerpoint',\r\n    pptx: 'file-powerpoint',\r\n    pdf: 'file-pdf',\r\n    mp3: 'file-audio',\r\n    avi: 'file-video',\r\n    mpg: 'file-video',\r\n    mpeg: 'file-video',\r\n    mov: 'file-video',\r\n    mp4: 'file-video',\r\n    zip: 'file-archive',\r\n    rar: 'file-archive',\r\n    txt: 'file-text',\r\n    html: 'file-code',\r\n    css: 'file-code',\r\n    xml: 'file-code',\r\n    xsl: 'file-code',\r\n  };\r\n\r\n  private matExtensions: { [key: string]: string } = {\r\n    vcf: 'person',\r\n  };\r\n\r\n  getExtension(filename: string) {\r\n    return filename.substr(filename.lastIndexOf('.') + 1).toLowerCase();\r\n  }\r\n\r\n  getIconClass(filename: string) {\r\n    const ext = this.getExtension(filename);\r\n    return this.matExtensions[ext] || this.customExtensions[ext] || this.defaultIcon;\r\n  }\r\n\r\n  isKnownType(filename: string) {\r\n    return this.matExtensions[this.getExtension(filename)] != null;\r\n  }\r\n\r\n  isImage(filename: string) {\r\n    return this.checkImgRegEx.test(filename);\r\n  }\r\n}\r\n","import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable, OnDestroy } from '@angular/core';\r\nimport { Store } from '@ngrx/store';\r\nimport { Observable, Subject } from 'rxjs';\r\nimport { FormDisabledSet, FormValueSet } from '../../../edit-types';\r\nimport { keyPartOfPage, keyPortalRoot, keyPublishing } from '../../../ng-dialogs/src/app/shared/constants/session.constants';\r\nimport { Context } from '../../../ng-dialogs/src/app/shared/services/context';\r\nimport { EavFormData, EditDialogContext } from '../../eav-item-dialog/multi-item-edit-form/multi-item-edit-form.models';\r\nimport { EavConfig } from '../models/eav-config';\r\nimport { Item } from '../models/eav/item';\r\nimport { SaveResult } from '../models/eav/save-result.model';\r\nimport { VersioningOptions } from '../models/eav/versioning-options';\r\nimport * as fromStore from '../store';\r\nimport * as itemActions from '../store/actions/item.actions';\r\n\r\nexport const webApiEditRoot = 'cms/edit/';\r\n\r\n@Injectable()\r\nexport class EavService implements OnDestroy {\r\n  /**\r\n   * Tells subscribed custom components that they should submit their values,\r\n   * e.g. form is going to be saved and we don't want to miss any values.\r\n   * Custom components run outside Angular zone and we have to wait for their values to update.\r\n   */\r\n  forceConnectorSave$ = new Subject<null>();\r\n  /** Temporary solution to circumvent value not being emitted on language change. Fix language change!  */\r\n  formValueChange$ = new Subject<FormValueSet>();\r\n  /** Temporary solution to circumvent disabled not being emitted on language change. Fix language change!  */\r\n  formDisabledChange$ = new Subject<FormDisabledSet>();\r\n\r\n  eavConfig: EavConfig;\r\n\r\n  constructor(\r\n    private http: HttpClient,\r\n    private store: Store<fromStore.EavState>,\r\n    private dnnContext: DnnContext,\r\n    /** Used to fetch form data and fill up eavConfig. Do not use anywhere else */\r\n    private context: Context,\r\n  ) { }\r\n\r\n  // spm TODO: ngOnDestroy only fires in services provided in component\r\n  ngOnDestroy() {\r\n    this.forceConnectorSave$.complete();\r\n    this.formValueChange$.complete();\r\n    this.formDisabledChange$.complete();\r\n  }\r\n\r\n  /** Create EavConfiguration from sessionStorage */\r\n  setEavConfig(editDialogContext: EditDialogContext) {\r\n    this.eavConfig = {\r\n      zoneId: this.context.zoneId.toString(),\r\n      appId: this.context.appId.toString(),\r\n      appRoot: editDialogContext.App.Url,\r\n      lang: editDialogContext.Language.Current,\r\n      langPri: editDialogContext.Language.Primary,\r\n      langs: editDialogContext.Language.All,\r\n      moduleId: this.context.moduleId.toString(),\r\n      partOfPage: sessionStorage.getItem(keyPartOfPage),\r\n      portalRoot: sessionStorage.getItem(keyPortalRoot),\r\n      tabId: this.context.tabId.toString(),\r\n      systemRoot: window.location.pathname.split('/dist/')[0] + '/',\r\n      versioningOptions: this.getVersioningOptions(\r\n        sessionStorage.getItem(keyPartOfPage) === 'true',\r\n        sessionStorage.getItem(keyPublishing),\r\n      ),\r\n    };\r\n  }\r\n\r\n  fetchFormData(items: string) {\r\n    return this.http.post(this.dnnContext.$2sxc.http.apiUrl(webApiEditRoot + 'load'), items, {\r\n      params: { appId: this.context.appId.toString() }\r\n    }) as Observable<EavFormData>;\r\n  }\r\n\r\n  saveItem(item: Item) {\r\n    this.store.dispatch(new itemActions.SaveItemAttributesValuesAction(item));\r\n  }\r\n\r\n  saveItemSuccess(data: SaveResult) {\r\n    this.store.dispatch(new itemActions.SaveItemAttributesValuesSuccessAction(data));\r\n  }\r\n\r\n  saveItemError(error: any) {\r\n    this.store.dispatch(new itemActions.SaveItemAttributesValuesErrorAction(error));\r\n  }\r\n\r\n  saveFormData(body: string) {\r\n    return this.http.post(this.dnnContext.$2sxc.http.apiUrl(webApiEditRoot + 'save'), body, {\r\n      params: { appId: this.eavConfig.appId.toString(), partOfPage: this.eavConfig.partOfPage }\r\n    }) as Observable<SaveResult>;\r\n  }\r\n\r\n  private getVersioningOptions(partOfPage: boolean, publishing: string): VersioningOptions {\r\n    if (!partOfPage) {\r\n      return { show: true, hide: true, branch: true };\r\n    }\r\n\r\n    const publish = publishing || '';\r\n    switch (publish) {\r\n      case '':\r\n      case 'DraftOptional':\r\n        return { show: true, hide: true, branch: true };\r\n      case 'DraftRequired':\r\n        return { branch: true, hide: true };\r\n      default: {\r\n        console.error('invalid versioning requiremenets: ' + publish);\r\n        return {};\r\n      }\r\n    }\r\n  }\r\n\r\n}\r\n","import { ActivatedRoute } from '@angular/router';\r\n\r\nexport function calculatePathFromRoot(route: ActivatedRoute) {\r\n  let lastChild = route;\r\n  while (lastChild.firstChild) {\r\n    lastChild = lastChild.firstChild;\r\n  }\r\n  let pathFromRoot = '';\r\n  for (const path of lastChild.snapshot.pathFromRoot) {\r\n    if (path.url.length <= 0) { continue; }\r\n    for (const urlSegment of path.url) {\r\n      if (!urlSegment.path) { continue; }\r\n      pathFromRoot += '/' + urlSegment.path;\r\n    }\r\n  }\r\n  return pathFromRoot;\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { UrlHelper } from '../helpers/url-helper';\r\nimport { EavService } from './eav.service';\r\n\r\ndeclare const sxcVersion: string;\r\n\r\nexport const FileTypeConstants = {\r\n  CSS: '.css',\r\n  JS: '.js',\r\n};\r\n\r\nexport interface LoadFile {\r\n  path: string;\r\n  type: string;\r\n  loaded: boolean;\r\n  domEl: HTMLLinkElement | HTMLScriptElement;\r\n}\r\n\r\n@Injectable()\r\nexport class ScriptsLoaderService {\r\n  private loadedFiles: LoadFile[] = [];\r\n\r\n  constructor(private eavService: EavService) { }\r\n\r\n  /** Loads CSS and JS files in order (CSS first) and calls callback function when finished */\r\n  public load(scripts: string[], callback: () => any) {\r\n    const sortedFiles = this.sortByType(scripts);\r\n    this.insertToDom(sortedFiles, callback, 0); // async, called again and again after each script is loaded\r\n  }\r\n\r\n  private sortByType(scripts: string[]): LoadFile[] {\r\n    const cssFiles: LoadFile[] = [];\r\n    const jsFiles: LoadFile[] = [];\r\n    scripts.forEach(script => {\r\n      const file: LoadFile = {\r\n        path: this.resolveSpecialPaths(script),\r\n        type: null,\r\n        loaded: false,\r\n        domEl: null\r\n      };\r\n      if (file.path.endsWith(FileTypeConstants.CSS)) {\r\n        file.type = FileTypeConstants.CSS;\r\n        cssFiles.push(file);\r\n      } else if (file.path.endsWith(FileTypeConstants.JS)) {\r\n        file.type = FileTypeConstants.JS;\r\n        jsFiles.push(file);\r\n      }\r\n    });\r\n    return cssFiles.concat(jsFiles);\r\n  }\r\n\r\n  private insertToDom(files: LoadFile[], callback: () => any, increment: number) {\r\n    const file = files[increment];\r\n    increment++;\r\n    if (!file) {\r\n      callback();\r\n      return;\r\n    }\r\n    file.path = file.path + '?sxcver=' + sxcVersion; // break cache\r\n\r\n    const existing = this.loadedFiles.find(loadedFile => loadedFile.path === file.path);\r\n    if (existing) {\r\n      if (existing.loaded) {\r\n        this.insertToDom(files, callback, increment);\r\n      } else {\r\n        const _listener = () => {\r\n          file.loaded = true;\r\n          this.insertToDom(files, callback, increment);\r\n          existing.domEl.removeEventListener('load', _listener);\r\n          existing.domEl.removeEventListener('error', _listener);\r\n        };\r\n        existing.domEl.addEventListener('load', _listener);\r\n        existing.domEl.addEventListener('error', _listener);\r\n      }\r\n    } else {\r\n      if (file.type === FileTypeConstants.CSS) {\r\n        file.domEl = document.createElement('link');\r\n        file.domEl.rel = 'stylesheet';\r\n        file.domEl.href = file.path;\r\n      } else if (file.type === FileTypeConstants.JS) {\r\n        file.domEl = document.createElement('script');\r\n        file.domEl.type = 'module';\r\n        file.domEl.src = file.path;\r\n      }\r\n\r\n      const _listener = () => {\r\n        file.loaded = true;\r\n        this.insertToDom(files, callback, increment);\r\n        file.domEl.removeEventListener('load', _listener);\r\n        file.domEl.removeEventListener('error', _listener);\r\n      };\r\n      file.domEl.addEventListener('load', _listener);\r\n      file.domEl.addEventListener('error', _listener);\r\n\r\n      document.querySelector('head').appendChild(file.domEl);\r\n      this.loadedFiles.push(file);\r\n    }\r\n  }\r\n\r\n  private resolveSpecialPaths(url: string) {\r\n    return url.replace(/\\[System:Path\\]/i, UrlHelper.getUrlPrefix('system', this.eavService.eavConfig))\r\n      .replace(/\\[Zone:Path\\]/i, UrlHelper.getUrlPrefix('zone', this.eavService.eavConfig))\r\n      .replace(/\\[App:Path\\]/i, UrlHelper.getUrlPrefix('app', this.eavService.eavConfig));\r\n  }\r\n}\r\n","import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { Context } from 'projects/ng-dialogs/src/app/shared/services/context';\r\nimport { Observable } from 'rxjs';\r\nimport { filter, share, switchMap } from 'rxjs/operators';\r\nimport { EntityInfo } from '../models/eav/entity-info';\r\nimport { EavService, webApiEditRoot } from './eav.service';\r\n\r\nexport const webApiEntityRoot = 'admin/entity/';\r\nexport const webApiEntityList = 'admin/entity/list';\r\n\r\n@Injectable()\r\nexport class EntityService {\r\n  constructor(\r\n    private http: HttpClient,\r\n    private eavService: EavService,\r\n    private context: Context,\r\n    private dnnContext: DnnContext,\r\n  ) { }\r\n\r\n  getAvailableEntities(filterText: string, contentTypeName: string) {\r\n    // eavConfig for edit ui and context for other calls\r\n    const context = this.eavService.eavConfig != null ? this.eavService.eavConfig : this.context;\r\n    return this.http.post<EntityInfo[]>(this.dnnContext.$2sxc.http.apiUrl(webApiEditRoot + 'EntityPicker'), filterText, {\r\n      params: { contentTypeName, appId: context.appId.toString() },\r\n    });\r\n  }\r\n\r\n  // Experimental 2dm\r\n  reactiveEntities(params: Observable<{ contentTypeName: string; filter: string }>) {\r\n    return params.pipe(\r\n      filter(p => p != null),\r\n      switchMap(p => this.getAvailableEntities(p.filter, p.contentTypeName).pipe(share())),\r\n    );\r\n  }\r\n\r\n  delete(contentType: string, entityId: string, force: boolean) {\r\n    return this.http.delete(this.dnnContext.$2sxc.http.apiUrl(webApiEntityRoot + 'delete'), {\r\n      params: { contentType, id: entityId, appId: this.eavService.eavConfig.appId.toString(), force: force.toString() },\r\n    }) as Observable<null>;\r\n  }\r\n}\r\n","import { Action } from '@ngrx/store';\r\nimport { Item } from '../../models/eav/item';\r\nimport { SaveResult } from '../../models/eav/save-result.model';\r\n\r\n// Item Attributes\r\nexport const SAVE_ITEM_ATTRIBUTES_VALUES = '[Item] SAVE_ITEM_ATTRIBUTES_VALUES';\r\nexport const SAVE_ITEM_ATTRIBUTES_VALUES_SUCCESS = '[Item] SAVE_ITEM_ATTRIBUTES_VALUES_SUCCESS';\r\nexport const SAVE_ITEM_ATTRIBUTES_VALUES_ERROR = '[Item] SAVE_ITEM_ATTRIBUTES_VALUES_ERROR';\r\n\r\n/** Save (submit) */\r\nexport class SaveItemAttributesValuesAction implements Action {\r\n  readonly type = SAVE_ITEM_ATTRIBUTES_VALUES;\r\n  constructor(public item: Item) { }\r\n}\r\n\r\nexport class SaveItemAttributesValuesSuccessAction implements Action {\r\n  readonly type = SAVE_ITEM_ATTRIBUTES_VALUES_SUCCESS;\r\n  constructor(public data: SaveResult) { }\r\n}\r\n\r\nexport class SaveItemAttributesValuesErrorAction implements Action {\r\n  readonly type = SAVE_ITEM_ATTRIBUTES_VALUES_ERROR;\r\n  constructor(public error: any) { }\r\n}\r\n\r\nexport type Actions\r\n  = SaveItemAttributesValuesAction\r\n  | SaveItemAttributesValuesSuccessAction\r\n  | SaveItemAttributesValuesErrorAction;\r\n","import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { Observable } from 'rxjs';\r\nimport { QueryStreams } from '../../eav-material-controls/input-types/entity/entity-query/entity-query.models';\r\n\r\n@Injectable()\r\nexport class QueryService {\r\n  constructor(private http: HttpClient, private dnnContext: DnnContext) { }\r\n\r\n  getAvailableEntities(queryUrl: string, includeGuid: boolean, params: string) {\r\n    return this.http.get(\r\n      this.dnnContext.$2sxc.http.apiUrl(`app/auto/query/${queryUrl}?includeGuid=${includeGuid}${params ? `&${params}` : ''}`)\r\n    ) as Observable<QueryStreams>;\r\n  }\r\n}\r\n","import { ChangeDetectionStrategy, Component, Inject, OnInit } from '@angular/core';\r\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\r\nimport { EavService } from '../../../shared/services/eav.service';\r\nimport { DnnBridgeDialogData } from './dnn-bridge.models';\r\n\r\n@Component({\r\n  selector: 'app-dnn-bridge',\r\n  templateUrl: './dnn-bridge.component.html',\r\n  styleUrls: ['./dnn-bridge.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class DnnBridgeComponent implements OnInit {\r\n  iframeSrc: string;\r\n\r\n  constructor(\r\n    @Inject(MAT_DIALOG_DATA) private dialogData: DnnBridgeDialogData,\r\n    private eavService: EavService,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    const connector = this.dialogData.connector;\r\n\r\n    let iframeSrc = this.eavService.eavConfig.portalRoot + 'Default.aspx'\r\n      + '?tabid=' + this.eavService.eavConfig.tabId\r\n      + '&ctl=webformsbridge'\r\n      + '&mid=' + this.eavService.eavConfig.moduleId\r\n      + '&dnnprintmode=true'\r\n      + '&SkinSrc=%5bG%5dSkins%2f_default%2fNo+Skin'\r\n      + '&ContainerSrc=%5bG%5dContainers%2f_default%2fNo+Container'\r\n      + '&type=' + connector.dialogType;\r\n\r\n    const paramKeys = Object.keys(connector.params);\r\n    for (const key of paramKeys) {\r\n      const value: string = (connector.params as any)[key];\r\n      if (value == null || value === '') { continue; }\r\n      iframeSrc += `&${key}=${encodeURIComponent(value)}`;\r\n    }\r\n\r\n    this.iframeSrc = iframeSrc;\r\n  }\r\n\r\n  iframeLoaded(event: Event) {\r\n    const iframe = event.target as HTMLIFrameElement;\r\n    const w: any = iframe.contentWindow || iframe;\r\n    if (!w.connectBridge) {\r\n      return alert(`Can't connect to the dialog - you are probably running a new DNN(v.8 +) and didn't activate the old Telerik components. Please install these in the host > extensions to get this to work`);\r\n    }\r\n    w.connectBridge(this.dialogData.connector);\r\n  }\r\n\r\n}\r\n","<div>\r\n\t<div class=\"modal-header\">\r\n\t\t<h3 class=\"modal-title\" translate=\"Fields.Hyperlink.PagePicker.Title\"></h3>\r\n\t</div>\r\n\t<div class=\"modal-body\" style=\"height:370px; width:600px\">\r\n\t\t<iframe style=\"width:100%; height: 350px; border: 0;\" [src]=\"iframeSrc | safeResourceUrl\"\r\n\t\t\t(load)=\"iframeLoaded($event)\">\r\n\t\t</iframe>\r\n\t</div>\r\n\t<div class=\"modal-footer\"></div>\r\n</div>\r\n","import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { MatDialog, MatDialogRef } from '@angular/material/dialog';\r\nimport { Observable } from 'rxjs';\r\nimport { DnnBridgeComponent } from '../../eav-material-controls/input-types/dnn-bridge/dnn-bridge.component';\r\nimport { DnnBridgeConnectorParams, DnnBridgeDialogData, DnnBridgeType } from '../../eav-material-controls/input-types/dnn-bridge/dnn-bridge.models';\r\nimport { EavService } from './eav.service';\r\n\r\n@Injectable()\r\nexport class DnnBridgeService {\r\n  constructor(private http: HttpClient, private dnnContext: DnnContext, private eavService: EavService, private dialog: MatDialog) { }\r\n\r\n  open(dialogType: DnnBridgeType, params: DnnBridgeConnectorParams, callback: (value: any) => void) {\r\n    let dialogRef: MatDialogRef<DnnBridgeComponent>;\r\n\r\n    const data: DnnBridgeDialogData = {\r\n      connector: {\r\n        params,\r\n        valueChanged: (value: any) => {\r\n          dialogRef.close();\r\n          callback(value);\r\n        },\r\n        dialogType,\r\n      },\r\n    };\r\n    dialogRef = this.dialog.open(DnnBridgeComponent, {\r\n      data,\r\n      width: '650px',\r\n    });\r\n    return dialogRef;\r\n  }\r\n\r\n  getUrlOfId(url: string, contentType: string, guid: string, field: string) {\r\n    return this.http.get(this.dnnContext.$2sxc.http.apiUrl('dnn/Hyperlink/ResolveHyperlink'), {\r\n      params: {\r\n        hyperlink: url,\r\n        ...(guid && { guid }),\r\n        ...(contentType && { contentType }),\r\n        ...(field && { field }),\r\n        appid: this.eavService.eavConfig.appId.toString(),\r\n      }\r\n    }) as Observable<string>;\r\n  }\r\n}\r\n","import { NgZone } from '@angular/core';\r\nimport { ElementEventListener } from '../../../shared/element-event-listener.model';\r\ndeclare const draggingClass: string;\r\ndeclare const windowBodyTimeouts: number[];\r\n\r\nexport class DropzoneDraggingHelper {\r\n  private eventListeners: ElementEventListener[] = [];\r\n\r\n  constructor(private zone: NgZone) { }\r\n\r\n  /** Starts listening for dragover and drop events on a given element */\r\n  attach(htmlEl: HTMLElement) {\r\n    this.zone.runOutsideAngular(() => {\r\n      htmlEl.addEventListener('dragover', dragoverListener, { passive: true });\r\n      htmlEl.addEventListener('drop', dropListener, { passive: true });\r\n\r\n      this.eventListeners.push(\r\n        { element: htmlEl, type: 'dragover', listener: dragoverListener },\r\n        { element: htmlEl, type: 'drop', listener: dropListener },\r\n      );\r\n\r\n      function dragoverListener() {\r\n        clearTimeouts(windowBodyTimeouts); // clear timeouts from global array of timeouts which clear draggingClass from body\r\n        document.body.classList.add(draggingClass);\r\n      }\r\n      function dropListener() {\r\n        document.body.classList.remove(draggingClass);\r\n      }\r\n      function clearTimeouts(timeoutsArray: number[]) {\r\n        for (const timeout of timeoutsArray) {\r\n          clearTimeout(timeout);\r\n        }\r\n        timeoutsArray.splice(0, timeoutsArray.length);\r\n      }\r\n    });\r\n  }\r\n\r\n  /** Removes event listeners from registered elements */\r\n  detach() {\r\n    this.zone.runOutsideAngular(() => {\r\n      this.eventListeners.forEach(eventListener => {\r\n        const element = eventListener.element;\r\n        const type = eventListener.type;\r\n        const listener = eventListener.listener;\r\n        element.removeEventListener(type, listener);\r\n      });\r\n    });\r\n  }\r\n}\r\n","import { Injectable, OnDestroy } from '@angular/core';\r\nimport { EntityCollectionServiceBase, EntityCollectionServiceElementsFactory } from '@ngrx/data';\r\nimport { Subject } from 'rxjs';\r\nimport { distinctUntilChanged, map } from 'rxjs/operators';\r\nimport { LanguageInstance } from '../../models/eav/language-instance';\r\n\r\n@Injectable({ providedIn: 'root' })\r\nexport class LanguageInstanceService extends EntityCollectionServiceBase<LanguageInstance> implements OnDestroy {\r\n  private localizationWrapperMenuChangeSource = new Subject<string>();\r\n  localizationWrapperMenuChange$ = this.localizationWrapperMenuChangeSource.asObservable();\r\n\r\n  constructor(serviceElementsFactory: EntityCollectionServiceElementsFactory) {\r\n    super('LanguageInstance', serviceElementsFactory);\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.localizationWrapperMenuChangeSource.complete();\r\n  }\r\n\r\n  /** Add language instance to ngrx-data */\r\n  addLanguageInstance(formId: number, currentLanguage: string, defaultLanguage: string, uiLanguage: string, hideHeader: boolean) {\r\n    const languageInstance: LanguageInstance = { formId, currentLanguage, defaultLanguage, uiLanguage, hideHeader };\r\n    this.addOneToCache(languageInstance);\r\n  }\r\n\r\n  /** Get current language observable for the form with given formId */\r\n  getCurrentLanguage(formId: number) {\r\n    return this.entities$.pipe(\r\n      map(languageInstances => languageInstances.find(langInstance => langInstance.formId === formId)?.currentLanguage),\r\n      distinctUntilChanged((oldLang, newLang) => oldLang === newLang),\r\n    );\r\n  }\r\n\r\n  /** Get default language observable for the form with given formId */\r\n  getDefaultLanguage(formId: number) {\r\n    return this.entities$.pipe(\r\n      map(languageInstances => languageInstances.find(langInstance => langInstance.formId === formId)?.defaultLanguage),\r\n      distinctUntilChanged((oldLang, newLang) => oldLang === newLang),\r\n    );\r\n  }\r\n\r\n  /** Get hideHeader for the form. Fix for safari and mobile browsers */\r\n  getHideHeader(formId: number) {\r\n    return this.entities$.pipe(\r\n      map(languageInstances => languageInstances.find(langInstance => langInstance.formId === formId)?.hideHeader),\r\n      distinctUntilChanged((oldHide, newHide) => oldHide === newHide),\r\n    );\r\n  }\r\n\r\n  /** Updated currentLanguage for a form with given formId. If form with given id isn't found, nothing is updated */\r\n  updateCurrentLanguage(formId: number, newLanguage: string) {\r\n    const languageInstance: Partial<LanguageInstance> = { formId, currentLanguage: newLanguage };\r\n    this.updateOneInCache(languageInstance);\r\n  }\r\n\r\n  /** Update hideHeader for the form. Fix for safari and mobile browsers */\r\n  updateHideHeader(formId: number, hideHeader: boolean) {\r\n    const languageInstance: Partial<LanguageInstance> = { formId, hideHeader };\r\n    this.updateOneInCache(languageInstance);\r\n  }\r\n\r\n  removeLanguageInstance(formId: number) {\r\n    this.removeOneFromCache(formId);\r\n  }\r\n\r\n  /** Trigger info message change on all form controls */\r\n  triggerLocalizationWrapperMenuChange() {\r\n    this.localizationWrapperMenuChangeSource.next();\r\n  }\r\n}\r\n"],"sourceRoot":"webpack:///"}