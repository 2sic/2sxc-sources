"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["default-projects_eav-ui_src_app_dev-rest_query_query_component_ts"],{3791:(dt,j,a)=>{a.r(j),a.d(j,{DevRestQueryComponent:()=>ot});var Q=a(87945),S=a(84175),N=a(31016),C=a(93840),T=a(59791),x=a(38223),b=a(29658),F=a(75797),f=a(19999),g=a(70271),I=a(71870),l=a(14079),R=a(12938),G=a(75445),w=a(4096),M=a(50052),U=a(34601),A=a(68873),V=a(91091),X=a(55630),B=a(1708),P=a(22422),Y=a(53966),k=a(16768),H=a(61426),L=a(37580),t=a(99293);let z=(()=>{class n{constructor(){this.data=(0,L.hFB)(),this.scenarios=l.vm}ngOnInit(){}static#t=this.\u0275fac=function(s){return new(s||n)};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-dev-query-introduction"]],inputs:{data:[1,"data"]},decls:12,vars:0,consts:[["href","https://docs.2sxc.org/index.html","target","_blank"],["href","https://docs.2sxc.org/basics/query/index.html","target","_blank"],["href","https://docs.2sxc.org/web-api/query-rest-web-api.html","target","_blank"]],template:function(s,i){1&s&&(t.j41(0,"p"),t.EFF(1," To learn more about queries you may want to read these "),t.j41(2,"a",0),t.EFF(3,"docs"),t.k0s(),t.EFF(4,":\n"),t.k0s(),t.j41(5,"ul")(6,"li")(7,"a",1),t.EFF(8,"Queries in 2sxc"),t.k0s()(),t.j41(9,"li")(10,"a",2),t.EFF(11,"Query REST API"),t.k0s()()())},encapsulation:2})}return n})();function J(n,r,e,s,i,d,o){const m="/"!==s[0]&&!s.startsWith("http");o&&o.length&&"?"!==o[0]&&(o="?"+o);const h=m?`${o}${o?"&":"?"}PageId=${e.tabId}&ModuleId=${e.moduleId}`:"",v=n.http.apiUrl(s)+h,u=s+o,c=`${s}/${d??"Default"}${o}`;return[new l.b2(m,"GET",u,"read all query streams","Read list of all items",!0,E(r,u,e),v),new l.b2(m,"GET",c,"read only Stream Default","Read list of all items",!0,E(r,c,e),v)]}function E(n,r,e,s){const i=e.moduleId,d="/"!==r[0],o=[],m=`${r}?PageId=${e.tabId}&ModuleId=${i}`;n.inSameContext&&o.push(new l.EI("Example with global $2sxc and event-context","This example finds the context information from the HTML where an action started.",`\n<button onclick="$2sxc(this).webApi.get('${r}').then(data => console.log(data))">\n  get it\n</button>`,!1,[l.Ms])),n.in2sxc&&o.push(new l.EI(`Example with global $2sxc and a Module-Id ${i}`,"This is how you get the context when your code doesn't start with a DOM context, so you need the moduleId.",`\n// get the sxc-controller for this module\nvar sxc = $2sxc(${i});\n// now get the data in the promise\nsxc.webApi.get('${r}')\n  .then(data => {\n    console.log(data)\n  });`,!1,[l.Ms]),new l.EI("Same example as one-liner","This is the same as above, but as a one-liner so you can run it directly in the F12 console right now.",`$2sxc(${i}).webApi.get('${r}').then(data => console.log('just got:', data));`,!0)),n.in2sxc&&n.inSameContext&&o.push(new l.EI("Example where you get the Module-Id from Razor","This example doesn't use a fixed moduleId but let's the Razor add the current moduleId when the page is rendered.",`\n// this will be replaced on the server with the ID\nvar moduleId = @Dnn.Module.ModuleID;\nvar sxc = $2sxc(moduleId);\nvar promise = sxc.webApi.get('${r}');`,!1,[l.Ms]));const h=d?`$2sxc.http.apiUrl('${r}')`:`'${r}'`,v=d?`$2sxc.http.apiUrl('${m}')`:`'${m}'`;return n.inSameSite?(o.push(new l.EI("Using jQuery inside DNN","This example uses jQuery instead of the $2sxc to do the AJAX call.\n      It shows you how to resolve the virtual path for use in other ways.",`\nvar endpoint = ${h};\n$.ajax({\n  url:endpoint,\n  beforeSend: $.dnnSF(${i}).setModuleHeaders\n}).then(data => {\n  console.log('Got this data:', data);\n})`,!1,[])),o.push(new l.EI("Using jQuery as single-liner","The same example as above, just as single-liner so you can test it directly in the F12 console.\n      This will only work if you're on a DNN page with this module.",`$.ajax({url: ${h}, beforeSend: $.dnnSF(${i}).setModuleHeaders }).then(data => console.log(data))`,!1,[])),o.push(new l.EI("Using jQuery and add Context in URL","This example uses jQuery instead of the $2sxc to do the AJAX call.\n      But instead of using the DNN Services Framework it adds relevant headers to the url.",`\n$.ajax(${v}).then(data => {\n  console.log('Got this data:', data);\n})`,!1,[])),o.push(new l.EI("Using jQuery with url-context as single-liner","The same example as above, just as single-liner so you can test it directly in the F12 console.\n      This will work on a DNN page which has jQuery activated. ",`$.ajax(${v}).then(data => console.log(data))`,!1,[]))):(o.push(new l.EI("Using jQuery in another Site or External","This example uses jQuery and doesn't use $2sxc or the DNN ServicesFramework,\n      because they would be either missing, or give wrong context-headers.",`\n$.ajax('${r}').then(data => {\n  console.log('Got this data:', data);\n})`,!1,[l.Qd])),o.push(new l.EI("Using jQuery with Context in URL","This example uses jQuery and includes a module-context. This is unusual for external access, but may be needed sometime.",`\n$.ajax('${m}').then(data => {\n  console.log('Got this data:', data);\n})`,!1,[l.Qd]))),o}var p=a(44444),O=a(81863),W=a(81955),Z=a(88622),D=a(87698);function K(n,r){if(1&n){const e=t.RV6();t.j41(0,"button",16),t.bIt("click",function(){p.eBV(e);const i=t.XpG(2);return p.Njj(i.closeDialog())}),t.j41(1,"mat-icon"),t.EFF(2,"close"),t.k0s()()}}function _(n,r){1&n&&(t.j41(0,"div",17)(1,"mat-icon"),t.EFF(2,"emoji_objects"),t.k0s(),t.j41(3,"span"),t.EFF(4,"Introduction"),t.k0s()())}function q(n,r){if(1&n&&(t.j41(0,"div",18)(1,"mat-icon"),t.EFF(2,"code_curly"),t.k0s(),t.j41(3,"span"),t.EFF(4),t.k0s()()),2&n){const e=t.XpG();t.Y8G("tippy",(e.scenario.useVirtual?"Virtual ":"Absolute ")+"REST URLs"),t.R7$(4),t.SpI("Call ",e.scenario.useVirtual?"Virtual":"Absolute"," REST URLs")}}function tt(n,r){1&n&&(t.j41(0,"mat-icon"),t.EFF(1,"warning"),t.k0s())}function et(n,r){if(1&n&&(t.j41(0,"div",19)(1,"mat-icon"),t.EFF(2,"person"),t.k0s(),t.j41(3,"span"),t.EFF(4),t.k0s(),t.nVh(5,tt,2,0,"mat-icon"),t.k0s()),2&n){const e=t.XpG();t.R7$(4),t.SpI("Permissions (",e.permissions.length,")"),t.R7$(),t.vxM(e.permissions.length?-1:5)}}function at(n,r){1&n&&(t.j41(0,"div",20)(1,"mat-icon"),t.EFF(2,"perm_device_information"),t.k0s(),t.j41(3,"span"),t.EFF(4,"HTTP headers & \xa0"),t.j41(5,"code"),t.EFF(6,"/auto/"),t.k0s()()())}function nt(n,r){if(1&n){const e=t.RV6();t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.EFF(3,"Using REST with Query:\xa0 "),t.j41(4,"code"),t.EFF(5),t.k0s()(),t.nVh(6,K,3,0,"button",3),t.k0s(),t.j41(7,"div",4),t.nrm(8,"router-outlet"),t.j41(9,"app-selector-with-help",5),t.bIt("valueChange",function(i){p.eBV(e);const d=t.XpG();return p.Njj(d.changeScenario(i))}),t.k0s(),t.j41(10,"mat-tab-group",6)(11,"mat-tab"),t.DNE(12,_,5,0,"div",7),t.nrm(13,"app-dev-query-introduction",8)(14,"app-dev-rest-tab-introduction",8),t.k0s(),t.j41(15,"mat-tab"),t.DNE(16,q,5,2,"div",9),t.nrm(17,"app-dev-rest-tab-examples-intro",8),t.j41(18,"div",10)(19,"mat-form-field",11)(20,"mat-label"),t.EFF(21,"Stream Name(s) to Limit, comma-separated"),t.k0s(),t.j41(22,"input",12),t.bIt("input",function(i){p.eBV(e);const d=t.XpG();return p.Njj(d.updateStreams(i))}),t.k0s()(),t.j41(23,"mat-form-field",11)(24,"mat-label"),t.EFF(25,"Additional Url Parameters"),t.k0s(),t.j41(26,"input",13),t.bIt("input",function(i){p.eBV(e);const d=t.XpG();return p.Njj(d.updateParams(i))}),t.k0s()()(),t.nrm(27,"app-dev-rest-urls-and-code",8),t.k0s(),t.j41(28,"mat-tab"),t.DNE(29,et,6,2,"div",14),t.nrm(30,"app-dev-rest-tab-permissions",8),t.k0s(),t.j41(31,"mat-tab"),t.DNE(32,at,7,0,"div",15),t.nrm(33,"app-dev-rest-tab-headers",8),t.k0s()()()()}if(2&n){const e=r,s=t.XpG();t.R7$(5),t.JRh(e.name),t.R7$(),t.vxM(s.isSideNavContent?-1:6),t.R7$(3),t.Y8G("items",s.scenarios)("valueInput",e.scenario.key),t.R7$(4),t.Y8G("data",e),t.R7$(),t.Y8G("data",e),t.R7$(3),t.Y8G("data",e),t.R7$(5),t.Y8G("value",s.streamNames$.value),t.R7$(4),t.Y8G("value",s.urlParams$.value),t.R7$(),t.Y8G("data",e),t.R7$(3),t.Y8G("data",e),t.R7$(3),t.Y8G("data",e)}}let ot=(()=>{class n extends V.n{#t;constructor(e,s,i,d,o){const m=(0,R.d)(w.Kn);super(e,s,o,i,d,m),this.hostClass="dialog-component",this.urlParams$=new F.t(""),this.streamNames$=new F.t("Default"),this.#t=(0,R.d)(G.xR),this.isSideNavContent=this.router.url.includes(l.N5.routeQuery);const h=(0,f.z)([d.paramMap.pipe((0,g.T)(u=>u.get(l.N5.paramQuery))),this.#t.getAll(M.YX.contentTypes.query).pipe((0,I.u)())]).pipe((0,g.T)(([u,c])=>c.find(y=>y.Guid===u)),(0,I.u)());this.permissions$=this.buildPermissionStream(l.N5.paramQuery);const v=(0,f.z)([h,this.scenario$,this.dialogSettings$]).pipe((0,g.T)(([u,c,y])=>{const $="app/{appname}/query/{queryname}".replace("{queryname}",u.Name).replace("{appname}",c.inSameContext?"auto":encodeURI(y.Context.App.Folder));return this.rootBasedOnScenario($,c)}));this.viewModel$=(0,f.z)([(0,f.z)([h,this.scenario$,this.permissions$]),(0,f.z)([v,this.dialogSettings$]),(0,f.z)([this.streamNames$,this.urlParams$])]).pipe((0,g.T)(([[u,c,y],[$,it],[lt,rt]])=>({...this.buildBaseViewModel(u.Name,u.Guid,it,y,$,c),query:u,apiCalls:J(o.$2sxc,c,e,$,0,lt,rt)})))}updateStreams(e){this.streamNames$.next(e.target.value)}updateParams(e){this.urlParams$.next(e.target.value)}static#e=this.\u0275fac=function(s){return new(s||n)(t.rXU(A.o),t.rXU(O.k),t.rXU(b.Ix),t.rXU(b.nX),t.rXU(W.ob))};static#a=this.\u0275cmp=t.VBU({type:n,selectors:[["app-dev-rest-query"]],hostVars:1,hostBindings:function(s,i){2&s&&t.Avn("className",i.hostClass)},features:[t.Vt3],decls:2,vars:3,consts:[[1,"eav-dialog","eav-no-scrollbar"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog"],[1,"eav-dialog-content"],["label","Choose Scenario",3,"valueChange","items","valueInput"],["dynamicHeight","","color","accent",1,"mat-tab-group-fit-height","mat-tab-group-fancy-scrollbar","default-fonts"],["class","mat-tab-label-box","tippy","Introduction",4,"matTabLabel"],[3,"data"],["class","mat-tab-label-box",3,"tippy",4,"matTabLabel"],[1,"params-form"],["color","accent",1,"eav-mat-form-field"],["matInput","","placeholder","Default",3,"input","value"],["matInput","","placeholder","?id=27",3,"input","value"],["class","mat-tab-label-box","tippy","Permissions",4,"matTabLabel"],["class","mat-tab-label-box","tippy","HTTP headers and auto",4,"matTabLabel"],["mat-icon-button","","tippy","Close dialog",3,"click"],["tippy","Introduction",1,"mat-tab-label-box"],[1,"mat-tab-label-box",3,"tippy"],["tippy","Permissions",1,"mat-tab-label-box"],["tippy","HTTP headers and auto",1,"mat-tab-label-box"]],template:function(s,i){if(1&s&&(t.nVh(0,nt,34,12,"div",0),t.nI1(1,"async")),2&s){let d;t.vxM((d=t.bMT(1,1,i.viewModel$))?0:-1,d)}},dependencies:[S.Hl,Z.M,U.e,C.m_,C.An,b.n3,B.Y,x.RI,x.ES,x.mq,x.T8,z,k.M,P.R,N.M,D.j,D.M,T.fS,T.fg,X.X,H.Q,Y.J,Q.Jj],encapsulation:2})}return n})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/20.00.02/dist/ng-edit/default-projects_eav-ui_src_app_dev-rest_query_query_component_ts.43adb582e1e57f24.js.map