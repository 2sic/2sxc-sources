"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["default-projects_eav-ui_src_app_permissions_permissions_component_ts"],{6663:(M,f,t)=>{t.d(f,{F:()=>l});var g=t(84175),h=t(53777),p=t(81863),d=t(69914),s=t(99293);function D(n,r){if(1&n&&(s.nrm(0,"mat-card-subtitle",0),s.nI1(1,"safeHtml")),2&n){const i=s.XpG();s.Y8G("innerHtml",s.bMT(1,1,i.dialogData.message),s.npT)}}function E(n,r){if(1&n&&s.EFF(0),2&n){const i=s.XpG();s.SpI(" ",i.dialogData.confirmTranslateKey," ")}}function c(n,r){1&n&&s.EFF(0," Delete ")}let l=(()=>{class n{constructor(i,v){this.dialogData=i,this.dialog=v,this.hostClass="dialog-component"}closeDialog(i){this.dialog.close(i)}static#t=this.\u0275fac=function(v){return new(v||n)(s.rXU(p.e),s.rXU(p.k))};static#e=this.\u0275cmp=s.VBU({type:n,selectors:[["app-confirm-delete-dialog"]],hostVars:1,hostBindings:function(v,e){2&v&&s.Avn("className",e.hostClass)},decls:11,vars:6,consts:[[3,"innerHtml"],["align","end"],["matButton","",1,"eav-card-action-button",3,"click"],["mat-button","","cdkFocusInitial","",3,"click","color"]],template:function(v,e){1&v&&(s.j41(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),s.EFF(3),s.k0s(),s.nVh(4,D,2,3,"mat-card-subtitle",0),s.k0s(),s.j41(5,"mat-card-actions",1)(6,"button",2),s.bIt("click",function(){return e.closeDialog()}),s.EFF(7,"Cancel"),s.k0s(),s.j41(8,"button",3),s.bIt("click",function(){return e.closeDialog(!0)}),s.nVh(9,E,1,1)(10,c,1,0),s.k0s()()()),2&v&&(s.R7$(3),s.E5c(" ",e.dialogData.title??"Delete"," ",e.dialogData.entityTitle," (",e.dialogData.entityId,")?"),s.R7$(),s.vxM(e.dialogData.message?4:-1),s.R7$(4),s.Y8G("color",e.dialogData.confirmColor??"warn"),s.R7$(),s.vxM(e.dialogData.confirmTranslateKey?9:10))},dependencies:[h.Hu,h.RN,h.YY,h.MM,h.Lc,h.dh,g.Hl,g.$z,d.$],styles:[".eav-card-action-button[_ngcontent-%COMP%]{margin-left:8px}"]})}return n})()},12458:(M,f,t)=>{t.r(f),t.d(f,{PermissionsComponent:()=>K});var g=t(44444),h=t(84175),p=t(81863),d=t(93840),s=t(29658),D=t(12938),E=t(13620),c=t(6663),l=t(11828),n=t(60251),r=t(50052),i=t(43216),v=t(70334),e=t(67037),a=t(60852),C=t(89061),T=t(34601),o=t(99293),y=t(29968);let R=(()=>{class P{agInit(m){this.params=m}refresh(m){return!0}deletePermission(){this.params.onDelete(this.params.data)}static#t=this.\u0275fac=function(u){return new(u||P)};static#e=this.\u0275cmp=o.VBU({type:P,selectors:[["app-permissions-actions"]],decls:4,vars:0,consts:[[1,"actions-component"],["matRipple","","tippy","Delete",1,"eav-grid-action-button","highlight",3,"click"]],template:function(u,_){1&u&&(o.j41(0,"div",0)(1,"div",1),o.bIt("click",function(){return _.deletePermission()}),o.j41(2,"mat-icon"),o.EFF(3,"delete"),o.k0s()()())},dependencies:[C.M,y.M,d.m_,d.An,T.e],encapsulation:2})}return P})();var U=t(44900),B=t(3347),A=t(88622),W=t(29841);let K=(()=>{class P{#t;#e;#s;#a;#i;constructor(m,u,_,O){this.dialog=m,this.snackBar=u,this.viewContainerRef=_,this.matDialog=O,this.gridOptions=this.buildGridOptions(),this.#t=(0,D.d)(U.K),this.#e=(0,D.d)(a.c),this.#s=(0,E.C)(this.#e.getParams(["targetType","keyType","key"]),I=>({targetType:parseInt(I.targetType,10),keyType:I.keyType,key:I.key})),this.#a=(0,g.vPA)(0),this.permissions=this.#t.getAllLive(this.#s.targetType,this.#s.keyType,this.#s.key,this.#a),this.#i={[r.YX.metadata.language.targetType]:{PermissionType:"language"}}}ngOnInit(){this.#e.doOnDialogClosed(()=>this.#a.update(m=>m+1))}closeDialog(){this.dialog.close()}editPermission(m){let u;u=null==m?{items:[{...v.c.newMetadataFromInfo(r.YX.contentTypes.permissions,v.c.constructMetadataInfo(this.#s.targetType,this.#s.keyType,this.#s.key)),...this.#i[this.#s.targetType]&&{Prefill:this.#i[this.#s.targetType]}}]}:{items:[v.c.editId(m.Id)]};const _=(0,i.s)(u);this.#e.navRelative([`edit/${_}`])}#n(m){this.snackBar.open("Deleting..."),this.matDialog.open(c.F,{autoFocus:!1,data:{entityId:m.Id,entityTitle:m.Title,message:"Delete this permission?"},viewContainerRef:this.viewContainerRef,width:"400px"}).afterClosed().subscribe(O=>{this.snackBar.dismiss(),O&&this.#t.delete(m.Id).subscribe(()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.#a.update(I=>I+1)})})}buildGridOptions(){return{...n.C,columnDefs:[{...l.r.Id,cellRendererParams:l.r.idFieldParamsTooltipGetter()},{...l.r.TextWide,headerName:"Name",field:"Title",sort:"asc",onCellClicked:u=>{this.editPermission(u.data)}},{...l.r.TextWide,field:"Identity"},{...l.r.TextWide,field:"Condition"},{...l.r.Character,field:"Grant"},{...l.r.ActionsPinnedRight1,cellRenderer:R,cellRendererParams:{onDelete:_=>this.#n(_)}}]}}static#o=this.\u0275fac=function(u){return new(u||P)(o.rXU(p.k),o.rXU(B.UG),o.rXU(o.c1b),o.rXU(p.h))};static#r=this.\u0275cmp=o.VBU({type:P,selectors:[["app-permissions"]],decls:15,vars:2,consts:[[1,"eav-dialog","nav-component-wrapper"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"eav-dialog-content","nav-component-wrapper"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","gridOptions"],["align","end"],["mat-fab","","mat-elevation-z24","","tippy","Create a new permission",1,"grid-fab",3,"click"]],template:function(u,_){1&u&&(o.j41(0,"div",0)(1,"div",1)(2,"div",2),o.EFF(3,"Permissions"),o.k0s(),o.j41(4,"button",3),o.bIt("click",function(){return _.closeDialog()}),o.j41(5,"mat-icon"),o.EFF(6,"close"),o.k0s()()(),o.j41(7,"div",4),o.nrm(8,"router-outlet"),o.j41(9,"div",5),o.nrm(10,"ag-grid-angular",6),o.k0s(),o.j41(11,"mat-dialog-actions",7)(12,"button",8),o.bIt("click",function(){return _.editPermission(null)}),o.j41(13,"mat-icon"),o.EFF(14,"add"),o.k0s()()()()()),2&u&&(o.R7$(10),o.Y8G("rowData",_.permissions())("gridOptions",_.gridOptions))},dependencies:[h.Hl,A.M,h.Sr,d.m_,d.An,s.n3,p.M,e.p,W.xs],encapsulation:2})}return P})()},13620:(M,f,t)=>{function g(p,d){return d(p)}function h(p,d){return d(p)}t.d(f,{C:()=>g,z:()=>h})},44900:(M,f,t)=>{t.d(f,{K:()=>c});var g=t(64173),h=t(70271),p=t(12938),d=t(50052),s=t(96817),D=t(80401),E=t(44444);let c=(()=>{class l{constructor(){this.metadataService=(0,p.d)(D.T),this.entitiesService=(0,p.d)(s.R)}getAll(r,i,v){return this.metadataService.getMetadata(r,i,v,d.YX.contentTypes.permissions).pipe((0,h.T)(e=>e.Items))}getAllLive(r,i,v,e){const a=this.metadataService.getMetadataLive(e,r,i,v,d.YX.contentTypes.permissions).value;return(0,g.EW)(()=>a()?.Items??[])}delete(r){return this.entitiesService.delete(d.YX.contentTypes.permissions,r,!1)}static#t=this.\u0275fac=function(i){return new(i||l)};static#e=this.\u0275prov=E.jDH({token:l,factory:l.\u0275fac})}return l})()},60852:(M,f,t)=>{t.d(f,{c:()=>r});var g=t(29658),h=t(51567),p=t(63037),d=t(70271),s=t(5057),D=t(98764),E=t(34435),c=t(4979),l=t(44444);const n={doOnDialogClosed:!0};let r=(()=>{class i extends c.V{constructor(e,a){super(),this.router=e,this.route=a,this.log=(0,E.Tq)({DialogRoutingService:i},n)}get snapshot(){return this.route.snapshot}get url(){return this.router.url}get urlSegments(){return this.router.url.split("/")}getParam(e){return this.route.snapshot.paramMap.get(e)}getParams(e){const a=this.route.snapshot.paramMap;return e.reduce((C,T)=>(C[T]=a.get(T),C),{})}getQueryParam(e){return this.route.snapshot.queryParamMap.get(e)}getQueryParams(e){const a=this.route.snapshot.queryParamMap;return e.reduce((C,T)=>(C[T]=a.get(T),C),{})}state(){return this.router.getCurrentNavigation().extras?.state}doOnDialogClosed(e){const a=this.log.fnIf("doOnDialogClosed");this.subscriptions.add(this.childDialogClosed$().subscribe(C=>(a.a("Dialog closed",{data:C}),e()))),a.end()}doOnDialogClosedWithData(e){const a=this.log.fnIf("doOnDialogClosed");this.subscriptions.add(this.#t().subscribe(({state:C})=>{a.a("Dialog closed",{state:C}),e(C)})),a.end()}urlSubRoute(e){const a=this.router.createUrlTree([e],{relativeTo:this.route});return this.router.serializeUrl(a)}navPath(e,a){return this.router.navigate([e],a)}navRelative(e,a){return this.router.navigate(e,{...a,relativeTo:this.route})}childDialogClosed$(){return this.router.events.pipe((0,h.p)(e=>e instanceof g.wF),(0,p.Z)(!!this.route.snapshot.firstChild),(0,d.T)(()=>!!this.route.snapshot.firstChild),(0,s.J)(),(0,h.p)(([e,a])=>e&&!a))}#t(){return this.router.events.pipe((0,h.p)(e=>e instanceof g.wF),(0,D.M)(e=>{const a=this.log.fn("childDialogClosed$",{event:e,firstChild:this.route.snapshot.firstChild,snapShot:this.route.snapshot,state:this.router.getCurrentNavigation()?.extras.state});a.a("NavigationEnd",{event:e}),a.end()}),(0,p.Z)(!!this.route.snapshot.firstChild),(0,d.T)(()=>({hasChildNow:!!this.route.snapshot.firstChild,state:this.router.getCurrentNavigation()?.extras.state})),(0,s.J)(),(0,h.p)(([e,a])=>e.hasChildNow&&!a.hasChildNow),(0,d.T)(([e,a])=>({hadChildBefore:e.hasChildNow,hasChildNow:a.hasChildNow,state:a.state})))}static#e=this.\u0275fac=function(a){return new(a||i)(l.KVO(g.Ix),l.KVO(g.nX))};static#s=this.\u0275prov=l.jDH({token:i,factory:i.\u0275fac})}return i})()},80401:(M,f,t)=>{t.d(f,{T:()=>s});var g=t(96474),h=t(99293),p=t(44444);const d="admin/metadata/get";let s=(()=>{class D extends g.D{getMetadata(c,l,n,r){return this.getHttpApiUrl(d,{params:{appId:this.appId,targetType:c.toString(),keyType:l,key:n.toString(),...r&&{contentType:r}}})}getMetadataLive(c,l,n,r,i){return this.newHttpResource(()=>(c(),{url:this.apiUrl(d),params:{appId:this.appId,targetType:l.toString(),keyType:n,key:r.toString(),...i&&{contentType:i}}}))}getMetadataPromise(c,l,n,r){return this.fetchPromise(d,{params:{appId:this.appId,targetType:c.toString(),keyType:l,key:n.toString(),...r&&{contentType:r}}})}static#t=this.\u0275fac=(()=>{let c;return function(n){return(c||(c=h.xGo(D)))(n||D)}})();static#e=this.\u0275prov=p.jDH({token:D,factory:D.\u0275fac})}return D})()},96817:(M,f,t)=>{t.d(f,{R:()=>E});var g=t(47215),h=t(85837),p=t(9234),d=t(24467),s=t(99293),D=t(44444);let E=(()=>{class c extends d.B{create(n,r){return this.http.post(`app/auto/data/${n}`,r,{params:{appId:this.appId,zoneId:this.zoneId}})}update(n,r,i){return this.http.post(`app/auto/data/${n}/${r}`,i,{params:{appId:this.appId,zoneId:this.zoneId}})}delete(n,r,i){return this.http.delete(this.apiUrl(p.gb+"delete"),{params:{contentType:n,id:r.toString(),appId:this.appId,force:i.toString()},context:(new g._y).set(h.g,[400])})}static#t=this.\u0275fac=(()=>{let n;return function(i){return(n||(n=s.xGo(c)))(i||c)}})();static#e=this.\u0275prov=D.jDH({token:c,factory:c.\u0275fac})}return c})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/20.00.02/dist/ng-edit/default-projects_eav-ui_src_app_permissions_permissions_component_ts.71b35beb8314ea94.js.map