"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_app-administration_web-api-rest-api_web-api-rest-api_component_ts"],{79262:(R,m,s)=>{s.r(m),s.d(m,{WebApiRestApiComponent:()=>r});var E=s(44444),u=s(64173),o=s(34456),O=s(84175),D=s(53777),T=s(93840),A=s(64043),P=s(29658),I=s(12938),M=s(79996),g=s(34435),C=s(67037),f=s(60852),n=s(99293),l=s(87698),W=s(23731);function t(e,h){if(1&e&&(n.j41(0,"mat-option",3),n.EFF(1),n.k0s()),2&e){const i=h.$implicit;n.Y8G("value",i.path),n.R7$(),n.SpI(" ",i.name," ")}}function a(e,h){if(1&e&&n.Z7z(0,t,2,2,"mat-option",3,n.fX1),2&e){const i=n.XpG();n.Dyx(i.webApisTypes().sort())}}const p={all:!1,webApisTypes:!0,syncUrl:!0};let r=(()=>{class e{#e;#t;#s;constructor(){this.log=(0,g.Tq)({WebApiRestApiComponent:e},p),this.#e=(0,I.d)(M.F),this.#t=(0,I.d)(f.c),this.#s=(0,E.WQX)(o.ok),this.#a=(0,E.vPA)(0),this.#p=this.#e.getWebApisLive(this.#a),this.webApisTypes=(0,u.EW)(()=>this.#p()),this.webApiTypeForm=this.#s.group({webApiType:[""]}),(0,u.QZ)(()=>{const i=this.log.fnIf("syncUrl"),_=this.webApisTypes();if(0===_.length)return i.end();const d=this.#t.urlSegments.at(-1);var v=d.replace(/%252F/g,"/");const c=_.find(U=>U.path===v);i.a("status:",{webApis:_,webApi:c,urlPath:d,encodedUrlPath:v}),c&&this.webApiTypeForm.get("webApiType").setValue(c.path),i.end()})}#a;#p;openRestApi(i){i&&this.#t.navRelative([encodeURIComponent(i)])}static#n=this.\u0275fac=function(_){return new(_||e)};static#r=this.\u0275cmp=n.VBU({type:e,selectors:[["app-web-api-rest-api"]],decls:7,vars:2,consts:[[3,"formGroup"],["color","accent",1,"eav-mat-form-field"],["formControlName","webApiType",3,"valueChange"],[3,"value"]],template:function(_,d){1&_&&(n.j41(0,"form",0)(1,"mat-form-field",1)(2,"mat-label"),n.EFF(3,"Endpoint"),n.k0s(),n.j41(4,"mat-select",2),n.bIt("valueChange",function(c){return d.openRestApi(c)}),n.nVh(5,a,2,0),n.k0s()()(),n.nrm(6,"router-outlet")),2&_&&(n.Y8G("formGroup",d.webApiTypeForm),n.R7$(5),n.vxM(d.webApisTypes()?5:-1))},dependencies:[A.M,l.j,l.M,A.g,W.M,O.Hl,D.Hu,T.m_,o.X1,o.qT,o.BC,o.cb,o.j4,o.JD,P.n3,C.p],encapsulation:2})}return e})()},79996:(R,m,s)=>{s.d(m,{F:()=>n});var E=s(46443),u=s(64173),o=s(70271),O=s(96474),D=s(99293),T=s(44444);const P="admin/AppFiles/asset",g="admin/ApiExplorer/AppApiFiles";let n=(()=>{class l extends O.D{get(t,a,p){return this.getHttpApiUrl(P,{params:{appId:this.appId,global:a,...this.templateIdOrPath(t,a,p)}}).pipe((0,o.T)(r=>{if("auto"===r.Type.toLocaleLowerCase())switch(r.Extension.toLocaleLowerCase()){case".cs":case".cshtml":r.Type="Razor";break;case".html":case".css":case".js":r.Type="Token"}return r}))}save(t,a,p,r){return this.http.post(this.apiUrl(P),p,{params:{appId:this.appId,global:a,...this.templateIdOrPath(t,a,r)}})}getAllPromise(t){return this.fetchPromise("admin/AppFiles/AppFiles",{params:{appId:this.appId,...t&&{mask:t}}}).then(({Files:a})=>(a.forEach(p=>{p.Shared??=!1}),a))}getWebApis(){return this.getHttpApiUrl(g,{params:{appId:this.appId}}).pipe((0,o.T)(({files:t})=>(t.forEach(a=>{a.isShared??=!1,a.isCompiled??=!1}),t))).pipe((0,o.T)(t=>t.map(p=>{const r=p.path.lastIndexOf("/"),e=p.path.lastIndexOf("."),h=p.path.substring(0,r),i=p.path.substring(r+1,e);return{path:p.path,folder:h,name:i,isShared:p.isShared,endpointPath:p.endpointPath,isCompiled:p.isCompiled,edition:p.edition}})))}getWebApisLive(t){const a=(0,E.fx)(()=>(t(),{url:this.apiUrl(g),params:{appId:this.appId}}));return(0,u.EW)(()=>{const r=a.value()?.files;return r?(r.forEach(e=>{e.isShared??=!1,e.isCompiled??=!1}),r.map(e=>{const h=e.path.lastIndexOf("/"),i=e.path.lastIndexOf("."),_=e.path.substring(0,h),d=e.path.substring(h+1,i);return{path:e.path,folder:_,name:d,isShared:e.isShared,endpointPath:e.endpointPath,isCompiled:e.isCompiled,edition:e.edition}})):[]})}getWebApiDetails(t){return this.getHttpApiUrl("admin/ApiExplorer/inspect",{params:{appId:this.appId,zoneId:this.zoneId,path:t}})}getPredefinedTemplates(t,a){return this.fetchPromise("admin/AppFiles/GetTemplates",{params:{...t&&{purpose:t},...a&&{type:a}}})}getPreview(t,a,p){return this.getHttpApiUrl("admin/AppFiles/preview",{params:{appId:this.appId,path:t,templateKey:p,global:a}})}create(t,a,p){return this.http.post(this.apiUrl("admin/AppFiles/create"),{},{params:{appId:this.appId,global:a,purpose:"auto",path:t,templateKey:p}})}templateIdOrPath(t,a,p){if(/^[0-9]*$/g.test(t)){const r=p.find(e=>e.EntityId?.toString()===t&&e.IsShared===a)?.Path;return{templateId:t,...null!=r&&{path:r}}}return{path:t}}static#e=this.\u0275fac=(()=>{let t;return function(p){return(t||(t=D.xGo(l)))(p||l)}})();static#t=this.\u0275prov=T.jDH({token:l,factory:l.\u0275fac})}return l})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/20.00.02/dist/ng-edit/projects_eav-ui_src_app_app-administration_web-api-rest-api_web-api-rest-api_component_ts.af403ecdf007d329.js.map