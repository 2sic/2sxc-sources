"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_manage-content-list_manage-content-list_component_ts-projects_eav-ui_-8d5b99"],{4979:(L,p,o)=>{o.d(p,{V:()=>a});var c=o(27092),h=o(44444);let a=(()=>{class _{constructor(){this.subscriptions=new c.yU}ngOnDestroy(){this.destroy()}destroy(){this.subscriptions.unsubscribe()}static#n=this.\u0275fac=function(C){return new(C||_)};static#e=this.\u0275prov=h.jDH({token:_,factory:_.\u0275fac})}return _})()},52645:(L,p,o)=>{o.r(p),o.d(p,{ManageContentListComponent:()=>W});var c=o(86571),h=o(84344),a=o(44444),_=o(84175),g=o(81863),u=o(93840),C=o(29658),v=o(90852),M=o(12938),D=o(13620),b=o(64699),O=o(23840),T=o(34601),E=o(43216),m=o(70334),R=o(60852),x=o(67993),k=o(59669),t=o(99293),B=o(3347),j=o(88622);const F=(s,d)=>d.Index+"+"+d.Id;function A(s,d){if(1&s){const n=t.RV6();t.j41(0,"span"),t.EFF(1),t.k0s(),t.j41(2,"button",13),t.bIt("click",function(){a.eBV(n);const i=t.XpG(3);return a.Njj(i.editHeader())}),t.j41(3,"mat-icon"),t.EFF(4,"edit"),t.k0s()()}if(2&s){const n=t.XpG(3);t.R7$(),t.JRh(n.header().Title)}}function U(s,d){1&s&&(t.EFF(0),t.nI1(1,"translate")),2&s&&t.SpI(" ",t.bMT(1,1,"ManageContentList.NoHeader")," ")}function y(s,d){if(1&s&&(t.j41(0,"p"),t.EFF(1),t.nI1(2,"translate"),t.k0s(),t.j41(3,"p"),t.nVh(4,A,5,1)(5,U,2,3),t.k0s()),2&s){const n=t.XpG(2);t.R7$(),t.SpI(" ",t.bMT(2,2,"ManageContentList.Description")," "),t.R7$(3),t.vxM(n.header().Type?4:5)}}function $(s,d){if(1&s&&(t.j41(0,"p",5),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&s){let n;const e=t.XpG(2);t.R7$(),t.SpI(" ",t.bMT(2,1,"ManageContentList."+(e.reordered()?"ListHasBeenReordered":(null==(n=e.items())?null:n.length)<25?"SortItems":"SortLotsOfItems"))," ")}}function K(s,d){if(1&s){const n=t.RV6();t.j41(0,"div",7)(1,"div",14)(2,"mat-icon",15),t.EFF(3,"drag_handle"),t.k0s(),t.j41(4,"span",16),t.EFF(5),t.k0s()(),t.j41(6,"div")(7,"button",17),t.bIt("click",function(){const i=a.eBV(n).$implicit,r=t.XpG(2);return a.Njj(r.addFromExisting(i.Index))}),t.j41(8,"mat-icon"),t.EFF(9,"playlist_add"),t.k0s()(),t.j41(10,"button",18),t.bIt("click",function(){const i=a.eBV(n).$implicit,r=t.XpG(2);return a.Njj(r.addBelow(i.Index))}),t.j41(11,"mat-icon"),t.EFF(12,"add"),t.k0s()(),t.j41(13,"button",19),t.bIt("click",function(){const i=a.eBV(n).$implicit,r=t.XpG(2);return a.Njj(r.remove(i))}),t.j41(14,"mat-icon"),t.EFF(15,"remove"),t.k0s()(),t.j41(16,"button",20),t.bIt("click",function(){const i=a.eBV(n).$implicit,r=t.XpG(2);return a.Njj(r.editItem(i.Id))}),t.j41(17,"mat-icon"),t.EFF(18,"edit"),t.k0s()()()()}if(2&s){const n=d.$implicit,e=t.XpG(2);t.R7$(4),t.Y8G("tippy",t.ai1("",n.Title," (",n.Id,")")),t.R7$(),t.Lme(" ",n.Title," (",n.Id,") "),t.R7$(2),t.Y8G("disabled",0===n.Id),t.R7$(3),t.Y8G("disabled",0===n.Id||e.reordered()),t.R7$(3),t.Y8G("disabled",e.reordered()),t.R7$(3),t.Y8G("disabled",0===n.Id)}}function G(s,d){if(1&s){const n=t.RV6();t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.EFF(3),t.nI1(4,"translate"),t.k0s()(),t.j41(5,"div",3),t.nrm(6,"router-outlet"),t.j41(7,"div",4),t.nVh(8,y,6,4),t.nVh(9,$,3,3,"p",5),t.j41(10,"div",6),t.bIt("cdkDropListDropped",function(i){a.eBV(n);const r=t.XpG();return a.Njj(r.drop(i))}),t.Z7z(11,K,19,9,"div",7,F),t.k0s()()(),t.j41(13,"mat-dialog-actions",8)(14,"button",9),t.bIt("click",function(){a.eBV(n);const i=t.XpG();return a.Njj(i.closeDialog())}),t.EFF(15),t.nI1(16,"translate"),t.k0s(),t.j41(17,"button",10),t.bIt("click",function(){a.eBV(n);const i=t.XpG();return a.Njj(i.saveList())}),t.EFF(18),t.nI1(19,"translate"),t.k0s(),t.j41(20,"button",11),t.bIt("click",function(){a.eBV(n);const i=t.XpG();return a.Njj(i.saveAndCloseList())}),t.j41(21,"mat-icon",12),t.EFF(22,"done"),t.k0s()()()()}if(2&s){const n=t.XpG();t.R7$(3),t.JRh(t.bMT(4,5,"ManageContentList.Title")),t.R7$(5),t.vxM(n.header()?8:-1),t.R7$(),t.vxM(n.items()?9:-1),t.R7$(2),t.Dyx(n.items()),t.R7$(4),t.JRh(t.bMT(16,7,"General.Buttons.Cancel")),t.R7$(3),t.JRh(t.bMT(19,9,"General.Buttons.Save"))}}let W=(()=>{class s{#n;#e;#s;constructor(n,e,i){this.dialog=n,this.snackBar=e,this.translate=i,this.hostClass="dialog-component",this.#n=(0,M.d)(R.c),this.#e=(0,M.d)(k.y),this.#s=(0,M.d)(b.L),this.items=(0,x.KX)("items",null),this.#t=(0,D.C)(this.#n.getParams(["guid","part","index"]),r=>({id:null,guid:r.guid,part:r.part,index:parseInt(r.index,10)})),this.#i=(0,a.vPA)(0),this.header=this.#e.getAllLive(this.#t,this.#i).value,this.reordered=(0,x.KX)("reordered",!1)}#t;#i;ngOnInit(){this.#o(),this.#r(),this.#n.doOnDialogClosed(()=>{this.#o(!0),this.#a()})}#r(){this.#s.getCurrent$().subscribe(n=>{this.translate.setDefaultLang(n.Context.Language.Primary.split("-")[0]),this.translate.use(n.Context.Language.Current.split("-")[0])})}closeDialog(){this.dialog.close()}saveList(){this.snackBar.open("Saving..."),this.#e.saveList(this.#t,this.items()).subscribe(()=>{this.snackBar.open("Saved",null,{duration:2e3}),this.#o(),this.#a()})}saveAndCloseList(){this.snackBar.open("Saving..."),this.#e.saveList(this.#t,this.items()).subscribe(()=>{this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()})}editHeader(){const n={items:[m.c.relationship(this.#t.guid,"listcontent",0,0===this.header().Id),m.c.relationship(this.#t.guid,"listpresentation",0,0===this.header().Id)]},e=(0,E.s)(n);this.#n.navRelative([`edit/${e}`])}editItem(n){const e={items:[m.c.editId(n)]},i=(0,E.s)(e);this.#n.navRelative([`edit/${i}`])}addFromExisting(n){this.#n.navRelative([`${this.#t.guid}/${this.#t.part}/${n+1}/replace`],{queryParams:{add:!0}})}addBelow(n){const e={items:[m.c.relationship(this.#t.guid,this.#t.part,n+1,!0)]},i=(0,E.s)(e);this.#n.navRelative([`edit/${i}`])}remove(n){confirm(this.translate.instant("ManageContentList.ConfirmRemove"))&&(this.snackBar.open("Removing..."),this.#e.removeItem(this.#t,n.Index).subscribe(()=>{this.snackBar.open("Removed",null,{duration:2e3}),this.#o()}))}drop(n){const e=[...this.items()];(0,c.HD)(e,n.previousIndex,n.currentIndex),this.items.set(e),this.reordered.set(!0)}#o(n=!1){this.#e.getListPromise(this.#t).then(e=>{if(this.reordered()){const i=this.items().map(l=>l.Id);if(this.items().length===e.length&&!e.some(l=>!i.includes(l.Id))&&n){const l=this.items().map(f=>f.Index);e.sort((f,V)=>{const I=l.indexOf(f.Index),P=l.indexOf(V.Index);return-1===I||-1===P?0:I-P})}else n&&this.snackBar.open("List was changed from somewhere else. Order of items is reset",null,{duration:5e3})}this.items.set(e),this.reordered.set(!1)})}#a(){this.#i.set(this.#i()+1)}static#d=this.\u0275fac=function(e){return new(e||s)(t.rXU(g.k),t.rXU(B.UG),t.rXU(v.c$))};static#_=this.\u0275cmp=t.VBU({type:s,selectors:[["app-manage-content-list"]],hostVars:1,hostBindings:function(e,i){2&e&&t.Avn("className",i.hostClass)},decls:1,vars:1,consts:[[1,"eav-dialog","eav-no-scrollbar"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],["cdkScrollable","",1,"dialog-component-content","fancy-scrollbar-light"],[1,"eav-sort-title"],["cdkDropList","",1,"eav-dnd-list",3,"cdkDropListDropped"],["cdkDrag","",1,"eav-dnd-item"],["align","end"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"click"],["mat-raised-button","","color","accent","tippyTranslate","Form.Buttons.SaveAndClose",3,"click"],[1,"eav-raised-button-icon"],["mat-icon-button","","tippy","Edit header",3,"click"],[1,"eav-dnd-item__title"],["tippy","Drag to reorder the list",1,"eav-dnd-item__title-icon"],[1,"eav-dnd-item__title-text",3,"tippy"],["mat-icon-button","","tippyTranslate","Fields.Picker.AddExistingItem","appMousedownStopPropagation","",3,"click","disabled"],["mat-icon-button","","tippyTranslate","Fields.Picker.AddItemBelow","appMousedownStopPropagation","",3,"click","disabled"],["mat-icon-button","","tippyTranslate","Fields.Picker.Remove","appMousedownStopPropagation","",3,"click","disabled"],["mat-icon-button","","tippyTranslate","Fields.Picker.Edit","appMousedownStopPropagation","",3,"click","disabled"]],template:function(e,i){1&e&&t.nVh(0,G,23,11,"div",0),2&e&&t.vxM(i.header()&&i.items()?0:-1)},dependencies:[C.n3,h.uv,_.Hl,_.$z,j.M,u.m_,u.An,c.O7,c.T1,g.M,v.h,v.D9,g.l,T.e,O.z],styles:[".eav-sort-title[_ngcontent-%COMP%]{padding-top:16px}.eav-dnd-list[_ngcontent-%COMP%]{margin:16px 0;border:1px solid #ccc;border-radius:4px;overflow:hidden}.eav-dnd-item[_ngcontent-%COMP%]{cursor:move;height:40px;border-bottom:1px solid #ccc;padding:0 8px;display:flex;align-items:center;justify-content:space-between;background:#fff;box-sizing:border-box;font-size:14px}.eav-dnd-item[_ngcontent-%COMP%]:last-child{border:none}.eav-dnd-item__title[_ngcontent-%COMP%]{display:flex;align-items:center;overflow:hidden;max-width:80%}.eav-dnd-item__title-icon[_ngcontent-%COMP%]{margin-right:8px;opacity:.4}.eav-dnd-item__title-text[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.dnd-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .dnd-item[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}"]})}return s})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/20.00.02/dist/ng-edit/projects_eav-ui_src_app_manage-content-list_manage-content-list_component_ts-projects_eav-ui_-8d5b99.4ed307a7c8fdd591.js.map