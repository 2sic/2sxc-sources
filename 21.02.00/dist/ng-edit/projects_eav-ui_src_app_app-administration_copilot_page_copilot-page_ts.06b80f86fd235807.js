"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_app-administration_copilot_page_copilot-page_ts"],{70751(ot,j,n){n.d(j,{CopilotPageComponent:()=>it});var c=n(93840),u=n(69393),F=n(79748),x=n(50698),h=n(56884),E=n(37580),t=n(36124),p=n(36664),D=n(49074),$=n(34456),g=n(84175),f=n(53777),R=n(87941),v=n(25175),I=n(3347),k=n(48010),M=n(14600),N=n(19999),S=n(70271),l=n(12938),A=n(336),C=n(11828),O=n(60251),G=n(34601),P=n(92324),T=n(30056),V=n(67037),H=n(60852),X=n(68873),z=n(9234),B=n(14513),W=n(25286),U=n(85309),Y=n(17828);let w=(()=>{class o{agInit(e){this.params=e,this.item=e.data}refresh(e){return!0}do(e){this.params.do(e,this.item)}static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["app-copilot-actions"]],decls:9,vars:0,consts:[[1,"actions-component",2,"display","flex","align-items","center","justify-content","center","gap","12px","height","100%"],["matRipple","","tippy","Generate Code",1,"eav-grid-action-button","highlight",2,"display","flex","align-items","center","gap","2px","white-space","nowrap","min-width","120px","justify-content","center",3,"click"],[2,"padding-left","2px"],["matRipple","","tippy","Delete",1,"eav-grid-action-button","highlight",2,"display","flex","align-items","center","justify-content","center",3,"click"]],template:function(i,a){1&i&&(t.j41(0,"div",0)(1,"div",1),t.bIt("click",function(){return a.do("generate")}),t.j41(2,"mat-icon"),t.EFF(3,"code"),t.k0s(),t.j41(4,"span",2),t.EFF(5,"Generate Code"),t.k0s()(),t.j41(6,"div",3),t.bIt("click",function(){return a.do("delete")}),t.j41(7,"mat-icon"),t.EFF(8,"delete"),t.k0s()()())},dependencies:[U.p,Y.r6,c.m_,c.An,G.e],encapsulation:2})}}return o})();var y=n(80423),L=n(96462),J=n(58857);function Q(o,r){1&o&&(t.j41(0,"p",12),t.EFF(1,"No configurations yet. Click + to create one."),t.k0s())}function Z(o,r){if(1&o&&(t.j41(0,"div",13),t.nrm(1,"ag-grid-angular",14),t.k0s()),2&o){const e=t.XpG(2);t.R7$(),t.Y8G("rowData",e.dataSourceData())("gridOptions",e.gridOptions)}}function K(o,r){1&o&&t.nVh(0,Q,2,0,"p",12)(1,Z,2,2,"div",13),2&o&&t.vxM(0===r.length?0:1)}function _(o,r){if(1&o&&(t.j41(0,"mat-option",7)(1,"strong"),t.EFF(2),t.k0s(),t.nrm(3,"br"),t.EFF(4),t.k0s()),2&o){const e=r.$implicit;t.Y8G("value",e.name),t.R7$(2),t.Lme("",e.name," v",e.version),t.R7$(2),t.SpI(" ",e.description," ")}}function q(o,r){1&o&&t.nrm(0,"mat-hint",8),2&o&&t.Y8G("innerHTML",r.descriptionHtml,t.npT)}function tt(o,r){if(1&o&&(t.j41(0,"mat-option",7)(1,"strong"),t.EFF(2),t.k0s(),t.EFF(3),t.k0s()),2&o){const e=r.$implicit;t.Y8G("value",e.name),t.R7$(2),t.JRh(e.label),t.R7$(),t.SpI(" (",e.description,") ")}}function et(o,r){if(1&o){const e=t.RV6();t.j41(0,"mat-form-field",5)(1,"mat-label"),t.EFF(2,"Select an Edition to generate code for"),t.k0s(),t.j41(3,"mat-select",6),t.mxI("valueChange",function(a){h.eBV(e);const s=t.XpG();return t.DH7(s.selectedEdition,a)||(s.selectedEdition=a),h.Njj(a)}),t.Z7z(4,tt,4,3,"mat-option",7,t.fX1),t.k0s(),t.j41(6,"mat-hint"),t.EFF(7," Editions are managed in the "),t.j41(8,"code"),t.EFF(9,"/App_Data/app.json"),t.k0s(),t.EFF(10," file. See "),t.j41(11,"a",15),t.EFF(12,"docs"),t.k0s(),t.EFF(13,". "),t.k0s()()}if(2&o){const e=t.XpG();t.R7$(3),t.R50("value",e.selectedEdition),t.R7$(),t.Dyx(r.sort())}}let nt=(()=>{class o{constructor(){this.gridOptions=this.buildGridOptions(),this.dataSourceData=(0,h.vPA)([]),this.outputType=(0,E.hFB)(),this.title=(0,E.hFB)("Copilot Generator"),this.#d=(0,l.d)(z.Tr),this.#i=(0,l.d)(H.c),this.#l=(0,l.d)(R.bZ),this.#t=(0,l.d)(I.UG),this.#e=(0,l.d)(X.o),this.#o=(0,l.d)(x.Qq),this.#a=(0,l.d)(B.t),this.#c=(0,l.d)(A.F),this.#p=(0,h.WQX)(t.c1b),this.#n="b08dcd23-2eb0-4a5e-a3d0-3178d2aae451",this.#s="admin/code/generateDataModels",this.displayedColumns=["title","generator","actions"],this.#m=this.#a.getMany({source:"f512e44b-5b34-4a32-bfe3-d46d46800a7f",params:(0,p.EW)(()=>({$filter:`OutputType eq '${this.outputType()}'`})),streams:"*"}),this.generators=(0,p.EW)(()=>this.#m.value()?.default.filter(e=>e.outputType===this.outputType())??[]),this.#h=(0,D.br)(this.generators),this.selectedGeneratorName=(0,p.uu)(()=>this.generators()?.[0]?.name??""),this.selectedGenerator=(0,p.EW)(()=>{const e=this.generators(),i=this.selectedGeneratorName();return e.find(a=>a.name===i)}),this.#r=this.#a.get({source:"ToSic.Sxc.DataSources.AppEditions"}),this.editions=(0,p.EW)(()=>this.#r().map(e=>({name:e.name,label:`/${e.name}/AppCode/Data`.replace(/\/\//g,"/"),description:(e.description||"no description provided")+(e.isDefault?" \u2705":"")}))),this.selectedEdition=(0,p.uu)(()=>this.#r().find(e=>e.isDefault)?.name??""),this.showConfigurationDropdown=(0,h.vPA)(!1)}buildGridOptions(){return{...O.C,columnDefs:[{...C.r.TextWideMin100,headerName:"Name",field:"Title",flex:2,cellRenderer:e=>`<a class='default-link' href='javascript:void(0)'>${e.value||"(Untitled)"}</a>`},{...C.r.TextWideMin100,headerName:"Generator",field:"CodeGenerator"},{...C.r.ActionsPinnedRight5,headerName:"Actions",cellRenderer:w,cellRendererParams:{do:(e,i)=>{switch(e){case"generate":this.generateForConfiguration(i);break;case"delete":this.deleteConfiguration(i)}}}}],onCellClicked:e=>{"Name"===e.colDef.headerName&&this.editConfig(e.data),"Actions"===e.colDef.headerName&&("generate"===e.event.target?.dataset?.action&&this.generateForConfiguration(e.data),"delete"===e.event.target?.dataset?.action&&this.deleteConfiguration(e.data))}}}#d;#i;#l;#t;#e;#o;#a;#c;#p;#n;#s;#m;#h;#r;ngOnInit(){this.fetchEntities(),this.#i.doOnDialogClosed(()=>this.fetchEntities()),this.entities$&&this.entities$.subscribe(e=>this.dataSourceData.set(e??[]))}fetchEntities(){const e=(0,M.H)(this.#c.getAllPromise(this.#n));this.entities$=(0,N.z)([e,this.#h]).pipe((0,S.T)(([i,a])=>{const s=i,d=new Set(a.map(m=>m.name));return s.filter(m=>d.has(m.CodeGenerator))})),this.entities$&&this.entities$.subscribe(i=>this.dataSourceData.set(i??[]))}editConfig(e){const i=e??this.selectedEntity,a={items:[i?T.H.editId(i.Id):T.H.newFromType(this.#n,{CodeGenerator:this.selectedGeneratorName(),OutputType:this.outputType()})]},s=(0,P.s)(a);this.#i.navRelative([`edit/${s}`])}deleteConfiguration(e){const i=e??this.selectedEntity;i&&this.#l.open(W.F,{autoFocus:!1,data:{entityId:i.Id,entityTitle:i.Title,message:"Are you sure you want to delete?",hasDeleteSnackbar:!0},viewContainerRef:this.#p,width:"400px"}).afterClosed().subscribe(s=>{s&&this.#d.delete(this.#e.appId,this.#n,i.Id,!1).subscribe({next:()=>{this.#t.open("Deleted",null,{duration:2e3}),this.selectedEntity?.Id===i.Id&&(this.selectedEntity=void 0),this.fetchEntities()},error:d=>{console.error("Error deleting configuration:",d),this.#t.open("Error deleting configuration",null,{duration:3e3})}})})}generateForConfiguration(e){this.#o.get(this.#s,{params:{appId:this.#e.appId,edition:this.selectedEdition(),generator:this.selectedGeneratorName(),configurationId:e.Id}}).subscribe(i=>{this.#t.open(`${i.message} (took ${i.timeTaken}ms)`,null,{duration:5e3})})}autoGeneratedCode(){const e={appId:this.#e.appId,edition:this.selectedEdition(),generator:this.selectedGeneratorName()};this.selectedEntity&&(e.configurationId=this.selectedEntity.Id),this.#o.get(this.#s,{params:e}).subscribe(i=>{this.#t.open(`${i.message} (took ${i.timeTaken}ms)`,null,{duration:5e3})})}toggleConfigurationDropdown(){this.showConfigurationDropdown.update(e=>!e)}static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["app-copilot-generator"]],inputs:{outputType:[1,"outputType"],title:[1,"title"]},decls:36,vars:10,consts:[[2,"display","flex","align-items","center","justify-content","space-between","gap","8px","padding","0 16px"],[1,"mat-subtitle-1"],["mat-fab","","mat-elevation-z24","","tippy","Add Configuration","tippyPlacement","left",1,"grid-fab",3,"click"],[2,"max-width","400px","margin-top","24px","margin-left","16px"],[2,"max-width","400px"],["color","accent",1,"eav-mat-form-field"],["required","",3,"valueChange","value"],[3,"value"],[3,"innerHTML"],[2,"display","flex","justify-content","flex-end"],["mat-button","",1,"eav-button__with-icon",3,"click"],[1,"eav-icon"],[1,"mat-body-1"],[2,"padding","0 16px"],["domLayout","autoHeight",1,"ag-theme-material",2,"width","100%",3,"rowData","gridOptions"],["href","https://go.2sxc.org/app-json","target","_blank"]],template:function(i,a){if(1&i&&(t.j41(0,"div",0)(1,"h3",1),t.EFF(2),t.nI1(3,"async"),t.k0s(),t.j41(4,"button",2),t.bIt("click",function(){return a.editConfig()}),t.j41(5,"mat-icon"),t.EFF(6,"add"),t.k0s()()(),t.nVh(7,K,2,1),t.nI1(8,"async"),t.j41(9,"div",3)(10,"mat-card")(11,"mat-card-content")(12,"h3",1),t.EFF(13,"Quick Generate"),t.k0s(),t.nrm(14,"br"),t.j41(15,"div",4)(16,"mat-form-field",5)(17,"mat-label"),t.EFF(18,"Generator"),t.k0s(),t.j41(19,"mat-select",6),t.mxI("valueChange",function(d){return t.DH7(a.selectedGeneratorName,d)||(a.selectedGeneratorName=d),d}),t.j41(20,"mat-select-trigger"),t.EFF(21),t.k0s(),t.Z7z(22,_,5,4,"mat-option",7,t.fX1),t.k0s(),t.nVh(24,q,1,1,"mat-hint",8),t.k0s(),t.nrm(25,"br")(26,"br"),t.nVh(27,et,14,1,"mat-form-field",5),t.nrm(28,"br"),t.j41(29,"div",9)(30,"button",10),t.bIt("click",function(){return a.autoGeneratedCode()}),t.j41(31,"mat-icon",11),t.EFF(32,"code"),t.k0s(),t.j41(33,"span"),t.EFF(34,"Generate Code"),t.k0s()()()()()()(),t.nrm(35,"router-outlet")),2&i){let s,d,m,b;t.R7$(2),t.SpI("Configurations (",(null==(s=t.bMT(3,6,a.entities$))?null:s.length)||0,")"),t.R7$(5),t.vxM((d=t.bMT(8,8,a.entities$))?7:-1,d),t.R7$(12),t.R50("value",a.selectedGeneratorName),t.R7$(2),t.SpI(" ",a.selectedGeneratorName()," "),t.R7$(),t.Dyx(a.generators().sort()),t.R7$(2),t.vxM((m=a.selectedGenerator())?24:-1,m),t.R7$(3),t.vxM((b=a.editions())?27:-1,b)}},dependencies:[F.MD,$.YN,g.Hl,g.$z,g.Sr,f.Hu,f.RN,f.m2,c.m_,c.An,v.Ve,y.rl,y.nJ,y.MV,v.VO,v.$2,L.wT,k.tP,u.n3,G.e,V.p,J.xs,F.Jj],styles:["[_nghost-%COMP%]     .ag-row-hover .ag-cell a, [_nghost-%COMP%]     .ag-row-hover .ag-cell .eav-grid-action-button, .eav-button__with-icon[_ngcontent-%COMP%]{color:#85283b!important}.eav-button__with-icon[_ngcontent-%COMP%]:disabled{color:#00000061!important}.header-row[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;width:100%}.header-actions[_ngcontent-%COMP%]{display:flex;align-items:center}.header-icon[_ngcontent-%COMP%]{font-size:24px;line-height:24px}"]})}}return o})(),it=(()=>{class o{constructor(e){this.data=e.snapshot.data}static{this.\u0275fac=function(i){return new(i||o)(t.rXU(u.nX))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["app-data-copilot"]],decls:10,vars:4,consts:[[1,"outer-container",2,"margin-bottom","0"],[2,"display","flex","align-items","center","justify-content","space-between","width","100%"],[2,"font-size","55px","width","64px","height","64px"],[2,"margin-bottom","0"],[3,"outputType","title"]],template:function(i,a){1&i&&(t.j41(0,"div",0)(1,"div",1)(2,"h1"),t.EFF(3),t.k0s(),t.j41(4,"mat-icon",2),t.EFF(5,"support_agent"),t.k0s()(),t.j41(6,"p",3),t.EFF(7),t.k0s()(),t.nrm(8,"app-copilot-generator",4)(9,"router-outlet")),2&i&&(t.R7$(3),t.JRh(a.data.heading),t.R7$(4),t.SpI(" ",a.data.intro," "),t.R7$(),t.Y8G("outputType",a.data.outputType)("title",a.data.title))},dependencies:[nt,u.n3,c.m_,c.An],styles:[".outer-container[_ngcontent-%COMP%]{padding:10px 20px}"]})}}return o})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/21.02.00/dist/ng-edit/projects_eav-ui_src_app_app-administration_copilot_page_copilot-page_ts.06b80f86fd235807.js.map