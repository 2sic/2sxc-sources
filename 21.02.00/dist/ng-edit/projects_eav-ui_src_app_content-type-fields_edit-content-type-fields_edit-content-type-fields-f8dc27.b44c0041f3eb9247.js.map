{"version":3,"file":"projects_eav-ui_src_app_content-type-fields_edit-content-type-fields_edit-content-type-fields-f8dc27.b44c0041f3eb9247.js","mappings":"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","names":["i0","$event","_r1","ctx_r1","onClick","triggerOnFormSubmit","label","ngClass","isDisabled","icon","SaveCloseButtonFabComponent","SaveCloseButtonBase","__ngFactoryType__","selectors","features","decls","vars","consts","template","rf","ctx","SaveCloseButtonFabComponent_ng_template_1_Template","NgClass","MatIconModule","i1","i2","i3","i4","MatRippleModule","i5","TranslateModule","TippyDirective","i6","styles","reduce","accumulator","seed","operate","scanInternals","hasSeed","emitOnNext","emitBeforeComplete","source","subscriber","hasState","state","index","subscribe","createOperatorSubscriber","value","i","next","complete","arguments","length","fieldNameError","staticName_r5","errors","reservedNames","EditContentTypeFieldsComponent_Conditional_9_For_4_Conditional_8_Conditional_0_Template","EditContentTypeFieldsComponent_Conditional_9_For_4_Conditional_8_Conditional_1_Template","pattern","dataType_r7","name","option_r8","EditContentTypeFieldsComponent_Conditional_9_For_4_For_34_Conditional_2_Template","inputType","_c2","isObsolete","field_r4","_r3","$implicit","StaticName","EditContentTypeFieldsComponent_Conditional_9_For_4_Conditional_8_Template","ɵ$index_23_r6","$index","setFieldType","EditContentTypeFieldsComponent_Conditional_9_For_4_For_20_Template","updateFieldPart","InputType","EditContentTypeFieldsComponent_Conditional_9_For_4_For_34_Template","fieldNamePattern","editMode","touched","Type","findIcon","findLabel","dataTypes","hints","data","tmp_31_0","getInputTypeOption","tmp_32_0","inputTypeOptions","input","saveAndClose","EditContentTypeFieldsComponent_Conditional_9_For_4_Template","_forTrack0","fields","canSave","EditContentTypeFieldsComponent","BaseComponent","#typesSvc","#typesFieldsSvc","constructor","dialog","route","snackBar","super","this","hostClass","formValid","signal","computed","saving","transient","ContentTypesService","ContentTypesFieldsService","calculateTypeIcon","calculateTypeLabel","snapshot","paramMap","get","filteredInputTypeOptions","#inputTypeOptions","getInputTypes","#contentTypeRouteName","getType","#existingFieldsLazy","contentTypeRouteName","untracked","getFieldsLive","NameId","initial","computedObj","routeId","editFieldId","parseInt","find","field","Id","#generateNewList","linkedSignal","computation","#reservedNamesSystem","getReservedNames","merged","ReservedNamesValidatorDirective","mergeReserved","all","map","filter","option","dataType","toLocaleLowerCase","description","obsoleteMessage","disableClose","subscriptions","add","backdropClick","_","ngForm","dirty","confirm","closeDialog","ngAfterViewInit","set","form","valid","statusChanges","autoFocusInputField","setTimeout","first","nativeElement","focus","ngOnInit","#watchKeyboardShortcuts","existingFieldCount","Array","keys","k","DataTypeCatalog","String","InputTypeCatalog","StringDefault","IsTitle","SortOrder","patch","update","f","type","defaultInputName","DefaultSuffix","options","inputName","close","open","doneAndClose","duration","rename","updateInputType","of","pipe","concatMap","catchError","toArray","keydownEvents","event","isCtrlEnter","preventDefault","viewQuery","NgForm","_c1","EditContentTypeFieldsComponent_Conditional_3_Template","EditContentTypeFieldsComponent_Conditional_4_Template","EditContentTypeFieldsComponent_Conditional_5_Template","EditContentTypeFieldsComponent_Conditional_9_Template","undefined","tmp_3_0","FormsModule","MatFormFieldModule","MatInputModule","MatSelectModule","i7","i8","i9","MatOptionModule","MatDialogActions","MatButtonModule","i10","FieldHintComponent"],"ignoreList":[],"sourceRoot":"webpack:///","sources":["./projects/eav-ui/src/app/shared/modules/save-close-button-fab/save-close-button-fab.html","./projects/eav-ui/src/app/shared/modules/save-close-button-fab/save-close-button-fab.ts","./node_modules/rxjs/dist/esm/internal/operators/reduce.js","./node_modules/rxjs/dist/esm/internal/operators/scanInternals.js","./projects/eav-ui/src/app/content-type-fields/edit-content-type-fields/edit-content-type-fields.html","./projects/eav-ui/src/app/content-type-fields/edit-content-type-fields/edit-content-type-fields.ts"],"sourcesContent":["<extended-fab-speed-dial>\r\n  <ng-template extendedFabSpeedDialTriggerContent>\r\n    <button\r\n      [type]=\"triggerOnFormSubmit() ? 'submit' : 'button'\"\r\n      [tippy]=\"(label() | translate) + ' (' + ('Form.Buttons.ActionAndCloseShortcut' | translate) + ')'\"\r\n      tippyShowDelay=\"500\"\r\n      [ngClass]=\"ngClass()\"\r\n      [disabled]=\"isDisabled\"\r\n      (click)=\"onClick($event)\"\r\n      extended-fab-speed-dial-trigger\r\n      matRipple\r\n    >\r\n      <span>{{ label() | translate }}</span>\r\n      <span class=\"keybinding-hint\">\r\n        <kbd>⌃</kbd><kbd>⏎</kbd>\r\n      </span>\r\n      <mat-icon>{{ icon() }}</mat-icon>\r\n    </button>\r\n  </ng-template>\r\n</extended-fab-speed-dial>\r\n","import { NgClass } from '@angular/common';\r\nimport { Component } from '@angular/core';\r\nimport { MatRippleModule } from '@angular/material/core';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { TippyDirective } from '../../directives/tippy.directive';\r\nimport { ExtendedFabSpeedDialImports } from '../extended-fab-speed-dial/extended-fab-speed-dial.imports';\r\nimport { SaveCloseButtonBase } from '../save-close-button/save-close-button-base.directive';\r\n\r\n@Component({\r\n  selector: 'app-save-close-button-fab',\r\n  imports: [\r\n    NgClass,\r\n    MatIconModule,\r\n    ...ExtendedFabSpeedDialImports,\r\n    MatRippleModule,\r\n    TranslateModule,\r\n    TippyDirective,\r\n  ],\r\n  templateUrl: './save-close-button-fab.html',\r\n  styleUrls: ['../save-close-button/save-close-button.scss'],\r\n})\r\nexport class SaveCloseButtonFabComponent extends SaveCloseButtonBase {}","import { scanInternals } from './scanInternals';\nimport { operate } from '../util/lift';\nexport function reduce(accumulator, seed) {\n    return operate(scanInternals(accumulator, seed, arguments.length >= 2, false, true));\n}\n","import { createOperatorSubscriber } from './OperatorSubscriber';\nexport function scanInternals(accumulator, seed, hasSeed, emitOnNext, emitBeforeComplete) {\n    return (source, subscriber) => {\n        let hasState = hasSeed;\n        let state = seed;\n        let index = 0;\n        source.subscribe(createOperatorSubscriber(subscriber, (value) => {\n            const i = index++;\n            state = hasState\n                ?\n                    accumulator(state, value, i)\n                :\n                    ((hasState = true), value);\n            emitOnNext && subscriber.next(state);\n        }, emitBeforeComplete &&\n            (() => {\n                hasState && subscriber.next(state);\n                subscriber.complete();\n            })));\n    };\n}\n","<div class=\"eav-dialog eav-no-scrollbar\">\r\n  <div class=\"eav-dialog-header\">\r\n    <div class=\"eav-dialog-header__title\">\r\n      @if (editMode === undefined) {\r\n        Fields\r\n      }\r\n      @if (editMode === null) {\r\n        Add Fields\r\n      }\r\n      @if (editMode != null) {\r\n        Edit Field\r\n      }\r\n    </div>\r\n    <button mat-icon-button tippy=\"Close dialog\" (click)=\"closeDialog()\">\r\n      <mat-icon>close</mat-icon>\r\n    </button>\r\n  </div>\r\n  @if (fields()?.length) {\r\n    <form #ngForm=\"ngForm\" (ngSubmit)=\"saveAndClose()\">\r\n      <div class=\"eav-dialog-content\">\r\n        @for (field of fields(); track field.SortOrder; let i = $index) {\r\n          <div class=\"eav-row-container\">\r\n            <div class=\"eav-edit-input\">\r\n              <mat-form-field color=\"accent\" class=\"eav-mat-form-field\">\r\n                <mat-label>Name</mat-label>\r\n                <input\r\n                  matInput\r\n                  [pattern]=\"fieldNamePattern\"\r\n                  [appReservedNames]=\"reservedNames()\"\r\n                  [(ngModel)]=\"field.StaticName\"\r\n                  [name]=\"'StaticName' + i\"\r\n                  #staticName=\"ngModel\"\r\n                  [disabled]=\"editMode === 'inputType'\"\r\n                  #autoFocusInputField\r\n                />\r\n              </mat-form-field>\r\n              @if (staticName.touched && staticName.errors) {\r\n                @if (staticName.errors.pattern) {\r\n                  <app-field-hint [isError]=\"true\">{{ fieldNameError }}</app-field-hint>\r\n                }\r\n                @if (staticName.errors.reservedNames) {\r\n                  <app-field-hint [isError]=\"true\">\r\n                    {{ staticName.errors.reservedNames }}\r\n                  </app-field-hint>\r\n                }\r\n              }\r\n            </div>\r\n            <div class=\"eav-edit-input\">\r\n              <mat-form-field color=\"accent\" class=\"eav-mat-form-field\">\r\n                <mat-label>Data Type</mat-label>\r\n                <mat-select\r\n                  (selectionChange)=\"setFieldType(i, $event.value)\"\r\n                  [ngModel]=\"field.Type\"\r\n                  [name]=\"'Type' + i\"\r\n                  [disabled]=\"editMode != null\"\r\n                  panelClass=\"eav-type-field-type-select\"\r\n                  panelWidth=\"\"\r\n                >\r\n                  <mat-select-trigger>\r\n                    <mat-icon class=\"eav-type-icon\">{{ findIcon(field.Type) }}</mat-icon>\r\n                    <span>{{ findLabel(field.Type) }}</span>\r\n                  </mat-select-trigger>\r\n                  @for (dataType of dataTypes(); track dataType) {\r\n                    <mat-option [value]=\"dataType.name\">\r\n                      {{ dataType.label }}\r\n                      <!-- Icon must come last; Angular will put it first. Otherwise we can't type the name of the label to quickly find an entry -->\r\n                      <mat-icon class=\"eav-type-icon\">{{ dataType.icon }}</mat-icon>\r\n                    </mat-option>\r\n                  }\r\n                </mat-select>\r\n              </mat-form-field>\r\n              <app-field-hint>{{ hints()[i].data }}</app-field-hint>\r\n            </div>\r\n            <div class=\"eav-edit-input\">\r\n              <mat-form-field color=\"accent\" class=\"eav-mat-form-field\">\r\n                <mat-label>Input Type</mat-label>\r\n                <mat-select\r\n                  (selectionChange)=\"updateFieldPart(i, { InputType: $event.value })\"\r\n                  [ngModel]=\"field.InputType\"\r\n                  [name]=\"'InputType' + i\"\r\n                  [disabled]=\"editMode === 'name'\"\r\n                  panelClass=\"eav-type-field-input-type-select\"\r\n                  panelWidth=\"\"\r\n                >\r\n                  <mat-select-trigger>\r\n                    <span>{{ getInputTypeOption(field.InputType)?.label }}</span>\r\n                    <mat-icon class=\"eav-input-icon\">{{ getInputTypeOption(field.InputType)?.icon }}</mat-icon>\r\n                  </mat-select-trigger>\r\n                  @for (option of inputTypeOptions()[i]; track option) {\r\n                    <mat-option [value]=\"option.inputType\" [ngClass]=\"{ 'eav-input-obsolete': option.isObsolete }\">\r\n                      {{ option.label }}\r\n                      @if (option.icon) {\r\n                        <!-- span is needed here because <mat-option> by default puts mat-icon to the beginning -->\r\n                        <span>\r\n                          <mat-icon class=\"eav-input-icon\">{{ option.icon }}</mat-icon>\r\n                        </span>\r\n                      }\r\n                    </mat-option>\r\n                  }\r\n                </mat-select>\r\n              </mat-form-field>\r\n              <app-field-hint>{{ hints()[i].input }}</app-field-hint>\r\n            </div>\r\n          </div>\r\n        }\r\n      </div>\r\n\r\n      <!-- Save / cancel buttons -->\r\n      <mat-dialog-actions align=\"end\">\r\n        <app-save-close-button-fab\r\n          [triggerOnFormSubmit]=\"true\"\r\n          [ngClass]=\"!canSave() ? 'disabled' : ''\"\r\n          [disabled]=\"!canSave()\"\r\n          (action)=\"saveAndClose()\"\r\n        />\r\n      </mat-dialog-actions>\r\n    </form>\r\n  }\r\n</div>","import { NgClass } from '@angular/common';\r\nimport { AfterViewInit, Component, computed, ElementRef, HostBinding, linkedSignal, OnInit, QueryList, signal, untracked, ViewChild, ViewChildren } from '@angular/core';\r\nimport { FormsModule, NgForm } from '@angular/forms';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatOptionModule } from '@angular/material/core';\r\nimport { MatDialogActions, MatDialogRef } from '@angular/material/dialog';\r\nimport { MatFormFieldModule } from '@angular/material/form-field';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatInputModule } from '@angular/material/input';\r\nimport { MatSelectModule } from '@angular/material/select';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { catchError, concatMap, filter, of, toArray } from 'rxjs';\r\nimport { transient } from '../../../../../core';\r\nimport { fieldNameError, fieldNamePattern } from '../../app-administration/constants/field-name.patterns';\r\nimport { ContentTypesService } from '../../app-administration/services/content-types.service';\r\nimport { isCtrlEnter } from '../../edit/dialog/main/keyboard-shortcuts';\r\nimport { BaseComponent } from '../../shared/components/base';\r\nimport { FieldHintComponent } from '../../shared/components/field-hint/field-hint';\r\nimport { ContentTypesFieldsService } from '../../shared/fields/content-types-fields.service';\r\nimport { DataTypeCatalog } from '../../shared/fields/data-type-catalog';\r\nimport { Field, FieldInputTypeOption } from '../../shared/fields/field.model';\r\nimport { InputTypeCatalog } from '../../shared/fields/input-type-catalog';\r\nimport { SaveCloseButtonFabComponent } from '../../shared/modules/save-close-button-fab/save-close-button-fab';\r\nimport { computedObj } from '../../shared/signals/signal.utilities';\r\nimport { calculateTypeIcon, calculateTypeLabel } from '../content-type-fields.helpers';\r\nimport { ReservedNamesValidatorDirective } from './reserved-names.directive';\r\n\r\ninterface Hints {\r\n  input: string;\r\n  data: string;\r\n}\r\n\r\ntype FieldSubset = Pick<Field, 'Id' | 'Type' | 'InputType' | 'StaticName' | 'IsTitle' | 'SortOrder'>;\r\n\r\n@Component({\r\n  selector: 'app-edit-content-type-fields',\r\n  templateUrl: './edit-content-type-fields.html',\r\n  styleUrls: ['./edit-content-type-fields.scss'],\r\n  imports: [\r\n    FormsModule,\r\n    MatFormFieldModule,\r\n    MatInputModule,\r\n    ReservedNamesValidatorDirective,\r\n    MatSelectModule,\r\n    MatIconModule,\r\n    MatOptionModule,\r\n    NgClass,\r\n    MatDialogActions,\r\n    MatButtonModule,\r\n    TranslateModule,\r\n    FieldHintComponent,\r\n    SaveCloseButtonFabComponent\r\n  ]\r\n})\r\nexport class EditContentTypeFieldsComponent extends BaseComponent implements AfterViewInit, OnInit {\r\n  @HostBinding('className') hostClass = 'dialog-component';\r\n  @ViewChild('ngForm', { read: NgForm }) private ngForm: NgForm;\r\n  @ViewChildren('autoFocusInputField') autoFocusInputField!: QueryList<ElementRef>;\r\n  \r\n  protected formValid = signal(false);\r\n  protected canSave = computed(() => this.formValid() && !this.saving());\r\n\r\n  #typesSvc = transient(ContentTypesService);\r\n  #typesFieldsSvc = transient(ContentTypesFieldsService);\r\n\r\n  constructor(\r\n    protected dialog: MatDialogRef<EditContentTypeFieldsComponent>,\r\n    private route: ActivatedRoute,\r\n    private snackBar: MatSnackBar,\r\n  ) {\r\n    super();\r\n    this.dialog.disableClose = true;\r\n    this.subscriptions.add(\r\n      this.dialog.backdropClick().subscribe(_ => {\r\n        if (this.ngForm?.dirty) {\r\n          const confirmed = confirm('You have unsaved changes. Are you sure you want to close this dialog?');\r\n          if (!confirmed) return;\r\n        }\r\n        this.closeDialog();\r\n      })\r\n    );\r\n  }\r\n\r\n  // External functions / constants to pass to the view\r\n  fieldNamePattern = fieldNamePattern;\r\n  fieldNameError = fieldNameError;\r\n  findIcon = calculateTypeIcon;\r\n  findLabel = calculateTypeLabel;\r\n\r\n  /** Edit mode is either not set (new fields) or edit-name / edit-inputType */\r\n  editMode = this.route.snapshot.paramMap.get('editMode') as 'name' | 'inputType';\r\n  filteredInputTypeOptions: FieldInputTypeOption[][] = [];\r\n  saving = signal(false);\r\n\r\n  /** Data types such as string, number, ... */\r\n  // dataTypes = this.#typesFieldsSvc.dataTypes();\r\n  dataTypes = this.#typesFieldsSvc.dataTypes().value;\r\n\r\n  #inputTypeOptions = this.#typesFieldsSvc.getInputTypes().value;\r\n\r\n  #contentTypeRouteName = this.#typesSvc.getType(this.route.snapshot.paramMap.get('contentTypeStaticName')).value;\r\n\r\n  #existingFieldsLazy = computed(() => {\r\n    const contentTypeRouteName = this.#contentTypeRouteName();\r\n    const data = untracked(() => {\r\n      return this.#typesFieldsSvc.getFieldsLive(signal(0), contentTypeRouteName?.NameId);\r\n    })\r\n    return data;\r\n  });\r\n\r\n\r\n  fields = (() => {\r\n    // Get the fields once the data is ready\r\n    const initial = computedObj('fields', () => {\r\n      const fields = this.#existingFieldsLazy()();\r\n      if (this.editMode != null) {\r\n        if (fields.length === 0) return [];\r\n        const routeId = this.route.snapshot.paramMap.get('id');\r\n        const editFieldId = routeId ? parseInt(routeId, 10) : null;\r\n        const editField = fields.find(field => field.Id === editFieldId);\r\n        return [editField];\r\n      } else\r\n        return this.#generateNewList(fields.length);\r\n    });\r\n\r\n    return linkedSignal({\r\n      source: initial,\r\n      computation: fields => fields,\r\n    });\r\n  })();\r\n\r\n  // Figure out the reserved names which should not be used as field names\r\n  #reservedNamesSystem = this.#typesFieldsSvc.getReservedNames().value;\r\n\r\n  reservedNames = computedObj('reservedNamesAll', () => {\r\n    // setup watchers\r\n    const fields = this.#existingFieldsLazy()();\r\n    const reservedNames = this.#reservedNamesSystem();\r\n    if (fields.length === 0)\r\n      return reservedNames;\r\n    const merged = ReservedNamesValidatorDirective.mergeReserved(reservedNames, fields);\r\n\r\n    // If we're about to rename, allow the current name to be reused\r\n    if (this.editMode === 'name')\r\n      delete merged[fields[0].StaticName];\r\n    return merged;\r\n  });\r\n\r\n  ngAfterViewInit(): void {\r\n    // Only run form logic if fields are loaded and form is rendered\r\n    if (this.fields().length && this.ngForm) {\r\n      this.formValid.set(this.ngForm?.form.valid ?? false);\r\n      this.ngForm?.form.statusChanges.subscribe(() => {\r\n        this.formValid.set(this.ngForm?.form.valid ?? false);\r\n      });\r\n    } else {\r\n      // Retry after a short delay if not ready\r\n      setTimeout(() => this.ngAfterViewInit(), 250);\r\n      return;\r\n    }\r\n    // Wait for the inputFields to be available\r\n    // But delay execution to ensure the view is fully rendered\r\n    if (this.autoFocusInputField)\r\n      setTimeout(() => this.autoFocusInputField.first?.nativeElement?.focus(), 250);\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.#watchKeyboardShortcuts();\r\n\r\n  //   setTimeout(() => {\r\n  //     console.log(this.#contentTypeRouteName()?.NameId)\r\n\r\n  //   }, 110); // Force change detection to ensure the view is ready\r\n  //   this.#typesFieldsSvc.getFieldsPromise(this.#contentTypeRouteName()?.NameId).then(fields => {\r\n  //     console.log('Fields loaded', fields);\r\n  //     this.#existingFieldsLazy.set(fields);\r\n  //   })\r\n  }\r\n\r\n  #generateNewList(existingFieldCount: number): FieldSubset[] {\r\n    return [...Array(8).keys()].map(k => ({\r\n      Id: 0,\r\n      Type: DataTypeCatalog.String,\r\n      InputType: InputTypeCatalog.StringDefault,\r\n      StaticName: '',\r\n      // first one is title, if there were no fields before\r\n      IsTitle: existingFieldCount === 0 && k === 0,\r\n      SortOrder: existingFieldCount + k + 1,\r\n    } satisfies FieldSubset));\r\n  }\r\n\r\n  /** 2D array of all possible options (by field index) */\r\n  inputTypeOptions = computedObj('inputTypeOptions', () => {\r\n    const all = this.#inputTypeOptions();\r\n    const fields = this.fields();\r\n    return fields.map((field, i) => {\r\n      return all.filter(option => option.dataType === field.Type.toLocaleLowerCase());\r\n    });\r\n  });\r\n\r\n  updateFieldPart(index: number, patch: Partial<Field>) {\r\n    this.fields.update(fields => [...fields].map((f, i) => (i !== index) ? f : ({ ...f, ...patch })));\r\n  }\r\n\r\n  setFieldType(index: number, type: string) {\r\n    // First update the field, as we'll access this again indirectly through other signals\r\n    this.updateFieldPart(index, { Type: type });\r\n\r\n    // Check if it has a xxx-default like string-default in the list\r\n    const defaultInputName = type.toLocaleLowerCase() + InputTypeCatalog.DefaultSuffix;\r\n    const options = this.inputTypeOptions()[index];\r\n    const inputName = options.find(option => option.inputType === defaultInputName)?.inputType\r\n      ?? options[0].inputType;\r\n    this.updateFieldPart(index, { InputType: inputName });\r\n  }\r\n\r\n  hints = computedObj('hints', () => {\r\n    const fields = this.fields();\r\n    return fields.map((field, i) => {\r\n      const dataType = this.dataTypes().find(dataType => dataType.name === field.Type);\r\n      const inputType = this.#inputTypeOptions().find(option => option.inputType === field.InputType);\r\n      return {\r\n        data: dataType?.description ?? '',\r\n        input: inputType?.isObsolete\r\n          ? `OBSOLETE - ${inputType.obsoleteMessage}`\r\n          : inputType?.description ?? '',\r\n      } satisfies Hints;\r\n    });\r\n  });\r\n\r\n  getInputTypeOption(inputName: string) {\r\n    return this.#inputTypeOptions().find(option => option.inputType === inputName);\r\n  }\r\n\r\n  closeDialog() {\r\n    this.dialog.close();\r\n  }\r\n\r\n  saveAndClose() {\r\n    this.saving.set(true);\r\n    this.snackBar.open('Saving...');\r\n\r\n    // Prepare finalize-action to reuse below\r\n    const doneAndClose = () => {\r\n      this.saving.set(false);\r\n      this.snackBar.open('Saved', null, { duration: 2000 });\r\n      this.closeDialog();\r\n    }\r\n\r\n    if (this.editMode != null) {\r\n      const field = this.fields()[0];\r\n      if (this.editMode === 'name') {\r\n        this.#typesFieldsSvc\r\n          .rename(field.Id, this.#contentTypeRouteName().Id, field.StaticName)\r\n          .subscribe(() => doneAndClose());\r\n      } else if (this.editMode === 'inputType') {\r\n        this.#typesFieldsSvc\r\n          .updateInputType(field.Id, field.StaticName, field.InputType)\r\n          .subscribe(() => doneAndClose());\r\n      }\r\n    } else {\r\n      of(...this.fields())\r\n        .pipe(\r\n          filter(field => !!field.StaticName),\r\n          concatMap(field =>\r\n            this.#typesFieldsSvc.add(field, this.#contentTypeRouteName().Id).pipe(catchError(_ => of(null)))\r\n          ),\r\n          toArray(),\r\n        )\r\n        .subscribe(() => doneAndClose());\r\n    }\r\n  }\r\n\r\n  #watchKeyboardShortcuts(): void {\r\n    this.dialog.keydownEvents().subscribe(event => {\r\n      if (isCtrlEnter(event) && this.canSave()) {\r\n        event.preventDefault();\r\n        this.saveAndClose();\r\n      }\r\n    });\r\n  }\r\n}"],"x_google_ignoreList":[2,3]}