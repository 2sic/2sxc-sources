{"version":3,"file":"main.6e1a9a7e9fd47f4c.js","mappings":"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AKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IACnFC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,KAAMC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC5FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,KAAMC,OAAG,KAAMC,OAAG,KAAMC,OAAG,KACtFC,OAAG,KAAMC,OAAG,KAAMC,OAAG,KAAMC,OAAG,KAAMC,OAAG,KAAMC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAChFC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IACnFC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,KAAMC,OAAG,KACpFC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC3FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC3FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,KAAMC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC5FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC3FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC3FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,KAAMC,OAAG,IAC5FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC3FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC3FC,OAAG,IAAKC,OAAG,KAAMC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC5FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,KAAMC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC5FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,QAAI,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC5FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC3FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,KAAMC,OAAG,KAC5FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,KAAMC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC5FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC3FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC3FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC3FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,KAAMC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,KAAMC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC7FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC3FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC3FC,OAAG,IAAKC,OAAG,KAAMC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC5FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC3FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,KAAMC,OAAG,KAAMC,OAAG,IAAKC,OAAG,KAC7FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC3FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,KAAMC,OAAG,IAAKC,OAAG,KAAMC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC7FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC3FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC3FC,OAAG,KAAMC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC5FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IACnBC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,KAAMC,OAAG,KAAMC,OAAG,KAAMC,OAAG,KAAMC,OAAG,KAAMC,OAAG,KAAMC,OAAG,KAAMC,OAAG,KAC1FC,OAAG,KAAMC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC5FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC3FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC3FC,OAAG,IAAKC,OAAG,KAAMC,OAAG,KAAMC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC7FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC3FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,KAAMC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC5FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC3FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,KAAMC,OAAG,IAAKC,OAAG,IAC5FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC3FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,KAAMC,OAAG,IAAKC,OAAG,IAC5FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC3FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC3FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,KAAMC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC5FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC3FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,KAAMC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC5FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,KAAMC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC5FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC3FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC3FC,OAAG,KAAMC,OAAG,KAAMC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,KAAMC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC9FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC3FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC3FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,KAAMC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC5FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC3FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC3FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,KAAMC,OAAG,IAAKC,OAAG,KAAMC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC7FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,KAAMC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC5FC,OAAG,KAAMC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,KAAMC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC7FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAC3FC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,IAAKC,OAAG,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","names":["logManager","storePrefix","LogManager","getSpecs","specs","lm","singleton","existing","cache","name","configured","state","merged","enabled","win","window","constructor","this","StateManagerSession","updateSpecs","updatedSpecs","Object","keys","forEach","isEqual","add","allSpecs","allConfigured","mergeAllSpecs","mergedSpecs","key","startsWith","specsOfConfigured","stateCache","map","k","configure","toggle","cached","logSpecs","all","load","getAll","requireFeature","unlicensedFeatures","FeaturesService","#dialogConfigSvc","disableAutoLoad","log","classLog","transient","DialogConfigAppService","#dialogContext","signal","#reqFeaturesForm","signalObj","#reqFeaturesFields","#reqFeatures","computedObj","req","allowed","filter","f","allowUse","missing","nameId","some","aIf","hasUnlicensedFeatures","length","isEnabled","ComputedCacheHelper","buildProxy","Features","find","fnIf","a","getCurrent$","subscribe","ds","Context","dialogContext","formData","set","RequiredFeatures","feature","reason","l","current","includes","update","d","end","getCurrent","featureNameId","i0","i1","factory","fac","token","injector","inject","Injector","create","providers","parent","get","undefined","self","HttpServiceBaseSignal","http","HttpClient","context","#dnnContext","DnnContext","apiUrl","$2sxc","appId","toString","zoneId","newHttpResource","request","httpResource","postSignal","endpoint","body","options","initial","target","post","getStatusPromise","httpOptions","observe","firstValueFrom","then","response","status","catch","error","console","e","Promise","resolve","fetchPromise","reject","ItemIdHelper","editId","id","EntityId","newFromType","contentType","prefill","ContentTypeName","Prefill","newJsonFromType","data","ClientData","save","duplicate","newMetadataFromInfo","contentTypeName","itemFor","For","Target","targetType","TargetType","keyType","eavConstants","keyTypes","guid","Guid","number","Number","parseInt","string","String","newMetadata","typeName","keyDef","createFor","Singleton","constructMetadataInfo","values","metadata","m","relationship","field","index","Parent","Field","Index","Add","copy","DuplicateEntity","FeaturesDisableAutoLoadService","providedIn","commonSpecs","DialogTypeConstants","Zone","Apps","AppImport","App","ContentType","ContentItems","Edit","ItemHistory","Develop","PipelineDesigner","Replace","InstanceList","prefix","keyZoneId","keyContentBlockId","keyModuleId","keyAppId","keyDebug","keyDialog","keyContentType","keyItems","keyPartOfPage","keyPublishing","keyFilters","keyPipelineId","keyUrl","keyIsShared","keyExtras","partOfPageDefault","keySettings","GlobalConfigService","snackBar","debugState","isDebug","computed","allowDebugMode","debugEnabled","debugEnabled$","toObservable","sessionStorage","getItem","allowDebug","allow","oldConfig","newConfig","toggleDebugEnabled","open","duration","iconsFontAwesome","AppIconsService","matIconRegistry","domSanitizer","setDefaultFontSetClass","entries","svg","addSvgIconLiteral","bypassSecurityTrustHtml","i2","AppComponent","SxcAppComponent","#subscriptions","#titleSvc","#appIconsSvc","el","dnnContext","router","activatedRoute","super","preConfigure","moduleId","contentBlockId","Subscription","Title","isLoading","initRoot","ngOnInit","appTitle","getTitle","events","pipe","event","NavigationEnd","child","firstChild","snapshot","title","setTitle","ngOnDestroy","unsubscribe","i3","selectors","features","decls","vars","consts","template","rf","ctx","AppComponent_Conditional_0_Template","AppComponent_Conditional_1_Template","RouterModule","MatProgressSpinnerModule","i4","styles","changeDetection","AppEntryRouteHandler","processEntryUrl","handleLongEntryRouteWithState","handleNonNormalEntryParamRoute","transferToSession","#processEntryUrl","location","hash","#logInitialRoute","#handleNonNormalEntryParamRoute","sS","eavKeys","urlHash","removeItem","setItem","href","paramsDic","UrlHelpers","urlParamsToDic","substring","#transferToSession","Router","dialog","items","go","route","extras","navigate","RouteLinkHelper","routeRoot","extrasZone","JSON","parse","tab","extrasApp","scope","editItems","formUrl","convertFormToUrl","repItem","queryParams","grpItem","alert","totalPopup","close","finalRoute","split","routeParts","mid","cbid","isNaN","ctxAll","Error","url","queryParametersFromUrl","paramKey","paramValue","full","routes","path","loadChildren","__webpack_require__","bind","appAdministrationRoutes","appsManagementRoutes","importRoutes","codeEditorRoutes","visualQueryRoutes","replaceContentRoutes","manageContentRoutes","contentItemsRoutes","contentTypeFieldsRoutes","historyRoutes","EditRoutesRoot","SetHeadersInterceptor","intercept","next","FormData","handle","reqWithJsonContentType","clone","setHeaders","appConfig","provideRouter","importProvidersFrom","BrowserModule","BrowserAnimationsModule","TranslateModule","forRoot","forChild","buildTranslateConfiguration","loader","provide","TranslateLoader","useFactory","deps","defaultLanguage","isolate","translateLoaderFactory","TranslateLoaderWithErrorHandling","sxcVersion","SxcHttpInterceptorProvider","provideAppInitializer","provideHttpClient","withInterceptorsFromDi","HTTP_INTERCEPTORS","useClass","multi","HandleErrorsInterceptor","LocationStrategy","HashLocationStrategy","MAT_FORM_FIELD_DEFAULT_OPTIONS","useValue","subscriptSizing","OVERLAY_DEFAULT_CONFIG","usePopover","environment","production","enableProdMode","bootstrapApplication","provideZoneChangeDetection","err","routeTo","SystemSettingsScopes","Site","EditApiKeyPaths","GoogleTranslate","GoogleMaps","outDataSource","Description","EntityGuid","In","Name","PartAssemblyAndType","PrimaryType","VisualDesignerData","Top","Left","Width","dataSourceDifficulties","default","advanced","attribute","label","app","entity","zone","language","cmsObject","hint","appMetadata","LightSpeed","scopes","value","configuration","contentTypes","appConfiguration","permissions","query","settings","resources","systemSettings","systemResources","customSettings","customResources","formulas","notes","imageDecorator","pipelineDesigner","outFinalTarget","Difficulty","DynamicIn","OutMode","EnableConfig","HelpLink","Icon","Out","TypeNameForUi","UiHint","defaultPipeline","dataSources","streamWiring","From","To","testParameters","editDialog","initContext","panelSize","panelClass","getComponent","_asyncToGenerator","EditEntryComponent","logger","hasGuidAndId","editRouteMatcherRoot","editRouteMatcherRootRefresh","editRouteMatcherSubEdit","editRouteMatcherSubEditRefresh","posEdit","posPurpose","posAppId","checkRelevantAndIds","rNull","match","consumed","slice","hasPurpose","posParams","identities","r","matchEditSub","purpose","hasDetails","hasUpdate","detailsEntityGuid","detailsFieldId","updateEntityGuid","updateFieldId","segments","reloadRoutes","loadComponent","EditReloadComponent","editRoutesDialogAndChildren","DialogEntryComponent","EditRoutes","matcher","matchEditSubRefresh","children","EditRoutesNoHistory","history","matchEditRootV2","matchEditRootRefreshV2","EditRoutesUnderAppsList","matchEditRoot","matchEditRootRefresh","StateManager","storage","configName","#storeKey","#cache","#load","#save","remove","reset","getNamesInStoreWithPrefix","Array","from","stringify","StateManagerLocal","localStorage","DialogConfigGlobalService","HttpServiceBase","globalConfigService","dialogSettings$","svcId","getShared$","#getDialogSettings","shareReplay","refCount","reqBy","getHttpApiUrl","params","dlgSettings","Language","List","IsEnabled","tap","Enable","DebugMode","contextSvcShared","initialValue","named","sig","equal","debugName","computation","comp","sigAny","SIGNAL","computedWithPrev","previous","newValue","getVersion","version","init","parentContext","ready","parentId","contextId","_zoneId","#routeNum","_appId","tabId","env","page","_contentBlockId","_moduleId","routeSnapshot","#clearCachedValues","#sessionNumber","result","num","paramName","paramMap","stripNonUrlCharacters","controlValue","allowPath","trimEnd","rexSeparators","latinizeText","toLowerCase","replace","input","latinMap","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","e","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","p","decodeURIComponent","getUrlParams","qs","join","tokens","re","exec","replaceUrlParam","pattern","RegExp","search","indexOf","getUrlPrefix","area","eavConfig","systemRoot","portalRoot","appRoot","appSharedRoot","endsWith","newUrlIfCurrentContainsOldUrl","oldEditUrl","newEditUrl","currentUrl","calculatePathFromRoot","lastIndex","lastIndexOf","lastChild","pathFromRoot","urlSegment","suffix","getTranslation","lang","catchError","warn","of","IGNORED_STATUSES","HttpContextToken","excludedUrls","ignoredStatuses","throwError","checkIfExcluded","showDetailedHttpError","excludedUrl","infoText","srvResp","msg","Message","msgDet","MessageDetail","ExceptionMessage","ParamEncoder","encode","text","decode","UrlParamBase64","json","btoa","encodeURIComponent","base64","paddedBase64","atob","PREFILL_PREFIX","GROUP_PREFIX","UIFIELDS_PREFIX","PARAM_PREFIX","COPY_PREFIX","SAVE_PREFIX","DATA_PREFIX","VAL_SEPARATOR","LIST_SEPARATOR","toOrderedParams","form","fn","item","asGroup","asItem","asInboundParams","fields","UiFields","parameters","Parameters","addTypicalUrlGroups","addItem","overrideData","parts","getParamForMetadata","forSuffix","buildForSuffix","Metadata","getParamForOldMetadata","toLocaleLowerCase","prefill2UrlParams","obj2UrlParams","fields2UrlParams","obj","prefillFromUrlParams","addTo","prefillParams","decodedValue","isNumber","maybeNumber","test","convertUrlToForm","innerItem","option","hasParam5Id","addParamToItemIdentifier","push","editItem","part","newParams","forParams","forKeyType","forKey","forSingleton","rSilent","formParams","dataEncoded","__ngFactoryType__","proxy","#proxy","Proxy","_","fieldName","getOrCreate","getOrCreateWithInfo","isNew","delete","clear","FnLoggerNoOp","intro","message","showData","rTrue","rFalse","RxTapDebug","jsonify","generateFn","subName","source","counter","rxTap","distinctUntilChanged","start","step","read","ClassLoggerNoop","enableChildren","extendName","addOn","inherit","forceEnable","aIfInList","list","subKey","fnCond","condition","fnIfInList","fnIfInFields","consoleLogObject","callStack","show","groupCollapsed","trace","groupEnd","FnLoggerReal","fnName","#a","autoPad","nameWithSvcId","ClassLoggerReal","#enabled","#setEnabled","Math","random","#rename","#ifInSpecs","#ifInSpecsList","listName","owner","pleaseUseClassLogEnabled","mainSpecs","classLogEnabled"],"ignoreList":[],"sourceRoot":"webpack:///","sources":["./projects/eav-ui/src/app/shared/logging/log-manager.ts","./projects/eav-ui/src/app/features/features.service.ts","./projects/core/transient.ts","./projects/eav-ui/src/app/shared/services/http-service-base-signal.ts","./projects/eav-ui/src/app/shared/models/item-id-helper.ts","./projects/eav-ui/src/app/features/features-disable-autoload.service.ts","./projects/eav-ui/src/app/shared/logging/index.ts","./projects/eav-ui/src/app/shared/constants/dialog-type.constants.ts","./projects/eav-ui/src/app/shared/constants/session.constants.ts","./projects/eav-ui/src/app/shared/services/global-config.service.ts","./projects/eav-ui/src/app/shared/icons/index.ts","./projects/eav-ui/src/app/assets/icons/code-curly.svg","./projects/eav-ui/src/app/shared/icons/app-icons.service.ts","./projects/eav-ui/src/app/app.html","./projects/eav-ui/src/app/app.ts","./projects/eav-ui/src/app/app-entry-route-handler.ts","./projects/eav-ui/src/app/app.routes.ts","./projects/eav-ui/src/app/shared/interceptors/set-headers.interceptor.ts","./projects/eav-ui/src/app/app.config.ts","./projects/eav-ui/src/app/shared/translation/translate-configuration.ts","./projects/eav-ui/src/app/shared/translation/translate-loader-factory.ts","./projects/eav-ui/src/main.ts","./projects/eav-ui/src/app/shared/routing/route-link-helper.ts","./projects/eav-ui/src/app/shared/constants/eav.constants.ts","./projects/eav-ui/src/app/edit/edit-dialog.config.ts","./projects/eav-ui/src/app/edit/routing/edit-route-matchers.ts","./projects/eav-ui/src/app/edit/edit.routing.ts","./projects/eav-ui/src/app/shared/user/state-manager.ts","./projects/eav-ui/src/app/app-administration/services/dialog-config-global.service.ts","./projects/eav-ui/src/app/app-administration/services/dialog-config-app.service.ts","./projects/eav-ui/src/environments/environment.prod.ts","./projects/eav-ui/src/app/shared/signals/signal.utilities.ts","./projects/eav-ui/src/app/shared/services/context.ts","./projects/eav-ui/src/app/edit/shared/helpers/url.helpers.ts","./projects/eav-ui/src/app/shared/translation/translate-loader-with-error-handling.ts","./projects/eav-ui/src/app/shared/interceptors/handle-errors.interceptor.ts","./projects/eav-ui/src/app/shared/helpers/param-encoder.ts","./projects/eav-ui/src/app/shared/helpers/url-param-base64.ts","./projects/eav-ui/src/app/shared/helpers/url-prep.helper.ts","./projects/eav-ui/src/app/shared/services/http-service-base.ts","./projects/eav-ui/src/app/shared/signals/computed-cache.ts","./projects/eav-ui/src/app/shared/logging/fn/fn-logger-noop.ts","./projects/eav-ui/src/app/shared/logging/rx-debug-dbg.ts","./projects/eav-ui/src/app/shared/logging/class/class-logger-noop.ts","./projects/eav-ui/src/app/shared/logging/output-console.ts","./projects/eav-ui/src/app/shared/logging/fn/fn-logger-real.ts","./projects/eav-ui/src/app/shared/logging/class/class-logger-real.ts","./projects/eav-ui/src/app/shared/logging/logging.ts"],"sourcesContent":["import { LogSpecs } from './log-specs';\r\nimport { StateManagerSession, StateManager } from '../user/state-manager';\r\nimport isEqual from 'lodash-es/isEqual';\r\n\r\nlet logManager: LogManager;\r\nconst storePrefix = 'logSpecs';\r\n\r\nexport class LogManager {\r\n  /**\r\n   * Main external function to get the specs for activating a logger.\r\n   *\r\n   * Goal are\r\n   * - to register the logger - so the UI can show that it exists.\r\n   * - to get any alternate specs for the logger, in case the UI changes the settings.\r\n   *\r\n   * @param specs initial / default specs according to code\r\n   * @returns\r\n   */\r\n  static getSpecs<T>(specs: LogSpecs<T>): LogSpecs<T> {\r\n    const lm = LogManager.singleton();\r\n\r\n    if (lm.debug) debugger;\r\n\r\n    // Check if we already did all the merge etc.\r\n    // and should just return the existing specs\r\n    const existing = lm.cache[specs.name] as LogSpecs<T>;\r\n    if (existing) return existing;\r\n\r\n    // Check if we have a configured version of the specs\r\n    const configured = lm.state.cache[specs.name] as LogSpecs<T>;\r\n\r\n    const merged: LogSpecs<T> = {\r\n      enabled: false,\r\n      ...specs,\r\n      ...configured,\r\n    };\r\n    lm.cache[specs.name] = merged;\r\n\r\n    return merged;\r\n  }\r\n\r\n  /** Get access to the singleton log manager */\r\n  static singleton(): LogManager {\r\n    if (logManager) return logManager;\r\n\r\n    // Since the code for the logger could be in multiple bundles, we must ensure we only have one instance\r\n    const win: { logManager: LogManager } = window as any;\r\n\r\n    if (win.logManager) return (logManager = win.logManager);\r\n\r\n    win.logManager = logManager = new LogManager();\r\n    return logManager;\r\n  }\r\n\r\n  /** Ensures that this class can only be constructed here */\r\n  private constructor() {}\r\n\r\n  private cache: Record<string, LogSpecs<unknown>> = {};\r\n\r\n  public state: StateManager<LogSpecs<unknown>> = new StateManagerSession(\r\n    storePrefix\r\n  );\r\n\r\n  debug: false;\r\n\r\n  /** Updates the in-memory specs and saves them to the state */\r\n  updateSpecs(updatedSpecs: Record<string, LogSpecs<unknown>>): void {\r\n    // Iterate through the updated specs to ensure all changes are reflected\r\n    Object.keys(updatedSpecs).forEach((name) => {\r\n      const existing = this.cache[name];\r\n\r\n      // Only update if the log specs are different\r\n      if (!isEqual(existing?.specs, updatedSpecs[name].specs)) {\r\n        this.cache[name] = updatedSpecs[name];\r\n        this.state.add(name, updatedSpecs[name]);\r\n      }\r\n    });\r\n  }\r\n\r\n  /** Get all specs */\r\n  get allSpecs() {\r\n    return this.cache;\r\n  }\r\n\r\n  get allConfigured() {\r\n    return this.state.cache;\r\n  }\r\n\r\n  /** Merged version of all configured and cached specs */\r\n  get mergeAllSpecs() {\r\n    const mergedSpecs: Record<string, LogSpecs<unknown>> = { ...this.cache };\r\n\r\n    Object.keys(this.state.cache).forEach((name) => {\r\n      mergedSpecs[name] = {\r\n        ...mergedSpecs[name],\r\n        ...this.state.cache[name],\r\n      };\r\n    });\r\n\r\n    // Removes all user Configs, because they are saved with the logs\r\n    Object.keys(mergedSpecs).forEach((key) => {\r\n      if (key.startsWith(storePrefix)) {\r\n        delete mergedSpecs[key];\r\n      }\r\n    });\r\n    return mergedSpecs;\r\n  }\r\n\r\n  get specsOfConfigured() {\r\n    const stateCache = this.state.cache;\r\n    return Object.keys(stateCache).map((k) => this.cache[k] || stateCache[k]);\r\n  }\r\n\r\n  configure<T>(specs: LogSpecs<T>) {\r\n    delete this.cache[specs.name];\r\n    this.state.add(specs.name, specs);\r\n  }\r\n\r\n  toggle(name: string): boolean;\r\n  toggle(name: string, state: boolean): boolean;\r\n  toggle(name: string, state?: boolean): boolean {\r\n    const cached = this.cache[name];\r\n    const configured = this.state.cache[name];\r\n    const enabled = state ?? !configured?.enabled;\r\n    const specs = configured?.specs || cached?.specs || {};\r\n    const newConfig = {\r\n      name,\r\n      enabled,\r\n      specs,\r\n    };\r\n    this.configure(newConfig);\r\n    return state;\r\n  }\r\n}\r\n","import { Injectable, Signal, signal } from '@angular/core';\r\nimport { Of, transient } from '../../../../core';\r\nimport { DialogConfigAppService } from '../app-administration/services/dialog-config-app.service';\r\nimport { EavEditLoadDto, RequiredFeatures } from '../edit/dialog/main/edit-dialog-main.models';\r\nimport { classLog } from '../shared/logging';\r\nimport { DialogContext } from '../shared/models/dialog-settings.model';\r\nimport { ComputedCacheHelper } from '../shared/signals/computed-cache';\r\nimport { computedObj, signalObj } from '../shared/signals/signal.utilities';\r\nimport { FeatureNames } from './feature-names';\r\nimport { FeaturesDisableAutoLoadService } from './features-disable-autoload.service';\r\nimport { FeatureSummary } from './models/feature-summary.model';\r\n\r\nconst logSpecs = {\r\n  all: false,\r\n  constructor: true,\r\n  load: false,\r\n  getAll: false,\r\n  requireFeature: true,\r\n  unlicensedFeatures: true,\r\n};\r\n\r\n/**\r\n * Service to provide information about enabled/disabled features.\r\n */\r\n@Injectable()\r\nexport class FeaturesService {\r\n\r\n  log = classLog({FeaturesService}, logSpecs);\r\n\r\n  #dialogConfigSvc = transient(DialogConfigAppService);\r\n\r\n  constructor(disableAutoLoad: FeaturesDisableAutoLoadService) {\r\n    this.log.fnIf('constructor');\r\n\r\n    // If auto-load is disable (special edge case when opening the dialog directly to the edit-form)\r\n    // then don't do this, because in some cases the person opening the dialog doesn't have the necessary permission.\r\n    if (!disableAutoLoad.disableAutoLoad)\r\n      this.#dialogConfigSvc.getCurrent$().subscribe(ds => this.load(ds.Context));\r\n    else\r\n      this.log.a('auto-load disabled');\r\n  }\r\n\r\n  load(dialogContext: DialogContext, formData?: EavEditLoadDto) {\r\n    this.log.fnIf('load', { formData, dialogContext });\r\n    this.#dialogContext.set(dialogContext);\r\n    this.#reqFeaturesForm.set(formData?.RequiredFeatures ?? {} as RequiredFeatures);\r\n  }\r\n\r\n  // Provide context information and ensure that previously added data is always available\r\n  #dialogContext = signal<DialogContext>(null);\r\n\r\n  /** Required features specified by the entire form */\r\n  #reqFeaturesForm = signalObj('reqFeaturesForm', {} as RequiredFeatures);\r\n\r\n  /** Required features specified by specific fields */\r\n  #reqFeaturesFields = signalObj('reqFeaturesFields', {} as RequiredFeatures);\r\n\r\n  /** All required features merged */\r\n  #reqFeatures = computedObj<RequiredFeatures>('requiredFeatures', () => {\r\n    const req = this.#reqFeaturesForm();\r\n    const fields = this.#reqFeaturesFields();\r\n    return {...req, ...fields};\r\n  });\r\n\r\n  requireFeature(feature: Of<typeof FeatureNames>, reason: string) {\r\n    const l = this.log.fnIf('requireFeature', { feature, reason });\r\n    const current = this.#reqFeaturesFields();\r\n    if (!Object.keys(current).includes(feature))\r\n      this.#reqFeaturesFields.update(current => ({...current, [feature]: [reason]}));\r\n    else if (!current[feature].includes(reason))\r\n      this.#reqFeaturesFields.update(current => ({...current, [feature]: [...current[feature], reason]}));\r\n    l.end('final', this.#reqFeaturesFields());\r\n  }\r\n\r\n\r\n  public unlicensedFeatures = computedObj<string[]>('unlicensedFeatures', () => {\r\n    const req = this.#reqFeatures();\r\n    const allowed = this.getAll()().filter(f => f.allowUse);\r\n    const missing = Object.keys(req).filter(nameId => !allowed.some(f => f.nameId === nameId));\r\n    this.log.aIf('unlicensedFeatures', { req, allowed, missing });\r\n    return missing;\r\n  });\r\n\r\n  public hasUnlicensedFeatures = computedObj('hasUnlicensedFeatures', () => this.unlicensedFeatures().length > 0);\r\n\r\n  getAll(): Signal<FeatureSummary[]> {\r\n    this.log.fnIf('getAll');\r\n    return computedObj('all-features', () => this.#dialogContext()?.Features ?? []);\r\n  }\r\n\r\n  getCurrent(featureNameId: string): FeatureSummary {\r\n    return this.#dialogContext()?.Features.find(f => f.nameId === featureNameId);\r\n  }\r\n\r\n  /**\r\n   * Property providing enabled, which behaves like a Record<string, Signal<boolean>>.\r\n   */\r\n  public isEnabled = new ComputedCacheHelper<Of<typeof FeatureNames>, boolean>('isEnabledCache').buildProxy(nameId => () => {\r\n    return this.#dialogContext()?.Features.find(f => f.nameId === nameId)?.isEnabled ?? false;\r\n  });\r\n\r\n  /**\r\n   * Property providing allowUse, which behaves like a Record<string, Signal<boolean>>.\r\n   * This is primarily meant for the field-wrapper, which\r\n   * - should show warnings etc. if not allowed\r\n   * - but in edge cases it is allowed, eg. when editing data on a system content-type\r\n   */\r\n  public allowUse = new ComputedCacheHelper<Of<typeof FeatureNames>, boolean>('isEnabledCache').buildProxy(nameId => () => {\r\n    return this.#dialogContext()?.Features.find(f => f.nameId === nameId)?.allowUse ?? false;\r\n  });\r\n\r\n}\r\n","import { Injector, ProviderToken, TypeProvider, inject } from '@angular/core';\r\n\r\n/**\r\n * Transient dependency injection provider.\r\n * This will create a new instance of the provided token,\r\n * without making it available in sub-components\r\n * as would happen with providers in a component.\r\n * \r\n * @param token the class which is injectable\r\n * @param injector the injector to use, if not provided, the current injector will be used.\r\n *     Not not necessary when using transient in the class properties construction or in the constructor,\r\n *     as the injector will be available in the constructor.\r\n *     But necessary when using transient inside anything else.\r\n * @returns \r\n */\r\nexport function transient<T>(token: ProviderToken<T>, injector?: Injector): T {\r\n  // make sure we have an injector\r\n  // this will throw an error, if transient is used outside of construction and without providing an injector\r\n  injector ??= inject(Injector);\r\n\r\n  // create a new injector which is only meant to be used for this transient instance\r\n  const subInjector = Injector.create({\r\n    providers: [\r\n      token as TypeProvider\r\n    ],\r\n    parent: injector\r\n  });\r\n\r\n  // return the instance\r\n  return subInjector.get(token, undefined, { self: true });\r\n}\r\n","import { Context as DnnContext } from '@2sic.com/sxc-angular';\r\nimport { HttpClient, httpResource } from '@angular/common/http';\r\nimport { inject, Injectable, Injector, Signal, signal } from '@angular/core';\r\nimport { firstValueFrom } from 'rxjs';\r\nimport { Context } from '../../shared/services/context';\r\n\r\n/**\r\n * Base class for all services that need to make HTTP calls.\r\n * Provides important typical information and services, especially\r\n * * apiUrl(name) - to get the full API URL\r\n * * appId - the current app id\r\n * * zoneId - the current zone id\r\n */\r\n@Injectable()\r\nexport class HttpServiceBaseSignal {\r\n\r\n  protected http = inject(HttpClient);\r\n  protected context = inject(Context);\r\n\r\n  // Retrieves the current Angular Injector instance from the DI system and stores it as a protected property.\r\n  // This allows you to create instances (e.g., services) later in this specific context.\r\n  protected injector = inject(Injector);\r\n\r\n  #dnnContext = inject(DnnContext);\r\n\r\n  /**\r\n   * Convert a short 2sxc-url into the correct full URL on the system.\r\n   * @param name 2sxc-style short url\r\n   * @returns\r\n   */\r\n  protected apiUrl(name: string) {\r\n    return this.#dnnContext.$2sxc.http.apiUrl(name);\r\n  }\r\n\r\n  /**\r\n   * The current app id\r\n   */\r\n  protected get appId() { return this.context.appId.toString(); }\r\n\r\n  /**\r\n   * The current zone id\r\n   */\r\n  protected get zoneId() { return this.context.zoneId.toString(); }\r\n\r\n  /**\r\n * NEW V20 Helper method to create an httpResource<T> with additional options such as a custom injector.\r\n * Advantage: If the httpResource API changes in the future, you only need to update this method in one place.\r\n * @param request - The request callback or object for httpResource<T>. \r\n *                  The signature is identical to the first parameter of httpResource<T>.\r\n * @returns A new httpResource<T> signal with centrally configurable options.\r\n */\r\n  protected newHttpResource<T>(request: Parameters<typeof httpResource>[0]) {\r\n    return httpResource<T>(request, { injector: this.injector });\r\n  }\r\n\r\n  /**   \r\n   *  Makes an HTTP GET request and returns a Signal with the response body of type T\r\n   * @param endpoint - The API endpoint path (will be combined with base URL)\r\n   *  @param options - Angular HttpClient options (headers, params, etc.)\r\n   * @param initial - Initial value for the Signal before the HTTP call\r\n   * @returns Signal that resolves to the HTTP response body of type T\r\n  */\r\n  protected postSignal<ResultType>(endpoint: string, body: Parameters<typeof this.http.post>[1], options: Parameters<typeof this.http.post>[2], initial: ResultType): Signal<ResultType> {\r\n    const target = signal<ResultType>(initial);\r\n    this.http.post<ResultType>(this.apiUrl(endpoint), body, options).subscribe(d => {\r\n      target.set(d)\r\n    });\r\n    return target;\r\n  }\r\n\r\n  /**\r\n   * Makes an HTTP GET request and returns a Promise with just the status code\r\n   * @param endpoint - The API endpoint path(will be combined with base URL)\r\n   * @param options - Angular HttpClient options(headers, params, etc.)\r\n   * @returns Promise that resolves to the HTTP status code(or error status code)\r\n  */\r\n  protected getStatusPromise(\r\n    endpoint: string,\r\n    options?: Parameters<typeof this.http.get>[1]\r\n  ): Promise<number> {\r\n    try {\r\n      // Ensure observe: 'response' is included in the options\r\n      const httpOptions = {\r\n        ...options,\r\n        observe: 'response' as const\r\n      };\r\n      // Convert the Observable returned by HttpClient to a Promise\r\n      return firstValueFrom(\r\n        this.http.get(this.apiUrl(endpoint), httpOptions)\r\n      )\r\n        .then(response => response.status)\r\n        .catch(error => {\r\n          console.error(`HTTP error in getStatusPromise:`, error);\r\n          return error?.status ?? 500;\r\n        });\r\n    } catch (e: any) {\r\n      // This catch handles any synchronous errors\r\n      console.error(`Error in getStatusPromise:`, e);\r\n      return Promise.resolve(500);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Makes an HTTP GET request and returns a Promise with the response body of type T\r\n   * @param endpoint - The API endpoint path (will be combined with base URL)\r\n   * @param options - Angular HttpClient options (headers, params, etc.)\r\n   * @returns Promise that resolves to the HTTP response body of type T (or rejects/returns null on error)\r\n   */\r\n  protected fetchPromise<T>(\r\n    endpoint: string,\r\n    options?: Parameters<typeof this.http.get>[1]\r\n  ): Promise<T> {\r\n    try {\r\n      // Ensure observe: 'body' is used (default for HttpClient.get)\r\n      const httpOptions = {\r\n        ...options,\r\n        observe: 'body' as const\r\n      };\r\n      // Convert the Observable returned by HttpClient to a Promise\r\n      return firstValueFrom(\r\n        this.http.get<T>(this.apiUrl(endpoint), httpOptions)\r\n      ).catch(error => {\r\n        console.error(`HTTP error in fetchPromise:`, error);\r\n        // You can throw, return null, or handle as you wish\r\n        throw error;\r\n      });\r\n    } catch (e: any) {\r\n      // Handles synchronous errors\r\n      console.error(`Error in fetchPromise:`, e);\r\n      return Promise.reject(e);\r\n    }\r\n  }\r\n}\r\n","import { Of } from 'projects/core';\r\nimport { MetadataInfo } from '../../content-items/create-metadata-dialog/create-metadata-dialog.models';\r\nimport { EavFor } from '../../edit/shared/models/eav';\r\nimport { eavConstants, MetadataKeyDefinition, MetadataKeyTypes } from '../constants/eav.constants';\r\nimport { ItemAddIdentifier, ItemEditIdentifier, ItemInListIdentifier } from './edit-form.model';\r\n\r\n// 2dm - new helper to reduce code when creating item identifiers\r\n\r\nexport class ItemIdHelper {\r\n\r\n  static editId(id: number): ItemEditIdentifier {\r\n    return { EntityId: id } satisfies ItemEditIdentifier;\r\n  }\r\n\r\n  /**\r\n   * Get the item identifier for adding a new item of the specified content type\r\n   * @param contentType\r\n   * @param prefill\r\n   * @returns\r\n   */\r\n  static newFromType(contentType: string, prefill?: Record<string, unknown>): ItemAddIdentifier {\r\n    return {\r\n      ContentTypeName: contentType,\r\n      ...(prefill && { Prefill: prefill })\r\n    } satisfies ItemAddIdentifier;\r\n  }\r\n\r\n  /**\r\n   * Get the item identifier to add/edit a json-based item of the specified content type\r\n   * @param contentType\r\n   * @param prefill\r\n   * @returns\r\n   */\r\n  static newJsonFromType(contentType: string, data: unknown, prefill?: Record<string, unknown>): ItemAddIdentifier {\r\n    const basics = {\r\n      ...this.newFromType(contentType, prefill),\r\n      ClientData: {\r\n        save: 'js',\r\n        duplicate: true,\r\n        data,\r\n      }\r\n    } as ItemAddIdentifier;\r\n    return basics;\r\n  }\r\n\r\n  static newMetadataFromInfo(contentTypeName: string, itemFor: MetadataInfo): ItemAddIdentifier {\r\n    return {\r\n      ContentTypeName: contentTypeName,\r\n      For: {\r\n        Target: itemFor.target ?? itemFor.targetType.toString(),\r\n        TargetType: itemFor.targetType,\r\n        ...(itemFor.keyType === eavConstants.keyTypes.guid && { Guid: itemFor.key }),\r\n        ...(itemFor.keyType === eavConstants.keyTypes.number && { Number: parseInt(itemFor.key, 10) }),\r\n        ...(itemFor.keyType === eavConstants.keyTypes.string && { String: itemFor.key }),\r\n      },\r\n    };\r\n  }\r\n\r\n  static newMetadata<T>(key: T, typeName: string, keyDef: MetadataKeyDefinition, singleton?: boolean): ItemAddIdentifier {\r\n    return {\r\n      ContentTypeName: typeName,\r\n      For: ItemIdHelper.createFor(keyDef, key, singleton),\r\n    } satisfies ItemAddIdentifier;\r\n  }\r\n\r\n  static createFor<T>(keyDef: MetadataKeyDefinition, key: T, singleton?: boolean): EavFor {\r\n    return {\r\n      Target: keyDef.target,\r\n      TargetType: keyDef.targetType,\r\n      ...(\r\n        typeof (key) == 'number'\r\n          ? { Number: key as number }\r\n          : keyDef.keyType == 'guid'\r\n            ? { Guid: key as string }\r\n            : { String: key as string }\r\n      ),\r\n      ...(singleton && { Singleton: true })\r\n    } satisfies EavFor;\r\n  }\r\n\r\n  static constructMetadataInfo(targetType: number, keyType: Of<typeof MetadataKeyTypes>, key: string): MetadataInfo {\r\n    const specs = Object.values(eavConstants.metadata).find(m => m.targetType === targetType);\r\n    return {\r\n      target: specs?.target ?? targetType.toString(),\r\n      targetType: targetType,\r\n      key: key,\r\n      keyType: keyType,\r\n    } satisfies MetadataInfo;\r\n  }\r\n\r\n  static relationship(parent: string, field: string, index: number = 0, add: boolean = null): ItemInListIdentifier {\r\n    return {\r\n      Parent: parent,\r\n      Field: field,\r\n      Index: index,\r\n      Add: add,\r\n    } satisfies ItemInListIdentifier;\r\n  }\r\n\r\n  static copy(contentType: string, id: number): ItemAddIdentifier {\r\n    return {\r\n      ContentTypeName: contentType,\r\n      DuplicateEntity: id,\r\n    } satisfies ItemAddIdentifier;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\n\r\n/**\r\n * Experimental\r\n */\r\n@Injectable({ providedIn: 'root' })\r\nexport class FeaturesDisableAutoLoadService {\r\n  disableAutoLoad = false;\r\n}","/*\r\n * Internal API Surface of logging.\r\n *\r\n * Please make sure you only use this index file for imports in typescripts outside of this folder.\r\n * This is just for consistency.\r\n */\r\n\r\nexport { ClassLogger } from './class/class-logger';\r\nexport { FnLogger } from './fn/fn-logger.interface';\r\nexport * from './logging';\r\n\r\nexport const commonSpecs = {\r\n  all: false,\r\n  constructor: false,\r\n};","export const DialogTypeConstants = {\r\n  Zone: 'zone',\r\n  Apps: 'apps',\r\n  AppImport: 'app-import',\r\n  App: 'app',\r\n  ContentType: 'contenttype',\r\n  ContentItems: 'contentitems',\r\n  Edit: 'edit',\r\n  ItemHistory: 'item-history',\r\n  Develop: 'develop',\r\n  PipelineDesigner: 'pipeline-designer',\r\n  Replace: 'replace',\r\n  InstanceList: 'instance-list',\r\n} as const /* the as const ensures that the keys/values can be strictly checked */;\r\n","// TODO: @someday Change constants to be a object with these keys\r\n// to make code which uses them clearer that these are global constants\r\n\r\nexport const prefix = 'eav-';\r\nexport const keyZoneId = `${prefix}zoneId`;\r\nexport const keyContentBlockId = `${prefix}cbid`;\r\nexport const keyModuleId = `${prefix}mid`;\r\nexport const keyAppId = `${prefix}appId`;\r\nexport const keyDebug = `${prefix}debug`;\r\nexport const keyDialog = `${prefix}dialog`;\r\nexport const keyContentType = `${prefix}contentType`;\r\nexport const keyItems = `${prefix}items`;\r\nexport const keyPartOfPage = `${prefix}partOfPage`;\r\nexport const keyPublishing = `${prefix}publishing`;\r\nexport const keyFilters = `${prefix}filters`;\r\nexport const keyPipelineId = `${prefix}pipelineId`;\r\n\r\n/** WIP v16.01 */\r\nexport const keyEditFields = `${prefix}uifields`;\r\n\r\n/** Url which opened the dialog. Used for debugging */\r\nexport const keyUrl = `${prefix}url`;\r\n\r\n/** This is used by file editor to determine if it's editing shared files or of that portal only */\r\nexport const keyIsShared = `${prefix}isshared`;\r\n\r\n/** \r\n * Contains extra parameters for dialogs.\r\n * Example: { tab: 'settings' } or { scope: 'global' } - this would be for the data admin dialog.\r\n */\r\nexport const keyExtras = `${prefix}extras`;\r\n\r\n/** Fallback value in case it is missing in url */\r\nexport const partOfPageDefault = 'false';\r\n\r\n/** Language settings - multiple values (JSON), WIP 18.03 */\r\nexport const keySettings = `${prefix}settings`;\r\n\r\n/**\r\n * NOTE: WIP\r\n * - v18.03 already introduced the various language parameters, but I believe there is as of v20 no case where this is passed in.\r\n * - v20 trying to introduce save behavior\r\n */\r\nexport interface DialogUiSettings {\r\n  /** enable / disable the language-dialog button */\r\n  languageUserSettings?: boolean | string;\r\n  languageUi?: string;\r\n  languageForm?: string;\r\n\r\n  /**\r\n   * Save behavior for the dialog.\r\n   * - `false` means it will not save the form.\r\n   * - `/any/path` means it will save the form to that path.\r\n   */\r\n  save: string;\r\n}","import { Injectable, computed, signal } from '@angular/core';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { toObservable } from '@angular/core/rxjs-interop';\r\nimport { keyDebug } from '../constants/session.constants';\r\n\r\n\r\n@Injectable({ providedIn: 'root' })\r\nexport class GlobalConfigService {\r\n\r\n  private debugState = signal<GlobalConfig>(null);\r\n\r\n  isDebug = computed(() => !!this.debugState()?.allowDebugMode && !!this.debugState()?.debugEnabled);\r\n\r\n  /** This observable is a left-over, try to remove once more is refactored */\r\n  debugEnabled$ = toObservable(this.isDebug);\r\n\r\n  constructor(private snackBar: MatSnackBar) {\r\n    const initial: GlobalConfig = {\r\n      id: 0,\r\n      debugEnabled: sessionStorage.getItem(keyDebug) === 'true',\r\n      allowDebugMode: false,\r\n    };\r\n    this.debugState.set(initial);\r\n  }\r\n\r\n  allowDebug(allow: boolean): void {\r\n    const oldConfig = this.debugState();\r\n    if (oldConfig.allowDebugMode === allow)\r\n      return;\r\n\r\n    const newConfig: GlobalConfig = {\r\n      ...oldConfig,\r\n      allowDebugMode: allow,\r\n    };\r\n    this.debugState.set(newConfig);\r\n  }\r\n\r\n  toggleDebugEnabled(): void {\r\n    const oldConfig = this.debugState();\r\n    if (!oldConfig.allowDebugMode) {\r\n      this.snackBar.open('You do not have permissions to enter developer mode', null, { duration: 3000 });\r\n      return;\r\n    }\r\n\r\n    const newConfig: GlobalConfig = {\r\n      ...oldConfig,\r\n      debugEnabled: !oldConfig.debugEnabled,\r\n    };\r\n    this.debugState.set(newConfig);\r\n    this.snackBar.open(newConfig.debugEnabled ? 'developer mode on' : 'developer mode off', null, { duration: 3000 });\r\n  }\r\n}\r\n\r\ninterface GlobalConfig {\r\n  id: 0;\r\n  debugEnabled: boolean;\r\n  allowDebugMode: boolean;\r\n}\r\n","// Font-Awesome\r\nimport codeCurly from '!raw-loader!../../assets/icons/code-curly.svg';\r\n\r\nexport const iconsFontAwesome: Record<string, string> = {\r\n  'code-curly': codeCurly,\r\n};\r\n","export default \"<svg width=\\\"24\\\" height=\\\"24\\\" viewBox=\\\"0 0 24 24\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\">\\r\\n<path d=\\\"M2.98187 13.2188C3.38292 13.2083 3.70844 13.1016 3.95844 12.8984C4.21365 12.6901 4.38292 12.4062 4.46625 12.0469C4.54958 11.6875 4.59385 11.0729 4.59906 10.2031C4.60427 9.33333 4.6199 8.76042 4.64594 8.48438C4.69281 8.04688 4.77875 7.69531 4.90375 7.42969C5.03396 7.16406 5.19281 6.95312 5.38031 6.79688C5.56781 6.63542 5.8074 6.51302 6.09906 6.42969C6.29698 6.3776 6.6199 6.35156 7.06781 6.35156H7.50531V7.57812H7.26312C6.72146 7.57812 6.36208 7.67708 6.185 7.875C6.00792 8.06771 5.91937 8.5026 5.91937 9.17969C5.91937 10.5443 5.89073 11.4062 5.83344 11.7656C5.73969 12.3229 5.57823 12.7526 5.34906 13.0547C5.1251 13.3568 4.77094 13.625 4.28656 13.8594C4.85948 14.099 5.27354 14.4661 5.52875 14.9609C5.78917 15.4505 5.91937 16.2552 5.91937 17.375C5.91937 18.3906 5.92979 18.9948 5.95062 19.1875C5.99229 19.5417 6.09646 19.7891 6.26312 19.9297C6.435 20.0703 6.76833 20.1406 7.26312 20.1406H7.50531V21.3672H7.06781C6.5574 21.3672 6.1876 21.3255 5.95844 21.2422C5.6251 21.1224 5.34906 20.9271 5.13031 20.6562C4.91156 20.3906 4.76833 20.0521 4.70062 19.6406C4.63812 19.2292 4.60427 18.5547 4.59906 17.6172C4.59385 16.6797 4.54958 16.0312 4.46625 15.6719C4.38292 15.3125 4.21365 15.0286 3.95844 14.8203C3.70844 14.612 3.38292 14.5026 2.98187 14.4922V13.2188ZM8.05344 18V16.3984H9.655V18H8.05344ZM11.2266 18V16.3984H12.8281V18H11.2266ZM14.3997 18V16.3984H16.0012V18H14.3997ZM21.0103 13.2188V14.4922C20.6093 14.5026 20.2811 14.612 20.0259 14.8203C19.7759 15.0286 19.6093 15.3125 19.5259 15.6719C19.4426 16.026 19.3983 16.638 19.3931 17.5078C19.3879 18.3776 19.3723 18.9505 19.3462 19.2266C19.2994 19.6693 19.2108 20.0208 19.0806 20.2812C18.9556 20.5469 18.7994 20.7578 18.6119 20.9141C18.4244 21.0755 18.1848 21.1979 17.8931 21.2812C17.6952 21.3385 17.3723 21.3672 16.9244 21.3672H16.4869V20.1406H16.7291C17.2707 20.1406 17.6301 20.0417 17.8072 19.8438C17.9843 19.651 18.0728 19.2135 18.0728 18.5312C18.0728 17.2292 18.0962 16.4036 18.1431 16.0547C18.2265 15.4766 18.3931 15.0156 18.6431 14.6719C18.8931 14.3229 19.2473 14.0521 19.7056 13.8594C19.1067 13.5729 18.6848 13.1953 18.44 12.7266C18.1952 12.2526 18.0728 11.4557 18.0728 10.3359C18.0728 9.32031 18.0598 8.71354 18.0337 8.51562C17.9973 8.16667 17.8931 7.92448 17.7212 7.78906C17.5546 7.64844 17.2239 7.57812 16.7291 7.57812H16.4869V6.35156H16.9244C17.4348 6.35156 17.8046 6.39323 18.0337 6.47656C18.3671 6.59115 18.6431 6.78385 18.8619 7.05469C19.0806 7.32552 19.2212 7.66667 19.2837 8.07812C19.3515 8.48958 19.3879 9.16406 19.3931 10.1016C19.3983 11.0391 19.4426 11.6875 19.5259 12.0469C19.6093 12.401 19.7759 12.6823 20.0259 12.8906C20.2811 13.099 20.6093 13.2083 21.0103 13.2188Z\\\"/>\\r\\n</svg>\\r\\n\";","import { Injectable } from '@angular/core';\r\nimport { MatIconRegistry } from '@angular/material/icon';\r\nimport { DomSanitizer } from '@angular/platform-browser';\r\nimport { iconsFontAwesome } from '.';\r\n\r\n@Injectable()\r\nexport class AppIconsService {\r\n  constructor(private matIconRegistry: MatIconRegistry, private domSanitizer: DomSanitizer) { }\r\n\r\n  load() {\r\n    // v18.01 - changing to Material Symbols\r\n    // this.matIconRegistry.setDefaultFontSetClass('material-icons-outlined');\r\n    this.matIconRegistry.setDefaultFontSetClass('material-symbols-outlined');\r\n\r\n    Object.entries(iconsFontAwesome).forEach(([name, svg]) => {\r\n      this.matIconRegistry.addSvgIconLiteral(name, this.domSanitizer.bypassSecurityTrustHtml(svg));\r\n    });\r\n  }\r\n}\r\n","@if (isLoading()) {\r\n  <div class=\"lading-indicator\">\r\n    <mat-spinner></mat-spinner>\r\n  </div>\r\n} @else {\r\n  <router-outlet></router-outlet>\r\n}\r\n","import { Context as DnnContext, SxcAppComponent } from '@2sic.com/sxc-angular';\r\nimport { ChangeDetectionStrategy, Component, ElementRef, OnDestroy, OnInit, signal } from '@angular/core';\r\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\r\nimport { Title } from '@angular/platform-browser';\r\nimport { ActivatedRoute, NavigationEnd, Router, RouterModule } from '@angular/router';\r\nimport { filter, map, Subscription } from 'rxjs';\r\nimport { transient } from '../../../core';\r\nimport { keyContentBlockId, keyModuleId } from './shared/constants/session.constants';\r\nimport { AppIconsService } from './shared/icons/app-icons.service';\r\nimport { Context } from './shared/services/context';\r\n\r\n@Component({\r\n  selector: 'app-root',\r\n  templateUrl: './app.html',\r\n  styleUrls: ['./app.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n  imports: [\r\n    RouterModule,\r\n    MatProgressSpinnerModule\r\n  ]\r\n})\r\nexport class AppComponent extends SxcAppComponent implements OnInit, OnDestroy {\r\n  #subscriptions = new Subscription();\r\n\r\n  #titleSvc = transient(Title);\r\n  #appIconsSvc = transient(AppIconsService);\r\n\r\n  // loader signal\r\n  isLoading = signal(true);\r\n\r\n  constructor(\r\n    el: ElementRef,\r\n    dnnContext: DnnContext,\r\n    private context: Context,\r\n    private router: Router,\r\n    private activatedRoute: ActivatedRoute,\r\n  ) {\r\n    super(\r\n      el,\r\n      dnnContext.preConfigure({\r\n        moduleId: parseInt(sessionStorage.getItem(keyModuleId) || '-1234', 10),\r\n        contentBlockId: parseInt(sessionStorage.getItem(keyContentBlockId) || '-1234', 10),\r\n      }),\r\n    );\r\n    this.context.initRoot();\r\n    this.#appIconsSvc.load();\r\n  }\r\n\r\n  ngOnInit() {\r\n    // Mostly copied from https://blog.bitsrc.io/dynamic-page-titles-in-angular-98ce20b5c334\r\n    // Routes need a data: { title: '...' } for this to work\r\n    const appTitle = this.#titleSvc.getTitle(); // initial title when loading the page\r\n    this.#subscriptions.add(\r\n      this.router.events.pipe(\r\n        filter(event => event instanceof NavigationEnd),\r\n        map(() => {\r\n          let child = this.activatedRoute.firstChild;\r\n          while (child?.firstChild)\r\n            child = child.firstChild;\r\n          return child?.snapshot.data['title'] ?? appTitle;\r\n        }),\r\n      ).subscribe((title: string) => {\r\n        this.#titleSvc.setTitle(title);\r\n        this.isLoading.set(false);\r\n      })\r\n    );\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.#subscriptions.unsubscribe();\r\n  }\r\n}","import { Injector } from '@angular/core';\r\nimport { NavigationExtras, Router } from '@angular/router';\r\nimport { Of } from '../../../core';\r\nimport { UrlHelpers } from './edit/shared/helpers/url.helpers';\r\nimport { DialogTypeConstants } from './shared/constants/dialog-type.constants';\r\nimport { keyAppId, keyContentBlockId, keyContentType, keyDialog, keyExtras, keyItems, keyModuleId, keyPipelineId, keyUrl, keyZoneId, prefix } from './shared/constants/session.constants';\r\nimport { convertFormToUrl } from './shared/helpers/url-prep.helper';\r\nimport { classLog } from './shared/logging';\r\nimport { EavWindow } from './shared/models/eav-window.model';\r\nimport { EditForm, ItemEditIdentifier, ItemInListIdentifier } from './shared/models/edit-form.model';\r\nimport { ExtrasParam } from './shared/routing/dialog-url-params.model';\r\nimport { RouteContextInfo } from './shared/routing/route-context-info';\r\nimport { RouteLinkHelper } from './shared/routing/route-link-helper';\r\n\r\ndeclare const window: EavWindow;\r\n\r\n/**\r\n * Handler for entry URLs when the App loads.\r\n * Previously (before Angular 19) implemented as APP_INITIALIZER\r\n * Changed to be a standalone object 2025-03-20 v19.03.03\r\n */\r\nexport class AppEntryRouteHandler {\r\n  log = classLog({ AppEntryRouteHandler }, {\r\n    all: true,\r\n    constructor: false,\r\n    processEntryUrl: false,\r\n    handleLongEntryRouteWithState: false,\r\n    handleNonNormalEntryParamRoute: false,\r\n    transferToSession: false,\r\n  });\r\n\r\n  /**\r\n   * Constructor, will call initializer\r\n   */\r\n  constructor(private injector: Injector) {\r\n    const l = this.log.fnIf('constructor');\r\n    this.#processEntryUrl();\r\n    l.end();\r\n  }\r\n\r\n  /**\r\n   * Initializer\r\n   * Will automatically do url checks and perform redirects if necessary\r\n   */\r\n  #processEntryUrl() {\r\n    const l = this.log.fnIf('processEntryUrl', null, 'Setting parameters config and clearing route');\r\n    \r\n    // Case 1: Check if the url does not start with \"#/\" in which case it must be rewritten\r\n    const isNotNormalRoute = !window.location.hash.startsWith('#/');\r\n    if (isNotNormalRoute) {\r\n      this.#logInitialRoute();\r\n      this.handleLongEntryRouteWithState();\r\n      return l.end();\r\n    }\r\n    \r\n    // Case 2: Not normal entry-Param-Route\r\n    // sessionStorage has no data, additional info seems to be behind ##\r\n    // not sure how this would ever be hit...? 2025-03-20\r\n    const eavKeys = Object.keys(sessionStorage).filter(key => key.startsWith(prefix));\r\n    if (eavKeys.length === 0) {\r\n      this.#logInitialRoute();\r\n      this.#handleNonNormalEntryParamRoute();\r\n      return l.end();\r\n    }\r\n\r\n    // Case 3: Normal entry-Param-Route - but refresh\r\n    l.a('No Params Route, but params saved..., assume refresh of previously working UI');\r\n    // Log initial route so a developer can re-open the dialog with the link in the console\r\n    this.#logInitialRoute(sessionStorage.getItem(keyUrl));\r\n    l.end();\r\n  }\r\n\r\n\r\n  /**\r\n   * Handle long entry route with state - usually coming from the in-page toolbars\r\n   * Will transfer the URL parameters to session storage and redirect to the expected dialog\r\n   */\r\n  handleLongEntryRouteWithState() {\r\n    const l = this.log.fnIf('handleLongEntryRouteWithState');\r\n\r\n    const sS = sessionStorage;\r\n    const eavKeys = Object.keys(sS).filter(key => key.startsWith(prefix));\r\n    const urlHash = window.location.hash;\r\n  \r\n    l.a('is Params Route - will process', { urlHash, eavKeys });\r\n\r\n    // Flush our part of the session, just to be sure it's a clean slate\r\n    for (const key of eavKeys)\r\n      sS.removeItem(key);\r\n\r\n    // save url which opened the dialog and set edit dialog as the default\r\n    sS.setItem(keyUrl, window.location.href);\r\n    sS.setItem(keyDialog, DialogTypeConstants.Edit);\r\n\r\n    // Transfer URL params to session storage, without the leading '#' char\r\n    const paramsDic = UrlHelpers.urlParamsToDic(urlHash.substring(1));\r\n    this.#transferToSession(paramsDic);\r\n\r\n    // Redirect to the expected dialog\r\n    const router = this.injector.get(Router);\r\n    const dialog = sS.getItem(keyDialog) as Of<typeof DialogTypeConstants>;\r\n    const contentType = sS.getItem(keyContentType);\r\n    const items = sS.getItem(keyItems);\r\n\r\n    // New 2025-03-20; centralize code to create full route\r\n    const getFull = () => new RouteLinkHelper().routeRoot({\r\n      zoneId: sS.getItem(keyZoneId),\r\n      moduleId: sS.getItem(keyModuleId),\r\n      contentBlockId: sS.getItem(keyContentBlockId),\r\n      appId: sS.getItem(keyAppId),\r\n    } satisfies RouteContextInfo);\r\n    l.a('dialog: ' + dialog);\r\n\r\n    function go(route: string, extras?: NavigationExtras) {\r\n      router.navigate([`${getFull()}${route}`], extras);\r\n      l.end(dialog);\r\n    }\r\n\r\n    switch (dialog) {\r\n      case DialogTypeConstants.Zone:\r\n        const extrasZone: ExtrasParam = JSON.parse(sS.getItem(keyExtras));\r\n        return go(`/apps${extrasZone?.tab ? `/${extrasZone.tab}` : ''}`);\r\n\r\n      case DialogTypeConstants.Apps:\r\n        return go(`/apps/list`);\r\n\r\n      case DialogTypeConstants.AppImport:\r\n        return go(`/import`);\r\n\r\n      case DialogTypeConstants.App:\r\n        const extrasApp: ExtrasParam = JSON.parse(sS.getItem(keyExtras));\r\n        return go(`/app${extrasApp?.tab ? `/${extrasApp.tab}` : ''}${extrasApp?.scope ? `/${extrasApp.scope}` : ''}`);\r\n\r\n      case DialogTypeConstants.ContentType:\r\n        return go(`/fields/${contentType}`);\r\n\r\n      case DialogTypeConstants.ContentItems:\r\n        return go(`/items/${contentType}`);\r\n\r\n      case DialogTypeConstants.Edit:\r\n        const editItems: ItemEditIdentifier[] = JSON.parse(items);\r\n        const formUrl = convertFormToUrl({ items: editItems } satisfies EditForm);\r\n        return go(`/edit/${formUrl}`);\r\n\r\n      case DialogTypeConstants.ItemHistory:\r\n        const historyItems: ItemEditIdentifier[] = JSON.parse(items);\r\n        return go(`/versions/${historyItems[0].EntityId}`);\r\n\r\n      case DialogTypeConstants.Develop:\r\n        return go(`/code`);\r\n\r\n      case DialogTypeConstants.PipelineDesigner:\r\n        const pipelineId = sS.getItem(keyPipelineId);\r\n        return go(`/query/${pipelineId}`);\r\n\r\n      case DialogTypeConstants.Replace:\r\n        const repItem = (JSON.parse(items) as ItemInListIdentifier[])[0];\r\n        const queryParams = repItem.Add ? { add: true } : {};\r\n        return go(`/${repItem.Parent}/${repItem.Field}/${repItem.Index}/replace`, { queryParams });\r\n\r\n      case DialogTypeConstants.InstanceList:\r\n        const grpItem = (JSON.parse(items) as ItemInListIdentifier[])[0];\r\n        return go(`/${grpItem.Parent}/${grpItem.Field}/${grpItem.Index}/reorder`);\r\n        \r\n      default:\r\n        alert(`Cannot open unknown dialog \"${dialog}\"`);\r\n        try {\r\n          window.parent.$2sxc.totalPopup.close();\r\n        } catch (error) { }\r\n        return l.end(`error: ${dialog}`);\r\n    }\r\n  }\r\n\r\n  // Note: 2025-03-20 not clear what this is for\r\n  // - it seems to indicate that there are URLs with ## in them, but I can't see where\r\n  // - but I can't seem to find a case where this is used\r\n  // - so I ported it from the previous code, but couldn't really test / verify it\r\n  // added console.error to spot if we ever see this\r\n  // 2025-12-23 2pp had a screenshot showing this message, but we still don't know why he saw it...\r\n  // also not sure if it actually found anything after the ##\r\n  #handleNonNormalEntryParamRoute() {\r\n    console.error('This code is believed to be unused - if you see this warning, please inform @ijungleboy and note what you clicked before you saw this message');\r\n    const l = this.log.fnIf('handleNonNormalEntryParamRoute');\r\n    // if not params route and no params are saved, e.g. browser was reopened,\r\n    // check if we have additional context info in the url behind a ##\r\n    const urlHash = window.location.hash;\r\n    const urlWithCtx = urlHash.split('##')\r\n    const finalRoute = urlWithCtx[0].substring(1);\r\n    // url is like '/73/v2/42/-42/770/app/data/...'\r\n    // or is like  '/73/v2/0/42/-42/770/apps/data/...'\r\n    const routeParts = finalRoute.split('/');\r\n    const zoneId = routeParts[1];\r\n    const mid = routeParts[3];\r\n    const cbid = routeParts[4];\r\n    const appId = routeParts[5];\r\n    if (!isNaN(+mid) && !isNaN(+cbid) && !isNaN(+appId)) {\r\n      l.a('No Params Route and no params saved, but found context info in url, will process', { urlHash });\r\n      const ctxAll = `zoneId=${zoneId}&appId=${appId}&mid=${mid}&cbid=${cbid}`;\r\n      l.a('found ##', { urlHash, ctxAll, finalRoute });\r\n      this.#transferToSession(UrlHelpers.urlParamsToDic(ctxAll));\r\n      const router = this.injector.get(Router);\r\n      router.navigate([finalRoute]);\r\n      return l.end();\r\n    }\r\n\r\n    // if not params route and no params are saved, e.g. browser was reopened, throw error\r\n    l.a('No Params Route and no params saved...');\r\n    alert('Missing required url parameters. Please reopen dialog.');\r\n    throw new Error('Missing required url parameters. Please reopen dialog.');\r\n  }\r\n\r\n  /** Log initial route so a developer can re-open the dialog with the link in the console */\r\n  #logInitialRoute(url?: string): void {\r\n    console.log('Initial route:', url ?? window.location.href);\r\n  }\r\n  \r\n  /** Helper to transfer various url-parameters to the session */\r\n  #transferToSession(queryParametersFromUrl: Record<string, string>): void {\r\n    const l = this.log.fnIf('transferToSession', { queryParametersFromUrl });\r\n    for (const [paramKey, paramValue] of Object.entries(queryParametersFromUrl))\r\n      if (paramValue != null)\r\n        sessionStorage.setItem(prefix + paramKey, paramValue);\r\n    l.end();\r\n  }\r\n\r\n}\r\n\r\n","import { Routes } from '@angular/router';\r\nimport { EditRoutesRoot } from './edit/edit.routing';\r\n\r\nconst zoneApp = `:zoneId/:appId`;\r\nconst full = `:zoneId/v2/:moduleId/:blockId/:appId`;\r\n\r\nexport const routes: Routes = [\r\n  // OLD - maybe still in use... (this is only use of `zoneApp`, can probably be removed but must be tested)\r\n  {\r\n    path: `${zoneApp}/app`,\r\n    loadChildren: () => import('./app-administration/app-administration.routing').then(m => m.appAdministrationRoutes),\r\n    data: { title: 'App' },\r\n  },\r\n\r\n  // NEW\r\n  \r\n  {\r\n    path: `${full}/apps`,\r\n    loadChildren: () => import('./apps-management/apps-management.routing').then(m => m.appsManagementRoutes),\r\n    data: { title: 'Apps' },\r\n  },\r\n  {\r\n    path: `${full}/import`,\r\n    loadChildren: () => import('./import-app/import-app.routing').then(m => m.importRoutes),\r\n    data: { title: 'Import App' },\r\n  },\r\n \r\n  {\r\n    path: `${full}/app`,\r\n    loadChildren: () => import('./app-administration/app-administration.routing').then(m => m.appAdministrationRoutes),\r\n    data: { title: 'App' },\r\n  },\r\n  {\r\n    path: `${full}/code`,\r\n    loadChildren: () => import('./code-editor/code-editor.routing').then(m => m.codeEditorRoutes),\r\n\r\n    data: { title: 'Code Editor' },\r\n  },\r\n  {\r\n    path: `${full}/query/:pipelineId`,\r\n    loadChildren: () => import('./visual-query/visual-query.routing').then(m => m.visualQueryRoutes),\r\n    data: { title: 'Visual Query' },\r\n  },\r\n  {\r\n    path: `${full}/:guid/:part/:index/replace`,\r\n    loadChildren: () => import('./replace-content/replace-content.routing').then(m => m.replaceContentRoutes),\r\n\r\n    data: { title: 'Apps' },\r\n  },\r\n  {\r\n    path: `${full}/:guid/:part/:index/reorder`,\r\n    loadChildren: () => import('./manage-content-list/manage-content-list.routing').then(m => m.manageContentRoutes),\r\n    data: { title: 'Reorder Items' },\r\n  },\r\n  {\r\n    path: `${full}/items/:contentTypeStaticName`,\r\n    loadChildren: () => import('./content-items/content-items.routing').then(m => m.contentItemsRoutes),\r\n    data: { title: 'Items' },\r\n  },\r\n  {\r\n    path: `${full}/fields/:contentTypeStaticName`,\r\n    loadChildren: () => import('./content-type-fields/content-type-fields.routing').then(m => m.contentTypeFieldsRoutes),\r\n    data: { title: 'Fields' },\r\n  },\r\n  {\r\n    path: `${full}/versions/:itemId`,\r\n    loadChildren: () => import('./item-history/item-history.routing').then(m => m.historyRoutes),\r\n  },\r\n  ...EditRoutesRoot,\r\n];\r\n\r\n","import { HttpEvent, HttpHandler, HttpInterceptor, HttpRequest } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { Observable } from 'rxjs';\r\n\r\n@Injectable()\r\nexport class SetHeadersInterceptor implements HttpInterceptor {\r\n\r\n  constructor() { }\r\n\r\n  intercept(req: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\r\n    // If sending files...\r\n    // Do not set content type so browser can add delimiter boundary automatically\r\n    if (req.body instanceof FormData)\r\n      return next.handle(req);\r\n\r\n    // Standard case: Make sure the server knows we want JSON\r\n    const reqWithJsonContentType = req.clone({\r\n      setHeaders: {\r\n        'Content-Type': 'application/json;charset=UTF-8',\r\n      }\r\n    });\r\n    return next.handle(reqWithJsonContentType);\r\n  }\r\n}\r\n","import { SxcHttpInterceptorProvider } from '@2sic.com/sxc-angular';\r\nimport { OVERLAY_DEFAULT_CONFIG } from '@angular/cdk/overlay';\r\nimport { HashLocationStrategy, LocationStrategy } from '@angular/common';\r\nimport { HTTP_INTERCEPTORS, provideHttpClient, withInterceptorsFromDi } from '@angular/common/http';\r\nimport { ApplicationConfig, importProvidersFrom, inject, Injector, provideAppInitializer } from '@angular/core';\r\nimport { MAT_FORM_FIELD_DEFAULT_OPTIONS } from '@angular/material/form-field';\r\nimport { BrowserModule } from '@angular/platform-browser';\r\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations';\r\nimport { provideRouter } from '@angular/router';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { AppEntryRouteHandler } from './app-entry-route-handler';\r\nimport { routes } from './app.routes';\r\nimport { FeaturesService } from './features/features.service';\r\nimport { HandleErrorsInterceptor } from './shared/interceptors/handle-errors.interceptor';\r\nimport { SetHeadersInterceptor } from './shared/interceptors/set-headers.interceptor';\r\nimport { Context } from './shared/services/context';\r\nimport { buildTranslateConfiguration } from './shared/translation';\r\nimport { translateLoaderFactory } from './shared/translation/translate-loader-factory';\r\n\r\nexport const appConfig: ApplicationConfig = {\r\n\r\n  providers: [\r\n    provideRouter(routes),\r\n    importProvidersFrom(\r\n      BrowserModule,\r\n      BrowserAnimationsModule,\r\n      TranslateModule.forRoot(),\r\n      TranslateModule.forChild(buildTranslateConfiguration(translateLoaderFactory)),\r\n    ),\r\n    SxcHttpInterceptorProvider,\r\n    Context,\r\n\r\n    // The feature service must be provided in root at first, so it's always there\r\n    // But certain dialogs will want to use their own.\r\n    FeaturesService,\r\n\r\n    // App Initializer which will convert long initial routes to nice routes\r\n    provideAppInitializer(() => { new AppEntryRouteHandler(inject(Injector)); }),\r\n\r\n    // Activate HTTP client & interceptors.\r\n    // it also uses 2sxc interceptors from the 2sxc module and some from here\r\n    provideHttpClient(withInterceptorsFromDi()),\r\n    { provide: HTTP_INTERCEPTORS, useClass: SetHeadersInterceptor, multi: true },\r\n    { provide: HTTP_INTERCEPTORS, useClass: HandleErrorsInterceptor, multi: true },\r\n\r\n    { provide: LocationStrategy, useClass: HashLocationStrategy },\r\n    { provide: MAT_FORM_FIELD_DEFAULT_OPTIONS, useValue: { subscriptSizing: 'dynamic' } },\r\n\r\n    // Special thing to avoid using popover in angular stuff, as it causes trouble with z-indexes\r\n    { provide: OVERLAY_DEFAULT_CONFIG, useValue: { usePopover: false /* Restores legacy overlay behavior */ } }\r\n  ],\r\n};\r\n","import { HttpClient } from '@angular/common/http';\r\nimport { TranslateLoader, TranslateModuleConfig } from '@ngx-translate/core';\r\n\r\nexport function buildTranslateConfiguration(factory: (http: HttpClient) => TranslateLoader): TranslateModuleConfig {\r\n  const config: TranslateModuleConfig = {\r\n    loader: {\r\n      provide: TranslateLoader,\r\n      useFactory: factory,\r\n      deps: [HttpClient],\r\n    },\r\n    defaultLanguage: 'en',\r\n    isolate: true,\r\n  };\r\n  return config;\r\n}\r\n","import { HttpClient } from \"@angular/common/http\";\r\nimport { TranslateLoader } from \"@ngx-translate/core\";\r\nimport { EavWindow } from \"../models/eav-window.model\";\r\nimport { TranslateLoaderWithErrorHandling } from \"./translate-loader-with-error-handling\";\r\n\r\ndeclare const window: EavWindow;\r\n\r\n// AoT requires an exported function for factories\r\n// at least according to https://github.com/ngx-translate/http-loader\r\nexport function translateLoaderFactory(http: HttpClient): TranslateLoader {\r\n  return new TranslateLoaderWithErrorHandling(http, './i18n/', `.js?${window.sxcVersion}`);\r\n}\r\n","import { enableProdMode, provideZoneChangeDetection } from '@angular/core';\r\nimport { bootstrapApplication } from '@angular/platform-browser';\r\nimport { AppComponent } from './app/app';\r\nimport { appConfig } from './app/app.config';\r\nimport { environment } from './environments/environment';\r\n\r\nif (environment.production)\r\n  enableProdMode();\r\n\r\nbootstrapApplication(AppComponent, {...appConfig, providers: [provideZoneChangeDetection(), ...appConfig.providers]})\r\n  .catch((err) => console.error(err));\r\n","import { RouteContextInfo } from './route-context-info';\r\n\r\nexport class RouteLinkHelper {\r\n\r\n  routeTo(context: RouteContextInfo, path: string) {\r\n    return `${this.routeRoot(context)}/${path}`;\r\n  }\r\n\r\n\r\n  routeRoot(context: RouteContextInfo) {\r\n    const route = `${context.zoneId}/v2/${context.moduleId}/${context.contentBlockId}/${context.appId}`;\r\n    return route;\r\n  }\r\n  \r\n}","import { Of } from \"../../../../../core\";\r\nimport { DataSourceInstance } from '../../visual-query/models/data-source-instance.model';\r\n\r\nexport const MetadataKeyTypes = {\r\n  Guid: 'guid',\r\n  String: 'string',\r\n  Number: 'number',\r\n} as const /* the as const ensures that the keys/values can be strictly checked */;\r\n\r\nexport interface ScopeOption {\r\n  name: string;\r\n  value: string;\r\n}\r\n\r\nexport const SystemSettingsScopes = {\r\n  App: 'app',\r\n  Site: 'site',\r\n} as const /* the as const ensures that the keys/values can be strictly checked */;\r\n\r\n\r\nexport const EditApiKeyPaths = {\r\n  GoogleTranslate: 'Settings.GoogleTranslate.ApiKey',\r\n  GoogleMaps: 'Settings.GoogleMaps.ApiKey',\r\n} as const;\r\n\r\nexport interface MetadataKeyDefinition {\r\n  targetType: number;\r\n  target: string;\r\n  label: string;\r\n  keyType: Of<typeof MetadataKeyTypes>;\r\n  hint?: string;\r\n}\r\n\r\n/** Prepare for reuse later */\r\nconst outDataSource = {\r\n  Description: 'The template/script which will show this data',\r\n  EntityGuid: 'Out',\r\n  In: ['Default', 'Header'],\r\n  Name: '2sxc Target (View or API)',\r\n  PartAssemblyAndType: 'SexyContentTemplate',\r\n  PrimaryType: 'Target',\r\n  VisualDesignerData: { Top: 20, Left: 200, Width: 700 },\r\n};\r\n\r\nconst dataSourceDifficulties = {\r\n  default: 100,\r\n  advanced: 200,\r\n};\r\n\r\nconst outFinalTarget: DataSourceInstance = {\r\n  ContentType: undefined,\r\n  Difficulty: dataSourceDifficulties.default,\r\n  DynamicIn: true,\r\n  OutMode: 'static',\r\n  EnableConfig: undefined,\r\n  HelpLink: undefined,\r\n  Icon: undefined,\r\n  In: outDataSource.In,\r\n  Name: outDataSource.Name,\r\n  Out: undefined,\r\n  PartAssemblyAndType: outDataSource.PartAssemblyAndType,\r\n  PrimaryType: outDataSource.PrimaryType,\r\n  TypeNameForUi: undefined,\r\n  UiHint: undefined,\r\n};\r\n\r\n\r\nexport const eavConstants = {\r\n  metadata: {\r\n    /** Metadata of Attribute */\r\n    // tslint:disable-next-line:max-line-length\r\n    attribute: { targetType: 2, target: 'EAV Field Properties', label: 'Content-Type Field/Attribute (2)', keyType: MetadataKeyTypes.Number },\r\n    /** Metadata of App */\r\n    app: { targetType: 3, target: 'App', label: 'App (3)', keyType: MetadataKeyTypes.Number },\r\n    /** Metadata of Entity */\r\n    entity: { targetType: 4, target: 'Entity', label: 'Entity (4)', keyType: MetadataKeyTypes.Guid },\r\n    /** Metadata of ContentType */\r\n    contentType: { targetType: 5, target: 'ContentType', label: 'Content-Type (5)', keyType: MetadataKeyTypes.String },\r\n    /** Metadata of Zone */\r\n    zone: { targetType: 6, target: 'Zone', label: 'Zone (6) - not used as of now', keyType: MetadataKeyTypes.Number },\r\n    /** Metadata of Language (a Dimension) */\r\n    language: { targetType: 8, target: 'Dimension', label: 'Language (8)', keyType: MetadataKeyTypes.String },\r\n    /** Metadata of CmsObject */\r\n    cmsObject: { targetType: 10, target: 'CmsObject', label: 'Cms Object (10)', keyType: MetadataKeyTypes.String, hint: 'Usually this is \"file:400\" or \"folder:4030\"' },\r\n  } satisfies Record<string, MetadataKeyDefinition>,\r\n\r\n  appMetadata: {\r\n    LightSpeed: { ContentTypeName: 'LightSpeedOutputDecorator' }\r\n  },\r\n\r\n  /** Lookup type for the metadata, e.g. key=80adb152-efad-4aa4-855e-74c5ef230e1f is keyType=guid */\r\n  keyTypes: {\r\n    guid: MetadataKeyTypes.Guid,\r\n    string: MetadataKeyTypes.String,\r\n    number: MetadataKeyTypes.Number,\r\n  },\r\n\r\n  /** Scopes */\r\n  scopes: {\r\n    /** This is the main schema and the data you usually see is from here */\r\n    default: { name: 'Default', value: 'Default' },\r\n    configuration: { name: 'Configuration (Views etc.)', value: 'System.Configuration' },\r\n  },\r\n\r\n  /** Content types where templates, permissions, etc. are stored */\r\n  contentTypes: {\r\n    /** Content type containing app's specifications */\r\n    appConfiguration: '2SexyContent-App',\r\n    /** Content type containing app's views */\r\n    template: '2SexyContent-Template',\r\n    /** Content type containing permissions */\r\n    permissions: 'PermissionConfiguration',\r\n    /** Content type containing queries */\r\n    query: 'DataPipeline',\r\n    /** Content type containing content type metadata */\r\n    contentType: 'ContentType',\r\n    /** Content type containing app's custom settings */\r\n    settings: 'App-Settings',\r\n    /** Content type containing app's custom resources */\r\n    resources: 'App-Resources',\r\n    /** Content type containing app's system settings */\r\n    systemSettings: 'SettingsSystem',\r\n    /** Content type containing app's system resources */\r\n    systemResources: 'ResourcesSystem',\r\n    /** Content type containing Primary and Global App custom settings */\r\n    customSettings: 'SettingsCustom',\r\n    /** Content type containing Primary and Global App custom resources */\r\n    customResources: 'ResourcesCustom',\r\n    /** Content type containing formulas */\r\n    formulas: 'UiFormula',\r\n    /** Content type containing notes */\r\n    notes: 'NoteDecorator',\r\n    /** Content type containing settings for image scaling */\r\n    imageDecorator: 'ImageDecorator',\r\n  },\r\n\r\n\r\n\r\n  pipelineDesigner: {\r\n    dataSourceDifficulties,\r\n    outDataSource,\r\n    /** Dummy target data */\r\n    outFinalTarget,\r\n    defaultPipeline: {\r\n      dataSources: [\r\n        {\r\n          EntityGuid: 'unsaved1',\r\n          PartAssemblyAndType: 'ToSic.Sxc.DataSources.CmsBlock, ToSic.Sxc',\r\n          VisualDesignerData: { Top: 170, Left: 440 },\r\n        }\r\n      ],\r\n      streamWiring: [\r\n        { From: 'unsaved1', Out: 'Header', To: 'Out', In: 'Header' },\r\n        { From: 'unsaved1', Out: 'Default', To: 'Out', In: 'Default' },\r\n      ],\r\n    },\r\n    testParameters: '[Demo:Demo]=true',\r\n  },\r\n};\r\n","import { Injector } from '@angular/core';\r\nimport { FeaturesDisableAutoLoadService } from '../features/features-disable-autoload.service';\r\nimport { DialogConfig } from '../shared/models/dialog-config.model';\r\n\r\n/**\r\n * Contains size definition and component reference for the edit dialog.\r\n */\r\nexport const editDialog: DialogConfig = {\r\n  name: 'ITEMS_EDIT_DIALOG',\r\n  initContext: true,\r\n  panelSize: 'custom',\r\n  panelClass: ['c-multi-item-dialog'],\r\n\r\n  /**\r\n   * Very special behavior - we need to be sure that the features-service does NOT auto-load the dialog-settings.\r\n   * This is because the edit dialog may be opened by a user who doesn't have the necessary permissions.\r\n   * @param injector \r\n   * @returns \r\n   */\r\n  async getComponent(injector: Injector) {\r\n    injector.get(FeaturesDisableAutoLoadService).disableAutoLoad = true\r\n\r\n    const { EditEntryComponent } = await import('./dialog/entry/edit-entry');\r\n    return EditEntryComponent;\r\n  }\r\n};\r\n","import { UrlMatchResult, UrlSegment } from '@angular/router';\r\nimport { classLog } from '../../shared/logging';\r\nimport { EditUrlParams } from './edit-url-params.model';\r\n\r\nconst logSpecs = {\r\n  all: true,\r\n  hasGuidAndId: false,\r\n  editRouteMatcherRoot: false,\r\n  editRouteMatcherRootRefresh: false,\r\n  editRouteMatcherSubEdit: false,\r\n  editRouteMatcherSubEditRefresh: false,\r\n};\r\n\r\nconst logger = classLog('EditRouteMatchers', logSpecs);\r\n\r\n/**\r\n * Matches:\r\n * - ':zoneId/:appId/edit/:items'\r\n * - ':zoneId/:appId/edit/:items/details/:detailsEntityGuid/:detailsFieldId'\r\n * - ':zoneId/:appId/edit/:items/update/:updateEntityGuid/:updateFieldId'\r\n */\r\nexport function matchEditRoot(url: UrlSegment[]): UrlMatchResult {\r\n  return editRouteMatcherRoot(url, 2, 4, 1);\r\n  // const l = logger.fnIf('editRouteMatcherRoot', { url });\r\n  // const specs = checkRelevantAndIds(url, 2, 4);\r\n  // if (specs == null) return l.rNull();\r\n  // const match: UrlMatchResult = {\r\n  //   consumed: url.slice(0, specs.hasPurpose ? 7 : 4),\r\n  //   posParams: {\r\n  //     zoneId: url[0],\r\n  //     appId: url[1],\r\n  //     items: url[3],\r\n  //     ...specs.identities,\r\n  //   } satisfies EditUrlParams<UrlSegment>,\r\n  // };\r\n  // return l.r(match, '');\r\n}\r\n\r\n/**\r\n * Matches:\r\n * - ':zoneId/v2/:mid/:cbid/:appId/edit/:items'\r\n * - ':zoneId/v2/:mid/:cbid/:appId/edit/:items/details/:detailsEntityGuid/:detailsFieldId'\r\n * - ':zoneId/v2/:mid/:cbid/:appId/edit/:items/update/:updateEntityGuid/:updateFieldId'\r\n */\r\nexport function matchEditRootV2(url: UrlSegment[]): UrlMatchResult {\r\n  return editRouteMatcherRoot(url, 5, 7, 4);\r\n  // const l = logger.fnIf('editRouteMatcherRoot', { url });\r\n  // const specs = checkRelevantAndIds(url, 5, 7);\r\n  // if (specs == null) return l.rNull();\r\n  // // debugger;\r\n  // const match: UrlMatchResult = {\r\n  //   consumed: url.slice(0, specs.hasPurpose ? 10 : 7),\r\n  //   posParams: {\r\n  //     zoneId: url[0],\r\n  //     appId: url[4],\r\n  //     items: url[6],\r\n  //     ...specs.identities,\r\n  //   } satisfies EditUrlParams<UrlSegment>,\r\n  // };\r\n  // return l.r(match, '');\r\n}\r\n\r\nfunction editRouteMatcherRoot(url: UrlSegment[], posEdit: number, posPurpose: number, posAppId: number): UrlMatchResult {\r\n  const l = logger.fnIf('editRouteMatcherRoot', { url });\r\n  const specs = checkRelevantAndIds(url, posEdit, posPurpose);\r\n  if (specs == null) return l.rNull();\r\n  const match: UrlMatchResult = {\r\n    consumed: url.slice(0, posPurpose + (specs.hasPurpose ? 3 : 0)),\r\n    posParams: {\r\n      zoneId: url[0],\r\n      appId: url[posAppId],\r\n      items: url[posAppId + 2],\r\n      ...specs.identities,\r\n    } satisfies EditUrlParams<UrlSegment>,\r\n  };\r\n  return l.r(match, '');\r\n}\r\n\r\n\r\n/**\r\n * Matches:\r\n * - 'edit/:items'\r\n * - 'edit/:items/details/:detailsEntityGuid/:detailsFieldId'\r\n * - 'edit/:items/update/:updateEntityGuid/:updateFieldId'\r\n */\r\nexport function matchEditSub(url: UrlSegment[]): UrlMatchResult {\r\n  const l = logger.fnIf('editRouteMatcherSubEdit', { url });\r\n  const specs = checkRelevantAndIds(url, 0, 2);\r\n  if (specs == null) return l.rNull();\r\n  const match: UrlMatchResult = {\r\n    consumed: url.slice(0, specs.hasPurpose ? 5 : 2),\r\n    posParams: {\r\n      items: url[1],\r\n      ...specs.identities,\r\n    } satisfies EditUrlParams<UrlSegment>,\r\n  };\r\n  return l.r(match, '');\r\n}\r\n\r\n/**\r\n * Determine if we're in an edit route, and if we have details/update data.\r\n * If we have it, the returned spread is a bit different for each use case as the parameter names differ.\r\n */\r\nfunction checkRelevantAndIds(url: UrlSegment[], posEdit: number, posPurpose: number) {\r\n  const l = logger.fnIf('hasGuidAndId', { url, posPurpose });\r\n  if (url.length < posPurpose) return l.rNull();\r\n  if (url[posEdit].path !== 'edit') return l.rNull();\r\n  const purpose = url[posPurpose]?.path;\r\n  if (purpose == null) return l.r({ hasPurpose: false, identities: {} });\r\n  const guid = url[posPurpose + 1];\r\n  const id = url[posPurpose + 2];\r\n  const hasGuidAndId = guid != null && id != null;\r\n  const hasDetails = purpose === 'details' && hasGuidAndId;\r\n  const hasUpdate = purpose === 'update' && hasGuidAndId;\r\n  const identities = {\r\n    ...(hasDetails && { detailsEntityGuid: guid, detailsFieldId: id }),\r\n    ...(hasUpdate && { updateEntityGuid: guid, updateFieldId: id }),\r\n  }\r\n  return l.r({ hasPurpose: hasDetails || hasUpdate, identities });\r\n}\r\n\r\n\r\n/** \r\n * Matches 'edit/refresh/:items'\r\n */\r\nexport function matchEditSubRefresh(url: UrlSegment[]): UrlMatchResult {\r\n  const l = logger.fnIf('editRouteMatcherSubEditRefresh', { url });\r\n  if (url.length < 3) return l.rNull();\r\n  if (url[0].path !== 'edit' || url[1].path !== 'refresh') return l.rNull();\r\n  const match: UrlMatchResult = {\r\n    consumed: url.slice(0, 3),\r\n    posParams: {\r\n      items: url[2],\r\n    } satisfies EditUrlParams<UrlSegment>,\r\n  };\r\n  return l.r(match, '');\r\n}\r\n\r\n/** \r\n * Matches ':zoneId/:appId/edit/refresh/:items'\r\n */\r\nexport function matchEditRootRefresh(url: UrlSegment[]): UrlMatchResult {\r\n  return editRouteMatcherRootRefresh(url, 5, 2, 1);\r\n  // const l = logger.fnIf('editRouteMatcherRootRefresh', { url });\r\n  // if (url.length < 5) return l.rNull();\r\n  // if (url[2].path !== 'edit' || url[3].path !== 'refresh') return l.rNull();\r\n  // const match: UrlMatchResult = {\r\n  //   consumed: url.slice(0, 5),\r\n  //   posParams: {\r\n  //     zoneId: url[0],\r\n  //     appId: url[1],\r\n  //     items: url[4],\r\n  //   } satisfies EditUrlParams<UrlSegment>,\r\n  // };\r\n  // return l.r(match, '');\r\n}\r\n\r\n/** \r\n * Matches ':zoneId/v2/:mid/:cbid/:appId/edit/refresh/:items'\r\n */\r\nexport function matchEditRootRefreshV2(url: UrlSegment[]): UrlMatchResult {\r\n  return editRouteMatcherRootRefresh(url, 8, 5, 4);\r\n  // const l = logger.fnIf('editRouteMatcherRootRefresh', { url });\r\n  // if (url.length < 8) return l.rNull();\r\n  // if (url[5].path !== 'edit' || url[6].path !== 'refresh') return l.rNull();\r\n  // const match: UrlMatchResult = {\r\n  //   consumed: url.slice(0, 8),\r\n  //   posParams: {\r\n  //     zoneId: url[0],\r\n  //     appId: url[4],\r\n  //     items: url[7],\r\n  //   } satisfies EditUrlParams<UrlSegment>,\r\n  // };\r\n  // return l.r(match, '');\r\n}\r\n\r\nfunction editRouteMatcherRootRefresh(url: UrlSegment[], segments: number, posEdit: number, posAppId: number): UrlMatchResult {\r\n  const l = logger.fnIf('editRouteMatcherRootRefresh', { url });\r\n  if (url.length < segments) return l.rNull();\r\n  if (url[posEdit].path !== 'edit' || url[posEdit + 1].path !== 'refresh') return l.rNull();\r\n  const match: UrlMatchResult = {\r\n    consumed: url.slice(0, segments),\r\n    posParams: {\r\n      zoneId: url[0],\r\n      appId: url[posAppId],\r\n      items: url[posAppId + 3],\r\n    } satisfies EditUrlParams<UrlSegment>,\r\n  };\r\n  return l.r(match, '');\r\n}","import { Routes } from '@angular/router';\r\nimport { classLog } from '../shared/logging';\r\nimport { editDialog } from './edit-dialog.config';\r\nimport { matchEditRoot, matchEditRootRefresh, matchEditRootRefreshV2, matchEditRootV2, matchEditSub, matchEditSubRefresh } from './routing/edit-route-matchers';\r\n\r\nconst log = classLog('Routes');\r\n\r\n/**\r\n * Routes which open an empty component which then reloads the entity to ensure a full refresh.\r\n * This is used on the history dialog, to ensure the restored data is fully reloaded.\r\n */\r\nconst reloadRoutes: Routes = [\r\n  {\r\n    path: '',\r\n    loadComponent: () => import('./routing/edit-reload').then(m => m.EditReloadComponent),\r\n    data: { title: 'Reloading Edit Dialog' }\r\n  },\r\n];\r\n\r\n\r\n/**\r\n * The main routes for the Edit Dialog.\r\n * It must always be attached to a /edit/:items route.\r\n * It will\r\n * 1. load the EntryComponent\r\n * 2. watch routes for sub-items.\r\n * 3. enable the history mechanism.\r\n */\r\nconst editRoutesDialogAndChildren: Routes = [\r\n  {\r\n    path: '',\r\n    loadComponent: () => import('../shared/components/dialog-entry/dialog-entry').then(m => m.DialogEntryComponent),\r\n    data: { dialog: editDialog },\r\n    loadChildren: () => [\r\n      ...EditRoutes,\r\n      {\r\n        path: 'versions/:itemId',\r\n        loadChildren: () => import('../item-history/item-history.routing').then(m => m.historyRoutes),\r\n      }\r\n    ],\r\n  },\r\n];\r\n\r\n/**\r\n * Routes for the Edit Dialog.\r\n * It will handle /edit/:items routes and also /edit/refresh/ routes.\r\n */\r\nexport const EditRoutes: Routes = [\r\n  {\r\n    matcher: matchEditSub,\r\n    loadChildren: () => {\r\n      // Recursively use these routes again.\r\n      log.a('loadChildren - matcher: sub-edit');\r\n      return editRoutesDialogAndChildren;\r\n    },\r\n  },\r\n  {\r\n    matcher: matchEditSubRefresh,\r\n    children: reloadRoutes,\r\n  },\r\n];\r\n\r\n/**\r\n * In some cases the history could cause trouble, eg. in VisualQuery, where there are many hidden fields which\r\n * build the query, and if someone goes back in time thinking they are just changing the labels, the query would break.\r\n * \r\n * So this is a route without the history-restore/refresh mechanism.\r\n */\r\nexport const EditRoutesNoHistory: Routes = [\r\n  {\r\n    matcher: matchEditSub,\r\n    loadChildren: () => editRoutesDialogAndChildren,\r\n    data: { history: false }, // disable history in the edit dialog\r\n  },\r\n];\r\n\r\n\r\n/**\r\n * Root routes only meant for the entry points of the application, \"App\" and \"Apps\"\r\n */\r\nexport const EditRoutesRoot: Routes = [\r\n  // { // Old\r\n  //   matcher: matchEditRoot,\r\n  //   loadChildren: () => editRoutesDialogAndChildren,\r\n  // },\r\n  { // New\r\n    matcher: matchEditRootV2,\r\n    loadChildren: () => editRoutesDialogAndChildren,\r\n  },\r\n  // { // Old\r\n  //   matcher: matchEditRootRefresh,\r\n  //   children: reloadRoutes,\r\n  // },\r\n  { // New\r\n    matcher: matchEditRootRefreshV2,\r\n    children: reloadRoutes,\r\n  },\r\n];\r\n\r\n\r\n/**\r\n * Root routes only meant for the entry points of the application, \"App\" and \"Apps\"\r\n */\r\nexport const EditRoutesUnderAppsList: Routes = [\r\n  { // Old\r\n    matcher: matchEditRoot,\r\n    loadChildren: () => editRoutesDialogAndChildren,\r\n  },\r\n  // { // New\r\n  //   matcher: matchEditRootV2,\r\n  //   loadChildren: () => editRoutesDialogAndChildren,\r\n  // },\r\n  { // Old\r\n    matcher: matchEditRootRefresh,\r\n    children: reloadRoutes,\r\n  },\r\n  // { // New\r\n  //   matcher: matchEditRootRefreshV2,\r\n  //   children: reloadRoutes,\r\n  // },\r\n];","import { LogSpecs } from '../logging/log-specs';\r\n\r\nconst logThis = false;\r\nconst separator = \":\";\r\nexport class StateManager<T> {\r\n\r\n  protected constructor(private storage: Storage, public prefix: string, private configName?: string) {\r\n    this.#storeKey = this.prefix + (this.configName ? `${separator}${this.configName}` : '');\r\n  }\r\n  #storeKey: string;\r\n\r\n  /** Get the current list of these settings */\r\n  get cache(): Record<string, T> {\r\n    return (this.#cache ??= this.#load() ?? {}) as unknown as Record<string, T>;\r\n  }\r\n  #cache: Record<string, unknown>;\r\n\r\n  get<TValue>(name: string): TValue {\r\n    return this.cache[name] as unknown as TValue;\r\n  }\r\n\r\n  add<TValue>(name: string, specs: TValue) {\r\n    this.cache[name] = specs as unknown as T;\r\n    this.#save(this.cache);\r\n  }\r\n\r\n  remove(name: string) {\r\n    delete this.cache[name];\r\n    this.#save(this.cache);\r\n  }\r\n\r\n  reset() {\r\n    this.#save(this.#cache = {});\r\n  }\r\n\r\n  getNamesInStoreWithPrefix() {\r\n    const result = Array.from(this.storage)\r\n      .filter(([key]) => key === this.prefix || key.startsWith(this.prefix + separator))\r\n      .map(([key]) => key);\r\n    \r\n    return result;\r\n  }\r\n\r\n  #save(data: Record<string, unknown>) {\r\n    this.storage.setItem(this.#storeKey, JSON.stringify(data));\r\n  }\r\n\r\n  #load(): Record<string, unknown> {\r\n    const data = this.storage.getItem(this.#storeKey);\r\n    const result = data ? JSON.parse(data) : {};\r\n    if (logThis && result)\r\n      console.log(`Loaded log specs for ${Object.keys(result).length} items`, result);\r\n    return result;\r\n  }\r\n}\r\n\r\n/**\r\n * State management for the log manager.\r\n * It will store it in the current session.\r\n */\r\nexport class StateManagerSession extends StateManager<LogSpecs<unknown>> {\r\n  constructor(prefix: string, configName?: string) {\r\n    super(window.sessionStorage, prefix, configName);\r\n  }\r\n}\r\n\r\nexport class StateManagerLocal extends StateManager<LogSpecs<unknown>> {\r\n  constructor(prefix: string, configName?: string) {\r\n    super(window.localStorage, prefix, configName);\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { map, Observable, shareReplay, tap } from 'rxjs';\r\nimport { classLog } from '../../shared/logging';\r\nimport { DialogSettings } from '../../shared/models/dialog-settings.model';\r\nimport { GlobalConfigService } from '../../shared/services/global-config.service';\r\nimport { HttpServiceBase } from '../../shared/services/http-service-base';\r\n\r\nconst webApiSettings = 'admin/dialog/settings';\r\n\r\n/**\r\n * Service for getting dialog settings for the current app.\r\n *\r\n * Note that it should normally be shared, to save resources / network calls.\r\n */\r\n@Injectable({ providedIn: 'root' })\r\nexport class DialogConfigGlobalService extends HttpServiceBase {\r\n\r\n  log = classLog({ DialogConfigGlobalService });\r\n\r\n  constructor(private globalConfigService: GlobalConfigService,) {\r\n    super();\r\n    this.log.a(`using context #${this.context.log.svcId}`);\r\n  }\r\n\r\n  private dialogSettings$: Record<number, Observable<DialogSettings>> = {};\r\n  // TODO: @2dg, ask 2dm \r\n  getShared$(appId: number): Observable<DialogSettings> {\r\n    this.log.a('getShared$ appId: ' + appId);\r\n    this.dialogSettings$[appId] ??= this.#getDialogSettings(appId, 'getShared$')\r\n      .pipe(\r\n        shareReplay({ refCount: false })\r\n      );\r\n    return this.dialogSettings$[appId];\r\n  }\r\n\r\n  #getDialogSettings(appId?: number, reqBy?: string): Observable<DialogSettings> {\r\n    this.log.a('getDialogSettings', { appId, reqBy });\r\n    return this.getHttpApiUrl<DialogSettings>(webApiSettings, {\r\n      params: { appId: appId ?? this.appId },\r\n    }).pipe(\r\n      map(dlgSettings => {\r\n        dlgSettings.Context.Language.List = dlgSettings.Context.Language.List.filter(language => language.IsEnabled);\r\n        return dlgSettings;\r\n      }),\r\n      tap(dlgSettings => {\r\n        this.globalConfigService.allowDebug(dlgSettings.Context.Enable.DebugMode);\r\n      }),\r\n    );\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { Observable } from 'rxjs';\r\nimport { classLog } from '../../shared/logging';\r\nimport { DialogSettings } from '../../shared/models/dialog-settings.model';\r\nimport { Context } from '../../shared/services/context';\r\nimport { DialogConfigGlobalService } from './dialog-config-global.service';\r\n\r\n/**\r\n * Context aware dialog configuration service.\r\n * \r\n * It uses the shared service so the settings are cached when re-requested by anything else.\r\n */\r\n@Injectable()\r\nexport class DialogConfigAppService {\r\n\r\n  log = classLog({ DialogConfigAppService });\r\n\r\n  constructor(private contextSvcShared: DialogConfigGlobalService, private context: Context) { }\r\n\r\n  getCurrent$(): Observable<DialogSettings> {\r\n    const appId = this.context.appId;\r\n    this.log.a(`getCurrent\\$ - appId:${appId}`);\r\n    return this.contextSvcShared.getShared$(appId);\r\n  }\r\n}\r\n","export const environment = {\r\n  production: true\r\n};\r\n","import { computed, signal, Signal, WritableSignal } from '@angular/core';\r\nimport { ReactiveNode, SIGNAL } from '@angular/core/primitives/signals';\r\nimport isEqual from 'lodash-es/isEqual';\r\nimport { Observable, take } from 'rxjs';\r\n\r\n\r\n/**\r\n * Named signal with object equality check\r\n * @param name name for debugging\r\n * @param initialValue initial value to start the signal\r\n * @returns\r\n */\r\nexport function signalObj<T>(name: string, initialValue: T): WritableSignal<T> {\r\n  const sig = signal(initialValue, { equal: isEqual, debugName: name }) as WritableSignal<T>;\r\n  return named(name, sig);\r\n}\r\n\r\nexport function computedObj<T>(name: string, computation: () => T): Signal<T> {\r\n  const comp =  computed(computation, { equal: isEqual, debugName: name }) as Signal<T>; // needs recast, because isEqual changes it to Signal<any>\r\n  return named(name, comp);\r\n}\r\n\r\n// Either in the place where it is called, or if the service is only used in one place, in the service itself to return a signal instead\r\n/**\r\n * Convert a single http get into a simple signal.\r\n * It will initialize with the optional initialValue and then update with the httpGet result.\r\n * As such, it has a first value, and will only update once.\r\n * @param name name of the signal for debugging\r\n * @param httpRequest the http request\r\n * @param initialValue optional initial value\r\n * @returns\r\n */\r\nexport function httpToSignal<T>(name: string, httpRequest: Observable<T>, initialValue: T = null): Signal<T> {\r\n  const sig = signal(initialValue, { equal: isEqual, debugName: name }) as WritableSignal<T>;\r\n  // take(1) to only get the first value, and close the subscription right afterwards - which is what happens to all normal http requests\r\n  httpRequest.pipe(take(1)).subscribe(value => sig.set(value));\r\n  return named(name, sig.asReadonly());\r\n}\r\n\r\n\r\nexport function named<TSig, TVal extends Signal<TVal> | WritableSignal<TVal>>(name: string, signal: TSig): TSig {\r\n  if (!signal) return signal;\r\n  const sigAny = signal as any;\r\n  sigAny.debugName = name;\r\n  if (!sigAny[SIGNAL]) return signal;\r\n  (sigAny[SIGNAL]).debugName = name;\r\n  return signal;\r\n}\r\n\r\n\r\n\r\n// wip atm unused\r\n/** Slightly unclean signal with previous value */\r\n// https://github.com/angular/angular/issues/54339\r\nexport function computedWithPrev<T>(computation: (prev: T | undefined) => T, initial?: T): Signal<T> {\r\n\tlet previous = initial;\r\n\treturn computed(() => {\r\n\t\tconst newValue = computation(previous);\r\n\t\tprevious = newValue;\r\n\t\treturn newValue;\r\n\t}, { equal: isEqual });\r\n}\r\n\r\nexport function getVersion(signal: Signal<unknown>): number | null {\r\n  if (!signal) return null;\r\n  return (signal[SIGNAL] as ReactiveNode)?.version ?? null;\r\n}\r\n","import { Injectable, Optional, SkipSelf } from '@angular/core';\r\nimport { ActivatedRoute, ActivatedRouteSnapshot } from '@angular/router';\r\nimport { keyAppId, keyContentBlockId, keyModuleId, keyZoneId, prefix } from '../constants/session.constants';\r\nimport { classLog } from '../logging';\r\nimport { EavWindow } from '../models/eav-window.model';\r\nimport { RouteContextInfo } from '../routing/route-context-info';\r\n\r\ndeclare const window: EavWindow;\r\n\r\nconst logSpecs = {\r\n  all: false,\r\n  constructor: false,\r\n  init: false,\r\n  initRoot: false,\r\n};\r\n\r\n/**\r\n * Context is used to display information about the current app in various depths.\r\n * In other words, if you open another app in a deeper dialog in the app on Apps Management\r\n * (the component is deeper), you get the information from this app and not the initial app.\r\n */\r\n@Injectable()\r\nexport class Context implements RouteContextInfo {\r\n\r\n  log = classLog({Context}, logSpecs);\r\n\r\n  constructor(@Optional() @SkipSelf() parentContext: Context) {\r\n    this.log.a(`constructor; hasParent: ${parentContext != null}`, { parentContext, 'parentId': parentContext?.id });\r\n    this.parent = parentContext;\r\n\r\n    // spm NOTE: I've given id to every context to make it easier to follow how things work\r\n    if (!window.contextId)\r\n      window.contextId = 0;\r\n    this.id = window.contextId++;\r\n    this.log.a('Context.constructor', { this: this });\r\n  }\r\n\r\n  /** Id of current context */\r\n  public id: number;\r\n\r\n  /** Determines if the context is ready to use, and everything is initialized */\r\n  public ready = false;\r\n\r\n  /** The parent, for hierarchical lookup */\r\n  private parent: Context;\r\n\r\n  private routeSnapshot: ActivatedRouteSnapshot;\r\n\r\n  /** The current Zone ID */\r\n  get zoneId(): number {\r\n    return this._zoneId || (this._zoneId = this.#routeNum(keyZoneId) || this.parent?.zoneId);\r\n  }\r\n  private _zoneId: number;\r\n\r\n  /** The current App ID */\r\n  get appId(): number {\r\n    return (this._appId != null) ? this._appId : (this._appId = this.#routeNum(keyAppId) || this.parent?.appId);\r\n  }\r\n  private _appId: number;\r\n\r\n\r\n  /** Tab Id is global */\r\n  get tabId(): number {\r\n    return window.$2sxc.env.page();\r\n  }\r\n\r\n  /** Content Block Id is global */\r\n  get contentBlockId(): number {\r\n    return this._contentBlockId || (this._contentBlockId = this.#routeNum(keyContentBlockId) || this.parent?.contentBlockId);\r\n  }\r\n  private _contentBlockId: number;\r\n\r\n  /** Module Id is global */\r\n  get moduleId(): number {\r\n    return this._moduleId || (this._moduleId = this.#routeNum(keyModuleId) || this.parent?.moduleId);\r\n  }\r\n  private _moduleId: number;\r\n\r\n  /**\r\n   * This is the initializer at entry-components of modules.\r\n   * It ensures that within that module, the context has the values given by the route.\r\n   *\r\n   * Note: 2024-07-01 2dm: a long time ago the context was recreated for every single component, so init was also called for every component.\r\n   * But after going standalone, thi doesn't happen any more, and the re-init seems to kill the context from previous,\r\n   * which is why we skip this if already ready.\r\n   * This is still a bit shaky, not sure if this should be the final implementation.\r\n   */\r\n  init(route: ActivatedRoute) {\r\n    const l = this.log.fnIf('init', { route }, `- previously ready: '${this.ready}'`);\r\n    // New prevent-multiple-init checks 2dm 2024-07-01\r\n    if (this.ready)\r\n      return l.r(this, 'Already ready, skipping init');\r\n    this.routeSnapshot = route?.snapshot;\r\n    this.#clearCachedValues();\r\n    this.ready = route != null;\r\n    this.log.a('init done', { this: this, 'appId': this.appId, 'zoneId': this.zoneId, 'contentBlockId': this.contentBlockId, 'moduleId': this.moduleId });\r\n  }\r\n\r\n  initRoot(): void {\r\n    const l = this.log.fnIf('initRoot');\r\n    this._zoneId = this.#sessionNumber(keyZoneId);\r\n    this._contentBlockId = this.#sessionNumber(keyContentBlockId);\r\n    this._moduleId = this.#sessionNumber(keyModuleId);\r\n    this._appId = this.#sessionNumber(keyAppId);\r\n\r\n    if (!this._zoneId)\r\n      throw new Error('Context is missing some of the required parameters');\r\n\r\n    this.ready = true;\r\n    l.r(this);\r\n  }\r\n\r\n  #sessionNumber(name: string): number {\r\n    const result = sessionStorage.getItem(name);\r\n    if (result === null) return null;\r\n    const num = parseInt(result, 10);\r\n    return isNaN(num) ? null : num;\r\n  }\r\n\r\n  /**\r\n   * Get a number from the route, or optionally its parents.\r\n   * Returns value in route or null\r\n   */\r\n  #routeNum(name: string): number {\r\n    // catch case where state is null, like when the recursive parent is in use\r\n    if (this.routeSnapshot == null) { return null; }\r\n    const paramName = name.substring(prefix.length);\r\n    const result = this.routeSnapshot.paramMap.get(paramName);\r\n    if (result !== null) {\r\n      const num = parseInt(result, 10);\r\n      return isNaN(num) ? null : num;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clears cached values. Required when one module instance is opened multiple times,\r\n   * e.g. Apps Management -> App Admin for appId 2 -> back -> App Admin for appId 17.\r\n   * Module is reused, and so is context and it contains values for previous appId.\r\n   */\r\n  #clearCachedValues() {\r\n    this._zoneId = null;\r\n    this._appId = null;\r\n    this._contentBlockId = null;\r\n    this._moduleId = null;\r\n  }\r\n}\r\n","import { ActivatedRoute } from '@angular/router';\r\nimport { FormConfiguration } from '../../form/form-configuration.model';\r\n\r\nexport class UrlHelpers {\r\n\r\n  static stripNonUrlCharacters(controlValue: string, allowPath: boolean, trimEnd: boolean) {\r\n    if (!controlValue) { return ''; }\r\n\r\n    const rexSeparators = allowPath ? /[^a-z0-9-_/]+/gi : /[^a-z0-9-_]+/gi;\r\n    const latinized = this.latinizeText(controlValue.toLowerCase());\r\n    const cleanInputValue = latinized\r\n      .replace(`'s `, 's ') // neutralize it's, daniel's etc. but only if followed by a space, to ensure we don't kill quotes\r\n      .replace('\\\\', '/') // neutralize slash representation\r\n      .replace(rexSeparators, '-') // replace everything we don't want with a -\r\n      .replace(/-+/gi, '-') // reduce multiple '-'\r\n      .replace(/\\/+/gi, '/') // reduce multiple slashes\r\n      .replace(/-*\\/-*/gi, '/') // reduce '-/' or '/-' combinations to a simple '/'\r\n      .replace(trimEnd ? /^-|-+$/gi : /^-/gi, ''); // trim front and maybe end '-'\r\n    return cleanInputValue;\r\n  }\r\n\r\n  static latinizeText(input: string) {\r\n    const latinMap: Record<string, string> = {\r\n      : 'A', : 'A', : 'A', : 'A', : 'A', : 'A', : 'A', : 'A', : 'A', : 'A', : 'A',\r\n      : 'A', : 'A', : 'A', : 'Ae', : 'A', : 'A', : 'A', : 'A', : 'A', : 'A', : 'A', : 'A',\r\n      : 'A', : 'A', : 'A', : 'A', : 'A', : 'A', : 'A', : 'AA', : 'AE', : 'AE', : 'AE',\r\n      : 'AO', : 'AU', : 'AV', : 'AV', : 'AY', : 'B', : 'B', : 'B', : 'B', : 'B',\r\n      : 'B', : 'C', : 'C', : 'C', : 'C', : 'C', : 'C', : 'C', : 'C', : 'D', : 'D',\r\n      : 'D', : 'D', : 'D', : 'D', : 'D', : 'D', : 'D', : 'D', : 'D', : 'DZ', : 'DZ',\r\n      : 'E', : 'E', : 'E', : 'E', : 'E', : 'E', : 'E', : 'E', : 'E', : 'E', : 'E', : 'E',\r\n      : 'E', : 'E', : 'E', : 'E', : 'E', : 'E', : 'E', : 'E', : 'E', : 'E', : 'E', : 'E',\r\n      : 'E', : 'E', : 'ET', : 'F', : 'F', : 'G', : 'G', : 'G', : 'G', : 'G', : 'G', : 'G',\r\n      : 'G', : 'G', : 'H', : 'H', : 'H', : 'H', : 'H', : 'H', : 'H', : 'H', : 'H', : 'I',\r\n      : 'I', : 'I', : 'I', : 'I', : 'I', : 'I', : 'I', : 'I', : 'I', : 'I', : 'I', : 'I',\r\n      : 'I', : 'I', : 'I', : 'I', : 'D', : 'F', : 'G', : 'R', : 'S', : 'T', : 'IS', : 'J',\r\n      : 'J', : 'K', : 'K', : 'K', : 'K', : 'K', : 'K', : 'K', : 'K', : 'K', : 'K', : 'L',\r\n      : 'L', : 'L', : 'L', : 'L', : 'L', : 'L', : 'L', : 'L', : 'L', : 'L', : 'L', : 'L',\r\n      : 'L', : 'LJ', : 'M', : 'M', : 'M', : 'M', : 'N', : 'N', : 'N', : 'N', : 'N', : 'N',\r\n      : 'N', : 'N', : 'N', : 'N', : 'N', : 'N', : 'NJ', : 'O', : 'O', : 'O', : 'O', : 'O',\r\n      : 'O', : 'O', : 'O', : 'O', e: 'O', : 'O', : 'O', : 'O', : 'O', : 'O', : 'O', : 'O',\r\n      : 'O', : 'O', : 'O', : 'O', : 'O', : 'O', : 'O', : 'O', : 'O', : 'O', : 'O', : 'O',\r\n      : 'O', : 'O', : 'O', : 'O', : 'O', : 'O', : 'O', : 'O', : 'O', : 'O', : 'OI', : 'OO',\r\n      : 'E', : 'O', : 'OU', : 'P', : 'P', : 'P', : 'P', : 'P', : 'P', : 'P', : 'Q', : 'Q',\r\n      : 'R', : 'R', : 'R', : 'R', : 'R', : 'R', : 'R', : 'R', : 'R', : 'R', : 'R', : 'C',\r\n      : 'E', : 'S', : 'S', : 'S', : 'S', : 'S', : 'S', : 'S', : 'S', : 'S', : 'S', : 'T',\r\n      : 'T', : 'T', : 'T', : 'T', : 'T', : 'T', : 'T', : 'T', : 'T', : 'T', : 'A', : 'L',\r\n      : 'M', : 'V', : 'TZ', : 'U', : 'U', : 'U', : 'U', : 'U', : 'Ue', : 'U', : 'U', : 'U',\r\n      : 'U', : 'U', : 'U', : 'U', : 'U', : 'U', : 'U', : 'U', : 'U', : 'U', : 'U', : 'U',\r\n      : 'U', : 'U', : 'U', : 'U', : 'U', : 'U', : 'U', : 'U', : 'U', : 'V', : 'V', : 'V',\r\n      : 'V', : 'VY', : 'W', : 'W', : 'W', : 'W', : 'W', : 'W', : 'W', : 'X', : 'X', : 'Y',\r\n      : 'Y', : 'Y', : 'Y', : 'Y', : 'Y', : 'Y', : 'Y', : 'Y', : 'Y', : 'Y', : 'Y', : 'Z',\r\n      : 'Z', : 'Z', : 'Z', : 'Z', : 'Z', : 'Z', : 'Z', : 'Z', : 'IJ', : 'OE', : 'A', : 'AE',\r\n      : 'B', : 'B', : 'C', : 'D', : 'E', : 'F', : 'G', : 'G', : 'H', : 'I', : 'R', : 'J',\r\n      : 'K', : 'L', : 'L', : 'M', : 'N', : 'O', : 'OE', : 'O', : 'OU', : 'P', : 'R', : 'N',\r\n      : 'R', : 'S', : 'T', : 'E', : 'R', : 'U', : 'V', : 'W', : 'Y', : 'Z', : 'a', : 'a',\r\n      : 'a', : 'a', : 'a', : 'a', : 'a', : 'a', : 'a', : 'a', : 'a', : 'a', : 'a', : 'a',\r\n      : 'ae', : 'a', : 'a', : 'a', : 'a', : 'a', : 'a', : 'a', : 'a', : 'a', : 'a', : 'a',\r\n      : 'a', : 'a', : 'a',\r\n      : 'a', : 'a', : 'a', : 'aa', : 'ae', : 'ae', : 'ae', : 'ao', : 'au', : 'av', : 'av',\r\n      : 'ay', : 'b', : 'b', : 'b', : 'b', : 'b', : 'b', : 'b', : 'b', : 'o', : 'c', : 'c',\r\n      : 'c', : 'c', : 'c', : 'c', : 'c', : 'c', : 'c', : 'd', : 'd', : 'd', : 'd', : 'd',\r\n      : 'd', : 'd', : 'd', : 'd', : 'd', : 'd', : 'd', : 'd', : 'd', : 'i', : 'j', : 'j',\r\n      : 'j', : 'dz', : 'dz', : 'e', : 'e', : 'e', : 'e', : 'e', : 'e', : 'e', : 'e', : 'e',\r\n      : 'e', : 'e', : 'e', : 'e', : 'e', : 'e', : 'e', : 'e', : 'e', : 'e', : 'e', : 'e',\r\n      : 'e', : 'e', : 'e', : 'e', : 'e', : 'e', : 'e', : 'et', : 'f', : 'f', : 'f', : 'f',\r\n      : 'g', : 'g', : 'g', : 'g', : 'g', : 'g', : 'g', : 'g', : 'g', : 'g', : 'h', : 'h',\r\n      : 'h', : 'h', : 'h', : 'h', : 'h', : 'h', : 'h', : 'h', : 'h', : 'hv', : 'i', : 'i',\r\n      : 'i', : 'i', : 'i', : 'i', : 'i', : 'i', : 'i', : 'i', : 'i', : 'i', : 'i', : 'i',\r\n      : 'i', : 'i', : 'i', : 'd', : 'f', : 'g', : 'r', : 's', : 't', : 'is', : 'j', : 'j',\r\n      : 'j', : 'j', : 'k', : 'k', : 'k', : 'k', : 'k', : 'k', : 'k', : 'k', : 'k', : 'k',\r\n      : 'k', : 'l', : 'l', : 'l', : 'l', : 'l', : 'l', : 'l', : 'l', : 'l', : 'l', : 'l',\r\n      : 'l', : 'l', : 'l', : 'l', : 'l', : 'l', : 'lj', : 's', : 's', : 's', : 's', : 'm',\r\n      : 'm', : 'm', : 'm', : 'm', : 'm', : 'n', : 'n', : 'n', : 'n', : 'n', : 'n', : 'n',\r\n      : 'n', : 'n', : 'n', : 'n', : 'n', : 'n', : 'n', : 'n', : 'nj', : 'o', : 'o', : 'o',\r\n      : 'o', : 'o', : 'o', : 'o', : 'o', : 'o', : 'oe', : 'o', : 'o', : 'o', : 'o', : 'o',\r\n      : 'o', : 'o', : 'o', : 'o', : 'o', : 'o', : 'o', : 'o', : 'o', : 'o', : 'o', : 'o',\r\n      : 'o', : 'o', : 'o', : 'o', : 'o', : 'o', : 'o', : 'o', : 'o', : 'o', : 'o', : 'o',\r\n      : 'oi', : 'oo', : 'e', : 'e', : 'o', : 'o', : 'ou', : 'p', : 'p', : 'p', : 'p', : 'p',\r\n      : 'p', : 'p', : 'p', : 'p', : 'q', : 'q', : 'q', : 'q', : 'r', : 'r', : 'r', : 'r',\r\n      : 'r', : 'r', : 'r', : 'r', : 'r', : 'r', : 'r', : 'r', : 'r', : 'r', : 'r', : 'r',\r\n      : 'c', : 'c', : 'e', : 'r', : 'ss', : 's', : 's', : 's', : 's', : 's', : 's', : 's',\r\n      : 's', : 's', : 's', : 's', : 's', : 's', : 's', : 'g', : 'o', : 'o', : 'u', : 't',\r\n      : 't', : 't', : 't', : 't', : 't', : 't', : 't', : 't', : 't', : 't', : 't', : 't',\r\n      : 't', : 't', : 'th', : 'a', : 'ae', : 'e', : 'g', : 'h', : 'h', : 'h', : 'i', : 'k',\r\n      : 'l', : 'm', : 'm', : 'oe', : 'r', : 'r', : 'r', : 'r', : 't', : 'v', : 'w', : 'y',\r\n      : 'tz', : 'u', : 'u', : 'u', : 'u', : 'u', : 'ue', : 'u', : 'u', : 'u', : 'u', : 'u',\r\n      : 'u', : 'u', : 'u', : 'u', : 'u', : 'u', : 'u', : 'u', : 'u', : 'u', : 'u', : 'u',\r\n      : 'u', : 'u', : 'u', : 'u', : 'u', : 'u', : 'u', : 'u', : 'ue', : 'um', : 'v', : 'v',\r\n      : 'v', : 'v', : 'v', : 'v', : 'v', : 'vy', : 'w', : 'w', : 'w', : 'w', : 'w', : 'w',\r\n      : 'w', : 'w', : 'x', : 'x', : 'x', : 'y', : 'y', : 'y', : 'y', : 'y', : 'y', : 'y',\r\n      : 'y', : 'y', : 'y', : 'y', : 'y', : 'y', : 'z', : 'z', : 'z', : 'z', : 'z', : 'z',\r\n      : 'z', : 'z', : 'z', : 'z', : 'z', : 'z', : 'z', : 'z', : 'ff', : 'ffi', : 'ffl', : 'fi',\r\n      : 'fl', : 'ij', : 'oe', : 'st', : 'a', : 'e', : 'i', : 'j', : 'o', : 'r', : 'u', : 'v',\r\n      : 'x',\r\n    };\r\n    return input.replace(/[^A-Za-z0-9\\[\\] ]/g, (a) => (latinMap[a] || a));\r\n  }\r\n\r\n  static urlParamsToDic(url: string): Record<string, string> {\r\n    const queryParams: Record<string, string> = {};\r\n    url.split('&').forEach(f => {\r\n      const p = f.split('=');\r\n      if (p.length === 2)\r\n        queryParams[p[0]] = decodeURIComponent(p[1].replace(/\\+/g, ' '));\r\n    });\r\n    return queryParams;\r\n  }\r\n\r\n  /** https://stackoverflow.com/questions/979975/how-to-get-the-value-from-the-get-parameters/1099670#1099670 */\r\n  static getUrlParams(qs: string) {\r\n    qs = qs.split('+').join(' ');\r\n\r\n    const params: Record<string, string> = {};\r\n    let tokens;\r\n    const re = /[?&]?([^=]+)=([^&]*)/g;\r\n\r\n    // tslint:disable-next-line:no-conditional-assignment\r\n    while (tokens = re.exec(qs)) {\r\n      params[decodeURIComponent(tokens[1])] = decodeURIComponent(tokens[2]);\r\n    }\r\n\r\n    return params;\r\n  }\r\n\r\n  static replaceUrlParam(url: string, paramName: string, paramValue: string) {\r\n    if (paramValue === null) { paramValue = ''; }\r\n\r\n    const pattern = new RegExp('\\\\b(' + paramName + '=).*?(&|#|$)');\r\n    if (url.search(pattern) >= 0) { return url.replace(pattern, '$1' + paramValue + '$2'); }\r\n\r\n    url = url.replace(/[?#]$/, '');\r\n    return url + (url.indexOf('?') > 0 ? '&' : '?') + paramName + '=' + paramValue;\r\n  }\r\n\r\n  static getUrlPrefix(area: 'system' | 'zone' | 'app' | 'appShared', eavConfig: FormConfiguration) {\r\n    let result = '';\r\n\r\n    if (area === 'system') { result = eavConfig.systemRoot; } // used to link to JS-stuff and similar\r\n    if (area === 'zone') { result = eavConfig.portalRoot; } // used to link to the site-root (like an image)\r\n    if (area === 'app') { result = eavConfig.appRoot; } // used to find the app-root of something inside an app\r\n    if (area === 'appShared') { result = eavConfig.appSharedRoot; } // used to find the app-root of something inside an app\r\n    if (result.endsWith('/')) { result = result.substring(0, result.length - 1); }\r\n\r\n    return result;\r\n  }\r\n\r\n  static newUrlIfCurrentContainsOldUrl(route: ActivatedRoute, oldEditUrl: string, newEditUrl: string) {\r\n    const currentUrl = UrlHelpers.calculatePathFromRoot(route);\r\n    const lastIndex = currentUrl.lastIndexOf(oldEditUrl);\r\n    if (lastIndex <= 0) return null;\r\n    const newUrl = currentUrl.substring(0, lastIndex) + currentUrl.substring(lastIndex).replace(oldEditUrl, newEditUrl);\r\n    return newUrl;\r\n  }\r\n\r\n  static calculatePathFromRoot(route: ActivatedRoute) {\r\n    let lastChild = route;\r\n    while (lastChild.firstChild) {\r\n      lastChild = lastChild.firstChild;\r\n    }\r\n    let pathFromRoot = '';\r\n    for (const path of lastChild.snapshot.pathFromRoot) {\r\n      if (path.url.length <= 0) continue;\r\n      for (const urlSegment of path.url) {\r\n        if (!urlSegment.path) continue;\r\n        pathFromRoot += '/' + urlSegment.path;\r\n      }\r\n    }\r\n    return pathFromRoot;\r\n  }\r\n}\r\n","import { HttpClient } from '@angular/common/http';\r\nimport { TranslateLoader } from '@ngx-translate/core';\r\nimport { catchError, Observable, of } from 'rxjs';\r\n\r\n/**\r\n * This loader should catch a 404 if the file doesn't exist and not result in errors.\r\n * https://stackoverflow.com/questions/47391613/how-to-set-a-fallback-assets-i18n-en-json-when-url-is-not-available-ngx-trans\r\n */\r\nexport class TranslateLoaderWithErrorHandling implements TranslateLoader {\r\n  constructor(private http: HttpClient, private prefix: string, private suffix: string) { }\r\n\r\n  getTranslation(lang: string): Observable<Record<string, any>> {\r\n    return this.http.get<Record<string, any>>(`${this.prefix}${lang}${this.suffix}`).pipe(\r\n      catchError(error => {\r\n        console.warn(`Translation: Failed to get language '${lang}' from ${this.prefix}`, error);\r\n        return of({});\r\n      }),\r\n    );\r\n  }\r\n}\r\n","import { HttpContextToken, HttpErrorResponse, HttpEvent, HttpHandler, HttpInterceptor, HttpRequest } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { catchError, Observable, throwError } from 'rxjs';\r\n\r\nexport const IGNORED_STATUSES = new HttpContextToken<number[]>(() => []);\r\n\r\n@Injectable()\r\nexport class HandleErrorsInterceptor implements HttpInterceptor {\r\n  /** URLs excluded from detailed error alert  */\r\n  private excludedUrls = [\r\n    'dist/ng-edit/i18n',\r\n  ];\r\n\r\n  constructor() { }\r\n\r\n  intercept(req: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\r\n    const ignoredStatuses = req.context.get(IGNORED_STATUSES);\r\n    return next.handle(req).pipe(\r\n\r\n      catchError((error: HttpErrorResponse) => {\r\n\r\n        // If Status is in the ignored list, just use the error custom im component (example: content-items.component 400 Error Deleting Item)\r\n        if (ignoredStatuses?.includes(error.status)) {\r\n          return throwError(() => error);\r\n        }\r\n\r\n        if (!this.checkIfExcluded(error.url)) {\r\n          this.showDetailedHttpError(error);\r\n        }\r\n        return throwError(error);\r\n      })\r\n    );\r\n  }\r\n\r\n  private checkIfExcluded(url: string) {\r\n    for (const excludedUrl of this.excludedUrls) {\r\n      if (url.includes(excludedUrl)) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  private showDetailedHttpError(error: HttpErrorResponse) {\r\n    let infoText = 'Had an error talking to the server (status ' + error.status + ').';\r\n    const srvResp = error.error;\r\n    if (srvResp) {\r\n      const msg = srvResp.Message;\r\n      if (msg)\r\n        infoText += '\\nMessage: ' + msg;\r\n      const msgDet = srvResp.MessageDetail || srvResp.ExceptionMessage;\r\n      if (msgDet)\r\n        infoText += '\\nDetail: ' + msgDet;\r\n\r\n      if (msgDet && msgDet.indexOf('No action was found') === 0) {\r\n        if (msgDet.indexOf('that matches the name') > 0)\r\n          infoText += '\\n\\nTip from 2sxc: you probably got the action-name wrong in your JS.';\r\n        else if (msgDet.indexOf('that matches the request.') > 0)\r\n          infoText += '\\n\\nTip from 2sxc: Seems like the parameters are the wrong amount or type.';\r\n      }\r\n\r\n      if (msg && msg.indexOf('Controller') === 0 && msg.indexOf('not found') > 0) {\r\n        infoText += '\\n\\nTip from 2sxc: you probably spelled the controller name wrong or forgot to remove the word \\'controller\\' from the call in JS. To call a controller called \\'DemoController\\' only use \\'Demo\\'.';\r\n      }\r\n      infoText += '\\n\\nif you are an advanced user you can learn more about what went wrong - discover how on 2sxc.org/help?tag=debug';\r\n    }\r\n\r\n    alert(infoText);\r\n  }\r\n}\r\n","/**\r\n * @internal\r\n */\r\nexport class ParamEncoder {\r\n  /** Encodes characters in URL parameter to not mess up routing. Don't forget to decode it! :) */\r\n  static encode(text: string) {\r\n    return (text ?? '')\r\n      .replace(/\\//g, '%2F')\r\n      .replace(/\\:/g, '%3A')\r\n      .replace(/\\&/g, '%26')\r\n      .replace(/\\~/g, '%7E')\r\n      .replace(/\\,/g, '%2C');\r\n  }\r\n\r\n  static decode(text: string) {\r\n    return (text ?? '')\r\n      .replace(/%2F/g, '/')\r\n      .replace(/%3A/g, ':')\r\n      .replace(/%26/g, '&')\r\n      .replace(/%7E/g, '~')\r\n      .replace(/%2C/g, ',');\r\n  }\r\n}\r\n","// TODO: @2rb - create a few unit tests for this helper\r\n// especially variants which would create special characters in the base64\r\n\r\nexport class UrlParamBase64 {\r\n  static encode(data: unknown): string {\r\n    const json = JSON.stringify(data);\r\n    const base64 = btoa(encodeURIComponent(json))\r\n      // make sure it's url safe by replacing + and / which are in base64 but not url-safe\r\n      .replace(/\\+/g, '-')\r\n      .replace(/\\//g, '_')\r\n      // also replace = with a safe character, though we need to restore it when reading\r\n      .replace(/=/g, '.');\r\n    return base64;\r\n  }\r\n\r\n  static decode<T>(base64: string): T {\r\n    const paddedBase64 = base64\r\n      // restore . to =\r\n      .replace(/\\./g, '=')\r\n      // restore - to +\r\n      .replace(/-/g, '+')\r\n      // restore _ to /\r\n      .replace(/_/g, '/');\r\n    const json = decodeURIComponent(atob(paddedBase64));\r\n    const data = JSON.parse(json) as T;\r\n    return data;\r\n  }\r\n}","import { EavFor } from '../../edit/shared/models/eav';\r\nimport { eavConstants } from '../constants/eav.constants';\r\nimport { classLog } from '../logging';\r\nimport { EditForm, ItemAddIdentifier, ItemEditIdentifier, ItemIdentifierInbound, ItemIdentifierShared, ItemInListIdentifier } from '../models/edit-form.model';\r\nimport { ItemIdHelper } from '../models/item-id-helper';\r\nimport { ParamEncoder } from './param-encoder';\r\nimport { UrlParamBase64 } from './url-param-base64';\r\n\r\n// Note: everything in here is a bit magical - and probably not ideal\r\n// It basically prepares a very compact url representation of an EditForm\r\n// so it can be passed in urls\r\n// The format is not documented anywhere - so changing it will likely break things\r\n// so be careful!\r\n// In some cases, order matters, in others there are prefixes to identify parts\r\n\r\nconst log = classLog(\"UrlPrepHelper\")\r\n\r\nconst PREFILL_PREFIX = 'prefill:';\r\nconst GROUP_PREFIX = 'group:';\r\nconst UIFIELDS_PREFIX = 'uifields:';\r\nconst PARAM_PREFIX = 'parameters:';\r\nconst COPY_PREFIX = 'copy:';\r\nconst SAVE_PREFIX = 'save:';\r\nconst DATA_PREFIX = 'data64:';\r\nconst ITEM_SEPARATOR = ',';\r\nconst VAL_SEPARATOR = '&';\r\nconst LIST_SEPARATOR = ':';\r\nconst METADATA_SEPARATOR = '~';\r\n\r\nfunction toOrderedParams(values: unknown[]): string {\r\n  return values.join(LIST_SEPARATOR);\r\n}\r\n\r\nexport function convertFormToUrl(form: EditForm) {\r\n  const l = log.fn('convertFormToUrl', { form });\r\n  let formUrl = '';\r\n\r\n  for (const item of form.items) {\r\n    // If we already have one, the next must be separated\r\n    if (formUrl) formUrl += ITEM_SEPARATOR;\r\n\r\n    const asGroup = item as ItemInListIdentifier;\r\n    const asItem = item as ItemEditIdentifier;\r\n    const asInboundParams = item as ItemIdentifierInbound;\r\n    // Fields/Parameters can come from two places\r\n    // When a link is inbound from the page, it will use UiFields/Parameters\r\n    // If it's from the Admin-UI itself, it should use the newer / deeper ClientData\r\n    const fields = asInboundParams.UiFields ?? item.ClientData?.fields;\r\n    const parameters = asInboundParams.Parameters ?? item.ClientData?.parameters;\r\n\r\n    // Group- or Inner-Item\r\n    if (asGroup.Parent) {\r\n      l.a(\"asGroup having parent\", {asGroup});\r\n      formUrl += GROUP_PREFIX + toOrderedParams([\r\n        asGroup.Parent,\r\n        asGroup.Field,\r\n        asGroup.Index,\r\n        asGroup.Add,\r\n        asGroup.EntityId\r\n      ]);\r\n      formUrl += addTypicalUrlGroups(asGroup, fields, parameters,\r\n        { prefill: true, fields: true, params: true, duplicate: true }\r\n      );\r\n\r\n    } else if (asItem.EntityId) {\r\n      l.a(\"asItem having entity id\", {asItem});\r\n      // Edit Item\r\n      formUrl += asItem.EntityId;\r\n\r\n      // New: fields\r\n      formUrl += addTypicalUrlGroups(asItem, fields, parameters,\r\n        { fields: true, params: true }\r\n      );\r\n\r\n      // 2023-05-11 in edit-id mode, prefill isn't supported, but we want the fields\r\n      // I actually think that prefill should be supported, because it can also transport more parameters\r\n      // formUrl += prefill2UrlParams(groupItem.Prefill, fields);\r\n\r\n      // 2024-05-30 2dm reactivating prefill on edit, for scenarios where new fields were added\r\n      // and for ephemeral control fields\r\n      // 2024-06-01 2dm re-disabled, since this also affects links coming in from the page\r\n      // so this could be an unexpected breaking change...\r\n      // formUrl += prefill2UrlParams(asItem.Prefill);\r\n\r\n    \r\n    }\r\n    // Add item, optionally with For-Metadata\r\n    else if ((item as ItemAddIdentifier).ContentTypeName) {\r\n      l.a(\"asItem having content type name\", {item});\r\n      // Add Item\r\n      const addItem = item as ItemAddIdentifier;\r\n      formUrl += 'new:' + addItem.ContentTypeName;\r\n\r\n      // Save in JS, new v21 WIP\r\n      const save = item.ClientData?.save;\r\n\r\n      formUrl += addTypicalUrlGroups(addItem, fields, parameters,\r\n        { metadata: true, prefill: true, fields: true, params: true, duplicate: true, save: save }\r\n      );\r\n\r\n      const overrideData = item.ClientData?.data;\r\n\r\n      // console.log('2dm-convertFormToUrl - overrideData', { overrideData });\r\n\r\n      if (overrideData)\r\n        formUrl += `${VAL_SEPARATOR}${DATA_PREFIX}${UrlParamBase64.encode(overrideData)}`;\r\n\r\n    }\r\n  }\r\n  return l.r(formUrl);\r\n}\r\n\r\nfunction addTypicalUrlGroups(\r\n  item: ItemAddIdentifier | ItemEditIdentifier | ItemInListIdentifier,\r\n  fields: string | undefined,\r\n  parameters: Record<string, unknown> | undefined,\r\n  parts: { metadata?: boolean, prefill?: boolean, fields?: boolean, params?: boolean, duplicate?: boolean, save?: string }\r\n): string {\r\n  const addItem = item as ItemAddIdentifier;\r\n  const result = ''\r\n    + (parts.metadata ? getParamForMetadata(addItem) : '')\r\n    + (parts.prefill ? prefill2UrlParams(item.Prefill) : '')\r\n    + (parts.fields ? fields2UrlParams(fields) : '')\r\n    + (parts.params ? obj2UrlParams(parameters, PARAM_PREFIX) : '')\r\n    + (parts.duplicate && addItem.DuplicateEntity ? `${VAL_SEPARATOR}${COPY_PREFIX}` + addItem.DuplicateEntity : '')\r\n    + (parts.save ? `${VAL_SEPARATOR}${SAVE_PREFIX}${parts.save}` : '');\r\n  return result;\r\n}\r\n\r\nfunction getParamForMetadata(addItem: ItemAddIdentifier) {\r\n  const l = log.fn(\"getParamForMetadata\", {addItem});\r\n\r\n  // helper function\r\n  const buildForSuffix = (itemFor: EavFor) => toOrderedParams([\r\n    '', // empty string to ensure it will start with a \":\"\r\n    itemFor.Target,\r\n    itemFor.TargetType,\r\n    (itemFor.Singleton ? itemFor.Singleton.toString() : '')\r\n  ]);\r\n\r\n  if (addItem.For != null) {\r\n    const prefix = `${VAL_SEPARATOR}for:`;\r\n    const forSuffix = buildForSuffix(addItem.For);\r\n    if (addItem.For?.String)\r\n      return l.r(`${prefix}s~${ParamEncoder.encode(addItem.For.String)}${forSuffix}`, \"for string\");\r\n    if (addItem.For?.Number)\r\n      return l.r(`${prefix}n~${addItem.For.Number}${forSuffix}`, \"for number\");\r\n    if (addItem.For?.Guid)\r\n      return l.r(`${prefix}g~${addItem.For.Guid}${forSuffix}`, \"for guid\");\r\n  }\r\n  if (addItem.Metadata)\r\n    return l.r(getParamForOldMetadata(addItem), \"metadata\");\r\n  return l.r('', \"other\");\r\n}\r\n\r\nfunction getParamForOldMetadata(addItem: ItemAddIdentifier) {\r\n  const l = log.fn(\"getParamForOldMetadata\", {addItem});\r\n  let keyType: string;\r\n  switch (addItem.Metadata.keyType.toLocaleLowerCase()) {\r\n    case eavConstants.keyTypes.string:\r\n      keyType = 's';\r\n      break;\r\n    case eavConstants.keyTypes.number:\r\n      keyType = 'n';\r\n      break;\r\n    case eavConstants.keyTypes.guid:\r\n      keyType = 'g';\r\n      break;\r\n  }\r\n  const target = Object.values(eavConstants.metadata)\r\n    .find(m => m.targetType === addItem.Metadata.targetType)?.target;\r\n  const result = `${VAL_SEPARATOR}for:` + keyType + METADATA_SEPARATOR + toOrderedParams([\r\n    ParamEncoder.encode(addItem.Metadata.key),\r\n    target,\r\n    addItem.Metadata.targetType\r\n  ]);\r\n  return l.r(result, result);\r\n}\r\n\r\nfunction prefill2UrlParams(prefill: Record<string, unknown>) {\r\n  return obj2UrlParams(prefill, PREFILL_PREFIX);\r\n}\r\n\r\nfunction obj2UrlParams(obj: Record<string, unknown>, prefix: string) {\r\n  let result = '';\r\n  if (!obj) return result;\r\n  for (const [key, value] of Object.entries(obj)) {\r\n    if (value == null) continue;\r\n    result += `${VAL_SEPARATOR}${prefix}${key}~${ParamEncoder.encode(value.toString())}`;\r\n  }\r\n  return result;\r\n}\r\n\r\nfunction prefillFromUrlParams(url: string, addTo: Record<string, unknown>): Record<string, unknown> {\r\n  const result = addTo ?? {} as Record<string, string>;\r\n  if (url == null) return result;\r\n  const prefillParams = url.split(LIST_SEPARATOR);\r\n  const [key, value] = prefillParams[1].split(METADATA_SEPARATOR);\r\n  const decodedValue = ParamEncoder.decode(value);\r\n  result[key] = decodedValue;\r\n  return result;\r\n}\r\n\r\nfunction fields2UrlParams(fields: string) {\r\n  return fields ? `${VAL_SEPARATOR}${UIFIELDS_PREFIX}${ParamEncoder.encode(fields)}` : '';\r\n}\r\n\r\nfunction isNumber(maybeNumber: string): boolean {\r\n  // The regex must be re-created for each test\r\n  return /^-?[0-9]*$/g.test(maybeNumber);\r\n}\r\n\r\nexport function convertUrlToForm(formUrl: string) {\r\n  const l = log.fn(\"convertUrlToForm\", { formUrl });\r\n  const form: EditForm = { items: [] };\r\n  const items = formUrl.split(ITEM_SEPARATOR);\r\n\r\n  for (const item of items) {\r\n    l.a(\"item\", {item});\r\n    // Handle group:\r\n    if (item.startsWith(GROUP_PREFIX)) {\r\n      // Inner Item / Group Item\r\n      let innerItem = {} as ItemInListIdentifier;\r\n      const options = item.split(VAL_SEPARATOR);\r\n\r\n      for (const option of options) {\r\n        if (option.startsWith(GROUP_PREFIX)) {\r\n          const params = option.split(LIST_SEPARATOR);\r\n          const hasParam5Id = params.length > 4 && params[5] && isNumber(params[5]);\r\n          innerItem = {\r\n            ...innerItem,\r\n            Parent: params[1],\r\n            Field: params[2],\r\n            Index: parseInt(params[3], 10),\r\n            Add: params[4] === 'true',\r\n            ...(hasParam5Id && { EntityId: parseInt(params[5], 10) })\r\n          }\r\n        } else if (option.startsWith(COPY_PREFIX)) {\r\n          // Add Item Copy\r\n          innerItem = {\r\n            ...innerItem,\r\n            DuplicateEntity: parseInt(option.split(LIST_SEPARATOR)[1], 10)\r\n          };\r\n        } else {\r\n          innerItem = addParamToItemIdentifier(innerItem, option);\r\n        }\r\n      }\r\n      form.items.push(innerItem);\r\n    } else if (isNumber((item ?? '').split(VAL_SEPARATOR)[0])) {\r\n      // Edit Item\r\n      const parts = item.split(VAL_SEPARATOR);\r\n      let editItem: ItemEditIdentifier = ItemIdHelper.editId(parseInt(parts[0], 10));\r\n      for (const part of parts)\r\n        editItem = addParamToItemIdentifier(editItem, part);\r\n      form.items.push(editItem);\r\n    } else if (item.startsWith('new:')) {\r\n      // Add Item\r\n      let addItem = {} as ItemAddIdentifier;\r\n      const options = item.split(VAL_SEPARATOR);\r\n\r\n      for (const option of options) {\r\n        if (option.startsWith('new:')) {\r\n          // Add Item ContentType\r\n          const newParams = option.split(LIST_SEPARATOR);\r\n          addItem.ContentTypeName = newParams[1];\r\n        } else if (option.startsWith('for:')) {\r\n          // Add Item For\r\n          const forParams = option.split(LIST_SEPARATOR);\r\n          const [forKeyType, forKey] = forParams[1].split(METADATA_SEPARATOR);\r\n          const forSingleton = forParams[4] != null ? forParams[4] === 'true' : undefined;\r\n          addItem.For = {\r\n            Target: forParams[2],\r\n            TargetType: parseInt(forParams[3], 10),\r\n            ...(forKeyType === 'g' && { Guid: forKey }),\r\n            ...(forKeyType === 'n' && { Number: parseInt(forKey, 10) }),\r\n            ...(forKeyType === 's' && { String: ParamEncoder.decode(forKey) }),\r\n            ...(forSingleton != null && { Singleton: forSingleton }),\r\n          };\r\n        } else if (option.startsWith(COPY_PREFIX)) {\r\n          // Add Item Copy\r\n          addItem = {\r\n            ...addItem,\r\n            DuplicateEntity: parseInt(option.split(LIST_SEPARATOR)[1], 10)\r\n          };\r\n\r\n        } else\r\n          addItem = addParamToItemIdentifier(addItem, option);\r\n      }\r\n      form.items.push(addItem);\r\n    }\r\n  }\r\n  return l.r(form);\r\n}\r\n\r\n/** add prefill and filter to url parameters */\r\nfunction addParamToItemIdentifier<T extends ItemIdentifierShared>(item: T, part: string): T {\r\n  const l = log.fn(\"addParamToItemIdentifier\", {item, part});\r\n  if (part.startsWith(UIFIELDS_PREFIX)) {\r\n    const fields = ParamEncoder.decode(part.split(LIST_SEPARATOR)[1]);\r\n    item.ClientData = { ...item.ClientData, fields };\r\n    return l.rSilent(item);\r\n  }\r\n  // Add Item Prefill\r\n  if (part.startsWith(PREFILL_PREFIX)) {\r\n    item.Prefill = prefillFromUrlParams(part, item.Prefill);\r\n    return l.rSilent(item);\r\n  }\r\n  // Add Item Form\r\n  if (part.startsWith(PARAM_PREFIX)) {\r\n    const formParams = prefillFromUrlParams(part, item.ClientData?.parameters);\r\n    item.ClientData = { ...item.ClientData, parameters: formParams };\r\n    return l.rSilent(item);\r\n  }\r\n\r\n  // Add Save mode new v21 WIP\r\n  if (part.startsWith(SAVE_PREFIX)) {\r\n    const save = part.split(LIST_SEPARATOR)[1] as 'js';\r\n    item.ClientData = { ...item.ClientData, save };\r\n    return l.rSilent(item);\r\n  }\r\n\r\n  // restore data new v21 WIP\r\n  if (part.startsWith(DATA_PREFIX)) {\r\n    const dataEncoded = part.split(LIST_SEPARATOR)[1];\r\n    const data = UrlParamBase64.decode(dataEncoded);\r\n    item.ClientData = { ...item.ClientData, data };\r\n    return l.rSilent(item);\r\n  }\r\n\r\n  return l.rSilent(item, 'no match');\r\n}\r\n\r\n","import { Injectable } from '@angular/core';\r\nimport { Observable } from 'rxjs';\r\nimport { HttpServiceBaseSignal } from './http-service-base-signal';\r\n\r\n/**\r\n * Base class for all services that need to make HTTP calls.\r\n * Provides important typical information and services, especially\r\n * * apiUrl(name) - to get the full API URL\r\n * * appId - the current app id\r\n * * zoneId - the current zone id\r\n */\r\n@Injectable()\r\nexport class HttpServiceBase extends HttpServiceBaseSignal {\r\n\r\n  protected getHttpApiUrl<ResultType>(endpoint: string, options?: Parameters<typeof this.http.get>[1]): Observable<ResultType> {\r\n    const url = this.apiUrl(endpoint);\r\n    return this.http.get<ResultType>(url, options ?? undefined); // has a quick, null would fail, undefined is ok\r\n  }\r\n\r\n  // @2dg 18.6.2025 commented out, not used anywhere\r\n  // protected getHttp<ResultType>(endpoint: string, options?: Parameters<typeof this.http.get>[1]): Observable<ResultType> {\r\n  //   return this.http.get<ResultType>(endpoint, options);\r\n  // }\r\n\r\n  // @2dg 18.6.2025 commented out, not used anywhere\r\n  // protected getAndWrite<ResultType>(endpoint: string, options: Parameters<typeof this.http.get>[1], target: WritableSignal<ResultType>): void {\r\n  //   this.getHttp<ResultType>(endpoint, options).subscribe(d => {\r\n  //     target.set(d);\r\n  //   });\r\n  // }\r\n\r\n  // @2dg 18.6.2025 commented out, not used anywhere\r\n  // /**\r\n  //  * @template ResultType Type of the final resulting data in the signal\r\n  //  * @template HttpType Type of the data returned by the http call; will match ResultType if no map is provided\r\n  //  * @param endpoint url / endpoint\r\n  //  * @param options http options\r\n  //  * @param initial initial value for the signal, before the http call\r\n  //  * @param reMap optional mapping function to transform the http result into the signal result\r\n  //  * @returns \r\n  //  */\r\n  // protected getSignal<ResultType, HttpType = ResultType>(\r\n  //   endpoint: string,\r\n  //   options?: Parameters<typeof this.http.get>[1],\r\n  //   initial?: ResultType,\r\n  //   reMap?: (x: HttpType) => ResultType,\r\n  // ): Signal<ResultType> {\r\n  //   // prepare the target signal\r\n  //   const target = signal<ResultType>(initial);\r\n  //   // do http call and set the result\r\n  //   this.getHttpApiUrl<HttpType>(endpoint, options).subscribe(d => {\r\n  //     // if we have a map function, use it, otherwise just cast\r\n  //     const transformed = reMap ? reMap(d) : (d as unknown as ResultType);\r\n  //     target.set(transformed)\r\n  //   });\r\n  //   return target;\r\n  // }\r\n\r\n  // @2dg 18.6.2025 commented out, not used anywhere\r\n  // protected postSignal<ResultType>(endpoint: string, body: Parameters<typeof this.http.post>[1], options: Parameters<typeof this.http.post>[2], initial: ResultType): Signal<ResultType> {\r\n  //   const target = signal<ResultType>(initial);\r\n  //   this.http.post<ResultType>(this.apiUrl(endpoint), body, options).subscribe(d => {\r\n  //     target.set(d)\r\n  //   });\r\n  //   return target;\r\n  // }\r\n\r\n}\r\n","import { Signal, CreateComputedOptions } from '@angular/core';\r\nimport { computedObj } from './signal.utilities';\r\n\r\nexport type ComputedCache<TKey extends string, TValue> = Record<TKey, Signal<TValue>>;\r\n\r\n/**\r\n * Special helper with Signals to cache computed signals.\r\n */\r\nexport class ComputedCacheHelper<TKey extends string | number, TValue> {\r\n\r\n  static proxy<TKey extends string | number, TValue>(\r\n    name: string = 'cache-name?',\r\n    factory: (name: string) => () => TValue, options: CreateComputedOptions<TValue> = null,\r\n  ) : Record<TKey, Signal<TValue>> {\r\n    const cch =  new ComputedCacheHelper<TKey, TValue>(name);\r\n    const proxy = cch.buildProxy(factory, options);\r\n    return proxy;\r\n  }\r\n\r\n  constructor(private name: string = 'cache-name?') {\r\n  }\r\n\r\n  private cache: Record<TKey, Signal<TValue>> = {} as Record<TKey, Signal<TValue>>;\r\n\r\n  get(key: TKey): Signal<TValue> {\r\n    return this.cache[key];\r\n  }\r\n\r\n  buildProxy(factory: (name: string) => () => TValue, options: CreateComputedOptions<TValue> = null) {\r\n    if (this.#proxy) throw new Error(`Proxy already built; it can't be again, as the factory could be unexpectedly different.`);\r\n    this.#proxy = new Proxy(this.cache, {\r\n      get: (_, fieldName) => {\r\n        if (typeof fieldName === 'string')\r\n          return this.getOrCreate(fieldName as TKey, factory(fieldName), options);\r\n        throw new Error(`Invalid name: '${fieldName?.toString()}'`);\r\n      }\r\n    });\r\n    return this.#proxy;\r\n  }\r\n  #proxy: Record<TKey, Signal<TValue>>;\r\n\r\n  getOrCreate(key: TKey, factory: () => TValue, options: CreateComputedOptions<TValue> = null): Signal<TValue> {\r\n    return this.getOrCreateWithInfo(key, factory, options).signal;\r\n  }\r\n\r\n  getOrCreateWithInfo(key: TKey, factory: () => TValue, options: CreateComputedOptions<TValue> = null): { signal: Signal<TValue>, isNew: boolean } {\r\n    if (this.cache[key])\r\n      return { signal: this.cache[key], isNew: false };\r\n    const sig = computedObj(`${this.name}-${key}`, () => factory());\r\n    return { signal: this.set(key, sig), isNew: true };\r\n  }\r\n\r\n\r\n  set(key: TKey, value: Signal<TValue>): Signal<TValue> {\r\n    this.cache[key] = value;\r\n    return value;\r\n  }\r\n\r\n  delete(key: TKey): void {\r\n    delete this.cache[key];\r\n  }\r\n\r\n  clear(): void {\r\n    Object.keys(this.cache).forEach((key) => {\r\n      delete this.cache[key as TKey];\r\n    });\r\n  }\r\n}","import { FnLogger } from './fn-logger.interface';\r\n\r\n/**\r\n * No-Operation logger.\r\n */\r\nexport class FnLoggerNoOp implements FnLogger {\r\n  enabled: boolean = false;\r\n  values(data: Record<string, unknown>, intro?: string): void { }\r\n  a(message: string, data?: Record<string, unknown>): void { }\r\n  r<TResult>(result: TResult, message?: string, showData?: boolean): TResult {\r\n    return result;\r\n  }\r\n  rSilent<TResult>(result: TResult, message?: string): TResult {\r\n    return result;\r\n  }\r\n  rNull(message?: string): null {\r\n    return null;\r\n  }\r\n  rTrue(message?: string): boolean {\r\n    throw true;\r\n  }\r\n  rFalse(message?: string): boolean {\r\n    throw false;\r\n  }\r\n\r\n  end(message?: string, data?: Record<string, unknown>): void { }\r\n\r\n}\r\n","import { Observable, tap } from 'rxjs';\r\nimport { ClassLogger } from './class/class-logger';\r\n\r\n/**\r\n * Special debug helper for RxJS observables\r\n */\r\nexport class RxTapDebug {\r\n  /**\r\n   * Constructor which will know the context and name of the stream it's for\r\n   * @param logger the main objects logger with name etc.\r\n   * @param name name of the stream we're logging\r\n   * @param jsonify will JSON.stringify the data if true - this is much faster as the browser doesn't block the debugger as much\r\n   */\r\n  constructor(private logger: ClassLogger, public name: string, private enabled = true, private jsonify: boolean = true) { }\r\n\r\n  /**\r\n   * Generate a rxjs tap function that logs the data with the current context\r\n   * Inspired by https://blog.angular-university.io/debug-rxjs/\r\n   * @param key\r\n   * @param subName\r\n   * @param message\r\n   * @returns\r\n   */\r\n  private generateFn<T>(key: string, subName?: unknown, message?: string): (source: Observable<T>) => Observable<T> {\r\n    // if not enabled, just return the original observable\r\n    if (!this.enabled || !this.logger.enabled) return (source: Observable<T>) => source;\r\n\r\n    const label = `${this.name}/${key}${subName ? `-${subName}` : ''}`;\r\n    let counter = 0;\r\n\r\n    // return a function that takes an observable and returns an observable\r\n    // and logs the data, and counts every access\r\n    return (source: Observable<T>) =>\r\n      source.pipe(\r\n        tap((data) => {\r\n          const showData = data == null\r\n            ? data  // if null or undefined, just show it\r\n            : this.jsonify ? JSON.parse(JSON.stringify(data)) : data;\r\n          return this.logger.a(label + ` #${counter++}`, { showData });\r\n        })\r\n      );\r\n  };\r\n\r\n  /** Create a sub-rx-tap (not yet tested as of 2024-06-11) */\r\n  rxTap(name: string, { enabled = true, jsonify = true }: { enabled?: boolean; jsonify?: boolean; } = { enabled: true, jsonify: true }) {\r\n    return new RxTapDebug(this.logger, `${this.name}-${name}`, enabled, jsonify);\r\n  }\r\n\r\n\r\n  /**\r\n   * Recommended to use at the beginning of a pipe to show when inbound signals came\r\n   * @param subName optional sub-name, to distinguish between different uses\r\n   */\r\n  pipe<T>(subName?: string) { return this.generateFn<T>('pipe', subName); }\r\n\r\n  /**\r\n   * Recommended after map to show what the map did\r\n   * @param subName optional sub-name, to distinguish between different uses\r\n   */\r\n  map<T>(subName?: string) { return this.generateFn<T>('map', subName); }\r\n\r\n  /**\r\n   * Recommended after filter to show what the filter did\r\n   * @param subName optional sub-name, to distinguish between different uses\r\n   */\r\n  filter<T>(subName?: string) { return this.generateFn<T>('filter', subName); }\r\n\r\n  /**\r\n   * Recommended after shareReplay\r\n   * @param subName optional sub-name, to distinguish between different uses\r\n   * @returns\r\n   */\r\n  shareReplay<T>(subName?: string) { return this.generateFn<T>('shareReplay', subName); }\r\n\r\n  /**\r\n   * Recommended after distinctUntilChanged\r\n   * @param subName optional sub-name, to distinguish between different uses\r\n   * @returns\r\n   */\r\n  distinctUntilChanged<T>(subName?: string) { return this.generateFn<T>('distinctUntilChanged', subName); }\r\n\r\n\r\n  start<T>() { return this.generateFn<T>('start'); }\r\n  end<T>() { return this.generateFn<T>('end'); }\r\n  step<T>(num: number) { return this.generateFn('step' + num); }\r\n  part<T>(subName?: string) { return this.generateFn<T>('part', subName); };\r\n  read<T>(subName?: string) { return this.generateFn<T>('read', subName); }\r\n}\r\n","import { FnLoggerNoOp } from '../fn/fn-logger-noop';\r\nimport { FnLogger } from '../fn/fn-logger.interface';\r\nimport { RxTapDebug } from '../rx-debug-dbg';\r\nimport { BooleanKeys, ClassLogger, RecordOrGenerator, StringArrayKeys } from './class-logger';\r\n\r\nexport class ClassLoggerNoop<TSpecs extends unknown = any> implements ClassLogger<TSpecs> {\r\n  constructor(specs: TSpecs) {\r\n    this.specs = specs ?? {} as TSpecs;\r\n  }\r\n  svcId = 'noop';\r\n  name = 'noop';\r\n  get enabled() { return false; }\r\n  enableChildren = false;\r\n  specs: TSpecs;\r\n\r\n  extendName(addOn: string): this { return this; }\r\n\r\n  nameWithSvcId: string;\r\n\r\n  inherit(parent: ClassLogger<any>): void { }\r\n\r\n  forceEnable(enabled: boolean | null): void { }\r\n\r\n  a(message: string, data?: RecordOrGenerator): void { }\r\n\r\n  aIfInList(list: StringArrayKeys<TSpecs>, subKey: string, data?: RecordOrGenerator, message?: string): void { }\r\n  \r\n  aIf(key: BooleanKeys<TSpecs> & string, data?: RecordOrGenerator, message?: string): void { }\r\n\r\n  rxTap(name: string, options?: { enabled?: boolean; jsonify?: boolean; }): RxTapDebug {\r\n    return new RxTapDebug(this as ClassLogger, 'noop');\r\n  }\r\n  \r\n  fn(name: string, data?: RecordOrGenerator, message?: string): FnLogger {\r\n    return new FnLoggerNoOp();\r\n  }\r\n  \r\n  fnCond(condition: boolean, name: string, data?: RecordOrGenerator, message?: string): FnLogger {\r\n    return new FnLoggerNoOp();\r\n  }\r\n  \r\n  fnIf(key: string, data?: RecordOrGenerator, message?: string): FnLogger {\r\n    return new FnLoggerNoOp();\r\n  }\r\n\r\n  fnIfInList(key: BooleanKeys<TSpecs> & string, list: StringArrayKeys<TSpecs>, value: string, data?: RecordOrGenerator, message?: string): FnLogger {\r\n    return new FnLoggerNoOp();\r\n  }\r\n\r\n  fnIfInFields(key: BooleanKeys<TSpecs> & string, fieldName: string, data?: RecordOrGenerator, message?: string): FnLogger {\r\n    return new FnLoggerNoOp();\r\n  }\r\n\r\n}","/**\r\n * Log to Console lightweight (no stack).\r\n * Uses a short, cryptic name log-console-internal to avoid it being used by mistake.\r\n*/\r\nexport function consoleLogObject({ message, callStack = false, data = null }\r\n  : { message?: any; callStack?: boolean, data?: Record<string, unknown>; }\r\n): void {\r\n  // Make prefix uppercase if not always\r\n  const prefix = ' ';\r\n  message = prefix + message;\r\n\r\n  // New lightweight log, without the entire trace / call stack\r\n  if (callStack != true) {\r\n    if (!data)\r\n      return console.log(`${message}`)\r\n\r\n    const keys = Object.keys(data);\r\n    if (keys.length === 0)\r\n      return console.log(`${message}`);\r\n\r\n    if (keys.length === 1) {\r\n      const key = keys[0];\r\n      const show = data[key];\r\n      if (typeof (show) === 'string')\r\n        return console.log(`${message} [string:${show.length}] '${key}'='${show}'`);\r\n      return console.log(`${message} [${typeof (show)}] '${key}'=`, show);\r\n    }\r\n\r\n    console.log(`${message} [${keys.length} data-items]`, data);\r\n    return;\r\n  }\r\n\r\n  console.groupCollapsed(`${message}`, data);\r\n\r\n  // tslint:disable-next-line:no-console\r\n  console.trace();\r\n  console.groupEnd();\r\n}\r\n\r\n","import { consoleLogObject } from '../output-console';\r\nimport { FnLogger } from './fn-logger.interface';\r\nimport { ClassLogger, RecordOrGenerator } from '../class/class-logger';\r\n\r\nexport class FnLoggerReal implements FnLogger {\r\n  \r\n  constructor(private parent: ClassLogger, private fnName: string, message?: string, data?: RecordOrGenerator) {\r\n    this.#a(message, data);\r\n  }\r\n\r\n  get enabled() { return this.parent.enabled; };\r\n\r\n  /** Internal helper to really log - if enabled */\r\n  #a(message: string, data?: RecordOrGenerator, autoPad: boolean = true): void {\r\n    if (!this.parent.enabled) return;\r\n    message ??= '';\r\n    if (message && autoPad) message = ` ${message}`;\r\n    data = typeof data === 'function' ? data() : data;\r\n    consoleLogObject({ message: `${this.parent.nameWithSvcId}.${this.fnName}()${message}`, data });\r\n  }\r\n\r\n  a(message: string, data?: Record<string, unknown>): void {\r\n    this.#a('/' + message, data, false);\r\n  }\r\n\r\n  values(data: Record<string, unknown>, intro?: string): void {\r\n    if (!data) return;\r\n    if (!this.parent.enabled) return;\r\n    intro = intro ? ` ${intro} ` : '';\r\n    this.#a('/values' + intro, data, false);\r\n  }\r\n\r\n  /** Return result and log it */\r\n  r<TResult>(result: TResult, message?: string): TResult {\r\n    this.#a('/return' + (message ? ' ' + message : ''), { result: result }, false);\r\n    return result;\r\n  }\r\n\r\n  /** Return without logging the result data */\r\n  rSilent<TResult>(result: TResult, message?: string): TResult {\r\n    this.#a('/return' + (message ? ' ' + message : ''), null, false);\r\n    return result;\r\n  }\r\n\r\n  /** Return NULL */\r\n  rNull(message?: string): null {\r\n    this.#a('/return NULL' + (message ? ' ' + message : ''), null, false);\r\n    return null;\r\n  }\r\n  rTrue(message?: string): boolean {\r\n    this.#a('/return TRUE' + (message ? ' ' + message : ''), null, false);\r\n    return true;\r\n  }\r\n  rFalse(message?: string): boolean {\r\n    this.#a('/return FALSE' + (message ? ' ' + message : ''), null, false);\r\n    return false;\r\n  }\r\n\r\n\r\n  /** End without return but show message and optional data */\r\n  end(message?: string, data?: Record<string, unknown>) {\r\n    this.#a('/end' + (message ? ' ' + message : ''), data, false);\r\n  }\r\n\r\n}\r\n\r\n\r\n","import { environment } from '../../../../environments/environment';\r\nimport { FnLoggerNoOp } from '../fn/fn-logger-noop';\r\nimport { FnLoggerReal } from '../fn/fn-logger-real';\r\nimport { FnLogger } from '../fn/fn-logger.interface';\r\nimport { LogSpecs } from '../log-specs';\r\nimport { consoleLogObject } from '../output-console';\r\nimport { RxTapDebug } from '../rx-debug-dbg';\r\nimport { BooleanKeys, ClassLogger, RecordOrGenerator, StringArrayKeys } from './class-logger';\r\n\r\n/**\r\n * TODO:\r\n * - STOP using this directly, but instead use the classLog function\r\n * - Then rename to ClassLogger\r\n * - ...and move to sub-folder\r\n */\r\nexport class ClassLoggerReal<TSpecs extends unknown = any> implements ClassLogger<TSpecs> {\r\n  /** Special random ID to identify a specific service and detect reuse or separate instances  */\r\n  svcId = Math.random().toString(36).substring(2, 5);\r\n\r\n  /** Name to be used in console logs etc. */\r\n  name: string;\r\n\r\n  /** Enabled state, combination of own enabled value + production-build info */\r\n  get enabled() { return this.#enabled; }\r\n  #enabled: boolean;\r\n  #setEnabled(value: boolean) {\r\n    this.#enabled = value && !environment.production;\r\n  }\r\n\r\n\r\n  enableChildren: boolean;\r\n\r\n  /** Additional specs for logging just parts of the data */\r\n  specs: TSpecs;\r\n\r\n  constructor(logSpecs: LogSpecs<TSpecs>) {\r\n    this.#rename(logSpecs.name);\r\n    // Bypass the default setEnabled, as we want to be able to override in production\r\n    this.#enabled = logSpecs.enabled;\r\n    this.enableChildren = logSpecs.enableChildren ?? false;\r\n    this.specs = logSpecs.specs;\r\n  }\r\n\r\n  #rename(name: string) {\r\n    this.name = name;\r\n    this.nameWithSvcId = `${name}-${this.svcId}`;\r\n  }\r\n\r\n  public extendName(addOn: string): this {\r\n    this.#rename(`${this.name}${addOn}`);\r\n    return this;\r\n  }\r\n\r\n  public nameWithSvcId: string;\r\n\r\n  public inherit(parent: ClassLogger) {\r\n    // if already enabled, don't do anything; inherit can only activate it\r\n    if (this.enabled)\r\n      return;\r\n\r\n    this.#setEnabled(parent.enabled);\r\n\r\n    // if this results in log enabled, inform the console.\r\n    // otherwise it's really hard to find out why a log is on\r\n    if (parent.enabled)\r\n      this.a(`Enabled: Inheriting log settings from parent ${parent.nameWithSvcId}`);\r\n  }\r\n\r\n  public forceEnable(enabled: boolean | null) {\r\n    if (enabled == null || this.enabled) return;\r\n    if (enabled) this.a('Enabled: Forced to enable log');\r\n    this.#setEnabled(enabled);\r\n  }\r\n\r\n  /** Internal helper to really log - if enabled */\r\n  #a(message: string, data?: RecordOrGenerator, autoPad: boolean = true): void {\r\n    if (!this.enabled) return;\r\n    message ??= '';\r\n    if (message && autoPad) message = ` ${message}`;\r\n    data = typeof data === 'function' ? data() : data;\r\n    consoleLogObject({ message: `${this.nameWithSvcId}${message}`, data });\r\n  }\r\n\r\n  /**\r\n   * Special 'a' = add log helper to better diagnose what is happening\r\n   */\r\n  a(message: string, data?: RecordOrGenerator): void {\r\n    this.#a(message, data);\r\n  }\r\n\r\n  aIf(key: BooleanKeys<TSpecs> & string, data?: RecordOrGenerator, message?: string): void {\r\n    if (this.enabled && this.#ifInSpecs(key))\r\n      this.#a(message, data);\r\n  }\r\n\r\n  aIfInList(list: StringArrayKeys<TSpecs>, subKey: string, data?: RecordOrGenerator, message?: string): void {\r\n    if (this.enabled && this.#ifInSpecsList(list, subKey))\r\n      this.#a(message, data);\r\n  }\r\n\r\n  /** Create a special logger for rx logging */\r\n  rxTap(name: string, { enabled = true, jsonify = true }: { enabled?: boolean; jsonify?: boolean; } = { enabled: true, jsonify: true }): RxTapDebug {\r\n    return new RxTapDebug(this as ClassLogger, name, enabled, jsonify);\r\n  }\r\n\r\n  /**\r\n   * \r\n   * TODO: @2pp - refactor all uses to just use the fnIf method? - but WAIT till delegate by 2dm\r\n   * \r\n   * @param name \r\n   * @param data \r\n   * @param message \r\n   * @returns \r\n   */\r\n  fn(name: string, data?: RecordOrGenerator, message?: string): FnLogger {\r\n    return new FnLoggerReal(this as ClassLogger, name, message, data);\r\n  }\r\n\r\n  /**\r\n   * Create a logger function that will only log if the condition is true\r\n   */\r\n  fnCond(condition: boolean, name: string, data?: RecordOrGenerator, message?: string): FnLogger {\r\n    // create real logger if condition is true, or if this logger is disabled anyhow\r\n    return condition || !this.enabled\r\n      ? this.fn(name, data, message)\r\n      : new FnLoggerNoOp();\r\n  }\r\n\r\n  /**\r\n   * Create a logger function that will only log if the condition is true.\r\n   * The condition must come from the specs object.\r\n   */\r\n  fnIf(key: BooleanKeys<TSpecs> & string, data?: RecordOrGenerator, message?: string): FnLogger {\r\n    // create real logger if condition is true, or if this logger is disabled anyhow\r\n    return this.enabled && this.#ifInSpecs(key)\r\n      ? this.fn(key, data, message)\r\n      : new FnLoggerNoOp();\r\n  }\r\n\r\n  fnIfInList(key: BooleanKeys<TSpecs> & string, listName: StringArrayKeys<TSpecs>, value: string, data?: RecordOrGenerator, message?: string): FnLogger {\r\n    return this.enabled && this.#ifInSpecs(key) && this.#ifInSpecsList(listName, value)\r\n      ? this.fn(`${key}[${value}]`, data, message)\r\n      : new FnLoggerNoOp();\r\n  }\r\n\r\n  fnIfInFields(key: BooleanKeys<TSpecs> & string, value: string, data?: RecordOrGenerator, message?: string): FnLogger {\r\n    return this.fnIfInList(key, 'fields' as StringArrayKeys<TSpecs>, value, data, message);\r\n  }\r\n\r\n  /** Helper to check if a key is in the specs and is true, or 'all' is true */\r\n  #ifInSpecs(key: BooleanKeys<TSpecs> & string): boolean {\r\n    return this.specs && !!(this.specs[key] || (this.specs as { all: boolean })['all']);\r\n  }\r\n\r\n  /** Check if tha property on the logSpecs contains the subKey or a wildcard '*' */\r\n  #ifInSpecsList(listName: StringArrayKeys<TSpecs>, subKey: string): boolean {\r\n    const keys = this.specs?.[listName] as string[] ?? [];\r\n    return keys && (keys.includes(subKey) || keys.includes('*'));\r\n  }\r\n}\r\n","import { environment } from './../../../environments/environment';\r\nimport { ClassLogger } from './class/class-logger';\r\nimport { ClassLoggerNoop } from './class/class-logger-noop';\r\nimport { ClassLoggerReal } from './class/class-logger-real';\r\nimport { LogManager } from './log-manager';\r\n\r\n//\r\n// This is a special section for logging.\r\n// A core goal is that logging will never break the application, so it should be null-safe\r\n// and work even if for example the .log property is null.\r\n\r\n/**\r\n * Main entry function to create a logger for a class.\r\n * \r\n * Usage: `log = classLog({MyClass})` // this will allow it to auto-detect the class name\r\n * \r\n * TODO: If logging is disabled, it will create a dummy logger that does nothing.\r\n * - wait with this, until we've refactored everything to use the new classLog and the logFn / logFnIf functions\r\n * @param owner a mini-class with 1 property, being the name of the class; optionally also the name as string, but not recommended\r\n * @param specs optional object containing further specs. If provided, can be used in `log.fnIf()` calls \r\n * @param pleaseUseClassLogEnabled blocker: to enable logging, please use classLogEnabled(...) so it's easier to find and disable again before release\r\n * @returns \r\n */\r\nexport function classLog<TSpecs extends Record<string, unknown> = any>(\r\n  owner: Record<string, unknown> | string,\r\n  specs?: TSpecs,\r\n  pleaseUseClassLogEnabled?: string,\r\n  enabled: boolean = false\r\n): ClassLogger<TSpecs> {\r\n\r\n  // Pick the first key as the name of the class\r\n  // Implemented as a function, to make the code clearer\r\n  const name = (() => {\r\n    if (!owner) return 'unknown';\r\n    if (typeof owner === 'string') return owner;\r\n    return (owner ? Object.keys(owner)[0] : null) ?? 'unknown';\r\n  })();\r\n  \r\n  // Build temporary logSpecs object\r\n  const logSpecs = {\r\n    // enabled should be false in production - unless overloaded below by the LogManager\r\n    enabled: enabled && !environment.production,\r\n    name,\r\n    specs: specs ?? {} as TSpecs,\r\n  }\r\n\r\n  // Get final / real logSpecs, and register these logs in the LogManager for run-time configuration\r\n  const mainSpecs = LogManager.getSpecs(logSpecs);\r\n\r\n  return (mainSpecs.enabled)\r\n    ? new ClassLoggerReal<TSpecs>(mainSpecs)\r\n    : new ClassLoggerNoop(specs);\r\n}\r\n\r\nexport function classLogEnabled<TSpecs extends Record<string, unknown> = any>(\r\n  owner: Record<string, unknown> | string,\r\n  specs?: TSpecs,\r\n): ClassLogger<TSpecs> {\r\n  return classLog(owner, specs, null, true);\r\n}"],"x_google_ignoreList":[]}