"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["default-projects_eav-ui_src_app_shared_components_file-upload-dialog_index_ts"],{3656:(D,g,i)=>{i.d(g,{E:()=>Y});var l=i(600),r=i(4844),h=i(5876),m=i(604),E=i(7496),_=i(6884),y=i(7244),e=i(4896),p=i(4648),d=i(5056),C=i(4204),c=i(4672),f=i(3884),T=i(8200),v=i(48);const O=["installerWindow"];function I(o,n){1&o&&e.wR5(0,"mat-spinner",5)}function M(o,n){1&o&&(e.I0R(0,"div"),e.OEk(1,"Select or drop file"),e.C$Y())}function U(o,n){if(1&o&&(e.I0R(0,"div"),e.OEk(1),e.C$Y()),2&o){const t=n.$implicit;e.yG2(1),e.cNF(t.name)}}function x(o,n){if(1&o){const t=e.KQA();e.I0R(0,"button",14),e.qCj("click",function(){e.usT(t);const s=e.GaO(2);return e.CGJ(s.showAppCatalog())}),e.OEk(1," Get recommended Apps from Catalog "),e.C$Y()}}function P(o,n){1&o&&(e.I0R(0,"div",18),e.OEk(1," Upload succeeded. See the messages below for more information. "),e.C$Y())}function A(o,n){1&o&&(e.I0R(0,"div",19),e.OEk(1," Upload failed. See the messages below for more information. "),e.C$Y())}const F=(o,n,t)=>({"sxc-message-warning":o,"sxc-message-success":n,"sxc-message-error":t});function b(o,n){if(1&o&&(e.I0R(0,"div",20),e.OEk(1),e.C$Y()),2&o){const t=n.$implicit,a=e.GaO(3);e.E7m("ngClass",e.uAc(2,F,t.MessageType===a.FileUploadMessageTypes.Warning,t.MessageType===a.FileUploadMessageTypes.Success,t.MessageType===a.FileUploadMessageTypes.Error)),e.yG2(1),e.oRS(" ",t.Text," ")}}function G(o,n){if(1&o&&(e.I0R(0,"div",15),e.yuY(1,P,2,0,"div",16)(2,A,2,0,"div",17),e.c53(3,b,2,6,"div",21,e.oxv),e.C$Y()),2&o){const t=e.GaO();e.yG2(1),e.C0Y(1,t.result.Success?1:-1),e.yG2(1),e.C0Y(2,t.result.Success?-1:2),e.yG2(1),e.oho(t.result.Messages)}}function w(o,n){1&o&&e.wR5(0,"iframe",22,23)}function R(o,n){if(1&o){const t=e.KQA();e.I0R(0,"button",25),e.qCj("click",function(){e.usT(t);const s=e.GaO(3);return e.CGJ(s.closeDialog())}),e.OEk(1,"Cancel"),e.C$Y(),e.I0R(2,"button",26),e.qCj("click",function(){e.usT(t);const s=e.GaO(3);return e.CGJ(s.upload())}),e.OEk(3," Upload "),e.C$Y()}if(2&o){const t=e.GaO(2);e.yG2(2),e.E7m("disabled",!t.files.length||t.uploading||!!t.result)}}function $(o,n){if(1&o){const t=e.KQA();e.I0R(0,"button",27),e.qCj("click",function(){e.usT(t);const s=e.GaO(3);return e.CGJ(s.closeDialog(!0))}),e.OEk(1,"Close"),e.C$Y()}}function B(o,n){if(1&o&&(e.I0R(0,"mat-dialog-actions",13),e.yuY(1,R,4,1)(2,$,2,0,"button",24),e.C$Y()),2&o){const t=e.GaO();e.yG2(1),e.C0Y(1,null!=t.result&&t.result.Success?-1:1),e.yG2(1),e.C0Y(2,null!=t.result&&t.result.Success?2:-1)}}function L(o,n){if(1&o){const t=e.KQA();e.I0R(0,"div",1),e.qCj("filesDropped",function(s){e.usT(t);const u=e.GaO();return e.CGJ(u.filesDropped(s))}),e.I0R(1,"div",2),e.wR5(2,"div",3),e.wVc(3,"safeHtml"),e.C$Y(),e.I0R(4,"div",4),e.yuY(5,I,1,0,"mat-spinner",5),e.wR5(6,"p",6),e.wVc(7,"safeHtml"),e.I0R(8,"div")(9,"button",7),e.qCj("click",function(){e.usT(t);const s=e.Gew(14);return e.CGJ(s.click())}),e.yuY(10,M,2,0,"div"),e.c53(11,U,2,1,"div",null,e.oxv),e.C$Y(),e.I0R(13,"input",8,9),e.qCj("change",function(s){e.usT(t);const u=e.GaO();return e.CGJ(u.filesChanged(s))}),e.C$Y(),e.yuY(15,x,2,0,"button",10),e.C$Y(),e.yuY(16,G,5,2,"div",11)(17,w,2,0,"iframe",12),e.C$Y(),e.yuY(18,B,3,2,"mat-dialog-actions",13),e.C$Y()}if(2&o){const t=e.GaO();e.E7m("allowedFileTypes",t.dialogData.allowedFileTypes),e.yG2(2),e.E7m("innerHtml",e.kDX(3,10,t.dialogData.title),e.E3n),e.yG2(3),e.C0Y(5,n.uploading?5:-1),e.yG2(1),e.E7m("innerHtml",e.kDX(7,12,t.dialogData.description),e.E3n),e.yG2(3),e.E7m("disabled",n.uploading),e.yG2(1),e.C0Y(10,n.files.length?-1:10),e.yG2(1),e.oho(n.files),e.yG2(4),e.C0Y(15,t.uploadType==t.UploadTypes.App?15:-1),e.yG2(1),e.C0Y(16,n.result?16:-1),e.yG2(1),e.C0Y(17,t.uploadType==t.UploadTypes.App&&n.showAppCatalog?17:-1),e.yG2(1),e.C0Y(18,n.showAppCatalog?-1:18)}}let Y=(()=>{class o extends _.C{constructor(t,a,s){super(),this.dialogData=t,this.dialogRef=a,this.snackBar=s,this.hostClass="dialog-component",this.uploading$=new r.g(!1),this.files$=new r.g([]),this.result$=new r.g(void 0),this.FileUploadMessageTypes=y.c,this.UploadTypes=y.w,this.showAppCatalog$=new r.g(!1)}ngOnInit(){this.subscription.add(this.files$.subscribe(()=>{void 0!==this.result$.value&&this.result$.next(void 0)})),null!=this.dialogData.files&&this.filesDropped(this.dialogData.files),this.viewModel$=(0,h.E)([this.uploading$,this.files$,this.result$,this.showAppCatalog$]).pipe((0,m.k)(([t,a,s,u])=>({uploading:t,files:a,result:s,showAppCatalog:u})))}ngOnDestroy(){this.uploading$.complete(),this.files$.complete(),this.result$.complete(),super.ngOnDestroy()}closeDialog(t){this.dialogRef.close(t)}filesDropped(t){this.setFiles(t),this.upload()}filesChanged(t){const s=Array.from(t.target.files);this.setFiles(s)}upload(){this.uploading$.next(!0),this.subscription.add(this.dialogData.upload$(this.files$.value).pipe((0,E.U)(1)).subscribe({next:t=>{this.uploading$.next(!1),this.result$.next(t)},error:()=>{this.uploading$.next(!1),this.result$.next(void 0),this.snackBar.open("Upload failed. Please check console for more information",void 0,{duration:3e3})}}))}showAppCatalog(){this.showAppCatalog$.next(!this.showAppCatalog$.value)}setFiles(t){this.dialogData.multiple||(t=t.slice(0,1)),this.files$.next(t)}static#e=this.\u0275fac=function(a){return new(a||o)(e.GI1(l.sR),e.GI1(l.yI),e.GI1(p.yS))};static#t=this.\u0275cmp=e.In1({type:o,selectors:[["app-file-upload-dialog"]],viewQuery:function(a,s){if(1&a&&e.CC$(O,5),2&a){let u;e.wto(u=e.Gqi())&&(s.installerWindow=u.first)}},hostVars:1,hostBindings:function(a,s){2&a&&e.SoX("className",s.hostClass)},inputs:{uploadType:"uploadType"},features:[e.eg9],decls:2,vars:3,consts:[["class","eav-dialog","appDragAndDrop","",3,"allowedFileTypes"],["appDragAndDrop","",1,"eav-dialog",3,"allowedFileTypes","filesDropped"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title",3,"innerHtml"],[1,"eav-dialog-content"],["mode","indeterminate","diameter","20","color","accent"],[3,"innerHtml"],["mat-raised-button","","tippy","Open file browser",3,"disabled","click"],["type","file","multiple","",1,"hide",3,"change"],["fileInput",""],["mat-raised-button","","class","eav-app-catalog-button","tippy","Open app catalog"],["class","eav-result-container"],["class","eav-app-catalog-iframe","src","//gettingstarted.2sxc.org/router.aspx?Platform=Dnn&SysVersion=9.6.1&SxcVersion=16.07.01&destination=autoconfigureapp&ModuleId=1197&SiteId=16&ZoneID=17&DefaultLanguage=en-us&CurrentLanguage=en-us&SysGuid=DB92DBFC-0C60-4101-93C6-803C2FE244B6&AppId=&fp=c2b7fabe7d51a0a0f6484d72bc119c8bf2d14b8ad29b30696a9148f9845a766c"],["align","end"],["mat-raised-button","","tippy","Open app catalog",1,"eav-app-catalog-button",3,"click"],[1,"eav-result-container"],["class","sxc-message sxc-message-info"],["class","sxc-message sxc-message-error"],[1,"sxc-message","sxc-message-info"],[1,"sxc-message","sxc-message-error"],[1,"sxc-message",3,"ngClass"],["class","sxc-message",3,"ngClass"],["src","//gettingstarted.2sxc.org/router.aspx?Platform=Dnn&SysVersion=9.6.1&SxcVersion=16.07.01&destination=autoconfigureapp&ModuleId=1197&SiteId=16&ZoneID=17&DefaultLanguage=en-us&CurrentLanguage=en-us&SysGuid=DB92DBFC-0C60-4101-93C6-803C2FE244B6&AppId=&fp=c2b7fabe7d51a0a0f6484d72bc119c8bf2d14b8ad29b30696a9148f9845a766c",1,"eav-app-catalog-iframe"],["installerWindow",""],["mat-raised-button","","color","accent"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click"],["mat-raised-button","","color","accent",3,"click"]],template:function(a,s){if(1&a&&(e.yuY(0,L,19,14,"div",0),e.wVc(1,"async")),2&a){let u;e.C0Y(0,(u=e.kDX(1,1,s.viewModel$))?0:-1,u)}},dependencies:[d.QF,C.cm,c.Gw,l.Yp,f.Q,T.Y,d.a,v.K],styles:[".eav-result-container[_ngcontent-%COMP%]{margin-top:16px}.eav-app-catalog-button[_ngcontent-%COMP%]{margin-left:12px}.eav-app-catalog-iframe[_ngcontent-%COMP%]{margin-top:16px;width:100%;height:500px;border:none}"]})}return o})()},7244:(D,g,i)=>{i.d(g,{c:()=>l,w:()=>r});const l={Warning:0,Success:1,Error:2},r={App:0,AppPart:1,ContentType:2,ContentItem:3,Query:4,View:5}},8288:(D,g,i)=>{i.d(g,{Ev:()=>l.E,cB:()=>r.c,wr:()=>r.w});var l=i(3656),r=i(7244)},3884:(D,g,i)=>{i.d(g,{Q:()=>E});var l=i(4896),r=i(3244),h=i(6884),m=i(4648);let E=(()=>{class _ extends h.C{constructor(e,p,d){super(),this.zone=p,this.snackBar=d,this.markStyle="outline",this.allowedFileTypes="",this.filesDropped=new l._w7,this.dropAreaClass="eav-droparea",this.dragClass="eav-dragover",this.timeouts=[],this.element=e.nativeElement}ngOnInit(){this.markStyleClass=`eav-droparea-${this.markStyle}`,this.element.classList.add(this.dropAreaClass,this.markStyleClass),this.zone.runOutsideAngular(()=>{this.subscription.add((0,r.w)(this.element,"dragover").subscribe(e=>{e.preventDefault(),e.stopPropagation(),this.clearTimeouts(),this.element.classList.add(this.dragClass)})),this.subscription.add((0,r.w)(this.element,"dragleave").subscribe(e=>{e.preventDefault(),e.stopPropagation(),this.timeouts.push(window.setTimeout(()=>{this.element.classList.remove(this.dragClass)},50))}))})}ngOnDestroy(){this.clearTimeouts(),this.element.classList.remove(this.dropAreaClass,this.markStyleClass,this.dragClass),super.ngOnDestroy()}onDrop(e){e.preventDefault(),e.stopPropagation(),this.clearTimeouts(),this.element.classList.remove(this.dragClass);let d=Array.from(e.dataTransfer.files);d=this.filterTypes(d,this.allowedFileTypes),d.length>0&&this.filesDropped.emit(d)}clearTimeouts(){for(const e of this.timeouts)clearTimeout(e);this.timeouts=[]}filterTypes(e,p){if(""===p)return e;const d=p.split(",").map(c=>c.toLocaleLowerCase()),C=e.filter(c=>{const f=c.name.lastIndexOf(".");if(f<=0)return!1;const T=c.name.substring(f+1).toLocaleLowerCase();return d.includes(T)});if(e.length!==C.length){const c=this.allowedFileTypes.replace(/\,/g,", ");this.snackBar.open(C.length?"Some files were filtered out. This drop location only accepts file types: "+c:"This drop location only accepts file types: "+c,null,{duration:5e3})}return C}static#e=this.\u0275fac=function(p){return new(p||_)(l.GI1(l.GMv),l.GI1(l.WW2),l.GI1(m.yS))};static#t=this.\u0275dir=l.Sc5({type:_,selectors:[["","appDragAndDrop",""]],hostBindings:function(p,d){1&p&&l.qCj("drop",function(c){return d.onDrop(c)})},inputs:{markStyle:"markStyle",allowedFileTypes:"allowedFileTypes"},outputs:{filesDropped:"filesDropped"},features:[l.eg9]})}return _})()},48:(D,g,i)=>{i.d(g,{K:()=>h});var l=i(4896),r=i(168);let h=(()=>{class m{constructor(_){this.sanitizer=_}transform(_){return this.sanitizer.bypassSecurityTrustHtml(_)}static#e=this.\u0275fac=function(y){return new(y||m)(l.GI1(r.mI,16))};static#t=this.\u0275pipe=l.UTH({name:"safeHtml",type:m,pure:!0})}return m})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/17.02.00/dist/ng-edit/default-projects_eav-ui_src_app_shared_components_file-upload-dialog_index_ts.084df75cb0c587a9.js.map