{"version":3,"file":"projects_eav-ui_src_app_app-administration_sub-dialogs_language-permissions_language-permissi-a91b40.506b389fbe96899c.js","mappings":"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","names":["LanguagesPermissionsActionsComponent","agInit","params","this","language","data","refresh","openPermissions","onOpenPermissions","static","t","core","Xpm","selectors","decls","vars","consts","template","rf","ctx","i0","Permissions","Count","_r3","ctx_r2","closeDialog","vm_r1","languages","ctx_r0","gridOptions","LanguagePermissionsComponent","BaseComponent","constructor","router","route","dialogRef","zoneService","super","subscription","Subscription","languages$","BehaviorSubject","undefined","buildGridOptions","ngOnInit","getLanguages","add","refreshOnChildClosedShallow","subscribe","viewModel$","combineLatest","pipe","map","ngOnDestroy","complete","close","navigate","GoToPermissions","getUrlLanguage","NameId","relativeTo","getLanguagesPermissions","error","next","defaultGridOptions","columnDefs","headerName","field","width","headerClass","cellClass","split","sortable","filter","valueGetter","Code","cellRenderer","IdFieldComponent","cellRendererParams","tooltipGetter","flex","minWidth","sort","Culture","pinned","i1","i2","i3","features","LanguagePermissionsComponent_div_0_Template"],"sourceRoot":"webpack:///","sources":["./projects/eav-ui/src/app/app-administration/sub-dialogs/language-permissions/languages-permissions-actions/languages-permissions-actions.component.ts","./projects/eav-ui/src/app/app-administration/sub-dialogs/language-permissions/languages-permissions-actions/languages-permissions-actions.component.html","./projects/eav-ui/src/app/app-administration/sub-dialogs/language-permissions/language-permissions.component.html","./projects/eav-ui/src/app/app-administration/sub-dialogs/language-permissions/language-permissions.component.ts"],"sourcesContent":["import { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { ICellRendererParams } from '@ag-grid-community/core';\r\nimport { Component } from '@angular/core';\r\nimport { SiteLanguagePermissions } from '../../../../apps-management/models/site-language.model';\r\nimport { LanguagesPermissionsActionsParams } from './languages-permissions-actions.models';\r\n\r\n@Component({\r\n  selector: 'app-languages-permissions-actions',\r\n  templateUrl: './languages-permissions-actions.component.html',\r\n  styleUrls: ['./languages-permissions-actions.component.scss'],\r\n})\r\nexport class LanguagesPermissionsActionsComponent implements ICellRendererAngularComp {\r\n  language: SiteLanguagePermissions;\r\n\r\n  private params: ICellRendererParams & LanguagesPermissionsActionsParams;\r\n\r\n  agInit(params: ICellRendererParams & LanguagesPermissionsActionsParams): void {\r\n    this.params = params;\r\n    this.language = this.params.data;\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n\r\n  openPermissions(): void {\r\n    this.params.onOpenPermissions(this.language);\r\n  }\r\n}\r\n","<div class=\"actions-component\">\r\n  <div class=\"eav-grid-action-button highlight\" matRipple tippy=\"Permissions\" (click)=\"openPermissions()\">\r\n    <mat-icon [matBadge]=\"language.Permissions.Count\" matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n      [matBadgeHidden]=\"!language.Permissions.Count\" matBadgePosition=\"below after\" aria-hidden=\"false\">\r\n      person\r\n    </mat-icon>\r\n  </div>\r\n</div>","<div class=\"eav-dialog nav-component-wrapper\" *ngIf=\"viewModel$ | async as vm\">\r\n  <div class=\"eav-dialog-header\">\r\n    <div class=\"eav-dialog-header__title\">Language permissions</div>\r\n    <button mat-icon-button tippy=\"Close dialog\" (click)=\"closeDialog()\">\r\n      <mat-icon>close</mat-icon>\r\n    </button>\r\n  </div>\r\n  <div class=\"eav-dialog-content nav-component-wrapper\">\r\n    <p>\r\n      If no language permissions are defined, all editors can edit all languages.\r\n      As soon as you set any language permission, only the specified users\r\n      (or users in the specified groups) can edit these permissions.\r\n    </p>\r\n    <router-outlet></router-outlet>  \r\n    <div class=\"grid-wrapper\">\r\n      <ag-grid-angular class=\"ag-theme-material\" [rowData]=\"vm.languages\" [gridOptions]=\"gridOptions\">\r\n      </ag-grid-angular>\r\n    </div>\r\n    <mat-dialog-actions align=\"end\"></mat-dialog-actions>\r\n  </div>\r\n</div>","import { GridOptions } from '@ag-grid-community/core';\r\nimport { Component, OnDestroy, OnInit } from '@angular/core';\r\nimport { MatDialogRef } from '@angular/material/dialog';\r\nimport { ActivatedRoute, NavigationEnd, Router } from '@angular/router';\r\nimport { BehaviorSubject, combineLatest, filter, map, Observable, pairwise, startWith, Subscription } from 'rxjs';\r\nimport { SiteLanguagePermissions } from '../../../apps-management/models/site-language.model';\r\nimport { ZoneService } from '../../../apps-management/services/zone.service';\r\nimport { GoToPermissions } from '../../../permissions';\r\nimport { BaseComponent } from '../../../shared/components/base-component/base.component';\r\nimport { IdFieldComponent } from '../../../shared/components/id-field/id-field.component';\r\nimport { IdFieldParams } from '../../../shared/components/id-field/id-field.models';\r\nimport { defaultGridOptions } from '../../../shared/constants/default-grid-options.constants';\r\nimport { LanguagesPermissionsActionsComponent } from './languages-permissions-actions/languages-permissions-actions.component';\r\nimport { LanguagesPermissionsActionsParams } from './languages-permissions-actions/languages-permissions-actions.models';\r\n\r\n@Component({\r\n  selector: 'app-language-permissions',\r\n  templateUrl: './language-permissions.component.html',\r\n  styleUrls: ['./language-permissions.component.scss'],\r\n})\r\nexport class LanguagePermissionsComponent extends BaseComponent implements OnInit, OnDestroy {\r\n  languages$: BehaviorSubject<SiteLanguagePermissions[] | undefined>;\r\n  gridOptions: GridOptions;\r\n\r\n  viewModel$: Observable<LanguagePermissionsViewModel>;\r\n\r\n  constructor(\r\n    protected router: Router,\r\n    protected route: ActivatedRoute,\r\n    private dialogRef: MatDialogRef<LanguagePermissionsComponent>,\r\n    private zoneService: ZoneService,\r\n  ) {\r\n    super(router, route);\r\n    this.subscription = new Subscription();\r\n    this.languages$ = new BehaviorSubject<SiteLanguagePermissions[] | undefined>(undefined);\r\n    this.gridOptions = this.buildGridOptions();\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.getLanguages();\r\n    this.subscription.add(this.refreshOnChildClosedShallow().subscribe(() => { this.getLanguages(); }));\r\n    this.viewModel$ = combineLatest([this.languages$]).pipe(\r\n      map(([languages]) => ({ languages }))\r\n    );\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.languages$.complete();\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  closeDialog(): void {\r\n    this.dialogRef.close();\r\n  }\r\n\r\n  openPermissions(language: SiteLanguagePermissions): void {\r\n    this.router.navigate([GoToPermissions.getUrlLanguage(language.NameId)], { relativeTo: this.route });\r\n  }\r\n\r\n  private getLanguages(): void {\r\n    this.zoneService.getLanguagesPermissions().subscribe({\r\n      error: () => {\r\n        this.languages$.next(undefined);\r\n      },\r\n      next: (languages) => {\r\n        this.languages$.next(languages);\r\n      },\r\n    });\r\n  }\r\n\r\n  private buildGridOptions(): GridOptions {\r\n    const gridOptions: GridOptions = {\r\n      ...defaultGridOptions,\r\n      columnDefs: [\r\n        {\r\n          headerName: 'ID',\r\n          field: 'Id',\r\n          width: 70,\r\n          headerClass: 'dense',\r\n          cellClass: 'id-action no-padding no-outline'.split(' '),\r\n          sortable: true,\r\n          filter: 'agTextColumnFilter',\r\n          valueGetter: (params) => {\r\n            const language: SiteLanguagePermissions = params.data;\r\n            return language.Code;\r\n          },\r\n          cellRenderer: IdFieldComponent,\r\n          cellRendererParams: (() => {\r\n            const params: IdFieldParams<SiteLanguagePermissions> = {\r\n              tooltipGetter: (language) => `ID: ${language.Code}`,\r\n            };\r\n            return params;\r\n          })(),\r\n        },\r\n        {\r\n          field: 'Name',\r\n          flex: 2,\r\n          minWidth: 250,\r\n          cellClass: 'no-outline',\r\n          sortable: true,\r\n          sort: 'asc',\r\n          filter: 'agTextColumnFilter',\r\n          valueGetter: (params) => {\r\n            const language: SiteLanguagePermissions = params.data;\r\n            return language.Culture;\r\n          },\r\n        },\r\n        {\r\n          width: 42,\r\n          cellClass: 'secondary-action no-padding'.split(' '),\r\n          pinned: 'right',\r\n          cellRenderer: LanguagesPermissionsActionsComponent,\r\n          cellRendererParams: (() => {\r\n            const params: LanguagesPermissionsActionsParams = {\r\n              onOpenPermissions: (language) => this.openPermissions(language),\r\n            };\r\n            return params;\r\n          })(),\r\n        },\r\n      ],\r\n    };\r\n    return gridOptions;\r\n  }\r\n}\r\n\r\ninterface LanguagePermissionsViewModel {\r\n  languages: SiteLanguagePermissions[] | undefined\r\n}\r\n"],"x_google_ignoreList":[]}