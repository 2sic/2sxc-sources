{"version":3,"file":"projects_eav-ui_src_app_apps-management_create-inherited-app_create-inherited-app_component_ts.f58fe8a8780b86df.js","mappings":"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","names":["i0","app_r4","Id","Name","CreateInheritedAppComponent_ng_container_0_mat_option_14_Template","CreateInheritedAppComponent_ng_container_0_app_field_hint_15_Template","_r6","ctx_r5","closeDialog","ctx_r7","create","ctx_r0","form","undefined","vm_r1","inheritableApps","length","controls","inheritId","touched","errors","required","loading","valid","CreateInheritedAppComponent","constructor","dialogRef","appsListService","snackBar","this","hostClass","buildForm","loading$","BehaviorSubject","inheritableApps$","viewModel$","combineLatest","pipe","map","ngOnInit","fetchInheritedApps","ngOnDestroy","complete","close","disable","next","value","name","find","app","open","subscribe","error","enable","duration","getInheritable","UntypedFormGroup","UntypedFormControl","Validators","static","t","i1","i2","i3","_angular_core__WEBPACK_IMPORTED_MODULE_1__","Xpm","selectors","hostVars","hostBindings","rf","ctx","CreateInheritedAppComponent_ng_container_0_Template","FieldHintComponent_mat_hint_1_ng_container_1_Template","_r3","FieldHintComponent_mat_error_2_ng_container_1_Template","FieldHintComponent","isError","isShort","toggleIsShort","_angular_core__WEBPACK_IMPORTED_MODULE_0__","inputs","ngContentSelectors","_c1","decls","vars","consts","template","FieldHintComponent_mat_hint_1_Template","FieldHintComponent_mat_error_2_Template","FieldHintComponent_ng_template_3_Template","_c0"],"sourceRoot":"webpack:///","sources":["./projects/eav-ui/src/app/apps-management/create-inherited-app/create-inherited-app.component.html","./projects/eav-ui/src/app/apps-management/create-inherited-app/create-inherited-app.component.ts","./projects/eav-ui/src/app/shared/components/field-hint/field-hint.component.html","./projects/eav-ui/src/app/shared/components/field-hint/field-hint.component.ts"],"sourcesContent":["<ng-container *ngIf=\"viewModel$ | async as vm\">\r\n  <div class=\"eav-dialog\">\r\n    <div class=\"eav-dialog-header\">\r\n      <div class=\"eav-dialog-header__title\">Create inherited App</div>\r\n    </div>\r\n    <div class=\"eav-dialog-content\">\r\n      <router-outlet></router-outlet>\r\n      <p>\r\n        Create an App which inherits everything (data, views, queries) from a global App. Only Apps which were specifically\r\n        marked for this will be listed here, and these apps must already have been loaded into Cache. If you don't see the\r\n        App you expect, make sure that has happened.\r\n      </p>\r\n      <form [formGroup]=\"form\">\r\n        <mat-form-field color=\"accent\" class=\"eav-form-field\">\r\n          <mat-label>Inherit App</mat-label>\r\n          <mat-select formControlName=\"inheritId\"\r\n            [placeholder]=\"vm.inheritableApps === undefined ? 'Loading...' : vm.inheritableApps === null || vm.inheritableApps.length === 0 ? 'No inheritable apps found' : ''\">\r\n            <mat-option *ngFor=\"let app of vm.inheritableApps\" [value]=\"app.Id\">\r\n              {{ app.Name }}\r\n            </mat-option>\r\n          </mat-select>\r\n        </mat-form-field>\r\n        <app-field-hint *ngIf=\"form.controls.inheritId.touched && form.controls.inheritId.errors?.required\" [isError]=\"true\">\r\n          Required\r\n        </app-field-hint>\r\n      </form>\r\n    </div>\r\n    <mat-dialog-actions align=\"end\">\r\n      <button type=\"button\" mat-raised-button [disabled]=\"vm.loading\" (click)=\"closeDialog()\">\r\n        Cancel\r\n      </button>\r\n      <button type=\"button\" mat-raised-button color=\"accent\" [disabled]=\"vm.loading || !form.valid\" (click)=\"create()\">\r\n        Create\r\n      </button>\r\n    </mat-dialog-actions>\r\n  </div>\r\n</ng-container>","import { Component, HostBinding, OnDestroy, OnInit } from '@angular/core';\r\nimport { UntypedFormControl, UntypedFormGroup, Validators } from '@angular/forms';\r\nimport { MatDialogRef } from '@angular/material/dialog';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { BehaviorSubject, Observable, combineLatest, map } from 'rxjs';\r\nimport { App } from '../models/app.model';\r\nimport { AppsListService } from '../services/apps-list.service';\r\n\r\n@Component({\r\n  selector: 'app-create-inherited-app',\r\n  templateUrl: './create-inherited-app.component.html',\r\n  styleUrls: ['./create-inherited-app.component.scss'],\r\n})\r\nexport class CreateInheritedAppComponent implements OnInit, OnDestroy {\r\n  @HostBinding('className') hostClass = 'dialog-component';\r\n\r\n  form: UntypedFormGroup;\r\n  loading$: BehaviorSubject<boolean>;\r\n  inheritableApps$: BehaviorSubject<App[] | undefined | null>;\r\n\r\n  viewModel$: Observable<CreateInheritedAppViewModel>;\r\n\r\n  constructor(\r\n    private dialogRef: MatDialogRef<CreateInheritedAppComponent>,\r\n    private appsListService: AppsListService,\r\n    private snackBar: MatSnackBar,\r\n  ) {\r\n    this.form = this.buildForm();\r\n    this.loading$ = new BehaviorSubject(false);\r\n    this.inheritableApps$ = new BehaviorSubject<App[]>(undefined);\r\n    this.viewModel$ = combineLatest([this.loading$, this.inheritableApps$]).pipe(\r\n      map(([loading, inheritableApps]) => {\r\n        return { loading, inheritableApps };\r\n      }),\r\n    );\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.fetchInheritedApps();\r\n\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.loading$.complete();\r\n    this.inheritableApps$.complete();\r\n  }\r\n\r\n  closeDialog(): void {\r\n    this.dialogRef.close();\r\n  }\r\n\r\n  create(): void {\r\n    this.form.disable();\r\n    this.loading$.next(true);\r\n    const inheritId = this.form.controls.inheritId.value;\r\n    const name = this.inheritableApps$.value.find(app => app.Id === inheritId).Name;\r\n    this.snackBar.open('Creating inherited app...');\r\n    this.appsListService.create(name, inheritId).subscribe({\r\n      error: () => {\r\n        this.form.enable();\r\n        this.loading$.next(false);\r\n        this.snackBar.open('Failed to create inherited app. Please check console for more information', undefined, { duration: 3000 });\r\n      },\r\n      next: () => {\r\n        this.form.enable();\r\n        this.snackBar.open('Created inherited app', undefined, { duration: 2000 });\r\n        this.closeDialog();\r\n      },\r\n    });\r\n  }\r\n\r\n  private fetchInheritedApps(): void {\r\n    this.appsListService.getInheritable().subscribe({\r\n      error: () => {\r\n        this.inheritableApps$.next(null);\r\n      },\r\n      next: (inheritableApps) => {\r\n        this.inheritableApps$.next(inheritableApps);\r\n      },\r\n    });\r\n  }\r\n\r\n  private buildForm(): UntypedFormGroup {\r\n    const form = new UntypedFormGroup({\r\n      inheritId: new UntypedFormControl(null, [Validators.required]),\r\n    });\r\n    return form;\r\n  }\r\n}\r\n\r\ninterface CreateInheritedAppViewModel { \r\n  loading: boolean;\r\n  inheritableApps: App[] | undefined | null;\r\n}\r\n","<div class=\"hint-box\" (click)=\"toggleIsShort()\" [ngClass]=\"{ 'hint-box__short': isShort }\" [ngSwitch]=\"isError\">\r\n  <mat-hint *ngSwitchCase=\"false\">\r\n    <ng-container *ngTemplateOutlet=\"content\"></ng-container>\r\n  </mat-hint>\r\n\r\n  <mat-error *ngSwitchCase=\"true\">\r\n    <ng-container *ngTemplateOutlet=\"content\"></ng-container>\r\n  </mat-error>\r\n</div>\r\n\r\n<ng-template #content>\r\n  <ng-content></ng-content>\r\n</ng-template>\r\n","import { Component, Input } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-field-hint',\r\n  templateUrl: './field-hint.component.html',\r\n  styleUrls: ['./field-hint.component.scss'],\r\n})\r\nexport class FieldHintComponent {\r\n  @Input() isError = false;\r\n  isShort = true;\r\n\r\n  constructor() { }\r\n\r\n  toggleIsShort() {\r\n    this.isShort = !this.isShort;\r\n  }\r\n}\r\n"],"x_google_ignoreList":[]}