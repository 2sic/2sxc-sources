"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_metadata_metadata_component_ts","projects_eav-ui_src_app_shared_directives_click-stop-propagation_directive_ts","projects_eav-ui_src_app_app-administration_services_app-dialog-config_service_ts-_86580","projects_eav-ui_src_app_app-administration_services_app-dialog-config_service_ts-_86581"],{9731:(P,C,n)=>{n.d(C,{K:()=>g});var r=n(1650),h=n(9736),d=n(3738),x=n(3488),a=n(2611),c=n(9039),_=n(4860),v=n(6232),u=n(7648);let g=(()=>{class l{constructor(t,p,T,y,L){this.http=t,this.context=p,this.dnnContext=T,this.globalConfigService=y,this.dialogSettings$={},L.loadFromService(this)}getShared$(t){return t??=this.context.appId,this.dialogSettings$[t]||(this.dialogSettings$[t]=this.getDialogSettings(t).pipe((0,r.d)({refCount:!1}))),this.dialogSettings$[t]}getDialogSettings(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/dialog/settings"),{params:{appId:t??this.context.appId.toString()}}).pipe((0,h.U)(p=>(p.Context.Language.List=p.Context.Language.List.filter(T=>T.IsEnabled),p)),(0,d.b)(p=>{this.globalConfigService.allowDebug(p.Context.Enable.DebugMode)}))}static#t=this.\u0275fac=function(p){return new(p||l)(c.LFG(_.eN),c.LFG(a._),c.LFG(v._y),c.LFG(x.bE),c.LFG(u.k))};static#e=this.\u0275prov=c.Yz7({token:l,factory:l.\u0275fac})}return l})()},2369:(P,C,n)=>{n.d(C,{T:()=>c});var r=n(2611),h=n(3379),d=n(9039),x=n(4860),a=n(6232);let c=(()=>{class _{constructor(u,m,g){this.http=u,this.context=m,this.dnnContext=g}getContentInfo(u){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(h.v+"Get"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),scope:u}})}exportParts(u,m,g){const l=this.dnnContext.$2sxc.http.apiUrl(h.v+"Export")+"?appId="+this.context.appId.toString()+"&zoneId="+this.context.zoneId.toString()+"&contentTypeIdsString="+u.join(";")+"&entityIdsString="+m.join(";")+"&templateIdsString="+g.join(";");window.open(l,"_blank","")}static#t=this.\u0275fac=function(m){return new(m||_)(d.LFG(x.eN),d.LFG(r._),d.LFG(a._y))};static#e=this.\u0275prov=d.Yz7({token:_,factory:_.\u0275fac})}return _})()},2091:(P,C,n)=>{n.d(C,{v:()=>c});var r=n(4173),h=n(2611),d=n(9039),x=n(4860),a=n(6232);let c=(()=>{class _{constructor(u,m,g){this.http=u,this.context=m,this.dnnContext=g}getAppInfo(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(r.H+"Statistics"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}exportApp(u,m){const g=this.dnnContext.$2sxc.http.apiUrl(r.H+"Export")+"?appId="+this.context.appId+"&zoneId="+this.context.zoneId+"&includeContentGroups="+u+"&resetAppGuid="+m;window.open(g,"_blank","")}exportForVersionControl({includeContentGroups:u,resetAppGuid:m,withFiles:g}){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(r.H+"SaveData"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),includeContentGroups:u.toString(),resetAppGuid:m.toString(),withPortalFiles:g.toString()}})}static#t=this.\u0275fac=function(m){return new(m||_)(d.LFG(x.eN),d.LFG(h._),d.LFG(a._y))};static#e=this.\u0275prov=d.Yz7({token:_,factory:_.\u0275fac})}return _})()},3379:(P,C,n)=>{n.d(C,{v:()=>c,z:()=>_});var r=n(4173),h=n(2611),d=n(9039),x=n(4860),a=n(6232);const c="admin/appParts/";let _=(()=>{class v{constructor(m,g,l){this.http=m,this.context=g,this.dnnContext=l}importAppParts(m){const g=new FormData;return g.append("File",m),this.http.post(this.dnnContext.$2sxc.http.apiUrl(c+"Import"),g,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}resetApp(m){return this.http.post(this.dnnContext.$2sxc.http.apiUrl(r.H+"Reset"),{},{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),withPortalFiles:m.toString()}})}static#t=this.\u0275fac=function(g){return new(g||v)(d.LFG(x.eN),d.LFG(h._),d.LFG(a._y))};static#e=this.\u0275prov=d.Yz7({token:v,factory:v.\u0275fac})}return v})()},1217:(P,C,n)=>{n.d(C,{Az:()=>c.Az,Kw:()=>r.K,TB:()=>c.TB,bf:()=>c.bf,cv:()=>c.cv,h3:()=>_.h,nt:()=>c.nt,sF:()=>h.s,vG:()=>c.vG});var r=n(9731),h=n(5530),c=(n(2369),n(2091),n(3379),n(7749)),_=n(6992)},7749:(P,C,n)=>{n.d(C,{Az:()=>t,TB:()=>T,bf:()=>y,cv:()=>E,nt:()=>p,vG:()=>L});var r=n(6253),h=n(1891),d=n(9736),x=n(400),a=n(237),c=n(2611),_=n(9039),v=n(4860),u=n(6232);const E="admin/query/Run",t="admin/query/DebugStream",p="admin/query/Save",T="admin/query/Get",y="admin/query/DataSources";let L=(()=>{class R{constructor(O,U,M){this.http=O,this.context=U,this.dnnContext=M}getAll(O){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(x.PS),{params:{appId:this.context.appId.toString(),contentType:O}})}importQuery(O){return(0,r.D)((0,a.s)(O)).pipe((0,h.w)(U=>this.http.post(this.dnnContext.$2sxc.http.apiUrl("admin/query/import"),{AppId:this.context.appId.toString(),ContentBase64:U})),(0,d.U)(U=>({Success:U,Messages:[]})))}clonePipeline(O){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/query/Clone"),{params:{Id:O.toString(),appId:this.context.appId.toString()}})}delete(O){return this.http.delete(this.dnnContext.$2sxc.http.apiUrl("admin/query/Delete"),{params:{appId:this.context.appId.toString(),Id:O.toString()}})}static#t=this.\u0275fac=function(U){return new(U||R)(_.LFG(v.eN),_.LFG(c._),_.LFG(u._y))};static#e=this.\u0275prov=_.Yz7({token:R,factory:R.\u0275fac})}return R})()},6992:(P,C,n)=>{n.d(C,{h:()=>g});var r=n(2611),h=n(9039),d=n(4860),x=n(6232);const a="admin/view/",c=a+"all",_=a+"delete",v=a+"import",u=a+"polymorphism",m=a+"usage";let g=(()=>{class l{constructor(t,p,T){this.http=t,this.context=p,this.dnnContext=T}getAll(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(c),{params:{appId:this.context.appId.toString()}})}delete(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(_),{params:{appId:this.context.appId.toString(),Id:t.toString()}})}import(t){const p=new FormData;return p.append("File",t),this.http.post(this.dnnContext.$2sxc.http.apiUrl(v),p,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}export(t){const p=this.dnnContext.$2sxc.http.apiUrl(a+"json")+"?appId="+this.context.appId+"&viewId="+t;window.open(p,"_blank","")}getPolymorphism(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(u),{params:{appId:this.context.appId.toString()}})}getUsage(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(m),{params:{appId:this.context.appId.toString(),guid:t}})}static#t=this.\u0275fac=function(p){return new(p||l)(h.LFG(d.eN),h.LFG(r._),h.LFG(x._y))};static#e=this.\u0275prov=h.Yz7({token:l,factory:l.\u0275fac})}return l})()},7100:(P,C,n)=>{n.d(C,{l:()=>g});var r=n(6253),h=n(1891),d=n(9736),x=n(5807),a=n(400),c=n(237),_=n(2611),v=n(9039),u=n(4860),m=n(6232);let g=(()=>{class l{constructor(t,p,T){this.http=t,this.context=p,this.dnnContext=T}getAll(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(a.PS),{params:{appId:this.context.appId.toString(),contentType:t}})}getColumns(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(x.jt),{params:{appId:this.context.appId.toString(),staticName:t}})}importItem(t){return(0,r.D)((0,c.s)(t)).pipe((0,h.w)(p=>this.http.post(this.dnnContext.$2sxc.http.apiUrl(a.Uo+"upload"),{AppId:this.context.appId.toString(),ContentBase64:p})),(0,d.U)(p=>({Success:p,Messages:[]})))}static#t=this.\u0275fac=function(p){return new(p||l)(v.LFG(u.eN),v.LFG(_._),v.LFG(m._y))};static#e=this.\u0275prov=v.Yz7({token:l,factory:l.\u0275fac})}return l})()},8737:(P,C,n)=>{n.d(C,{f:()=>a});var r=n(9039),h=n(4860),d=n(6232);let a=(()=>{class c{constructor(v,u){this.http=v,this.dnnContext=u}getFeatureDetails(v){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/feature/details"),{params:{nameId:v}})}static#t=this.\u0275fac=function(u){return new(u||c)(r.LFG(h.eN),r.LFG(d._y))};static#e=this.\u0275prov=r.Yz7({token:c,factory:c.\u0275fac})}return c})()},8968:(P,C,n)=>{n.d(C,{B:()=>U});var r=n(6861),h=n(3839),d=n(9736),x=n(4472),a=n(9039),c=n(9409),_=n(8737),v=n(6575),u=n(895),m=n(6515),g=n(8497),l=n(9498),E=n(6537),t=n(1916);function p(M,B){if(1&M){const f=a.EpF();a.TgZ(0,"div",2)(1,"div",3),a._uU(2,"ID:"),a.qZA(),a.TgZ(3,"div",9)(4,"span",10),a.NdJ("click",function(){const Z=a.CHM(f).ngIf,b=a.oxw(2);return a.KtG(b.copyToClipboard(Z))}),a._uU(5),a.qZA()()()}if(2&M){const f=B.ngIf;a.xp6(4),a.Q6J("tippy",f),a.xp6(1),a.Oqu(f)}}function T(M,B){if(1&M){const f=a.EpF();a.TgZ(0,"button",11),a.NdJ("click",function(){const Z=a.CHM(f).ngIf,b=a.oxw(2);return a.KtG(b.findOutMore(Z))}),a.TgZ(1,"mat-icon"),a._uU(2,"open_in_new"),a.qZA(),a._uU(3),a.ALo(4,"translate"),a.qZA()}2&M&&(a.xp6(3),a.hij(" ",a.lcZ(4,1,"Features.FindOutMore")," "))}function y(M,B){if(1&M){const f=a.EpF();a.TgZ(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),a._uU(3),a.qZA()(),a.TgZ(4,"mat-card-content"),a._UZ(5,"p",1),a.ALo(6,"safeHtml"),a.TgZ(7,"div",2)(8,"div",3),a._uU(9),a.ALo(10,"translate"),a.qZA(),a.TgZ(11,"div",4)(12,"span"),a._uU(13),a.ALo(14,"translate"),a.qZA()()(),a.YNc(15,p,6,2,"div",5),a.qZA(),a.TgZ(16,"mat-card-actions",6),a.YNc(17,T,5,3,"button",7),a.TgZ(18,"button",8),a.NdJ("click",function(){a.CHM(f);const F=a.oxw();return a.KtG(F.closeDialog())}),a._uU(19),a.ALo(20,"translate"),a.qZA()()()}if(2&M){const f=B.ngIf;a.xp6(3),a.Oqu(f.feature.Name),a.xp6(2),a.Q6J("innerHtml",a.lcZ(6,7,f.feature.Description),a.oJD),a.xp6(4),a.hij("",a.lcZ(10,9,"Features.Status"),":"),a.xp6(4),a.Oqu(a.lcZ(14,11,f.feature.IsEnabled?"Features.Active":"Features.NotActive")),a.xp6(2),a.Q6J("ngIf",f.feature.NameId),a.xp6(2),a.Q6J("ngIf",f.feature.Link),a.xp6(2),a.hij(" ",a.lcZ(20,13,"Features.Close")," ")}}let L=(()=>{class M{constructor(f,I,F,Z){this.dialogData=f,this.dialogRef=I,this.snackBar=F,this.featureDetailService=Z}ngOnInit(){this.viewModel$=(0,h.a)([this.featureDetailService.getFeatureDetails(this.dialogData)]).pipe((0,d.U)(([f])=>({feature:f})))}copyToClipboard(f){(0,x.v)(f),this.snackBar.open("Copied to clipboard",null,{duration:2e3})}findOutMore(f){window.open(f,"_blank")}closeDialog(){this.dialogRef.close()}static#t=this.\u0275fac=function(I){return new(I||M)(a.Y36(r.WI),a.Y36(r.so),a.Y36(c.ux),a.Y36(_.f))};static#e=this.\u0275cmp=a.Xpm({type:M,selectors:[["app-feature-info-dialog"]],decls:2,vars:3,consts:[[4,"ngIf"],[3,"innerHtml"],[1,"eav-info-row"],[1,"eav-info-row__label"],[1,"eav-info-row__value"],["class","eav-info-row",4,"ngIf"],["align","end"],["mat-raised-button","","color","accent","class","eav-card-action-button",3,"click",4,"ngIf"],["mat-raised-button","",1,"eav-card-action-button",3,"click"],[1,"eav-info-row__value","eav_click"],[3,"tippy","click"],["mat-raised-button","","color","accent",1,"eav-card-action-button",3,"click"]],template:function(I,F){1&I&&(a.YNc(0,y,21,15,"mat-card",0),a.ALo(1,"async")),2&I&&a.Q6J("ngIf",a.lcZ(1,1,F.viewModel$))},dependencies:[v.O5,u.lW,m.Hw,g.a8,g.hq,g.dn,g.dk,g.n5,l.$,v.Ov,E.z,t.X$]})}return M})();var R=n(8071),K=n(1891),O=n(7648);let U=(()=>{class M{set featureNameId(f){this.featureNameId$.next(f)}set showIf(f){this.showIf$.next(1==f)}constructor(f,I,F,Z){this.dialog=f,this.viewContainerRef=I,this.changeDetectorRef=F,this.featuresService=Z,this.featureNameId$=new R.X(null),this.showIf$=new R.X(!1),this.feature$=this.featureNameId$.pipe((0,K.w)(b=>this.featuresService.get$(b))),this.show$=(0,h.a)([this.feature$,this.showIf$]).pipe((0,d.U)(([b,$])=>$==(b?.IsEnabled??!1)))}openDialog(){M.openDialog(this.dialog,this.featureNameId$.value,this.viewContainerRef,this.changeDetectorRef)}static openDialog(f,I,F,Z){f.open(L,{autoFocus:!1,data:I,viewContainerRef:F,width:"400px"}),Z.markForCheck()}static#t=this.\u0275fac=function(I){return new(I||M)(a.Y36(r.uw),a.Y36(a.s_b),a.Y36(a.sBO),a.Y36(O.k))};static#e=this.\u0275dir=a.lG2({type:M,inputs:{featureNameId:"featureNameId",showIf:"showIf"}})}return M})()},4173:(P,C,n)=>{n.d(C,{H:()=>v,a:()=>u});var r=n(1891),h=n(4980),d=n(7503),x=n(2611),a=n(9039),c=n(4860),_=n(6232);const v="admin/app/";let u=(()=>{class m{constructor(l,E,t){this.http=l,this.context=E,this.dnnContext=t}importApp(l,E,t=!1){const p=new FormData;return p.append("File",l),p.append("Name",E??""),this.http.post(this.dnnContext.$2sxc.http.apiUrl(v+"Import"),p,{params:{zoneId:this.context.zoneId.toString()}}).pipe((0,r.w)(T=>{if(t&&T.Messages[0]?.MessageType===d.DS.Warning){const y=prompt(T.Messages[0].Text+" Would you like to install it using another folder name?");if(y)return this.importApp(l,y,!0)}return(0,h.of)(T)}))}static#t=this.\u0275fac=function(E){return new(E||m)(a.LFG(c.eN),a.LFG(x._),a.LFG(_._y))};static#e=this.\u0275prov=a.Yz7({token:m,factory:m.\u0275fac})}return m})()},2023:(P,C,n)=>{n.r(C),n.d(C,{MetadataComponent:()=>It});var r=n(8071),h=n(3839),d=n(9736),x=n(3738),a=n(7100),c=n(1092),_=n(8088),v=n(6041),u=n(5253),m=n(6433),g=n(196),l=n(2957),E=n(6861),t=n(9039),p=n(6575),T=n(895),y=n(8497),L=n(6537);function R(i,D){if(1&i&&(t._UZ(0,"mat-card-subtitle",3),t.ALo(1,"safeHtml")),2&i){const e=t.oxw();t.Q6J("innerHtml",t.lcZ(1,1,e.dialogData.message),t.oJD)}}let K=(()=>{class i{constructor(e,o){this.dialogData=e,this.dialogRef=o,this.hostClass="dialog-component"}closeDialog(e){this.dialogRef.close(e)}static#t=this.\u0275fac=function(o){return new(o||i)(t.Y36(E.WI),t.Y36(E.so))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-confirm-delete-dialog"]],hostVars:1,hostBindings:function(o,s){2&o&&t.Ikx("className",s.hostClass)},decls:10,vars:3,consts:[[3,"innerHtml",4,"ngIf"],["align","end"],["mat-raised-button","",1,"eav-card-action-button",3,"click"],[3,"innerHtml"]],template:function(o,s){1&o&&(t.TgZ(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),t._uU(3),t.qZA(),t.YNc(4,R,2,3,"mat-card-subtitle",0),t.qZA(),t.TgZ(5,"mat-card-actions",1)(6,"button",2),t.NdJ("click",function(){return s.closeDialog()}),t._uU(7,"Cancel"),t.qZA(),t.TgZ(8,"button",2),t.NdJ("click",function(){return s.closeDialog(!0)}),t._uU(9,"Delete"),t.qZA()()()),2&o&&(t.xp6(3),t.AsE("Delete ",s.dialogData.entityTitle," (",s.dialogData.entityId,")?"),t.xp6(1),t.Q6J("ngIf",s.dialogData.message))},dependencies:[p.O5,T.lW,y.a8,y.hq,y.dk,y.$j,y.n5,L.z],styles:[".eav-card-action-button[_ngcontent-%COMP%]{margin-left:8px}"]})}return i})();var O=n(9498),U=n(6515),M=n(257);let B=(()=>{class i{agInit(e){this.params=e}refresh(e){return!0}deleteMetadata(){this.params.onDelete(this.params.data)}static#t=this.\u0275fac=function(o){return new(o||i)};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-metadata-actions"]],decls:4,vars:0,consts:[[1,"actions-component"],["matRipple","","tippy","Delete",1,"eav-grid-action-button","highlight",3,"click"]],template:function(o,s){1&o&&(t.TgZ(0,"div",0)(1,"div",1),t.NdJ("click",function(){return s.deleteMetadata()}),t.TgZ(2,"mat-icon"),t._uU(3,"delete"),t.qZA()()())},dependencies:[O.$,U.Hw,M.wG]})}return i})(),f=(()=>{class i{agInit(e){this.value=e.value,this.metadata=e.data}refresh(e){return!0}static#t=this.\u0275fac=function(o){return new(o||i)};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-metadata-content-type"]],decls:2,vars:3,consts:[[1,"container",3,"tippy","tippyDisabled"]],template:function(o,s){1&o&&(t.TgZ(0,"div",0),t._uU(1),t.qZA()),2&o&&(t.Q6J("tippy",s.metadata._Type.Description)("tippyDisabled",!s.metadata._Type.Description),t.xp6(1),t.hij(" ",s.value,"\n"))},dependencies:[O.$],styles:[".container[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content}"]})}return i})();var I=n(8849),F=n(5043),Z=n(3317),b=n(1217),$=n(8834),Q=n(9851),Y=n(131),N=n(1268),H=n(6355),j=n(9674),z=n(9293);function k(i,D){if(1&i&&(t.TgZ(0,"mat-option",16),t._uU(1),t.qZA()),2&i){const e=D.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",e.name," ")}}function V(i,D){if(1&i&&(t.ynx(0),t.TgZ(1,"mat-form-field",3)(2,"mat-label"),t._uU(3,"Scope"),t.qZA(),t.TgZ(4,"mat-select",14),t.YNc(5,k,2,2,"mat-option",15),t.TgZ(6,"mat-option",16),t._uU(7,"Other..."),t.qZA()()(),t.TgZ(8,"app-field-hint"),t._uU(9," The scope should almost never be changed - "),t.TgZ(10,"a",17),t._uU(11,"see help"),t.qZA()(),t.BQk()),2&i){const e=t.oxw().ngIf,o=t.oxw();t.xp6(4),t.Q6J("placeholder",e.scopeOptions.length?"":"No items found"),t.xp6(1),t.Q6J("ngForOf",e.scopeOptions),t.xp6(1),t.Q6J("value",o.dropdownInsertValue)}}function X(i,D){if(1&i&&(t.TgZ(0,"mat-option",16),t._uU(1),t.qZA()),2&i){const e=D.$implicit;t.Q6J("value",e.StaticName),t.xp6(1),t.hij(" ",e.Label," ")}}function q(i,D){if(1&i&&(t.TgZ(0,"mat-select",18),t.YNc(1,X,2,2,"mat-option",15),t.qZA()),2&i){const e=t.oxw().ngIf;t.Q6J("placeholder",e.contentTypes.length?"":"No items found"),t.xp6(1),t.Q6J("ngForOf",e.contentTypes)}}function tt(i,D){1&i&&t._UZ(0,"input",19)}function et(i,D){1&i&&(t.TgZ(0,"app-field-hint",20),t._uU(1," This field is required "),t.qZA()),2&i&&t.Q6J("isError",!0)}const w=i=>({active:i});function nt(i,D){if(1&i){const e=t.EpF();t.TgZ(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),t._uU(3,"Create Metadata"),t.qZA(),t.TgZ(4,"mat-card-subtitle"),t._uU(5," This is a special operation to add an item which is metadata for another item, see "),t.TgZ(6,"a",1),t._uU(7,"docs"),t.qZA(),t._uU(8,". "),t.qZA()(),t.TgZ(9,"mat-card-content")(10,"form",2),t.YNc(11,V,12,3,"ng-container",0),t.TgZ(12,"mat-form-field",3)(13,"mat-label"),t._uU(14,"Content Type"),t.qZA(),t.YNc(15,q,2,2,"mat-select",4)(16,tt,1,0,"input",5),t.TgZ(17,"div",6)(18,"button",7),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.toggleGuidedContentType(!0))}),t.TgZ(19,"mat-icon"),t._uU(20,"search"),t.qZA()(),t.TgZ(21,"button",8),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.toggleGuidedContentType(!1))}),t.TgZ(22,"mat-icon"),t._uU(23,"text_fields"),t.qZA()()()(),t.YNc(24,et,2,1,"app-field-hint",9),t.qZA()(),t.TgZ(25,"mat-card-actions",10)(26,"mat-slide-toggle",11),t.NdJ("change",function(s){t.CHM(e);const A=t.oxw();return t.KtG(A.toggleAdvancedMode(s))}),t._uU(27),t.qZA(),t.TgZ(28,"div")(29,"button",12),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.closeDialog())}),t._uU(30,"Cancel"),t.qZA(),t.TgZ(31,"button",13),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.confirm())}),t._uU(32," Confirm "),t.qZA()()()()}if(2&i){const e=t.oxw();t.xp6(10),t.Q6J("formGroup",e.form),t.xp6(1),t.Q6J("ngIf",e.advancedMode&&e.guidedContentType),t.xp6(4),t.Q6J("ngIf",e.guidedContentType),t.xp6(1),t.Q6J("ngIf",!e.guidedContentType),t.xp6(2),t.Q6J("ngClass",t.VKq(10,w,e.guidedContentType)),t.xp6(3),t.Q6J("ngClass",t.VKq(12,w,!e.guidedContentType)),t.xp6(3),t.Q6J("ngIf",e.form.controls.contentType.touched&&(null==e.form.controls.contentType.errors?null:e.form.controls.contentType.errors.required)),t.xp6(2),t.Q6J("checked",e.advancedMode),t.xp6(1),t.hij(" ",e.advancedMode?"Advanced":"Simple"," "),t.xp6(4),t.Q6J("disabled",!e.form.valid)}}let at=(()=>{class i{constructor(e,o){this.dialogRef=e,this.contentTypesService=o,this.hostClass="dialog-component",this.dropdownInsertValue=$.G,this.guidedContentType=!0,this.advancedMode=!1}ngOnInit(){this.contentTypes$=new r.X([]),this.scopeOptions$=new r.X([]),this.buildForm(),this.fetchScopes(),this.viewModel$=(0,h.a)([this.contentTypes$,this.scopeOptions$]).pipe((0,d.U)(([e,o])=>({contentTypes:e,scopeOptions:o})))}ngOnDestroy(){this.contentTypes$.complete(),this.scopeOptions$.complete()}closeDialog(e){this.dialogRef.close(e)}toggleGuidedContentType(e){this.guidedContentType=e}toggleAdvancedMode(e){this.advancedMode=e.checked}confirm(){const e=this.form.getRawValue();this.closeDialog(e.contentType)}buildForm(){this.form=new I.nJ({}),this.form.addControl("contentType",new I.p4(null,[I.kI.required])),this.form.addControl("scope",new I.p4(g.Zy.scopes.default.value)),this.form.controls.scope.valueChanges.pipe((0,F.O)(this.form.controls.scope.value),(0,Z.x)()).subscribe(e=>{null!=this.form.controls.contentType.value&&this.form.controls.contentType.patchValue(null),e===$.G?(e=prompt("This is an advanced feature to show content-types of another scope. Don't use this if you don't know what you're doing, as content-types of other scopes are usually hidden for a good reason.")||g.Zy.scopes.default.value,this.scopeOptions$.value.some(o=>o.value===e)||this.scopeOptions$.next([{name:e,value:e},...this.scopeOptions$.value]),this.form.controls.scope.patchValue(e)):this.fetchContentTypes(e)})}fetchContentTypes(e){this.contentTypesService.retrieveContentTypes(e).subscribe(o=>{this.contentTypes$.next(o)})}fetchScopes(){this.contentTypesService.getScopes().subscribe(e=>{this.scopeOptions$.next(e)})}static#t=this.\u0275fac=function(o){return new(o||i)(t.Y36(E.so),t.Y36(b.sF))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-metadata-save-dialog"]],hostVars:1,hostBindings:function(o,s){2&o&&t.Ikx("className",s.hostClass)},decls:2,vars:3,consts:[[4,"ngIf"],["href","https://go.2sxc.org/metadata","target","_blank"],[3,"formGroup"],["color","accent",1,"eav-form-field"],["formControlName","contentType","required","",3,"placeholder",4,"ngIf"],["matInput","","type","text","formControlName","contentType","required","",4,"ngIf"],["matTextSuffix",""],["mat-icon-button","","type","button","tippy","Pick existing value",3,"ngClass","click"],["mat-icon-button","","type","button","tippy","Manual entry",3,"ngClass","click"],[3,"isError",4,"ngIf"],[1,"eav-card-actions"],["color","accent",3,"checked","change"],["mat-raised-button","",1,"eav-card-action-button",3,"click"],["mat-raised-button","","color","accent",1,"eav-card-action-button",3,"disabled","click"],["formControlName","scope",3,"placeholder"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["href","https://2sxc.org/help?tag=scope","target","_blank","appClickStopPropagation",""],["formControlName","contentType","required","",3,"placeholder"],["matInput","","type","text","formControlName","contentType","required",""],[3,"isError"]],template:function(o,s){1&o&&(t.YNc(0,nt,33,14,"mat-card",0),t.ALo(1,"async")),2&o&&t.Q6J("ngIf",t.lcZ(1,1,s.viewModel$))},dependencies:[p.mk,p.sg,p.O5,Q.Y,Y.E,O.$,T.lW,T.RK,U.Hw,I._Y,I.Fj,I.JJ,I.JL,I.Q7,I.sg,I.u,N.KE,N.hX,N.R9,H.gD,M.ey,j.Nt,z.Rr,y.a8,y.hq,y.dn,y.dk,y.$j,y.n5,p.Ov],styles:[".eav-card-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.eav-card-action-button[_ngcontent-%COMP%]{margin-left:8px}"]})}return i})();var ot=n(8968),W=n(91),it=n(9409),st=n(8621),G=n(77),rt=n(5392);function ct(i,D){1&i&&(t.ynx(0),t._uU(1,"This item is not metadata for anything else."),t.BQk())}function lt(i,D){if(1&i&&(t.ynx(0),t._UZ(1,"br"),t._uU(2),t.BQk()),2&i){const e=t.oxw(2).ngIf;t.xp6(2),t.hij("Number: ",e.itemFor.Number,"")}}function pt(i,D){if(1&i&&(t.ynx(0),t._UZ(1,"br"),t._uU(2),t.BQk()),2&i){const e=t.oxw(2).ngIf;t.xp6(2),t.hij("Guid: ",e.itemFor.Guid,"")}}function dt(i,D){if(1&i&&(t.ynx(0),t._UZ(1,"br"),t._uU(2),t.BQk()),2&i){const e=t.oxw(2).ngIf;t.xp6(2),t.hij("String: ",e.itemFor.String,"")}}function _t(i,D){if(1&i&&(t.ynx(0),t._UZ(1,"br"),t._uU(2),t.BQk()),2&i){const e=t.oxw(2).ngIf;t.xp6(2),t.hij("Title: ",e.itemFor.String,"")}}function mt(i,D){if(1&i&&(t.ynx(0),t._uU(1," This item is metadata for: "),t._UZ(2,"br"),t._uU(3),t._UZ(4,"br"),t._uU(5),t.YNc(6,lt,3,1,"ng-container",0)(7,pt,3,1,"ng-container",0)(8,dt,3,1,"ng-container",0)(9,_t,3,1,"ng-container",0),t.BQk()),2&i){const e=t.oxw().ngIf;t.xp6(3),t.hij("Target: ",e.itemFor.Target," "),t.xp6(2),t.hij("TargetType: ",e.itemFor.TargetType," "),t.xp6(1),t.Q6J("ngIf",e.itemFor.Number),t.xp6(1),t.Q6J("ngIf",e.itemFor.Guid),t.xp6(1),t.Q6J("ngIf",e.itemFor.String),t.xp6(1),t.Q6J("ngIf",e.itemFor.Title)}}function ht(i,D){if(1&i){const e=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(2);return t.KtG(s.createMetadata())}),t.TgZ(1,"mat-icon"),t._uU(2,"add"),t.qZA()()}}function gt(i,D){1&i&&t._UZ(0,"div")}function ut(i,D){if(1&i&&(t._UZ(0,"div",23),t.ALo(1,"safeHtml")),2&i){const e=t.oxw().$implicit;t.Q6J("innerHTML",t.lcZ(1,2,e.Icon),t.oJD)("matBadgeHidden",e.Enabled)}}function ft(i,D){1&i&&(t.TgZ(0,"mat-icon"),t._uU(1,"add"),t.qZA())}function vt(i,D){if(1&i){const e=t.EpF();t.TgZ(0,"button",19),t.NdJ("click",function(){const A=t.CHM(e).$implicit,S=t.oxw(3);return t.KtG(S.createMetadata(A))}),t.YNc(1,gt,1,0,"div",20)(2,ut,2,4,"ng-template",null,21,t.W1O)(4,ft,2,0,"ng-template",null,22,t.W1O),t.qZA()}if(2&i){const e=D.$implicit,o=t.MAs(3),s=t.MAs(5);t.uIk("label",e.Title),t.xp6(1),t.Q6J("ngIf",e.Icon)("ngIfThen",o)("ngIfElse",s)}}const Ct=i=>({"fab-opened":i});function xt(i,D){if(1&i){const e=t.EpF();t.TgZ(0,"eco-fab-speed-dial",12),t.NdJ("openChange",function(s){t.CHM(e);const A=t.oxw(2);return t.KtG(A.openChange(s))}),t.TgZ(1,"eco-fab-speed-dial-trigger",13)(2,"button",14)(3,"mat-icon",15),t._uU(4),t.qZA()()(),t.TgZ(5,"eco-fab-speed-dial-actions",16)(6,"button",17),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(2);return t.KtG(s.createMetadata())}),t.TgZ(7,"mat-icon"),t._uU(8,"search"),t.qZA()(),t.YNc(9,vt,6,4,"button",18),t.qZA()()}if(2&i){const e=t.oxw().ngIf;t.Q6J("ngClass",t.VKq(4,Ct,e.fabOpen)),t.xp6(1),t.Q6J("spin",!0),t.xp6(3),t.Oqu(e.fabOpen?"close":"add"),t.xp6(5),t.Q6J("ngForOf",e.recommendations)}}function Tt(i,D){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",1)(2,"div",2)(3,"div",3),t._uU(4),t.qZA(),t.TgZ(5,"button",4),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.closeDialog())}),t.TgZ(6,"mat-icon"),t._uU(7,"close"),t.qZA()()(),t.TgZ(8,"div",5)(9,"p"),t.YNc(10,ct,2,0,"ng-container",0)(11,mt,10,6,"ng-container",0),t.qZA(),t._UZ(12,"router-outlet"),t.TgZ(13,"div",6),t._UZ(14,"ag-grid-angular",7),t.qZA()(),t.TgZ(15,"mat-dialog-actions",8),t.YNc(16,ht,3,0,"button",9)(17,xt,10,6,"eco-fab-speed-dial",10),t.qZA()(),t.BQk()}if(2&i){const e=D.ngIf,o=t.oxw();t.xp6(4),t.hij(" ",o.title||"Metadata"," "),t.xp6(6),t.Q6J("ngIf",!e.itemFor),t.xp6(1),t.Q6J("ngIf",e.itemFor),t.xp6(3),t.Q6J("rowData",e.metadata)("gridOptions",o.gridOptions),t.xp6(2),t.Q6J("ngIf",0===e.recommendations.length),t.xp6(1),t.Q6J("ngIf",e.recommendations.length>0)}}let It=(()=>{class i extends v.H{constructor(e,o,s,A,S,J,Mt,Dt,Et,yt){super(e,o),this.router=e,this.route=o,this.dialogRef=s,this.metadataService=A,this.snackBar=S,this.entitiesService=J,this.contentItemsService=Mt,this.dialog=Dt,this.viewContainerRef=Et,this.changeDetectorRef=yt,this.gridOptions=this.buildGridOptions(),this.metadata$=new r.X([]),this.recommendations$=new r.X([]),this.itemFor$=new r.X(void 0),this.fabOpen$=new r.X(!1),this.targetType=parseInt(this.route.snapshot.paramMap.get("targetType"),10),this.keyType=this.route.snapshot.paramMap.get("keyType"),this.key=this.route.snapshot.paramMap.get("key"),this.title=decodeURIComponent(this.route.snapshot.paramMap.get("title")??""),this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName")}ngOnInit(){this.fetchFor(),this.fetchMetadata(),this.subscription.add(this.refreshOnChildClosedShallow().subscribe(()=>{this.fetchMetadata()}));const e=(0,h.a)([this.metadata$,this.recommendations$]).pipe((0,d.U)(([o,s])=>s.filter(A=>o.filter(S=>S._Type.Id===A.Id).length<A.Count)));this.viewModel$=(0,h.a)([this.metadata$,e,this.itemFor$,this.fabOpen$]).pipe((0,d.U)(([o,s,A,S])=>({metadata:o,recommendations:s,itemFor:A,fabOpen:S})))}ngOnDestroy(){this.metadata$.complete(),this.recommendations$.complete(),this.itemFor$.complete(),this.fabOpen$.complete(),super.ngOnDestroy()}closeDialog(){this.dialogRef.close()}openChange(e){this.fabOpen$.next(e)}createMetadata(e){if(e)return e.Enabled?void(e.CreateEmpty?(this.snackBar.open(`Creating ${e.Name}...`),this.entitiesService.create(e.Id,{For:this.calculateItemFor()}).subscribe({error:()=>{this.snackBar.open(`Creating ${e.Name} failed. Please check console for more info`,void 0,{duration:3e3}),this.fetchMetadata()},next:()=>{this.snackBar.open(`Created ${e.Name}`,void 0,{duration:3e3}),this.fetchMetadata()}})):this.createMetadataForm(e.Id)):void ot.B.openDialog(this.dialog,e.MissingFeature,this.viewContainerRef,this.changeDetectorRef);this.dialog.open(at,{autoFocus:!1,viewContainerRef:this.viewContainerRef,width:"650px"}).afterClosed().subscribe(s=>{null!=s&&this.createMetadataForm(s)})}createMetadataForm(e){const o={items:[{ContentTypeName:e,For:this.calculateItemFor()}]},s=(0,l.f)(o);this.router.navigate([`edit/${s}`],{relativeTo:this.route}),this.changeDetectorRef.markForCheck()}calculateItemFor(){return{Target:Object.values(g.Zy.metadata).find(o=>o.targetType===this.targetType)?.target??this.targetType.toString(),TargetType:this.targetType,...this.keyType===g.Zy.keyTypes.guid&&{Guid:this.key},...this.keyType===g.Zy.keyTypes.number&&{Number:parseInt(this.key,10)},...this.keyType===g.Zy.keyTypes.string&&{String:this.key}}}fetchFor(){this.contentTypeStaticName&&this.contentItemsService.getAll(this.contentTypeStaticName).subscribe(e=>{const o=e.find(s=>s.Guid===this.key);o?.For&&this.itemFor$.next(o.For)})}fetchMetadata(){this.metadataService.getMetadata(this.targetType,this.keyType,this.key).pipe((0,d.U)(e=>(e.Recommendations.forEach(o=>{o.Icon?.startsWith("base64:")&&(o.Icon=o.Icon.replace("base64:",""),o.Icon=window.atob(o.Icon),o.Icon=o.Icon.replace('fill="#000000"','fill="#ffffff"'))}),e)),(0,x.b)(e=>{this.metadata$.next(e.Items),this.recommendations$.next(e.Recommendations)})).subscribe()}editMetadata(e){const s=(0,l.f)({items:[{EntityId:e.Id}]});this.router.navigate([`edit/${s}`],{relativeTo:this.route})}deleteMetadata(e,o=!1){if(o)this.snackBar.open("Deleting..."),this.entitiesService.delete(e._Type.Id,e.Id,!1).subscribe({next:()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchMetadata()},error:()=>{this.snackBar.open("Delete failed. Please check console for more information",null,{duration:3e3})}});else{const s={entityId:e.Id,entityTitle:e.Title,message:this.recommendations$.value.find(S=>S.Id===e._Type.Id)?.DeleteWarning};this.dialog.open(K,{autoFocus:!1,data:s,viewContainerRef:this.viewContainerRef,width:"400px"}).afterClosed().subscribe(S=>{S&&this.deleteMetadata(e,!0)})}}buildGridOptions(){return{...m.f,columnDefs:[{headerName:"ID",field:"Id",width:70,headerClass:"dense",cellClass:"id-action no-padding no-outline".split(" "),sortable:!0,filter:"agNumberColumnFilter",valueGetter:o=>o.data.Id,cellRenderer:u.m,cellRendererParams:{tooltipGetter:s=>`ID: ${s.Id}\nGUID: ${s.Guid}`}},{field:"Title",flex:2,minWidth:250,cellClass:"primary-action highlight".split(" "),sortable:!0,sort:"asc",filter:"agTextColumnFilter",valueGetter:o=>o.data.Title,onCellClicked:o=>{this.editMetadata(o.data)}},{headerName:"Content Type",field:"ContentType",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:o=>{const s=o.data;return`${s._Type.Name}${s._Type.Title!==s._Type.Name?` (${s._Type.Title})`:""}`},cellRenderer:f},{width:42,cellClass:"secondary-action no-padding".split(" "),pinned:"right",cellRenderer:B,cellRendererParams:(()=>({onDelete:s=>this.deleteMetadata(s)}))()}]}}static#t=this.\u0275fac=function(o){return new(o||i)(t.Y36(W.F0),t.Y36(W.gz),t.Y36(E.so),t.Y36(_.Do),t.Y36(it.ux),t.Y36(c.g),t.Y36(a.l),t.Y36(E.uw),t.Y36(t.s_b),t.Y36(t.sBO))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-metadata"]],features:[t.qOj],decls:2,vars:3,consts:[[4,"ngIf"],[1,"eav-dialog","nav-component-wrapper"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"eav-dialog-content","nav-component-wrapper"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","gridOptions"],["align","end"],["mat-fab","","mat-elevation-z24","","class","grid-fab","tippy","Create a new metadata for this item",3,"click",4,"ngIf"],["class","eav-eco-fab-speed-dial",3,"ngClass","openChange",4,"ngIf"],["mat-fab","","mat-elevation-z24","","tippy","Create a new metadata for this item",1,"grid-fab",3,"click"],[1,"eav-eco-fab-speed-dial",3,"ngClass","openChange"],[3,"spin"],["mat-fab",""],[1,"spin180"],[1,"eav-eco-fab-speed-dial-actions"],["mat-mini-fab","","label","Other Content Type",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["mat-mini-fab","","class","eav-eco-fab-speed-dial-action-button",3,"click",4,"ngFor","ngForOf"],["mat-mini-fab","",1,"eav-eco-fab-speed-dial-action-button",3,"click"],[4,"ngIf","ngIfThen","ngIfElse"],["svgIcon",""],["matIcon",""],["matBadgeColor","accent","matBadgeSize","small","matBadge","\u{1f48e}","matBadgePosition","below after","aria-hidden","false",2,"color","white","fill","white",3,"innerHTML","matBadgeHidden"]],template:function(o,s){1&o&&(t.YNc(0,Tt,18,7,"ng-container",0),t.ALo(1,"async")),2&o&&t.Q6J("ngIf",t.lcZ(1,1,s.viewModel$))},dependencies:[p.mk,p.sg,p.O5,W.lC,O.$,E.H8,T.RK,T.nh,T.cs,U.Hw,st.N8,G.Lp,G.W7,G.YI,rt.k,p.Ov,L.z],styles:["[_nghost-%COMP%]     .mat-button-wrapper div svg *:not([fill]){fill:#fff}"]})}return i})()},9851:(P,C,n)=>{n.d(C,{Y:()=>g});var r=n(9039),h=n(6575),d=n(1268);function x(l,E){1&l&&r.GkF(0)}function a(l,E){if(1&l&&(r.TgZ(0,"mat-hint"),r.YNc(1,x,1,0,"ng-container",3),r.qZA()),2&l){r.oxw();const t=r.MAs(4);r.xp6(1),r.Q6J("ngTemplateOutlet",t)}}function c(l,E){1&l&&r.GkF(0)}function _(l,E){if(1&l&&(r.TgZ(0,"mat-error"),r.YNc(1,c,1,0,"ng-container",3),r.qZA()),2&l){r.oxw();const t=r.MAs(4);r.xp6(1),r.Q6J("ngTemplateOutlet",t)}}function v(l,E){1&l&&r.Hsn(0)}const u=l=>({"hint-box__short":l}),m=["*"];let g=(()=>{class l{constructor(){this.isError=!1,this.isShort=!0}toggleIsShort(){this.isShort=!this.isShort}static#t=this.\u0275fac=function(p){return new(p||l)};static#e=this.\u0275cmp=r.Xpm({type:l,selectors:[["app-field-hint"]],inputs:{isError:"isError"},ngContentSelectors:m,decls:5,vars:6,consts:[[1,"hint-box",3,"ngClass","ngSwitch","click"],[4,"ngSwitchCase"],["content",""],[4,"ngTemplateOutlet"]],template:function(p,T){1&p&&(r.F$t(),r.TgZ(0,"div",0),r.NdJ("click",function(){return T.toggleIsShort()}),r.YNc(1,a,2,1,"mat-hint",1)(2,_,2,1,"mat-error",1),r.qZA(),r.YNc(3,v,1,0,"ng-template",null,2,r.W1O)),2&p&&(r.Q6J("ngClass",r.VKq(4,u,T.isShort))("ngSwitch",T.isError),r.xp6(1),r.Q6J("ngSwitchCase",!1),r.xp6(1),r.Q6J("ngSwitchCase",!0))},dependencies:[h.mk,h.tP,h.RF,h.n9,d.bx,d.TO],styles:[".hint-box[_ngcontent-%COMP%]{margin-top:4px}.hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{font-size:12px;display:block}.hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]})}return l})()},131:(P,C,n)=>{n.d(C,{E:()=>h});var r=n(9039);let h=(()=>{class d{onClick(a){a.stopPropagation()}static#t=this.\u0275fac=function(c){return new(c||d)};static#e=this.\u0275dir=r.lG2({type:d,selectors:[["","appClickStopPropagation",""]],hostBindings:function(c,_){1&c&&r.NdJ("click",function(u){return _.onClick(u)})}})}return d})()},237:(P,C,n)=>{function r(d){return new Promise((x,a)=>{const c=new FileReader;c.readAsDataURL(d),c.onload=()=>{x(c.result.split(",")[1])},c.onerror=_=>{a(_)}})}function h(d){return new Promise((x,a)=>{const c=new FileReader;c.readAsText(d),c.onload=()=>{x(c.result)},c.onerror=_=>{a(_)}})}n.d(C,{B:()=>h,s:()=>r})}}]);
//# sourceMappingURL=https://sources.2sxc.org/17.00.00/dist/ng-edit/projects_eav-ui_src_app_metadata_metadata_component_ts.4bb78f784c7750b8.js.map