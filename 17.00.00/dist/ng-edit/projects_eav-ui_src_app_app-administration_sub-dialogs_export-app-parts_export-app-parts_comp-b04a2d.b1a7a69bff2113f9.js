"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_app-administration_sub-dialogs_export-app-parts_export-app-parts_comp-b04a2d","projects_eav-ui_src_app_shared_directives_click-stop-propagation_directive_ts"],{8018:(T,g,_)=>{_.r(g),_.d(g,{ExportAppPartsComponent:()=>R});var l=_(8071),h=_(3839),r=_(9736),v=_(8834),c=_(196),d=_(5530),f=_(2369),t=_(9039),x=_(6861),P=_(9851),M=_(131),A=_(9498),m=_(6575),E=_(895),O=_(6515),C=_(8849),u=_(1268),I=_(6355),D=_(257),Z=_(6658);function y(o,p){if(1&o&&(t.TgZ(0,"mat-option",10),t._uU(1),t.qZA()),2&o){const e=p.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",e.name," ")}}function U(o,p){if(1&o){const e=t.EpF();t.TgZ(0,"li",20)(1,"div",21)(2,"mat-checkbox",22),t.NdJ("ngModelChange",function(i){const s=t.CHM(e).$implicit;return t.KtG(s._export=i)}),t.TgZ(3,"span",23),t._uU(4),t.qZA()()()()}if(2&o){const e=p.$implicit;t.xp6(2),t.Q6J("ngModel",e._export),t.xp6(2),t.AsE("",e.Name," (",e.Id,")")}}function k(o,p){if(1&o&&(t.TgZ(0,"ul",25)(1,"p",26),t._uU(2,"Templates"),t.qZA(),t.YNc(3,U,5,3,"li",19),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(3),t.Q6J("ngForOf",e.Templates)}}function K(o,p){if(1&o){const e=t.EpF();t.TgZ(0,"li",20)(1,"div",21)(2,"mat-checkbox",22),t.NdJ("ngModelChange",function(i){const s=t.CHM(e).$implicit;return t.KtG(s._export=i)}),t.TgZ(3,"span",23),t._uU(4),t.qZA()()()()}if(2&o){const e=p.$implicit;t.xp6(2),t.Q6J("ngModel",e._export),t.xp6(2),t.AsE("",e.Title," (",e.Id,")")}}function J(o,p){if(1&o&&(t.TgZ(0,"ul",25)(1,"p",26),t._uU(2,"Entities"),t.qZA(),t.YNc(3,K,5,3,"li",19),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(3),t.Q6J("ngForOf",e.Entities)}}function S(o,p){if(1&o){const e=t.EpF();t.TgZ(0,"li",20)(1,"div",21)(2,"mat-checkbox",22),t.NdJ("ngModelChange",function(i){const s=t.CHM(e).$implicit;return t.KtG(s._export=i)}),t.TgZ(3,"span",23),t._uU(4),t.qZA()()(),t.YNc(5,k,4,1,"ul",24)(6,J,4,1,"ul",24),t.qZA()}if(2&o){const e=p.$implicit;t.xp6(2),t.Q6J("ngModel",e._export),t.xp6(2),t.AsE("",e.Name," (",e.Id,")"),t.xp6(1),t.Q6J("ngIf",e.Templates.length>0),t.xp6(1),t.Q6J("ngIf",e.Entities.length>0)}}function b(o,p){if(1&o){const e=t.EpF();t.TgZ(0,"li",20)(1,"div",21)(2,"mat-checkbox",22),t.NdJ("ngModelChange",function(i){const s=t.CHM(e).$implicit;return t.KtG(s._export=i)}),t.TgZ(3,"span",23),t._uU(4),t.qZA()()()()}if(2&o){const e=p.$implicit;t.xp6(2),t.Q6J("ngModel",e._export),t.xp6(2),t.AsE("",e.Name," (",e.Id,")")}}function B(o,p){if(1&o&&(t.TgZ(0,"div")(1,"ul",17)(2,"p",18),t._uU(3,"Content Types"),t.qZA(),t.YNc(4,S,7,5,"li",19),t.qZA(),t.TgZ(5,"ul",17)(6,"p",18),t._uU(7,"Templates Without Content Types"),t.qZA(),t.YNc(8,b,5,3,"li",19),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(4),t.Q6J("ngForOf",e.contentInfo.ContentTypes),t.xp6(4),t.Q6J("ngForOf",e.contentInfo.TemplatesWithoutContentTypes)}}function $(o,p){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",1)(2,"div",2)(3,"div",3),t._uU(4,"Export Content and Templates from this App"),t.qZA()(),t.TgZ(5,"div",4)(6,"p"),t._uU(7," This is an advanced feature to export parts of the app. The export will create an xml file which can be imported into another site or app. To export the entire content of the app (for example when duplicating the entire site), go to the app export. For further help visit "),t.TgZ(8,"a",5),t._uU(9,"2sxc Help"),t.qZA(),t._uU(10,". "),t.qZA(),t.TgZ(11,"div",6)(12,"mat-form-field",7)(13,"mat-label"),t._uU(14,"Scope"),t.qZA(),t.TgZ(15,"mat-select",8),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.changeScope(i))}),t.YNc(16,y,2,2,"mat-option",9),t.TgZ(17,"mat-option",10),t._uU(18,"Other..."),t.qZA()(),t.TgZ(19,"button",11)(20,"mat-icon",12),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.unlockScope())}),t._uU(21),t.qZA()()(),t.TgZ(22,"app-field-hint"),t._uU(23," The scope should almost never be changed - "),t.TgZ(24,"a",13),t._uU(25,"see help"),t.qZA()()(),t.YNc(26,B,9,2,"div",0),t.qZA(),t.TgZ(27,"mat-dialog-actions",14)(28,"button",15),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.closeDialog())}),t._uU(29," Cancel "),t.qZA(),t.TgZ(30,"button",16),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.exportAppParts())}),t._uU(31," Export "),t.qZA()()(),t.BQk()}if(2&o){const e=p.ngIf,n=t.oxw();t.xp6(15),t.Q6J("ngModel",n.exportScope)("disabled",n.lockScope),t.xp6(1),t.Q6J("ngForOf",n.scopeOptions),t.xp6(1),t.Q6J("value",n.dropdownInsertValue),t.xp6(2),t.Q6J("tippy",n.lockScope?"Unlock":"Lock"),t.xp6(2),t.hij(" ",n.lockScope?"lock":"lock_open"," "),t.xp6(5),t.Q6J("ngIf",n.contentInfo),t.xp6(2),t.Q6J("disabled",e.loading||e.isExporting),t.xp6(2),t.Q6J("disabled",e.loading||e.isExporting)}}let R=(()=>{class o{constructor(e,n,i){this.dialogRef=e,this.exportAppPartsService=n,this.contentTypesService=i,this.hostClass="dialog-component",this.exportScope=c.Zy.scopes.default.value,this.lockScope=!0,this.dropdownInsertValue=v.G,this.loading$=new l.X(!1),this.isExporting$=new l.X(!1),this.viewModel$=(0,h.a)([this.loading$,this.isExporting$]).pipe((0,r.U)(([a,s])=>({loading:a,isExporting:s})))}ngOnInit(){this.fetchScopes(),this.fetchContentInfo()}ngOnDestroy(){this.loading$.complete(),this.isExporting$.complete()}closeDialog(){this.dialogRef.close()}exportAppParts(){this.isExporting$.next(!0);const e=this.selectedContentTypes().map(a=>a.Id),n=this.selectedTemplates().map(a=>a.Id);let i=this.selectedEntities().map(a=>a.Id);i=i.concat(n),this.exportAppPartsService.exportParts(e,i,n),this.isExporting$.next(!1)}changeScope(e){e!==v.G||(e=prompt("This is an advanced feature to show content-types of another scope. Don't use this if you don't know what you're doing, as content-types of other scopes are usually hidden for a good reason.")||c.Zy.scopes.default.value,this.scopeOptions.find(n=>n.value===e))||this.scopeOptions.unshift({name:e,value:e}),this.exportScope=e,this.fetchContentInfo()}unlockScope(){this.lockScope=!this.lockScope,this.lockScope&&(this.exportScope=c.Zy.scopes.default.value,this.fetchContentInfo())}fetchScopes(){this.loading$.next(!0),this.contentTypesService.getScopes().subscribe(e=>{this.scopeOptions=e,this.loading$.next(!1)})}fetchContentInfo(){this.loading$.next(!0),this.exportAppPartsService.getContentInfo(this.exportScope).subscribe(e=>{this.contentInfo=e,this.loading$.next(!1)})}selectedContentTypes(){return this.contentInfo.ContentTypes.filter(e=>e._export)}selectedEntities(){let e=[];for(const n of this.contentInfo.ContentTypes)e=e.concat(n.Entities.filter(i=>i._export));return e}selectedTemplates(){let e=[];for(const n of this.contentInfo.ContentTypes)e=e.concat(n.Templates.filter(i=>i._export));return e=e.concat(this.contentInfo.TemplatesWithoutContentTypes.filter(n=>n._export)),e}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(x.so),t.Y36(f.T),t.Y36(d.s))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-export-app-parts"]],hostVars:1,hostBindings:function(n,i){2&n&&t.Ikx("className",i.hostClass)},decls:2,vars:3,consts:[[4,"ngIf"],[1,"eav-dialog","eav-no-scrollbar"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],["href","https://2sxc.org/en/help?tag=export","target","_blank"],[1,"eav-edit-input"],["color","accent",1,"eav-form-field"],["name","Scope",3,"ngModel","disabled","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["mat-icon-button","","matTextSuffix","",3,"tippy"],["appClickStopPropagation","",3,"click"],["appClickStopPropagation","","href","https://2sxc.org/help?tag=scope","target","_blank"],["align","end"],["mat-raised-button","",3,"disabled","click"],["mat-raised-button","","color","accent",3,"disabled","click"],[1,"eav-content-info__list","eav-content-info__base"],[1,"eav-content-info__title"],["class","eav-content-info__item",4,"ngFor","ngForOf"],[1,"eav-content-info__item"],[1,"eav-option-box"],[3,"ngModel","ngModelChange"],[1,"eav-option-box__text"],["class","eav-content-info__list",4,"ngIf"],[1,"eav-content-info__list"],[1,"eav-content-info__subtitle"]],template:function(n,i){1&n&&(t.YNc(0,$,32,9,"ng-container",0),t.ALo(1,"async")),2&n&&t.Q6J("ngIf",t.lcZ(1,1,i.viewModel$))},dependencies:[P.Y,M.E,A.$,x.H8,m.sg,m.O5,E.lW,E.RK,O.Hw,C.JJ,C.On,u.KE,u.hX,u.R9,I.gD,D.ey,Z.oG,m.Ov],styles:[".eav-edit-input[_ngcontent-%COMP%]{padding-bottom:8px}.eav-content-info__title[_ngcontent-%COMP%]{font-size:18px;font-weight:700}.eav-content-info__subtitle[_ngcontent-%COMP%]{font-size:14px;font-weight:700}.eav-content-info__list[_ngcontent-%COMP%]{font-size:14px;list-style-type:none}.eav-content-info__base[_ngcontent-%COMP%]{padding:0}.eav-content-info__item[_ngcontent-%COMP%]{border-top:1px solid #DDD;padding:2px}.eav-option-box[_ngcontent-%COMP%]{margin:8px 0}.eav-option-box__text[_ngcontent-%COMP%]{white-space:normal;font-size:14px}"]})}return o})()},131:(T,g,_)=>{_.d(g,{E:()=>h});var l=_(9039);let h=(()=>{class r{onClick(c){c.stopPropagation()}static#t=this.\u0275fac=function(d){return new(d||r)};static#e=this.\u0275dir=l.lG2({type:r,selectors:[["","appClickStopPropagation",""]],hostBindings:function(d,f){1&d&&l.NdJ("click",function(x){return f.onClick(x)})}})}return r})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/17.00.00/dist/ng-edit/projects_eav-ui_src_app_app-administration_sub-dialogs_export-app-parts_export-app-parts_comp-b04a2d.b1a7a69bff2113f9.js.map