"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_content-type-fields_edit-content-type-fields_edit-content-type-fields-f4d799"],{6335:(J,F,o)=>{o.r(F),o.d(F,{EditContentTypeFieldsComponent:()=>Gt});var s=o(8849),c=o(8071),h=o(5584),v=o(1891),i=o(9736),_=o(4300),T=o(4980),M=o(4520),D=o(5616),N=o(2389),y=o(7938),u=o(4114);const b=(n,d)=>(n.push(d),n);function A(){return(0,u.e)((n,d)=>{(function Z(n,d){return(0,u.e)((0,y.U)(n,d,arguments.length>=2,!1,!0))})(b,[])(n).subscribe(d)})}const E=/^[A-Za-z][A-Za-z0-9]+$/,B="Standard letters and numbers are allowed. Must start with a letter.";var k=o(5530),R=o(9097),O=o(6191),H=o(5809),S=o(9294),f=o(5807);const Y={Boolean:{label:(0,S.C)(O.Q.Boolean),description:"Yes/no or true/false values"},Custom:{label:(0,S.C)(O.Q.Custom),description:"Use for things like gps-pickers (which writes into multiple fields) or for custom-data which serializes something exotic into the db like an array, a custom json or anything"},DateTime:{label:(0,S.C)(O.Q.DateTime),description:"For date, time or combined values"},Empty:{label:(0,S.C)(O.Q.Empty),description:"Use to structure your form"},Entity:{label:(0,S.C)(O.Q.Entity),description:"One or more other content-items"},Hyperlink:{label:(0,S.C)(O.Q.Hyperlink),description:"Hyperlink or reference to a picture / file"},Number:{label:(0,S.C)(O.Q.Number),description:"Any kind of number"},String:{label:(0,S.C)(O.Q.String),description:"Any kind of text"}};var x=o(3488),C=o(6861),g=o(5299),w=o(1527),L=o(5331),it=o(8968),t=o(9039),G=o(9409),ot=o(7648),$=o(6575),j=o(9851),X=o(895),q=o(9674),K=o(1268),at=o(8497),st=o(425);let z=(()=>{class n{constructor(){this.reservedNames={}}validate(e){if(!e.value)return null;const a=e.value.toLocaleLowerCase(),l=Object.keys(this.reservedNames).find(r=>r.toLocaleLowerCase()===a);return l?{reservedNames:this.reservedNames[l]}:null}static#t=this.\u0275fac=function(a){return new(a||n)};static#e=this.\u0275dir=t.lG2({type:n,selectors:[["","appReservedNames",""]],inputs:{reservedNames:["appReservedNames","reservedNames"]},features:[t._Bn([{provide:s.Cf,useExisting:n,multi:!0}])]})}return n})();var V=o(1916);const lt=["ngForm"];function rt(n,d){1&n&&(t.TgZ(0,"th",26)(1,"b"),t._uU(2,"Content Type"),t.qZA()())}function dt(n,d){if(1&n&&(t.TgZ(0,"td",27),t._uU(1),t.qZA()),2&n){const e=d.$implicit;t.xp6(1),t.hij(" ",e.ContentType.Name," ")}}function ct(n,d){1&n&&(t.TgZ(0,"th",26)(1,"b"),t._uU(2,"Name"),t.qZA()())}function pt(n,d){if(1&n&&(t.TgZ(0,"td",27),t._uU(1),t.qZA()),2&n){const e=d.$implicit;t.xp6(1),t.hij(" ",e.StaticName," ")}}function mt(n,d){1&n&&(t.TgZ(0,"th",26)(1,"b"),t._uU(2,"Type"),t.qZA()())}function ut(n,d){if(1&n&&(t.TgZ(0,"td",27),t._uU(1),t.qZA()),2&n){const e=d.$implicit;t.xp6(1),t.hij(" ",e.Type," ")}}function ft(n,d){1&n&&(t.TgZ(0,"th",26)(1,"b"),t._uU(2,"Share"),t.qZA()())}function gt(n,d){if(1&n){const e=t.EpF();t.TgZ(0,"td",27)(1,"button",22),t.NdJ("click",function(){const r=t.CHM(e).$implicit,m=t.oxw();return t.KtG(m.selectField(r))}),t._uU(2,"Select"),t.qZA()()}}function ht(n,d){1&n&&t._UZ(0,"tr",28)}function _t(n,d){1&n&&t._UZ(0,"tr",29)}function vt(n,d){1&n&&(t.TgZ(0,"th",26)(1,"b"),t._uU(2,"New Name"),t.qZA()())}function Ct(n,d){if(1&n&&(t.TgZ(0,"app-field-hint",35),t._uU(1),t.qZA()),2&n){const e=t.oxw(3);t.Q6J("isError",!0),t.xp6(1),t.Oqu(e.fieldNameError)}}function Tt(n,d){if(1&n&&(t.TgZ(0,"app-field-hint",35),t._uU(1),t.qZA()),2&n){t.oxw(2);const e=t.MAs(5);t.Q6J("isError",!0),t.xp6(1),t.hij(" ",e.errors.reservedNames," ")}}function yt(n,d){if(1&n&&(t.ynx(0),t.YNc(1,Ct,2,2,"app-field-hint",34)(2,Tt,2,2,"app-field-hint",34),t.BQk()),2&n){t.oxw();const e=t.MAs(5);t.xp6(1),t.Q6J("ngIf",e.errors.pattern),t.xp6(1),t.Q6J("ngIf",e.errors.reservedNames)}}function xt(n,d){if(1&n){const e=t.EpF();t.TgZ(0,"td",27)(1,"mat-form-field",30)(2,"mat-label"),t._uU(3,"New Name"),t.qZA(),t.TgZ(4,"input",31,32),t.NdJ("ngModelChange",function(l){const m=t.CHM(e).$implicit;return t.KtG(m.newName=l)}),t.qZA()(),t.YNc(6,yt,3,2,"ng-container",33),t.qZA()}if(2&n){const e=d.$implicit,a=d.index,l=t.MAs(5),r=t.oxw();t.xp6(4),t.Q6J("pattern",r.fieldNamePattern)("ngModel",e.newName)("name","StaticName"+a)("appReservedNames",r.reservedNames),t.xp6(2),t.Q6J("ngIf",l.errors)}}function Ft(n,d){1&n&&(t.TgZ(0,"th",26)(1,"b"),t._uU(2,"Source"),t.qZA()())}function bt(n,d){if(1&n&&(t.TgZ(0,"td",36),t._uU(1),t.qZA()),2&n){const e=d.$implicit;t.xp6(1),t.lnq(" ",e.field.ContentType.Name,"/",e.field.StaticName," (",e.field.Type,") ")}}function At(n,d){1&n&&(t.TgZ(0,"th",26)(1,"b"),t._uU(2,"Remove"),t.qZA()())}function St(n,d){if(1&n){const e=t.EpF();t.TgZ(0,"td",27)(1,"button",22),t.NdJ("click",function(){const r=t.CHM(e).$implicit,m=t.oxw();return t.KtG(m.removeField(r))}),t._uU(2,"Remove"),t.qZA()()}}function Zt(n,d){1&n&&t._UZ(0,"tr",28)}function It(n,d){1&n&&t._UZ(0,"tr",29)}let Mt=(()=>{class n extends R.f{constructor(e,a,l,r,m,P,U,Q){super(),this.dialogData=e,this.dialogRef=a,this.contentTypesFieldsService=l,this.snackBar=r,this.featuresService=m,this.dialog=P,this.viewContainerRef=U,this.changeDetectorRef=Q,this.hostClass="dialog-component",this.displayedShareableFieldsColumns=["contentType","name","type","share"],this.displayedSelectedFieldsColumns=["newName","source","remove"],this.shareableFields=new g.by([]),this.selectedFields=new g.by([]),this.fieldNamePattern=E,this.fieldNameError=B,this.saving$=new c.X(!1),this.dialogRef.disableClose=!0,this.subscription.add(this.dialogRef.backdropClick().subscribe(()=>{(this.form.dirty||this.selectedFields.data.length>0)&&!confirm("You have unsaved changes. Are you sure you want to close this dialog?")||this.closeDialog()}))}ngOnInit(){this.subscription.add(this.contentTypesFieldsService.getShareableFields().subscribe(e=>{this.shareableFields.data=e})),this.subscription.add(this.contentTypesFieldsService.getReservedNames().subscribe(e=>{const a={};this.dialogData.existingFields.forEach(l=>{a[l.StaticName]="Field with this name already exists"}),this.reservedNames={...e,...a}}))}ngOnDestroy(){this.saving$.complete(),super.ngOnDestroy()}selectField(e){const a=this.selectedFields.data;a.push({newName:e.StaticName,field:e}),this.selectedFields.data=a}removeField(e){const a=this.selectedFields.data;a.splice(a.indexOf(e),1),this.selectedFields.data=a}save(){this.featuresService.isEnabled$(L.C.FieldShareConfigManagement).pipe((0,w.q)(1)).subscribe(e=>{e?(this.saving$.next(!0),this.snackBar.open("Saving..."),(0,T.of)(...this.selectedFields.data).pipe((0,M.h)(a=>!!a.newName),(0,D.b)(a=>this.contentTypesFieldsService.addInheritedField(this.dialogData.contentType.Id,a.field.ContentType.Id,a.field.Guid,a.newName).pipe((0,N.K)(l=>(0,T.of)(null)))),A()).subscribe(a=>{this.saving$.next(!1),this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()})):it.B.openDialog(this.dialog,L.C.FieldShareConfigManagement,this.viewContainerRef,this.changeDetectorRef)})}closeDialog(){this.dialogRef.close()}static#t=this.\u0275fac=function(a){return new(a||n)(t.Y36(C.WI),t.Y36(C.so),t.Y36(f.Mr),t.Y36(G.ux),t.Y36(ot.k),t.Y36(C.uw),t.Y36(t.s_b),t.Y36(t.sBO))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-add-sharing-fields"]],viewQuery:function(a,l){if(1&a&&t.Gf(lt,5,s.F),2&a){let r;t.iGM(r=t.CRH())&&(l.form=r.first)}},hostVars:1,hostBindings:function(a,l){2&a&&t.Ikx("className",l.hostClass)},features:[t.qOj],decls:50,vars:16,consts:[[1,"eav-dialog","eav-no-scrollbar"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],[1,"eav-tables-div"],[1,"eav-table-div-left"],["mat-table","",1,"eav-fields-table",3,"dataSource"],["matColumnDef","contentType"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","eav-table-cell",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","type"],["matColumnDef","share"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"eav-table-div-right"],["ngForm","ngForm"],["matColumnDef","newName"],["matColumnDef","source"],["mat-cell","","style","word-break:break-all;","class","eav-table-cell",4,"matCellDef"],["matColumnDef","remove"],["align","end"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","submit","color","accent",3,"disabled","click"],[1,"eav-button-feature"],[1,"eav-button-feature-icon",3,"featureNameId"],["mat-header-cell",""],["mat-cell","",1,"eav-table-cell"],["mat-header-row",""],["mat-row",""],["color","accent",1,"eav-form-field"],["matInput","",3,"pattern","ngModel","name","appReservedNames","ngModelChange"],["newName","ngModel"],[4,"ngIf"],[3,"isError",4,"ngIf"],[3,"isError"],["mat-cell","",1,"eav-table-cell",2,"word-break","break-all"]],template:function(a,l){if(1&a&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.TgZ(5,"div",3)(6,"span"),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.TgZ(9,"div",4)(10,"mat-card",5)(11,"table",6),t.ynx(12,7),t.YNc(13,rt,3,0,"th",8)(14,dt,2,1,"td",9),t.BQk(),t.ynx(15,10),t.YNc(16,ct,3,0,"th",8)(17,pt,2,1,"td",9),t.BQk(),t.ynx(18,11),t.YNc(19,mt,3,0,"th",8)(20,ut,2,1,"td",9),t.BQk(),t.ynx(21,12),t.YNc(22,ft,3,0,"th",8)(23,gt,3,0,"td",9),t.BQk(),t.YNc(24,ht,1,0,"tr",13)(25,_t,1,0,"tr",14),t.qZA()(),t.TgZ(26,"mat-card",15)(27,"form",null,16)(29,"table",6),t.ynx(30,17),t.YNc(31,vt,3,0,"th",8)(32,xt,7,5,"td",9),t.BQk(),t.ynx(33,18),t.YNc(34,Ft,3,0,"th",8)(35,bt,2,3,"td",19),t.BQk(),t.ynx(36,20),t.YNc(37,At,3,0,"th",8)(38,St,3,0,"td",9),t.BQk(),t.YNc(39,Zt,1,0,"tr",13)(40,It,1,0,"tr",14),t.qZA()()()(),t.TgZ(41,"mat-dialog-actions",21)(42,"button",22),t.NdJ("click",function(){return l.closeDialog()}),t._uU(43,"Cancel"),t.qZA(),t.TgZ(44,"button",23),t.NdJ("click",function(){return l.save()}),t.ALo(45,"async"),t.TgZ(46,"div",24)(47,"span"),t._uU(48,"Save"),t.qZA(),t._UZ(49,"app-feature-icon-indicator",25),t.qZA()()()()()),2&a){const r=t.MAs(28);t.xp6(3),t.hij(" ",t.lcZ(4,10,"SharingOrInheriting.TitleAddFieldsWhichInherit")," "),t.xp6(4),t.Oqu(t.lcZ(8,12,"SharingOrInheriting.PickFieldsToInheritFrom")),t.xp6(4),t.Q6J("dataSource",l.shareableFields),t.xp6(13),t.Q6J("matHeaderRowDef",l.displayedShareableFieldsColumns),t.xp6(1),t.Q6J("matRowDefColumns",l.displayedShareableFieldsColumns),t.xp6(4),t.Q6J("dataSource",l.selectedFields),t.xp6(10),t.Q6J("matHeaderRowDef",l.displayedSelectedFieldsColumns),t.xp6(1),t.Q6J("matRowDefColumns",l.displayedSelectedFieldsColumns),t.xp6(4),t.Q6J("disabled",!r.form.valid||0==l.selectedFields.data.length||t.lcZ(45,14,l.saving$)),t.xp6(5),t.Q6J("featureNameId","FieldShareConfigManagement")}},dependencies:[$.O5,j.Y,C.H8,X.lW,s._Y,s.Fj,s.JJ,s.JL,s.c5,s.On,s.F,q.Nt,K.KE,K.hX,g.BZ,g.fO,g.as,g.w1,g.Dz,g.nj,g.ge,g.ev,g.XQ,g.Gk,at.a8,st.F,z,$.Ov,V.X$],styles:[".eav-tables-div[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;margin-top:4px;padding-top:4px;height:400px}.eav-tables-div[_ngcontent-%COMP%]   .eav-table-div-left[_ngcontent-%COMP%]{width:50%;height:100%;margin-right:4px;overflow-y:auto;border:1px solid rgba(0,0,0,.1)}.eav-tables-div[_ngcontent-%COMP%]   .eav-table-div-right[_ngcontent-%COMP%]{width:50%;height:100%;margin-left:4px;overflow-y:auto;border:1px solid rgba(0,0,0,.1)}.eav-tables-div[_ngcontent-%COMP%]   .eav-table-div-right[_ngcontent-%COMP%]   .eav-form-field[_ngcontent-%COMP%]{max-width:150px}.eav-tables-div[_ngcontent-%COMP%]   .eav-table-cell[_ngcontent-%COMP%]{border-bottom:1px solid rgba(0,0,0,.1)}.eav-tables-div[_ngcontent-%COMP%]   .mat-column-source[_ngcontent-%COMP%]{min-width:150px}.eav-button-feature[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.eav-button-feature[_ngcontent-%COMP%]   .eav-button-feature-icon[_ngcontent-%COMP%]{margin-left:4px;margin-top:6px}"]})}return n})();var Ot=o(91),Nt=o(40),Et=o(6515),tt=o(6355),Dt=o(257);const wt=["ngForm"];function Ut(n,d){1&n&&(t.ynx(0),t._uU(1,"Fields"),t.BQk())}function Pt(n,d){1&n&&(t.ynx(0),t._uU(1,"Add Fields"),t.BQk())}function Qt(n,d){1&n&&(t.ynx(0),t._uU(1,"Edit Field"),t.BQk())}function Jt(n,d){if(1&n&&(t.TgZ(0,"app-field-hint",24),t._uU(1),t.qZA()),2&n){const e=t.oxw(4);t.Q6J("isError",!0),t.xp6(1),t.Oqu(e.fieldNameError)}}function Yt(n,d){if(1&n&&(t.TgZ(0,"app-field-hint",24),t._uU(1),t.qZA()),2&n){t.oxw(2);const e=t.MAs(6);t.Q6J("isError",!0),t.xp6(1),t.hij(" ",e.errors.reservedNames," ")}}function $t(n,d){if(1&n&&(t.ynx(0),t.YNc(1,Jt,2,2,"app-field-hint",23)(2,Yt,2,2,"app-field-hint",23),t.BQk()),2&n){t.oxw();const e=t.MAs(6);t.xp6(1),t.Q6J("ngIf",e.errors.pattern),t.xp6(1),t.Q6J("ngIf",e.errors.reservedNames)}}function Bt(n,d){if(1&n&&(t.TgZ(0,"mat-option",25)(1,"mat-icon",19),t._uU(2),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.qZA()()),2&n){const e=d.$implicit;t.Q6J("value",e.name),t.xp6(2),t.Oqu(e.icon),t.xp6(2),t.Oqu(e.label)}}function Rt(n,d){if(1&n&&(t.TgZ(0,"mat-icon",21),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.icon)}}const Ht=n=>({"eav-input-obsolete":n});function Lt(n,d){if(1&n&&(t.TgZ(0,"mat-option",26)(1,"div")(2,"span"),t._uU(3),t.qZA(),t.YNc(4,Rt,2,1,"mat-icon",27),t.qZA()()),2&n){const e=d.$implicit;t.Q6J("value",e.inputType)("ngClass",t.VKq(4,Ht,e.isObsolete)),t.xp6(3),t.Oqu(e.label),t.xp6(1),t.Q6J("ngIf",e.icon)}}function Kt(n,d){if(1&n){const e=t.EpF();t.TgZ(0,"div",13)(1,"div",14)(2,"mat-form-field",15)(3,"mat-label"),t._uU(4,"Name"),t.qZA(),t.TgZ(5,"input",16,17),t.NdJ("ngModelChange",function(l){const m=t.CHM(e).$implicit;return t.KtG(m.StaticName=l)}),t.qZA()(),t.YNc(7,$t,3,2,"ng-container",3),t.qZA(),t.TgZ(8,"div",14)(9,"mat-form-field",15)(10,"mat-label"),t._uU(11,"Data Type"),t.qZA(),t.TgZ(12,"mat-select",18),t.NdJ("selectionChange",function(){const r=t.CHM(e).index,m=t.oxw(2);return m.filterInputTypeOptions(r),m.resetInputType(r),t.KtG(m.calculateHints(r))})("ngModelChange",function(l){const m=t.CHM(e).$implicit;return t.KtG(m.Type=l)}),t.TgZ(13,"mat-select-trigger")(14,"mat-icon",19),t._uU(15),t.qZA(),t.TgZ(16,"span"),t._uU(17),t.qZA()(),t.YNc(18,Bt,5,3,"mat-option",20),t.qZA()(),t.TgZ(19,"app-field-hint"),t._uU(20),t.qZA()(),t.TgZ(21,"div",14)(22,"mat-form-field",15)(23,"mat-label"),t._uU(24,"Input Type"),t.qZA(),t.TgZ(25,"mat-select",18),t.NdJ("selectionChange",function(){const r=t.CHM(e).index,m=t.oxw(2);return t.KtG(m.calculateHints(r))})("ngModelChange",function(l){const m=t.CHM(e).$implicit;return t.KtG(m.InputType=l)}),t.TgZ(26,"mat-select-trigger")(27,"span"),t._uU(28),t.qZA(),t.TgZ(29,"mat-icon",21),t._uU(30),t.qZA()(),t.YNc(31,Lt,5,6,"mat-option",22),t.qZA()(),t.TgZ(32,"app-field-hint"),t._uU(33),t.qZA()()()}if(2&n){const e=d.$implicit,a=d.index,l=t.MAs(6),r=t.oxw(2);let m,P;t.xp6(5),t.Q6J("pattern",r.fieldNamePattern)("appReservedNames",r.reservedNames)("ngModel",e.StaticName)("name","StaticName"+a)("disabled","inputType"===r.editMode),t.xp6(2),t.Q6J("ngIf",l.touched&&l.errors),t.xp6(5),t.Q6J("ngModel",e.Type)("name","Type"+a)("disabled",null!=r.editMode),t.xp6(3),t.Oqu(r.findIcon(e.Type)),t.xp6(2),t.Oqu(r.findLabel(e.Type)),t.xp6(1),t.Q6J("ngForOf",r.dataTypes),t.xp6(2),t.Oqu(r.dataTypeHints[a]),t.xp6(5),t.Q6J("ngModel",e.InputType)("name","InputType"+a)("disabled","name"===r.editMode),t.xp6(3),t.Oqu(null==(m=r.getInputTypeOption(e.InputType))?null:m.label),t.xp6(2),t.Oqu(null==(P=r.getInputTypeOption(e.InputType))?null:P.icon),t.xp6(1),t.Q6J("ngForOf",r.filteredInputTypeOptions[a]),t.xp6(2),t.Oqu(r.inputTypeHints[a])}}function kt(n,d){if(1&n){const e=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){t.CHM(e);const l=t.oxw(2);return t.KtG(l.addSharedField())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"SharingOrInheriting.AddSharedField")))}function Wt(n,d){if(1&n){const e=t.EpF();t.TgZ(0,"form",5,6),t.NdJ("ngSubmit",function(){t.CHM(e);const l=t.oxw();return t.KtG(l.save())}),t.TgZ(2,"div",7),t.YNc(3,Kt,34,20,"div",8),t.qZA(),t.TgZ(4,"mat-dialog-actions"),t.YNc(5,kt,3,3,"button",9),t.ALo(6,"async"),t._UZ(7,"div",10),t.TgZ(8,"button",11),t.NdJ("click",function(){t.CHM(e);const l=t.oxw();return t.KtG(l.closeDialog())}),t._uU(9,"Cancel"),t.qZA(),t.TgZ(10,"button",12),t.ALo(11,"async"),t._uU(12," Save "),t.qZA()()()}if(2&n){const e=t.MAs(1),a=t.oxw();t.xp6(3),t.Q6J("ngForOf",a.fields),t.xp6(2),t.Q6J("ngIf",t.lcZ(6,3,a.debugEnabled$)),t.xp6(5),t.Q6J("disabled",!e.form.valid||t.lcZ(11,5,a.saving$))}}let Gt=(()=>{class n extends R.f{constructor(e,a,l,r,m,P,U){super(),this.dialogRef=e,this.route=a,this.contentTypesService=l,this.contentTypesFieldsService=r,this.globalConfigService=m,this.snackBar=P,this.dialog=U,this.hostClass="dialog-component",this.fields=[],this.existingFields=[],this.filteredInputTypeOptions=[],this.dataTypeHints=[],this.inputTypeHints=[],this.fieldNamePattern=E,this.fieldNameError=B,this.findIcon=S.x,this.findLabel=S.C,this.loading$=new c.X(!0),this.saving$=new c.X(!1),this.debugEnabled$=this.globalConfigService.getDebugEnabled$(),this.dialogRef.disableClose=!0,this.subscription.add(this.dialogRef.backdropClick().subscribe(Q=>{this.form.dirty&&!confirm("You have unsaved changes. Are you sure you want to close this dialog?")||this.closeDialog()}))}ngOnInit(){this.editMode=this.route.snapshot.paramMap.get("editMode");const e=this.route.snapshot.paramMap.get("contentTypeStaticName"),a=this.contentTypesService.retrieveContentType(e).pipe((0,h.B)()),l=a.pipe((0,v.w)(U=>this.contentTypesFieldsService.getFields(U.StaticName))),r=this.contentTypesFieldsService.typeListRetrieve().pipe((0,i.U)(U=>function p(n){const d=[];for(const e of n)d.push({name:e,label:Y[e].label,icon:(0,S.x)(e),description:Y[e].description});return d}(U))),m=this.contentTypesFieldsService.getInputTypesList(),P=this.contentTypesFieldsService.getReservedNames();(0,_.D)([a,l,r,m,P]).subscribe(([U,Q,W,jt,Xt])=>{this.contentType=U,this.dataTypes=W,this.inputTypeOptions=jt,this.existingFields=Q;const et={};if(Q.forEach(I=>{et[I.StaticName]="Field with this name already exists"}),this.reservedNames={...Xt,...et},null!=this.editMode){const I=this.route.snapshot.paramMap.get("id")?parseInt(this.route.snapshot.paramMap.get("id"),10):null,nt=Q.find(qt=>qt.Id===I);"name"===this.editMode&&delete this.reservedNames[nt.StaticName],this.fields.push(nt)}else for(let I=1;I<=8;I++)this.fields.push({Id:0,Type:O.Q.String,InputType:H.v.StringDefault,StaticName:"",IsTitle:0===Q.length,SortOrder:Q.length+I});for(let I=0;I<this.fields.length;I++)this.filterInputTypeOptions(I),this.calculateHints(I);this.loading$.next(!1)})}ngOnDestroy(){this.loading$.complete(),this.saving$.complete(),super.ngOnDestroy()}closeDialog(){this.dialogRef.close()}filterInputTypeOptions(e){this.filteredInputTypeOptions[e]=this.inputTypeOptions.filter(a=>a.dataType===this.fields[e].Type.toLocaleLowerCase())}resetInputType(e){let a=this.fields[e].Type.toLocaleLowerCase()+H.v.DefaultSuffix;this.filteredInputTypeOptions[e].some(r=>r.inputType===a)||(a=this.filteredInputTypeOptions[e][0].inputType),this.fields[e].InputType=a}calculateHints(e){const a=this.dataTypes.find(r=>r.name===this.fields[e].Type),l=this.inputTypeOptions.find(r=>r.inputType===this.fields[e].InputType);this.dataTypeHints[e]=a?.description??"",this.inputTypeHints[e]=l?.isObsolete?`OBSOLETE - ${l.obsoleteMessage}`:l?.description??""}getInputTypeOption(e){return this.inputTypeOptions.find(a=>a.inputType===e)}addSharedField(){this.dialog.open(Mt,{autoFocus:!1,width:"1600px",data:{contentType:this.contentType,existingFields:this.existingFields}})}save(){if(this.saving$.next(!0),this.snackBar.open("Saving..."),null!=this.editMode){const e=this.fields[0];"name"===this.editMode?this.contentTypesFieldsService.rename(e.Id,this.contentType.Id,e.StaticName).subscribe(()=>{this.saving$.next(!1),this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()}):"inputType"===this.editMode&&this.contentTypesFieldsService.updateInputType(e.Id,e.StaticName,e.InputType).subscribe(()=>{this.saving$.next(!1),this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()})}else(0,T.of)(...this.fields).pipe((0,M.h)(e=>!!e.StaticName),(0,D.b)(e=>this.contentTypesFieldsService.add(e,this.contentType.Id).pipe((0,N.K)(a=>(0,T.of)(null)))),A()).subscribe(e=>{this.saving$.next(!1),this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()})}static#t=this.\u0275fac=function(a){return new(a||n)(t.Y36(C.so),t.Y36(Ot.gz),t.Y36(k.s),t.Y36(f.Mr),t.Y36(x.bE),t.Y36(G.ux),t.Y36(C.uw))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-edit-content-type-fields"]],viewQuery:function(a,l){if(1&a&&t.Gf(wt,5,s.F),2&a){let r;t.iGM(r=t.CRH())&&(l.form=r.first)}},hostVars:1,hostBindings:function(a,l){2&a&&t.Ikx("className",l.hostClass)},features:[t.qOj],decls:8,vars:6,consts:[["appToggleDebug","",1,"eav-dialog","eav-no-scrollbar"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[4,"ngIf"],[3,"ngSubmit",4,"ngIf"],[3,"ngSubmit"],["ngForm","ngForm"],[1,"eav-dialog-content"],["class","eav-row-container",4,"ngFor","ngForOf"],["mat-raised-button","","type","button",3,"click",4,"ngIf"],[1,"spacer"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","submit","color","accent",3,"disabled"],[1,"eav-row-container"],[1,"eav-edit-input"],["color","accent",1,"eav-form-field"],["matInput","",3,"pattern","appReservedNames","ngModel","name","disabled","ngModelChange"],["staticName","ngModel"],[3,"ngModel","name","disabled","selectionChange","ngModelChange"],[1,"eav-type-icon"],[3,"value",4,"ngFor","ngForOf"],[1,"eav-input-icon"],[3,"value","ngClass",4,"ngFor","ngForOf"],[3,"isError",4,"ngIf"],[3,"isError"],[3,"value"],[3,"value","ngClass"],["class","eav-input-icon",4,"ngIf"]],template:function(a,l){1&a&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t.YNc(3,Ut,2,0,"ng-container",3)(4,Pt,2,0,"ng-container",3)(5,Qt,2,0,"ng-container",3),t.qZA()(),t.YNc(6,Wt,13,7,"form",4),t.ALo(7,"async"),t.qZA()),2&a&&(t.xp6(3),t.Q6J("ngIf",void 0===l.editMode),t.xp6(1),t.Q6J("ngIf",null===l.editMode),t.xp6(1),t.Q6J("ngIf",null!=l.editMode),t.xp6(1),t.Q6J("ngIf",!1===t.lcZ(7,4,l.loading$)))},dependencies:[$.mk,$.sg,$.O5,j.Y,Nt.D,C.H8,X.lW,Et.Hw,s._Y,s.Fj,s.JJ,s.JL,s.c5,s.On,s.F,q.Nt,K.KE,K.hX,tt.gD,tt.$L,Dt.ey,z,$.Ov,V.X$],styles:[".eav-row-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.eav-edit-input[_ngcontent-%COMP%]{padding-bottom:8px;width:30%}.eav-type-icon[_ngcontent-%COMP%]{width:inherit;height:inherit;margin-right:8px;font-size:inherit;vertical-align:top;line-height:inherit}.eav-input-icon[_ngcontent-%COMP%]{width:inherit;height:inherit;margin-left:8px;font-size:inherit;vertical-align:top;line-height:inherit}.eav-input-obsolete[_ngcontent-%COMP%]{-webkit-text-decoration:black line-through;text-decoration:black line-through;color:#696969}"]})}return n})()},425:(J,F,o)=>{o.d(F,{F:()=>N});var s=o(8968),c=o(9039),h=o(6861),v=o(7648),i=o(6575),_=o(6515),T=o(9498),M=o(1916);function D(y,u){1&y&&(c.TgZ(0,"mat-icon",1),c.ALo(1,"translate"),c._uU(2,"diamond"),c.qZA()),2&y&&c.Q6J("tippy",c.lcZ(1,1,"Features.NotActivated"))}let N=(()=>{class y extends s.B{constructor(Z,b,A,E){super(Z,b,E,A)}static#t=this.\u0275fac=function(b){return new(b||y)(c.Y36(h.uw),c.Y36(c.s_b),c.Y36(v.k),c.Y36(c.sBO))};static#e=this.\u0275cmp=c.Xpm({type:y,selectors:[["app-feature-icon-indicator"]],features:[c.qOj],decls:2,vars:3,consts:[[3,"tippy",4,"ngIf"],[3,"tippy"]],template:function(b,A){1&b&&(c.YNc(0,D,3,3,"mat-icon",0),c.ALo(1,"async")),2&b&&c.Q6J("ngIf",c.lcZ(1,1,A.show$))},dependencies:[i.O5,_.Hw,T.$,i.Ov,M.X$]})}return y})()},5331:(J,F,o)=>{o.d(F,{C:()=>s});const s={AppSyncWithSiteFiles:"AppSyncWithSiteFiles",WysiwygPasteFormatted:"WysiwygPasteFormatted",PasteImageFromClipboard:"PasteImageFromClipboard",EditUiShowNotes:"EditUiShowNotes",EditUiShowMetadataFor:"EditUiShowMetadataFor",NoSponsoredByToSic:"NoSponsoredByToSic",EditUiTranslateWithGoogle:"EditUiTranslateWithGoogle",LightSpeed:"LightSpeedOutputCache",ContentSecurityPolicy:"ContentSecurityPolicy",PermissionsByLanguage:"PermissionsByLanguage",FieldShareConfigManagement:"FieldShareConfigManagement"}},8968:(J,F,o)=>{o.d(F,{B:()=>S});var s=o(6861),c=o(3839),h=o(9736),v=o(4472),i=o(9039),_=o(9409),T=o(8737),M=o(6575),D=o(895),N=o(6515),y=o(8497),u=o(9498),Z=o(6537),b=o(1916);function A(f,Y){if(1&f){const p=i.EpF();i.TgZ(0,"div",2)(1,"div",3),i._uU(2,"ID:"),i.qZA(),i.TgZ(3,"div",9)(4,"span",10),i.NdJ("click",function(){const g=i.CHM(p).ngIf,w=i.oxw(2);return i.KtG(w.copyToClipboard(g))}),i._uU(5),i.qZA()()()}if(2&f){const p=Y.ngIf;i.xp6(4),i.Q6J("tippy",p),i.xp6(1),i.Oqu(p)}}function E(f,Y){if(1&f){const p=i.EpF();i.TgZ(0,"button",11),i.NdJ("click",function(){const g=i.CHM(p).ngIf,w=i.oxw(2);return i.KtG(w.findOutMore(g))}),i.TgZ(1,"mat-icon"),i._uU(2,"open_in_new"),i.qZA(),i._uU(3),i.ALo(4,"translate"),i.qZA()}2&f&&(i.xp6(3),i.hij(" ",i.lcZ(4,1,"Features.FindOutMore")," "))}function B(f,Y){if(1&f){const p=i.EpF();i.TgZ(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),i._uU(3),i.qZA()(),i.TgZ(4,"mat-card-content"),i._UZ(5,"p",1),i.ALo(6,"safeHtml"),i.TgZ(7,"div",2)(8,"div",3),i._uU(9),i.ALo(10,"translate"),i.qZA(),i.TgZ(11,"div",4)(12,"span"),i._uU(13),i.ALo(14,"translate"),i.qZA()()(),i.YNc(15,A,6,2,"div",5),i.qZA(),i.TgZ(16,"mat-card-actions",6),i.YNc(17,E,5,3,"button",7),i.TgZ(18,"button",8),i.NdJ("click",function(){i.CHM(p);const C=i.oxw();return i.KtG(C.closeDialog())}),i._uU(19),i.ALo(20,"translate"),i.qZA()()()}if(2&f){const p=Y.ngIf;i.xp6(3),i.Oqu(p.feature.Name),i.xp6(2),i.Q6J("innerHtml",i.lcZ(6,7,p.feature.Description),i.oJD),i.xp6(4),i.hij("",i.lcZ(10,9,"Features.Status"),":"),i.xp6(4),i.Oqu(i.lcZ(14,11,p.feature.IsEnabled?"Features.Active":"Features.NotActive")),i.xp6(2),i.Q6J("ngIf",p.feature.NameId),i.xp6(2),i.Q6J("ngIf",p.feature.Link),i.xp6(2),i.hij(" ",i.lcZ(20,13,"Features.Close")," ")}}let k=(()=>{class f{constructor(p,x,C,g){this.dialogData=p,this.dialogRef=x,this.snackBar=C,this.featureDetailService=g}ngOnInit(){this.viewModel$=(0,c.a)([this.featureDetailService.getFeatureDetails(this.dialogData)]).pipe((0,h.U)(([p])=>({feature:p})))}copyToClipboard(p){(0,v.v)(p),this.snackBar.open("Copied to clipboard",null,{duration:2e3})}findOutMore(p){window.open(p,"_blank")}closeDialog(){this.dialogRef.close()}static#t=this.\u0275fac=function(x){return new(x||f)(i.Y36(s.WI),i.Y36(s.so),i.Y36(_.ux),i.Y36(T.f))};static#e=this.\u0275cmp=i.Xpm({type:f,selectors:[["app-feature-info-dialog"]],decls:2,vars:3,consts:[[4,"ngIf"],[3,"innerHtml"],[1,"eav-info-row"],[1,"eav-info-row__label"],[1,"eav-info-row__value"],["class","eav-info-row",4,"ngIf"],["align","end"],["mat-raised-button","","color","accent","class","eav-card-action-button",3,"click",4,"ngIf"],["mat-raised-button","",1,"eav-card-action-button",3,"click"],[1,"eav-info-row__value","eav_click"],[3,"tippy","click"],["mat-raised-button","","color","accent",1,"eav-card-action-button",3,"click"]],template:function(x,C){1&x&&(i.YNc(0,B,21,15,"mat-card",0),i.ALo(1,"async")),2&x&&i.Q6J("ngIf",i.lcZ(1,1,C.viewModel$))},dependencies:[M.O5,D.lW,N.Hw,y.a8,y.hq,y.dn,y.dk,y.n5,u.$,M.Ov,Z.z,b.X$]})}return f})();var R=o(8071),O=o(1891),H=o(7648);let S=(()=>{class f{set featureNameId(p){this.featureNameId$.next(p)}set showIf(p){this.showIf$.next(1==p)}constructor(p,x,C,g){this.dialog=p,this.viewContainerRef=x,this.changeDetectorRef=C,this.featuresService=g,this.featureNameId$=new R.X(null),this.showIf$=new R.X(!1),this.feature$=this.featureNameId$.pipe((0,O.w)(w=>this.featuresService.get$(w))),this.show$=(0,c.a)([this.feature$,this.showIf$]).pipe((0,h.U)(([w,L])=>L==(w?.IsEnabled??!1)))}openDialog(){f.openDialog(this.dialog,this.featureNameId$.value,this.viewContainerRef,this.changeDetectorRef)}static openDialog(p,x,C,g){p.open(k,{autoFocus:!1,data:x,viewContainerRef:C,width:"400px"}),g.markForCheck()}static#t=this.\u0275fac=function(x){return new(x||f)(i.Y36(s.uw),i.Y36(i.s_b),i.Y36(i.sBO),i.Y36(H.k))};static#e=this.\u0275dir=i.lG2({type:f,inputs:{featureNameId:"featureNameId",showIf:"showIf"}})}return f})()},9851:(J,F,o)=>{o.d(F,{Y:()=>y});var s=o(9039),c=o(6575),h=o(1268);function v(u,Z){1&u&&s.GkF(0)}function i(u,Z){if(1&u&&(s.TgZ(0,"mat-hint"),s.YNc(1,v,1,0,"ng-container",3),s.qZA()),2&u){s.oxw();const b=s.MAs(4);s.xp6(1),s.Q6J("ngTemplateOutlet",b)}}function _(u,Z){1&u&&s.GkF(0)}function T(u,Z){if(1&u&&(s.TgZ(0,"mat-error"),s.YNc(1,_,1,0,"ng-container",3),s.qZA()),2&u){s.oxw();const b=s.MAs(4);s.xp6(1),s.Q6J("ngTemplateOutlet",b)}}function M(u,Z){1&u&&s.Hsn(0)}const D=u=>({"hint-box__short":u}),N=["*"];let y=(()=>{class u{constructor(){this.isError=!1,this.isShort=!0}toggleIsShort(){this.isShort=!this.isShort}static#t=this.\u0275fac=function(A){return new(A||u)};static#e=this.\u0275cmp=s.Xpm({type:u,selectors:[["app-field-hint"]],inputs:{isError:"isError"},ngContentSelectors:N,decls:5,vars:6,consts:[[1,"hint-box",3,"ngClass","ngSwitch","click"],[4,"ngSwitchCase"],["content",""],[4,"ngTemplateOutlet"]],template:function(A,E){1&A&&(s.F$t(),s.TgZ(0,"div",0),s.NdJ("click",function(){return E.toggleIsShort()}),s.YNc(1,i,2,1,"mat-hint",1)(2,T,2,1,"mat-error",1),s.qZA(),s.YNc(3,M,1,0,"ng-template",null,2,s.W1O)),2&A&&(s.Q6J("ngClass",s.VKq(4,D,E.isShort))("ngSwitch",E.isError),s.xp6(1),s.Q6J("ngSwitchCase",!1),s.xp6(1),s.Q6J("ngSwitchCase",!0))},dependencies:[c.mk,c.tP,c.RF,c.n9,h.bx,h.TO],styles:[".hint-box[_ngcontent-%COMP%]{margin-top:4px}.hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{font-size:12px;display:block}.hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]})}return u})()},40:(J,F,o)=>{o.d(F,{D:()=>h});var s=o(3488),c=o(9039);let h=(()=>{class v{constructor(_){this.globalConfigService=_}onClick(_){(navigator.platform.match("Mac")?_.metaKey:_.ctrlKey)&&_.shiftKey&&_.altKey&&(this.globalConfigService.toggleDebugEnabled(),window.getSelection().removeAllRanges())}static#t=this.\u0275fac=function(T){return new(T||v)(c.Y36(s.bE))};static#e=this.\u0275dir=c.lG2({type:v,selectors:[["","appToggleDebug",""]],hostBindings:function(T,M){1&T&&c.NdJ("click",function(N){return M.onClick(N)})}})}return v})()},4472:(J,F,o)=>{function s(c){const h=document.createElement("textarea");h.value=c,h.setAttribute("readonly",""),h.style.position="absolute",h.style.left="-9999px",document.body.appendChild(h);const v=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);h.select(),document.execCommand("copy"),document.body.removeChild(h),v&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(v))}o.d(F,{v:()=>s})},6537:(J,F,o)=>{o.d(F,{z:()=>h});var s=o(9039),c=o(6480);let h=(()=>{class v{constructor(_){this.sanitizer=_}transform(_){return this.sanitizer.bypassSecurityTrustHtml(_)}static#t=this.\u0275fac=function(T){return new(T||v)(s.Y36(c.H7,16))};static#e=this.\u0275pipe=s.Yjl({name:"safeHtml",type:v,pure:!0})}return v})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/17.00.00/dist/ng-edit/projects_eav-ui_src_app_content-type-fields_edit-content-type-fields_edit-content-type-fields-f4d799.91a56f287577231c.js.map