"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_content-items_content-items_component_ts","projects_eav-ui_src_app_shared_directives_click-stop-propagation_directive_ts","projects_eav-ui_src_app_app-administration_services_app-dialog-config_service_ts-_86580","projects_eav-ui_src_app_app-administration_services_app-dialog-config_service_ts-_86581"],{9731:(O,v,i)=>{i.d(v,{K:()=>h});var r=i(1650),l=i(9736),d=i(3738),T=i(3488),f=i(2611),m=i(9039),p=i(4860),x=i(6232),g=i(7648);let h=(()=>{class c{constructor(t,y,C,Z,F){this.http=t,this.context=y,this.dnnContext=C,this.globalConfigService=Z,this.dialogSettings$={},F.loadFromService(this)}getShared$(t){return t??=this.context.appId,this.dialogSettings$[t]||(this.dialogSettings$[t]=this.getDialogSettings(t).pipe((0,r.d)({refCount:!1}))),this.dialogSettings$[t]}getDialogSettings(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/dialog/settings"),{params:{appId:t??this.context.appId.toString()}}).pipe((0,l.U)(y=>(y.Context.Language.List=y.Context.Language.List.filter(C=>C.IsEnabled),y)),(0,d.b)(y=>{this.globalConfigService.allowDebug(y.Context.Enable.DebugMode)}))}static#t=this.\u0275fac=function(y){return new(y||c)(m.LFG(p.eN),m.LFG(f._),m.LFG(x._y),m.LFG(T.bE),m.LFG(g.k))};static#e=this.\u0275prov=m.Yz7({token:c,factory:c.\u0275fac})}return c})()},2369:(O,v,i)=>{i.d(v,{T:()=>m});var r=i(2611),l=i(3379),d=i(9039),T=i(4860),f=i(6232);let m=(()=>{class p{constructor(g,u,h){this.http=g,this.context=u,this.dnnContext=h}getContentInfo(g){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(l.v+"Get"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),scope:g}})}exportParts(g,u,h){const c=this.dnnContext.$2sxc.http.apiUrl(l.v+"Export")+"?appId="+this.context.appId.toString()+"&zoneId="+this.context.zoneId.toString()+"&contentTypeIdsString="+g.join(";")+"&entityIdsString="+u.join(";")+"&templateIdsString="+h.join(";");window.open(c,"_blank","")}static#t=this.\u0275fac=function(u){return new(u||p)(d.LFG(T.eN),d.LFG(r._),d.LFG(f._y))};static#e=this.\u0275prov=d.Yz7({token:p,factory:p.\u0275fac})}return p})()},2091:(O,v,i)=>{i.d(v,{v:()=>m});var r=i(4173),l=i(2611),d=i(9039),T=i(4860),f=i(6232);let m=(()=>{class p{constructor(g,u,h){this.http=g,this.context=u,this.dnnContext=h}getAppInfo(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(r.H+"Statistics"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}exportApp(g,u){const h=this.dnnContext.$2sxc.http.apiUrl(r.H+"Export")+"?appId="+this.context.appId+"&zoneId="+this.context.zoneId+"&includeContentGroups="+g+"&resetAppGuid="+u;window.open(h,"_blank","")}exportForVersionControl({includeContentGroups:g,resetAppGuid:u,withFiles:h}){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(r.H+"SaveData"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),includeContentGroups:g.toString(),resetAppGuid:u.toString(),withPortalFiles:h.toString()}})}static#t=this.\u0275fac=function(u){return new(u||p)(d.LFG(T.eN),d.LFG(l._),d.LFG(f._y))};static#e=this.\u0275prov=d.Yz7({token:p,factory:p.\u0275fac})}return p})()},3379:(O,v,i)=>{i.d(v,{v:()=>m,z:()=>p});var r=i(4173),l=i(2611),d=i(9039),T=i(4860),f=i(6232);const m="admin/appParts/";let p=(()=>{class x{constructor(u,h,c){this.http=u,this.context=h,this.dnnContext=c}importAppParts(u){const h=new FormData;return h.append("File",u),this.http.post(this.dnnContext.$2sxc.http.apiUrl(m+"Import"),h,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}resetApp(u){return this.http.post(this.dnnContext.$2sxc.http.apiUrl(r.H+"Reset"),{},{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),withPortalFiles:u.toString()}})}static#t=this.\u0275fac=function(h){return new(h||x)(d.LFG(T.eN),d.LFG(l._),d.LFG(f._y))};static#e=this.\u0275prov=d.Yz7({token:x,factory:x.\u0275fac})}return x})()},1217:(O,v,i)=>{i.d(v,{Az:()=>m.Az,Kw:()=>r.K,TB:()=>m.TB,bf:()=>m.bf,cv:()=>m.cv,h3:()=>p.h,nt:()=>m.nt,sF:()=>l.s,vG:()=>m.vG});var r=i(9731),l=i(5530),m=(i(2369),i(2091),i(3379),i(7749)),p=i(6992)},7749:(O,v,i)=>{i.d(v,{Az:()=>t,TB:()=>C,bf:()=>Z,cv:()=>E,nt:()=>y,vG:()=>F});var r=i(6253),l=i(1891),d=i(9736),T=i(400),f=i(237),m=i(2611),p=i(9039),x=i(4860),g=i(6232);const E="admin/query/Run",t="admin/query/DebugStream",y="admin/query/Save",C="admin/query/Get",Z="admin/query/DataSources";let F=(()=>{class U{constructor(b,I,L){this.http=b,this.context=I,this.dnnContext=L}getAll(b){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(T.PS),{params:{appId:this.context.appId.toString(),contentType:b}})}importQuery(b){return(0,r.D)((0,f.s)(b)).pipe((0,l.w)(I=>this.http.post(this.dnnContext.$2sxc.http.apiUrl("admin/query/import"),{AppId:this.context.appId.toString(),ContentBase64:I})),(0,d.U)(I=>({Success:I,Messages:[]})))}clonePipeline(b){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/query/Clone"),{params:{Id:b.toString(),appId:this.context.appId.toString()}})}delete(b){return this.http.delete(this.dnnContext.$2sxc.http.apiUrl("admin/query/Delete"),{params:{appId:this.context.appId.toString(),Id:b.toString()}})}static#t=this.\u0275fac=function(I){return new(I||U)(p.LFG(x.eN),p.LFG(m._),p.LFG(g._y))};static#e=this.\u0275prov=p.Yz7({token:U,factory:U.\u0275fac})}return U})()},6992:(O,v,i)=>{i.d(v,{h:()=>h});var r=i(2611),l=i(9039),d=i(4860),T=i(6232);const f="admin/view/",m=f+"all",p=f+"delete",x=f+"import",g=f+"polymorphism",u=f+"usage";let h=(()=>{class c{constructor(t,y,C){this.http=t,this.context=y,this.dnnContext=C}getAll(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(m),{params:{appId:this.context.appId.toString()}})}delete(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(p),{params:{appId:this.context.appId.toString(),Id:t.toString()}})}import(t){const y=new FormData;return y.append("File",t),this.http.post(this.dnnContext.$2sxc.http.apiUrl(x),y,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}export(t){const y=this.dnnContext.$2sxc.http.apiUrl(f+"json")+"?appId="+this.context.appId+"&viewId="+t;window.open(y,"_blank","")}getPolymorphism(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(g),{params:{appId:this.context.appId.toString()}})}getUsage(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(u),{params:{appId:this.context.appId.toString(),guid:t}})}static#t=this.\u0275fac=function(y){return new(y||c)(l.LFG(d.eN),l.LFG(r._),l.LFG(T._y))};static#e=this.\u0275prov=l.Yz7({token:c,factory:c.\u0275fac})}return c})()},1352:(O,v,i)=>{i.r(v),i.d(v,{ContentItemsComponent:()=>_e});var r=i(9877),l=i(8071),d=i(3839),T=i(9736),f=i(4520),m=i(1527),p=i(5530),x=i(4323),g=i(6191),u=i(3488),h=i(3955),c=i(6041),E=i(8730),t=i(9039),y=i(1268),C=i(8849),Z=i(9674);const F=["valueInput"];let U=(()=>{class o{constructor(){this.filter="",this.idFilterString="",this.idFilter=[]}agInit(e){this.filterParams=e}isFilterActive(){return""!==this.filter||this.idFilter.length>0}doesFilterPass(e){if(""!==this.filter){const a=this.filterParams.valueGetter({api:this.filterParams.api,colDef:this.filterParams.colDef,column:this.filterParams.column,columnApi:this.filterParams.columnApi,context:this.filterParams.context,data:e.node.data,getValue:s=>e.node.data[s],node:e.node});if(null==a||!a.some(s=>!!s&&s.includes(this.filter)))return!1}if(this.idFilter.length>0){const n=e.data[this.filterParams.colDef.headerName];if(null==n||!this.idFilter.some(a=>n.some(s=>s.Id===a)))return!1}return!0}getModel(){return this.isFilterActive()?{filterType:"entity",filter:this.filter,idFilter:this.idFilter}:void 0}setModel(e){this.filter=e?.filter??"",this.idFilter=e?.idFilter??[],this.idFilterString=e?.idFilter?.join(",")??""}afterGuiAttached(e){this.valueInputRef.nativeElement.focus()}updateIdFilter(){this.idFilter=this.idFilterString.split(",").map(e=>parseInt(e,10)).filter(e=>!isNaN(e))}filterChanged(){this.filterParams.filterChangedCallback()}static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-entity-filter"]],viewQuery:function(n,a){if(1&n&&t.Gf(F,5),2&n){let s;t.iGM(s=t.CRH())&&(a.valueInputRef=s.first)}},decls:9,vars:2,consts:[["color","accent"],["matInput","","type","text",3,"ngModel","ngModelChange"],["valueInput",""]],template:function(n,a){1&n&&(t.TgZ(0,"mat-form-field",0)(1,"mat-label"),t._uU(2,"Value"),t.qZA(),t.TgZ(3,"input",1,2),t.NdJ("ngModelChange",function(D){return a.filter=D})("ngModelChange",function(){return a.filterChanged()}),t.qZA()(),t.TgZ(5,"mat-form-field",0)(6,"mat-label"),t._uU(7,"IDs (comma separated)"),t.qZA(),t.TgZ(8,"input",1),t.NdJ("ngModelChange",function(D){return a.idFilterString=D})("ngModelChange",function(){return a.updateIdFilter(),a.filterChanged()}),t.qZA()()),2&n&&(t.xp6(3),t.Q6J("ngModel",a.filter),t.xp6(5),t.Q6J("ngModel",a.idFilterString))},dependencies:[y.KE,y.hX,C.Fj,C.JJ,C.On,Z.Nt],styles:["[_nghost-%COMP%]{display:block;padding:16px 12px 2px}.mat-mdc-form-field[_ngcontent-%COMP%]{display:block;width:150px}"]})}return o})();var q=i(5253),b=i(6433),I=i(196),L=i(6115),tt=i(1766),Q=i(2957),S=i(9498),w=i(6515),W=i(257),G=i(8128);function et(o,_){if(1&o){const e=t.EpF();t.TgZ(0,"button",7),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.deleteItem())}),t.TgZ(1,"mat-icon"),t._uU(2,"delete"),t.qZA(),t.TgZ(3,"span"),t._uU(4,"Delete"),t.qZA()()}if(2&o){const e=t.oxw();t.Q6J("disabled",e.item._EditInfo.DisableDelete)}}let nt=(()=>{class o{agInit(e){this.params=e,this.item=e.data}refresh(e){return!0}clone(){this.params.onClone(this.item)}export(){this.params.onExport(this.item)}deleteItem(){this.params.onDelete(this.item)}static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-content-items-actions"]],decls:13,vars:1,consts:[[1,"actions-component"],["matRipple","","tippy","Copy",1,"eav-grid-action-button","highlight",3,"click"],["matRipple","","tippy","Export",1,"eav-grid-action-button","highlight",3,"click"],["matRipple","","tippy","More",1,"eav-grid-action-button","highlight",3,"matMenuTriggerFor"],[1,"grid-more-menu"],["menu","matMenu"],["matMenuContent",""],["mat-menu-item","",3,"disabled","click"]],template:function(n,a){if(1&n&&(t.TgZ(0,"div",0)(1,"div",1),t.NdJ("click",function(){return a.clone()}),t.TgZ(2,"mat-icon"),t._uU(3,"file_copy"),t.qZA()(),t.TgZ(4,"div",2),t.NdJ("click",function(){return a.export()}),t.TgZ(5,"mat-icon"),t._uU(6,"cloud_download"),t.qZA()(),t.TgZ(7,"div",3)(8,"mat-icon"),t._uU(9,"more_horiz"),t.qZA()()(),t.TgZ(10,"mat-menu",4,5),t.YNc(12,et,5,1,"ng-template",6),t.qZA()),2&n){const s=t.MAs(11);t.xp6(7),t.Q6J("matMenuTriggerFor",s)}},dependencies:[S.$,w.Hw,W.wG,G.VK,G.OP,G.KA,G.p6]})}return o})();var P=i(6575);function ot(o,_){if(1&o&&(t.TgZ(0,"span",2),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Oqu(e.entities)}}let it=(()=>{class o{agInit(e){Array.isArray(e.value)&&(this.encodedValue=this.htmlEncode(e.value.join(", ")),e.colDef.allowMultiValue&&(this.entities=e.value.length))}refresh(e){return!0}htmlEncode(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-content-items-entity"]],decls:3,vars:3,consts:[[3,"tippy"],["class","more-entities",4,"ngIf"],[1,"more-entities"]],template:function(n,a){1&n&&(t.TgZ(0,"div",0),t.YNc(1,ot,2,1,"span",1),t._uU(2),t.qZA()),2&n&&(t.Q6J("tippy",a.encodedValue),t.xp6(1),t.Q6J("ngIf",a.entities),t.xp6(1),t.hij(" ",a.encodedValue,"\n"))},dependencies:[P.O5,S.$],styles:[".more-entities[_ngcontent-%COMP%]{padding:0 8px;border-radius:10px;border:1px solid rgba(29,39,61,.44);-webkit-user-select:none;user-select:none}"]})}return o})();var at=i(5392);const st=o=>({"hide-until-row-hover":o});function rt(o,_){if(1&o){const e=t.EpF();t.TgZ(0,"div",4),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.openMetadata())}),t.TgZ(1,"mat-icon",5),t._uU(2),t.qZA()()}if(2&o){const e=t.oxw();t.Q6J("ngClass",t.VKq(5,st,!e.metadataCount&&!e.value.metadata))("tippy",e.metadataTooltip),t.xp6(1),t.Q6J("matBadge",e.metadataCount)("matBadgeHidden",!e.metadataCount),t.xp6(1),t.hij("",e.value.metadata?"loyalty":"local_offer"," ")}}function lt(o,_){if(1&o&&(t.TgZ(0,"div",6)(1,"mat-icon",7),t._uU(2),t.qZA()()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("matBadge",e.metadataCount)("matBadgeHidden",!e.metadataCount),t.xp6(1),t.hij("",e.value.metadata?"loyalty":"local_offer"," ")}}let ct=(()=>{class o{agInit(e){this.value=e.value,this.params=e,this.item=e.data,this.disableMetadata=this.item._EditInfo.DisableMetadata,this.metadataCount=this.item.Metadata?.length??0,this.metadataTooltip=this.item.For?`This item is metadata for:\nTarget: ${this.item.For.Target}\nTargetType: ${this.item.For.TargetType}`+(this.item.For.Number?`\nNumber: ${this.item.For.Number}`:"")+(this.item.For.String?`\nString: ${this.item.For.String}`:"")+(this.item.For.Guid?`\nGuid: ${this.item.For.Guid}`:"")+(this.item.For.Title?`\nTitle: ${this.item.For.Title}`:""):"This item is not metadata.",this.metadataTooltip+=`\n\nThis item has ${this.metadataCount>0?this.metadataCount:"no"} other metadata ${1===this.metadataCount?"item":"items"} attached to it.`}refresh(e){return!0}openMetadata(){this.params.onOpenMetadata(this.item)}static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-content-items-status"]],decls:6,vars:4,consts:[[1,"actions-component"],[1,"eav-grid-action-button","icon",3,"tippy"],["class","eav-grid-action-button highlight","matRipple","",3,"ngClass","tippy","click",4,"ngIf"],["class","eav-grid-action-button disabled",4,"ngIf"],["matRipple","",1,"eav-grid-action-button","highlight",3,"ngClass","tippy","click"],["matBadgeColor","accent","matBadgeSize","small","matBadgePosition","below after","aria-hidden","false",3,"matBadge","matBadgeHidden"],[1,"eav-grid-action-button","disabled"],["matBadgeColor","accent","matBadgeSize","small","matBadgeDisabled","true","matBadgePosition","below after","aria-hidden","false",3,"matBadge","matBadgeHidden"]],template:function(n,a){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"mat-icon"),t._uU(3),t.qZA()(),t.YNc(4,rt,3,7,"div",2)(5,lt,3,3,"div",3),t.qZA()),2&n&&(t.xp6(1),t.Q6J("tippy",a.value.published?"Published":"Not published"),t.xp6(2),t.Oqu(a.value.published?"visibility":"visibility_off"),t.xp6(1),t.Q6J("ngIf",!a.disableMetadata),t.xp6(1),t.Q6J("ngIf",a.disableMetadata&&!(!a.metadataCount&&!a.value.metadata)))},dependencies:[P.mk,P.O5,S.$,w.Hw,W.wG,at.k],styles:[".hide-until-row-hover[_ngcontent-%COMP%]{visibility:hidden}  .ag-row-hover .hide-until-row-hover{visibility:visible}"]})}return o})();var R=i(926),H=i(5043),N=i(3317),dt=i(7835),_t=i(1217),ut=i(9097),j=i(8834),mt=i(2611),V=i(7100),gt=i(3188);function ht(o){return _=>{if(!_.value)return null;const e=o.controls.keyType.value,n=_.value.toString();switch(e){case I.Zy.keyTypes.number:return/^[0-9]+$/.test(n)?null:{patternWholeNumber:!0};case I.Zy.keyTypes.guid:const s=["{","}"].some(A=>n.includes(A)),D=n.substring(s?1:0,s?n.length-1:n.length);return(0,gt.M)().test(D)?null:{patternGuid:!0};default:return null}}}var K=i(6861),ft=i(9851),Ct=i(131),B=i(895),yt=i(6355),Tt=i(9293);function vt(o,_){if(1&o&&(t.TgZ(0,"mat-option",25),t._uU(1),t.qZA()),2&o){const e=_.$implicit;t.Q6J("value",e.targetType),t.xp6(1),t.hij(" ",e.label," ")}}function xt(o,_){if(1&o&&(t.TgZ(0,"mat-option",25),t._uU(1),t.qZA()),2&o){const e=t.oxw(2).ngIf;t.Q6J("value",e.formValues.targetType),t.xp6(1),t.hij(" ",e.formValues.targetType," ")}}function Mt(o,_){if(1&o&&(t.TgZ(0,"mat-select",23),t.YNc(1,vt,2,2,"mat-option",12)(2,xt,2,2,"mat-option",24),t.qZA()),2&o){const e=t.oxw().ngIf,n=t.oxw();t.xp6(1),t.Q6J("ngForOf",n.targetTypeOptions),t.xp6(1),t.Q6J("ngIf",e.unknownTargetType)}}function It(o,_){1&o&&t._UZ(0,"input",26)}function Dt(o,_){1&o&&(t.TgZ(0,"app-field-hint",27),t._uU(1," Warning: you entered an unknown target type. This may work or may not. Please be sure you know what you're doing "),t.qZA()),2&o&&t.Q6J("isError",!1)}function Et(o,_){if(1&o&&(t.TgZ(0,"app-field-hint",27),t._uU(1),t.qZA()),2&o){const e=t.oxw().ngIf;t.Q6J("isError",!1),t.xp6(1),t.Oqu(e.targetTypeHint)}}function Ot(o,_){1&o&&(t.TgZ(0,"app-field-hint",27),t._uU(1," This field is required "),t.qZA()),2&o&&t.Q6J("isError",!0)}function At(o,_){1&o&&(t.TgZ(0,"app-field-hint",27),t._uU(1," Must be a whole number "),t.qZA()),2&o&&t.Q6J("isError",!0)}function Pt(o,_){if(1&o&&(t.TgZ(0,"mat-option",25),t._uU(1),t.qZA()),2&o){const e=_.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e," ")}}function bt(o,_){1&o&&(t.TgZ(0,"app-field-hint",27),t._uU(1," This field is required "),t.qZA()),2&o&&t.Q6J("isError",!0)}function Zt(o,_){if(1&o&&(t.TgZ(0,"mat-option",25),t._uU(1),t.qZA()),2&o){const e=_.$implicit;t.Q6J("value",e.StaticName),t.xp6(1),t.hij(" ",e.Label," ")}}function Ut(o,_){if(1&o&&(t.TgZ(0,"mat-form-field",7)(1,"mat-label"),t._uU(2,"Content Type"),t.qZA(),t.TgZ(3,"mat-select",28),t.YNc(4,Zt,2,2,"mat-option",12),t.qZA()()),2&o){const e=t.oxw().ngIf;t.xp6(3),t.Q6J("placeholder",e.contentTypes.length?"":"No items found"),t.xp6(1),t.Q6J("ngForOf",e.contentTypes)}}function Ft(o,_){if(1&o&&(t.TgZ(0,"mat-option",25),t._uU(1),t.qZA()),2&o){const e=_.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",e.name," ")}}function St(o,_){if(1&o&&(t.TgZ(0,"mat-form-field",7)(1,"mat-label"),t._uU(2,"Scope"),t.qZA(),t.TgZ(3,"mat-select",29),t.YNc(4,Ft,2,2,"mat-option",12),t.TgZ(5,"mat-option",25),t._uU(6,"Other..."),t.qZA()()()),2&o){const e=t.oxw().ngIf,n=t.oxw();t.xp6(3),t.Q6J("placeholder",e.scopeOptions.length?"":"No items found"),t.xp6(1),t.Q6J("ngForOf",e.scopeOptions),t.xp6(1),t.Q6J("value",n.dropdownInsertValue)}}function Rt(o,_){1&o&&t.GkF(0)}function Nt(o,_){if(1&o&&(t.TgZ(0,"mat-option",25),t._uU(1),t.qZA()),2&o){const e=_.$implicit;t.Q6J("value",e.Guid),t.xp6(1),t.AsE(" ",e.Title," (",e.Id,") ")}}function Kt(o,_){if(1&o&&(t.TgZ(0,"mat-select",35),t.YNc(1,Nt,2,3,"mat-option",12),t.qZA()),2&o){const e=t.oxw(3).ngIf;t.Q6J("placeholder",e.contentItems.length?"":"No items found"),t.xp6(1),t.Q6J("ngForOf",e.contentItems)}}function Bt(o,_){1&o&&t._UZ(0,"input",36)}function Jt(o,_){if(1&o&&(t.ynx(0),t.YNc(1,Kt,2,2,"mat-select",33)(2,Bt,1,0,"input",34),t.BQk()),2&o){const e=t.oxw(2).ngIf;t.xp6(1),t.Q6J("ngIf",e.guidedKey),t.xp6(1),t.Q6J("ngIf",!e.guidedKey)}}function $t(o,_){if(1&o&&(t.TgZ(0,"mat-option",25),t._uU(1),t.qZA()),2&o){const e=_.$implicit;t.Q6J("value",e.StaticName),t.xp6(1),t.hij(" ",e.Label," ")}}function Lt(o,_){if(1&o&&(t.TgZ(0,"mat-select",35),t.YNc(1,$t,2,2,"mat-option",12),t.qZA()),2&o){const e=t.oxw(3).ngIf;t.Q6J("placeholder",e.contentTypes.length?"":"No items found"),t.xp6(1),t.Q6J("ngForOf",e.contentTypes)}}function wt(o,_){1&o&&t._UZ(0,"input",36)}function Gt(o,_){if(1&o&&(t.ynx(0),t.YNc(1,Lt,2,2,"mat-select",33)(2,wt,1,0,"input",34),t.BQk()),2&o){const e=t.oxw(2).ngIf;t.xp6(1),t.Q6J("ngIf",e.guidedKey),t.xp6(1),t.Q6J("ngIf",!e.guidedKey)}}function kt(o,_){1&o&&t.GkF(0)}function Qt(o,_){if(1&o&&(t.ynx(0),t.YNc(1,kt,1,0,"ng-container",37),t.BQk()),2&o){t.oxw(2);const e=t.MAs(40);t.xp6(1),t.Q6J("ngTemplateOutlet",e)}}function Wt(o,_){if(1&o&&(t.ynx(0,30),t.YNc(1,Jt,3,2,"ng-container",31)(2,Gt,3,2,"ng-container",31)(3,Qt,2,1,"ng-container",32),t.BQk()),2&o){const e=t.oxw().ngIf,n=t.oxw();t.Q6J("ngSwitch",e.formValues.targetType),t.xp6(1),t.Q6J("ngSwitchCase",n.eavConstants.metadata.entity.targetType),t.xp6(1),t.Q6J("ngSwitchCase",n.eavConstants.metadata.contentType.targetType)}}function Ht(o,_){1&o&&t._UZ(0,"input",36)}function Yt(o,_){1&o&&t._UZ(0,"input",39)}function jt(o,_){if(1&o&&t.YNc(0,Ht,1,0,"input",34)(1,Yt,1,0,"input",38),2&o){const e=t.oxw().ngIf,n=t.oxw();t.Q6J("ngIf",e.formValues.keyType!==n.eavConstants.keyTypes.number),t.xp6(1),t.Q6J("ngIf",e.formValues.keyType===n.eavConstants.keyTypes.number)}}const z=o=>({active:o});function Vt(o,_){if(1&o){const e=t.EpF();t.TgZ(0,"div",40)(1,"button",41),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2);return t.KtG(a.toggleGuidedKey(!0))}),t.TgZ(2,"mat-icon",42),t._uU(3,"search"),t.qZA()(),t.TgZ(4,"button",43),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2);return t.KtG(a.toggleGuidedKey(!1))}),t.TgZ(5,"mat-icon",42),t._uU(6,"text_fields"),t.qZA()()()}if(2&o){const e=t.oxw().ngIf;t.xp6(1),t.Q6J("ngClass",t.VKq(2,z,e.guidedKey)),t.xp6(3),t.Q6J("ngClass",t.VKq(4,z,!e.guidedKey))}}function zt(o,_){1&o&&(t.TgZ(0,"app-field-hint",27),t._uU(1," This field is required "),t.qZA()),2&o&&t.Q6J("isError",!0)}function Xt(o,_){1&o&&(t.TgZ(0,"app-field-hint",27),t._uU(1," Must be a whole number "),t.qZA()),2&o&&t.Q6J("isError",!0)}function qt(o,_){1&o&&(t.TgZ(0,"app-field-hint",27),t._uU(1," Must be a valid GUID "),t.qZA()),2&o&&t.Q6J("isError",!0)}function te(o,_){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",1)(2,"div",2)(3,"div",3),t._uU(4,"Create Metadata"),t.qZA()(),t.TgZ(5,"div",4)(6,"p"),t._uU(7," This is a special operation to add an item which is metadata for another item, see "),t.TgZ(8,"a",5),t._uU(9,"docs"),t.qZA(),t._uU(10,". "),t.qZA(),t.TgZ(11,"form",6)(12,"mat-form-field",7)(13,"mat-label"),t._uU(14,"Target"),t.qZA(),t.YNc(15,Mt,3,2,"mat-select",8)(16,It,1,0,"input",9),t.qZA(),t.YNc(17,Dt,2,1,"app-field-hint",10)(18,Et,2,2,"app-field-hint",10)(19,Ot,2,1,"app-field-hint",10)(20,At,2,1,"app-field-hint",10),t.TgZ(21,"mat-form-field",7)(22,"mat-label"),t._uU(23,"Key type"),t.qZA(),t.TgZ(24,"mat-select",11),t.YNc(25,Pt,2,2,"mat-option",12),t.qZA()(),t.YNc(26,bt,2,1,"app-field-hint",10)(27,Ut,5,2,"mat-form-field",13)(28,St,7,3,"mat-form-field",13),t.TgZ(29,"app-field-hint"),t._uU(30," The scope should almost never be changed - "),t.TgZ(31,"a",14),t._uU(32,"see help"),t.qZA()(),t.TgZ(33,"mat-form-field",7)(34,"mat-label"),t._uU(35,"Key"),t.qZA(),t.YNc(36,Rt,1,0,"ng-container",15)(37,Wt,4,3,"ng-template",null,16,t.W1O)(39,jt,2,2,"ng-template",null,17,t.W1O)(41,Vt,7,6,"div",18),t.qZA(),t.YNc(42,zt,2,1,"app-field-hint",10)(43,Xt,2,1,"app-field-hint",10)(44,qt,2,1,"app-field-hint",10),t.qZA()(),t.TgZ(45,"mat-dialog-actions",19)(46,"mat-slide-toggle",20),t.NdJ("change",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.toggleGuidedMode(a))}),t._uU(47),t.qZA(),t.TgZ(48,"div")(49,"button",21),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.closeDialog())}),t._uU(50,"Cancel"),t.qZA(),t.TgZ(51,"button",22),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.confirm())}),t._uU(52," Confirm "),t.qZA()()()(),t.BQk()}if(2&o){const e=_.ngIf,n=t.MAs(38),a=t.MAs(40),s=t.oxw();t.xp6(11),t.Q6J("formGroup",s.form),t.xp6(4),t.Q6J("ngIf",e.guidedMode),t.xp6(1),t.Q6J("ngIf",!e.guidedMode),t.xp6(1),t.Q6J("ngIf",s.form.controls.targetType.touched&&!s.form.controls.targetType.invalid&&e.unknownTargetType),t.xp6(1),t.Q6J("ngIf",e.targetTypeHint),t.xp6(1),t.Q6J("ngIf",s.form.controls.targetType.touched&&(null==s.form.controls.targetType.errors?null:s.form.controls.targetType.errors.required)),t.xp6(1),t.Q6J("ngIf",s.form.controls.targetType.touched&&(null==s.form.controls.targetType.errors?null:s.form.controls.targetType.errors.pattern)),t.xp6(5),t.Q6J("ngForOf",e.keyTypeOptions),t.xp6(1),t.Q6J("ngIf",s.form.controls.keyType.touched&&(null==s.form.controls.keyType.errors?null:s.form.controls.keyType.errors.required)),t.xp6(1),t.Q6J("ngIf",e.guidedMode&&e.formValues.targetType===s.eavConstants.metadata.entity.targetType),t.xp6(1),t.Q6J("ngIf",e.guidedMode&&(e.formValues.targetType===s.eavConstants.metadata.entity.targetType||e.formValues.targetType===s.eavConstants.metadata.contentType.targetType)),t.xp6(8),t.Q6J("ngIf",e.guidedMode)("ngIfThen",n)("ngIfElse",a),t.xp6(5),t.Q6J("ngIf",e.guidedMode&&e.guidedKeyExists),t.xp6(1),t.Q6J("ngIf",s.form.controls.key.touched&&(null==s.form.controls.key.errors?null:s.form.controls.key.errors.required)),t.xp6(1),t.Q6J("ngIf",s.form.controls.key.touched&&(null==s.form.controls.key.errors?null:s.form.controls.key.errors.patternWholeNumber)),t.xp6(1),t.Q6J("ngIf",s.form.controls.key.touched&&(null==s.form.controls.key.errors?null:s.form.controls.key.errors.patternGuid)),t.xp6(2),t.Q6J("tippy",e.guidedMode?"Guided mode helps you select options that work":"Manual mode is for advanced uses and allows you to insert any values")("checked",e.guidedMode),t.xp6(1),t.hij(" ",e.guidedMode?"Guided":"Manual"," "),t.xp6(4),t.Q6J("disabled",!s.form.valid)}}let ee=(()=>{class o extends ut.f{constructor(e,n,a,s){super(),this.dialogRef=e,this.context=n,this.contentItemsService=a,this.contentTypesService=s,this.hostClass="dialog-component",this.eavConstants=I.Zy,this.dropdownInsertValue=j.G}ngOnInit(){this.targetTypeOptions=Object.values(I.Zy.metadata).map(n=>({...n})),this.keyTypeOptions=Object.values(I.Zy.keyTypes),this.keyTypeOptions$=new l.X([]),this.scopeOptions$=new l.X([]),this.guidedMode$=new l.X(!0),this.contentItems$=new l.X([]),this.contentTypes$=new l.X([]),this.guidedKey$=new l.X(!0),this.fetchScopes(),this.form=new C.nJ({}),this.form.addControl("targetType",new C.p4(I.Zy.metadata.entity.targetType,[C.kI.required,C.kI.pattern(/^[0-9]+$/)])),this.form.addControl("keyType",new C.p4(I.Zy.metadata.entity.keyType,[C.kI.required])),this.form.addControl("contentTypeForContentItems",new C.p4(null)),this.form.addControl("scopeForContentTypes",new C.p4(I.Zy.scopes.default.value)),this.form.addControl("key",new C.p4(null,[C.kI.required,ht(this.form)])),this.subscription.add(this.form.controls.scopeForContentTypes.valueChanges.pipe((0,H.O)(this.form.controls.scopeForContentTypes.value),(0,N.x)()).subscribe(n=>{null!=this.form.controls.contentTypeForContentItems.value&&this.form.controls.contentTypeForContentItems.patchValue(null),n===j.G?(n=prompt("This is an advanced feature to show content-types of another scope. Don't use this if you don't know what you're doing, as content-types of other scopes are usually hidden for a good reason.")||I.Zy.scopes.default.value,this.scopeOptions$.value.some(a=>a.value===n)||this.scopeOptions$.next([{name:n,value:n},...this.scopeOptions$.value]),this.form.controls.scopeForContentTypes.patchValue(n)):this.fetchContentTypes(n)})),this.subscription.add((0,dt.T)(this.form.controls.targetType.valueChanges.pipe((0,N.x)()),this.form.controls.keyType.valueChanges.pipe((0,N.x)())).subscribe(()=>{this.guidedKey$.next(!0),null!=this.form.getRawValue().key&&this.form.patchValue({key:null})})),this.subscription.add(this.form.controls.contentTypeForContentItems.valueChanges.pipe((0,H.O)(this.form.controls.contentTypeForContentItems.value),(0,N.x)()).subscribe(n=>{const a=this.form.getRawValue();a.targetType===I.Zy.metadata.entity.targetType&&null!=a.key&&this.form.patchValue({key:null}),this.contentItemsService.getAll(n).subscribe(s=>{this.contentItems$.next(s)})}));const e=this.form.valueChanges.pipe((0,H.O)(this.form.getRawValue()),(0,T.U)(()=>this.form.getRawValue()),(0,N.x)(R.iX.objectsEqual));this.subscription.add((0,d.a)([e,this.guidedMode$]).subscribe(([n,a])=>{const s=this.targetTypeOptions.find(k=>k.targetType===n.targetType),D=a&&s?[s.keyType]:[...this.keyTypeOptions];R.iX.arraysEqual(D,this.keyTypeOptions$.value)||this.keyTypeOptions$.next(D);const M={};this.keyTypeOptions$.value.includes(n.keyType)||(M.keyType=this.keyTypeOptions$.value[0]);const A=a&&n.targetType===I.Zy.metadata.app.targetType;A&&n.key!==this.context.appId&&(M.key=this.context.appId),Object.keys(M).length&&this.form.patchValue(M),R.iX.disableControl(this.form.controls.keyType,a&&this.keyTypeOptions$.value.length<=1),R.iX.disableControl(this.form.controls.key,A)})),this.viewModel$=(0,d.a)([(0,d.a)([this.guidedMode$,this.keyTypeOptions$,this.scopeOptions$,this.contentItems$,this.contentTypes$]),(0,d.a)([e,this.guidedKey$])]).pipe((0,T.U)(([[n,a,s,D,M],[A,J]])=>({guidedMode:n,unknownTargetType:!this.targetTypeOptions.some($=>$.targetType===A.targetType),targetTypeHint:n&&this.targetTypeOptions.find($=>$.targetType===A.targetType)?.hint,keyTypeOptions:a,scopeOptions:s,guidedKey:J,guidedKeyExists:[I.Zy.metadata.entity.targetType,I.Zy.metadata.contentType.targetType].includes(A.targetType),formValues:A,contentItems:D,contentTypes:M})))}ngOnDestroy(){this.guidedMode$.complete(),this.keyTypeOptions$.complete(),this.contentItems$.complete(),this.contentTypes$.complete(),this.guidedKey$.complete(),super.ngOnDestroy()}closeDialog(e){this.dialogRef.close(e)}toggleGuidedKey(e){this.guidedKey$.next(e)}toggleGuidedMode(e){this.guidedMode$.next(e.checked)}confirm(){const e=this.form.getRawValue(),n={target:this.targetTypeOptions.find(a=>a.targetType===e.targetType)?.target,targetType:e.targetType,keyType:e.keyType,key:e.keyType===I.Zy.keyTypes.guid?e.key.replace(/{|}/g,""):e.key.toString()};this.closeDialog(n)}fetchContentTypes(e){this.contentTypesService.retrieveContentTypes(e).subscribe(n=>{this.contentTypes$.next(n)})}fetchScopes(){this.contentTypesService.getScopes().subscribe(e=>{this.scopeOptions$.next(e)})}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(K.so),t.Y36(mt._),t.Y36(V.l),t.Y36(_t.sF))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-create-metadata-dialog"]],hostVars:1,hostBindings:function(n,a){2&n&&t.Ikx("className",a.hostClass)},features:[t.qOj],decls:2,vars:3,consts:[[4,"ngIf"],[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],["href","https://go.2sxc.org/metadata","target","_blank"],[3,"formGroup"],["color","accent",1,"eav-form-field"],["formControlName","targetType","required","",4,"ngIf"],["matInput","","type","number","min","0","formControlName","targetType","required","",4,"ngIf"],[3,"isError",4,"ngIf"],["formControlName","keyType","required",""],[3,"value",4,"ngFor","ngForOf"],["color","accent","class","eav-form-field",4,"ngIf"],["href","https://2sxc.org/help?tag=scope","target","_blank","appClickStopPropagation",""],[4,"ngIf","ngIfThen","ngIfElse"],["specialKeyInputs",""],["defaultKeyInput",""],["matTextSuffix","","class","eav-selection-suffix",4,"ngIf"],[1,"eav-dialog-actions"],["color","accent",3,"tippy","checked","change"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],["formControlName","targetType","required",""],[3,"value",4,"ngIf"],[3,"value"],["matInput","","type","number","min","0","formControlName","targetType","required",""],[3,"isError"],["formControlName","contentTypeForContentItems",3,"placeholder"],["formControlName","scopeForContentTypes",3,"placeholder"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["formControlName","key","required","",3,"placeholder",4,"ngIf"],["matInput","","type","text","formControlName","key","required","",4,"ngIf"],["formControlName","key","required","",3,"placeholder"],["matInput","","type","text","formControlName","key","required",""],[4,"ngTemplateOutlet"],["matInput","","type","number","formControlName","key","required","",4,"ngIf"],["matInput","","type","number","formControlName","key","required",""],["matTextSuffix","",1,"eav-selection-suffix"],["mat-icon-button","","type","button","tippy","Pick existing value",1,"eav-selection-suffix-button",3,"ngClass","click"],[1,"eav-icon"],["mat-icon-button","","type","button","tippy","Manual entry",1,"eav-selection-suffix-button",3,"ngClass","click"]],template:function(n,a){1&n&&(t.YNc(0,te,53,22,"ng-container",0),t.ALo(1,"async")),2&n&&t.Q6J("ngIf",t.lcZ(1,1,a.viewModel$))},dependencies:[P.mk,P.sg,P.O5,P.tP,P.RF,P.n9,P.ED,ft.Y,Ct.E,S.$,K.H8,B.lW,B.RK,w.Hw,C._Y,C.Fj,C.wV,C.JJ,C.JL,C.Q7,C.qQ,Z.Nt,y.KE,y.hX,y.R9,yt.gD,W.ey,C.sg,C.u,Tt.Rr,P.Ov]})}return o})();var X=i(2106);let ne=(()=>{class o{constructor(){this.published="",this.metadata="",this.hasMetadata=""}agInit(e){this.filterParams=e}isFilterActive(){return""!==this.published||""!==this.metadata||""!==this.hasMetadata}doesFilterPass(e){let n=!1,a=!1,s=!1;const M=this.filterParams.valueGetter({api:this.filterParams.api,colDef:this.filterParams.colDef,column:this.filterParams.column,columnApi:this.filterParams.columnApi,context:this.filterParams.context,data:e.node.data,getValue:A=>e.node.data[A],node:e.node});return n=""===this.published||null!=M.published&&M.published.toString()===this.published,a=""===this.metadata||null!=M.metadata&&M.metadata.toString()===this.metadata,s=""===this.hasMetadata||null!=M.hasMetadata&&M.hasMetadata.toString()===this.hasMetadata,n&&a&&s}getModel(){return this.isFilterActive()?{filterType:"pub-meta",published:this.published,metadata:this.metadata,hasMetadata:this.hasMetadata}:void 0}setModel(e){this.published=e?e.published:"",this.metadata=e?e.metadata:"",this.hasMetadata=e?e.hasMetadata:""}afterGuiAttached(e){}filterChanged(){this.filterParams.filterChangedCallback()}static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-pub-meta-filter"]],decls:27,vars:3,consts:[[1,"title"],[3,"ngModel","ngModelChange"],["value",""],["value","true"],["value","false"]],template:function(n,a){1&n&&(t.TgZ(0,"div",0),t._uU(1,"Published"),t.qZA(),t.TgZ(2,"mat-radio-group",1),t.NdJ("ngModelChange",function(D){return a.published=D})("ngModelChange",function(){return a.filterChanged()}),t.TgZ(3,"mat-radio-button",2),t._uU(4,"All"),t.qZA(),t.TgZ(5,"mat-radio-button",3),t._uU(6,"Published"),t.qZA(),t.TgZ(7,"mat-radio-button",4),t._uU(8,"Not published"),t.qZA()(),t.TgZ(9,"div",0),t._uU(10,"Is Metadata"),t.qZA(),t.TgZ(11,"mat-radio-group",1),t.NdJ("ngModelChange",function(D){return a.metadata=D})("ngModelChange",function(){return a.filterChanged()}),t.TgZ(12,"mat-radio-button",2),t._uU(13,"All"),t.qZA(),t.TgZ(14,"mat-radio-button",3),t._uU(15,"Is metadata"),t.qZA(),t.TgZ(16,"mat-radio-button",4),t._uU(17,"Is not metadata"),t.qZA()(),t.TgZ(18,"div",0),t._uU(19,"Has Metadata"),t.qZA(),t.TgZ(20,"mat-radio-group",1),t.NdJ("ngModelChange",function(D){return a.hasMetadata=D})("ngModelChange",function(){return a.filterChanged()}),t.TgZ(21,"mat-radio-button",2),t._uU(22,"All"),t.qZA(),t.TgZ(23,"mat-radio-button",3),t._uU(24,"Has metadata"),t.qZA(),t.TgZ(25,"mat-radio-button",4),t._uU(26,"Has no metadata"),t.qZA()()),2&n&&(t.xp6(2),t.Q6J("ngModel",a.published),t.xp6(9),t.Q6J("ngModel",a.metadata),t.xp6(9),t.Q6J("ngModel",a.hasMetadata))},dependencies:[C.JJ,C.On,X.VQ,X.U0],styles:[".title[_ngcontent-%COMP%]{padding:12px 12px 0}.mat-mdc-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;overflow:hidden;padding:12px;width:160px;height:104px}"]})}return o})();var oe=i(1092),Y=i(91),ie=i(9409),ae=i(2849),se=i(40),re=i(8621),le=i(6537);function ce(o,_){1&o&&(t._UZ(0,"div",18),t.ALo(1,"safeHtml")),2&o&&t.Q6J("innerHTML",t.lcZ(1,1,_.ngIf),t.oJD)}function pe(o,_){if(1&o){const e=t.EpF();t.TgZ(0,"button",19),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2);return t.KtG(a.debugFilter())}),t.TgZ(1,"mat-icon",12),t._uU(2,"filter_list"),t.qZA(),t.TgZ(3,"span"),t._uU(4,"Filter"),t.qZA()()}}function de(o,_){if(1&o){const e=t.EpF();t.TgZ(0,"div",1)(1,"div",2)(2,"div",3),t._uU(3),t.qZA(),t.TgZ(4,"button",4),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.closeDialog())}),t.TgZ(5,"mat-icon"),t._uU(6,"close"),t.qZA()()(),t.TgZ(7,"div",5),t._UZ(8,"router-outlet"),t.YNc(9,ce,2,3,"div",6),t.TgZ(10,"div",7)(11,"ag-grid-angular",8),t.NdJ("gridReady",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.onGridReady(a))})("filesDropped",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.filesDropped(a))}),t.qZA()()(),t.TgZ(12,"mat-dialog-actions",9)(13,"div",10)(14,"button",11),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.exportContent())}),t.TgZ(15,"mat-icon",12),t._uU(16,"cloud_download"),t.qZA(),t.TgZ(17,"span"),t._uU(18,"Data"),t.qZA()(),t.TgZ(19,"button",13),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.importContent())}),t.TgZ(20,"mat-icon",12),t._uU(21,"cloud_upload"),t.qZA(),t.TgZ(22,"span"),t._uU(23,"Data"),t.qZA()(),t.TgZ(24,"button",14),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.importItem())}),t.TgZ(25,"mat-icon",12),t._uU(26,"cloud_upload"),t.qZA(),t.TgZ(27,"span"),t._uU(28,"Item"),t.qZA()(),t.TgZ(29,"button",15),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.createMetadata())}),t.TgZ(30,"mat-icon",12),t._uU(31,"local_offer"),t.qZA(),t.TgZ(32,"span"),t._uU(33,"Create Metadata"),t.qZA()(),t.YNc(34,pe,5,0,"button",16),t.qZA(),t.TgZ(35,"button",17),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.editItem(null))}),t.TgZ(36,"mat-icon"),t._uU(37,"add"),t.qZA()()()()}if(2&o){const e=_.ngIf,n=t.oxw();t.xp6(3),t.hij(" ",e.contentType.Label||e.contentType.Name," Data "),t.xp6(6),t.Q6J("ngIf",null==e.contentType||null==e.contentType.Properties?null:e.contentType.Properties.ListInstructions),t.xp6(2),t.Q6J("rowData",e.items)("gridOptions",n.gridOptions)("allowedFileTypes","xml,json"),t.xp6(23),t.Q6J("ngIf",e.debugEnabled)}}let _e=(()=>{class o extends c.H{constructor(e,n,a,s,D,M,A,J,k,$,ue,me){super(e,n),this.router=e,this.route=n,this.dialogRef=a,this.contentTypesService=s,this.contentItemsService=D,this.entitiesService=M,this.contentExportService=A,this.snackBar=J,this.globalConfigService=k,this.dialog=$,this.viewContainerRef=ue,this.changeDetectorRef=me,this.contentType$=new r.x,this.items$=new l.X(void 0),this.gridOptions={...b.f},this.gridApi$=new l.X(null),this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName")}ngOnInit(){this.fetchContentType(),this.fetchItems(),this.fetchColumns(),this.subscription.add(this.refreshOnChildClosedShallow().subscribe(()=>{this.fetchItems()})),this.viewModel$=(0,d.a)([this.contentType$,this.items$,this.globalConfigService.getDebugEnabled$()]).pipe((0,T.U)(([e,n,a])=>({contentType:e,items:n,debugEnabled:a})))}ngOnDestroy(){this.contentType$.complete(),this.items$.complete(),this.gridApi$.complete(),super.ngOnDestroy()}closeDialog(){this.dialogRef.close()}onGridReady(e){this.gridApi$.next(e.api)}fetchContentType(){this.contentTypesService.retrieveContentType(this.contentTypeStaticName).subscribe(e=>{this.contentType$.next(e)})}fetchItems(){this.contentItemsService.getAll(this.contentTypeStaticName).subscribe(e=>{this.items$.next(e)})}fetchColumns(){this.contentItemsService.getColumns(this.contentTypeStaticName).subscribe(e=>{const n=this.buildColumnDefs(e),a=function pt(o,_){if(!o)return;let e;"="===o.charAt(o.length-1)&&(o=atob(o));try{e=JSON.parse(o)}catch{console.error("Can't parse JSON with filters from url:",o)}if(!e)return;const n={};return(e.IsPublished||e.IsMetadata)&&(n.Status={filterType:"pub-meta",published:e.IsPublished??"",metadata:e.IsMetadata??"",hasMetadata:""}),Object.entries(e).filter(([a,s])=>"IsPublished"!==a&&"IsMetadata"!==a).forEach(([a,s])=>{if(_.find(M=>M.headerName===a)?.filter!==U){if("string"==typeof s)n[a]={filterType:"text",type:"equals",filter:s};else if("number"==typeof s)n[a]={filterType:"number",type:"equals",filter:s,filterTo:null};else if("boolean"==typeof s){const M={filterType:"boolean",filter:s.toString()};n[a]=M}}else{const M={filterType:"entity",filter:"string"==typeof(s=R.iX.tryParse(s)??s)?s:void 0,idFilter:"number"==typeof s?[s]:Array.isArray(s)?s.filter(A=>"number"==typeof A):void 0};n[a]=M}}),n}(sessionStorage.getItem(L.JA),n);this.gridApi$.value?this.setColumnDefs(n,a):this.gridApi$.pipe((0,f.h)(s=>null!=s),(0,m.q)(1)).subscribe(s=>{this.setColumnDefs(n,a)})})}setColumnDefs(e,n){this.gridApi$.value.setColumnDefs(e),n&&((0,tt.P)("Will try to apply filter:",n),this.gridApi$.value.setFilterModel(n))}openMetadata(e){const n=h.U.getUrlEntity(e.Guid,`Metadata for Entity: ${e._Title} (${e.Id})`,this.contentTypeStaticName);this.router.navigate([n],{relativeTo:this.route})}editItem(e){const a=(0,Q.f)({items:[null==e?{ContentTypeName:this.contentTypeStaticName}:{EntityId:e.Id}]});this.router.navigate([`edit/${a}`],{relativeTo:this.route})}exportContent(){const e=this.gridApi$.value.getFilterModel(),n=Object.keys(e).length>0,a=[];n&&this.gridApi$.value.forEachNodeAfterFilterAndSort(s=>{a.push(s.data.Id)}),this.router.navigate([`export/${this.contentTypeStaticName}${a.length>0?`/${a}`:""}`],{relativeTo:this.route})}filesDropped(e){const n=e[0];switch(n.name.substring(n.name.lastIndexOf(".")+1).toLocaleLowerCase()){case"xml":this.importContent(e);break;case"json":this.importItem(e)}}importContent(e){this.router.navigate([`${this.contentTypeStaticName}/import`],{relativeTo:this.route,state:{files:e}})}importItem(e){this.router.navigate(["import"],{relativeTo:this.route,state:{files:e}})}createMetadata(){this.dialog.open(ee,{autoFocus:!1,viewContainerRef:this.viewContainerRef,width:"650px"}).afterClosed().subscribe(n=>{if(null==n)return;const a={items:[{ContentTypeName:this.contentTypeStaticName,For:{Target:n.target??n.targetType.toString(),TargetType:n.targetType,...n.keyType===I.Zy.keyTypes.guid&&{Guid:n.key},...n.keyType===I.Zy.keyTypes.number&&{Number:parseInt(n.key,10)},...n.keyType===I.Zy.keyTypes.string&&{String:n.key}}}]},s=(0,Q.f)(a);this.router.navigate([`edit/${s}`],{relativeTo:this.route}),this.changeDetectorRef.markForCheck()})}debugFilter(){console.warn("Current filter:",this.gridApi$.value.getFilterModel()),this.snackBar.open("Check console for filter information",void 0,{duration:3e3})}buildColumnDefs(e){const n=[{headerName:"ID",field:"Id",width:70,headerClass:"dense",sortable:!0,filter:"agNumberColumnFilter",cellClass:a=>("id-action no-padding no-outline "+(a.data._EditInfo.ReadOnly?"disabled":"")).split(" "),valueGetter:a=>a.data.Id,cellRenderer:q.m,cellRendererParams:{tooltipGetter:s=>`ID: ${s.Id}\nRepoID: ${s._RepositoryId}\nGUID: ${s.Guid}`}},{field:"Status",width:82,headerClass:"dense",cellClass:"secondary-action no-padding".split(" "),filter:ne,valueGetter:a=>{const s=a.data;return{published:s.IsPublished,metadata:!!s.For,hasMetadata:!!s.Metadata&&s.Metadata.length>0}},cellRenderer:ct,cellRendererParams:(()=>({onOpenMetadata:s=>this.openMetadata(s)}))()},{headerName:"Item (Entity)",field:"_Title",flex:2,minWidth:250,cellClass:"primary-action highlight".split(" "),sortable:!0,filter:"agTextColumnFilter",onCellClicked:a=>{this.editItem(a.data)},valueGetter:a=>a.data._Title},{headerName:"Stats",headerTooltip:"Used by others / uses others",field:"_Used",width:70,headerClass:"dense",cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:a=>{const s=a.data;return`${s._Used} / ${s._Uses}`}},{cellClass:"secondary-action no-padding".split(" "),width:122,pinned:"right",cellRenderer:nt,cellRendererParams:(()=>({onClone:s=>this.clone(s),onExport:s=>this.export(s),onDelete:s=>this.delete(s)}))()}];for(const a of e){const s={headerName:a.StaticName,field:a.StaticName,flex:2,minWidth:250,cellClass:"no-outline",sortable:!0};switch(a.Type){case g.Q.Entity:s.allowMultiValue=a.Metadata?.Entity?.AllowMultiValue??!0,s.cellRenderer=it,s.valueGetter=this.valueGetterEntityField,s.filter=U;break;case g.Q.DateTime:s.useTimePicker=a.Metadata?.DateTime?.UseTimePicker??!1,s.valueGetter=this.valueGetterDateTime,s.filter="agTextColumnFilter";break;case g.Q.Boolean:s.valueGetter=this.valueGetterBoolean,s.filter=E.U;break;case g.Q.Number:s.filter="agNumberColumnFilter";break;default:s.filter="agTextColumnFilter"}n.push(s)}return n}clone(e){const a=(0,Q.f)({items:[{ContentTypeName:this.contentTypeStaticName,DuplicateEntity:e.Id}]});this.router.navigate([`edit/${a}`],{relativeTo:this.route})}export(e){this.contentExportService.exportEntity(e.Id,this.contentTypeStaticName,!0)}delete(e){confirm(`Delete '${e._Title}' (${e._RepositoryId})?`)&&(this.snackBar.open("Deleting..."),this.entitiesService.delete(this.contentTypeStaticName,e._RepositoryId,!1).subscribe({next:()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchItems()},error:n=>{this.snackBar.dismiss(),confirm(`${n.error.ExceptionMessage}\n\nDo you want to force delete '${e._Title}' (${e._RepositoryId})?`)&&(this.snackBar.open("Deleting..."),this.entitiesService.delete(this.contentTypeStaticName,e._RepositoryId,!0).subscribe(()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchItems()}))}}))}valueGetterEntityField(e){const n=e.data[e.colDef.field];return 0===n.length?null:n.map(a=>a.Title)}valueGetterDateTime(e){const n=e.data[e.colDef.field];return n?e.colDef.useTimePicker?n.replace("T"," ").replace("Z",""):n.split("T")[0]:null}valueGetterBoolean(e){const n=e.data[e.colDef.field];return"boolean"!=typeof n?null:n.toString()}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(Y.F0),t.Y36(Y.gz),t.Y36(K.so),t.Y36(p.s),t.Y36(V.l),t.Y36(oe.g),t.Y36(x.i),t.Y36(ie.ux),t.Y36(u.bE),t.Y36(K.uw),t.Y36(t.s_b),t.Y36(t.sBO))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-content-items"]],features:[t.qOj],decls:2,vars:3,consts:[["appToggleDebug","","class","eav-dialog nav-component-wrapper",4,"ngIf"],["appToggleDebug","",1,"eav-dialog","nav-component-wrapper"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"eav-dialog-content","nav-component-wrapper"],[3,"innerHTML",4,"ngIf"],[1,"grid-wrapper"],["appDragAndDrop","",1,"ag-theme-material",3,"rowData","gridOptions","allowedFileTypes","gridReady","filesDropped"],[1,"eav-dialog-actions"],[1,"eav-dialog-actions-div"],["mat-button","","tippy","Export xml list",1,"eav-button__with-icon",3,"click"],[1,"eav-icon"],["mat-button","","tippy","Import xml list",1,"eav-button__with-icon",3,"click"],["mat-button","","tippy","Import single json item",1,"eav-button__with-icon",3,"click"],["mat-button","","tippy","Create metadata",1,"eav-button__with-icon",3,"click"],["mat-button","","class","eav-button__with-icon","color","accent","tippy","Print filter to console",3,"click",4,"ngIf"],["mat-fab","","mat-elevation-z24","","tippy","Add item",1,"grid-fab",3,"click"],[3,"innerHTML"],["mat-button","","color","accent","tippy","Print filter to console",1,"eav-button__with-icon",3,"click"]],template:function(n,a){1&n&&(t.YNc(0,de,38,6,"div",0),t.ALo(1,"async")),2&n&&t.Q6J("ngIf",t.lcZ(1,1,a.viewModel$))},dependencies:[P.O5,Y.lC,ae.z,se.D,S.$,K.H8,B.lW,B.RK,B.cs,w.Hw,re.N8,P.Ov,le.z]})}return o})()},4173:(O,v,i)=>{i.d(v,{H:()=>x,a:()=>g});var r=i(1891),l=i(4980),d=i(7503),T=i(2611),f=i(9039),m=i(4860),p=i(6232);const x="admin/app/";let g=(()=>{class u{constructor(c,E,t){this.http=c,this.context=E,this.dnnContext=t}importApp(c,E,t=!1){const y=new FormData;return y.append("File",c),y.append("Name",E??""),this.http.post(this.dnnContext.$2sxc.http.apiUrl(x+"Import"),y,{params:{zoneId:this.context.zoneId.toString()}}).pipe((0,r.w)(C=>{if(t&&C.Messages[0]?.MessageType===d.DS.Warning){const Z=prompt(C.Messages[0].Text+" Would you like to install it using another folder name?");if(Z)return this.importApp(c,Z,!0)}return(0,l.of)(C)}))}static#t=this.\u0275fac=function(E){return new(E||u)(f.LFG(m.eN),f.LFG(T._),f.LFG(p._y))};static#e=this.\u0275prov=f.Yz7({token:u,factory:u.\u0275fac})}return u})()},6041:(O,v,i)=>{i.d(v,{H:()=>x});var r=i(91),l=i(4520),d=i(5043),T=i(9736),f=i(9422),m=i(9097),p=i(9039);let x=(()=>{class g extends m.f{constructor(h,c){super(),this.router=h,this.route=c}ngOnDestroy(){super.ngOnDestroy()}refreshOnChildClosedDeep(){return this.router.events.pipe((0,l.h)(h=>h instanceof r.m2),(0,d.O)(!!this.route.snapshot.firstChild.firstChild),(0,T.U)(()=>!!this.route.snapshot.firstChild.firstChild),(0,f.G)(),(0,l.h)(([h,c])=>h&&!c))}refreshOnChildClosedShallow(){return this.router.events.pipe((0,l.h)(h=>h instanceof r.m2),(0,d.O)(!!this.route.snapshot.firstChild),(0,T.U)(()=>!!this.route.snapshot.firstChild),(0,f.G)(),(0,l.h)(([h,c])=>h&&!c))}static#t=this.\u0275fac=function(c){return new(c||g)(p.Y36(r.F0),p.Y36(r.gz))};static#e=this.\u0275dir=p.lG2({type:g,features:[p.qOj]})}return g})()},8730:(O,v,i)=>{i.d(v,{U:()=>T});var r=i(9039),l=i(8849),d=i(2106);let T=(()=>{class f{constructor(){this.filter=""}agInit(p){this.filterParams=p}isFilterActive(){return""!==this.filter}doesFilterPass(p){const g=this.filterParams.valueGetter({api:this.filterParams.api,colDef:this.filterParams.colDef,column:this.filterParams.column,columnApi:this.filterParams.columnApi,context:this.filterParams.context,data:p.node.data,getValue:u=>p.node.data[u],node:p.node});return null!=g&&g.toString()===this.filter}getModel(){if(this.isFilterActive())return{filterType:"boolean",filter:this.filter}}setModel(p){this.filter=p?p.filter:""}afterGuiAttached(p){}filterChanged(){this.filterParams.filterChangedCallback()}static#t=this.\u0275fac=function(x){return new(x||f)};static#e=this.\u0275cmp=r.Xpm({type:f,selectors:[["app-boolean-filter"]],decls:7,vars:1,consts:[[3,"ngModel","ngModelChange"],["value",""],["value","true"],["value","false"]],template:function(x,g){1&x&&(r.TgZ(0,"mat-radio-group",0),r.NdJ("ngModelChange",function(h){return g.filter=h})("ngModelChange",function(){return g.filterChanged()}),r.TgZ(1,"mat-radio-button",1),r._uU(2,"All"),r.qZA(),r.TgZ(3,"mat-radio-button",2),r._uU(4,"True"),r.qZA(),r.TgZ(5,"mat-radio-button",3),r._uU(6,"False"),r.qZA()()),2&x&&r.Q6J("ngModel",g.filter)},dependencies:[l.JJ,l.On,d.VQ,d.U0],styles:[".mat-mdc-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;overflow:hidden;padding:12px;width:160px;height:104px}"]})}return f})()},9851:(O,v,i)=>{i.d(v,{Y:()=>h});var r=i(9039),l=i(6575),d=i(1268);function T(c,E){1&c&&r.GkF(0)}function f(c,E){if(1&c&&(r.TgZ(0,"mat-hint"),r.YNc(1,T,1,0,"ng-container",3),r.qZA()),2&c){r.oxw();const t=r.MAs(4);r.xp6(1),r.Q6J("ngTemplateOutlet",t)}}function m(c,E){1&c&&r.GkF(0)}function p(c,E){if(1&c&&(r.TgZ(0,"mat-error"),r.YNc(1,m,1,0,"ng-container",3),r.qZA()),2&c){r.oxw();const t=r.MAs(4);r.xp6(1),r.Q6J("ngTemplateOutlet",t)}}function x(c,E){1&c&&r.Hsn(0)}const g=c=>({"hint-box__short":c}),u=["*"];let h=(()=>{class c{constructor(){this.isError=!1,this.isShort=!0}toggleIsShort(){this.isShort=!this.isShort}static#t=this.\u0275fac=function(y){return new(y||c)};static#e=this.\u0275cmp=r.Xpm({type:c,selectors:[["app-field-hint"]],inputs:{isError:"isError"},ngContentSelectors:u,decls:5,vars:6,consts:[[1,"hint-box",3,"ngClass","ngSwitch","click"],[4,"ngSwitchCase"],["content",""],[4,"ngTemplateOutlet"]],template:function(y,C){1&y&&(r.F$t(),r.TgZ(0,"div",0),r.NdJ("click",function(){return C.toggleIsShort()}),r.YNc(1,f,2,1,"mat-hint",1)(2,p,2,1,"mat-error",1),r.qZA(),r.YNc(3,x,1,0,"ng-template",null,2,r.W1O)),2&y&&(r.Q6J("ngClass",r.VKq(4,g,C.isShort))("ngSwitch",C.isError),r.xp6(1),r.Q6J("ngSwitchCase",!1),r.xp6(1),r.Q6J("ngSwitchCase",!0))},dependencies:[l.mk,l.tP,l.RF,l.n9,d.bx,d.TO],styles:[".hint-box[_ngcontent-%COMP%]{margin-top:4px}.hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{font-size:12px;display:block}.hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]})}return c})()},5253:(O,v,i)=>{i.d(v,{m:()=>g});var r=i(4472),l=i(9039),d=i(9409),T=i(6575),f=i(257),m=i(6515),p=i(9498);const x=(u,h)=>({"align-start":u,"align-end":h});let g=(()=>{class u{constructor(c){this.snackBar=c}agInit(c){this.id=c.value,this.align="number"==typeof this.id?"end":"start",this.tooltip=c.tooltipGetter(c.data)}refresh(c){return!0}copy(){(0,r.v)(this.tooltip),this.snackBar.open("Copied to clipboard",null,{duration:2e3})}static#t=this.\u0275fac=function(E){return new(E||u)(l.Y36(d.ux))};static#e=this.\u0275cmp=l.Xpm({type:u,selectors:[["app-id-field"]],decls:5,vars:6,consts:[["matRipple","",1,"id-box","highlight",3,"tippy","ngClass","click"],[1,"id"],[1,"icon"]],template:function(E,t){1&E&&(l.TgZ(0,"div",0),l.NdJ("click",function(){return t.copy()}),l.TgZ(1,"span",1),l._uU(2),l.qZA(),l.TgZ(3,"mat-icon",2),l._uU(4,"file_copy"),l.qZA()()),2&E&&(l.Q6J("tippy",t.tooltip)("ngClass",l.WLB(3,x,"start"===t.align,"end"===t.align)),l.xp6(2),l.Oqu(t.id))},dependencies:[T.mk,f.wG,m.Hw,p.$],styles:[".id-box[_ngcontent-%COMP%]{padding:0 8px;height:100%;display:flex;align-items:center}.id-box.align-start[_ngcontent-%COMP%]{justify-content:flex-start}.id-box.align-end[_ngcontent-%COMP%]{justify-content:flex-end}.id-box[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{max-width:100%;text-overflow:ellipsis;overflow:hidden}.id-box[_ngcontent-%COMP%]:hover{text-decoration:none}.id-box[_ngcontent-%COMP%]:hover   .id[_ngcontent-%COMP%]{display:none}.id-box[_ngcontent-%COMP%]:not(:hover)   .icon[_ngcontent-%COMP%]{display:none}"]})}return u})()},6433:(O,v,i)=>{i.d(v,{f:()=>r});const r={accentedSort:!0,animateRows:!0,enableCellTextSelection:!0,headerHeight:32,suppressScrollOnNewData:!0,valueCache:!0,defaultColDef:{filterParams:{newRowsAction:"keep"}},tooltipShowDelay:0,tooltipHideDelay:1e5,suppressMovableColumns:!0}},131:(O,v,i)=>{i.d(v,{E:()=>l});var r=i(9039);let l=(()=>{class d{onClick(f){f.stopPropagation()}static#t=this.\u0275fac=function(m){return new(m||d)};static#e=this.\u0275dir=r.lG2({type:d,selectors:[["","appClickStopPropagation",""]],hostBindings:function(m,p){1&m&&r.NdJ("click",function(g){return p.onClick(g)})}})}return d})()},40:(O,v,i)=>{i.d(v,{D:()=>d});var r=i(3488),l=i(9039);let d=(()=>{class T{constructor(m){this.globalConfigService=m}onClick(m){(navigator.platform.match("Mac")?m.metaKey:m.ctrlKey)&&m.shiftKey&&m.altKey&&(this.globalConfigService.toggleDebugEnabled(),window.getSelection().removeAllRanges())}static#t=this.\u0275fac=function(p){return new(p||T)(l.Y36(r.bE))};static#e=this.\u0275dir=l.lG2({type:T,selectors:[["","appToggleDebug",""]],hostBindings:function(p,x){1&p&&l.NdJ("click",function(u){return x.onClick(u)})}})}return T})()},4472:(O,v,i)=>{function r(l){const d=document.createElement("textarea");d.value=l,d.setAttribute("readonly",""),d.style.position="absolute",d.style.left="-9999px",document.body.appendChild(d);const T=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);d.select(),document.execCommand("copy"),document.body.removeChild(d),T&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(T))}i.d(v,{v:()=>r})}}]);
//# sourceMappingURL=https://sources.2sxc.org/17.00.00/dist/ng-edit/projects_eav-ui_src_app_content-items_content-items_component_ts.b33dd42011d7ea24.js.map