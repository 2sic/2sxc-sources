"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["default-projects_eav-ui_src_app_shared_components_file-upload-dialog_index_ts"],{9399:(v,g,i)=>{i.d(g,{U:()=>S});var n=i(6861),p=i(8071),D=i(3839),u=i(9736),T=i(1527),d=i(9097),C=i(5101),e=i(9039),_=i(9409),r=i(6575),m=i(3910),c=i(895),h=i(2849),x=i(9498),E=i(6537);const U=["installerWindow"];function A(s,l){1&s&&e._UZ(0,"mat-spinner",16)}function M(s,l){1&s&&(e.TgZ(0,"div"),e._uU(1,"Select or drop file"),e.qZA())}function y(s,l){if(1&s&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&s){const t=l.$implicit;e.xp6(1),e.Oqu(t.name)}}function O(s,l){if(1&s){const t=e.EpF();e.TgZ(0,"button",17),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.showAppCatalog())}),e._uU(1," Get recommended Apps from Catalog "),e.qZA()}}function I(s,l){1&s&&(e.TgZ(0,"div",22),e._uU(1," Upload succeeded. See the messages below for more information. "),e.qZA())}function F(s,l){1&s&&(e.TgZ(0,"div",23),e._uU(1," Upload failed. See the messages below for more information. "),e.qZA())}const P=(s,l,t)=>({"sxc-message-warning":s,"sxc-message-success":l,"sxc-message-error":t});function b(s,l){if(1&s&&(e.TgZ(0,"div",24),e._uU(1),e.qZA()),2&s){const t=l.$implicit,a=e.oxw(3);e.Q6J("ngClass",e.kEZ(2,P,t.MessageType===a.FileUploadMessageTypes.Warning,t.MessageType===a.FileUploadMessageTypes.Success,t.MessageType===a.FileUploadMessageTypes.Error)),e.xp6(1),e.hij(" ",t.Text," ")}}function Z(s,l){if(1&s&&(e.TgZ(0,"div",18),e.YNc(1,I,2,0,"div",19)(2,F,2,0,"div",20)(3,b,2,6,"div",21),e.qZA()),2&s){const t=e.oxw().ngIf;e.xp6(1),e.Q6J("ngIf",t.result.Success),e.xp6(1),e.Q6J("ngIf",!t.result.Success),e.xp6(1),e.Q6J("ngForOf",t.result.Messages)}}function w(s,l){1&s&&e._UZ(0,"iframe",25,26)}function B(s,l){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",28),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(3);return e.KtG(o.closeDialog())}),e._uU(2,"Cancel"),e.qZA(),e.TgZ(3,"button",29),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(3);return e.KtG(o.upload())}),e._uU(4," Upload "),e.qZA(),e.BQk()}if(2&s){const t=e.oxw(2).ngIf;e.xp6(3),e.Q6J("disabled",!t.files.length||t.uploading||!!t.result)}}function L(s,l){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",30),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(3);return e.KtG(o.closeDialog(!0))}),e._uU(2,"Close"),e.qZA(),e.BQk()}}function K(s,l){if(1&s&&(e.TgZ(0,"mat-dialog-actions",27),e.YNc(1,B,5,1,"ng-container",8)(2,L,3,0,"ng-container",8),e.qZA()),2&s){const t=e.oxw().ngIf;e.xp6(1),e.Q6J("ngIf",!(null!=t.result&&t.result.Success)),e.xp6(1),e.Q6J("ngIf",null==t.result?null:t.result.Success)}}function R(s,l){if(1&s){const t=e.EpF();e.TgZ(0,"div",1),e.NdJ("filesDropped",function(o){e.CHM(t);const f=e.oxw();return e.KtG(f.filesDropped(o))}),e.TgZ(1,"div",2),e._UZ(2,"div",3),e.ALo(3,"safeHtml"),e.qZA(),e.TgZ(4,"div",4),e.YNc(5,A,1,0,"mat-spinner",5),e._UZ(6,"p",6),e.ALo(7,"safeHtml"),e.TgZ(8,"div")(9,"button",7),e.NdJ("click",function(){e.CHM(t);const o=e.MAs(13);return e.KtG(o.click())}),e.YNc(10,M,2,0,"div",8)(11,y,2,1,"div",9),e.qZA(),e.TgZ(12,"input",10,11),e.NdJ("change",function(o){e.CHM(t);const f=e.oxw();return e.KtG(f.filesChanged(o))}),e.qZA(),e.YNc(14,O,2,0,"button",12),e.qZA(),e.YNc(15,Z,4,3,"div",13)(16,w,2,0,"iframe",14),e.qZA(),e.YNc(17,K,3,2,"mat-dialog-actions",15),e.qZA()}if(2&s){const t=l.ngIf,a=e.oxw();e.Q6J("allowedFileTypes",a.dialogData.allowedFileTypes),e.xp6(2),e.Q6J("innerHtml",e.lcZ(3,11,a.dialogData.title),e.oJD),e.xp6(3),e.Q6J("ngIf",t.uploading),e.xp6(1),e.Q6J("innerHtml",e.lcZ(7,13,a.dialogData.description),e.oJD),e.xp6(3),e.Q6J("disabled",t.uploading),e.xp6(1),e.Q6J("ngIf",!t.files.length),e.xp6(1),e.Q6J("ngForOf",t.files),e.xp6(3),e.Q6J("ngIf",a.uploadType==a.UploadTypes.App),e.xp6(1),e.Q6J("ngIf",t.result),e.xp6(1),e.Q6J("ngIf",a.uploadType==a.UploadTypes.App&&t.showAppCatalog),e.xp6(1),e.Q6J("ngIf",!t.showAppCatalog)}}let S=(()=>{class s extends d.f{constructor(t,a,o){super(),this.dialogData=t,this.dialogRef=a,this.snackBar=o,this.hostClass="dialog-component",this.uploading$=new p.X(!1),this.files$=new p.X([]),this.result$=new p.X(void 0),this.FileUploadMessageTypes=C.D,this.UploadTypes=C.p,this.showAppCatalog$=new p.X(!1)}ngOnInit(){this.subscription.add(this.files$.subscribe(()=>{void 0!==this.result$.value&&this.result$.next(void 0)})),null!=this.dialogData.files&&this.filesDropped(this.dialogData.files),this.viewModel$=(0,D.a)([this.uploading$,this.files$,this.result$,this.showAppCatalog$]).pipe((0,u.U)(([t,a,o,f])=>({uploading:t,files:a,result:o,showAppCatalog:f})))}ngOnDestroy(){this.uploading$.complete(),this.files$.complete(),this.result$.complete(),super.ngOnDestroy()}closeDialog(t){this.dialogRef.close(t)}filesDropped(t){this.setFiles(t),this.upload()}filesChanged(t){const o=Array.from(t.target.files);this.setFiles(o)}upload(){this.uploading$.next(!0),this.subscription.add(this.dialogData.upload$(this.files$.value).pipe((0,T.q)(1)).subscribe({next:t=>{this.uploading$.next(!1),this.result$.next(t)},error:()=>{this.uploading$.next(!1),this.result$.next(void 0),this.snackBar.open("Upload failed. Please check console for more information",void 0,{duration:3e3})}}))}showAppCatalog(){this.showAppCatalog$.next(!this.showAppCatalog$.value)}setFiles(t){this.dialogData.multiple||(t=t.slice(0,1)),this.files$.next(t)}static#e=this.\u0275fac=function(a){return new(a||s)(e.Y36(n.WI),e.Y36(n.so),e.Y36(_.ux))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-file-upload-dialog"]],viewQuery:function(a,o){if(1&a&&e.Gf(U,5),2&a){let f;e.iGM(f=e.CRH())&&(o.installerWindow=f.first)}},hostVars:1,hostBindings:function(a,o){2&a&&e.Ikx("className",o.hostClass)},inputs:{uploadType:"uploadType"},features:[e.qOj],decls:2,vars:3,consts:[["class","eav-dialog","appDragAndDrop","",3,"allowedFileTypes","filesDropped",4,"ngIf"],["appDragAndDrop","",1,"eav-dialog",3,"allowedFileTypes","filesDropped"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title",3,"innerHtml"],[1,"eav-dialog-content"],["mode","indeterminate","diameter","20","color","accent",4,"ngIf"],[3,"innerHtml"],["mat-raised-button","","tippy","Open file browser",3,"disabled","click"],[4,"ngIf"],[4,"ngFor","ngForOf"],["type","file","multiple","",1,"hide",3,"change"],["fileInput",""],["mat-raised-button","","class","eav-app-catalog-button","tippy","Open app catalog",3,"click",4,"ngIf"],["class","eav-result-container",4,"ngIf"],["class","eav-app-catalog-iframe","src","//gettingstarted.2sxc.org/router.aspx?Platform=Dnn&SysVersion=9.6.1&SxcVersion=16.07.01&destination=autoconfigureapp&ModuleId=1197&SiteId=16&ZoneID=17&DefaultLanguage=en-us&CurrentLanguage=en-us&SysGuid=DB92DBFC-0C60-4101-93C6-803C2FE244B6&AppId=&fp=c2b7fabe7d51a0a0f6484d72bc119c8bf2d14b8ad29b30696a9148f9845a766c",4,"ngIf"],["align","end",4,"ngIf"],["mode","indeterminate","diameter","20","color","accent"],["mat-raised-button","","tippy","Open app catalog",1,"eav-app-catalog-button",3,"click"],[1,"eav-result-container"],["class","sxc-message sxc-message-info",4,"ngIf"],["class","sxc-message sxc-message-error",4,"ngIf"],["class","sxc-message",3,"ngClass",4,"ngFor","ngForOf"],[1,"sxc-message","sxc-message-info"],[1,"sxc-message","sxc-message-error"],[1,"sxc-message",3,"ngClass"],["src","//gettingstarted.2sxc.org/router.aspx?Platform=Dnn&SysVersion=9.6.1&SxcVersion=16.07.01&destination=autoconfigureapp&ModuleId=1197&SiteId=16&ZoneID=17&DefaultLanguage=en-us&CurrentLanguage=en-us&SysGuid=DB92DBFC-0C60-4101-93C6-803C2FE244B6&AppId=&fp=c2b7fabe7d51a0a0f6484d72bc119c8bf2d14b8ad29b30696a9148f9845a766c",1,"eav-app-catalog-iframe"],["installerWindow",""],["align","end"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click"],["mat-raised-button","","color","accent",3,"click"]],template:function(a,o){1&a&&(e.YNc(0,R,18,15,"div",0),e.ALo(1,"async")),2&a&&e.Q6J("ngIf",e.lcZ(1,1,o.viewModel$))},dependencies:[r.mk,r.sg,r.O5,m.Ou,c.lW,n.H8,h.z,x.$,r.Ov,E.z],styles:[".eav-result-container[_ngcontent-%COMP%]{margin-top:16px}.eav-app-catalog-button[_ngcontent-%COMP%]{margin-left:12px}.eav-app-catalog-iframe[_ngcontent-%COMP%]{margin-top:16px;width:100%;height:500px;border:none}"]})}return s})()},5101:(v,g,i)=>{i.d(g,{D:()=>n,p:()=>p});const n={Warning:0,Success:1,Error:2},p={App:0,AppPart:1,ContentType:2,ContentItem:3,Query:4,View:5}},7503:(v,g,i)=>{i.d(g,{DS:()=>p.D,UR:()=>n.U,pC:()=>p.p});var n=i(9399),p=i(5101)},2849:(v,g,i)=>{i.d(g,{z:()=>T});var n=i(9039),p=i(9016),D=i(9097),u=i(9409);let T=(()=>{class d extends D.f{constructor(e,_,r){super(),this.zone=_,this.snackBar=r,this.markStyle="outline",this.allowedFileTypes="",this.filesDropped=new n.vpe,this.dropAreaClass="eav-droparea",this.dragClass="eav-dragover",this.timeouts=[],this.element=e.nativeElement}ngOnInit(){this.markStyleClass=`eav-droparea-${this.markStyle}`,this.element.classList.add(this.dropAreaClass,this.markStyleClass),this.zone.runOutsideAngular(()=>{this.subscription.add((0,p.R)(this.element,"dragover").subscribe(e=>{e.preventDefault(),e.stopPropagation(),this.clearTimeouts(),this.element.classList.add(this.dragClass)})),this.subscription.add((0,p.R)(this.element,"dragleave").subscribe(e=>{e.preventDefault(),e.stopPropagation(),this.timeouts.push(window.setTimeout(()=>{this.element.classList.remove(this.dragClass)},50))}))})}ngOnDestroy(){this.clearTimeouts(),this.element.classList.remove(this.dropAreaClass,this.markStyleClass,this.dragClass),super.ngOnDestroy()}onDrop(e){e.preventDefault(),e.stopPropagation(),this.clearTimeouts(),this.element.classList.remove(this.dragClass);let r=Array.from(e.dataTransfer.files);r=this.filterTypes(r,this.allowedFileTypes),r.length>0&&this.filesDropped.emit(r)}clearTimeouts(){for(const e of this.timeouts)clearTimeout(e);this.timeouts=[]}filterTypes(e,_){if(""===_)return e;const r=_.split(",").map(c=>c.toLocaleLowerCase()),m=e.filter(c=>{const h=c.name.lastIndexOf(".");if(h<=0)return!1;const x=c.name.substring(h+1).toLocaleLowerCase();return r.includes(x)});if(e.length!==m.length){const c=this.allowedFileTypes.replace(/\,/g,", ");this.snackBar.open(m.length?"Some files were filtered out. This drop location only accepts file types: "+c:"This drop location only accepts file types: "+c,null,{duration:5e3})}return m}static#e=this.\u0275fac=function(_){return new(_||d)(n.Y36(n.SBq),n.Y36(n.R0b),n.Y36(u.ux))};static#t=this.\u0275dir=n.lG2({type:d,selectors:[["","appDragAndDrop",""]],hostBindings:function(_,r){1&_&&n.NdJ("drop",function(c){return r.onDrop(c)})},inputs:{markStyle:"markStyle",allowedFileTypes:"allowedFileTypes"},outputs:{filesDropped:"filesDropped"},features:[n.qOj]})}return d})()},6537:(v,g,i)=>{i.d(g,{z:()=>D});var n=i(9039),p=i(6480);let D=(()=>{class u{constructor(d){this.sanitizer=d}transform(d){return this.sanitizer.bypassSecurityTrustHtml(d)}static#e=this.\u0275fac=function(C){return new(C||u)(n.Y36(p.H7,16))};static#t=this.\u0275pipe=n.Yjl({name:"safeHtml",type:u,pure:!0})}return u})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/17.00.00/dist/ng-edit/default-projects_eav-ui_src_app_shared_components_file-upload-dialog_index_ts.5d4f5cd12d5014f2.js.map