"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_apps-management_add-app-from-folder_add-app-from-folder_component_ts"],{2204:(L,r,n)=>{n.r(r),n.d(r,{AddAppFromFolderComponent:()=>j});var d=n(600),g=n(1616),f=n(4844),C=n(1484),v=n(5876),A=n(1792),y=n(9432),F=n(1672),O=n(8916),x=n(3584),G=n(604),I=n(6996),b=n(6884),$=n(1743),p=n(9244),c=n(924),E=n(988),h=n(2328),t=n(4896),R=n(8200);let S=(()=>{class i{agInit(e){this.name=e.value,this.tooltip=e.tooltipGetter(e.data)}refresh(e){return!0}static#t=this.\u0275fac=function(o){return new(o||i)};static#e=this.\u0275cmp=t.In1({type:i,selectors:[["app-app-name-show"]],standalone:!0,features:[t.UHJ],decls:5,vars:2,consts:[[1,"name-box"],[1,"info-icon",3,"tippy"]],template:function(o,s){1&o&&(t.I0R(0,"div",0)(1,"span"),t.OEk(2),t.C$Y(),t.I0R(3,"mat-icon",1),t.OEk(4,"info"),t.C$Y()()),2&o&&(t.yG2(2),t.cNF(s.name),t.yG2(1),t.E7m("tippy",s.tooltip))},dependencies:[h.oB,h.qL,E.q,R.Y],styles:[".name-box[_ngcontent-%COMP%]{display:flex;align-items:center}.info-icon[_ngcontent-%COMP%]{margin-left:7px;margin-bottom:3px}"]})}return i})(),Y=(()=>{class i{agInit(e){this.params=e}refresh(e){return!0}onChange(e){this.params.onChange(this.params.data,e.currentTarget.checked)}static#t=this.\u0275fac=function(o){return new(o||i)};static#e=this.\u0275cmp=t.In1({type:i,selectors:[["app-checkbox-cell"]],standalone:!0,features:[t.UHJ],decls:2,vars:2,consts:[[1,"checkbox-box"],["type","checkbox",1,"checkbox-input",3,"disabled","checked","change"]],template:function(o,s){1&o&&(t.I0R(0,"div",0)(1,"input",1),t.qCj("change",function(J){return s.onChange(J)}),t.C$Y()()),2&o&&(t.yG2(1),t.E7m("disabled",s.params.isDisabled)("checked",s.params.value))},styles:[".checkbox-box[_ngcontent-%COMP%]{height:100%;display:flex;align-items:center}.checkbox-input[_ngcontent-%COMP%]{height:15px;width:15px}"]})}return i})();var T=n(5056),m=n(4672),u=n(4072),D=n(4460),k=n(4648),P=n(4616);function M(i,l){1&i&&(t.I0R(0,"p"),t.OEk(1," Nothing to show. All apps in the 2sxc folder are already installed. "),t.C$Y())}function B(i,l){if(1&i&&(t.I0R(0,"div"),t.wR5(1,"ag-grid-angular",9),t.C$Y()),2&i){const e=t.GaO(),o=t.GaO();t.yG2(1),t.E7m("rowData",e.pendingApps)("gridOptions",o.gridOptions)}}function N(i,l){if(1&i){const e=t.KQA();t.I0R(0,"div",1)(1,"div",2)(2,"div",3),t.OEk(3,"Add App from Folder"),t.C$Y()(),t.I0R(4,"div",4),t.wR5(5,"app-feature-text-info",5),t.I0R(6,"p"),t.OEk(7," Select an app from the apps-folder which has been copied there (or git-cloned) but not installed yet. "),t.C$Y(),t.yuY(8,M,2,0,"p")(9,B,2,2,"div"),t.C$Y(),t.I0R(10,"mat-dialog-actions",6)(11,"button",7),t.qCj("click",function(){t.usT(e);const s=t.GaO();return t.CGJ(s.closeDialog())}),t.OEk(12," Cancel "),t.C$Y(),t.I0R(13,"button",8),t.qCj("click",function(){t.usT(e);const s=t.GaO();return t.CGJ(s.install())}),t.OEk(14," Install "),t.C$Y()()()}if(2&i){const e=t.GaO();t.yG2(5),t.E7m("featureNameId","AppSyncWithSiteFiles"),t.yG2(3),t.C0Y(8,0==(null==l.pendingApps?null:l.pendingApps.length)?8:-1),t.yG2(1),t.C0Y(9,(null==l.pendingApps?null:l.pendingApps.length)>0?9:-1),t.yG2(4),t.E7m("disabled",0===e.pendingApps.length||e.installing)}}let j=(()=>{class i extends b.C{constructor(e,o,s,a){super(),this.dialogRef=e,this.appsListService=o,this.snackBar=s,this.featuresService=a,this.hostClass="dialog-component",this.gridOptions=this.buildGridOptions(),this.pendingApps=[],this.installing=!1,this.refreshApps$=new g.E,this.isAddFromFolderEnabled$=new f.g(!1)}ngOnInit(){this.subscription.add(this.featuresService.isEnabled$(I.y.AppSyncWithSiteFiles).pipe((0,C.a)()).subscribe(this.isAddFromFolderEnabled$)),this.viewModel$=(0,v.E)([this.refreshApps$.pipe((0,A.W)(void 0),(0,y.G)(()=>this.appsListService.getPendingApps().pipe((0,F.a)(()=>(0,O.of)(void 0)))),(0,x.o)())]).pipe((0,G.k)(([e])=>({pendingApps:e})))}ngOnDestroy(){this.refreshApps$.complete(),super.ngOnDestroy()}closeDialog(){this.dialogRef.close()}onChange(e,o){o?this.pendingApps.push(e):this.pendingApps.splice(this.pendingApps.indexOf(e),1)}install(){this.installing=!0,this.snackBar.open("Installing",void 0,{duration:2e3}),this.appsListService.installPendingApps(this.pendingApps).subscribe({error:()=>{this.installing=!1,this.snackBar.open("Failed to install app. Please check console for more information",void 0,{duration:3e3})},next:()=>{this.installing=!1,this.snackBar.open("Installed app",void 0,{duration:2e3}),this.closeDialog()}})}buildGridOptions(){return{...$.A,columnDefs:[{field:"",width:40,cellClass:"no-outline",sortable:!0,cellRenderer:Y,cellRendererParams:()=>({isDisabled:!this.isAddFromFolderEnabled$.value,onChange:(s,a)=>this.onChange(s,a)})},{field:"Name",flex:1,cellClass:"no-outline",sortable:!0,sort:"asc",filter:"agTextColumnFilter",cellRenderer:S,cellRendererParams:{tooltipGetter:s=>`Server folder: ${s.ServerFolder}\nFolder: ${s.Folder}\nVersion: ${s.Version}\nDescription: ${s.Description}`}}]}}static#t=this.\u0275fac=function(o){return new(o||i)(t.GI1(d.yI),t.GI1(c.m),t.GI1(k.yS),t.GI1(p.E))};static#e=this.\u0275cmp=t.In1({type:i,selectors:[["app-add-app-from-folder"]],hostVars:1,hostBindings:function(o,s){2&o&&t.SoX("className",s.hostClass)},standalone:!0,features:[t.M5G([c.m,p.E]),t.eg9,t.UHJ],decls:2,vars:3,consts:[["class","eav-dialog"],[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],[3,"featureNameId"],["align","end"],["type","button","mat-raised-button","",3,"click"],["type","button","mat-raised-button","","color","accent",3,"disabled","click"],[1,"ag-theme-material","eav-grid",3,"rowData","gridOptions"]],template:function(o,s){if(1&o&&(t.yuY(0,N,15,4,"div",0),t.wVc(1,"async")),2&o){let a;t.C0Y(0,(a=t.kDX(1,1,s.viewModel$))?0:-1,a)}},dependencies:[D.y,P.E,u.Oc,u.U5,d.Yp,m.oJ,m.Gw,T.a],styles:[".eav-grid[_ngcontent-%COMP%]{height:200px;width:auto}"]})}return i})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/17.06.04/dist/ng-edit/projects_eav-ui_src_app_apps-management_add-app-from-folder_add-app-from-folder_component_ts.c13fd1c3c4fb63dd.js.map