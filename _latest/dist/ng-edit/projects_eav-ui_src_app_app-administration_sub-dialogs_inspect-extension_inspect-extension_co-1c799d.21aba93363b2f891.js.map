{"version":3,"file":"projects_eav-ui_src_app_app-administration_sub-dialogs_inspect-extension_inspect-extension_co-1c799d.21aba93363b2f891.js","mappings":"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","names":["AppExtensionsService","HttpServiceBase","constructor","this","log","classLog","getAllLive","refresh","newHttpResource","url","apiUrl","params","appId","method","updateConfiguration","name","config","configJson","JSON","parse","http","post","zoneId","downloadExtension","folder","URLSearchParams","toString","window","open","uploadExtensions","file","editions","formData","FormData","append","pipe","map","success","Success","Messages","MessageType","Text","installPreflightExtension","files","forEach","preflightExtension","edition","deleteExtension","force","withData","delete","static","__ngFactoryType__","_angular_core__WEBPACK_IMPORTED_MODULE_4__","jDH","factory","Éµfac","InspectExtensionComponent","#extensionsSvc","route","dialogData","dialog","transient","extensionFolder","snapshot","paramMap","get","preflightResult","value","closeDialog","confirm","close","i0","i1","MAT_DIALOG_DATA","i2","_angular_core__WEBPACK_IMPORTED_MODULE_2__","VBU","selectors","decls","vars","consts","template","rf","ctx","MatButtonModule","i3","MatIconModule","i4","MatSlideToggleModule","FormsModule","MatCardModule","MatExpansionModule","InspectExtensionContentComponent","TippyDirective","styles"],"ignoreList":[],"sourceRoot":"webpack:///","sources":["./projects/eav-ui/src/app/app-administration/services/app-extensions.service.ts","./projects/eav-ui/src/app/app-administration/sub-dialogs/inspect-extension/inspect-extension.component.ts","./projects/eav-ui/src/app/app-administration/sub-dialogs/inspect-extension/inspect-extension.component.html"],"sourcesContent":["import { Injectable, Signal } from '@angular/core';\r\nimport { map } from 'rxjs';\r\nimport { FileUploadResult } from '../../shared/components/file-upload-dialog/file-upload-dialog.models';\r\nimport { classLog } from '../../shared/logging';\r\nimport { HttpServiceBase } from '../../shared/services/http-service-base';\r\nimport { Extension, ExtensionInspectResult, ExtensionPreflightItem } from '../models/extension.model';\r\n\r\n@Injectable()\r\nexport class AppExtensionsService extends HttpServiceBase {\r\n  log = classLog({ AppExtensionsService });\r\n\r\n  /** Get all extensions with live refresh capability */\r\n  getAllLive(refresh: Signal<unknown>) {\r\n    return this.newHttpResource<{ extensions: Extension[] }>(() => {\r\n      // Watch the refresh signal to trigger reloads\r\n      refresh();\r\n\r\n      return {\r\n        url: this.apiUrl('admin/appExtensions/extensions'),\r\n        params: { appId: this.appId },\r\n        method: 'GET',\r\n      };\r\n    });\r\n  }\r\n\r\n  /** Update config (mutations still best done via HttpClient per Angular docs) */\r\n  updateConfiguration(name: string, config: string) {\r\n    // Parse the config to JsonElement format that the API expects\r\n    const configJson = JSON.parse(config);\r\n\r\n    return this.http.post<boolean>(this.apiUrl('admin/appExtensions/configuration'), configJson, {\r\n      params: {\r\n        zoneId: this.zoneId,\r\n        appId: this.appId,\r\n        name\r\n      },\r\n    });\r\n  }\r\n\r\n  /** Open download link for an extension */\r\n  downloadExtension(folder: string) {\r\n    const params = new URLSearchParams({\r\n      appId: this.appId,\r\n      zoneId: this.zoneId,\r\n      name: folder,\r\n    });\r\n    const url = `${this.apiUrl('admin/appExtensions/download')}?${params.toString()}`;\r\n    window.open(url, '_blank', '');\r\n  }\r\n\r\n  /** Uploads extension files */\r\n  uploadExtensions(file: File, editions?: string) {\r\n    const formData = new FormData();\r\n    formData.append('files', file);\r\n\r\n    const params = {\r\n      appId: this.appId,\r\n      zoneId: this.zoneId,\r\n      ...(editions ? { editions } : {})\r\n    };\r\n\r\n    return this.http.post<boolean>(this.apiUrl('admin/appExtensions/install'), formData, {\r\n      params,\r\n    }).pipe(\r\n      map((success: boolean): FileUploadResult => ({\r\n        Success: success,\r\n        Messages: success\r\n          ? [{ MessageType: 1, Text: 'Extension uploaded successfully' }]\r\n          : [{ MessageType: 2, Text: 'Extension upload failed' }]\r\n      }))\r\n    );\r\n  }\r\n\r\n  installPreflightExtension(files: File[]) {\r\n    const formData = new FormData();\r\n    files.forEach(file => formData.append('files', file));\r\n\r\n    return this.http.post<{ extensions: ExtensionPreflightItem[] }>(\r\n      this.apiUrl('admin/appExtensions/installPreflight'),\r\n      formData,\r\n      {\r\n        params: {\r\n          appId: this.appId,\r\n          zoneId: this.zoneId\r\n        },\r\n      }\r\n    );\r\n  }\r\n\r\n  preflightExtension(name: string, edition?: string) {\r\n    const params: { appId: string, name: string, edition?: string } = {\r\n      appId: this.appId,\r\n      name,\r\n    };\r\n    if (edition) params.edition = edition;\r\n\r\n    return this.newHttpResource<ExtensionInspectResult>(() => ({\r\n      url: this.apiUrl('admin/appExtensions/inspect'),\r\n      params,\r\n      method: 'GET',\r\n    }));\r\n  }\r\n\r\n  deleteExtension(name: string, edition?: string, force = false, withData = false) {\r\n    const params = {\r\n      appId: this.appId,\r\n      name,\r\n      force,\r\n      withData,\r\n      ...(edition ? { edition: edition } : {})\r\n    };\r\n\r\n    return this.http.delete<boolean>(\r\n      this.apiUrl('admin/appExtensions/delete'),\r\n      { params }\r\n    );\r\n  }\r\n}\r\n","import { Component, Inject } from '@angular/core';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatCardModule } from '@angular/material/card';\r\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\r\nimport { MatExpansionModule } from '@angular/material/expansion';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatSlideToggleModule } from '@angular/material/slide-toggle';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { transient } from 'projects/core';\r\nimport { TippyDirective } from '../../../shared/directives/tippy.directive';\r\nimport { AppExtensionsService } from '../../services/app-extensions.service';\r\nimport { ConfirmDeleteDialogData } from '../confirm-delete-dialog/confirm-delete-dialog.models';\r\nimport { InspectExtensionContentComponent } from './inspect-extension-content/inspect-extension-content.component';\r\n\r\n@Component({\r\n  selector: 'app-inspect-extension',\r\n  templateUrl: './inspect-extension.component.html',\r\n  styleUrls: ['./inspect-extension.component.scss'],\r\n  imports: [\r\n    MatButtonModule,\r\n    MatIconModule,\r\n    MatSlideToggleModule,\r\n    FormsModule,\r\n    MatCardModule,\r\n    MatExpansionModule,\r\n    InspectExtensionContentComponent,\r\n    TippyDirective,\r\n  ]\r\n})\r\nexport class InspectExtensionComponent {\r\n  #extensionsSvc = transient(AppExtensionsService);\r\n\r\n  extensionFolder = this.route.snapshot.paramMap.get('extension') as 'extension';\r\n\r\n  preflightResult = this.#extensionsSvc.preflightExtension(this.extensionFolder, '').value;\r\n\r\n  constructor(\r\n    private route: ActivatedRoute,\r\n    @Inject(MAT_DIALOG_DATA) public dialogData: ConfirmDeleteDialogData,\r\n    public dialog: MatDialogRef<{}>,\r\n  ) { }\r\n\r\n  closeDialog(confirm?: boolean) {\r\n    confirm\r\n      ? this.dialog.close(confirm)\r\n      : this.dialog.close();\r\n  }\r\n}\r\n","<div class=\"eav-dialog\">\r\n  <div class=\"eav-dialog-header\">\r\n    <div class=\"eav-dialog-header__title\">{{ extensionFolder || 'No Extension' }}</div>\r\n    <button mat-icon-button tippy=\"Close dialog\" (click)=\"closeDialog()\">\r\n      <mat-icon>close</mat-icon>\r\n    </button>\r\n  </div>\r\n\r\n  <div class=\"eav-dialog-content\">\r\n    <app-inspect-extension-content [data]=\"preflightResult()\" />\r\n  </div>\r\n</div>\r\n"],"x_google_ignoreList":[]}