{"version":3,"file":"projects_eav-ui_src_app_content-items_import-content-item_import-content-item_component_ts.js","mappings":";;;;;;;;;;;;;;;;;;AAC2D;AACX;AAC0E;AAClD;;AAOlE,MAAOK,0BAA0B;EAMrCC,YAAqCC,UAAgC;IAJrE,KAAAC,UAAU,GAAGL,8EAAW,CAACM,WAAW;IAE5B,KAAAC,mBAAmB,GAAGT,gDAAS,CAACG,gFAAmB,CAAC;IAG1DG,UAAU,CAACI,KAAK,KAAK,oBAAoB;IACzCJ,UAAU,CAACK,WAAW,KAAK,0DAA0D;IACrFL,UAAU,CAACM,gBAAgB,KAAK,MAAM;IACtCN,UAAU,CAACO,OAAO,KAAMC,KAAK,IAAK,IAAI,CAACL,mBAAmB,CAACM,UAAU,CAACD,KAAK,CAAC,CAAC,CAAC,CAAC;EACjF;;;uCAXWV,0BAA0B,EAAAY,+DAAA,CAMjBjB,qEAAe;IAAA;EAAA;;;YANxBK,0BAA0B;MAAAc,SAAA;MAAAC,KAAA;MAAAC,IAAA;MAAAC,MAAA;MAAAC,QAAA,WAAAC,oCAAAC,EAAA,EAAAC,GAAA;QAAA,IAAAD,EAAA;UCXvCR,uDAAA,gCAA2E;;;UAAnDA,wDAAA,eAAAS,GAAA,CAAAlB,UAAA,CAAyB;;;qBDSnCN,4FAAyB;MAAA2B,aAAA;IAAA;EAAA;;;;;;;;;;;;;;;;;;;;;;;AETY;AACP;AAEuC;AAEb;AACoB;AAChB;;AAIpE,MAAOzB,mBAAoB,SAAQkC,+EAAe;EAEtDC,MAAMA,CAACC,qBAA6B;IAClC,OAAO,IAAI,CAACC,aAAa,CAAgBL,6EAAgB,EAAE;MACzDM,MAAM,EAAE;QAAEC,KAAK,EAAE,IAAI,CAACA,KAAK;QAAEC,WAAW,EAAEJ;MAAqB;KAChE,CAAC;EACJ;EAEAK,SAASA,CAACL,qBAA6B,EAAEM,OAAkB;IACzD,OAAO,IAAI,CAACC,SAAS,CAAgBX,6EAAgB,EAAE;MACrDM,MAAM,EAAE;QAAEC,KAAK,EAAE,IAAI,CAACA,KAAK;QAAEC,WAAW,EAAEJ;MAAqB;KAChE,EAAEM,OAAO,CAAC;EACb;EAEAE,UAAUA,CAACR,qBAA6B;IACtC,OAAO,IAAI,CAACC,aAAa,CAAUP,wFAAe,EAAE;MAClDQ,MAAM,EAAE;QAAEC,KAAK,EAAE,IAAI,CAACA,KAAK;QAAEM,UAAU,EAAET;MAAqB;KAC/D,CAAC;EACJ;EAEAxB,UAAUA,CAACkC,IAAU;IACnB,OAAOnB,0CAAI,CAACI,+EAAQ,CAACe,IAAI,CAAC,CAAC,CAACC,IAAI,CAC9BlB,+CAAS,CAACmB,UAAU,IAAG;MACrB,OAAO,IAAI,CAACC,IAAI,CAACC,IAAI,CAAU,IAAI,CAACC,MAAM,CAAClB,6EAAgB,GAAG,QAAQ,CAAC,EAAE;QACvEmB,KAAK,EAAE,IAAI,CAACb,KAAK;QACjBc,aAAa,EAAEL;OAChB,CAAC;IACJ,CAAC,CAAC,EACFpB,yCAAG,CAAC0B,OAAO,IAAG;MACZ,MAAMC,MAAM,GAAqB;QAC/BC,OAAO,EAAEF,OAAO;QAChBG,QAAQ,EAAE;OACX;MACD,OAAOF,MAAM;IACf,CAAC,CAAC,CACH;EACH;;;;;4JApCWvD,mBAAmB,IAAA0D,iBAAA,IAAnB1D,mBAAmB;MAAA;IAAA;EAAA;;;aAAnBA,mBAAmB;MAAA2D,OAAA,EAAnB3D,mBAAmB,CAAA4D;IAAA;EAAA","sources":["./projects/eav-ui/src/app/content-items/import-content-item/import-content-item.component.ts","./projects/eav-ui/src/app/content-items/import-content-item/import-content-item.component.html","./projects/eav-ui/src/app/content-items/services/content-items.service.ts"],"sourcesContent":["import { Component, Inject } from '@angular/core';\r\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\r\nimport { transient } from '../../../../../core';\r\nimport { FileUploadDialogComponent, FileUploadDialogData, UploadTypes } from '../../shared/components/file-upload-dialog';\r\nimport { ContentItemsService } from '../services/content-items.service';\r\n\r\n@Component({\r\n    selector: 'app-import-content-item',\r\n    templateUrl: './import-content-item.component.html',\r\n    imports: [FileUploadDialogComponent,]\r\n})\r\nexport class ImportContentItemComponent {\r\n\r\n  uploadType = UploadTypes.ContentItem;\r\n\r\n  private contentItemsService = transient(ContentItemsService);\r\n\r\n  constructor(@Inject(MAT_DIALOG_DATA) dialogData: FileUploadDialogData) {\r\n    dialogData.title ??= `Import Single Item`;\r\n    dialogData.description ??= `Select an item file (json) from your computer to import.`;\r\n    dialogData.allowedFileTypes ??= 'json';\r\n    dialogData.upload$ ??= (files) => this.contentItemsService.importItem(files[0]);\r\n  }\r\n\r\n}\r\n","<app-file-upload-dialog [uploadType]=\"uploadType\"></app-file-upload-dialog>\r\n","import { Injectable, Signal } from '@angular/core';\r\nimport { from, map, switchMap } from 'rxjs';\r\nimport { FileUploadResult } from '../../shared/components/file-upload-dialog';\r\nimport { webApiFieldsAll } from '../../shared/fields/content-types-fields.service';\r\nimport { Field } from '../../shared/fields/field.model';\r\nimport { toBase64 } from '../../shared/helpers/file-to-base64.helper';\r\nimport { webApiEntityList, webApiEntityRoot } from '../../shared/services/entity.service';\r\nimport { HttpServiceBase } from '../../shared/services/http-service-base';\r\nimport { ContentItem } from '../models/content-item.model';\r\n\r\n@Injectable()\r\nexport class ContentItemsService extends HttpServiceBase {\r\n\r\n  getAll(contentTypeStaticName: string) {\r\n    return this.getHttpApiUrl<ContentItem[]>(webApiEntityList, {\r\n      params: { appId: this.appId, contentType: contentTypeStaticName }\r\n    });\r\n  }\r\n\r\n  getAllSig(contentTypeStaticName: string, initial: undefined): Signal<ContentItem[]> {\r\n    return this.getSignal<ContentItem[]>(webApiEntityList, {\r\n      params: { appId: this.appId, contentType: contentTypeStaticName }\r\n    }, initial);\r\n  }\r\n\r\n  getColumns(contentTypeStaticName: string) {\r\n    return this.getHttpApiUrl<Field[]>(webApiFieldsAll, {\r\n      params: { appId: this.appId, staticName: contentTypeStaticName }\r\n    });\r\n  }\r\n\r\n  importItem(file: File) {\r\n    return from(toBase64(file)).pipe(\r\n      switchMap(fileBase64 => {\r\n        return this.http.post<boolean>(this.apiUrl(webApiEntityRoot + 'upload'), {\r\n          AppId: this.appId,\r\n          ContentBase64: fileBase64,\r\n        });\r\n      }),\r\n      map(success => {\r\n        const result: FileUploadResult = {\r\n          Success: success,\r\n          Messages: [],\r\n        };\r\n        return result;\r\n      }),\r\n    );\r\n  }\r\n}\r\n"],"names":["MAT_DIALOG_DATA","transient","FileUploadDialogComponent","UploadTypes","ContentItemsService","ImportContentItemComponent","constructor","dialogData","uploadType","ContentItem","contentItemsService","title","description","allowedFileTypes","upload$","files","importItem","i0","ɵɵdirectiveInject","selectors","decls","vars","consts","template","ImportContentItemComponent_Template","rf","ctx","ɵɵelement","ɵɵproperty","encapsulation","Signal","from","map","switchMap","webApiFieldsAll","toBase64","webApiEntityList","webApiEntityRoot","HttpServiceBase","getAll","contentTypeStaticName","getHttpApiUrl","params","appId","contentType","getAllSig","initial","getSignal","getColumns","staticName","file","pipe","fileBase64","http","post","apiUrl","AppId","ContentBase64","success","result","Success","Messages","__ngFactoryType__","factory","ɵfac"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}