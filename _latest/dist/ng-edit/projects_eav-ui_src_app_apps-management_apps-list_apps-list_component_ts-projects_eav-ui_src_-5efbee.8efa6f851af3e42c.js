"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_apps-management_apps-list_apps-list_component_ts-projects_eav-ui_src_-5efbee"],{1609:(F,E,e)=>{e.r(E),e.d(E,{AppsListComponent:()=>V});var r=e(9509),C=e(8824),A=e(316),t=e(1659),g=e(6256),u=e(4175),y=e(7941),n=e(3840),f=e(2159),c=e(3183),m=e(2938),D=e(8713),a=e(8136),p=e(9001),o=e(9006),v=e(8991),h=e(1828),P=e(1960),O=e(251),R=e(4575),b=e(3216),I=e(4435),L=e(7037),B=e(8471),j=e(8873),k=e(3583);const W={states:{true:{tooltip:"Show this app to users",icon:"visibility"},false:{tooltip:"Hide this app from users",icon:"visibility_off"}}},$={states:{true:{clickable:!0,tooltip:"This App uses obsolete code which will cause problems on future upgrades. Click to see details.",icon:"bug_report",getUrl:d=>window.$2sxc.http.apiUrl("sys/insights/logs?key=warnings-obsolete&filter=AppId="+d.Id)},false:{tooltip:"Hide this app from users",icon:""}}};var M=e(1034),S=e(4646),K=e(1657),G=e(4601);function x(d,U){1&d&&(t.j41(0,"mat-icon"),t.EFF(1,"foundation"),t.k0s())}function X(d,U){1&d&&(t.j41(0,"mat-icon"),t.EFF(1,"holiday_village"),t.k0s())}function H(d,U){if(1&d){const i=t.RV6();t.j41(0,"button",7),t.bIt("click",function(){t.eBV(i);const s=t.XpG();return t.Njj(s.do("flushCache"))}),t.j41(1,"mat-icon"),t.EFF(2,"cached"),t.k0s(),t.j41(3,"span"),t.EFF(4,"Flush cache"),t.k0s()(),t.j41(5,"button",8),t.bIt("click",function(){t.eBV(i);const s=t.XpG();return t.Njj(s.do("deleteApp"))}),t.j41(6,"mat-icon"),t.EFF(7,"delete"),t.k0s(),t.j41(8,"span"),t.EFF(9,"Delete"),t.k0s()()}if(2&d){const i=t.XpG();t.R7$(5),t.Y8G("disabled",!i.app.IsApp)}}let N=(()=>{class d{agInit(i){this.params=i,this.app=this.params.data}refresh(i){return!0}do(i){this.params.do(i,this.app)}static{this.\u0275fac=function(l){return new(l||d)}}static{this.\u0275cmp=t.VBU({type:d,selectors:[["app-apps-list-actions"]],decls:11,vars:8,consts:[["menu","matMenu"],[1,"actions-component"],[1,"eav-grid-action-button","icon",3,"tippy","tippyDisabled"],[3,"lightSpeedOwner","params","lightSpeed"],["matRipple","","tippy","More",1,"eav-grid-action-button","highlight",3,"matMenuTriggerFor"],[1,"grid-more-menu"],["matMenuContent",""],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click","disabled"]],template:function(l,s){if(1&l&&(t.j41(0,"div",1)(1,"div",2),t.DNE(2,x,2,0,"mat-icon")(3,X,2,0,"mat-icon"),t.k0s(),t.nrm(4,"app-lightspeed-action",3),t.j41(5,"div",4)(6,"mat-icon"),t.EFF(7,"more_horiz"),t.k0s()()(),t.j41(8,"mat-menu",5,0),t.DNE(10,H,10,1,"ng-template",6),t.k0s()),2&l){const T=t.sdS(9);t.R7$(),t.Y8G("tippy",s.app.IsGlobal?"This app is global":s.app.IsInherited?"This app is inherited":"")("tippyDisabled",!s.app.IsGlobal&&!s.app.IsInherited),t.R7$(),t.vxM(s.app.IsGlobal?2:-1),t.R7$(),t.vxM(s.app.IsInherited?3:-1),t.R7$(),t.Y8G("lightSpeedOwner",s.app)("params",s.params)("lightSpeed",s.app.lightSpeed),t.R7$(),t.Y8G("matMenuTriggerFor",T)}},dependencies:[G.e,n.m_,n.An,g.Y,S.pZ,S.r6,M.Cn,M.kk,M.fb,M.z8,M.Cp,K.E],encapsulation:2})}}return d})();var w=e(3347),Y=e(9841);const z=d=>({"fab-opened":d});let V=(()=>{class d{#e;#t;constructor(i,l,s,T,_){this.snackBar=i,this.context=l,this.matDialog=s,this.viewContainerRef=T,this.changeDetectorRef=_,this.log=(0,I.Tq)({AppsListComponent:d}),this.gridOptions=this.#r(),this.features=(0,t.WQX)(p.D),this.isAddFromFolderEnabled=this.features.isEnabled[a.T.AppSyncWithSiteFiles],this.#e=(0,m.d)(k.U),this.#t=(0,m.d)(B.c),this.fabOpen=(0,t.vPA)(!1),this.#s=(0,t.vPA)(0),this.apps=(0,t.EWP)(()=>(this.#s(),this.#e.getAll())),C.syG.registerModules([r.Q])}#s;ngOnInit(){this.#t.doOnDialogClosed(()=>this.#i())}openChange(i){this.fabOpen.set(i)}browseCatalog(){window.open("https://2sxc.org/apps","_blank")}createApp(){this.#t.navRelative(["create"])}createInheritedApp(){this.#t.navRelative(["create-inherited"])}addFromFolder(){this.#t.navRelative(["add-app-from-folder"])}importApp(i){this.#t.navRelative(["import"],{state:{files:i}})}#a(i){const l=prompt(`This cannot be undone. To really delete this app, type 'yes!' or type/paste the app-name here. Are you sure want to delete '${i.Name}' (${i.Id})?`);null!==l&&(l===i.Name||"yes!"===l?(this.snackBar.open("Deleting..."),this.#e.delete(i.Id).subscribe({error:()=>{this.snackBar.open("Delete failed. Please check console for more information",void 0,{duration:3e3}),this.#i()},next:()=>{this.snackBar.open("Deleted",void 0,{duration:2e3}),this.#i()}})):alert("Input did not match - will not delete"))}#n(i){confirm(`Flush the App Cache for ${i.Name} (${i.Id})?`)&&(this.snackBar.open("Flushing cache..."),this.#e.flushCache(i.Id).subscribe({error:()=>this.snackBar.open("Cache flush failed. Please check console.",void 0,{duration:3e3}),next:()=>this.snackBar.open("Cache flushed",void 0,{duration:2e3})}))}#o(i){const l=(0,b.s)(D.g.getLightSpeedEditParams(i.Id));return this.#t.urlSubRoute(`${this.context.zoneId}/${i.Id}/edit/${l}`)}openLightSpeedFeatInfo(){(0,o.j)(this.matDialog,a.T.LightSpeed,this.viewContainerRef,this.changeDetectorRef)}#r(){return{...O.C,columnDefs:[{...h.r.IdWithDefaultRenderer,cellRendererParams:h.r.idFieldParamsTooltipGetter()},{...h.r.IconShow,cellRendererParams:{settings:()=>W}},{...h.r.TextWide,field:"Name",cellClass:"apps-list-primary-action highlight".split(" "),sort:"asc",cellRenderer:l=>{const s=l.data;return`\n              <a class="default-link fill-cell" href="#${this.#t.urlSubRoute(s.Id.toString())}">\n                <div class="container">\n                  ${s.Thumbnail?`<img class="image logo" src="${s.Thumbnail}?w=40&h=40&mode=crop"></img>`:'<div class="image logo"><span class="material-symbols-outlined">star</span></div>'}\n                  ${l.value}\n                </div>\n              </a>\n            `}},{...h.r.TextWide,field:"Folder"},{...h.r.Character,field:"Version",width:78},{...h.r.Number,field:"Items"},{...h.r.Boolean,field:"HasCodeWarnings",headerName:"Code",filter:P.y,cellRenderer:v.N,cellRendererParams:{settings:()=>$}},{...h.r.ActionsPinnedRight3,cellRenderer:N,cellRendererParams:{lightSpeedLink:l=>this.#o(l),openLightspeedFeatureInfo:()=>this.openLightSpeedFeatInfo(),do:(l,s)=>{switch(l){case"deleteApp":this.#a(s);break;case"flushCache":this.#n(s)}}}}]}}#i(){this.#s.update(i=>i+1)}static{this.\u0275fac=function(l){return new(l||d)(t.rXU(w.UG),t.rXU(j.o),t.rXU(y.bZ),t.rXU(t.c1b),t.rXU(t.gRc))}}static{this.\u0275cmp=t.VBU({type:d,selectors:[["app-apps-list"]],decls:25,vars:9,consts:[[1,"grid-wrapper","mat-tab-grid-wrapper"],["appDragAndDrop","",1,"ag-theme-material",3,"filesDropped","rowData","gridOptions","allowedFileTypes"],["align","end"],[1,"eav-eco-fab-speed-dial",3,"openChange","ngClass"],[3,"spin"],["mat-fab",""],[1,"spin180"],[1,"eav-eco-fab-speed-dial-actions"],["mat-mini-fab","","label","Find more apps",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["mat-mini-fab","","label","Create inherited app",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["mat-mini-fab","","label","Add from folder",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["matBadgeColor","accent","matBadgeSize","small","matBadge","\u{1f48e}","matBadgePosition","below after","aria-hidden","false",3,"matBadgeHidden"],["mat-mini-fab","","label","Import app",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["mat-mini-fab","","label","Create app",1,"eav-eco-fab-speed-dial-action-button",3,"click"]],template:function(l,s){1&l&&(t.j41(0,"div",0)(1,"ag-grid-angular",1),t.bIt("filesDropped",function(_){return s.importApp(_)}),t.k0s(),t.j41(2,"mat-dialog-actions",2)(3,"eco-fab-speed-dial",3),t.bIt("openChange",function(_){return s.openChange(_)}),t.j41(4,"eco-fab-speed-dial-trigger",4)(5,"button",5)(6,"mat-icon",6),t.EFF(7),t.k0s()()(),t.j41(8,"eco-fab-speed-dial-actions",7)(9,"button",8),t.bIt("click",function(){return s.browseCatalog()}),t.j41(10,"mat-icon"),t.EFF(11,"search"),t.k0s()(),t.j41(12,"button",9),t.bIt("click",function(){return s.createInheritedApp()}),t.j41(13,"mat-icon"),t.EFF(14,"holiday_village"),t.k0s()(),t.j41(15,"button",10),t.bIt("click",function(){return s.addFromFolder()}),t.j41(16,"mat-icon",11),t.EFF(17," add "),t.k0s()(),t.j41(18,"button",12),t.bIt("click",function(){return s.importApp()}),t.j41(19,"mat-icon"),t.EFF(20,"cloud_upload"),t.k0s()(),t.j41(21,"button",13),t.bIt("click",function(){return s.createApp()}),t.j41(22,"mat-icon"),t.EFF(23,"add"),t.k0s()()()()()(),t.nrm(24,"router-outlet")),2&l&&(t.R7$(),t.Y8G("rowData",s.apps()())("gridOptions",s.gridOptions)("allowedFileTypes","zip"),t.R7$(2),t.Y8G("ngClass",t.eq3(7,z,s.fabOpen())),t.R7$(),t.Y8G("spin",!0),t.R7$(3),t.JRh(s.fabOpen()?"close":"add"),t.R7$(9),t.Y8G("matBadgeHidden",s.isAddFromFolderEnabled()))},dependencies:[L.p,Y.xs,y.E7,c.TE,A.YU,c.p1,u.Hl,u.$0,u.Sr,n.m_,n.An,c.yf,g.Y,g.k,f.n3,R.S],encapsulation:2})}}return d})()},3140:(F,E,e)=>{e.d(E,{J:()=>A});var r=e(7092),C=e(1659);let A=(()=>{class t{constructor(){this.subscriptions=new r.yU}ngOnDestroy(){this.subscriptions.unsubscribe()}static{this.\u0275fac=function(y){return new(y||t)}}static{this.\u0275dir=C.FsC({type:t})}}return t})()},4575:(F,E,e)=>{e.d(E,{S:()=>g});var r=e(1659),C=e(8537),A=e(3140),t=e(3347);let g=(()=>{class u extends A.J{constructor(n,f,c){super(),this.zone=f,this.snackBar=c,this.markStyle=(0,r.hFB)("outline"),this.allowedFileTypes=(0,r.hFB)(""),this.filesDropped=(0,r.CGW)(),this.dropAreaClass="eav-droparea",this.markStyleClass=(0,r.vPA)(""),this.dragClass="eav-dragover",this.timeouts=[],this.element=n.nativeElement}ngOnInit(){this.markStyleClass.set(`eav-droparea-${this.markStyle()}`),this.element.classList.add(this.dropAreaClass,this.markStyleClass()),this.zone.runOutsideAngular(()=>{this.subscriptions.add((0,C.R)(this.element,"dragover").subscribe(n=>{n.preventDefault(),n.stopPropagation(),this.clearTimeouts(),this.element.classList.add(this.dragClass)})),this.subscriptions.add((0,C.R)(this.element,"dragleave").subscribe(n=>{n.preventDefault(),n.stopPropagation(),this.timeouts.push(window.setTimeout(()=>{this.element.classList.remove(this.dragClass)},50))}))})}ngOnDestroy(){this.clearTimeouts(),this.element.classList.remove(this.dropAreaClass,this.markStyleClass(),this.dragClass),super.ngOnDestroy()}onDrop(n){n.preventDefault(),n.stopPropagation(),this.clearTimeouts(),this.element.classList.remove(this.dragClass);let c=Array.from(n.dataTransfer.files);c=this.filterTypes(c,this.allowedFileTypes()),c.length>0&&this.filesDropped.emit(c)}clearTimeouts(){for(const n of this.timeouts)clearTimeout(n);this.timeouts=[]}filterTypes(n,f){if(""===f)return n;const c=f.split(",").map(D=>D.toLocaleLowerCase()),m=n.filter(D=>{const a=D.name.lastIndexOf(".");if(a<=0)return!1;const p=D.name.substring(a+1).toLocaleLowerCase();return c.includes(p)});if(n.length!==m.length){const D=this.allowedFileTypes().replace(/\,/g,", ");this.snackBar.open(m.length?"Some files were filtered out. This drop location only accepts file types: "+D:"This drop location only accepts file types: "+D,null,{duration:5e3})}return m}static{this.\u0275fac=function(f){return new(f||u)(r.rXU(r.aKT),r.rXU(r.SKi),r.rXU(t.UG))}}static{this.\u0275dir=r.FsC({type:u,selectors:[["","appDragAndDrop",""]],hostBindings:function(f,c){1&f&&r.bIt("drop",function(D){return c.onDrop(D)})},inputs:{markStyle:[1,"markStyle"],allowedFileTypes:[1,"allowedFileTypes"]},outputs:{filesDropped:"filesDropped"},features:[r.Vt3]})}}return u})()},8136:(F,E,e)=>{e.d(E,{T:()=>r});const r={AppSyncWithSiteFiles:"AppSyncWithSiteFiles",WysiwygPasteFormatted:"WysiwygPasteFormatted",PasteImageFromClipboard:"PasteImageFromClipboard",EditUiShowNotes:"EditUiShowNotes",EditUiShowMetadataFor:"EditUiShowMetadataFor",NoSponsoredByToSic:"NoSponsoredByToSic",EditUiTranslateWithGoogle:"EditUiTranslateWithGoogle",LightSpeed:"LightSpeedOutputCache",ContentSecurityPolicy:"ContentSecurityPolicy",PermissionsByLanguage:"PermissionsByLanguage",ContentTypeFieldsReuseDefinitions:"ContentTypeFieldsReuseDefinitions",AppExportAssetsAdvanced:"AppExportAssetsAdvanced",PickerUiCheckbox:"PickerUiCheckbox",PickerUiRadio:"PickerUiRadio",PickerSourceCsv:"PickerSourceCsv",PickerSourceAppAssets:"PickerSourceAppAssets",PickerFormulas:"PickerFormulas",PickerUiMoreInfo:"PickerUiMoreInfo"}},8471:(F,E,e)=>{e.d(E,{c:()=>c});var r=e(2159),C=e(1567),A=e(3037),t=e(271),g=e(5057),u=e(4435),y=e(4979),n=e(1659);const f={doOnDialogClosed:!0};let c=(()=>{class m extends y.V{constructor(a,p){super(),this.router=a,this.route=p,this.log=(0,u.Tq)({DialogRoutingService:m},f)}get snapshot(){return this.route.snapshot}get url(){return this.router.url}get urlSegments(){return this.router.url.split("/")}getParam(a){return this.route.snapshot.paramMap.get(a)}getParams(a){const p=this.route.snapshot.paramMap;return a.reduce((o,v)=>(o[v]=p.get(v),o),{})}getQueryParam(a){return this.route.snapshot.queryParamMap.get(a)}getQueryParams(a){const p=this.route.snapshot.queryParamMap;return a.reduce((o,v)=>(o[v]=p.get(v),o),{})}state(){return this.router.getCurrentNavigation().extras?.state}doOnDialogClosed(a){const p=this.log.fnIf("doOnDialogClosed");this.subscriptions.add(this.childDialogClosed$().subscribe(()=>a())),p.end()}urlSubRoute(a){const p=this.router.createUrlTree([a],{relativeTo:this.route});return this.router.serializeUrl(p)}navPath(a,p){return this.router.navigate([a],p)}navRelative(a,p){return this.router.navigate(a,{...p,relativeTo:this.route})}childDialogClosed$(){return this.router.events.pipe((0,C.p)(a=>a instanceof r.wF),(0,A.Z)(!!this.route.snapshot.firstChild),(0,t.T)(()=>!!this.route.snapshot.firstChild),(0,g.J)(),(0,C.p)(([a,p])=>a&&!p))}static{this.\u0275fac=function(p){return new(p||m)(n.KVO(r.Ix),n.KVO(r.nX))}}static{this.\u0275prov=n.jDH({token:m,factory:m.\u0275fac})}}return m})()},8537:(F,E,e)=>{e.d(E,{R:()=>c});var r=e(2645),C=e(3942),A=e(1365),t=e(8830),g=e(1530),u=e(8067);const y=["addListener","removeListener"],n=["addEventListener","removeEventListener"],f=["on","off"];function c(o,v,h,P){if((0,g.T)(h)&&(P=h,h=void 0),P)return c(o,v,h).pipe((0,u.I)(P));const[O,R]=function p(o){return(0,g.T)(o.addEventListener)&&(0,g.T)(o.removeEventListener)}(o)?n.map(b=>I=>o[b](v,I,h)):function D(o){return(0,g.T)(o.addListener)&&(0,g.T)(o.removeListener)}(o)?y.map(m(o,v)):function a(o){return(0,g.T)(o.on)&&(0,g.T)(o.off)}(o)?f.map(m(o,v)):[];if(!O&&(0,t.X)(o))return(0,A.Z)(b=>c(b,v,h))((0,r.Tg)(o));if(!O)throw new TypeError("Invalid event target");return new C.c(b=>{const I=(...L)=>b.next(1<L.length?L:L[0]);return O(I),()=>R(I)})}function m(o,v){return h=>P=>o[h](v,P)}},9914:(F,E,e)=>{e.d(E,{$:()=>A});var r=e(1659),C=e(436);let A=(()=>{class t{constructor(u){this.sanitizer=u}transform(u){return this.sanitizer.bypassSecurityTrustHtml(u)}static{this.\u0275fac=function(y){return new(y||t)(r.rXU(C.up,16))}}static{this.\u0275pipe=r.EJ8({name:"safeHtml",type:t,pure:!0})}}return t})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/19.03.05/dist/ng-edit/projects_eav-ui_src_app_apps-management_apps-list_apps-list_component_ts-projects_eav-ui_src_-5efbee.8efa6f851af3e42c.js.map