"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_content-export_content-export_component_ts-projects_eav-ui_src_app_sh-5eade4"],{2743:(T,v,e)=>{e.d(v,{b:()=>r});var i=e(271),D=e(6301),h=e(8764),M=e(8873),O=e(4858),C=e(4979),x=e(3472),p=e(9431),n=e(8559),m=e(6443);let r=(()=>{class f extends C.V{constructor(l,o,s,c){super(new x.B("AppDialogConfigService",!1)),this.http=l,this.context=o,this.globalConfigService=s,this.dialogSettings$={},this.log.a(`using context #${this.context.log.svcId}`),c.loadFromService(this)}ngOnDestroy(){super.destroy()}getCurrent$(){const l=this.context.appId;return this.log.a(`getCurrent$ - appId:${l}`),this.getShared$(l)}getSitePrimaryApp$(){return this.getCurrent$().pipe((0,i.T)(l=>l?.Context.Site.PrimaryApp))}getGlobalPrimaryApp$(){return this.getCurrent$().pipe((0,i.T)(l=>l?.Context.System.PrimaryApp))}getShared$(l){return this.log.a("getShared$ appId: "+l),this.dialogSettings$[l]??=this.getDialogSettings(l,"getShared$").pipe((0,D.t)({refCount:!1})),this.dialogSettings$[l]}getDialogSettings(l,o){return this.log.a("getDialogSettings",{appId:l,reqBy:o}),this.http.get("admin/dialog/settings",{params:{appId:l??this.context.appId.toString()}}).pipe((0,i.T)(s=>(s.Context.Language.List=s.Context.Language.List.filter(c=>c.IsEnabled),s)),(0,h.M)(s=>{this.globalConfigService.allowDebug(s.Context.Enable.DebugMode)}))}static#t=this.\u0275fac=function(o){return new(o||f)(n.KVO(m.Qq),n.KVO(M.o),n.KVO(p.B),n.KVO(O.D))};static#e=this.\u0275prov=n.jDH({token:f,factory:f.\u0275fac})}return f})()},7693:(T,v,e)=>{e.d(v,{X:()=>C,g:()=>f});var i=e(271),D=e(8873),h=e(8559),M=e(6443),O=e(4821);const C="admin/type/",n="admin/type/scopes";let f=(()=>{class t{constructor(o,s,c){this.http=o,this.context=s,this.dnnContext=c}apiUrl(o){return this.dnnContext.$2sxc.http.apiUrl(o)}retrieveContentType(o){return this.http.get(this.apiUrl("admin/type/get"),{params:{appId:this.context.appId.toString(),contentTypeId:o}})}retrieveContentTypes(o){return this.http.get(this.apiUrl("admin/type/list"),{params:{appId:this.context.appId.toString(),scope:o}})}getScopes(){return this.http.get(this.apiUrl(n),{params:{appId:this.context.appId.toString()}}).pipe((0,i.T)(o=>{const s=o.old;return Object.keys(s).map(P=>({name:s[P],value:P}))}))}getScopesV2(){return this.http.get(this.apiUrl(n),{params:{appId:this.context.appId.toString()}}).pipe((0,i.T)(o=>o.scopes))}save(o){return this.http.post(this.apiUrl("admin/type/save"),o,{params:{appid:this.context.appId.toString()}})}delete(o){return this.http.delete(this.apiUrl("admin/type/delete"),{params:{appid:this.context.appId.toString(),staticName:o.StaticName}})}import(o){const s=new FormData;for(const c of o)s.append("File",c);return this.http.post(this.apiUrl("admin/type/import"),s,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}createGhost(o){return this.http.post(this.apiUrl("admin/type/addghost"),null,{params:{appid:this.context.appId.toString(),sourceStaticName:o}})}static#t=this.\u0275fac=function(s){return new(s||t)(h.KVO(M.Qq),h.KVO(D.o),h.KVO(O.ob))};static#e=this.\u0275prov=h.jDH({token:t,factory:t.\u0275fac})}return t})()},5727:(T,v,e)=>{e.r(v),e.d(v,{ContentExportComponent:()=>P});var i=e(7941),D=e(5797),h=e(1873),M=e(2743),O=e(7693),C=e(6360),x=e(316),p=e(4175),n=e(3804),m=e(5060),I=e(5175),g=e(5944),r=e(4456),f=e(5437),t=e(8559),l=e(9184);function o(d,R){if(1&d&&(t.j41(0,"mat-option",10),t.EFF(1),t.k0s()),2&d){const E=R.$implicit;t.Y8G("value",E.NameId),t.R7$(),t.JRh(E.NameId)}}function s(d,R){if(1&d&&(t.j41(0,"mat-radio-button",15),t.EFF(1),t.k0s()),2&d){const E=t.XpG(2);t.R7$(),t.SpI(" Export selected ",E.itemIds.length," items ")}}function c(d,R){if(1&d){const E=t.RV6();t.j41(0,"form",null,0)(2,"div",4)(3,"p"),t.EFF(4," This will generate an XML file which you can edit in Excel. If you just want to import new data, use this to export the schema that you can then fill in using Excel. Please visit "),t.j41(5,"a",5),t.EFF(6,"https://2sxc.org/help"),t.k0s(),t.EFF(7," for more instructions. "),t.k0s(),t.j41(8,"div",6)(9,"div")(10,"mat-form-field",7)(11,"mat-label"),t.EFF(12,"Languages"),t.k0s(),t.j41(13,"mat-select",8),t.mxI("ngModelChange",function(a){t.eBV(E);const u=t.XpG();return t.DH7(u.formValues.language,a)||(u.formValues.language=a),t.Njj(a)}),t.j41(14,"mat-option",9),t.EFF(15,"All"),t.k0s(),t.Z7z(16,o,2,2,"mat-option",10,t.fX1),t.k0s()()(),t.j41(18,"div")(19,"p",11),t.EFF(20,"Export data"),t.k0s(),t.j41(21,"mat-radio-group",12),t.mxI("ngModelChange",function(a){t.eBV(E);const u=t.XpG();return t.DH7(u.formValues.recordExport,a)||(u.formValues.recordExport=a),t.Njj(a)}),t.j41(22,"mat-radio-button",13),t.EFF(23,"No, just export blank data schema (for new data import) "),t.k0s(),t.j41(24,"mat-radio-button",14),t.EFF(25,"Yes, export all content-items"),t.k0s(),t.DNE(26,s,2,1,"mat-radio-button",15),t.k0s()(),t.j41(27,"div")(28,"p",11),t.EFF(29,"Value references to other languages"),t.k0s(),t.j41(30,"mat-radio-group",16),t.mxI("ngModelChange",function(a){t.eBV(E);const u=t.XpG();return t.DH7(u.formValues.languageReferences,a)||(u.formValues.languageReferences=a),t.Njj(a)}),t.j41(31,"mat-radio-button",17),t.EFF(32,"Keep references to other languages (for re-import) "),t.k0s(),t.j41(33,"mat-radio-button",18),t.EFF(34,"Replace references with values"),t.k0s()()(),t.j41(35,"div")(36,"p",11),t.EFF(37,"File / page references"),t.k0s(),t.j41(38,"mat-radio-group",19),t.mxI("ngModelChange",function(a){t.eBV(E);const u=t.XpG();return t.DH7(u.formValues.resourcesReferences,a)||(u.formValues.resourcesReferences=a),t.Njj(a)}),t.j41(39,"mat-radio-button",17),t.EFF(40,"Keep references (for re-import, for example Page:4711) "),t.k0s(),t.j41(41,"mat-radio-button",18),t.EFF(42,"Replace references with real URLs (for example /Portals/0...) "),t.k0s()()()()(),t.j41(43,"mat-dialog-actions",20)(44,"button",21),t.bIt("click",function(){t.eBV(E);const a=t.XpG();return t.Njj(a.closeDialog())}),t.EFF(45,"Cancel"),t.k0s(),t.j41(46,"button",22),t.bIt("click",function(){t.eBV(E);const a=t.XpG();return t.Njj(a.exportContent())}),t.EFF(47," Export Data "),t.k0s()()()}if(2&d){const E=t.sdS(1),_=t.XpG();t.R7$(13),t.R50("ngModel",_.formValues.language),t.R7$(3),t.Dyx(_.languages),t.R7$(5),t.R50("ngModel",_.formValues.recordExport),t.R7$(5),t.vxM(26,_.hasIdList?26:-1),t.R7$(4),t.R50("ngModel",_.formValues.languageReferences),t.Y8G("disabled","Blank"===_.formValues.recordExport),t.R7$(8),t.R50("ngModel",_.formValues.resourcesReferences),t.Y8G("disabled","Blank"===_.formValues.recordExport),t.R7$(8),t.Y8G("disabled",!E.form.valid)}}let P=(()=>{class d{constructor(E,_){this.dialogRef=E,this.route=_,this.hostClass="dialog-component",this.contentExportService=(0,f.d)(C.D),this.contentTypesService=(0,f.d)(O.g),this.appDialogConfigService=(0,f.d)(M.b),this.hasIdList=!1,this.loading$=new D.t(!1),this.contentType$=new D.t(null),this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName");const a=this.route.snapshot.paramMap.get("selectedIds");this.hasIdList=!!a,this.hasIdList&&(this.itemIds=a.split(",").map(u=>parseInt(u,10)))}ngOnInit(){this.loading$.next(!0);const E=this.contentTypesService.retrieveContentType(this.contentTypeStaticName),_=this.appDialogConfigService.getCurrent$();(0,h.p)([E,_]).subscribe(([a,u])=>{this.contentType$.next(a),this.languages=u.Context.Language.List,this.formValues={defaultLanguage:u.Context.Language.Primary,contentTypeStaticName:this.contentTypeStaticName,language:"",recordExport:this.hasIdList?"Selection":"All",languageReferences:"Link",resourcesReferences:"Link"},this.loading$.next(!1)})}ngOnDestroy(){this.contentType$.complete(),this.loading$.complete()}closeDialog(){this.dialogRef.close()}exportContent(){this.contentExportService.exportContent(this.formValues,this.hasIdList&&"Selection"===this.formValues.recordExport?this.itemIds:null)}static#t=this.\u0275fac=function(_){return new(_||d)(t.rXU(i.CP),t.rXU(l.nX))};static#e=this.\u0275cmp=t.VBU({type:d,selectors:[["app-content-export"]],hostVars:1,hostBindings:function(_,a){2&_&&t.Mr5("className",a.hostClass)},standalone:!0,features:[t.aNF],decls:7,vars:6,consts:[["ngForm","ngForm"],[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],["href","https://2sxc.org/help","target","_blank"],[1,"dialog-form-content","fancy-scrollbar-light"],["color","accent",1,"eav-mat-form-field"],["name","Language",3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"eav-radio-group-label"],["name","RecordExport",1,"eav-radio-group",3,"ngModelChange","ngModel"],["value","Blank"],["value","All"],["value","Selection"],["name","LanguageReferences",1,"eav-radio-group",3,"ngModelChange","ngModel","disabled"],["value","Link"],["value","Resolve"],["name","ResourcesReferences",1,"eav-radio-group",3,"ngModelChange","ngModel","disabled"],["align","end"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"click","disabled"]],template:function(_,a){if(1&_&&(t.j41(0,"div",1)(1,"div",2)(2,"div",3),t.EFF(3),t.nI1(4,"async"),t.k0s()(),t.DNE(5,c,48,8,"form"),t.nI1(6,"async"),t.k0s()),2&_){let u;t.R7$(3),t.SpI("Export ",null==(u=t.bMT(4,2,a.contentType$))?null:u.Name,""),t.R7$(2),t.vxM(5,!1===t.bMT(6,4,a.loading$)?5:-1)}},dependencies:[r.YN,r.qT,r.BC,r.cb,r.vS,r.cV,g.RG,g.rl,g.nJ,I.Ve,I.VO,m.wT,m.Sy,n.Wk,n.VT,n._g,i.E7,p.Hl,p.$z,x.Jj],styles:[".eav-radio-group-label[_ngcontent-%COMP%]{font-size:18px;margin:24px 0 0}.eav-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:8px 0}"]})}return d})()},1576:(T,v,e)=>{e.d(v,{W:()=>D});var i=e(3826);class D{static#t=this.boolEquals={equal:i.a.valueEquals};static#e=this.numberEquals={equal:i.a.valueEquals};static#n=this.stringEquals={equal:i.a.valueEquals};static#a=this.objectEquals={equal:i.a.objectsEqual}}},9234:(T,v,e)=>{e.d(v,{Gg:()=>f,Tr:()=>t,gb:()=>r});var i=e(1567),D=e(6647),h=e(6301),M=e(271),O=e(4979),C=e(3472),x=e(4839),p=e(1736),n=e(8559),m=e(6443),I=e(4821);const r="admin/entity/",f="admin/entity/list";let t=(()=>{class l extends O.V{constructor(s,c,P,d){super(new C.B("EntityService",!1)),this.http=s,this.formConfig=c,this.dnnContext=P,this.queryService=d}getEntities$(s){return s.pipe((0,i.p)(c=>null!=c),(0,D.n)(c=>this.getAvailableEntities(c.contentTypeName).pipe((0,h.t)(1))))}getAvailableEntities(s,c){var P=this.log.rxTap("getEntities",{enabled:!0});return this.queryService.getEntities({contentTypes:[s],itemIds:c,fields:"Id,Guid,Title",log:"getAvailableEntities"}).pipe(P.pipe(),(0,M.T)(d=>d.Default))}delete(s,c,P,d,R){return this.http.delete(this.dnnContext.$2sxc.http.apiUrl(r+"delete"),{params:{contentType:s,id:c.toString(),appId:this.formConfig.config.appId,force:P.toString(),...d&&{parentId:d.toString()},...d&&R&&{parentField:R}}})}static#t=this.\u0275fac=function(c){return new(c||l)(n.KVO(m.Qq),n.KVO(p.S),n.KVO(I.ob),n.KVO(x.c))};static#e=this.\u0275prov=n.jDH({token:l,factory:l.\u0275fac})}return l})()},4858:(T,v,e)=>{e.d(v,{D:()=>n});var i=e(8559),D=e(6042),h=e(271),M=e(4979),O=e(3472),C=e(1576),x=e(3826);let n=(()=>{class m extends M.V{constructor(){super(new O.B("FeaturesService",!1)),this.dialogContext$=new D.m(1),this.dialogContextSignal=(0,i.vPA)(null)}loadFromService(g){g.getCurrent$().subscribe(r=>this.load(r.Context))}load(g){this.dialogContext$.next(g),this.dialogContextSignal.set(g)}getAll(){return(0,i.EWP)(()=>this.dialogContextSignal()?.Features??[],{equal:x.a.arraysEqual})}get$(g){return this.dialogContext$.pipe((0,h.T)(r=>r?.Features.find(f=>f.nameId===g)))}getSignal(g){return(0,i.EWP)(()=>this.dialogContextSignal()?.Features.find(r=>r.nameId===g),{equal:x.a.objectsEqual})}isEnabled$(g){return this.get$(g).pipe((0,h.T)(r=>r?.isEnabled??!1))}isEnabled(g){return(0,i.EWP)(()=>this.dialogContextSignal()?.Features.find(r=>r.nameId===g)?.isEnabled??!1,C.W.boolEquals)}static#t=this.\u0275fac=function(r){return new(r||m)};static#e=this.\u0275prov=i.jDH({token:m,factory:m.\u0275fac,providedIn:"root"})}return m})()},9431:(T,v,e)=>{e.d(v,{B:()=>O});var i=e(8559),D=e(9074),h=e(8172),M=e(3347);let O=(()=>{class C{constructor(p){this.snackBar=p,this.debugState=(0,i.vPA)(null),this.isDebug=(0,i.EWP)(()=>!!this.debugState()?.allowDebugMode&&!!this.debugState()?.debugEnabled),this.debugEnabled$=(0,D.br)(this.isDebug);const n={id:0,debugEnabled:"true"===sessionStorage.getItem(h.tn),allowDebugMode:!1};this.debugState.set(n)}allowDebug(p){const n=this.debugState();if(n.allowDebugMode===p)return;const m={...n,allowDebugMode:p};this.debugState.set(m)}toggleDebugEnabled(){const p=this.debugState();if(!p.allowDebugMode)return void this.snackBar.open("You do not have permissions to enter developer mode",null,{duration:3e3});const n={...p,debugEnabled:!p.debugEnabled};this.debugState.set(n),this.snackBar.open(n.debugEnabled?"developer mode on":"developer mode off",null,{duration:3e3})}static#t=this.\u0275fac=function(n){return new(n||C)(i.KVO(M.UG))};static#e=this.\u0275prov=i.jDH({token:C,factory:C.\u0275fac,providedIn:"root"})}return C})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/18.00.01/dist/ng-edit/projects_eav-ui_src_app_content-export_content-export_component_ts-projects_eav-ui_src_app_sh-5eade4.c92f4b1ae87e699e.js.map