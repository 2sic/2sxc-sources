{"version":3,"mappings":"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","names":["ContentItemsService","http","context","dnnContext","this","contentTypeStaticName","get","$2sxc","apiUrl","webApiEntityList","params","appId","toString","contentType","webApiFieldsAll","staticName","file","from","toBase64","pipe","mergeMap","y","post","webApiEntityRoot","AppId","ContentBase64","fileBase64","p","i0","factory","MetadataActionsComponent","onDelete","data","c","selectors","ctx","ctx_r12","ctx_r14","ctx_r15","ctx_r16","ctx_r17","MetadataSaveDialogComponent","dialogRef","contentTypesService","C","dropdownInsertValue","contentTypes$","BehaviorSubject","scopeOptions$","buildForm","fetchScopes","templateVars$","combineLatest","map","contentTypes","i","scopeOptions","complete","close","guidedContentType","event","advancedMode","checked","formValues","form","getRawValue","closeDialog","FormGroup","addControl","FormControl","Validators","eavConstants","controls","scope","valueChanges","startWith","value","distinctUntilChanged","subscribe","newScope","e","patchValue","prompt","some","option","next","name","concat","fetchContentTypes","retrieveContentTypes","getScopes","scopes","ctx_r19","ctx_r21","ctx_r23","ctx_r25","MetadataComponent","router","route","metadataService","snackBar","entitiesService","contentItemsService","dialog","viewContainerRef","changeDetectorRef","AllCommunityModules","Object","defaultGridOptions","frameworkComponents","idFieldComponent","IdFieldComponent","metadataActionsComponent","columnDefs","headerName","field","width","headerClass","cellClass","cellRenderer","sortable","filter","cellRendererParams","tooltipGetter","metadata","Id","Guid","flex","minWidth","sort","onCellClicked","editMetadata","bind","valueGetter","_Type","Name","Description","pinned","deleteMetadata","undefined","Subscription","parseInt","snapshot","paramMap","decodeURIComponent","$","_a","fetchFor","fetchMetadata","refreshOnChildClosed","metadata$","recommendations$","itemFor$","fabOpen$","recommendations","itemFor","fabOpen","subscription","unsubscribe","open","recommendation","CreateEmpty","create","For","calculateItemFor","error","duration","createMetadataForm","autoFocus","afterClosed","items","ContentTypeName","formUrl","convertFormToUrl","navigate","relativeTo","markForCheck","Target","r","values","find","m","targetType","target","_b","TargetType","keyType","key","Number","String","getAll","item","getMetadata","Items","filtered","Recommendations","Count","EntityId","warning","DeleteWarning","Title","confirm","delete","add","events","NavigationEnd","firstChild","pairwise","FieldHintComponent","isShort","u","ClickStopPropagationDirective","stopPropagation","d","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","split","onerror","readAsText"],"sources":["./projects/ng-dialogs/src/app/content-items/services/content-items.service.ts","./projects/ng-dialogs/src/app/metadata/ag-grid-components/metadata-actions/metadata-actions.component.ts","./projects/ng-dialogs/src/app/metadata/ag-grid-components/metadata-actions/metadata-actions.component.html","./projects/ng-dialogs/src/app/metadata/metadata-save-dialog/metadata-save-dialog.component.html","./projects/ng-dialogs/src/app/metadata/metadata-save-dialog/metadata-save-dialog.component.ts","./projects/ng-dialogs/src/app/metadata/metadata.component.html","./projects/ng-dialogs/src/app/metadata/metadata.component.ts","./projects/ng-dialogs/src/app/shared/components/field-hint/field-hint.component.html","./projects/ng-dialogs/src/app/shared/components/field-hint/field-hint.component.ts","./projects/ng-dialogs/src/app/shared/directives/click-stop-propagation.directive.ts","./projects/ng-dialogs/src/app/shared/helpers/file-to-base64.helper.ts"],"sourcesContent":["import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { from } from 'rxjs';\r\nimport { mergeMap } from 'rxjs/operators';\r\nimport { webApiEntityList, webApiEntityRoot } from '../../../../../edit/shared/services';\r\nimport { Field } from '../../content-type-fields/models/field.model';\r\nimport { webApiFieldsAll } from '../../content-type-fields/services/content-types-fields.service';\r\nimport { toBase64 } from '../../shared/helpers/file-to-base64.helper';\r\nimport { Context } from '../../shared/services/context';\r\nimport { ContentItem } from '../models/content-item.model';\r\n\r\n@Injectable()\r\nexport class ContentItemsService {\r\n  constructor(private http: HttpClient, private context: Context, private dnnContext: DnnContext) { }\r\n\r\n  getAll(contentTypeStaticName: string) {\r\n    return this.http.get<ContentItem[]>(this.dnnContext.$2sxc.http.apiUrl(webApiEntityList), {\r\n      params: { appId: this.context.appId.toString(), contentType: contentTypeStaticName }\r\n    });\r\n  }\r\n\r\n  getColumns(contentTypeStaticName: string) {\r\n    return this.http.get<Field[]>(this.dnnContext.$2sxc.http.apiUrl(webApiFieldsAll), {\r\n      params: { appId: this.context.appId.toString(), staticName: contentTypeStaticName }\r\n    });\r\n  }\r\n\r\n  importItem(file: File) {\r\n    return from(toBase64(file)).pipe(\r\n      mergeMap(fileBase64 => {\r\n        return this.http.post<boolean>(this.dnnContext.$2sxc.http.apiUrl(webApiEntityRoot + 'upload'), {\r\n          AppId: this.context.appId.toString(),\r\n          ContentBase64: fileBase64,\r\n        });\r\n      })\r\n    );\r\n  }\r\n}\r\n","import { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { Component } from '@angular/core';\r\nimport { MetadataItem } from '../../models/metadata.model';\r\nimport { MetadataActionsParams } from './metadata-actions.models';\r\n\r\n@Component({\r\n  selector: 'app-metadata-actions',\r\n  templateUrl: './metadata-actions.component.html',\r\n  styleUrls: ['./metadata-actions.component.scss'],\r\n})\r\nexport class MetadataActionsComponent implements ICellRendererAngularComp {\r\n  private params: MetadataActionsParams;\r\n\r\n  agInit(params: MetadataActionsParams) {\r\n    this.params = params;\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n\r\n  deleteMetadata() {\r\n    const metadata: MetadataItem = this.params.data;\r\n    this.params.onDelete(metadata);\r\n  }\r\n}\r\n","<div class=\"actions-component\">\r\n  <div class=\"like-button highlight\" matRipple tippy=\"Delete\" (click)=\"deleteMetadata()\">\r\n    <mat-icon>delete</mat-icon>\r\n  </div>\r\n</div>\r\n","<ng-container *ngIf=\"templateVars$ | async as data\">\r\n  <div mat-dialog-title>\r\n    <div class=\"dialog-title-box\">Create Metadata</div>\r\n  </div>\r\n\r\n  <p class=\"dialog-description\">\r\n    This is a special operation to add an item which is metadata for another item,\r\n    see <a href=\"http://r.2sxc.org/metadata\" target=\"_blank\">docs</a>.\r\n  </p>\r\n\r\n  <form [formGroup]=\"form\" class=\"dialog-form\">\r\n    <div class=\"dialog-form-content fancy-scrollbar-light\">\r\n\r\n      <!-- Scope -->\r\n      <ng-container *ngIf=\"advancedMode && guidedContentType\">\r\n        <mat-form-field appearance=\"standard\" color=\"accent\">\r\n          <mat-label>Scope</mat-label>\r\n          <mat-select formControlName=\"scope\" [placeholder]=\"!data.scopeOptions.length ? 'No items found' : ''\">\r\n            <mat-option *ngFor=\"let scopeOption of data.scopeOptions\" [value]=\"scopeOption.value\">\r\n              {{ scopeOption.name }}\r\n            </mat-option>\r\n            <mat-option [value]=\"dropdownInsertValue\">Other...</mat-option>\r\n          </mat-select>\r\n        </mat-form-field>\r\n        <app-field-hint>\r\n          The scope should almost never be changed -\r\n          <a href=\"https://2sxc.org/help?tag=scope\" target=\"_blank\" appClickStopPropagation>see help</a>\r\n        </app-field-hint>\r\n      </ng-container>\r\n\r\n      <!-- Content Type of metadata item -->\r\n      <mat-form-field appearance=\"standard\" color=\"accent\">\r\n        <mat-label>Content Type</mat-label>\r\n        <mat-select *ngIf=\"guidedContentType\" formControlName=\"contentType\" required\r\n          [placeholder]=\"!data.contentTypes.length ? 'No items found' : ''\">\r\n          <mat-option *ngFor=\"let contentType of data.contentTypes\" [value]=\"contentType.StaticName\">\r\n            {{ contentType.Label }}\r\n          </mat-option>\r\n        </mat-select>\r\n\r\n        <input matInput type=\"text\" *ngIf=\"!guidedContentType\" formControlName=\"contentType\" required>\r\n\r\n        <div matSuffix class=\"selection-suffix\">\r\n          <button mat-icon-button type=\"button\" [ngClass]=\"{ 'active': guidedContentType }\" tippy=\"Pick existing value\"\r\n            (click)=\"toggleGuidedContentType(true)\">\r\n            <mat-icon>search</mat-icon>\r\n          </button>\r\n          <button mat-icon-button type=\"button\" [ngClass]=\"{ 'active': !guidedContentType }\" tippy=\"Manual entry\"\r\n            (click)=\"toggleGuidedContentType(false)\">\r\n            <mat-icon>text_fields</mat-icon>\r\n          </button>\r\n        </div>\r\n      </mat-form-field>\r\n      <app-field-hint *ngIf=\"form.controls.contentType.touched && form.controls.contentType.errors?.required\"\r\n        [isError]=\"true\">\r\n        This field is required\r\n      </app-field-hint>\r\n    </div>\r\n\r\n    <div class=\"dialog-form-actions\">\r\n      <mat-slide-toggle color=\"accent\" [checked]=\"advancedMode\" (change)=\"toggleAdvancedMode($event)\">\r\n        {{ advancedMode ? 'Advanced' : 'Simple' }}\r\n      </mat-slide-toggle>\r\n      <div class=\"spacer\"></div>\r\n      <button mat-raised-button type=\"button\" (click)=\"closeDialog()\">Cancel</button>\r\n      <button mat-raised-button type=\"button\" color=\"accent\" [disabled]=\"!form.valid\" (click)=\"confirm()\">\r\n        Confirm\r\n      </button>\r\n    </div>\r\n  </form>\r\n</ng-container>\r\n","import { Component, HostBinding, OnDestroy, OnInit } from '@angular/core';\r\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\r\nimport { MatDialogRef } from '@angular/material/dialog';\r\nimport { MatSlideToggleChange } from '@angular/material/slide-toggle';\r\nimport { BehaviorSubject, combineLatest, Observable } from 'rxjs';\r\nimport { distinctUntilChanged, map, startWith } from 'rxjs/operators';\r\nimport { ContentType } from '../../app-administration/models';\r\nimport { ContentTypesService } from '../../app-administration/services';\r\nimport { dropdownInsertValue } from '../../shared/constants/dropdown-insert-value.constant';\r\nimport { eavConstants, ScopeOption } from '../../shared/constants/eav.constants';\r\nimport { MetadataSaveDialogTemplateVars, MetadataSaveFormValues } from './metadata-save-dialog.models';\r\n\r\n@Component({\r\n  selector: 'app-metadata-save-dialog',\r\n  templateUrl: './metadata-save-dialog.component.html',\r\n  styleUrls: ['./metadata-save-dialog.component.scss']\r\n})\r\nexport class MetadataSaveDialogComponent implements OnInit, OnDestroy {\r\n  @HostBinding('className') hostClass = 'dialog-component';\r\n\r\n  form: FormGroup;\r\n  dropdownInsertValue = dropdownInsertValue;\r\n  templateVars$: Observable<MetadataSaveDialogTemplateVars>;\r\n  guidedContentType = true;\r\n  advancedMode = false;\r\n\r\n  private contentTypes$: BehaviorSubject<ContentType[]>;\r\n  private scopeOptions$: BehaviorSubject<ScopeOption[]>;\r\n\r\n  constructor(\r\n    private dialogRef: MatDialogRef<MetadataSaveDialogComponent>,\r\n    private contentTypesService: ContentTypesService,\r\n  ) { }\r\n\r\n  ngOnInit(): void {\r\n    this.contentTypes$ = new BehaviorSubject<ContentType[]>([]);\r\n    this.scopeOptions$ = new BehaviorSubject<ScopeOption[]>([]);\r\n\r\n    this.buildForm();\r\n    this.fetchScopes();\r\n\r\n    this.templateVars$ = combineLatest([this.contentTypes$, this.scopeOptions$]).pipe(\r\n      map(([contentTypes, scopeOptions]) => {\r\n        const templateVars: MetadataSaveDialogTemplateVars = {\r\n          contentTypes,\r\n          scopeOptions,\r\n        };\r\n        return templateVars;\r\n      }),\r\n    );\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.contentTypes$.complete();\r\n    this.scopeOptions$.complete();\r\n  }\r\n\r\n  closeDialog(contentType?: string): void {\r\n    this.dialogRef.close(contentType);\r\n  }\r\n\r\n  toggleGuidedContentType(guidedContentType: boolean): void {\r\n    this.guidedContentType = guidedContentType;\r\n  }\r\n\r\n  toggleAdvancedMode(event: MatSlideToggleChange): void {\r\n    this.advancedMode = event.checked;\r\n  }\r\n\r\n  confirm(): void {\r\n    const formValues: MetadataSaveFormValues = this.form.getRawValue();\r\n    this.closeDialog(formValues.contentType);\r\n  }\r\n\r\n  private buildForm(): void {\r\n    this.form = new FormGroup({});\r\n    this.form.addControl('contentType', new FormControl(null, [Validators.required]));\r\n    this.form.addControl('scope', new FormControl(eavConstants.scopes.default.value));\r\n\r\n    this.form.controls.scope.valueChanges.pipe(\r\n      startWith(this.form.controls.scope.value),\r\n      distinctUntilChanged(),\r\n    ).subscribe((newScope: string) => {\r\n      // reset content types when scope changes\r\n      if (this.form.controls.contentType.value != null) {\r\n        this.form.controls.contentType.patchValue(null);\r\n      }\r\n\r\n      // add new scope on manual entry\r\n      if (newScope === dropdownInsertValue) {\r\n        newScope = prompt('This is an advanced feature to show content-types of another scope. Don\\'t use this if you don\\'t know what you\\'re doing, as content-types of other scopes are usually hidden for a good reason.') || eavConstants.scopes.default.value;\r\n        if (!this.scopeOptions$.value.some(option => option.value === newScope)) {\r\n          const newScopeOption: ScopeOption = {\r\n            name: newScope,\r\n            value: newScope,\r\n          };\r\n          this.scopeOptions$.next([newScopeOption, ...this.scopeOptions$.value]);\r\n        }\r\n        this.form.controls.scope.patchValue(newScope);\r\n      } else {\r\n        this.fetchContentTypes(newScope);\r\n      }\r\n    });\r\n  }\r\n\r\n  private fetchContentTypes(scope: string): void {\r\n    this.contentTypesService.retrieveContentTypes(scope).subscribe(contentTypes => {\r\n      this.contentTypes$.next(contentTypes);\r\n    });\r\n  }\r\n\r\n  private fetchScopes(): void {\r\n    this.contentTypesService.getScopes().subscribe(scopes => {\r\n      this.scopeOptions$.next(scopes);\r\n    });\r\n  }\r\n}\r\n","<ng-container *ngIf=\"templateVars$ | async as data\">\r\n  <div class=\"nav-component-wrapper\">\r\n    <div mat-dialog-title>\r\n      <div class=\"dialog-title-box\">\r\n        <div>{{ title || 'Metadata' }}</div>\r\n        <button mat-icon-button tippy=\"Close dialog\" (click)=\"closeDialog()\">\r\n          <mat-icon>close</mat-icon>\r\n        </button>\r\n      </div>\r\n    </div>\r\n\r\n    <p class=\"dialog-description\">\r\n      <ng-container *ngIf=\"!data.itemFor\">This item is not metadata for anything else.</ng-container>\r\n      <ng-container *ngIf=\"data.itemFor\">\r\n        This item is metadata for:\r\n        <br>Target: {{ data.itemFor.Target }}\r\n        <br>TargetType: {{ data.itemFor.TargetType }}\r\n        <ng-container *ngIf=\"data.itemFor.Number\"><br>Number: {{ data.itemFor.Number }}</ng-container>\r\n        <ng-container *ngIf=\"data.itemFor.Guid\"><br>Guid: {{ data.itemFor.Guid }}</ng-container>\r\n        <ng-container *ngIf=\"data.itemFor.String\"><br>String: {{ data.itemFor.String }}</ng-container>\r\n        <ng-container *ngIf=\"data.itemFor.Title\"><br>Title: {{ data.itemFor.String }}</ng-container>\r\n      </ng-container>\r\n    </p>\r\n\r\n    <router-outlet></router-outlet>\r\n\r\n    <div class=\"grid-wrapper\">\r\n      <ag-grid-angular class=\"ag-theme-material\" [rowData]=\"data.metadata\" [modules]=\"modules\"\r\n        [gridOptions]=\"gridOptions\">\r\n      </ag-grid-angular>\r\n\r\n      <div class=\"grid-more-actions-box\"></div>\r\n\r\n      <button mat-fab mat-elevation-z24 class=\"grid-fab\" *ngIf=\"data.recommendations.length === 0\"\r\n        tippy=\"Create a new metadata for this item\" (click)=\"createMetadata()\">\r\n        <mat-icon>add</mat-icon>\r\n      </button>\r\n\r\n      <eco-fab-speed-dial class=\"grid-fab\" [ngClass]=\"{ 'fab-opened': data.fabOpen }\"\r\n        *ngIf=\"data.recommendations.length > 0\" (openChange)=\"openChange($event)\">\r\n        <eco-fab-speed-dial-trigger [spin]=\"true\">\r\n          <button mat-fab>\r\n            <mat-icon class=\"spin180\">{{ data.fabOpen ? 'close' : 'add' }}</mat-icon>\r\n          </button>\r\n        </eco-fab-speed-dial-trigger>\r\n\r\n        <eco-fab-speed-dial-actions>\r\n          <button mat-mini-fab label=\"Other Content Type\" (click)=\"createMetadata()\">\r\n            <mat-icon>search</mat-icon>\r\n          </button>\r\n          <button mat-mini-fab *ngFor=\"let recommendation of data.recommendations\" [attr.label]=\"recommendation.Title\"\r\n            (click)=\"createMetadata(recommendation)\">\r\n            <mat-icon>{{ recommendation.Icon || 'add' }}</mat-icon>\r\n          </button>\r\n        </eco-fab-speed-dial-actions>\r\n      </eco-fab-speed-dial>\r\n    </div>\r\n  </div>\r\n</ng-container>\r\n","import { AllCommunityModules, CellClickedEvent, GridOptions } from '@ag-grid-community/all-modules';\r\nimport { ChangeDetectorRef, Component, OnDestroy, OnInit, ViewContainerRef } from '@angular/core';\r\nimport { MatDialog, MatDialogRef } from '@angular/material/dialog';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { ActivatedRoute, NavigationEnd, Router } from '@angular/router';\r\nimport { BehaviorSubject, combineLatest, Observable, Subscription } from 'rxjs';\r\nimport { filter, map, pairwise, startWith } from 'rxjs/operators';\r\nimport { EavFor } from '../../../../edit/shared/models/eav';\r\nimport { ContentItemsService } from '../content-items/services/content-items.service';\r\nimport { EntitiesService } from '../content-items/services/entities.service';\r\nimport { MetadataService } from '../permissions';\r\nimport { IdFieldComponent } from '../shared/components/id-field/id-field.component';\r\nimport { IdFieldParams } from '../shared/components/id-field/id-field.models';\r\nimport { defaultGridOptions } from '../shared/constants/default-grid-options.constants';\r\nimport { eavConstants, MetadataKeyType } from '../shared/constants/eav.constants';\r\nimport { convertFormToUrl } from '../shared/helpers/url-prep.helper';\r\nimport { EditForm } from '../shared/models/edit-form.model';\r\nimport { MetadataActionsComponent } from './ag-grid-components/metadata-actions/metadata-actions.component';\r\nimport { MetadataActionsParams } from './ag-grid-components/metadata-actions/metadata-actions.models';\r\nimport { MetadataSaveDialogComponent } from './metadata-save-dialog/metadata-save-dialog.component';\r\nimport { MetadataItem, MetadataRecommendation, MetadataTemplateVars } from './models/metadata.model';\r\n\r\n@Component({\r\n  selector: 'app-metadata',\r\n  templateUrl: './metadata.component.html',\r\n  styleUrls: ['./metadata.component.scss'],\r\n})\r\nexport class MetadataComponent implements OnInit, OnDestroy {\r\n  modules = AllCommunityModules;\r\n  gridOptions: GridOptions = {\r\n    ...defaultGridOptions,\r\n    frameworkComponents: {\r\n      idFieldComponent: IdFieldComponent,\r\n      metadataActionsComponent: MetadataActionsComponent,\r\n    },\r\n    columnDefs: [\r\n      {\r\n        headerName: 'ID', field: 'Id', width: 70, headerClass: 'dense', cellClass: 'id-action no-padding no-outline',\r\n        cellRenderer: 'idFieldComponent', sortable: true, filter: 'agTextColumnFilter',\r\n        cellRendererParams: {\r\n          tooltipGetter: (metadata: MetadataItem) => `ID: ${metadata.Id}\\nGUID: ${metadata.Guid}`,\r\n        } as IdFieldParams,\r\n      },\r\n      {\r\n        headerName: 'Title', field: 'Title', flex: 2, minWidth: 250, cellClass: 'primary-action highlight',\r\n        sortable: true, sort: 'asc', filter: 'agTextColumnFilter', onCellClicked: this.editMetadata.bind(this),\r\n      },\r\n      {\r\n        headerName: 'Content Type', flex: 2, minWidth: 250, cellClass: 'no-outline', sortable: true,\r\n        filter: 'agTextColumnFilter', valueGetter: (params) => {\r\n          const metadata = params.data as MetadataItem;\r\n          return `${metadata._Type.Name}${metadata._Type.Description ? ` (${metadata._Type.Description})` : ''}`;\r\n        },\r\n      },\r\n      {\r\n        width: 42, cellClass: 'secondary-action no-padding', cellRenderer: 'metadataActionsComponent', pinned: 'right',\r\n        cellRendererParams: {\r\n          onDelete: this.deleteMetadata.bind(this),\r\n        } as MetadataActionsParams,\r\n      },\r\n    ],\r\n  };\r\n\r\n  private metadata$ = new BehaviorSubject<MetadataItem[]>([]);\r\n  private recommendations$ = new BehaviorSubject<MetadataRecommendation[]>([]);\r\n  private itemFor$ = new BehaviorSubject<EavFor | undefined>(undefined);\r\n  private fabOpen$ = new BehaviorSubject(false);\r\n  private subscription = new Subscription();\r\n  private targetType = parseInt(this.route.snapshot.paramMap.get('targetType'), 10);\r\n  private keyType = this.route.snapshot.paramMap.get('keyType') as MetadataKeyType;\r\n  private key = this.route.snapshot.paramMap.get('key');\r\n  title = decodeURIComponent(this.route.snapshot.paramMap.get('title') ?? '');\r\n  private contentTypeStaticName = this.route.snapshot.paramMap.get('contentTypeStaticName');\r\n  templateVars$: Observable<MetadataTemplateVars>;\r\n\r\n  constructor(\r\n    private dialogRef: MatDialogRef<MetadataComponent>,\r\n    private router: Router,\r\n    private route: ActivatedRoute,\r\n    private metadataService: MetadataService,\r\n    private snackBar: MatSnackBar,\r\n    private entitiesService: EntitiesService,\r\n    private contentItemsService: ContentItemsService,\r\n    private dialog: MatDialog,\r\n    private viewContainerRef: ViewContainerRef,\r\n    private changeDetectorRef: ChangeDetectorRef,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.fetchFor();\r\n    this.fetchMetadata();\r\n    this.refreshOnChildClosed();\r\n\r\n    this.templateVars$ = combineLatest([this.metadata$, this.recommendations$, this.itemFor$, this.fabOpen$]).pipe(\r\n      map(([metadata, recommendations, itemFor, fabOpen]) => {\r\n        const templateVars: MetadataTemplateVars = {\r\n          metadata,\r\n          recommendations,\r\n          itemFor,\r\n          fabOpen,\r\n        };\r\n        return templateVars;\r\n      }),\r\n    );\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.metadata$.complete();\r\n    this.recommendations$.complete();\r\n    this.itemFor$.complete();\r\n    this.fabOpen$.complete();\r\n    this.subscription.unsubscribe();\r\n  }\r\n\r\n  closeDialog() {\r\n    this.dialogRef.close();\r\n  }\r\n\r\n  openChange(open: boolean) {\r\n    this.fabOpen$.next(open);\r\n  }\r\n\r\n  createMetadata(recommendation?: MetadataRecommendation) {\r\n    if (recommendation) {\r\n      if (recommendation.CreateEmpty) {\r\n        this.snackBar.open(`Creating ${recommendation.Name}...`);\r\n        this.entitiesService.create(recommendation.Id, { For: this.calculateItemFor() }).subscribe({\r\n          error: () => {\r\n            this.snackBar.open(`Creating ${recommendation.Name} failed. Please check console for more info`, undefined, { duration: 3000 });\r\n            this.fetchMetadata();\r\n          },\r\n          next: () => {\r\n            this.snackBar.open(`Created ${recommendation.Name}`, undefined, { duration: 3000 });\r\n            this.fetchMetadata();\r\n          },\r\n        });\r\n      } else {\r\n        this.createMetadataForm(recommendation.Id);\r\n      }\r\n      return;\r\n    }\r\n    const metadataDialogRef = this.dialog.open(MetadataSaveDialogComponent, {\r\n      autoFocus: false,\r\n      viewContainerRef: this.viewContainerRef,\r\n      width: '650px',\r\n    });\r\n    metadataDialogRef.afterClosed().subscribe((contentType?: string) => {\r\n      if (contentType == null) { return; }\r\n      this.createMetadataForm(contentType);\r\n    });\r\n  }\r\n\r\n  private createMetadataForm(contentType: string) {\r\n    const form: EditForm = {\r\n      items: [{\r\n        ContentTypeName: contentType,\r\n        For: this.calculateItemFor(),\r\n      }],\r\n    };\r\n    const formUrl = convertFormToUrl(form);\r\n    this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route });\r\n    this.changeDetectorRef.markForCheck();\r\n  }\r\n\r\n  private calculateItemFor(): EavFor {\r\n    const itemFor: EavFor = {\r\n      Target: Object.values(eavConstants.metadata).find(m => m.targetType === this.targetType)?.target ?? this.targetType.toString(),\r\n      TargetType: this.targetType,\r\n      ...(this.keyType === eavConstants.keyTypes.guid && { Guid: this.key }),\r\n      ...(this.keyType === eavConstants.keyTypes.number && { Number: parseInt(this.key, 10) }),\r\n      ...(this.keyType === eavConstants.keyTypes.string && { String: this.key }),\r\n    };\r\n    return itemFor;\r\n  }\r\n\r\n  private fetchFor() {\r\n    if (!this.contentTypeStaticName) { return; }\r\n\r\n    this.contentItemsService.getAll(this.contentTypeStaticName).subscribe(items => {\r\n      const item = items.find(i => i.Guid === this.key);\r\n      if (item?.For) {\r\n        this.itemFor$.next(item.For);\r\n      }\r\n    });\r\n  }\r\n\r\n  private fetchMetadata() {\r\n    this.metadataService.getMetadata(this.targetType, this.keyType, this.key).subscribe(metadata => {\r\n      this.metadata$.next(metadata.Items);\r\n      const filtered = metadata.Recommendations.filter(r => r.Count === 1 && !metadata.Items.some(i => i._Type.Id === r.Id));\r\n      this.recommendations$.next(filtered);\r\n    });\r\n  }\r\n\r\n  private editMetadata(params: CellClickedEvent) {\r\n    const metadata: MetadataItem = params.data;\r\n    const form: EditForm = {\r\n      items: [{ EntityId: metadata.Id }],\r\n    };\r\n    const formUrl = convertFormToUrl(form);\r\n    this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route });\r\n  }\r\n\r\n  private deleteMetadata(metadata: MetadataItem) {\r\n    let warning = this.recommendations$.value.find(r => r.Id === metadata._Type.Id)?.DeleteWarning || '';\r\n    warning = warning\r\n      ? `${warning}\\n\\nAre you sure you want to delete '${metadata.Title}' (${metadata.Id})?`\r\n      : `Delete '${metadata.Title}' (${metadata.Id})?`;\r\n    if (!confirm(warning)) { return; }\r\n\r\n    this.snackBar.open('Deleting...');\r\n    this.entitiesService.delete(metadata._Type.Id, metadata.Id, false).subscribe({\r\n      next: () => {\r\n        this.snackBar.open('Deleted', null, { duration: 2000 });\r\n        this.fetchMetadata();\r\n      },\r\n      error: () => {\r\n        this.snackBar.open('Delete failed. Please check console for more information', null, { duration: 3000 });\r\n      }\r\n    });\r\n  }\r\n\r\n  private refreshOnChildClosed() {\r\n    this.subscription.add(\r\n      this.router.events.pipe(\r\n        filter(event => event instanceof NavigationEnd),\r\n        startWith(!!this.route.snapshot.firstChild),\r\n        map(() => !!this.route.snapshot.firstChild),\r\n        pairwise(),\r\n        filter(([hadChild, hasChild]) => hadChild && !hasChild),\r\n      ).subscribe(() => {\r\n        this.fetchMetadata();\r\n      })\r\n    );\r\n  }\r\n\r\n}\r\n","<div class=\"hint-box\" (click)=\"toggleIsShort()\" [ngClass]=\"{ 'hint-box__short': isShort }\" [ngSwitch]=\"isError\">\r\n  <mat-hint *ngSwitchCase=\"false\">\r\n    <ng-container *ngTemplateOutlet=\"content\"></ng-container>\r\n  </mat-hint>\r\n\r\n  <mat-error *ngSwitchCase=\"true\">\r\n    <ng-container *ngTemplateOutlet=\"content\"></ng-container>\r\n  </mat-error>\r\n</div>\r\n\r\n<ng-template #content>\r\n  <ng-content></ng-content>\r\n</ng-template>\r\n","import { Component, Input } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-field-hint',\r\n  templateUrl: './field-hint.component.html',\r\n  styleUrls: ['./field-hint.component.scss'],\r\n})\r\nexport class FieldHintComponent {\r\n  @Input() isError = false;\r\n  isShort = true;\r\n\r\n  constructor() { }\r\n\r\n  toggleIsShort() {\r\n    this.isShort = !this.isShort;\r\n  }\r\n}\r\n","import { Directive, HostListener } from '@angular/core';\r\n\r\n@Directive({ selector: '[appClickStopPropagation]' })\r\nexport class ClickStopPropagationDirective {\r\n  @HostListener('click', ['$event'])\r\n  onClick(event: MouseEvent): void {\r\n    event.stopPropagation();\r\n  }\r\n}\r\n","export function toBase64(file: File): Promise<string> {\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    reader.readAsDataURL(file);\r\n    reader.onload = () => {\r\n      resolve((reader.result as string).split(',')[1]);\r\n    };\r\n    reader.onerror = error => {\r\n      reject(error);\r\n    };\r\n  });\r\n}\r\n\r\nexport function toString(file: File): Promise<string> {\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    reader.readAsText(file);\r\n    reader.onload = () => {\r\n      resolve(reader.result as string);\r\n    };\r\n    reader.onerror = error => {\r\n      reject(error);\r\n    };\r\n  });\r\n}\r\n"],"sourceRoot":"webpack:///","file":"projects_ng-dialogs_src_app_metadata_metadata_component_ts.851d89a47a1e81b8.js"}