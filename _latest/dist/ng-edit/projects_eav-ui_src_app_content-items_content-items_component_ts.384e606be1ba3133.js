"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_content-items_content-items_component_ts"],{336:(x,D,i)=>{i.d(D,{F:()=>I});var c=i(46443),M=i(14600),g=i(36647),l=i(70271),d=i(78742),v=i(70693),C=i(34435),E=i(9234),O=i(24467),_=i(99293),F=i(44444);const b={getAll:!0,getAllLive:!0,getAllOnce:!0};let I=(()=>{class m extends O.B{constructor(){super(...arguments),this.log=(0,C.Tq)({ContentItemsService:m},b)}getAllPromise(y){return this.log.fnIf("getAll",{contentTypeStaticName:y}),this.fetchPromise(E.Gg,{params:{appId:this.appId,contentType:y}})}getAllOnce(y){return this.log.fnIf("getAllOnce",{contentTypeStaticName:y}),(0,c.fx)(()=>({url:this.apiUrl(E.Gg),params:{appId:this.appId,contentType:y}}))}getAllLive(y,p){return this.log.fnIf("getAllLive",{contentTypeStaticName:y,refresh:p}),(0,c.fx)(()=>(p(),{url:this.apiUrl(E.Gg),params:{appId:this.appId,contentType:y}}))}getColumnsPromise(y){return this.fetchPromise(d.z,{params:{appId:this.appId,staticName:y}})}importItem(y){return(0,M.H)((0,v.n)(y)).pipe((0,g.n)(p=>this.http.post(this.apiUrl(E.gb+"upload"),{AppId:this.appId,ContentBase64:p})),(0,l.T)(p=>({Success:p,Messages:[]})))}static#t=this.\u0275fac=(()=>{let y;return function(T){return(y||(y=_.xGo(m)))(T||m)}})();static#e=this.\u0275prov=F.jDH({token:m,factory:m.\u0275fac})}return m})()},5858:(x,D,i)=>{i.d(D,{O:()=>c});const c="DROPDOWN_INSERT_VALUE"},6663:(x,D,i)=>{i.d(D,{F:()=>O});var c=i(84175),M=i(53777),g=i(81863),l=i(69914),d=i(99293);function v(_,F){if(1&_&&(d.nrm(0,"mat-card-subtitle",0),d.nI1(1,"safeHtml")),2&_){const b=d.XpG();d.Y8G("innerHtml",d.bMT(1,1,b.dialogData.message),d.npT)}}function C(_,F){if(1&_&&d.EFF(0),2&_){const b=d.XpG();d.SpI(" ",b.dialogData.confirmTranslateKey," ")}}function E(_,F){1&_&&d.EFF(0," Delete ")}let O=(()=>{class _{constructor(b,I){this.dialogData=b,this.dialog=I,this.hostClass="dialog-component"}closeDialog(b){this.dialog.close(b)}static#t=this.\u0275fac=function(I){return new(I||_)(d.rXU(g.e),d.rXU(g.k))};static#e=this.\u0275cmp=d.VBU({type:_,selectors:[["app-confirm-delete-dialog"]],hostVars:1,hostBindings:function(I,m){2&I&&d.Avn("className",m.hostClass)},decls:11,vars:6,consts:[[3,"innerHtml"],["align","end"],["matButton","",1,"eav-card-action-button",3,"click"],["mat-button","","cdkFocusInitial","",3,"click","color"]],template:function(I,m){1&I&&(d.j41(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),d.EFF(3),d.k0s(),d.nVh(4,v,2,3,"mat-card-subtitle",0),d.k0s(),d.j41(5,"mat-card-actions",1)(6,"button",2),d.bIt("click",function(){return m.closeDialog()}),d.EFF(7,"Cancel"),d.k0s(),d.j41(8,"button",3),d.bIt("click",function(){return m.closeDialog(!0)}),d.nVh(9,C,1,1)(10,E,1,0),d.k0s()()()),2&I&&(d.R7$(3),d.E5c(" ",m.dialogData.title??"Delete"," ",m.dialogData.entityTitle," (",m.dialogData.entityId,")?"),d.R7$(),d.vxM(m.dialogData.message?4:-1),d.R7$(4),d.Y8G("color",m.dialogData.confirmColor??"warn"),d.R7$(),d.vxM(m.dialogData.confirmTranslateKey?9:10))},dependencies:[M.Hu,M.RN,M.YY,M.MM,M.Lc,M.dh,c.Hl,c.$z,l.$],styles:[".eav-card-action-button[_ngcontent-%COMP%]{margin-left:8px}"]})}return _})()},16256:(x,D,i)=>{i.d(D,{Y:()=>m,k:()=>I});var c=i(72102),M=i(51590),g=i(87438),l=i(99293),d=i(44444),v=i(37580),C=i(82981),E=i(9227),O=i(73388),_=i(8126);const F="mat-badge-content";let b=(()=>{class r{static \u0275fac=function(T){return new(T||r)};static \u0275cmp=l.VBU({type:r,selectors:[["ng-component"]],decls:0,vars:0,template:function(T,t){},styles:[".mat-badge{position:relative}.mat-badge.mat-badge{overflow:visible}.mat-badge-content{position:absolute;text-align:center;display:inline-block;transition:transform 200ms ease-in-out;transform:scale(0.6);overflow:hidden;white-space:nowrap;text-overflow:ellipsis;box-sizing:border-box;pointer-events:none;background-color:var(--mat-badge-background-color, var(--mat-sys-error));color:var(--mat-badge-text-color, var(--mat-sys-on-error));font-family:var(--mat-badge-text-font, var(--mat-sys-label-small-font));font-weight:var(--mat-badge-text-weight, var(--mat-sys-label-small-weight));border-radius:var(--mat-badge-container-shape, var(--mat-sys-corner-full))}.mat-badge-above .mat-badge-content{bottom:100%}.mat-badge-below .mat-badge-content{top:100%}.mat-badge-before .mat-badge-content{right:100%}[dir=rtl] .mat-badge-before .mat-badge-content{right:auto;left:100%}.mat-badge-after .mat-badge-content{left:100%}[dir=rtl] .mat-badge-after .mat-badge-content{left:auto;right:100%}@media(forced-colors: active){.mat-badge-content{outline:solid 1px;border-radius:0}}.mat-badge-disabled .mat-badge-content{background-color:var(--mat-badge-disabled-state-background-color, color-mix(in srgb, var(--mat-sys-error) 38%, transparent));color:var(--mat-badge-disabled-state-text-color, var(--mat-sys-on-error))}.mat-badge-hidden .mat-badge-content{display:none}.ng-animate-disabled .mat-badge-content,.mat-badge-content._mat-animation-noopable{transition:none}.mat-badge-content.mat-badge-active{transform:none}.mat-badge-small .mat-badge-content{width:var(--mat-badge-legacy-small-size-container-size, unset);height:var(--mat-badge-legacy-small-size-container-size, unset);min-width:var(--mat-badge-small-size-container-size, 6px);min-height:var(--mat-badge-small-size-container-size, 6px);line-height:var(--mat-badge-small-size-line-height, 6px);padding:var(--mat-badge-small-size-container-padding, 0);font-size:var(--mat-badge-small-size-text-size, 0);margin:var(--mat-badge-small-size-container-offset, -6px 0)}.mat-badge-small.mat-badge-overlap .mat-badge-content{margin:var(--mat-badge-small-size-container-overlap-offset, -6px)}.mat-badge-medium .mat-badge-content{width:var(--mat-badge-legacy-container-size, unset);height:var(--mat-badge-legacy-container-size, unset);min-width:var(--mat-badge-container-size, 16px);min-height:var(--mat-badge-container-size, 16px);line-height:var(--mat-badge-line-height, 16px);padding:var(--mat-badge-container-padding, 0 4px);font-size:var(--mat-badge-text-size, var(--mat-sys-label-small-size));margin:var(--mat-badge-container-offset, -12px 0)}.mat-badge-medium.mat-badge-overlap .mat-badge-content{margin:var(--mat-badge-container-overlap-offset, -12px)}.mat-badge-large .mat-badge-content{width:var(--mat-badge-legacy-large-size-container-size, unset);height:var(--mat-badge-legacy-large-size-container-size, unset);min-width:var(--mat-badge-large-size-container-size, 16px);min-height:var(--mat-badge-large-size-container-size, 16px);line-height:var(--mat-badge-large-size-line-height, 16px);padding:var(--mat-badge-large-size-container-padding, 0 4px);font-size:var(--mat-badge-large-size-text-size, var(--mat-sys-label-small-size));margin:var(--mat-badge-large-size-container-offset, -12px 0)}.mat-badge-large.mat-badge-overlap .mat-badge-content{margin:var(--mat-badge-large-size-container-overlap-offset, -12px)}\n"],encapsulation:2,changeDetection:0})}return r})(),I=(()=>{class r{_ngZone=(0,d.WQX)(l.SKi);_elementRef=(0,d.WQX)(l.aKT);_ariaDescriber=(0,d.WQX)(c.vr);_renderer=(0,d.WQX)(l.sFG);_animationsDisabled=(0,O._)();_idGenerator=(0,d.WQX)(M._);get color(){return this._color}set color(p){this._setColor(p),this._color=p}_color="primary";overlap=!0;disabled;position="above after";get content(){return this._content}set content(p){this._updateRenderedContent(p)}_content;get description(){return this._description}set description(p){this._updateDescription(p)}_description;size="medium";hidden;_badgeElement;_inlineBadgeDescription;_isInitialized=!1;_interactivityChecker=(0,d.WQX)(g.I);_document=(0,d.WQX)(d.qQL);constructor(){const p=(0,d.WQX)(C._);p.load(b),p.load(E.Y)}isAbove(){return-1===this.position.indexOf("below")}isAfter(){return-1===this.position.indexOf("before")}getBadgeElement(){return this._badgeElement}ngOnInit(){this._clearExistingBadges(),this.content&&!this._badgeElement&&(this._badgeElement=this._createBadgeElement(),this._updateRenderedContent(this.content)),this._isInitialized=!0}ngOnDestroy(){this._renderer.destroyNode&&(this._renderer.destroyNode(this._badgeElement),this._inlineBadgeDescription?.remove()),this._ariaDescriber.removeDescription(this._elementRef.nativeElement,this.description)}_isHostInteractive(){return this._interactivityChecker.isFocusable(this._elementRef.nativeElement,{ignoreVisibility:!0})}_createBadgeElement(){const p=this._renderer.createElement("span"),T="mat-badge-active";return p.setAttribute("id",this._idGenerator.getId("mat-badge-content-")),p.setAttribute("aria-hidden","true"),p.classList.add(F),this._animationsDisabled&&p.classList.add("_mat-animation-noopable"),this._elementRef.nativeElement.appendChild(p),"function"!=typeof requestAnimationFrame||this._animationsDisabled?p.classList.add(T):this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{p.classList.add(T)})}),p}_updateRenderedContent(p){const T=`${p??""}`.trim();this._isInitialized&&T&&!this._badgeElement&&(this._badgeElement=this._createBadgeElement()),this._badgeElement&&(this._badgeElement.textContent=T),this._content=T}_updateDescription(p){this._ariaDescriber.removeDescription(this._elementRef.nativeElement,this.description),(!p||this._isHostInteractive())&&this._removeInlineDescription(),this._description=p,this._isHostInteractive()?this._ariaDescriber.describe(this._elementRef.nativeElement,p):this._updateInlineDescription()}_updateInlineDescription(){this._inlineBadgeDescription||(this._inlineBadgeDescription=this._document.createElement("span"),this._inlineBadgeDescription.classList.add("cdk-visually-hidden")),this._inlineBadgeDescription.textContent=this.description,this._badgeElement?.appendChild(this._inlineBadgeDescription)}_removeInlineDescription(){this._inlineBadgeDescription?.remove(),this._inlineBadgeDescription=void 0}_setColor(p){const T=this._elementRef.nativeElement.classList;T.remove(`mat-badge-${this._color}`),p&&T.add(`mat-badge-${p}`)}_clearExistingBadges(){const p=this._elementRef.nativeElement.querySelectorAll(`:scope > .${F}`);for(const T of Array.from(p))T!==this._badgeElement&&T.remove()}static \u0275fac=function(T){return new(T||r)};static \u0275dir=l.FsC({type:r,selectors:[["","matBadge",""]],hostAttrs:[1,"mat-badge"],hostVars:20,hostBindings:function(T,t){2&T&&l.AVh("mat-badge-overlap",t.overlap)("mat-badge-above",t.isAbove())("mat-badge-below",!t.isAbove())("mat-badge-before",!t.isAfter())("mat-badge-after",t.isAfter())("mat-badge-small","small"===t.size)("mat-badge-medium","medium"===t.size)("mat-badge-large","large"===t.size)("mat-badge-hidden",t.hidden||!t.content)("mat-badge-disabled",t.disabled)},inputs:{color:[0,"matBadgeColor","color"],overlap:[2,"matBadgeOverlap","overlap",v.L39],disabled:[2,"matBadgeDisabled","disabled",v.L39],position:[0,"matBadgePosition","position"],content:[0,"matBadge","content"],description:[0,"matBadgeDescription","description"],size:[0,"matBadgeSize","size"],hidden:[2,"matBadgeHidden","hidden",v.L39]}})}return r})(),m=(()=>{class r{static \u0275fac=function(T){return new(T||r)};static \u0275mod=l.$C({type:r});static \u0275inj=d.G2t({imports:[g.A,_.M,_.M]})}return r})()},21183:(x,D,i)=>{i.d(D,{f:()=>c});class c{static cellLink(g,l,d){return`<a class="default-link fill-cell ${d}" href="${g}">${l}</a>`}}},39333:(x,D,i)=>{i.d(D,{c:()=>g});var c=i(34435),M=i(99293);let g=(()=>{class l{constructor(){this.log=(0,c.Tq)({ClickStopPropagationDirective:l}),this.log.a("constructor")}onClick(v){this.log.a("onClick",{event:v}),v.stopPropagation()}static#t=this.\u0275fac=function(C){return new(C||l)};static#e=this.\u0275dir=M.FsC({type:l,selectors:[["","appClickStopPropagation",""]],hostBindings:function(C,E){1&C&&M.bIt("click",function(_){return E.onClick(_)})}})}return l})()},43758:(x,D,i)=>{i.d(D,{F:()=>m});var c=i(87945),M=i(37580),g=i(31016),l=i(99293),d=i(44444),v=i(87698);const C=["*"],E=r=>({"hint-box__short":r});function O(r,y){1&r&&l.eu8(0)}function _(r,y){if(1&r&&(l.j41(0,"mat-hint"),l.DNE(1,O,1,0,"ng-container",2),l.k0s()),2&r){l.XpG();const p=l.sdS(4);l.R7$(),l.Y8G("ngTemplateOutlet",p)}}function F(r,y){1&r&&l.eu8(0)}function b(r,y){if(1&r&&(l.j41(0,"mat-error"),l.DNE(1,F,1,0,"ng-container",2),l.k0s()),2&r){l.XpG();const p=l.sdS(4);l.R7$(),l.Y8G("ngTemplateOutlet",p)}}function I(r,y){1&r&&l.SdG(0)}let m=(()=>{class r{constructor(){this.isError=(0,M.hFB)(!1),this.isShort=!0}toggleIsShort(){this.isShort=!this.isShort}static#t=this.\u0275fac=function(T){return new(T||r)};static#e=this.\u0275cmp=l.VBU({type:r,selectors:[["app-field-hint"]],inputs:{isError:[1,"isError"]},ngContentSelectors:C,decls:5,vars:4,consts:[["content",""],[1,"hint-box",3,"click","ngClass"],[4,"ngTemplateOutlet"]],template:function(T,t){if(1&T){const B=l.RV6();l.NAR(),l.j41(0,"div",1),l.bIt("click",function(){return d.eBV(B),d.Njj(t.toggleIsShort())}),l.nVh(1,_,2,1,"mat-hint")(2,b,2,1,"mat-error"),l.k0s(),l.DNE(3,I,1,0,"ng-template",null,0,l.C5r)}if(2&T){let B;l.Y8G("ngClass",l.eq3(2,E,t.isShort)),l.R7$(),l.vxM(!1===(B=t.isError())?1:!0===B?2:-1)}},dependencies:[g.M,v.c,v.b,c.YU,c.T3],styles:[".hint-box[_ngcontent-%COMP%]{margin-top:4px}.hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{font-size:12px;display:block}.hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]})}return r})()},48021:(x,D,i)=>{i.d(D,{A:()=>v,J:()=>d});var c=i(95682),M=i(91817),g=i(70271),l=i(92434);function d(C){return(0,c.F)((0,M.F)(),(0,g.T)(C),(0,M.F)())}function v(C){return(0,c.F)((0,M.F)(l.A),(0,g.T)(C),(0,M.F)(l.A))}},60852:(x,D,i)=>{i.d(D,{c:()=>F});var c=i(29658),M=i(51567),g=i(63037),l=i(70271),d=i(5057),v=i(98764),C=i(34435),E=i(4979),O=i(44444);const _={doOnDialogClosed:!0};let F=(()=>{class b extends E.V{constructor(m,r){super(),this.router=m,this.route=r,this.log=(0,C.Tq)({DialogRoutingService:b},_)}get snapshot(){return this.route.snapshot}get url(){return this.router.url}get urlSegments(){return this.router.url.split("/")}getParam(m){return this.route.snapshot.paramMap.get(m)}getParams(m){const r=this.route.snapshot.paramMap;return m.reduce((y,p)=>(y[p]=r.get(p),y),{})}getQueryParam(m){return this.route.snapshot.queryParamMap.get(m)}getQueryParams(m){const r=this.route.snapshot.queryParamMap;return m.reduce((y,p)=>(y[p]=r.get(p),y),{})}state(){return this.router.getCurrentNavigation().extras?.state}doOnDialogClosed(m){const r=this.log.fnIf("doOnDialogClosed");this.subscriptions.add(this.childDialogClosed$().subscribe(y=>(r.a("Dialog closed",{data:y}),m()))),r.end()}doOnDialogClosedWithData(m){const r=this.log.fnIf("doOnDialogClosed");this.subscriptions.add(this.#t().subscribe(({state:y})=>{r.a("Dialog closed",{state:y}),m(y)})),r.end()}urlSubRoute(m){const r=this.router.createUrlTree([m],{relativeTo:this.route});return this.router.serializeUrl(r)}navPath(m,r){return this.router.navigate([m],r)}navRelative(m,r){return this.router.navigate(m,{...r,relativeTo:this.route})}childDialogClosed$(){return this.router.events.pipe((0,M.p)(m=>m instanceof c.wF),(0,g.Z)(!!this.route.snapshot.firstChild),(0,l.T)(()=>!!this.route.snapshot.firstChild),(0,d.J)(),(0,M.p)(([m,r])=>m&&!r))}#t(){return this.router.events.pipe((0,M.p)(m=>m instanceof c.wF),(0,v.M)(m=>{const r=this.log.fn("childDialogClosed$",{event:m,firstChild:this.route.snapshot.firstChild,snapShot:this.route.snapshot,state:this.router.getCurrentNavigation()?.extras.state});r.a("NavigationEnd",{event:m}),r.end()}),(0,g.Z)(!!this.route.snapshot.firstChild),(0,l.T)(()=>({hasChildNow:!!this.route.snapshot.firstChild,state:this.router.getCurrentNavigation()?.extras.state})),(0,d.J)(),(0,M.p)(([m,r])=>m.hasChildNow&&!r.hasChildNow),(0,l.T)(([m,r])=>({hadChildBefore:m.hasChildNow,hasChildNow:r.hasChildNow,state:r.state})))}static#e=this.\u0275fac=function(r){return new(r||b)(O.KVO(c.Ix),O.KVO(c.nX))};static#s=this.\u0275prov=O.jDH({token:b,factory:b.\u0275fac})}return b})()},77730:(x,D,i)=>{i.r(D),i.d(D,{ContentItemsComponent:()=>Pe});var c=i(44444),M=i(64173),g=i(84175),l=i(81863),d=i(93840),v=i(29658),C=i(12938),E=i(17693),O=i(6663),_=i(56360),F=i(93454),b=i(21183),I=i(11828),m=i(91960),r=i(34456),y=i(53804),p=i(31016),T=i(59791),t=i(99293),B=i(87698);const z=["valueInput"];let Y=(()=>{class n{constructor(){this.filter="",this.idFilterString="",this.idFilter=[]}agInit(e){this.filterParams=e}isFilterActive(){return""!==this.filter||this.idFilter.length>0}doesFilterPass(e){if(""!==this.filter){const o=this.filterParams.valueGetter({api:this.filterParams.api,colDef:this.filterParams.colDef,column:this.filterParams.column,columnApi:this.filterParams.columnApi,context:this.filterParams.context,data:e.node.data,getValue:s=>e.node.data[s],node:e.node});if(null==o||!o.some(s=>!!s&&s.includes(this.filter)))return!1}if(this.idFilter.length>0){const a=e.data[this.filterParams.colDef.headerName];if(null==a||!this.idFilter.some(o=>a.some(s=>s.Id===o)))return!1}return!0}getModel(){return this.isFilterActive()?{filterType:"entity",filter:this.filter,idFilter:this.idFilter}:void 0}setModel(e){this.filter=e?.filter??"",this.idFilter=e?.idFilter??[],this.idFilterString=e?.idFilter?.join(",")??""}afterGuiAttached(e){this.valueInputRef.nativeElement.focus()}updateIdFilter(){this.idFilter=this.idFilterString.split(",").map(e=>parseInt(e,10)).filter(e=>!isNaN(e))}filterChanged(){this.filterParams.filterChangedCallback()}static#t=this.\u0275fac=function(a){return new(a||n)};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-entity-filter"]],viewQuery:function(a,o){if(1&a&&t.GBs(z,5),2&a){let s;t.mGM(s=t.lsd())&&(o.valueInputRef=s.first)}},decls:9,vars:2,consts:[["valueInput",""],["color","accent",1,"eav-mat-form-field"],["matInput","","type","text",3,"ngModelChange","ngModel"]],template:function(a,o){if(1&a){const s=t.RV6();t.j41(0,"mat-form-field",1)(1,"mat-label"),t.EFF(2,"Value"),t.k0s(),t.j41(3,"input",2,0),t.mxI("ngModelChange",function(f){return c.eBV(s),t.DH7(o.filter,f)||(o.filter=f),c.Njj(f)}),t.bIt("ngModelChange",function(){return c.eBV(s),c.Njj(o.filterChanged())}),t.k0s()(),t.j41(5,"mat-form-field",1)(6,"mat-label"),t.EFF(7,"IDs (comma separated)"),t.k0s(),t.j41(8,"input",2),t.mxI("ngModelChange",function(f){return c.eBV(s),t.DH7(o.idFilterString,f)||(o.idFilterString=f),c.Njj(f)}),t.bIt("ngModelChange",function(){return c.eBV(s),o.updateIdFilter(),c.Njj(o.filterChanged())}),t.k0s()()}2&a&&(t.R7$(3),t.R50("ngModel",o.filter),t.R7$(5),t.R50("ngModel",o.idFilterString))},dependencies:[r.YN,r.me,r.BC,r.vS,y.Wk,p.M,B.j,B.M,T.fS,T.fg],styles:["[_nghost-%COMP%]{display:block;padding:16px 12px 2px}.mat-mdc-form-field[_ngcontent-%COMP%]{display:block;width:175px}"]})}return n})();var ot=i(60251),st=i(38172),rt=i(34575),A=i(34601),lt=i(95699),U=i(1726),G=i(43216),dt=i(34435),j=i(70334),ct=i(67037),mt=i(69914),pt=i(60852),ut=i(96817),ht=i(39431),gt=i(67993),H=i(89061),V=i(31034),w=i(29968);function ft(n,u){if(1&n){const e=t.RV6();t.j41(0,"button",7),t.bIt("click",function(){c.eBV(e);const o=t.XpG();return c.Njj(o.do("delete"))}),t.j41(1,"mat-icon"),t.EFF(2,"delete"),t.k0s(),t.j41(3,"span"),t.EFF(4,"Delete"),t.k0s()()}if(2&n){const e=t.XpG();t.Y8G("disabled",e.item._EditInfo.DisableDelete)}}let _t=(()=>{class n{agInit(e){this.params=e,this.item=e.data}refresh(e){return!0}do(e){this.params.do(e,this.item)}static#t=this.\u0275fac=function(a){return new(a||n)};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-data-bundle-actions"]],decls:13,vars:2,consts:[["menu","matMenu"],[1,"actions-component"],["matRipple","","tippy","Clone",1,"eav-grid-action-button","default-link","highlight",3,"href"],["matRipple","","tippy","Export",1,"eav-grid-action-button","highlight",3,"click"],["matRipple","","tippy","More",1,"eav-grid-action-button","highlight",3,"matMenuTriggerFor"],[1,"grid-more-menu"],["matMenuContent",""],["mat-menu-item","",3,"click","disabled"]],template:function(a,o){if(1&a){const s=t.RV6();t.j41(0,"div",1)(1,"a",2)(2,"mat-icon"),t.EFF(3,"file_copy"),t.k0s()(),t.j41(4,"div",3),t.bIt("click",function(){return c.eBV(s),c.Njj(o.do("export"))}),t.j41(5,"mat-icon"),t.EFF(6,"cloud_download"),t.k0s()(),t.j41(7,"div",4)(8,"mat-icon"),t.EFF(9,"more_horiz"),t.k0s()()(),t.j41(10,"mat-menu",5,0),t.DNE(12,ft,5,1,"ng-template",6),t.k0s()}if(2&a){const s=t.sdS(11);t.R7$(),t.Y8G("href",o.params.urlTo("clone",o.item),t.B4B),t.R7$(6),t.Y8G("matMenuTriggerFor",s)}},dependencies:[H.M,w.M,d.m_,d.An,V.Cn,V.kk,V.fb,V.z8,V.Cp,A.e],encapsulation:2})}return n})();function Ct(n,u){if(1&n&&(t.j41(0,"span",1),t.EFF(1),t.k0s()),2&n){const e=t.XpG();t.R7$(),t.JRh(e.entities)}}let vt=(()=>{class n{agInit(e){Array.isArray(e.value)&&(this.encodedValue=this.htmlEncode(e.value.join(", ")),e.colDef.allowMultiValue&&(this.entities=e.value.length))}refresh(e){return!0}htmlEncode(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}static#t=this.\u0275fac=function(a){return new(a||n)};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-content-items-entity"]],decls:3,vars:3,consts:[[3,"tippy"],[1,"more-entities"]],template:function(a,o){1&a&&(t.j41(0,"div",0),t.nVh(1,Ct,2,1,"span",1),t.EFF(2),t.k0s()),2&a&&(t.Y8G("tippy",o.encodedValue),t.R7$(),t.vxM(o.entities?1:-1),t.R7$(),t.SpI(" ",o.encodedValue,"\n"))},dependencies:[A.e],styles:[".more-entities[_ngcontent-%COMP%]{padding:0 8px;border-radius:10px;border:1px solid rgba(29,39,61,.44);-webkit-user-select:none;user-select:none}"]})}return n})();var L=i(87945),Z=i(16256);const yt=n=>({"hide-until-row-hover":n});function Tt(n,u){if(1&n&&(t.j41(0,"a",2)(1,"mat-icon",4),t.EFF(2),t.k0s()()),2&n){const e=t.XpG();t.Y8G("tippy",e.metadataTooltip)("href",e.params.urlTo("openMetadata",e.item),t.B4B)("ngClass",t.eq3(6,yt,!e.metadataCount&&!e.value.metadata)),t.R7$(),t.Y8G("matBadge",e.metadataCount)("matBadgeHidden",!e.metadataCount),t.R7$(),t.SpI("",e.value.metadata?"loyalty":"local_offer"," ")}}function Mt(n,u){if(1&n&&(t.j41(0,"div",3)(1,"mat-icon",5),t.EFF(2),t.k0s()()),2&n){const e=t.XpG();t.R7$(),t.Y8G("matBadge",e.metadataCount)("matBadgeHidden",!e.metadataCount),t.R7$(),t.SpI("",e.value.metadata?"loyalty":"local_offer"," ")}}let bt=(()=>{class n{agInit(e){this.params=e,this.value=e.value,this.item=e.data,this.disableMetadata=this.item._EditInfo.DisableMetadata,this.metadataCount=this.item.Metadata?.length??0;const a=this.item.For;this.metadataTooltip=a?`This item is metadata for:\nTarget: ${a.Target}\nTargetType: ${a.TargetType}`+(a.KeyNumber?`\nNumber: ${a.KeyNumber}`:"")+(a.KeyString?`\nString: ${a.KeyString}`:"")+(a.KeyGuid?`\nGuid: ${a.KeyGuid}`:"")+(a.Title?`\nTitle: ${a.Title}`:""):"This item is not metadata.",this.metadataTooltip+=`\n\nThis item has ${this.metadataCount>0?this.metadataCount:"no"} other metadata ${1===this.metadataCount?"item":"items"} attached to it.`}refresh(e){return!0}static#t=this.\u0275fac=function(a){return new(a||n)};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-content-items-status"]],decls:6,vars:3,consts:[[1,"actions-component"],[1,"eav-grid-action-button","icon",3,"tippy"],["matRipple","",1,"eav-grid-action-button","default-link","highlight",3,"tippy","href","ngClass"],[1,"eav-grid-action-button","disabled"],["matBadgeColor","accent","matBadgeSize","small","matBadgePosition","below after","aria-hidden","false",3,"matBadge","matBadgeHidden"],["matBadgeColor","accent","matBadgeSize","small","matBadgeDisabled","true","matBadgePosition","below after","aria-hidden","false",3,"matBadge","matBadgeHidden"]],template:function(a,o){1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"mat-icon"),t.EFF(3),t.k0s()(),t.nVh(4,Tt,3,8,"a",2)(5,Mt,3,3,"div",3),t.k0s()),2&a&&(t.R7$(),t.Y8G("tippy",o.value.published?"Published":"Not published"),t.R7$(2),t.JRh(o.value.published?"visibility":"visibility_off"),t.R7$(),t.vxM(o.disableMetadata?o.disableMetadata&&(o.metadataCount||o.value.metadata)?5:-1:4))},dependencies:[d.m_,d.An,H.M,w.M,L.YU,Z.Y,Z.k,A.e],styles:[".hide-until-row-hover[_ngcontent-%COMP%]{visibility:hidden}  .ag-row-hover .hide-until-row-hover{visibility:visible}"]})}return n})();var Et=i(4038),Ft=i(31403),Q=i(64043),J=i(8827),$=i(75797),W=i(63037),S=i(91817),It=i(63617),q=i(70271),K=i(19999),Pt=i(75445),tt=i(88857),Ot=i(43176),Rt=i(43758),et=i(5858),R=i(50052),xt=i(39333),Bt=i(48021),kt=i(93826),jt=i(68873),at=i(336),$t=i(49417);function At(n){return u=>{if(!u.value)return null;const e=n.controls.keyType.value,a=u.value.toString();switch(e){case R.YX.keyTypes.number:return/^[0-9]+$/.test(a)?null:{patternWholeNumber:!0};case R.YX.keyTypes.guid:const s=["{","}"].some(P=>a.includes(P)),h=a.substring(s?1:0,s?a.length-1:a.length);return(0,$t.L)().test(h)?null:{patternGuid:!0};default:return null}}}var Gt=i(23731),nt=i(88622);const it=n=>({active:n});function Vt(n,u){if(1&n&&(t.j41(0,"mat-option",12),t.EFF(1),t.k0s()),2&n){const e=u.$implicit;t.Y8G("value",e.targetType),t.R7$(),t.SpI(" ",e.label," ")}}function Ut(n,u){if(1&n&&(t.j41(0,"mat-option",12),t.EFF(1),t.k0s()),2&n){const e=t.XpG(2);t.Y8G("value",e.formValues.targetType),t.R7$(),t.SpI(" ",e.formValues.targetType," ")}}function Lt(n,u){if(1&n&&(t.j41(0,"mat-select",8),t.Z7z(1,Vt,2,2,"mat-option",12,t.fX1),t.nVh(3,Ut,2,2,"mat-option",12),t.k0s()),2&n){const e=t.XpG(),a=t.XpG();t.R7$(),t.Dyx(a.targetTypeOptions),t.R7$(2),t.vxM(e.unknownTargetType?3:-1)}}function St(n,u){1&n&&t.nrm(0,"input",9)}function Kt(n,u){1&n&&(t.j41(0,"app-field-hint",10),t.EFF(1," Warning: you entered an unknown target type. This may work or may not. Please be sure you know what you're doing "),t.k0s()),2&n&&t.Y8G("isError",!1)}function Nt(n,u){if(1&n&&(t.j41(0,"app-field-hint",10),t.EFF(1),t.k0s()),2&n){const e=t.XpG();t.Y8G("isError",!1),t.R7$(),t.JRh(e.targetTypeHint)}}function Wt(n,u){1&n&&(t.j41(0,"app-field-hint",10),t.EFF(1," This field is required "),t.k0s()),2&n&&t.Y8G("isError",!0)}function Xt(n,u){1&n&&(t.j41(0,"app-field-hint",10),t.EFF(1," Must be a whole number "),t.k0s()),2&n&&t.Y8G("isError",!0)}function zt(n,u){if(1&n&&(t.j41(0,"mat-option",12),t.EFF(1),t.k0s()),2&n){const e=u.$implicit;t.Y8G("value",e),t.R7$(),t.SpI(" ",e," ")}}function Yt(n,u){1&n&&(t.j41(0,"app-field-hint",10),t.EFF(1," This field is required "),t.k0s()),2&n&&t.Y8G("isError",!0)}function Ht(n,u){if(1&n&&(t.j41(0,"mat-option",12),t.EFF(1),t.k0s()),2&n){const e=u.$implicit;t.Y8G("value",e.NameId),t.R7$(),t.SpI(" ",e.Label," ")}}function wt(n,u){if(1&n&&(t.j41(0,"mat-form-field",7)(1,"mat-label"),t.EFF(2,"Content Type"),t.k0s(),t.j41(3,"mat-select",19),t.Z7z(4,Ht,2,2,"mat-option",12,t.fX1),t.k0s()()),2&n){const e=t.XpG();t.R7$(3),t.Y8G("placeholder",e.contentTypes.length?"":"No items found"),t.R7$(),t.Dyx(e.contentTypes)}}function Zt(n,u){if(1&n&&(t.j41(0,"mat-option",12),t.EFF(1),t.k0s()),2&n){const e=u.$implicit;t.Y8G("value",e.value),t.R7$(),t.SpI(" ",e.name," ")}}function Qt(n,u){if(1&n&&(t.j41(0,"mat-form-field",7)(1,"mat-label"),t.EFF(2,"Scope"),t.k0s(),t.j41(3,"mat-select",20),t.Z7z(4,Zt,2,2,"mat-option",12,t.fX1),t.j41(6,"mat-option",12),t.EFF(7,"Other..."),t.k0s()()()),2&n){const e=t.XpG(),a=t.XpG();t.R7$(3),t.Y8G("placeholder",e.scopeOptions.length?"":"No items found"),t.R7$(),t.Dyx(e.scopeOptions),t.R7$(2),t.Y8G("value",a.dropdownInsertValue)}}function Jt(n,u){if(1&n&&(t.j41(0,"mat-option",12),t.EFF(1),t.k0s()),2&n){const e=u.$implicit;t.Y8G("value",e.Guid),t.R7$(),t.Lme(" ",e.Title," (",e.Id,") ")}}function qt(n,u){if(1&n&&(t.j41(0,"mat-select",21),t.Z7z(1,Jt,2,3,"mat-option",12,t.fX1),t.k0s()),2&n){const e=t.XpG(3);t.Y8G("placeholder",e.contentItems.length?"":"No items found"),t.R7$(),t.Dyx(e.contentItems)}}function te(n,u){1&n&&t.nrm(0,"input",22)}function ee(n,u){if(1&n&&t.nVh(0,qt,3,1,"mat-select",21)(1,te,1,0,"input",22),2&n){const e=t.XpG(2);t.vxM(e.guidedKey?0:1)}}function ae(n,u){if(1&n&&(t.j41(0,"mat-option",12),t.EFF(1),t.k0s()),2&n){const e=u.$implicit;t.Y8G("value",e.NameId),t.R7$(),t.SpI(" ",e.Label," ")}}function ne(n,u){if(1&n&&(t.j41(0,"mat-select",21),t.Z7z(1,ae,2,2,"mat-option",12,t.fX1),t.k0s()),2&n){const e=t.XpG(3);t.Y8G("placeholder",e.contentTypes.length?"":"No items found"),t.R7$(),t.Dyx(e.contentTypes)}}function ie(n,u){1&n&&t.nrm(0,"input",22)}function oe(n,u){if(1&n&&t.nVh(0,ne,3,1,"mat-select",21)(1,ie,1,0,"input",22),2&n){const e=t.XpG(2);t.vxM(e.guidedKey?0:1)}}function se(n,u){1&n&&t.eu8(0)}function re(n,u){if(1&n&&t.DNE(0,se,1,0,"ng-container",23),2&n){t.XpG(2);const e=t.sdS(39);t.Y8G("ngTemplateOutlet",e)}}function le(n,u){if(1&n&&t.nVh(0,ee,2,1)(1,oe,2,1)(2,re,1,1,"ng-container"),2&n){let e;const a=t.XpG(),o=t.XpG();t.vxM((e=a.formValues.targetType)===o.eavConstants.metadata.entity.targetType?0:e===o.eavConstants.metadata.contentType.targetType?1:2)}}function de(n,u){1&n&&t.nrm(0,"input",22)}function ce(n,u){1&n&&t.nrm(0,"input",24)}function me(n,u){if(1&n&&(t.nVh(0,de,1,0,"input",22),t.nVh(1,ce,1,0,"input",24)),2&n){const e=t.XpG(),a=t.XpG();t.vxM(e.formValues.keyType!==a.eavConstants.keyTypes.number?0:-1),t.R7$(),t.vxM(e.formValues.keyType===a.eavConstants.keyTypes.number?1:-1)}}function pe(n,u){1&n&&t.nrm(0,"input",22)}function ue(n,u){1&n&&t.nrm(0,"input",24)}function he(n,u){if(1&n&&(t.nVh(0,pe,1,0,"input",22),t.nVh(1,ue,1,0,"input",24)),2&n){const e=t.XpG(),a=t.XpG();t.vxM(e.formValues.keyType!==a.eavConstants.keyTypes.number?0:-1),t.R7$(),t.vxM(e.formValues.keyType===a.eavConstants.keyTypes.number?1:-1)}}function ge(n,u){if(1&n){const e=t.RV6();t.j41(0,"div",14)(1,"button",25),t.bIt("click",function(){c.eBV(e);const o=t.XpG(2);return c.Njj(o.toggleGuidedKey(!0))}),t.j41(2,"mat-icon",26),t.EFF(3,"search"),t.k0s()(),t.j41(4,"button",27),t.bIt("click",function(){c.eBV(e);const o=t.XpG(2);return c.Njj(o.toggleGuidedKey(!1))}),t.j41(5,"mat-icon",26),t.EFF(6,"text_fields"),t.k0s()()()}if(2&n){const e=t.XpG();t.R7$(),t.Y8G("ngClass",t.eq3(2,it,e.guidedKey)),t.R7$(3),t.Y8G("ngClass",t.eq3(4,it,!e.guidedKey))}}function fe(n,u){1&n&&(t.j41(0,"app-field-hint",10),t.EFF(1," This field is required "),t.k0s()),2&n&&t.Y8G("isError",!0)}function _e(n,u){1&n&&(t.j41(0,"app-field-hint",10),t.EFF(1," Must be a whole number "),t.k0s()),2&n&&t.Y8G("isError",!0)}function Ce(n,u){1&n&&(t.j41(0,"app-field-hint",10),t.EFF(1," Must be a valid GUID "),t.k0s()),2&n&&t.Y8G("isError",!0)}function ve(n,u){if(1&n){const e=t.RV6();t.j41(0,"div",1)(1,"div",2)(2,"div",3),t.EFF(3,"Create Metadata"),t.k0s()(),t.j41(4,"div",4)(5,"p"),t.EFF(6," This is a special operation to add an item which is metadata for another item, see "),t.j41(7,"a",5),t.EFF(8,"docs"),t.k0s(),t.EFF(9,". "),t.k0s(),t.j41(10,"form",6)(11,"mat-form-field",7)(12,"mat-label"),t.EFF(13,"Target"),t.k0s(),t.nVh(14,Lt,4,1,"mat-select",8),t.nVh(15,St,1,0,"input",9),t.k0s(),t.nVh(16,Kt,2,1,"app-field-hint",10),t.nVh(17,Nt,2,2,"app-field-hint",10),t.nVh(18,Wt,2,1,"app-field-hint",10),t.nVh(19,Xt,2,1,"app-field-hint",10),t.j41(20,"mat-form-field",7)(21,"mat-label"),t.EFF(22,"Key type"),t.k0s(),t.j41(23,"mat-select",11),t.Z7z(24,zt,2,2,"mat-option",12,t.fX1),t.k0s()(),t.nVh(26,Yt,2,1,"app-field-hint",10),t.nVh(27,wt,6,1,"mat-form-field",7),t.nVh(28,Qt,8,2,"mat-form-field",7),t.j41(29,"app-field-hint"),t.EFF(30," The scope should almost never be changed - "),t.j41(31,"a",13),t.EFF(32,"see help"),t.k0s()(),t.j41(33,"mat-form-field",7)(34,"mat-label"),t.EFF(35,"Key"),t.k0s(),t.nVh(36,le,3,1)(37,me,2,2),t.DNE(38,he,2,2,"ng-template",null,0,t.C5r),t.nVh(40,ge,7,6,"div",14),t.k0s(),t.nVh(41,fe,2,1,"app-field-hint",10),t.nVh(42,_e,2,1,"app-field-hint",10),t.nVh(43,Ce,2,1,"app-field-hint",10),t.k0s()(),t.j41(44,"mat-dialog-actions",15)(45,"mat-slide-toggle",16),t.bIt("change",function(o){c.eBV(e);const s=t.XpG();return c.Njj(s.toggleGuidedMode(o))}),t.EFF(46),t.k0s(),t.j41(47,"div")(48,"button",17),t.bIt("click",function(){c.eBV(e);const o=t.XpG();return c.Njj(o.closeDialog())}),t.EFF(49,"Cancel"),t.k0s(),t.j41(50,"button",18),t.bIt("click",function(){c.eBV(e);const o=t.XpG();return c.Njj(o.confirm())}),t.EFF(51,"Confirm"),t.k0s()()()()}if(2&n){const e=u,a=t.XpG();t.R7$(10),t.Y8G("formGroup",a.form),t.R7$(4),t.vxM(e.guidedMode?14:-1),t.R7$(),t.vxM(e.guidedMode?-1:15),t.R7$(),t.vxM(a.form.controls.targetType.touched&&!a.form.controls.targetType.invalid&&e.unknownTargetType?16:-1),t.R7$(),t.vxM(e.targetTypeHint?17:-1),t.R7$(),t.vxM(a.form.controls.targetType.touched&&null!=a.form.controls.targetType.errors&&a.form.controls.targetType.errors.required?18:-1),t.R7$(),t.vxM(a.form.controls.targetType.touched&&null!=a.form.controls.targetType.errors&&a.form.controls.targetType.errors.pattern?19:-1),t.R7$(5),t.Dyx(e.keyTypeOptions),t.R7$(2),t.vxM(a.form.controls.keyType.touched&&null!=a.form.controls.keyType.errors&&a.form.controls.keyType.errors.required?26:-1),t.R7$(),t.vxM(e.guidedMode&&e.formValues.targetType===a.eavConstants.metadata.entity.targetType?27:-1),t.R7$(),t.vxM(!e.guidedMode||e.formValues.targetType!==a.eavConstants.metadata.entity.targetType&&e.formValues.targetType!==a.eavConstants.metadata.contentType.targetType?-1:28),t.R7$(8),t.vxM(e.guidedMode?36:37),t.R7$(4),t.vxM(e.guidedMode&&e.guidedKeyExists?40:-1),t.R7$(),t.vxM(a.form.controls.key.touched&&null!=a.form.controls.key.errors&&a.form.controls.key.errors.required?41:-1),t.R7$(),t.vxM(a.form.controls.key.touched&&null!=a.form.controls.key.errors&&a.form.controls.key.errors.patternWholeNumber?42:-1),t.R7$(),t.vxM(a.form.controls.key.touched&&null!=a.form.controls.key.errors&&a.form.controls.key.errors.patternGuid?43:-1),t.R7$(2),t.Y8G("tippy",e.guidedMode?"Guided mode helps you select options that work":"Manual mode is for advanced uses and allows you to insert any values")("checked",e.guidedMode),t.R7$(),t.SpI(" ",e.guidedMode?"Guided":"Manual"," "),t.R7$(4),t.Y8G("disabled",!a.form.valid)}}let ye=(()=>{class n extends Ot.${constructor(e,a){super(),this.dialog=e,this.context=a,this.hostClass="dialog-component",this.eavConstants=R.YX,this.dropdownInsertValue=et.O,this.contentItemsService=(0,C.d)(at.F),this.contentTypesService=(0,C.d)(Pt.gs)}ngOnInit(){this.targetTypeOptions=Object.values(R.YX.metadata).map(a=>({...a})),this.keyTypeOptions=Object.values(R.YX.keyTypes),this.keyTypeOptions$=new $.t([]),this.scopeOptions$=new $.t([]),this.guidedMode$=new $.t(!0),this.contentItems$=new $.t([]),this.contentTypes$=new $.t([]),this.guidedKey$=new $.t(!0),this.fetchScopes(),this.form=new r.J3({}),this.form.addControl("targetType",new r.hs(R.YX.metadata.entity.targetType,[r.k0.required,r.k0.pattern(/^[0-9]+$/)])),this.form.addControl("keyType",new r.hs(R.YX.metadata.entity.keyType,[r.k0.required])),this.form.addControl("contentTypeForContentItems",new r.hs(null)),this.form.addControl("scopeForContentTypes",new r.hs(R.YX.scopes.default.value)),this.form.addControl("key",new r.hs(null,[r.k0.required,At(this.form)])),this.subscriptions.add(this.form.controls.scopeForContentTypes.valueChanges.pipe((0,W.Z)(this.form.controls.scopeForContentTypes.value),(0,S.F)()).subscribe(a=>{null!=this.form.controls.contentTypeForContentItems.value&&this.form.controls.contentTypeForContentItems.patchValue(null),a===et.O?(a=prompt("This is an advanced feature to show content-types of another scope. Don't use this if you don't know what you're doing, as content-types of other scopes are usually hidden for a good reason.")||R.YX.scopes.default.value,this.scopeOptions$.value.some(o=>o.value===a)||this.scopeOptions$.next([{name:a,value:a},...this.scopeOptions$.value]),this.form.controls.scopeForContentTypes.patchValue(a)):this.fetchContentTypes(a)})),this.subscriptions.add((0,It.h)(this.form.controls.targetType.valueChanges.pipe((0,S.F)()),this.form.controls.keyType.valueChanges.pipe((0,S.F)())).subscribe(()=>{this.guidedKey$.next(!0),null!=this.form.getRawValue().key&&this.form.patchValue({key:null})})),this.subscriptions.add(this.form.controls.contentTypeForContentItems.valueChanges.pipe((0,W.Z)(this.form.controls.contentTypeForContentItems.value),(0,S.F)()).subscribe(a=>{const o=this.form.getRawValue();o.targetType===R.YX.metadata.entity.targetType&&null!=o.key&&this.form.patchValue({key:null}),this.contentItemsService.getAllPromise(a).then(s=>{this.contentItems$.next(s)})}));const e=this.form.valueChanges.pipe((0,W.Z)(this.form.getRawValue()),(0,q.T)(()=>this.form.getRawValue()),(0,Bt.A)(a=>a));this.subscriptions.add((0,K.z)([e,this.guidedMode$]).subscribe(([a,o])=>{const s=this.targetTypeOptions.find(N=>N.targetType===a.targetType),h=o&&s?[s.keyType]:[...this.keyTypeOptions];kt.a.arraysEqual(h,this.keyTypeOptions$.value)||this.keyTypeOptions$.next(h);const f={};this.keyTypeOptions$.value.includes(a.keyType)||(f.keyType=this.keyTypeOptions$.value[0]);const P=o&&a.targetType===R.YX.metadata.app.targetType;P&&a.key!==this.context.appId&&(f.key=this.context.appId),Object.keys(f).length&&this.form.patchValue(f),tt.a.disable(this.form.controls.keyType,o&&this.keyTypeOptions$.value.length<=1),tt.a.disable(this.form.controls.key,P)})),this.viewModel$=(0,K.z)([(0,K.z)([this.guidedMode$,this.keyTypeOptions$,this.scopeOptions$,this.contentItems$,this.contentTypes$]),(0,K.z)([e,this.guidedKey$])]).pipe((0,q.T)(([[a,o,s,h,f],[P,k]])=>({guidedMode:a,unknownTargetType:!this.targetTypeOptions.some(X=>X.targetType===P.targetType),targetTypeHint:a&&this.targetTypeOptions.find(X=>X.targetType===P.targetType)?.hint,keyTypeOptions:o,scopeOptions:s,guidedKey:k,guidedKeyExists:[R.YX.metadata.entity.targetType,R.YX.metadata.contentType.targetType].includes(P.targetType),formValues:P,contentItems:h,contentTypes:f})))}ngOnDestroy(){this.guidedMode$.complete(),this.keyTypeOptions$.complete(),this.contentItems$.complete(),this.contentTypes$.complete(),this.guidedKey$.complete(),super.ngOnDestroy()}closeDialog(e){this.dialog.close(e)}toggleGuidedKey(e){this.guidedKey$.next(e)}toggleGuidedMode(e){this.guidedMode$.next(e.checked)}confirm(){const e=this.form.getRawValue(),a={target:this.targetTypeOptions.find(o=>o.targetType===e.targetType)?.target,targetType:e.targetType,keyType:e.keyType,key:e.keyType===R.YX.keyTypes.guid?e.key.replace(/{|}/g,""):e.key.toString()};this.closeDialog(a)}fetchContentTypes(e){this.contentTypesService.retrieveContentTypesPromise(e).then(a=>{this.contentTypes$.next(a)})}fetchScopes(){this.contentTypesService.getScopesPromise().then(e=>{this.scopeOptions$.next(e)})}static#t=this.\u0275fac=function(a){return new(a||n)(t.rXU(l.k),t.rXU(jt.o))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-create-metadata-dialog"]],hostVars:1,hostBindings:function(a,o){2&a&&t.Avn("className",o.hostClass)},features:[t.Vt3],decls:2,vars:3,consts:[["defaultKeyInput",""],[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],["href","https://go.2sxc.org/metadata","target","_blank"],[3,"formGroup"],["color","accent",2,"width","100%","margin-bottom","8px"],["formControlName","targetType","required",""],["matInput","","type","number","min","0","formControlName","targetType","required",""],[3,"isError"],["formControlName","keyType","required",""],[3,"value"],["href","https://2sxc.org/help?tag=scope","target","_blank","appClickStopPropagation",""],["matTextSuffix","",1,"eav-selection-suffix"],[1,"eav-dialog-actions"],["color","accent",3,"change","tippy","checked"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","button","color","accent",3,"click","disabled"],["formControlName","contentTypeForContentItems",3,"placeholder"],["formControlName","scopeForContentTypes",3,"placeholder"],["formControlName","key","required","",3,"placeholder"],["matInput","","type","text","formControlName","key","required",""],[4,"ngTemplateOutlet"],["matInput","","type","number","formControlName","key","required",""],["mat-icon-button","","type","button","tippy","Pick existing value",1,"eav-selection-suffix-button",3,"click","ngClass"],[1,"eav-icon"],["mat-icon-button","","type","button","tippy","Manual entry",1,"eav-selection-suffix-button",3,"click","ngClass"]],template:function(a,o){if(1&a&&(t.nVh(0,ve,52,19,"div",1),t.nI1(1,"async")),2&a){let s;t.vxM((s=t.bMT(1,1,o.viewModel$))?0:-1,s)}},dependencies:[r.YN,r.qT,r.me,r.Q0,r.BC,r.cb,r.YS,r.VZ,r.X1,r.j4,r.JD,p.M,B.j,B.M,B.g,Q.M,Q.g,Gt.M,Ft.M,T.fS,T.fg,L.T3,g.Hl,g.$z,nt.M,L.YU,d.m_,d.An,l.M,J.mV,J.sG,L.Jj,Rt.F,xt.c,A.e],encapsulation:2})}return n})(),Te=(()=>{class n{constructor(){this.published="",this.metadata="",this.hasMetadata=""}agInit(e){this.filterParams=e}isFilterActive(){return""!==this.published||""!==this.metadata||""!==this.hasMetadata}doesFilterPass(e){let a=!1,o=!1,s=!1;const f=this.filterParams.valueGetter({api:this.filterParams.api,colDef:this.filterParams.colDef,column:this.filterParams.column,columnApi:this.filterParams.columnApi,context:this.filterParams.context,data:e.node.data,getValue:P=>e.node.data[P],node:e.node});return a=""===this.published||null!=f.published&&f.published.toString()===this.published,o=""===this.metadata||null!=f.metadata&&f.metadata.toString()===this.metadata,s=""===this.hasMetadata||null!=f.hasMetadata&&f.hasMetadata.toString()===this.hasMetadata,a&&o&&s}getModel(){return this.isFilterActive()?{filterType:"pub-meta",published:this.published,metadata:this.metadata,hasMetadata:this.hasMetadata}:void 0}setModel(e){this.published=e?e.published:"",this.metadata=e?e.metadata:"",this.hasMetadata=e?e.hasMetadata:""}afterGuiAttached(e){}filterChanged(){this.filterParams.filterChangedCallback()}static#t=this.\u0275fac=function(a){return new(a||n)};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-pub-meta-filter"]],decls:27,vars:3,consts:[[1,"title"],[3,"ngModelChange","ngModel"],["value",""],["value","true"],["value","false"]],template:function(a,o){1&a&&(t.j41(0,"div",0),t.EFF(1,"Published"),t.k0s(),t.j41(2,"mat-radio-group",1),t.mxI("ngModelChange",function(h){return t.DH7(o.published,h)||(o.published=h),h}),t.bIt("ngModelChange",function(){return o.filterChanged()}),t.j41(3,"mat-radio-button",2),t.EFF(4,"All"),t.k0s(),t.j41(5,"mat-radio-button",3),t.EFF(6,"Published"),t.k0s(),t.j41(7,"mat-radio-button",4),t.EFF(8,"Not published"),t.k0s()(),t.j41(9,"div",0),t.EFF(10,"Is Metadata"),t.k0s(),t.j41(11,"mat-radio-group",1),t.mxI("ngModelChange",function(h){return t.DH7(o.metadata,h)||(o.metadata=h),h}),t.bIt("ngModelChange",function(){return o.filterChanged()}),t.j41(12,"mat-radio-button",2),t.EFF(13,"All"),t.k0s(),t.j41(14,"mat-radio-button",3),t.EFF(15,"Is metadata"),t.k0s(),t.j41(16,"mat-radio-button",4),t.EFF(17,"Is not metadata"),t.k0s()(),t.j41(18,"div",0),t.EFF(19,"Has Metadata"),t.k0s(),t.j41(20,"mat-radio-group",1),t.mxI("ngModelChange",function(h){return t.DH7(o.hasMetadata,h)||(o.hasMetadata=h),h}),t.bIt("ngModelChange",function(){return o.filterChanged()}),t.j41(21,"mat-radio-button",2),t.EFF(22,"All"),t.k0s(),t.j41(23,"mat-radio-button",3),t.EFF(24,"Has metadata"),t.k0s(),t.j41(25,"mat-radio-button",4),t.EFF(26,"Has no metadata"),t.k0s()()),2&a&&(t.R7$(2),t.R50("ngModel",o.published),t.R7$(9),t.R50("ngModel",o.metadata),t.R7$(9),t.R50("ngModel",o.hasMetadata))},dependencies:[y.Wk,y.VT,y._g,r.YN,r.BC,r.vS],styles:[".title[_ngcontent-%COMP%]{padding:12px 12px 0}.mat-mdc-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;overflow:hidden;padding:12px;width:160px;height:104px}"]})}return n})();var Me=i(37580),be=i(3347),Ee=i(29841);function De(n,u){1&n&&(t.nrm(0,"div",5),t.nI1(1,"safeHtml")),2&n&&t.Y8G("innerHTML",t.bMT(1,1,u),t.npT)}function Fe(n,u){if(1&n){const e=t.RV6();t.j41(0,"button",17),t.bIt("click",function(){c.eBV(e);const o=t.XpG();return c.Njj(o.debugFilter())}),t.j41(1,"mat-icon",11),t.EFF(2,"filter_list"),t.k0s(),t.j41(3,"span"),t.EFF(4,"Filter"),t.k0s()()}}const Ie={all:!1,items:!0};let Pe=(()=>{class n{#t;#e;#s;#d;#n;constructor(e,a,o,s,h){this.dialog=e,this.snackBar=a,this.matDialog=o,this.viewContainerRef=s,this.changeDetectorRef=h,this.log=(0,dt.Tq)({ContentItemsComponent:n},Ie),this.isDebug=(0,c.WQX)(ht.B).isDebug,this.#t=(0,C.d)(ut.R),this.#e=(0,C.d)(_.D),this.#s=(0,C.d)(at.F),this.#d=(0,C.d)(E.g),this.#n=(0,C.d)(pt.c),this.gridOptions={...ot.C,onFilterChanged:f=>this.#r.update(P=>P+1)},this.#r=(0,c.vPA)(0),this.#l=(0,c.vPA)(0),this.#i=(0,c.vPA)(null),this.#a=this.#n.getParam("contentTypeStaticName"),this.contentType=this.#d.getType(this.#a).value,this.#c=this.#s.getAllLive(this.#a,this.#l).value,this.items=(0,M.EW)(()=>{const f=this.#c();return this.log.aIf("items",{data:f}),f}),this.urlToExportContent=(0,gt.bo)("urlToExportContent",()=>{const f=this.#i();if(!f)return"";this.#r();const P=Object.keys(f.getFilterModel()).length>0,k=[];return P&&f.forEachNodeAfterFilterAndSort(N=>k.push(N.data.Id)),this.#o(`export/${this.#a}${k.length>0?`/${k.join(",")}`:""}`)})}#r;#l;#i;#a;#c;ngOnInit(){this.urlToExportContent(),this.#n.doOnDialogClosed(()=>this.fetchItems())}closeDialog(){this.dialog.close()}onGridReady(e){this.#i.set(e.api),this.fetchColumns(),this.urlToExportContent()}fetchItems(){this.#l.update(e=>++e)}fetchColumns(){this.#s.getColumnsPromise(this.#a).then(e=>{const a=e.filter(h=>!h.IsEphemeral),o=this.#h(a),s=function Dt(n,u){if(!n)return;let e;"="===n.charAt(n.length-1)&&(n=atob(n));try{e=JSON.parse(n)}catch{console.error("Can't parse JSON with filters from url:",n)}if(!e)return;const a={};return(e.IsPublished||e.IsMetadata)&&(a.Status={filterType:"pub-meta",published:e.IsPublished??"",metadata:e.IsMetadata??"",hasMetadata:""}),Object.entries(e).filter(([o,s])=>"IsPublished"!==o&&"IsMetadata"!==o).forEach(([o,s])=>{if(u.find(f=>f.headerName===o)?.filter!==Y){if("string"==typeof s)a[o]={filterType:"text",type:"equals",filter:s};else if("number"==typeof s)a[o]={filterType:"number",type:"equals",filter:s,filterTo:null};else if("boolean"==typeof s){const f={filterType:"boolean",filter:s.toString()};a[o]=f}}else{const f={filterType:"entity",filter:"string"==typeof(s=Et.i.tryParse(s)??s)?s:void 0,idFilter:"number"==typeof s?[s]:Array.isArray(s)?s.filter(P=>"number"==typeof P):void 0};a[o]=f}}),a}(sessionStorage.getItem(st.bo),o);this.#i()&&this.setColumnDefs(o,s)})}setColumnDefs(e,a){this.#i().setColumnDefs(e),a&&(this.log.a("Will try to apply filter:",a),this.#i().setFilterModel(a))}#o(e){return"#"+this.#n.urlSubRoute(e)}#p(e){return this.#n.urlSubRoute(F.H.getUrlEntity(e.Guid,`Metadata for Entity: ${e._Title} (${e.Id})`,this.#a))}editItem(e){const a={items:[null==e?j.c.newFromType(this.#a):j.c.editId(e.Id)]},o=(0,G.s)(a);this.#n.navRelative([`edit/${o}`])}#u(e){return this.#o(`edit/${(0,G.s)({items:[null==e?j.c.newFromType(this.#a):j.c.editId(e.Id)]})}`)}urlToNewItem(e){return this.#o(`edit/${(0,G.s)({items:[null==e?j.c.newFromType(this.#a):j.c.editId(e.Id)]})}`)}filesDropped(e){const a=e[0];switch(a.name.substring(a.name.lastIndexOf(".")+1).toLocaleLowerCase()){case"xml":this.urlToImportContent(e);break;case"json":this.importItem(e)}}urlToImportContent(e){return this.#o(`${this.#a}${e?`/${e.map(a=>a.name).join(",")}`:""}/import`)}importItem(e){this.#n.navRelative(["import"],{state:{files:e}})}urlToImportItem(){return this.#o("import")}createMetadata(){this.matDialog.open(ye,{autoFocus:!1,viewContainerRef:this.viewContainerRef,width:"650px"}).afterClosed().subscribe(a=>{if(null==a)return;const o={items:[j.c.newMetadataFromInfo(this.#a,a)]},s=(0,G.s)(o);this.#n.navRelative([`edit/${s}`]),this.changeDetectorRef.markForCheck()})}debugFilter(){console.warn("Current filter:",this.#i().getFilterModel()),this.snackBar.open("Check console for filter information",void 0,{duration:3e3})}#h(e){const a=[{...I.r.IdWithDefaultRenderer,cellClass:o=>("id-action no-padding no-outline "+(o.data._EditInfo.ReadOnly?"disabled":"")).split(" "),cellRendererParams:I.r.idFieldParamsTooltipGetter()},{field:"Status",width:82,headerClass:"dense",cellClass:"secondary-action no-padding".split(" "),filter:Te,valueGetter:o=>{const s=o.data;return{published:s.IsPublished,metadata:!!s.For,hasMetadata:!!s.Metadata&&s.Metadata.length>0}},cellRenderer:bt,cellRendererParams:{urlTo:(o,s)=>"#"+this.#p(s)}},{...I.r.TextWidePrimary,headerName:"Item (Entity)",field:"_Title",flex:2,cellRenderer:o=>b.f.cellLink(this.#u(o.data),o.data._Title)},{headerName:"Stats",headerTooltip:"Used by others / uses others",field:"_Used",width:70,headerClass:"dense",cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:o=>`${o.data._Used} / ${o.data._Uses}`},{...I.r.ActionsPinnedRight3,cellRenderer:_t,cellRendererParams:{urlTo:(s,h)=>"#"+this.#g(h),do:(s,h)=>{switch(s){case"export":this.#f(h);break;case"delete":this.#_(h)}}}}];for(const o of e){const s={headerName:o.StaticName,field:o.StaticName,flex:2,minWidth:250,cellClass:"no-outline",sortable:!0};switch(o.Type){case U.O.Entity:s.allowMultiValue=o.Metadata?.Entity?.AllowMultiValue??!0,s.cellRenderer=vt,s.valueGetter=this.valueGetterEntityField,s.filter=Y;break;case U.O.DateTime:s.useTimePicker=o.Metadata?.DateTime?.UseTimePicker??!1,s.valueGetter=this.valueGetterDateTime,s.filter="agTextColumnFilter";break;case U.O.Boolean:s.valueGetter=this.valueGetterBoolean,s.filter=m.y;break;case U.O.Number:s.filter="agNumberColumnFilter";break;default:s.filter="agTextColumnFilter"}a.push(s)}return a}#g(e){return this.#n.urlSubRoute(`edit/${(0,G.s)({items:[j.c.copy(this.#a,e.Id)]})}`)}#f(e){this.#e.exportEntity(e.Id,this.#a,!0)}#_(e){this.snackBar.open("Deleting..."),this.#m(e,"Delete Item?",!1)}#m(e,a,o,s,h){this.matDialog.open(O.F,{autoFocus:!1,data:{entityId:e._RepositoryId,entityTitle:e._Title,message:a,title:s,confirmTranslateKey:h},viewContainerRef:this.viewContainerRef,width:"400px"}).afterClosed().subscribe(P=>{this.snackBar.dismiss(),P&&(this.snackBar.open("Deleting..."),this.#t.delete(this.#a,e._RepositoryId,o).subscribe({next:()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchItems()},error:k=>{o||(this.snackBar.dismiss(),this.#m(e,`${k.error.ExceptionMessage} \n\nDo you want to force delete`,!0,"Force Delete","Force"))}}))})}valueGetterEntityField(e){const a=e.data[e.colDef.field];return 0===a.length?null:a.map(o=>o.Title)}valueGetterDateTime(e){const a=e.data[e.colDef.field];return a?e.colDef.useTimePicker?a.replace("T"," ").replace("Z",""):a.split("T")[0]:null}valueGetterBoolean(e){const a=e.data[e.colDef.field];return"boolean"!=typeof a?null:a.toString()}static#C=this.\u0275fac=function(a){return new(a||n)(t.rXU(l.k),t.rXU(be.UG),t.rXU(l.h),t.rXU(t.c1b),t.rXU(Me.gRc))};static#v=this.\u0275cmp=t.VBU({type:n,selectors:[["app-content-items"]],decls:38,vars:10,consts:[["appToggleDebug","",1,"eav-dialog","nav-component-wrapper"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"eav-dialog-content","nav-component-wrapper"],[3,"innerHTML"],[1,"grid-wrapper"],["appDragAndDrop","",1,"ag-theme-material",3,"gridReady","filesDropped","rowData","gridOptions","allowedFileTypes"],[1,"eav-dialog-actions"],[1,"eav-dialog-actions-div"],["mat-button","","tippy","Export xml list","tippyPlacement","top",1,"eav-button__with-icon",3,"href"],[1,"eav-icon"],["mat-button","","tippy","Import xml list","tippyPlacement","top",1,"eav-button__with-icon",3,"href"],["mat-button","","tippy","Import single json item","tippyPlacement","top",1,"eav-button__with-icon",3,"href"],["mat-button","","tippy","Create metadata","tippyPlacement","top",1,"eav-button__with-icon",3,"click"],["mat-button","","color","accent","tippy","Print filter to console","tippyPlacement","top",1,"eav-button__with-icon"],["mat-fab","","mat-elevation-z24","","tippy","Add item",1,"grid-fab",3,"href"],["mat-button","","color","accent","tippy","Print filter to console","tippyPlacement","top",1,"eav-button__with-icon",3,"click"]],template:function(a,o){if(1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.EFF(3),t.k0s(),t.j41(4,"button",3),t.bIt("click",function(){return o.closeDialog()}),t.j41(5,"mat-icon"),t.EFF(6,"close"),t.k0s()()(),t.j41(7,"div",4),t.nrm(8,"router-outlet"),t.nVh(9,De,2,3,"div",5),t.j41(10,"div",6)(11,"ag-grid-angular",7),t.bIt("gridReady",function(h){return o.onGridReady(h)})("filesDropped",function(h){return o.filesDropped(h)}),t.k0s()()(),t.j41(12,"mat-dialog-actions",8)(13,"div",9)(14,"a",10)(15,"mat-icon",11),t.EFF(16,"cloud_download"),t.k0s(),t.j41(17,"span"),t.EFF(18,"Data"),t.k0s()(),t.j41(19,"a",12)(20,"mat-icon",11),t.EFF(21,"cloud_upload"),t.k0s(),t.j41(22,"span"),t.EFF(23,"Data"),t.k0s()(),t.j41(24,"a",13)(25,"mat-icon",11),t.EFF(26,"cloud_upload"),t.k0s(),t.j41(27,"span"),t.EFF(28,"Item"),t.k0s()(),t.j41(29,"button",14),t.bIt("click",function(){return o.createMetadata()}),t.j41(30,"mat-icon",11),t.EFF(31,"local_offer"),t.k0s(),t.j41(32,"span"),t.EFF(33,"Create Metadata"),t.k0s()(),t.nVh(34,Fe,5,0,"button",15),t.k0s(),t.j41(35,"a",16)(36,"mat-icon"),t.EFF(37,"add"),t.k0s()()()()),2&a){let s,h;t.R7$(3),t.SpI("",(null==(s=o.contentType())?null:s.Label)||(null==(s=o.contentType())?null:s.Name)," Data"),t.R7$(6),t.vxM((h=null==(h=o.contentType())||null==h.Properties?null:h.Properties.ListInstructions)?9:-1,h),t.R7$(2),t.Y8G("rowData",o.items())("gridOptions",o.gridOptions)("allowedFileTypes","xml,json"),t.R7$(3),t.Y8G("href",o.urlToExportContent(),t.B4B),t.R7$(5),t.Y8G("href",o.urlToImportContent(),t.B4B),t.R7$(5),t.Y8G("href",o.urlToImportItem(),t.B4B),t.R7$(10),t.vxM(o.isDebug()?34:-1),t.R7$(),t.Y8G("href",o.urlToNewItem(),t.B4B)}},dependencies:[g.Hl,g.$z,nt.M,g.Sr,d.m_,d.An,v.n3,l.M,mt.$,rt.S,lt.V,ct.p,Ee.xs,A.e],encapsulation:2})}return n})()},93826:(x,D,i)=>{i.d(D,{a:()=>c});class c{static boolEquals(g,l){return g===l}static stringEquals(g,l){return g===l}static valueEquals(g,l){return g===l}static objectsEqual(g,l){if(null==g||null==l)return g===l;const d=g,v=l,C=Object.keys(d),E=Object.keys(v);return C.length===E.length&&C.every(_=>!!v.hasOwnProperty(_)&&d[_]===v[_])}static arraysEqual(g,l){return null==g||null==l?g===l:g.length===l.length&&g.every((v,C)=>g[C]===l[C])}static distinct(g,l,d){return d.indexOf(g)===l}}},95699:(x,D,i)=>{i.d(D,{V:()=>g});var c=i(99293),M=i(39431);let g=(()=>{class l{constructor(v){this.globalConfigService=v}onClick(v){(navigator.platform.match("Mac")?v.metaKey:v.ctrlKey)&&v.shiftKey&&v.altKey&&(this.globalConfigService.toggleDebugEnabled(),window.getSelection().removeAllRanges())}static#t=this.\u0275fac=function(C){return new(C||l)(c.rXU(M.B))};static#e=this.\u0275dir=c.FsC({type:l,selectors:[["","appToggleDebug",""]],hostBindings:function(C,E){1&C&&c.bIt("click",function(_){return E.onClick(_)})}})}return l})()},96817:(x,D,i)=>{i.d(D,{R:()=>C});var c=i(47215),M=i(85837),g=i(9234),l=i(24467),d=i(99293),v=i(44444);let C=(()=>{class E extends l.B{create(_,F){return this.http.post(`app/auto/data/${_}`,F,{params:{appId:this.appId,zoneId:this.zoneId}})}update(_,F,b){return this.http.post(`app/auto/data/${_}/${F}`,b,{params:{appId:this.appId,zoneId:this.zoneId}})}delete(_,F,b){return this.http.delete(this.apiUrl(g.gb+"delete"),{params:{contentType:_,id:F.toString(),appId:this.appId,force:b.toString()},context:(new c._y).set(M.g,[400])})}static#t=this.\u0275fac=(()=>{let _;return function(b){return(_||(_=d.xGo(E)))(b||E)}})();static#e=this.\u0275prov=v.jDH({token:E,factory:E.\u0275fac})}return E})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/20.00.00/dist/ng-edit/projects_eav-ui_src_app_content-items_content-items_component_ts.384e606be1ba3133.js.map