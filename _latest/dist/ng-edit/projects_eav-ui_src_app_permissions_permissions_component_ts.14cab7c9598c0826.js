"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_permissions_permissions_component_ts"],{61:(v,c,e)=>{e.r(c),e.d(c,{PermissionsComponent:()=>U});var d=e(2977),o=e(6317),a=e(7714),p=e(116),f=e(4874),y=e(635),C=e(679),T=e(2087),P=e(4153),r=e(941),u=e(2225),t=e(3184),m=e(1130),O=e(6190),D=e(5590);let M=(()=>{class l{agInit(i){this.params=i}refresh(i){return!0}deletePermission(){this.params.onDelete(this.params.data)}}return l.\u0275fac=function(i){return new(i||l)},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-permissions-actions"]],decls:3,vars:0,consts:[[1,"actions-component"],["matRipple","","tippy","Delete",1,"like-button","highlight",3,"click"],["svgIcon","delete"]],template:function(i,s){1&i&&(t.TgZ(0,"div",0)(1,"div",1),t.NdJ("click",function(){return s.deletePermission()}),t._UZ(2,"mat-icon",2),t.qZA()())},directives:[m.wG,O.$,D.Hw],styles:[""]}),l})();var Z=e(2023),I=e(5758),x=e(2528),A=e(7317),E=e(1350),R=e(6362);let U=(()=>{class l{constructor(i,s,n,h,b){this.dialogRef=i,this.router=s,this.route=n,this.permissionsService=h,this.snackBar=b,this.permissions$=new o.X(void 0),this.gridOptions=this.buildGridOptions(),this.subscription=new a.w0,this.targetType=parseInt(this.route.snapshot.paramMap.get("targetType"),10),this.keyType=this.route.snapshot.paramMap.get("keyType"),this.key=this.route.snapshot.paramMap.get("key"),this.prefills={[r.Z.metadata.language.targetType]:{PermissionType:"language"}}}ngOnInit(){this.fetchPermissions(),this.refreshOnChildClosed()}ngOnDestroy(){this.permissions$.complete(),this.subscription.unsubscribe()}closeDialog(){this.dialogRef.close()}fetchPermissions(){this.permissionsService.getAll(this.targetType,this.keyType,this.key).subscribe(i=>{this.permissions$.next(i)})}editPermission(i){var s,n;let h;h=null==i?{items:[Object.assign({ContentTypeName:r.Z.contentTypes.permissions,For:Object.assign(Object.assign(Object.assign({Target:null!==(n=null===(s=Object.values(r.Z.metadata).find(G=>G.targetType===this.targetType))||void 0===s?void 0:s.target)&&void 0!==n?n:this.targetType.toString(),TargetType:this.targetType},this.keyType===r.Z.keyTypes.guid&&{Guid:this.key}),this.keyType===r.Z.keyTypes.number&&{Number:parseInt(this.key,10)}),this.keyType===r.Z.keyTypes.string&&{String:this.key})},this.prefills[this.targetType]&&{Prefill:this.prefills[this.targetType]})]}:{items:[{EntityId:i.Id}]};const b=(0,u.f)(h);this.router.navigate([`edit/${b}`],{relativeTo:this.route})}deletePermission(i){!confirm(`Delete '${i.Title}' (${i.Id})?`)||(this.snackBar.open("Deleting..."),this.permissionsService.delete(i.Id).subscribe(()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchPermissions()}))}refreshOnChildClosed(){this.subscription.add(this.router.events.pipe((0,p.h)(i=>i instanceof d.m2),(0,f.O)(!!this.route.snapshot.firstChild),(0,y.U)(()=>!!this.route.snapshot.firstChild),(0,C.G)(),(0,p.h)(([i,s])=>i&&!s)).subscribe(()=>{this.fetchPermissions()}))}buildGridOptions(){return Object.assign(Object.assign({},P.f),{columnDefs:[{headerName:"ID",field:"Id",width:70,headerClass:"dense",cellClass:"id-action no-padding no-outline".split(" "),sortable:!0,filter:"agNumberColumnFilter",valueGetter:s=>s.data.Id,cellRenderer:T.m,cellRendererParams:{tooltipGetter:n=>`ID: ${n.Id}\nGUID: ${n.Guid}`}},{field:"Name",flex:2,minWidth:250,cellClass:"primary-action highlight".split(" "),sortable:!0,sort:"asc",filter:"agTextColumnFilter",onCellClicked:s=>{this.editPermission(s.data)},valueGetter:s=>s.data.Title},{field:"Identity",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:s=>s.data.Identity},{field:"Condition",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:s=>s.data.Condition},{field:"Grant",width:70,headerClass:"dense",cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:s=>s.data.Grant},{width:42,cellClass:"secondary-action no-padding".split(" "),pinned:"right",cellRenderer:M,cellRendererParams:(()=>({onDelete:n=>this.deletePermission(n)}))()}]})}}return l.\u0275fac=function(i){return new(i||l)(t.Y36(I.so),t.Y36(d.F0),t.Y36(d.gz),t.Y36(Z.q),t.Y36(x.ux))},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-permissions"]],decls:14,vars:4,consts:[[1,"nav-component-wrapper"],["mat-dialog-title",""],[1,"dialog-title-box"],["mat-icon-button","","tippy","Close dialog",3,"click"],["svgIcon","close"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","gridOptions"],[1,"grid-more-actions-box"],["mat-fab","","mat-elevation-z24","","tippy","Create a new permission",1,"grid-fab",3,"click"],["svgIcon","add"]],template:function(i,s){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div"),t._uU(4,"Permissions"),t.qZA(),t.TgZ(5,"button",3),t.NdJ("click",function(){return s.closeDialog()}),t._UZ(6,"mat-icon",4),t.qZA()()(),t._UZ(7,"router-outlet"),t.TgZ(8,"div",5),t._UZ(9,"ag-grid-angular",6),t.ALo(10,"async"),t._UZ(11,"div",7),t.TgZ(12,"button",8),t.NdJ("click",function(){return s.editPermission(null)}),t._UZ(13,"mat-icon",9),t.qZA()()()),2&i&&(t.xp6(9),t.Q6J("rowData",t.lcZ(10,2,s.permissions$))("gridOptions",s.gridOptions))},directives:[I.uh,A.lW,O.$,D.Hw,d.lC,E.N8],pipes:[R.Ov],styles:[""]}),l})()},2087:(v,c,e)=>{e.d(c,{m:()=>P});var d=e(9673),o=e(3184),a=e(2528),p=e(1130),f=e(6190),y=e(6362),C=e(5590);const T=function(r,u){return{"align-start":r,"align-end":u}};let P=(()=>{class r{constructor(t){this.snackBar=t}agInit(t){this.id=t.value,this.align="number"==typeof this.id?"end":"start",this.tooltip=t.tooltipGetter(t.data)}refresh(t){return!0}copy(){(0,d.v)(this.tooltip),this.snackBar.open("Copied to clipboard",null,{duration:2e3})}}return r.\u0275fac=function(t){return new(t||r)(o.Y36(a.ux))},r.\u0275cmp=o.Xpm({type:r,selectors:[["app-id-field"]],decls:4,vars:6,consts:[["matRipple","",1,"id-box","highlight",3,"tippy","ngClass","click"],[1,"id"],["svgIcon","file-copy",1,"icon"]],template:function(t,m){1&t&&(o.TgZ(0,"div",0),o.NdJ("click",function(){return m.copy()}),o.TgZ(1,"span",1),o._uU(2),o.qZA(),o._UZ(3,"mat-icon",2),o.qZA()),2&t&&(o.Q6J("tippy",m.tooltip)("ngClass",o.WLB(3,T,"start"===m.align,"end"===m.align)),o.xp6(2),o.Oqu(m.id))},directives:[p.wG,f.$,y.mk,C.Hw],styles:[".id-box[_ngcontent-%COMP%]{padding:0 8px;height:100%;display:flex;align-items:center}.id-box.align-start[_ngcontent-%COMP%]{justify-content:flex-start}.id-box.align-end[_ngcontent-%COMP%]{justify-content:flex-end}.id-box[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{max-width:100%;text-overflow:ellipsis;overflow:hidden}.id-box[_ngcontent-%COMP%]:hover{text-decoration:none}.id-box[_ngcontent-%COMP%]:hover   .id[_ngcontent-%COMP%]{display:none}.id-box[_ngcontent-%COMP%]:not(:hover)   .icon[_ngcontent-%COMP%]{display:none}"]}),r})()},4153:(v,c,e)=>{e.d(c,{f:()=>d});const d={accentedSort:!0,animateRows:!0,enableCellTextSelection:!0,headerHeight:32,suppressScrollOnNewData:!0,valueCache:!0,defaultColDef:{filterParams:{newRowsAction:"keep"}},tooltipShowDelay:0,tooltipHideDelay:1e5,suppressMovableColumns:!0}},9673:(v,c,e)=>{function d(o){const a=document.createElement("textarea");a.value=o,a.setAttribute("readonly",""),a.style.position="absolute",a.style.left="-9999px",document.body.appendChild(a);const p=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);a.select(),document.execCommand("copy"),document.body.removeChild(a),p&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(p))}e.d(c,{v:()=>d})}}]);
//# sourceMappingURL=https://sources.2sxc.org/14.09.00/ng-edit/projects_eav-ui_src_app_permissions_permissions_component_ts.14cab7c9598c0826.js.map