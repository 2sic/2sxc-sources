(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{SST1:function(e,t,i){"use strict";i.r(t);var n=i("D57K"),s=i("5/c3"),o=i("LiEJ"),r=i("LR82"),a=i("z5yO"),l=i("W/Ou"),c=i("Jg5f"),p=i("QagP"),d=i("KLQV"),u=i("1C3z"),h=i("OeRG"),m=i("Qc/f"),b=i("r4gC"),f=function(){function e(){}return e.prototype.agInit=function(e){this.params=e},e.prototype.refresh=function(e){return!0},e.prototype.deletePermission=function(){this.params.onDelete(this.params.data)},e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=u.Jb({type:e,selectors:[["app-permissions-actions"]],decls:4,vars:0,consts:[[1,"actions-component"],["matRipple","","matTooltip","Delete",1,"like-button","highlight",3,"click"]],template:function(e,t){1&e&&(u.Vb(0,"div",0),u.Vb(1,"div",1),u.dc("click",(function(){return t.deletePermission()})),u.Vb(2,"mat-icon"),u.Oc(3,"delete"),u.Ub(),u.Ub(),u.Ub())},directives:[h.q,m.a,b.a],styles:[""],changeDetection:0}),e}(),y=i("o9tz"),g=i("JzAw"),v=i("QjRa"),C=i("uuTa"),k=i("BLjT"),O=i("SNUn"),T=i("2pW/"),w=i("9HSk"),P=i("G6Ml"),D=i("8AiQ");i.d(t,"PermissionsComponent",(function(){return j}));var j=function(){function e(e,t,i,s,a){this.dialogRef=e,this.router=t,this.route=i,this.permissionsService=s,this.snackBar=a,this.permissions$=new o.a(null),this.modules=d.a,this.gridOptions=Object(n.a)(Object(n.a)({},v.a),{frameworkComponents:{idFieldComponent:g.a,permissionsActionsComponent:f},columnDefs:[{headerName:"ID",field:"Id",width:70,headerClass:"dense",cellClass:"id-action no-padding no-outline",cellRenderer:"idFieldComponent",sortable:!0,filter:"agTextColumnFilter",valueGetter:this.idValueGetter},{headerName:"Name",field:"Title",flex:2,minWidth:250,cellClass:"primary-action highlight",sortable:!0,filter:"agTextColumnFilter",onCellClicked:this.editPermission.bind(this)},{width:40,cellClass:"secondary-action no-padding",cellRenderer:"permissionsActionsComponent",cellRendererParams:{onDelete:this.deletePermission.bind(this)}},{headerName:"Identity",field:"Identity",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter"},{headerName:"Condition",field:"Condition",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter"},{headerName:"Grant",field:"Grant",width:70,headerClass:"dense",cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter"}]}),this.subscription=new r.a,this.targetType=parseInt(this.route.snapshot.paramMap.get("type"),10),this.keyType=this.route.snapshot.paramMap.get("keyType"),this.key=this.route.snapshot.paramMap.get("key")}return e.prototype.ngOnInit=function(){this.fetchPermissions(),this.refreshOnChildClosed()},e.prototype.ngOnDestroy=function(){this.permissions$.complete(),this.subscription.unsubscribe()},e.prototype.closeDialog=function(){this.dialogRef.close()},e.prototype.idValueGetter=function(e){var t=e.data;return"ID: "+t.Id+"\nGUID: "+t.Guid},e.prototype.fetchPermissions=function(){var e=this;this.permissionsService.getAll(this.targetType,this.keyType,this.key).subscribe((function(t){e.permissions$.next(t)}))},e.prototype.editPermission=function(e){var t,i,s;if(null==e){var o=void 0,r=Object.keys(y.a.metadata);try{for(var a=Object(n.i)(r),l=a.next();!l.done;l=a.next()){var c=l.value;if(y.a.metadata[c].type===this.targetType){o=y.a.metadata[c].target;break}}}catch(d){t={error:d}}finally{try{l&&!l.done&&(i=a.return)&&i.call(a)}finally{if(t)throw t.error}}s={items:[{ContentTypeName:y.a.contentTypes.permissions,For:Object(n.a)(Object(n.a)(Object(n.a)({Target:o},this.keyType===y.a.keyTypes.guid&&{Guid:this.key}),this.keyType===y.a.keyTypes.number&&{Number:parseInt(this.key,10)}),this.keyType===y.a.keyTypes.string&&{String:this.key})}]}}else s={items:[{EntityId:e.data.Id}]};var p=Object(C.a)(s);this.router.navigate(["edit/"+p],{relativeTo:this.route})},e.prototype.deletePermission=function(e){var t=this;confirm("Delete '"+e.Title+"' ("+e.Id+")?")&&(this.snackBar.open("Deleting..."),this.permissionsService.delete(e.Id).subscribe((function(){t.snackBar.open("Deleted",null,{duration:2e3}),t.fetchPermissions()})))},e.prototype.refreshOnChildClosed=function(){var e=this;this.subscription.add(this.router.events.pipe(Object(a.a)((function(e){return e instanceof s.b})),Object(l.a)(!!this.route.snapshot.firstChild),Object(c.a)((function(){return!!e.route.snapshot.firstChild})),Object(p.a)(),Object(a.a)((function(e){var t=Object(n.f)(e,2);return t[0]&&!t[1]}))).subscribe((function(){e.fetchPermissions()})))},e.\u0275fac=function(t){return new(t||e)(u.Pb(k.g),u.Pb(s.c),u.Pb(s.a),u.Pb(O.a),u.Pb(T.b))},e.\u0275cmp=u.Jb({type:e,selectors:[["app-permissions"]],decls:15,vars:5,consts:[[1,"nav-component-wrapper"],["mat-dialog-title",""],[1,"dialog-title-box"],["mat-icon-button","","matTooltip","Close dialog",3,"click"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","modules","gridOptions"],["mat-fab","","mat-elevation-z24","","matTooltip","Create a new permission",1,"grid-fab",3,"click"]],template:function(e,t){1&e&&(u.Vb(0,"div",0),u.Vb(1,"div",1),u.Vb(2,"div",2),u.Vb(3,"div"),u.Oc(4,"Permissions"),u.Ub(),u.Vb(5,"button",3),u.dc("click",(function(){return t.closeDialog()})),u.Vb(6,"mat-icon"),u.Oc(7,"close"),u.Ub(),u.Ub(),u.Ub(),u.Ub(),u.Qb(8,"router-outlet"),u.Vb(9,"div",4),u.Qb(10,"ag-grid-angular",5),u.ic(11,"async"),u.Vb(12,"button",6),u.dc("click",(function(){return t.editPermission(null)})),u.Vb(13,"mat-icon"),u.Oc(14,"add"),u.Ub(),u.Ub(),u.Ub(),u.Ub()),2&e&&(u.Bb(10),u.nc("rowData",u.jc(11,3,t.permissions$))("modules",t.modules)("gridOptions",t.gridOptions))},directives:[k.h,w.a,m.a,b.a,s.e,P.a],pipes:[D.b],styles:[""],changeDetection:0}),e}()}}]);
//# sourceMappingURL=https://sources.2sxc.org/11.07.00/ng-edit/permissions-component.12eb385668f83bf37b62.js.map