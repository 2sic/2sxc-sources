"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_app-administration_sub-dialogs_views-usage_views-usage_component_ts"],{2570:(G,m,s)=>{s.d(m,{y:()=>D});var f=s(8873),p=s(8559),C=s(6443),I=s(4821);const u="admin/view/",w=u+"all",x=u+"delete",b=u+"import",V=u+"polymorphism",F=u+"usage";let D=(()=>{class g{constructor(d,c,h){this.http=d,this.context=c,this.dnnContext=h}getAll(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(w),{params:{appId:this.context.appId.toString()}})}delete(d){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(x),{params:{appId:this.context.appId.toString(),Id:d.toString()}})}import(d){const c=new FormData;return c.append("File",d),this.http.post(this.dnnContext.$2sxc.http.apiUrl(b),c,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}export(d){const c=this.dnnContext.$2sxc.http.apiUrl(u+"json")+"?appId="+this.context.appId+"&viewId="+d;window.open(c,"_blank","")}getPolymorphism(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(V),{params:{appId:this.context.appId.toString()}})}getUsage(d){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(F),{params:{appId:this.context.appId.toString(),guid:d}})}static#t=this.\u0275fac=function(c){return new(c||g)(p.KVO(C.Qq),p.KVO(f.o),p.KVO(I.ob))};static#e=this.\u0275prov=p.jDH({token:g,factory:g.\u0275fac})}return g})()},8267:(G,m,s)=>{s.r(m),s.d(m,{ViewsUsageComponent:()=>K});var f=s(2159),p=s(5797),C=s(9999),I=s(271),u=s(251),w=s(2570);function x(i){const a=i.data;return`ID: ${a.Block.Id}\nGUID: ${a.Block.Guid}`}function b(i){const a=i.data;if(null!=a.Module)return`ID: ${a.Module.Id}\nUsageId: ${a.Module.UsageId}\nTitle: ${a.Module.Title}`}function V(i){return((null!=i.value?"id-action no-padding":"")+" no-outline").split(" ")}function F(i){const a=i.data;if(null!=a.PageId)return`ID: ${a.PageId}`}function D(i){return((null!=i.value?"id-action no-padding":"")+" no-outline").split(" ")}function g(i){return(null!=i.value?"primary-action highlight":"no-outline").split(" ")}function O(i){null!=i.value&&window.open(i.data.Url,"_blank")}function d(i){const a=i.value;if(null!=a)return`\n    <div style="height: 100%;display: flex;align-items: center;">\n      ${a.IsVisible?'<span class="material-icons-outlined">visibility</span>':'<span class="material-icons-outlined">visibility_off</span>'}\n      ${a.IsDeleted?'<span style="margin-left: 8px;" class="material-icons-outlined">delete</span>':""}\n    </div>\n  `}var c=s(519),h=s(3840),P=s(5060),$=s(7896),t=s(8559),E=s(3347);function T(i,a){if(1&i){const e=t.RV6();t.j41(0,"div",1),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.copy())}),t.j41(1,"span",2),t.EFF(2),t.k0s(),t.j41(3,"mat-icon",3),t.EFF(4,"file_copy"),t.k0s()()}if(2&i){const e=t.XpG();t.Y8G("tippy",e.tooltip),t.R7$(2),t.JRh(e.id)}}let U=(()=>{class i{constructor(e){this.snackBar=e}agInit(e){if(this.tooltip=e.value,null==this.tooltip)return;const n=this.tooltip.split("\n")[0];this.id=n.split(" ")[1]}refresh(e){return!0}copy(){(0,c.l)(this.tooltip),this.snackBar.open("Copied to clipboard",null,{duration:2e3})}static#t=this.\u0275fac=function(n){return new(n||i)(t.rXU(E.UG))};static#e=this.\u0275cmp=t.VBU({type:i,selectors:[["app-views-usage-id"]],standalone:!0,features:[t.aNF],decls:1,vars:1,consts:[["matRipple","",1,"id-box","highlight",3,"tippy"],["matRipple","",1,"id-box","highlight",3,"click","tippy"],[1,"id"],[1,"icon"]],template:function(n,o){1&n&&t.DNE(0,T,5,2,"div",0),2&n&&t.vxM(0,o.id?0:-1)},dependencies:[P.pZ,P.r6,h.m_,h.An,$.e],styles:[".id-box[_ngcontent-%COMP%]{padding:0 8px;text-align:end;height:100%;display:flex;align-items:center;justify-content:flex-end}.id-box[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{max-width:100%;text-overflow:ellipsis;overflow:hidden}.id-box[_ngcontent-%COMP%]:hover{text-decoration:none}.id-box[_ngcontent-%COMP%]:hover   .id[_ngcontent-%COMP%]{display:none}.id-box[_ngcontent-%COMP%]:not(:hover)   .icon[_ngcontent-%COMP%]{display:none}"]})}return i})();var M=s(4456),y=s(3804);let R=(()=>{class i{constructor(){this.isVisible="",this.isDeleted=""}agInit(e){this.filterParams=e}isFilterActive(){return""!==this.isVisible||""!==this.isDeleted}doesFilterPass(e){let n=!1,o=!1;const l=this.filterParams.valueGetter({api:this.filterParams.api,colDef:this.filterParams.colDef,column:this.filterParams.column,columnApi:this.filterParams.columnApi,context:this.filterParams.context,data:e.node.data,getValue:L=>e.node.data[L],node:e.node});return null!=l&&(n=""===this.isVisible||null!=l.IsVisible&&l.IsVisible.toString()===this.isVisible,o=""===this.isDeleted||null!=l.IsDeleted&&l.IsDeleted.toString()===this.isDeleted,n&&o)}getModel(){if(this.isFilterActive())return{filterType:"views-usage-status",isVisible:this.isVisible,isDeleted:this.isDeleted}}setModel(e){this.isVisible=e?e.isVisible:"",this.isDeleted=e?e.isDeleted:""}afterGuiAttached(e){}filterChanged(){this.filterParams.filterChangedCallback()}static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275cmp=t.VBU({type:i,selectors:[["app-views-usage-status-filter"]],standalone:!0,features:[t.aNF],decls:18,vars:2,consts:[[1,"title"],[3,"ngModelChange","ngModel"],["value",""],["value","true"],["value","false"]],template:function(n,o){1&n&&(t.j41(0,"div",0),t.EFF(1,"Visible"),t.k0s(),t.j41(2,"mat-radio-group",1),t.mxI("ngModelChange",function(l){return t.DH7(o.isVisible,l)||(o.isVisible=l),l}),t.bIt("ngModelChange",function(){return o.filterChanged()}),t.j41(3,"mat-radio-button",2),t.EFF(4,"All"),t.k0s(),t.j41(5,"mat-radio-button",3),t.EFF(6,"Visible"),t.k0s(),t.j41(7,"mat-radio-button",4),t.EFF(8,"Hidden"),t.k0s()(),t.j41(9,"div",0),t.EFF(10,"Deleted"),t.k0s(),t.j41(11,"mat-radio-group",1),t.mxI("ngModelChange",function(l){return t.DH7(o.isDeleted,l)||(o.isDeleted=l),l}),t.bIt("ngModelChange",function(){return o.filterChanged()}),t.j41(12,"mat-radio-button",2),t.EFF(13,"All"),t.k0s(),t.j41(14,"mat-radio-button",3),t.EFF(15,"Is deleted"),t.k0s(),t.j41(16,"mat-radio-button",4),t.EFF(17,"Is not deleted"),t.k0s()()),2&n&&(t.R7$(2),t.R50("ngModel",o.isVisible),t.R7$(9),t.R50("ngModel",o.isDeleted))},dependencies:[y.Wk,y.VT,y._g,M.YN,M.BC,M.vS],styles:[".title[_ngcontent-%COMP%]{padding:12px 12px 0}.mat-mdc-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;overflow:hidden;padding:12px;width:160px;height:104px}"]})}return i})();var v=s(1828),S=s(316),j=s(4175),k=s(7037),A=s(5437),B=s(7941),N=s(9841);function X(i,a){if(1&i){const e=t.RV6();t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),t.EFF(4),t.k0s(),t.j41(5,"button",4),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.closeDialog())}),t.j41(6,"mat-icon"),t.EFF(7,"close"),t.k0s()()()(),t.j41(8,"p",5),t.EFF(9," This shows where this view is being used. Read about the "),t.j41(10,"a",6),t.EFF(11,"connections between DNN and 2sxc Views"),t.k0s(),t.EFF(12," to make good decisions if you're doing clean-up or just want to better know what this is all about. "),t.j41(13,"em"),t.EFF(14,"Before you get confused about some things you see here, do read the FAQ on that page."),t.k0s()(),t.nrm(15,"router-outlet"),t.j41(16,"div",7),t.nrm(17,"ag-grid-angular",8)(18,"div",9),t.k0s()()}if(2&i){const e=a,n=t.XpG();t.R7$(3),t.Y8G("tippy",e.viewTooltip),t.R7$(),t.SpI("View: ",null==e.viewUsage?null:e.viewUsage.Name,""),t.R7$(13),t.Y8G("rowData",e.data)("gridOptions",n.gridOptions)}}let K=(()=>{class i{constructor(e,n){this.dialogRef=e,this.route=n,this.viewUsage$=new p.t(void 0),this.viewTooltip$=new p.t(void 0),this.data$=new p.t(void 0),this.gridOptions=this.buildGridOptions(),this.viewsService=(0,A.d)(w.y)}ngOnInit(){const e=this.route.snapshot.paramMap.get("guid");this.viewsService.getUsage(e).subscribe(n=>{const o=n[0];this.viewUsage$.next(o),this.viewTooltip$.next(`ID: ${o.Id}\nGUID: ${o.Guid}`);const l=function _(i){const a=[];for(const e of i.Blocks){0===e.Modules.length&&a.push({Block:{Id:e.Id,Guid:e.Guid}});for(const n of e.Modules)a.push({Block:{Id:e.Id,Guid:e.Guid},Module:n,PageId:n.Page.Id,Name:n.Page.Name,Url:n.Page.Url,Language:n.Page.CultureCode,Status:{IsVisible:n.Page.Visible,IsDeleted:n.IsDeleted}})}return a}(o);this.data$.next(l)}),this.viewModel$=(0,C.z)([this.viewUsage$,this.viewTooltip$,this.data$]).pipe((0,I.T)(([n,o,r])=>({viewUsage:n,viewTooltip:o,data:r})))}ngOnDestroy(){this.viewUsage$.complete(),this.viewTooltip$.complete(),this.data$.complete()}closeDialog(){this.dialogRef.close()}buildGridOptions(){return{...u.C,columnDefs:[{...v.r.Id,field:"Block",valueGetter:x,cellRenderer:U},{...v.r.Number,field:"Module",width:80,valueGetter:b,cellClass:V,cellRenderer:U},{...v.r.Number,field:"Page",valueGetter:F,cellClass:D,cellRenderer:U},{...v.r.TextWide,field:"Name",sort:"asc",cellClass:g,onCellClicked:O},{field:"Language",width:90,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter"},{field:"Status",width:80,cellClass:"icon no-outline".split(" "),filter:R,cellRenderer:d}]}}static#t=this.\u0275fac=function(n){return new(n||i)(t.rXU(B.CP),t.rXU(f.nX))};static#e=this.\u0275cmp=t.VBU({type:i,selectors:[["app-views-usage"]],standalone:!0,features:[t.aNF],decls:2,vars:3,consts:[[1,"nav-component-wrapper"],["mat-mdc-dialog-title",""],[1,"dialog-title-box"],[3,"tippy"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"dialog-description"],["href","https://go.2sxc.org/content-in-dnn","target","_blank"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","gridOptions"],[1,"grid-more-actions-box"]],template:function(n,o){if(1&n&&(t.DNE(0,X,19,4,"div",0),t.nI1(1,"async")),2&n){let r;t.vxM(0,(r=t.bMT(1,1,o.viewModel$))?0:-1,r)}},dependencies:[j.Hl,j.iY,h.m_,h.An,f.n3,S.Jj,k.p,N.xs,$.e]})}return i})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/18.00.01/dist/ng-edit/projects_eav-ui_src_app_app-administration_sub-dialogs_views-usage_views-usage_component_ts.05322f429cdffea7.js.map