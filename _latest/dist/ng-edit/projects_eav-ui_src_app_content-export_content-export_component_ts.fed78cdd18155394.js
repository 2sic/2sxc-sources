"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_content-export_content-export_component_ts"],{17693:(F,M,e)=>{e.d(M,{X:()=>T,g:()=>y});var f=e(46443),d=e(64173),x=e(96474),D=e(99293),I=e(44444);const T="admin/type/",u="admin/type/get",c="admin/type/list",v="admin/type/scopes";let y=(()=>{class t extends x.D{retrieveContentType(a){return this.getHttpApiUrl(u,{params:{appId:this.appId,contentTypeId:a}})}getType(a){return(0,f.fx)(()=>({url:this.apiUrl(u),params:{appId:this.appId,contentTypeId:a}}))}getTypes(a){return(0,f.fx)(()=>({url:this.apiUrl(c),params:{appId:this.appId,scope:a()}}),{defaultValue:[]})}retrieveContentTypesPromise(a){return this.fetchPromise(c,{params:{appId:this.appId,scope:a}})}getScopesPromise(){return this.fetchPromise(v,{params:{appId:this.appId}}).then(a=>{const m=a.old;return Object.keys(m).map(E=>({name:m[E],value:E}))})}getScopesSig(){const a=(0,f.fx)(()=>({url:this.apiUrl(v),params:{appid:this.appId}}));return(0,d.EW)(()=>{const E=(0,a.value)();if(!E||!E.old)return[];const R=E.old;return Object.keys(R).map(P=>({name:R[P],value:P}))})}getScopesV2Promise(){return this.fetchPromise(v,{params:{appId:this.appId}}).then(a=>a.scopes)}save(a){return this.http.post(this.apiUrl("admin/type/save"),a,{params:{appid:this.appId}})}delete(a){return this.http.delete(this.apiUrl("admin/type/delete"),{params:{appid:this.appId,staticName:a.NameId}})}import(a){const m=new FormData;for(const h of a)m.append("File",h);return this.http.post(this.apiUrl("admin/type/import"),m,{params:{appId:this.appId,zoneId:this.zoneId}})}createGhost(a){return this.http.post(this.apiUrl("admin/type/addghost"),null,{params:{appid:this.appId,sourceNameId:a}})}static#t=this.\u0275fac=(()=>{let a;return function(h){return(a||(a=D.xGo(t)))(h||t)}})();static#e=this.\u0275prov=I.jDH({token:t,factory:t.\u0275fac})}return t})()},56360:(F,M,e)=>{e.d(M,{D:()=>u});var f=e(24467),d=e(99293),x=e(44444);let u=(()=>{class c extends f.B{exportContent(i,l){const g=l?"&selectedids="+l.join():"",C=this.apiUrl("admin/entity/Download")+"?appId="+this.appId+"&language="+i.language+"&defaultLanguage="+i.defaultLanguage+"&contentType="+i.contentTypeStaticName+"&recordExport="+i.recordExport+"&resourcesReferences="+i.resourcesReferences+"&languageReferences="+i.languageReferences+g;window.open(C,"_blank","")}exportJson(i){const l=this.apiUrl("admin/type/Json")+"?appId="+this.appId+"&name="+i;window.open(l,"_blank","")}exportEntity(i,l,g){const C=this.apiUrl("admin/entity/Json")+"?appId="+this.appId+"&id="+i+"&prefix="+l+"&withMetadata="+g;window.open(C,"_blank","")}static#t=this.\u0275fac=(()=>{let i;return function(g){return(i||(i=d.xGo(c)))(g||c)}})();static#e=this.\u0275prov=x.jDH({token:c,factory:c.\u0275fac})}return c})()},75727:(F,M,e)=>{e.r(M),e.d(M,{ContentExportComponent:()=>L});var f=e(87945),d=e(34456),x=e(84175),D=e(31403),I=e(81863),T=e(31016),u=e(53804),c=e(64043),v=e(75797),i=e(61873),l=e(12938),g=e(17693),C=e(64699),y=e(56360),t=e(99293),_=e(44444),a=e(29658),m=e(87698),h=e(23731);function E(p,O){if(1&p&&(t.j41(0,"mat-option",10),t.EFF(1),t.k0s()),2&p){const s=O.$implicit;t.Y8G("value",s.NameId),t.R7$(),t.JRh(s.NameId)}}function R(p,O){if(1&p&&(t.j41(0,"mat-radio-button",15),t.EFF(1),t.k0s()),2&p){const s=t.XpG(2);t.R7$(),t.SpI(" Export selected ",s.itemIds.length," items ")}}function P(p,O){if(1&p){const s=t.RV6();t.j41(0,"form",null,0)(2,"div",4)(3,"p"),t.EFF(4," This will generate an XML file which you can edit in Excel. If you just want to import new data, use this to export the schema that you can then fill in using Excel. Please visit "),t.j41(5,"a",5),t.EFF(6,"https://2sxc.org/help"),t.k0s(),t.EFF(7," for more instructions. "),t.k0s(),t.j41(8,"div",6)(9,"div")(10,"mat-form-field",7)(11,"mat-label"),t.EFF(12,"Languages"),t.k0s(),t.j41(13,"mat-select",8),t.mxI("ngModelChange",function(n){_.eBV(s);const r=t.XpG();return t.DH7(r.formValues.language,n)||(r.formValues.language=n),_.Njj(n)}),t.j41(14,"mat-option",9),t.EFF(15,"All"),t.k0s(),t.Z7z(16,E,2,2,"mat-option",10,t.fX1),t.k0s()()(),t.j41(18,"div")(19,"p",11),t.EFF(20,"Export data"),t.k0s(),t.j41(21,"mat-radio-group",12),t.mxI("ngModelChange",function(n){_.eBV(s);const r=t.XpG();return t.DH7(r.formValues.recordExport,n)||(r.formValues.recordExport=n),_.Njj(n)}),t.j41(22,"mat-radio-button",13),t.EFF(23,"No, just export blank data schema (for new data import) "),t.k0s(),t.j41(24,"mat-radio-button",14),t.EFF(25,"Yes, export all content-items"),t.k0s(),t.nVh(26,R,2,1,"mat-radio-button",15),t.k0s()(),t.j41(27,"div")(28,"p",11),t.EFF(29,"Value references to other languages"),t.k0s(),t.j41(30,"mat-radio-group",16),t.mxI("ngModelChange",function(n){_.eBV(s);const r=t.XpG();return t.DH7(r.formValues.languageReferences,n)||(r.formValues.languageReferences=n),_.Njj(n)}),t.j41(31,"mat-radio-button",17),t.EFF(32,"Keep references to other languages (for re-import) "),t.k0s(),t.j41(33,"mat-radio-button",18),t.EFF(34,"Replace references with values"),t.k0s()()(),t.j41(35,"div")(36,"p",11),t.EFF(37,"File / page references"),t.k0s(),t.j41(38,"mat-radio-group",19),t.mxI("ngModelChange",function(n){_.eBV(s);const r=t.XpG();return t.DH7(r.formValues.resourcesReferences,n)||(r.formValues.resourcesReferences=n),_.Njj(n)}),t.j41(39,"mat-radio-button",17),t.EFF(40,"Keep references (for re-import, for example Page:4711) "),t.k0s(),t.j41(41,"mat-radio-button",18),t.EFF(42,"Replace references with real URLs (for example /Portals/0...) "),t.k0s()()()()(),t.j41(43,"mat-dialog-actions",20)(44,"button",21),t.bIt("click",function(){_.eBV(s);const n=t.XpG();return _.Njj(n.closeDialog())}),t.EFF(45,"Cancel"),t.k0s(),t.j41(46,"button",22),t.bIt("click",function(){_.eBV(s);const n=t.XpG();return _.Njj(n.exportContent())}),t.EFF(47,"Export Data"),t.k0s()()()}if(2&p){const s=t.sdS(1),o=t.XpG();t.R7$(13),t.R50("ngModel",o.formValues.language),t.R7$(3),t.Dyx(o.languages),t.R7$(5),t.R50("ngModel",o.formValues.recordExport),t.R7$(5),t.vxM(o.hasIdList?26:-1),t.R7$(4),t.R50("ngModel",o.formValues.languageReferences),t.Y8G("disabled","Blank"===o.formValues.recordExport),t.R7$(8),t.R50("ngModel",o.formValues.resourcesReferences),t.Y8G("disabled","Blank"===o.formValues.recordExport),t.R7$(8),t.Y8G("disabled",!s.form.valid)}}let L=(()=>{class p{constructor(s,o){this.dialog=s,this.route=o,this.hostClass="dialog-component",this.contentExportService=(0,l.d)(y.D),this.contentTypesService=(0,l.d)(g.g),this.dialogConfigSvc=(0,l.d)(C.L),this.hasIdList=!1,this.loading$=new v.t(!1),this.contentType$=new v.t(null),this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName");const n=this.route.snapshot.paramMap.get("selectedIds");this.hasIdList=!!n,this.hasIdList&&(this.itemIds=n.split(",").map(r=>parseInt(r,10)))}ngOnInit(){this.loading$.next(!0);const s=this.contentTypesService.retrieveContentType(this.contentTypeStaticName),o=this.dialogConfigSvc.getCurrent$();(0,i.p)([s,o]).subscribe(([n,r])=>{this.contentType$.next(n),this.languages=r.Context.Language.List,this.formValues={defaultLanguage:r.Context.Language.Primary,contentTypeStaticName:this.contentTypeStaticName,language:"",recordExport:this.hasIdList?"Selection":"All",languageReferences:"Link",resourcesReferences:"Link"},this.loading$.next(!1)})}ngOnDestroy(){this.contentType$.complete(),this.loading$.complete()}closeDialog(){this.dialog.close()}exportContent(){this.contentExportService.exportContent(this.formValues,this.hasIdList&&"Selection"===this.formValues.recordExport?this.itemIds:null)}static#t=this.\u0275fac=function(o){return new(o||p)(t.rXU(I.k),t.rXU(a.nX))};static#e=this.\u0275cmp=t.VBU({type:p,selectors:[["app-content-export"]],hostVars:1,hostBindings:function(o,n){2&o&&t.Avn("className",n.hostClass)},decls:7,vars:6,consts:[["ngForm","ngForm"],[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],["href","https://2sxc.org/help","target","_blank"],[1,"dialog-form-content","fancy-scrollbar-light"],["color","accent",1,"eav-mat-form-field"],["name","Language",3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"eav-radio-group-label"],["name","RecordExport",1,"eav-radio-group",3,"ngModelChange","ngModel"],["value","Blank"],["value","All"],["value","Selection"],["name","LanguageReferences",1,"eav-radio-group",3,"ngModelChange","ngModel","disabled"],["value","Link"],["value","Resolve"],["name","ResourcesReferences",1,"eav-radio-group",3,"ngModelChange","ngModel","disabled"],["align","end"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"click","disabled"]],template:function(o,n){if(1&o&&(t.j41(0,"div",1)(1,"div",2)(2,"div",3),t.EFF(3),t.nI1(4,"async"),t.k0s()(),t.nVh(5,P,48,8,"form"),t.nI1(6,"async"),t.k0s()),2&o){let r;t.R7$(3),t.SpI("Export ",null==(r=t.bMT(4,2,n.contentType$))?null:r.Name),t.R7$(2),t.vxM(!1===t.bMT(6,4,n.loading$)?5:-1)}},dependencies:[d.YN,d.qT,d.BC,d.cb,d.vS,d.cV,T.M,m.j,m.M,c.M,c.g,h.M,D.M,u.Wk,u.VT,u._g,I.M,x.Hl,x.$z,f.Jj],styles:[".eav-radio-group-label[_ngcontent-%COMP%]{font-size:18px;margin:24px 0 0}.eav-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:8px 0}"]})}return p})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/20.00.04/dist/ng-edit/projects_eav-ui_src_app_content-export_content-export_component_ts.fed78cdd18155394.js.map