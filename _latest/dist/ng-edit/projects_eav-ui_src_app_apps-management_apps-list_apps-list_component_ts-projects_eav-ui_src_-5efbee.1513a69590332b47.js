"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_apps-management_apps-list_apps-list_component_ts-projects_eav-ui_src_-5efbee"],{1609:(D,h,t)=>{t.r(h),t.d(h,{AppsListComponent:()=>V});var o=t(9509),g=t(8824),f=t(316),e=t(7580),A=t(6256),l=t(4175),C=t(7941),n=t(3840),d=t(2159),p=t(3183),v=t(2938),c=t(8713),b=t(8136),T=t(9001),E=t(9006),I=t(8991),u=t(1828),k=t(1960),R=t(251),L=t(4575),U=t(3216),B=t(4435),O=t(7037),j=t(8471),M=t(8873),$=t(3583);const G={states:{true:{tooltip:"Show this app to users",icon:"visibility"},false:{tooltip:"Hide this app from users",icon:"visibility_off"}}},W={states:{true:{clickable:!0,tooltip:"This App uses obsolete code which will cause problems on future upgrades. Click to see details.",icon:"bug_report",getUrl:r=>window.$2sxc.http.apiUrl("sys/insights/logs?key=warnings-obsolete&filter=AppId="+r.Id)},false:{tooltip:"Hide this app from users",icon:""}}};var y=t(1034),S=t(4646),w=t(1657),N=t(4601);function _(r,P){1&r&&(e.j41(0,"mat-icon"),e.EFF(1,"foundation"),e.k0s())}function X(r,P){1&r&&(e.j41(0,"mat-icon"),e.EFF(1,"holiday_village"),e.k0s())}function H(r,P){if(1&r){const i=e.RV6();e.j41(0,"button",7),e.bIt("click",function(){e.eBV(i);const s=e.XpG();return e.Njj(s.do("flushCache"))}),e.j41(1,"mat-icon"),e.EFF(2,"cached"),e.k0s(),e.j41(3,"span"),e.EFF(4,"Flush cache"),e.k0s()(),e.j41(5,"button",8),e.bIt("click",function(){e.eBV(i);const s=e.XpG();return e.Njj(s.do("deleteApp"))}),e.j41(6,"mat-icon"),e.EFF(7,"delete"),e.k0s(),e.j41(8,"span"),e.EFF(9,"Delete"),e.k0s()()}if(2&r){const i=e.XpG();e.R7$(5),e.Y8G("disabled",!i.app.IsApp)}}let Y=(()=>{class r{agInit(i){this.params=i,this.app=this.params.data}refresh(i){return!0}do(i){this.params.do(i,this.app)}static{this.\u0275fac=function(a){return new(a||r)}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-apps-list-actions"]],decls:11,vars:8,consts:[["menu","matMenu"],[1,"actions-component"],[1,"eav-grid-action-button","icon",3,"tippy","tippyDisabled"],[3,"lightSpeedOwner","params","lightSpeed"],["matRipple","","tippy","More",1,"eav-grid-action-button","highlight",3,"matMenuTriggerFor"],[1,"grid-more-menu"],["matMenuContent",""],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click","disabled"]],template:function(a,s){if(1&a&&(e.j41(0,"div",1)(1,"div",2),e.DNE(2,_,2,0,"mat-icon")(3,X,2,0,"mat-icon"),e.k0s(),e.nrm(4,"app-lightspeed-action",3),e.j41(5,"div",4)(6,"mat-icon"),e.EFF(7,"more_horiz"),e.k0s()()(),e.j41(8,"mat-menu",5,0),e.DNE(10,H,10,1,"ng-template",6),e.k0s()),2&a){const m=e.sdS(9);e.R7$(),e.Y8G("tippy",s.app.IsGlobal?"This app is global":s.app.IsInherited?"This app is inherited":"")("tippyDisabled",!s.app.IsGlobal&&!s.app.IsInherited),e.R7$(),e.vxM(s.app.IsGlobal?2:-1),e.R7$(),e.vxM(s.app.IsInherited?3:-1),e.R7$(),e.Y8G("lightSpeedOwner",s.app)("params",s.params)("lightSpeed",s.app.lightSpeed),e.R7$(),e.Y8G("matMenuTriggerFor",m)}},dependencies:[N.e,n.m_,n.An,A.Y,S.pZ,S.r6,y.Cn,y.kk,y.fb,y.z8,y.Cp,w.E],encapsulation:2})}}return r})();var x=t(3347),K=t(9841);const z=r=>({"fab-opened":r});let V=(()=>{class r{#t;#e;constructor(i,a,s,m,F){this.snackBar=i,this.context=a,this.matDialog=s,this.viewContainerRef=m,this.changeDetectorRef=F,this.log=(0,B.Tq)({AppsListComponent:r}),this.gridOptions=this.#r(),this.features=(0,e.WQX)(T.D),this.isAddFromFolderEnabled=this.features.isEnabled[b.T.AppSyncWithSiteFiles],this.#t=(0,v.d)($.U),this.#e=(0,v.d)(j.c),this.fabOpen=(0,e.vPA)(!1),this.#s=(0,e.vPA)(0),this.apps=(0,e.EWP)(()=>(this.#s(),this.#t.getAll())),g.syG.registerModules([o.Q])}#s;ngOnInit(){this.#e.doOnDialogClosed(()=>this.#i())}openChange(i){this.fabOpen.set(i)}browseCatalog(){window.open("https://2sxc.org/apps","_blank")}createApp(){this.#e.navRelative(["create"])}createInheritedApp(){this.#e.navRelative(["create-inherited"])}addFromFolder(){this.#e.navRelative(["add-app-from-folder"])}importApp(i){this.#e.navRelative(["import"],{state:{files:i}})}#a(i){const a=prompt(`This cannot be undone. To really delete this app, type 'yes!' or type/paste the app-name here. Are you sure want to delete '${i.Name}' (${i.Id})?`);null!==a&&(a===i.Name||"yes!"===a?(this.snackBar.open("Deleting..."),this.#t.delete(i.Id).subscribe({error:()=>{this.snackBar.open("Delete failed. Please check console for more information",void 0,{duration:3e3}),this.#i()},next:()=>{this.snackBar.open("Deleted",void 0,{duration:2e3}),this.#i()}})):alert("Input did not match - will not delete"))}#n(i){confirm(`Flush the App Cache for ${i.Name} (${i.Id})?`)&&(this.snackBar.open("Flushing cache..."),this.#t.flushCache(i.Id).subscribe({error:()=>this.snackBar.open("Cache flush failed. Please check console.",void 0,{duration:3e3}),next:()=>this.snackBar.open("Cache flushed",void 0,{duration:2e3})}))}#o(i){const a=(0,U.s)(c.g.getLightSpeedEditParams(i.Id));return this.#e.urlSubRoute(`${this.context.zoneId}/${i.Id}/edit/${a}`)}openLightSpeedFeatInfo(){(0,E.j)(this.matDialog,b.T.LightSpeed,this.viewContainerRef,this.changeDetectorRef)}#r(){return{...R.C,columnDefs:[{...u.r.IdWithDefaultRenderer,cellRendererParams:u.r.idFieldParamsTooltipGetter()},{...u.r.IconShow,cellRenderer:I.N,cellRendererParams:{settings:()=>G}},{...u.r.TextWide,field:"Name",cellClass:"apps-list-primary-action highlight".split(" "),sort:"asc",cellRenderer:a=>{const s=a.data;return`\n              <a class="default-link fill-cell" href="#${this.#e.urlSubRoute(s.Id.toString())}">\n                <div class="container">\n                  ${s.Thumbnail?`<img class="image logo" src="${s.Thumbnail}?w=40&h=40&mode=crop"></img>`:'<div class="image logo"><span class="material-symbols-outlined">star</span></div>'}\n                  ${a.value}\n                </div>\n              </a>\n            `}},{...u.r.TextWide,field:"Folder"},{...u.r.Character,field:"Version",width:78},{...u.r.Number,field:"Items"},{...u.r.Boolean,field:"HasCodeWarnings",headerName:"Code",filter:k.y,cellRenderer:I.N,cellRendererParams:{settings:()=>W}},{...u.r.ActionsPinnedRight3,cellRenderer:Y,cellRendererParams:{lightSpeedLink:a=>this.#o(a),openLightspeedFeatureInfo:()=>this.openLightSpeedFeatInfo(),do:(a,s)=>{switch(a){case"deleteApp":this.#a(s);break;case"flushCache":this.#n(s)}}}}]}}#i(){this.#s.update(i=>i+1)}static{this.\u0275fac=function(a){return new(a||r)(e.rXU(x.UG),e.rXU(M.o),e.rXU(C.bZ),e.rXU(e.c1b),e.rXU(e.gRc))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-apps-list"]],decls:25,vars:9,consts:[[1,"grid-wrapper","mat-tab-grid-wrapper"],["appDragAndDrop","",1,"ag-theme-material",3,"filesDropped","rowData","gridOptions","allowedFileTypes"],["align","end"],[1,"eav-eco-fab-speed-dial",3,"openChange","ngClass"],[3,"spin"],["mat-fab",""],[1,"spin180"],[1,"eav-eco-fab-speed-dial-actions"],["mat-mini-fab","","label","Find more apps",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["mat-mini-fab","","label","Create inherited app",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["mat-mini-fab","","label","Add from folder",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["matBadgeColor","accent","matBadgeSize","small","matBadge","\u{1f48e}","matBadgePosition","below after","aria-hidden","false",3,"matBadgeHidden"],["mat-mini-fab","","label","Import app",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["mat-mini-fab","","label","Create app",1,"eav-eco-fab-speed-dial-action-button",3,"click"]],template:function(a,s){1&a&&(e.j41(0,"div",0)(1,"ag-grid-angular",1),e.bIt("filesDropped",function(F){return s.importApp(F)}),e.k0s(),e.j41(2,"mat-dialog-actions",2)(3,"eco-fab-speed-dial",3),e.bIt("openChange",function(F){return s.openChange(F)}),e.j41(4,"eco-fab-speed-dial-trigger",4)(5,"button",5)(6,"mat-icon",6),e.EFF(7),e.k0s()()(),e.j41(8,"eco-fab-speed-dial-actions",7)(9,"button",8),e.bIt("click",function(){return s.browseCatalog()}),e.j41(10,"mat-icon"),e.EFF(11,"search"),e.k0s()(),e.j41(12,"button",9),e.bIt("click",function(){return s.createInheritedApp()}),e.j41(13,"mat-icon"),e.EFF(14,"holiday_village"),e.k0s()(),e.j41(15,"button",10),e.bIt("click",function(){return s.addFromFolder()}),e.j41(16,"mat-icon",11),e.EFF(17," add "),e.k0s()(),e.j41(18,"button",12),e.bIt("click",function(){return s.importApp()}),e.j41(19,"mat-icon"),e.EFF(20,"cloud_upload"),e.k0s()(),e.j41(21,"button",13),e.bIt("click",function(){return s.createApp()}),e.j41(22,"mat-icon"),e.EFF(23,"add"),e.k0s()()()()()(),e.nrm(24,"router-outlet")),2&a&&(e.R7$(),e.Y8G("rowData",s.apps()())("gridOptions",s.gridOptions)("allowedFileTypes","zip"),e.R7$(2),e.Y8G("ngClass",e.eq3(7,z,s.fabOpen())),e.R7$(),e.Y8G("spin",!0),e.R7$(3),e.JRh(s.fabOpen()?"close":"add"),e.R7$(9),e.Y8G("matBadgeHidden",s.isAddFromFolderEnabled()))},dependencies:[O.p,K.xs,C.E7,p.TE,f.YU,p.p1,l.Hl,l.$0,l.Sr,n.m_,n.An,p.yf,A.Y,A.k,d.n3,L.S],encapsulation:2})}}return r})()},8136:(D,h,t)=>{t.d(h,{T:()=>o});const o={AppSyncWithSiteFiles:"AppSyncWithSiteFiles",WysiwygPasteFormatted:"WysiwygPasteFormatted",PasteImageFromClipboard:"PasteImageFromClipboard",EditUiShowNotes:"EditUiShowNotes",EditUiShowMetadataFor:"EditUiShowMetadataFor",NoSponsoredByToSic:"NoSponsoredByToSic",EditUiTranslateWithGoogle:"EditUiTranslateWithGoogle",LightSpeed:"LightSpeedOutputCache",ContentSecurityPolicy:"ContentSecurityPolicy",PermissionsByLanguage:"PermissionsByLanguage",ContentTypeFieldsReuseDefinitions:"ContentTypeFieldsReuseDefinitions",AppExportAssetsAdvanced:"AppExportAssetsAdvanced",PickerUiCheckbox:"PickerUiCheckbox",PickerUiRadio:"PickerUiRadio",PickerSourceCsv:"PickerSourceCsv",PickerSourceAppAssets:"PickerSourceAppAssets",PickerFormulas:"PickerFormulas",PickerUiMoreInfo:"PickerUiMoreInfo"}},3140:(D,h,t)=>{t.d(h,{J:()=>f});var o=t(7092),g=t(7580);let f=(()=>{class e{constructor(){this.subscriptions=new o.yU}ngOnDestroy(){this.subscriptions.unsubscribe()}static{this.\u0275fac=function(C){return new(C||e)}}static{this.\u0275dir=g.FsC({type:e})}}return e})()},4575:(D,h,t)=>{t.d(h,{S:()=>A});var o=t(7580),g=t(8537),f=t(3140),e=t(3347);let A=(()=>{class l extends f.J{constructor(n,d,p){super(),this.zone=d,this.snackBar=p,this.markStyle=(0,o.hFB)("outline"),this.allowedFileTypes=(0,o.hFB)(""),this.filesDropped=(0,o.CGW)(),this.dropAreaClass="eav-droparea",this.markStyleClass=(0,o.vPA)(""),this.dragClass="eav-dragover",this.timeouts=[],this.element=n.nativeElement}ngOnInit(){this.markStyleClass.set(`eav-droparea-${this.markStyle()}`),this.element.classList.add(this.dropAreaClass,this.markStyleClass()),this.zone.runOutsideAngular(()=>{this.subscriptions.add((0,g.R)(this.element,"dragover").subscribe(n=>{n.preventDefault(),n.stopPropagation(),this.clearTimeouts(),this.element.classList.add(this.dragClass)})),this.subscriptions.add((0,g.R)(this.element,"dragleave").subscribe(n=>{n.preventDefault(),n.stopPropagation(),this.timeouts.push(window.setTimeout(()=>{this.element.classList.remove(this.dragClass)},50))}))})}ngOnDestroy(){this.clearTimeouts(),this.element.classList.remove(this.dropAreaClass,this.markStyleClass(),this.dragClass),super.ngOnDestroy()}onDrop(n){n.preventDefault(),n.stopPropagation(),this.clearTimeouts(),this.element.classList.remove(this.dragClass);let p=Array.from(n.dataTransfer.files);p=this.filterTypes(p,this.allowedFileTypes()),p.length>0&&this.filesDropped.emit(p)}clearTimeouts(){for(const n of this.timeouts)clearTimeout(n);this.timeouts=[]}filterTypes(n,d){if(""===d)return n;const p=d.split(",").map(c=>c.toLocaleLowerCase()),v=n.filter(c=>{const b=c.name.lastIndexOf(".");if(b<=0)return!1;const T=c.name.substring(b+1).toLocaleLowerCase();return p.includes(T)});if(n.length!==v.length){const c=this.allowedFileTypes().replace(/\,/g,", ");this.snackBar.open(v.length?"Some files were filtered out. This drop location only accepts file types: "+c:"This drop location only accepts file types: "+c,null,{duration:5e3})}return v}static{this.\u0275fac=function(d){return new(d||l)(o.rXU(o.aKT),o.rXU(o.SKi),o.rXU(e.UG))}}static{this.\u0275dir=o.FsC({type:l,selectors:[["","appDragAndDrop",""]],hostBindings:function(d,p){1&d&&o.bIt("drop",function(c){return p.onDrop(c)})},inputs:{markStyle:[1,"markStyle"],allowedFileTypes:[1,"allowedFileTypes"]},outputs:{filesDropped:"filesDropped"},features:[o.Vt3]})}}return l})()},9914:(D,h,t)=>{t.d(h,{$:()=>f});var o=t(7580),g=t(436);let f=(()=>{class e{constructor(l){this.sanitizer=l}transform(l){return this.sanitizer.bypassSecurityTrustHtml(l)}static{this.\u0275fac=function(C){return new(C||e)(o.rXU(g.up,16))}}static{this.\u0275pipe=o.EJ8({name:"safeHtml",type:e,pure:!0})}}return e})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/19.00.00/dist/ng-edit/projects_eav-ui_src_app_apps-management_apps-list_apps-list_component_ts-projects_eav-ui_src_-5efbee.1513a69590332b47.js.map