"use strict";(self.webpackChunkng_dialogs=self.webpackChunkng_dialogs||[]).push([["projects_ng-dialogs_src_app_metadata_metadata_component_ts","projects_ng-dialogs_src_app_shared_directives_click-stop-propagation_directive_ts","projects_ng-dialogs_src_app_app-administration_services_app-dialog-config_service_ts-_ad200","projects_ng-dialogs_src_app_app-administration_services_app-dialog-config_service_ts-_ad201"],{6886:function(U,I,e){e.d(I,{K:function(){return m}});var E=e(8069),y=e(8047),r=e(635),h=e(8598),_=e(7133),l=e(8784),g=e(2425),m=function(){var d=function(){function p(v,f,s){(0,E.Z)(this,p),this.http=v,this.context=f,this.dnnContext=s}return(0,y.Z)(p,[{key:"getDialogSettings",value:function(f){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/dialog/settings"),{params:{appId:null!=f?f:this.context.appId.toString()}}).pipe((0,r.U)(function(s){return s.Context.Language.List=s.Context.Language.List.filter(function(x){return x.IsEnabled}),s}))}}]),p}();return d.\u0275fac=function(v){return new(v||d)(_.LFG(l.eN),_.LFG(h._),_.LFG(g._y))},d.\u0275prov=_.Yz7({token:d,factory:d.\u0275fac}),d}()},1025:function(U,I,e){e.d(I,{T:function(){return M}});var E=e(8069),y=e(8047),r=e(8598),h=e(7003),_=e(7133),l=e(8784),g=e(2425),M=function(){var m=function(){function d(p,v,f){(0,E.Z)(this,d),this.http=p,this.context=v,this.dnnContext=f}return(0,y.Z)(d,[{key:"getContentInfo",value:function(v){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(h.v+"Get"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),scope:v}})}},{key:"exportParts",value:function(v,f,s){var x=this.dnnContext.$2sxc.http.apiUrl(h.v+"Export")+"?appId="+this.context.appId.toString()+"&zoneId="+this.context.zoneId.toString()+"&contentTypeIdsString="+v.join(";")+"&entityIdsString="+f.join(";")+"&templateIdsString="+s.join(";");window.open(x,"_blank","")}}]),d}();return m.\u0275fac=function(p){return new(p||m)(_.LFG(l.eN),_.LFG(r._),_.LFG(g._y))},m.\u0275prov=_.Yz7({token:m,factory:m.\u0275fac}),m}()},2372:function(U,I,e){e.d(I,{v:function(){return M}});var E=e(8069),y=e(8047),r=e(8854),h=e(8598),_=e(7133),l=e(8784),g=e(2425),M=function(){var m=function(){function d(p,v,f){(0,E.Z)(this,d),this.http=p,this.context=v,this.dnnContext=f}return(0,y.Z)(d,[{key:"getAppInfo",value:function(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(r.H+"Statistics"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}},{key:"exportApp",value:function(v,f){var s=this.dnnContext.$2sxc.http.apiUrl(r.H+"Export")+"?appId="+this.context.appId+"&zoneId="+this.context.zoneId+"&includeContentGroups="+v+"&resetAppGuid="+f;window.open(s,"_blank","")}},{key:"exportForVersionControl",value:function(v,f){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(r.H+"SaveData"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),includeContentGroups:v.toString(),resetAppGuid:f.toString()}})}}]),d}();return m.\u0275fac=function(p){return new(p||m)(_.LFG(l.eN),_.LFG(h._),_.LFG(g._y))},m.\u0275prov=_.Yz7({token:m,factory:m.\u0275fac}),m}()},7003:function(U,I,e){e.d(I,{v:function(){return M},z:function(){return m}});var E=e(8069),y=e(8047),r=e(8854),h=e(8598),_=e(7133),l=e(8784),g=e(2425),M="admin/appParts/",m=function(){var d=function(){function p(v,f,s){(0,E.Z)(this,p),this.http=v,this.context=f,this.dnnContext=s}return(0,y.Z)(p,[{key:"importAppParts",value:function(f){var s=new FormData;return s.append("File",f),this.http.post(this.dnnContext.$2sxc.http.apiUrl(M+"Import"),s,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}},{key:"resetApp",value:function(){return this.http.post(this.dnnContext.$2sxc.http.apiUrl(r.H+"Reset"),{},{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}}]),p}();return d.\u0275fac=function(v){return new(v||d)(_.LFG(l.eN),_.LFG(h._),_.LFG(g._y))},d.\u0275prov=_.Yz7({token:d,factory:d.\u0275fac}),d}()},7854:function(U,I,e){e.d(I,{Kw:function(){return E.K},sF:function(){return y.s},vG:function(){return l.vG},bf:function(){return l.bf},Az:function(){return l.Az},TB:function(){return l.TB},cv:function(){return l.cv},nt:function(){return l.nt},h3:function(){return g.h}});var E=e(6886),y=e(5005),l=(e(1025),e(2372),e(7003),e(6805)),g=e(6559)},6805:function(U,I,e){e.d(I,{cv:function(){return x},Az:function(){return T},nt:function(){return D},TB:function(){return P},bf:function(){return K},vG:function(){return t}});var E=e(8069),y=e(8047),r=e(7400),h=e(9525),_=e(7368),l=e(7396),g=e(8598),M=e(7133),m=e(8784),d=e(2425),p="admin/query/",x=p+"Run",T=p+"DebugStream",D=p+"Save",P=p+"Get",K=p+"DataSources",t=function(){var F=function(){function L(Z,S,R){(0,E.Z)(this,L),this.http=Z,this.context=S,this.dnnContext=R}return(0,y.Z)(L,[{key:"getAll",value:function(S){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(_.PS),{params:{appId:this.context.appId.toString(),contentType:S}})}},{key:"importQuery",value:function(S){var R=this;return(0,r.D)((0,l.s)(S)).pipe((0,h.z)(function(A){return R.http.post(R.dnnContext.$2sxc.http.apiUrl("admin/query/import"),{AppId:R.context.appId.toString(),ContentBase64:A})}))}},{key:"clonePipeline",value:function(S){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/query/Clone"),{params:{Id:S.toString(),appId:this.context.appId.toString()}})}},{key:"delete",value:function(S){return this.http.delete(this.dnnContext.$2sxc.http.apiUrl("admin/query/Delete"),{params:{appId:this.context.appId.toString(),Id:S.toString()}})}}]),L}();return F.\u0275fac=function(Z){return new(Z||F)(M.LFG(m.eN),M.LFG(g._),M.LFG(d._y))},F.\u0275prov=M.Yz7({token:F,factory:F.\u0275fac}),F}()},6559:function(U,I,e){e.d(I,{h:function(){return f}});var E=e(8069),y=e(8047),r=e(8598),h=e(7133),_=e(8784),l=e(2425),f=function(){var s=function(){function x(T,D,P){(0,E.Z)(this,x),this.http=T,this.context=D,this.dnnContext=P}return(0,y.Z)(x,[{key:"getAll",value:function(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/view/all"),{params:{appId:this.context.appId.toString()}})}},{key:"delete",value:function(D){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/view/delete"),{params:{appId:this.context.appId.toString(),Id:D.toString()}})}},{key:"import",value:function(D){var P=new FormData;return P.append("File",D),this.http.post(this.dnnContext.$2sxc.http.apiUrl("admin/view/import"),P,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}},{key:"export",value:function(D){var P=this.dnnContext.$2sxc.http.apiUrl("admin/view/json")+"?appId="+this.context.appId+"&viewId="+D;window.open(P,"_blank","")}},{key:"getPolymorphism",value:function(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/view/polymorphism"),{params:{appId:this.context.appId.toString()}})}},{key:"getUsage",value:function(D){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/view/usage"),{params:{appId:this.context.appId.toString(),guid:D}})}}]),x}();return s.\u0275fac=function(T){return new(T||s)(h.LFG(_.eN),h.LFG(r._),h.LFG(l._y))},s.\u0275prov=h.Yz7({token:s,factory:s.\u0275fac}),s}()},803:function(U,I,e){e.d(I,{l:function(){return v}});var E=e(8069),y=e(8047),r=e(7400),h=e(9525),_=e(7368),l=e(4722),g=e(7396),M=e(8598),m=e(7133),d=e(8784),p=e(2425),v=function(){var f=function(){function s(x,T,D){(0,E.Z)(this,s),this.http=x,this.context=T,this.dnnContext=D}return(0,y.Z)(s,[{key:"getAll",value:function(T){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(_.PS),{params:{appId:this.context.appId.toString(),contentType:T}})}},{key:"getColumns",value:function(T){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(l.jt),{params:{appId:this.context.appId.toString(),staticName:T}})}},{key:"importItem",value:function(T){var D=this;return(0,r.D)((0,g.s)(T)).pipe((0,h.z)(function(P){return D.http.post(D.dnnContext.$2sxc.http.apiUrl(_.Uo+"upload"),{AppId:D.context.appId.toString(),ContentBase64:P})}))}}]),s}();return f.\u0275fac=function(x){return new(x||f)(m.LFG(d.eN),m.LFG(M._),m.LFG(p._y))},f.\u0275prov=m.Yz7({token:f,factory:f.\u0275fac}),f}()},8854:function(U,I,e){e.d(I,{H:function(){return g},a:function(){return M}});var E=e(8069),y=e(8047),r=e(8598),h=e(7133),_=e(8784),l=e(2425),g="admin/app/",M=function(){var m=function(){function d(p,v,f){(0,E.Z)(this,d),this.http=p,this.context=v,this.dnnContext=f}return(0,y.Z)(d,[{key:"importApp",value:function(v,f){var s=new FormData;return s.append("File",v),s.append("Name",f||""),this.http.post(this.dnnContext.$2sxc.http.apiUrl(g+"Import"),s,{params:{zoneId:this.context.zoneId.toString()}})}}]),d}();return m.\u0275fac=function(p){return new(p||m)(h.LFG(_.eN),h.LFG(r._),h.LFG(l._y))},m.\u0275prov=h.Yz7({token:m,factory:m.\u0275fac}),m}()},326:function(U,I,e){e.r(I),e.d(I,{MetadataComponent:function(){return Et}});var E=e(2090),y=e(8069),r=e(8047),h=e(1276),_=e(2977),l=e(6317),g=e(7714),M=e(6562),m=e(635),d=e(116),p=e(4874),v=e(679),f=e(803),s=e(8130),x=e(6307),T=e(5578),D=e(9119),P=e(1825),K=e(5137),t=e(7133),F=e(1130),L=e(785),Z=e(5590),S=function(){var a=function(){function u(){(0,y.Z)(this,u)}return(0,r.Z)(u,[{key:"agInit",value:function(n){this.params=n}},{key:"refresh",value:function(n){return!0}},{key:"deleteMetadata",value:function(){this.params.onDelete(this.params.data)}}]),u}();return a.\u0275fac=function(o){return new(o||a)},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-metadata-actions"]],decls:4,vars:0,consts:[[1,"actions-component"],["matRipple","","tippy","Delete",1,"like-button","highlight",3,"click"]],template:function(o,n){1&o&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.NdJ("click",function(){return n.deleteMetadata()}),t.TgZ(2,"mat-icon"),t._uU(3,"delete"),t.qZA(),t.qZA(),t.qZA())},directives:[F.wG,L.$,Z.Hw],styles:[""]}),a}(),R=e(6170),A=e(587),H=e(8977),V=e(7854),J=e(9670),B=e(5758),b=e(6362),N=e(4770),Y=e(7317),w=e(6623),X=e(1434),q=e(3135),tt=e(491),et=e(4683);function nt(a,u){if(1&a&&(t.TgZ(0,"mat-option",21),t._uU(1),t.qZA()),2&a){var o=u.$implicit;t.Q6J("value",o.value),t.xp6(1),t.hij(" ",o.name," ")}}function ot(a,u){if(1&a&&(t.ynx(0),t.TgZ(1,"mat-form-field",7),t.TgZ(2,"mat-label"),t._uU(3,"Scope"),t.qZA(),t.TgZ(4,"mat-select",19),t.YNc(5,nt,2,2,"mat-option",20),t.TgZ(6,"mat-option",21),t._uU(7,"Other..."),t.qZA(),t.qZA(),t.qZA(),t.TgZ(8,"app-field-hint"),t._uU(9," The scope should almost never be changed - "),t.TgZ(10,"a",22),t._uU(11,"see help"),t.qZA(),t.qZA(),t.BQk()),2&a){var o=t.oxw().ngIf,n=t.oxw();t.xp6(4),t.Q6J("placeholder",o.scopeOptions.length?"":"No items found"),t.xp6(1),t.Q6J("ngForOf",o.scopeOptions),t.xp6(1),t.Q6J("value",n.dropdownInsertValue)}}function at(a,u){if(1&a&&(t.TgZ(0,"mat-option",21),t._uU(1),t.qZA()),2&a){var o=u.$implicit;t.Q6J("value",o.StaticName),t.xp6(1),t.hij(" ",o.Label," ")}}function it(a,u){if(1&a&&(t.TgZ(0,"mat-select",23),t.YNc(1,at,2,2,"mat-option",20),t.qZA()),2&a){var o=t.oxw().ngIf;t.Q6J("placeholder",o.contentTypes.length?"":"No items found"),t.xp6(1),t.Q6J("ngForOf",o.contentTypes)}}function rt(a,u){1&a&&t._UZ(0,"input",24)}function st(a,u){1&a&&(t.TgZ(0,"app-field-hint",25),t._uU(1," This field is required "),t.qZA()),2&a&&t.Q6J("isError",!0)}var z=function(u){return{active:u}};function ct(a,u){if(1&a){var o=t.EpF();t.ynx(0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t._uU(3,"Create Metadata"),t.qZA(),t.qZA(),t.TgZ(4,"p",3),t._uU(5," This is a special operation to add an item which is metadata for another item, see "),t.TgZ(6,"a",4),t._uU(7,"docs"),t.qZA(),t._uU(8,". "),t.qZA(),t.TgZ(9,"form",5),t.TgZ(10,"div",6),t.YNc(11,ot,12,3,"ng-container",0),t.TgZ(12,"mat-form-field",7),t.TgZ(13,"mat-label"),t._uU(14,"Content Type"),t.qZA(),t.YNc(15,it,2,2,"mat-select",8),t.YNc(16,rt,1,0,"input",9),t.TgZ(17,"div",10),t.TgZ(18,"button",11),t.NdJ("click",function(){return t.CHM(o),t.oxw().toggleGuidedContentType(!0)}),t.TgZ(19,"mat-icon"),t._uU(20,"search"),t.qZA(),t.qZA(),t.TgZ(21,"button",12),t.NdJ("click",function(){return t.CHM(o),t.oxw().toggleGuidedContentType(!1)}),t.TgZ(22,"mat-icon"),t._uU(23,"text_fields"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(24,st,2,1,"app-field-hint",13),t.qZA(),t.TgZ(25,"div",14),t.TgZ(26,"mat-slide-toggle",15),t.NdJ("change",function(c){return t.CHM(o),t.oxw().toggleAdvancedMode(c)}),t._uU(27),t.qZA(),t._UZ(28,"div",16),t.TgZ(29,"button",17),t.NdJ("click",function(){return t.CHM(o),t.oxw().closeDialog()}),t._uU(30,"Cancel"),t.qZA(),t.TgZ(31,"button",18),t.NdJ("click",function(){return t.CHM(o),t.oxw().confirm()}),t._uU(32," Confirm "),t.qZA(),t.qZA(),t.qZA(),t.BQk()}if(2&a){var n=t.oxw();t.xp6(9),t.Q6J("formGroup",n.form),t.xp6(2),t.Q6J("ngIf",n.advancedMode&&n.guidedContentType),t.xp6(4),t.Q6J("ngIf",n.guidedContentType),t.xp6(1),t.Q6J("ngIf",!n.guidedContentType),t.xp6(2),t.Q6J("ngClass",t.VKq(10,z,n.guidedContentType)),t.xp6(3),t.Q6J("ngClass",t.VKq(12,z,!n.guidedContentType)),t.xp6(3),t.Q6J("ngIf",n.form.controls.contentType.touched&&(null==n.form.controls.contentType.errors?null:n.form.controls.contentType.errors.required)),t.xp6(2),t.Q6J("checked",n.advancedMode),t.xp6(1),t.hij(" ",n.advancedMode?"Advanced":"Simple"," "),t.xp6(4),t.Q6J("disabled",!n.form.valid)}}var _t=function(){var a=function(){function u(o,n){(0,y.Z)(this,u),this.dialogRef=o,this.contentTypesService=n,this.hostClass="dialog-component",this.dropdownInsertValue=J.G,this.guidedContentType=!0,this.advancedMode=!1}return(0,r.Z)(u,[{key:"ngOnInit",value:function(){this.contentTypes$=new l.X([]),this.scopeOptions$=new l.X([]),this.buildForm(),this.fetchScopes(),this.templateVars$=(0,M.a)([this.contentTypes$,this.scopeOptions$]).pipe((0,m.U)(function(n){var i=(0,E.Z)(n,2);return{contentTypes:i[0],scopeOptions:i[1]}}))}},{key:"ngOnDestroy",value:function(){this.contentTypes$.complete(),this.scopeOptions$.complete()}},{key:"closeDialog",value:function(n){this.dialogRef.close(n)}},{key:"toggleGuidedContentType",value:function(n){this.guidedContentType=n}},{key:"toggleAdvancedMode",value:function(n){this.advancedMode=n.checked}},{key:"confirm",value:function(){var n=this.form.getRawValue();this.closeDialog(n.contentType)}},{key:"buildForm",value:function(){var n=this;this.form=new A.cw({}),this.form.addControl("contentType",new A.NI(null,[A.kI.required])),this.form.addControl("scope",new A.NI(P.Z.scopes.default.value)),this.form.controls.scope.valueChanges.pipe((0,p.O)(this.form.controls.scope.value),(0,H.x)()).subscribe(function(i){null!=n.form.controls.contentType.value&&n.form.controls.contentType.patchValue(null),i===J.G?(i=prompt("This is an advanced feature to show content-types of another scope. Don't use this if you don't know what you're doing, as content-types of other scopes are usually hidden for a good reason.")||P.Z.scopes.default.value,n.scopeOptions$.value.some(function(C){return C.value===i})||n.scopeOptions$.next([{name:i,value:i}].concat((0,R.Z)(n.scopeOptions$.value))),n.form.controls.scope.patchValue(i)):n.fetchContentTypes(i)})}},{key:"fetchContentTypes",value:function(n){var i=this;this.contentTypesService.retrieveContentTypes(n).subscribe(function(c){i.contentTypes$.next(c)})}},{key:"fetchScopes",value:function(){var n=this;this.contentTypesService.getScopes().subscribe(function(i){n.scopeOptions$.next(i)})}}]),u}();return a.\u0275fac=function(o){return new(o||a)(t.Y36(B.so),t.Y36(V.sF))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-metadata-save-dialog"]],hostVars:1,hostBindings:function(o,n){2&o&&t.Ikx("className",n.hostClass)},decls:2,vars:3,consts:[[4,"ngIf"],["mat-dialog-title",""],[1,"dialog-title-box"],[1,"dialog-description"],["href","http://r.2sxc.org/metadata","target","_blank"],[1,"dialog-form",3,"formGroup"],[1,"dialog-form-content","fancy-scrollbar-light"],["appearance","standard","color","accent"],["formControlName","contentType","required","",3,"placeholder",4,"ngIf"],["matInput","","type","text","formControlName","contentType","required","",4,"ngIf"],["matSuffix","",1,"selection-suffix"],["mat-icon-button","","type","button","tippy","Pick existing value",3,"ngClass","click"],["mat-icon-button","","type","button","tippy","Manual entry",3,"ngClass","click"],[3,"isError",4,"ngIf"],[1,"dialog-form-actions"],["color","accent",3,"checked","change"],[1,"spacer"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],["formControlName","scope",3,"placeholder"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["href","https://2sxc.org/help?tag=scope","target","_blank","appClickStopPropagation",""],["formControlName","contentType","required","",3,"placeholder"],["matInput","","type","text","formControlName","contentType","required",""],[3,"isError"]],template:function(o,n){1&o&&(t.YNc(0,ct,33,14,"ng-container",0),t.ALo(1,"async")),2&o&&t.Q6J("ngIf",t.lcZ(1,1,n.templateVars$))},directives:[b.O5,B.uh,A._Y,A.JL,A.sg,N.KE,N.hX,N.R9,Y.lW,L.$,b.mk,Z.Hw,w.Rr,X.gD,A.JJ,A.u,b.sg,F.ey,q.Y,tt.E,A.Q7,et.Nt,A.Fj],pipes:[b.Ov],styles:[".dialog-form-content[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]:not(:first-of-type){margin-top:8px}"]}),a}(),lt=e(2528),pt=e(1350),k=e(5718);function ut(a,u){1&a&&(t.ynx(0),t._uU(1,"This item is not metadata for anything else."),t.BQk())}function dt(a,u){if(1&a&&(t.ynx(0),t._UZ(1,"br"),t._uU(2),t.BQk()),2&a){var o=t.oxw(2).ngIf;t.xp6(2),t.hij("Number: ",o.itemFor.Number,"")}}function mt(a,u){if(1&a&&(t.ynx(0),t._UZ(1,"br"),t._uU(2),t.BQk()),2&a){var o=t.oxw(2).ngIf;t.xp6(2),t.hij("Guid: ",o.itemFor.Guid,"")}}function ft(a,u){if(1&a&&(t.ynx(0),t._UZ(1,"br"),t._uU(2),t.BQk()),2&a){var o=t.oxw(2).ngIf;t.xp6(2),t.hij("String: ",o.itemFor.String,"")}}function ht(a,u){if(1&a&&(t.ynx(0),t._UZ(1,"br"),t._uU(2),t.BQk()),2&a){var o=t.oxw(2).ngIf;t.xp6(2),t.hij("Title: ",o.itemFor.String,"")}}function gt(a,u){if(1&a&&(t.ynx(0),t._uU(1," This item is metadata for: "),t._UZ(2,"br"),t._uU(3),t._UZ(4,"br"),t._uU(5),t.YNc(6,dt,3,1,"ng-container",0),t.YNc(7,mt,3,1,"ng-container",0),t.YNc(8,ft,3,1,"ng-container",0),t.YNc(9,ht,3,1,"ng-container",0),t.BQk()),2&a){var o=t.oxw().ngIf;t.xp6(3),t.hij("Target: ",o.itemFor.Target," "),t.xp6(2),t.hij("TargetType: ",o.itemFor.TargetType," "),t.xp6(1),t.Q6J("ngIf",o.itemFor.Number),t.xp6(1),t.Q6J("ngIf",o.itemFor.Guid),t.xp6(1),t.Q6J("ngIf",o.itemFor.String),t.xp6(1),t.Q6J("ngIf",o.itemFor.Title)}}function vt(a,u){if(1&a){var o=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){return t.CHM(o),t.oxw(2).createMetadata()}),t.TgZ(1,"mat-icon"),t._uU(2,"add"),t.qZA(),t.qZA()}}function Ct(a,u){if(1&a){var o=t.EpF();t.TgZ(0,"button",18),t.NdJ("click",function(){var C=t.CHM(o).$implicit;return t.oxw(3).createMetadata(C)}),t.TgZ(1,"mat-icon"),t._uU(2),t.qZA(),t.qZA()}if(2&a){var n=u.$implicit;t.uIk("label",n.Title),t.xp6(2),t.Oqu(n.Icon||"add")}}var xt=function(u){return{"fab-opened":u}};function Tt(a,u){if(1&a){var o=t.EpF();t.TgZ(0,"eco-fab-speed-dial",12),t.NdJ("openChange",function(c){return t.CHM(o),t.oxw(2).openChange(c)}),t.TgZ(1,"eco-fab-speed-dial-trigger",13),t.TgZ(2,"button",14),t.TgZ(3,"mat-icon",15),t._uU(4),t.qZA(),t.qZA(),t.qZA(),t.TgZ(5,"eco-fab-speed-dial-actions"),t.TgZ(6,"button",16),t.NdJ("click",function(){return t.CHM(o),t.oxw(2).createMetadata()}),t.TgZ(7,"mat-icon"),t._uU(8,"search"),t.qZA(),t.qZA(),t.YNc(9,Ct,3,2,"button",17),t.qZA(),t.qZA()}if(2&a){var n=t.oxw().ngIf;t.Q6J("ngClass",t.VKq(4,xt,n.fabOpen)),t.xp6(1),t.Q6J("spin",!0),t.xp6(3),t.Oqu(n.fabOpen?"close":"add"),t.xp6(5),t.Q6J("ngForOf",n.recommendations)}}function Mt(a,u){if(1&a){var o=t.EpF();t.ynx(0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"div",3),t.TgZ(4,"div"),t._uU(5),t.qZA(),t.TgZ(6,"button",4),t.NdJ("click",function(){return t.CHM(o),t.oxw().closeDialog()}),t.TgZ(7,"mat-icon"),t._uU(8,"close"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(9,"p",5),t.YNc(10,ut,2,0,"ng-container",0),t.YNc(11,gt,10,6,"ng-container",0),t.qZA(),t._UZ(12,"router-outlet"),t.TgZ(13,"div",6),t._UZ(14,"ag-grid-angular",7),t._UZ(15,"div",8),t.YNc(16,vt,3,0,"button",9),t.YNc(17,Tt,10,6,"eco-fab-speed-dial",10),t.qZA(),t.qZA(),t.BQk()}if(2&a){var n=u.ngIf,i=t.oxw();t.xp6(5),t.Oqu(i.title||"Metadata"),t.xp6(5),t.Q6J("ngIf",!n.itemFor),t.xp6(1),t.Q6J("ngIf",n.itemFor),t.xp6(3),t.Q6J("rowData",n.metadata)("modules",i.modules)("gridOptions",i.gridOptions),t.xp6(2),t.Q6J("ngIf",0===n.recommendations.length),t.xp6(1),t.Q6J("ngIf",n.recommendations.length>0)}}var Et=function(){var a=function(){function u(o,n,i,c,C,O,j,$,yt,It){var G;(0,y.Z)(this,u),this.dialogRef=o,this.router=n,this.route=i,this.metadataService=c,this.snackBar=C,this.entitiesService=O,this.contentItemsService=j,this.dialog=$,this.viewContainerRef=yt,this.changeDetectorRef=It,this.modules=h.F$,this.gridOptions=Object.assign(Object.assign({},D.f),{frameworkComponents:{idFieldComponent:T.m,metadataActionsComponent:S},columnDefs:[{headerName:"ID",field:"Id",width:70,headerClass:"dense",cellClass:"id-action no-padding no-outline",cellRenderer:"idFieldComponent",sortable:!0,filter:"agNumberColumnFilter",cellRendererParams:{tooltipGetter:function(W){return"ID: ".concat(W.Id,"\nGUID: ").concat(W.Guid)}}},{headerName:"Title",field:"Title",flex:2,minWidth:250,cellClass:"primary-action highlight",sortable:!0,sort:"asc",filter:"agTextColumnFilter",onCellClicked:this.editMetadata.bind(this)},{headerName:"Content Type",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:function(W){var Q=W.data;return"".concat(Q._Type.Name).concat(Q._Type.Description?" (".concat(Q._Type.Description,")"):"")}},{width:42,cellClass:"secondary-action no-padding",cellRenderer:"metadataActionsComponent",pinned:"right",cellRendererParams:{onDelete:this.deleteMetadata.bind(this)}}]}),this.metadata$=new l.X([]),this.recommendations$=new l.X([]),this.itemFor$=new l.X(void 0),this.fabOpen$=new l.X(!1),this.subscription=new g.w0,this.targetType=parseInt(this.route.snapshot.paramMap.get("targetType"),10),this.keyType=this.route.snapshot.paramMap.get("keyType"),this.key=this.route.snapshot.paramMap.get("key"),this.title=decodeURIComponent(null!==(G=this.route.snapshot.paramMap.get("title"))&&void 0!==G?G:""),this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName")}return(0,r.Z)(u,[{key:"ngOnInit",value:function(){this.fetchFor(),this.fetchMetadata(),this.refreshOnChildClosed(),this.templateVars$=(0,M.a)([this.metadata$,this.recommendations$,this.itemFor$,this.fabOpen$]).pipe((0,m.U)(function(n){var i=(0,E.Z)(n,4);return{metadata:i[0],recommendations:i[1],itemFor:i[2],fabOpen:i[3]}}))}},{key:"ngOnDestroy",value:function(){this.metadata$.complete(),this.recommendations$.complete(),this.itemFor$.complete(),this.fabOpen$.complete(),this.subscription.unsubscribe()}},{key:"closeDialog",value:function(){this.dialogRef.close()}},{key:"openChange",value:function(n){this.fabOpen$.next(n)}},{key:"createMetadata",value:function(n){var i=this;n?n.CreateEmpty?(this.snackBar.open("Creating ".concat(n.Name,"...")),this.entitiesService.create(n.Id,{For:this.calculateItemFor()}).subscribe({error:function(){i.snackBar.open("Creating ".concat(n.Name," failed. Please check console for more info"),void 0,{duration:3e3}),i.fetchMetadata()},next:function(){i.snackBar.open("Created ".concat(n.Name),void 0,{duration:3e3}),i.fetchMetadata()}})):this.createMetadataForm(n.Id):this.dialog.open(_t,{autoFocus:!1,viewContainerRef:this.viewContainerRef,width:"650px"}).afterClosed().subscribe(function(C){null!=C&&i.createMetadataForm(C)})}},{key:"createMetadataForm",value:function(n){var i={items:[{ContentTypeName:n,For:this.calculateItemFor()}]},c=(0,K.f)(i);this.router.navigate(["edit/".concat(c)],{relativeTo:this.route}),this.changeDetectorRef.markForCheck()}},{key:"calculateItemFor",value:function(){var i,c,n=this;return Object.assign(Object.assign(Object.assign({Target:null!==(c=null===(i=Object.values(P.Z.metadata).find(function(O){return O.targetType===n.targetType}))||void 0===i?void 0:i.target)&&void 0!==c?c:this.targetType.toString(),TargetType:this.targetType},this.keyType===P.Z.keyTypes.guid&&{Guid:this.key}),this.keyType===P.Z.keyTypes.number&&{Number:parseInt(this.key,10)}),this.keyType===P.Z.keyTypes.string&&{String:this.key})}},{key:"fetchFor",value:function(){var n=this;!this.contentTypeStaticName||this.contentItemsService.getAll(this.contentTypeStaticName).subscribe(function(i){var c=i.find(function(C){return C.Guid===n.key});(null==c?void 0:c.For)&&n.itemFor$.next(c.For)})}},{key:"fetchMetadata",value:function(){var n=this;this.metadataService.getMetadata(this.targetType,this.keyType,this.key).subscribe(function(i){n.metadata$.next(i.Items);var c=i.Recommendations.filter(function(C){return 1===C.Count&&!i.Items.some(function(O){return O._Type.Id===C.Id})});n.recommendations$.next(c)})}},{key:"editMetadata",value:function(n){var C=(0,K.f)({items:[{EntityId:n.data.Id}]});this.router.navigate(["edit/".concat(C)],{relativeTo:this.route})}},{key:"deleteMetadata",value:function(n){var c,i=this,C=(null===(c=this.recommendations$.value.find(function(O){return O.Id===n._Type.Id}))||void 0===c?void 0:c.DeleteWarning)||"";C=C?"".concat(C,"\n\nAre you sure you want to delete '").concat(n.Title,"' (").concat(n.Id,")?"):"Delete '".concat(n.Title,"' (").concat(n.Id,")?"),confirm(C)&&(this.snackBar.open("Deleting..."),this.entitiesService.delete(n._Type.Id,n.Id,!1).subscribe({next:function(){i.snackBar.open("Deleted",null,{duration:2e3}),i.fetchMetadata()},error:function(){i.snackBar.open("Delete failed. Please check console for more information",null,{duration:3e3})}}))}},{key:"refreshOnChildClosed",value:function(){var n=this;this.subscription.add(this.router.events.pipe((0,d.h)(function(i){return i instanceof _.m2}),(0,p.O)(!!this.route.snapshot.firstChild),(0,m.U)(function(){return!!n.route.snapshot.firstChild}),(0,v.G)(),(0,d.h)(function(i){var c=(0,E.Z)(i,2);return c[0]&&!c[1]})).subscribe(function(){n.fetchMetadata()}))}}]),u}();return a.\u0275fac=function(o){return new(o||a)(t.Y36(B.so),t.Y36(_.F0),t.Y36(_.gz),t.Y36(x.Do),t.Y36(lt.ux),t.Y36(s.g),t.Y36(f.l),t.Y36(B.uw),t.Y36(t.s_b),t.Y36(t.sBO))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-metadata"]],decls:2,vars:3,consts:[[4,"ngIf"],[1,"nav-component-wrapper"],["mat-dialog-title",""],[1,"dialog-title-box"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"dialog-description"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","modules","gridOptions"],[1,"grid-more-actions-box"],["mat-fab","","mat-elevation-z24","","class","grid-fab","tippy","Create a new metadata for this item",3,"click",4,"ngIf"],["class","grid-fab",3,"ngClass","openChange",4,"ngIf"],["mat-fab","","mat-elevation-z24","","tippy","Create a new metadata for this item",1,"grid-fab",3,"click"],[1,"grid-fab",3,"ngClass","openChange"],[3,"spin"],["mat-fab",""],[1,"spin180"],["mat-mini-fab","","label","Other Content Type",3,"click"],["mat-mini-fab","",3,"click",4,"ngFor","ngForOf"],["mat-mini-fab","",3,"click"]],template:function(o,n){1&o&&(t.YNc(0,Mt,18,8,"ng-container",0),t.ALo(1,"async")),2&o&&t.Q6J("ngIf",t.lcZ(1,1,n.templateVars$))},directives:[b.O5,B.uh,Y.lW,L.$,Z.Hw,_.lC,pt.N8,k.W7,b.mk,k.YI,k.Lp,b.sg],pipes:[b.Ov],styles:[""]}),a}()},3135:function(U,I,e){e.d(I,{Y:function(){return f}});var E=e(8069),y=e(8047),r=e(7133),h=e(6362),_=e(4770);function l(s,x){1&s&&r.GkF(0)}function g(s,x){if(1&s&&(r.TgZ(0,"mat-hint"),r.YNc(1,l,1,0,"ng-container",3),r.qZA()),2&s){r.oxw();var T=r.MAs(4);r.xp6(1),r.Q6J("ngTemplateOutlet",T)}}function M(s,x){1&s&&r.GkF(0)}function m(s,x){if(1&s&&(r.TgZ(0,"mat-error"),r.YNc(1,M,1,0,"ng-container",3),r.qZA()),2&s){r.oxw();var T=r.MAs(4);r.xp6(1),r.Q6J("ngTemplateOutlet",T)}}function d(s,x){1&s&&r.Hsn(0)}var p=function(x){return{"hint-box__short":x}},v=["*"],f=function(){var s=function(){function x(){(0,E.Z)(this,x),this.isError=!1,this.isShort=!0}return(0,y.Z)(x,[{key:"toggleIsShort",value:function(){this.isShort=!this.isShort}}]),x}();return s.\u0275fac=function(T){return new(T||s)},s.\u0275cmp=r.Xpm({type:s,selectors:[["app-field-hint"]],inputs:{isError:"isError"},ngContentSelectors:v,decls:5,vars:6,consts:[[1,"hint-box",3,"ngClass","ngSwitch","click"],[4,"ngSwitchCase"],["content",""],[4,"ngTemplateOutlet"]],template:function(T,D){1&T&&(r.F$t(),r.TgZ(0,"div",0),r.NdJ("click",function(){return D.toggleIsShort()}),r.YNc(1,g,2,1,"mat-hint",1),r.YNc(2,m,2,1,"mat-error",1),r.qZA(),r.YNc(3,d,1,0,"ng-template",null,2,r.W1O)),2&T&&(r.Q6J("ngClass",r.VKq(4,p,D.isShort))("ngSwitch",D.isError),r.xp6(1),r.Q6J("ngSwitchCase",!1),r.xp6(1),r.Q6J("ngSwitchCase",!0))},directives:[h.mk,h.RF,h.n9,_.bx,h.tP,_.TO],styles:[".hint-box[_ngcontent-%COMP%]{margin-top:4px}.hint-box[_ngcontent-%COMP%]   .mat-hint[_ngcontent-%COMP%], .hint-box[_ngcontent-%COMP%]   .mat-error[_ngcontent-%COMP%]{font-size:12px;display:block}.hint-box__short[_ngcontent-%COMP%]   .mat-hint[_ngcontent-%COMP%], .hint-box__short[_ngcontent-%COMP%]   .mat-error[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]}),s}()},491:function(U,I,e){e.d(I,{E:function(){return h}});var E=e(8069),y=e(8047),r=e(7133),h=function(){var _=function(){function l(){(0,E.Z)(this,l)}return(0,y.Z)(l,[{key:"onClick",value:function(M){M.stopPropagation()}}]),l}();return _.\u0275fac=function(g){return new(g||_)},_.\u0275dir=r.lG2({type:_,selectors:[["","appClickStopPropagation",""]],hostBindings:function(g,M){1&g&&r.NdJ("click",function(d){return M.onClick(d)})}}),_}()},7396:function(U,I,e){function E(r){return new Promise(function(h,_){var l=new FileReader;l.readAsDataURL(r),l.onload=function(){h(l.result.split(",")[1])},l.onerror=function(g){_(g)}})}function y(r){return new Promise(function(h,_){var l=new FileReader;l.readAsText(r),l.onload=function(){h(l.result)},l.onerror=function(g){_(g)}})}e.d(I,{s:function(){return E},B:function(){return y}})}}]);
//# sourceMappingURL=https://sources.2sxc.org/13.02.00/ng-edit/projects_ng-dialogs_src_app_metadata_metadata_component_ts.512880697cf04400.js.map