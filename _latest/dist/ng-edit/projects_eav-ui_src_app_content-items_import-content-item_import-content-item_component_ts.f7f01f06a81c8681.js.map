{"version":3,"file":"projects_eav-ui_src_app_content-items_import-content-item_import-content-item_component_ts.f7f01f06a81c8681.js","mappings":"8RAYO,IAAMA,EAA0B,MAAjC,MAAOA,EAMXC,YAAqCC,GAJrCC,KAAAC,WAAaC,KAAYC,YAEjBH,KAAAI,uBAAsBC,KAAUC,KAGtCP,EAAWQ,QAAU,qBACrBR,EAAWS,cAAgB,2DAC3BT,EAAWU,mBAAqB,OAChCV,EAAWW,UAAaC,GAAUX,KAAKI,oBAAoBQ,WAAWD,EAAM,GAC9E,iDAXWd,GAA0BgB,MAMjBC,MAAe,oCANxBjB,EAA0BkB,UAAA,8BAAAC,YAAA,EAAAC,SAAA,CAAAJ,OAAAK,MAAA,EAAAC,KAAA,EAAAC,OAAA,mBAAAC,SAAA,SAAAC,EAAAC,GAAA,EAAAD,GCZvCT,MAAA,mCAAwBA,MAAA,aAAAU,EAAAtB,2BDUZuB,MAAyBC,cAAA,YAExB5B,CAA0B,uHEDhC,IAAMS,EAAoB,MAA3B,MAAOA,UAA4BoB,IAEvCC,OAAOC,GACL,OAAO5B,KAAK6B,cAA6BC,KAAkB,CACzDC,OAAQ,CAAEC,MAAOhC,KAAKgC,MAAOC,YAAaL,IAE9C,CAEAM,UAAUN,EAA+BO,GACvC,OAAOnC,KAAKoC,UAAyBN,KAAkB,CACrDC,OAAQ,CAAEC,MAAOhC,KAAKgC,MAAOC,YAAaL,IACzCO,EACL,CAEAE,WAAWT,GACT,OAAO5B,KAAK6B,cAAuBS,IAAiB,CAClDP,OAAQ,CAAEC,MAAOhC,KAAKgC,MAAOO,WAAYX,IAE7C,CAEAhB,WAAW4B,GACT,SAAOC,QAAKC,KAASF,IAAOG,QAC1BC,KAAUC,GACD7C,KAAK8C,KAAKC,KAAc/C,KAAKgD,OAAOC,KAAmB,UAAW,CACvEC,MAAOlD,KAAKgC,MACZmB,cAAeN,MAElB,EACDO,KAAIC,KAEAC,QAASD,EACTE,SAAU,MAKlB,yEApCWjD,KAAmBkD,GAAnBlD,EAAmB,0CAAnBA,EAAmBmD,QAAnBnD,EAAmBoD,WAAA,SAAnBpD,CAAoB","names":["ImportContentItemComponent","constructor","dialogData","this","uploadType","UploadTypes","ContentItem","contentItemsService","transient","ContentItemsService","title","description","allowedFileTypes","upload$","files","importItem","i0","MAT_DIALOG_DATA","selectors","standalone","features","decls","vars","consts","template","rf","ctx","FileUploadDialogComponent","encapsulation","HttpServiceBase","getAll","contentTypeStaticName","getHttpApiUrl","webApiEntityList","params","appId","contentType","getAllSig","initial","getSignal","getColumns","webApiFieldsAll","staticName","file","from","toBase64","pipe","switchMap","fileBase64","http","post","apiUrl","webApiEntityRoot","AppId","ContentBase64","map","success","Success","Messages","__ngFactoryType__","factory","Éµfac"],"ignoreList":[],"sourceRoot":"webpack:///","sources":["./projects/eav-ui/src/app/content-items/import-content-item/import-content-item.component.ts","./projects/eav-ui/src/app/content-items/import-content-item/import-content-item.component.html","./projects/eav-ui/src/app/content-items/services/content-items.service.ts"],"sourcesContent":["import { Component, Inject } from '@angular/core';\r\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\r\nimport { transient } from '../../../../../core';\r\nimport { FileUploadDialogComponent, FileUploadDialogData, UploadTypes } from '../../shared/components/file-upload-dialog';\r\nimport { ContentItemsService } from '../services/content-items.service';\r\n\r\n@Component({\r\n  selector: 'app-import-content-item',\r\n  templateUrl: './import-content-item.component.html',\r\n  standalone: true,\r\n  imports: [FileUploadDialogComponent,],\r\n})\r\nexport class ImportContentItemComponent {\r\n\r\n  uploadType = UploadTypes.ContentItem;\r\n\r\n  private contentItemsService = transient(ContentItemsService);\r\n\r\n  constructor(@Inject(MAT_DIALOG_DATA) dialogData: FileUploadDialogData) {\r\n    dialogData.title ??= `Import Single Item`;\r\n    dialogData.description ??= `Select an item file (json) from your computer to import.`;\r\n    dialogData.allowedFileTypes ??= 'json';\r\n    dialogData.upload$ ??= (files) => this.contentItemsService.importItem(files[0]);\r\n  }\r\n\r\n}\r\n","<app-file-upload-dialog [uploadType]=\"uploadType\"></app-file-upload-dialog>\r\n","import { Injectable, Signal } from '@angular/core';\r\nimport { from, map, switchMap } from 'rxjs';\r\nimport { FileUploadResult } from '../../shared/components/file-upload-dialog';\r\nimport { webApiFieldsAll } from '../../shared/fields/content-types-fields.service';\r\nimport { Field } from '../../shared/fields/field.model';\r\nimport { toBase64 } from '../../shared/helpers/file-to-base64.helper';\r\nimport { webApiEntityList, webApiEntityRoot } from '../../shared/services/entity.service';\r\nimport { HttpServiceBase } from '../../shared/services/http-service-base';\r\nimport { ContentItem } from '../models/content-item.model';\r\n\r\n@Injectable()\r\nexport class ContentItemsService extends HttpServiceBase {\r\n\r\n  getAll(contentTypeStaticName: string) {\r\n    return this.getHttpApiUrl<ContentItem[]>(webApiEntityList, {\r\n      params: { appId: this.appId, contentType: contentTypeStaticName }\r\n    });\r\n  }\r\n\r\n  getAllSig(contentTypeStaticName: string, initial: undefined): Signal<ContentItem[]> {\r\n    return this.getSignal<ContentItem[]>(webApiEntityList, {\r\n      params: { appId: this.appId, contentType: contentTypeStaticName }\r\n    }, initial);\r\n  }\r\n\r\n  getColumns(contentTypeStaticName: string) {\r\n    return this.getHttpApiUrl<Field[]>(webApiFieldsAll, {\r\n      params: { appId: this.appId, staticName: contentTypeStaticName }\r\n    });\r\n  }\r\n\r\n  importItem(file: File) {\r\n    return from(toBase64(file)).pipe(\r\n      switchMap(fileBase64 => {\r\n        return this.http.post<boolean>(this.apiUrl(webApiEntityRoot + 'upload'), {\r\n          AppId: this.appId,\r\n          ContentBase64: fileBase64,\r\n        });\r\n      }),\r\n      map(success => {\r\n        const result: FileUploadResult = {\r\n          Success: success,\r\n          Messages: [],\r\n        };\r\n        return result;\r\n      }),\r\n    );\r\n  }\r\n}\r\n"],"x_google_ignoreList":[]}