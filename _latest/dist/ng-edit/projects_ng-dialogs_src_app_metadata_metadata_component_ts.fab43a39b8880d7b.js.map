{"version":3,"mappings":"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","names":["AppDialogConfigService","constructor","http","context","dnnContext","globalConfigService","this","getDialogSettings","appId","get","$2sxc","apiUrl","webApiDialogRoot","params","toString","pipe","map","dialogSettings","Context","Language","List","filter","language","IsEnabled","tap","allowDebug","Enable","DebugMode","i0","factory","ExportAppPartsService","getContentInfo","scope","webApiAppPartsRoot","appid","zoneId","exportParts","contentTypeIds","entityIds","templateIds","url","join","window","open","ExportAppService","getAppInfo","webApiAppRoot","exportApp","includeContentGroups","resetAppGuid","exportForVersionControl","ImportAppPartsService","importAppParts","file","formData","FormData","append","post","resetApp","webApiQueryRoot","webApiQueryRun","webApiQueryDebugStream","webApiQuerySave","webApiQueryGet","webApiQueryDataSources","PipelinesService","getAll","contentType","webApiEntityList","importQuery","from","toBase64","mergeMap","fileBase64","AppId","ContentBase64","clonePipeline","id","Id","delete","ViewsService","webApiViewRoot","import","export","getPolymorphism","getUsage","guid","ContentItemsService","contentTypeStaticName","getColumns","webApiFieldsAll","staticName","importItem","webApiEntityRoot","ImportAppService","importApp","changedName","MetadataActionsComponent","agInit","refresh","deleteMetadata","onDelete","data","selectors","ctx","MetadataContentTypeComponent","value","metadata","ConfirmDeleteDialogComponent","dialogData","dialogRef","closeDialog","confirm","close","MAT_DIALOG_DATA","ctx_r12","ctx_r14","ctx_r15","ctx_r16","ctx_r17","MetadataSaveDialogComponent","contentTypesService","dropdownInsertValue","ngOnInit","contentTypes$","BehaviorSubject","scopeOptions$","buildForm","fetchScopes","templateVars$","combineLatest","contentTypes","scopeOptions","ngOnDestroy","complete","toggleGuidedContentType","guidedContentType","toggleAdvancedMode","event","advancedMode","checked","formValues","form","getRawValue","FormGroup","addControl","FormControl","Validators","eavConstants","controls","valueChanges","startWith","distinctUntilChanged","subscribe","newScope","patchValue","prompt","some","option","next","name","fetchContentTypes","retrieveContentTypes","getScopes","scopes","ctx_r19","oxw","ctx_r21","ctx_r23","ctx_r25","MetadataComponent","router","route","metadataService","snackBar","entitiesService","contentItemsService","dialog","viewContainerRef","changeDetectorRef","AllCommunityModules","Object","defaultGridOptions","columnDefs","headerName","field","width","headerClass","cellClass","split","cellRenderer","IdFieldComponent","sortable","valueGetter","cellRendererParams","tooltipGetter","Guid","flex","minWidth","Title","sort","onCellClicked","editMetadata","_Type","Name","pinned","undefined","Subscription","parseInt","snapshot","paramMap","decodeURIComponent","K","_a","fetchFor","fetchMetadata","refreshOnChildClosed","filteredRecommendations$","metadata$","recommendations$","metadataItems","recommendations","r","Count","i","itemFor$","fabOpen$","itemFor","fabOpen","subscription","unsubscribe","openChange","createMetadata","recommendation","CreateEmpty","create","For","calculateItemFor","error","duration","createMetadataForm","autoFocus","afterClosed","items","ContentTypeName","formUrl","convertFormToUrl","navigate","relativeTo","markForCheck","Target","a","e","values","find","m","targetType","target","_b","TargetType","keyType","key","Number","String","item","getMetadata","Items","Recommendations","EntityId","confirmed","entityId","entityTitle","message","u","DeleteWarning","isConfirmed","add","events","NavigationEnd","firstChild","pairwise","hadChild","hasChild","FieldHintComponent","toggleIsShort","isShort","ClickStopPropagationDirective","onClick","stopPropagation","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","onerror","readAsText","SafeHtmlPipe","sanitizer","transform","html","bypassSecurityTrustHtml","pure"],"sources":["./projects/ng-dialogs/src/app/app-administration/services/app-dialog-config.service.ts","./projects/ng-dialogs/src/app/app-administration/services/export-app-parts.service.ts","./projects/ng-dialogs/src/app/app-administration/services/export-app.service.ts","./projects/ng-dialogs/src/app/app-administration/services/import-app-parts.service.ts","./projects/ng-dialogs/src/app/app-administration/services/pipelines.service.ts","./projects/ng-dialogs/src/app/app-administration/services/views.service.ts","./projects/ng-dialogs/src/app/content-items/services/content-items.service.ts","./projects/ng-dialogs/src/app/import-app/services/import-app.service.ts","./projects/ng-dialogs/src/app/metadata/ag-grid-components/metadata-actions/metadata-actions.component.ts","./projects/ng-dialogs/src/app/metadata/ag-grid-components/metadata-actions/metadata-actions.component.html","./projects/ng-dialogs/src/app/metadata/ag-grid-components/metadata-content-type/metadata-content-type.component.ts","./projects/ng-dialogs/src/app/metadata/ag-grid-components/metadata-content-type/metadata-content-type.component.html","./projects/ng-dialogs/src/app/metadata/confirm-delete-dialog/confirm-delete-dialog.component.html","./projects/ng-dialogs/src/app/metadata/confirm-delete-dialog/confirm-delete-dialog.component.ts","./projects/ng-dialogs/src/app/metadata/metadata-save-dialog/metadata-save-dialog.component.html","./projects/ng-dialogs/src/app/metadata/metadata-save-dialog/metadata-save-dialog.component.ts","./projects/ng-dialogs/src/app/metadata/metadata.component.html","./projects/ng-dialogs/src/app/metadata/metadata.component.ts","./projects/ng-dialogs/src/app/shared/components/field-hint/field-hint.component.html","./projects/ng-dialogs/src/app/shared/components/field-hint/field-hint.component.ts","./projects/ng-dialogs/src/app/shared/directives/click-stop-propagation.directive.ts","./projects/ng-dialogs/src/app/shared/helpers/file-to-base64.helper.ts","./projects/ng-dialogs/src/app/shared/pipes/safe-html.pipe.ts"],"sourcesContent":["import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { map, tap } from 'rxjs';\r\nimport { GlobalConfigService } from '../../../../../edit/shared/store/ngrx-data';\r\nimport { Context } from '../../shared/services/context';\r\nimport { DialogSettings } from '../models/dialog-settings.model';\r\n\r\nconst webApiDialogRoot = 'admin/dialog/';\r\n\r\n@Injectable()\r\nexport class AppDialogConfigService {\r\n  constructor(\r\n    private http: HttpClient,\r\n    private context: Context,\r\n    private dnnContext: DnnContext,\r\n    private globalConfigService: GlobalConfigService,\r\n  ) { }\r\n\r\n  getDialogSettings(appId?: number) {\r\n    return this.http.get<DialogSettings>(this.dnnContext.$2sxc.http.apiUrl(webApiDialogRoot + 'settings'), {\r\n      params: { appId: appId ?? this.context.appId.toString() },\r\n    }).pipe(\r\n      map(dialogSettings => {\r\n        dialogSettings.Context.Language.List = dialogSettings.Context.Language.List.filter(language => language.IsEnabled);\r\n        return dialogSettings;\r\n      }),\r\n      tap(dialogSettings => {\r\n        this.globalConfigService.allowDebug(dialogSettings.Context.Enable.DebugMode);\r\n      }),\r\n    );\r\n  }\r\n}\r\n","import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { Context } from '../../shared/services/context';\r\nimport { ContentInfo } from '../models/content-info.model';\r\nimport { webApiAppPartsRoot } from './import-app-parts.service';\r\n\r\n@Injectable()\r\nexport class ExportAppPartsService {\r\n  constructor(private http: HttpClient, private context: Context, private dnnContext: DnnContext) { }\r\n\r\n  getContentInfo(scope: string) {\r\n    return this.http.get<ContentInfo>(this.dnnContext.$2sxc.http.apiUrl(webApiAppPartsRoot + 'Get'), {\r\n      params: { appid: this.context.appId.toString(), zoneId: this.context.zoneId.toString(), scope },\r\n    });\r\n  }\r\n\r\n  exportParts(contentTypeIds: number[], entityIds: number[], templateIds: number[]) {\r\n    const url = this.dnnContext.$2sxc.http.apiUrl(webApiAppPartsRoot + 'Export')\r\n      + '?appId=' + this.context.appId.toString()\r\n      + '&zoneId=' + this.context.zoneId.toString()\r\n      + '&contentTypeIdsString=' + contentTypeIds.join(';')\r\n      + '&entityIdsString=' + entityIds.join(';')\r\n      + '&templateIdsString=' + templateIds.join(';');\r\n\r\n    window.open(url, '_blank', '');\r\n  }\r\n}\r\n","import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { webApiAppRoot } from '../../import-app/services/import-app.service';\r\nimport { Context } from '../../shared/services/context';\r\nimport { AppInfo } from '../models/app-info.model';\r\n\r\n@Injectable()\r\nexport class ExportAppService {\r\n  constructor(private http: HttpClient, private context: Context, private dnnContext: DnnContext) { }\r\n\r\n  getAppInfo() {\r\n    return this.http.get<AppInfo>(this.dnnContext.$2sxc.http.apiUrl(webApiAppRoot + 'Statistics'), {\r\n      params: { appid: this.context.appId.toString(), zoneId: this.context.zoneId.toString() },\r\n    });\r\n  }\r\n\r\n  exportApp(includeContentGroups: boolean, resetAppGuid: boolean) {\r\n    const url = this.dnnContext.$2sxc.http.apiUrl(webApiAppRoot + 'Export')\r\n      + '?appId=' + this.context.appId\r\n      + '&zoneId=' + this.context.zoneId\r\n      + '&includeContentGroups=' + includeContentGroups\r\n      + '&resetAppGuid=' + resetAppGuid;\r\n\r\n    window.open(url, '_blank', '');\r\n  }\r\n\r\n  exportForVersionControl(includeContentGroups: boolean, resetAppGuid: boolean) {\r\n    return this.http.get<boolean>(this.dnnContext.$2sxc.http.apiUrl(webApiAppRoot + 'SaveData'), {\r\n      params: {\r\n        appid: this.context.appId.toString(),\r\n        zoneId: this.context.zoneId.toString(),\r\n        includeContentGroups: includeContentGroups.toString(),\r\n        resetAppGuid: resetAppGuid.toString(),\r\n      },\r\n    });\r\n  }\r\n}\r\n","import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { ImportAppResult } from '../../import-app/models/import-app-result.model';\r\nimport { webApiAppRoot } from '../../import-app/services/import-app.service';\r\nimport { Context } from '../../shared/services/context';\r\n\r\nexport const webApiAppPartsRoot = 'admin/appParts/';\r\n\r\n@Injectable()\r\nexport class ImportAppPartsService {\r\n  constructor(private http: HttpClient, private context: Context, private dnnContext: DnnContext) { }\r\n\r\n  importAppParts(file: File) {\r\n    const formData = new FormData();\r\n    formData.append('File', file);\r\n    return this.http.post<ImportAppResult>(this.dnnContext.$2sxc.http.apiUrl(webApiAppPartsRoot + 'Import'), formData, {\r\n      params: { appId: this.context.appId.toString(), zoneId: this.context.zoneId.toString() }\r\n    });\r\n  }\r\n\r\n  /** Reset the App back to the state it was in the last xml export */\r\n  resetApp() {\r\n    return this.http.post<ImportAppResult>(this.dnnContext.$2sxc.http.apiUrl(webApiAppRoot + 'Reset'), {}, {\r\n      params: { appId: this.context.appId.toString(), zoneId: this.context.zoneId.toString() }\r\n    });\r\n  }\r\n}\r\n","import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { from } from 'rxjs';\r\nimport { mergeMap } from 'rxjs/operators';\r\nimport { webApiEntityList } from '../../../../../edit/shared/services';\r\nimport { toBase64 } from '../../shared/helpers/file-to-base64.helper';\r\nimport { Context } from '../../shared/services/context';\r\nimport { Query } from '../models/query.model';\r\n\r\nconst webApiQueryRoot = 'admin/query/';\r\nconst webApiQueryImport = webApiQueryRoot + 'import';\r\nconst webApiQueryClone = webApiQueryRoot + 'Clone';\r\nconst webApiQueryDelete = webApiQueryRoot + 'Delete';\r\nexport const webApiQueryRun = webApiQueryRoot + 'Run';\r\nexport const webApiQueryDebugStream = webApiQueryRoot + 'DebugStream';\r\nexport const webApiQuerySave = webApiQueryRoot + 'Save';\r\nexport const webApiQueryGet = webApiQueryRoot + 'Get';\r\nexport const webApiQueryDataSources = webApiQueryRoot + 'DataSources';\r\n\r\n@Injectable()\r\nexport class PipelinesService {\r\n  constructor(private http: HttpClient, private context: Context, private dnnContext: DnnContext) { }\r\n\r\n  getAll(contentType: string) {\r\n    return this.http.get<Query[]>(this.dnnContext.$2sxc.http.apiUrl(webApiEntityList), {\r\n      params: { appId: this.context.appId.toString(), contentType }\r\n    });\r\n  }\r\n\r\n  importQuery(file: File) {\r\n    return from(toBase64(file)).pipe(\r\n      mergeMap(fileBase64 => {\r\n        return this.http.post<boolean>(this.dnnContext.$2sxc.http.apiUrl(webApiQueryImport), {\r\n          AppId: this.context.appId.toString(),\r\n          ContentBase64: fileBase64,\r\n        });\r\n      })\r\n    );\r\n  }\r\n\r\n  clonePipeline(id: number) {\r\n    return this.http.get<null>(this.dnnContext.$2sxc.http.apiUrl(webApiQueryClone), {\r\n      params: { Id: id.toString(), appId: this.context.appId.toString() }\r\n    });\r\n  }\r\n\r\n  delete(id: number) {\r\n    return this.http.delete<boolean>(this.dnnContext.$2sxc.http.apiUrl(webApiQueryDelete), {\r\n      params: { appId: this.context.appId.toString(), Id: id.toString() },\r\n    });\r\n  }\r\n}\r\n","import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { ImportAppResult } from '../../import-app/models/import-app-result.model';\r\nimport { Context } from '../../shared/services/context';\r\nimport { Polymorphism } from '../models/polymorphism.model';\r\nimport { ViewUsage } from '../models/view-usage.model';\r\nimport { View } from '../models/view.model';\r\n\r\nconst webApiViewRoot = 'admin/view/';\r\nconst webApiViews = webApiViewRoot + 'all';\r\nconst webApiViewDelete = webApiViewRoot + 'delete';\r\nconst webApiViewImport = webApiViewRoot + 'import';\r\nconst webApiViewPolymorph = webApiViewRoot + 'polymorphism';\r\nconst webApiViewUsage = webApiViewRoot + 'usage';\r\n\r\n@Injectable()\r\nexport class ViewsService {\r\n  constructor(private http: HttpClient, private context: Context, private dnnContext: DnnContext) { }\r\n\r\n  getAll() {\r\n    return this.http.get<View[]>(this.dnnContext.$2sxc.http.apiUrl(webApiViews), {\r\n      params: { appId: this.context.appId.toString() }\r\n    });\r\n  }\r\n\r\n  delete(id: number) {\r\n    return this.http.get<boolean>(this.dnnContext.$2sxc.http.apiUrl(webApiViewDelete), {\r\n      params: { appId: this.context.appId.toString(), Id: id.toString() },\r\n    });\r\n  }\r\n\r\n  import(file: File) {\r\n    const formData = new FormData();\r\n    formData.append('File', file);\r\n    return this.http.post<ImportAppResult>(this.dnnContext.$2sxc.http.apiUrl(webApiViewImport), formData, {\r\n      params: { appId: this.context.appId.toString(), zoneId: this.context.zoneId.toString() }\r\n    });\r\n  }\r\n\r\n  export(id: number) {\r\n    const url = this.dnnContext.$2sxc.http.apiUrl(webApiViewRoot + 'json')\r\n      + '?appId=' + this.context.appId\r\n      + '&viewId=' + id;\r\n\r\n    window.open(url, '_blank', '');\r\n  }\r\n\r\n  getPolymorphism() {\r\n    return this.http.get<Polymorphism>(this.dnnContext.$2sxc.http.apiUrl(webApiViewPolymorph), {\r\n      params: { appId: this.context.appId.toString() }\r\n    });\r\n  }\r\n\r\n  getUsage(guid: string) {\r\n    return this.http.get<ViewUsage[]>(this.dnnContext.$2sxc.http.apiUrl(webApiViewUsage), {\r\n      params: { appId: this.context.appId.toString(), guid }\r\n    });\r\n  }\r\n}\r\n","import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { from } from 'rxjs';\r\nimport { mergeMap } from 'rxjs/operators';\r\nimport { webApiEntityList, webApiEntityRoot } from '../../../../../edit/shared/services';\r\nimport { Field } from '../../content-type-fields/models/field.model';\r\nimport { webApiFieldsAll } from '../../content-type-fields/services/content-types-fields.service';\r\nimport { toBase64 } from '../../shared/helpers/file-to-base64.helper';\r\nimport { Context } from '../../shared/services/context';\r\nimport { ContentItem } from '../models/content-item.model';\r\n\r\n@Injectable()\r\nexport class ContentItemsService {\r\n  constructor(private http: HttpClient, private context: Context, private dnnContext: DnnContext) { }\r\n\r\n  getAll(contentTypeStaticName: string) {\r\n    return this.http.get<ContentItem[]>(this.dnnContext.$2sxc.http.apiUrl(webApiEntityList), {\r\n      params: { appId: this.context.appId.toString(), contentType: contentTypeStaticName }\r\n    });\r\n  }\r\n\r\n  getColumns(contentTypeStaticName: string) {\r\n    return this.http.get<Field[]>(this.dnnContext.$2sxc.http.apiUrl(webApiFieldsAll), {\r\n      params: { appId: this.context.appId.toString(), staticName: contentTypeStaticName }\r\n    });\r\n  }\r\n\r\n  importItem(file: File) {\r\n    return from(toBase64(file)).pipe(\r\n      mergeMap(fileBase64 => {\r\n        return this.http.post<boolean>(this.dnnContext.$2sxc.http.apiUrl(webApiEntityRoot + 'upload'), {\r\n          AppId: this.context.appId.toString(),\r\n          ContentBase64: fileBase64,\r\n        });\r\n      })\r\n    );\r\n  }\r\n}\r\n","import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { Context } from '../../shared/services/context';\r\nimport { ImportAppResult } from '../models/import-app-result.model';\r\n\r\nexport const webApiAppRoot = 'admin/app/';\r\n\r\n@Injectable()\r\nexport class ImportAppService {\r\n  constructor(private http: HttpClient, private context: Context, private dnnContext: DnnContext) { }\r\n\r\n  importApp(file: File, changedName: string) {\r\n    const formData = new FormData();\r\n    formData.append('File', file);\r\n    formData.append('Name', changedName ? changedName : '');\r\n    return this.http.post<ImportAppResult>(this.dnnContext.$2sxc.http.apiUrl(webApiAppRoot + 'Import'), formData, {\r\n      params: { zoneId: this.context.zoneId.toString() }\r\n    });\r\n  }\r\n}\r\n","import { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { Component } from '@angular/core';\r\nimport { MetadataItem } from '../../models/metadata.model';\r\nimport { MetadataActionsParams } from './metadata-actions.models';\r\n\r\n@Component({\r\n  selector: 'app-metadata-actions',\r\n  templateUrl: './metadata-actions.component.html',\r\n  styleUrls: ['./metadata-actions.component.scss'],\r\n})\r\nexport class MetadataActionsComponent implements ICellRendererAngularComp {\r\n  private params: MetadataActionsParams;\r\n\r\n  agInit(params: MetadataActionsParams) {\r\n    this.params = params;\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n\r\n  deleteMetadata() {\r\n    const metadata: MetadataItem = this.params.data;\r\n    this.params.onDelete(metadata);\r\n  }\r\n}\r\n","<div class=\"actions-component\">\r\n  <div class=\"like-button highlight\" matRipple tippy=\"Delete\" (click)=\"deleteMetadata()\">\r\n    <mat-icon>delete</mat-icon>\r\n  </div>\r\n</div>\r\n","import { ICellRendererParams } from '@ag-grid-community/all-modules';\r\nimport { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { Component } from '@angular/core';\r\nimport { MetadataItem } from '../../models/metadata.model';\r\n\r\n@Component({\r\n  selector: 'app-metadata-content-type',\r\n  templateUrl: './metadata-content-type.component.html',\r\n  styleUrls: ['./metadata-content-type.component.scss'],\r\n})\r\nexport class MetadataContentTypeComponent implements ICellRendererAngularComp {\r\n  value: string;\r\n  metadata: MetadataItem;\r\n\r\n  agInit(params: ICellRendererParams) {\r\n    this.value = params.value;\r\n    this.metadata = params.data;\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n}\r\n","<div class=\"container\" [tippy]=\"metadata._Type.Description\" [tippyDisabled]=\"!metadata._Type.Description\">\r\n  {{ value }}\r\n</div>\r\n","<div mat-dialog-title>\r\n  <div class=\"dialog-title-box\">Delete {{ dialogData.entityTitle }} ({{ dialogData.entityId }})?</div>\r\n</div>\r\n\r\n<div class=\"dialog-component-content fancy-scrollbar-light\" *ngIf=\"dialogData.message\"\r\n  [innerHtml]=\"dialogData.message | safeHtml\">\r\n</div>\r\n\r\n<div class=\"dialog-component-actions\">\r\n  <button mat-raised-button (click)=\"closeDialog()\">Cancel</button>\r\n  <button mat-raised-button (click)=\"closeDialog(true)\">Delete</button>\r\n</div>\r\n","import { Component, HostBinding, Inject } from '@angular/core';\r\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\r\nimport { ConfirmDeleteDialogData } from './confirm-delete-dialog.models';\r\n\r\n@Component({\r\n  selector: 'app-confirm-delete-dialog',\r\n  templateUrl: './confirm-delete-dialog.component.html',\r\n  styleUrls: ['./confirm-delete-dialog.component.scss'],\r\n})\r\nexport class ConfirmDeleteDialogComponent {\r\n  @HostBinding('className') hostClass = 'dialog-component';\r\n\r\n  constructor(\r\n    @Inject(MAT_DIALOG_DATA) public dialogData: ConfirmDeleteDialogData,\r\n    private dialogRef: MatDialogRef<ConfirmDeleteDialogComponent>,\r\n  ) { }\r\n\r\n  closeDialog(confirm?: boolean) {\r\n    this.dialogRef.close(confirm);\r\n  }\r\n}\r\n","<ng-container *ngIf=\"templateVars$ | async as data\">\r\n  <div mat-dialog-title>\r\n    <div class=\"dialog-title-box\">Create Metadata</div>\r\n  </div>\r\n\r\n  <p class=\"dialog-description\">\r\n    This is a special operation to add an item which is metadata for another item,\r\n    see <a href=\"http://r.2sxc.org/metadata\" target=\"_blank\">docs</a>.\r\n  </p>\r\n\r\n  <form [formGroup]=\"form\" class=\"dialog-form\">\r\n    <div class=\"dialog-form-content fancy-scrollbar-light\">\r\n\r\n      <!-- Scope -->\r\n      <ng-container *ngIf=\"advancedMode && guidedContentType\">\r\n        <mat-form-field appearance=\"standard\" color=\"accent\">\r\n          <mat-label>Scope</mat-label>\r\n          <mat-select formControlName=\"scope\" [placeholder]=\"!data.scopeOptions.length ? 'No items found' : ''\">\r\n            <mat-option *ngFor=\"let scopeOption of data.scopeOptions\" [value]=\"scopeOption.value\">\r\n              {{ scopeOption.name }}\r\n            </mat-option>\r\n            <mat-option [value]=\"dropdownInsertValue\">Other...</mat-option>\r\n          </mat-select>\r\n        </mat-form-field>\r\n        <app-field-hint>\r\n          The scope should almost never be changed -\r\n          <a href=\"https://2sxc.org/help?tag=scope\" target=\"_blank\" appClickStopPropagation>see help</a>\r\n        </app-field-hint>\r\n      </ng-container>\r\n\r\n      <!-- Content Type of metadata item -->\r\n      <mat-form-field appearance=\"standard\" color=\"accent\">\r\n        <mat-label>Content Type</mat-label>\r\n        <mat-select *ngIf=\"guidedContentType\" formControlName=\"contentType\" required\r\n          [placeholder]=\"!data.contentTypes.length ? 'No items found' : ''\">\r\n          <mat-option *ngFor=\"let contentType of data.contentTypes\" [value]=\"contentType.StaticName\">\r\n            {{ contentType.Label }}\r\n          </mat-option>\r\n        </mat-select>\r\n\r\n        <input matInput type=\"text\" *ngIf=\"!guidedContentType\" formControlName=\"contentType\" required>\r\n\r\n        <div matSuffix class=\"selection-suffix\">\r\n          <button mat-icon-button type=\"button\" [ngClass]=\"{ 'active': guidedContentType }\" tippy=\"Pick existing value\"\r\n            (click)=\"toggleGuidedContentType(true)\">\r\n            <mat-icon>search</mat-icon>\r\n          </button>\r\n          <button mat-icon-button type=\"button\" [ngClass]=\"{ 'active': !guidedContentType }\" tippy=\"Manual entry\"\r\n            (click)=\"toggleGuidedContentType(false)\">\r\n            <mat-icon>text_fields</mat-icon>\r\n          </button>\r\n        </div>\r\n      </mat-form-field>\r\n      <app-field-hint *ngIf=\"form.controls.contentType.touched && form.controls.contentType.errors?.required\"\r\n        [isError]=\"true\">\r\n        This field is required\r\n      </app-field-hint>\r\n    </div>\r\n\r\n    <div class=\"dialog-form-actions\">\r\n      <mat-slide-toggle color=\"accent\" [checked]=\"advancedMode\" (change)=\"toggleAdvancedMode($event)\">\r\n        {{ advancedMode ? 'Advanced' : 'Simple' }}\r\n      </mat-slide-toggle>\r\n      <div class=\"spacer\"></div>\r\n      <button mat-raised-button type=\"button\" (click)=\"closeDialog()\">Cancel</button>\r\n      <button mat-raised-button type=\"button\" color=\"accent\" [disabled]=\"!form.valid\" (click)=\"confirm()\">\r\n        Confirm\r\n      </button>\r\n    </div>\r\n  </form>\r\n</ng-container>\r\n","import { Component, HostBinding, OnDestroy, OnInit } from '@angular/core';\r\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\r\nimport { MatDialogRef } from '@angular/material/dialog';\r\nimport { MatSlideToggleChange } from '@angular/material/slide-toggle';\r\nimport { BehaviorSubject, combineLatest, Observable } from 'rxjs';\r\nimport { distinctUntilChanged, map, startWith } from 'rxjs/operators';\r\nimport { ContentType } from '../../app-administration/models';\r\nimport { ContentTypesService } from '../../app-administration/services';\r\nimport { dropdownInsertValue } from '../../shared/constants/dropdown-insert-value.constant';\r\nimport { eavConstants, ScopeOption } from '../../shared/constants/eav.constants';\r\nimport { MetadataSaveDialogTemplateVars, MetadataSaveFormValues } from './metadata-save-dialog.models';\r\n\r\n@Component({\r\n  selector: 'app-metadata-save-dialog',\r\n  templateUrl: './metadata-save-dialog.component.html',\r\n  styleUrls: ['./metadata-save-dialog.component.scss']\r\n})\r\nexport class MetadataSaveDialogComponent implements OnInit, OnDestroy {\r\n  @HostBinding('className') hostClass = 'dialog-component';\r\n\r\n  form: FormGroup;\r\n  dropdownInsertValue = dropdownInsertValue;\r\n  templateVars$: Observable<MetadataSaveDialogTemplateVars>;\r\n  guidedContentType = true;\r\n  advancedMode = false;\r\n\r\n  private contentTypes$: BehaviorSubject<ContentType[]>;\r\n  private scopeOptions$: BehaviorSubject<ScopeOption[]>;\r\n\r\n  constructor(\r\n    private dialogRef: MatDialogRef<MetadataSaveDialogComponent>,\r\n    private contentTypesService: ContentTypesService,\r\n  ) { }\r\n\r\n  ngOnInit(): void {\r\n    this.contentTypes$ = new BehaviorSubject<ContentType[]>([]);\r\n    this.scopeOptions$ = new BehaviorSubject<ScopeOption[]>([]);\r\n\r\n    this.buildForm();\r\n    this.fetchScopes();\r\n\r\n    this.templateVars$ = combineLatest([this.contentTypes$, this.scopeOptions$]).pipe(\r\n      map(([contentTypes, scopeOptions]) => {\r\n        const templateVars: MetadataSaveDialogTemplateVars = {\r\n          contentTypes,\r\n          scopeOptions,\r\n        };\r\n        return templateVars;\r\n      }),\r\n    );\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.contentTypes$.complete();\r\n    this.scopeOptions$.complete();\r\n  }\r\n\r\n  closeDialog(contentType?: string): void {\r\n    this.dialogRef.close(contentType);\r\n  }\r\n\r\n  toggleGuidedContentType(guidedContentType: boolean): void {\r\n    this.guidedContentType = guidedContentType;\r\n  }\r\n\r\n  toggleAdvancedMode(event: MatSlideToggleChange): void {\r\n    this.advancedMode = event.checked;\r\n  }\r\n\r\n  confirm(): void {\r\n    const formValues: MetadataSaveFormValues = this.form.getRawValue();\r\n    this.closeDialog(formValues.contentType);\r\n  }\r\n\r\n  private buildForm(): void {\r\n    this.form = new FormGroup({});\r\n    this.form.addControl('contentType', new FormControl(null, [Validators.required]));\r\n    this.form.addControl('scope', new FormControl(eavConstants.scopes.default.value));\r\n\r\n    this.form.controls.scope.valueChanges.pipe(\r\n      startWith(this.form.controls.scope.value),\r\n      distinctUntilChanged(),\r\n    ).subscribe((newScope: string) => {\r\n      // reset content types when scope changes\r\n      if (this.form.controls.contentType.value != null) {\r\n        this.form.controls.contentType.patchValue(null);\r\n      }\r\n\r\n      // add new scope on manual entry\r\n      if (newScope === dropdownInsertValue) {\r\n        newScope = prompt('This is an advanced feature to show content-types of another scope. Don\\'t use this if you don\\'t know what you\\'re doing, as content-types of other scopes are usually hidden for a good reason.') || eavConstants.scopes.default.value;\r\n        if (!this.scopeOptions$.value.some(option => option.value === newScope)) {\r\n          const newScopeOption: ScopeOption = {\r\n            name: newScope,\r\n            value: newScope,\r\n          };\r\n          this.scopeOptions$.next([newScopeOption, ...this.scopeOptions$.value]);\r\n        }\r\n        this.form.controls.scope.patchValue(newScope);\r\n      } else {\r\n        this.fetchContentTypes(newScope);\r\n      }\r\n    });\r\n  }\r\n\r\n  private fetchContentTypes(scope: string): void {\r\n    this.contentTypesService.retrieveContentTypes(scope).subscribe(contentTypes => {\r\n      this.contentTypes$.next(contentTypes);\r\n    });\r\n  }\r\n\r\n  private fetchScopes(): void {\r\n    this.contentTypesService.getScopes().subscribe(scopes => {\r\n      this.scopeOptions$.next(scopes);\r\n    });\r\n  }\r\n}\r\n","<ng-container *ngIf=\"templateVars$ | async as data\">\r\n  <div class=\"nav-component-wrapper\">\r\n    <div mat-dialog-title>\r\n      <div class=\"dialog-title-box\">\r\n        <div>{{ title || 'Metadata' }}</div>\r\n        <button mat-icon-button tippy=\"Close dialog\" (click)=\"closeDialog()\">\r\n          <mat-icon>close</mat-icon>\r\n        </button>\r\n      </div>\r\n    </div>\r\n\r\n    <p class=\"dialog-description\">\r\n      <ng-container *ngIf=\"!data.itemFor\">This item is not metadata for anything else.</ng-container>\r\n      <ng-container *ngIf=\"data.itemFor\">\r\n        This item is metadata for:\r\n        <br>Target: {{ data.itemFor.Target }}\r\n        <br>TargetType: {{ data.itemFor.TargetType }}\r\n        <ng-container *ngIf=\"data.itemFor.Number\"><br>Number: {{ data.itemFor.Number }}</ng-container>\r\n        <ng-container *ngIf=\"data.itemFor.Guid\"><br>Guid: {{ data.itemFor.Guid }}</ng-container>\r\n        <ng-container *ngIf=\"data.itemFor.String\"><br>String: {{ data.itemFor.String }}</ng-container>\r\n        <ng-container *ngIf=\"data.itemFor.Title\"><br>Title: {{ data.itemFor.String }}</ng-container>\r\n      </ng-container>\r\n    </p>\r\n\r\n    <router-outlet></router-outlet>\r\n\r\n    <div class=\"grid-wrapper\">\r\n      <ag-grid-angular class=\"ag-theme-material\" [rowData]=\"data.metadata\" [modules]=\"modules\"\r\n        [gridOptions]=\"gridOptions\">\r\n      </ag-grid-angular>\r\n\r\n      <div class=\"grid-more-actions-box\"></div>\r\n\r\n      <button mat-fab mat-elevation-z24 class=\"grid-fab\" *ngIf=\"data.recommendations.length === 0\"\r\n        tippy=\"Create a new metadata for this item\" (click)=\"createMetadata()\">\r\n        <mat-icon>add</mat-icon>\r\n      </button>\r\n\r\n      <eco-fab-speed-dial class=\"grid-fab\" [ngClass]=\"{ 'fab-opened': data.fabOpen }\"\r\n        *ngIf=\"data.recommendations.length > 0\" (openChange)=\"openChange($event)\">\r\n        <eco-fab-speed-dial-trigger [spin]=\"true\">\r\n          <button mat-fab>\r\n            <mat-icon class=\"spin180\">{{ data.fabOpen ? 'close' : 'add' }}</mat-icon>\r\n          </button>\r\n        </eco-fab-speed-dial-trigger>\r\n\r\n        <eco-fab-speed-dial-actions>\r\n          <button mat-mini-fab label=\"Other Content Type\" (click)=\"createMetadata()\">\r\n            <mat-icon>search</mat-icon>\r\n          </button>\r\n          <button mat-mini-fab *ngFor=\"let recommendation of data.recommendations\" [attr.label]=\"recommendation.Title\"\r\n            (click)=\"createMetadata(recommendation)\">\r\n            <mat-icon>{{ recommendation.Icon || 'add' }}</mat-icon>\r\n          </button>\r\n        </eco-fab-speed-dial-actions>\r\n      </eco-fab-speed-dial>\r\n    </div>\r\n  </div>\r\n</ng-container>\r\n","import { AllCommunityModules, GridOptions } from '@ag-grid-community/all-modules';\r\nimport { ChangeDetectorRef, Component, OnDestroy, OnInit, ViewContainerRef } from '@angular/core';\r\nimport { MatDialog, MatDialogRef } from '@angular/material/dialog';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { ActivatedRoute, NavigationEnd, Router } from '@angular/router';\r\nimport { BehaviorSubject, combineLatest, Observable, Subscription } from 'rxjs';\r\nimport { filter, map, pairwise, startWith } from 'rxjs/operators';\r\nimport { EavFor } from '../../../../edit/shared/models/eav';\r\nimport { ContentItemsService } from '../content-items/services/content-items.service';\r\nimport { EntitiesService } from '../content-items/services/entities.service';\r\nimport { MetadataService } from '../permissions';\r\nimport { IdFieldComponent } from '../shared/components/id-field/id-field.component';\r\nimport { IdFieldParams } from '../shared/components/id-field/id-field.models';\r\nimport { defaultGridOptions } from '../shared/constants/default-grid-options.constants';\r\nimport { eavConstants, MetadataKeyType } from '../shared/constants/eav.constants';\r\nimport { convertFormToUrl } from '../shared/helpers/url-prep.helper';\r\nimport { EditForm } from '../shared/models/edit-form.model';\r\nimport { MetadataActionsComponent } from './ag-grid-components/metadata-actions/metadata-actions.component';\r\nimport { MetadataActionsParams } from './ag-grid-components/metadata-actions/metadata-actions.models';\r\nimport { MetadataContentTypeComponent } from './ag-grid-components/metadata-content-type/metadata-content-type.component';\r\nimport { ConfirmDeleteDialogComponent } from './confirm-delete-dialog/confirm-delete-dialog.component';\r\nimport { ConfirmDeleteDialogData } from './confirm-delete-dialog/confirm-delete-dialog.models';\r\nimport { MetadataSaveDialogComponent } from './metadata-save-dialog/metadata-save-dialog.component';\r\nimport { MetadataItem, MetadataRecommendation, MetadataTemplateVars } from './models/metadata.model';\r\n\r\n@Component({\r\n  selector: 'app-metadata',\r\n  templateUrl: './metadata.component.html',\r\n  styleUrls: ['./metadata.component.scss'],\r\n})\r\nexport class MetadataComponent implements OnInit, OnDestroy {\r\n  modules = AllCommunityModules;\r\n  gridOptions: GridOptions = {\r\n    ...defaultGridOptions,\r\n    columnDefs: [\r\n      {\r\n        headerName: 'ID', field: 'Id', width: 70, headerClass: 'dense', cellClass: 'id-action no-padding no-outline'.split(' '),\r\n        cellRenderer: IdFieldComponent, sortable: true, filter: 'agNumberColumnFilter',\r\n        valueGetter: (params) => (params.data as MetadataItem).Id,\r\n        cellRendererParams: {\r\n          tooltipGetter: (metadata: MetadataItem) => `ID: ${metadata.Id}\\nGUID: ${metadata.Guid}`,\r\n        } as IdFieldParams,\r\n      },\r\n      {\r\n        field: 'Title', flex: 2, minWidth: 250, cellClass: 'primary-action highlight'.split(' '),\r\n        valueGetter: (params) => (params.data as MetadataItem).Title,\r\n        sortable: true, sort: 'asc', filter: 'agTextColumnFilter',\r\n        onCellClicked: (event) => this.editMetadata(event.data as MetadataItem),\r\n      },\r\n      {\r\n        headerName: 'Content Type', field: 'ContentType', flex: 2, minWidth: 250, cellClass: 'no-outline', sortable: true,\r\n        cellRenderer: MetadataContentTypeComponent, filter: 'agTextColumnFilter', valueGetter: (params) => {\r\n          const metadata = params.data as MetadataItem;\r\n          return `${metadata._Type.Name}${metadata._Type.Title !== metadata._Type.Name ? ` (${metadata._Type.Title})` : ''}`;\r\n        },\r\n      },\r\n      {\r\n        width: 42, cellClass: 'secondary-action no-padding'.split(' '), cellRenderer: MetadataActionsComponent, pinned: 'right',\r\n        cellRendererParams: {\r\n          onDelete: (metadata) => this.deleteMetadata(metadata),\r\n        } as MetadataActionsParams,\r\n      },\r\n    ],\r\n  };\r\n\r\n  private metadata$ = new BehaviorSubject<MetadataItem[]>([]);\r\n  private recommendations$ = new BehaviorSubject<MetadataRecommendation[]>([]);\r\n  private itemFor$ = new BehaviorSubject<EavFor | undefined>(undefined);\r\n  private fabOpen$ = new BehaviorSubject(false);\r\n  private subscription = new Subscription();\r\n  private targetType = parseInt(this.route.snapshot.paramMap.get('targetType'), 10);\r\n  private keyType = this.route.snapshot.paramMap.get('keyType') as MetadataKeyType;\r\n  private key = this.route.snapshot.paramMap.get('key');\r\n  title = decodeURIComponent(this.route.snapshot.paramMap.get('title') ?? '');\r\n  private contentTypeStaticName = this.route.snapshot.paramMap.get('contentTypeStaticName');\r\n  templateVars$: Observable<MetadataTemplateVars>;\r\n\r\n  constructor(\r\n    private dialogRef: MatDialogRef<MetadataComponent>,\r\n    private router: Router,\r\n    private route: ActivatedRoute,\r\n    private metadataService: MetadataService,\r\n    private snackBar: MatSnackBar,\r\n    private entitiesService: EntitiesService,\r\n    private contentItemsService: ContentItemsService,\r\n    private dialog: MatDialog,\r\n    private viewContainerRef: ViewContainerRef,\r\n    private changeDetectorRef: ChangeDetectorRef,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.fetchFor();\r\n    this.fetchMetadata();\r\n    this.refreshOnChildClosed();\r\n\r\n    const filteredRecommendations$ = combineLatest([this.metadata$, this.recommendations$]).pipe(\r\n      map(([metadataItems, recommendations]) =>\r\n        recommendations.filter(r => r.Count === 1 && !metadataItems.some(i => i._Type.Id === r.Id))),\r\n    );\r\n    this.templateVars$ = combineLatest([this.metadata$, filteredRecommendations$, this.itemFor$, this.fabOpen$]).pipe(\r\n      map(([metadata, recommendations, itemFor, fabOpen]) => {\r\n        const templateVars: MetadataTemplateVars = {\r\n          metadata,\r\n          recommendations,\r\n          itemFor,\r\n          fabOpen,\r\n        };\r\n        return templateVars;\r\n      }),\r\n    );\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.metadata$.complete();\r\n    this.recommendations$.complete();\r\n    this.itemFor$.complete();\r\n    this.fabOpen$.complete();\r\n    this.subscription.unsubscribe();\r\n  }\r\n\r\n  closeDialog() {\r\n    this.dialogRef.close();\r\n  }\r\n\r\n  openChange(open: boolean) {\r\n    this.fabOpen$.next(open);\r\n  }\r\n\r\n  createMetadata(recommendation?: MetadataRecommendation) {\r\n    if (recommendation) {\r\n      if (recommendation.CreateEmpty) {\r\n        this.snackBar.open(`Creating ${recommendation.Name}...`);\r\n        this.entitiesService.create(recommendation.Id, { For: this.calculateItemFor() }).subscribe({\r\n          error: () => {\r\n            this.snackBar.open(`Creating ${recommendation.Name} failed. Please check console for more info`, undefined, { duration: 3000 });\r\n            this.fetchMetadata();\r\n          },\r\n          next: () => {\r\n            this.snackBar.open(`Created ${recommendation.Name}`, undefined, { duration: 3000 });\r\n            this.fetchMetadata();\r\n          },\r\n        });\r\n      } else {\r\n        this.createMetadataForm(recommendation.Id);\r\n      }\r\n      return;\r\n    }\r\n    const metadataDialogRef = this.dialog.open(MetadataSaveDialogComponent, {\r\n      autoFocus: false,\r\n      viewContainerRef: this.viewContainerRef,\r\n      width: '650px',\r\n    });\r\n    metadataDialogRef.afterClosed().subscribe((contentType?: string) => {\r\n      if (contentType == null) { return; }\r\n      this.createMetadataForm(contentType);\r\n    });\r\n  }\r\n\r\n  private createMetadataForm(contentType: string) {\r\n    const form: EditForm = {\r\n      items: [{\r\n        ContentTypeName: contentType,\r\n        For: this.calculateItemFor(),\r\n      }],\r\n    };\r\n    const formUrl = convertFormToUrl(form);\r\n    this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route });\r\n    this.changeDetectorRef.markForCheck();\r\n  }\r\n\r\n  private calculateItemFor(): EavFor {\r\n    const itemFor: EavFor = {\r\n      Target: Object.values(eavConstants.metadata).find(m => m.targetType === this.targetType)?.target ?? this.targetType.toString(),\r\n      TargetType: this.targetType,\r\n      ...(this.keyType === eavConstants.keyTypes.guid && { Guid: this.key }),\r\n      ...(this.keyType === eavConstants.keyTypes.number && { Number: parseInt(this.key, 10) }),\r\n      ...(this.keyType === eavConstants.keyTypes.string && { String: this.key }),\r\n    };\r\n    return itemFor;\r\n  }\r\n\r\n  private fetchFor() {\r\n    if (!this.contentTypeStaticName) { return; }\r\n\r\n    this.contentItemsService.getAll(this.contentTypeStaticName).subscribe(items => {\r\n      const item = items.find(i => i.Guid === this.key);\r\n      if (item?.For) {\r\n        this.itemFor$.next(item.For);\r\n      }\r\n    });\r\n  }\r\n\r\n  private fetchMetadata() {\r\n    this.metadataService.getMetadata(this.targetType, this.keyType, this.key).subscribe(metadata => {\r\n      this.metadata$.next(metadata.Items);\r\n      this.recommendations$.next(metadata.Recommendations);\r\n    });\r\n  }\r\n\r\n  private editMetadata(metadata: MetadataItem) {\r\n    const form: EditForm = {\r\n      items: [{ EntityId: metadata.Id }],\r\n    };\r\n    const formUrl = convertFormToUrl(form);\r\n    this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route });\r\n  }\r\n\r\n  private deleteMetadata(metadata: MetadataItem, confirmed = false) {\r\n    if (!confirmed) {\r\n      const data: ConfirmDeleteDialogData = {\r\n        entityId: metadata.Id,\r\n        entityTitle: metadata.Title,\r\n        message: this.recommendations$.value.find(r => r.Id === metadata._Type.Id)?.DeleteWarning,\r\n      };\r\n      const confirmationDialogRef = this.dialog.open(ConfirmDeleteDialogComponent, {\r\n        autoFocus: false,\r\n        data,\r\n        viewContainerRef: this.viewContainerRef,\r\n        width: '650px',\r\n      });\r\n      confirmationDialogRef.afterClosed().subscribe((isConfirmed: boolean) => {\r\n        if (isConfirmed) {\r\n          this.deleteMetadata(metadata, true);\r\n        }\r\n      });\r\n      return;\r\n    }\r\n\r\n    this.snackBar.open('Deleting...');\r\n    this.entitiesService.delete(metadata._Type.Id, metadata.Id, false).subscribe({\r\n      next: () => {\r\n        this.snackBar.open('Deleted', null, { duration: 2000 });\r\n        this.fetchMetadata();\r\n      },\r\n      error: () => {\r\n        this.snackBar.open('Delete failed. Please check console for more information', null, { duration: 3000 });\r\n      }\r\n    });\r\n  }\r\n\r\n  private refreshOnChildClosed() {\r\n    this.subscription.add(\r\n      this.router.events.pipe(\r\n        filter(event => event instanceof NavigationEnd),\r\n        startWith(!!this.route.snapshot.firstChild),\r\n        map(() => !!this.route.snapshot.firstChild),\r\n        pairwise(),\r\n        filter(([hadChild, hasChild]) => hadChild && !hasChild),\r\n      ).subscribe(() => {\r\n        this.fetchMetadata();\r\n      })\r\n    );\r\n  }\r\n\r\n}\r\n","<div class=\"hint-box\" (click)=\"toggleIsShort()\" [ngClass]=\"{ 'hint-box__short': isShort }\" [ngSwitch]=\"isError\">\r\n  <mat-hint *ngSwitchCase=\"false\">\r\n    <ng-container *ngTemplateOutlet=\"content\"></ng-container>\r\n  </mat-hint>\r\n\r\n  <mat-error *ngSwitchCase=\"true\">\r\n    <ng-container *ngTemplateOutlet=\"content\"></ng-container>\r\n  </mat-error>\r\n</div>\r\n\r\n<ng-template #content>\r\n  <ng-content></ng-content>\r\n</ng-template>\r\n","import { Component, Input } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-field-hint',\r\n  templateUrl: './field-hint.component.html',\r\n  styleUrls: ['./field-hint.component.scss'],\r\n})\r\nexport class FieldHintComponent {\r\n  @Input() isError = false;\r\n  isShort = true;\r\n\r\n  constructor() { }\r\n\r\n  toggleIsShort() {\r\n    this.isShort = !this.isShort;\r\n  }\r\n}\r\n","import { Directive, HostListener } from '@angular/core';\r\n\r\n@Directive({ selector: '[appClickStopPropagation]' })\r\nexport class ClickStopPropagationDirective {\r\n  @HostListener('click', ['$event'])\r\n  onClick(event: MouseEvent): void {\r\n    event.stopPropagation();\r\n  }\r\n}\r\n","export function toBase64(file: File): Promise<string> {\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    reader.readAsDataURL(file);\r\n    reader.onload = () => {\r\n      resolve((reader.result as string).split(',')[1]);\r\n    };\r\n    reader.onerror = error => {\r\n      reject(error);\r\n    };\r\n  });\r\n}\r\n\r\nexport function toString(file: File): Promise<string> {\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    reader.readAsText(file);\r\n    reader.onload = () => {\r\n      resolve(reader.result as string);\r\n    };\r\n    reader.onerror = error => {\r\n      reject(error);\r\n    };\r\n  });\r\n}\r\n","import { Pipe, PipeTransform } from '@angular/core';\r\nimport { DomSanitizer } from '@angular/platform-browser';\r\n\r\n@Pipe({ name: 'safeHtml' })\r\nexport class SafeHtmlPipe implements PipeTransform {\r\n\r\n  constructor(private sanitizer: DomSanitizer) { }\r\n\r\n  transform(html: string) {\r\n    return this.sanitizer.bypassSecurityTrustHtml(html);\r\n  }\r\n}\r\n"],"sourceRoot":"webpack:///","file":"projects_ng-dialogs_src_app_metadata_metadata_component_ts.fab43a39b8880d7b.js"}