"use strict";(self.webpackChunkng_dialogs=self.webpackChunkng_dialogs||[]).push([["projects_ng-dialogs_src_app_replace-content_replace-content_component_ts"],{7849:function(V,C,o){o.r(C),o.d(C,{ReplaceContentComponent:function(){return J}});var p=o(2090),R=o(8069),I=o(8047),d=o(2977),U=o(7714),g=o(6317),E=o(6562),v=o(635),O=o(116),Z=o(4874),y=o(679),B=o(4830),L=o(5137),t=o(7133),M=o(5758),b=o(2528),x=o(6362),T=o(4770),K=o(4683),P=o(3188),h=o(587),m=o(9051),W=o(7317),$=o(785),j=o(5590),N=o(1130);function S(r,_){if(1&r&&(t.TgZ(0,"mat-option",15),t._uU(1),t.qZA()),2&r){var i=_.$implicit;t.Q6J("value",i),t.xp6(1),t.Oqu(i)}}function G(r,_){if(1&r){var i=t.EpF();t.ynx(0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t._uU(3),t.qZA(),t.qZA(),t._UZ(4,"router-outlet"),t.TgZ(5,"p",3),t._uU(6),t.qZA(),t.TgZ(7,"div",4),t.TgZ(8,"mat-form-field",5),t.TgZ(9,"mat-label"),t._uU(10,"Choose item"),t.qZA(),t.TgZ(11,"input",6),t.NdJ("ngModelChange",function(n){return t.CHM(i),t.oxw().setFilter(n)}),t.qZA(),t.TgZ(12,"mat-autocomplete",7,8),t.NdJ("optionSelected",function(n){return t.CHM(i),t.oxw().select(n)}),t.TgZ(14,"cdk-virtual-scroll-viewport",9),t.YNc(15,S,2,2,"mat-option",10),t.qZA(),t.qZA(),t.qZA(),t.TgZ(16,"button",11),t.NdJ("click",function(){return t.CHM(i),t.oxw().copySelected()}),t.TgZ(17,"mat-icon"),t._uU(18,"file_copy"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(19,"div",12),t.TgZ(20,"button",13),t.NdJ("click",function(){return t.CHM(i),t.oxw().closeDialog()}),t._uU(21,"Cancel"),t.qZA(),t.TgZ(22,"button",14),t.NdJ("click",function(){return t.CHM(i),t.oxw().save()}),t._uU(23,"Save"),t.qZA(),t.qZA(),t.BQk()}if(2&r){var e=_.ngIf,l=t.MAs(13);t.xp6(3),t.Oqu(e.isAddMode?"Add Existing Item":"Replace Content Item"),t.xp6(3),t.hij(" ",e.isAddMode?"Select a content-item to add to this list.":"By replacing a content-item you can make other content appear in the slot of the original content."," "),t.xp6(5),t.Q6J("matAutocomplete",l)("ngModel",e.filterText),t.xp6(3),t.Udp("height",e.filteredOptions.length<6?48*e.filteredOptions.length:240,"px"),t.xp6(1),t.Q6J("cdkVirtualForOf",e.filteredOptions),t.xp6(1),t.Q6J("disabled",!e.isMatch),t.xp6(6),t.Q6J("disabled",!e.isMatch)}}var J=function(){var r=function(){function _(i,e,l,a,n){(0,R.Z)(this,_),this.dialogRef=i,this.contentGroupService=e,this.router=l,this.route=a,this.snackBar=n,this.hostClass="dialog-component"}return(0,I.Z)(_,[{key:"ngOnInit",value:function(){var e=this;this.guid=this.route.snapshot.paramMap.get("guid"),this.part=this.route.snapshot.paramMap.get("part"),this.index=parseInt(this.route.snapshot.paramMap.get("index"),10),this.add=!!this.route.snapshot.queryParamMap.get("add"),this.subscription=new U.w0,this.filterText$=new g.X(""),this.options$=new g.X([]);var l=(0,E.a)([this.filterText$,this.options$]).pipe((0,v.U)(function(a){var n=(0,p.Z)(a,2),s=n[0];return n[1].filter(function(u){return u.label.toLocaleLowerCase().includes(s.toLocaleLowerCase())}).map(function(u){return u.label})}));this.templateVars$=(0,E.a)([this.filterText$,l]).pipe((0,v.U)(function(a){var n=(0,p.Z)(a,2),s=n[0],c=n[1];return{filterText:s,filteredOptions:c,isAddMode:e.add,isMatch:c.includes(s)}})),this.fetchConfig(!1,null),this.refreshOnChildClosed()}},{key:"ngOnDestroy",value:function(){this.filterText$.complete(),this.options$.complete(),this.subscription.unsubscribe()}},{key:"closeDialog",value:function(){this.dialogRef.close()}},{key:"setFilter",value:function(e){this.filterText$.next(e)}},{key:"select",value:function(e){this.filterText$.next(e.option.value)}},{key:"copySelected",value:function(){var e=this.buildContentGroup(),a=(0,L.f)({items:[{ContentTypeName:this.contentTypeName,DuplicateEntity:e.id}]});this.router.navigate(["edit/".concat(a)],{relativeTo:this.route})}},{key:"save",value:function(){var e=this;this.snackBar.open("Saving...");var l=this.buildContentGroup();this.contentGroupService.saveItem(l).subscribe(function(){e.snackBar.open("Saved",null,{duration:2e3}),e.closeDialog()})}},{key:"fetchConfig",value:function(e,l){var a=this,n=this.buildContentGroup();this.contentGroupService.getItems(n).subscribe(function(s){var c,u=Object.entries(s.Items).map(function(f){var D=(0,p.Z)(f,2),A=D[0],H=D[1];return{id:parseInt(A,10),label:"".concat(H," (").concat(A,")")}});if(a.options$.next(u),!n.add&&!e||null!=l){var k=e?l:s.SelectedId,F=(null===(c=a.options$.value.find(function(f){return f.id===k}))||void 0===c?void 0:c.label)||"";a.filterText$.next(F)}a.contentTypeName=s.ContentTypeName})}},{key:"refreshOnChildClosed",value:function(){var e=this;this.subscription.add(this.router.events.pipe((0,O.h)(function(l){return l instanceof d.m2}),(0,Z.O)(!!this.route.snapshot.firstChild),(0,v.U)(function(){return!!e.route.snapshot.firstChild}),(0,y.G)(),(0,O.h)(function(l){var a=(0,p.Z)(l,2);return a[0]&&!a[1]})).subscribe(function(){var l,n=null===(l=e.router.getCurrentNavigation().extras)||void 0===l?void 0:l.state,s=null==n?void 0:n[Object.keys(n)[0]];e.fetchConfig(!0,s)}))}},{key:"buildContentGroup",value:function(){var l,a,e=this;return{id:null!==(a=null===(l=this.options$.value.find(function(c){return c.label===e.filterText$.value}))||void 0===l?void 0:l.id)&&void 0!==a?a:null,guid:this.guid,part:this.part,index:this.index,add:this.add}}}]),_}();return r.\u0275fac=function(i){return new(i||r)(t.Y36(M.so),t.Y36(B.e),t.Y36(d.F0),t.Y36(d.gz),t.Y36(b.ux))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-replace-content"]],hostVars:1,hostBindings:function(i,e){2&i&&t.Ikx("className",e.hostClass)},decls:2,vars:3,consts:[[4,"ngIf"],["mat-dialog-title",""],[1,"dialog-title-box"],[1,"dialog-description"],[1,"options-box"],["appearance","standard","color","accent",1,"options-box__field"],["matInput","",3,"matAutocomplete","ngModel","ngModelChange"],[3,"optionSelected"],["auto","matAutocomplete"],["itemSize","48","minBufferPx","500","maxBufferPx","1000"],[3,"value",4,"cdkVirtualFor","cdkVirtualForOf"],["mat-icon-button","","tippy","Copy",1,"options-box__copy",3,"disabled","click"],[1,"dialog-component-actions"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click"],[3,"value"]],template:function(i,e){1&i&&(t.YNc(0,G,24,9,"ng-container",0),t.ALo(1,"async")),2&i&&t.Q6J("ngIf",t.lcZ(1,1,e.templateVars$))},directives:[x.O5,M.uh,d.lC,T.KE,T.hX,K.Nt,P.ZL,h.Fj,h.JJ,h.On,P.XC,m.N7,m.xd,m.x0,W.lW,$.$,j.Hw,N.ey],pipes:[x.Ov],styles:[".options-box[_ngcontent-%COMP%]{display:flex;align-items:flex-end}.options-box__field[_ngcontent-%COMP%]{width:40%}.options-box__copy[_ngcontent-%COMP%]{margin-left:8px}"]}),r}()}}]);
//# sourceMappingURL=https://sources.2sxc.org/13.03.00/ng-edit/projects_ng-dialogs_src_app_replace-content_replace-content_component_ts.e303a31e2ca289d2.js.map