{"version":3,"file":"default-projects_eav-ui_src_app_shared_components_file-upload-dialog_index_ts.js","mappings":"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","sources":["./projects/eav-ui/src/app/shared/components/file-upload-dialog/file-upload-dialog.component.ts","./projects/eav-ui/src/app/shared/components/file-upload-dialog/file-upload-dialog.component.html","./projects/eav-ui/src/app/shared/components/file-upload-dialog/file-upload-dialog.models.ts","./projects/eav-ui/src/app/shared/components/file-upload-dialog/index.ts","./projects/eav-ui/src/app/shared/directives/drag-and-drop.directive.ts","./projects/eav-ui/src/app/shared/services/getting-started.service.ts","./projects/eav-ui/src/app/shared/services/installer.service.ts"],"sourcesContent":["import { NgClass } from '@angular/common';\r\nimport { ChangeDetectorRef, Component, ElementRef, HostBinding, Inject, input, OnDestroy, OnInit, signal, ViewChild } from '@angular/core';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MAT_DIALOG_DATA, MatDialogModule, MatDialogRef } from '@angular/material/dialog';\r\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { DomSanitizer } from '@angular/platform-browser';\r\nimport { catchError, filter, fromEvent, map, of, switchMap, take, tap } from 'rxjs';\r\nimport { Of, transient } from '../../../../../../core';\r\nimport { DragAndDropDirective } from '../../directives/drag-and-drop.directive';\r\nimport { CrossWindowMessage, InstallPackage, InstallSettings, SpecsForInstaller } from '../../models/installer-models';\r\nimport { SafeHtmlPipe } from '../../pipes/safe-html.pipe';\r\nimport { Context } from '../../services/context';\r\nimport { AppInstallSettingsService } from '../../services/getting-started.service';\r\nimport { InstallerService } from '../../services/installer.service';\r\nimport { BaseComponent } from '../base.component';\r\nimport { FileUploadDialogData, FileUploadMessageTypes, FileUploadResult, UploadTypes } from './file-upload-dialog.models';\r\n\r\n\r\n@Component({\r\n  selector: 'app-file-upload-dialog',\r\n  templateUrl: './file-upload-dialog.component.html',\r\n  styleUrls: ['./file-upload-dialog.component.scss'],\r\n  standalone: true,\r\n  imports: [\r\n    NgClass,\r\n    MatDialogModule,\r\n    MatProgressSpinnerModule,\r\n    SafeHtmlPipe,\r\n    DragAndDropDirective,\r\n    MatButtonModule,\r\n  ]\r\n})\r\nexport class FileUploadDialogComponent extends BaseComponent implements OnInit, OnDestroy {\r\n  @HostBinding('className') hostClass = 'dialog-component';\r\n\r\n  uploadType = input<Of<typeof UploadTypes>>();\r\n\r\n  @ViewChild('installerWindow') installerWindow: ElementRef;\r\n\r\n  uploading = signal(false);\r\n  showAppCatalog = signal(false);\r\n  result = signal<FileUploadResult>(undefined);\r\n  files = signal<File[]>([]);\r\n\r\n  FileUploadMessageTypes = FileUploadMessageTypes;\r\n  UploadTypes = UploadTypes;\r\n\r\n  showProgress: boolean = false;\r\n  currentPackage: InstallPackage;\r\n  remoteInstallerUrl = '';\r\n  ready = false;\r\n  settings: InstallSettings;\r\n\r\n  private installerService = transient(InstallerService);\r\n  private installSettingsService = transient(AppInstallSettingsService);\r\n\r\n  constructor(\r\n    @Inject(MAT_DIALOG_DATA) public dialogData: FileUploadDialogData,\r\n    private dialog: MatDialogRef<FileUploadDialogComponent>,\r\n    private snackBar: MatSnackBar,\r\n    private sanitizer: DomSanitizer,\r\n    private context: Context,\r\n    private changeDetectorRef: ChangeDetectorRef,\r\n  ) {\r\n    super();\r\n\r\n    // TODO: @2dg Check with Daniel subscriptions\r\n     // TODO: Old Code\r\n    //  this.subscriptions.add(\r\n    //   this.files$.subscribe(() => {\r\n    //     console.log('files changed');\r\n    //     if (this.result() !== undefined)\r\n    //       this.result.set(undefined);\r\n    //   }),\r\n    // );\r\n\r\n    // copied from 2sxc-ui app/installer\r\n    this.subscriptions.add(\r\n      this.installSettingsService.settings$.subscribe(settings => {\r\n        this.settings = settings;\r\n        this.remoteInstallerUrl = <string>this.sanitizer.bypassSecurityTrustResourceUrl(settings.remoteUrl);\r\n        this.ready = true;\r\n      })\r\n    );\r\n  }\r\n\r\n  private alreadyProcessing = false;\r\n  // copied from 2sxc-ui app/installer\r\n  // Initial Observable to monitor messages\r\n  private messages$ = fromEvent(window, 'message').pipe(\r\n    // Ensure only one installation is processed.\r\n    filter(() => !this.alreadyProcessing),\r\n    filter((evt: MessageEvent) => evt.origin === \"https://2sxc.org\"),\r\n    // Get data from event.\r\n    map((evt: MessageEvent) => {\r\n      try {\r\n        return JSON.parse(evt.data) as CrossWindowMessage;\r\n      } catch (e) {\r\n        console.error('error procesing message. Message was ' + evt.data, e);\r\n        return void 0;\r\n      }\r\n    }),\r\n    // Check if data is valid and the moduleID matches\r\n    filter(data => data && Number(data.moduleId) === this.context.moduleId),\r\n  );\r\n\r\n  ngOnInit(): void {\r\n\r\n    if (this.dialogData.files != null)\r\n      this.filesDropped(this.dialogData.files);\r\n\r\n    // copied from 2sxc-ui\r\n    this.installSettingsService.loadGettingStarted(false); // Passed as input from 2sxc-ui\r\n\r\n    // copied from 2sxc-ui app/installer\r\n    this.subscriptions.add(this.messages$.pipe(\r\n      // Verify it's for this action\r\n      filter(data => data.action === 'specs'),\r\n      // Send message to iframe\r\n      tap(() => {\r\n        const winFrame = this.installerWindow.nativeElement as HTMLIFrameElement;\r\n        const specsMsg: SpecsForInstaller = {\r\n          action: 'specs',\r\n          data: {\r\n            //currently not used\r\n            installedApps: this.settings.installedApps,//.map(app => ((app as InstalledApp).guid)),\r\n            //currently used to forbid already installed apps\r\n            rules: this.settings.installedApps.map(app => ({ target: 'guid', appGuid: app.guid, mode: 'f', url: '' })),//this.settings.rules,\r\n          },\r\n        };\r\n        const specsJson = JSON.stringify(specsMsg);\r\n        winFrame.contentWindow.postMessage(specsJson, '*');\r\n        console.log('debug: just sent specs message:' + specsJson, specsMsg, winFrame);\r\n      }),\r\n    ).subscribe());\r\n\r\n    // copied from 2sxc-ui app/installer\r\n    // Subscription to listen to 'install' messages\r\n    this.subscriptions.add(this.messages$.pipe(\r\n      filter(data => data.action === 'install'),\r\n      // Get packages from data.\r\n      map(data => Object.values(data.packages)),\r\n      // Show confirm dialog.\r\n      filter(packages => {\r\n        const packagesDisplayNames = packages\r\n          .reduce((t, c) => `${t} - ${c.displayName}\\n`, '');\r\n\r\n        const msg = `Do you want to install these packages?\r\n\r\n${packagesDisplayNames}\r\nThis takes about 10 seconds per package. Don't reload the page while it's installing.`;\r\n        return confirm(msg);\r\n      }),\r\n      // Install the packages one at a time\r\n      switchMap(packages => {\r\n        this.alreadyProcessing = true;\r\n        this.showProgress = true;\r\n        this.changeDetectorRef.detectChanges(); //without this spinner is not shown\r\n        return this.installerService.installPackages(packages, p => this.currentPackage = p);\r\n      }),\r\n      tap(() => {\r\n        this.showProgress = false;\r\n        this.changeDetectorRef.detectChanges(); //without this spinner is not removed (though window reload will remove it anyway) so maybe unnecessary\r\n        alert('Installation complete 👍');\r\n        window.top.location.reload();\r\n      }),\r\n      catchError(error => {\r\n        console.error('Error: ', error);\r\n        this.showProgress = false;\r\n        this.alreadyProcessing = false;\r\n        this.changeDetectorRef.detectChanges(); //without this spinner is not removed\r\n        const errorMsg = `An error occurred: Package ${this.currentPackage.displayName}\r\n\r\n${error.error?.Message ?? error.error?.message ?? ''}\r\n\r\n${error.message}\r\n\r\nPlease try again later or check how to manually install content-templates: https://azing.org/2sxc/r/0O4OymoA`;\r\n        alert(errorMsg);\r\n        return of(error);\r\n      }),\r\n    ).subscribe());\r\n\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  closeDialog(refresh?: boolean): void {\r\n    this.dialog.close(refresh);\r\n  }\r\n\r\n  filesDropped(files: File[]): void {\r\n    this.setFiles(files);\r\n    this.upload();\r\n  }\r\n\r\n  filesChanged(event: Event): void {\r\n    const fileList = (event.target as HTMLInputElement).files;\r\n    const files = Array.from(fileList);\r\n    this.setFiles(files);\r\n  }\r\n\r\n  upload(): void {\r\n    this.uploading.set(true);\r\n    this.subscriptions.add(\r\n      this.dialogData.upload$(this.files()).pipe(take(1)).subscribe({\r\n        next: (result) => {\r\n          this.uploading.set(false);\r\n          this.result.set(result);\r\n        },\r\n        error: () => {\r\n          this.uploading.set(false);\r\n          this.result.set(undefined);\r\n          this.snackBar.open('Upload failed. Please check console for more information', undefined, { duration: 3000 });\r\n        },\r\n      }),\r\n    );\r\n  }\r\n\r\n  toggleShowAppCatalog(): void {\r\n    this.showAppCatalog.set(!this.showAppCatalog());\r\n  }\r\n\r\n  private setFiles(files: File[]): void {\r\n    if (!this.dialogData.multiple) {\r\n      files = files.slice(0, 1);\r\n    }\r\n    this.files.set(files);\r\n  }\r\n}\r\n\r\n","<div class=\"eav-dialog\" appDragAndDrop [allowedFileTypes]=\"dialogData.allowedFileTypes\"\r\n  (filesDropped)=\"filesDropped($event)\">\r\n  <div class=\"eav-dialog-header\">\r\n    <div class=\"eav-dialog-header__title\" [innerHtml]=\"dialogData.title | safeHtml\"></div>\r\n  </div>\r\n  <div class=\"eav-dialog-content\">\r\n    @if (uploading()) {\r\n    <mat-spinner mode=\"indeterminate\" diameter=\"20\" color=\"accent\"></mat-spinner>\r\n    }\r\n    <p [innerHtml]=\"dialogData.description | safeHtml\"></p>\r\n    <div>\r\n      <button mat-raised-button tippy=\"Open file browser\" [disabled]=\"uploading()\" (click)=\"fileInput.click()\">\r\n        @if (!files().length) {\r\n        <div>Select or drop file</div>\r\n        }\r\n        @for (file of files(); track file) {\r\n        <div>{{ file.name }}</div>\r\n        }\r\n      </button>\r\n      <input #fileInput type=\"file\" multiple (change)=\"filesChanged($event)\" class=\"hide\" />\r\n      @if (uploadType() == UploadTypes.App) {\r\n      <button mat-raised-button class=\"eav-app-catalog-button\" [disabled]=\"uploading()\" tippy=\"Open app catalog\"\r\n        (click)=\"toggleShowAppCatalog()\">\r\n        Get recommended Apps from Catalog\r\n      </button>\r\n      }\r\n    </div>\r\n    @if (result()) {\r\n    <div class=\"eav-result-container\">\r\n      @if (result().Success) {\r\n      <div class=\"sxc-message sxc-message-info\">\r\n        Upload succeeded. See the messages below for more information.\r\n      </div>\r\n      }\r\n      @if (!result().Success) {\r\n      <div class=\"sxc-message sxc-message-error\">\r\n        Upload failed. See the messages below for more information.\r\n      </div>\r\n      }\r\n      @for (message of result().Messages; track message) {\r\n      <div class=\"sxc-message\" [ngClass]=\"{\r\n              'sxc-message-warning': message.MessageType === FileUploadMessageTypes.Warning,\r\n              'sxc-message-success': message.MessageType === FileUploadMessageTypes.Success,\r\n              'sxc-message-error': message.MessageType === FileUploadMessageTypes.Error\r\n              }\">\r\n        {{ message.Text }}\r\n      </div>\r\n      }\r\n    </div>\r\n    }\r\n    @if (uploadType() == UploadTypes.App && showAppCatalog()) {\r\n    @if (ready) {\r\n    <iframe #installerWindow class=\"eav-app-catalog-iframe\" [src]=\"remoteInstallerUrl\"></iframe>\r\n    }\r\n    @if (showProgress) {\r\n    <div class=\"eav-progress\">\r\n      <mat-progress-spinner [mode]=\"'indeterminate'\"></mat-progress-spinner>\r\n      <span>Installing {{ currentPackage?.displayName }}..</span>\r\n    </div>\r\n    }\r\n    }\r\n  </div>\r\n  <mat-dialog-actions align=\"end\">\r\n    @if (!result()?.Success) {\r\n    <button mat-raised-button (click)=\"closeDialog()\">Cancel</button>\r\n    <button mat-raised-button color=\"accent\" [disabled]=\"!files().length || uploading() || !!result()\"\r\n      (click)=\"upload()\">\r\n      Upload\r\n    </button>\r\n    }\r\n    @if (result()?.Success) {\r\n    <button mat-raised-button color=\"accent\" (click)=\"closeDialog(true)\">Close</button>\r\n    }\r\n  </mat-dialog-actions>\r\n</div>\r\n","import { Observable } from 'rxjs';\r\nimport { Of } from '../../../../../../core';\r\n\r\nexport interface FileUploadDialogData {\r\n  title?: string;\r\n  description?: string;\r\n  allowedFileTypes?: string;\r\n  files?: File[];\r\n  multiple?: boolean;\r\n  upload$?(files: File[]): Observable<FileUploadResult>;\r\n}\r\n\r\nexport interface FileUploadResult {\r\n  Messages: FileUploadResultMessage[];\r\n  Success: boolean;\r\n}\r\n\r\nexport interface FileUploadResultMessage {\r\n  MessageType: Of<typeof FileUploadMessageTypes>;\r\n  Text: string;\r\n}\r\n\r\nexport const FileUploadMessageTypes = {\r\n  Warning: 0,\r\n  Success: 1,\r\n  Error: 2,\r\n} as const /* the as const ensures that the keys/values can be strictly checked */;\r\n\r\nexport const UploadTypes = {\r\n  App: 0,\r\n  AppPart: 1,\r\n  ContentType: 2,\r\n  ContentItem: 3,\r\n  Query: 4,\r\n  View: 5,\r\n} as const /* the as const ensures that the keys/values can be strictly checked */;\r\n","export * from './file-upload-dialog.component';\r\nexport * from './file-upload-dialog.models';\r\n","import { Directive, ElementRef, HostListener, input, NgZone, OnDestroy, OnInit, output, signal } from '@angular/core';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { fromEvent } from 'rxjs';\r\nimport { BaseDirective } from './base.directive';\r\n\r\n@Directive({ selector: '[appDragAndDrop]', standalone: true })\r\nexport class DragAndDropDirective extends BaseDirective implements OnInit, OnDestroy {\r\n  markStyle = input<'outline' | 'fill' | 'shadow'>('outline');\r\n  /** Comma separated file types, e.g. 'txt,doc,docx' */\r\n  allowedFileTypes = input<string>('');\r\n  protected filesDropped = output<File[]>();\r\n\r\n  private element: HTMLElement;\r\n  private dropAreaClass = 'eav-droparea';\r\n  private markStyleClass = signal<string>('');\r\n  private dragClass = 'eav-dragover';\r\n  private timeouts: number[] = [];\r\n\r\n  constructor(elementRef: ElementRef, private zone: NgZone, private snackBar: MatSnackBar) {\r\n    super();\r\n    this.element = elementRef.nativeElement;\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.markStyleClass.set(`eav-droparea-${this.markStyle()}`);\r\n    this.element.classList.add(this.dropAreaClass, this.markStyleClass());\r\n    this.zone.runOutsideAngular(() => {\r\n      this.subscriptions.add(\r\n        fromEvent<DragEvent>(this.element, 'dragover').subscribe(event => {\r\n          event.preventDefault();\r\n          event.stopPropagation();\r\n          this.clearTimeouts();\r\n          this.element.classList.add(this.dragClass);\r\n        })\r\n      );\r\n      this.subscriptions.add(\r\n        fromEvent<DragEvent>(this.element, 'dragleave').subscribe(event => {\r\n          event.preventDefault();\r\n          event.stopPropagation();\r\n          this.timeouts.push(\r\n            window.setTimeout(() => { this.element.classList.remove(this.dragClass); }, 50)\r\n          );\r\n        })\r\n      );\r\n    });\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.clearTimeouts();\r\n    this.element.classList.remove(this.dropAreaClass, this.markStyleClass(), this.dragClass);\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  @HostListener('drop', ['$event'])\r\n  onDrop(event: DragEvent) {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n    this.clearTimeouts();\r\n    this.element.classList.remove(this.dragClass);\r\n    const fileList = event.dataTransfer.files;\r\n    let files = Array.from(fileList);\r\n    files = this.filterTypes(files, this.allowedFileTypes());\r\n    if (files.length > 0) {\r\n      this.filesDropped.emit(files);\r\n    }\r\n  }\r\n\r\n  private clearTimeouts() {\r\n    for (const timeout of this.timeouts) {\r\n      clearTimeout(timeout);\r\n    }\r\n    this.timeouts = [];\r\n  }\r\n\r\n  private filterTypes(files: File[], allowedFileTypes: string) {\r\n    if (allowedFileTypes === '') { return files; }\r\n\r\n    const allowedTypes = allowedFileTypes.split(',').map(type => type.toLocaleLowerCase());\r\n    const filtered = files.filter(file => {\r\n      const extIndex = file.name.lastIndexOf('.');\r\n      if (extIndex <= 0) { return false; }\r\n      const ext = file.name.substring(extIndex + 1).toLocaleLowerCase();\r\n      const allowed = allowedTypes.includes(ext);\r\n      return allowed;\r\n    });\r\n\r\n    if (files.length !== filtered.length) {\r\n      const allowedTypesString = this.allowedFileTypes().replace(/\\,/g, ', ');\r\n      const message = filtered.length\r\n        ? 'Some files were filtered out. This drop location only accepts file types: ' + allowedTypesString\r\n        : 'This drop location only accepts file types: ' + allowedTypesString;\r\n      this.snackBar.open(message, null, { duration: 5000 });\r\n    }\r\n    return filtered;\r\n  }\r\n}\r\n","\r\nimport { startWith, map, tap } from 'rxjs/operators';\r\nimport { Injectable } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Subject, Observable } from 'rxjs';\r\nimport { InstallSettings } from '../models/installer-models';\r\n\r\n// copied from 2sxc-ui app/installer\r\n@Injectable()\r\nexport class AppInstallSettingsService {\r\n\r\n  private installSettingsSubject: Subject<InstallSettings> = new Subject<InstallSettings>();\r\n  settings$: Observable<InstallSettings> = this.installSettingsSubject.asObservable();\r\n\r\n  constructor(private http: HttpClient) {\r\n    const ready$ = this.settings$.pipe(\r\n      map(() => true),\r\n      startWith(false));\r\n\r\n    ready$.subscribe();\r\n  }\r\n\r\n  public loadGettingStarted(isContentApp: boolean): void {\r\n    this.http.get<InstallSettings>(`sys/install/InstallSettings?isContentApp=${isContentApp}`)\r\n      .subscribe(json => this.installSettingsSubject.next(json));\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { Observable, of, switchMap } from 'rxjs';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { InstallPackage } from '../models/installer-models';\r\n\r\n// copied from 2sxc-ui app/installer\r\n@Injectable()\r\nexport class InstallerService {\r\n\r\n  constructor(private http: HttpClient) { }\r\n\r\n  installPackages(packages: InstallPackage[], step: (p: InstallPackage) => void): Observable<any> {\r\n    return packages.reduce(\r\n      (t: Observable<Response>, c) => t.pipe(\r\n        switchMap(() => {\r\n          if (!c.url) return of(true);\r\n          step(c);\r\n          return <Observable<any>>this.http.post(`sys/install/RemotePackage?packageUrl=${c.url}`, {});\r\n        })),\r\n      of(true));\r\n  }\r\n}\r\n"],"names":["NgClass","ChangeDetectorRef","ElementRef","input","signal","MatButtonModule","MAT_DIALOG_DATA","MatDialogModule","MatDialogRef","MatProgressSpinnerModule","MatSnackBar","DomSanitizer","catchError","filter","fromEvent","map","of","switchMap","take","tap","transient","DragAndDropDirective","SafeHtmlPipe","Context","AppInstallSettingsService","InstallerService","BaseComponent","FileUploadMessageTypes","UploadTypes","i0","ɵɵelement","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵadvance","ɵɵtextInterpolate","file_r3","name","ɵɵlistener","FileUploadDialogComponent_Conditional_15_Template_button_click_0_listener","ɵɵrestoreView","_r4","ctx_r4","ɵɵnextContext","ɵɵresetView","toggleShowAppCatalog","ɵɵproperty","uploading","ɵɵpureFunction3","_c1","message_r6","MessageType","Warning","Success","Error","ɵɵtextInterpolate1","Text","ɵɵtemplate","FileUploadDialogComponent_Conditional_16_Conditional_1_Template","FileUploadDialogComponent_Conditional_16_Conditional_2_Template","ɵɵrepeaterCreate","FileUploadDialogComponent_Conditional_16_For_4_Template","ɵɵrepeaterTrackByIdentity","ɵɵconditional","result","ɵɵrepeater","Messages","remoteInstallerUrl","ɵɵsanitizeResourceUrl","currentPackage","displayName","FileUploadDialogComponent_Conditional_17_Conditional_0_Template","FileUploadDialogComponent_Conditional_17_Conditional_1_Template","ready","showProgress","FileUploadDialogComponent_Conditional_19_Template_button_click_0_listener","_r7","closeDialog","FileUploadDialogComponent_Conditional_19_Template_button_click_2_listener","upload","files","length","FileUploadDialogComponent_Conditional_20_Template_button_click_0_listener","_r8","FileUploadDialogComponent","constructor","dialogData","dialog","snackBar","sanitizer","context","changeDetectorRef","hostClass","uploadType","showAppCatalog","undefined","installerService","installSettingsService","alreadyProcessing","messages$","window","pipe","evt","origin","JSON","parse","data","e","console","error","Number","moduleId","subscriptions","add","settings$","subscribe","settings","bypassSecurityTrustResourceUrl","remoteUrl","ngOnInit","filesDropped","loadGettingStarted","action","winFrame","installerWindow","nativeElement","specsMsg","installedApps","rules","app","target","appGuid","guid","mode","url","specsJson","stringify","contentWindow","postMessage","log","Object","values","packages","packagesDisplayNames","reduce","t","c","msg","confirm","detectChanges","installPackages","p","alert","top","location","reload","errorMsg","Message","message","ngOnDestroy","refresh","close","setFiles","filesChanged","event","fileList","Array","from","set","upload$","next","open","duration","multiple","slice","ɵɵdirectiveInject","i1","i2","i3","i4","selectors","viewQuery","FileUploadDialogComponent_Query","rf","ctx","ɵɵhostProperty","FileUploadDialogComponent_Template_div_filesDropped_0_listener","$event","_r1","FileUploadDialogComponent_Conditional_5_Template","FileUploadDialogComponent_Template_button_click_9_listener","fileInput_r2","ɵɵreference","click","FileUploadDialogComponent_Conditional_10_Template","FileUploadDialogComponent_For_12_Template","FileUploadDialogComponent_Template_input_change_13_listener","FileUploadDialogComponent_Conditional_15_Template","FileUploadDialogComponent_Conditional_16_Template","FileUploadDialogComponent_Conditional_17_Template","FileUploadDialogComponent_Conditional_19_Template","FileUploadDialogComponent_Conditional_20_Template","allowedFileTypes","ɵɵpipeBind1","title","ɵɵsanitizeHtml","description","App","tmp_11_0","tmp_12_0","MatDialogActions","i5","MatProgressSpinner","i6","MatButton","styles","AppPart","ContentType","ContentItem","Query","View","NgZone","output","BaseDirective","elementRef","zone","markStyle","dropAreaClass","markStyleClass","dragClass","timeouts","element","classList","runOutsideAngular","preventDefault","stopPropagation","clearTimeouts","push","setTimeout","remove","onDrop","dataTransfer","filterTypes","emit","timeout","clearTimeout","allowedTypes","split","type","toLocaleLowerCase","filtered","file","extIndex","lastIndexOf","ext","substring","allowed","includes","allowedTypesString","replace","hostBindings","DragAndDropDirective_HostBindings","DragAndDropDirective_drop_HostBindingHandler","startWith","HttpClient","Subject","http","installSettingsSubject","asObservable","ready$","isContentApp","get","json","ɵɵinject","factory","ɵfac","step","post"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}