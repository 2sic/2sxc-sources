"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_replace-content_replace-content_component_ts-node_modules_rxjs_dist_e-178ebb"],{4513:(T,m,n)=>{n.r(m),n.d(m,{ReplaceContentComponent:()=>W});var c=n(9771),p=n(7941),E=n(2159),r=n(5797),O=n(9999),g=n(271),C=n(9669),M=n(3216),D=n(334),f=n(316),d=n(3840),P=n(4175),i=n(5060),s=n(2275),_=n(4456),h=n(7984),R=n(5944),j=n(5437),U=n(8471),t=n(7580),L=n(3347);function K(u,B){if(1&u&&(t.j41(0,"mat-option",15),t.EFF(1),t.k0s()),2&u){const e=B.$implicit;t.Y8G("value",e),t.R7$(),t.JRh(e)}}function y(u,B){if(1&u){const e=t.RV6();t.j41(0,"div",1)(1,"div",2)(2,"div",3),t.EFF(3),t.k0s()(),t.j41(4,"div",4),t.nrm(5,"router-outlet"),t.j41(6,"p"),t.EFF(7),t.k0s(),t.j41(8,"div",5)(9,"mat-form-field",6)(10,"mat-label"),t.EFF(11,"Choose item"),t.k0s(),t.j41(12,"input",7),t.bIt("ngModelChange",function(o){t.eBV(e);const l=t.XpG();return t.Njj(l.setFilter(o))}),t.k0s(),t.j41(13,"mat-autocomplete",8,0),t.bIt("optionSelected",function(o){t.eBV(e);const l=t.XpG();return t.Njj(l.select(o))}),t.j41(15,"cdk-virtual-scroll-viewport",9),t.DNE(16,K,2,2,"mat-option",10),t.k0s()()(),t.j41(17,"button",11),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.copySelected())}),t.j41(18,"mat-icon"),t.EFF(19,"file_copy"),t.k0s()()()(),t.j41(20,"mat-dialog-actions",12)(21,"button",13),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.closeDialog())}),t.EFF(22,"Cancel"),t.k0s(),t.j41(23,"button",14),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.save())}),t.EFF(24,"Save"),t.k0s()()()}if(2&u){const e=B,a=t.sdS(14);t.R7$(3),t.JRh(e.isAddMode?"Add Existing Item":"Replace Content Item"),t.R7$(4),t.SpI("",e.isAddMode?"Select a content-item to add to this list.":"By replacing a content-item you can make other content appear in the slot of the original content."," "),t.R7$(5),t.Y8G("matAutocomplete",a)("ngModel",e.filterText),t.R7$(),t.Y8G("hideSingleSelectionIndicator",!0),t.R7$(2),t.xc7("height",e.filteredOptions.length<6?48*e.filteredOptions.length:240,"px"),t.R7$(),t.Y8G("cdkVirtualForOf",e.filteredOptions),t.R7$(),t.Y8G("disabled",!e.isMatch),t.R7$(6),t.Y8G("disabled",!e.isMatch)}}let W=(()=>{class u{#o;#s;#l;#a;#t;#n;#r;#i;#e;constructor(e,a){this.dialogRef=e,this.snackBar=a,this.hostClass="dialog-component",this.#i=(0,j.d)(C.y),this.#e=(0,j.d)(U.c)}ngOnInit(){const e=this.#e.snapshot;this.#o=e.paramMap.get("guid"),this.#s=e.paramMap.get("part"),this.#l=parseInt(e.paramMap.get("index"),10),this.#a=!!e.queryParamMap.get("add"),this.#t=new r.t(""),this.#n=new r.t([]);const a=(0,O.z)([this.#t,this.#n]).pipe((0,g.T)(([o,l])=>l.filter(v=>v.label.toLocaleLowerCase().includes(o.toLocaleLowerCase())).map(v=>v.label)));this.viewModel$=(0,O.z)([this.#t,a]).pipe((0,g.T)(([o,l])=>({filterText:o,filteredOptions:l,isAddMode:this.#a,isMatch:l.includes(o)}))),this.fetchConfig(!1,null),this.#e.doOnDialogClosed(()=>{const l=this.#e.router.getCurrentNavigation().extras?.state,v=l?.[Object.keys(l)[0]];this.fetchConfig(!0,v)})}ngOnDestroy(){this.#t.complete(),this.#n.complete()}closeDialog(){this.dialogRef.close()}setFilter(e){this.#t.next(e)}select(e){this.#t.next(e.option.value)}copySelected(){const e=this.buildContentGroup(),a={items:[D.c.copy(this.#r,e.id)]},o=(0,M.s)(a);this.#e.navRelative([`edit/${o}`])}save(){this.snackBar.open("Saving...");const e=this.buildContentGroup();this.#i.saveItem(e).subscribe(()=>{this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()})}fetchConfig(e,a){const o=this.buildContentGroup();this.#i.getItems(o).subscribe(l=>{const v=Object.entries(l.Items).map(([I,A])=>({id:parseInt(I,10),label:`${A} (${I})`}));if(this.#n.next(v),!o.add&&!e||null!=a){const I=e?a:l.SelectedId,A=this.#n.value.find(x=>x.id===I)?.label||"";this.#t.next(A)}this.#r=l.ContentTypeName})}buildContentGroup(){return{id:this.#n.value.find(o=>o.label===this.#t.value)?.id??null,guid:this.#o,part:this.#s,index:this.#l,add:this.#a}}static#c=this.\u0275fac=function(a){return new(a||u)(t.rXU(p.CP),t.rXU(L.UG))};static#d=this.\u0275cmp=t.VBU({type:u,selectors:[["app-replace-content"]],hostVars:1,hostBindings:function(a,o){2&a&&t.Mr5("className",o.hostClass)},standalone:!0,features:[t.aNF],decls:2,vars:3,consts:[["auto","matAutocomplete"],[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],[1,"eav-options-box"],["color","accent",1,"eav-mat-form-field"],["matInput","",3,"ngModelChange","matAutocomplete","ngModel"],[3,"optionSelected","hideSingleSelectionIndicator"],["itemSize","48","minBufferPx","500","maxBufferPx","1000"],[3,"value",4,"cdkVirtualFor","cdkVirtualForOf"],["mat-icon-button","","tippy","Copy",3,"click","disabled"],["align","end"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"click","disabled"],[3,"value"]],template:function(a,o){if(1&a&&(t.DNE(0,y,25,10,"div",1),t.nI1(1,"async")),2&a){let l;t.vxM(0,(l=t.bMT(1,1,o.viewModel$))?0:-1,l)}},dependencies:[E.n3,R.RG,R.rl,R.nJ,h.fS,h.fg,c.jL,c.$3,i.wT,c.pN,_.YN,_.me,_.BC,_.vS,s.d6,s.yg,s.E$,i.Sy,P.Hl,P.$z,P.iY,d.m_,d.An,p.E7,f.Jj],styles:[".eav-options-box[_ngcontent-%COMP%]{display:flex;align-items:flex-end}"]})}return u})()},8471:(T,m,n)=>{n.d(m,{c:()=>f});var c=n(2159),p=n(1567),E=n(3037),r=n(271),O=n(5057),g=n(5506),C=n(4979),M=n(7580);const D={enabled:!1,name:"DialogRoutingService",specs:{doOnDialogClosed:!0}};let f=(()=>{class d extends C.V{constructor(i,s){super(),this.router=i,this.route=s,this.log=new g.B(D)}ngOnDestroy(){super.destroy()}get snapshot(){return this.route.snapshot}get url(){return this.router.url}state(){return this.router.getCurrentNavigation().extras?.state}doOnDialogClosed(i){const s=this.log.fnIf("doOnDialogClosed");this.subscriptions.add(this.childDialogClosed$().subscribe(()=>{i()})),s.end()}navPath(i,s){return this.router.navigate([i],s)}navRelative(i,s){return this.router.navigate(i,{...s,relativeTo:this.route})}navParentFirstChild(i,s){return this.router.navigate(i,{...s,relativeTo:this.route.parent.firstChild})}childDialogClosed$(){return this.router.events.pipe((0,p.p)(i=>i instanceof c.wF),(0,E.Z)(!!this.route.snapshot.firstChild),(0,r.T)(()=>!!this.route.snapshot.firstChild),(0,O.J)(),(0,p.p)(([i,s])=>i&&!s))}static#o=this.\u0275fac=function(s){return new(s||d)(M.KVO(c.Ix),M.KVO(c.nX))};static#s=this.\u0275prov=M.jDH({token:d,factory:d.\u0275fac})}return d})()},4979:(T,m,n)=>{n.d(m,{V:()=>E});var c=n(7092),p=n(7580);let E=(()=>{class r{constructor(){this.subscriptions=new c.yU}ngOnDestroy(){this.destroy()}destroy(){this.subscriptions.unsubscribe()}static#o=this.\u0275fac=function(C){return new(C||r)};static#s=this.\u0275prov=p.jDH({token:r,factory:r.\u0275fac})}return r})()},591:(T,m,n)=>{n.d(m,{c:()=>i});var c=n(8473),p=n(3513),E=n(4334),r=n(819),O=n(1687),g=n(4318),M=n(7378),D=n(1365),f=n(2645);function d(s,_){return _?h=>(0,p.x)(_.pipe((0,E.s)(1),function C(){return(0,r.N)((s,_)=>{s.subscribe((0,O._)(_,g.l))})}()),h.pipe(d(s))):(0,D.Z)((h,R)=>(0,f.Tg)(s(h,R)).pipe((0,E.s)(1),(0,M.u)(h)))}var P=n(4581);function i(s,_=c.E){const h=(0,P.O)(s,_);return d(()=>h)}}}]);
//# sourceMappingURL=https://sources.2sxc.org/18.00.02/dist/ng-edit/projects_eav-ui_src_app_replace-content_replace-content_component_ts-node_modules_rxjs_dist_e-178ebb.15bc4adb5484d780.js.map