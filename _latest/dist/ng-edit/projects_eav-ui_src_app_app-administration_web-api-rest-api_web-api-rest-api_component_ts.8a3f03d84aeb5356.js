"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_app-administration_web-api-rest-api_web-api-rest-api_component_ts"],{9262:(M,u,i)=>{i.r(u),i.d(u,{WebApiRestApiComponent:()=>l});var e=i(1659),o=i(4456),I=i(4175),P=i(3777),E=i(3840),g=i(5175),T=i(2159),m=i(2938),O=i(9996),C=i(4435),f=i(7037),_=i(8471),v=i(4950),t=i(4646);function p(r,h){if(1&r&&(e.j41(0,"mat-option",3),e.EFF(1),e.k0s()),2&r){const n=h.$implicit;e.Y8G("value",n.path),e.R7$(),e.SpI(" ",n.name," ")}}function s(r,h){if(1&r&&e.Z7z(0,p,2,2,"mat-option",3,e.fX1),2&r){const n=e.XpG();e.Dyx(n.webApisTypes().sort())}}const a={all:!1,webApisTypes:!0,syncUrl:!0};let l=(()=>{class r{#e;#t;#s;constructor(){this.log=(0,C.Tq)({WebApiRestApiComponent:r},a),this.#e=(0,m.d)(O.F),this.#t=(0,m.d)(_.c),this.#s=(0,e.WQX)(o.ok),this.#a=this.#e.getWebApisSig(),this.webApisTypes=(0,e.EWP)(()=>this.#a()),this.webApiTypeForm=this.#s.group({webApiType:[""]}),(0,e.QZP)(()=>{const n=this.log.fnIf("syncUrl"),d=this.webApisTypes();if(0===d.length)return n.end();const c=this.#t.urlSegments.at(-1);var D=c.replace(/%252F/g,"/");const A=d.find(U=>U.path===D);n.a("status:",{webApis:d,webApi:A,urlPath:c,encodedUrlPath:D}),A&&this.webApiTypeForm.get("webApiType").setValue(A.path),n.end()})}#a;openRestApi(n){n&&this.#t.navRelative([encodeURIComponent(n)])}static{this.\u0275fac=function(d){return new(d||r)}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-web-api-rest-api"]],decls:7,vars:2,consts:[[3,"formGroup"],["color","accent",1,"eav-mat-form-field"],["formControlName","webApiType",3,"valueChange"],[3,"value"]],template:function(d,c){1&d&&(e.j41(0,"form",0)(1,"mat-form-field",1)(2,"mat-label"),e.EFF(3,"Endpoint"),e.k0s(),e.j41(4,"mat-select",2),e.bIt("valueChange",function(A){return c.openRestApi(A)}),e.DNE(5,s,2,0),e.k0s()()(),e.nrm(6,"router-outlet")),2&d&&(e.Y8G("formGroup",c.webApiTypeForm),e.R7$(5),e.vxM(c.webApisTypes()?5:-1))},dependencies:[g.Ve,v.rl,v.nJ,g.VO,t.wT,I.Hl,P.Hu,E.m_,o.X1,o.qT,o.BC,o.cb,o.j4,o.JD,T.n3,f.p],encapsulation:2})}}return r})()},9996:(M,u,i)=>{i.d(u,{F:()=>f});var e=i(1659),o=i(271),I=i(6474);const E="admin/AppFiles/asset",m="admin/ApiExplorer/AppApiFiles";let f=(()=>{class _ extends I.D{get(t,p,s){return this.getHttpApiUrl(E,{params:{appId:this.appId,global:p,...this.templateIdOrPath(t,p,s)}}).pipe((0,o.T)(a=>{if("auto"===a.Type.toLocaleLowerCase())switch(a.Extension.toLocaleLowerCase()){case".cs":case".cshtml":a.Type="Razor";break;case".html":case".css":case".js":a.Type="Token"}return a}))}save(t,p,s,a){return this.http.post(this.apiUrl(E),s,{params:{appId:this.appId,global:p,...this.templateIdOrPath(t,p,a)}})}getAll(t){return this.getHttpApiUrl("admin/AppFiles/AppFiles",{params:{appId:this.appId,...t&&{mask:t}}}).pipe((0,o.T)(({Files:p})=>(p.forEach(s=>{s.Shared??=!1}),p)))}getWebApis(){return this.getHttpApiUrl(m,{params:{appId:this.appId}}).pipe((0,o.T)(({files:t})=>(t.forEach(p=>{p.isShared??=!1,p.isCompiled??=!1}),t))).pipe((0,o.T)(t=>t.map(s=>{const a=s.path.lastIndexOf("/"),l=s.path.lastIndexOf("."),r=s.path.substring(0,a),h=s.path.substring(a+1,l);return{path:s.path,folder:r,name:h,isShared:s.isShared,endpointPath:s.endpointPath,isCompiled:s.isCompiled,edition:s.edition}})))}getWebApisSig(){const t=this.getSignal(m,{params:{appId:this.appId}});return(0,e.EWP)(()=>{const s=t()?.files;return s?(s.forEach(a=>{a.isShared??=!1,a.isCompiled??=!1}),s.map(a=>{const l=a.path.lastIndexOf("/"),r=a.path.lastIndexOf("."),h=a.path.substring(0,l),n=a.path.substring(l+1,r);return{path:a.path,folder:h,name:n,isShared:a.isShared,endpointPath:a.endpointPath,isCompiled:a.isCompiled,edition:a.edition}})):[]})}getWebApiDetails(t){return this.getHttpApiUrl("admin/ApiExplorer/inspect",{params:{appId:this.appId,zoneId:this.zoneId,path:t}})}getPredefinedTemplates(t,p){return this.getHttpApiUrl("admin/AppFiles/GetTemplates",{params:{...t&&{purpose:t},...p&&{type:p}}})}getPreview(t,p,s){return this.getHttpApiUrl("admin/AppFiles/preview",{params:{appId:this.appId,path:t,templateKey:s,global:p}})}create(t,p,s){return this.http.post(this.apiUrl("admin/AppFiles/create"),{},{params:{appId:this.appId,global:p,purpose:"auto",path:t,templateKey:s}})}templateIdOrPath(t,p,s){if(/^[0-9]*$/g.test(t)){const a=s.find(l=>l.EntityId?.toString()===t&&l.IsShared===p)?.Path;return{templateId:t,...null!=a&&{path:a}}}return{path:t}}static{this.\u0275fac=(()=>{let t;return function(s){return(t||(t=e.xGo(_)))(s||_)}})()}static{this.\u0275prov=e.jDH({token:_,factory:_.\u0275fac})}}return _})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/19.03.03/dist/ng-edit/projects_eav-ui_src_app_app-administration_web-api-rest-api_web-api-rest-api_component_ts.8a3f03d84aeb5356.js.map