"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["default-projects_eav-ui_src_app_permissions_index_ts","projects_eav-ui_src_app_permissions_permissions_module_ts","projects_eav-ui_src_app_permissions_permissions_component_ts"],{1092:(P,p,t)=>{t.d(p,{g:()=>d});var i=t(400),s=t(2611),a=t(1699),g=t(4860),h=t(6232);let d=(()=>{var n;class m{constructor(o,_,l){this.http=o,this.context=_,this.dnnContext=l}create(o,_){return this.http.post(`app/auto/data/${o}`,_,{params:{appId:this.context.appId,zoneId:this.context.zoneId}})}update(o,_,l){return this.http.post(`app/auto/data/${o}/${_}`,l,{params:{appId:this.context.appId,zoneId:this.context.zoneId}})}delete(o,_,l){return this.http.delete(this.dnnContext.$2sxc.http.apiUrl(i.Uo+"delete"),{params:{contentType:o,id:_.toString(),appId:this.context.appId.toString(),force:l.toString()}})}}return(n=m).\u0275fac=function(o){return new(o||n)(a.LFG(g.eN),a.LFG(s._),a.LFG(h._y))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac}),m})()},8657:(P,p,t)=>{t.d(p,{i:()=>s});var i=t(196);let s=(()=>{class g{static getUrl(d,n,m){return`permissions/${d}/${n}/${m}`}static getUrlApp(d){return this.getUrl(i.Zy.metadata.app.targetType,i.Zy.metadata.app.keyType,d.toString())}static getUrlAttribute(d){return this.getUrl(i.Zy.metadata.attribute.targetType,i.Zy.metadata.attribute.keyType,d.toString())}static getUrlContentType(d){return this.getUrlEntity(d)}static getUrlEntity(d){return this.getUrl(i.Zy.metadata.entity.targetType,i.Zy.metadata.entity.keyType,d)}static getUrlLanguage(d){return this.getUrl(i.Zy.metadata.language.targetType,i.Zy.metadata.language.keyType,d)}}return g.route={path:"permissions/:targetType/:keyType/:key",loadChildren:()=>t.e("projects_eav-ui_src_app_permissions_permissions_module_ts").then(t.bind(t,806)).then(h=>h.PermissionsModule),data:{title:"Permissions"}},g})()},8088:(P,p,t)=>{t.d(p,{Do:()=>d.D,iK:()=>i.i,qQ:()=>n.q});var i=t(8657),d=(t(7641),t(3100),t(8660),t(806),t(7477)),n=t(7782)},7641:(P,p,t)=>{t.d(p,{g:()=>s});var i=t(1670);const s={name:"SET_PERMISSIONS_DIALOG",initContext:!0,panelSize:"large",panelClass:null,getComponent:()=>(0,i.Z)(function*(){const{PermissionsComponent:a}=yield t.e("projects_eav-ui_src_app_permissions_permissions_component_ts").then(t.bind(t,8660));return a})()}},3100:(P,p,t)=>{t.d(p,{T:()=>n});var i=t(91),s=t(8226),a=t(891),g=t(7641),h=t(1699);const d=[{path:"",component:a.r,data:{dialog:g.g},children:[{matcher:s.eP,loadChildren:()=>Promise.all([t.e("default-projects_eav-ui_src_app_create-file-dialog_index_ts"),t.e("default-node_modules_angular_material_fesm2022_list_mjs"),t.e("default-node_modules_angular_material_fesm2022_autocomplete_mjs"),t.e("default-node_modules_angular_material_fesm2022_card_mjs"),t.e("default-projects_eav-ui_src_app_edit_edit_module_ts"),t.e("default-node_modules_angular_cdk_fesm2022_drag-drop_mjs"),t.e("default-node_modules_angular_material_fesm2022_menu_mjs"),t.e("default-node_modules_angular_material_fesm2022_slide-toggle_mjs"),t.e("common"),t.e("projects_eav-ui_src_app_features_features_module_ts-projects_eav-ui_src_app_shared_components-41d340")]).then(t.bind(t,4084)).then(m=>m.EditModule)},{matcher:s.lZ,loadChildren:()=>t.e("projects_eav-ui_src_app_edit_refresh-edit_module_ts").then(t.bind(t,9703)).then(m=>m.RefreshEditModule)}]}];let n=(()=>{var m;class e{}return(m=e).\u0275fac=function(_){return new(_||m)},m.\u0275mod=h.oAB({type:m}),m.\u0275inj=h.cJS({imports:[i.Bz.forChild(d),i.Bz]}),e})()},8660:(P,p,t)=>{t.r(p),t.d(p,{PermissionsComponent:()=>B});var i=t(8071),s=t(3839),a=t(9736),g=t(6041),h=t(5253),d=t(6433),n=t(196),m=t(2957),e=t(1699),o=t(9498),_=t(6515),l=t(257);let u=(()=>{var E;class f{agInit(r){this.params=r}refresh(r){return!0}deletePermission(){this.params.onDelete(this.params.data)}}return(E=f).\u0275fac=function(r){return new(r||E)},E.\u0275cmp=e.Xpm({type:E,selectors:[["app-permissions-actions"]],decls:4,vars:0,consts:[[1,"actions-component"],["matRipple","","tippy","Delete",1,"eav-grid-action-button","highlight",3,"click"]],template:function(r,c){1&r&&(e.TgZ(0,"div",0)(1,"div",1),e.NdJ("click",function(){return c.deletePermission()}),e.TgZ(2,"mat-icon"),e._uU(3,"delete"),e.qZA()()())},dependencies:[o.$,_.Hw,l.wG]}),f})();var C=t(7782),y=t(91),M=t(6861),D=t(9409),T=t(6575),I=t(895),A=t(8621);function R(E,f){if(1&E){const O=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"div",3),e._uU(3,"Permissions"),e.qZA(),e.TgZ(4,"button",4),e.NdJ("click",function(){e.CHM(O);const c=e.oxw();return e.KtG(c.closeDialog())}),e.TgZ(5,"mat-icon"),e._uU(6,"close"),e.qZA()()(),e.TgZ(7,"div",5),e._UZ(8,"router-outlet"),e.TgZ(9,"div",6),e._UZ(10,"ag-grid-angular",7),e.qZA(),e.TgZ(11,"mat-dialog-actions",8)(12,"button",9),e.NdJ("click",function(){e.CHM(O);const c=e.oxw();return e.KtG(c.editPermission(null))}),e.TgZ(13,"mat-icon"),e._uU(14,"add"),e.qZA()()()()()}if(2&E){const O=f.ngIf,r=e.oxw();e.xp6(10),e.Q6J("rowData",O.permissions)("gridOptions",r.gridOptions)}}let B=(()=>{var E;class f extends g.H{constructor(r,c,v,U,L){super(r,c),this.router=r,this.route=c,this.dialogRef=v,this.permissionsService=U,this.snackBar=L,this.permissions$=new i.X(void 0),this.gridOptions=this.buildGridOptions(),this.targetType=parseInt(this.route.snapshot.paramMap.get("targetType"),10),this.keyType=this.route.snapshot.paramMap.get("keyType"),this.key=this.route.snapshot.paramMap.get("key"),this.prefills={[n.Zy.metadata.language.targetType]:{PermissionType:"language"}}}ngOnInit(){this.fetchPermissions(),this.subscription.add(this.refreshOnChildClosedShallow().subscribe(()=>{this.fetchPermissions()})),this.viewModel$=(0,s.a)([this.permissions$]).pipe((0,a.U)(([r])=>({permissions:r})))}ngOnDestroy(){this.permissions$.complete(),super.ngOnDestroy()}closeDialog(){this.dialogRef.close()}fetchPermissions(){this.permissionsService.getAll(this.targetType,this.keyType,this.key).subscribe(r=>{this.permissions$.next(r)})}editPermission(r){let c;c=null==r?{items:[{ContentTypeName:n.Zy.contentTypes.permissions,For:{Target:Object.values(n.Zy.metadata).find(U=>U.targetType===this.targetType)?.target??this.targetType.toString(),TargetType:this.targetType,...this.keyType===n.Zy.keyTypes.guid&&{Guid:this.key},...this.keyType===n.Zy.keyTypes.number&&{Number:parseInt(this.key,10)},...this.keyType===n.Zy.keyTypes.string&&{String:this.key}},...this.prefills[this.targetType]&&{Prefill:this.prefills[this.targetType]}}]}:{items:[{EntityId:r.Id}]};const v=(0,m.f)(c);this.router.navigate([`edit/${v}`],{relativeTo:this.route})}deletePermission(r){confirm(`Delete '${r.Title}' (${r.Id})?`)&&(this.snackBar.open("Deleting..."),this.permissionsService.delete(r.Id).subscribe(()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchPermissions()}))}buildGridOptions(){return{...d.f,columnDefs:[{headerName:"ID",field:"Id",width:70,headerClass:"dense",cellClass:"id-action no-padding no-outline".split(" "),sortable:!0,filter:"agNumberColumnFilter",valueGetter:c=>c.data.Id,cellRenderer:h.m,cellRendererParams:{tooltipGetter:v=>`ID: ${v.Id}\nGUID: ${v.Guid}`}},{field:"Name",flex:2,minWidth:250,cellClass:"primary-action highlight".split(" "),sortable:!0,sort:"asc",filter:"agTextColumnFilter",onCellClicked:c=>{this.editPermission(c.data)},valueGetter:c=>c.data.Title},{field:"Identity",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:c=>c.data.Identity},{field:"Condition",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:c=>c.data.Condition},{field:"Grant",width:70,headerClass:"dense",cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:c=>c.data.Grant},{width:42,cellClass:"secondary-action no-padding".split(" "),pinned:"right",cellRenderer:u,cellRendererParams:(()=>({onDelete:v=>this.deletePermission(v)}))()}]}}}return(E=f).\u0275fac=function(r){return new(r||E)(e.Y36(y.F0),e.Y36(y.gz),e.Y36(M.so),e.Y36(C.q),e.Y36(D.ux))},E.\u0275cmp=e.Xpm({type:E,selectors:[["app-permissions"]],features:[e.qOj],decls:2,vars:3,consts:[["class","eav-dialog nav-component-wrapper",4,"ngIf"],[1,"eav-dialog","nav-component-wrapper"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"eav-dialog-content","nav-component-wrapper"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","gridOptions"],["align","end"],["mat-fab","","mat-elevation-z24","","tippy","Create a new permission",1,"grid-fab",3,"click"]],template:function(r,c){1&r&&(e.YNc(0,R,15,2,"div",0),e.ALo(1,"async")),2&r&&e.Q6J("ngIf",e.lcZ(1,1,c.viewModel$))},dependencies:[T.O5,y.lC,o.$,M.H8,I.RK,I.cs,_.Hw,A.N8,T.Ov]}),f})()},806:(P,p,t)=>{t.r(p),t.d(p,{PermissionsModule:()=>y});var i=t(6575),s=t(895),a=t(257),g=t(6861),h=t(6515),d=t(9409),n=t(1092),m=t(3078),e=t(2611),o=t(7138),_=t(3100),l=t(7477),u=t(7782),C=t(1699);let y=(()=>{var M;class D{}return(M=D).\u0275fac=function(I){return new(I||M)},M.\u0275mod=C.oAB({type:M}),M.\u0275inj=C.cJS({providers:[e._,u.q,l.D,n.g],imports:[i.ez,_.T,o.q,g.Is,s.ot,h.Ps,m.o,a.si,d.ZX]}),D})()},7477:(P,p,t)=>{t.d(p,{D:()=>d});var i=t(2611),s=t(1699),a=t(4860),g=t(6232);let d=(()=>{var n;class m{constructor(o,_,l){this.http=o,this.context=_,this.dnnContext=l}getMetadata(o,_,l,u){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/metadata/get"),{params:{appId:this.context.appId.toString(),targetType:o.toString(),keyType:_,key:l.toString(),...u&&{contentType:u}}})}}return(n=m).\u0275fac=function(o){return new(o||n)(s.LFG(a.eN),s.LFG(i._),s.LFG(g._y))},n.\u0275prov=s.Yz7({token:n,factory:n.\u0275fac}),m})()},7782:(P,p,t)=>{t.d(p,{q:()=>d});var i=t(9736),s=t(1092),a=t(196),g=t(7477),h=t(1699);let d=(()=>{var n;class m{constructor(o,_){this.metadataService=o,this.entitiesService=_}getAll(o,_,l){return this.metadataService.getMetadata(o,_,l,a.Zy.contentTypes.permissions).pipe((0,i.U)(u=>u.Items))}delete(o){return this.entitiesService.delete(a.Zy.contentTypes.permissions,o,!1)}}return(n=m).\u0275fac=function(o){return new(o||n)(h.LFG(g.D),h.LFG(s.g))},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac}),m})()},6041:(P,p,t)=>{t.d(p,{H:()=>m});var i=t(91),s=t(4520),a=t(5043),g=t(9736),h=t(9422),d=t(9097),n=t(1699);let m=(()=>{var e;class o extends d.f{constructor(l,u){super(),this.router=l,this.route=u}ngOnDestroy(){super.ngOnDestroy()}refreshOnChildClosedDeep(){return this.router.events.pipe((0,s.h)(l=>l instanceof i.m2),(0,a.O)(!!this.route.snapshot.firstChild.firstChild),(0,g.U)(()=>!!this.route.snapshot.firstChild.firstChild),(0,h.G)(),(0,s.h)(([l,u])=>l&&!u))}refreshOnChildClosedShallow(){return this.router.events.pipe((0,s.h)(l=>l instanceof i.m2),(0,a.O)(!!this.route.snapshot.firstChild),(0,g.U)(()=>!!this.route.snapshot.firstChild),(0,h.G)(),(0,s.h)(([l,u])=>l&&!u))}}return(e=o).\u0275fac=function(l){return new(l||e)(n.Y36(i.F0),n.Y36(i.gz))},e.\u0275dir=n.lG2({type:e,features:[n.qOj]}),o})()},5253:(P,p,t)=>{t.d(p,{m:()=>e});var i=t(4472),s=t(1699),a=t(9409),g=t(6575),h=t(257),d=t(6515),n=t(9498);const m=function(o,_){return{"align-start":o,"align-end":_}};let e=(()=>{var o;class _{constructor(u){this.snackBar=u}agInit(u){this.id=u.value,this.align="number"==typeof this.id?"end":"start",this.tooltip=u.tooltipGetter(u.data)}refresh(u){return!0}copy(){(0,i.v)(this.tooltip),this.snackBar.open("Copied to clipboard",null,{duration:2e3})}}return(o=_).\u0275fac=function(u){return new(u||o)(s.Y36(a.ux))},o.\u0275cmp=s.Xpm({type:o,selectors:[["app-id-field"]],decls:5,vars:6,consts:[["matRipple","",1,"id-box","highlight",3,"tippy","ngClass","click"],[1,"id"],[1,"icon"]],template:function(u,C){1&u&&(s.TgZ(0,"div",0),s.NdJ("click",function(){return C.copy()}),s.TgZ(1,"span",1),s._uU(2),s.qZA(),s.TgZ(3,"mat-icon",2),s._uU(4,"file_copy"),s.qZA()()),2&u&&(s.Q6J("tippy",C.tooltip)("ngClass",s.WLB(3,m,"start"===C.align,"end"===C.align)),s.xp6(2),s.Oqu(C.id))},dependencies:[g.mk,h.wG,d.Hw,n.$],styles:[".id-box[_ngcontent-%COMP%]{padding:0 8px;height:100%;display:flex;align-items:center}.id-box.align-start[_ngcontent-%COMP%]{justify-content:flex-start}.id-box.align-end[_ngcontent-%COMP%]{justify-content:flex-end}.id-box[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{max-width:100%;text-overflow:ellipsis;overflow:hidden}.id-box[_ngcontent-%COMP%]:hover{text-decoration:none}.id-box[_ngcontent-%COMP%]:hover   .id[_ngcontent-%COMP%]{display:none}.id-box[_ngcontent-%COMP%]:not(:hover)   .icon[_ngcontent-%COMP%]{display:none}"]}),_})()},6433:(P,p,t)=>{t.d(p,{f:()=>i});const i={accentedSort:!0,animateRows:!0,enableCellTextSelection:!0,headerHeight:32,suppressScrollOnNewData:!0,valueCache:!0,defaultColDef:{filterParams:{newRowsAction:"keep"}},tooltipShowDelay:0,tooltipHideDelay:1e5,suppressMovableColumns:!0}},4472:(P,p,t)=>{function i(s){const a=document.createElement("textarea");a.value=s,a.setAttribute("readonly",""),a.style.position="absolute",a.style.left="-9999px",document.body.appendChild(a);const g=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);a.select(),document.execCommand("copy"),document.body.removeChild(a),g&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(g))}t.d(p,{v:()=>i})}}]);
//# sourceMappingURL=https://sources.2sxc.org/16.17.00/dist/ng-edit/default-projects_eav-ui_src_app_permissions_index_ts.41f9815a50fc34bb.js.map