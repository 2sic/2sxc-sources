(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_ng-dialogs_src_app_content-type-fields_content-type-fields_component_ts"],{3143:function(e,t,n){"use strict";n.r(t),n.d(t,{ContentTypeFieldsComponent:function(){return te}});var i=n(4762),o=n(9206),a=n(1282),r=n(8512),s=n(7570),l=n(878),p=n(3148),d=n(3835),c=n(6238),u=n(9996),f=n(2855),g=n(753),m=n(241),h=n(8579),y=n(5803),v=n(2420),T=n(3667),Z=n(2542),I=n(1785),w=n(1116),A=n(7064),C=n(7512),b=n(7070),x=n(7307),R=n(7217);function N(e,t){if(1&e){var n=I.EpF();I.TgZ(0,"div",8),I.NdJ("click",function(){return I.CHM(n),I.oxw().openMetadata()}),I.TgZ(1,"mat-icon",9),I._uU(2," local_offer "),I.qZA(),I.qZA()}if(2&e){var i=I.oxw();I.xp6(1),I.Q6J("matBadge",i.metadataCount)("matBadgeHidden",!i.metadataCount)}}function F(e,t){if(1&e&&(I.TgZ(0,"div",10),I.TgZ(1,"mat-icon",11),I._uU(2," local_offer "),I.qZA(),I.qZA()),2&e){var n=I.oxw();I.xp6(1),I.Q6J("matBadge",n.metadataCount)("matBadgeHidden",!n.metadataCount)}}function k(e,t){if(1&e){var n=I.EpF();I.TgZ(0,"div",12),I.NdJ("click",function(){return I.CHM(n),I.oxw().openPermissions()}),I.TgZ(1,"mat-icon",9),I._uU(2," person "),I.qZA(),I.qZA()}if(2&e){var i=I.oxw();I.xp6(1),I.Q6J("matBadge",i.field.Permissions.Count)("matBadgeHidden",!i.field.Permissions.Count)}}function q(e,t){if(1&e&&(I.TgZ(0,"div",10),I.TgZ(1,"mat-icon",11),I._uU(2," person "),I.qZA(),I.qZA()),2&e){var n=I.oxw();I.xp6(1),I.Q6J("matBadge",n.field.Permissions.Count)("matBadgeHidden",!n.field.Permissions.Count)}}var D=function(){function e(){}return e.prototype.agInit=function(e){this.params=e,this.field=this.params.data,this.metadataCount=this.field.Metadata?Object.keys(this.field.Metadata).filter(function(e){return"merged"!==e}).length:0,this.enablePermissions=this.field.InputType===Z.v.StringWysiwyg||this.field.Type===T.Q.Hyperlink},e.prototype.refresh=function(e){return!0},e.prototype.openMetadata=function(){this.params.onOpenMetadata(this.field)},e.prototype.rename=function(){this.params.onRename(this.field)},e.prototype.openPermissions=function(){this.params.onOpenPermissions(this.field)},e.prototype.deleteField=function(){this.params.onDelete(this.field)},e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=I.Xpm({type:e,selectors:[["app-content-type-fields-actions"]],decls:20,vars:7,consts:[[1,"actions-component"],["class","like-button highlight","matRipple","","tippy","Metadata",3,"click",4,"ngIf"],["class","like-button disabled",4,"ngIf"],["class","like-button highlight","matRipple","","tippy","Permissions",3,"click",4,"ngIf"],["matRipple","","tippy","More",1,"like-button","highlight",3,"matMenuTriggerFor"],[1,"grid-more-menu"],["menu","matMenu"],["mat-menu-item","",3,"disabled","click"],["matRipple","","tippy","Metadata",1,"like-button","highlight",3,"click"],["matBadgeColor","accent","matBadgeSize","small",3,"matBadge","matBadgeHidden"],[1,"like-button","disabled"],["matBadgeColor","accent","matBadgeSize","small","matBadgeDisabled","true",3,"matBadge","matBadgeHidden"],["matRipple","","tippy","Permissions",1,"like-button","highlight",3,"click"]],template:function(e,t){if(1&e&&(I.TgZ(0,"div",0),I.YNc(1,N,3,2,"div",1),I.YNc(2,F,3,2,"div",2),I.YNc(3,k,3,2,"div",3),I.YNc(4,q,3,2,"div",2),I.TgZ(5,"div",4),I.TgZ(6,"mat-icon"),I._uU(7,"more_horiz"),I.qZA(),I.qZA(),I.qZA(),I.TgZ(8,"mat-menu",5,6),I.TgZ(10,"button",7),I.NdJ("click",function(){return t.rename()}),I.TgZ(11,"mat-icon"),I._uU(12,"text_fields"),I.qZA(),I.TgZ(13,"span"),I._uU(14,"Rename"),I.qZA(),I.qZA(),I.TgZ(15,"button",7),I.NdJ("click",function(){return t.deleteField()}),I.TgZ(16,"mat-icon"),I._uU(17,"delete"),I.qZA(),I.TgZ(18,"span"),I._uU(19,"Delete"),I.qZA(),I.qZA(),I.qZA()),2&e){var n=I.MAs(9);I.xp6(1),I.Q6J("ngIf",!t.field.EditInfo.ReadOnly),I.xp6(1),I.Q6J("ngIf",t.field.EditInfo.ReadOnly),I.xp6(1),I.Q6J("ngIf",!t.field.EditInfo.ReadOnly&&t.enablePermissions),I.xp6(1),I.Q6J("ngIf",t.field.EditInfo.ReadOnly||!t.enablePermissions),I.xp6(1),I.Q6J("matMenuTriggerFor",n),I.xp6(5),I.Q6J("disabled",t.field.EditInfo.ReadOnly),I.xp6(5),I.Q6J("disabled",t.field.EditInfo.ReadOnly||t.field.IsTitle)}},directives:[w.O5,A.wG,C.$,b.p6,x.Hw,b.VK,b.OP,R.k],styles:[""]}),e}();function _(e,t){if(1&e){var n=I.EpF();I.TgZ(0,"div",2),I.NdJ("click",function(){return I.CHM(n),I.oxw().changeInputType()}),I.TgZ(1,"div",3),I._uU(2),I.qZA(),I.TgZ(3,"div",4),I.TgZ(4,"mat-icon"),I._uU(5,"arrow_drop_down"),I.qZA(),I.qZA(),I.qZA()}if(2&e){var i=I.oxw();I.xp6(2),I.Oqu(i.value)}}function S(e,t){if(1&e&&(I.TgZ(0,"div",5),I.TgZ(1,"div",6),I._uU(2),I.qZA(),I.TgZ(3,"div",7),I.TgZ(4,"mat-icon"),I._uU(5,"arrow_drop_down"),I.qZA(),I.qZA(),I.qZA()),2&e){var n=I.oxw();I.xp6(2),I.Oqu(n.value)}}var E=function(){function e(){}return e.prototype.agInit=function(e){this.params=e,this.value=e.value,this.field=e.data},e.prototype.refresh=function(e){return!0},e.prototype.changeInputType=function(){this.params.onChangeInputType(this.field)},e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=I.Xpm({type:e,selectors:[["app-content-type-fields-input-type"]],decls:2,vars:2,consts:[["matRipple","","class","input-component highlight",3,"click",4,"ngIf"],["class","input-component disabled",4,"ngIf"],["matRipple","",1,"input-component","highlight",3,"click"],[1,"text"],[1,"like-button"],[1,"input-component","disabled"],[1,"text","disabled"],[1,"like-button","disabled"]],template:function(e,t){1&e&&(I.YNc(0,_,6,1,"div",0),I.YNc(1,S,6,1,"div",1)),2&e&&(I.Q6J("ngIf",!t.field.EditInfo.ReadOnly),I.xp6(1),I.Q6J("ngIf",t.field.EditInfo.ReadOnly))},directives:[w.O5,A.wG,x.Hw],styles:[""]}),e}();function O(e,t){1&e&&(I.TgZ(0,"mat-icon",3),I._uU(1,"functions"),I.qZA())}function M(e,t){1&e&&(I.TgZ(0,"mat-icon",4),I._uU(1,"mobiledata_off"),I.qZA())}var J=function(){function e(){}return e.prototype.agInit=function(e){var t=e.data;this.hasFormulas=t.HasFormulas,this.isEphemeral=t.IsEphemeral},e.prototype.refresh=function(e){return!0},e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=I.Xpm({type:e,selectors:[["app-content-type-fields-special"]],decls:3,vars:2,consts:[[1,"icon-container"],["tippy","Has Formulas",4,"ngIf"],["tippy","Ephemeral / Temporary, won't save",4,"ngIf"],["tippy","Has Formulas"],["tippy","Ephemeral / Temporary, won't save"]],template:function(e,t){1&e&&(I.TgZ(0,"div",0),I.YNc(1,O,2,0,"mat-icon",1),I.YNc(2,M,2,0,"mat-icon",2),I.qZA()),2&e&&(I.xp6(1),I.Q6J("ngIf",t.hasFormulas),I.xp6(1),I.Q6J("ngIf",t.isEphemeral))},directives:[w.O5,x.Hw,C.$],styles:[""]}),e}();function U(e,t){1&e&&I._UZ(0,"mat-icon",6)}function Q(e,t){1&e&&(I.TgZ(0,"mat-icon"),I._uU(1,"star_outline"),I.qZA())}function $(e,t){if(1&e){var n=I.EpF();I.TgZ(0,"div",3),I.NdJ("click",function(){return I.CHM(n),I.oxw().setTitle()}),I.YNc(1,U,1,0,"mat-icon",4),I.YNc(2,Q,2,0,"mat-icon",5),I.qZA()}if(2&e){var i=I.oxw();I.xp6(1),I.Q6J("ngIf",i.isTitle),I.xp6(1),I.Q6J("ngIf",!i.isTitle)}}function B(e,t){1&e&&I._UZ(0,"mat-icon",6)}function H(e,t){1&e&&(I.TgZ(0,"mat-icon"),I._uU(1,"star_outline"),I.qZA())}function P(e,t){if(1&e&&(I.TgZ(0,"div",7),I.YNc(1,B,1,0,"mat-icon",4),I.YNc(2,H,2,0,"mat-icon",5),I.qZA()),2&e){var n=I.oxw();I.xp6(1),I.Q6J("ngIf",n.isTitle),I.xp6(1),I.Q6J("ngIf",!n.isTitle)}}var Y=function(){function e(){}return e.prototype.agInit=function(e){this.params=e,this.isTitle=e.value,this.field=e.data},e.prototype.refresh=function(e){return!0},e.prototype.setTitle=function(){this.params.onSetTitle(this.field)},e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=I.Xpm({type:e,selectors:[["app-content-type-fields-title"]],decls:3,vars:2,consts:[[1,"actions-component"],["class","like-button highlight","matRipple","","tippy","Use as title field",3,"click",4,"ngIf"],["class","like-button disabled",4,"ngIf"],["matRipple","","tippy","Use as title field",1,"like-button","highlight",3,"click"],["svgIcon","star",4,"ngIf"],[4,"ngIf"],["svgIcon","star"],[1,"like-button","disabled"]],template:function(e,t){1&e&&(I.TgZ(0,"div",0),I.YNc(1,$,3,2,"div",1),I.YNc(2,P,3,2,"div",2),I.qZA()),2&e&&(I.xp6(1),I.Q6J("ngIf",!t.field.EditInfo.ReadOnly),I.xp6(1),I.Q6J("ngIf",t.field.EditInfo.ReadOnly))},directives:[w.O5,A.wG,C.$,x.Hw],styles:[""]}),e}(),G=n(3269),X=function(){function e(){}return e.prototype.agInit=function(e){this.value=e.value,this.icon=(0,G.x)(this.value)},e.prototype.refresh=function(e){return!0},e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=I.Xpm({type:e,selectors:[["app-content-type-fields-type"]],decls:3,vars:2,consts:[[1,"icon-container",3,"tippy"]],template:function(e,t){1&e&&(I.TgZ(0,"div",0),I.TgZ(1,"mat-icon"),I._uU(2),I.qZA(),I.qZA()),2&e&&(I.Q6J("tippy",t.value),I.xp6(2),I.Oqu(t.icon))},directives:[C.$,x.Hw],styles:[""]}),e}(),L=n(2935),W=n(2832),j=n(7093),z=n(3589),V=n(4369),K=n(9825),ee=function(e,t){return{"grid-sorted":e,"grid-filtered":t}},te=function(){function e(e,t,n,a,l,p){var d=this;this.dialogRef=e,this.route=t,this.router=n,this.contentTypesService=a,this.contentTypesFieldsService=l,this.snackBar=p,this.contentType$=new r.X(null),this.fields$=new r.X(null),this.modules=o.F$,this.gridOptions=(0,i.pi)((0,i.pi)({},h.f),{getRowClass:function(e){var t=e.data,n=[];return t.EditInfo.ReadOnly&&n.push("disable-row-drag"),t.InputType===Z.v.EmptyDefault&&n.push("group-start-row"),t.InputType===Z.v.EmptyEnd&&n.push("group-end-row"),n.join(" ")},frameworkComponents:{contentTypeFieldsTitleComponent:Y,contentTypeFieldsTypeComponent:X,contentTypeFieldsInputTypeComponent:E,contentTypeFieldsSpecialComponent:J,contentTypeFieldsActionsComponent:D},columnDefs:[{rowDrag:!0,width:18,cellClass:"no-select no-padding no-outline"},{headerName:"Title",field:"IsTitle",width:42,cellClass:"secondary-action no-padding no-outline",cellRenderer:"contentTypeFieldsTitleComponent",cellRendererParams:{onSetTitle:function(e){return d.setTitle(e)}}},{headerName:"Name",field:"StaticName",flex:2,minWidth:250,cellClass:"primary-action highlight",sortable:!0,filter:"agTextColumnFilter",onCellClicked:function(e){return d.editFieldMetadata(e.data)},cellRenderer:function(e){return d.nameCellRenderer(e)}},{headerName:"Type",field:"Type",width:70,headerClass:"dense",cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",cellRenderer:"contentTypeFieldsTypeComponent"},{headerName:"Input",field:"InputType",width:160,cellClass:function(e){return e.data.EditInfo.ReadOnly?"no-outline no-padding":"secondary-action no-padding"},sortable:!0,filter:"agTextColumnFilter",cellRenderer:"contentTypeFieldsInputTypeComponent",valueGetter:function(e){return d.inputTypeValueGetter(e)},cellRendererParams:{onChangeInputType:function(e){return d.changeInputType(e)}}},{headerName:"Label",field:"Metadata.All.Name",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter"},{headerName:"Special",width:66,headerClass:"dense",cellClass:"no-outline",cellRenderer:"contentTypeFieldsSpecialComponent"},{headerName:"Notes",field:"Metadata.All.Notes",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter"},{width:122,cellClass:"secondary-action no-padding",cellRenderer:"contentTypeFieldsActionsComponent",pinned:"right",cellRendererParams:{onRename:function(e){return d.rename(e)},onDelete:function(e){return d.delete(e)},onOpenPermissions:function(e){return d.openPermissions(e)},onOpenMetadata:function(e){return d.openMetadata(e)}}}]}),this.sortApplied=!1,this.filterApplied=!1,this.rowDragSuppressed=!1,this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName"),this.subscription=new s.w}return e.prototype.ngOnInit=function(){this.fetchFields(),this.refreshOnChildClosed()},e.prototype.ngOnDestroy=function(){this.contentType$.complete(),this.fields$.complete(),this.subscription.unsubscribe()},e.prototype.closeDialog=function(){this.dialogRef.close()},e.prototype.onGridReady=function(e){this.gridApi=e.api},e.prototype.onRowDragEnter=function(e){this.gridApi.setEnableCellTextSelection(!1)},e.prototype.onRowDragEnd=function(e){var t=this;this.gridApi.setSuppressRowDrag(!0);var n=this.fields$.value.map(function(e){return e.Id});this.contentTypesFieldsService.reOrder(n,this.contentType$.value).subscribe(function(e){t.fetchFields(function(){t.gridApi.setEnableCellTextSelection(!0),t.gridApi.setSuppressRowDrag(!1)})})},e.prototype.onRowDragMove=function(e){var t=e.node,n=e.overNode;if(n&&t!==n){var o=t.data,a=n.data,r=(0,i.ev)([],(0,i.CR)(this.fields$.value)),s=r.indexOf(o),l=r.indexOf(a);this.moveInArray(r,s,l),this.fields$.next(r),this.gridApi.clearFocusedCell()}},e.prototype.moveInArray=function(e,t,n){var i=e[t];e.splice(t,1),e.splice(n,0,i)},e.prototype.onSortChanged=function(e){var t=this.gridApi.getSortModel();this.sortApplied=t.length>0,this.suppressRowDrag()},e.prototype.onFilterChanged=function(e){var t=this.gridApi.getFilterModel(),n=Object.keys(t);this.filterApplied=n.length>0,this.suppressRowDrag()},e.prototype.suppressRowDrag=function(){var e=this.sortApplied||this.filterApplied;e&&!this.rowDragSuppressed?(this.rowDragSuppressed=!0,this.gridApi.setSuppressRowDrag(!0)):!e&&this.rowDragSuppressed&&(this.rowDragSuppressed=!1,this.gridApi.setSuppressRowDrag(!1))},e.prototype.add=function(){this.router.navigate(["add/"+this.contentTypeStaticName],{relativeTo:this.route})},e.prototype.nameCellRenderer=function(e){var t,n,o=e.data;if([Z.v.EmptyDefault,Z.v.EmptyEnd].includes(o.InputType))return e.value;var a=!1;try{for(var r=(0,i.XA)(this.fields$.value),s=r.next();!s.done;s=r.next()){var l=s.value;if(l.InputType!==Z.v.EmptyDefault)if(l.InputType!==Z.v.EmptyEnd){if(l.StaticName===o.StaticName)break}else a=!1;else a=!0}}catch(p){t={error:p}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return a?'<span class="is-in-group">'+e.value+"</span>":e.value},e.prototype.inputTypeValueGetter=function(e){var t=e.data;return t.InputType.substring(t.InputType.indexOf("-")+1)},e.prototype.fetchFields=function(e){var t=this,n=null==this.contentType$.value?this.contentTypesService.retrieveContentType(this.contentTypeStaticName):(0,l.of)(this.contentType$.value),o=this.contentTypesFieldsService.getFields(this.contentTypeStaticName);(0,p.D)([n,o]).subscribe(function(n){var o=(0,i.CR)(n,2),a=o[1];t.contentType$.next(o[0]),t.fields$.next(a),null!=e&&e()})},e.prototype.editFieldMetadata=function(e){var t={items:[this.createItemDefinition(e,"All"),this.createItemDefinition(e,e.Type),this.createItemDefinition(e,e.InputType)]},n=(0,v.f)(t);this.router.navigate(["edit/"+n],{relativeTo:this.route})},e.prototype.createItemDefinition=function(e,t){return null!=e.Metadata[t]?{EntityId:e.Metadata[t].Id}:{ContentTypeName:"@"+t,For:{Target:y.Z.metadata.attribute.target,Number:e.Id},Prefill:{Name:e.StaticName}}},e.prototype.setTitle=function(e){var t=this;this.snackBar.open("Setting title..."),this.contentTypesFieldsService.setTitle(e,this.contentType$.value).subscribe(function(){t.snackBar.open("Title set",null,{duration:2e3}),t.fetchFields()})},e.prototype.changeInputType=function(e){this.router.navigate(["update/"+this.contentTypeStaticName+"/"+e.Id+"/inputType"],{relativeTo:this.route})},e.prototype.rename=function(e){this.router.navigate(["update/"+this.contentTypeStaticName+"/"+e.Id+"/name"],{relativeTo:this.route})},e.prototype.delete=function(e){var t=this;confirm("Are you sure you want to delete '"+e.StaticName+"' ("+e.Id+")?")&&(this.snackBar.open("Deleting..."),this.contentTypesFieldsService.delete(e,this.contentType$.value).subscribe(function(e){t.snackBar.open("Deleted",null,{duration:2e3}),t.fetchFields()}))},e.prototype.openPermissions=function(e){this.router.navigate([m.i.getUrlAttribute(e.Id)],{relativeTo:this.route})},e.prototype.openMetadata=function(e){var t=g.U.getUrlAttribute(e.Id,"Metadata for Field: "+e.StaticName+" ("+e.Id+")");this.router.navigate([t],{relativeTo:this.route})},e.prototype.refreshOnChildClosed=function(){var e=this;this.subscription.add(this.router.events.pipe((0,d.h)(function(e){return e instanceof a.m2}),(0,c.O)(!!this.route.snapshot.firstChild),(0,u.U)(function(){return!!e.route.snapshot.firstChild}),(0,f.G)(),(0,d.h)(function(e){var t=(0,i.CR)(e,2);return t[0]&&!t[1]})).subscribe(function(){e.fetchFields()}))},e.\u0275fac=function(t){return new(t||e)(I.Y36(L.so),I.Y36(a.gz),I.Y36(a.F0),I.Y36(W.s),I.Y36(j.Mr),I.Y36(z.ux))},e.\u0275cmp=I.Xpm({type:e,selectors:[["app-content-type-fields"]],decls:19,vars:17,consts:[[1,"nav-component-wrapper"],["mat-dialog-title",""],[1,"dialog-title-box"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","modules","gridOptions","ngClass","rowDragEnter","rowDragEnd","rowDragMove","gridReady","sortChanged","filterChanged"],[1,"grid-more-actions-box"],["mat-fab","","mat-elevation-z24","","tippy","Add fields",1,"grid-fab",3,"disabled","click"]],template:function(e,t){var n;1&e&&(I.TgZ(0,"div",0),I.TgZ(1,"div",1),I.TgZ(2,"div",2),I.TgZ(3,"div"),I._uU(4),I.ALo(5,"async"),I.qZA(),I.TgZ(6,"button",3),I.NdJ("click",function(){return t.closeDialog()}),I.TgZ(7,"mat-icon"),I._uU(8,"close"),I.qZA(),I.qZA(),I.qZA(),I.qZA(),I._UZ(9,"router-outlet"),I.TgZ(10,"div",4),I.TgZ(11,"ag-grid-angular",5),I.NdJ("rowDragEnter",function(e){return t.onRowDragEnter(e)})("rowDragEnd",function(e){return t.onRowDragEnd(e)})("rowDragMove",function(e){return t.onRowDragMove(e)})("gridReady",function(e){return t.onGridReady(e)})("sortChanged",function(e){return t.onSortChanged(e)})("filterChanged",function(e){return t.onFilterChanged(e)}),I.ALo(12,"async"),I.qZA(),I._UZ(13,"div",6),I.TgZ(14,"button",7),I.NdJ("click",function(){return t.add()}),I.ALo(15,"async"),I.ALo(16,"async"),I.TgZ(17,"mat-icon"),I._uU(18,"add"),I.qZA(),I.qZA(),I.qZA(),I.qZA()),2&e&&(I.xp6(4),I.hij("",null==(n=I.lcZ(5,6,t.contentType$))?null:n.Name," Fields"),I.xp6(7),I.Q6J("rowData",I.lcZ(12,8,t.fields$))("modules",t.modules)("gridOptions",t.gridOptions)("ngClass",I.WLB(14,ee,t.sortApplied,t.filterApplied)),I.xp6(3),I.Q6J("disabled",null==I.lcZ(15,10,t.contentType$)||I.lcZ(16,12,t.contentType$).EditInfo.ReadOnly))},directives:[L.uh,V.lW,C.$,x.Hw,a.lC,K.N8,w.mk],pipes:[w.Ov],styles:[""]}),e}()}}]);
//# sourceMappingURL=https://sources.2sxc.org/13.01.00/ng-edit/projects_ng-dialogs_src_app_content-type-fields_content-type-fields_component_ts.5473b27fdaacf287e8a4.js.map