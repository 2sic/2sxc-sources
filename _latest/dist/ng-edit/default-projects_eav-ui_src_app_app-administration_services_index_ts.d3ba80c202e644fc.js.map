{"version":3,"mappings":"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","names":["AppDialogConfigService","constructor","http","context","dnnContext","globalConfigService","this","getShared$","appId","dialogSettings$","getDialogSettings","pipe","shareReplay","refCount","get","$2sxc","apiUrl","webApiDialogRoot","params","toString","map","dialogSettings","Context","Language","List","filter","language","IsEnabled","tap","allowDebug","Enable","DebugMode","i0","factory","ExportAppPartsService","getContentInfo","scope","webApiAppPartsRoot","appid","zoneId","exportParts","contentTypeIds","entityIds","templateIds","url","join","window","open","ExportAppService","getAppInfo","webApiAppRoot","exportApp","includeContentGroups","resetAppGuid","exportForVersionControl","withFiles","withPortalFiles","ImportAppPartsService","importAppParts","file","formData","FormData","append","post","resetApp","webApiQueryRoot","webApiQueryRun","webApiQueryDebugStream","webApiQuerySave","webApiQueryGet","webApiQueryDataSources","PipelinesService","getAll","contentType","webApiEntityList","importQuery","from","toBase64","switchMap","fileBase64","AppId","ContentBase64","success","Success","Messages","clonePipeline","id","Id","delete","ViewsService","webApiViewRoot","import","export","getPolymorphism","getUsage","guid","ImportAppService","importApp","changedName","retryOnDuplicate","result","O","_a","MessageType","FileUploadMessageTypes","folderName","prompt","Text","of","ctx_r15","ctx_r17","ctx_r19","oxw","ctx_r21","_r5","ctx_r24","FileUploadDialogComponent","dialogData","dialogRef","snackBar","BehaviorSubject","undefined","Subscription","ngOnInit","subscription","add","files$","subscribe","result$","value","next","files","filesDropped","ngOnDestroy","uploading$","complete","unsubscribe","closeDialog","refresh","close","setFiles","upload","filesChanged","event","Array","target","upload$","take","error","duration","multiple","slice","MAT_DIALOG_DATA","selectors","Warning","Error","DragAndDropDirective","elementRef","zone","EventEmitter","element","nativeElement","markStyleClass","markStyle","classList","dropAreaClass","runOutsideAngular","fromEvent","preventDefault","stopPropagation","clearTimeouts","dragClass","timeouts","push","setTimeout","remove","onDrop","dataTransfer","filterTypes","allowedFileTypes","length","emit","timeout","clearTimeout","allowedTypes","split","type","toLocaleLowerCase","filtered","extIndex","name","lastIndexOf","ext","substring","includes","allowedTypesString","replace","ctx","SafeHtmlPipe","sanitizer","transform","html","bypassSecurityTrustHtml","pure"],"sources":["./projects/eav-ui/src/app/app-administration/services/app-dialog-config.service.ts","./projects/eav-ui/src/app/app-administration/services/export-app-parts.service.ts","./projects/eav-ui/src/app/app-administration/services/export-app.service.ts","./projects/eav-ui/src/app/app-administration/services/import-app-parts.service.ts","./projects/eav-ui/src/app/app-administration/services/pipelines.service.ts","./projects/eav-ui/src/app/app-administration/services/views.service.ts","./projects/eav-ui/src/app/import-app/services/import-app.service.ts","./projects/eav-ui/src/app/shared/components/file-upload-dialog/file-upload-dialog.component.html","./projects/eav-ui/src/app/shared/components/file-upload-dialog/file-upload-dialog.component.ts","./projects/eav-ui/src/app/shared/components/file-upload-dialog/file-upload-dialog.models.ts","./projects/eav-ui/src/app/shared/directives/drag-and-drop.directive.ts","./projects/eav-ui/src/app/shared/pipes/safe-html.pipe.ts"],"sourcesContent":["import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { map, Observable, shareReplay, tap } from 'rxjs';\r\nimport { GlobalConfigService } from '../../edit/shared/store/ngrx-data';\r\nimport { DialogSettings } from '../../shared/models/dialog-settings.model';\r\nimport { Context } from '../../shared/services/context';\r\n\r\nconst webApiDialogRoot = 'admin/dialog/';\r\n\r\n@Injectable()\r\nexport class AppDialogConfigService {\r\n  constructor(\r\n    private http: HttpClient,\r\n    private context: Context,\r\n    private dnnContext: DnnContext,\r\n    private globalConfigService: GlobalConfigService,\r\n  ) { }\r\n\r\n  private dialogSettings$: Record<number, Observable<DialogSettings>> = {};\r\n\r\n  getShared$(appId?: number) {\r\n    appId ??= this.context.appId;\r\n    if (!this.dialogSettings$[appId])\r\n      this.dialogSettings$[appId] = this.getDialogSettings(appId).pipe(shareReplay({ refCount: false }));\r\n    return this.dialogSettings$[appId];\r\n    // TODO: probably should add an onDestroy and ensure all subscriptions are killed\r\n  }\r\n\r\n  getDialogSettings(appId?: number) {\r\n    return this.http.get<DialogSettings>(this.dnnContext.$2sxc.http.apiUrl(webApiDialogRoot + 'settings'), {\r\n      params: { appId: appId ?? this.context.appId.toString() },\r\n    }).pipe(\r\n      map(dialogSettings => {\r\n        dialogSettings.Context.Language.List = dialogSettings.Context.Language.List.filter(language => language.IsEnabled);\r\n        return dialogSettings;\r\n      }),\r\n      tap(dialogSettings => {\r\n        this.globalConfigService.allowDebug(dialogSettings.Context.Enable.DebugMode);\r\n      }),\r\n    );\r\n  }\r\n}\r\n","import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { Context } from '../../shared/services/context';\r\nimport { ContentInfo } from '../models/content-info.model';\r\nimport { webApiAppPartsRoot } from './import-app-parts.service';\r\n\r\n@Injectable()\r\nexport class ExportAppPartsService {\r\n  constructor(private http: HttpClient, private context: Context, private dnnContext: DnnContext) { }\r\n\r\n  getContentInfo(scope: string) {\r\n    return this.http.get<ContentInfo>(this.dnnContext.$2sxc.http.apiUrl(webApiAppPartsRoot + 'Get'), {\r\n      params: { appid: this.context.appId.toString(), zoneId: this.context.zoneId.toString(), scope },\r\n    });\r\n  }\r\n\r\n  exportParts(contentTypeIds: number[], entityIds: number[], templateIds: number[]) {\r\n    const url = this.dnnContext.$2sxc.http.apiUrl(webApiAppPartsRoot + 'Export')\r\n      + '?appId=' + this.context.appId.toString()\r\n      + '&zoneId=' + this.context.zoneId.toString()\r\n      + '&contentTypeIdsString=' + contentTypeIds.join(';')\r\n      + '&entityIdsString=' + entityIds.join(';')\r\n      + '&templateIdsString=' + templateIds.join(';');\r\n\r\n    window.open(url, '_blank', '');\r\n  }\r\n}\r\n","import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { webApiAppRoot } from '../../import-app/services/import-app.service';\r\nimport { Context } from '../../shared/services/context';\r\nimport { AppInfo } from '../models/app-info.model';\r\n\r\n@Injectable()\r\nexport class ExportAppService {\r\n  constructor(private http: HttpClient, private context: Context, private dnnContext: DnnContext) { }\r\n\r\n  getAppInfo() {\r\n    return this.http.get<AppInfo>(this.dnnContext.$2sxc.http.apiUrl(webApiAppRoot + 'Statistics'), {\r\n      params: { appid: this.context.appId.toString(), zoneId: this.context.zoneId.toString() },\r\n    });\r\n  }\r\n\r\n  exportApp(includeContentGroups: boolean, resetAppGuid: boolean) {\r\n    const url = this.dnnContext.$2sxc.http.apiUrl(webApiAppRoot + 'Export')\r\n      + '?appId=' + this.context.appId\r\n      + '&zoneId=' + this.context.zoneId\r\n      + '&includeContentGroups=' + includeContentGroups\r\n      + '&resetAppGuid=' + resetAppGuid;\r\n\r\n    window.open(url, '_blank', '');\r\n  }\r\n\r\n  exportForVersionControl({ includeContentGroups, resetAppGuid, withFiles }:\r\n    { includeContentGroups: boolean; resetAppGuid: boolean; withFiles: boolean; }) {\r\n    return this.http.get<boolean>(this.dnnContext.$2sxc.http.apiUrl(webApiAppRoot + 'SaveData'), {\r\n      params: {\r\n        appid: this.context.appId.toString(),\r\n        zoneId: this.context.zoneId.toString(),\r\n        includeContentGroups: includeContentGroups.toString(),\r\n        resetAppGuid: resetAppGuid.toString(),\r\n        withPortalFiles: withFiles.toString(),\r\n      },\r\n    });\r\n  }\r\n}\r\n","import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { webApiAppRoot } from '../../import-app/services/import-app.service';\r\nimport { FileUploadResult } from '../../shared/components/file-upload-dialog';\r\nimport { Context } from '../../shared/services/context';\r\n\r\nexport const webApiAppPartsRoot = 'admin/appParts/';\r\n\r\n@Injectable()\r\nexport class ImportAppPartsService {\r\n  constructor(private http: HttpClient, private context: Context, private dnnContext: DnnContext) { }\r\n\r\n  importAppParts(file: File) {\r\n    const formData = new FormData();\r\n    formData.append('File', file);\r\n    return this.http.post<FileUploadResult>(this.dnnContext.$2sxc.http.apiUrl(webApiAppPartsRoot + 'Import'), formData, {\r\n      params: { appId: this.context.appId.toString(), zoneId: this.context.zoneId.toString() }\r\n    });\r\n  }\r\n\r\n  /** Reset the App back to the state it was in the last xml export */\r\n  resetApp(withFiles: boolean) {\r\n    return this.http.post<FileUploadResult>(this.dnnContext.$2sxc.http.apiUrl(webApiAppRoot + 'Reset'), {}, {\r\n      params: {\r\n        appId: this.context.appId.toString(),\r\n        zoneId: this.context.zoneId.toString(),\r\n        withPortalFiles: withFiles.toString(),\r\n      }\r\n    });\r\n  }\r\n}\r\n","import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { from, map, switchMap } from 'rxjs';\r\nimport { webApiEntityList } from '../../edit/shared/services';\r\nimport { FileUploadResult } from '../../shared/components/file-upload-dialog';\r\nimport { toBase64 } from '../../shared/helpers/file-to-base64.helper';\r\nimport { Context } from '../../shared/services/context';\r\nimport { Query } from '../models/query.model';\r\n\r\nconst webApiQueryRoot = 'admin/query/';\r\nconst webApiQueryImport = webApiQueryRoot + 'import';\r\nconst webApiQueryClone = webApiQueryRoot + 'Clone';\r\nconst webApiQueryDelete = webApiQueryRoot + 'Delete';\r\nexport const webApiQueryRun = webApiQueryRoot + 'Run';\r\nexport const webApiQueryDebugStream = webApiQueryRoot + 'DebugStream';\r\nexport const webApiQuerySave = webApiQueryRoot + 'Save';\r\nexport const webApiQueryGet = webApiQueryRoot + 'Get';\r\nexport const webApiQueryDataSources = webApiQueryRoot + 'DataSources';\r\n\r\n@Injectable()\r\nexport class PipelinesService {\r\n  constructor(private http: HttpClient, private context: Context, private dnnContext: DnnContext) { }\r\n\r\n  getAll(contentType: string) {\r\n    return this.http.get<Query[]>(this.dnnContext.$2sxc.http.apiUrl(webApiEntityList), {\r\n      params: { appId: this.context.appId.toString(), contentType }\r\n    });\r\n  }\r\n\r\n  importQuery(file: File) {\r\n    return from(toBase64(file)).pipe(\r\n      switchMap(fileBase64 => {\r\n        return this.http.post<boolean>(this.dnnContext.$2sxc.http.apiUrl(webApiQueryImport), {\r\n          AppId: this.context.appId.toString(),\r\n          ContentBase64: fileBase64,\r\n        });\r\n      }),\r\n      map(success => {\r\n        const result: FileUploadResult = {\r\n          Success: success,\r\n          Messages: [],\r\n        };\r\n        return result;\r\n      }),\r\n    );\r\n  }\r\n\r\n  clonePipeline(id: number) {\r\n    return this.http.get<null>(this.dnnContext.$2sxc.http.apiUrl(webApiQueryClone), {\r\n      params: { Id: id.toString(), appId: this.context.appId.toString() }\r\n    });\r\n  }\r\n\r\n  delete(id: number) {\r\n    return this.http.delete<boolean>(this.dnnContext.$2sxc.http.apiUrl(webApiQueryDelete), {\r\n      params: { appId: this.context.appId.toString(), Id: id.toString() },\r\n    });\r\n  }\r\n}\r\n","import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { FileUploadResult } from '../../shared/components/file-upload-dialog';\r\nimport { Context } from '../../shared/services/context';\r\nimport { Polymorphism } from '../models/polymorphism.model';\r\nimport { ViewUsage } from '../models/view-usage.model';\r\nimport { View } from '../models/view.model';\r\n\r\nconst webApiViewRoot = 'admin/view/';\r\nconst webApiViews = webApiViewRoot + 'all';\r\nconst webApiViewDelete = webApiViewRoot + 'delete';\r\nconst webApiViewImport = webApiViewRoot + 'import';\r\nconst webApiViewPolymorph = webApiViewRoot + 'polymorphism';\r\nconst webApiViewUsage = webApiViewRoot + 'usage';\r\n\r\n@Injectable()\r\nexport class ViewsService {\r\n  constructor(private http: HttpClient, private context: Context, private dnnContext: DnnContext) { }\r\n\r\n  getAll() {\r\n    return this.http.get<View[]>(this.dnnContext.$2sxc.http.apiUrl(webApiViews), {\r\n      params: { appId: this.context.appId.toString() }\r\n    });\r\n  }\r\n\r\n  delete(id: number) {\r\n    return this.http.get<boolean>(this.dnnContext.$2sxc.http.apiUrl(webApiViewDelete), {\r\n      params: { appId: this.context.appId.toString(), Id: id.toString() },\r\n    });\r\n  }\r\n\r\n  import(file: File) {\r\n    const formData = new FormData();\r\n    formData.append('File', file);\r\n    return this.http.post<FileUploadResult>(this.dnnContext.$2sxc.http.apiUrl(webApiViewImport), formData, {\r\n      params: { appId: this.context.appId.toString(), zoneId: this.context.zoneId.toString() }\r\n    });\r\n  }\r\n\r\n  export(id: number) {\r\n    const url = this.dnnContext.$2sxc.http.apiUrl(webApiViewRoot + 'json')\r\n      + '?appId=' + this.context.appId\r\n      + '&viewId=' + id;\r\n\r\n    window.open(url, '_blank', '');\r\n  }\r\n\r\n  getPolymorphism() {\r\n    return this.http.get<Polymorphism>(this.dnnContext.$2sxc.http.apiUrl(webApiViewPolymorph), {\r\n      params: { appId: this.context.appId.toString() }\r\n    });\r\n  }\r\n\r\n  getUsage(guid: string) {\r\n    return this.http.get<ViewUsage[]>(this.dnnContext.$2sxc.http.apiUrl(webApiViewUsage), {\r\n      params: { appId: this.context.appId.toString(), guid }\r\n    });\r\n  }\r\n}\r\n","import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { Observable, of, switchMap } from 'rxjs';\r\nimport { FileUploadMessageTypes, FileUploadResult } from '../../shared/components/file-upload-dialog';\r\nimport { Context } from '../../shared/services/context';\r\n\r\nexport const webApiAppRoot = 'admin/app/';\r\n\r\n@Injectable()\r\nexport class ImportAppService {\r\n  constructor(private http: HttpClient, private context: Context, private dnnContext: DnnContext) { }\r\n\r\n  importApp(file: File, changedName: string, retryOnDuplicate = false): Observable<FileUploadResult> {\r\n    const formData = new FormData();\r\n    formData.append('File', file);\r\n    formData.append('Name', changedName ?? '');\r\n    return this.http.post<FileUploadResult>(this.dnnContext.$2sxc.http.apiUrl(webApiAppRoot + 'Import'), formData, {\r\n      params: { zoneId: this.context.zoneId.toString() }\r\n    }).pipe(\r\n      switchMap(result => {\r\n        if (retryOnDuplicate && result.Messages[0]?.MessageType === FileUploadMessageTypes.Warning) {\r\n          const folderName = prompt(result.Messages[0].Text + ' Would you like to install it using another folder name?');\r\n          if (folderName) {\r\n            return this.importApp(file, folderName, true);\r\n          }\r\n        }\r\n        return of(result);\r\n      }),\r\n    );\r\n  }\r\n}\r\n","<div appDragAndDrop [allowedFileTypes]=\"dialogData.allowedFileTypes\" (filesDropped)=\"filesDropped($event)\" *ngIf=\"{\r\n  uploading: uploading$ | async,\r\n    files: files$ | async,\r\n    result: result$ | async\r\n  } as data\">\r\n\r\n  <div mat-dialog-title>\r\n    <div class=\"dialog-title-box\" [innerHtml]=\"dialogData.title | safeHtml\"></div>\r\n  </div>\r\n\r\n  <mat-spinner *ngIf=\"data.uploading\" mode=\"indeterminate\" diameter=\"20\" color=\"accent\"></mat-spinner>\r\n\r\n  <p class=\"dialog-description\" [innerHtml]=\"dialogData.description | safeHtml\"></p>\r\n\r\n  <div>\r\n    <button mat-raised-button tippy=\"Open file browser\" [disabled]=\"data.uploading\" (click)=\"fileInput.click()\">\r\n      <div *ngIf=\"!data.files.length\">Select or drop file</div>\r\n      <div *ngFor=\"let file of data.files\">{{ file.name }}</div>\r\n    </button>\r\n    <input #fileInput type=\"file\" multiple (change)=\"filesChanged($event)\" class=\"hide\" />\r\n  </div>\r\n\r\n  <div class=\"dialog-component-content fancy-scrollbar-light result-container\" *ngIf=\"data.result\">\r\n    <div *ngIf=\"data.result.Success\" class=\"sxc-message sxc-message-info\">\r\n      Upload succeeded. See the messages below for more information.\r\n    </div>\r\n    <div *ngIf=\"!data.result.Success\" class=\"sxc-message sxc-message-error\">\r\n      Upload failed. See the messages below for more information.\r\n    </div>\r\n    <div *ngFor=\"let message of data.result.Messages\" class=\"sxc-message\" [ngClass]=\"{\r\n      'sxc-message-warning': message.MessageType === FileUploadMessageTypes.Warning,\r\n      'sxc-message-success': message.MessageType === FileUploadMessageTypes.Success,\r\n      'sxc-message-error': message.MessageType === FileUploadMessageTypes.Error\r\n    }\">\r\n      {{ message.Text }}\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"dialog-component-actions\">\r\n    <ng-container *ngIf=\"!data.result?.Success\">\r\n      <button mat-raised-button (click)=\"closeDialog()\">Cancel</button>\r\n      <button mat-raised-button color=\"accent\" [disabled]=\"!data.files.length || data.uploading || !!data.result\"\r\n        (click)=\"upload()\">\r\n        Upload\r\n      </button>\r\n    </ng-container>\r\n    <ng-container *ngIf=\"data.result?.Success\">\r\n      <button mat-raised-button color=\"accent\" (click)=\"closeDialog(true)\">Close</button>\r\n    </ng-container>\r\n  </div>\r\n</div>\r\n","import { Component, HostBinding, Inject, OnDestroy, OnInit } from '@angular/core';\r\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { BehaviorSubject, Subscription, take } from 'rxjs';\r\nimport { FileUploadDialogData, FileUploadMessageTypes, FileUploadResult } from './file-upload-dialog.models';\r\n\r\n@Component({\r\n  selector: 'app-file-upload-dialog',\r\n  templateUrl: './file-upload-dialog.component.html',\r\n  styleUrls: ['./file-upload-dialog.component.scss'],\r\n})\r\nexport class FileUploadDialogComponent implements OnInit, OnDestroy {\r\n  @HostBinding('className') hostClass = 'dialog-component';\r\n\r\n  uploading$ = new BehaviorSubject<boolean>(false);\r\n  files$ = new BehaviorSubject<File[]>([]);\r\n  result$ = new BehaviorSubject<FileUploadResult>(undefined);\r\n  FileUploadMessageTypes = FileUploadMessageTypes;\r\n\r\n  private subscription = new Subscription();\r\n\r\n  constructor(\r\n    @Inject(MAT_DIALOG_DATA) public dialogData: FileUploadDialogData,\r\n    private dialogRef: MatDialogRef<FileUploadDialogComponent>,\r\n    private snackBar: MatSnackBar,\r\n  ) { }\r\n\r\n  ngOnInit(): void {\r\n    this.subscription.add(\r\n      this.files$.subscribe(() => {\r\n        if (this.result$.value !== undefined) {\r\n          this.result$.next(undefined);\r\n        }\r\n      }),\r\n    );\r\n\r\n    if (this.dialogData.files != null) {\r\n      this.filesDropped(this.dialogData.files);\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.uploading$.complete();\r\n    this.files$.complete();\r\n    this.result$.complete();\r\n    this.subscription.unsubscribe();\r\n  }\r\n\r\n  closeDialog(refresh?: boolean): void {\r\n    this.dialogRef.close(refresh);\r\n  }\r\n\r\n  filesDropped(files: File[]): void {\r\n    this.setFiles(files);\r\n    this.upload();\r\n  }\r\n\r\n  filesChanged(event: Event): void {\r\n    const fileList = (event.target as HTMLInputElement).files;\r\n    const files = Array.from(fileList);\r\n    this.setFiles(files);\r\n  }\r\n\r\n  upload(): void {\r\n    this.uploading$.next(true);\r\n    this.subscription.add(\r\n      this.dialogData.upload$(this.files$.value).pipe(take(1)).subscribe({\r\n        next: (result) => {\r\n          this.uploading$.next(false);\r\n          this.result$.next(result);\r\n        },\r\n        error: () => {\r\n          this.uploading$.next(false);\r\n          this.result$.next(undefined);\r\n          this.snackBar.open('Upload failed. Please check console for more information', undefined, { duration: 3000 });\r\n        },\r\n      }),\r\n    );\r\n  }\r\n\r\n  private setFiles(files: File[]): void {\r\n    if (!this.dialogData.multiple) {\r\n      files = files.slice(0, 1);\r\n    }\r\n    this.files$.next(files);\r\n  }\r\n}\r\n","import { Observable } from 'rxjs';\r\n\r\nexport interface FileUploadDialogData {\r\n  title?: string;\r\n  description?: string;\r\n  allowedFileTypes?: string;\r\n  files?: File[];\r\n  multiple?: boolean;\r\n  upload$?(files: File[]): Observable<FileUploadResult>;\r\n}\r\n\r\nexport interface FileUploadResult {\r\n  Messages: FileUploadResultMessage[];\r\n  Success: boolean;\r\n}\r\n\r\nexport interface FileUploadResultMessage {\r\n  MessageType: FileUploadMessageType;\r\n  Text: string;\r\n}\r\n\r\nexport const FileUploadMessageTypes = {\r\n  Warning: 0,\r\n  Success: 1,\r\n  Error: 2,\r\n} as const;\r\n\r\nexport type FileUploadMessageType = typeof FileUploadMessageTypes[keyof typeof FileUploadMessageTypes];\r\n","import { Directive, ElementRef, EventEmitter, HostListener, Input, NgZone, OnDestroy, OnInit, Output } from '@angular/core';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { fromEvent, Subscription } from 'rxjs';\r\n\r\n@Directive({ selector: '[appDragAndDrop]' })\r\nexport class DragAndDropDirective implements OnInit, OnDestroy {\r\n  @Input() markStyle: 'outline' | 'fill' | 'shadow' = 'outline';\r\n  /** Comma separated file types, e.g. 'txt,doc,docx' */\r\n  @Input() allowedFileTypes = '';\r\n  @Output() private filesDropped = new EventEmitter<File[]>();\r\n\r\n  private element: HTMLElement;\r\n  private dropAreaClass = 'eav-droparea';\r\n  private markStyleClass: string;\r\n  private dragClass = 'eav-dragover';\r\n  private timeouts: number[] = [];\r\n  private subscription = new Subscription();\r\n\r\n  constructor(elementRef: ElementRef, private zone: NgZone, private snackBar: MatSnackBar) {\r\n    this.element = elementRef.nativeElement;\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.markStyleClass = `eav-droparea-${this.markStyle}`;\r\n    this.element.classList.add(this.dropAreaClass, this.markStyleClass);\r\n    this.zone.runOutsideAngular(() => {\r\n      this.subscription.add(\r\n        fromEvent<DragEvent>(this.element, 'dragover').subscribe(event => {\r\n          event.preventDefault();\r\n          event.stopPropagation();\r\n          this.clearTimeouts();\r\n          this.element.classList.add(this.dragClass);\r\n        })\r\n      );\r\n      this.subscription.add(\r\n        fromEvent<DragEvent>(this.element, 'dragleave').subscribe(event => {\r\n          event.preventDefault();\r\n          event.stopPropagation();\r\n          this.timeouts.push(\r\n            window.setTimeout(() => { this.element.classList.remove(this.dragClass); }, 50)\r\n          );\r\n        })\r\n      );\r\n    });\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.clearTimeouts();\r\n    this.element.classList.remove(this.dropAreaClass, this.markStyleClass, this.dragClass);\r\n    this.subscription.unsubscribe();\r\n  }\r\n\r\n  @HostListener('drop', ['$event'])\r\n  onDrop(event: DragEvent) {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n    this.clearTimeouts();\r\n    this.element.classList.remove(this.dragClass);\r\n    const fileList = event.dataTransfer.files;\r\n    let files = Array.from(fileList);\r\n    files = this.filterTypes(files, this.allowedFileTypes);\r\n    if (files.length > 0) {\r\n      this.filesDropped.emit(files);\r\n    }\r\n  }\r\n\r\n  private clearTimeouts() {\r\n    for (const timeout of this.timeouts) {\r\n      clearTimeout(timeout);\r\n    }\r\n    this.timeouts = [];\r\n  }\r\n\r\n  private filterTypes(files: File[], allowedFileTypes: string) {\r\n    if (allowedFileTypes === '') { return files; }\r\n\r\n    const allowedTypes = allowedFileTypes.split(',').map(type => type.toLocaleLowerCase());\r\n    const filtered = files.filter(file => {\r\n      const extIndex = file.name.lastIndexOf('.');\r\n      if (extIndex <= 0) { return false; }\r\n      const ext = file.name.substring(extIndex + 1).toLocaleLowerCase();\r\n      const allowed = allowedTypes.includes(ext);\r\n      return allowed;\r\n    });\r\n\r\n    if (files.length !== filtered.length) {\r\n      const allowedTypesString = this.allowedFileTypes.replace(/\\,/g, ', ');\r\n      const message = filtered.length\r\n        ? 'Some files were filtered out. This drop location only accepts file types: ' + allowedTypesString\r\n        : 'This drop location only accepts file types: ' + allowedTypesString;\r\n      this.snackBar.open(message, null, { duration: 5000 });\r\n    }\r\n    return filtered;\r\n  }\r\n}\r\n","import { Pipe, PipeTransform } from '@angular/core';\r\nimport { DomSanitizer } from '@angular/platform-browser';\r\n\r\n@Pipe({ name: 'safeHtml' })\r\nexport class SafeHtmlPipe implements PipeTransform {\r\n\r\n  constructor(private sanitizer: DomSanitizer) { }\r\n\r\n  transform(html: string) {\r\n    return this.sanitizer.bypassSecurityTrustHtml(html);\r\n  }\r\n}\r\n"],"sourceRoot":"webpack:///","file":"default-projects_eav-ui_src_app_app-administration_services_index_ts.d3ba80c202e644fc.js"}