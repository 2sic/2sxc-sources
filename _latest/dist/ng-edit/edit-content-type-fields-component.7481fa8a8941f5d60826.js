(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{"87pQ":function(e,t,n){"use strict";n.r(t);var i=n("D57K"),o=n("ZSGP"),a=n("LR82"),c=n("cQOC"),r=n("pN2L"),s=n("fa4O"),l=n("4HYP"),p=n("Jg5f"),d=n("z5yO"),u=n("HswR"),b=n("IMYO"),f=n("nBd1");function h(e,t,n){return 0===n?[t]:(e.push(t),e)}var g=n("DOM6"),y={Boolean:{label:"Boolean (yes/no)",description:"Yes/no or true/false values"},Custom:{label:"Custom - ui-tools or custom types",description:"Use for things like gps-pickers (which writes into multiple fields) or for custom-data which serializes something exotic into the db like an array, a custom json or anything"},DateTime:{label:"Date and/or time",description:"For date, time or combined values"},Empty:{label:"Empty - for form-titles etc.",description:"Use to structure your form"},Entity:{label:"Entity (other content-items)",description:"One or more other content-items"},Hyperlink:{label:"Link / file reference",description:"Hyperlink or reference to a picture / file"},Number:{label:"Number",description:"Any kind of number"},String:{label:"Text / string",description:"Any kind of text"}},m=n("ZHmz"),v=n("nsG0"),T=n("DGvA"),O=n("1C3z"),S=n("BLjT"),M=n("5/c3"),B=n("S36y"),U=n("/Foi"),I=n("2pW/"),C=n("8AiQ"),V=n("9HSk"),w=n("hOvr"),F=n("TDrE"),k=n("LuBX"),D=n("r4gC"),P=n("Uk43"),N=n("OeRG");n.d(t,"EditContentTypeFieldsComponent",(function(){return Q}));var j=["ngForm"];function H(e,t){1&e&&(O.Tb(0),O.Oc(1,"Fields"),O.Sb())}function x(e,t){1&e&&(O.Tb(0),O.Oc(1,"Edit Field"),O.Sb())}function E(e,t){1&e&&(O.Tb(0),O.Oc(1,"Add Fields"),O.Sb())}function L(e,t){if(1&e&&(O.Vb(0,"app-field-hint",21),O.Oc(1),O.Ub()),2&e){var n=O.hc(3);O.nc("isError",!0),O.Bb(1),O.Pc(n.fieldNameError)}}function R(e,t){if(1&e&&(O.Tb(0),O.Mc(1,L,2,2,"app-field-hint",20),O.Sb()),2&e){O.hc();var n=O.Bc(6);O.Bb(1),O.nc("ngIf",n.errors.pattern)}}function A(e,t){if(1&e&&(O.Vb(0,"mat-option",22),O.Vb(1,"mat-icon"),O.Oc(2),O.Ub(),O.Vb(3,"span"),O.Oc(4),O.Ub(),O.Ub()),2&e){var n=t.$implicit;O.nc("value",n.name),O.Bb(2),O.Pc(n.icon),O.Bb(2),O.Pc(n.label)}}function $(e,t){if(1&e&&(O.Vb(0,"mat-option",22),O.Oc(1),O.Ub()),2&e){var n=t.$implicit;O.nc("value",n.inputType),O.Bb(1),O.Qc(" ",n.label,"")}}function z(e,t){if(1&e){var n=O.Wb();O.Vb(0,"div",10),O.Vb(1,"div",11),O.Vb(2,"mat-form-field",12),O.Vb(3,"mat-label"),O.Oc(4,"Name"),O.Ub(),O.Vb(5,"input",13,14),O.dc("ngModelChange",(function(e){return O.Dc(n),t.$implicit.StaticName=e})),O.Ub(),O.Ub(),O.Mc(7,R,2,1,"ng-container",15),O.Ub(),O.Vb(8,"div",11),O.Vb(9,"mat-form-field",12),O.Vb(10,"mat-label"),O.Oc(11,"Data Type"),O.Ub(),O.Vb(12,"mat-select",16),O.dc("selectionChange",(function(){O.Dc(n);var e=t.index,i=O.hc();return i.resetInputType(e),i.calculateInputTypeOptions(e),i.calculateHints(e)}))("ngModelChange",(function(e){return O.Dc(n),t.$implicit.Type=e})),O.Vb(13,"mat-select-trigger"),O.Vb(14,"mat-icon",17),O.Oc(15),O.Ub(),O.Vb(16,"span"),O.Oc(17),O.Ub(),O.Ub(),O.Mc(18,A,5,3,"mat-option",18),O.Ub(),O.Ub(),O.Vb(19,"app-field-hint"),O.Oc(20),O.Ub(),O.Ub(),O.Vb(21,"div",11),O.Vb(22,"mat-form-field",12),O.Vb(23,"mat-label"),O.Oc(24,"Input Type"),O.Ub(),O.Vb(25,"mat-select",19),O.dc("selectionChange",(function(){O.Dc(n);var e=t.index;return O.hc().calculateHints(e)}))("ngModelChange",(function(e){return O.Dc(n),t.$implicit.InputType=e})),O.Mc(26,$,2,2,"mat-option",18),O.Ub(),O.Ub(),O.Vb(27,"app-field-hint"),O.Oc(28),O.Ub(),O.Ub(),O.Ub()}if(2&e){var i=t.$implicit,o=t.index,a=O.Bc(6),c=O.hc();O.Bb(5),O.nc("pattern",c.fieldNamePattern)("ngModel",i.StaticName)("name","StaticName"+o)("disabled",c.editMode),O.Bb(2),O.nc("ngIf",a.touched&&a.errors),O.Bb(5),O.nc("ngModel",i.Type)("name","Type"+o)("disabled",c.editMode),O.Bb(3),O.Pc(c.findIcon(i.Type)),O.Bb(2),O.Pc(i.Type),O.Bb(1),O.nc("ngForOf",c.dataTypes),O.Bb(2),O.Pc(c.dataTypeHints[o]),O.Bb(5),O.nc("ngModel",i.InputType)("name","InputType"+o),O.Bb(1),O.nc("ngForOf",c.filteredInputTypeOptions[o]),O.Bb(2),O.Pc(c.inputTypeHints[o])}}var Q=function(){function e(e,t,n,i,o){var c=this;this.dialogRef=e,this.route=t,this.contentTypesService=n,this.contentTypesFieldsService=i,this.snackBar=o,this.hostClass="dialog-component",this.fields=[],this.filteredInputTypeOptions=[],this.dataTypeHints=[],this.inputTypeHints=[],this.fieldNamePattern=m.b,this.fieldNameError=m.a,this.findIcon=g.a,this.subscription=new a.a,this.dialogRef.disableClose=!0,this.subscription.add(this.dialogRef.backdropClick().subscribe((function(e){c.form.dirty&&!confirm("You have unsaved changes. Are you sure you want to close this dialog?")||c.closeDialog()})))}return e.prototype.ngOnInit=function(){var e=this,t=this.route.snapshot.paramMap.get("contentTypeStaticName"),n=this.route.snapshot.paramMap.get("id")?parseInt(this.route.snapshot.paramMap.get("id"),10):null;this.editMode=null!==n;var o=this.contentTypesService.retrieveContentType(t).pipe(Object(s.a)()),a=o.pipe(Object(l.a)((function(t){return e.contentTypesFieldsService.getFields(t)}))),r=this.contentTypesFieldsService.typeListRetrieve().pipe(Object(p.a)((function(e){return function(e){var t,n,o=[];try{for(var a=Object(i.i)(e),c=a.next();!c.done;c=a.next()){var r=c.value;o.push({name:r,label:y[r].label,icon:Object(g.a)(r),description:y[r].description})}}catch(s){t={error:s}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return o}(e)}))),d=this.contentTypesFieldsService.getInputTypesList();Object(c.a)([o,a,r,d]).subscribe((function(t){var o=Object(i.f)(t,4),a=o[1],c=o[2],r=o[3];e.contentType=o[0];var s=a;if(e.dataTypes=c,e.inputTypeOptions=r,e.editMode){var l=s.find((function(e){return e.Id===n}));e.fields.push(l)}else for(var p=1;p<=8;p++)e.fields.push({Id:0,Type:T.a.String,InputType:v.a.StringDefault,StaticName:"",IsTitle:0===s.length,SortOrder:s.length+p});for(p=0;p<e.fields.length;p++)e.calculateInputTypeOptions(p),e.calculateHints(p)}))},e.prototype.ngOnDestroy=function(){this.subscription.unsubscribe()},e.prototype.closeDialog=function(){this.dialogRef.close()},e.prototype.resetInputType=function(e){this.fields[e].InputType=this.fields[e].Type.toLowerCase()+v.a.DefaultSuffix},e.prototype.calculateInputTypeOptions=function(e){var t=this;this.filteredInputTypeOptions[e]=this.inputTypeOptions.filter((function(n){return n.dataType===t.fields[e].Type.toLowerCase()}))},e.prototype.calculateHints=function(e){var t=this,n=this.dataTypes.find((function(n){return n.name===t.fields[e].Type})),i=this.inputTypeOptions.find((function(n){return n.inputType===t.fields[e].InputType}));this.dataTypeHints[e]=n?n.description:"",this.inputTypeHints[e]=i?i.description:""},e.prototype.save=function(){var e=this;if(this.snackBar.open("Saving..."),this.editMode){var t=this.fields[0];this.contentTypesFieldsService.updateInputType(t.Id,t.StaticName,t.InputType).subscribe((function(t){e.snackBar.open("Saved",null,{duration:2e3}),e.closeDialog()}))}else r.a.apply(void 0,Object(i.g)(this.fields)).pipe(Object(d.a)((function(e){return!!e.StaticName})),Object(u.a)((function(t){return e.contentTypesFieldsService.add(t,e.contentType.Id).pipe(Object(b.a)((function(e){return Object(r.a)(null)})))})),Object(f.a)(h,[])).subscribe((function(t){e.snackBar.open("Saved",null,{duration:2e3}),e.closeDialog()}))},e.\u0275fac=function(t){return new(t||e)(O.Pb(S.g),O.Pb(M.a),O.Pb(B.a),O.Pb(U.a),O.Pb(I.b))},e.\u0275cmp=O.Jb({type:e,selectors:[["app-edit-content-type-fields"]],viewQuery:function(e,t){var n;1&e&&O.Uc(j,!0,o.n),2&e&&O.Ac(n=O.ec())&&(t.form=n.first)},hostVars:1,hostBindings:function(e,t){2&e&&O.Yb("className",t.hostClass)},decls:14,vars:6,consts:[["mat-dialog-title",""],[1,"dialog-title-box",3,"ngSwitch"],[4,"ngSwitchCase"],[1,"dialog-form"],["ngForm","ngForm"],[1,"dialog-form-content","fancy-scrollbar-light"],["class","row-container",4,"ngFor","ngForOf"],[1,"dialog-form-actions"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click"],[1,"row-container"],[1,"edit-input"],["appearance","standard","color","accent"],["matInput","",3,"pattern","ngModel","name","disabled","ngModelChange"],["staticName","ngModel"],[4,"ngIf"],[3,"ngModel","name","disabled","selectionChange","ngModelChange"],[1,"type-icon"],[3,"value",4,"ngFor","ngForOf"],[3,"ngModel","name","selectionChange","ngModelChange"],[3,"isError",4,"ngIf"],[3,"isError"],[3,"value"]],template:function(e,t){if(1&e&&(O.Vb(0,"div",0),O.Vb(1,"div",1),O.Mc(2,H,2,0,"ng-container",2),O.Mc(3,x,2,0,"ng-container",2),O.Mc(4,E,2,0,"ng-container",2),O.Ub(),O.Ub(),O.Vb(5,"form",3,4),O.Vb(7,"div",5),O.Mc(8,z,29,16,"div",6),O.Ub(),O.Vb(9,"div",7),O.Vb(10,"button",8),O.dc("click",(function(){return t.closeDialog()})),O.Oc(11,"Cancel"),O.Ub(),O.Vb(12,"button",9),O.dc("click",(function(){return t.save()})),O.Oc(13,"Save"),O.Ub(),O.Ub(),O.Ub()),2&e){var n=O.Bc(6);O.Bb(1),O.nc("ngSwitch",t.editMode),O.Bb(1),O.nc("ngSwitchCase",void 0),O.Bb(1),O.nc("ngSwitchCase",!0),O.Bb(1),O.nc("ngSwitchCase",!1),O.Bb(4),O.nc("ngForOf",t.fields),O.Bb(4),O.nc("disabled",!n.form.valid)}},directives:[S.h,C.o,C.p,o.u,o.m,o.n,C.l,V.a,w.c,w.g,F.b,o.b,o.q,o.l,o.o,C.m,k.a,k.c,D.a,P.a,N.l],styles:[".row-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.edit-input[_ngcontent-%COMP%]{padding-bottom:8px;width:30%}.type-icon[_ngcontent-%COMP%]{width:inherit;height:inherit;margin-right:8px;font-size:inherit;vertical-align:top;line-height:inherit}"]}),e}()}}]);
//# sourceMappingURL=https://sources.2sxc.org/11.05.01/ng-edit/edit-content-type-fields-component.7481fa8a8941f5d60826.js.map