{"version":3,"file":"projects_eav-ui_src_app_visual-query_visual-query_component_ts.js","mappings":"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","sources":["./projects/eav-ui/src/app/app-administration/services/index.ts","./projects/eav-ui/src/app/app-administration/services/pipelines.service.ts","./projects/eav-ui/src/app/app-administration/services/views.service.ts","./projects/eav-ui/src/app/shared/directives/mousedown-stop-propagation.directive.ts","./projects/eav-ui/src/app/shared/helpers/array.helpers.ts","./projects/eav-ui/src/app/shared/helpers/file-to-base64.helper.ts","./projects/eav-ui/src/app/visual-query/add-explorer/add-explorer.component.ts","./projects/eav-ui/src/app/visual-query/add-explorer/add-explorer.component.html","./projects/eav-ui/src/app/visual-query/add-explorer/add-explorer.helpers.ts","./projects/eav-ui/src/app/visual-query/plumb-editor/endpoints.helper.ts","./projects/eav-ui/src/app/visual-query/plumb-editor/plumb-editor.component.ts","./projects/eav-ui/src/app/visual-query/plumb-editor/plumb-editor.component.html","./projects/eav-ui/src/app/visual-query/plumb-editor/plumb-editor.helpers.ts","./projects/eav-ui/src/app/visual-query/plumb-editor/plumber.helper.ts","./projects/eav-ui/src/app/visual-query/plumb-editor/rename-stream/rename-stream.component.ts","./projects/eav-ui/src/app/visual-query/plumb-editor/rename-stream/rename-stream.component.html","./projects/eav-ui/src/app/visual-query/query-result/query-result.component.ts","./projects/eav-ui/src/app/visual-query/query-result/query-result.component.html","./projects/eav-ui/src/app/visual-query/run-explorer/run-explorer.component.ts","./projects/eav-ui/src/app/visual-query/run-explorer/run-explorer.component.html","./projects/eav-ui/src/app/visual-query/run-explorer/run-explorer.helpers.ts","./projects/eav-ui/src/app/visual-query/services/query-definition.service.ts","./projects/eav-ui/src/app/visual-query/services/visual-query.service.ts","./projects/eav-ui/src/app/visual-query/stream-error-result/stream-error-result.component.ts","./projects/eav-ui/src/app/visual-query/stream-error-result/stream-error-result.component.html","./projects/eav-ui/src/app/visual-query/visual-query.component.ts","./projects/eav-ui/src/app/visual-query/visual-query.component.html"],"sourcesContent":["export * from './dialog-config-global.service';\r\nexport * from './content-types.service';\r\nexport * from './export-app-parts.service';\r\nexport * from './export-app.service';\r\nexport * from './import-app-parts.service';\r\nexport * from './pipelines.service';\r\nexport * from './views.service';\r\n","import { Injectable } from '@angular/core';\r\nimport { from, map, switchMap } from 'rxjs';\r\nimport { FileUploadResult } from '../../shared/components/file-upload-dialog';\r\nimport { toBase64 } from '../../shared/helpers/file-to-base64.helper';\r\nimport { webApiEntityList } from '../../shared/services/entity.service';\r\nimport { HttpServiceBase } from '../../shared/services/http-service-base';\r\nimport { Query } from '../models/query.model';\r\n\r\nconst webApiQueryImport = 'admin/query/import';\r\nconst webApiQueryClone = 'admin/query/Clone';\r\nconst webApiQueryDelete = 'admin/query/Delete';\r\nexport const webApiQueryRun = 'admin/query/Run';\r\nexport const webApiQueryDebugStream = 'admin/query/DebugStream';\r\nexport const webApiQuerySave = 'admin/query/Save';\r\nexport const webApiQueryGet = 'admin/query/Get';\r\nexport const webApiQueryDataSources = 'admin/query/DataSources';\r\n\r\n@Injectable()\r\nexport class PipelinesService extends HttpServiceBase {\r\n\r\n  getAll(contentType: string) {\r\n    return this.getHttpApiUrl<Query[]>(webApiEntityList, {\r\n      params: { appId: this.appId, contentType }\r\n    });\r\n  }\r\n\r\n  importQuery(file: File) {\r\n    return from(toBase64(file)).pipe(\r\n      switchMap(fileBase64 => {\r\n        return this.http.post<boolean>(this.apiUrl(webApiQueryImport), {\r\n          AppId: this.appId,\r\n          ContentBase64: fileBase64,\r\n        });\r\n      }),\r\n      map(success => {\r\n        const result: FileUploadResult = {\r\n          Success: success,\r\n          Messages: [],\r\n        };\r\n        return result;\r\n      }),\r\n    );\r\n  }\r\n\r\n  clonePipeline(id: number) {\r\n    return this.getHttpApiUrl<null>(webApiQueryClone, {\r\n      params: { Id: id.toString(), appId: this.appId }\r\n    });\r\n  }\r\n\r\n  delete(id: number) {\r\n    return this.http.delete<boolean>(this.apiUrl(webApiQueryDelete), {\r\n      params: { appId: this.appId, Id: id.toString() },\r\n    });\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { FileUploadResult } from '../../shared/components/file-upload-dialog';\r\nimport { HttpServiceBase } from '../../shared/services/http-service-base';\r\nimport { Polymorphism } from '../models/polymorphism.model';\r\nimport { ViewUsage } from '../models/view-usage.model';\r\nimport { View } from '../models/view.model';\r\n\r\nconst webApiViewRoot = 'admin/view/';\r\nconst webApiViews = webApiViewRoot + 'all';\r\nconst webApiViewDelete = webApiViewRoot + 'delete';\r\nconst webApiViewImport = webApiViewRoot + 'import';\r\nconst webApiViewPolymorph = webApiViewRoot + 'polymorphism';\r\nconst webApiViewUsage = webApiViewRoot + 'usage';\r\n\r\n@Injectable()\r\nexport class ViewsService extends HttpServiceBase {\r\n\r\n  getAll() {\r\n    return this.getHttpApiUrl<View[]>(webApiViews, {\r\n      params: { appId: this.appId }\r\n    });\r\n  }\r\n\r\n  delete(id: number) {\r\n    return this.getHttpApiUrl<boolean>(webApiViewDelete, {\r\n      params: { appId: this.appId, Id: id.toString() },\r\n    });\r\n  }\r\n\r\n  import(file: File) {\r\n    const formData = new FormData();\r\n    formData.append('File', file);\r\n    return this.http.post<FileUploadResult>(this.apiUrl(webApiViewImport), formData, {\r\n      params: { appId: this.appId, zoneId: this.zoneId }\r\n    });\r\n  }\r\n\r\n  export(id: number) {\r\n    const url = this.apiUrl(webApiViewRoot + 'json')\r\n      + '?appId=' + this.appId\r\n      + '&viewId=' + id;\r\n\r\n    window.open(url, '_blank', '');\r\n  }\r\n\r\n  getPolymorphism() {\r\n    return this.getHttpApiUrl<Polymorphism>(webApiViewPolymorph, {\r\n      params: { appId: this.appId }\r\n    });\r\n  }\r\n\r\n  getUsage(guid: string) {\r\n    return this.getHttpApiUrl<ViewUsage[]>(webApiViewUsage, {\r\n      params: { appId: this.appId, guid }\r\n    });\r\n  }\r\n}\r\n","import { Directive, HostListener } from '@angular/core';\r\n\r\n@Directive({\r\n  selector: '[appMousedownStopPropagation]',\r\n  standalone: true\r\n})\r\nexport class MousedownStopPropagationDirective {\r\n  @HostListener('mousedown', ['$event'])\r\n  onMousedown(event: MouseEvent): void {\r\n    event.stopPropagation();\r\n  }\r\n}\r\n","export class ArrayHelpers {\r\n  /**\r\n   * Toggles an item in an array. If the item is not in the array, it is added. If it is in the array, it is removed.\r\n   * @param item The item to toggle\r\n   * @param array The array to toggle the item in\r\n   */\r\n  static toggleInArray<T>(item: T, array: T[]): void {\r\n    const index = array.indexOf(item);\r\n    if (index === -1) {\r\n      array.push(item);\r\n    } else {\r\n      array.splice(index, 1);\r\n    }\r\n  }\r\n\r\n  // probably better: Array.from(new Set(merged));\r\n  // static distinct<T extends unknown>(array: T[]): T[] {\r\n  //   return array.filter(onlyUnique);\r\n  // }\r\n\r\n}\r\n\r\n\r\n// function onlyUnique<T extends unknown>(value: T, index: number, array: T[]): boolean {\r\n//   return array.indexOf(value) === index;\r\n// }","export function toBase64(file: File): Promise<string> {\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    reader.readAsDataURL(file);\r\n    reader.onload = () => {\r\n      resolve((reader.result as string).split(',')[1]);\r\n    };\r\n    reader.onerror = error => {\r\n      reject(error);\r\n    };\r\n  });\r\n}\r\n\r\nexport function toString(file: File): Promise<string> {\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    reader.readAsText(file);\r\n    reader.onload = () => {\r\n      resolve(reader.result as string);\r\n    };\r\n    reader.onerror = error => {\r\n      reject(error);\r\n    };\r\n  });\r\n}\r\n","import { AsyncPipe, KeyValue, KeyValuePipe } from '@angular/common';\r\nimport { Component, computed, signal } from '@angular/core';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatSlideToggleChange, MatSlideToggleModule } from '@angular/material/slide-toggle';\r\nimport { eavConstants } from '../../shared/constants/eav.constants';\r\nimport { TippyDirective } from '../../shared/directives/tippy.directive';\r\nimport { ArrayHelpers } from '../../shared/helpers/array.helpers';\r\nimport { DataSource } from '../models';\r\nimport { guiTypes } from '../plumb-editor/plumb-editor.helpers';\r\nimport { VisualQueryStateService } from '../services/visual-query.service';\r\nimport { filterAndSortDataSources } from './add-explorer.helpers';\r\n\r\n@Component({\r\n  selector: 'app-add-explorer',\r\n  templateUrl: './add-explorer.component.html',\r\n  styleUrls: ['./add-explorer.component.scss'],\r\n  standalone: true,\r\n  imports: [\r\n    MatSlideToggleModule,\r\n    MatIconModule,\r\n    AsyncPipe,\r\n    KeyValuePipe,\r\n    TippyDirective,\r\n  ],\r\n})\r\nexport class AddExplorerComponent {\r\n  toggledItems: string[] = [];\r\n  guiTypes = guiTypes;\r\n\r\n  #difficulties = eavConstants.pipelineDesigner.dataSourceDifficulties;\r\n\r\n  #difficulty = signal(this.#difficulties.default);\r\n\r\n  sorted = computed(() => filterAndSortDataSources(this.visualQueryService.dataSources(), this.#difficulty()));\r\n\r\n  constructor(private visualQueryService: VisualQueryStateService) { }\r\n\r\n  toggleDifficulty(event: MatSlideToggleChange) {\r\n    const difficulty = event.checked ? this.#difficulties.advanced : this.#difficulties.default;\r\n    this.#difficulty.set(difficulty);\r\n  }\r\n\r\n  addDataSource(dataSource: DataSource) {\r\n    this.visualQueryService.addDataSource(dataSource);\r\n  }\r\n\r\n  toggleItem(item: string) {\r\n    ArrayHelpers.toggleInArray(item, this.toggledItems);\r\n  }\r\n\r\n  trackGroups(index: number, type: KeyValue<string, DataSource[]>) {\r\n    return type.key;\r\n  }\r\n\r\n  trackDataSources(index: number, dataSource: DataSource) {\r\n    return dataSource.PartAssemblyAndType;\r\n  }\r\n}\r\n","@if (sorted()) {\r\n  <div class=\"editor-active-explorer fancy-scrollbar-dark\">\r\n    <div class=\"eav-show-advanced\">\r\n      <span class=\"eav-slide-toggle-label\">Show Advanced</span>\r\n      <mat-slide-toggle color=\"primary\" (change)=\"toggleDifficulty($event)\" />\r\n    </div>\r\n    @for (group of sorted() | keyvalue; track trackGroups($index, group)) {\r\n      <div class=\"collapsible\" [tippy]=\"guiTypes[group.key].UiHint || group.key\" tippyShowDelay=\"750\"\r\n        (click)=\"toggleItem(group.key)\">\r\n        <mat-icon>{{ guiTypes[group.key].Icon || guiTypes.Unknown.Icon }}</mat-icon>\r\n        <span>{{ guiTypes[group.key].Label ?? guiTypes[group.key].Name ?? group.key }}</span>\r\n      </div>\r\n      @if (toggledItems.includes(group.key)) {\r\n        <div class=\"list\">\r\n          @for (dataSource of group.value; track trackDataSources($index, dataSource)) {\r\n            <div class=\"list-item\"\r\n              [tippy]=\"dataSource.UiHint || dataSource.Name\" tippyShowDelay=\"750\" (click)=\"addDataSource(dataSource)\">\r\n              <mat-icon>{{ dataSource.Icon || guiTypes.Unknown.Icon }}</mat-icon>\r\n              <span>{{ dataSource.Name }}</span>\r\n            </div>\r\n          }\r\n        </div>\r\n      }\r\n    }\r\n  </div>\r\n}\r\n","import cloneDeep from 'lodash-es/cloneDeep';\r\nimport { eavConstants } from '../../shared/constants/eav.constants';\r\nimport { DataSource, SortedDataSources } from '../models';\r\n\r\nexport function filterAndSortDataSources(dataSources: DataSource[], maxDifficulty: number) {\r\n  if (!dataSources) return;\r\n\r\n  const cloned = cloneDeep(dataSources);\r\n\r\n  const filtered = cloned.filter(dataSource =>\r\n    dataSource.Difficulty <= maxDifficulty\r\n    && dataSource.PartAssemblyAndType !== eavConstants.pipelineDesigner.outDataSource.PartAssemblyAndType\r\n  );\r\n\r\n  filtered.sort((a, b) => a.Name.toLocaleLowerCase().localeCompare(b.Name.toLocaleLowerCase()));\r\n\r\n  const sorted: SortedDataSources = {};\r\n  for (const dataSource of filtered) {\r\n    const type = dataSource.PrimaryType;\r\n    if (sorted[type]) {\r\n      sorted[type].push(dataSource);\r\n    } else {\r\n      sorted[type] = [dataSource];\r\n    }\r\n  }\r\n\r\n  return sorted;\r\n}\r\n","import { classLog } from '../../shared/logging';\r\nimport { EndpointInfo, PlumbType } from './plumb-editor.models';\r\nimport { Plumber } from './plumber.helper';\r\n\r\nconst logSpecs = {\r\n  all: true,\r\n  getEndpointOverlays: true,\r\n  getEndpointInfo: true,\r\n  buildSourceEndpoint: true,\r\n  buildTargetEndpoint: true,\r\n}\r\n\r\nexport class EndpointsHelper {\r\n\r\n  log = classLog({EndpointsHelper}, logSpecs);\r\n\r\n  constructor(private plumb: Plumber) { }\r\n\r\n  private getEndpointOverlays(isSource: boolean) {\r\n    const l = this.log.fnIf('getEndpointOverlays', {isSource});\r\n    const result = [\r\n      [\r\n        'Label', {\r\n          id: 'endpointLabel',\r\n          location: [0.5, isSource ? 0 : 1],\r\n          label: 'Default',\r\n          cssClass: isSource ? 'endpointSourceLabel' : 'endpointTargetLabel',\r\n        },\r\n      ],\r\n    ];\r\n    return l.r(result);\r\n  }\r\n\r\n  getEndpointInfo(endpointName: string, isDynamic: boolean): EndpointInfo {\r\n    const l = this.log.fnIf('getEndpointInfo', {endpointName, isDynamic});\r\n    let name: string;\r\n    let required: boolean;\r\n\r\n    const trimmed = endpointName.trim();\r\n    required = trimmed.endsWith('*');\r\n    name = !required ? trimmed : trimmed.substring(0, trimmed.length - 1);\r\n\r\n    if (isDynamic)\r\n      return l.r({\r\n        name,\r\n        required: false\r\n      } satisfies EndpointInfo, 'isDynamic');\r\n\r\n    return l.r({ name, required } satisfies EndpointInfo, 'notDynamic');\r\n  }\r\n\r\n  buildSourceEndpoint(pipelineDataSourceGuid: string, style?: string) {\r\n    const l = this.log.fnIf('buildSourceEndpoint', {pipelineDataSourceGuid, style});\r\n    const isSource = true;\r\n    const sourceEndpoint = {\r\n      paintStyle: { fill: 'transparent', radius: 10 },\r\n      cssClass: 'sourceEndpoint ' + (style ?? ''),\r\n      maxConnections: -1,\r\n      isSource,\r\n      anchor: ['Continuous', { faces: ['top'] }],\r\n      overlays: this.getEndpointOverlays(isSource),\r\n      events: {\r\n        click: (endpointOrOverlay: PlumbType) => this.plumb.onChangeLabel(endpointOrOverlay, isSource, pipelineDataSourceGuid),\r\n      },\r\n    };\r\n    return l.r(sourceEndpoint);\r\n  }\r\n\r\n  buildTargetEndpoint(pipelineDataSourceGuid: string, style?: string) {\r\n    const l = this.log.fnIf('buildTargetEndpoint', {pipelineDataSourceGuid, style});\r\n    const isSource = false;\r\n    const targetEndpoint = {\r\n      paintStyle: { fill: 'transparent', radius: 10 },\r\n      cssClass: 'targetEndpoint ' + (style ?? ' '), // + (angled ? 'angled' : ''),\r\n      maxConnections: 1,\r\n      isTarget: !isSource,\r\n      anchor: ['Continuous', { faces: ['bottom'] }],\r\n      overlays: this.getEndpointOverlays(isSource),\r\n      dropOptions: { hoverClass: 'hover', activeClass: 'active' },\r\n      events: {\r\n        click: (endpointOrOverlay: PlumbType) => this.plumb.onChangeLabel(endpointOrOverlay, isSource, pipelineDataSourceGuid),\r\n      },\r\n    };\r\n    return l.r(targetEndpoint);\r\n  }\r\n}\r\n","// tslint:disable-next-line:max-line-length\r\nimport { AsyncPipe, NgClass, NgStyle } from '@angular/common';\r\nimport { AfterViewInit, ChangeDetectorRef, Component, computed, ElementRef, OnDestroy, OnInit, QueryList, ViewChild, ViewChildren, ViewContainerRef } from '@angular/core';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { BehaviorSubject, combineLatest, map } from 'rxjs';\r\nimport { transient } from '../../../../../core';\r\nimport { BaseComponent } from '../../shared/components/base.component';\r\nimport { eavConstants } from '../../shared/constants/eav.constants';\r\nimport { MousedownStopPropagationDirective } from '../../shared/directives/mousedown-stop-propagation.directive';\r\nimport { JsonHelpers } from '../../shared/helpers/json.helpers';\r\nimport { loadScripts } from '../../shared/helpers/load-scripts.helper';\r\nimport { classLog } from '../../shared/logging';\r\nimport { PipelineDataSource, PipelineResultStream, VisualDesignerData } from '../models';\r\nimport { QueryDefinitionService } from '../services/query-definition.service';\r\nimport { VisualQueryStateService } from '../services/visual-query.service';\r\nimport { calculateTypeInfos } from './plumb-editor.helpers';\r\nimport { dataSrcIdPrefix, Plumber } from './plumber.helper';\r\n\r\nconst logSpecs = {\r\n  all: false,\r\n  ngAfterViewInit: false,\r\n}\r\n\r\nconst jsPlumbUrl = 'https://cdnjs.cloudflare.com/ajax/libs/jsPlumb/2.14.5/js/jsplumb.min.js';\r\n\r\n@Component({\r\n  selector: 'app-plumb-editor',\r\n  templateUrl: './plumb-editor.component.html',\r\n  styles: [':host { display: block; width: 100%; height: 100%; }'],\r\n  standalone: true,\r\n  imports: [\r\n    NgStyle,\r\n    NgClass,\r\n    MatIconModule,\r\n    AsyncPipe,\r\n    MousedownStopPropagationDirective,\r\n  ],\r\n})\r\nexport class PlumbEditorComponent extends BaseComponent implements OnInit, AfterViewInit, OnDestroy {\r\n\r\n  log = classLog({ PlumbEditorComponent }, logSpecs);\r\n\r\n  @ViewChild('domRoot') private domRootRef: ElementRef<HTMLDivElement>;\r\n  @ViewChildren('domDataSource') private domDataSourcesRef: QueryList<ElementRef<HTMLDivElement>>;\r\n\r\n  dataSrcIdPrefix = dataSrcIdPrefix;\r\n  hardReset = false;\r\n\r\n  #plumber: Plumber;\r\n  #scriptLoaded$ = new BehaviorSubject(false);\r\n\r\n\r\n  #queryDefinitionSvc = transient(QueryDefinitionService);\r\n\r\n  showDataSourceDetails = computed(() => {\r\n    const result = JsonHelpers.tryParse(this.vsSvc.pipelineModel()?.Pipeline.VisualDesignerData) ?? {};\r\n    return result.ShowDataSourceDetails ?? false;\r\n  });\r\n\r\n  typeInfos = computed(() =>\r\n    calculateTypeInfos(this.vsSvc.pipelineModel()?.DataSources ?? [], this.vsSvc.dataSources()\r\n    ));\r\n\r\n  constructor(\r\n    public vsSvc: VisualQueryStateService, // Check if this not with transient better\r\n    private changeDetectorRef: ChangeDetectorRef,\r\n    private matDialog: MatDialog,\r\n    private viewContainerRef: ViewContainerRef,\r\n  ) { super(); }\r\n\r\n  ngOnInit() {\r\n    loadScripts([{ test: 'jsPlumb', src: jsPlumbUrl }], () => {\r\n      this.#scriptLoaded$.next(true);\r\n    });\r\n\r\n    this.subscriptions.add(\r\n      this.vsSvc.putEntityCountOnConnections$.subscribe(result => {\r\n        this.#plumber.putEntityCountOnConnections(result);\r\n      })\r\n    );\r\n\r\n    // this.viewModel$ = combineLatest([\r\n    //   this.vsSvc.pipelineModel$,\r\n    // ]).pipe(\r\n    //   map(([pipelineModel]) => {\r\n    //     if (pipelineModel == null) return;\r\n\r\n    //     // workaround for jsPlumb not working with dom elements which it initialized on previously.\r\n    //     // This wipes dom entirely and gives us new elements\r\n    // TODO: @2dm Check with Daniel\r\n    //     this.hardReset = true;\r\n    //     this.changeDetectorRef.detectChanges();\r\n    //     this.hardReset = false;\r\n    //     const viewModel: PlumbEditorViewModel = {\r\n    //       removed: \"removeLater\",\r\n    //     };\r\n    //     return viewModel;\r\n    //   }),\r\n    // );\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    const l = this.log.fnIf('ngAfterViewInit');\r\n    // https://stackoverflow.com/questions/37087864/execute-a-function-when-ngfor-finished-in-angular-2/37088348#37088348\r\n    const domDataSourcesLoaded$ = this.domDataSourcesRef.changes.pipe(map(() => true));\r\n\r\n    this.subscriptions.add(\r\n      combineLatest([this.#scriptLoaded$, domDataSourcesLoaded$]).subscribe(([scriptLoaded, domDataSourcesLoaded]) => {\r\n        if (!scriptLoaded || !domDataSourcesLoaded)\r\n          return;\r\n\r\n        l.a('scriptLoaded and domDataSourcesLoaded', { scriptLoaded, domDataSourcesLoaded });\r\n\r\n        this.#plumber?.destroy();\r\n        this.#plumber = new Plumber(\r\n          this.domRootRef.nativeElement,\r\n          this.vsSvc.pipelineModel(),\r\n          this.vsSvc.dataSources(),\r\n          this.onConnectionsChanged.bind(this),\r\n          this.onDragend.bind(this),\r\n          this.onDebugStream.bind(this),\r\n          this.matDialog,\r\n          this.viewContainerRef,\r\n          this.changeDetectorRef,\r\n        );\r\n      })\r\n    );\r\n    l.end();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.#plumber?.destroy();\r\n    this.#scriptLoaded$.complete();\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  onConnectionsChanged() {\r\n    const connections = this.#plumber.getAllConnections();\r\n    const streamsOut = this.#plumber.getStreamsOut();\r\n    this.vsSvc.changeConnections(connections, streamsOut);\r\n  }\r\n\r\n  onDragend(pipelineDataSourceGuid: string, position: VisualDesignerData) {\r\n    this.vsSvc.changeDataSourcePosition(pipelineDataSourceGuid, position);\r\n  }\r\n\r\n  onDebugStream(stream: PipelineResultStream) {\r\n    this.vsSvc.debugStream(stream);\r\n  }\r\n\r\n  configureDataSource(dataSource: PipelineDataSource): void {\r\n    // ensure dataSource entity is saved\r\n    if (dataSource.EntityGuid.includes('unsaved'))\r\n      return this.vsSvc.saveAndRun(true, false);\r\n\r\n    this.vsSvc.editDataSource(dataSource);\r\n  }\r\n\r\n  getTypeName(partAssemblyAndType: string) {\r\n    const dataSource = this.vsSvc.dataSources().find(ds => ds.PartAssemblyAndType === partAssemblyAndType);\r\n    return this.#queryDefinitionSvc.typeNameFilter(dataSource?.TypeNameForUi || partAssemblyAndType, 'className');\r\n  }\r\n\r\n  isOutDataSource(pipelineDataSource: PipelineDataSource) {\r\n    return pipelineDataSource.PartAssemblyAndType === eavConstants.pipelineDesigner.outDataSource.PartAssemblyAndType;\r\n  }\r\n\r\n  remove(pipelineDataSource: PipelineDataSource) {\r\n    if (!confirm(`Delete ${pipelineDataSource.Name} data source?`)) return;\r\n\r\n    this.#plumber.removeEndpointsOnDataSource(pipelineDataSource.EntityGuid);\r\n    const connections = this.#plumber.getAllConnections();\r\n    const streamsOut = this.#plumber.getStreamsOut();\r\n    this.vsSvc.removeDataSource(pipelineDataSource.EntityGuid, connections, streamsOut);\r\n  }\r\n\r\n  openHelp(url: string) {\r\n    window.open(url, '_blank');\r\n  }\r\n\r\n  editName(dataSource: PipelineDataSource) {\r\n    const newName = prompt('Rename data source', dataSource.Name)?.trim();\r\n    if (newName == null || newName === '') return;\r\n\r\n    this.vsSvc.renameDataSource(dataSource.EntityGuid, newName);\r\n  }\r\n\r\n  editDescription(dataSource: PipelineDataSource) {\r\n    const newDescription = prompt('Edit description', dataSource.Description)?.trim();\r\n    if (newDescription == null) return;\r\n\r\n    this.vsSvc.changeDataSourceDescription(dataSource.EntityGuid, newDescription);\r\n  }\r\n\r\n}\r\n","@if (vsSvc.pipelineModel()) {\r\n  <div #domRoot id=\"pipeline-root\">\r\n    <!-- do not use trackBy, jsPlumb drag stops working properly after delete -->\r\n    @if (!hardReset) {\r\n      @for (dataSource of vsSvc.pipelineModel().DataSources; track dataSource) {\r\n        <div\r\n          #domDataSource\r\n          [id]=\"dataSrcIdPrefix + dataSource.EntityGuid\"\r\n          class=\"dataSource\"\r\n          [ngStyle]=\"{\r\n            top: dataSource.VisualDesignerData.Top + 'px',\r\n            left: dataSource.VisualDesignerData.Left + 'px',\r\n            'min-width': dataSource.VisualDesignerData.Width ? dataSource.VisualDesignerData.Width + 'px' : null,\r\n          }\"\r\n          [ngClass]=\"{\r\n            'show-details': showDataSourceDetails() && vsSvc.dataSourceConfigs()[dataSource.EntityId]?.length,\r\n          }\"\r\n        >\r\n          <div class=\"actions left\">\r\n            <mat-icon class=\"type-info\" [title]=\"typeInfos()[dataSource.EntityGuid].UiHint\">\r\n              {{ typeInfos()[dataSource.EntityGuid].Icon }}\r\n            </mat-icon>\r\n            @if (vsSvc.pipelineModel().Pipeline.AllowEdit && typeInfos()[dataSource.EntityGuid].EnableConfig) {\r\n              <mat-icon\r\n                class=\"configure\"\r\n                title=\"Configure data source\"\r\n                appMousedownStopPropagation\r\n                (click)=\"configureDataSource(dataSource)\"\r\n              >\r\n                settings\r\n              </mat-icon>\r\n            }\r\n            @if (typeInfos()[dataSource.EntityGuid].HelpLink) {\r\n              <mat-icon\r\n                class=\"help\"\r\n                title=\"Help for this data source\"\r\n                appMousedownStopPropagation\r\n                (click)=\"openHelp(typeInfos()[dataSource.EntityGuid].HelpLink)\"\r\n              >\r\n                help_outline\r\n              </mat-icon>\r\n            }\r\n          </div>\r\n          <div class=\"actions right\">\r\n            @if (vsSvc.pipelineModel().Pipeline.AllowEdit && !isOutDataSource(dataSource)) {\r\n              <mat-icon class=\"delete\" title=\"Delete\" appMousedownStopPropagation (click)=\"remove(dataSource)\"> delete </mat-icon>\r\n            }\r\n          </div>\r\n          <div\r\n            class=\"name\"\r\n            title=\"Click to edit name\"\r\n            appMousedownStopPropagation\r\n            (click)=\"vsSvc.pipelineModel().Pipeline.AllowEdit && editName(dataSource)\"\r\n          >\r\n            <span>{{ dataSource.Name || '(no name)' }}</span>\r\n            <mat-icon class=\"show-hover-inline\">edit</mat-icon>\r\n          </div>\r\n          <br />\r\n          <div\r\n            class=\"description\"\r\n            title=\"Click to edit description\"\r\n            appMousedownStopPropagation\r\n            (click)=\"vsSvc.pipelineModel().Pipeline.AllowEdit && editDescription(dataSource)\"\r\n          >\r\n            <span>{{ dataSource.Description }}</span>\r\n            <mat-icon class=\"show-hover-inline\">edit</mat-icon>\r\n          </div>\r\n          <br />\r\n          @if (showDataSourceDetails() && vsSvc.dataSourceConfigs()[dataSource.EntityId]?.length) {\r\n            <hr style=\"margin: 0\" />\r\n            <table class=\"configs\">\r\n              @for (config of vsSvc.dataSourceConfigs()[dataSource.EntityId]; track config) {\r\n                <tr class=\"config\">\r\n                  <td class=\"config-name\" [title]=\"config.name\">{{ config.name }}</td>\r\n                  <td class=\"config-value\" [title]=\"config.value\">{{ config.value }}</td>\r\n                </tr>\r\n              }\r\n            </table>\r\n          }\r\n          <div class=\"typename\" [title]=\"dataSource.PartAssemblyAndType\">Type: {{ getTypeName(dataSource.PartAssemblyAndType) }}</div>\r\n          @if (vsSvc.pipelineModel().Pipeline.AllowEdit && typeInfos()[dataSource.EntityGuid].DynamicOut) {\r\n            <div class=\"add-endpoint sourceEndpoint dynamic\" title=\"Drag a new Out-Connection\"></div>\r\n          }\r\n          @if (vsSvc.pipelineModel().Pipeline.AllowEdit && typeInfos()[dataSource.EntityGuid].DynamicIn) {\r\n            <div class=\"many-in targetEndpoint dynamic\" title=\"This data source supports multiple In-Connections\"></div>\r\n          }\r\n        </div>\r\n      }\r\n    }\r\n  </div>\r\n}\r\n","import { DataSource, PipelineDataSource } from '../models';\r\nimport { GuiTypes, TypeInfo, TypeInfos } from './plumb-editor.models';\r\n\r\nexport const guiTypes: GuiTypes = {\r\n  App: { Name: 'App', Label: 'App DataSources', Icon: 'star', UiHint: 'DataSources from the current App' },\r\n  Cache: { Name: 'Cache', Icon: 'history', UiHint: 'Caching of data' },\r\n  Filter: { Name: 'Filter', Icon: 'filter_list', UiHint: 'Filter data - usually returning less items than came in' },\r\n  Logic: { Name: 'Logic', Icon: 'share', UiHint: 'Logic operations - usually choosing between different streams' },\r\n  Lookup: { Name: 'Lookup', Icon: 'search', UiHint: 'Lookup operation - usually looking for other data based on a criteria' },\r\n  Modify: { Name: 'Modify', Icon: 'edit_attributes', UiHint: 'Modify data - usually changing, adding or removing values' },\r\n  Security: { Name: 'Security', Icon: 'account_circle', UiHint: 'Security - usually limit what the user sees based on his identity' },\r\n  Sort: { Name: 'Sort', Icon: 'sort', UiHint: 'Sort the items' },\r\n  Source: { Name: 'Source', Icon: 'cloud_upload', UiHint: 'Source of new data - usually SQL, CSV or similar' },\r\n  Target: { Name: 'Target', Icon: 'adjust', UiHint: 'Target - usually just a destination of data' },\r\n  Unknown: { Name: 'Unknown', Icon: 'fiber_manual_record', UiHint: 'Unknown type' },\r\n  Debug: { Name: 'Debug', Icon: 'bug_report', UiHint: 'Debugging Tools'},\r\n  System: { Name: 'System', Icon: 'military_tech', UiHint: 'System Data' },\r\n};\r\n\r\nexport function calculateTypeInfos(pipelineDataSources: PipelineDataSource[], dataSources: DataSource[]) {\r\n  const typeInfos: TypeInfos = {};\r\n\r\n  for (const pipelineDataSource of pipelineDataSources) {\r\n    let typeInfo: TypeInfo;\r\n    const ds = dataSources.find(ds => ds.PartAssemblyAndType === pipelineDataSource.PartAssemblyAndType);\r\n    if (ds) {\r\n      typeInfo = { ...(ds.PrimaryType ? guiTypes[ds.PrimaryType] : guiTypes.Unknown) };\r\n      if (ds.Icon != null) { typeInfo.Icon = ds.Icon; }\r\n      if (ds.DynamicIn != null) { typeInfo.DynamicIn = ds.DynamicIn; }\r\n      if (ds.DynamicOut != null) { typeInfo.DynamicOut = ds.DynamicOut; }\r\n      if (ds.HelpLink != null) { typeInfo.HelpLink = ds.HelpLink; }\r\n      if (ds.EnableConfig != null) { typeInfo.EnableConfig = ds.EnableConfig; }\r\n      if (ds.UiHint != null) { typeInfo.UiHint = ds.UiHint; }\r\n    }\r\n    if (!typeInfo)\r\n      typeInfo = { ...guiTypes.Unknown };\r\n    typeInfos[pipelineDataSource.EntityGuid] = typeInfo;\r\n  }\r\n\r\n  return typeInfos;\r\n}\r\n","import { ChangeDetectorRef, ViewContainerRef } from '@angular/core';\r\nimport { MatDialog, MatDialogRef } from '@angular/material/dialog';\r\nimport { eavConstants } from '../../shared/constants/eav.constants';\r\nimport { classLog } from '../../shared/logging';\r\nimport { DataSource, PipelineDataSource, PipelineModel, PipelineResult, PipelineResultStream, StreamWire, VisualDesignerData } from '../models';\r\nimport { WindowWithJsPlumb } from '../window';\r\nimport { EndpointsHelper } from './endpoints.helper';\r\nimport { PlumbType } from './plumb-editor.models';\r\nimport { RenameStreamComponent } from './rename-stream/rename-stream.component';\r\nimport { RenameStreamDialogData } from './rename-stream/rename-stream.models';\r\n\r\nconst logSpecs = {\r\n  all: true,\r\n  addEndpoint: true,\r\n}\r\n\r\ndeclare const window: WindowWithJsPlumb;\r\n\r\nexport const dataSrcIdPrefix = 'dataSource_';\r\n\r\nconst endPointsWhereWeRotate = 3;\r\n\r\nexport class Plumber {\r\n\r\n  log = classLog({Plumber}, logSpecs);\r\n\r\n  #instance: PlumbType;\r\n  #lineCount = 0;\r\n  #linePaintDefault = {\r\n    stroke: '#61B7CF',\r\n    strokeWidth: 4,\r\n    outlineStroke: 'white',\r\n    outlineWidth: 2,\r\n  };\r\n  #lineColors = [\r\n    '#009688', '#00bcd4', '#3f51b5', '#9c27b0', '#e91e63',\r\n    '#db4437', '#ff9800', '#60a917', '#60a917', '#008a00',\r\n    '#00aba9', '#1ba1e2', '#0050ef', '#6a00ff', '#aa00ff',\r\n    '#f472d0', '#d80073', '#a20025', '#e51400', '#fa6800',\r\n    '#f0a30a', '#e3c800', '#825a2c', '#6d8764', '#647687',\r\n    '#76608a', '#a0522d',\r\n  ];\r\n  #maxCols = this.#lineColors.length - 1;\r\n  #uuidColorMap: Record<string, any> = {};\r\n  #bulkDelete = false;\r\n  #dialog: MatDialogRef<RenameStreamComponent>;\r\n\r\n  #endpoints: EndpointsHelper;\r\n\r\n  constructor(\r\n    private jsPlumbRoot: HTMLElement,\r\n    private pipelineModel: PipelineModel,\r\n    private dataSources: DataSource[],\r\n    private onConnectionsChanged: () => void,\r\n    private onDragend: (pipelineDataSourceGuid: string, position: VisualDesignerData) => void,\r\n    private onDebugStream: (stream: PipelineResultStream) => void,\r\n    private matDialog: MatDialog,\r\n    private viewContainerRef: ViewContainerRef,\r\n    private changeDetectorRef: ChangeDetectorRef,\r\n  ) {\r\n    this.#endpoints = new EndpointsHelper(this);\r\n    this.#instance = window.jsPlumb.getInstance(this.#getInstanceDefaults(this.jsPlumbRoot));\r\n    this.#instance.batch(() => {\r\n      this.#initDomDataSources();\r\n      this.#initWirings();\r\n      this.#bindEvents();\r\n    });\r\n    // spm NOTE: repaint after initial paint fixes:\r\n    // Error: <svg> attribute width: Expected length, \"-Infinity\".\r\n    this.#instance.repaintEverything();\r\n  }\r\n\r\n  destroy() {\r\n    this.#dialog?.close();\r\n    this.#instance.reset();\r\n    this.#instance.unbindContainer();\r\n  }\r\n\r\n  removeEndpointsOnDataSource(pipelineDataSourceGuid: string) {\r\n    const elementId = dataSrcIdPrefix + pipelineDataSourceGuid;\r\n    this.#bulkDelete = true;\r\n    this.#instance.batch(() => {\r\n      this.#instance.selectEndpoints({ element: elementId }).delete();\r\n    });\r\n    this.#bulkDelete = false;\r\n  }\r\n\r\n  getAllConnections() {\r\n    const connectionInfos: StreamWire[] = this.#instance.getAllConnections().map((connection: PlumbType) => {\r\n      const wire: StreamWire = {\r\n        From: connection.sourceId.replace(dataSrcIdPrefix, ''),\r\n        Out: connection.endpoints[0].getOverlay('endpointLabel').label,\r\n        To: connection.targetId.replace(dataSrcIdPrefix, ''),\r\n        In: connection.endpoints[1].getOverlay('endpointLabel').label,\r\n      };\r\n      return wire;\r\n    });\r\n    return connectionInfos;\r\n  }\r\n\r\n  getStreamsOut() {\r\n    const streamsOut: string[] = [];\r\n    this.#instance.selectEndpoints({ target: dataSrcIdPrefix + 'Out' }).each((endpoint: PlumbType) => {\r\n      streamsOut.push(endpoint.getOverlay('endpointLabel').label);\r\n    });\r\n    const streamsOutStr = streamsOut.join(',');\r\n    return streamsOutStr;\r\n  }\r\n\r\n  putEntityCountOnConnections(result: PipelineResult) {\r\n    result.Streams?.forEach(stream => {\r\n      const sourceElementId = dataSrcIdPrefix + stream.Source;\r\n      const outTargets = ['00000000-0000-0000-0000-000000000000', this.pipelineModel.Pipeline.EntityGuid];\r\n      const targetElementId = outTargets.includes(stream.Target) ? dataSrcIdPrefix + 'Out' : dataSrcIdPrefix + stream.Target;\r\n\r\n      const fromUuid = sourceElementId + '_out_' + stream.SourceOut;\r\n      const toUuid = targetElementId + '_in_' + stream.TargetIn;\r\n\r\n      const sEndp: PlumbType = this.#instance.getEndpoint(fromUuid);\r\n      sEndp?.connections\r\n        ?.filter((connection: PlumbType) => connection.endpoints[1].getUuid() === toUuid)\r\n        ?.forEach((connection: PlumbType) => {\r\n          const label = !stream.Error ? stream.Count.toString() : '';\r\n          const cssClass = 'streamEntitiesCount ' + (!stream.Error ? '' : 'streamEntitiesError');\r\n          connection.setLabel({\r\n            label,\r\n            cssClass,\r\n            events: {\r\n              click: (overlay: PlumbType) => {\r\n                if (!this.pipelineModel.Pipeline.AllowEdit) return;\r\n                this.onDebugStream(stream);\r\n              },\r\n            },\r\n          });\r\n        });\r\n    });\r\n  }\r\n\r\n  #nextLinePaintStyle(uuid: string) {\r\n    return (\r\n      this.#uuidColorMap[uuid] ||\r\n      (this.#uuidColorMap[uuid] = Object.assign({}, this.#linePaintDefault, { stroke: this.#lineColors[this.#lineCount++ % this.#maxCols] }))\r\n    );\r\n  }\r\n\r\n  #getInstanceDefaults(container: HTMLElement) {\r\n    const defaults = {\r\n      Container: container,\r\n      Connector: ['Bezier', { curviness: 70 }],\r\n      PaintStyle: this.#nextLinePaintStyle('dummy'),\r\n      HoverPaintStyle: {\r\n        stroke: '#216477',\r\n        strokeWidth: 4,\r\n        outlineStroke: 'white',\r\n        outlineWidth: 2,\r\n      },\r\n    };\r\n    return defaults;\r\n  }\r\n\r\n  /** Create sources, targets and endpoints */\r\n  #initDomDataSources() {\r\n    const l = this.log.fnCond(false, 'initDomDataSources');\r\n    for (const pipelineDataSource of this.pipelineModel.DataSources) {\r\n      const domDataSource = this.jsPlumbRoot.querySelector<HTMLElement>('#' + dataSrcIdPrefix + pipelineDataSource.EntityGuid);\r\n      if (!domDataSource) continue;\r\n      const dataSource = this.dataSources.find(ds => ds.PartAssemblyAndType === pipelineDataSource.PartAssemblyAndType);\r\n      if (!dataSource) continue;\r\n\r\n      if (this.pipelineModel.Pipeline.AllowEdit) {\r\n        // WARNING! Must happen before instance.makeSource()\r\n        this.#instance.draggable(domDataSource, {\r\n          grid: [20, 20], stop: (event: PlumbType) => {\r\n            const element: HTMLElement = event.el;\r\n            const pipelineDataSourceGuid: string = element.id.replace(dataSrcIdPrefix, '');\r\n            const position: VisualDesignerData = {\r\n              Top: event.finalPos[1],\r\n              Left: event.finalPos[0],\r\n            };\r\n            setTimeout(() => { this.onDragend(pipelineDataSourceGuid, position); });\r\n          }\r\n        });\r\n      }\r\n\r\n      // Add Out-Endpoints from Definition\r\n      const outCount = dataSource.Out?.length ?? 0;\r\n      l.a('dataSource.Out', { outCount, out: dataSource.Out });\r\n      dataSource.Out?.forEach(name => {\r\n        this.#addEndpoint(domDataSource, name, false, pipelineDataSource, outCount);\r\n      });\r\n\r\n      // Add In-Endpoints from Definition\r\n      const inCount = dataSource.In?.length ?? 0;\r\n      l.a('dataSource.In', { inCount, in: dataSource.In });\r\n      dataSource.In?.forEach(name => {\r\n        this.#addEndpoint(domDataSource, name, true, pipelineDataSource, inCount);\r\n      });\r\n\r\n      // Make DataSource a Target for new Endpoints (if .In is an Array)\r\n      if (dataSource.In) {\r\n        const targetEndpointUnlimited = this.#endpoints.buildTargetEndpoint(pipelineDataSource.EntityGuid);\r\n        targetEndpointUnlimited.maxConnections = -1;\r\n        this.#instance.makeTarget(domDataSource, targetEndpointUnlimited);\r\n      }\r\n\r\n      if (dataSource.DynamicOut)\r\n        this.#instance.makeSource(domDataSource, this.#endpoints.buildSourceEndpoint(pipelineDataSource.EntityGuid), { filter: '.add-endpoint' });\r\n    }\r\n    l.end();\r\n  }\r\n\r\n  /** Create wires */\r\n  #initWirings() {\r\n    const l = this.log.fn('initWirings');\r\n    const wirings = this.pipelineModel.Pipeline.StreamWiring;\r\n    if (!wirings) return l.end('no wirings');\r\n\r\n    const inGroups = groupBy(wirings, wire => wire.To);\r\n    const outGroups = groupBy(wirings, wire => wire.From);\r\n\r\n    l.values({ inGroups, outGroups });\r\n\r\n    wirings.forEach(wire => {\r\n      // read connections from Pipeline\r\n      const sourceElementId = dataSrcIdPrefix + wire.From;\r\n      const fromUuid = sourceElementId + '_out_' + wire.Out;\r\n      const targetElementId = dataSrcIdPrefix + wire.To;\r\n      const toUuid = targetElementId + '_in_' + wire.In;\r\n\r\n      // Ensure In-Endpoint exist\r\n      if (!this.#instance.getEndpoint(fromUuid)) {\r\n        const domDataSource = this.jsPlumbRoot.querySelector<HTMLElement>('#' + sourceElementId);\r\n        if (!domDataSource) return;\r\n\r\n        const guid: string = domDataSource.id.replace(dataSrcIdPrefix, '');\r\n        const dataSource = this.pipelineModel.DataSources.find(pipeDataSource => pipeDataSource.EntityGuid === guid);\r\n        this.#addEndpoint(domDataSource, wire.Out, false, dataSource, outGroups[wire.From].length);\r\n      }\r\n\r\n      // Ensure Out-Endpoint exist\r\n      if (!this.#instance.getEndpoint(toUuid)) {\r\n        const domDataSource = this.jsPlumbRoot.querySelector<HTMLElement>('#' + targetElementId);\r\n        if (!domDataSource) return;\r\n\r\n        const guid: string = domDataSource.id.replace(dataSrcIdPrefix, '');\r\n        const dataSource = this.pipelineModel.DataSources.find(pipeDataSource => pipeDataSource.EntityGuid === guid);\r\n\r\n        // if (wire.In === \"DEBUG\") debugger;\r\n\r\n        this.#addEndpoint(domDataSource, wire.In, true, dataSource, inGroups[wire.To].length);\r\n      }\r\n\r\n      try {\r\n        this.#instance.connect({\r\n          uuids: [fromUuid, toUuid],\r\n          paintStyle: this.#nextLinePaintStyle(fromUuid),\r\n        });\r\n      } catch (e) {\r\n        console.error({ message: 'Connection failed', from: fromUuid, to: toUuid });\r\n      }\r\n    });\r\n    l.end();\r\n  }\r\n\r\n  #addEndpoint(domDataSource: HTMLElement, endpointName: string, isIn: boolean, queryDs: PipelineDataSource, count: number = 0) {\r\n    const l = this.log.fnIf('addEndpoint', { endpointName, isIn, queryDs });\r\n    const dataSource = this.dataSources.find(d => d.PartAssemblyAndType === queryDs.PartAssemblyAndType);\r\n    const connectionList = isIn ? dataSource.In : dataSource.Out;\r\n    const hasDynamic = connectionList?.some(name => this.#endpoints.getEndpointInfo(name, false));\r\n    // const count = connectionList?.length ?? -1;\r\n    const endpointInfo = this.#endpoints.getEndpointInfo(endpointName, hasDynamic);\r\n\r\n    l.a(`endpointInfo ${count}`, { dataSource, connectionList, isDynamic: hasDynamic, count, endpointInfo });\r\n\r\n    // if (endpointName === \"DEBUG\") debugger;\r\n\r\n    let style: string;\r\n    if (hasDynamic)\r\n      style = 'dynamic';\r\n    else if (!endpointInfo.required)\r\n      style = '';\r\n    else {\r\n      const wireExists = this.pipelineModel.Pipeline.StreamWiring?.some(wire => {\r\n        const targetElementId = dataSrcIdPrefix + wire.To;\r\n        const targetEndpointName = wire.In;\r\n\r\n        return targetElementId === domDataSource.id && targetEndpointName === endpointInfo.name;\r\n      });\r\n      style = wireExists ? '' : 'required';\r\n    }\r\n\r\n    const uuid = domDataSource.id + (isIn ? '_in_' : '_out_') + endpointInfo.name;\r\n    const angled = count > endPointsWhereWeRotate;\r\n    const model = isIn\r\n      ? this.#endpoints.buildTargetEndpoint(queryDs.EntityGuid, style)\r\n      : this.#endpoints.buildSourceEndpoint(queryDs.EntityGuid, style);\r\n    // Endpoints on Out-DataSource must be always enabled\r\n    const params = {\r\n      uuid,\r\n      enabled: this.pipelineModel.Pipeline.AllowEdit\r\n        || queryDs.EntityGuid === eavConstants.pipelineDesigner.outDataSource.EntityGuid\r\n    };\r\n\r\n    const endpoint: PlumbType = this.#instance.addEndpoint(domDataSource, model, params);\r\n    const overlay = endpoint.getOverlay('endpointLabel');\r\n    overlay.setLabel(endpointInfo.name);\r\n    if (angled)\r\n      overlay.addClass('angled');\r\n    l.end(\"end\", {count, angled, overlay});\r\n  }\r\n\r\n  public onChangeLabel(endpointOrOverlay: PlumbType, isSource: boolean, pipelineDataSourceGuid: string) {\r\n    if (!this.pipelineModel.Pipeline.AllowEdit)\r\n      return;\r\n\r\n    const overlay: PlumbType = endpointOrOverlay.getOverlay ? endpointOrOverlay.getOverlay('endpointLabel') : endpointOrOverlay;\r\n    const data: RenameStreamDialogData = {\r\n      pipelineDataSourceGuid,\r\n      isSource,\r\n      label: overlay.label,\r\n    };\r\n    this.#dialog = this.matDialog.open(RenameStreamComponent, {\r\n      autoFocus: false,\r\n      data,\r\n      viewContainerRef: this.viewContainerRef,\r\n      width: '650px',\r\n    });\r\n    this.#dialog.afterClosed().subscribe(newLabel => {\r\n      if (!newLabel) return;\r\n      overlay.setLabel(newLabel);\r\n      setTimeout(() => this.onConnectionsChanged());\r\n    });\r\n    this.changeDetectorRef.markForCheck();\r\n  }\r\n\r\n  #bindEvents() {\r\n    this.#instance.bind('connectionDetached', (info: PlumbType) => {\r\n      if (this.#bulkDelete) return;\r\n      const domDataSource: HTMLElement = info.target;\r\n      const pipelineDataSource = this.pipelineModel.DataSources.find(\r\n        pipelineDS => pipelineDS.EntityGuid === domDataSource.id.replace(dataSrcIdPrefix, '')\r\n      );\r\n      const dataSource = this.dataSources.find(ds => ds.PartAssemblyAndType === pipelineDataSource.PartAssemblyAndType);\r\n      const label: string = info.targetEndpoint.getOverlay('endpointLabel').label;\r\n      const isDynamic = !dataSource.In.some(name => this.#endpoints.getEndpointInfo(name, false).name === label);\r\n      if (isDynamic)\r\n        this.#instance.deleteEndpoint(info.targetEndpoint);\r\n      setTimeout(() => { this.onConnectionsChanged(); });\r\n    });\r\n\r\n    this.#instance.bind('connection', (info: PlumbType) => {\r\n      if (info.sourceId === info.targetId) {\r\n        setTimeout(() => {\r\n          this.#instance.deleteConnection(info.connection, { fireEvent: false });\r\n          setTimeout(() => this.onConnectionsChanged());\r\n        });\r\n        return;\r\n      }\r\n      const endpointLabel: PlumbType = info.targetEndpoint.getOverlay('endpointLabel');\r\n      const labelPrompt: string = endpointLabel.getLabel();\r\n      const endpoints: PlumbType[] = this.#instance.getEndpoints(info.target.id);\r\n      const targetEndpointHasSameLabel = endpoints.some(endpoint => {\r\n        const label: string = endpoint.getOverlay('endpointLabel').getLabel();\r\n        return label === labelPrompt &&\r\n          info.targetEndpoint.id !== endpoint.id &&\r\n          (endpoint.canvas as HTMLCanvasElement).classList.contains('targetEndpoint');\r\n      });\r\n      if (targetEndpointHasSameLabel)\r\n        endpointLabel.setLabel(`PleaseRename${Math.floor(Math.random() * 99999)}`);\r\n      setTimeout(() => { this.onConnectionsChanged(); });\r\n    });\r\n  }\r\n\r\n}\r\n\r\n// https://stackoverflow.com/questions/14446511/most-efficient-method-to-groupby-on-an-array-of-objects\r\nconst groupBy = <T, K extends keyof any>(arr: T[], key: (i: T) => K) =>\r\n  arr.reduce((groups, item) => {\r\n    (groups[key(item)] ||= []).push(item);\r\n    return groups;\r\n  }, {} as Record<K, T[]>);\r\n","import { NgClass } from '@angular/common';\r\nimport { ChangeDetectorRef, Component, HostBinding, Inject, OnInit } from '@angular/core';\r\nimport { FormsModule, ReactiveFormsModule, UntypedFormControl, UntypedFormGroup, Validators } from '@angular/forms';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatOptionModule } from '@angular/material/core';\r\nimport { MAT_DIALOG_DATA, MatDialogActions, MatDialogRef } from '@angular/material/dialog';\r\nimport { MatFormFieldModule } from '@angular/material/form-field';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatInputModule } from '@angular/material/input';\r\nimport { MatSelectModule } from '@angular/material/select';\r\nimport { MatSlideToggleChange, MatSlideToggleModule } from '@angular/material/slide-toggle';\r\nimport { distinctUntilChanged, startWith } from 'rxjs';\r\nimport { transient } from '../../../../../../core';\r\nimport { ContentTypesService } from '../../../app-administration/services';\r\nimport { BaseComponent } from '../../../shared/components/base.component';\r\nimport { FieldHintComponent } from '../../../shared/components/field-hint/field-hint.component';\r\nimport { eavConstants, ScopeOption } from '../../../shared/constants/eav.constants';\r\nimport { ClickStopPropagationDirective } from '../../../shared/directives/click-stop-propagation.directive';\r\nimport { VisualQueryStateService } from '../../services/visual-query.service';\r\nimport { RenameStreamDialogControls, RenameStreamDialogData, RenameStreamDialogFormValue } from './rename-stream.models';\r\n\r\n@Component({\r\n  selector: 'app-rename-stream',\r\n  templateUrl: './rename-stream.component.html',\r\n  standalone: true,\r\n  imports: [\r\n    MatButtonModule,\r\n    MatIconModule,\r\n    FormsModule,\r\n    ReactiveFormsModule,\r\n    MatFormFieldModule,\r\n    MatInputModule,\r\n    MatSelectModule,\r\n    MatOptionModule,\r\n    NgClass,\r\n    MatDialogActions,\r\n    MatSlideToggleModule,\r\n    FieldHintComponent,\r\n    ClickStopPropagationDirective,\r\n  ],\r\n})\r\nexport class RenameStreamComponent extends BaseComponent implements OnInit {\r\n  @HostBinding('className') hostClass = 'dialog-component';\r\n\r\n  form: UntypedFormGroup;\r\n  controls: RenameStreamDialogControls;\r\n  isSource = this.dialogData.isSource;\r\n  pipelineResultExists = this.visualQueryService.queryResult != null;\r\n  scopeOptions: ScopeOption[] = [];\r\n  labelOptions: string[] = [];\r\n  guidedLabel = true;\r\n  advancedMode = false;\r\n\r\n  #contentTypesSvc = transient(ContentTypesService);\r\n  \r\n  constructor(\r\n    @Inject(MAT_DIALOG_DATA) private dialogData: RenameStreamDialogData,\r\n    private dialog: MatDialogRef<RenameStreamComponent>,\r\n    private visualQueryService: VisualQueryStateService,\r\n    private changeDetectorRef: ChangeDetectorRef,\r\n  ) {\r\n    super();\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.#buildForm();\r\n  }\r\n\r\n  closeDialog(label?: string): void {\r\n    this.dialog.close(label);\r\n  }\r\n\r\n  toggleGuidedLabel(guidedLabel: boolean): void {\r\n    this.guidedLabel = guidedLabel;\r\n  }\r\n\r\n  toggleAdvancedMode(event: MatSlideToggleChange): void {\r\n    this.advancedMode = event.checked;\r\n  }\r\n\r\n  rename(): void {\r\n    const formValue: RenameStreamDialogFormValue = this.form.getRawValue();\r\n    this.closeDialog(formValue.label);\r\n  }\r\n\r\n  #buildForm(): void {\r\n    this.form = new UntypedFormGroup({\r\n      label: new UntypedFormControl(this.dialogData.label, Validators.required),\r\n      scope: new UntypedFormControl(eavConstants.scopes.default.value),\r\n    });\r\n    this.controls = this.form.controls as any;\r\n\r\n    if (!this.isSource || !this.pipelineResultExists)\r\n      return;\r\n\r\n    this.subscriptions.add(\r\n      this.controls.scope.valueChanges.pipe(\r\n        startWith<string>(this.controls.scope.value),\r\n        distinctUntilChanged(),\r\n      ).subscribe(scope => {\r\n        this.labelOptions = Object.values(this.visualQueryService.queryResult.Sources)\r\n          .find(source => source.Guid === this.dialogData.pipelineDataSourceGuid).Out\r\n          .filter(out => out.Scope === scope)\r\n          .map(out => out.Name);\r\n\r\n        if (!this.labelOptions.includes(this.controls.label.value) && this.controls.label.value != null)\r\n          this.controls.label.patchValue(null);\r\n      })\r\n    );\r\n\r\n    this.#contentTypesSvc.getScopes().subscribe(scopes => {\r\n      const sourceOut = Object.values(this.visualQueryService.queryResult.Sources)\r\n        .find(source => source.Guid === this.dialogData.pipelineDataSourceGuid).Out;\r\n      const filtered = scopes.filter(s => sourceOut.some(o => o.Scope === s.value));\r\n      this.scopeOptions = filtered;\r\n      this.changeDetectorRef.markForCheck();\r\n    });\r\n  }\r\n}\r\n","<div class=\"eav-dialog\">\r\n  <div class=\"eav-dialog-header\">\r\n    <div class=\"eav-dialog-header__title\">Rename stream</div>\r\n    <button mat-icon-button tippy=\"Close dialog\" (click)=\"closeDialog()\">\r\n      <mat-icon>close</mat-icon>\r\n    </button>\r\n  </div>\r\n  <div class=\"eav-dialog-content\">\r\n    <form [formGroup]=\"form\">\r\n      <!-- Simple form -->\r\n      @if (!isSource || !pipelineResultExists) {\r\n        <!-- Label -->\r\n        <mat-form-field color=\"accent\" class=\"eav-mat-form-field\">\r\n          <mat-label>Label</mat-label>\r\n          <input matInput type=\"text\" formControlName=\"label\" required>\r\n        </mat-form-field>\r\n        @if (isSource && !pipelineResultExists) {\r\n          <app-field-hint>\r\n            You will get suggestions for out-streams after you run query\r\n          </app-field-hint>\r\n        }\r\n        @if (controls.label.touched && controls.label.errors?.required) {\r\n          <app-field-hint [isError]=\"true\">\r\n            This field is required\r\n          </app-field-hint>\r\n        }\r\n      }\r\n\r\n      <!-- Rich form -->\r\n      @if (isSource && pipelineResultExists) {\r\n        <!-- Scope -->\r\n        @if (advancedMode && guidedLabel) {\r\n          <mat-form-field color=\"accent\" class=\"eav-mat-form-field\">\r\n            <mat-label>Scope</mat-label>\r\n            <mat-select formControlName=\"scope\" [placeholder]=\"!scopeOptions.length ? 'No items found' : ''\">\r\n              @for (scopeOption of scopeOptions; track scopeOption) {\r\n                <mat-option [value]=\"scopeOption.value\">\r\n                  {{ scopeOption.name }}\r\n                </mat-option>\r\n              }\r\n            </mat-select>\r\n          </mat-form-field>\r\n          <app-field-hint>\r\n            The scope should almost never be changed -\r\n            <a href=\"https://2sxc.org/help?tag=scope\" target=\"_blank\" appClickStopPropagation>see help</a>\r\n          </app-field-hint>\r\n        }\r\n        <!-- Label -->\r\n        <mat-form-field color=\"accent\" class=\"eav-mat-form-field\">\r\n          <mat-label>Label</mat-label>\r\n          @if (guidedLabel) {\r\n            <mat-select formControlName=\"label\" required\r\n              [placeholder]=\"!labelOptions.length ? 'No items found' : ''\">\r\n              @for (labelOption of labelOptions; track labelOption) {\r\n                <mat-option [value]=\"labelOption\">\r\n                  {{ labelOption }}\r\n                </mat-option>\r\n              }\r\n            </mat-select>\r\n          }\r\n          @if (!guidedLabel) {\r\n            <input matInput type=\"text\" formControlName=\"label\" required>\r\n          }\r\n          <div matTextSuffix class=\"eav-selection-suffix\">\r\n            <button mat-icon-button class=\"eav-selection-suffix-button\" type=\"button\" [ngClass]=\"{ 'active': guidedLabel }\" tippy=\"Pick existing value\"\r\n              (click)=\"toggleGuidedLabel(true)\">\r\n              <mat-icon class=\"eav-icon\">search</mat-icon>\r\n            </button>\r\n            <button mat-icon-button class=\"eav-selection-suffix-button\" type=\"button\" [ngClass]=\"{ 'active': !guidedLabel }\" tippy=\"Manual entry\"\r\n              (click)=\"toggleGuidedLabel(false)\">\r\n              <mat-icon class=\"eav-icon\">text_fields</mat-icon>\r\n            </button>\r\n          </div>\r\n        </mat-form-field>\r\n        @if (controls.label.touched && controls.label.errors?.required) {\r\n          <app-field-hint [isError]=\"true\">\r\n            This field is required\r\n          </app-field-hint>\r\n        }\r\n      }\r\n    </form>\r\n  </div>\r\n  <mat-dialog-actions class=\"eav-dialog-actions\">\r\n    <!-- Extra button for rich form -->\r\n    <div>\r\n      @if (isSource && pipelineResultExists) {\r\n        <mat-slide-toggle color=\"accent\" [checked]=\"advancedMode\" (change)=\"toggleAdvancedMode($event)\">\r\n          {{ advancedMode ? 'Advanced' : 'Simple' }}\r\n        </mat-slide-toggle>\r\n      }\r\n    </div>\r\n    <div>\r\n      <button mat-raised-button type=\"button\" (click)=\"closeDialog()\">Cancel</button>\r\n      <button mat-raised-button type=\"button\" color=\"accent\" [disabled]=\"!form.valid\" (click)=\"rename()\">\r\n        Rename\r\n      </button>\r\n    </div>\r\n  </mat-dialog-actions>\r\n</div>\r\n","import { JsonPipe, KeyValuePipe } from '@angular/common';\r\nimport { Component, Inject, OnInit } from '@angular/core';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatTabsModule } from '@angular/material/tabs';\r\nimport { DebugStreamInfo, PipelineResultQuery, PipelineResultSources, PipelineResultStream } from '../models';\r\nimport { VisualQueryStateService } from '../services/visual-query.service';\r\nimport { QueryResultDialogData } from './query-result.models';\r\n\r\n@Component({\r\n  selector: 'app-query-result',\r\n  templateUrl: './query-result.component.html',\r\n  styleUrls: ['./query-result.component.scss'],\r\n  standalone: true,\r\n  imports: [\r\n    MatButtonModule,\r\n    MatIconModule,\r\n    MatTabsModule,\r\n    JsonPipe,\r\n    KeyValuePipe,\r\n  ],\r\n})\r\nexport class QueryResultComponent implements OnInit {\r\n  parameters: string[];\r\n  timeUsed: number;\r\n  ticksUsed: number;\r\n  top: number;\r\n  optionsForTop: number[];\r\n  result: PipelineResultQuery;\r\n  debugStream: DebugStreamInfo;\r\n  sources: PipelineResultSources;\r\n  streams: PipelineResultStream[];\r\n\r\n  constructor(\r\n    @Inject(MAT_DIALOG_DATA) private dialogData: QueryResultDialogData,\r\n    private dialog: MatDialogRef<QueryResultComponent>,\r\n    private visualQueryService: VisualQueryStateService,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    const pipeline = this.visualQueryService.pipelineModel().Pipeline;\r\n    const params = (pipeline.Params?.split('\\n') ?? []).filter(el => !!el);\r\n    const testParams = (pipeline.TestParameters?.split('\\n') ?? []).filter(el => !!el);\r\n    this.parameters = [].concat(params, testParams);\r\n    this.timeUsed = this.dialogData.result.QueryTimer.Milliseconds;\r\n    this.ticksUsed = this.dialogData.result.QueryTimer.Ticks;\r\n    this.top = this.dialogData.top;\r\n    this.optionsForTop = [25, 100, 1000, 0];\r\n    this.result = this.dialogData.result.Query;\r\n    this.debugStream = this.dialogData.debugStream;\r\n    this.sources = this.dialogData.result.Sources;\r\n    this.streams = this.dialogData.result.Streams;\r\n  }\r\n\r\n  closeDialog() {\r\n    this.dialog.close();\r\n  }\r\n\r\n  show(top: number) {\r\n    if (top === this.top) return;\r\n\r\n    if (this.debugStream) {\r\n      this.visualQueryService.debugStream(this.debugStream.original, top);\r\n    } else {\r\n      this.visualQueryService.runPipeline(top);\r\n    }\r\n\r\n    this.closeDialog();\r\n  }\r\n}\r\n","<div class=\"eav-dialog\">\r\n  <div class=\"eav-dialog-header\">\r\n    <div class=\"eav-dialog-header__title\">\r\n      Query Results\r\n      @if (debugStream) {\r\n        for Stream: \"{{ debugStream.name }}\" on Source: \"{{ debugStream.sourceName }}\"\r\n      }\r\n    </div>\r\n    <button mat-icon-button tippy=\"Close dialog\" (click)=\"closeDialog()\">\r\n      <mat-icon>close</mat-icon>\r\n    </button>\r\n  </div>\r\n\r\n  <div class=\"eav-dialog-content\">\r\n    <p>\r\n      The Full result was logged to the Browser Console. Further down you'll find more debug-infos. Executed in {{ timeUsed }}ms ({{\r\n        ticksUsed\r\n      }}\r\n      ticks)\r\n    </p>\r\n\r\n    <mat-tab-group dynamicHeight color=\"accent\" class=\"eav-tab-group\">\r\n      <!-- Results -->\r\n      <mat-tab>\r\n        <div *matTabLabel class=\"mat-tab-label-box\" tippy=\"Results\">\r\n          <span>Results</span>\r\n        </div>\r\n        <div class=\"eav-tab-description\">\r\n          <div>\r\n            @if (top === 0) {\r\n              Showing All results\r\n            }\r\n            @if (top !== 0) {\r\n              Showing top {{ top }} results\r\n            }\r\n          </div>\r\n          <div>\r\n            @for (option of optionsForTop; track option) {\r\n              <button mat-button (click)=\"show(option)\">\r\n                Show\r\n                @if (option === 0) {\r\n                  All\r\n                }\r\n                @if (option !== 0) {\r\n                  {{ option }}\r\n                }\r\n              </button>\r\n            }\r\n          </div>\r\n        </div>\r\n        <pre class=\"eav-pre-scroll\">{{ result | json }}</pre>\r\n      </mat-tab>\r\n\r\n      @if (parameters?.length) {\r\n        <!-- Parameters -->\r\n        <mat-tab>\r\n          <div *matTabLabel class=\"mat-tab-label-box\" tippy=\"Parameters\">\r\n            <span>Parameters</span>\r\n          </div>\r\n\r\n          <div class=\"eav-tab-content\">\r\n            <ul>\r\n              @for (param of parameters; track param) {\r\n                <li>{{ param }}</li>\r\n              }\r\n            </ul>\r\n          </div>\r\n        </mat-tab>\r\n      }\r\n\r\n      <!-- Sources -->\r\n      <mat-tab>\r\n        <div *matTabLabel class=\"mat-tab-label-box\" tippy=\"Sources\">\r\n          <span>Sources</span>\r\n        </div>\r\n\r\n        <div class=\"eav-tab-content\">\r\n          <table>\r\n            <tr>\r\n              <th>Name and Guid</th>\r\n              <th>Type</th>\r\n              <th>Configuration</th>\r\n              <th>Error</th>\r\n            </tr>\r\n            @for (source of sources | keyvalue; track source) {\r\n              <tr>\r\n                <td>\r\n                  @if (source.value.Definition?.Name) {\r\n                    <div>{{ source.value.Definition?.Name }}</div>\r\n                  }\r\n                  <pre>{{ source.value.Guid }}</pre>\r\n                </td>\r\n                <td>{{ source.value.Type }}</td>\r\n                <td>\r\n                  <ol>\r\n                    @for (config of source.value.Configuration | keyvalue; track config) {\r\n                      <li>\r\n                        <b>{{ config.key }}</b\r\n                        >=<em>{{ config.value }}</em>\r\n                      </li>\r\n                    }\r\n                  </ol>\r\n                </td>\r\n                <td>{{ source.value.Error }}</td>\r\n              </tr>\r\n            }\r\n          </table>\r\n        </div>\r\n      </mat-tab>\r\n\r\n      <!-- Streams -->\r\n      <mat-tab>\r\n        <div *matTabLabel class=\"mat-tab-label-box\" tippy=\"Streams\">\r\n          <span>Streams</span>\r\n        </div>\r\n\r\n        <div class=\"eav-tab-content\">\r\n          <table>\r\n            <tr>\r\n              <th>Source</th>\r\n              <th>Target</th>\r\n              <th>Items</th>\r\n              <th>Error</th>\r\n            </tr>\r\n            @for (stream of streams; track stream) {\r\n              <tr>\r\n                <td>\r\n                  <pre>{{ stream.Source + ':' + stream.SourceOut }}</pre>\r\n                </td>\r\n                <td>\r\n                  <pre>{{ stream.Target + ':' + stream.TargetIn }}</pre>\r\n                </td>\r\n                <td>{{ stream.Count }}</td>\r\n                <td>{{ stream.Error }}</td>\r\n              </tr>\r\n            }\r\n          </table>\r\n        </div>\r\n      </mat-tab>\r\n    </mat-tab-group>\r\n  </div>\r\n</div>\r\n","import { AsyncPipe } from '@angular/common';\r\nimport { Component, signal } from '@angular/core';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatSlideToggleChange, MatSlideToggleModule } from '@angular/material/slide-toggle';\r\nimport { transient } from '../../../../../core';\r\nimport { GoToDevRest } from '../../dev-rest';\r\nimport { JsonHelpers } from '../../shared/helpers/json.helpers';\r\nimport { DialogRoutingService } from '../../shared/routing/dialog-routing.service';\r\nimport { Context } from '../../shared/services/context';\r\nimport { VisualQueryStateService } from '../services/visual-query.service';\r\nimport { calculateWarnings } from './run-explorer.helpers';\r\n\r\n@Component({\r\n  selector: 'app-run-explorer',\r\n  templateUrl: './run-explorer.component.html',\r\n  styleUrls: ['./run-explorer.component.scss'],\r\n  standalone: true,\r\n  imports: [\r\n    MatButtonModule,\r\n    MatIconModule,\r\n    MatSlideToggleModule,\r\n    AsyncPipe,\r\n  ],\r\n})\r\nexport class RunExplorerComponent {\r\n\r\n  warningSig = signal<string[]>(\r\n    calculateWarnings(this.vsSvc?.pipelineModel() ?? null, this.context)\r\n  );\r\n\r\n  visualDesignerDataSig = signal<Record<string, any>>(\r\n    JsonHelpers.tryParse(this.vsSvc?.pipelineModel()?.Pipeline.VisualDesignerData) ?? {}\r\n  );\r\n\r\n  #dialogRouter = transient(DialogRoutingService);\r\n\r\n  constructor(\r\n    private context: Context,\r\n    public vsSvc: VisualQueryStateService,\r\n  ) { }\r\n\r\n  editPipeline() {\r\n    this.vsSvc.editPipelineEntity();\r\n  }\r\n\r\n  openParamsHelp() {\r\n    window.open('https://go.2sxc.org/QueryParams', '_blank');\r\n  }\r\n\r\n  saveAndRunQuery(save: boolean, run: boolean) {\r\n    this.vsSvc.saveAndRun(save, run);\r\n  }\r\n\r\n  showDataSourceDetails(event: MatSlideToggleChange): void {\r\n    this.vsSvc.showDataSourceDetails(event.checked);\r\n  }\r\n\r\n  openRestApi() {\r\n    const queryGuid = this.vsSvc.pipelineModel().Pipeline.EntityGuid;\r\n    this.#dialogRouter.navRelative([GoToDevRest.getUrlQueryDialog(queryGuid)]);\r\n  }\r\n}\r\n","@if (vsSvc.pipelineModel()) {\r\n  <div class=\"editor-active-explorer fancy-scrollbar-dark\">\r\n    <div class=\"wrapper\">\r\n      <div class=\"actions\">\r\n        <button mat-raised-button class=\"action\" color=\"accent\" (click)=\"saveAndRunQuery(true, true)\">Save and run</button>\r\n        <button mat-raised-button class=\"action\" (click)=\"saveAndRunQuery(false, true)\">Run</button>\r\n        <button mat-raised-button class=\"action\" (click)=\"saveAndRunQuery(true, false)\">Save</button>\r\n      </div>\r\n      <div class=\"parameters\">\r\n        <div class=\"title\">\r\n          <div>Query Parameters</div>\r\n          <div>\r\n            <button mat-icon-button tippy=\"Edit parameters\" (click)=\"editPipeline()\">\r\n              <mat-icon>edit</mat-icon>\r\n            </button>\r\n            <button mat-icon-button tippy=\"Query Params Docs\" (click)=\"openParamsHelp()\">\r\n              <mat-icon>info</mat-icon>\r\n            </button>\r\n          </div>\r\n        </div>\r\n        @if (vsSvc.pipelineModel().Pipeline.Params?.length) {\r\n          <ul class=\"values\">\r\n            @for (param of vsSvc.pipelineModel().Pipeline.Params?.split('\\n'); track param) {\r\n              <li>\r\n                {{ param }}\r\n              </li>\r\n            }\r\n          </ul>\r\n        }\r\n      </div>\r\n      <div class=\"parameters\">\r\n        <div class=\"title\">Test Parameters</div>\r\n        @if (vsSvc.pipelineModel().Pipeline.TestParameters?.length) {\r\n          <ul class=\"values\">\r\n            @for (param of vsSvc.pipelineModel().Pipeline.TestParameters?.split('\\n'); track param) {\r\n              <li>\r\n                {{ param }}\r\n              </li>\r\n            }\r\n          </ul>\r\n        }\r\n      </div>\r\n      @if (visualDesignerDataSig()) {\r\n        <div class=\"parameters\">\r\n          <span class=\"eav-slide-toggle-label\">Show DataSource Params</span>\r\n          <mat-slide-toggle\r\n            color=\"primary\"\r\n            [checked]=\"visualDesignerDataSig().ShowDataSourceDetails\"\r\n            (change)=\"showDataSourceDetails($event)\"\r\n          />\r\n        </div>\r\n      }\r\n      @if (warningSig()) {\r\n        @if (warningSig().length) {\r\n          <div class=\"warnings\">\r\n            <div class=\"title\">\r\n              <span>Warnings</span>\r\n              <mat-icon style=\"color: red\">warning</mat-icon>\r\n            </div>\r\n            <ol class=\"values\">\r\n              @for (warning of warningSig(); track warning) {\r\n                <li [innerHTML]=\"warning\"></li>\r\n              }\r\n            </ol>\r\n          </div>\r\n        }\r\n      }\r\n      @if (vsSvc.pipelineModel().Pipeline.Description) {\r\n        <div class=\"description\">\r\n          <div class=\"title\">Query Description</div>\r\n          <div>{{ vsSvc.pipelineModel().Pipeline.Description }}</div>\r\n        </div>\r\n      }\r\n      <div class=\"footer-actions\">\r\n        <button mat-raised-button class=\"action\" (click)=\"openRestApi()\">\r\n          <span>Use in JSON / REST API</span>\r\n          <mat-icon>code_curly</mat-icon>\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n}\r\n","import { Context } from '../../shared/services/context';\r\nimport { PipelineModel } from '../models';\r\n\r\n/**\r\n * Check if there are special warnings the developer should know.\r\n * Typically when the test ModuleId is different from the one we're currently working on\r\n */\r\nexport function calculateWarnings(pipelineModel: PipelineModel, context: Context) {\r\n  if(!pipelineModel) return [];\r\n  const warnings: string[] = [];\r\n\r\n  try {\r\n    const queryParams = pipelineModel.Pipeline.Params?.split(/\\r?\\n/) || [];\r\n    const testParams = pipelineModel.Pipeline.TestParameters?.split(/\\r?\\n/) || [];\r\n\r\n    queryParams.forEach(param => {\r\n      param = param?.trim();\r\n      if (!param) return;\r\n\r\n      // Check if the syntax on Query Parameters is off.\r\n      // It should contain [...]=...\r\n      // But it's easy to forget the [ and ] brackets\r\n      const paramSyntax = /^[a-zA-Z0-9]+=(.*)$/gmi;\r\n      const matched = paramSyntax.test(param);\r\n      if (!matched) {\r\n        warnings.push(`\r\n          A <em>Query Parameter</em> seems wrong: <br>\r\n          <code>${param}</code> <br>\r\n          It should use the syntax: <br>\r\n          <code>key=value</code> <br>\r\n          or resolve to a token like: <br>\r\n          <code>key=[source:key]</code>\r\n        `);\r\n      }\r\n    });\r\n\r\n    testParams.forEach(param => {\r\n      param = param?.trim();\r\n      if (!param) return;\r\n\r\n      // Check if the syntax on Test Parameters is off.\r\n      // It should contain [...]=...\r\n      // But it's easy to forget the [ and ] brackets\r\n      const testParamSyntax = /^\\[[a-zA-Z]+:[a-zA-Z0-9]+\\]=(.*)$/gmi;\r\n      const matched = testParamSyntax.test(param);\r\n      if (!matched) {\r\n        warnings.push(`\r\n          A <em>Test Parameter</em> seems wrong: <br>\r\n          <code>${param}</code> <br>\r\n          It should use the syntax: <br>\r\n          <code>[source:key]=value</code>\r\n        `);\r\n      }\r\n\r\n      // Check if we should show the warning about the test ModuleId.\r\n      // This is because in the old days, the ModuleId wasn't auto-filled, so people had to add it as a test value.\r\n      // Now it's not necessary any more\r\n      const midRegex = /^\\[module:id\\]=([0-9]*)$/gmi;\r\n      const midMatch = midRegex.exec(param);\r\n      if (midMatch) {\r\n        const testMid = midMatch[1];\r\n        const urlMid = context.moduleId?.toString();\r\n        if (testMid !== urlMid) {\r\n          warnings.push(`\r\n            Your test ModuleId (${testMid}) is different from the current ModuleId (${urlMid}).<br>\r\n            Note that 2sxc automatically provides the ModuleId - so you usually do not need to set it\r\n          `);\r\n        }\r\n      }\r\n\r\n      const oldMidRegex = /^\\[module:moduleid\\]=([0-9]*)$/gmi;\r\n      const oldMidMatch = oldMidRegex.exec(param);\r\n      if (oldMidMatch) {\r\n        warnings.push(`\r\n          You are using deprecated [Module:ModuleId] test parameter.<br>\r\n          Please use [Module:Id]\r\n        `);\r\n      }\r\n    });\r\n  } catch (error) {\r\n    console.error('Something went wrong in calculateWarnings for params', error);\r\n  }\r\n\r\n  return warnings;\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { map } from 'rxjs';\r\nimport { webApiQueryDataSources, webApiQueryDebugStream, webApiQueryGet, webApiQueryRun, webApiQuerySave } from '../../app-administration/services';\r\nimport { eavConstants } from '../../shared/constants/eav.constants';\r\nimport { HttpServiceBase } from '../../shared/services/http-service-base';\r\nimport { DataSource, PipelineDataSource, PipelineModel, PipelineResult } from '../models';\r\n\r\n@Injectable()\r\nexport class QueryDefinitionService extends HttpServiceBase {\r\n\r\n  fetchPipeline(pipelineEntityId: number, dataSources: DataSource[]) {\r\n    return this.getHttp<PipelineModel>(webApiQueryGet, {\r\n      params: { appId: this.appId, id: pipelineEntityId.toString() }\r\n    }).pipe(\r\n      map(pipelineModel => {\r\n        // if pipeline is new, populate it with default model\r\n        if (!pipelineModel.DataSources.length) {\r\n          this.buildDefaultModel(pipelineModel, dataSources);\r\n        }\r\n        this.fixPipelineDataSources(pipelineModel.DataSources);\r\n        return pipelineModel;\r\n      }),\r\n    );\r\n  }\r\n\r\n  private buildDefaultModel(pipelineModel: PipelineModel, dataSources: DataSource[]) {\r\n    const templateDataSources = eavConstants.pipelineDesigner.defaultPipeline.dataSources;\r\n    for (const templateDS of templateDataSources) {\r\n      const dataSource = dataSources.find(ds => ds.PartAssemblyAndType === templateDS.PartAssemblyAndType);\r\n      const pipelineDataSource: PipelineDataSource = {\r\n        Description: '',\r\n        EntityGuid: templateDS.EntityGuid,\r\n        EntityId: undefined,\r\n        Name: dataSource.Name,\r\n        PartAssemblyAndType: templateDS.PartAssemblyAndType,\r\n        VisualDesignerData: templateDS.VisualDesignerData,\r\n      };\r\n      pipelineModel.DataSources.push(pipelineDataSource);\r\n    }\r\n\r\n    pipelineModel.Pipeline.StreamWiring = eavConstants.pipelineDesigner.defaultPipeline.streamWiring;\r\n  }\r\n\r\n  private fixPipelineDataSources(pipelineDataSources: PipelineDataSource[]) {\r\n    const outDataSourceExists = pipelineDataSources.some(\r\n      pipelineDS => pipelineDS.EntityGuid === eavConstants.pipelineDesigner.outDataSource.EntityGuid\r\n    );\r\n    if (!outDataSourceExists) {\r\n      const outDs = eavConstants.pipelineDesigner.outDataSource;\r\n      const outDsConst: PipelineDataSource = {\r\n        Description: outDs.Description,\r\n        EntityGuid: outDs.EntityGuid,\r\n        EntityId: undefined,\r\n        Name: outDs.Name,\r\n        PartAssemblyAndType: outDs.PartAssemblyAndType,\r\n        VisualDesignerData: outDs.VisualDesignerData,\r\n      };\r\n      pipelineDataSources.push(outDsConst);\r\n    }\r\n\r\n    for (const pipelineDataSource of pipelineDataSources) {\r\n      pipelineDataSource.VisualDesignerData ??= { Top: 50, Left: 50 };\r\n    }\r\n  }\r\n\r\n  fetchDataSources() {\r\n    return this.getHttp<DataSource[]>(webApiQueryDataSources, {\r\n      params: {\r\n        appid: this.appId,\r\n        zoneId: this.zoneId,\r\n      },\r\n    }).pipe(\r\n      map(dataSources => {\r\n        const outDs = eavConstants.pipelineDesigner.outDataSource;\r\n        const outDsConst: DataSource = {\r\n          ContentType: undefined,\r\n          Difficulty: eavConstants.pipelineDesigner.dataSourceDifficulties.default,\r\n          DynamicIn: true,\r\n          DynamicOut: false,\r\n          EnableConfig: undefined,\r\n          HelpLink: undefined,\r\n          Icon: undefined,\r\n          In: outDs.In,\r\n          Name: outDs.Name,\r\n          Out: undefined,\r\n          PartAssemblyAndType: outDs.PartAssemblyAndType,\r\n          PrimaryType: outDs.PrimaryType,\r\n          TypeNameForUi: undefined,\r\n          UiHint: undefined,\r\n        };\r\n        dataSources.push(outDsConst);\r\n        return dataSources;\r\n      }),\r\n    );\r\n  }\r\n\r\n  typeNameFilter(input: string, format: 'className' | 'classFullName') {\r\n    const globalParts = input.split(', ');\r\n\r\n    switch (format) {\r\n      case 'classFullName':\r\n        const classFullName = globalParts[0];\r\n        return classFullName;\r\n      case 'className':\r\n        const classFullNameParts = globalParts[0].split('.');\r\n        const className = classFullNameParts[classFullNameParts.length - 1];\r\n        return className;\r\n      default:\r\n        return input;\r\n    }\r\n  }\r\n\r\n  /** Save the current query and reload entire definition as returned from server */\r\n  savePipeline(pipelineModel: PipelineModel) {\r\n    const pipeline = pipelineModel.Pipeline;\r\n    const dataSources = pipelineModel.DataSources;\r\n\r\n    return this.http.post<PipelineModel>(\r\n      webApiQuerySave,\r\n      { pipeline, dataSources },\r\n      { params: { appId: this.appId, Id: pipeline.EntityId.toString() } }\r\n    ).pipe(\r\n      map(newPipelineModel => {\r\n        this.fixPipelineDataSources(newPipelineModel.DataSources);\r\n        return newPipelineModel;\r\n      }),\r\n    );\r\n  }\r\n\r\n  /** `top` - fetch first X items */\r\n  runPipeline(id: number, top: number) {\r\n    return this.getHttp<PipelineResult>(webApiQueryRun, {\r\n      params: { appId: this.appId, id: id.toString(), top: top.toString() }\r\n    });\r\n  }\r\n\r\n  /** `top` - fetch first X items */\r\n  debugStream(id: number, source: string, sourceOut: string, top: number) {\r\n    return this.getHttp<PipelineResult>(webApiQueryDebugStream, {\r\n      params: { appId: this.appId, id: id.toString(), from: source, out: sourceOut, top: top.toString() }\r\n    });\r\n  }\r\n}\r\n","import { HttpErrorResponse } from '@angular/common/http';\r\nimport { ChangeDetectorRef, Injectable, NgZone, OnDestroy, signal, ViewContainerRef } from '@angular/core';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { Title } from '@angular/platform-browser';\r\nimport cloneDeep from 'lodash-es/cloneDeep';\r\nimport { filter, fromEvent, Subject } from 'rxjs';\r\nimport { ContentTypesService } from '../../app-administration/services/content-types.service';\r\nimport { MetadataService } from '../../permissions/services/metadata.service';\r\nimport { eavConstants } from '../../shared/constants/eav.constants';\r\nimport { convertFormToUrl } from '../../shared/helpers/url-prep.helper';\r\nimport { EditForm, EditPrep } from '../../shared/models/edit-form.model';\r\nimport { QueryDefinitionService } from './query-definition.service';\r\n// tslint:disable-next-line:max-line-length\r\nimport { transient } from '../../../../../core';\r\nimport { isCtrlS } from '../../edit/dialog/main/keyboard-shortcuts';\r\nimport { JsonHelpers } from '../../shared/helpers/json.helpers';\r\nimport { DialogRoutingService } from '../../shared/routing/dialog-routing.service';\r\nimport { ServiceBase } from '../../shared/services/service-base';\r\nimport { DataSource, DataSourceConfig, DataSourceConfigs, DebugStreamInfo, PipelineDataSource, PipelineModel, PipelineResult, PipelineResultStream, StreamWire, VisualDesignerData } from '../models';\r\nimport { QueryResultComponent } from '../query-result/query-result.component';\r\nimport { QueryResultDialogData } from '../query-result/query-result.models';\r\nimport { StreamErrorResultComponent } from '../stream-error-result/stream-error-result.component';\r\nimport { StreamErrorResultDialogData } from '../stream-error-result/stream-error-result.models';\r\n\r\n/**\r\n * Service containing the state for the visual query.\r\n * It's shared, so should not be used with transient(...);\r\n */\r\n@Injectable()\r\nexport class VisualQueryStateService extends ServiceBase implements OnDestroy {\r\n\r\n  #contentTypesSvc = transient(ContentTypesService);\r\n  #metadataSvc = transient(MetadataService);\r\n  #queryDefSvc = transient(QueryDefinitionService);\r\n  #dialogRoute = transient(DialogRoutingService);\r\n  #titleSvc = transient(Title);\r\n\r\n  pipelineModel = signal<PipelineModel>(null);\r\n  dataSources = signal<DataSource[]>(null);\r\n  dataSourceConfigs = signal<DataSourceConfigs>({});\r\n\r\n  putEntityCountOnConnections$ = new Subject<PipelineResult>();\r\n\r\n  queryResult?: PipelineResult;\r\n\r\n  #pipelineId = parseInt(this.#dialogRoute.getParam('pipelineId'), 10);\r\n  #refreshPipeline = false;\r\n  #refreshDataSourceConfigs = false;\r\n\r\n  constructor(\r\n    private snackBar: MatSnackBar,\r\n    private matDialog: MatDialog,\r\n    private viewContainerRef: ViewContainerRef,\r\n    private zone: NgZone,\r\n    private changeDetectorRef: ChangeDetectorRef,\r\n  ) {\r\n    super();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.putEntityCountOnConnections$.complete();\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  init() {\r\n    this.#fetchDataSources(() => this.#fetchPipeline(true, true, false));\r\n    this.#attachKeyboardSave();\r\n    this.#dialogRoute.doOnDialogClosed(() => {\r\n      if (this.#refreshPipeline || this.#refreshDataSourceConfigs)\r\n        this.#fetchPipeline(this.#refreshPipeline, this.#refreshDataSourceConfigs, this.#refreshPipeline);\r\n      this.#refreshPipeline = false;\r\n      this.#refreshDataSourceConfigs = false;\r\n    });\r\n  }\r\n\r\n  public editPipelineEntity() {\r\n    // save Pipeline, then open Edit Dialog\r\n    this.#savePipeline(() => {\r\n      const form: EditForm = {\r\n        items: [EditPrep.editId(this.pipelineModel().Pipeline.EntityId)],\r\n      };\r\n      const formUrl = convertFormToUrl(form);\r\n      this.#dialogRoute.navRelative([`edit/${formUrl}`]);\r\n      this.#refreshPipeline = true;\r\n    });\r\n  }\r\n\r\n  public saveAndRun(save: boolean, run: boolean): void {\r\n    if (save && run)\r\n      return this.#savePipeline(() => this.runPipeline());\r\n\r\n    if (save)\r\n      return this.#savePipeline();\r\n\r\n    if (run)\r\n      return this.runPipeline();\r\n  }\r\n\r\n  showDataSourceDetails(showDetails: boolean) {\r\n    const query = cloneDeep(this.pipelineModel());\r\n    const designerData: Record<string, any> = JsonHelpers.tryParse(query.Pipeline.VisualDesignerData) ?? {};\r\n    designerData.ShowDataSourceDetails = showDetails;\r\n    query.Pipeline.VisualDesignerData = JSON.stringify(designerData);\r\n    this.pipelineModel.set(query);\r\n  }\r\n\r\n  addDataSource(dataSource: DataSource) {\r\n    const query = cloneDeep(this.pipelineModel());\r\n    const newSource: PipelineDataSource = {\r\n      Description: '',\r\n      EntityGuid: 'unsaved' + (query.DataSources.length + 1),\r\n      EntityId: undefined,\r\n      Name: dataSource.Name,\r\n      PartAssemblyAndType: dataSource.PartAssemblyAndType,\r\n      VisualDesignerData: { Top: 100, Left: 100 },\r\n    };\r\n    query.DataSources.push(newSource);\r\n    this.pipelineModel.set(query);\r\n    this.#savePipeline();\r\n  }\r\n\r\n  removeDataSource(pipelineDataSourceGuid: string, connections: StreamWire[], streamsOut: string) {\r\n    const query = cloneDeep(this.pipelineModel());\r\n    query.DataSources = query.DataSources.filter(pipelineDS => pipelineDS.EntityGuid !== pipelineDataSourceGuid);\r\n    query.Pipeline.StreamWiring = connections;\r\n    query.Pipeline.StreamsOut = streamsOut;\r\n    this.pipelineModel.set(query);\r\n  }\r\n\r\n  renameDataSource(pipelineDataSourceGuid: string, name: string) {\r\n    const query = cloneDeep(this.pipelineModel());\r\n    const dataSource = query.DataSources.find(pipelineDS => pipelineDS.EntityGuid === pipelineDataSourceGuid);\r\n    dataSource.Name = name;\r\n    this.pipelineModel.set(query);\r\n  }\r\n\r\n  changeDataSourceDescription(pipelineDataSourceGuid: string, description: string) {\r\n    const query = cloneDeep(this.pipelineModel());\r\n    const dataSource = query.DataSources.find(pipelineDS => pipelineDS.EntityGuid === pipelineDataSourceGuid);\r\n    dataSource.Description = description;\r\n    this.pipelineModel.set(query);\r\n  }\r\n\r\n  changeConnections(connections: StreamWire[], streamsOut: string) {\r\n    const query = cloneDeep(this.pipelineModel());\r\n    query.Pipeline.StreamWiring = connections;\r\n    query.Pipeline.StreamsOut = streamsOut;\r\n    this.pipelineModel.set(query);\r\n  }\r\n\r\n  changeDataSourcePosition(pipelineDataSourceGuid: string, position: VisualDesignerData) {\r\n    const query = cloneDeep(this.pipelineModel());\r\n    const dataSource = query.DataSources.find(pipelineDS => pipelineDS.EntityGuid === pipelineDataSourceGuid);\r\n    if (!dataSource) {\r\n      // spm NOTE: fixes problem where dataSource position can't be updated if dataSource with guid unsavedXX gets saved while dragging.\r\n      // Can happen if dataSource is just added and user drags it and save happens.\r\n      return;\r\n    }\r\n    dataSource.VisualDesignerData = { ...dataSource.VisualDesignerData, ...position };\r\n    this.pipelineModel.set(query);\r\n  }\r\n\r\n  #calculateDataSourceConfigs(dataSources: PipelineDataSource[]) {\r\n    const dataSourceConfigs: DataSourceConfigs = {};\r\n    dataSources.forEach(dataSource => {\r\n      if (dataSource.EntityId == null) return;\r\n      dataSourceConfigs[dataSource.EntityId] = [];\r\n      dataSource.Metadata?.forEach(metadataItem => {\r\n        Object.entries(metadataItem).forEach(([attributeName, attributeValue]) => {\r\n          if (attributeValue == null || attributeValue === '') return;\r\n          if (['Created', 'Guid', 'Id', 'Modified', 'Title', '_Type'].includes(attributeName)) return;\r\n          if (Array.isArray(attributeValue) && attributeValue[0]?.Title !== null && attributeValue[0]?.Id !== null) {\r\n            attributeValue = `${attributeValue[0].Title} (${attributeValue[0].Id})`;\r\n          }\r\n          const dataSourceConfig: DataSourceConfig = {\r\n            name: attributeName,\r\n            value: attributeValue,\r\n          };\r\n          dataSourceConfigs[dataSource.EntityId].push(dataSourceConfig);\r\n        });\r\n      });\r\n    });\r\n    this.dataSourceConfigs.set(dataSourceConfigs);\r\n  }\r\n\r\n  editDataSource(pipelineDataSource: PipelineDataSource) {\r\n    const dataSource = this.dataSources().find(ds => ds.PartAssemblyAndType === pipelineDataSource.PartAssemblyAndType);\r\n    const contentTypeName = dataSource.ContentType;\r\n    const { targetType, keyType } = eavConstants.metadata.entity;\r\n    const key = pipelineDataSource.EntityGuid;\r\n\r\n    // query for existing Entity\r\n    this.#metadataSvc.getMetadata(targetType, keyType, key, contentTypeName).subscribe(metadata => {\r\n      // edit existing Entity\r\n      if (metadata.Items.length) {\r\n        const form: EditForm = {\r\n          items: [EditPrep.editId(metadata.Items[0].Id)],\r\n        };\r\n        const formUrl = convertFormToUrl(form);\r\n        this.#dialogRoute.navRelative([`edit/${formUrl}`]);\r\n        this.#refreshDataSourceConfigs = true;\r\n        return;\r\n      }\r\n\r\n      // Check if the type exists, and if yes, create new Entity\r\n      this.#contentTypesSvc.retrieveContentType(contentTypeName).subscribe({\r\n        next: contentType => {\r\n          if (contentType == null) {\r\n            this.snackBar.open('DataSource doesn\\'t have any configuration', undefined, { duration: 3000 });\r\n            return;\r\n          }\r\n          const form: EditForm = {\r\n            items: [ EditPrep.newMetadata(key, contentTypeName, eavConstants.metadata.entity) ],\r\n          };\r\n          const formUrl = convertFormToUrl(form);\r\n          this.#dialogRoute.navRelative([`edit/${formUrl}`]);\r\n          this.#refreshDataSourceConfigs = true;\r\n        },\r\n        error: (error: HttpErrorResponse) => {\r\n          const message = 'Server reports error - this usually means that this DataSource doesn\\'t have any configuration';\r\n          this.snackBar.open(message, undefined, { duration: 3000 });\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  #savePipeline(callback?: () => void) {\r\n    this.snackBar.open('Saving...');\r\n    this.#queryDefSvc.savePipeline(this.pipelineModel()).subscribe({\r\n      next: pipelineModel => {\r\n        this.snackBar.open('Saved', null, { duration: 2000 });\r\n        this.pipelineModel.set(pipelineModel);\r\n        if (callback != null) { callback(); }\r\n      },\r\n      error: (error: HttpErrorResponse) => {\r\n        this.snackBar.open('Save Pipeline failed', null, { duration: 2000 });\r\n      }\r\n    });\r\n  }\r\n\r\n  runPipeline(top = 25) {\r\n    this.snackBar.open('Running query...');\r\n    this.#queryDefSvc.runPipeline(this.pipelineModel().Pipeline.EntityId, top).subscribe({\r\n      next: pipelineResult => {\r\n        this.snackBar.open('Query worked', null, { duration: 2000 });\r\n        this.queryResult = pipelineResult;\r\n        this.#showQueryResult(pipelineResult, top);\r\n        console.warn(pipelineResult);\r\n        // push cloned pipelineModel to reset jsPlumb\r\n        this.pipelineModel.set(cloneDeep(this.pipelineModel()));\r\n\r\n        setTimeout(() => { this.putEntityCountOnConnections$.next(pipelineResult); });\r\n      },\r\n      error: (error: HttpErrorResponse) => {\r\n        this.snackBar.open('Query failed', null, { duration: 2000 });\r\n      }\r\n    });\r\n  }\r\n\r\n  debugStream(stream: PipelineResultStream, top = 25): void {\r\n    if (stream.Error)\r\n      return this.#showStreamErrorResult(stream);\r\n\r\n    if (stream.Count === 0)\r\n      return;\r\n\r\n    this.snackBar.open('Running stream...');\r\n    const pipelineId = this.pipelineModel().Pipeline.EntityId;\r\n    this.#queryDefSvc.debugStream(pipelineId, stream.Source, stream.SourceOut, top).subscribe({\r\n      next: streamResult => {\r\n        this.snackBar.open('Stream worked', null, { duration: 2000 });\r\n        const pipelineDataSource = this.pipelineModel().DataSources.find(ds => ds.EntityGuid === stream.Source);\r\n        const debugStream: DebugStreamInfo = {\r\n          name: stream.SourceOut,\r\n          source: stream.Source,\r\n          sourceName: pipelineDataSource.Name,\r\n          original: stream,\r\n        };\r\n        this.#showQueryResult(streamResult, top, debugStream);\r\n        console.warn(streamResult);\r\n      },\r\n      error: (_: HttpErrorResponse) => {\r\n        this.snackBar.open('Stream failed', null, { duration: 2000 });\r\n      },\r\n    });\r\n  }\r\n\r\n  #fetchPipeline(refreshPipeline: boolean, refreshDataSourceConfigs: boolean, showSnackBar: boolean) {\r\n    if (showSnackBar)\r\n      this.snackBar.open('Reloading query, please wait...');\r\n\r\n    this.#queryDefSvc.fetchPipeline(this.#pipelineId, this.dataSources()).subscribe(pipelineModel => {\r\n      if (showSnackBar)\r\n        this.snackBar.open('Query reloaded', null, { duration: 2000 });\r\n\r\n      this.#titleSvc.setTitle(`${pipelineModel.Pipeline.Name} - Visual Query`);\r\n      if (refreshPipeline)\r\n      this.pipelineModel.set(pipelineModel);\r\n\r\n\r\n      if (refreshDataSourceConfigs)\r\n        this.#calculateDataSourceConfigs(pipelineModel.DataSources);\r\n    });\r\n  }\r\n\r\n  #showQueryResult(result: PipelineResult, top: number, debugStream?: DebugStreamInfo) {\r\n    const dialogData: QueryResultDialogData = {\r\n      result,\r\n      debugStream,\r\n      top,\r\n    };\r\n    this.matDialog.open(QueryResultComponent, {\r\n      autoFocus: false,\r\n      backdropClass: 'dialog-backdrop',\r\n      closeOnNavigation: false,\r\n      data: dialogData,\r\n      panelClass: ['dialog-panel', `dialog-panel-medium`, 'no-scrollbar'],\r\n      // spm NOTE: position used to force align-items: flex-start; on cdk-global-overlay-wrapper.\r\n      // Real top margin is overwritten in css e.g. dialog-panel-large\r\n      position: { top: '0' },\r\n      viewContainerRef: this.viewContainerRef,\r\n    });\r\n    this.changeDetectorRef.markForCheck();\r\n  }\r\n\r\n  #showStreamErrorResult(stream: PipelineResultStream) {\r\n    const dialogData: StreamErrorResultDialogData = {\r\n      errorData: stream.ErrorData,\r\n    };\r\n    this.matDialog.open(StreamErrorResultComponent, {\r\n      autoFocus: false,\r\n      backdropClass: 'dialog-backdrop',\r\n      closeOnNavigation: false,\r\n      data: dialogData,\r\n      panelClass: ['dialog-panel', `dialog-panel-medium`, 'no-scrollbar'],\r\n      // spm NOTE: position used to force align-items: flex-start; on cdk-global-overlay-wrapper.\r\n      // Real top margin is overwritten in css e.g. dialog-panel-large\r\n      position: { top: '0' },\r\n      viewContainerRef: this.viewContainerRef,\r\n    });\r\n    this.changeDetectorRef.markForCheck();\r\n  }\r\n\r\n  #fetchDataSources(callback?: () => void) {\r\n    this.#queryDefSvc.fetchDataSources().subscribe(dataSources => {\r\n      this.dataSources.set(dataSources);\r\n      callback();\r\n    });\r\n  }\r\n\r\n  #attachKeyboardSave() {\r\n    this.zone.runOutsideAngular(() => {\r\n      this.subscriptions.add(\r\n        fromEvent<KeyboardEvent>(window, 'keydown').pipe(\r\n          filter(() => !this.#dialogRoute.snapshot.firstChild),\r\n          filter(event => isCtrlS(event)),\r\n        ).subscribe(event => {\r\n          event.preventDefault();\r\n          this.zone.run(() => { this.#savePipeline(); });\r\n        })\r\n      );\r\n    });\r\n  }\r\n}\r\n","import { JsonPipe } from '@angular/common';\r\nimport { Component, Inject, OnInit } from '@angular/core';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MAT_DIALOG_DATA, MatDialogActions, MatDialogRef } from '@angular/material/dialog';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { EavWindow } from '../../shared/models/eav-window.model';\r\nimport { StreamErrorData } from '../models';\r\nimport { StreamErrorResultDialogData } from './stream-error-result.models';\r\n\r\ndeclare const window: EavWindow;\r\n\r\n@Component({\r\n  selector: 'app-stream-error-result',\r\n  templateUrl: './stream-error-result.component.html',\r\n  styleUrls: ['./stream-error-result.component.scss'],\r\n  standalone: true,\r\n  imports: [\r\n    MatButtonModule,\r\n    MatIconModule,\r\n    MatDialogActions,\r\n    JsonPipe,\r\n  ],\r\n})\r\nexport class StreamErrorResultComponent implements OnInit {\r\n  errorData: StreamErrorData;\r\n\r\n  constructor(\r\n    @Inject(MAT_DIALOG_DATA) private dialogData: StreamErrorResultDialogData,\r\n    private dialog: MatDialogRef<StreamErrorResultComponent>,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.errorData = this.dialogData.errorData;\r\n  }\r\n\r\n  closeDialog() {\r\n    this.dialog.close();\r\n  }\r\n\r\n  openInsights() {\r\n    window.open(window.$2sxc.http.apiUrl('sys/insights/logs?key=web-api-query'), '_blank');\r\n  }\r\n}\r\n","<div class=\"eav-dialog\">\r\n  <div class=\"eav-dialog-header\">\r\n    <div class=\"eav-dialog-header__title\">Stream Error Results</div>\r\n    <button mat-icon-button tippy=\"Close dialog\" (click)=\"closeDialog()\">\r\n      <mat-icon>close</mat-icon>\r\n    </button>\r\n  </div>\r\n  <div class=\"eav-dialog-content\">\r\n    <pre>{{ errorData | json }}</pre>\r\n  </div>\r\n  <mat-dialog-actions align=\"end\">\r\n    <button mat-button class=\"eav-button__with-icon\" tippy=\"Open 2sxc Insights\" (click)=\"openInsights()\">\r\n      <mat-icon class=\"eav-icon\">speed</mat-icon>\r\n      <span>Insights</span>\r\n    </button>\r\n  </mat-dialog-actions>\r\n</div>\r\n","import { NgClass } from '@angular/common';\r\nimport { Component, OnInit, ViewChild } from '@angular/core';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { ActivatedRoute, RouterOutlet } from '@angular/router';\r\nimport { Context } from '../shared/services/context';\r\nimport { AddExplorerComponent } from './add-explorer/add-explorer.component';\r\nimport { PlumbEditorComponent } from './plumb-editor/plumb-editor.component';\r\nimport { RunExplorerComponent } from './run-explorer/run-explorer.component';\r\nimport { VisualQueryStateService } from './services/visual-query.service';\r\n\r\n@Component({\r\n  selector: 'app-visual-query',\r\n  templateUrl: './visual-query.component.html',\r\n  styleUrls: ['./visual-query.component.scss'],\r\n  standalone: true,\r\n  imports: [\r\n    RouterOutlet,\r\n    NgClass,\r\n    MatIconModule,\r\n    RunExplorerComponent,\r\n    AddExplorerComponent,\r\n    PlumbEditorComponent,\r\n  ],\r\n  providers: [\r\n    VisualQueryStateService,  // Shared State for the entire Visual Query, - init run here\r\n  ],\r\n})\r\nexport class VisualQueryComponent implements OnInit {\r\n  @ViewChild(PlumbEditorComponent) plumbEditor: PlumbEditorComponent;\r\n\r\n  explorer = {\r\n    run: 'run',\r\n    add: 'add'\r\n  };\r\n  activeExplorer = this.explorer.run;\r\n\r\n  constructor(\r\n    private context: Context,\r\n    private route: ActivatedRoute,\r\n    private visualQueryService: VisualQueryStateService\r\n  ) {\r\n    this.context.init(this.route);\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.visualQueryService.init();\r\n  }\r\n\r\n  toggleExplorer(explorer: string) {\r\n    this.activeExplorer = (this.activeExplorer === explorer) ? null : explorer;\r\n  }\r\n\r\n  openHelp() {\r\n    window.open('https://go.2sxc.org/visual-query', '_blank');\r\n  }\r\n\r\n}\r\n","<router-outlet></router-outlet>\r\n\r\n<div class=\"editor-root\">\r\n  <div class=\"editor-side-toolbar\">\r\n    <div class=\"button\" tippy=\"Run\" [ngClass]=\"{ 'active': activeExplorer === explorer.run }\"\r\n      (click)=\"toggleExplorer(explorer.run)\">\r\n      <mat-icon>play_arrow</mat-icon>\r\n    </div>\r\n    <div class=\"button\" tippy=\"Add\" [ngClass]=\"{ 'active': activeExplorer === explorer.add }\"\r\n      (click)=\"toggleExplorer(explorer.add)\">\r\n      <mat-icon>add</mat-icon>\r\n    </div>\r\n    <div class=\"spacer\"></div>\r\n    <div class=\"button\" tippy=\"Help\" (click)=\"openHelp()\">\r\n      <mat-icon>help_outline</mat-icon>\r\n    </div>\r\n  </div>\r\n\r\n  <app-run-explorer [hidden]=\"activeExplorer !== explorer.run\"></app-run-explorer>\r\n\r\n  <app-add-explorer [hidden]=\"activeExplorer !== explorer.add\"></app-add-explorer>\r\n\r\n  <app-plumb-editor></app-plumb-editor>\r\n</div>\r\n"],"names":["from","map","switchMap","toBase64","webApiEntityList","HttpServiceBase","webApiQueryImport","webApiQueryClone","webApiQueryDelete","webApiQueryRun","webApiQueryDebugStream","webApiQuerySave","webApiQueryGet","webApiQueryDataSources","PipelinesService","getAll","contentType","getHttpApiUrl","params","appId","importQuery","file","pipe","fileBase64","http","post","apiUrl","AppId","ContentBase64","success","result","Success","Messages","clonePipeline","id","Id","toString","delete","__ngFactoryType__","factory","ɵfac","webApiViewRoot","webApiViews","webApiViewDelete","webApiViewImport","webApiViewPolymorph","webApiViewUsage","ViewsService","import","formData","FormData","append","zoneId","export","url","window","open","getPolymorphism","getUsage","guid","MousedownStopPropagationDirective","onMousedown","event","stopPropagation","selectors","hostBindings","MousedownStopPropagationDirective_HostBindings","rf","ctx","i0","ɵɵlistener","MousedownStopPropagationDirective_mousedown_HostBindingHandler","$event","ArrayHelpers","toggleInArray","item","array","index","indexOf","push","splice","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","split","onerror","error","readAsText","KeyValue","KeyValuePipe","computed","signal","MatIconModule","MatSlideToggleModule","eavConstants","TippyDirective","guiTypes","VisualQueryStateService","filterAndSortDataSources","ɵɵelementStart","AddExplorerComponent_Conditional_0_For_6_Conditional_5_For_2_Template_div_click_0_listener","dataSource_r6","ɵɵrestoreView","_r5","$implicit","ctx_r1","ɵɵnextContext","ɵɵresetView","addDataSource","ɵɵtext","ɵɵelementEnd","ɵɵproperty","UiHint","Name","ɵɵadvance","ɵɵtextInterpolate","Icon","Unknown","ɵɵrepeaterCreate","AddExplorerComponent_Conditional_0_For_6_Conditional_5_For_2_Template","ɵɵcomponentInstance","trackDataSources","ɵɵrepeater","group_r4","value","AddExplorerComponent_Conditional_0_For_6_Template_div_click_0_listener","_r3","toggleItem","key","ɵɵtemplate","AddExplorerComponent_Conditional_0_For_6_Conditional_5_Template","tmp_13_0","Label","undefined","ɵɵconditional","toggledItems","includes","AddExplorerComponent_Conditional_0_Template_mat_slide_toggle_change_4_listener","_r1","toggleDifficulty","AddExplorerComponent_Conditional_0_For_6_Template","trackGroups","ɵɵpipeBind1","sorted","AddExplorerComponent","difficulties","difficulty","constructor","visualQueryService","pipelineDesigner","dataSourceDifficulties","default","dataSources","checked","advanced","set","dataSource","type","PartAssemblyAndType","ɵɵdirectiveInject","i1","standalone","features","ɵɵStandaloneFeature","decls","vars","consts","template","AddExplorerComponent_Template","AddExplorerComponent_Conditional_0_Template","i2","MatSlideToggle","i3","MatIcon","styles","cloneDeep","maxDifficulty","cloned","filtered","filter","Difficulty","outDataSource","sort","a","b","toLocaleLowerCase","localeCompare","PrimaryType","classLog","logSpecs","all","getEndpointOverlays","getEndpointInfo","buildSourceEndpoint","buildTargetEndpoint","EndpointsHelper","plumb","log","isSource","l","fnIf","location","label","cssClass","r","endpointName","isDynamic","name","required","trimmed","trim","endsWith","substring","length","pipelineDataSourceGuid","style","sourceEndpoint","paintStyle","fill","radius","maxConnections","anchor","faces","overlays","events","click","endpointOrOverlay","onChangeLabel","targetEndpoint","isTarget","dropOptions","hoverClass","activeClass","NgClass","NgStyle","ChangeDetectorRef","ElementRef","QueryList","ViewContainerRef","MatDialog","BehaviorSubject","combineLatest","transient","BaseComponent","JsonHelpers","loadScripts","QueryDefinitionService","calculateTypeInfos","dataSrcIdPrefix","Plumber","PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_5_Template_mat_icon_click_0_listener","_r2","dataSource_r3","ctx_r3","configureDataSource","PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_6_Template_mat_icon_click_0_listener","openHelp","typeInfos","EntityGuid","HelpLink","PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_8_Template_mat_icon_click_0_listener","_r6","remove","config_r7","ɵɵelement","PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_21_For_3_Template","ɵɵrepeaterTrackByIdentity","vsSvc","dataSourceConfigs","EntityId","PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_5_Template","PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_6_Template","PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_8_Template","PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Template_div_click_9_listener","pipelineModel","Pipeline","AllowEdit","editName","PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Template_div_click_15_listener","editDescription","PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_21_Template","PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_24_Template","PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_25_Template","ɵɵpureFunction3","_c2","VisualDesignerData","Top","Left","Width","ɵɵpureFunction1","_c3","showDataSourceDetails","tmp_16_0","ɵɵtextInterpolate1","EnableConfig","isOutDataSource","Description","tmp_24_0","getTypeName","DynamicOut","DynamicIn","PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Template","DataSources","PlumbEditorComponent_Conditional_0_Conditional_2_Template","hardReset","ngAfterViewInit","jsPlumbUrl","PlumbEditorComponent","plumber","scriptLoaded$","queryDefinitionSvc","changeDetectorRef","matDialog","viewContainerRef","tryParse","ShowDataSourceDetails","ngOnInit","test","src","next","subscriptions","add","putEntityCountOnConnections$","subscribe","putEntityCountOnConnections","domDataSourcesLoaded$","domDataSourcesRef","changes","scriptLoaded","domDataSourcesLoaded","destroy","domRootRef","nativeElement","onConnectionsChanged","bind","onDragend","onDebugStream","end","ngOnDestroy","complete","connections","getAllConnections","streamsOut","getStreamsOut","changeConnections","position","changeDataSourcePosition","stream","debugStream","saveAndRun","editDataSource","partAssemblyAndType","find","ds","typeNameFilter","TypeNameForUi","pipelineDataSource","confirm","removeEndpointsOnDataSource","removeDataSource","newName","prompt","renameDataSource","newDescription","changeDataSourceDescription","viewQuery","PlumbEditorComponent_Query","PlumbEditorComponent_Conditional_0_Template","App","Cache","Filter","Logic","Lookup","Modify","Security","Sort","Source","Target","Debug","System","pipelineDataSources","typeInfo","RenameStreamComponent","addEndpoint","endPointsWhereWeRotate","instance","lineCount","linePaintDefault","lineColors","maxCols","uuidColorMap","bulkDelete","dialog","endpoints","jsPlumbRoot","stroke","strokeWidth","outlineStroke","outlineWidth","jsPlumb","getInstance","getInstanceDefaults","batch","initDomDataSources","initWirings","bindEvents","repaintEverything","close","reset","unbindContainer","elementId","selectEndpoints","element","connectionInfos","connection","wire","From","sourceId","replace","Out","getOverlay","To","targetId","In","target","each","endpoint","streamsOutStr","join","Streams","forEach","sourceElementId","outTargets","targetElementId","fromUuid","SourceOut","toUuid","TargetIn","sEndp","getEndpoint","getUuid","Error","Count","setLabel","overlay","nextLinePaintStyle","#nextLinePaintStyle","uuid","Object","assign","#getInstanceDefaults","container","defaults","Container","Connector","curviness","PaintStyle","HoverPaintStyle","#initDomDataSources","fnCond","domDataSource","querySelector","draggable","grid","stop","el","finalPos","setTimeout","outCount","out","inCount","in","targetEndpointUnlimited","makeTarget","makeSource","#initWirings","fn","wirings","StreamWiring","inGroups","groupBy","outGroups","values","pipeDataSource","connect","uuids","e","console","message","to","#addEndpoint","isIn","queryDs","count","d","connectionList","hasDynamic","some","endpointInfo","wireExists","targetEndpointName","angled","model","enabled","addClass","data","autoFocus","width","afterClosed","newLabel","markForCheck","#bindEvents","info","pipelineDS","deleteEndpoint","deleteConnection","fireEvent","endpointLabel","labelPrompt","getLabel","getEndpoints","targetEndpointHasSameLabel","canvas","classList","contains","Math","floor","random","arr","reduce","groups","FormsModule","ReactiveFormsModule","UntypedFormControl","UntypedFormGroup","Validators","MatButtonModule","MatOptionModule","MAT_DIALOG_DATA","MatDialogActions","MatDialogRef","MatFormFieldModule","MatInputModule","MatSelectModule","distinctUntilChanged","startWith","ContentTypesService","FieldHintComponent","ClickStopPropagationDirective","RenameStreamComponent_Conditional_9_Conditional_4_Template","RenameStreamComponent_Conditional_9_Conditional_5_Template","ctx_r0","pipelineResultExists","controls","touched","errors","scopeOption_r3","RenameStreamComponent_Conditional_10_Conditional_0_For_5_Template","scopeOptions","labelOption_r4","RenameStreamComponent_Conditional_10_Conditional_4_For_2_Template","labelOptions","RenameStreamComponent_Conditional_10_Conditional_0_Template","RenameStreamComponent_Conditional_10_Conditional_4_Template","RenameStreamComponent_Conditional_10_Conditional_5_Template","RenameStreamComponent_Conditional_10_Template_button_click_7_listener","toggleGuidedLabel","RenameStreamComponent_Conditional_10_Template_button_click_10_listener","RenameStreamComponent_Conditional_10_Conditional_13_Template","advancedMode","guidedLabel","_c0","RenameStreamComponent_Conditional_13_Template_mat_slide_toggle_change_0_listener","toggleAdvancedMode","contentTypesSvc","dialogData","hostClass","queryResult","buildForm","closeDialog","rename","formValue","form","getRawValue","#buildForm","scope","scopes","valueChanges","Sources","source","Guid","Scope","patchValue","getScopes","sourceOut","s","o","hostVars","RenameStreamComponent_HostBindings","ɵɵhostProperty","RenameStreamComponent_Template_button_click_4_listener","RenameStreamComponent_Conditional_9_Template","RenameStreamComponent_Conditional_10_Template","RenameStreamComponent_Conditional_13_Template","RenameStreamComponent_Template_button_click_15_listener","RenameStreamComponent_Template_button_click_17_listener","valid","MatButton","MatIconButton","i4","i5","ɵNgNoValidate","DefaultValueAccessor","NgControlStatus","NgControlStatusGroup","RequiredValidator","FormGroupDirective","FormControlName","i6","MatFormField","MatLabel","MatSuffix","i7","MatInput","i8","MatSelect","i9","MatOption","i10","encapsulation","JsonPipe","MatTabsModule","ɵɵtextInterpolate2","sourceName","top","option_r3","QueryResultComponent_For_20_Template_button_click_0_listener","show","QueryResultComponent_For_20_Conditional_2_Template","QueryResultComponent_For_20_Conditional_3_Template","param_r4","QueryResultComponent_Conditional_24_div_1_Template","QueryResultComponent_Conditional_24_For_5_Template","parameters","source_r5","Definition","config_r6","QueryResultComponent_For_39_Conditional_2_Template","QueryResultComponent_For_39_For_10_Template","Type","Configuration","stream_r7","QueryResultComponent","pipeline","Params","testParams","TestParameters","concat","timeUsed","QueryTimer","Milliseconds","ticksUsed","Ticks","optionsForTop","Query","sources","streams","original","runPipeline","QueryResultComponent_Template","QueryResultComponent_Conditional_4_Template","QueryResultComponent_Template_button_click_5_listener","QueryResultComponent_div_13_Template","QueryResultComponent_Conditional_16_Template","QueryResultComponent_Conditional_17_Template","QueryResultComponent_For_20_Template","QueryResultComponent_Conditional_24_Template","QueryResultComponent_div_26_Template","QueryResultComponent_For_39_Template","QueryResultComponent_div_42_Template","QueryResultComponent_For_55_Template","MatTabLabel","MatTab","MatTabGroup","GoToDevRest","DialogRoutingService","Context","calculateWarnings","param_r3","RunExplorerComponent_Conditional_0_Conditional_20_For_2_Template","tmp_2_0","RunExplorerComponent_Conditional_0_Conditional_24_For_2_Template","RunExplorerComponent_Conditional_0_Conditional_25_Template_mat_slide_toggle_change_3_listener","visualDesignerDataSig","warning_r6","ɵɵsanitizeHtml","RunExplorerComponent_Conditional_0_Conditional_26_Conditional_0_For_8_Template","warningSig","RunExplorerComponent_Conditional_0_Conditional_26_Conditional_0_Template","RunExplorerComponent_Conditional_0_Template_button_click_3_listener","saveAndRunQuery","RunExplorerComponent_Conditional_0_Template_button_click_5_listener","RunExplorerComponent_Conditional_0_Template_button_click_7_listener","RunExplorerComponent_Conditional_0_Template_button_click_14_listener","editPipeline","RunExplorerComponent_Conditional_0_Template_button_click_17_listener","openParamsHelp","RunExplorerComponent_Conditional_0_Conditional_20_Template","RunExplorerComponent_Conditional_0_Conditional_24_Template","RunExplorerComponent_Conditional_0_Conditional_25_Template","RunExplorerComponent_Conditional_0_Conditional_26_Template","RunExplorerComponent_Conditional_0_Conditional_27_Template","RunExplorerComponent_Conditional_0_Template_button_click_29_listener","openRestApi","tmp_1_0","RunExplorerComponent","dialogRouter","context","editPipelineEntity","save","run","queryGuid","navRelative","getUrlQueryDialog","RunExplorerComponent_Template","RunExplorerComponent_Conditional_0_Template","warnings","queryParams","param","paramSyntax","matched","testParamSyntax","midRegex","midMatch","exec","testMid","urlMid","moduleId","oldMidRegex","oldMidMatch","fetchPipeline","pipelineEntityId","getHttp","buildDefaultModel","fixPipelineDataSources","templateDataSources","defaultPipeline","templateDS","streamWiring","outDataSourceExists","outDs","outDsConst","fetchDataSources","appid","ContentType","input","format","globalParts","classFullName","classFullNameParts","className","savePipeline","newPipelineModel","NgZone","MatSnackBar","Title","fromEvent","Subject","MetadataService","convertFormToUrl","EditPrep","isCtrlS","ServiceBase","StreamErrorResultComponent","metadataSvc","queryDefSvc","dialogRoute","titleSvc","pipelineId","refreshPipeline","refreshDataSourceConfigs","snackBar","zone","parseInt","getParam","init","attachKeyboardSave","doOnDialogClosed","items","editId","formUrl","showDetails","query","designerData","JSON","stringify","newSource","StreamsOut","description","calculateDataSourceConfigs","#calculateDataSourceConfigs","Metadata","metadataItem","entries","attributeName","attributeValue","Array","isArray","dataSourceConfig","contentTypeName","targetType","keyType","metadata","entity","getMetadata","Items","retrieveContentType","duration","newMetadata","#savePipeline","callback","pipelineResult","showQueryResult","warn","showStreamErrorResult","streamResult","_","#fetchPipeline","showSnackBar","setTitle","#showQueryResult","backdropClass","closeOnNavigation","panelClass","#showStreamErrorResult","errorData","ErrorData","#fetchDataSources","#attachKeyboardSave","runOutsideAngular","snapshot","firstChild","preventDefault","ɵɵinject","openInsights","$2sxc","StreamErrorResultComponent_Template","StreamErrorResultComponent_Template_button_click_4_listener","StreamErrorResultComponent_Template_button_click_12_listener","ActivatedRoute","RouterOutlet","VisualQueryComponent","route","explorer","activeExplorer","toggleExplorer","VisualQueryComponent_Query","VisualQueryComponent_Template","VisualQueryComponent_Template_div_click_3_listener","VisualQueryComponent_Template_div_click_6_listener","VisualQueryComponent_Template_div_click_10_listener"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}