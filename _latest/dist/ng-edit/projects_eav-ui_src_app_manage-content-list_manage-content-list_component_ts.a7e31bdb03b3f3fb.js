"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_manage-content-list_manage-content-list_component_ts"],{5026:(K,v,s)=>{s.r(v),s.d(v,{ManageContentListComponent:()=>A});var l=s(6571),c=s(7941),x=s(2159),p=s(3216),_=s(334),I=s(9669),m=s(852),M=s(3840),g=s(4175),b=s(2275),L=s(7896),D=s(1459),h=s(5437),P=s(1897),O=s(4699),R=s(8471),u=s(7993),t=s(7580),T=s(3347);const k=(o,r)=>r.Index+"+"+r.Id;function B(o,r){if(1&o){const n=t.RV6();t.j41(0,"span"),t.EFF(1),t.k0s(),t.j41(2,"button",13),t.bIt("click",function(){t.eBV(n);const i=t.XpG(3);return t.Njj(i.editHeader())}),t.j41(3,"mat-icon"),t.EFF(4,"edit"),t.k0s()()}if(2&o){const n=t.XpG(3);t.R7$(),t.JRh(n.header().Title)}}function F(o,r){1&o&&(t.EFF(0),t.nI1(1,"translate")),2&o&&t.SpI(" ",t.bMT(1,1,"ManageContentList.NoHeader")," ")}function j(o,r){if(1&o&&(t.j41(0,"p"),t.EFF(1),t.nI1(2,"translate"),t.k0s(),t.j41(3,"p"),t.DNE(4,B,5,1)(5,F,2,3),t.k0s()),2&o){const n=t.XpG(2);t.R7$(),t.SpI(" ",t.bMT(2,2,"ManageContentList.Description")," "),t.R7$(3),t.vxM(4,n.header().Type?4:5)}}function $(o,r){if(1&o&&(t.j41(0,"p",5),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&o){let n;const e=t.XpG(2);t.R7$(),t.SpI(" ",t.bMT(2,1,"ManageContentList."+(e.reordered()?"ListHasBeenReordered":(null==(n=e.items())?null:n.length)<25?"SortItems":"SortLotsOfItems"))," ")}}function y(o,r){if(1&o){const n=t.RV6();t.j41(0,"div",7)(1,"div",14)(2,"mat-icon",15),t.EFF(3,"drag_handle"),t.k0s(),t.j41(4,"span",16),t.EFF(5),t.k0s()(),t.j41(6,"div")(7,"button",17),t.nI1(8,"translate"),t.bIt("click",function(){const i=t.eBV(n).$implicit,a=t.XpG(2);return t.Njj(a.addFromExisting(i.Index))}),t.j41(9,"mat-icon"),t.EFF(10,"playlist_add"),t.k0s()(),t.j41(11,"button",17),t.nI1(12,"translate"),t.bIt("click",function(){const i=t.eBV(n).$implicit,a=t.XpG(2);return t.Njj(a.addBelow(i.Index))}),t.j41(13,"mat-icon"),t.EFF(14,"add"),t.k0s()(),t.j41(15,"button",17),t.nI1(16,"translate"),t.bIt("click",function(){const i=t.eBV(n).$implicit,a=t.XpG(2);return t.Njj(a.remove(i))}),t.j41(17,"mat-icon"),t.EFF(18,"remove"),t.k0s()(),t.j41(19,"button",17),t.nI1(20,"translate"),t.bIt("click",function(){const i=t.eBV(n).$implicit,a=t.XpG(2);return t.Njj(a.editItem(i.Id))}),t.j41(21,"mat-icon"),t.EFF(22,"edit"),t.k0s()()()()}if(2&o){const n=r.$implicit,e=t.XpG(2);t.R7$(4),t.FCK("tippy","",n.Title," (",n.Id,")"),t.R7$(),t.Lme(" ",n.Title," (",n.Id,") "),t.R7$(2),t.Y8G("tippy",t.bMT(8,13,"Fields.Picker.AddExistingItem"))("disabled",0===n.Id),t.R7$(4),t.Y8G("tippy",t.bMT(12,15,"Fields.Picker.AddItemBelow"))("disabled",0===n.Id||e.reordered()),t.R7$(4),t.Y8G("tippy",t.bMT(16,17,"Fields.Picker.Remove"))("disabled",e.reordered()),t.R7$(4),t.Y8G("tippy",t.bMT(20,19,"Fields.Picker.Edit"))("disabled",0===n.Id)}}function U(o,r){if(1&o){const n=t.RV6();t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.EFF(3),t.nI1(4,"translate"),t.k0s()(),t.j41(5,"div",3),t.nrm(6,"router-outlet"),t.j41(7,"div",4),t.DNE(8,j,6,4)(9,$,3,3,"p",5),t.j41(10,"div",6),t.bIt("cdkDropListDropped",function(i){t.eBV(n);const a=t.XpG();return t.Njj(a.drop(i))}),t.Z7z(11,y,23,21,"div",7,k),t.k0s()()(),t.j41(13,"mat-dialog-actions",8)(14,"button",9),t.bIt("click",function(){t.eBV(n);const i=t.XpG();return t.Njj(i.closeDialog())}),t.EFF(15),t.nI1(16,"translate"),t.k0s(),t.j41(17,"button",10),t.bIt("click",function(){t.eBV(n);const i=t.XpG();return t.Njj(i.saveList())}),t.EFF(18),t.nI1(19,"translate"),t.k0s(),t.j41(20,"button",11),t.nI1(21,"translate"),t.bIt("click",function(){t.eBV(n);const i=t.XpG();return t.Njj(i.saveAndCloseList())}),t.j41(22,"mat-icon",12),t.EFF(23,"done"),t.k0s()()()()}if(2&o){const n=t.XpG();t.R7$(3),t.JRh(t.bMT(4,6,"ManageContentList.Title")),t.R7$(5),t.vxM(8,n.header()?8:-1),t.R7$(),t.vxM(9,n.items()?9:-1),t.R7$(2),t.Dyx(n.items()),t.R7$(4),t.JRh(t.bMT(16,8,"General.Buttons.Cancel")),t.R7$(3),t.JRh(t.bMT(19,10,"General.Buttons.Save")),t.R7$(2),t.Y8G("tippy",t.bMT(21,12,"Form.Buttons.SaveAndClose"))}}let A=(()=>{class o{#n;#e;#s;constructor(n,e,i){this.dialogRef=n,this.snackBar=e,this.translate=i,this.hostClass="dialog-component",this.#n=(0,h.d)(R.c),this.#e=(0,h.d)(I.y),this.#s=(0,h.d)(O.L),this.items=(0,u.KX)("items",null),this.header=(0,u.KX)("header",null),this.#t=(0,P.C)(this.#n.getParams(["guid","part","index"]),a=>({id:null,guid:a.guid,part:a.part,index:parseInt(a.index,10)})),this.reordered=(0,u.KX)("reordered",!1)}#t;ngOnInit(){this.#i(),this.#o(),this.#a(),this.#n.doOnDialogClosed(()=>{this.#i(!0),this.#o()})}#a(){this.#s.getCurrent$().subscribe(n=>{this.translate.setDefaultLang(n.Context.Language.Primary.split("-")[0]),this.translate.use(n.Context.Language.Current.split("-")[0])})}closeDialog(){this.dialogRef.close()}saveList(){this.snackBar.open("Saving..."),this.#e.saveList(this.#t,this.items()).subscribe(()=>{this.snackBar.open("Saved",null,{duration:2e3}),this.#i(),this.#o()})}saveAndCloseList(){this.snackBar.open("Saving..."),this.#e.saveList(this.#t,this.items()).subscribe(()=>{this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()})}editHeader(){const n={items:[_.c.relationship(this.#t.guid,"listcontent",0,0===this.header().Id),_.c.relationship(this.#t.guid,"listpresentation",0,0===this.header().Id)]},e=(0,p.s)(n);this.#n.navRelative([`edit/${e}`])}editItem(n){const e={items:[_.c.editId(n)]},i=(0,p.s)(e);this.#n.navRelative([`edit/${i}`])}addFromExisting(n){this.#n.navRelative([`${this.#t.guid}/${this.#t.part}/${n+1}/replace`],{queryParams:{add:!0}})}addBelow(n){const e={items:[_.c.relationship(this.#t.guid,this.#t.part,n+1,!0)]},i=(0,p.s)(e);this.#n.navRelative([`edit/${i}`])}remove(n){confirm(this.translate.instant("ManageContentList.ConfirmRemove"))&&(this.snackBar.open("Removing..."),this.#e.removeItem(this.#t,n.Index).subscribe(()=>{this.snackBar.open("Removed",null,{duration:2e3}),this.#i()}))}drop(n){const e=[...this.items()];(0,l.HD)(e,n.previousIndex,n.currentIndex),this.items.set(e),this.reordered.set(!0)}#i(n=!1){this.#e.getList(this.#t).subscribe(e=>{if(this.reordered()){const i=this.items().map(d=>d.Id);if(this.items().length===e.length&&!e.some(d=>!i.includes(d.Id))&&n){const d=this.items().map(C=>C.Index);e.sort((C,G)=>{const E=d.indexOf(C.Index),f=d.indexOf(G.Index);return-1===E||-1===f?0:E-f})}else n&&this.snackBar.open("List was changed from somewhere else. Order of items is reset",null,{duration:5e3})}this.items.set(e),this.reordered.set(!1)})}#o(){this.#e.getHeader(this.#t).subscribe(n=>this.header.set(n))}static#r=this.\u0275fac=function(e){return new(e||o)(t.rXU(c.CP),t.rXU(T.UG),t.rXU(m.c$))};static#d=this.\u0275cmp=t.VBU({type:o,selectors:[["app-manage-content-list"]],hostVars:1,hostBindings:function(e,i){2&e&&t.Mr5("className",i.hostClass)},standalone:!0,features:[t.aNF],decls:1,vars:1,consts:[[1,"eav-dialog","eav-no-scrollbar"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],["cdkScrollable","",1,"dialog-component-content","fancy-scrollbar-light"],[1,"eav-sort-title"],["cdkDropList","",1,"eav-dnd-list",3,"cdkDropListDropped"],["cdkDrag","",1,"eav-dnd-item"],["align","end"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"click"],["mat-raised-button","","color","accent",3,"click","tippy"],[1,"eav-raised-button-icon"],["mat-icon-button","","tippy","Edit header",3,"click"],[1,"eav-dnd-item__title"],["tippy","Drag to reorder the list",1,"eav-dnd-item__title-icon"],[1,"eav-dnd-item__title-text",3,"tippy"],["mat-icon-button","","appMousedownStopPropagation","",3,"click","tippy","disabled"]],template:function(e,i){1&e&&t.DNE(0,U,24,14,"div",0),2&e&&t.vxM(0,i.header()&&i.items()?0:-1)},dependencies:[x.n3,b.uv,g.Hl,g.$z,g.iY,M.m_,M.An,l.O7,l.T1,c.E7,m.h,m.D9,c.hM,L.e,D.z],styles:[".eav-sort-title[_ngcontent-%COMP%]{padding-top:16px}.eav-dnd-list[_ngcontent-%COMP%]{margin:16px 0;border:1px solid #ccc;border-radius:4px;overflow:hidden}.eav-dnd-item[_ngcontent-%COMP%]{cursor:move;height:40px;border-bottom:1px solid #ccc;padding:0 8px;display:flex;align-items:center;justify-content:space-between;background:#fff;box-sizing:border-box;font-size:14px}.eav-dnd-item[_ngcontent-%COMP%]:last-child{border:none}.eav-dnd-item__title[_ngcontent-%COMP%]{display:flex;align-items:center;overflow:hidden;max-width:80%}.eav-dnd-item__title-icon[_ngcontent-%COMP%]{margin-right:8px;opacity:.4}.eav-dnd-item__title-text[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.dnd-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .dnd-item[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}"]})}return o})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/18.01.00/dist/ng-edit/projects_eav-ui_src_app_manage-content-list_manage-content-list_component_ts.a7e31bdb03b3f3fb.js.map