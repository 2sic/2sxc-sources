"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["default-projects_eav-ui_src_app_permissions_permissions_component_ts"],{6663:(M,f,t)=>{t.d(f,{F:()=>l});var g=t(84175),c=t(53777),p=t(81863),d=t(69914),s=t(99293);function v(i,r){if(1&i&&(s.nrm(0,"mat-card-subtitle",1),s.nI1(1,"safeHtml")),2&i){const n=s.XpG();s.Y8G("innerHtml",s.bMT(1,1,n.dialogData.message),s.npT)}}function E(i,r){if(1&i&&s.EFF(0),2&i){const n=s.XpG();s.SpI(" ",n.dialogData.confirmTranslateKey," ")}}function h(i,r){1&i&&s.EFF(0," Delete ")}let l=(()=>{class i{constructor(n,D){this.dialogData=n,this.dialog=D,this.hostClass="dialog-component"}static#t=this.\u0275fac=function(D){return new(D||i)(s.rXU(p.e),s.rXU(p.k))};static#e=this.\u0275cmp=s.VBU({type:i,selectors:[["app-confirm-delete-dialog"]],hostVars:1,hostBindings:function(D,e){2&D&&s.Avn("className",e.hostClass)},decls:12,vars:6,consts:[[2,"margin-bottom","12px"],[3,"innerHtml"],["align","end"],["mat-raised-button","",3,"click"],["mat-raised-button","","cdkFocusInitial","",1,"eav-card-action-button",3,"click","color"]],template:function(D,e){1&D&&(s.j41(0,"mat-card")(1,"mat-card-header",0)(2,"mat-card-title"),s.EFF(3),s.k0s()(),s.j41(4,"mat-card-content"),s.nVh(5,v,2,3,"mat-card-subtitle",1),s.k0s(),s.j41(6,"mat-card-actions",2)(7,"button",3),s.bIt("click",function(){return e.dialog.close()}),s.EFF(8,"Cancel"),s.k0s(),s.j41(9,"button",4),s.bIt("click",function(){return e.dialog.close(!0)}),s.nVh(10,E,1,1)(11,h,1,0),s.k0s()()()),2&D&&(s.R7$(3),s.E5c(" ",e.dialogData.title??"Delete"," ",e.dialogData.entityTitle," (",e.dialogData.entityId,")"),s.R7$(2),s.vxM(e.dialogData.message?5:-1),s.R7$(4),s.Y8G("color",e.dialogData.confirmColor??"warn"),s.R7$(),s.vxM(e.dialogData.confirmTranslateKey?10:11))},dependencies:[c.Hu,c.RN,c.YY,c.m2,c.MM,c.Lc,c.dh,g.Hl,g.$z,d.$],styles:[".eav-card-action-button[_ngcontent-%COMP%]{margin-left:8px}"]})}return i})()},12458:(M,f,t)=>{t.r(f),t.d(f,{PermissionsComponent:()=>K});var g=t(44444),c=t(84175),p=t(81863),d=t(93840),s=t(29658),v=t(12938),E=t(13620),h=t(6663),l=t(11828),i=t(60251),r=t(50052),n=t(43216),D=t(70334),e=t(67037),a=t(60852),C=t(89061),T=t(34601),o=t(99293),y=t(29968);let R=(()=>{class P{agInit(m){this.params=m}refresh(m){return!0}deletePermission(){this.params.onDelete(this.params.data)}static#t=this.\u0275fac=function(u){return new(u||P)};static#e=this.\u0275cmp=o.VBU({type:P,selectors:[["app-permissions-actions"]],decls:4,vars:0,consts:[[1,"actions-component"],["matRipple","","tippy","Delete",1,"eav-grid-action-button","highlight",3,"click"]],template:function(u,_){1&u&&(o.j41(0,"div",0)(1,"div",1),o.bIt("click",function(){return _.deletePermission()}),o.j41(2,"mat-icon"),o.EFF(3,"delete"),o.k0s()()())},dependencies:[C.M,y.M,d.m_,d.An,T.e],encapsulation:2})}return P})();var U=t(44900),B=t(3347),A=t(88622),W=t(29841);let K=(()=>{class P{#t;#e;#s;#a;#i;constructor(m,u,_,O){this.dialog=m,this.snackBar=u,this.viewContainerRef=_,this.matDialog=O,this.gridOptions=this.buildGridOptions(),this.#t=(0,v.d)(U.K),this.#e=(0,v.d)(a.c),this.#s=(0,E.C)(this.#e.getParams(["targetType","keyType","key"]),I=>({targetType:parseInt(I.targetType,10),keyType:I.keyType,key:I.key})),this.#a=(0,g.vPA)(0),this.permissions=this.#t.getAllLive(this.#s.targetType,this.#s.keyType,this.#s.key,this.#a),this.#i={[r.YX.metadata.language.targetType]:{PermissionType:"language"}}}ngOnInit(){this.#e.doOnDialogClosed(()=>this.#a.update(m=>m+1))}closeDialog(){this.dialog.close()}editPermission(m){let u;u=null==m?{items:[{...D.c.newMetadataFromInfo(r.YX.contentTypes.permissions,D.c.constructMetadataInfo(this.#s.targetType,this.#s.keyType,this.#s.key)),...this.#i[this.#s.targetType]&&{Prefill:this.#i[this.#s.targetType]}}]}:{items:[D.c.editId(m.Id)]};const _=(0,n.s)(u);this.#e.navRelative([`edit/${_}`])}#n(m){this.snackBar.open("Deleting..."),this.matDialog.open(h.F,{autoFocus:!1,data:{entityId:m.Id,entityTitle:m.Title,message:"Delete this permission?"},viewContainerRef:this.viewContainerRef,width:"400px"}).afterClosed().subscribe(O=>{this.snackBar.dismiss(),O&&this.#t.delete(m.Id).subscribe(()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.#a.update(I=>I+1)})})}buildGridOptions(){return{...i.C,columnDefs:[{...l.r.Id,cellRendererParams:l.r.idFieldParamsTooltipGetter()},{...l.r.TextWide,headerName:"Name",field:"Title",sort:"asc",onCellClicked:u=>{this.editPermission(u.data)}},{...l.r.TextWide,field:"Identity"},{...l.r.TextWide,field:"Condition"},{...l.r.Character,field:"Grant"},{...l.r.ActionsPinnedRight1,cellRenderer:R,cellRendererParams:{onDelete:_=>this.#n(_)}}]}}static#o=this.\u0275fac=function(u){return new(u||P)(o.rXU(p.k),o.rXU(B.UG),o.rXU(o.c1b),o.rXU(p.h))};static#r=this.\u0275cmp=o.VBU({type:P,selectors:[["app-permissions"]],decls:15,vars:2,consts:[[1,"eav-dialog","nav-component-wrapper"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"eav-dialog-content","nav-component-wrapper"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","gridOptions"],["align","end"],["mat-fab","","mat-elevation-z24","","tippy","Create a new permission",1,"grid-fab",3,"click"]],template:function(u,_){1&u&&(o.j41(0,"div",0)(1,"div",1)(2,"div",2),o.EFF(3,"Permissions"),o.k0s(),o.j41(4,"button",3),o.bIt("click",function(){return _.closeDialog()}),o.j41(5,"mat-icon"),o.EFF(6,"close"),o.k0s()()(),o.j41(7,"div",4),o.nrm(8,"router-outlet"),o.j41(9,"div",5),o.nrm(10,"ag-grid-angular",6),o.k0s(),o.j41(11,"mat-dialog-actions",7)(12,"button",8),o.bIt("click",function(){return _.editPermission(null)}),o.j41(13,"mat-icon"),o.EFF(14,"add"),o.k0s()()()()()),2&u&&(o.R7$(10),o.Y8G("rowData",_.permissions())("gridOptions",_.gridOptions))},dependencies:[c.Hl,A.M,c.Sr,d.m_,d.An,s.n3,p.M,e.p,W.xs],encapsulation:2})}return P})()},13620:(M,f,t)=>{function g(p,d){return d(p)}function c(p,d){return d(p)}t.d(f,{C:()=>g,z:()=>c})},44900:(M,f,t)=>{t.d(f,{K:()=>h});var g=t(64173),c=t(70271),p=t(12938),d=t(50052),s=t(96817),v=t(80401),E=t(44444);let h=(()=>{class l{constructor(){this.metadataService=(0,p.d)(v.T),this.entitiesService=(0,p.d)(s.R)}getAll(r,n,D){return this.metadataService.getMetadata(r,n,D,d.YX.contentTypes.permissions).pipe((0,c.T)(e=>e.Items))}getAllLive(r,n,D,e){const a=this.metadataService.getMetadataLive(e,r,n,D,d.YX.contentTypes.permissions).value;return(0,g.EW)(()=>a()?.Items??[])}delete(r){return this.entitiesService.delete(d.YX.contentTypes.permissions,r,!1)}static#t=this.\u0275fac=function(n){return new(n||l)};static#e=this.\u0275prov=E.jDH({token:l,factory:l.\u0275fac})}return l})()},60852:(M,f,t)=>{t.d(f,{c:()=>r});var g=t(29658),c=t(51567),p=t(63037),d=t(70271),s=t(5057),v=t(98764),E=t(34435),h=t(4979),l=t(44444);const i={doOnDialogClosed:!0};let r=(()=>{class n extends h.V{constructor(e,a){super(),this.router=e,this.route=a,this.log=(0,E.Tq)({DialogRoutingService:n},i)}get snapshot(){return this.route.snapshot}get url(){return this.router.url}get urlSegments(){return this.router.url.split("/")}getParam(e){return this.route.snapshot.paramMap.get(e)}getParams(e){const a=this.route.snapshot.paramMap;return e.reduce((C,T)=>(C[T]=a.get(T),C),{})}getQueryParam(e){return this.route.snapshot.queryParamMap.get(e)}getQueryParams(e){const a=this.route.snapshot.queryParamMap;return e.reduce((C,T)=>(C[T]=a.get(T),C),{})}state(){return this.router.getCurrentNavigation().extras?.state}doOnDialogClosed(e){const a=this.log.fnIf("doOnDialogClosed");this.subscriptions.add(this.childDialogClosed$().subscribe(C=>(a.a("Dialog closed",{data:C}),e()))),a.end()}doOnDialogClosedWithData(e){const a=this.log.fnIf("doOnDialogClosed");this.subscriptions.add(this.#t().subscribe(({state:C})=>{a.a("Dialog closed",{state:C}),e(C)})),a.end()}urlSubRoute(e){const a=this.router.createUrlTree([e],{relativeTo:this.route});return this.router.serializeUrl(a)}navPath(e,a){return this.router.navigate([e],a)}navRelative(e,a){return this.router.navigate(e,{...a,relativeTo:this.route})}childDialogClosed$(){return this.router.events.pipe((0,c.p)(e=>e instanceof g.wF),(0,p.Z)(!!this.route.snapshot.firstChild),(0,d.T)(()=>!!this.route.snapshot.firstChild),(0,s.J)(),(0,c.p)(([e,a])=>e&&!a))}#t(){return this.router.events.pipe((0,c.p)(e=>e instanceof g.wF),(0,v.M)(e=>{const a=this.log.fn("childDialogClosed$",{event:e,firstChild:this.route.snapshot.firstChild,snapShot:this.route.snapshot,state:this.router.getCurrentNavigation()?.extras.state});a.a("NavigationEnd",{event:e}),a.end()}),(0,p.Z)(!!this.route.snapshot.firstChild),(0,d.T)(()=>({hasChildNow:!!this.route.snapshot.firstChild,state:this.router.getCurrentNavigation()?.extras.state})),(0,s.J)(),(0,c.p)(([e,a])=>e.hasChildNow&&!a.hasChildNow),(0,d.T)(([e,a])=>({hadChildBefore:e.hasChildNow,hasChildNow:a.hasChildNow,state:a.state})))}static#e=this.\u0275fac=function(a){return new(a||n)(l.KVO(g.Ix),l.KVO(g.nX))};static#s=this.\u0275prov=l.jDH({token:n,factory:n.\u0275fac})}return n})()},80401:(M,f,t)=>{t.d(f,{T:()=>s});var g=t(96474),c=t(99293),p=t(44444);const d="admin/metadata/get";let s=(()=>{class v extends g.D{getMetadata(h,l,i,r){return this.getHttpApiUrl(d,{params:{appId:this.appId,targetType:h.toString(),keyType:l,key:i.toString(),...r&&{contentType:r}}})}getMetadataLive(h,l,i,r,n){return this.newHttpResource(()=>(h(),{url:this.apiUrl(d),params:{appId:this.appId,targetType:l.toString(),keyType:i,key:r.toString(),...n&&{contentType:n}}}))}getMetadataPromise(h,l,i,r){return this.fetchPromise(d,{params:{appId:this.appId,targetType:h.toString(),keyType:l,key:i.toString(),...r&&{contentType:r}}})}static#t=this.\u0275fac=(()=>{let h;return function(i){return(h||(h=c.xGo(v)))(i||v)}})();static#e=this.\u0275prov=p.jDH({token:v,factory:v.\u0275fac})}return v})()},96817:(M,f,t)=>{t.d(f,{R:()=>E});var g=t(47215),c=t(85837),p=t(9234),d=t(24467),s=t(99293),v=t(44444);let E=(()=>{class h extends d.B{create(i,r){return this.http.post(`app/auto/data/${i}`,r,{params:{appId:this.appId,zoneId:this.zoneId}})}update(i,r,n){return this.http.post(`app/auto/data/${i}/${r}`,n,{params:{appId:this.appId,zoneId:this.zoneId}})}delete(i,r,n){return this.http.delete(this.apiUrl(p.gb+"delete"),{params:{contentType:i,id:r.toString(),appId:this.appId,force:n.toString()},context:(new g._y).set(c.g,[400])})}static#t=this.\u0275fac=(()=>{let i;return function(n){return(i||(i=s.xGo(h)))(n||h)}})();static#e=this.\u0275prov=v.jDH({token:h,factory:h.\u0275fac})}return h})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/20.00.04/dist/ng-edit/default-projects_eav-ui_src_app_permissions_permissions_component_ts.f0ddf5948109a960.js.map