"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_content-export_content-export_component_ts-projects_eav-ui_src_app_sh-5eade4"],{2743:(b,D,e)=>{e.d(D,{b:()=>p});var r=e(8873),M=e(5506),u=e(6163),v=e(7580);let p=(()=>{class i{constructor(n,s){this.contextSvcShared=n,this.context=s,this.log=new M.B("DialogConfigService",!1)}getCurrent$(){const n=this.context.appId;return this.log.a(`getCurrent$ - appId:${n}`),this.contextSvcShared.getShared$(n)}static#t=this.\u0275fac=function(s){return new(s||i)(v.KVO(u.t),v.KVO(r.o))};static#e=this.\u0275prov=v.jDH({token:i,factory:i.\u0275fac})}return i})()},7693:(b,D,e)=>{e.d(D,{X:()=>m,g:()=>C});var r=e(271),M=e(8873),u=e(7580),v=e(6443),O=e(4821);const m="admin/type/",o="admin/type/scopes";let C=(()=>{class t{constructor(a,d,P){this.http=a,this.context=d,this.dnnContext=P}apiUrl(a){return this.dnnContext.$2sxc.http.apiUrl(a)}retrieveContentType(a){return this.http.get(this.apiUrl("admin/type/get"),{params:{appId:this.context.appId.toString(),contentTypeId:a}})}retrieveContentTypes(a){return this.http.get(this.apiUrl("admin/type/list"),{params:{appId:this.context.appId.toString(),scope:a}})}getScopes(){return this.http.get(this.apiUrl(o),{params:{appId:this.context.appId.toString()}}).pipe((0,r.T)(a=>{const d=a.old;return Object.keys(d).map(x=>({name:d[x],value:x}))}))}getScopesV2(){return this.http.get(this.apiUrl(o),{params:{appId:this.context.appId.toString()}}).pipe((0,r.T)(a=>a.scopes))}save(a){return this.http.post(this.apiUrl("admin/type/save"),a,{params:{appid:this.context.appId.toString()}})}delete(a){return this.http.delete(this.apiUrl("admin/type/delete"),{params:{appid:this.context.appId.toString(),staticName:a.StaticName}})}import(a){const d=new FormData;for(const P of a)d.append("File",P);return this.http.post(this.apiUrl("admin/type/import"),d,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}createGhost(a){return this.http.post(this.apiUrl("admin/type/addghost"),null,{params:{appid:this.context.appId.toString(),sourceStaticName:a}})}static#t=this.\u0275fac=function(d){return new(d||t)(u.KVO(v.Qq),u.KVO(M.o),u.KVO(O.ob))};static#e=this.\u0275prov=u.jDH({token:t,factory:t.\u0275fac})}return t})()},6163:(b,D,e)=>{e.d(D,{t:()=>l});var r=e(6301),M=e(271),u=e(8764),v=e(8873),O=e(5506),m=e(9431),p=e(7580),i=e(6443);let l=(()=>{class _{constructor(t,I,a){this.http=t,this.context=I,this.globalConfigService=a,this.log=new O.B("GlobalDialogConfigService",!1),this.dialogSettings$={},this.log.a(`using context #${this.context.log.svcId}`)}getShared$(t){return this.log.a("getShared$ appId: "+t),this.dialogSettings$[t]??=this.getDialogSettings(t,"getShared$").pipe((0,r.t)({refCount:!1})),this.dialogSettings$[t]}getDialogSettings(t,I){return this.log.a("getDialogSettings",{appId:t,reqBy:I}),this.http.get("admin/dialog/settings",{params:{appId:t??this.context.appId.toString()}}).pipe((0,M.T)(a=>(a.Context.Language.List=a.Context.Language.List.filter(d=>d.IsEnabled),a)),(0,u.M)(a=>{this.globalConfigService.allowDebug(a.Context.Enable.DebugMode)}))}static#t=this.\u0275fac=function(I){return new(I||_)(p.KVO(i.Qq),p.KVO(v.o),p.KVO(m.B))};static#e=this.\u0275prov=p.jDH({token:_,factory:_.\u0275fac,providedIn:"root"})}return _})()},5727:(b,D,e)=>{e.r(D),e.d(D,{ContentExportComponent:()=>x});var r=e(7941),M=e(5797),u=e(1873),v=e(7693),O=e(6360),m=e(316),p=e(4175),i=e(3804),o=e(5060),n=e(5175),s=e(5944),l=e(4456),_=e(5437),C=e(2743),t=e(7580),I=e(2159);function a(f,T){if(1&f&&(t.j41(0,"mat-option",10),t.EFF(1),t.k0s()),2&f){const h=T.$implicit;t.Y8G("value",h.NameId),t.R7$(),t.JRh(h.NameId)}}function d(f,T){if(1&f&&(t.j41(0,"mat-radio-button",15),t.EFF(1),t.k0s()),2&f){const h=t.XpG(2);t.R7$(),t.SpI(" Export selected ",h.itemIds.length," items ")}}function P(f,T){if(1&f){const h=t.RV6();t.j41(0,"form",null,0)(2,"div",4)(3,"p"),t.EFF(4," This will generate an XML file which you can edit in Excel. If you just want to import new data, use this to export the schema that you can then fill in using Excel. Please visit "),t.j41(5,"a",5),t.EFF(6,"https://2sxc.org/help"),t.k0s(),t.EFF(7," for more instructions. "),t.k0s(),t.j41(8,"div",6)(9,"div")(10,"mat-form-field",7)(11,"mat-label"),t.EFF(12,"Languages"),t.k0s(),t.j41(13,"mat-select",8),t.mxI("ngModelChange",function(c){t.eBV(h);const E=t.XpG();return t.DH7(E.formValues.language,c)||(E.formValues.language=c),t.Njj(c)}),t.j41(14,"mat-option",9),t.EFF(15,"All"),t.k0s(),t.Z7z(16,a,2,2,"mat-option",10,t.fX1),t.k0s()()(),t.j41(18,"div")(19,"p",11),t.EFF(20,"Export data"),t.k0s(),t.j41(21,"mat-radio-group",12),t.mxI("ngModelChange",function(c){t.eBV(h);const E=t.XpG();return t.DH7(E.formValues.recordExport,c)||(E.formValues.recordExport=c),t.Njj(c)}),t.j41(22,"mat-radio-button",13),t.EFF(23,"No, just export blank data schema (for new data import) "),t.k0s(),t.j41(24,"mat-radio-button",14),t.EFF(25,"Yes, export all content-items"),t.k0s(),t.DNE(26,d,2,1,"mat-radio-button",15),t.k0s()(),t.j41(27,"div")(28,"p",11),t.EFF(29,"Value references to other languages"),t.k0s(),t.j41(30,"mat-radio-group",16),t.mxI("ngModelChange",function(c){t.eBV(h);const E=t.XpG();return t.DH7(E.formValues.languageReferences,c)||(E.formValues.languageReferences=c),t.Njj(c)}),t.j41(31,"mat-radio-button",17),t.EFF(32,"Keep references to other languages (for re-import) "),t.k0s(),t.j41(33,"mat-radio-button",18),t.EFF(34,"Replace references with values"),t.k0s()()(),t.j41(35,"div")(36,"p",11),t.EFF(37,"File / page references"),t.k0s(),t.j41(38,"mat-radio-group",19),t.mxI("ngModelChange",function(c){t.eBV(h);const E=t.XpG();return t.DH7(E.formValues.resourcesReferences,c)||(E.formValues.resourcesReferences=c),t.Njj(c)}),t.j41(39,"mat-radio-button",17),t.EFF(40,"Keep references (for re-import, for example Page:4711) "),t.k0s(),t.j41(41,"mat-radio-button",18),t.EFF(42,"Replace references with real URLs (for example /Portals/0...) "),t.k0s()()()()(),t.j41(43,"mat-dialog-actions",20)(44,"button",21),t.bIt("click",function(){t.eBV(h);const c=t.XpG();return t.Njj(c.closeDialog())}),t.EFF(45,"Cancel"),t.k0s(),t.j41(46,"button",22),t.bIt("click",function(){t.eBV(h);const c=t.XpG();return t.Njj(c.exportContent())}),t.EFF(47," Export Data "),t.k0s()()()}if(2&f){const h=t.sdS(1),g=t.XpG();t.R7$(13),t.R50("ngModel",g.formValues.language),t.R7$(3),t.Dyx(g.languages),t.R7$(5),t.R50("ngModel",g.formValues.recordExport),t.R7$(5),t.vxM(26,g.hasIdList?26:-1),t.R7$(4),t.R50("ngModel",g.formValues.languageReferences),t.Y8G("disabled","Blank"===g.formValues.recordExport),t.R7$(8),t.R50("ngModel",g.formValues.resourcesReferences),t.Y8G("disabled","Blank"===g.formValues.recordExport),t.R7$(8),t.Y8G("disabled",!h.form.valid)}}let x=(()=>{class f{constructor(h,g){this.dialogRef=h,this.route=g,this.hostClass="dialog-component",this.contentExportService=(0,_.d)(O.D),this.contentTypesService=(0,_.d)(v.g),this.dialogConfigSvc=(0,_.d)(C.b),this.hasIdList=!1,this.loading$=new M.t(!1),this.contentType$=new M.t(null),this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName");const c=this.route.snapshot.paramMap.get("selectedIds");this.hasIdList=!!c,this.hasIdList&&(this.itemIds=c.split(",").map(E=>parseInt(E,10)))}ngOnInit(){this.loading$.next(!0);const h=this.contentTypesService.retrieveContentType(this.contentTypeStaticName),g=this.dialogConfigSvc.getCurrent$();(0,u.p)([h,g]).subscribe(([c,E])=>{this.contentType$.next(c),this.languages=E.Context.Language.List,this.formValues={defaultLanguage:E.Context.Language.Primary,contentTypeStaticName:this.contentTypeStaticName,language:"",recordExport:this.hasIdList?"Selection":"All",languageReferences:"Link",resourcesReferences:"Link"},this.loading$.next(!1)})}ngOnDestroy(){this.contentType$.complete(),this.loading$.complete()}closeDialog(){this.dialogRef.close()}exportContent(){this.contentExportService.exportContent(this.formValues,this.hasIdList&&"Selection"===this.formValues.recordExport?this.itemIds:null)}static#t=this.\u0275fac=function(g){return new(g||f)(t.rXU(r.CP),t.rXU(I.nX))};static#e=this.\u0275cmp=t.VBU({type:f,selectors:[["app-content-export"]],hostVars:1,hostBindings:function(g,c){2&g&&t.Mr5("className",c.hostClass)},standalone:!0,features:[t.aNF],decls:7,vars:6,consts:[["ngForm","ngForm"],[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],["href","https://2sxc.org/help","target","_blank"],[1,"dialog-form-content","fancy-scrollbar-light"],["color","accent",1,"eav-mat-form-field"],["name","Language",3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"eav-radio-group-label"],["name","RecordExport",1,"eav-radio-group",3,"ngModelChange","ngModel"],["value","Blank"],["value","All"],["value","Selection"],["name","LanguageReferences",1,"eav-radio-group",3,"ngModelChange","ngModel","disabled"],["value","Link"],["value","Resolve"],["name","ResourcesReferences",1,"eav-radio-group",3,"ngModelChange","ngModel","disabled"],["align","end"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"click","disabled"]],template:function(g,c){if(1&g&&(t.j41(0,"div",1)(1,"div",2)(2,"div",3),t.EFF(3),t.nI1(4,"async"),t.k0s()(),t.DNE(5,P,48,8,"form"),t.nI1(6,"async"),t.k0s()),2&g){let E;t.R7$(3),t.SpI("Export ",null==(E=t.bMT(4,2,c.contentType$))?null:E.Name,""),t.R7$(2),t.vxM(5,!1===t.bMT(6,4,c.loading$)?5:-1)}},dependencies:[l.YN,l.qT,l.BC,l.cb,l.vS,l.cV,s.RG,s.rl,s.nJ,n.Ve,n.VO,o.wT,o.Sy,i.Wk,i.VT,i._g,r.E7,p.Hl,p.$z,m.Jj],styles:[".eav-radio-group-label[_ngcontent-%COMP%]{font-size:18px;margin:24px 0 0}.eav-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:8px 0}"]})}return f})()},9234:(b,D,e)=>{e.d(D,{Gg:()=>_,Tr:()=>C,gb:()=>l});var r=e(1567),M=e(6647),u=e(6301),v=e(271),O=e(5506),m=e(4839),p=e(5437),i=e(7580),o=e(6443),n=e(4821);const s={enabled:!1,name:"EntityService",specs:{all:!1,getEntities:!1,getAvailableEntities:!1,delete:!1}},l="admin/entity/",_="admin/entity/list";let C=(()=>{class t{constructor(a,d){this.http=a,this.dnnContext=d,this.queryService=(0,p.d)(m.c),this.log=new O.B(s)}getEntities$(a){return this.log.fnIf("getEntities"),a.pipe((0,r.p)(d=>null!=d),(0,M.n)(d=>this.getAvailableEntities(d.contentTypeName).pipe((0,u.t)(1))))}getAvailableEntities(a,d){return this.log.fnIf("getAvailableEntities"),this.queryService.getEntities({contentTypes:[a],itemIds:d,fields:"Id,Guid,Title",log:"getAvailableEntities"}).pipe((0,v.T)(x=>x.Default))}delete(a,d,P,x,f,T){return this.log.fnIf("delete",{appId:a,contentType:d,entityId:P,force:x,parentId:f,parent}),this.http.delete(this.dnnContext.$2sxc.http.apiUrl(l+"delete"),{params:{contentType:d,id:P.toString(),appId:a,force:x.toString(),...f&&{parentId:f.toString()},...f&&T&&{parentField:T}}})}static#t=this.\u0275fac=function(d){return new(d||t)(i.KVO(o.Qq),i.KVO(n.ob))};static#e=this.\u0275prov=i.jDH({token:t,factory:t.\u0275fac})}return t})()},9431:(b,D,e)=>{e.d(D,{B:()=>O});var r=e(7580),M=e(9074),u=e(8172),v=e(3347);let O=(()=>{class m{constructor(i){this.snackBar=i,this.debugState=(0,r.vPA)(null),this.isDebug=(0,r.EWP)(()=>!!this.debugState()?.allowDebugMode&&!!this.debugState()?.debugEnabled),this.debugEnabled$=(0,M.br)(this.isDebug);const o={id:0,debugEnabled:"true"===sessionStorage.getItem(u.tn),allowDebugMode:!1};this.debugState.set(o)}allowDebug(i){const o=this.debugState();if(o.allowDebugMode===i)return;const n={...o,allowDebugMode:i};this.debugState.set(n)}toggleDebugEnabled(){const i=this.debugState();if(!i.allowDebugMode)return void this.snackBar.open("You do not have permissions to enter developer mode",null,{duration:3e3});const o={...i,debugEnabled:!i.debugEnabled};this.debugState.set(o),this.snackBar.open(o.debugEnabled?"developer mode on":"developer mode off",null,{duration:3e3})}static#t=this.\u0275fac=function(o){return new(o||m)(r.KVO(v.UG))};static#e=this.\u0275prov=r.jDH({token:m,factory:m.\u0275fac,providedIn:"root"})}return m})()},4839:(b,D,e)=>{e.d(D,{c:()=>m});var r=e(5506),M=e(8873),u=e(7580),v=e(6443);const O={enabled:!1,name:"QueryService",specs:{all:!1,getAvailableEntities:!1,getEntities:!1}};let m=(()=>{class p{constructor(o,n){this.http=o,this.context=n,this.log=new r.B(O)}getAvailableEntities(o,n,s,l){this.log.fnIf("getAvailableEntities",{queryUrl:o,params:n,fields:s,entitiesFilter:l});const _=!!n,a=(((n?.toLocaleLowerCase()??"").includes("appid=")?"":`&appId=${this.context.appId}`)+(_?`&${n}`:"")+"&$select="+(s??"")).substring(1);return this.http.post(`app/auto/query/${o}?${a}`,{Guids:l})}getEntities({contentTypes:o,itemIds:n,fields:s,log:l}){this.log.fnIf("getEntities",{log:l,contentTypes:o,itemIds:n,fields:s});const C=("&typeNames="+(o?.join(",")??"")+`&appId=${this.context.appId}&itemIds=`+(n?.join(",")??"")+"&$select="+(s??"")).substring(1);return this.http.post(`app/auto/query/System.EntityPicker/Default?${C}`,{})}static#t=this.\u0275fac=function(n){return new(n||p)(u.KVO(v.Qq),u.KVO(M.o))};static#e=this.\u0275prov=u.jDH({token:p,factory:p.\u0275fac})}return p})()},9074:(b,D,e)=>{e.d(D,{br:()=>p,ot:()=>i});var r=e(7580),M=e(6042);function p(o,n){!n?.injector&&(0,r.Af3)(p);const s=n?.injector??(0,r.WQX)(r.zZn),l=new M.m(1),_=(0,r.QZP)(()=>{let C;try{C=o()}catch(t){return void(0,r.O8t)(()=>l.error(t))}(0,r.O8t)(()=>l.next(C))},{injector:s,manualCleanup:!0});return s.get(r.abz).onDestroy(()=>{_.destroy(),l.complete()}),l.asObservable()}function i(o,n){const s=!n?.manualCleanup;s&&!n?.injector&&(0,r.Af3)(i);const l=s?n?.injector?.get(r.abz)??(0,r.WQX)(r.abz):null;let _;_=(0,r.vPA)(n?.requireSync?{kind:0}:{kind:1,value:n?.initialValue});const C=o.subscribe({next:t=>_.set({kind:1,value:t}),error:t=>{if(n?.rejectErrors)throw t;_.set({kind:2,error:t})}});return l?.onDestroy(C.unsubscribe.bind(C)),(0,r.EWP)(()=>{const t=_();switch(t.kind){case 1:return t.value;case 2:throw t.error;case 0:throw new r.wOt(601,"`toSignal()` called with `requireSync` but `Observable` did not emit synchronously.")}})}}}]);
//# sourceMappingURL=https://sources.2sxc.org/18.00.02/dist/ng-edit/projects_eav-ui_src_app_content-export_content-export_component_ts-projects_eav-ui_src_app_sh-5eade4.30b91d0fef25e6ff.js.map