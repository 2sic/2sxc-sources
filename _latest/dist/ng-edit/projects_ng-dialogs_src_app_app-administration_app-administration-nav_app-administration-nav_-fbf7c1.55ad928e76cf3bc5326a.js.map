{"version":3,"sources":["./projects/ng-dialogs/src/app/shared/models/dialog-context.models.ts","./projects/ng-dialogs/src/app/app-administration/getting-started/getting-started.component.ts","./projects/ng-dialogs/src/app/app-administration/getting-started/getting-started.component.html","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/data-actions/data-actions.component.html","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/data-actions/data-actions.component.ts","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/data-fields/data-fields.component.html","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/data-fields/data-fields.component.ts","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/data-items/data-items.component.ts","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/data-items/data-items.component.html","./projects/ng-dialogs/src/app/app-administration/sub-dialogs/metadata/metadata-save-dialog.component.html","./projects/ng-dialogs/src/app/app-administration/sub-dialogs/metadata/metadata-save-dialog.component.ts","./projects/ng-dialogs/src/app/app-administration/data/data.component.html","./projects/ng-dialogs/src/app/app-administration/data/data.component.ts","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/queries-actions/queries-actions.ts","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/queries-actions/queries-actions.component.html","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/queries-actions/queries-actions.component.ts","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/ag-actions/ag-actions-component.ts","./projects/ng-dialogs/src/app/app-administration/queries/queries.component.ts","./projects/ng-dialogs/src/app/app-administration/queries/queries.component.html","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/views-actions/views-actions.component.html","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/views-actions/views-actions.component.ts","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/views-show/views-show.component.html","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/views-show/views-show.component.ts","./projects/ng-dialogs/src/app/app-administration/views/views.helpers.ts","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/views-type/views-type.component.ts","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/views-type/views-type.component.html","./projects/ng-dialogs/src/app/app-administration/views/views.component.ts","./projects/ng-dialogs/src/app/app-administration/views/polymorph-logo.png","./projects/ng-dialogs/src/app/app-administration/views/views.component.html","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/web-api-actions/web-api-actions.component.html","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/web-api-actions/web-api-actions.component.ts","./projects/ng-dialogs/src/app/app-administration/web-api/web-api.component.ts","./projects/ng-dialogs/src/app/app-administration/web-api/web-api.component.html","./projects/ng-dialogs/src/app/app-administration/sub-dialogs/analyze-settings/analyze-settings.models.ts","./projects/ng-dialogs/src/app/app-administration/app-configuration/app-configuration.component.html","./projects/ng-dialogs/src/app/app-administration/app-configuration/app-configuration.component.ts","./projects/ng-dialogs/src/app/app-administration/app-administration-nav/app-administration-nav.component.html","./projects/ng-dialogs/src/app/app-administration/app-administration-nav/app-administration-nav.component.ts","./projects/ng-dialogs/src/app/shared/constants/file-names.constants.ts","./projects/ng-dialogs/src/app/shared/constants/guid.constants.ts","./projects/ng-dialogs/src/app/shared/directives/click-stop-propagation.directive.ts","./projects/ng-dialogs/src/app/shared/directives/toggle-debug.directive.ts"],"names":["AppScopes","App","Site","Global","ngOnInit","GettingStartedComponent","agInit","params","this","contentType","data","enablePermissions","enablePermissionsGetter","test","StaticName","refresh","createOrEditMetadata","onCreateOrEditMetadata","openPermissions","onOpenPermissions","editContentType","onEdit","addMetadata","onAddMetadata","openRestApi","onOpenRestApi","exportType","onTypeExport","openDataExport","onOpenDataExport","openDataImport","onOpenDataImport","deleteContentType","onDelete","DataActionsComponent","value","DataFieldsComponent","DataItemsComponent","dialogData","dialogRef","contentTypesService","hostClass","initialScope","scope","disableAnimation$","BehaviorSubject","scopeOptions$","lockScope$","contentTypes$","subscription","Subscription","form","contentTypeControl","controls","scopeControl","add","subscribe","lockScope","patchValue","disabled","disable","enable","valueChanges","newScope","prompt","scope$","pipe","startWith","filter","distinctUntilChanged","combineLatest","getScopes","scopeOptions","selectedScope","newScopes","forEach","scopeOption","some","push","name","next","length","retrieveContentTypes","contentTypes","templateVars$","map","disableAnimation","formValues","ngAfterViewInit","setTimeout","ngOnDestroy","complete","unsubscribe","closeDialog","saveToContentTypeName","close","unlockScope","confirm","MetadataSaveDialogComponent","router","route","globalConfigService","snackBar","contentExportService","dialog","viewContainerRef","changeDetectorRef","debugEnabled$","getDebugEnabled$","modules","gridOptions","frameworkComponents","idFieldComponent","dataItemsComponent","dataFieldsComponent","dataActionsComponent","columnDefs","headerName","field","width","headerClass","cellClass","cellRenderer","sortable","cellRendererParams","tooltipGetter","paramsData","Id","flex","minWidth","sort","onCellClicked","showContentItems","bind","comparator","valueA","valueB","nodeA","nodeB","isInverted","_compareLabel","localeCompare","addItem","editFields","nameCellClassGetter","event","pinned","defaultScope","fetchScopes","refreshScopeOnRouteChange","refreshOnChildClosed","filesDropped","files","importFile","substring","lastIndexOf","toLocaleLowerCase","from","take","fileString","contentTypeName","split","find","ct","Name","open","duration","importType","navigate","relativeTo","firstChild","state","UsesSharedDef","fetchContentTypes","Label","replace","existing","createGhost","sourceName","window","res","changeScope","formUrl","items","ContentTypeName","Properties","EntityId","For","Target","String","Prefill","Description","autoFocus","afterClosed","markForCheck","exportJson","delete","result","events","snapshot","paramMap","get","option","includes","newScopeOption","pairwise","DataComponent","QueryActions","actions","getEnablePermissions","QueriesActionsComponent","item","pipelinesService","dialogService","queries$","queriesActionsComponent","Guid","openVisualQueryDesigner","do","doMenuAction","fetchQueries","getAll","queries","importQuery","action","query","Edit","editQuery","Rest","Clone","cloneQuery","Permissions","Export","exportQuery","Delete","deleteQuery","TestParameters","openQueryDesigner","clonePipeline","exportEntity","QueriesComponent","view","enableCode","enableCodeGetter","openCode","onOpenCode","cloneView","onClone","exportView","onExport","deleteView","ViewsActionsComponent","ViewsShowComponent","calculateViewType","icon","HasQuery","List","ContentType","type","ViewsTypeComponent","viewsService","views$","polymorphStatus$","polymorphLogo","booleanFilterComponent","viewsTypeComponent","viewsShowComponent","viewsActionsComponent","valueGetter","showValueGetter","editView","typeValueGetter","openUsage","contentDemoValueGetter","presentationDemoValueGetter","headerDemoValueGetter","headerPresDemoValueGetter","fetchTemplates","fetchPolymorphism","importView","views","getPolymorphism","polymorphism","Resolver","editPolymorphisms","TypeName","IsHidden","DemoId","DemoTitle","PresentationType","ListContentType","ListPresentationType","openCodeFile","TemplatePath","IsShared","DuplicateEntity","export","ViewsComponent","WebApiActionsComponent","webApisService","webApis$","webApiActions","fetchWebApis","addController","nameLower","extIndex","typeIndex","charAt","toLocaleUpperCase","create","webApis","api","path","WebApiComponent","AnalyzeParts","Settings","Resources","contentItemsService","context","exportAppService","importAppPartsService","eavConstants","SystemSettingsScopes","fetchSystemSettings","dismiss","edit","staticName","systemSettingsScope","contentItems","settingsEntity","i","SettingsEntityScope","Error","openSiteSettings","siteDefaultApp","dialogSettings","Context","DefaultApp","openAppAdministration","ZoneId","AppId","openGlobalSettings","globalDefaultApp","System","config","appId","exportApp","exportParts","importParts","exportAppXml","exportForVersionControl","error","resetApp","analyze","part","forkJoin","systemSettingsItems","systemResourcesItems","appSystemSettingsExists","siteSystemSettingsExists","appSystemResourcesExists","siteSystemResourcesExists","AppConfigurationComponent","appDialogConfigService","dialogSettings$","tabs$","tabIndex$","url","tabs","indexOf","tabIndex","fetchDialogSettings","changeTab","index","getDialogSettings","Enable","Query","tab","AppAdministrationNavComponent","defaultControllerName","defaultTemplateName","defaultTokenName","guidRegex","onClick","stopPropagation","ClickStopPropagationDirective","navigator","platform","match","metaKey","ctrlKey","shiftKey","altKey","toggleDebugEnabled","getSelection","removeAllRanges","ToggleDebugDirective"],"mappings":"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","file":"projects_ng-dialogs_src_app_app-administration_app-administration-nav_app-administration-nav_-fbf7c1.55ad928e76cf3bc5326a.js","sourcesContent":["import { PermissionsCount } from '../../app-administration/models/permissions-count.model';\r\n\r\nexport interface DialogContextApp {\r\n  GettingStartedUrl: string;\r\n  Id: number;\r\n  Identifier: unknown;\r\n  Name: string;\r\n  Folder: string;\r\n  Permissions: PermissionsCount;\r\n  Url: string;\r\n  /** New in v12 - the root for app APIs and content/query */\r\n  Api: string;\r\n  SettingsScope: AppScope;\r\n}\r\n\r\nexport const AppScopes = {\r\n  App: 'App',\r\n  Site: 'Site',\r\n  Global: 'Global',\r\n} as const;\r\nexport type AppScope = typeof AppScopes[keyof typeof AppScopes];\r\n\r\nexport interface DialogContextEnable {\r\n  /** Determines if app admin should show app-permissions (true for Apps, false for Content) */\r\n  AppPermissions?: boolean;\r\n  /** Determines if Code editing should be enabled (true for super-users) */\r\n  CodeEditor?: boolean;\r\n  /** Determines if Queries should be enabled (true for Apps) */\r\n  Query?: boolean;\r\n  /** True if saving of formulas should be enabled (for edit-ui) */\r\n  FormulaSave?: boolean;\r\n}\r\n\r\nexport interface DialogContextLanguage {\r\n  All: DialogContextAllLangs;\r\n  Current: string;\r\n  Primary: string;\r\n}\r\n\r\nexport interface DialogContextAllLangs {\r\n  [key: string]: string;\r\n}\r\n\r\nexport interface DialogContextPage {\r\n  Id: number;\r\n}\r\n\r\nexport interface DialogContextSite {\r\n  DefaultApp: DialogContextDefaultApp;\r\n  Id: number;\r\n  Url: string;\r\n}\r\n\r\nexport interface DialogContextSystem {\r\n  DefaultApp: DialogContextDefaultApp;\r\n  Url: string;\r\n}\r\n\r\nexport interface DialogContextDefaultApp {\r\n  ZoneId: number;\r\n  AppId: number;\r\n}\r\n","import { Component, Input, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-getting-started',\r\n  templateUrl: './getting-started.component.html',\r\n  styleUrls: ['./getting-started.component.scss'],\r\n})\r\nexport class GettingStartedComponent implements OnInit {\r\n  @Input() gettingStartedUrl: string;\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n}\r\n","<iframe class=\"iframe\" [src]=\"gettingStartedUrl | safeResourceUrl\"></iframe>\r\n","<div class=\"actions-component\">\r\n  <div class=\"like-button highlight\" matRipple *ngIf=\"!contentType.UsesSharedDef\" tippy=\"Metadata\"\r\n    (click)=\"createOrEditMetadata()\">\r\n    <mat-icon>edit</mat-icon>\r\n  </div>\r\n  <div class=\"like-button disabled\" *ngIf=\"contentType.UsesSharedDef\">\r\n    <mat-icon>edit</mat-icon>\r\n  </div>\r\n\r\n  <div class=\"like-button highlight\" matRipple *ngIf=\"enablePermissions\" tippy=\"Permissions\"\r\n    (click)=\"openPermissions()\">\r\n    <mat-icon [matBadge]=\"contentType.Permissions.Count\" matBadgePosition=\"after\" matBadgeColor=\"accent\"\r\n      matBadgeSize=\"small\" *ngIf=\"contentType.Permissions.Count\">\r\n      person\r\n    </mat-icon>\r\n    <mat-icon *ngIf=\"!contentType.Permissions.Count\">person</mat-icon>\r\n  </div>\r\n  <div class=\"like-button disabled\" *ngIf=\"!enablePermissions\">\r\n    <mat-icon>person</mat-icon>\r\n  </div>\r\n\r\n  <div class=\"like-button highlight\" matRipple tippy=\"More\" [matMenuTriggerFor]=\"menu\">\r\n    <mat-icon>more_horiz</mat-icon>\r\n  </div>\r\n</div>\r\n\r\n<mat-menu #menu=\"matMenu\" class=\"grid-more-menu\">\r\n  <button mat-menu-item [disabled]=\"contentType.UsesSharedDef\" (click)=\"editContentType()\">\r\n    <mat-icon>settings</mat-icon>\r\n    <span>Rename</span>\r\n  </button>\r\n  <button mat-menu-item [disabled]=\"contentType.UsesSharedDef\" (click)=\"addMetadata()\">\r\n    <mat-icon>local_offer</mat-icon>\r\n    <span>Add metadata</span>\r\n  </button>\r\n  <button mat-menu-item (click)=\"openRestApi()\">\r\n    <mat-icon svgIcon=\"code-curly\"></mat-icon>\r\n    <span>REST API</span>\r\n  </button>\r\n  <button mat-menu-item (click)=\"exportType()\">\r\n    <mat-icon>cloud_download</mat-icon>\r\n    <span>Export content type</span>\r\n  </button>\r\n  <button mat-menu-item (click)=\"openDataExport()\">\r\n    <mat-icon>cloud_download</mat-icon>\r\n    <span>Export data</span>\r\n  </button>\r\n  <button mat-menu-item (click)=\"openDataImport()\">\r\n    <mat-icon>cloud_upload</mat-icon>\r\n    <span>Import data</span>\r\n  </button>\r\n  <button mat-menu-item [disabled]=\"contentType.UsesSharedDef\" (click)=\"deleteContentType()\">\r\n    <mat-icon>delete</mat-icon>\r\n    <span>Delete</span>\r\n  </button>\r\n</mat-menu>\r\n","import { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { Component } from '@angular/core';\r\nimport { guidRegex } from '../../../shared/constants/guid.constants';\r\nimport { ContentType } from '../../models/content-type.model';\r\nimport { DataActionsParams } from './data-actions.models';\r\n\r\n@Component({\r\n  selector: 'app-data-actions',\r\n  templateUrl: './data-actions.component.html',\r\n  styleUrls: ['./data-actions.component.scss'],\r\n})\r\nexport class DataActionsComponent implements ICellRendererAngularComp {\r\n  contentType: ContentType;\r\n  enablePermissions: boolean;\r\n  private params: DataActionsParams;\r\n\r\n  constructor() { }\r\n\r\n  agInit(params: DataActionsParams) {\r\n    this.params = params;\r\n    this.contentType = this.params.data;\r\n    const enablePermissions = this.params.enablePermissionsGetter();\r\n    this.enablePermissions = enablePermissions && guidRegex().test(this.contentType.StaticName);\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n\r\n  createOrEditMetadata() {\r\n    this.params.onCreateOrEditMetadata(this.contentType);\r\n  }\r\n\r\n  openPermissions() {\r\n    this.params.onOpenPermissions(this.contentType);\r\n  }\r\n\r\n  editContentType() {\r\n    this.params.onEdit(this.contentType);\r\n  }\r\n\r\n  addMetadata() {\r\n    this.params.onAddMetadata(this.contentType);\r\n  }\r\n\r\n  openRestApi() {\r\n    this.params.onOpenRestApi(this.contentType);\r\n  }\r\n\r\n  exportType() {\r\n    this.params.onTypeExport(this.contentType);\r\n  }\r\n\r\n  openDataExport() {\r\n    this.params.onOpenDataExport(this.contentType);\r\n  }\r\n\r\n  openDataImport() {\r\n    this.params.onOpenDataImport(this.contentType);\r\n  }\r\n\r\n  deleteContentType() {\r\n    this.params.onDelete(this.contentType);\r\n  }\r\n}\r\n","<div matRipple class=\"chip-component highlight\" tippy=\"Edit fields\" *ngIf=\"!contentType.UsesSharedDef\">\r\n  <div class=\"chip-box\">\r\n    <span class=\"chip\">{{ value }}</span>\r\n  </div>\r\n  <div class=\"like-button\">\r\n    <mat-icon>dns</mat-icon>\r\n  </div>\r\n</div>\r\n\r\n<div class=\"chip-component disabled\" *ngIf=\"contentType.UsesSharedDef\"\r\n  tippy=\"This content-type shares the definition of #{{ contentType.SharedDefId }} so you can't edit it here. Read 2sxc.org/help?tag=shared-types\">\r\n  <div class=\"chip-box\">\r\n    <span class=\"chip\">{{ value }}</span>\r\n  </div>\r\n  <div class=\"like-button disabled\">\r\n    <mat-icon>share</mat-icon>\r\n  </div>\r\n</div>\r\n","import { ICellRendererParams } from '@ag-grid-community/all-modules';\r\nimport { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { Component } from '@angular/core';\r\nimport { ContentType } from '../../models/content-type.model';\r\n\r\n@Component({\r\n  selector: 'app-data-fields',\r\n  templateUrl: './data-fields.component.html',\r\n  styleUrls: ['./data-fields.component.scss'],\r\n})\r\nexport class DataFieldsComponent implements ICellRendererAngularComp {\r\n  contentType: ContentType;\r\n  value: number;\r\n\r\n  agInit(params: ICellRendererParams) {\r\n    this.contentType = params.data;\r\n    this.value = params.value;\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n}\r\n","import { ICellRendererParams } from '@ag-grid-community/all-modules';\r\nimport { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { Component } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-data-items',\r\n  templateUrl: './data-items.component.html',\r\n  styleUrls: ['./data-items.component.scss'],\r\n})\r\nexport class DataItemsComponent implements ICellRendererAngularComp {\r\n  value: number;\r\n\r\n  agInit(params: ICellRendererParams) {\r\n    this.value = params.value;\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n}\r\n","<div matRipple class=\"chip-component highlight\" tippy=\"Add item\">\r\n  <div class=\"chip-box\">\r\n    <span class=\"chip\">{{ value }}</span>\r\n  </div>\r\n  <div class=\"like-button\">\r\n    <mat-icon>add</mat-icon>\r\n  </div>\r\n</div>\r\n","<ng-container *ngIf=\"templateVars$ | async as data\">\r\n  <div mat-dialog-title>\r\n    <div class=\"dialog-title-box\">Please select Content Type</div>\r\n  </div>\r\n\r\n  <p class=\"dialog-description\">\r\n    This is a special operation to add an item which is metadata for another item,\r\n    see <a href=\"http://r.2sxc.org/metadata\" target=\"_blank\">docs</a>.\r\n  </p>\r\n\r\n  <form [formGroup]=\"form\" class=\"dialog-form\">\r\n    <div class=\"dialog-form-content fancy-scrollbar-light\">\r\n\r\n      <!-- Content Type -->\r\n      <div class=\"edit-input\">\r\n        <mat-form-field appearance=\"standard\" color=\"accent\">\r\n          <mat-label>Content Type</mat-label>\r\n          <mat-select formControlName=\"contentType\" required\r\n            [placeholder]=\"!data.contentTypes.length ? 'No items found' : ''\">\r\n            <mat-option *ngFor=\"let contentType of data.contentTypes\" [value]=\"contentType.StaticName\">\r\n              {{ contentType.Label }}\r\n            </mat-option>\r\n          </mat-select>\r\n        </mat-form-field>\r\n        <app-field-hint *ngIf=\"contentTypeControl.touched && contentTypeControl.errors?.required\" [isError]=\"true\">\r\n          This field is required\r\n        </app-field-hint>\r\n      </div>\r\n\r\n      <mat-accordion [@.disabled]=\"data.disableAnimation\">\r\n        <mat-expansion-panel>\r\n          <mat-expansion-panel-header>\r\n            <mat-panel-title>Advanced</mat-panel-title>\r\n            <mat-panel-description></mat-panel-description>\r\n          </mat-expansion-panel-header>\r\n\r\n          <!-- Scope -->\r\n          <div class=\"edit-input\">\r\n            <mat-form-field appearance=\"standard\" color=\"accent\">\r\n              <mat-label>Scope</mat-label>\r\n              <mat-select formControlName=\"scope\" required\r\n                [placeholder]=\"!data.contentTypes.length ? 'No items found' : ''\">\r\n                <mat-option *ngFor=\"let scopeOption of data.scopeOptions\" [value]=\"scopeOption.value\">\r\n                  {{ scopeOption.name }}\r\n                </mat-option>\r\n                <mat-option value=\"Other\">Other...</mat-option>\r\n              </mat-select>\r\n              <button mat-icon-button type=\"button\" matSuffix [tippy]=\"data.lockScope ? 'Unlock' : 'Lock'\">\r\n                <mat-icon appClickStopPropagation (click)=\"unlockScope()\">\r\n                  {{ data.lockScope ? 'lock' : 'lock_open' }}\r\n                </mat-icon>\r\n              </button>\r\n            </mat-form-field>\r\n            <app-field-hint>\r\n              The scope should almost never be changed -\r\n              <a href=\"https://2sxc.org/help?tag=scope\" target=\"_blank\" appClickStopPropagation>see help</a>\r\n            </app-field-hint>\r\n            <app-field-hint *ngIf=\"scopeControl.touched && scopeControl.errors?.required\" [isError]=\"true\">\r\n              This field is required\r\n            </app-field-hint>\r\n          </div>\r\n        </mat-expansion-panel>\r\n      </mat-accordion>\r\n    </div>\r\n\r\n    <div class=\"dialog-form-actions\">\r\n      <button mat-raised-button type=\"button\" (click)=\"closeDialog()\">Cancel</button>\r\n      <button mat-raised-button type=\"button\" color=\"accent\" [disabled]=\"!form.valid\" (click)=\"confirm()\">\r\n        Confirm\r\n      </button>\r\n    </div>\r\n  </form>\r\n</ng-container>\r\n","import { AfterViewInit, Component, HostBinding, Inject, OnDestroy, OnInit } from '@angular/core';\r\nimport { AbstractControl, FormControl, FormGroup, Validators } from '@angular/forms';\r\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\r\nimport { BehaviorSubject, combineLatest, Observable, Subscription } from 'rxjs';\r\nimport { distinctUntilChanged, filter, map, startWith } from 'rxjs/operators';\r\nimport { GeneralHelpers } from '../../../../../../edit/shared/helpers';\r\nimport { eavConstants, EavScopeOption } from '../../../shared/constants/eav.constants';\r\nimport { ContentType } from '../../models';\r\nimport { ContentTypesService } from '../../services';\r\nimport { MetadataSaveDialogData, MetadataSaveDialogTemplateVars } from './metadata-save-dialog.models';\r\n\r\n@Component({\r\n  selector: 'app-metadata-save-dialog',\r\n  templateUrl: './metadata-save-dialog.component.html',\r\n  styleUrls: ['./metadata-save-dialog.component.scss']\r\n})\r\nexport class MetadataSaveDialogComponent implements OnInit, AfterViewInit, OnDestroy {\r\n  @HostBinding('className') hostClass = 'dialog-component';\r\n\r\n  form: FormGroup;\r\n  contentTypeControl: AbstractControl;\r\n  scopeControl: AbstractControl;\r\n  templateVars$: Observable<MetadataSaveDialogTemplateVars>;\r\n\r\n  private initialScope: string;\r\n  private disableAnimation$: BehaviorSubject<boolean>;\r\n  private scopeOptions$: BehaviorSubject<EavScopeOption[]>;\r\n  private lockScope$: BehaviorSubject<boolean>;\r\n  private contentTypes$: BehaviorSubject<ContentType[]>;\r\n  private subscription: Subscription;\r\n\r\n  constructor(\r\n    @Inject(MAT_DIALOG_DATA) private dialogData: MetadataSaveDialogData | undefined,\r\n    private dialogRef: MatDialogRef<MetadataSaveDialogComponent>,\r\n    private contentTypesService: ContentTypesService,\r\n  ) { }\r\n\r\n  ngOnInit(): void {\r\n    this.initialScope = this.dialogData?.scope ?? eavConstants.scopes.default.value;\r\n    this.disableAnimation$ = new BehaviorSubject(true);\r\n    this.scopeOptions$ = new BehaviorSubject<EavScopeOption[]>([]);\r\n    this.lockScope$ = new BehaviorSubject(true);\r\n    this.contentTypes$ = new BehaviorSubject<ContentType[]>([]);\r\n    this.subscription = new Subscription();\r\n\r\n    this.form = new FormGroup({\r\n      contentType: new FormControl(null, [Validators.required]),\r\n      scope: new FormControl(this.initialScope, [Validators.required]),\r\n    });\r\n    this.contentTypeControl = this.form.controls['contentType'];\r\n    this.scopeControl = this.form.controls['scope'];\r\n\r\n    this.subscription.add(\r\n      this.lockScope$.subscribe(lockScope => {\r\n        if (lockScope) {\r\n          if (this.scopeControl.value !== this.initialScope) {\r\n            this.scopeControl.patchValue(this.initialScope);\r\n          }\r\n          if (!this.scopeControl.disabled) {\r\n            this.scopeControl.disable();\r\n          }\r\n        } else {\r\n          if (this.scopeControl.disabled) {\r\n            this.scopeControl.enable();\r\n          }\r\n        }\r\n      })\r\n    );\r\n\r\n    this.subscription.add(\r\n      this.scopeControl.valueChanges.subscribe(scope => {\r\n        if (scope !== 'Other') { return; }\r\n\r\n        let newScope = prompt('This is an advanced feature to show content-types of another scope. Don\\'t use this if you don\\'t know what you\\'re doing, as content-types of other scopes are usually hidden for a good reason.');\r\n        if (!newScope) {\r\n          newScope = this.initialScope;\r\n        }\r\n        this.scopeControl.patchValue(newScope);\r\n      })\r\n    );\r\n\r\n    const scope$ = this.scopeControl.valueChanges.pipe(\r\n      startWith(this.scopeControl.value),\r\n      filter<string>(scope => scope !== 'Other'),\r\n      distinctUntilChanged(),\r\n    );\r\n\r\n    this.subscription.add(\r\n      combineLatest([this.contentTypesService.getScopes(), scope$]).subscribe(([scopeOptions, selectedScope]) => {\r\n        const newScopes = [...this.scopeOptions$.value];\r\n        scopeOptions.forEach(scopeOption => {\r\n          if (!newScopes.some(scope => scope.value === scopeOption.value)) {\r\n            newScopes.push(scopeOption);\r\n          }\r\n        });\r\n        if (!newScopes.some(scope => scope.value === selectedScope)) {\r\n          const newScopeOption: EavScopeOption = {\r\n            name: selectedScope,\r\n            value: selectedScope,\r\n          };\r\n          newScopes.push(newScopeOption);\r\n        }\r\n        this.scopeOptions$.next(newScopes);\r\n      })\r\n    );\r\n\r\n    this.subscription.add(\r\n      scope$.subscribe(scope => {\r\n        if (this.contentTypeControl.value != null) {\r\n          this.contentTypeControl.patchValue(null);\r\n        }\r\n        if (this.contentTypes$.value.length > 0) {\r\n          this.contentTypes$.next([]);\r\n        }\r\n        this.contentTypesService.retrieveContentTypes(scope).subscribe(contentTypes => {\r\n          this.contentTypes$.next(contentTypes);\r\n        });\r\n      })\r\n    );\r\n\r\n    this.templateVars$ = combineLatest([\r\n      this.disableAnimation$,\r\n      this.scopeOptions$,\r\n      this.contentTypes$,\r\n      this.lockScope$,\r\n      this.form.valueChanges.pipe(\r\n        startWith(this.form.value),\r\n        distinctUntilChanged<Record<string, string>>(GeneralHelpers.objectsEqual),\r\n      ),\r\n    ]).pipe(\r\n      map(([disableAnimation, scopeOptions, contentTypes, lockScope, formValues]) => {\r\n        const templateVars: MetadataSaveDialogTemplateVars = {\r\n          contentTypes,\r\n          disableAnimation,\r\n          formValues,\r\n          lockScope,\r\n          scopeOptions,\r\n        };\r\n        return templateVars;\r\n      }),\r\n    );\r\n  }\r\n\r\n  // workaround for angular component issue #13870\r\n  ngAfterViewInit() {\r\n    // timeout required to avoid ExpressionChangedAfterItHasBeenCheckedError\r\n    setTimeout(() => this.disableAnimation$.next(false));\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.disableAnimation$.complete();\r\n    this.scopeOptions$.complete();\r\n    this.lockScope$.complete();\r\n    this.contentTypes$.complete();\r\n    this.subscription.unsubscribe();\r\n  }\r\n\r\n  closeDialog(saveToContentTypeName?: string): void {\r\n    this.dialogRef.close(saveToContentTypeName);\r\n  }\r\n\r\n  unlockScope(): void {\r\n    this.lockScope$.next(!this.lockScope$.value);\r\n  }\r\n\r\n  confirm(): void {\r\n    const saveToContentTypeName = this.contentTypeControl.value;\r\n    this.closeDialog(saveToContentTypeName);\r\n  }\r\n}\r\n","<div class=\"grid-wrapper mat-tab-grid-wrapper\">\r\n  <ag-grid-angular class=\"ag-theme-material\" [rowData]=\"contentTypes$ | async\" [modules]=\"modules\"\r\n    [gridOptions]=\"gridOptions\" appDragAndDrop [allowedFileTypes]=\"'xml,json'\" (filesDropped)=\"filesDropped($event)\">\r\n  </ag-grid-angular>\r\n\r\n  <div class=\"grid-more-actions-box\">\r\n    <mat-form-field appearance=\"standard\" color=\"accent\" class=\"scope-dropdown\">\r\n      <mat-select [ngModel]=\"scope$ | async\" name=\"Scope\" (ngModelChange)=\"changeScope($event)\">\r\n        <mat-option *ngFor=\"let scopeOption of (scopeOptions$ | async)\" [value]=\"scopeOption.value\">\r\n          {{ 'Scope: ' + scopeOption.name }}\r\n        </mat-option>\r\n        <mat-option value=\"Other\">Scope: Other...</mat-option>\r\n      </mat-select>\r\n    </mat-form-field>\r\n\r\n    <button mat-button tippy=\"Import content type\" (click)=\"importType()\">\r\n      <mat-icon>cloud_upload</mat-icon>\r\n      <span>Content Type</span>\r\n    </button>\r\n\r\n    <button mat-button color=\"accent\" tippy=\"Create a ghost content type\" *ngIf=\"debugEnabled$ | async\"\r\n      (click)=\"createGhost()\">\r\n      <mat-icon>share</mat-icon>\r\n      <span>Ghost</span>\r\n    </button>\r\n  </div>\r\n\r\n  <button mat-fab mat-elevation-z24 class=\"grid-fab\" tippy=\"Create a new content type\" (click)=\"editContentType(null)\">\r\n    <mat-icon>add</mat-icon>\r\n  </button>\r\n</div>\r\n","import { AllCommunityModules, CellClassParams, CellClickedEvent, GridOptions } from '@ag-grid-community/all-modules';\r\nimport { ChangeDetectorRef, Component, Input, OnDestroy, OnInit, ViewContainerRef } from '@angular/core';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { ActivatedRoute, NavigationEnd, Router } from '@angular/router';\r\nimport { BehaviorSubject, from, Subscription } from 'rxjs';\r\nimport { distinctUntilChanged, filter, map, pairwise, startWith, take } from 'rxjs/operators';\r\nimport { GlobalConfigService } from '../../../../../edit/shared/store/ngrx-data';\r\nimport { ContentExportService } from '../../content-export/services/content-export.service';\r\nimport { ContentImportDialogData } from '../../content-import/content-import-dialog.config';\r\nimport { GoToDevRest } from '../../dev-rest/go-to-dev-rest';\r\nimport { GoToPermissions } from '../../permissions/go-to-permissions';\r\nimport { IdFieldComponent } from '../../shared/components/id-field/id-field.component';\r\nimport { IdFieldParams } from '../../shared/components/id-field/id-field.models';\r\nimport { defaultGridOptions } from '../../shared/constants/default-grid-options.constants';\r\nimport { eavConstants, EavScopeOption } from '../../shared/constants/eav.constants';\r\nimport { toString } from '../../shared/helpers/file-to-base64.helper';\r\nimport { convertFormToUrl } from '../../shared/helpers/url-prep.helper';\r\nimport { EditForm } from '../../shared/models/edit-form.model';\r\nimport { DataActionsComponent } from '../ag-grid-components/data-actions/data-actions.component';\r\nimport { DataActionsParams } from '../ag-grid-components/data-actions/data-actions.models';\r\nimport { DataFieldsComponent } from '../ag-grid-components/data-fields/data-fields.component';\r\nimport { DataItemsComponent } from '../ag-grid-components/data-items/data-items.component';\r\nimport { ContentType } from '../models/content-type.model';\r\nimport { ContentTypesService } from '../services/content-types.service';\r\nimport { ImportContentTypeDialogData } from '../sub-dialogs/import-content-type/import-content-type-dialog.config';\r\nimport { MetadataSaveDialogComponent } from '../sub-dialogs/metadata/metadata-save-dialog.component';\r\nimport { MetadataSaveDialogData } from '../sub-dialogs/metadata/metadata-save-dialog.models';\r\n\r\n@Component({\r\n  selector: 'app-data',\r\n  templateUrl: './data.component.html',\r\n  styleUrls: ['./data.component.scss'],\r\n})\r\nexport class DataComponent implements OnInit, OnDestroy {\r\n  @Input() enablePermissions: boolean;\r\n\r\n  contentTypes$ = new BehaviorSubject<ContentType[]>(null);\r\n  scope$ = new BehaviorSubject<string>(null);\r\n  scopeOptions$ = new BehaviorSubject<EavScopeOption[]>([]);\r\n  debugEnabled$ = this.globalConfigService.getDebugEnabled$();\r\n\r\n  modules = AllCommunityModules;\r\n  gridOptions: GridOptions = {\r\n    ...defaultGridOptions,\r\n    frameworkComponents: {\r\n      idFieldComponent: IdFieldComponent,\r\n      dataItemsComponent: DataItemsComponent,\r\n      dataFieldsComponent: DataFieldsComponent,\r\n      dataActionsComponent: DataActionsComponent,\r\n    },\r\n    columnDefs: [\r\n      {\r\n        headerName: 'ID', field: 'Id', width: 70, headerClass: 'dense', cellClass: 'id-action no-padding no-outline',\r\n        cellRenderer: 'idFieldComponent', sortable: true, filter: 'agTextColumnFilter',\r\n        cellRendererParams: {\r\n          tooltipGetter: (paramsData: ContentType) => `ID: ${paramsData.Id}\\nGUID: ${paramsData.StaticName}`,\r\n        } as IdFieldParams,\r\n      },\r\n      {\r\n        headerName: 'Content Type', field: 'Label', flex: 3, minWidth: 250, cellClass: 'primary-action highlight', sortable: true,\r\n        sort: 'asc', filter: 'agTextColumnFilter', onCellClicked: this.showContentItems.bind(this),\r\n        comparator: (valueA, valueB, nodeA, nodeB, isInverted) => {\r\n          const a = (nodeA.data as ContentType)._compareLabel;\r\n          const b = (nodeB.data as ContentType)._compareLabel;\r\n          return a.localeCompare(b);\r\n        },\r\n      },\r\n      {\r\n        headerName: 'Items', field: 'Items', width: 102, headerClass: 'dense', cellClass: 'secondary-action no-padding',\r\n        sortable: true, filter: 'agNumberColumnFilter', cellRenderer: 'dataItemsComponent', onCellClicked: this.addItem.bind(this),\r\n      },\r\n      {\r\n        headerName: 'Fields', field: 'Fields', width: 94, headerClass: 'dense', cellClass: 'secondary-action no-padding',\r\n        sortable: true, filter: 'agNumberColumnFilter', cellRenderer: 'dataFieldsComponent', onCellClicked: this.editFields.bind(this),\r\n      },\r\n      {\r\n        headerName: 'Name', field: 'Name', flex: 1, minWidth: 100, cellClass: this.nameCellClassGetter.bind(this),\r\n        sortable: true, filter: 'agTextColumnFilter', onCellClicked: (event) => { this.editContentType(event.data); },\r\n      },\r\n      {\r\n        headerName: 'Description', field: 'Metadata.Description', flex: 3, minWidth: 250, cellClass: 'no-outline',\r\n        sortable: true, filter: 'agTextColumnFilter',\r\n      },\r\n      {\r\n        width: 120, cellClass: 'secondary-action no-padding', cellRenderer: 'dataActionsComponent', pinned: 'right',\r\n        cellRendererParams: {\r\n          enablePermissionsGetter: this.enablePermissionsGetter.bind(this),\r\n          onCreateOrEditMetadata: this.createOrEditMetadata.bind(this),\r\n          onOpenPermissions: this.openPermissions.bind(this),\r\n          onEdit: this.editContentType.bind(this),\r\n          onOpenRestApi: this.openRestApi.bind(this),\r\n          onAddMetadata: this.addMetadata.bind(this),\r\n          onTypeExport: this.exportType.bind(this),\r\n          onOpenDataExport: this.openDataExport.bind(this),\r\n          onOpenDataImport: this.openDataImport.bind(this),\r\n          onDelete: this.deleteContentType.bind(this),\r\n        } as DataActionsParams,\r\n      },\r\n    ],\r\n  };\r\n\r\n  private defaultScope = eavConstants.scopes.default.value;\r\n  private subscription = new Subscription();\r\n\r\n  constructor(\r\n    private router: Router,\r\n    private route: ActivatedRoute,\r\n    private contentTypesService: ContentTypesService,\r\n    private globalConfigService: GlobalConfigService,\r\n    private snackBar: MatSnackBar,\r\n    private contentExportService: ContentExportService,\r\n    private dialog: MatDialog,\r\n    private viewContainerRef: ViewContainerRef,\r\n    private changeDetectorRef: ChangeDetectorRef,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.fetchScopes();\r\n    this.refreshScopeOnRouteChange();\r\n    this.refreshOnChildClosed();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.contentTypes$.complete();\r\n    this.scope$.complete();\r\n    this.scopeOptions$.complete();\r\n    this.subscription.unsubscribe();\r\n  }\r\n\r\n  filesDropped(files: File[]) {\r\n    const importFile = files[0];\r\n    const ext = importFile.name.substring(importFile.name.lastIndexOf('.') + 1).toLocaleLowerCase();\r\n    switch (ext) {\r\n      case 'xml':\r\n        from(toString(files[0])).pipe(take(1)).subscribe(fileString => {\r\n          const contentTypeName = fileString.split('<Entity Type=\"')[1]?.split('\"')[0];\r\n          const contentType = this.contentTypes$.value.find(ct => ct.Name === contentTypeName);\r\n          if (contentType == null) {\r\n            const message = `Cannot find Content Type named '${contentTypeName}'. Please open Content Type Import dialog manually.`;\r\n            this.snackBar.open(message, null, { duration: 5000 });\r\n            return;\r\n          }\r\n          this.openDataImport(contentType, files);\r\n        });\r\n        break;\r\n      case 'json':\r\n        this.importType(files);\r\n        break;\r\n    }\r\n  }\r\n\r\n  importType(files?: File[]) {\r\n    const importContentTypeData: ImportContentTypeDialogData = { files };\r\n    this.router.navigate(['import'], { relativeTo: this.route.firstChild, state: importContentTypeData });\r\n  }\r\n\r\n  private showContentItems(params: CellClickedEvent) {\r\n    const contentType = params.data as ContentType;\r\n    this.router.navigate([`items/${contentType.StaticName}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  editContentType(contentType: ContentType) {\r\n    if (!contentType) {\r\n      this.router.navigate(['add'], { relativeTo: this.route.firstChild });\r\n    } else {\r\n      if (contentType.UsesSharedDef) { return; }\r\n      this.router.navigate([`${contentType.StaticName}/edit`], { relativeTo: this.route.firstChild });\r\n    }\r\n  }\r\n\r\n  private fetchContentTypes() {\r\n    this.contentTypesService.retrieveContentTypes(this.scope$.value).subscribe(contentTypes => {\r\n      for (const contentType of contentTypes) {\r\n        contentType._compareLabel = contentType.Label.replace(/\\p{Emoji}/gu, '');\r\n      }\r\n      this.contentTypes$.next(contentTypes);\r\n      if (this.scope$.value !== this.defaultScope) {\r\n        const message = 'Warning! You are in a special scope. Changing things here could easily break functionality';\r\n        this.snackBar.open(message, null, { duration: 2000 });\r\n      }\r\n    });\r\n  }\r\n\r\n  private fetchScopes() {\r\n    this.contentTypesService.getScopes().subscribe(scopeOptions => {\r\n      const newScopes = [...this.scopeOptions$.value];\r\n      scopeOptions.forEach(scopeOption => {\r\n        const existing = newScopes.find(scope => scope.value === scopeOption.value);\r\n        if (existing) {\r\n          existing.name = scopeOption.name;\r\n        } else {\r\n          newScopes.push(scopeOption);\r\n        }\r\n      });\r\n      this.scopeOptions$.next(newScopes);\r\n    });\r\n  }\r\n\r\n  createGhost() {\r\n    const sourceName = window.prompt('To create a ghost content-type enter source static name / id - this is a very advanced operation - read more about it on 2sxc.org/help?tag=ghost');\r\n    if (!sourceName) { return; }\r\n    this.snackBar.open('Saving...');\r\n    this.contentTypesService.createGhost(sourceName).subscribe(res => {\r\n      this.snackBar.open('Saved', null, { duration: 2000 });\r\n      this.fetchContentTypes();\r\n    });\r\n  }\r\n\r\n  changeScope(newScope: string) {\r\n    if (newScope === 'Other') {\r\n      newScope = prompt('This is an advanced feature to show content-types of another scope. Don\\'t use this if you don\\'t know what you\\'re doing, as content-types of other scopes are usually hidden for a good reason.') || this.defaultScope;\r\n    }\r\n    this.router.navigate([`data/${newScope}`], { relativeTo: this.route });\r\n  }\r\n\r\n  private enablePermissionsGetter() {\r\n    return this.enablePermissions;\r\n  }\r\n\r\n  private nameCellClassGetter(params: CellClassParams) {\r\n    const contentType: ContentType = params.data;\r\n    if (contentType.UsesSharedDef) {\r\n      return 'disabled';\r\n    } else {\r\n      return 'primary-action highlight';\r\n    }\r\n  }\r\n\r\n  private addItem(params: CellClickedEvent) {\r\n    const contentType = params.data as ContentType;\r\n    const form: EditForm = {\r\n      items: [{ ContentTypeName: contentType.StaticName }],\r\n    };\r\n    const formUrl = convertFormToUrl(form);\r\n    this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private editFields(params: CellClickedEvent) {\r\n    const contentType = params.data as ContentType;\r\n    if (contentType.UsesSharedDef) { return; }\r\n    this.router.navigate([`fields/${contentType.StaticName}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private createOrEditMetadata(contentType: ContentType) {\r\n    const form: EditForm = {\r\n      items: [\r\n        !contentType.Properties\r\n          ? {\r\n            ContentTypeName: eavConstants.contentTypes.contentType,\r\n            For: {\r\n              Target: eavConstants.metadata.contentType.target,\r\n              String: contentType.StaticName,\r\n            },\r\n            Prefill: { Label: contentType.Name, Description: contentType.Description },\r\n          }\r\n          : { EntityId: contentType.Properties.Id }\r\n      ],\r\n    };\r\n    const formUrl = convertFormToUrl(form);\r\n    this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private addMetadata(contentType: ContentType) {\r\n    const dialogData: MetadataSaveDialogData = {\r\n      scope: this.scope$.value,\r\n    };\r\n    const metadataDialogRef = this.dialog.open(MetadataSaveDialogComponent, {\r\n      autoFocus: false,\r\n      viewContainerRef: this.viewContainerRef,\r\n      width: '650px',\r\n      data: dialogData,\r\n    });\r\n    metadataDialogRef.afterClosed().pipe(take(1)).subscribe((saveToContentTypeName: string) => {\r\n      if (saveToContentTypeName == null) { return; }\r\n\r\n      const form: EditForm = {\r\n        items: [{\r\n          ContentTypeName: saveToContentTypeName,\r\n          For: {\r\n            Target: eavConstants.metadata.contentType.target,\r\n            String: contentType.StaticName,\r\n          },\r\n        }],\r\n      };\r\n      const formUrl = convertFormToUrl(form);\r\n      this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route.firstChild });\r\n      this.changeDetectorRef.markForCheck();\r\n    });\r\n  }\r\n\r\n  private openRestApi(contentType: ContentType) {\r\n    this.router.navigate([GoToDevRest.goToData(contentType)], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private exportType(contentType: ContentType) {\r\n    this.contentExportService.exportJson(contentType.StaticName);\r\n  }\r\n\r\n  private openDataExport(contentType: ContentType) {\r\n    this.router.navigate([`export/${contentType.StaticName}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private openDataImport(contentType: ContentType, files?: File[]) {\r\n    const contentImportData: ContentImportDialogData = { files };\r\n    this.router.navigate([`${contentType.StaticName}/import`], { relativeTo: this.route.firstChild, state: contentImportData });\r\n  }\r\n\r\n  private openPermissions(contentType: ContentType) {\r\n    this.router.navigate([GoToPermissions.goEntity(contentType.StaticName)], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private deleteContentType(contentType: ContentType) {\r\n    if (!confirm(`Are you sure you want to delete '${contentType.Name}' (${contentType.Id})?`)) { return; }\r\n    this.snackBar.open('Deleting...');\r\n    this.contentTypesService.delete(contentType).subscribe(result => {\r\n      this.snackBar.open('Deleted', null, { duration: 2000 });\r\n      this.fetchContentTypes();\r\n    });\r\n  }\r\n\r\n  private refreshScopeOnRouteChange() {\r\n    this.subscription.add(\r\n      this.router.events.pipe(\r\n        filter(event => event instanceof NavigationEnd),\r\n        map(() => this.route.snapshot.firstChild.paramMap.get('scope')),\r\n        startWith(this.route.snapshot.firstChild.paramMap.get('scope')),\r\n        filter(scope => !!scope),\r\n        distinctUntilChanged(),\r\n      ).subscribe(scope => {\r\n        this.scope$.next(scope);\r\n        if (!this.scopeOptions$.value.map(option => option.value).includes(scope)) {\r\n          const newScopeOption: EavScopeOption = {\r\n            name: scope,\r\n            value: scope,\r\n          };\r\n          this.scopeOptions$.next([...this.scopeOptions$.value, newScopeOption]);\r\n        }\r\n        this.fetchContentTypes();\r\n      })\r\n    );\r\n  }\r\n\r\n  private refreshOnChildClosed() {\r\n    this.subscription.add(\r\n      this.router.events.pipe(\r\n        filter(event => event instanceof NavigationEnd),\r\n        startWith(!!this.route.snapshot.firstChild.firstChild),\r\n        map(() => !!this.route.snapshot.firstChild.firstChild),\r\n        pairwise(),\r\n        filter(([hadChild, hasChild]) => hadChild && !hasChild),\r\n      ).subscribe(() => {\r\n        this.fetchContentTypes();\r\n      })\r\n    );\r\n  }\r\n\r\n}\r\n","import { Query } from '../../models/query.model';\r\nimport { IAgActions } from '../ag-actions';\r\n\r\n// Test 2dm 2020-11-20 - I believe the current model has way too much ceremony\r\n// I need to change ca. 10 places just to get one more action to work\r\n// that's not great\r\nexport enum QueryActions {\r\n  Edit,\r\n  Rest,\r\n  Clone,\r\n  Permissions,\r\n  Export,\r\n  Delete,\r\n}\r\n\r\nexport interface QueriesActionsParams extends IAgActions<QueryActions, Query> {\r\n  getEnablePermissions(): boolean;\r\n}\r\n","<div class=\"actions-component\">\r\n  <div class=\"like-button highlight\" matRipple tippy=\"Edit\" (click)=\"params.do(actions.Edit, item)\">\r\n    <mat-icon>edit</mat-icon>\r\n  </div>\r\n\r\n  <div class=\"like-button highlight\" matRipple *ngIf=\"enablePermissions\" tippy=\"Permissions\"\r\n    (click)=\"params.do(actions.Permissions, item)\">\r\n    <mat-icon [matBadge]=\"item._Permissions.Count\" matBadgePosition=\"after\" matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n      *ngIf=\"item._Permissions.Count\">\r\n      person\r\n    </mat-icon>\r\n    <mat-icon *ngIf=\"!item._Permissions.Count\">person</mat-icon>\r\n  </div>\r\n  <div class=\"like-button disabled\" *ngIf=\"!enablePermissions\">\r\n    <mat-icon>person</mat-icon>\r\n  </div>\r\n\r\n  <div class=\"like-button highlight\" matRipple tippy=\"More\" [matMenuTriggerFor]=\"menu\">\r\n    <mat-icon>more_horiz</mat-icon>\r\n  </div>\r\n</div>\r\n\r\n<mat-menu #menu=\"matMenu\" class=\"grid-more-menu\">\r\n  <button mat-menu-item (click)=\"params.do(actions.Rest, item)\">\r\n    <mat-icon svgIcon=\"code-curly\"></mat-icon>\r\n    <span>REST API</span>\r\n  </button>\r\n  <button mat-menu-item (click)=\"params.do(actions.Clone, item)\">\r\n    <mat-icon>file_copy</mat-icon>\r\n    <span>Copy</span>\r\n  </button>\r\n  <button mat-menu-item (click)=\"params.do(actions.Export, item)\">\r\n    <mat-icon>cloud_download</mat-icon>\r\n    <span>Export</span>\r\n  </button>\r\n  <button mat-menu-item (click)=\"params.do(actions.Delete, item)\">\r\n    <mat-icon>delete</mat-icon>\r\n    <span>Delete</span>\r\n  </button>\r\n</mat-menu>\r\n","import { Component } from '@angular/core';\r\nimport { Query } from '../../models/query.model';\r\nimport { AgActionsComponent } from '../ag-actions';\r\nimport { QueriesActionsParams, QueryActions } from './queries-actions';\r\n\r\n@Component({\r\n  selector: 'app-queries-actions',\r\n  templateUrl: './queries-actions.component.html',\r\n})\r\nexport class QueriesActionsComponent extends AgActionsComponent<QueriesActionsParams, Query> {\r\n  enablePermissions: boolean;\r\n\r\n  public actions = QueryActions;\r\n\r\n  agInit(params: QueriesActionsParams) {\r\n    super.agInit(params);\r\n    this.enablePermissions = this.params.getEnablePermissions();\r\n  }\r\n}\r\n","import { ICellRendererParams } from '@ag-grid-community/all-modules';\r\nimport { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\n\r\nexport class AgActionsComponent<TParams extends ICellRendererParams, TData> implements ICellRendererAngularComp {\r\n  public item: TData;\r\n  public params: TParams;\r\n\r\n  constructor() { }\r\n\r\n  agInit(params: TParams) {\r\n    this.params = params;\r\n    this.item = this.params.data;\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n\r\n}\r\n","import { AllCommunityModules, CellClickedEvent, GridOptions } from '@ag-grid-community/all-modules';\r\nimport { Component, Input, OnDestroy, OnInit } from '@angular/core';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { ActivatedRoute, NavigationEnd, Router } from '@angular/router';\r\nimport { BehaviorSubject, Subscription } from 'rxjs';\r\nimport { filter, map, pairwise, startWith } from 'rxjs/operators';\r\nimport { ContentExportService } from '../../content-export/services/content-export.service';\r\nimport { GoToDevRest } from '../../dev-rest/go-to-dev-rest';\r\nimport { GoToPermissions } from '../../permissions/go-to-permissions';\r\nimport { IdFieldComponent } from '../../shared/components/id-field/id-field.component';\r\nimport { IdFieldParams } from '../../shared/components/id-field/id-field.models';\r\nimport { defaultGridOptions } from '../../shared/constants/default-grid-options.constants';\r\nimport { eavConstants } from '../../shared/constants/eav.constants';\r\nimport { convertFormToUrl } from '../../shared/helpers/url-prep.helper';\r\nimport { EditForm } from '../../shared/models/edit-form.model';\r\nimport { DialogService } from '../../shared/services/dialog.service';\r\nimport { QueriesActionsParams, QueryActions } from '../ag-grid-components/queries-actions/queries-actions';\r\nimport { QueriesActionsComponent } from '../ag-grid-components/queries-actions/queries-actions.component';\r\nimport { Query } from '../models/query.model';\r\nimport { PipelinesService } from '../services/pipelines.service';\r\nimport { ImportQueryDialogData } from '../sub-dialogs/import-query/import-query-dialog.config';\r\n\r\n@Component({\r\n  selector: 'app-queries',\r\n  templateUrl: './queries.component.html',\r\n  styleUrls: ['./queries.component.scss'],\r\n})\r\nexport class QueriesComponent implements OnInit, OnDestroy {\r\n  @Input() enablePermissions: boolean;\r\n\r\n  queries$ = new BehaviorSubject<Query[]>(null);\r\n  modules = AllCommunityModules;\r\n  gridOptions: GridOptions = {\r\n    ...defaultGridOptions,\r\n    frameworkComponents: {\r\n      idFieldComponent: IdFieldComponent,\r\n      queriesActionsComponent: QueriesActionsComponent,\r\n    },\r\n    columnDefs: [\r\n      {\r\n        headerName: 'ID', field: 'Id', width: 70, headerClass: 'dense', cellClass: 'id-action no-padding no-outline',\r\n        cellRenderer: 'idFieldComponent', sortable: true, filter: 'agTextColumnFilter',\r\n        cellRendererParams: {\r\n          tooltipGetter: (paramsData: Query) => `ID: ${paramsData.Id}\\nGUID: ${paramsData.Guid}`,\r\n        } as IdFieldParams,\r\n      },\r\n      {\r\n        headerName: 'Name', field: 'Name', flex: 2, minWidth: 250, cellClass: 'primary-action highlight', sortable: true,\r\n        sort: 'asc', filter: 'agTextColumnFilter', onCellClicked: this.openVisualQueryDesigner.bind(this),\r\n      },\r\n      {\r\n        headerName: 'Description', field: 'Description', flex: 2, minWidth: 250, cellClass: 'no-outline', sortable: true,\r\n        filter: 'agTextColumnFilter',\r\n      },\r\n      {\r\n        width: 120, cellClass: 'secondary-action no-padding', pinned: 'right',\r\n        cellRenderer: 'queriesActionsComponent', cellRendererParams: {\r\n          getEnablePermissions: this.enablePermissionsGetter.bind(this),\r\n          do: this.doMenuAction.bind(this),\r\n        } as QueriesActionsParams,\r\n      },\r\n    ],\r\n  };\r\n\r\n  private subscription = new Subscription();\r\n\r\n  constructor(\r\n    private router: Router,\r\n    private route: ActivatedRoute,\r\n    private pipelinesService: PipelinesService,\r\n    private contentExportService: ContentExportService,\r\n    private snackBar: MatSnackBar,\r\n    private dialogService: DialogService,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.fetchQueries();\r\n    this.refreshOnChildClosed();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.queries$.complete();\r\n    this.subscription.unsubscribe();\r\n  }\r\n\r\n  private fetchQueries() {\r\n    this.pipelinesService.getAll(eavConstants.contentTypes.query).subscribe((queries: Query[]) => {\r\n      this.queries$.next(queries);\r\n    });\r\n  }\r\n\r\n  importQuery(files?: File[]) {\r\n    const dialogData: ImportQueryDialogData = { files };\r\n    this.router.navigate(['import'], { relativeTo: this.route.firstChild, state: dialogData });\r\n  }\r\n\r\n  /**\r\n   * Experiment by 2dm 2020-11-20 - trying to reduce the ceremony around menus\r\n   * Once this works, we would then remove all the 3-line functions below, as they\r\n   * would just be added here (if that's the only place they are used)\r\n   */\r\n  private doMenuAction(action: QueryActions, query: Query) {\r\n    switch (action) {\r\n      case QueryActions.Edit: return this.editQuery(query);\r\n      case QueryActions.Rest:\r\n        return this.router.navigate([GoToDevRest.goToQuery(query.Guid)], { relativeTo: this.route.firstChild });\r\n      case QueryActions.Clone: return this.cloneQuery(query);\r\n      case QueryActions.Permissions: return this.openPermissions(query);\r\n      case QueryActions.Export: return this.exportQuery(query);\r\n      case QueryActions.Delete: return this.deleteQuery(query);\r\n    }\r\n  }\r\n\r\n  editQuery(query: Query) {\r\n    const form: EditForm = {\r\n      items: [\r\n        query == null\r\n          ? {\r\n            ContentTypeName: eavConstants.contentTypes.query,\r\n            Prefill: { TestParameters: eavConstants.pipelineDesigner.testParameters }\r\n          }\r\n          : { EntityId: query.Id }\r\n      ],\r\n    };\r\n    const formUrl = convertFormToUrl(form);\r\n    this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private enablePermissionsGetter() {\r\n    return this.enablePermissions;\r\n  }\r\n\r\n  private openVisualQueryDesigner(params: CellClickedEvent) {\r\n    const query: Query = params.data;\r\n    this.dialogService.openQueryDesigner(query.Id);\r\n  }\r\n\r\n  private cloneQuery(query: Query) {\r\n    this.snackBar.open('Copying...');\r\n    this.pipelinesService.clonePipeline(query.Id).subscribe(() => {\r\n      this.snackBar.open('Copied', null, { duration: 2000 });\r\n      this.fetchQueries();\r\n    });\r\n  }\r\n\r\n  private openPermissions(query: Query) {\r\n    this.router.navigate([GoToPermissions.goEntity(query.Guid)], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private exportQuery(query: Query) {\r\n    this.contentExportService.exportEntity(query.Id, 'Query', true);\r\n  }\r\n\r\n  private deleteQuery(query: Query) {\r\n    if (!confirm(`Delete Pipeline '${query.Name}' (${query.Id})?`)) { return; }\r\n    this.snackBar.open('Deleting...');\r\n    this.pipelinesService.delete(query.Id).subscribe(res => {\r\n      this.snackBar.open('Deleted', null, { duration: 2000 });\r\n      this.fetchQueries();\r\n    });\r\n  }\r\n\r\n  private refreshOnChildClosed() {\r\n    this.subscription.add(\r\n      this.router.events.pipe(\r\n        filter(event => event instanceof NavigationEnd),\r\n        startWith(!!this.route.snapshot.firstChild.firstChild),\r\n        map(() => !!this.route.snapshot.firstChild.firstChild),\r\n        pairwise(),\r\n        filter(([hadChild, hasChild]) => hadChild && !hasChild),\r\n      ).subscribe(() => {\r\n        this.fetchQueries();\r\n      })\r\n    );\r\n  }\r\n\r\n}\r\n","<div class=\"grid-wrapper mat-tab-grid-wrapper\">\r\n  <ag-grid-angular class=\"ag-theme-material\" [rowData]=\"queries$ | async\" [modules]=\"modules\"\r\n    [gridOptions]=\"gridOptions\" appDragAndDrop [allowedFileTypes]=\"'json'\" (filesDropped)=\"importQuery($event)\">\r\n  </ag-grid-angular>\r\n\r\n  <div class=\"grid-more-actions-box\"></div>\r\n\r\n  <eco-fab-speed-dial class=\"grid-fab\">\r\n    <eco-fab-speed-dial-trigger [spin]=\"true\">\r\n      <button mat-fab>\r\n        <mat-icon class=\"spin180\">add</mat-icon>\r\n      </button>\r\n    </eco-fab-speed-dial-trigger>\r\n\r\n    <eco-fab-speed-dial-actions>\r\n      <button mat-mini-fab tippy=\"Import query\" (click)=\"importQuery()\">\r\n        <mat-icon>cloud_upload</mat-icon>\r\n      </button>\r\n      <button mat-mini-fab tippy=\"Create a new query\" (click)=\"editQuery(null)\">\r\n        <mat-icon>add</mat-icon>\r\n      </button>\r\n    </eco-fab-speed-dial-actions>\r\n  </eco-fab-speed-dial>\r\n</div>\r\n","<div class=\"actions-component\">\r\n  <div class=\"like-button highlight\" matRipple *ngIf=\"enableCode\" tippy=\"Code\" (click)=\"openCode()\">\r\n    <mat-icon>code</mat-icon>\r\n  </div>\r\n  <div class=\"like-button disabled\" *ngIf=\"!enableCode\">\r\n    <mat-icon>code</mat-icon>\r\n  </div>\r\n\r\n  <div class=\"like-button highlight\" matRipple *ngIf=\"enablePermissions\" tippy=\"Permissions\"\r\n    (click)=\"openPermissions()\">\r\n    <mat-icon [matBadge]=\"view.Permissions.Count\" matBadgePosition=\"after\" matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n      *ngIf=\"view.Permissions.Count\">\r\n      person\r\n    </mat-icon>\r\n    <mat-icon *ngIf=\"!view.Permissions.Count\">person</mat-icon>\r\n  </div>\r\n  <div class=\"like-button disabled\" *ngIf=\"!enablePermissions\">\r\n    <mat-icon>person</mat-icon>\r\n  </div>\r\n\r\n  <div class=\"like-button highlight\" matRipple tippy=\"More\" [matMenuTriggerFor]=\"menu\">\r\n    <mat-icon>more_horiz</mat-icon>\r\n  </div>\r\n</div>\r\n\r\n<mat-menu #menu=\"matMenu\" class=\"grid-more-menu\">\r\n  <button mat-menu-item (click)=\"addMetadata()\">\r\n    <mat-icon>local_offer</mat-icon>\r\n    <span>Add metadata</span>\r\n  </button>\r\n  <button mat-menu-item (click)=\"cloneView()\">\r\n    <mat-icon>file_copy</mat-icon>\r\n    <span>Copy</span>\r\n  </button>\r\n  <button mat-menu-item (click)=\"exportView()\">\r\n    <mat-icon>cloud_download</mat-icon>\r\n    <span>Export</span>\r\n  </button>\r\n  <button mat-menu-item (click)=\"deleteView()\">\r\n    <mat-icon>delete</mat-icon>\r\n    <span>Delete</span>\r\n  </button>\r\n</mat-menu>\r\n","import { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { Component } from '@angular/core';\r\nimport { View } from '../../models/view.model';\r\nimport { ViewActionsParams } from './views-actions.models';\r\n\r\n@Component({\r\n  selector: 'app-views-actions',\r\n  templateUrl: './views-actions.component.html',\r\n  styleUrls: ['./views-actions.component.scss'],\r\n})\r\nexport class ViewsActionsComponent implements ICellRendererAngularComp {\r\n  view: View;\r\n  enableCode: boolean;\r\n  enablePermissions: boolean;\r\n  private params: ViewActionsParams;\r\n\r\n  constructor() { }\r\n\r\n  agInit(params: ViewActionsParams) {\r\n    this.params = params;\r\n    this.view = this.params.data;\r\n    this.enableCode = this.params.enableCodeGetter();\r\n    this.enablePermissions = this.params.enablePermissionsGetter();\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n\r\n  openCode() {\r\n    this.params.onOpenCode(this.view);\r\n  }\r\n\r\n  openPermissions() {\r\n    this.params.onOpenPermissions(this.view);\r\n  }\r\n\r\n  addMetadata() {\r\n    this.params.onAddMetadata(this.view);\r\n  }\r\n\r\n  cloneView() {\r\n    this.params.onClone(this.view);\r\n  }\r\n\r\n  exportView() {\r\n    this.params.onExport(this.view);\r\n  }\r\n\r\n  deleteView() {\r\n    this.params.onDelete(this.view);\r\n  }\r\n}\r\n","<div class=\"icon-container\">\r\n  <mat-icon *ngIf=\"value\">visibility</mat-icon>\r\n  <mat-icon *ngIf=\"!value\">visibility_off</mat-icon>\r\n</div>\r\n","import { ICellRendererParams } from '@ag-grid-community/all-modules';\r\nimport { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { Component } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-views-show',\r\n  templateUrl: './views-show.component.html',\r\n  styleUrls: ['./views-show.component.scss'],\r\n})\r\nexport class ViewsShowComponent implements ICellRendererAngularComp {\r\n  value: boolean;\r\n\r\n  agInit(params: ICellRendererParams) {\r\n    this.value = params.value;\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n}\r\n","import { View } from '../models/view.model';\r\n\r\nexport function calculateViewType(view: View) {\r\n  let value = '';\r\n  let icon = '';\r\n  if (view.HasQuery) {\r\n    value = 'Data (from query)';\r\n    icon = 'filter_list';\r\n  } else if (view.List) {\r\n    value = 'Items (list)';\r\n    icon = 'format_list_numbered';\r\n  } else if (!view.ContentType && !view.HasQuery) {\r\n    value = 'Code';\r\n    icon = 'check_box_outline_blank';\r\n  } else if (!view.List) {\r\n    value = 'Item (one)';\r\n    icon = 'looks_one';\r\n  }\r\n  return { value, icon };\r\n}\r\n","import { ICellRendererParams } from '@ag-grid-community/all-modules';\r\nimport { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { Component } from '@angular/core';\r\nimport { calculateViewType } from '../../views/views.helpers';\r\n\r\n@Component({\r\n  selector: 'app-views-type',\r\n  templateUrl: './views-type.component.html',\r\n  styleUrls: ['./views-type.component.scss'],\r\n})\r\nexport class ViewsTypeComponent implements ICellRendererAngularComp {\r\n  value: string;\r\n  icon: string;\r\n\r\n  agInit(params: ICellRendererParams) {\r\n    this.value = params.value;\r\n    const view = params.data;\r\n    const type = calculateViewType(view);\r\n    this.icon = type.icon;\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n}\r\n","<div class=\"icon-container\" [tippy]=\"value\">\r\n  <mat-icon>{{ icon }}</mat-icon>\r\n</div>\r\n","import polymorphLogo from '!url-loader!./polymorph-logo.png';\r\nimport { AllCommunityModules, CellClickedEvent, GridOptions, ValueGetterParams } from '@ag-grid-community/all-modules';\r\nimport { ChangeDetectorRef, Component, Input, OnDestroy, OnInit, ViewContainerRef } from '@angular/core';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { ActivatedRoute, NavigationEnd, Router } from '@angular/router';\r\nimport { BehaviorSubject, Subscription } from 'rxjs';\r\nimport { filter, map, pairwise, startWith, take } from 'rxjs/operators';\r\nimport { GoToPermissions } from '../../permissions/go-to-permissions';\r\nimport { BooleanFilterComponent } from '../../shared/components/boolean-filter/boolean-filter.component';\r\nimport { IdFieldComponent } from '../../shared/components/id-field/id-field.component';\r\nimport { IdFieldParams } from '../../shared/components/id-field/id-field.models';\r\nimport { defaultGridOptions } from '../../shared/constants/default-grid-options.constants';\r\nimport { eavConstants } from '../../shared/constants/eav.constants';\r\nimport { convertFormToUrl } from '../../shared/helpers/url-prep.helper';\r\nimport { EditForm } from '../../shared/models/edit-form.model';\r\nimport { DialogService } from '../../shared/services/dialog.service';\r\nimport { ViewsActionsComponent } from '../ag-grid-components/views-actions/views-actions.component';\r\nimport { ViewActionsParams } from '../ag-grid-components/views-actions/views-actions.models';\r\nimport { ViewsShowComponent } from '../ag-grid-components/views-show/views-show.component';\r\nimport { ViewsTypeComponent } from '../ag-grid-components/views-type/views-type.component';\r\nimport { Polymorphism } from '../models/polymorphism.model';\r\nimport { View } from '../models/view.model';\r\nimport { ViewsService } from '../services/views.service';\r\nimport { ImportViewDialogData } from '../sub-dialogs/import-view/import-view-dialog.config';\r\nimport { MetadataSaveDialogComponent } from '../sub-dialogs/metadata/metadata-save-dialog.component';\r\nimport { calculateViewType } from './views.helpers';\r\n\r\n@Component({\r\n  selector: 'app-views',\r\n  templateUrl: './views.component.html',\r\n  styleUrls: ['./views.component.scss'],\r\n})\r\nexport class ViewsComponent implements OnInit, OnDestroy {\r\n  @Input() enableCode: boolean;\r\n  @Input() enablePermissions: boolean;\r\n\r\n  views$ = new BehaviorSubject<View[]>(null);\r\n  polymorphStatus$ = new BehaviorSubject('');\r\n  polymorphLogo = polymorphLogo;\r\n\r\n  modules = AllCommunityModules;\r\n  gridOptions: GridOptions = {\r\n    ...defaultGridOptions,\r\n    frameworkComponents: {\r\n      idFieldComponent: IdFieldComponent,\r\n      booleanFilterComponent: BooleanFilterComponent,\r\n      viewsTypeComponent: ViewsTypeComponent,\r\n      viewsShowComponent: ViewsShowComponent,\r\n      viewsActionsComponent: ViewsActionsComponent,\r\n    },\r\n    columnDefs: [\r\n      {\r\n        headerName: 'ID', field: 'Id', width: 70, headerClass: 'dense', cellClass: 'id-action no-padding no-outline',\r\n        cellRenderer: 'idFieldComponent', sortable: true, filter: 'agTextColumnFilter',\r\n        cellRendererParams: {\r\n          tooltipGetter: (paramsData: View) => `ID: ${paramsData.Id}\\nGUID: ${paramsData.Guid}`,\r\n        } as IdFieldParams,\r\n      },\r\n      {\r\n        headerName: 'Show', field: 'IsHidden', width: 70, headerClass: 'dense', cellClass: 'no-outline', cellRenderer: 'viewsShowComponent',\r\n        sortable: true, filter: 'booleanFilterComponent', valueGetter: this.showValueGetter,\r\n      },\r\n      {\r\n        headerName: 'Name', field: 'Name', flex: 2, minWidth: 250, cellClass: 'primary-action highlight',\r\n        sortable: true, sort: 'asc', filter: 'agTextColumnFilter', onCellClicked: this.editView.bind(this),\r\n      },\r\n      {\r\n        headerName: 'Type', field: 'Type', width: 70, headerClass: 'dense', cellClass: 'no-outline',\r\n        sortable: true, filter: 'agTextColumnFilter', cellRenderer: 'viewsTypeComponent', valueGetter: this.typeValueGetter,\r\n      },\r\n      {\r\n        headerName: 'Used', field: 'Used', width: 70, headerClass: 'dense', cellClass: 'primary-action highlight',\r\n        sortable: true, filter: 'agNumberColumnFilter', onCellClicked: (event) => { this.openUsage(event); }\r\n      },\r\n      {\r\n        headerName: 'Url Key', field: 'ViewNameInUrl', flex: 1, minWidth: 150, cellClass: 'no-outline',\r\n        sortable: true, filter: 'agTextColumnFilter',\r\n      },\r\n      {\r\n        headerName: 'Path', field: 'TemplatePath', flex: 2, minWidth: 250, cellClass: 'no-outline',\r\n        sortable: true, filter: 'agTextColumnFilter',\r\n      },\r\n      {\r\n        headerName: 'Content', field: 'ContentType.Name', flex: 2, minWidth: 250, cellClass: 'no-outline',\r\n        sortable: true, filter: 'agTextColumnFilter',\r\n      },\r\n      {\r\n        headerName: 'Default', field: 'ContentType.DemoId', flex: 1, minWidth: 150, cellClass: 'no-outline',\r\n        sortable: true, filter: 'agTextColumnFilter', valueGetter: this.contentDemoValueGetter,\r\n      },\r\n      {\r\n        headerName: 'Presentation', field: 'PresentationType.Name', flex: 2, minWidth: 250, cellClass: 'no-outline',\r\n        sortable: true, filter: 'agTextColumnFilter',\r\n      },\r\n      {\r\n        headerName: 'Default', field: 'PresentationType.DemoId', flex: 1, minWidth: 150, cellClass: 'no-outline',\r\n        sortable: true, filter: 'agTextColumnFilter', valueGetter: this.presentationDemoValueGetter,\r\n      },\r\n      {\r\n        headerName: 'Header', field: 'ListContentType.Name', flex: 2, minWidth: 250, cellClass: 'no-outline',\r\n        sortable: true, filter: 'agTextColumnFilter',\r\n      },\r\n      {\r\n        headerName: 'Default', field: 'ListContentType.DemoId', flex: 1, minWidth: 150, cellClass: 'no-outline',\r\n        sortable: true, filter: 'agTextColumnFilter', valueGetter: this.headerDemoValueGetter,\r\n      },\r\n      {\r\n        headerName: 'Header Presentation', field: 'ListPresentationType.Name', flex: 2, minWidth: 250, cellClass: 'no-outline',\r\n        sortable: true, filter: 'agTextColumnFilter',\r\n      },\r\n      {\r\n        headerName: 'Default', field: 'ListPresentationType.DemoId', flex: 1, minWidth: 150, cellClass: 'no-outline',\r\n        sortable: true, filter: 'agTextColumnFilter', valueGetter: this.headerPresDemoValueGetter,\r\n      },\r\n      {\r\n        width: 120, cellClass: 'secondary-action no-padding', cellRenderer: 'viewsActionsComponent', pinned: 'right',\r\n        cellRendererParams: {\r\n          enableCodeGetter: this.enableCodeGetter.bind(this),\r\n          enablePermissionsGetter: this.enablePermissionsGetter.bind(this),\r\n          onOpenCode: this.openCode.bind(this),\r\n          onOpenPermissions: this.openPermissions.bind(this),\r\n          onAddMetadata: this.addMetadata.bind(this),\r\n          onClone: this.cloneView.bind(this),\r\n          onExport: this.exportView.bind(this),\r\n          onDelete: this.deleteView.bind(this),\r\n        } as ViewActionsParams,\r\n      },\r\n    ],\r\n  };\r\n\r\n  private subscription = new Subscription();\r\n  private polymorphism: Polymorphism;\r\n\r\n  constructor(\r\n    private viewsService: ViewsService,\r\n    private router: Router,\r\n    private route: ActivatedRoute,\r\n    private snackBar: MatSnackBar,\r\n    private dialogService: DialogService,\r\n    private dialog: MatDialog,\r\n    private viewContainerRef: ViewContainerRef,\r\n    private changeDetectorRef: ChangeDetectorRef,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.fetchTemplates();\r\n    this.fetchPolymorphism();\r\n    this.refreshOnChildClosed();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.views$.complete();\r\n    this.polymorphStatus$.complete();\r\n    this.subscription.unsubscribe();\r\n  }\r\n\r\n  importView(files?: File[]) {\r\n    const importViewData: ImportViewDialogData = { files };\r\n    this.router.navigate(['import'], { relativeTo: this.route.firstChild, state: importViewData });\r\n  }\r\n\r\n  private fetchTemplates() {\r\n    this.viewsService.getAll().subscribe(views => {\r\n      this.views$.next(views);\r\n    });\r\n  }\r\n\r\n  private fetchPolymorphism() {\r\n    this.viewsService.getPolymorphism().subscribe(polymorphism => {\r\n      this.polymorphism = polymorphism;\r\n      const polymorphStatus = (polymorphism.Id === null)\r\n        ? 'not configured'\r\n        : (polymorphism.Resolver === null ? 'disabled' : 'using ' + polymorphism.Resolver);\r\n      this.polymorphStatus$.next(polymorphStatus);\r\n    });\r\n  }\r\n\r\n  editView(params: CellClickedEvent) {\r\n    const view: View = params?.data;\r\n    const form: EditForm = {\r\n      items: [\r\n        view == null\r\n          ? { ContentTypeName: eavConstants.contentTypes.template }\r\n          : { EntityId: view.Id }\r\n      ],\r\n    };\r\n    const formUrl = convertFormToUrl(form);\r\n    this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  editPolymorphisms() {\r\n    if (!this.polymorphism) { return; }\r\n\r\n    const form: EditForm = {\r\n      items: [\r\n        !this.polymorphism.Id\r\n          ? { ContentTypeName: this.polymorphism.TypeName }\r\n          : { EntityId: this.polymorphism.Id }\r\n      ],\r\n    };\r\n    const formUrl = convertFormToUrl(form);\r\n    this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private showValueGetter(params: ValueGetterParams) {\r\n    const view: View = params.data;\r\n    return !view.IsHidden;\r\n  }\r\n\r\n  private typeValueGetter(params: ValueGetterParams) {\r\n    const view: View = params.data;\r\n    const type = calculateViewType(view);\r\n    return type.value;\r\n  }\r\n\r\n  private enableCodeGetter() {\r\n    return this.enableCode;\r\n  }\r\n\r\n  private enablePermissionsGetter() {\r\n    return this.enablePermissions;\r\n  }\r\n\r\n  private contentDemoValueGetter(params: ValueGetterParams) {\r\n    const view: View = params.data;\r\n    return `${view.ContentType.DemoId} ${view.ContentType.DemoTitle}`;\r\n  }\r\n\r\n  private presentationDemoValueGetter(params: ValueGetterParams) {\r\n    const view: View = params.data;\r\n    return `${view.PresentationType.DemoId} ${view.PresentationType.DemoTitle}`;\r\n  }\r\n\r\n  private headerDemoValueGetter(params: ValueGetterParams) {\r\n    const view: View = params.data;\r\n    return `${view.ListContentType.DemoId} ${view.ListContentType.DemoTitle}`;\r\n  }\r\n\r\n  private headerPresDemoValueGetter(params: ValueGetterParams) {\r\n    const view: View = params.data;\r\n    return `${view.ListPresentationType.DemoId} ${view.ListPresentationType.DemoTitle}`;\r\n  }\r\n\r\n  private openUsage(event: CellClickedEvent) {\r\n    const view: View = event.data;\r\n    this.router.navigate([`usage/${view.Guid}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private openCode(view: View) {\r\n    this.dialogService.openCodeFile(view.TemplatePath, view.IsShared);\r\n  }\r\n\r\n  private openPermissions(view: View) {\r\n    this.router.navigate([GoToPermissions.goEntity(view.Guid)], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private addMetadata(view: View) {\r\n    const metadataDialogRef = this.dialog.open(MetadataSaveDialogComponent, {\r\n      autoFocus: false,\r\n      viewContainerRef: this.viewContainerRef,\r\n      width: '650px',\r\n    });\r\n    metadataDialogRef.afterClosed().pipe(take(1)).subscribe((saveToContentTypeName: string) => {\r\n      if (saveToContentTypeName == null) { return; }\r\n\r\n      const form: EditForm = {\r\n        items: [{\r\n          ContentTypeName: saveToContentTypeName,\r\n          For: {\r\n            Target: eavConstants.metadata.entity.target,\r\n            String: view.Guid,\r\n          },\r\n        }],\r\n      };\r\n      const formUrl = convertFormToUrl(form);\r\n      this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route.firstChild });\r\n      this.changeDetectorRef.markForCheck();\r\n    });\r\n  }\r\n\r\n  private cloneView(view: View) {\r\n    const form: EditForm = {\r\n      items: [{ ContentTypeName: eavConstants.contentTypes.template, DuplicateEntity: view.Id }],\r\n    };\r\n    const formUrl = convertFormToUrl(form);\r\n    this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private exportView(view: View) {\r\n    this.viewsService.export(view.Id);\r\n  }\r\n\r\n  private deleteView(view: View) {\r\n    if (!confirm(`Delete '${view.Name}' (${view.Id})?`)) { return; }\r\n    this.snackBar.open('Deleting...');\r\n    this.viewsService.delete(view.Id).subscribe(res => {\r\n      this.snackBar.open('Deleted', null, { duration: 2000 });\r\n      this.fetchTemplates();\r\n    });\r\n  }\r\n\r\n  private refreshOnChildClosed() {\r\n    this.subscription.add(\r\n      this.router.events.pipe(\r\n        filter(event => event instanceof NavigationEnd),\r\n        startWith(!!this.route.snapshot.firstChild.firstChild),\r\n        map(() => !!this.route.snapshot.firstChild.firstChild),\r\n        pairwise(),\r\n        filter(([hadChild, hasChild]) => hadChild && !hasChild),\r\n      ).subscribe(() => {\r\n        this.fetchTemplates();\r\n        this.fetchPolymorphism();\r\n      })\r\n    );\r\n  }\r\n}\r\n","export default \"data:image/png;base64,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\"","<div class=\"grid-wrapper mat-tab-grid-wrapper\">\r\n  <ag-grid-angular class=\"ag-theme-material\" [rowData]=\"views$ | async\" [modules]=\"modules\" [gridOptions]=\"gridOptions\"\r\n    appDragAndDrop [allowedFileTypes]=\"'json'\" (filesDropped)=\"importView($event)\">\r\n  </ag-grid-angular>\r\n\r\n  <div class=\"grid-more-actions-box\">\r\n    <button mat-button tippy=\"Configure polymorphism\" (click)=\"editPolymorphisms()\">\r\n      <img class=\"polymorph-logo\" [src]=\"polymorphLogo\">\r\n      <span>Polymorphism {{ polymorphStatus$ | async }}</span>\r\n    </button>\r\n\r\n    <button mat-button tippy=\"Import view\" (click)=\"importView()\">\r\n      <mat-icon>cloud_upload</mat-icon>\r\n      <span>View</span>\r\n    </button>\r\n  </div>\r\n\r\n  <button mat-fab mat-elevation-z24 class=\"grid-fab\" tippy=\"Create a new view\" (click)=\"editView(null)\">\r\n    <mat-icon>add</mat-icon>\r\n  </button>\r\n</div>\r\n","<div class=\"actions-component\">\r\n  <div class=\"like-button highlight\" matRipple *ngIf=\"enableCode\" tippy=\"Code\" (click)=\"openCode()\">\r\n    <mat-icon>code</mat-icon>\r\n  </div>\r\n  <div class=\"like-button disabled\" *ngIf=\"!enableCode\">\r\n    <mat-icon>code</mat-icon>\r\n  </div>\r\n\r\n  <div class=\"like-button highlight\" matRipple tippy=\"More\" [matMenuTriggerFor]=\"menu\">\r\n    <mat-icon>more_horiz</mat-icon>\r\n  </div>\r\n</div>\r\n\r\n<mat-menu #menu=\"matMenu\" class=\"grid-more-menu\">\r\n  <button mat-menu-item (click)=\"openRestApi()\">\r\n    <mat-icon svgIcon=\"code-curly\"></mat-icon>\r\n    <span>REST API</span>\r\n  </button>\r\n</mat-menu>\r\n","import { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { Component } from '@angular/core';\r\nimport { WebApi } from '../../models/web-api.model';\r\nimport { WebApiActionsParams } from './web-api-actions.models';\r\n\r\n@Component({\r\n  selector: 'app-web-api-actions',\r\n  templateUrl: './web-api-actions.component.html',\r\n  styleUrls: ['./web-api-actions.component.scss'],\r\n})\r\nexport class WebApiActionsComponent implements ICellRendererAngularComp {\r\n  enableCode: boolean;\r\n  private params: WebApiActionsParams;\r\n\r\n  agInit(params: WebApiActionsParams) {\r\n    this.params = params;\r\n    this.enableCode = this.params.enableCodeGetter();\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n\r\n  openCode() {\r\n    const api: WebApi = this.params.data;\r\n    this.params.onOpenCode(api);\r\n  }\r\n\r\n  openRestApi() {\r\n    const api: WebApi = this.params.data;\r\n    this.params.onOpenRestApi(api);\r\n  }\r\n}\r\n","import { AllCommunityModules, GridOptions } from '@ag-grid-community/all-modules';\r\nimport { Component, Input, OnDestroy, OnInit } from '@angular/core';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { BehaviorSubject } from 'rxjs';\r\nimport { SanitizeHelper } from '../../../../../edit/shared/helpers';\r\nimport { GoToDevRest } from '../../dev-rest/go-to-dev-rest';\r\nimport { defaultGridOptions } from '../../shared/constants/default-grid-options.constants';\r\nimport { defaultControllerName } from '../../shared/constants/file-names.constants';\r\nimport { DialogService } from '../../shared/services/dialog.service';\r\nimport { WebApiActionsComponent } from '../ag-grid-components/web-api-actions/web-api-actions.component';\r\nimport { WebApiActionsParams } from '../ag-grid-components/web-api-actions/web-api-actions.models';\r\nimport { WebApi } from '../models/web-api.model';\r\nimport { WebApisService } from '../services/web-apis.service';\r\n\r\n@Component({\r\n  selector: 'app-web-api',\r\n  templateUrl: './web-api.component.html',\r\n  styleUrls: ['./web-api.component.scss'],\r\n})\r\nexport class WebApiComponent implements OnInit, OnDestroy {\r\n  @Input() enableCode: boolean;\r\n\r\n  webApis$ = new BehaviorSubject<WebApi[]>(null);\r\n  modules = AllCommunityModules;\r\n  gridOptions: GridOptions = {\r\n    ...defaultGridOptions,\r\n    frameworkComponents: {\r\n      webApiActions: WebApiActionsComponent,\r\n    },\r\n    columnDefs: [\r\n      {\r\n        headerName: 'Folder', field: 'folder', flex: 2, minWidth: 250, cellClass: 'no-outline',\r\n        sortable: true, sort: 'asc', filter: 'agTextColumnFilter',\r\n      },\r\n      {\r\n        headerName: 'Name', field: 'name', flex: 2, minWidth: 250, cellClass: 'no-outline',\r\n        sortable: true, filter: 'agTextColumnFilter',\r\n      },\r\n      {\r\n        width: 80, cellClass: 'secondary-action no-padding', cellRenderer: 'webApiActions', pinned: 'right',\r\n        cellRendererParams: {\r\n          enableCodeGetter: this.enableCodeGetter.bind(this),\r\n          onOpenCode: this.openCode.bind(this),\r\n          onOpenRestApi: this.openRestApi.bind(this),\r\n        } as WebApiActionsParams,\r\n      },\r\n    ],\r\n  };\r\n\r\n  constructor(\r\n    private webApisService: WebApisService,\r\n    private snackBar: MatSnackBar,\r\n    private dialogService: DialogService,\r\n    private router: Router,\r\n    private route: ActivatedRoute,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.fetchWebApis();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.webApis$.complete();\r\n  }\r\n\r\n  addController() {\r\n    let name = prompt('Controller name:', defaultControllerName);\r\n    if (name === null || name.length === 0) { return; }\r\n\r\n    name = SanitizeHelper.sanitizePath(name);\r\n    name = name.replace(/\\s/g, ''); // remove all whitespaces\r\n    // find name without extension\r\n    let nameLower = name.toLocaleLowerCase();\r\n    const extIndex = nameLower.lastIndexOf('.cs');\r\n    if (extIndex > 0) {\r\n      nameLower = nameLower.substring(0, extIndex);\r\n    }\r\n    const typeIndex = nameLower.lastIndexOf('controller');\r\n    if (typeIndex > 0) {\r\n      nameLower = nameLower.substring(0, typeIndex);\r\n    }\r\n    // uppercase first letter, take other letters as is and append extension\r\n    name = name.charAt(0).toLocaleUpperCase() + name.substring(1, nameLower.length) + 'Controller.cs';\r\n\r\n    this.snackBar.open('Saving...');\r\n    this.webApisService.create(name).subscribe(res => {\r\n      this.snackBar.open('Saved', null, { duration: 2000 });\r\n      this.fetchWebApis();\r\n    });\r\n  }\r\n\r\n  private fetchWebApis() {\r\n    this.webApisService.getAll().subscribe(webApis => {\r\n      this.webApis$.next(webApis);\r\n    });\r\n  }\r\n\r\n  private enableCodeGetter() {\r\n    return this.enableCode;\r\n  }\r\n\r\n  private openCode(api: WebApi) {\r\n    this.dialogService.openCodeFile(api.path);\r\n  }\r\n\r\n  private openRestApi(api: WebApi) {\r\n    this.router.navigate([GoToDevRest.goToWebApi(api)], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n}\r\n","<div class=\"grid-wrapper mat-tab-grid-wrapper\">\r\n  <ag-grid-angular class=\"ag-theme-material\" [rowData]=\"webApis$ | async\" [modules]=\"modules\"\r\n    [gridOptions]=\"gridOptions\">\r\n  </ag-grid-angular>\r\n\r\n  <div class=\"grid-more-actions-box\"></div>\r\n\r\n  <button mat-fab mat-elevation-z24 class=\"grid-fab\" tippy=\"Create a new controller\" (click)=\"addController()\">\r\n    <mat-icon>add</mat-icon>\r\n  </button>\r\n</div>\r\n","import { View } from '../../models';\r\n\r\nexport const AnalyzeParts = {\r\n  Settings: 'Settings',\r\n  Resources: 'Resources',\r\n} as const;\r\nexport type AnalyzePart = typeof AnalyzeParts[keyof typeof AnalyzeParts];\r\n\r\nexport interface AnalyzeSettingsTemplateVars {\r\n  views: View[];\r\n  selectedView: string;\r\n  stack: SettingsStackItem[];\r\n}\r\n\r\nexport interface SettingsStackItem {\r\n  Path: string;\r\n  Priority: number;\r\n  Source: string;\r\n  TotalResults: number;\r\n  Type: string;\r\n  Value: string;\r\n  _value: string;\r\n}\r\n","<div class=\"alert alert-info scope-info\"\r\n  *ngIf=\"dialogSettings.Context.App.SettingsScope === AppScopes.Global || dialogSettings.Context.App.SettingsScope === AppScopes.Site\">\r\n  <ng-container *ngIf=\"dialogSettings.Context.App.SettingsScope === AppScopes.Global\">\r\n    This is the Global App. Anything configured here will affect all Sites and Apps in this installation.\r\n  </ng-container>\r\n  <ng-container *ngIf=\"dialogSettings.Context.App.SettingsScope === AppScopes.Site\">\r\n    This is the Primary App of this Site. You can also configure sitewide settings and resources here.\r\n  </ng-container>\r\n  See <a href=\"http://r.2sxc.org/settings\" target=\"_blank\">docs</a>.\r\n</div>\r\n\r\n<div class=\"cards-box\">\r\n  <mat-card class=\"mat-elevation-z2\">\r\n    <mat-card-header>\r\n      <mat-card-title>Settings</mat-card-title>\r\n      <div class=\"mat-card-header-icon\">\r\n        <mat-icon>settings</mat-icon>\r\n      </div>\r\n    </mat-card-header>\r\n    <mat-card-content>\r\n      <p>\r\n        Settings are things like SQL-connection strings, default \"items-to-show\" numbers and similar.\r\n        If necessary, settings like a link to an RSS-Feed could be different in each language.\r\n        <a href=\"http://r.2sxc.org/settings\" target=\"_blank\">docs</a>\r\n      </p>\r\n\r\n      <table class=\"settings\">\r\n        <thead>\r\n          <tr>\r\n            <th></th>\r\n            <th>System Settings</th>\r\n            <th>Custom Settings</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <!-- Only show App Settings when not on Global -->\r\n          <tr *ngIf=\"dialogSettings.Context.App.SettingsScope !== AppScopes.Global\">\r\n            <th>{{ dialogSettings.Context.App.Name }}</th>\r\n            <td>\r\n              <button mat-button (click)=\"edit(eavConstants.contentTypes.systemSettings, SystemSettingsScopes.App)\"\r\n                tippy=\"Edit app system settings\">\r\n                <mat-icon matBadgePosition=\"below after\" matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n                  [matBadge]=\"appSystemSettingsExists ? 1 : null\">\r\n                  edit\r\n                </mat-icon>\r\n              </button>\r\n            </td>\r\n            <td>\r\n              <button mat-button (click)=\"edit(eavConstants.contentTypes.settings)\" tippy=\"Edit custom app settings\">\r\n                <mat-icon>edit</mat-icon>\r\n              </button>\r\n              <button mat-button (click)=\"config(eavConstants.contentTypes.settings)\"\r\n                tippy=\"Configure fields of the custom app settings\">\r\n                <mat-icon>dns</mat-icon>\r\n              </button>\r\n            </td>\r\n          </tr>\r\n          <!-- Only show the Site Settings when we're not on Global -->\r\n          <tr *ngIf=\"dialogSettings.Context.App.SettingsScope !== AppScopes.Global\">\r\n            <th>Site</th>\r\n            <ng-container *ngIf=\"dialogSettings.Context.App.SettingsScope === AppScopes.Site; else elseGotoSite\">\r\n              <td>\r\n                <button mat-button (click)=\"edit(eavConstants.contentTypes.systemSettings, SystemSettingsScopes.Site)\"\r\n                  tippy=\"Edit site system settings\">\r\n                  <mat-icon matBadgePosition=\"below after\" matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n                    [matBadge]=\"siteSystemSettingsExists ? 1 : null\">\r\n                    edit\r\n                  </mat-icon>\r\n                </button>\r\n              </td>\r\n              <td>\r\n                <mat-icon tippy=\"This isn't automated yet. Just create a SettingsCustom yourself\">\r\n                  help_outline\r\n                </mat-icon>\r\n              </td>\r\n            </ng-container>\r\n          </tr>\r\n          <!-- Global Row - always show -->\r\n          <tr>\r\n            <th>Global</th>\r\n            <!-- Global System Settings should be shown on the Global Default App -->\r\n            <ng-container *ngIf=\"dialogSettings.Context.App.SettingsScope === AppScopes.Global; else elseGotoGlobal\">\r\n              <td>\r\n                <button mat-button (click)=\"edit(eavConstants.contentTypes.systemSettings, SystemSettingsScopes.App)\"\r\n                  tippy=\"Edit global system settings\">\r\n                  <mat-icon matBadgePosition=\"below after\" matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n                    [matBadge]=\"appSystemSettingsExists ? 1 : null\">\r\n                    edit\r\n                  </mat-icon>\r\n                </button>\r\n              </td>\r\n              <td>\r\n                <mat-icon tippy=\"This isn't automated yet. Just create a SettingsCustom yourself\">\r\n                  help_outline\r\n                </mat-icon>\r\n              </td>\r\n            </ng-container>\r\n            <!-- Global Settings - show this when not on the Global Default App -->\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n    </mat-card-content>\r\n\r\n    <mat-card-actions>\r\n      <div class=\"actions-row\">\r\n        <button mat-button (click)=\"analyze(AnalyzeParts.Settings)\" tippy=\"See the result of combining all settings\">\r\n          <mat-icon>manage_search</mat-icon>\r\n          <span>Analyze Combined Settings</span>\r\n        </button>\r\n        <!-- <button mat-button (click)=\"edit(eavConstants.contentTypes.settings)\">\r\n          <mat-icon>edit</mat-icon>\r\n          <span>Edit</span>\r\n        </button>\r\n        <button mat-button (click)=\"config(eavConstants.contentTypes.settings)\">\r\n          <mat-icon>dns</mat-icon>\r\n          <span>Fields</span>\r\n        </button> -->\r\n      </div>\r\n      <!-- Global System Settings on Default App -->\r\n      <!-- <ng-container *ngIf=\"dialogSettings.Context.App.SettingsScope === AppScopes.Global\">\r\n        <div class=\"actions-row\">\r\n          <button mat-button (click)=\"edit(eavConstants.contentTypes.systemSettings, SystemSettingsScopes.App)\">\r\n            <mat-icon matBadgePosition=\"after\" matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n              [matBadge]=\"appSystemSettingsExists ? 1 : null\">\r\n              edit\r\n            </mat-icon>\r\n            <span>Global System Settings</span>\r\n          </button>\r\n        </div>\r\n      </ng-container> -->\r\n      <!-- App and Site System Settings on Content App -->\r\n      <!-- <ng-container *ngIf=\"dialogSettings.Context.App.SettingsScope === AppScopes.Site\">\r\n        <div class=\"actions-row\">\r\n          <button mat-button (click)=\"edit(eavConstants.contentTypes.systemSettings, SystemSettingsScopes.App)\">\r\n            <mat-icon matBadgePosition=\"after\" matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n              [matBadge]=\"appSystemSettingsExists ? 1 : null\">\r\n              edit\r\n            </mat-icon>\r\n            <span>App System Settings</span>\r\n          </button>\r\n        </div>\r\n        <div class=\"actions-row\">\r\n          <button mat-button (click)=\"edit(eavConstants.contentTypes.systemSettings, SystemSettingsScopes.Site)\">\r\n            <mat-icon matBadgePosition=\"after\" matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n              [matBadge]=\"siteSystemSettingsExists ? 1 : null\">\r\n              edit\r\n            </mat-icon>\r\n            <span>Site System Settings</span>\r\n          </button>\r\n        </div>\r\n        <div class=\"actions-row\">\r\n          <button mat-button (click)=\"openGlobalSettings()\">\r\n            <mat-icon>open_in_new</mat-icon>\r\n            <span>Go to Global Settings</span>\r\n          </button>\r\n        </div>\r\n      </ng-container> -->\r\n      <!-- App System Settings on normal Apps -->\r\n      <!-- <ng-container *ngIf=\"dialogSettings.Context.App.SettingsScope === AppScopes.App\">\r\n        <div class=\"actions-row\">\r\n          <button mat-button (click)=\"edit(eavConstants.contentTypes.systemSettings, SystemSettingsScopes.App)\">\r\n            <mat-icon matBadgePosition=\"after\" matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n              [matBadge]=\"appSystemSettingsExists ? 1 : null\">\r\n              edit\r\n            </mat-icon>\r\n            <span>App System Settings</span>\r\n          </button>\r\n        </div>\r\n        <div class=\"actions-row\">\r\n          <button mat-button (click)=\"openSiteSettings()\">\r\n            <mat-icon>open_in_new</mat-icon>\r\n            <span>Go to Site Settings</span>\r\n          </button>\r\n        </div>\r\n        <div class=\"actions-row\">\r\n          <button mat-button (click)=\"openGlobalSettings()\">\r\n            <mat-icon>open_in_new</mat-icon>\r\n            <span>Go to Global Settings</span>\r\n          </button>\r\n        </div>\r\n      </ng-container> -->\r\n    </mat-card-actions>\r\n  </mat-card>\r\n\r\n  <mat-card class=\"mat-elevation-z2\">\r\n    <mat-card-header>\r\n      <mat-card-title>Language Resources (i18n)</mat-card-title>\r\n      <div class=\"mat-card-header-icon\">\r\n        <mat-icon>translate</mat-icon>\r\n      </div>\r\n    </mat-card-header>\r\n    <mat-card-content>\r\n      <p>\r\n        Resources are used for labels and things like that in the App.\r\n        They are usually needed to create multi-lingual views and such, and should not be used for App-Settings.\r\n        <a href=\"http://r.2sxc.org/settings\" target=\"_blank\">docs</a>\r\n      </p>\r\n\r\n      <table class=\"settings\">\r\n        <thead>\r\n          <tr>\r\n            <th></th>\r\n            <th>System Resources</th>\r\n            <th>Custom Resources</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <!-- Only show App Settings when not on Global -->\r\n          <tr *ngIf=\"dialogSettings.Context.App.SettingsScope !== AppScopes.Global\">\r\n            <th>{{ dialogSettings.Context.App.Name }}</th>\r\n            <td>\r\n              <button mat-button (click)=\"edit(eavConstants.contentTypes.systemResources, SystemSettingsScopes.App)\"\r\n                tippy=\"Edit app system resources\">\r\n                <mat-icon matBadgePosition=\"below after\" matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n                  [matBadge]=\"appSystemResourcesExists ? 1 : null\">\r\n                  edit\r\n                </mat-icon>\r\n              </button>\r\n            </td>\r\n            <td>\r\n              <button mat-button (click)=\"edit(eavConstants.contentTypes.resources)\" tippy=\"Edit custom app resources\">\r\n                <mat-icon>edit</mat-icon>\r\n              </button>\r\n              <button mat-button (click)=\"config(eavConstants.contentTypes.resources)\"\r\n                tippy=\"Configure fields of the custom app resources\">\r\n                <mat-icon>dns</mat-icon>\r\n              </button>\r\n            </td>\r\n          </tr>\r\n          <!-- Only show the Site Settings when we're not on Global -->\r\n          <tr *ngIf=\"dialogSettings.Context.App.SettingsScope !== AppScopes.Global\">\r\n            <th>Site</th>\r\n            <ng-container *ngIf=\"dialogSettings.Context.App.SettingsScope === AppScopes.Site; else elseGotoSite\">\r\n              <td>\r\n                <button mat-button (click)=\"edit(eavConstants.contentTypes.systemResources, SystemSettingsScopes.Site)\"\r\n                  tippy=\"Edit site system resources\">\r\n                  <mat-icon matBadgePosition=\"below after\" matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n                    [matBadge]=\"siteSystemResourcesExists ? 1 : null\">\r\n                    edit\r\n                  </mat-icon>\r\n                </button>\r\n              </td>\r\n              <td>\r\n                <mat-icon tippy=\"This isn't automated yet. Just create a ResourcesCustom yourself\">\r\n                  help_outline\r\n                </mat-icon>\r\n              </td>\r\n            </ng-container>\r\n          </tr>\r\n          <!-- Global Row - always show -->\r\n          <tr>\r\n            <th>Global</th>\r\n            <!-- Global System Settings should be shown on the Global Default App -->\r\n            <ng-container *ngIf=\"dialogSettings.Context.App.SettingsScope === AppScopes.Global; else elseGotoGlobal\">\r\n              <td>\r\n                <button mat-button (click)=\"edit(eavConstants.contentTypes.systemResources, SystemSettingsScopes.App)\"\r\n                  tippy=\"Edit global system resources\">\r\n                  <mat-icon matBadgePosition=\"below after\" matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n                    [matBadge]=\"appSystemResourcesExists ? 1 : null\">\r\n                    edit\r\n                  </mat-icon>\r\n                </button>\r\n              </td>\r\n              <td>\r\n                <mat-icon tippy=\"This isn't automated yet. Just create a ResourcesCustom yourself\">\r\n                  help_outline\r\n                </mat-icon>\r\n              </td>\r\n            </ng-container>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n    </mat-card-content>\r\n    <mat-card-actions>\r\n      <div class=\"actions-row\">\r\n        <button mat-button (click)=\"analyze(AnalyzeParts.Resources)\" tippy=\"See the result of combining all resources\">\r\n          <mat-icon>manage_search</mat-icon>\r\n          <span>Analyze Combined Resources</span>\r\n        </button>\r\n        <!-- <button mat-button (click)=\"edit(eavConstants.contentTypes.resources)\">\r\n          <mat-icon>edit</mat-icon>\r\n          <span>Edit</span>\r\n        </button>\r\n        <button mat-button (click)=\"config(eavConstants.contentTypes.resources)\">\r\n          <mat-icon>dns</mat-icon>\r\n          <span>Fields</span>\r\n        </button> -->\r\n      </div>\r\n      <!-- Global System Resources on Default App -->\r\n      <!-- <ng-container *ngIf=\"dialogSettings.Context.App.SettingsScope === AppScopes.Global\">\r\n        <div class=\"actions-row\">\r\n          <button mat-button (click)=\"edit(eavConstants.contentTypes.systemResources, SystemSettingsScopes.App)\">\r\n            <mat-icon matBadgePosition=\"after\" matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n              [matBadge]=\"appSystemResourcesExists ? 1 : null\">\r\n              edit\r\n            </mat-icon>\r\n            <span>Global System Resources</span>\r\n          </button>\r\n        </div>\r\n      </ng-container> -->\r\n      <!-- App and Site System Resources on Content App -->\r\n      <!-- <ng-container *ngIf=\"dialogSettings.Context.App.SettingsScope === AppScopes.Site\">\r\n        <div class=\"actions-row\">\r\n          <button mat-button (click)=\"edit(eavConstants.contentTypes.systemResources, SystemSettingsScopes.App)\">\r\n            <mat-icon matBadgePosition=\"after\" matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n              [matBadge]=\"appSystemResourcesExists ? 1 : null\">\r\n              edit\r\n            </mat-icon>\r\n            <span>App System Resources</span>\r\n          </button>\r\n        </div>\r\n        <div class=\"actions-row\">\r\n          <button mat-button (click)=\"edit(eavConstants.contentTypes.systemResources, SystemSettingsScopes.Site)\">\r\n            <mat-icon matBadgePosition=\"after\" matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n              [matBadge]=\"siteSystemResourcesExists ? 1 : null\">\r\n              edit\r\n            </mat-icon>\r\n            <span>Site System Resources</span>\r\n          </button>\r\n        </div>\r\n        <div class=\"actions-row\">\r\n          <button mat-button (click)=\"openGlobalSettings()\">\r\n            <mat-icon>open_in_new</mat-icon>\r\n            <span>Go to Global Resources</span>\r\n          </button>\r\n        </div>\r\n      </ng-container> -->\r\n      <!-- App System Resources on normal Apps -->\r\n      <!-- <ng-container *ngIf=\"dialogSettings.Context.App.SettingsScope === AppScopes.App\">\r\n        <div class=\"actions-row\">\r\n          <button mat-button (click)=\"edit(eavConstants.contentTypes.systemResources, SystemSettingsScopes.App)\">\r\n            <mat-icon matBadgePosition=\"after\" matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n              [matBadge]=\"appSystemResourcesExists ? 1 : null\">\r\n              edit\r\n            </mat-icon>\r\n            <span>App System Resources</span>\r\n          </button>\r\n        </div>\r\n        <div class=\"actions-row\">\r\n          <button mat-button (click)=\"openSiteSettings()\">\r\n            <mat-icon>open_in_new</mat-icon>\r\n            <span>Go to Site Resources</span>\r\n          </button>\r\n        </div>\r\n        <div class=\"actions-row\">\r\n          <button mat-button (click)=\"openGlobalSettings()\">\r\n            <mat-icon>open_in_new</mat-icon>\r\n            <span>Go to Global Resources</span>\r\n          </button>\r\n        </div>\r\n      </ng-container> -->\r\n    </mat-card-actions>\r\n  </mat-card>\r\n\r\n  <!-- Templates which are re-used in the table above -->\r\n  <ng-template #elseGotoSite>\r\n    <td>\r\n      <button mat-button (click)=\"openSiteSettings()\" tippy=\"Go to site\">\r\n        <mat-icon>open_in_new</mat-icon>\r\n      </button>\r\n    </td>\r\n  </ng-template>\r\n\r\n  <ng-template #elseGotoGlobal>\r\n    <td>\r\n      <button mat-button (click)=\"openGlobalSettings()\" tippy=\"Go to global\">\r\n        <mat-icon>open_in_new</mat-icon>\r\n      </button>\r\n    </td>\r\n  </ng-template>\r\n\r\n</div>\r\n\r\n<div class=\"cards-box\">\r\n  <mat-card class=\"mat-elevation-z2\">\r\n    <mat-card-header>\r\n      <mat-card-title>App Configuration</mat-card-title>\r\n      <div class=\"mat-card-header-icon\">\r\n        <mat-icon>redeem</mat-icon>\r\n      </div>\r\n    </mat-card-header>\r\n    <mat-card-content>\r\n      App name, folder, version and more.\r\n    </mat-card-content>\r\n    <mat-card-actions>\r\n      <button mat-button (click)=\"edit(eavConstants.scopes.app.value)\">\r\n        <mat-icon>edit</mat-icon>\r\n        <span>Edit Configuration</span>\r\n      </button>\r\n    </mat-card-actions>\r\n  </mat-card>\r\n\r\n  <mat-card class=\"mat-elevation-z2\">\r\n    <mat-card-header>\r\n      <mat-card-title>App Permissions</mat-card-title>\r\n      <div class=\"mat-card-header-icon\">\r\n        <mat-icon>person</mat-icon>\r\n      </div>\r\n    </mat-card-header>\r\n    <mat-card-content>\r\n      Give access to the entire app (all data). Use with care.\r\n    </mat-card-content>\r\n    <mat-card-actions>\r\n      <button mat-button [disabled]=\"!dialogSettings.Context.Enable.AppPermissions\" (click)=\"openPermissions()\">\r\n        <mat-icon matBadgePosition=\"below after\" matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n          [matBadge]=\"dialogSettings.Context.App.Permissions.Count ? dialogSettings.Context.App.Permissions.Count : null\">\r\n          person\r\n        </mat-icon>\r\n        <span>\r\n          Edit Permissions\r\n          {{ dialogSettings.Context.Enable.AppPermissions ? '' : '(not available on Content)' }}\r\n        </span>\r\n      </button>\r\n    </mat-card-actions>\r\n  </mat-card>\r\n</div>\r\n\r\n<div class=\"cards-box\">\r\n  <mat-card class=\"mat-elevation-z2\">\r\n    <mat-card-header>\r\n      <mat-card-title>Export this entire App</mat-card-title>\r\n      <div class=\"mat-card-header-icon\">\r\n        <mat-icon>cloud_download</mat-icon>\r\n      </div>\r\n    </mat-card-header>\r\n    <mat-card-content>\r\n      Create an package (zip) which can be installed in another site.\r\n    </mat-card-content>\r\n    <mat-card-actions>\r\n      <button mat-button (click)=\"exportApp()\">\r\n        <mat-icon>cloud_download</mat-icon>\r\n        <span>Export App</span>\r\n      </button>\r\n    </mat-card-actions>\r\n  </mat-card>\r\n\r\n  <mat-card class=\"mat-elevation-z2\">\r\n    <mat-card-header>\r\n      <mat-card-title>Export or Import parts of this App</mat-card-title>\r\n      <div class=\"mat-card-header-icon\">\r\n        <mat-icon>import_export</mat-icon>\r\n      </div>\r\n    </mat-card-header>\r\n    <mat-card-content>\r\n      Create an xml containing parts of the app, e.g. content and templates.\r\n      Import parts from such an xml into this app.\r\n    </mat-card-content>\r\n    <mat-card-actions>\r\n      <button mat-button (click)=\"exportParts()\">\r\n        <mat-icon>cloud_download</mat-icon>\r\n        <span>Export Parts</span>\r\n      </button>\r\n      <button mat-button (click)=\"importParts()\">\r\n        <mat-icon>cloud_upload</mat-icon>\r\n        <span>Import Parts</span>\r\n      </button>\r\n    </mat-card-actions>\r\n  </mat-card>\r\n</div>\r\n\r\n<div class=\"cards-box\">\r\n  <mat-card class=\"mat-elevation-z2\">\r\n    <mat-card-header>\r\n      <mat-card-title>App-State Versioning</mat-card-title>\r\n      <div class=\"mat-card-header-icon\">\r\n        <mat-icon>history_toggle_off</mat-icon>\r\n      </div>\r\n    </mat-card-header>\r\n    <mat-card-content>\r\n      You can save / restore the app with data and configuration in <code>.data/app.xml</code>.\r\n      This file can then also be versioned using git.\r\n    </mat-card-content>\r\n    <mat-card-actions>\r\n      <button mat-button (click)=\"exportAppXml()\">\r\n        <mat-icon>more_time</mat-icon>\r\n        <span>Save state</span>\r\n      </button>\r\n      <button mat-button (click)=\"resetApp()\">\r\n        <mat-icon>restore</mat-icon>\r\n        <span>Restore state</span>\r\n      </button>\r\n    </mat-card-actions>\r\n  </mat-card>\r\n</div>\r\n","import { HttpErrorResponse } from '@angular/common/http';\r\nimport { ChangeDetectorRef, Component, Input, OnDestroy, OnInit } from '@angular/core';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { ActivatedRoute, NavigationEnd, Router } from '@angular/router';\r\nimport { forkJoin, Subscription } from 'rxjs';\r\nimport { filter, map, pairwise, startWith } from 'rxjs/operators';\r\nimport { ContentItemsService } from '../../content-items/services/content-items.service';\r\nimport { GoToPermissions } from '../../permissions/go-to-permissions';\r\nimport { eavConstants, SystemSettingsScope, SystemSettingsScopes } from '../../shared/constants/eav.constants';\r\nimport { convertFormToUrl } from '../../shared/helpers/url-prep.helper';\r\nimport { AppScopes } from '../../shared/models/dialog-context.models';\r\nimport { EditForm } from '../../shared/models/edit-form.model';\r\nimport { Context } from '../../shared/services/context';\r\nimport { DialogService } from '../../shared/services/dialog.service';\r\nimport { DialogSettings } from '../models/dialog-settings.model';\r\nimport { ExportAppService } from '../services/export-app.service';\r\nimport { ImportAppPartsService } from '../services/import-app-parts.service';\r\nimport { AnalyzePart, AnalyzeParts } from '../sub-dialogs/analyze-settings/analyze-settings.models';\r\n\r\n@Component({\r\n  selector: 'app-app-configuration',\r\n  templateUrl: './app-configuration.component.html',\r\n  styleUrls: ['./app-configuration.component.scss'],\r\n})\r\nexport class AppConfigurationComponent implements OnInit, OnDestroy {\r\n  @Input() dialogSettings: DialogSettings;\r\n  eavConstants = eavConstants;\r\n  AnalyzeParts = AnalyzeParts;\r\n  SystemSettingsScopes = SystemSettingsScopes;\r\n  AppScopes = AppScopes;\r\n  appSystemSettingsExists: boolean;\r\n  siteSystemSettingsExists: boolean;\r\n  appSystemResourcesExists: boolean;\r\n  siteSystemResourcesExists: boolean;\r\n\r\n  private subscription: Subscription;\r\n\r\n  constructor(\r\n    private contentItemsService: ContentItemsService,\r\n    private router: Router,\r\n    private route: ActivatedRoute,\r\n    private context: Context,\r\n    private exportAppService: ExportAppService,\r\n    private importAppPartsService: ImportAppPartsService,\r\n    private snackBar: MatSnackBar,\r\n    private dialogService: DialogService,\r\n    private changeDetectorRef: ChangeDetectorRef,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.subscription = new Subscription();\r\n    this.fetchSystemSettings();\r\n    this.refreshOnChildClosed();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.snackBar.dismiss();\r\n    this.subscription.unsubscribe();\r\n  }\r\n\r\n  edit(staticName: string, systemSettingsScope?: SystemSettingsScope) {\r\n    this.contentItemsService.getAll(staticName).subscribe(contentItems => {\r\n      let form: EditForm;\r\n\r\n      switch (staticName) {\r\n        case eavConstants.contentTypes.systemSettings:\r\n        case eavConstants.contentTypes.systemResources:\r\n          const settingsEntity = contentItems.find(i => systemSettingsScope === SystemSettingsScopes.App\r\n            ? !i.SettingsEntityScope\r\n            : i.SettingsEntityScope === SystemSettingsScopes.Site);\r\n          form = {\r\n            items: [\r\n              settingsEntity == null\r\n                ? {\r\n                  ContentTypeName: staticName,\r\n                  Prefill: {\r\n                    ...(systemSettingsScope === SystemSettingsScopes.Site && { SettingsEntityScope: SystemSettingsScopes.Site }),\r\n                  }\r\n                }\r\n                : { EntityId: settingsEntity.Id }\r\n            ],\r\n          };\r\n          break;\r\n        default:\r\n          if (contentItems.length !== 1) {\r\n            throw new Error(`Found too many settings for the type ${staticName}`);\r\n          }\r\n          form = {\r\n            items: [{ EntityId: contentItems[0].Id }],\r\n          };\r\n      }\r\n\r\n      const formUrl = convertFormToUrl(form);\r\n      this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route.firstChild });\r\n    });\r\n  }\r\n\r\n  openSiteSettings() {\r\n    const siteDefaultApp = this.dialogSettings.Context.Site.DefaultApp;\r\n    this.dialogService.openAppAdministration(siteDefaultApp.ZoneId, siteDefaultApp.AppId, 'app');\r\n  }\r\n\r\n  openGlobalSettings() {\r\n    const globalDefaultApp = this.dialogSettings.Context.System.DefaultApp;\r\n    this.dialogService.openAppAdministration(globalDefaultApp.ZoneId, globalDefaultApp.AppId, 'app');\r\n  }\r\n\r\n  config(staticName: string) {\r\n    this.router.navigate([`fields/${staticName}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  openPermissions() {\r\n    this.router.navigate([GoToPermissions.goApp(this.context.appId)], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  exportApp() {\r\n    this.router.navigate([`export`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  exportParts() {\r\n    this.router.navigate([`export/parts`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  importParts() {\r\n    this.router.navigate([`import/parts`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  exportAppXml() {\r\n    this.snackBar.open('Exporting...');\r\n    this.exportAppService.exportForVersionControl(true, false).subscribe({\r\n      next: result => {\r\n        this.snackBar.open('Export done. Please check your \\'.data\\' folder', null, { duration: 3000 });\r\n      },\r\n      error: (error: HttpErrorResponse) => {\r\n        this.snackBar.open('Export failed. Please check console for more information', null, { duration: 3000 });\r\n      },\r\n    });\r\n  }\r\n\r\n  resetApp() {\r\n    if (!confirm('Are you sure? All changes since last xml export will be lost')) { return; }\r\n    this.snackBar.open('Resetting...');\r\n    this.importAppPartsService.resetApp().subscribe({\r\n      next: result => {\r\n        this.snackBar.open(\r\n          'Reset worked! Since this is a complex operation, please restart the Website to ensure all caches are correct',\r\n          null,\r\n          { duration: 30000 },\r\n        );\r\n      },\r\n      error: (error: HttpErrorResponse) => {\r\n        this.snackBar.open('Reset failed. Please check console for more information', null, { duration: 3000 });\r\n      },\r\n    });\r\n  }\r\n\r\n  analyze(part: AnalyzePart) {\r\n    this.router.navigate([`analyze/${part}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private fetchSystemSettings() {\r\n    forkJoin([\r\n      this.contentItemsService.getAll(eavConstants.contentTypes.systemSettings),\r\n      this.contentItemsService.getAll(eavConstants.contentTypes.systemResources),\r\n    ]).subscribe(([systemSettingsItems, systemResourcesItems]) => {\r\n      this.appSystemSettingsExists = systemSettingsItems.some(i => !i.SettingsEntityScope);\r\n      this.siteSystemSettingsExists = systemSettingsItems.some(i => i.SettingsEntityScope === SystemSettingsScopes.Site);\r\n      this.appSystemResourcesExists = systemResourcesItems.some(i => !i.SettingsEntityScope);\r\n      this.siteSystemResourcesExists = systemResourcesItems.some(i => i.SettingsEntityScope === SystemSettingsScopes.Site);\r\n\r\n      this.changeDetectorRef.markForCheck();\r\n    });\r\n  }\r\n\r\n  private refreshOnChildClosed() {\r\n    this.subscription.add(\r\n      this.router.events.pipe(\r\n        filter(event => event instanceof NavigationEnd),\r\n        startWith(!!this.route.snapshot.firstChild.firstChild),\r\n        map(() => !!this.route.snapshot.firstChild.firstChild),\r\n        pairwise(),\r\n        filter(([hadChild, hasChild]) => hadChild && !hasChild),\r\n      ).subscribe(() => {\r\n        this.fetchSystemSettings();\r\n      })\r\n    );\r\n  }\r\n}\r\n","<div class=\"nav-component-wrapper\" appToggleDebug *ngIf=\"(templateVars$ | async) as data\">\r\n  <div mat-dialog-title>\r\n    <div class=\"dialog-title-box\">\r\n      <div>\r\n        <ng-container *ngIf=\"data.dialogSettings?.Context.App.SettingsScope === AppScopes.Global\">\r\n          Global\r\n        </ng-container>\r\n        <ng-container *ngIf=\"data.dialogSettings?.Context.App.SettingsScope !== AppScopes.Global\">\r\n          {{ data.dialogSettings?.Context.App.Name }}\r\n        </ng-container>\r\n        Admin\r\n      </div>\r\n      <button mat-icon-button tippy=\"Close dialog\" (click)=\"closeDialog()\">\r\n        <mat-icon>close</mat-icon>\r\n      </button>\r\n    </div>\r\n  </div>\r\n\r\n  <router-outlet></router-outlet>\r\n\r\n  <!-- spm NOTE: we use mat-tab-group because mat-tab-nav-bar doesn't have animations and doesn't look pretty -->\r\n  <mat-tab-group class=\"mat-tab-group-max-height\" dynamicHeight color=\"accent\"\r\n    *ngIf=\"data.dialogSettings && data.tabIndex != null\" (selectedTabChange)=\"changeTab($event)\"\r\n    [selectedIndex]=\"data.tabIndex\">\r\n    <mat-tab>\r\n      <div *matTabLabel class=\"mat-tab-label-box\" tippy=\"App Info\">\r\n        <mat-icon>info</mat-icon>\r\n        <span>Info</span>\r\n      </div>\r\n      <app-getting-started *matTabContent [gettingStartedUrl]=\"data.dialogSettings.Context.App.GettingStartedUrl\">\r\n      </app-getting-started>\r\n    </mat-tab>\r\n\r\n    <mat-tab>\r\n      <div *matTabLabel class=\"mat-tab-label-box\" tippy=\"Data / Content\">\r\n        <mat-icon>menu</mat-icon>\r\n        <span>Data</span>\r\n      </div>\r\n      <app-data *matTabContent [enablePermissions]=\"data.dialogSettings.Context.Enable.AppPermissions\"></app-data>\r\n    </mat-tab>\r\n\r\n    <mat-tab *ngIf=\"data.dialogSettings.Context.Enable.Query\">\r\n      <div *matTabLabel class=\"mat-tab-label-box\" tippy=\"Queries / Visual Query Designer\">\r\n        <mat-icon>filter_list</mat-icon>\r\n        <span>Queries</span>\r\n      </div>\r\n      <app-queries *matTabContent [enablePermissions]=\"data.dialogSettings.Context.Enable.AppPermissions\">\r\n      </app-queries>\r\n    </mat-tab>\r\n\r\n    <mat-tab>\r\n      <div *matTabLabel class=\"mat-tab-label-box\" tippy=\"Views / Templates\">\r\n        <mat-icon>layers</mat-icon>\r\n        <span>Views</span>\r\n      </div>\r\n      <app-views *matTabContent [enableCode]=\"data.dialogSettings.Context.Enable.CodeEditor\"\r\n        [enablePermissions]=\"data.dialogSettings.Context.Enable.AppPermissions\">\r\n      </app-views>\r\n    </mat-tab>\r\n\r\n    <mat-tab *ngIf=\"data.dialogSettings.Context.Enable.Query\">\r\n      <div *matTabLabel class=\"mat-tab-label-box\" tippy=\"WebApi\">\r\n        <mat-icon>offline_bolt</mat-icon>\r\n        <span>WebApi</span>\r\n      </div>\r\n      <app-web-api *matTabContent [enableCode]=\"data.dialogSettings.Context.Enable.CodeEditor\">\r\n      </app-web-api>\r\n    </mat-tab>\r\n\r\n    <mat-tab>\r\n      <div *matTabLabel class=\"mat-tab-label-box\" tippy=\"App Settings\">\r\n        <mat-icon>settings_applications</mat-icon>\r\n        <span>App</span>\r\n      </div>\r\n      <app-app-configuration *matTabContent [dialogSettings]=\"data.dialogSettings\">\r\n      </app-app-configuration>\r\n    </mat-tab>\r\n  </mat-tab-group>\r\n</div>\r\n","import { Component, OnDestroy, OnInit } from '@angular/core';\r\nimport { MatDialogRef } from '@angular/material/dialog';\r\nimport { MatTabChangeEvent } from '@angular/material/tabs';\r\nimport { ActivatedRoute, NavigationEnd, Router } from '@angular/router';\r\nimport { BehaviorSubject, combineLatest, Subscription } from 'rxjs';\r\nimport { filter, map, pairwise, startWith } from 'rxjs/operators';\r\nimport { eavConstants } from '../../shared/constants/eav.constants';\r\nimport { UpdateEnvVarsFromDialogSettings } from '../../shared/helpers/update-env-vars-from-dialog-settings.helper';\r\nimport { AppScopes } from '../../shared/models/dialog-context.models';\r\nimport { DialogSettings } from '../models/dialog-settings.model';\r\nimport { AppDialogConfigService } from '../services/app-dialog-config.service';\r\n\r\n@Component({\r\n  selector: 'app-app-administration-nav',\r\n  templateUrl: './app-administration-nav.component.html',\r\n  styleUrls: ['./app-administration-nav.component.scss'],\r\n})\r\nexport class AppAdministrationNavComponent implements OnInit, OnDestroy {\r\n  AppScopes = AppScopes;\r\n\r\n  private defaultScope = eavConstants.scopes.default.value;\r\n  private dialogSettings$ = new BehaviorSubject<DialogSettings>(null);\r\n  private tabs$ = new BehaviorSubject<string[]>(null);\r\n  private tabIndex$ = combineLatest([\r\n    this.tabs$,\r\n    this.router.events.pipe(\r\n      filter(event => event instanceof NavigationEnd),\r\n      map(() => this.route.snapshot.firstChild.url[0].path),\r\n      startWith(this.route.snapshot.firstChild.url[0].path),\r\n    )\r\n  ]).pipe(\r\n    map(([tabs, path]) => {\r\n      if (tabs == null) { return; }\r\n      const tabIndex = tabs.indexOf(path);\r\n      return tabIndex;\r\n    })\r\n  );\r\n  templateVars$ = combineLatest([this.dialogSettings$, this.tabIndex$]).pipe(\r\n    map(([dialogSettings, tabIndex]) => ({ dialogSettings, tabIndex })),\r\n  );\r\n\r\n  private subscription = new Subscription();\r\n\r\n  constructor(\r\n    private dialogRef: MatDialogRef<AppAdministrationNavComponent>,\r\n    private appDialogConfigService: AppDialogConfigService,\r\n    private router: Router,\r\n    private route: ActivatedRoute,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.fetchDialogSettings();\r\n    this.refreshOnChildClosed();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.dialogSettings$.complete();\r\n    this.tabs$.complete();\r\n    this.subscription.unsubscribe();\r\n  }\r\n\r\n  closeDialog() {\r\n    this.dialogRef.close();\r\n  }\r\n\r\n  changeTab(event: MatTabChangeEvent) {\r\n    let path = this.tabs$.value[event.index];\r\n    if (path === 'data') {\r\n      path = `data/${this.defaultScope}`;\r\n    }\r\n    this.router.navigate([path], { relativeTo: this.route });\r\n  }\r\n\r\n  private fetchDialogSettings() {\r\n    this.appDialogConfigService.getDialogSettings().subscribe(dialogSettings => {\r\n      UpdateEnvVarsFromDialogSettings(dialogSettings.Context.App);\r\n      this.dialogSettings$.next(dialogSettings);\r\n\r\n      let tabs = ['home', 'data', 'queries', 'views', 'web-api', 'app']; // tabs order has to match template\r\n      if (!dialogSettings.Context.Enable.Query) {\r\n        tabs = tabs.filter(tab => tab !== 'queries' && tab !== 'web-api');\r\n      }\r\n      this.tabs$.next(tabs);\r\n    });\r\n  }\r\n\r\n  private refreshOnChildClosed() {\r\n    this.subscription.add(\r\n      this.router.events.pipe(\r\n        filter(event => event instanceof NavigationEnd),\r\n        startWith(!!this.route.snapshot.firstChild.firstChild),\r\n        map(() => !!this.route.snapshot.firstChild.firstChild),\r\n        pairwise(),\r\n        filter(([hadChild, hasChild]) => hadChild && !hasChild),\r\n      ).subscribe(() => {\r\n        this.fetchDialogSettings();\r\n      })\r\n    );\r\n  }\r\n}\r\n","export const defaultControllerName = 'MyController.cs';\r\nexport const defaultTemplateName = '_MyFile.cshtml';\r\nexport const defaultTokenName = 'MyFile.html';\r\n","/**\r\n * Do not reuse regex:\r\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/test#using_test_on_a_regex_with_the_global_flag\r\n */\r\nexport function guidRegex(): RegExp {\r\n  return /^[a-f0-9]{8}(?:-[a-f0-9]{4}){3}-[a-f0-9]{12}$/i;\r\n}\r\n","import { Directive, HostListener } from '@angular/core';\r\n\r\n@Directive({ selector: '[appClickStopPropagation]' })\r\nexport class ClickStopPropagationDirective {\r\n  @HostListener('click', ['$event'])\r\n  onClick(event: MouseEvent): void {\r\n    event.stopPropagation();\r\n  }\r\n}\r\n","import { Directive, HostListener } from '@angular/core';\r\nimport { GlobalConfigService } from '../../../../../edit/shared/store/ngrx-data';\r\n\r\n@Directive({ selector: '[appToggleDebug]' })\r\nexport class ToggleDebugDirective {\r\n\r\n  constructor(private globalConfigService: GlobalConfigService) { }\r\n\r\n  @HostListener('click', ['$event'])\r\n  onClick(event: MouseEvent): void {\r\n    const CTRL_SHIFT_ALT_CLICK = (navigator.platform.match('Mac') ? event.metaKey : event.ctrlKey) && event.shiftKey && event.altKey;\r\n    if (CTRL_SHIFT_ALT_CLICK) {\r\n      this.globalConfigService.toggleDebugEnabled();\r\n      window.getSelection().removeAllRanges();\r\n    }\r\n  }\r\n}\r\n"],"sourceRoot":"webpack:///"}