(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_ng-dialogs_src_app_content-items_content-items_component_ts"],{6582:function(t,e,n){"use strict";n.r(e),n.d(e,{ContentItemsComponent:function(){return gt}});var o=n(4762),i=n(9206),r=n(1282),a=n(8512),l=n(7570),s=n(3835),u=n(611),c=n(6238),p=n(9996),d=n(2855),f=n(3667),m=n(7867),g=n(6085),h=n(8579),y=n(5803),T=n(5549),v=n(9081),b=n(2420),Z=n(1785),C=n(7064),k=n(7512),A=n(7307),x=n(7070),I=function(){function t(){}return t.prototype.agInit=function(t){this.params=t,this.item=t.data},t.prototype.refresh=function(t){return!0},t.prototype.clone=function(){this.params.onClone(this.item)},t.prototype.export=function(){this.params.onExport(this.item)},t.prototype.deleteItem=function(){this.params.onDelete(this.item)},t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Z.Xpm({type:t,selectors:[["app-content-items-actions"]],decls:17,vars:1,consts:[[1,"actions-component"],["matRipple","","tippy","Copy",1,"like-button","highlight",3,"click"],["matRipple","","tippy","Export",1,"like-button","highlight",3,"click"],["matRipple","","tippy","More",1,"like-button","highlight",3,"matMenuTriggerFor"],[1,"grid-more-menu"],["menu","matMenu"],["mat-menu-item","",3,"click"]],template:function(t,e){if(1&t&&(Z.TgZ(0,"div",0),Z.TgZ(1,"div",1),Z.NdJ("click",function(){return e.clone()}),Z.TgZ(2,"mat-icon"),Z._uU(3,"file_copy"),Z.qZA(),Z.qZA(),Z.TgZ(4,"div",2),Z.NdJ("click",function(){return e.export()}),Z.TgZ(5,"mat-icon"),Z._uU(6,"cloud_download"),Z.qZA(),Z.qZA(),Z.TgZ(7,"div",3),Z.TgZ(8,"mat-icon"),Z._uU(9,"more_horiz"),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(10,"mat-menu",4,5),Z.TgZ(12,"button",6),Z.NdJ("click",function(){return e.deleteItem()}),Z.TgZ(13,"mat-icon"),Z._uU(14,"delete"),Z.qZA(),Z.TgZ(15,"span"),Z._uU(16,"Delete"),Z.qZA(),Z.qZA(),Z.qZA()),2&t){var n=Z.MAs(11);Z.xp6(7),Z.Q6J("matMenuTriggerFor",n)}},directives:[C.wG,k.$,A.Hw,x.p6,x.VK,x.OP],styles:[""]}),t}(),_=n(1116);function q(t,e){if(1&t&&(Z.TgZ(0,"span",2),Z._uU(1),Z.qZA()),2&t){var n=Z.oxw();Z.xp6(1),Z.Oqu(n.entities)}}var N=function(){function t(){}return t.prototype.agInit=function(t){Array.isArray(t.value)&&(this.encodedValue=this.htmlEncode(t.value.join(", ")),t.colDef.allowMultiValue&&(this.entities=t.value.length))},t.prototype.refresh=function(t){return!0},t.prototype.htmlEncode=function(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Z.Xpm({type:t,selectors:[["app-content-items-entity"]],decls:3,vars:3,consts:[[3,"tippy"],["class","more-entities",4,"ngIf"],[1,"more-entities"]],template:function(t,e){1&t&&(Z.TgZ(0,"div",0),Z.YNc(1,q,2,1,"span",1),Z._uU(2),Z.qZA()),2&t&&(Z.Q6J("tippy",e.encodedValue),Z.xp6(1),Z.Q6J("ngIf",e.entities),Z.xp6(1),Z.hij(" ",e.encodedValue,"\n"))},directives:[k.$,_.O5],styles:[".more-entities[_ngcontent-%COMP%]{padding:0 8px;border-radius:10px;border:1px solid rgba(29,39,61,.44);-webkit-user-select:none;user-select:none}"]}),t}();function w(t,e){1&t&&(Z.TgZ(0,"mat-icon",4),Z._uU(1,"visibility"),Z.qZA())}function U(t,e){1&t&&(Z.TgZ(0,"mat-icon",5),Z._uU(1,"visibility_off"),Z.qZA())}function J(t,e){if(1&t&&(Z.TgZ(0,"mat-icon",6),Z._uU(1,"local_offer"),Z.qZA()),2&t){var n=Z.oxw();Z.Q6J("tippy",n.metadataTooltip)}}var S=function(){function t(){}return t.prototype.agInit=function(t){this.value=t.value;var e=t.data;e.For&&(this.metadataTooltip="Metadata\nType: "+e.For.Target+(e.For.Number?"\nNumber: "+e.For.Number:"")+(e.For.String?"\nString: "+e.For.String:"")+(e.For.Guid?"\nGuid: "+e.For.Guid:""))},t.prototype.refresh=function(t){return!0},t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Z.Xpm({type:t,selectors:[["app-content-items-status"]],decls:4,vars:3,consts:[[1,"icon-container"],["tippy","Published",4,"ngIf"],["tippy","Not published",4,"ngIf"],["class","meta-icon",3,"tippy",4,"ngIf"],["tippy","Published"],["tippy","Not published"],[1,"meta-icon",3,"tippy"]],template:function(t,e){1&t&&(Z.TgZ(0,"div",0),Z.YNc(1,w,2,0,"mat-icon",1),Z.YNc(2,U,2,0,"mat-icon",2),Z.YNc(3,J,2,1,"mat-icon",3),Z.qZA()),2&t&&(Z.xp6(1),Z.Q6J("ngIf",e.value.published),Z.xp6(1),Z.Q6J("ngIf",!e.value.published),Z.xp6(1),Z.Q6J("ngIf",e.value.metadata))},directives:[_.O5,A.Hw,k.$],styles:[".meta-icon[_ngcontent-%COMP%]{margin-left:8px}"]}),t}(),M=n(7436),D=n(1041),F=function(){function t(){this.published="",this.metadata=""}return t.prototype.agInit=function(t){this.params=t},t.prototype.isFilterActive=function(){return""!==this.published||""!==this.metadata},t.prototype.doesFilterPass=function(t){var e,n,o=this.params.valueGetter(t.node);return e=""===this.published||null!=o.published&&o.published.toString()===this.published,n=""===this.metadata||null!=o.metadata&&o.metadata.toString()===this.metadata,e&&n},t.prototype.getModel=function(){if(this.isFilterActive())return{filterType:"pub-meta",published:this.published,metadata:this.metadata}},t.prototype.setModel=function(t){this.published=t?t.published:"",this.metadata=t?t.metadata:""},t.prototype.afterGuiAttached=function(t){},t.prototype.filterChanged=function(){this.params.filterChangedCallback()},t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Z.Xpm({type:t,selectors:[["app-pub-meta-filter"]],decls:18,vars:2,consts:[[1,"title"],[3,"ngModel","ngModelChange"],["value",""],["value","true"],["value","false"]],template:function(t,e){1&t&&(Z.TgZ(0,"div",0),Z._uU(1,"Published"),Z.qZA(),Z.TgZ(2,"mat-radio-group",1),Z.NdJ("ngModelChange",function(t){return e.published=t})("ngModelChange",function(){return e.filterChanged()}),Z.TgZ(3,"mat-radio-button",2),Z._uU(4,"All"),Z.qZA(),Z.TgZ(5,"mat-radio-button",3),Z._uU(6,"Published"),Z.qZA(),Z.TgZ(7,"mat-radio-button",4),Z._uU(8,"Not published"),Z.qZA(),Z.qZA(),Z.TgZ(9,"div",0),Z._uU(10,"Metadata"),Z.qZA(),Z.TgZ(11,"mat-radio-group",1),Z.NdJ("ngModelChange",function(t){return e.metadata=t})("ngModelChange",function(){return e.filterChanged()}),Z.TgZ(12,"mat-radio-button",2),Z._uU(13,"All"),Z.qZA(),Z.TgZ(14,"mat-radio-button",3),Z._uU(15,"Is metadata"),Z.qZA(),Z.TgZ(16,"mat-radio-button",4),Z._uU(17,"Is not metadata"),Z.qZA(),Z.qZA()),2&t&&(Z.xp6(2),Z.Q6J("ngModel",e.published),Z.xp6(9),Z.Q6J("ngModel",e.metadata))},directives:[M.VQ,D.JJ,D.On,M.U0],styles:[".title[_ngcontent-%COMP%]{padding:12px 12px 0}.mat-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;overflow:hidden;padding:12px;width:160px;height:104px}"]}),t}(),O=n(2935),Q=n(3070),E=n(4369),P=n(1271),Y=n(3841),R=n(9550),G=n(7110);function $(t,e){if(1&t&&(Z.TgZ(0,"mat-option",19),Z._uU(1),Z.qZA()),2&t){var n=e.$implicit;Z.Q6J("value",n.type),Z.xp6(1),Z.hij(" ",n.target," ")}}function j(t,e){if(1&t&&(Z.TgZ(0,"mat-option",19),Z._uU(1),Z.qZA()),2&t){var n=Z.oxw(2);Z.Q6J("value",n.form.controls.targetType.value),Z.xp6(1),Z.hij(" ",n.form.controls.targetType.value," ")}}function B(t,e){if(1&t&&(Z.TgZ(0,"mat-select",17),Z.YNc(1,$,2,2,"mat-option",11),Z.YNc(2,j,2,2,"mat-option",18),Z.qZA()),2&t){var n=Z.oxw();Z.xp6(1),Z.Q6J("ngForOf",n.targetTypeOptions),Z.xp6(1),Z.Q6J("ngIf",!n.knownTargetTypes.includes(n.form.controls.targetType.value))}}function H(t,e){1&t&&Z._UZ(0,"input",20)}function X(t,e){1&t&&(Z.TgZ(0,"app-field-hint",21),Z._uU(1," This field is required "),Z.qZA()),2&t&&Z.Q6J("isError",!0)}function L(t,e){1&t&&(Z.TgZ(0,"app-field-hint",21),Z._uU(1," Warning: you entered an unknown target type. This may work or may not. Please be sure you know what you're doing "),Z.qZA()),2&t&&Z.Q6J("isError",!1)}function V(t,e){if(1&t&&(Z.TgZ(0,"mat-option",19),Z._uU(1),Z.qZA()),2&t){var n=e.$implicit;Z.Q6J("value",n),Z.xp6(1),Z.hij(" ",n," ")}}function W(t,e){1&t&&(Z.TgZ(0,"app-field-hint",21),Z._uU(1," This field is required "),Z.qZA()),2&t&&Z.Q6J("isError",!0)}function z(t,e){1&t&&Z._UZ(0,"input",22)}function K(t,e){1&t&&Z._UZ(0,"input",23)}function tt(t,e){1&t&&(Z.TgZ(0,"app-field-hint",21),Z._uU(1," This field is required "),Z.qZA()),2&t&&Z.Q6J("isError",!0)}function et(t,e){1&t&&(Z.TgZ(0,"app-field-hint",21),Z._uU(1," Key type and key don't match "),Z.qZA()),2&t&&Z.Q6J("isError",!0)}var nt=function(){function t(t){this.dialogRef=t,this.hostClass="dialog-component",this.eavConstants=y.Z,this.freeTextTargetType=!1}return t.prototype.ngOnInit=function(){var t;this.form=new D.cw({}),this.form.addControl("targetType",new D.NI(y.Z.metadata.entity.type,[D.kI.required])),this.form.addControl("keyType",new D.NI(y.Z.keyTypes.number,[D.kI.required])),this.form.addControl("key",new D.NI(null,[D.kI.required,(t=this.form,function(e){var n=t.controls.keyType.value;return"number"===n&&"number"!=typeof e.value||"number"!==n&&"string"!=typeof e.value?{mismatch:!0}:null})])),this.targetTypeOptions=Object.values(y.Z.metadata).map(function(t){return(0,o.pi)({},t)}),this.knownTargetTypes=this.targetTypeOptions.map(function(t){return t.type}),this.keyTypeOptions=Object.values(y.Z.keyTypes)},t.prototype.closeDialog=function(t){this.dialogRef.close(t)},t.prototype.confirm=function(){var t,e,n=this.form.getRawValue(),o={target:null!==(e=null===(t=this.targetTypeOptions.find(function(t){return t.type===n.targetType}))||void 0===t?void 0:t.target)&&void 0!==e?e:n.targetType.toString(),keyType:n.keyType,key:n.key.toString()};this.closeDialog(o)},t.\u0275fac=function(e){return new(e||t)(Z.Y36(O.so))},t.\u0275cmp=Z.Xpm({type:t,selectors:[["app-create-metadata-dialog"]],hostVars:1,hostBindings:function(t,e){2&t&&Z.Ikx("className",e.hostClass)},decls:35,vars:12,consts:[["mat-dialog-title",""],[1,"dialog-title-box"],[1,"dialog-description"],[1,"dialog-form",3,"formGroup"],[1,"dialog-form-content","fancy-scrollbar-light"],["appearance","standard","color","accent"],["formControlName","targetType",4,"ngIf"],["matInput","","type","number","min","0","formControlName","targetType",4,"ngIf"],["mat-icon-button","","matSuffix","","tippy","FreeText TargetType","appClickStopPropagation","",3,"click"],[3,"isError",4,"ngIf"],["formControlName","keyType"],[3,"value",4,"ngFor","ngForOf"],["matInput","","type","text","formControlName","key",4,"ngIf"],["matInput","","type","number","formControlName","key",4,"ngIf"],[1,"dialog-form-actions"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click"],["formControlName","targetType"],[3,"value",4,"ngIf"],[3,"value"],["matInput","","type","number","min","0","formControlName","targetType"],[3,"isError"],["matInput","","type","text","formControlName","key"],["matInput","","type","number","formControlName","key"]],template:function(t,e){1&t&&(Z.TgZ(0,"div",0),Z.TgZ(1,"div",1),Z._uU(2,"Create Metadata Info"),Z.qZA(),Z.qZA(),Z.TgZ(3,"p",2),Z._uU(4," This is a special operation to add an item which is metadata for another item.\n"),Z.qZA(),Z.TgZ(5,"form",3),Z.TgZ(6,"div",4),Z.TgZ(7,"mat-form-field",5),Z.TgZ(8,"mat-label"),Z._uU(9,"What kind of assignment do you want?"),Z.qZA(),Z.YNc(10,B,3,2,"mat-select",6),Z.YNc(11,H,1,0,"input",7),Z.TgZ(12,"button",8),Z.NdJ("click",function(){return e.freeTextTargetType=!e.freeTextTargetType}),Z.TgZ(13,"mat-icon"),Z._uU(14,"text_fields"),Z.qZA(),Z.qZA(),Z.qZA(),Z.YNc(15,X,2,1,"app-field-hint",9),Z.YNc(16,L,2,1,"app-field-hint",9),Z.TgZ(17,"mat-form-field",5),Z.TgZ(18,"mat-label"),Z._uU(19,"What key type do you want?"),Z.qZA(),Z.TgZ(20,"mat-select",10),Z.YNc(21,V,2,2,"mat-option",11),Z.qZA(),Z.qZA(),Z.YNc(22,W,2,1,"app-field-hint",9),Z.TgZ(23,"mat-form-field",5),Z.TgZ(24,"mat-label"),Z._uU(25,"What key do you want?"),Z.qZA(),Z.YNc(26,z,1,0,"input",12),Z.YNc(27,K,1,0,"input",13),Z.qZA(),Z.YNc(28,tt,2,1,"app-field-hint",9),Z.YNc(29,et,2,1,"app-field-hint",9),Z.qZA(),Z.TgZ(30,"div",14),Z.TgZ(31,"button",15),Z.NdJ("click",function(){return e.closeDialog()}),Z._uU(32,"Cancel"),Z.qZA(),Z.TgZ(33,"button",16),Z.NdJ("click",function(){return e.confirm()}),Z._uU(34,"Confirm"),Z.qZA(),Z.qZA(),Z.qZA()),2&t&&(Z.xp6(5),Z.Q6J("formGroup",e.form),Z.xp6(5),Z.Q6J("ngIf",!e.freeTextTargetType),Z.xp6(1),Z.Q6J("ngIf",e.freeTextTargetType),Z.xp6(4),Z.Q6J("ngIf",e.form.controls.targetType.touched&&(null==e.form.controls.targetType.errors?null:e.form.controls.targetType.errors.required)),Z.xp6(1),Z.Q6J("ngIf",e.form.controls.targetType.touched&&!e.form.controls.targetType.invalid&&!e.knownTargetTypes.includes(e.form.controls.targetType.value)),Z.xp6(5),Z.Q6J("ngForOf",e.keyTypeOptions),Z.xp6(1),Z.Q6J("ngIf",e.form.controls.keyType.touched&&(null==e.form.controls.keyType.errors?null:e.form.controls.keyType.errors.required)),Z.xp6(4),Z.Q6J("ngIf","number"!==e.form.controls.keyType.value),Z.xp6(1),Z.Q6J("ngIf","number"===e.form.controls.keyType.value),Z.xp6(1),Z.Q6J("ngIf",e.form.controls.key.touched&&(null==e.form.controls.key.errors?null:e.form.controls.key.errors.required)),Z.xp6(1),Z.Q6J("ngIf",e.form.controls.key.touched&&!(null!=e.form.controls.key.errors&&e.form.controls.key.errors.required)&&(null==e.form.controls.key.errors?null:e.form.controls.key.errors.mismatch)),Z.xp6(4),Z.Q6J("disabled",!e.form.valid))},directives:[O.uh,D._Y,D.JL,D.sg,Q.KE,Q.hX,_.O5,E.lW,Q.R9,k.$,P.E,A.Hw,Y.gD,D.JJ,D.u,_.sg,C.ey,R.Nt,D.qQ,D.wV,D.Fj,G.Y],styles:[".dialog-form-content[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]:not(:first-of-type){margin-top:8px}"]}),t}(),ot=n(2832),it=n(5223),rt=n(7553),at=n(3653),lt=n(3589),st=n(9886),ut=n(6146),ct=n(9825),pt=n(5921),dt=n(6207);function ft(t,e){1&t&&(Z._UZ(0,"div",14),Z.ALo(1,"safeHtml")),2&t&&Z.Q6J("innerHTML",Z.lcZ(1,1,e.ngIf),Z.oJD)}function mt(t,e){if(1&t){var n=Z.EpF();Z.TgZ(0,"button",15),Z.NdJ("click",function(){return Z.CHM(n),Z.oxw().debugFilter()}),Z.TgZ(1,"mat-icon"),Z._uU(2,"filter_list"),Z.qZA(),Z.TgZ(3,"span"),Z._uU(4,"Filter"),Z.qZA(),Z.qZA()}}var gt=function(){function t(t,e,n,r,s,u,c,p,d,f,y,T){this.dialogRef=t,this.contentTypesService=e,this.router=n,this.route=r,this.contentItemsService=s,this.entitiesService=u,this.contentExportService=c,this.snackBar=p,this.globalConfigService=d,this.dialog=f,this.viewContainerRef=y,this.changeDetectorRef=T,this.contentType$=new a.X(null),this.items$=new a.X(null),this.debugEnabled$=this.globalConfigService.getDebugEnabled$(),this.modules=i.F$,this.gridOptions=(0,o.pi)((0,o.pi)({},h.f),{frameworkComponents:{pubMetaFilterComponent:F,booleanFilterComponent:m.U,idFieldComponent:g.m,contentItemsStatusComponent:S,contentItemsActionsComponent:I,contentItemsEntityComponent:N}}),this.gridApi$=new a.X(null),this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName"),this.subscription=new l.w}return t.prototype.ngOnInit=function(){this.fetchContentType(),this.fetchItems(),this.fetchColumns(),this.refreshOnChildClosed()},t.prototype.ngOnDestroy=function(){this.contentType$.complete(),this.items$.complete(),this.gridApi$.complete(),this.subscription.unsubscribe()},t.prototype.closeDialog=function(){this.dialogRef.close()},t.prototype.onGridReady=function(t){this.gridApi$.next(t.api)},t.prototype.fetchContentType=function(){var t=this;this.contentTypesService.retrieveContentType(this.contentTypeStaticName).subscribe(function(e){t.contentType$.next(e)})},t.prototype.fetchItems=function(){var t=this;this.contentItemsService.getAll(this.contentTypeStaticName).subscribe(function(e){t.items$.next(e)})},t.prototype.fetchColumns=function(){var t=this;this.contentItemsService.getColumns(this.contentTypeStaticName).subscribe(function(e){var n=t.buildColumnDefs(e),i=function(t){var e,n;if(t){var i;"="===t.charAt(t.length-1)&&(t=atob(t));try{i=JSON.parse(t)}catch(d){console.error("Can't parse JSON with filters from url:",t)}if(i){var r={};(i.IsPublished||i.IsMetadata)&&(r.Status=p={filterType:"pub-meta",published:i.IsPublished?i.IsPublished:"",metadata:i.IsMetadata?i.IsMetadata:""});var a=Object.keys(i);try{for(var l=(0,o.XA)(a),s=l.next();!s.done;s=l.next()){var u=s.value;if("IsPublished"!==u&&"IsMetadata"!==u){var c=i[u];if("string"==typeof c)r[u]=p={filterType:"text",type:"equals",filter:c};else if("number"==typeof c)r[u]=p={filterType:"number",type:"equals",filter:c,filterTo:null};else if("boolean"==typeof c){var p={filterType:"boolean",filter:c.toString()};r[u]=p}}}}catch(f){e={error:f}}finally{try{s&&!s.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}return r}}}(sessionStorage.getItem(T.JA));t.gridApi$.value?t.setColumnDefs(n,i):t.gridApi$.pipe((0,s.h)(function(t){return null!=t}),(0,u.q)(1)).subscribe(function(e){t.setColumnDefs(n,i)})})},t.prototype.setColumnDefs=function(t,e){this.gridApi$.value.setColumnDefs(t),e&&((0,v.P)("Will try to apply filter:",e),this.gridApi$.value.setFilterModel(e))},t.prototype.editItem=function(t){var e=null==t?void 0:t.data,n=(0,b.f)({items:[null==e?{ContentTypeName:this.contentTypeStaticName}:{EntityId:e.Id}]});this.router.navigate(["edit/"+n],{relativeTo:this.route})},t.prototype.exportContent=function(){var t=this.gridApi$.value.getFilterModel(),e=Object.keys(t).length>0,n=[];e&&this.gridApi$.value.forEachNodeAfterFilterAndSort(function(t){n.push(t.data.Id)}),this.router.navigate(["export/"+this.contentTypeStaticName+(n.length>0?"/"+n:"")],{relativeTo:this.route})},t.prototype.filesDropped=function(t){var e=t[0];switch(e.name.substring(e.name.lastIndexOf(".")+1).toLocaleLowerCase()){case"xml":this.importContent(t);break;case"json":this.importItem(t)}},t.prototype.importContent=function(t){this.router.navigate([this.contentTypeStaticName+"/import"],{relativeTo:this.route,state:{files:t}})},t.prototype.importItem=function(t){this.router.navigate(["import"],{relativeTo:this.route,state:{files:t}})},t.prototype.addMetadata=function(){var t=this;this.dialog.open(nt,{autoFocus:!1,viewContainerRef:this.viewContainerRef,width:"650px"}).afterClosed().pipe((0,u.q)(1)).subscribe(function(e){if(null!=e){var n={items:[{ContentTypeName:t.contentTypeStaticName,For:(0,o.pi)((0,o.pi)((0,o.pi)({Target:e.target},e.keyType===y.Z.keyTypes.guid&&{Guid:e.key}),e.keyType===y.Z.keyTypes.number&&{Number:parseInt(e.key,10)}),e.keyType===y.Z.keyTypes.string&&{String:e.key})}]},i=(0,b.f)(n);t.router.navigate(["edit/"+i],{relativeTo:t.route}),t.changeDetectorRef.markForCheck()}})},t.prototype.debugFilter=function(){console.warn("Current filter:",this.gridApi$.value.getFilterModel()),alert("Check console for filter information")},t.prototype.refreshOnChildClosed=function(){var t=this;this.subscription.add(this.router.events.pipe((0,s.h)(function(t){return t instanceof r.m2}),(0,c.O)(!!this.route.snapshot.firstChild),(0,p.U)(function(){return!!t.route.snapshot.firstChild}),(0,d.G)(),(0,s.h)(function(t){var e=(0,o.CR)(t,2);return e[0]&&!e[1]})).subscribe(function(){t.fetchItems()}))},t.prototype.buildColumnDefs=function(t){var e,n,i=[{headerName:"ID",field:"Id",width:70,headerClass:"dense",cellClass:"id-action no-padding no-outline",cellRenderer:"idFieldComponent",sortable:!0,filter:"agTextColumnFilter",cellRendererParams:{tooltipGetter:function(t){return"ID: "+t.Id+"\nRepoID: "+t._RepositoryId+"\nGUID: "+t.Guid}}},{headerName:"Status",field:"Status",width:80,headerClass:"dense",cellClass:"no-outline",filter:"pubMetaFilterComponent",cellRenderer:"contentItemsStatusComponent",valueGetter:this.valueGetterStatus},{headerName:"Item (Entity)",field:"_Title",flex:2,minWidth:250,cellClass:"primary-action highlight",sortable:!0,filter:"agTextColumnFilter",onCellClicked:this.editItem.bind(this)},{headerName:"Stats",headerTooltip:"Used by others / uses others",field:"_Used",width:70,headerClass:"dense",cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:this.valueGetterUsage},{cellClass:"secondary-action no-padding",width:120,cellRenderer:"contentItemsActionsComponent",pinned:"right",cellRendererParams:{onClone:this.clone.bind(this),onExport:this.export.bind(this),onDelete:this.delete.bind(this)}}];try{for(var r=(0,o.XA)(t),a=r.next();!a.done;a=r.next()){var l=a.value,s={headerName:l.StaticName,field:l.StaticName,flex:2,minWidth:250,cellClass:"no-outline",sortable:!0};switch(l.Type){case f.Q.Entity:try{s.allowMultiValue=l.Metadata.Entity.AllowMultiValue}catch(u){s.allowMultiValue=!0}s.cellRenderer="contentItemsEntityComponent",s.valueGetter=this.valueGetterEntityField,s.filter="agTextColumnFilter";break;case f.Q.DateTime:try{s.useTimePicker=l.Metadata.DateTime.UseTimePicker}catch(u){s.useTimePicker=!1}s.valueGetter=this.valueGetterDateTime,s.filter="agTextColumnFilter";break;case f.Q.Boolean:s.valueGetter=this.valueGetterBoolean,s.filter="booleanFilterComponent";break;case f.Q.Number:s.filter="agNumberColumnFilter";break;default:s.filter="agTextColumnFilter"}i.push(s)}}catch(c){e={error:c}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return i},t.prototype.clone=function(t){var e=(0,b.f)({items:[{ContentTypeName:this.contentTypeStaticName,DuplicateEntity:t.Id}]});this.router.navigate(["edit/"+e],{relativeTo:this.route})},t.prototype.export=function(t){this.contentExportService.exportEntity(t.Id,this.contentTypeStaticName,!0)},t.prototype.delete=function(t){var e=this;confirm("Delete '"+t._Title+"' ("+t._RepositoryId+")?")&&(this.snackBar.open("Deleting..."),this.entitiesService.delete(this.contentTypeStaticName,t._RepositoryId,!1).subscribe({next:function(){e.snackBar.open("Deleted",null,{duration:2e3}),e.fetchItems()},error:function(n){e.snackBar.dismiss(),confirm(n.error.ExceptionMessage+"\n\nDo you want to force delete '"+t._Title+"' ("+t._RepositoryId+")?")&&(e.snackBar.open("Deleting..."),e.entitiesService.delete(e.contentTypeStaticName,t._RepositoryId,!0).subscribe(function(){e.snackBar.open("Deleted",null,{duration:2e3}),e.fetchItems()}))}}))},t.prototype.valueGetterStatus=function(t){var e=t.data;return{published:e.IsPublished,metadata:!!e.For}},t.prototype.valueGetterUsage=function(t){var e=t.data;return e._Used+" / "+e._Uses},t.prototype.valueGetterEntityField=function(t){var e=t.data[t.colDef.field];return 0===e.length?null:e.map(function(t){return t.Title})},t.prototype.valueGetterDateTime=function(t){var e=t.data[t.colDef.field];return e?t.colDef.useTimePicker?e.substring(0,19).replace("T"," "):e.substring(0,10):null},t.prototype.valueGetterBoolean=function(t){var e=t.data[t.colDef.field];return"boolean"!=typeof e?null:e.toString()},t.\u0275fac=function(e){return new(e||t)(Z.Y36(O.so),Z.Y36(ot.s),Z.Y36(r.F0),Z.Y36(r.gz),Z.Y36(it.l),Z.Y36(rt.g),Z.Y36(at.i),Z.Y36(lt.ux),Z.Y36(st.bE),Z.Y36(O.uw),Z.Y36(Z.s_b),Z.Y36(Z.sBO))},t.\u0275cmp=Z.Xpm({type:t,selectors:[["app-content-items"]],decls:41,vars:15,consts:[["appToggleDebug","",1,"nav-component-wrapper"],["mat-dialog-title",""],[1,"dialog-title-box"],["mat-icon-button","","tippy","Close dialog",3,"click"],[3,"innerHTML",4,"ngIf"],[1,"grid-wrapper"],["appDragAndDrop","",1,"ag-theme-material",3,"rowData","modules","gridOptions","allowedFileTypes","gridReady","filesDropped"],[1,"grid-more-actions-box"],["mat-button","","tippy","Export xml list",3,"click"],["mat-button","","tippy","Import xml list",3,"click"],["mat-button","","tippy","Import single json item",3,"click"],["mat-button","","tippy","Add metadata to entity",3,"click"],["mat-button","","color","accent","tippy","Print filter to console",3,"click",4,"ngIf"],["mat-fab","","mat-elevation-z24","","tippy","Add item",1,"grid-fab",3,"click"],[3,"innerHTML"],["mat-button","","color","accent","tippy","Print filter to console",3,"click"]],template:function(t,e){var n,o;1&t&&(Z.TgZ(0,"div",0),Z.TgZ(1,"div",1),Z.TgZ(2,"div",2),Z.TgZ(3,"div"),Z._uU(4),Z.ALo(5,"async"),Z.qZA(),Z.TgZ(6,"button",3),Z.NdJ("click",function(){return e.closeDialog()}),Z.TgZ(7,"mat-icon"),Z._uU(8,"close"),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z._UZ(9,"router-outlet"),Z.YNc(10,ft,2,3,"div",4),Z.ALo(11,"async"),Z.TgZ(12,"div",5),Z.TgZ(13,"ag-grid-angular",6),Z.NdJ("gridReady",function(t){return e.onGridReady(t)})("filesDropped",function(t){return e.filesDropped(t)}),Z.ALo(14,"async"),Z.qZA(),Z.TgZ(15,"div",7),Z.TgZ(16,"button",8),Z.NdJ("click",function(){return e.exportContent()}),Z.TgZ(17,"mat-icon"),Z._uU(18,"cloud_download"),Z.qZA(),Z.TgZ(19,"span"),Z._uU(20,"Data"),Z.qZA(),Z.qZA(),Z.TgZ(21,"button",9),Z.NdJ("click",function(){return e.importContent()}),Z.TgZ(22,"mat-icon"),Z._uU(23,"cloud_upload"),Z.qZA(),Z.TgZ(24,"span"),Z._uU(25,"Data"),Z.qZA(),Z.qZA(),Z.TgZ(26,"button",10),Z.NdJ("click",function(){return e.importItem()}),Z.TgZ(27,"mat-icon"),Z._uU(28,"cloud_upload"),Z.qZA(),Z.TgZ(29,"span"),Z._uU(30,"Item"),Z.qZA(),Z.qZA(),Z.TgZ(31,"button",11),Z.NdJ("click",function(){return e.addMetadata()}),Z.TgZ(32,"mat-icon"),Z._uU(33,"local_offer"),Z.qZA(),Z.TgZ(34,"span"),Z._uU(35,"Metadata"),Z.qZA(),Z.qZA(),Z.YNc(36,mt,5,0,"button",12),Z.ALo(37,"async"),Z.qZA(),Z.TgZ(38,"button",13),Z.NdJ("click",function(){return e.editItem(null)}),Z.TgZ(39,"mat-icon"),Z._uU(40,"add"),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA()),2&t&&(Z.xp6(4),Z.hij("",null==(n=Z.lcZ(5,7,e.contentType$))?null:n.Name," Data"),Z.xp6(6),Z.Q6J("ngIf",null==(o=Z.lcZ(11,9,e.contentType$))||null==o.Metadata?null:o.Metadata.ListInstructions),Z.xp6(3),Z.Q6J("rowData",Z.lcZ(14,11,e.items$))("modules",e.modules)("gridOptions",e.gridOptions)("allowedFileTypes","xml,json"),Z.xp6(23),Z.Q6J("ngIf",Z.lcZ(37,13,e.debugEnabled$)))},directives:[ut.D,O.uh,E.lW,k.$,A.Hw,r.lC,_.O5,ct.N8,pt.z],pipes:[_.Ov,dt.z],styles:[""]}),t}()},6085:function(t,e,n){"use strict";n.d(e,{m:function(){return u}});var o=n(8838),i=n(1785),r=n(3589),a=n(7064),l=n(7512),s=n(7307),u=function(){function t(t){this.snackBar=t}return t.prototype.agInit=function(t){this.id=t.value,this.tooltip=t.tooltipGetter(t.data)},t.prototype.refresh=function(t){return!0},t.prototype.copy=function(){(0,o.v)(this.tooltip),this.snackBar.open("Copied to clipboard",null,{duration:2e3})},t.\u0275fac=function(e){return new(e||t)(i.Y36(r.ux))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-id-field"]],decls:5,vars:2,consts:[["matRipple","",1,"id-box","highlight",3,"tippy","click"],[1,"id"],[1,"icon"]],template:function(t,e){1&t&&(i.TgZ(0,"div",0),i.NdJ("click",function(){return e.copy()}),i.TgZ(1,"span",1),i._uU(2),i.qZA(),i.TgZ(3,"mat-icon",2),i._uU(4,"file_copy"),i.qZA(),i.qZA()),2&t&&(i.Q6J("tippy",e.tooltip),i.xp6(2),i.Oqu(e.id))},directives:[a.wG,l.$,s.Hw],styles:[".id-box[_ngcontent-%COMP%]{padding:0 8px;text-align:end;height:100%;display:flex;align-items:center;justify-content:flex-end}.id-box[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{max-width:100%;text-overflow:ellipsis;overflow:hidden}.id-box[_ngcontent-%COMP%]:hover{text-decoration:none}.id-box[_ngcontent-%COMP%]:hover   .id[_ngcontent-%COMP%], .id-box[_ngcontent-%COMP%]:not(:hover)   .icon[_ngcontent-%COMP%]{display:none}"]}),t}()},1271:function(t,e,n){"use strict";n.d(e,{E:function(){return i}});var o=n(1785),i=function(){function t(){}return t.prototype.onClick=function(t){t.stopPropagation()},t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=o.lG2({type:t,selectors:[["","appClickStopPropagation",""]],hostBindings:function(t,e){1&t&&o.NdJ("click",function(t){return e.onClick(t)})}}),t}()},6146:function(t,e,n){"use strict";n.d(e,{D:function(){return r}});var o=n(1785),i=n(9886),r=function(){function t(t){this.globalConfigService=t}return t.prototype.onClick=function(t){(navigator.platform.match("Mac")?t.metaKey:t.ctrlKey)&&t.shiftKey&&t.altKey&&(this.globalConfigService.toggleDebugEnabled(),window.getSelection().removeAllRanges())},t.\u0275fac=function(e){return new(e||t)(o.Y36(i.bE))},t.\u0275dir=o.lG2({type:t,selectors:[["","appToggleDebug",""]],hostBindings:function(t,e){1&t&&o.NdJ("click",function(t){return e.onClick(t)})}}),t}()},8838:function(t,e,n){"use strict";function o(t){var e=document.createElement("textarea");e.value=t,e.setAttribute("readonly",""),e.style.position="absolute",e.style.left="-9999px",document.body.appendChild(e);var n=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);e.select(),document.execCommand("copy"),document.body.removeChild(e),n&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(n))}n.d(e,{v:function(){return o}})},6207:function(t,e,n){"use strict";n.d(e,{z:function(){return r}});var o=n(1785),i=n(9624),r=function(){function t(t){this.sanitizer=t}return t.prototype.transform=function(t){return this.sanitizer.bypassSecurityTrustHtml(t)},t.\u0275fac=function(e){return new(e||t)(o.Y36(i.H7,16))},t.\u0275pipe=o.Yjl({name:"safeHtml",type:t,pure:!0}),t}()}}]);
//# sourceMappingURL=https://sources.2sxc.org/12.04.00/ng-edit/projects_ng-dialogs_src_app_content-items_content-items_component_ts.e240f75c0b1019c17c71.js.map