"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_app-administration_web-api_web-api_component_ts"],{27592:(E,A,e)=>{e.r(A),e.d(A,{WebApiComponent:()=>S});var l=e(44444),g=e(84175),i=e(81863),u=e(93840),c=e(31034),b=e(29658),y=e(12938),O=e(79996),C=e(76068),P=e(72871),h=e(11828),d=e(60251),p=e(67037),f=e(71693),v=e(82838),F=e(64699),T=e(89061),x=e(10261),M=e(34601),t=e(99293),R=e(29968);function _(r,W){if(1&r){const n=t.RV6();t.j41(0,"div",7),t.bIt("click",function(){l.eBV(n);const a=t.XpG();return l.Njj(a.openCode())}),t.j41(1,"mat-icon"),t.EFF(2,"code"),t.k0s()()}}function j(r,W){1&r&&(t.j41(0,"div",3)(1,"mat-icon"),t.EFF(2,"code"),t.k0s()())}function G(r,W){if(1&r){const n=t.RV6();t.j41(0,"button",8),t.bIt("click",function(){l.eBV(n);const a=t.XpG();return l.Njj(a.openRestApi())}),t.nrm(1,"mat-icon",9),t.j41(2,"span"),t.EFF(3,"REST API"),t.k0s()()}}let B=(()=>{class r{constructor(n,o){this.router=n,this.route=o}agInit(n){this.params=n,this.enableCode=this.params.enableCodeGetter()}refresh(n){return!0}openCode(){this.params.onOpenCode(this.params.data)}openRestApi(){const n=this.params.data,o=this.router.url.split("/");o[o.length-1]=x.N.routeWebApi,o.push(encodeURIComponent(n.path));const a=o.join("/");this.router.navigate([a])}static#e=this.\u0275fac=function(o){return new(o||r)(t.rXU(b.Ix),t.rXU(b.nX))};static#t=this.\u0275cmp=t.VBU({type:r,selectors:[["app-web-api-actions"]],decls:9,vars:3,consts:[["menu","matMenu"],[1,"actions-component"],["matRipple","","tippy","Code",1,"eav-grid-action-button","highlight"],[1,"eav-grid-action-button","disabled"],["matRipple","","tippy","More",1,"eav-grid-action-button","highlight",3,"matMenuTriggerFor"],[1,"grid-more-menu"],["matMenuContent",""],["matRipple","","tippy","Code",1,"eav-grid-action-button","highlight",3,"click"],["mat-menu-item","",3,"click"],["svgIcon","code-curly"]],template:function(o,a){if(1&o&&(t.j41(0,"div",1),t.nVh(1,_,3,0,"div",2),t.nVh(2,j,3,0,"div",3),t.j41(3,"div",4)(4,"mat-icon"),t.EFF(5,"more_horiz"),t.k0s()()(),t.j41(6,"mat-menu",5,0),t.DNE(8,G,4,0,"ng-template",6),t.k0s()),2&o){const s=t.sdS(7);t.R7$(),t.vxM(a.enableCode?1:-1),t.R7$(),t.vxM(a.enableCode?-1:2),t.R7$(),t.Y8G("matMenuTriggerFor",s)}},dependencies:[T.M,R.M,u.m_,u.An,c.Cn,c.kk,c.fb,c.z8,c.Cp,M.e],encapsulation:2})}return r})();var H=e(3347),D=e(29841);function I(r,W){if(1&r&&t.nrm(0,"ag-grid-angular",2),2&r){const n=t.XpG();t.Y8G("rowData",n.webApis())("gridOptions",n.gridOptions)}}let S=(()=>{class r{#e;#t;#n;constructor(n,o,a){this.snackBar=n,this.matDialog=o,this.viewContainerRef=a,this.#e=(0,y.d)(f.d),this.#t=(0,y.d)(O.F),this.refresh=(0,l.vPA)(0),this.webApis=this.#t.getWebApisLive(this.refresh),this.gridOptions=this.buildGridOptions(),this.dialogConfigSvc=(0,y.d)(F.L),this.#n={empty:{description:"<p><b>This is where you manage Web APIs</b><br>They are custom C# code which do anything you want.</p>",hint:"<p>WebApi Controllers are listed automatically. <br>Click the (+) in the bottom right corner to create your first Web API from a template file.</p>"},content:{description:"<p><b>This is where you manage Web APIs</b><br>They are custom C# code which do anything you want.</p>",hint:""}},this.uxHelpText=(0,l.vPA)(this.#n.empty)}ngOnInit(){this.dialogConfigSvc.getCurrent$().subscribe(n=>{this.enableCode=n.Context.Enable.CodeEditor})}createController(n){this.matDialog.open(C.g,{autoFocus:!1,data:{folder:"api",global:n,purpose:"Api"},viewContainerRef:this.viewContainerRef,width:"650px"}).afterClosed().subscribe(s=>{if(s){if(s.name.endsWith("Controller.cs")){const m=s.name.substring(s.name.lastIndexOf("/")+1);if(!/^[A-Z][a-zA-Z0-9]*Controller\.cs$/g.test(m))return void this.snackBar.open(`"${m}" is invalid controller name. Should be something like "MyController.cs"`,null,{duration:5e3})}this.snackBar.open("Saving..."),this.#t.create(s.name,n,s.templateKey).subscribe(()=>{this.snackBar.open("Saved",null,{duration:2e3}),this.refresh.update(m=>++m),this.uxHelpText.set(0===this.webApis().length?this.#n.empty:this.#n.content)})}})}enableCodeGetter(){return this.enableCode}openCode(n){this.#e.openCodeFile(n.path,n.isShared)}buildGridOptions(){return{...d.C,columnDefs:[{...h.r.ItemsText,headerName:"Endpoint",field:"endpointPath",flex:2,minWidth:250},{...h.r.TextWideMin100,headerName:"Edition",field:"edition",sort:"asc"},{...h.r.TextWideMin100,headerName:"Forder2",field:"folder",sort:"asc"},{...h.r.TextWide,headerName:"Name",field:"name"},{...h.r.Boolean2,headerName:"Compiled",field:"isCompiled",cellRenderer:P.J},{...h.r.ActionsPinnedRight6,cellRenderer:B,cellRendererParams:{enableCodeGetter:()=>this.enableCodeGetter(),onOpenCode:a=>this.openCode(a)}}]}}static#i=this.\u0275fac=function(o){return new(o||r)(t.rXU(H.UG),t.rXU(i.h),t.rXU(t.c1b))};static#o=this.\u0275cmp=t.VBU({type:r,selectors:[["app-web-api"]],decls:15,vars:5,consts:[["menu","matMenu"],[3,"helpText","refresh","rowLength"],[1,"ag-theme-material","grid-dynamic",3,"rowData","gridOptions"],["align","end"],["mat-fab","","mat-elevation-z24","","tippy","Create a new controller","tippyPlacement","left",1,"grid-fab",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"]],template:function(o,a){if(1&o){const s=t.RV6();t.j41(0,"app-grid-with-help",1),t.nVh(1,I,1,2,"ag-grid-angular",2),t.j41(2,"mat-dialog-actions",3)(3,"button",4)(4,"mat-icon"),t.EFF(5,"add"),t.k0s()(),t.j41(6,"mat-menu",null,0)(8,"button",5),t.bIt("click",function(){return l.eBV(s),l.Njj(a.createController(!1))}),t.j41(9,"span"),t.EFF(10,"App"),t.k0s()(),t.j41(11,"button",5),t.bIt("click",function(){return l.eBV(s),l.Njj(a.createController(!0))}),t.j41(12,"span"),t.EFF(13,"Shared (global)"),t.k0s()()()()(),t.nrm(14,"router-outlet")}if(2&o){let s,m;const w=t.sdS(7);t.Y8G("helpText",a.uxHelpText())("refresh",a.refresh())("rowLength",null==(s=a.webApis())?null:s.length),t.R7$(),t.vxM(null!=(m=a.webApis())&&m.length?1:-1),t.R7$(2),t.Y8G("matMenuTriggerFor",w)}},dependencies:[p.p,D.xs,i.M,g.Hl,g.Sr,c.Cn,c.kk,c.fb,c.Cp,u.m_,u.An,b.n3,v.v],encapsulation:2})}return r})()},82838:(E,A,e)=>{e.d(A,{v:()=>O});var l=e(29841),g=e(37580),i=e(99293),u=e(64173),c=e(81863);const b=[[["ag-grid-angular"]],[["mat-dialog-actions"]]],y=["ag-grid-angular","mat-dialog-actions"];let O=(()=>{class C{constructor(){this.agGrid=(0,g.sbv)(l.xs,{read:i.aKT}),this.dialogAction=(0,g.sbv)(c.M,{read:i.aKT}),this.helpText=g.hFB.required({}),this.refresh=g.hFB.required(),this.rowLength=g.hFB.required(),(0,u.QZ)(()=>{this.refresh();const d=this.rowLength();(0,u.O8)(()=>{const p=this.agGrid()?.nativeElement,f=this.dialogAction()?.nativeElement,v=document.querySelector(".help-info-card");v?.classList.toggle("center-center",0===d);const F=document.querySelector(".grid-wrapper-dynamic")?.clientHeight??0;if(!p||!f)return;const T=p.querySelector(".ag-row")?.clientHeight??47,x=64+d*T,M=(v.clientHeight??0)+24,t=(f.clientHeight??0)+11;console.debug("helpCardHeight",M),p.style.height=T?`${x}px`:"0px",v.style.flex="1 1 auto";const R=M+x+t>F;v?.classList.toggle("hidden-help-info-card",R)})})}static#e=this.\u0275fac=function(d){return new(d||C)};static#t=this.\u0275cmp=i.VBU({type:C,selectors:[["app-grid-with-help"]],contentQueries:function(d,p,f){1&d&&(i.C6U(f,p.agGrid,l.xs,5,i.aKT),i.C6U(f,p.dialogAction,c.M,5,i.aKT)),2&d&&i.NyB(2)},inputs:{helpText:[1,"helpText"],refresh:[1,"refresh"],rowLength:[1,"rowLength"]},ngContentSelectors:y,decls:7,vars:2,consts:[[1,"grid-wrapper-dynamic"],[1,"help-info-card"],[1,"help-info-card-text"],[3,"innerHTML"]],template:function(d,p){1&d&&(i.NAR(b),i.j41(0,"div",0),i.SdG(1),i.j41(2,"div",1)(3,"div",2),i.nrm(4,"span",3)(5,"span",3),i.k0s()(),i.SdG(6,1),i.k0s()),2&d&&(i.R7$(4),i.Y8G("innerHTML",p.helpText().description,i.npT),i.R7$(),i.Y8G("innerHTML",p.helpText().hint,i.npT))},styles:[".grid-wrapper-dynamic[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.grid-wrapper-dynamic[_ngcontent-%COMP%]     .grid-dynamic{max-height:calc(100% - 73px)}.grid-wrapper-dynamic[_ngcontent-%COMP%]     .ag-theme-material.grid-dynamic{flex-shrink:0;flex-grow:0}.grid-wrapper-dynamic[_ngcontent-%COMP%]     .hidden-help-info-card{visibility:hidden!important;position:absolute!important}.grid-wrapper-dynamic[_ngcontent-%COMP%]     mat-dialog-actions{flex-shrink:0;margin-top:auto}.grid-wrapper-dynamic[_ngcontent-%COMP%]     mat-dialog-actions .eav-scope-dropdown{margin-top:-14px;width:350px}.help-info-card[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.help-info-card[_ngcontent-%COMP%]   .help-info-card-text[_ngcontent-%COMP%]{text-align:center;color:gray;width:30vw;max-width:400px;min-width:180px}.center-center[_ngcontent-%COMP%]{flex:1 1 auto}"]})}return C})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/20.00.01/dist/ng-edit/projects_eav-ui_src_app_app-administration_web-api_web-api_component_ts.c12770992a706124.js.map