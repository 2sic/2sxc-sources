{"version":3,"file":"projects_eav-ui_src_app_replace-content_replace-content_component_ts.js","mappings":"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","sources":["./projects/eav-ui/src/app/replace-content/replace-content.component.ts","./projects/eav-ui/src/app/replace-content/replace-content.component.html","./projects/eav-ui/src/app/shared/components/base-with-child-dialog.component.ts"],"sourcesContent":["import { Component, HostBinding, OnDestroy, OnInit } from '@angular/core';\r\nimport { MatAutocompleteSelectedEvent, MatAutocompleteModule } from '@angular/material/autocomplete';\r\nimport { MatDialogRef, MatDialogActions } from '@angular/material/dialog';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { ActivatedRoute, Router, RouterOutlet } from '@angular/router';\r\nimport { BehaviorSubject, combineLatest, map, Observable } from 'rxjs';\r\nimport { ContentGroupAdd } from '../manage-content-list/models/content-group.model';\r\nimport { ContentGroupService } from '../manage-content-list/services/content-group.service';\r\nimport { BaseWithChildDialogComponent } from '../shared/components/base-with-child-dialog.component';\r\nimport { convertFormToUrl } from '../shared/helpers/url-prep.helper';\r\nimport { EditForm } from '../shared/models/edit-form.model';\r\nimport { ReplaceOption } from './models/replace-option.model';\r\nimport { ReplaceContentViewModel } from './replace-content.models';\r\nimport { AsyncPipe } from '@angular/common';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatOptionModule } from '@angular/material/core';\r\nimport { CdkVirtualScrollViewport, CdkFixedSizeVirtualScroll, CdkVirtualForOf } from '@angular/cdk/scrolling';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { MatInputModule } from '@angular/material/input';\r\nimport { MatFormFieldModule } from '@angular/material/form-field';\r\n\r\n@Component({\r\n  selector: 'app-replace-content',\r\n  templateUrl: './replace-content.component.html',\r\n  styleUrls: ['./replace-content.component.scss'],\r\n  standalone: true,\r\n  imports: [\r\n    RouterOutlet,\r\n    MatFormFieldModule,\r\n    MatInputModule,\r\n    MatAutocompleteModule,\r\n    FormsModule,\r\n    CdkVirtualScrollViewport,\r\n    CdkFixedSizeVirtualScroll,\r\n    CdkVirtualForOf,\r\n    MatOptionModule,\r\n    MatButtonModule,\r\n    MatIconModule,\r\n    MatDialogActions,\r\n    AsyncPipe,\r\n  ],\r\n  providers: [\r\n    ContentGroupService,\r\n  ],\r\n})\r\nexport class ReplaceContentComponent extends BaseWithChildDialogComponent implements OnInit, OnDestroy {\r\n  @HostBinding('className') hostClass = 'dialog-component';\r\n\r\n  viewModel$: Observable<ReplaceContentViewModel>;\r\n\r\n  private guid: string;\r\n  private part: string;\r\n  private index: number;\r\n  private add: boolean;\r\n  private filterText$: BehaviorSubject<string>;\r\n  private options$: BehaviorSubject<ReplaceOption[]>;\r\n  private contentTypeName: string;\r\n\r\n  constructor(\r\n    protected router: Router,\r\n    protected route: ActivatedRoute,\r\n    private dialogRef: MatDialogRef<ReplaceContentComponent>,\r\n    private contentGroupService: ContentGroupService,\r\n\r\n    private snackBar: MatSnackBar,\r\n  ) {\r\n    super(router, route);\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.guid = this.route.snapshot.paramMap.get('guid');\r\n    this.part = this.route.snapshot.paramMap.get('part');\r\n    this.index = parseInt(this.route.snapshot.paramMap.get('index'), 10);\r\n    this.add = !!this.route.snapshot.queryParamMap.get('add');\r\n\r\n    this.filterText$ = new BehaviorSubject('');\r\n    this.options$ = new BehaviorSubject([]);\r\n\r\n    const filteredOptions$ = combineLatest([this.filterText$, this.options$]).pipe(\r\n      map(([filterText, options]) =>\r\n        options.filter(option => option.label.toLocaleLowerCase().includes(filterText.toLocaleLowerCase())).map(option => option.label)\r\n      ),\r\n    );\r\n    this.viewModel$ = combineLatest([this.filterText$, filteredOptions$]).pipe(\r\n      map(([filterText, filteredOptions]) => {\r\n        const viewModel: ReplaceContentViewModel = {\r\n          filterText,\r\n          filteredOptions,\r\n          isAddMode: this.add,\r\n          isMatch: filteredOptions.includes(filterText),\r\n        };\r\n        return viewModel;\r\n      }),\r\n    );\r\n\r\n    this.fetchConfig(false, null);\r\n    this.subscriptions.add(this.childDialogClosed$().subscribe(() => {\r\n      const navigation = this.router.getCurrentNavigation();\r\n      const editResult = navigation.extras?.state;\r\n      const cloneId: number = editResult?.[Object.keys(editResult)[0]];\r\n      this.fetchConfig(true, cloneId);\r\n    }));\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.filterText$.complete();\r\n    this.options$.complete();\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  closeDialog() {\r\n    this.dialogRef.close();\r\n  }\r\n\r\n  setFilter(filterText: string) {\r\n    this.filterText$.next(filterText);\r\n  }\r\n\r\n  select(event: MatAutocompleteSelectedEvent) {\r\n    this.filterText$.next(event.option.value);\r\n  }\r\n\r\n  copySelected() {\r\n    const contentGroup = this.buildContentGroup();\r\n    const form: EditForm = {\r\n      items: [{ ContentTypeName: this.contentTypeName, DuplicateEntity: contentGroup.id }],\r\n    };\r\n    const formUrl = convertFormToUrl(form);\r\n    this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route });\r\n  }\r\n\r\n  save() {\r\n    this.snackBar.open('Saving...');\r\n    const contentGroup = this.buildContentGroup();\r\n    this.contentGroupService.saveItem(contentGroup).subscribe(() => {\r\n      this.snackBar.open('Saved', null, { duration: 2000 });\r\n      this.closeDialog();\r\n    });\r\n  }\r\n\r\n  private fetchConfig(isRefresh: boolean, cloneId: number) {\r\n    const contentGroup = this.buildContentGroup();\r\n    this.contentGroupService.getItems(contentGroup).subscribe(replaceConfig => {\r\n      const options = Object.entries(replaceConfig.Items).map(([itemId, itemName]) => {\r\n        const option: ReplaceOption = {\r\n          id: parseInt(itemId, 10),\r\n          label: `${itemName} (${itemId})`,\r\n        };\r\n        return option;\r\n      });\r\n      this.options$.next(options);\r\n\r\n      // don't set selected option if dialog should be in add-mode and don't change selected option on refresh unless it's cloneId\r\n      if ((!contentGroup.add && !isRefresh) || cloneId != null) {\r\n        const newId = !isRefresh ? replaceConfig.SelectedId : cloneId;\r\n        const newFilter = this.options$.value.find(option => option.id === newId)?.label || '';\r\n        this.filterText$.next(newFilter);\r\n      }\r\n      this.contentTypeName = replaceConfig.ContentTypeName;\r\n    });\r\n  }\r\n\r\n  private buildContentGroup() {\r\n    const id = this.options$.value.find(option => option.label === this.filterText$.value)?.id ?? null;\r\n\r\n    const contentGroup: ContentGroupAdd = {\r\n      id,\r\n      guid: this.guid,\r\n      part: this.part,\r\n      index: this.index,\r\n      add: this.add,\r\n    };\r\n    return contentGroup;\r\n  }\r\n}\r\n","@if (viewModel$ | async; as vm) {\r\n\r\n<div class=\"eav-dialog\">\r\n  <div class=\"eav-dialog-header\">\r\n    <div class=\"eav-dialog-header__title\">{{ vm.isAddMode ? 'Add Existing Item' : 'Replace Content Item' }}</div>\r\n  </div>\r\n  <div class=\"eav-dialog-content\">\r\n    <router-outlet></router-outlet>\r\n    <p>{{vm.isAddMode\r\n      ? 'Select a content-item to add to this list.'\r\n      : 'By replacing a content-item you can make other content appear in the slot of the original content.'}}\r\n    </p>\r\n    <div class=\"eav-options-box\">\r\n      <mat-form-field color=\"accent\" class=\"eav-mat-form-field\">\r\n        <mat-label>Choose item</mat-label>\r\n        <input matInput [matAutocomplete]=\"auto\" [ngModel]=\"vm.filterText\" (ngModelChange)=\"setFilter($event)\">\r\n        <mat-autocomplete #auto=\"matAutocomplete\" (optionSelected)=\"select($event)\"\r\n          [hideSingleSelectionIndicator]=\"true\">\r\n          <cdk-virtual-scroll-viewport itemSize=\"48\" minBufferPx=\"500\" maxBufferPx=\"1000\"\r\n            [style.height.px]=\"vm.filteredOptions.length < 6 ? vm.filteredOptions.length * 48 : 240\">\r\n            <mat-option *cdkVirtualFor=\"let option of vm.filteredOptions\" [value]=\"option\">{{ option }}</mat-option>\r\n          </cdk-virtual-scroll-viewport>\r\n        </mat-autocomplete>\r\n      </mat-form-field>\r\n      <button mat-icon-button tippy=\"Copy\" [disabled]=\"!vm.isMatch\" (click)=\"copySelected()\">\r\n        <mat-icon>file_copy</mat-icon>\r\n      </button>\r\n    </div>\r\n  </div>\r\n  <mat-dialog-actions align=\"end\">\r\n    <button mat-raised-button (click)=\"closeDialog()\">Cancel</button>\r\n    <button mat-raised-button color=\"accent\" [disabled]=\"!vm.isMatch\" (click)=\"save()\">Save</button>\r\n  </mat-dialog-actions>\r\n</div>\r\n}\r\n","import { Directive, OnDestroy } from '@angular/core';\r\nimport { ActivatedRoute, NavigationEnd, Router } from '@angular/router';\r\nimport { filter, map, pairwise, startWith, tap } from 'rxjs';\r\nimport { BaseComponent } from './base.component';\r\nimport { EavLogger } from '../logging/eav-logger';\r\n\r\nconst logThis = false;\r\n\r\n// 2024-06-12 2dm experimental - remove comments if all is good mid of June\r\n// - previously had\r\n// @Directive()   // Needs the @Directive() so the compiler allows OnDestroy to be implemented\r\n// ...then tried this\r\n// @Component({\r\n//   selector: 'app-base-component-with-child',\r\n//   template: ''\r\n// })\r\n// ...but then added abstract, so I think it doesn't actually need all that\r\n// tslint:disable-next-line:directive-class-suffix\r\nexport abstract class BaseWithChildDialogComponent extends BaseComponent implements OnDestroy {\r\n\r\n  constructor(\r\n    protected router: Router,\r\n    protected route: ActivatedRoute,\r\n    public log?: EavLogger\r\n  ) {\r\n    super();\r\n    this.log ??= new EavLogger('BaseComponent', logThis);\r\n  }\r\n\r\n  // 2024-06-12 2dm - don't think this is needed since it's already on the base class\r\n  // ngOnDestroy() {\r\n  //   super.ngOnDestroy();\r\n  // }\r\n\r\n  // TODO @2dg not longer in use after refactoring SideNav with Routing\r\n  // protected refreshOnChildClosedDeep() {\r\n  //   return this.router.events.pipe(\r\n  //     filter(event => event instanceof NavigationEnd),\r\n  //     startWith(!!this.route.snapshot.firstChild.firstChild),\r\n  //     map(() => !!this.route.snapshot.firstChild.firstChild),\r\n  //     pairwise(),\r\n  //     filter(([hadChild, hasChild]) => hadChild && !hasChild),\r\n  //   )\r\n  // }\r\n\r\n  protected childDialogClosed$() {\r\n    return this.router.events.pipe(\r\n      filter(event => event instanceof NavigationEnd),\r\n      startWith(!!this.route.snapshot.firstChild),\r\n      map(() => !!this.route.snapshot.firstChild),\r\n      pairwise(),\r\n      filter(([hadChildBefore, hasChildNow]) => hadChildBefore && !hasChildNow),\r\n      // tap(() => console.log('2dm ' + 'childDialogClosed$'))\r\n    )\r\n  }\r\n}\r\n"],"names":["MatAutocompleteModule","MatDialogRef","MatDialogActions","MatSnackBar","ActivatedRoute","Router","RouterOutlet","BehaviorSubject","combineLatest","map","ContentGroupService","BaseWithChildDialogComponent","convertFormToUrl","AsyncPipe","MatIconModule","MatButtonModule","MatOptionModule","CdkVirtualScrollViewport","CdkFixedSizeVirtualScroll","CdkVirtualForOf","FormsModule","MatInputModule","MatFormFieldModule","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵproperty","option_r3","ɵɵadvance","ɵɵtextInterpolate","ɵɵelement","ɵɵlistener","ReplaceContentComponent_Conditional_0_Template_input_ngModelChange_12_listener","$event","ɵɵrestoreView","_r1","ctx_r1","ɵɵnextContext","ɵɵresetView","setFilter","ReplaceContentComponent_Conditional_0_Template_mat_autocomplete_optionSelected_13_listener","select","ɵɵtemplate","ReplaceContentComponent_Conditional_0_mat_option_16_Template","ReplaceContentComponent_Conditional_0_Template_button_click_17_listener","copySelected","ReplaceContentComponent_Conditional_0_Template_button_click_21_listener","closeDialog","ReplaceContentComponent_Conditional_0_Template_button_click_23_listener","save","vm_r4","isAddMode","ɵɵtextInterpolate1","auto_r5","filterText","ɵɵstyleProp","filteredOptions","length","isMatch","ReplaceContentComponent","constructor","router","route","dialogRef","contentGroupService","snackBar","hostClass","ngOnInit","guid","snapshot","paramMap","get","part","index","parseInt","add","queryParamMap","filterText$","options$","filteredOptions$","pipe","options","filter","option","label","toLocaleLowerCase","includes","viewModel$","viewModel","fetchConfig","subscriptions","childDialogClosed$","subscribe","navigation","getCurrentNavigation","editResult","extras","state","cloneId","Object","keys","ngOnDestroy","complete","close","next","event","value","contentGroup","buildContentGroup","form","items","ContentTypeName","contentTypeName","DuplicateEntity","id","formUrl","navigate","relativeTo","open","saveItem","duration","isRefresh","getItems","replaceConfig","entries","Items","itemId","itemName","newId","SelectedId","newFilter","find","_","ɵɵdirectiveInject","i1","i2","i3","i4","_2","selectors","hostVars","hostBindings","ReplaceContentComponent_HostBindings","rf","ctx","ɵɵhostProperty","ɵɵInheritDefinitionFeature","ɵɵStandaloneFeature","decls","vars","consts","template","ReplaceContentComponent_Template","ReplaceContentComponent_Conditional_0_Template","ɵɵconditional","tmp_0_0","ɵɵpipeBind1","i5","MatFormField","MatLabel","i6","MatInput","i7","MatAutocomplete","i8","MatOption","MatAutocompleteTrigger","i9","DefaultValueAccessor","NgControlStatus","NgModel","i10","MatButton","MatIconButton","i11","MatIcon","styles","NavigationEnd","pairwise","startWith","BaseComponent","EavLogger","logThis","log","events","firstChild","hadChildBefore","hasChildNow"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}