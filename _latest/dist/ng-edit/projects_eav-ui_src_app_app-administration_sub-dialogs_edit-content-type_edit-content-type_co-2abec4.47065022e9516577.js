"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_app-administration_sub-dialogs_edit-content-type_edit-content-type_co-2abec4"],{8407:(_,C,o)=>{o.r(C),o.d(C,{EditContentTypeComponent:()=>K});var u=o(7941),y=o(5858),f=o(52);const T=/(^[A-Za-z][A-Za-z0-9]*$)|(^@[A-Za-z][A-Za-z0-9\-]*$)/.toString(),S=T.substring(1,T.toString().length-1);var N=o(7693),p=o(3840),s=o(4175),c=o(5060),d=o(5175),r=o(353),M=o(7984),E=o(5944),l=o(4456),x=o(3758),R=o(9333),k=o(7896),O=o(5437),h=o(7993),A=o(5506),t=o(7580),D=o(2159),I=o(3347);function G(a,g){1&a&&(t.j41(0,"app-field-hint",19),t.EFF(1,"This field is required"),t.k0s()),2&a&&t.Y8G("isError",!0)}function P(a,g){if(1&a&&(t.j41(0,"app-field-hint",19),t.EFF(1),t.k0s()),2&a){const e=t.XpG(3);t.Y8G("isError",!0),t.R7$(),t.JRh(e.contentTypeNameError)}}function X(a,g){if(1&a&&t.DNE(0,G,2,1,"app-field-hint",19)(1,P,2,2,"app-field-hint",19),2&a){t.XpG();const e=t.sdS(9);t.vxM(0,e.errors.required?0:-1),t.R7$(),t.vxM(1,e.errors.pattern?1:-1)}}function $(a,g){if(1&a&&(t.j41(0,"mat-option",12),t.EFF(1),t.k0s()),2&a){const e=g.$implicit;t.Y8G("value",e.value),t.R7$(),t.SpI(" ",e.name," ")}}function B(a,g){if(1&a&&(t.j41(0,"div",7)(1,"h3"),t.EFF(2,"Shared Content Type (Ghost)"),t.k0s(),t.j41(3,"p"),t.EFF(4,"Note: this can't be edited in the UI, for now if you really know what you're doing, do it in the DB "),t.k0s(),t.j41(5,"p"),t.EFF(6),t.k0s()()),2&a){const e=t.XpG(2);t.R7$(6),t.SpI("Uses Type Definition of: ",e.contentType().SharedDefId,"")}}function V(a,g){if(1&a){const e=t.RV6();t.j41(0,"form",5,0),t.bIt("ngSubmit",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.save())}),t.j41(2,"div",6)(3,"div")(4,"div",7)(5,"mat-form-field",8)(6,"mat-label"),t.EFF(7,"Name"),t.k0s(),t.j41(8,"input",9,1),t.bIt("ngModelChange",function(n){t.eBV(e);const m=t.XpG();return t.Njj(m.changeContentTypeName(n))}),t.k0s()(),t.DNE(10,X,2,2),t.k0s(),t.j41(11,"mat-accordion")(12,"mat-expansion-panel")(13,"mat-expansion-panel-header")(14,"mat-panel-title"),t.EFF(15,"Advanced"),t.k0s(),t.nrm(16,"mat-panel-description"),t.k0s(),t.j41(17,"div",7)(18,"div",10)(19,"mat-form-field",8)(20,"mat-label"),t.EFF(21,"Scope"),t.k0s(),t.j41(22,"mat-select",11),t.bIt("ngModelChange",function(n){t.eBV(e);const m=t.XpG();return t.Njj(m.changeScope(n))}),t.Z7z(23,$,2,2,"mat-option",12,t.fX1),t.j41(25,"mat-option",12),t.EFF(26,"Other..."),t.k0s()()(),t.j41(27,"button",13),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.unlockScope())}),t.j41(28,"mat-icon"),t.EFF(29),t.k0s()()(),t.j41(30,"app-field-hint"),t.EFF(31," The scope should almost never be changed - "),t.j41(32,"a",14),t.EFF(33,"see help"),t.k0s()()(),t.j41(34,"div",7)(35,"mat-form-field",8)(36,"mat-label"),t.EFF(37,"Static Name"),t.k0s(),t.nrm(38,"input",15),t.k0s()(),t.DNE(39,B,7,1,"div",7),t.k0s()()()(),t.j41(40,"mat-dialog-actions",16)(41,"button",17),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.closeDialog())}),t.EFF(42,"Cancel"),t.k0s(),t.j41(43,"button",18),t.EFF(44," Save "),t.k0s()()()}if(2&a){const e=t.sdS(1),i=t.sdS(9),n=t.XpG();t.R7$(8),t.Y8G("pattern",n.contentTypeNamePattern)("ngModel",n.contentType().Name),t.R7$(2),t.vxM(10,i.touched&&i.errors?10:-1),t.R7$(),t.Y8G("@.disabled",n.disableAnimation()),t.R7$(11),t.Y8G("ngModel",n.contentType().Scope)("disabled",n.lockScope()),t.R7$(),t.Dyx(n.scopeOptions()),t.R7$(2),t.Y8G("value",n.dropdownInsertValue),t.R7$(2),t.Y8G("tippy",n.lockScope()?"Unlock":"Lock"),t.R7$(2),t.SpI(" ",n.lockScope()?"lock":"lock_open"," "),t.R7$(9),t.Y8G("ngModel",n.contentType().StaticName),t.R7$(),t.vxM(39,n.contentType().SharedDefId?39:-1),t.R7$(4),t.Y8G("disabled",!e.form.valid||n.loading())}}const Y={enabled:!1,name:"EditContentType",specs:{}};let K=(()=>{class a{#e;#t;#n;constructor(e,i,n){this.dialogRef=e,this.route=i,this.snackBar=n,this.hostClass="dialog-component",this.log=new A.B(Y),this.#e=(0,O.d)(N.g),this.#t=this.route.snapshot.parent.paramMap.get("scope"),this.#n=this.route.snapshot.paramMap.get("contentTypeStaticName"),this.contentTypeNamePattern=S,this.contentTypeNameError="Standard letters and numbers are allowed. Must start with a letter.",this.dropdownInsertValue=y.O,this.modeIsEdit=!!this.#n,this.lockScope=(0,h.KX)("lockScope",!0),this.disableAnimation=(0,h.KX)("disableAnimation",!0),this.loading=(0,h.KX)("loading",!1),this.contentType=(0,h.KX)("contentType",{StaticName:"",Name:"",Description:"",Scope:this.#t,ChangeStaticName:!1,NewStaticName:""}),this.#i=(0,h.D3)("scopeOptionsHttp",this.#e.getScopes()),this.#o=(0,h.KX)("scopeOptionsManual",[]),this.scopeOptions=(0,h.bo)("scopeOptions",()=>{const m=this.#i(),j=this.#o();return m?j.concat(this.#s(m)):j}),this.log.a("constructor"),this.#a()}#a(){this.modeIsEdit&&this.#e.retrieveContentType(this.#n).subscribe(e=>{this.contentType.set({...e,ChangeStaticName:!1,NewStaticName:e.StaticName})})}#i;#o;#s(e){const i=[];return e.forEach(n=>{i.some(m=>m.value===n.value)||i.push(n)}),i.some(n=>n.value===this.#t)||i.push({name:this.#t,value:this.#t}),i}ngAfterViewInit(){setTimeout(()=>this.disableAnimation.set(!1))}closeDialog(){this.dialogRef.close()}changeContentTypeName(e){this.contentType.set({...this.contentType(),Name:e})}changeScope(e){e===y.O&&(e=prompt("This is an advanced feature to show content-types of another scope. Don't use this if you don't know what you're doing, as content-types of other scopes are usually hidden for a good reason.")||f.YX.scopes.default.value,this.scopeOptions().some(i=>i.value===e)||this.#o.set([{name:e,value:e},...this.scopeOptions()])),this.contentType.set({...this.contentType(),Scope:e})}unlockScope(){this.lockScope.set(!this.lockScope()),this.lockScope()&&this.contentType.set({...this.contentType(),Scope:this.#t})}save(){this.loading.set(!0),this.snackBar.open("Saving..."),this.#e.save(this.contentType()).subscribe(e=>{this.loading.set(!1),this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()}),document.activeElement instanceof HTMLElement&&document.activeElement.blur()}static#c=this.\u0275fac=function(i){return new(i||a)(t.rXU(u.CP),t.rXU(D.nX),t.rXU(I.UG))};static#p=this.\u0275cmp=t.VBU({type:a,selectors:[["app-edit-content-type"]],hostVars:1,hostBindings:function(i,n){2&i&&t.Mr5("className",n.hostClass)},standalone:!0,features:[t.aNF],decls:5,vars:2,consts:[["ngForm","ngForm"],["name","ngModel"],[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[3,"ngSubmit"],[1,"eav-dialog-content"],[1,"eav-edit-input"],["color","accent",1,"eav-mat-form-field"],["matInput","","type","text","required","","name","Name",3,"ngModelChange","pattern","ngModel"],[1,"eav-form-and-button"],["name","Scope",3,"ngModelChange","ngModel","disabled"],[3,"value"],["mat-icon-button","","type","button","matTextSuffix","",1,"eav-scope-button",3,"click","tippy"],["href","https://2sxc.org/help?tag=scope","target","_blank","appClickStopPropagation",""],["matInput","","type","text","name","StaticName","disabled","",3,"ngModel"],["align","end"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","submit","color","accent",3,"disabled"],[3,"isError"]],template:function(i,n){1&i&&(t.j41(0,"div",2)(1,"div",3)(2,"div",4),t.EFF(3),t.k0s()(),t.DNE(4,V,45,12,"form"),t.k0s()),2&i&&(t.R7$(3),t.JRh(n.modeIsEdit?"Edit Content Type":"New Content Type"),t.R7$(),t.vxM(4,n.contentType()?4:-1))},dependencies:[l.YN,l.qT,l.me,l.BC,l.cb,l.YS,l.R_,l.vS,l.cV,E.RG,E.rl,E.nJ,E.yw,M.fS,M.fg,r.MY,r.BS,r.GK,r.Z2,r.WN,r.Q6,d.Ve,d.VO,c.wT,c.Sy,s.Hl,s.$z,s.iY,p.m_,p.An,u.E7,x.F,R.c,k.e],styles:[".eav-edit-input[_ngcontent-%COMP%]{padding-bottom:8px}.eav-form-and-button[_ngcontent-%COMP%]{display:flex;align-items:baseline;justify-content:space-between}.eav-form-and-button[_ngcontent-%COMP%]   .eav-scope-button[_ngcontent-%COMP%]{margin-left:8px}"]})}return a})()},7993:(_,C,o)=>{o.d(C,{D3:()=>S,KT:()=>v,KX:()=>T,bo:()=>F,tD:()=>N});var u=o(7580),y=o(5689),f=o(2434),b=o(4334);function T(p,s){return v(p,(0,u.vPA)(s,{equal:f.A}))}function F(p,s){return v(p,(0,u.EWP)(s,{equal:f.A}))}function S(p,s,c=null){const d=(0,u.vPA)(c,{equal:f.A});return s.pipe((0,b.s)(1)).subscribe(r=>d.set(r)),v(p,d.asReadonly())}function v(p,s){if(!s)return s;const c=s;return c.debugName=p,c[y.bh]&&(c[y.bh].debugName=p),s}function N(p,s){let c=s;return(0,u.EWP)(()=>{const d=p(c);return c=d,d},{equal:f.A})}}}]);
//# sourceMappingURL=https://sources.2sxc.org/18.00.02/dist/ng-edit/projects_eav-ui_src_app_app-administration_sub-dialogs_edit-content-type_edit-content-type_co-2abec4.47065022e9516577.js.map