{"version":3,"sources":["C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_baseTimes.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_isIndex.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_arrayLikeKeys.js","./src/app/shared/helpers/load-scripts.helper.ts","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_getAllKeys.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_nativeCreate.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_hashGet.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_hashHas.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_Hash.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_hashClear.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_hashDelete.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_hashSet.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_getMapData.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_isKeyable.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_MapCache.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_mapCacheClear.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_mapCacheDelete.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_mapCacheGet.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_mapCacheHas.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_mapCacheSet.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_Stack.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_stackClear.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_stackDelete.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_stackGet.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_stackHas.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_stackSet.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/keys.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_listCacheClear.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_assocIndexOf.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_listCacheDelete.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_ListCache.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_listCacheGet.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_listCacheHas.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_listCacheSet.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/eq.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/stubArray.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_arrayPush.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/rxjs/_esm5/internal/observable/zip.js","../edit/eav-material-controls/input-types/base/base.component.ts","../edit/eav-material-controls/adam/adam-browser/adam-browser.models.ts","../edit/shared/models/feature/feature.ts","../edit/shared/store/ngrx-data/feature.service.ts","../edit/shared/directives/paste-clipboard-image.directive.ts","../shared/features-guids.constants.ts","../edit/eav-material-controls/adam/adam-browser/adam-browser.component.html","../edit/eav-material-controls/adam/adam-browser/adam-browser.component.ts","../edit/eav-material-controls/adam/adam-hint/adam-hint.component.ts","../edit/eav-material-controls/adam/adam-hint/adam-hint.component.html","../edit/eav-material-controls/adam/adam-attach-wrapper/adam-attach-wrapper.component.ts","../edit/eav-material-controls/adam/adam-attach-wrapper/adam-attach-wrapper.component.html","../edit/eav-material-controls/wrappers/collapsible-field-wrapper/collapsible-field-wrapper.component.ts","../edit/eav-material-controls/wrappers/collapsible-field-wrapper/collapsible-field-wrapper.component.html","../edit/shared/store/ngrx-data/content-type.service.ts","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_SetCache.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_setCacheAdd.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_setCacheHas.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_arraySome.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_equalArrays.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_cacheHas.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_mapToArray.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_setToArray.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_equalByTag.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_equalObjects.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_baseIsEqualDeep.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/isEqual.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_baseIsEqual.js","../edit/shared/constants/translation-link.constants.ts","../edit/eav-material-controls/localization/link-to-other-language/link-to-other-language.constants.ts","../edit/eav-material-controls/localization/link-to-other-language/link-to-other-language.component.html","../edit/eav-material-controls/localization/link-to-other-language/link-to-other-language.component.ts","../edit/eav-material-controls/localization/link-to-other-language/link-to-other-language.helpers.ts","../edit/eav-material-controls/localization/translate-group-menu/translate-group-menu.helpers.ts","../edit/eav-material-controls/localization/translate-group-menu/translate-group-menu.component.html","../edit/eav-material-controls/localization/translate-group-menu/translate-group-menu.component.ts","../edit/shared/directives/change-anchor-target.directive.ts","../edit/eav-material-controls/wrappers/collapsible-wrapper/collapsible-wrapper.component.html","../edit/eav-material-controls/wrappers/collapsible-wrapper/collapsible-wrapper.component.ts","../edit/eav-material-controls/adam/dropzone-wrapper/dropzone-wrapper.models.ts","../edit/eav-material-controls/adam/dropzone-wrapper/dropzone-wrapper.component.ts","../edit/eav-material-controls/adam/dropzone-wrapper/dropzone-wrapper.component.html","../edit/eav-material-controls/wrappers/eav-localization-wrapper/eav-localization-wrapper.component.ts","../edit/eav-material-controls/wrappers/eav-localization-wrapper/eav-localization-wrapper.component.html","../edit/shared/animations/content-expand-animation.ts","../edit/eav-material-controls/input-types/entity/entity-default/entity-default.helpers.ts","../edit/eav-material-controls/wrappers/field-helper-text/field-helper-text.component.html","../edit/eav-material-controls/wrappers/field-helper-text/field-helper-text.component.ts","../edit/eav-material-controls/wrappers/entity-expandable-wrapper/entity-expandable-wrapper.component.html","../edit/eav-material-controls/wrappers/entity-expandable-wrapper/entity-expandable-wrapper.component.ts","../edit/eav-material-controls/input-types/custom/external-web-component/connector/models/connector-instance.model.ts","../edit/eav-material-controls/input-types/custom/external-web-component/connector/connector.helper.ts","../edit/shared/services/dropzone-dragging.helper.ts","../edit/eav-material-controls/wrappers/expandable-wrapper/expandable-wrapper.component.html","../edit/eav-material-controls/wrappers/expandable-wrapper/expandable-wrapper.component.ts","../edit/eav-material-controls/wrappers/hidden-wrapper/hidden-wrapper.component.ts","../edit/eav-material-controls/wrappers/hidden-wrapper/hidden-wrapper.component.html","../edit/eav-material-controls/wrappers/hyperlink-default-expandable-wrapper/hyperlink-default-expandable-wrapper.component.html","../edit/eav-material-controls/wrappers/hyperlink-default-expandable-wrapper/hyperlink-default-expandable-wrapper.component.ts","../edit/eav-material-controls/wrappers/hyperlink-library-expandable-wrapper/hyperlink-library-expandable-wrapper.component.html","../edit/eav-material-controls/wrappers/hyperlink-library-expandable-wrapper/hyperlink-library-expandable-wrapper.component.ts","../edit/eav-dynamic-form/decorators/input-type.decorator.ts","../edit/eav-material-controls/input-types/string/string-default/string-default.component.html","../edit/eav-material-controls/input-types/string/string-default/string-default.component.ts","../shared/field-mask.service.ts","../edit/eav-material-controls/input-types/string/string-url-path/string-url-path.component.html","../edit/eav-material-controls/input-types/string/string-url-path/string-url-path.component.ts","../edit/eav-material-controls/input-types/string/string-dropdown/string-dropdown.component.html","../edit/eav-material-controls/input-types/string/string-dropdown/string-dropdown.component.ts","../edit/eav-material-controls/input-types/string/string-dropdown/string-dropdown.helpers.ts","../edit/eav-material-controls/input-types/entity/entity-default-search/entity-default-search.component.html","../edit/eav-material-controls/input-types/entity/entity-default-search/entity-default-search.component.ts","../edit/eav-material-controls/input-types/entity/entity-default-list/entity-default-list.component.html","../edit/eav-material-controls/input-types/entity/entity-default-list/entity-default-list.component.ts","../edit/eav-material-controls/input-types/entity/entity-default/entity-default.component.html","../edit/eav-material-controls/input-types/entity/entity-default/entity-default.component.ts","../edit/eav-material-controls/input-types/entity/entity-query/entity-query.component.ts","../edit/eav-material-controls/input-types/string/string-dropdown-query/string-dropdown-query.component.ts","../edit/eav-material-controls/input-types/string/string-font-icon-picker/string-font-icon-picker.component.html","../edit/eav-material-controls/input-types/string/string-font-icon-picker/string-font-icon-picker.component.ts","../edit/eav-material-controls/input-types/string/string-font-icon-picker/string-font-icon-picker.helpers.ts","../edit/eav-material-controls/input-types/string/string-template-picker/string-template-picker.constants.ts","../edit/eav-material-controls/input-types/string/string-template-picker/string-template-picker.component.html","../edit/eav-material-controls/input-types/string/string-template-picker/string-template-picker.component.ts","../edit/eav-material-controls/input-types/boolean/boolean-default/boolean-default.component.html","../edit/eav-material-controls/input-types/boolean/boolean-default/boolean-default.component.ts","../edit/eav-material-controls/input-types/boolean/boolean-tristate/boolean-tristate.component.html","../edit/eav-material-controls/input-types/boolean/boolean-tristate/boolean-tristate.component.ts","../edit/eav-material-controls/input-types/datetime/datetime-default/datetime-default.component.html","../edit/eav-material-controls/input-types/datetime/datetime-default/datetime-default.component.ts","../edit/eav-material-controls/input-types/empty/empty-default/empty-default.component.ts","../edit/eav-material-controls/input-types/number/number-default/number-default.component.html","../edit/eav-material-controls/input-types/number/number-default/number-default.component.ts","../edit/eav-material-controls/input-types/hyperlink/hyperlink-default/hyperlink-default.component.html","../edit/eav-material-controls/input-types/hyperlink/hyperlink-default/hyperlink-default.component.ts","../edit/eav-material-controls/input-types/custom/custom-default/custom-default.component.ts","../edit/eav-material-controls/input-types/custom/custom-default/custom-default.component.html","../edit/eav-material-controls/input-types/entity/entity-content-blocks/entity-content-blocks.component.ts","../edit/eav-material-controls/input-types/custom/external-web-component/connector/connector.component.ts","../edit/eav-material-controls/input-types/custom/external-web-component/connector/connector.component.html","../edit/eav-material-controls/input-types/custom/external-web-component/external-web-component.component.html","../edit/eav-material-controls/input-types/custom/external-web-component/external-web-component.component.ts","../edit/eav-material-controls/input-types/hyperlink/hyperlink-library/hyperlink-library.component.ts","../edit/eav-material-controls/input-types/custom/custom-json-editor/custom-json-editor.component.html","../edit/eav-material-controls/input-types/custom/custom-json-editor/custom-json-editor.component.ts","../edit/eav-dynamic-form/components/eav-field/eav-field.directive.ts","../edit/eav-dynamic-form/components/eav-form/eav-form.component.ts","../edit/eav-dynamic-form/components/eav-form/eav-form.component.html","../edit/eav-item-dialog/item-edit-form/item-edit-form.component.html","../edit/eav-item-dialog/item-edit-form/item-edit-form.component.ts","../edit/shared/models/json-format-v1/value1.ts","../edit/shared/models/json-format-v1/attributes1.ts","../edit/shared/models/json-format-v1/type1.ts","../edit/shared/models/json-format-v1/for1.ts","../edit/shared/models/json-format-v1/entity1.ts","../edit/shared/models/json-format-v1/json-item1.ts","../edit/eav-material-controls/dialogs/snack-bar-unsaved-changes/snack-bar-unsaved-changes.component.ts","../edit/eav-material-controls/dialogs/snack-bar-unsaved-changes/snack-bar-unsaved-changes.component.html","../edit/eav-material-controls/dialogs/snack-bar-save-errors/snack-bar-save-errors.component.html","../edit/eav-material-controls/dialogs/snack-bar-save-errors/snack-bar-save-errors.component.ts","../edit/eav-item-dialog/multi-item-edit-form/multi-item-edit-form.helpers.ts","../edit/eav-item-dialog/multi-item-edit-form/multi-item-edit-form.constants.ts","../edit/eav-material-controls/dialogs/save-status-dialog/save-status-dialog.component.ts","../edit/eav-material-controls/dialogs/save-status-dialog/save-status-dialog.component.html","../edit/eav-material-controls/localization/eav-language-switcher/eav-language-switcher-services/mouse-scroll-helper.ts","../edit/eav-material-controls/localization/eav-language-switcher/eav-language-switcher-services/center-selected-helper.ts","../edit/eav-material-controls/localization/eav-language-switcher/eav-language-switcher-services/show-shadows-helper.ts","../edit/eav-material-controls/localization/eav-language-switcher/eav-language-switcher-services/eav-language-switcher.helpers.ts","../edit/eav-material-controls/localization/eav-language-switcher/eav-language-switcher.component.html","../edit/eav-material-controls/localization/eav-language-switcher/eav-language-switcher.component.ts","../edit/eav-item-dialog/multi-item-edit-form-header/multi-item-edit-form-header.component.html","../edit/eav-item-dialog/multi-item-edit-form-header/multi-item-edit-form-header.component.ts","../edit/eav-item-dialog/multi-item-edit-form-debug/multi-item-edit-form-debug.component.html","../edit/eav-item-dialog/multi-item-edit-form-debug/multi-item-edit-form-debug.component.ts","../edit/eav-item-dialog/multi-item-edit-form/multi-item-edit-form.component.html","../edit/eav-item-dialog/multi-item-edit-form/multi-item-edit-form.component.ts","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_baseGetAllKeys.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_Uint8Array.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_arrayFilter.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/lodash-es/_getSymbols.js","C:/Projects/2sxc/eav-item-dialog-angular/node_modules/reflect-metadata/Reflect.js"],"names":["reIsUint","value","length","type","test","Object","prototype","hasOwnProperty","inherited","isArr","isArray","isArg","isArguments","isBuff","isBuffer","isType","isTypedArray","skipIndexes","result","n","iteratee","index","Array","String","key","call","push","loadScripts","scriptObjects","callback","iteration","newCallback","bind","this","scrObj","global","window","scriptInDom","document","querySelector","src","addEventListener","once","scriptEl","createElement","head","appendChild","object","Hash","entries","clear","entry","set","__data__","size","has","get","data","undefined","map","MapCache","Stack","pairs","LARGE_ARRAY_SIZE","array","eq","splice","ListCache","pop","other","values","offset","zip","observables","_i","arguments","resultSelector","fromArray","lift","ZipOperator","subscriber","source","subscribe","_super","ZipSubscriber","destination","create","_this","iterators","active","_next","StaticIterator","_complete","len","unsubscribe","i","iterator","stillUnsubscribed","add","complete","notifyInactive","checkIterators","hasValue","shouldComplete","args","next","hasCompleted","done","_tryresultSelector","apply","err","error","Subscriber","nextResult","StaticArrayIterator","ZipBufferIterator","parent","observable","buffer","isComplete","shift","notifyComplete","notifyNext","outerValue","innerValue","outerIndex","innerIndex","innerSub","subscribeToResult","OuterSubscriber","eavService","validationMessagesService","subscription","Subscription","ngOnInit","control","group","controls","config","field","name","settings$","label$","pipe","settings","Name","placeholder$","Placeholder","required$","isRequired","invalid$","statusChanges","status","startWith","invalid","showValidation$","filter","value$","formValueChange$","formSet","formId","form","entityGuid","entity","distinctUntilChanged","disabled$","formDisabledChange$","asObservable","formDisabledSet","disabled","ngOnDestroy","BaseComponent","rootSubfolder","fileFilter","allowAssetsInRoot","folderDepth","metadataContentTypes","usePortalRoot","showImagesOnly","autoLoad","enableSelect","subfolder","allowEdit","maxDepthReached","enabled","expires","id","isPublic","ui","createFeatureArray","features","featureList","forEach","f","Feature","public","serviceElementsFactory","loadFeatures","addAllToCache","isFeatureEnabled","guid","isEnabled","entities$","take","feature","find","ftr","FeatureService","elementRef","featureService","eventListeners","elementType","nativeElement","pastableTextarea","pastableNonInputable","handleImageBound","handleImage","element","listener","eventListener","removeEventListener","event","image","getFile","detail","dropzone","uploadFile","newFile","file","formData","FormData","append","imageFileName","e","console","PasteClipboardImageDirective","adamService","fileTypeService","dnnContext","editRoutingService","zone","openUpload","adamConfig$","BehaviorSubject","items$","refreshOnChildClosed","url","$2sxc","http","apiUrl","header","ContentTypeName","Guid","pasteClipboardImage","adam","toggle","run","setConfig","getConfig","getConfig$","onItemClick","onItemUpload","refresh","fetchItems","addFullPath","item","adamConfig","expanded$","isExpanded","addFolder","folderName","prompt","res","del","confirm","deleteItem","editItemMetadata","adamItem","open","items","MetadataId","_metadataContentType","For","Target","metadata","cmsObject","target","Type","Id","EntityId","goUp","includes","slice","lastIndexOf","getMetadataContentType","found","match","goIntoFolder","openUploadClick","emit","rename","newName","select","getAll","filteredItems","allowedFileTypes","split","extension","replace","trim","IsFolder","substring","_icon","getIconClass","_isMaterialIcon","isKnownType","_displaySize","Size","toFixed","AllowEdit","sort","a","b","toLocaleLowerCase","localeCompare","toString","newConfig","JSON","stringify","trackByFn","startDisabled","isExternal","oldConfig","AdamConfigInstance","newConfigKeys","keys","startsWith","folders","join","oldDzConfig","newDzConfig","dzUrlParams","getUrlParams","newUrl","replaceUrlParam","uploadDisabled","childFormClosed","AdamBrowserComponent","height","overflow","AdamHintComponent","adamDisabled$","fullscreenAdam","inputType","HyperlinkLibrary","ngAfterViewInit","invisibleClickableRef","click","AdamAttachWrapperComponent","collapse$","toggleCollapse","CollapsibleFieldWrapperComponent","addContentTypes","rawContentTypes","builtContentTypes","rawCT","addManyToCache","getContentTypeById","contentTypes","contentType","ContentTypeService","SetCache","predicate","bitmask","customizer","equalFunc","stack","isPartial","arrLength","othLength","stacked","seen","arrValue","othValue","compared","othIndex","symbolProto","symbolValueOf","valueOf","objectTag","baseIsEqual","isObjectLike","objIsArr","othIsArr","objTag","othTag","objIsObj","othIsObj","isSameTag","tag","byteLength","byteOffset","message","convert","objIsWrapped","othIsWrapped","objUnwrapped","othUnwrapped","objProps","objLength","skipCtor","objValue","objCtor","constructor","othCtor","Translate","DontTranslate","MissingDefaultLangValue","LinkReadOnly","LinkReadWrite","LinkCopyFrom","NoTranslate","FromPrimary","FromOther","LinkShared","dialogData","languageService","languageInstanceService","TranslationLinks","TranslationLinkConstants","I18nKeys","I18nKeyConstants","selected$","showLanguages$","language","i18nKey","translationLink","findI18nKey","linkType","i18nRoot$","languages$","combineLatest","getCurrentLanguage","combined","currentLanguage","lang","showLanguages","newSelected","findTranslationLink","selectLanguage","isOkDisabled","selected","isLanguageDisabled","languageKey","attributes","isEditableTranslationExist","attributeKey","defaultLanguage","LinkToOtherLanguageComponent","calculateSharedInfoMessage","dimensions","TranslateGroupMenuHelpers","calculateShortDimensions","calculateEditAndReadDimensions","editableDimensions","readOnlyDimensions","infoMessage","editableExist","readOnlyExist","dimensionsMap","shortCurrentLanguage","indexOf","dimension","shortNoReadOnly","shortDimension","dialog","itemService","inputTypeService","contentTypeService","translationLinkConstants","defaultLanguageMissingValue$","headerGroupSlotIsEmpty","translationState$","infoMessage$","infoMessageLabel$","fieldConfig","isParentGroup","of","currentLanguage$","defaultLanguage$","getDefaultLanguage","attributes$","selectAttributesByEntityId","entityId","subscribeToAttributeValues","subscribeMenuChange","subscribeToItemFromStore","subscribeToContentTypeFromStore","subscribeToCurrentLanguageFromStore","subscribeToDefaultLanguageFromStore","subscribeToEntityHeaderFromStore","ngOnChanges","changes","toggleTranslateField","translateUnlink","openLinkToOtherLanguage","dialogRef","panelClass","autoFocus","width","keydownEvents","keyCode","navigator","platform","metaKey","ctrlKey","preventDefault","afterClosed","actionResult","triggerTranslation","isTranslateDisabled","removeItemAttributeDimension","defaultValue","getValueTranslation","fieldType","getFieldType","addAttributeValue","refreshControlConfig","linkToDefault","translateAll","setTranslationState","triggerLocalizationWrapperMenuChange","dontTranslateAll","copyFromAll","copyFrom","copyFromLanguageKey","attributeValueTranslation","isEditableOrReadonlyTranslationExist","updateItemAttributeValue","linkReadOnlyAll","linkReadOnly","addItemAttributeDimension","linkReadWriteAll","linkReadWrite","getTranslationStateClass","setControlDisable","readTranslationState","setInfoMessage","newTranslationState","disable","emitEvent","enable","translationExistsInDefault","isReadonlyTranslationExist","translateAllConfiguration","fieldSettings","translateSettings","fullSettings","label","validation","getValidations","required","Group","SlotCanBeEmpty","selectHeaderByEntityId","SlotIsEmpty","selectItemById","attributeDef","attr","calculatedInputType","calculateInputType","isI18nDisabled","editableElements","readOnlyElements","localizationWrapperMenuChange$","s","d","TranslateGroupMenuComponent","runOutsideAngular","observer","MutationObserver","mutations","tagName","anchor","childAnchors","getElementsByTagName","observe","childList","subtree","disconnect","ChangeAnchorTargetDirective","header$","DefaultCollapsed","slotCanBeEmpty$","slotIsEmpty$","itemTitle$","contentTypeId","cType","defaultLang","getValueOrDefault","Label","description$","EditInstructions","Notes","toggleSlotIsEmpty","hdr","newHeader","updateItemHeader","CollapsibleWrapperComponent","headers","acceptedFiles","maxFiles","parallelUploads","autoReset","errorReset","cancelReset","maxFilesize","paramName","maxThumbnailFilesize","dictDefaultMessage","addRemoveLinks","previewsContainer","clickable","dropzoneConfig$","eavConfig","getEavConfig","dropzoneDisabled$","dropzoneConfig","onUploadError","dropzoneRef","reset","onUploadSuccess","response","Success","alert","Error","appId","sxc","webApi","DropzoneConfigInstance","uploadLimit","upload","chunked","defaultOptions","chunking","processFile","DropzoneWrapperComponent","toggleTranslateField$","open$","toggleTranslate","isOpen","EavLocalizationComponent","ContentExpandAnimation","maxHeight","params","bottomPixels","innerWidth","calculateSelectedEntities","fieldValue","separator","availableEntities","translate","convertValueToArray","Value","Text","instant","tooltip","isFreeTextOrNotFound","disableError","isFullText","toggleHint","classList","contains","parentNode","getErrorMessage","FieldHelperTextComponent","Separator","dialogIsOpen$","selectedEntities$","entityCache$","calculateBottomPixels","expandDialog","expand","closeDialog","EntityExpandableWrapperComponent","_connectorHost","_experimental","ConnectorDataInstance","ConnectorDialogInstance","loadScript","testOrScripts","srcOrCallback","resolveTokens","script","getUrlPrefix","sxcVersion","clientValueChangeListeners","forceConnectorSave$","newValue","clientListener","update","onValueChange","componentTag","close","customElContainerRef","customElName","translateService","dnnBridgeService","customEl","connector","buildConnector","connectorHost","calculateRegularProps","experimental","calculateExperimentalProps","updateControl","allInputTypeNames","calculateInputTypes","formGroup","isExpanded$","updateField","setFocused","focused","focused$","openDnnDialog","oldValue","getUrlOfIdDnnDialog","urlCallback","urlFromId$","getUrlOfId","patchValue","dirty","markAsDirty","touched","markAsTouched","destroy","removeChild","attach","htmlEl","dragoverListener","timeoutsArray","clearTimeout","clearTimeouts","windowBodyTimeouts","body","draggingClass","dropListener","remove","passive","detach","connectorCreator","previewContainerRef","dropzoneDraggingHelper","backdropRef","ExpandableWrapperComponent","visibleInEditUI$","VisibleInEditUI","HiddenWrapperComponent","preview$","thumbnailUrl","thumbnailPreviewUrl","floatingText","isImage","icon","setLink","adamButton$","Buttons","pageButton$","setValue","openPageDialog","Paths","FileFilter","processResultOfPagePicker","path","preview","quote","qt","HyperlinkDefaultExpandableWrapperComponent","adamItems$","HyperlinkLibraryExpandableWrapperComponent","InputType","annotation","Reflect","defineMetadata","rowCount$","RowCount","StringDefaultComponent","wrapper","EavLocalizationWrapper","mask","model","changeEvent","overloadPreCleanValues","fields","findFields","unwrapField","subscriptions","fieldList","preClean","watchAllFields","resolve","zoneId","replaceValue","cleaned","matches","staticName","onChange","maybeNew","valueSub","valueChanges","lastAutoCopy","autoGenerateMask","AutoGenerateMask","allowSlashes","AllowSlashes","fieldMaskService","FieldMaskService","onSourcesChanged","clean","stripNonUrlCharacters","trimEnd","StringUrlPathComponent","toggleFreeText$","enableTextEntry$","EnableTextEntry","dropdownOptions$","currentValue","dropdownValues","currentValueFound","options","DropdownValues","maybeWantedEmptyVal","val","option","freeTextMode$","toggleFreeTextMode","StringDropdownComponent","globalConfigurationService","addSelected","editEntity","filteredEntities","debugEnabled$","getDebugEnabled","autocompleteRef","filterSelectionList","getPlaceholder","toggleFreeText","toLowerCase","optionSelected","blur","insertNull","isOptionDisabled","selectedEntities","openNewEntityDialog","EntityDefaultSearchComponent","reorder","removeSelected","deleteEntity","drop","previousIndex","currentIndex","edit","removeItem","EntityDefaultListComponent","entityService","snackBar","useQuery","error$","disableAddNew$","calculateSettings","contentTypeMask","EntityType","updateAddNew","fetchAvailableEntities","fixedSettings","AllowMultiValue","EnableEdit","EnableCreate","EnableAddExisting","EnableRemove","EnableDelete","enableAddExisting","contentTypeName","getAvailableEntities","reorderIndexes","updateValue","entities","title","findIndex","delete","duration","dismiss","res2","childFormResult","newItemGuid","action","valueArray","valueString","convertArrayToString","setTimeout","entitySearchComponent","focus","EntityDefaultComponent","queryService","paramsMask","UrlParameters","Query","StreamName","stngs","streamName","queryUrl","queryEntityMapping","Title","EntityQueryComponent","StringDropdownQueryComponent","class","scriptsLoaderService","iconOptions$","cssPrefix","CssPrefix","showPrefix","ShowPrefix","load","Files","newIconOptions","classPrefix","foundList","duplicateDetector","truncateLabel","styleSheets","sheet","rules","cssRules","j","rule","selectorText","selector","iconClass","search","findAllIconsInCss","previewCss$","PreviewCss","filteredIcons$","iconList","StringFontIconPickerComponent","templateTypes","Token","ext","prefix","suggestion","assetsService","templateOptions$","activeSpec","templates","resetIfNotFound","typeWatcher","setFileConfig","locationWatcher","onLocationChange","setTemplateOptions","location","filtered","template","createTemplate","foundSlash","endsWith","fullPath","StringTemplatePickerComponent","TitleTrue","TitleFalse","BooleanDefaultComponent","TitleIndeterminate","nextValue","BooleanTristateComponent","dateAdapter","ngxDateTimeAdapter","currentLang","setLocale","useTimePicker$","UseTimePicker","DatetimeDefaultComponent","EmptyDefaultComponent","min$","Min","max$","Max","NumberDefaultComponent","buttons$","attachAdam","link","toggleAdam","HyperlinkDefaultComponent","DropzoneWrapper","HyperlinkDefaultExpandableWrapper","AdamAttachWrapper","CustomDefaultComponent","EntityContentBlockComponent","history","state","ConnectorComponent","loading$","loadAssets","getInputTypeById","assets","AngularAssets","assetsLoaded","ExternalWebComponentComponent","attachAdamValidator","Required","adamValidation","AllowAssetsInRoot","FolderDepth","MetadataContentTypes","setValidators","validators","validateAdam","adamItems","updateValueAndValidity","HyperlinkLibraryComponent","HyperlinkLibraryExpandableWrapper","Rows","CustomJsonEditorComponent","resolver","container","components","controlConfiguration","createFieldOrGroup","fieldGroup","createGroupComponents","createComponent","wrappers","createComponentWrappers","componentType","readComponentType","ExternalWebComponent","inputTypeAnnotations","getMetadata","factory","resolveComponentFactory","ref","assign","instance","wrapperName","createWrapper","componentFactory","fieldComponent","EavFieldDirective","formBuilder","formSubmit","formValueChange","createControlsInFormGroup","submitOutside","valueIsChanged","valueKeys","valueKey","fieldConfigArray","addControl","createControl","initialValue","EavFormComponent","actions$","buildFieldsService","itemFormValueChange","setFormValues","getContentTypeId","contentType$","itemFields$","buildFields","formSaveObservable","updateItemAttributesValues","submit","valid","checkAreAllControlsDisabled","saveItem","allDisabled","controlKeys","formValues","entityValues","ItemEditFormComponent","eavValues","newValue1","eavValue","allDimensions","eavAttributes","newAttribute1","Attributes1","eavAttributeKey","entityFor","Number","Version","Attributes","Owner","Metadata","attributes1","metaData1","createArray","for1","For1","Entity1","version","Type1","owner","eavEntityArray","metaData1Array","eavEntity","Header","Entity","JsonItem1","snackRef","snackBarData","saveChanges","save","dismissWithAction","SnackBarUnsavedChangesComponent","fieldErrors","SnackBarSaveErrorsComponent","alphabetCompare","Show","Hide","Branch","Modes","PublishModeConstants","publishMode","setMode","mode","SaveStatusDialogComponent","ngZone","areButtonsDisabled","registerScroll","headerDownListener","evList","button","getSelection","removeAllRanges","oldScrollBehavior","getComputedStyle","getPropertyValue","style","scrollBehavior","positionX","pageX","doScroll","removeScroll","newPositionX","scrollLeft","moveThreshold","stopClick","checkIfMouseMoved","lngButtonDown","saveInitialPosition","lngButtonClick","doMove","stopClickIfMouseMoved","positionY","pageY","Math","abs","buttonOffset","getBoundingClientRect","left","buttonWidth","headerOffset","headerWidth","leftShadow","rightShadow","hidden","calculateShadows","maxScrollLeft","scrollWidth","clientWidth","hideBoth","hideLeft","hideRight","showBoth","removeRegionName","languageName","toLocaleUpperCase","languageButtons$","langs","languageButtons","regionlessNamesCount","languages","regionlessName","buttonText","showShadowsService","ShowShadowsHelper","headerRef","leftShadowRef","rightShadowRef","mouseScrollHelper","MouseScrollHelper","centerSelectedService","CenterSelectedHelper","formsAreValid","allControlsAreDisabled","lngButtonMouseDown","updateCurrentLanguage","showError","EavLanguageSwitcherComponent","setPublishMode","hasLanguages$","openSaveStatusDialog","MultiItemEditFormHeaderComponent","debugInfoOpened","sxcVer","showDebugInfo$","selectAllItems","toggleDebugInfo","MultiItemEditFormDebugComponent","changeDetectorRef","loadIconsService","route","floor","random","formsAreValid$","allControlsAreDisabled$","publishMode$","reduceSaveButton$","tap","debugEnabled","debugInfoIsOpen$","formErrors","formsAreDirty","formSaveAllObservables$","createMode","formIsSaved","setEavConfig","isoLangCode","use","init","isParentDialog","editDialogCount","snapshot","pathFromRoot","calculateIsParentDialog","sortedLanguages","primaryLangKey","primaryLang","sameLangs","otherLangs","sortLanguages","langpri","parse","loadLanguages","addLanguageInstance","fetchFormData","languageChangeSubscribe","dialogBackdropClickSubscribe","saveFormMessagesSubscribe","formSetValueChangeSubscribe","checkFormsState","ngAfterViewChecked","attachAllSaveFormObservables","detectChanges","removeLanguageInstance","clearCache","toggleDebugEnabled","shiftKey","altKey","saveResult","disableClose","snackBarYouHaveUnsavedChanges","versioningOptions","saveAll","itemEditFormRefs","itemEditFormComponent","calculateAllValidationMessages","formError","openFromComponent","opened","loadItems","Items","addInputTypes","InputTypes","ContentTypes","Features","DraftShouldBranch","IsPublished","hideHeader$","getHideHeader","slide$","merge","pairwise","previous","current","l","fromEvent","slideableRef","animationName","delay","valuesExistInDefaultLanguage","selectItemsByIdList","returnValue","backdropClick","updateItemId","first","areFormsDirtyAnyLanguage","isDirty","langKeys","validateForm","saveFormSubscribe","switchMap","actions","allItems","saveFormData","partOfPage","saveItemSuccess","catchError","saveItemError","snackBarRef","onAction","containerInstance","snackBarConfig","MultiItemEditFormComponent","keysFunc","symbolsFunc","Uint8Array","propertyIsEnumerable","nativeGetSymbols","getOwnPropertySymbols","resIndex","stubArray","root","self","Function","exporter","makeExporter","defineProperty","configurable","writable","hasOwn","supportsSymbol","Symbol","toPrimitiveSymbol","toPrimitive","iteratorSymbol","supportsCreate","supportsProto","__proto__","downLevel","HashMap","MakeDictionary","functionPrototype","getPrototypeOf","usePolyfill","process","env","_Map","Map","cacheSentinel","arraySentinel","MapIterator","_index","_keys","_values","_selector","throw","return","_cacheKey","_cacheIndex","enumerable","_find","getKey","getValue","getEntry","insert","_","CreateMapPolyfill","_Set","Set","_map","WeakMap","rootKey","CreateUniqueKey","_key","table","GetOrCreateWeakMapTable","CreateUUID","FillRandomBytes","crypto","getRandomValues","msCrypto","byte","CreateWeakMapPolyfill","GetOrCreateMetadataMap","O","P","Create","targetMetadata","IsUndefined","metadataMap","OrdinaryHasOwnMetadata","MetadataKey","OrdinaryGetOwnMetadata","OrdinaryDefineOwnMetadata","MetadataValue","OrdinaryOwnMetadataKeys","obj","method","GetMethod","IsCallable","TypeError","IsObject","GetIterator","k","IteratorStep","IteratorClose","x","IsNull","ToPropertyKey","argument","input","PreferredType","exoticToPrim","hint","toString_1","OrdinaryToPrimitive","ToPrimitive","ToString","IsArray","IsConstructor","V","func","OrdinaryGetPrototypeOf","proto","prototypeProto","__","decorators","propertyKey","decorated","decorator","DecorateConstructor","descriptor","DecorateProperty","metadataKey","metadataValue","IsPropertyKey","OrdinaryHasMetadata","OrdinaryGetMetadata","OrdinaryMetadataKeys","ownKeys","parentKeys","ownKeys_1","_a","parentKeys_1"],"mappings":"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","file":"multi-item-edit-form-component.0dbe2710693dca4cdc8a.js","sourcesContent":["/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nexport default baseTimes;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  var type = typeof value;\n  length = length == null ? MAX_SAFE_INTEGER : length;\n\n  return !!length &&\n    (type == 'number' ||\n      (type != 'symbol' && reIsUint.test(value))) &&\n        (value > -1 && value % 1 == 0 && value < length);\n}\n\nexport default isIndex;\n","import baseTimes from './_baseTimes.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\nimport isBuffer from './isBuffer.js';\nimport isIndex from './_isIndex.js';\nimport isTypedArray from './isTypedArray.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default arrayLikeKeys;\n","export function loadScripts(scriptObjects: ScriptObject[], callback: () => any, iteration = 0) {\r\n  const isLast = scriptObjects.length === iteration + 1;\r\n  const newCallback = isLast ? callback : loadScripts.bind(this, scriptObjects, callback, iteration + 1);\r\n  const scrObj = scriptObjects[iteration];\r\n\r\n  const global = typeof scrObj.test === 'string' ? scrObj.test : null;\r\n  const test = typeof scrObj.test === 'function' ? scrObj.test : null;\r\n\r\n  if (global != null && !!(window as any)[global]) {\r\n    callback();\r\n    return;\r\n  }\r\n\r\n  if (test != null && test()) {\r\n    callback();\r\n    return;\r\n  }\r\n\r\n  const scriptInDom: HTMLScriptElement = document.querySelector(`script[src=\"${scrObj.src}\"]`);\r\n  if (scriptInDom) {\r\n    scriptInDom.addEventListener('load', newCallback, { once: true });\r\n    return;\r\n  }\r\n\r\n  const scriptEl = document.createElement('script');\r\n  scriptEl.src = scrObj.src;\r\n  scriptEl.addEventListener('load', newCallback, { once: true });\r\n  document.head.appendChild(scriptEl);\r\n}\r\n\r\nexport class ScriptObject {\r\n  /** window.xxx or a function that returns a boolean */\r\n  test: string | (() => boolean);\r\n  src: string;\r\n}\r\n","import baseGetAllKeys from './_baseGetAllKeys.js';\nimport getSymbols from './_getSymbols.js';\nimport keys from './keys.js';\n\n/**\n * Creates an array of own enumerable property names and symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeys(object) {\n  return baseGetAllKeys(object, keys, getSymbols);\n}\n\nexport default getAllKeys;\n","import getNative from './_getNative.js';\n\n/* Built-in method references that are verified to be native. */\nvar nativeCreate = getNative(Object, 'create');\n\nexport default nativeCreate;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\nexport default hashGet;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n}\n\nexport default hashHas;\n","import hashClear from './_hashClear.js';\nimport hashDelete from './_hashDelete.js';\nimport hashGet from './_hashGet.js';\nimport hashHas from './_hashHas.js';\nimport hashSet from './_hashSet.js';\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\nexport default Hash;\n","import nativeCreate from './_nativeCreate.js';\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n  this.size = 0;\n}\n\nexport default hashClear;\n","/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nexport default hashDelete;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  this.size += this.has(key) ? 0 : 1;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\nexport default hashSet;\n","import isKeyable from './_isKeyable.js';\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\nexport default getMapData;\n","/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\nexport default isKeyable;\n","import mapCacheClear from './_mapCacheClear.js';\nimport mapCacheDelete from './_mapCacheDelete.js';\nimport mapCacheGet from './_mapCacheGet.js';\nimport mapCacheHas from './_mapCacheHas.js';\nimport mapCacheSet from './_mapCacheSet.js';\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\nexport default MapCache;\n","import Hash from './_Hash.js';\nimport ListCache from './_ListCache.js';\nimport Map from './_Map.js';\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.size = 0;\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\nexport default mapCacheClear;\n","import getMapData from './_getMapData.js';\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  var result = getMapData(this, key)['delete'](key);\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nexport default mapCacheDelete;\n","import getMapData from './_getMapData.js';\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\nexport default mapCacheGet;\n","import getMapData from './_getMapData.js';\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\nexport default mapCacheHas;\n","import getMapData from './_getMapData.js';\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  var data = getMapData(this, key),\n      size = data.size;\n\n  data.set(key, value);\n  this.size += data.size == size ? 0 : 1;\n  return this;\n}\n\nexport default mapCacheSet;\n","import ListCache from './_ListCache.js';\nimport stackClear from './_stackClear.js';\nimport stackDelete from './_stackDelete.js';\nimport stackGet from './_stackGet.js';\nimport stackHas from './_stackHas.js';\nimport stackSet from './_stackSet.js';\n\n/**\n * Creates a stack cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Stack(entries) {\n  var data = this.__data__ = new ListCache(entries);\n  this.size = data.size;\n}\n\n// Add methods to `Stack`.\nStack.prototype.clear = stackClear;\nStack.prototype['delete'] = stackDelete;\nStack.prototype.get = stackGet;\nStack.prototype.has = stackHas;\nStack.prototype.set = stackSet;\n\nexport default Stack;\n","import ListCache from './_ListCache.js';\n\n/**\n * Removes all key-value entries from the stack.\n *\n * @private\n * @name clear\n * @memberOf Stack\n */\nfunction stackClear() {\n  this.__data__ = new ListCache;\n  this.size = 0;\n}\n\nexport default stackClear;\n","/**\n * Removes `key` and its value from the stack.\n *\n * @private\n * @name delete\n * @memberOf Stack\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction stackDelete(key) {\n  var data = this.__data__,\n      result = data['delete'](key);\n\n  this.size = data.size;\n  return result;\n}\n\nexport default stackDelete;\n","/**\n * Gets the stack value for `key`.\n *\n * @private\n * @name get\n * @memberOf Stack\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction stackGet(key) {\n  return this.__data__.get(key);\n}\n\nexport default stackGet;\n","/**\n * Checks if a stack value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Stack\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction stackHas(key) {\n  return this.__data__.has(key);\n}\n\nexport default stackHas;\n","import ListCache from './_ListCache.js';\nimport Map from './_Map.js';\nimport MapCache from './_MapCache.js';\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * Sets the stack `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Stack\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the stack cache instance.\n */\nfunction stackSet(key, value) {\n  var data = this.__data__;\n  if (data instanceof ListCache) {\n    var pairs = data.__data__;\n    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n      pairs.push([key, value]);\n      this.size = ++data.size;\n      return this;\n    }\n    data = this.__data__ = new MapCache(pairs);\n  }\n  data.set(key, value);\n  this.size = data.size;\n  return this;\n}\n\nexport default stackSet;\n","import arrayLikeKeys from './_arrayLikeKeys.js';\nimport baseKeys from './_baseKeys.js';\nimport isArrayLike from './isArrayLike.js';\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nexport default keys;\n","/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\nexport default listCacheClear;\n","import eq from './eq.js';\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\nexport default assocIndexOf;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/** Built-in value references. */\nvar splice = arrayProto.splice;\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  --this.size;\n  return true;\n}\n\nexport default listCacheDelete;\n","import listCacheClear from './_listCacheClear.js';\nimport listCacheDelete from './_listCacheDelete.js';\nimport listCacheGet from './_listCacheGet.js';\nimport listCacheHas from './_listCacheHas.js';\nimport listCacheSet from './_listCacheSet.js';\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\nexport default ListCache;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\nexport default listCacheGet;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\nexport default listCacheHas;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    ++this.size;\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\nexport default listCacheSet;\n","/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nexport default eq;\n","/**\n * This method returns a new empty array.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {Array} Returns the new empty array.\n * @example\n *\n * var arrays = _.times(2, _.stubArray);\n *\n * console.log(arrays);\n * // => [[], []]\n *\n * console.log(arrays[0] === arrays[1]);\n * // => false\n */\nfunction stubArray() {\n  return [];\n}\n\nexport default stubArray;\n","/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\nexport default arrayPush;\n","/** PURE_IMPORTS_START tslib,_fromArray,_util_isArray,_Subscriber,_OuterSubscriber,_util_subscribeToResult,_.._internal_symbol_iterator PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { fromArray } from './fromArray';\nimport { isArray } from '../util/isArray';\nimport { Subscriber } from '../Subscriber';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\nimport { iterator as Symbol_iterator } from '../../internal/symbol/iterator';\nexport function zip() {\n    var observables = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        observables[_i] = arguments[_i];\n    }\n    var resultSelector = observables[observables.length - 1];\n    if (typeof resultSelector === 'function') {\n        observables.pop();\n    }\n    return fromArray(observables, undefined).lift(new ZipOperator(resultSelector));\n}\nvar ZipOperator = /*@__PURE__*/ (function () {\n    function ZipOperator(resultSelector) {\n        this.resultSelector = resultSelector;\n    }\n    ZipOperator.prototype.call = function (subscriber, source) {\n        return source.subscribe(new ZipSubscriber(subscriber, this.resultSelector));\n    };\n    return ZipOperator;\n}());\nexport { ZipOperator };\nvar ZipSubscriber = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(ZipSubscriber, _super);\n    function ZipSubscriber(destination, resultSelector, values) {\n        if (values === void 0) {\n            values = Object.create(null);\n        }\n        var _this = _super.call(this, destination) || this;\n        _this.iterators = [];\n        _this.active = 0;\n        _this.resultSelector = (typeof resultSelector === 'function') ? resultSelector : null;\n        _this.values = values;\n        return _this;\n    }\n    ZipSubscriber.prototype._next = function (value) {\n        var iterators = this.iterators;\n        if (isArray(value)) {\n            iterators.push(new StaticArrayIterator(value));\n        }\n        else if (typeof value[Symbol_iterator] === 'function') {\n            iterators.push(new StaticIterator(value[Symbol_iterator]()));\n        }\n        else {\n            iterators.push(new ZipBufferIterator(this.destination, this, value));\n        }\n    };\n    ZipSubscriber.prototype._complete = function () {\n        var iterators = this.iterators;\n        var len = iterators.length;\n        this.unsubscribe();\n        if (len === 0) {\n            this.destination.complete();\n            return;\n        }\n        this.active = len;\n        for (var i = 0; i < len; i++) {\n            var iterator = iterators[i];\n            if (iterator.stillUnsubscribed) {\n                var destination = this.destination;\n                destination.add(iterator.subscribe(iterator, i));\n            }\n            else {\n                this.active--;\n            }\n        }\n    };\n    ZipSubscriber.prototype.notifyInactive = function () {\n        this.active--;\n        if (this.active === 0) {\n            this.destination.complete();\n        }\n    };\n    ZipSubscriber.prototype.checkIterators = function () {\n        var iterators = this.iterators;\n        var len = iterators.length;\n        var destination = this.destination;\n        for (var i = 0; i < len; i++) {\n            var iterator = iterators[i];\n            if (typeof iterator.hasValue === 'function' && !iterator.hasValue()) {\n                return;\n            }\n        }\n        var shouldComplete = false;\n        var args = [];\n        for (var i = 0; i < len; i++) {\n            var iterator = iterators[i];\n            var result = iterator.next();\n            if (iterator.hasCompleted()) {\n                shouldComplete = true;\n            }\n            if (result.done) {\n                destination.complete();\n                return;\n            }\n            args.push(result.value);\n        }\n        if (this.resultSelector) {\n            this._tryresultSelector(args);\n        }\n        else {\n            destination.next(args);\n        }\n        if (shouldComplete) {\n            destination.complete();\n        }\n    };\n    ZipSubscriber.prototype._tryresultSelector = function (args) {\n        var result;\n        try {\n            result = this.resultSelector.apply(this, args);\n        }\n        catch (err) {\n            this.destination.error(err);\n            return;\n        }\n        this.destination.next(result);\n    };\n    return ZipSubscriber;\n}(Subscriber));\nexport { ZipSubscriber };\nvar StaticIterator = /*@__PURE__*/ (function () {\n    function StaticIterator(iterator) {\n        this.iterator = iterator;\n        this.nextResult = iterator.next();\n    }\n    StaticIterator.prototype.hasValue = function () {\n        return true;\n    };\n    StaticIterator.prototype.next = function () {\n        var result = this.nextResult;\n        this.nextResult = this.iterator.next();\n        return result;\n    };\n    StaticIterator.prototype.hasCompleted = function () {\n        var nextResult = this.nextResult;\n        return nextResult && nextResult.done;\n    };\n    return StaticIterator;\n}());\nvar StaticArrayIterator = /*@__PURE__*/ (function () {\n    function StaticArrayIterator(array) {\n        this.array = array;\n        this.index = 0;\n        this.length = 0;\n        this.length = array.length;\n    }\n    StaticArrayIterator.prototype[Symbol_iterator] = function () {\n        return this;\n    };\n    StaticArrayIterator.prototype.next = function (value) {\n        var i = this.index++;\n        var array = this.array;\n        return i < this.length ? { value: array[i], done: false } : { value: null, done: true };\n    };\n    StaticArrayIterator.prototype.hasValue = function () {\n        return this.array.length > this.index;\n    };\n    StaticArrayIterator.prototype.hasCompleted = function () {\n        return this.array.length === this.index;\n    };\n    return StaticArrayIterator;\n}());\nvar ZipBufferIterator = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(ZipBufferIterator, _super);\n    function ZipBufferIterator(destination, parent, observable) {\n        var _this = _super.call(this, destination) || this;\n        _this.parent = parent;\n        _this.observable = observable;\n        _this.stillUnsubscribed = true;\n        _this.buffer = [];\n        _this.isComplete = false;\n        return _this;\n    }\n    ZipBufferIterator.prototype[Symbol_iterator] = function () {\n        return this;\n    };\n    ZipBufferIterator.prototype.next = function () {\n        var buffer = this.buffer;\n        if (buffer.length === 0 && this.isComplete) {\n            return { value: null, done: true };\n        }\n        else {\n            return { value: buffer.shift(), done: false };\n        }\n    };\n    ZipBufferIterator.prototype.hasValue = function () {\n        return this.buffer.length > 0;\n    };\n    ZipBufferIterator.prototype.hasCompleted = function () {\n        return this.buffer.length === 0 && this.isComplete;\n    };\n    ZipBufferIterator.prototype.notifyComplete = function () {\n        if (this.buffer.length > 0) {\n            this.isComplete = true;\n            this.parent.notifyInactive();\n        }\n        else {\n            this.destination.complete();\n        }\n    };\n    ZipBufferIterator.prototype.notifyNext = function (outerValue, innerValue, outerIndex, innerIndex, innerSub) {\n        this.buffer.push(innerValue);\n        this.parent.checkIterators();\n    };\n    ZipBufferIterator.prototype.subscribe = function (value, index) {\n        return subscribeToResult(this, this.observable, this, index);\n    };\n    return ZipBufferIterator;\n}(OuterSubscriber));\n//# sourceMappingURL=zip.js.map\n","import { Input, OnInit, OnDestroy } from '@angular/core';\r\nimport { FormGroup, AbstractControl } from '@angular/forms';\r\nimport { Observable, Subscription } from 'rxjs';\r\nimport { map, startWith, filter, distinctUntilChanged } from 'rxjs/operators';\r\n\r\nimport { FieldConfigSet } from '../../../eav-dynamic-form/model/field-config';\r\nimport { Field } from '../../../eav-dynamic-form/model/field';\r\nimport { FieldSettings } from '../../../../edit-types';\r\nimport { EavService } from '../../../shared/services/eav.service';\r\nimport { ValidationHelper } from '../../validators/validation-helper';\r\nimport { ValidationMessagesService } from '../../validators/validation-messages-service';\r\n\r\nexport class BaseComponent<T> implements Field, OnInit, OnDestroy {\r\n  @Input() config: FieldConfigSet;\r\n  @Input() group: FormGroup;\r\n\r\n  control: AbstractControl;\r\n  settings$: Observable<FieldSettings>;\r\n  label$: Observable<string>;\r\n  placeholder$: Observable<string>;\r\n  value$: Observable<T>;\r\n  disabled$: Observable<boolean>;\r\n  required$: Observable<boolean>;\r\n  invalid$: Observable<boolean>;\r\n  showValidation$: Observable<AbstractControl>;\r\n  subscription = new Subscription();\r\n\r\n  constructor(public eavService: EavService, public validationMessagesService: ValidationMessagesService) { }\r\n\r\n  ngOnInit() {\r\n    this.control = this.group.controls[this.config.field.name];\r\n    this.settings$ = this.config.field.settings$;\r\n    this.label$ = this.settings$.pipe(map(settings => settings.Name));\r\n    this.placeholder$ = this.settings$.pipe(map(settings => settings.Placeholder));\r\n    this.required$ = this.settings$.pipe(map(settings => ValidationHelper.isRequired(settings)));\r\n    this.invalid$ = this.control.statusChanges.pipe(map(status => status === 'INVALID'), startWith(this.control.invalid));\r\n    this.showValidation$ = this.validationMessagesService.showValidation$.pipe(filter(control => control === this.control));\r\n    // doesn't work because controls are sometimes updated without emitting change (e.g. on language change)\r\n    // this.value$ = this.control.valueChanges.pipe(\r\n    //   startWith(this.control.value)\r\n    // );\r\n    // this.status$ = this.control.statusChanges.pipe(\r\n    //   startWith(this.control.status)\r\n    // );\r\n    this.value$ = this.eavService.formValueChange$.pipe(\r\n      filter(formSet => (formSet.formId === this.config.form.formId) && (formSet.entityGuid === this.config.entity.entityGuid)),\r\n      map(formSet => this.control.value),\r\n      startWith(this.control.value),\r\n      distinctUntilChanged(),\r\n    );\r\n    this.disabled$ = this.eavService.formDisabledChange$.asObservable().pipe(\r\n      filter(formDisabledSet => (formDisabledSet.formId === this.config.form.formId)\r\n        && (formDisabledSet.entityGuid === this.config.entity.entityGuid)\r\n      ),\r\n      map(formSet => this.control.disabled),\r\n      startWith(this.control.disabled),\r\n      distinctUntilChanged(),\r\n    );\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.subscription.unsubscribe();\r\n  }\r\n}\r\n","import { AdamConfig } from '../../../../edit-types';\r\n\r\nexport class AdamConfigInstance implements AdamConfig {\r\n  //#region Field settings\r\n  rootSubfolder = '';\r\n  fileFilter = '';\r\n  allowAssetsInRoot = true;\r\n  folderDepth = 0;\r\n  metadataContentTypes = '';\r\n  //#endregion\r\n\r\n  //#region Toggle\r\n  usePortalRoot = false;\r\n  showImagesOnly = false;\r\n  //#endregion\r\n\r\n  //#region Calculated\r\n  autoLoad = false;\r\n  enableSelect = true;\r\n  subfolder = '';\r\n  allowEdit = true;\r\n  disabled = true;\r\n  maxDepthReached = false;\r\n  //#endregion\r\n\r\n  constructor(disabled: boolean) {\r\n    this.disabled = disabled;\r\n  }\r\n}\r\n","export class Feature {\r\n  constructor(\r\n    public enabled: boolean,\r\n    public expires: string,\r\n    public id: string,\r\n    public isPublic: boolean,\r\n    public ui: boolean,\r\n  ) {\r\n    this.enabled = enabled;\r\n    this.expires = expires;\r\n    this.id = id;\r\n    this.isPublic = isPublic;\r\n    this.ui = ui;\r\n  }\r\n\r\n  /**\r\n   * Features array from service have one different key.\r\n   * Key 'public' is converted to 'isPublic' ('public' is a reserved word in strict mode)\r\n   */\r\n  public static createFeatureArray(features: any[]) {\r\n    const featureList: Feature[] = [];\r\n    features.forEach(f => {\r\n      featureList.push(new Feature(f.enabled, f.expires, f.id, f.public, f.ui));\r\n    });\r\n    return featureList;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { EntityCollectionServiceBase, EntityCollectionServiceElementsFactory } from '@ngrx/data';\r\nimport { take } from 'rxjs/operators';\r\n\r\nimport { Feature } from '../../models/feature/feature';\r\n\r\n@Injectable({ providedIn: 'root' })\r\nexport class FeatureService extends EntityCollectionServiceBase<Feature> {\r\n  constructor(serviceElementsFactory: EntityCollectionServiceElementsFactory) {\r\n    super('Feature', serviceElementsFactory);\r\n  }\r\n\r\n  loadFeatures(features: any[]) {\r\n    const featureList: Feature[] = Feature.createFeatureArray(features);\r\n    this.addAllToCache(featureList);\r\n  }\r\n\r\n  isFeatureEnabled(guid: string) {\r\n    let isEnabled = false;\r\n    this.entities$.pipe(take(1)).subscribe(features => {\r\n      const feature = features.find(ftr => ftr.id === guid);\r\n      if (feature != null) {\r\n        isEnabled = feature.enabled;\r\n      }\r\n    });\r\n    return isEnabled;\r\n  }\r\n}\r\n","import { Directive, Input, ElementRef, OnInit, OnDestroy } from '@angular/core';\r\n\r\nimport { FieldConfigSet } from '../../eav-dynamic-form/model/field-config';\r\nimport { FeatureService } from '../store/ngrx-data/feature.service';\r\nimport { FeaturesGuidsConstants } from '../../../shared/features-guids.constants';\r\nimport { ElementEventListener } from '../../../shared/element-event-listener.model';\r\nimport { PasteClipboardImageEventDetail } from '../models/adam/paste-clipboard-image';\r\nimport { angularConsoleLog } from '../../../ng-dialogs/src/app/shared/helpers/angular-console-log.helper';\r\n\r\n@Directive({ selector: '[appPasteClipboardImage]' })\r\nexport class PasteClipboardImageDirective implements OnInit, OnDestroy {\r\n  @Input() config: FieldConfigSet;\r\n  @Input() elementType: string;\r\n  private eventListeners: ElementEventListener[] = [];\r\n\r\n  constructor(private elementRef: ElementRef, private featureService: FeatureService) { }\r\n\r\n  ngOnInit() {\r\n    if (!this.featureService.isFeatureEnabled(FeaturesGuidsConstants.PasteImageFromClipboard)) { return; }\r\n\r\n    switch (this.elementType) {\r\n      case 'input':\r\n        this.elementRef.nativeElement.pastableTextarea();\r\n        break;\r\n      case 'element':\r\n        this.elementRef.nativeElement.pastableNonInputable();\r\n        break;\r\n    }\r\n    const handleImageBound = this.handleImage.bind(this);\r\n    this.elementRef.nativeElement.addEventListener('handleImage', handleImageBound);\r\n\r\n    this.eventListeners.push(\r\n      { element: this.elementRef.nativeElement, type: 'handleImage', listener: handleImageBound },\r\n    );\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    // spm 2019-10-24 paste.js which handles clipboard paste doesn't destroy listeners\r\n    this.eventListeners.forEach(eventListener => {\r\n      const element = eventListener.element;\r\n      const type = eventListener.type;\r\n      const listener = eventListener.listener;\r\n      element.removeEventListener(type, listener);\r\n    });\r\n  }\r\n\r\n  private handleImage(event: CustomEvent) {\r\n    angularConsoleLog('PASTE IMAGE', 'event:', event);\r\n    // todo: convert png to jpg to reduce file size\r\n    const image = this.getFile(event.detail as PasteClipboardImageEventDetail);\r\n    this.config.dropzone.uploadFile(image);\r\n  }\r\n\r\n  private getFile(data: PasteClipboardImageEventDetail) {\r\n    let newFile = data.file; // for fallback\r\n\r\n    try {\r\n      // File.name is readonly so we do this\r\n      const formData = new FormData();\r\n      formData.append('file', data.file, data.imageFileName);\r\n      newFile = formData.get('file') as File;\r\n    } catch (e) {\r\n      console.error('paste image error', e);\r\n    }\r\n    return newFile;\r\n  }\r\n}\r\n","export const FeaturesGuidsConstants = {\r\n    PasteWithFormatting: '1b13e0e6-a346-4454-a1e6-2fb18c047d20',\r\n    PasteImageFromClipboard: 'f6b8d6da-4744-453b-9543-0de499aa2352',\r\n};\r\n","<ng-container *ngIf=\"{\r\n  adamConfig: adamConfig$ | async,\r\n  disabled: disabled$ | async\r\n  } as data\">\r\n  <div class=\"dropzone\" [@adamShowAnimate]=\"data.adamConfig?.autoLoad ? 'open' : 'closed'\">\r\n    <div *ngIf=\"data.adamConfig?.autoLoad && (expanded$ | async)\" [ngClass]=\"{\r\n    'adam-scope-site': data.adamConfig.usePortalRoot,\r\n    'adam-scope-field': !data.adamConfig.usePortalRoot\r\n  }\">\r\n\r\n      <!-- click to upload -->\r\n      <div\r\n        *ngIf=\"!data.disabled && data.adamConfig.allowEdit && !((data.adamConfig.subfolder === '' || data.adamConfig.usePortalRoot && data.adamConfig.subfolder === data.adamConfig.rootSubfolder) && !data.adamConfig.allowAssetsInRoot)\"\r\n        class=\"dz-preview dropzone-adam\" (click)=\"openUploadClick($event)\"\r\n        [matTooltip]=\"'Fields.Hyperlink.AdamFileManager.UploadTip' | translate\">\r\n        <div class=\"dz-image adam-browse-background-icon adam-browse-background\">\r\n          <mat-icon>cloud_upload</mat-icon>\r\n          <div class=\"adam-upload-label\">\r\n            {{ 'Fields.Hyperlink.AdamFileManager.UploadLabel' | translate }}\r\n            &nbsp;\r\n            <mat-icon *ngIf=\"data.adamConfig.usePortalRoot\">public</mat-icon>\r\n            <mat-icon *ngIf=\"!data.adamConfig.usePortalRoot\" svgIcon=\"appleFilled\"></mat-icon>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- paste image from clipboard -->\r\n      <div #pasteDiv\r\n        *ngIf=\"pasteClipboardImage && !data.disabled && data.adamConfig.allowEdit && !((data.adamConfig.subfolder === '' || data.adamConfig.usePortalRoot && data.adamConfig.subfolder === data.adamConfig.rootSubfolder) && !data.adamConfig.allowAssetsInRoot)\"\r\n        appPasteClipboardImage [config]=\"config\" [elementType]=\"'element'\" class=\"dz-preview dropzone-adam paste-image\"\r\n        [matTooltip]=\"'Fields.Hyperlink.AdamFileManager.UploadPasteTip' | translate\">\r\n        <div class=\"dz-image adam-browse-background-icon adam-browse-background\">\r\n          <mat-icon>filter</mat-icon>\r\n          <div *ngIf=\"!pasteDiv.classList.contains('pastable-focus')\" class=\"adam-upload-label\">\r\n            {{ 'Fields.Hyperlink.AdamFileManager.UploadPasteLabel' | translate }}\r\n          </div>\r\n          <div *ngIf=\"pasteDiv.classList.contains('pastable-focus')\" class=\"adam-upload-label\">\r\n            {{ 'Fields.Hyperlink.AdamFileManager.UploadPasteFocusedLabel' | translate }}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- add folder -->\r\n      <div\r\n        *ngIf=\"!data.adamConfig.maxDepthReached && !data.disabled && data.adamConfig.allowEdit && !((data.adamConfig.subfolder === '' || data.adamConfig.usePortalRoot && data.adamConfig.subfolder === data.adamConfig.rootSubfolder) && !data.adamConfig.allowAssetsInRoot)\"\r\n        class=\"dz-preview\" (click)=\"addFolder()\"\r\n        [matTooltip]=\"'Fields.Hyperlink.AdamFileManager.NewFolderTip' | translate\">\r\n        <div class=\"dz-image adam-browse-background-icon adam-browse-background\">\r\n          <mat-icon svgIcon=\"folder-plus\"></mat-icon>\r\n          <div class=\"adam-short-label\">{{ 'Fields.Hyperlink.AdamFileManager.NewFolder' | translate }}</div>\r\n        </div>\r\n        <div class=\"dz-details\" style=\"opacity: 1\"></div>\r\n      </div>\r\n\r\n      <!-- browse up a folder -->\r\n      <ng-container\r\n        *ngIf=\"data.adamConfig.subfolder !== '' || data.adamConfig.usePortalRoot && data.adamConfig.subfolder !== data.adamConfig.rootSubfolder\">\r\n        <div class=\"dz-preview\" (click)=\"goUp()\"\r\n          [matTooltip]=\"'Fields.Hyperlink.AdamFileManager.BackFolderTip' | translate\">\r\n          <div class=\"dz-image adam-browse-background-icon adam-browse-background\">\r\n            <mat-icon svgIcon=\"folder\"></mat-icon>\r\n            <div class=\"adam-short-label\">{{ 'Fields.Hyperlink.AdamFileManager.BackFolder' | translate }}</div>\r\n          </div>\r\n          <div class=\"adam-background adam-browse-background-icon\">\r\n            <mat-icon class=\"adam-back-folder-arrow\">arrow_back</mat-icon>\r\n          </div>\r\n        </div>\r\n      </ng-container>\r\n\r\n      <ng-container *ngFor=\"let item of (items$ | async); trackBy: trackByFn\">\r\n        <!-- folders -->\r\n        <ng-container *ngIf=\"item.IsFolder\">\r\n          <div class=\"dz-preview\" (click)=\"goIntoFolder(item)\">\r\n            <div class=\"dz-image adam-blur adam-browse-background-icon adam-browse-background\">\r\n              <mat-icon svgIcon=\"folder\"></mat-icon>\r\n              <div class=\"short-label\">{{ item.Name }}</div>\r\n            </div>\r\n            <div class=\"dz-details file-type-{{ item.Type }}\">\r\n              <mat-icon *ngIf=\"data.adamConfig.allowEdit\" (click)=\"del(item)\" appClickStopPropagation\r\n                class=\"adam-delete-button\" [matTooltip]=\"'Fields.Hyperlink.AdamFileManager.Delete' | translate\"\r\n                [ngClass]=\"{\r\n                'adam-button-disabled': data.disabled\r\n              }\">clear\r\n              </mat-icon>\r\n              <mat-icon *ngIf=\"data.adamConfig.allowEdit\" (click)=\"rename(item)\" appClickStopPropagation\r\n                class=\"adam-rename-button\" [matTooltip]=\"'Fields.Hyperlink.AdamFileManager.Edit' | translate\" [ngClass]=\"{\r\n                'adam-button-disabled': data.disabled\r\n              }\">edit\r\n              </mat-icon>\r\n              <div class=\"adam-full-name-area\">\r\n                <div class=\"adam-full-name\" [title]=\"item.Name\">{{ item.Name }}</div>\r\n              </div>\r\n            </div>\r\n            <mat-icon class=\"adam-tag\" [ngClass]=\"{ 'metadata-exists': item.MetadataId > 0 }\"\r\n              (click)=\"editItemMetadata(item)\" matTooltip=\"{{ item._metadataContentType }}: {{ item.MetadataId }}\"\r\n              appClickStopPropagation *ngIf=\"item._metadataContentType\">local_offer</mat-icon>\r\n          </div>\r\n        </ng-container>\r\n\r\n        <!-- files -->\r\n        <ng-container *ngIf=\"!item.IsFolder\">\r\n          <div class=\"dz-preview\" (click)=\"select(item)\" [ngClass]=\"{\r\n            'dz-success': (value$ | async) === 'file:' + item.Id,\r\n            'disable-select': !data.adamConfig.enableSelect\r\n          }\">\r\n            <div *ngIf=\"item.Type !== 'image'\"\r\n              class=\"dz-image adam-blur adam-browse-background-icon adam-browse-background\">\r\n              <mat-icon *ngIf=\"item._isMaterialIcon\">{{ item._icon }}</mat-icon>\r\n              <mat-icon *ngIf=\"!item._isMaterialIcon\" [svgIcon]=\"item._icon\"></mat-icon>\r\n              <div class=\"adam-short-label\">{{ item.Name }}</div>\r\n            </div>\r\n            <div *ngIf=\"item.Type === 'image'\" class=\"dz-image adam-browse-background-image\">\r\n              <img data-dz-thumbnail=\"\" [alt]=\"item.Id + ':' + item.Name\"\r\n                [src]=\"item.FullPath + '?w=120&h=120&mode=crop'\">\r\n            </div>\r\n\r\n            <div class=\"dz-details file-type-{{ item.Type }}\">\r\n              <mat-icon *ngIf=\"data.adamConfig.allowEdit\" (click)=\"del(item)\" appClickStopPropagation\r\n                class=\"adam-delete-button\" [matTooltip]=\"'Fields.Hyperlink.AdamFileManager.Delete' | translate\"\r\n                [ngClass]=\"{\r\n                'adam-button-disabled': data.disabled\r\n              }\">clear\r\n              </mat-icon>\r\n              <mat-icon *ngIf=\"data.adamConfig.allowEdit\" (click)=\"rename(item)\" appClickStopPropagation\r\n                class=\"adam-rename-button\" [matTooltip]=\"'Fields.Hyperlink.AdamFileManager.Edit' | translate\" [ngClass]=\"{\r\n                'adam-button-disabled': data.disabled\r\n              }\">edit\r\n              </mat-icon>\r\n              <div class=\"adam-full-name-area\">\r\n                <div class=\"adam-full-name\" [title]=\"item.Name\">{{ item.Name }}</div>\r\n              </div>\r\n              <div class=\"dz-filename adam-short-label\" appClickStopPropagation\r\n                title=\"#{{ item.Id }} - {{ item._displaySize }} KB\">\r\n                <span>#{{ item.Id }} - {{ item._displaySize }} KB</span>\r\n              </div>\r\n              <a class=\"adam-link-button\" target=\"_blank\" [href]=\"item.FullPath\" appClickStopPropagation>\r\n                <mat-icon [matTooltip]=\"'Fields.Hyperlink.AdamFileManager.Show' | translate\">open_in_new</mat-icon>\r\n              </a>\r\n            </div>\r\n            <mat-icon class=\"adam-tag\" [ngClass]=\"{ 'metadata-exists': item.MetadataId > 0 }\"\r\n              (click)=\"editItemMetadata(item)\" *ngIf=\"item._metadataContentType\" appClickStopPropagation\r\n              matTooltip=\"{{ item._metadataContentType }}: {{ item.MetadataId }}\">local_offer</mat-icon>\r\n\r\n            <div class=\"dz-success-mark\">\r\n              <svg width=\"54px\" height=\"54px\" viewBox=\"0 0 54 54\" version=\"1.1\" xmlns=\"https://www.w3.org/2000/svg\"\r\n                xmlns:xlink=\"https://www.w3.org/1999/xlink\" xmlns:sketch=\"https://www.bohemiancoding.com/sketch/ns\">\r\n                <title>Check</title>\r\n                <defs></defs>\r\n                <g id=\"Page-1\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" sketch:type=\"MSPage\">\r\n                  <path\r\n                    d=\"M23.5,31.8431458 L17.5852419,25.9283877 C16.0248253,24.3679711 13.4910294,24.366835 11.9289322,25.9289322 C10.3700136,27.4878508 10.3665912,30.0234455 11.9283877,31.5852419 L20.4147581,40.0716123 C20.5133999,40.1702541 20.6159315,40.2626649 20.7218615,40.3488435 C22.2835669,41.8725651 24.794234,41.8626202 26.3461564,40.3106978 L43.3106978,23.3461564 C44.8771021,21.7797521 44.8758057,19.2483887 43.3137085,17.6862915 C41.7547899,16.1273729 39.2176035,16.1255422 37.6538436,17.6893022 L23.5,31.8431458 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z\"\r\n                    id=\"Oval-2\" stroke-opacity=\"0.198794158\" stroke=\"#747474\" fill-opacity=\"0.816519475\" fill=\"#FFFFFF\"\r\n                    sketch:type=\"MSShapeGroup\"></path>\r\n                </g>\r\n              </svg>\r\n            </div>\r\n          </div>\r\n        </ng-container>\r\n      </ng-container>\r\n    </div>\r\n  </div>\r\n</ng-container>\r\n","import { Component, OnInit, Input, Output, EventEmitter, OnDestroy, ChangeDetectionStrategy, NgZone } from '@angular/core';\r\nimport { trigger, state, style, transition, animate } from '@angular/animations';\r\nimport { FormGroup, AbstractControl } from '@angular/forms';\r\nimport { Observable, Subscription, BehaviorSubject } from 'rxjs';\r\nimport { filter, map, startWith, distinctUntilChanged } from 'rxjs/operators';\r\nimport { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\n\r\nimport { AdamService } from '../adam.service';\r\nimport { FileTypeService } from '../../../shared/services/file-type.service';\r\nimport { FeatureService } from '../../../shared/store/ngrx-data/feature.service';\r\nimport { AdamConfigInstance } from './adam-browser.models';\r\nimport { FieldConfigSet } from '../../../eav-dynamic-form/model/field-config';\r\nimport { eavConstants } from '../../../../ng-dialogs/src/app/shared/constants/eav.constants';\r\nimport { UrlHelper } from '../../../shared/helpers/url-helper';\r\nimport { FeaturesGuidsConstants } from '../../../../shared/features-guids.constants';\r\nimport { EditForm } from '../../../../ng-dialogs/src/app/shared/models/edit-form.model';\r\nimport { EavService } from '../../../shared/services/eav.service';\r\nimport { EditRoutingService } from '../../../shared/services/edit-routing.service';\r\nimport { AdamItem, AdamConfig, DropzoneConfigExt } from '../../../../edit-types';\r\n\r\n@Component({\r\n  // tslint:disable-next-line:component-selector\r\n  selector: 'adam-browser',\r\n  templateUrl: './adam-browser.component.html',\r\n  styleUrls: ['./adam-browser.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n  animations: [\r\n    trigger('adamShowAnimate', [\r\n      state('closed', style({\r\n        height: '0',\r\n        overflow: 'hidden'\r\n      })),\r\n      state('open', style({\r\n        height: '*',\r\n        overflow: 'hidden'\r\n      })),\r\n      transition('closed => open', [\r\n        animate('300ms cubic-bezier(0.4, 0.0, 0.2, 1)'),\r\n      ])\r\n    ])\r\n  ]\r\n})\r\nexport class AdamBrowserComponent implements OnInit, OnDestroy {\r\n  @Input() config: FieldConfigSet;\r\n  @Input() group: FormGroup;\r\n  @Output() openUpload = new EventEmitter<null>();\r\n\r\n  value$: Observable<string>;\r\n  disabled$: Observable<boolean>;\r\n  expanded$: Observable<boolean>;\r\n  adamConfig$ = new BehaviorSubject<AdamConfig>(null);\r\n  items$ = new BehaviorSubject<AdamItem[]>([]);\r\n  pasteClipboardImage: boolean;\r\n\r\n  private control: AbstractControl;\r\n  private url: string;\r\n  private subscription = new Subscription();\r\n\r\n  constructor(\r\n    private adamService: AdamService,\r\n    private fileTypeService: FileTypeService,\r\n    private featureService: FeatureService,\r\n    private dnnContext: DnnContext,\r\n    private eavService: EavService,\r\n    private editRoutingService: EditRoutingService,\r\n    private zone: NgZone,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.control = this.group.controls[this.config.field.name];\r\n    this.refreshOnChildClosed();\r\n    const contentType = this.config.entity.header.ContentTypeName;\r\n    const entityGuid = this.config.entity.header.Guid;\r\n    const field = this.config.field.name;\r\n    this.url = this.dnnContext.$2sxc.http.apiUrl(`app-content/${contentType}/${entityGuid}/${field}`);\r\n    this.pasteClipboardImage = this.featureService.isFeatureEnabled(FeaturesGuidsConstants.PasteImageFromClipboard);\r\n\r\n    // run inside zone to detect changes when called from custom components\r\n    this.config.adam = {\r\n      items$: this.items$.asObservable(),\r\n      toggle: (usePortalRoot, showImagesOnly) => {\r\n        this.zone.run(() => {\r\n          this.toggle(usePortalRoot, showImagesOnly);\r\n        });\r\n      },\r\n      setConfig: (config) => {\r\n        this.zone.run(() => {\r\n          this.setConfig(config);\r\n        });\r\n      },\r\n      getConfig: () => this.adamConfig$.value,\r\n      getConfig$: () => this.adamConfig$.asObservable(),\r\n      onItemClick: () => { return; },\r\n      onItemUpload: () => { return; },\r\n      refresh: () => {\r\n        this.zone.run(() => {\r\n          this.fetchItems();\r\n        });\r\n      },\r\n      addFullPath: (item) => { this.adamService.addFullPath(item); }\r\n    };\r\n    this.subscription.add(this.adamConfig$.subscribe(adamConfig => {\r\n      this.fetchItems();\r\n    }));\r\n    this.expanded$ = this.editRoutingService.isExpanded(this.config.field.index, this.config.entity.entityGuid);\r\n    this.value$ = this.eavService.formValueChange$.pipe(\r\n      filter(formSet => (formSet.formId === this.config.form.formId) && (formSet.entityGuid === this.config.entity.entityGuid)),\r\n      map(formSet => this.control.value),\r\n      startWith(this.control.value),\r\n      distinctUntilChanged(),\r\n    );\r\n    this.disabled$ = this.eavService.formDisabledChange$.asObservable().pipe(\r\n      filter(formDisabledSet => (formDisabledSet.formId === this.config.form.formId)\r\n        && (formDisabledSet.entityGuid === this.config.entity.entityGuid)\r\n      ),\r\n      map(formSet => this.control.disabled),\r\n      startWith(this.control.disabled),\r\n      distinctUntilChanged(),\r\n    );\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.adamConfig$.complete();\r\n    this.items$.complete();\r\n    this.subscription.unsubscribe();\r\n  }\r\n\r\n  addFolder() {\r\n    if (this.control.disabled) { return; }\r\n\r\n    const folderName = window.prompt('Please enter a folder name'); // todo i18n\r\n    if (!folderName) { return; }\r\n\r\n    this.adamService.addFolder(folderName, this.url, this.adamConfig$.value).subscribe(res => {\r\n      this.fetchItems();\r\n    });\r\n  }\r\n\r\n  del(item: AdamItem) {\r\n    if (this.control.disabled) { return; }\r\n\r\n    const ok = window.confirm('Are you sure you want to delete this item?'); // todo i18n\r\n    if (!ok) { return; }\r\n\r\n    this.adamService.deleteItem(item, this.url, this.adamConfig$.value).subscribe(res => {\r\n      this.fetchItems();\r\n    });\r\n  }\r\n\r\n  editItemMetadata(adamItem: AdamItem) {\r\n    const form: EditForm = {\r\n      items: [\r\n        adamItem.MetadataId === 0\r\n          ? {\r\n            ContentTypeName: adamItem._metadataContentType,\r\n            For: {\r\n              Target: eavConstants.metadata.cmsObject.target,\r\n              String: `${adamItem.Type === 'folder' ? 'folder' : 'file'}:${adamItem.Id}`,\r\n            }\r\n          }\r\n          : { EntityId: adamItem.MetadataId }\r\n      ],\r\n    };\r\n    this.editRoutingService.open(this.config.field.index, this.config.entity.entityGuid, form);\r\n  }\r\n\r\n  goUp() {\r\n    let subfolder = this.adamConfig$.value.subfolder;\r\n    subfolder = subfolder.includes('/') ? subfolder.slice(0, subfolder.lastIndexOf('/')) : '';\r\n    this.config.adam.setConfig({ subfolder });\r\n  }\r\n\r\n  private getMetadataContentType(item: AdamItem) {\r\n    let found: string[];\r\n\r\n    // check if it's a folder and if this has a special registration\r\n    if (item.Type === 'folder') {\r\n      found = this.adamConfig$.value.metadataContentTypes.match(/^(folder)(:)([^\\n]*)/im);\r\n      if (found) {\r\n        return found[3];\r\n      } else {\r\n        return null;\r\n      }\r\n    }\r\n\r\n    // check if the extension has a special registration\r\n    // -- not implemented yet\r\n\r\n    // check if the type \"image\" or \"document\" has a special registration\r\n    // -- not implemented yet\r\n\r\n    // nothing found so far, go for the default with nothing as the prefix\r\n    found = this.adamConfig$.value.metadataContentTypes.match(/^([^:\\n]*)(\\n|$)/im);\r\n    if (found) { return found[1]; }\r\n\r\n    // this is if we don't find anything\r\n    return null;\r\n  }\r\n\r\n  goIntoFolder(item: AdamItem) {\r\n    let subfolder = this.adamConfig$.value.subfolder;\r\n    subfolder = subfolder ? `${subfolder}/${item.Name}` : item.Name;\r\n    this.config.adam.setConfig({ subfolder });\r\n  }\r\n\r\n  openUploadClick(event: MouseEvent) {\r\n    this.openUpload.emit();\r\n  }\r\n\r\n  rename(item: AdamItem) {\r\n    if (this.control.disabled) { return; }\r\n\r\n    const newName = window.prompt('Rename the file / folder to: ', item.Name);\r\n    if (!newName) { return; }\r\n\r\n    this.adamService.rename(item, newName, this.url, this.adamConfig$.value).subscribe(res => {\r\n      this.fetchItems();\r\n    });\r\n  }\r\n\r\n  select(item: AdamItem) {\r\n    if (this.control.disabled || !this.adamConfig$.value.enableSelect) { return; }\r\n    this.config.adam.onItemClick(item);\r\n  }\r\n\r\n  private fetchItems() {\r\n    const adamConfig = this.adamConfig$.value;\r\n    if (adamConfig == null) { return; }\r\n    if (!adamConfig.autoLoad) { return; }\r\n    this.adamService.getAll(this.url, adamConfig).subscribe(items => {\r\n      const filteredItems: AdamItem[] = [];\r\n      const allowedFileTypes = adamConfig.fileFilter\r\n        ? adamConfig.fileFilter.split(',').map(extension => extension.replace('*', '').trim())\r\n        : [];\r\n\r\n      for (const item of items) {\r\n        if (item.Name === '.') { // is root\r\n          const allowEdit = item.AllowEdit;\r\n          if (allowEdit !== adamConfig.allowEdit) {\r\n            this.config.adam.setConfig({ allowEdit });\r\n          }\r\n          continue;\r\n        }\r\n        if (item.Name === '2sxc' || item.Name === 'adam') { continue; }\r\n        if (!item.IsFolder && adamConfig.showImagesOnly && item.Type !== 'image') { continue; }\r\n        if (item.IsFolder && adamConfig.maxDepthReached) { continue; }\r\n        if (allowedFileTypes.length > 0) {\r\n          const extension = item.Name.substring(item.Name.lastIndexOf('.'));\r\n          if (!allowedFileTypes.includes(extension)) { continue; }\r\n        }\r\n\r\n        item._metadataContentType = this.getMetadataContentType(item);\r\n        item._icon = this.fileTypeService.getIconClass(item.Name);\r\n        item._isMaterialIcon = this.fileTypeService.isKnownType(item.Name);\r\n        item._displaySize = (item.Size / 1024).toFixed(0);\r\n        filteredItems.push(item);\r\n      }\r\n\r\n      filteredItems.sort((a, b) => a.Name.toLocaleLowerCase().localeCompare(b.Name.toLocaleLowerCase()));\r\n      filteredItems.sort((a, b) => b.IsFolder.toString().localeCompare(a.IsFolder.toString()));\r\n      this.items$.next(filteredItems);\r\n    });\r\n  }\r\n\r\n  private toggle(usePortalRoot: boolean, showImagesOnly: boolean) {\r\n    const newConfig = { ...this.adamConfig$.value, ...{ usePortalRoot, showImagesOnly } };\r\n    if (JSON.stringify(newConfig) === JSON.stringify(this.adamConfig$.value)) {\r\n      newConfig.autoLoad = !newConfig.autoLoad;\r\n    } else if (!newConfig.autoLoad) {\r\n      newConfig.autoLoad = true;\r\n    }\r\n    this.config.adam.setConfig(newConfig);\r\n  }\r\n\r\n  trackByFn(index: number, item: AdamItem) {\r\n    return item.Id;\r\n  }\r\n\r\n  private setConfig(config: Partial<AdamConfig>) {\r\n    // set new values and use old ones where new value is not provided\r\n    const startDisabled = this.config.field.isExternal;\r\n    const oldConfig = (this.adamConfig$.value != null) ? this.adamConfig$.value : new AdamConfigInstance(startDisabled);\r\n    const newConfig = new AdamConfigInstance(startDisabled);\r\n    const newConfigKeys = Object.keys(newConfig);\r\n    for (const key of newConfigKeys) {\r\n      (newConfig as any)[key] = ((config as any)[key] != null) ? (config as any)[key] : (oldConfig as any)[key];\r\n    }\r\n\r\n    // fixes\r\n    const resetSubfolder = oldConfig.usePortalRoot !== newConfig.usePortalRoot;\r\n    if (resetSubfolder) {\r\n      newConfig.subfolder = '';\r\n    }\r\n    if (newConfig.usePortalRoot) {\r\n      const fixBackSlashes = newConfig.rootSubfolder.includes('\\\\');\r\n      if (fixBackSlashes) {\r\n        newConfig.rootSubfolder = newConfig.rootSubfolder.replace(/\\\\/g, '/');\r\n      }\r\n      const fixStartingSlash = newConfig.rootSubfolder.startsWith('/');\r\n      if (fixStartingSlash) {\r\n        newConfig.rootSubfolder = newConfig.rootSubfolder.replace('/', '');\r\n      }\r\n      const fixRoot = !newConfig.subfolder.startsWith(newConfig.rootSubfolder);\r\n      if (fixRoot) {\r\n        newConfig.subfolder = newConfig.rootSubfolder;\r\n      }\r\n      newConfig.maxDepthReached = false; // when using portal root depth is infinite\r\n    }\r\n    if (!newConfig.usePortalRoot) {\r\n      const currentDepth = newConfig.subfolder ? newConfig.subfolder.split('/').length : 0;\r\n      const fixDepth = currentDepth >= newConfig.folderDepth;\r\n      if (fixDepth) {\r\n        let folders = newConfig.subfolder.split('/');\r\n        folders = folders.slice(0, newConfig.folderDepth);\r\n        newConfig.subfolder = folders.join('/');\r\n        newConfig.maxDepthReached = true;\r\n      } else {\r\n        newConfig.maxDepthReached = false;\r\n      }\r\n    }\r\n    this.adamConfig$.next(newConfig);\r\n\r\n    // fix dropzone\r\n    const oldDzConfig = this.config.dropzone.getConfig();\r\n    const newDzConfig: Partial<DropzoneConfigExt> = {};\r\n    const dzUrlParams = UrlHelper.getUrlParams(oldDzConfig.url as string);\r\n    const dzSubfolder = dzUrlParams.subfolder || '';\r\n    const dzUsePortalRoot = dzUrlParams.usePortalRoot;\r\n    const fixUploadUrl = dzSubfolder !== newConfig.subfolder || dzUsePortalRoot !== newConfig.usePortalRoot.toString();\r\n    if (fixUploadUrl) {\r\n      let newUrl = oldDzConfig.url as string;\r\n      newUrl = UrlHelper.replaceUrlParam(newUrl, 'subfolder', newConfig.subfolder);\r\n      newUrl = UrlHelper.replaceUrlParam(newUrl, 'usePortalRoot', newConfig.usePortalRoot.toString());\r\n      newDzConfig.url = newUrl;\r\n    }\r\n    const uploadDisabled = !newConfig.allowEdit\r\n      || (\r\n        (newConfig.subfolder === '' || newConfig.usePortalRoot && newConfig.subfolder === newConfig.rootSubfolder)\r\n        && !newConfig.allowAssetsInRoot\r\n      );\r\n    const fixDisabled = oldDzConfig.disabled !== uploadDisabled;\r\n    if (fixDisabled) {\r\n      newDzConfig.disabled = uploadDisabled;\r\n    }\r\n    if (Object.keys(newDzConfig).length > 0) {\r\n      this.config.dropzone.setConfig(newDzConfig);\r\n    }\r\n  }\r\n\r\n  private refreshOnChildClosed() {\r\n    this.subscription.add(this.editRoutingService.childFormClosed().subscribe(result => {\r\n      this.fetchItems();\r\n    }));\r\n  }\r\n\r\n}\r\n","import { Component, OnInit, ChangeDetectionStrategy } from '@angular/core';\r\n\r\n@Component({\r\n  // tslint:disable-next-line:component-selector\r\n  selector: 'adam-hint',\r\n  templateUrl: './adam-hint.component.html',\r\n  styleUrls: ['./adam-hint.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class AdamHintComponent implements OnInit {\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit() {\r\n  }\r\n}\r\n","<mat-divider></mat-divider>\r\n<div class=\"hint-box u-border-radius-bottom mat-caption u-shadow-top\">\r\n  <div class=\"hint-box__hint\">{{ 'Fields.Hyperlink.AdamFileManager.Hint' | translate }}</div>\r\n  <div class=\"hint-box__sponsor\">\r\n    <a href=\"https://2sxc.org/help?tag=adam\" target=\"_blank\" tabindex=\"-1\" class=\"adam-link\"\r\n      [matTooltip]=\"'Fields.Hyperlink.AdamFileManager.SponsorTooltip' | translate\">\r\n      <mat-icon svgIcon=\"appleFilled\"></mat-icon>\r\n      <span>Adam</span>\r\n    </a>\r\n    &nbsp;\r\n    <span>{{ 'Fields.Hyperlink.AdamFileManager.SponsorLine' | translate }}</span>\r\n    &nbsp;\r\n    <a href=\"https://www.2sic.com\" target=\"_blank\" tabindex=\"-1\">2sic.com</a>\r\n  </div>\r\n</div>\r\n","import { Component, OnInit, ViewContainerRef, ViewChild, ElementRef, OnDestroy, AfterViewInit, ChangeDetectionStrategy } from '@angular/core';\r\nimport { BehaviorSubject } from 'rxjs';\r\n\r\nimport { FieldWrapper } from '../../../eav-dynamic-form/model/field-wrapper';\r\nimport { InputTypeConstants } from '../../../../ng-dialogs/src/app/content-type-fields/constants/input-type.constants';\r\nimport { BaseComponent } from '../../input-types/base/base.component';\r\nimport { EavService } from '../../../shared/services/eav.service';\r\nimport { ValidationMessagesService } from '../../validators/validation-messages-service';\r\n\r\n@Component({\r\n  selector: 'app-adam-attach-wrapper',\r\n  templateUrl: './adam-attach-wrapper.component.html',\r\n  styleUrls: ['./adam-attach-wrapper.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class AdamAttachWrapperComponent extends BaseComponent<any> implements FieldWrapper, OnInit, AfterViewInit, OnDestroy {\r\n  @ViewChild('fieldComponent', { static: true, read: ViewContainerRef }) fieldComponent: ViewContainerRef;\r\n  @ViewChild('invisibleClickable') invisibleClickableRef: ElementRef;\r\n\r\n  fullscreenAdam: boolean;\r\n  adamDisabled$ = new BehaviorSubject(true);\r\n\r\n  constructor(eavService: EavService, validationMessagesService: ValidationMessagesService) {\r\n    super(eavService, validationMessagesService);\r\n  }\r\n\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n    this.fullscreenAdam = this.config.field.inputType === InputTypeConstants.HyperlinkLibrary;\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    this.subscription.add(this.config.adam.getConfig$().subscribe(adamConfig => {\r\n      if (adamConfig == null) { return; }\r\n      this.adamDisabled$.next(adamConfig.disabled);\r\n    }));\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.adamDisabled$.complete();\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  openUpload() {\r\n    this.invisibleClickableRef.nativeElement.click();\r\n  }\r\n}\r\n","<div class=\"adam-dialog-container\">\r\n  <div class=\"adam-dialog-content\">\r\n    <ng-container #fieldComponent></ng-container>\r\n  </div>\r\n  <adam-browser (openUpload)=\"openUpload()\" [config]=\"config\" [group]=\"group\" class=\"u-shadow-top\" [ngClass]=\"{\r\n      'adam-browser-container--short u-hide-scrollbar': !fullscreenAdam,\r\n      'u-display-none': adamDisabled$ | async\r\n    }\">\r\n  </adam-browser>\r\n  <div class=\"{{ 'field-' + config.field.index }}\" [ngClass]=\"{ 'u-display-none': adamDisabled$ | async }\">\r\n    <div class=\"dropzone-previews\"></div>\r\n    <span #invisibleClickable class=\"invisible-clickable\" data-note=\"just a fake, invisible area for dropzone\"></span>\r\n  </div>\r\n  <adam-hint class=\"field-hints\" [ngClass]=\"{ 'u-display-none': adamDisabled$ | async }\"></adam-hint>\r\n</div>\r\n","import { Component, OnInit, ViewChild, ViewContainerRef, OnDestroy, ChangeDetectionStrategy } from '@angular/core';\r\nimport { BehaviorSubject } from 'rxjs';\r\n\r\nimport { FieldWrapper } from '../../../eav-dynamic-form/model/field-wrapper';\r\nimport { BaseComponent } from '../../input-types/base/base.component';\r\nimport { EavService } from '../../../shared/services/eav.service';\r\nimport { ValidationMessagesService } from '../../validators/validation-messages-service';\r\n\r\n@Component({\r\n  selector: 'app-collapsible-field-wrapper',\r\n  templateUrl: './collapsible-field-wrapper.component.html',\r\n  styleUrls: ['./collapsible-field-wrapper.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class CollapsibleFieldWrapperComponent extends BaseComponent<string[]> implements FieldWrapper, OnInit, OnDestroy {\r\n  @ViewChild('fieldComponent', { static: true, read: ViewContainerRef }) fieldComponent: ViewContainerRef;\r\n\r\n  collapse$ = new BehaviorSubject(true);\r\n\r\n  constructor(eavService: EavService, validationMessagesService: ValidationMessagesService) {\r\n    super(eavService, validationMessagesService);\r\n  }\r\n\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.collapse$.complete();\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  toggleCollapse() {\r\n    this.collapse$.next(!this.collapse$.value);\r\n  }\r\n}\r\n","<div fxLayout=\"row\" fxLayoutAlign=\"start center\" class=\"mat-card-header-group-child\">\r\n  <div fxFlex=\"auto\" fxLayoutAlign=\"start center\" (click)=\"toggleCollapse()\" class=\"mat-caption\">\r\n    <div fxLayoutAlign=\"start center\" class=\"mat-caption field-title\">\r\n      <mat-icon> {{ (collapse$ | async) ? 'keyboard_arrow_down' : 'keyboard_arrow_up' }}</mat-icon>\r\n      <span>{{ label$ | async }}&nbsp;{{ (required$ | async) ? '*': '' }}</span>\r\n    </div>\r\n  </div>\r\n</div>\r\n<div style=\"padding-top: 8px;\" [ngStyle]=\"{ 'display': !(collapse$ | async) ? 'block' : 'none' }\">\r\n  <ng-container #fieldComponent></ng-container>\r\n</div>\r\n","import { Injectable } from '@angular/core';\r\nimport { EntityCollectionServiceBase, EntityCollectionServiceElementsFactory } from '@ngrx/data';\r\nimport { map } from 'rxjs/operators';\r\n\r\nimport { ContentType } from '../../models/eav';\r\nimport { JsonContentType1 } from '../../models/json-format-v1';\r\n\r\n@Injectable({ providedIn: 'root' })\r\nexport class ContentTypeService extends EntityCollectionServiceBase<ContentType> {\r\n  constructor(serviceElementsFactory: EntityCollectionServiceElementsFactory) {\r\n    super('ContentType', serviceElementsFactory);\r\n  }\r\n\r\n  /** Add new content types to the store */\r\n  addContentTypes(rawContentTypes: JsonContentType1[]) {\r\n    const builtContentTypes = rawContentTypes.map(rawCT => ContentType.create(rawCT));\r\n    this.addManyToCache(builtContentTypes);\r\n  }\r\n\r\n  /** Get content type observable from the store */\r\n  getContentTypeById(id: string) {\r\n    return this.entities$.pipe(\r\n      map(contentTypes => contentTypes.find(contentType => contentType.contentType.id === id))\r\n      // maybe add distinctUntilChanged()\r\n    );\r\n  }\r\n}\r\n","import MapCache from './_MapCache.js';\nimport setCacheAdd from './_setCacheAdd.js';\nimport setCacheHas from './_setCacheHas.js';\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values == null ? 0 : values.length;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\nexport default SetCache;\n","/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\nexport default setCacheAdd;\n","/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\nexport default setCacheHas;\n","/**\n * A specialized version of `_.some` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n */\nfunction arraySome(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (predicate(array[index], index, array)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nexport default arraySome;\n","import SetCache from './_SetCache.js';\nimport arraySome from './_arraySome.js';\nimport cacheHas from './_cacheHas.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * A specialized version of `baseIsEqualDeep` for arrays with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Array} array The array to compare.\n * @param {Array} other The other array to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `array` and `other` objects.\n * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.\n */\nfunction equalArrays(array, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      arrLength = array.length,\n      othLength = other.length;\n\n  if (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n    return false;\n  }\n  // Assume cyclic values are equal.\n  var stacked = stack.get(array);\n  if (stacked && stack.get(other)) {\n    return stacked == other;\n  }\n  var index = -1,\n      result = true,\n      seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache : undefined;\n\n  stack.set(array, other);\n  stack.set(other, array);\n\n  // Ignore non-index properties.\n  while (++index < arrLength) {\n    var arrValue = array[index],\n        othValue = other[index];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, arrValue, index, other, array, stack)\n        : customizer(arrValue, othValue, index, array, other, stack);\n    }\n    if (compared !== undefined) {\n      if (compared) {\n        continue;\n      }\n      result = false;\n      break;\n    }\n    // Recursively compare arrays (susceptible to call stack limits).\n    if (seen) {\n      if (!arraySome(other, function(othValue, othIndex) {\n            if (!cacheHas(seen, othIndex) &&\n                (arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n              return seen.push(othIndex);\n            }\n          })) {\n        result = false;\n        break;\n      }\n    } else if (!(\n          arrValue === othValue ||\n            equalFunc(arrValue, othValue, bitmask, customizer, stack)\n        )) {\n      result = false;\n      break;\n    }\n  }\n  stack['delete'](array);\n  stack['delete'](other);\n  return result;\n}\n\nexport default equalArrays;\n","/**\n * Checks if a `cache` value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\nexport default cacheHas;\n","/**\n * Converts `map` to its key-value pairs.\n *\n * @private\n * @param {Object} map The map to convert.\n * @returns {Array} Returns the key-value pairs.\n */\nfunction mapToArray(map) {\n  var index = -1,\n      result = Array(map.size);\n\n  map.forEach(function(value, key) {\n    result[++index] = [key, value];\n  });\n  return result;\n}\n\nexport default mapToArray;\n","/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\nexport default setToArray;\n","import Symbol from './_Symbol.js';\nimport Uint8Array from './_Uint8Array.js';\nimport eq from './eq.js';\nimport equalArrays from './_equalArrays.js';\nimport mapToArray from './_mapToArray.js';\nimport setToArray from './_setToArray.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/** `Object#toString` result references. */\nvar boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]';\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * A specialized version of `baseIsEqualDeep` for comparing objects of\n * the same `toStringTag`.\n *\n * **Note:** This function only supports comparing values with tags of\n * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {string} tag The `toStringTag` of the objects to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalByTag(object, other, tag, bitmask, customizer, equalFunc, stack) {\n  switch (tag) {\n    case dataViewTag:\n      if ((object.byteLength != other.byteLength) ||\n          (object.byteOffset != other.byteOffset)) {\n        return false;\n      }\n      object = object.buffer;\n      other = other.buffer;\n\n    case arrayBufferTag:\n      if ((object.byteLength != other.byteLength) ||\n          !equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n        return false;\n      }\n      return true;\n\n    case boolTag:\n    case dateTag:\n    case numberTag:\n      // Coerce booleans to `1` or `0` and dates to milliseconds.\n      // Invalid dates are coerced to `NaN`.\n      return eq(+object, +other);\n\n    case errorTag:\n      return object.name == other.name && object.message == other.message;\n\n    case regexpTag:\n    case stringTag:\n      // Coerce regexes to strings and treat strings, primitives and objects,\n      // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n      // for more details.\n      return object == (other + '');\n\n    case mapTag:\n      var convert = mapToArray;\n\n    case setTag:\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n      convert || (convert = setToArray);\n\n      if (object.size != other.size && !isPartial) {\n        return false;\n      }\n      // Assume cyclic values are equal.\n      var stacked = stack.get(object);\n      if (stacked) {\n        return stacked == other;\n      }\n      bitmask |= COMPARE_UNORDERED_FLAG;\n\n      // Recursively compare objects (susceptible to call stack limits).\n      stack.set(object, other);\n      var result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n      stack['delete'](object);\n      return result;\n\n    case symbolTag:\n      if (symbolValueOf) {\n        return symbolValueOf.call(object) == symbolValueOf.call(other);\n      }\n  }\n  return false;\n}\n\nexport default equalByTag;\n","import getAllKeys from './_getAllKeys.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqualDeep` for objects with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalObjects(object, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      objProps = getAllKeys(object),\n      objLength = objProps.length,\n      othProps = getAllKeys(other),\n      othLength = othProps.length;\n\n  if (objLength != othLength && !isPartial) {\n    return false;\n  }\n  var index = objLength;\n  while (index--) {\n    var key = objProps[index];\n    if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n      return false;\n    }\n  }\n  // Assume cyclic values are equal.\n  var stacked = stack.get(object);\n  if (stacked && stack.get(other)) {\n    return stacked == other;\n  }\n  var result = true;\n  stack.set(object, other);\n  stack.set(other, object);\n\n  var skipCtor = isPartial;\n  while (++index < objLength) {\n    key = objProps[index];\n    var objValue = object[key],\n        othValue = other[key];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, objValue, key, other, object, stack)\n        : customizer(objValue, othValue, key, object, other, stack);\n    }\n    // Recursively compare objects (susceptible to call stack limits).\n    if (!(compared === undefined\n          ? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n          : compared\n        )) {\n      result = false;\n      break;\n    }\n    skipCtor || (skipCtor = key == 'constructor');\n  }\n  if (result && !skipCtor) {\n    var objCtor = object.constructor,\n        othCtor = other.constructor;\n\n    // Non `Object` object instances with different constructors are not equal.\n    if (objCtor != othCtor &&\n        ('constructor' in object && 'constructor' in other) &&\n        !(typeof objCtor == 'function' && objCtor instanceof objCtor &&\n          typeof othCtor == 'function' && othCtor instanceof othCtor)) {\n      result = false;\n    }\n  }\n  stack['delete'](object);\n  stack['delete'](other);\n  return result;\n}\n\nexport default equalObjects;\n","import Stack from './_Stack.js';\nimport equalArrays from './_equalArrays.js';\nimport equalByTag from './_equalByTag.js';\nimport equalObjects from './_equalObjects.js';\nimport getTag from './_getTag.js';\nimport isArray from './isArray.js';\nimport isBuffer from './isBuffer.js';\nimport isTypedArray from './isTypedArray.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqual` for arrays and objects which performs\n * deep comparisons and tracks traversed objects enabling objects with circular\n * references to be compared.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} [stack] Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction baseIsEqualDeep(object, other, bitmask, customizer, equalFunc, stack) {\n  var objIsArr = isArray(object),\n      othIsArr = isArray(other),\n      objTag = objIsArr ? arrayTag : getTag(object),\n      othTag = othIsArr ? arrayTag : getTag(other);\n\n  objTag = objTag == argsTag ? objectTag : objTag;\n  othTag = othTag == argsTag ? objectTag : othTag;\n\n  var objIsObj = objTag == objectTag,\n      othIsObj = othTag == objectTag,\n      isSameTag = objTag == othTag;\n\n  if (isSameTag && isBuffer(object)) {\n    if (!isBuffer(other)) {\n      return false;\n    }\n    objIsArr = true;\n    objIsObj = false;\n  }\n  if (isSameTag && !objIsObj) {\n    stack || (stack = new Stack);\n    return (objIsArr || isTypedArray(object))\n      ? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n      : equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n  }\n  if (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n    var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),\n        othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');\n\n    if (objIsWrapped || othIsWrapped) {\n      var objUnwrapped = objIsWrapped ? object.value() : object,\n          othUnwrapped = othIsWrapped ? other.value() : other;\n\n      stack || (stack = new Stack);\n      return equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n    }\n  }\n  if (!isSameTag) {\n    return false;\n  }\n  stack || (stack = new Stack);\n  return equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n}\n\nexport default baseIsEqualDeep;\n","import baseIsEqual from './_baseIsEqual.js';\n\n/**\n * Performs a deep comparison between two values to determine if they are\n * equivalent.\n *\n * **Note:** This method supports comparing arrays, array buffers, booleans,\n * date objects, error objects, maps, numbers, `Object` objects, regexes,\n * sets, strings, symbols, and typed arrays. `Object` objects are compared\n * by their own, not inherited, enumerable properties. Functions and DOM\n * nodes are compared by strict equality, i.e. `===`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.isEqual(object, other);\n * // => true\n *\n * object === other;\n * // => false\n */\nfunction isEqual(value, other) {\n  return baseIsEqual(value, other);\n}\n\nexport default isEqual;\n","import baseIsEqualDeep from './_baseIsEqualDeep.js';\nimport isObjectLike from './isObjectLike.js';\n\n/**\n * The base implementation of `_.isEqual` which supports partial comparisons\n * and tracks traversed objects.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Unordered comparison\n *  2 - Partial comparison\n * @param {Function} [customizer] The function to customize comparisons.\n * @param {Object} [stack] Tracks traversed `value` and `other` objects.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n */\nfunction baseIsEqual(value, other, bitmask, customizer, stack) {\n  if (value === other) {\n    return true;\n  }\n  if (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n    return value !== value && other !== other;\n  }\n  return baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n}\n\nexport default baseIsEqual;\n","export class TranslationLinkConstants {\r\n  public static readonly Translate = 'translate';\r\n  public static readonly DontTranslate = 'dontTranslate';\r\n  public static readonly MissingDefaultLangValue = 'missingDefaultLangValue';\r\n  public static readonly LinkReadOnly = 'linkReadOnly';\r\n  public static readonly LinkReadWrite = 'linkReadWrite';\r\n  public static readonly LinkCopyFrom = 'linkCopyFrom';\r\n}\r\n","export class I18nKeyConstants {\r\n  public static readonly NoTranslate = 'NoTranslate';\r\n  public static readonly FromPrimary = 'FromPrimary';\r\n  public static readonly FromOther = 'FromOther';\r\n  public static readonly LinkReadOnly = 'LinkReadOnly';\r\n  public static readonly LinkShared = 'LinkShared';\r\n}\r\n","<mat-card class=\"link-other-lang-container u-hide-scrollbar\" *ngIf=\"{\r\n  languages: languages$ | async,\r\n  selected: selected$ | async,\r\n  showLanguages: showLanguages$ | async,\r\n  i18nRoot: i18nRoot$ | async\r\n} as data\">\r\n  <div class=\"mat-card__header\">\r\n    <div class=\"mat-card__title\">\r\n      {{ 'LangMenu.Dialog.Title' | translate: { name: dialogData.attributeKey } }}\r\n    </div>\r\n    <div class=\"mat-card__description\">\r\n      {{ 'LangMenu.Dialog.Intro' | translate }}\r\n    </div>\r\n  </div>\r\n\r\n  <mat-nav-list toggle>\r\n    <ng-container\r\n      *ngTemplateOutlet=\"item;context:{ link: TranslationLinks.DontTranslate, icon: 'lock', i18nKey: I18nKeys.NoTranslate }\">\r\n    </ng-container>\r\n    <ng-container\r\n      *ngTemplateOutlet=\"item;context:{ link: TranslationLinks.Translate, icon: 'lock_open', i18nKey: I18nKeys.FromPrimary }\">\r\n    </ng-container>\r\n    <ng-container\r\n      *ngTemplateOutlet=\"item;context:{ link: TranslationLinks.LinkCopyFrom, icon: 'translate', i18nKey: I18nKeys.FromOther }\">\r\n    </ng-container>\r\n    <ng-container\r\n      *ngTemplateOutlet=\"item;context:{ link: TranslationLinks.LinkReadOnly, icon: 'link', i18nKey: I18nKeys.LinkReadOnly }\">\r\n    </ng-container>\r\n    <ng-container\r\n      *ngTemplateOutlet=\"item;context:{ link: TranslationLinks.LinkReadWrite, icon: 'share', i18nKey: I18nKeys.LinkShared }\">\r\n    </ng-container>\r\n  </mat-nav-list>\r\n\r\n  <ng-template #item let-icon=\"icon\" let-link='link' let-i18nKey=\"i18nKey\">\r\n    <mat-list-item [ngClass]=\"{ 'mat-list-item-focus': data.selected.linkType === link }\" (click)=\"select(i18nKey)\">\r\n\r\n      <mat-icon matListIcon color=\"accent\">{{ icon }}</mat-icon>\r\n      <div matLine class=\"mat-list-item__title\">\r\n        {{ ('LangMenu.Dialog.' + i18nKey + '.Title') | translate : { primary: dialogData.defaultLanguage } }}</div>\r\n      <div matLine class=\"mat-list-item__body\">\r\n        {{ ('LangMenu.Dialog.' + i18nKey + '.Body') | translate : { primary: dialogData.defaultLanguage } }}</div>\r\n    </mat-list-item>\r\n  </ng-template>\r\n\r\n  <div *ngIf=\"data.showLanguages\">\r\n    <div class=\"mat-card__header\">\r\n      <div class=\"mat-card__title\">\r\n        {{ (data.i18nRoot + '.Subtitle') | translate }}\r\n      </div>\r\n      <div class=\"mat-card__description\">\r\n        {{'LangMenu.Dialog.PickLanguageIntro' | translate }}\r\n      </div>\r\n    </div>\r\n\r\n    <mat-action-list>\r\n      <button mat-list-item *ngFor=\"let language of data.languages\" (click)=\"selectLanguage(language.key)\"\r\n        [disabled]=\"isLanguageDisabled(language.key)\" [ngClass]=\"{\r\n        'mat-list-item-focus': data.selected.language === language.key,\r\n        'mat-list-item--disabled': isLanguageDisabled(language.key)\r\n      }\">\r\n        <mat-icon matListIcon color=\"accent\">language</mat-icon>\r\n        {{ language.key }}\r\n      </button>\r\n    </mat-action-list>\r\n  </div>\r\n\r\n  <mat-dialog-actions fxLayoutAlign=\"end center\">\r\n    <button mat-button color=\"accent\" [disabled]=\"isOkDisabled(data.selected)\"\r\n      [mat-dialog-close]=\"data.selected\">OK</button>\r\n  </mat-dialog-actions>\r\n</mat-card>\r\n","import { Component, OnInit, Inject, OnDestroy, ChangeDetectionStrategy } from '@angular/core';\r\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\r\nimport { Observable, BehaviorSubject, combineLatest } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\n\r\nimport { LinkToOtherLanguageData } from '../../../shared/models/eav/link-to-other-language-data';\r\nimport { LanguageService } from '../../../shared/store/ngrx-data/language.service';\r\nimport { LanguageInstanceService } from '../../../shared/store/ngrx-data/language-instance.service';\r\nimport { Language } from '../../../shared/models/eav';\r\nimport { TranslationLinkConstants } from '../../../shared/constants/translation-link.constants';\r\nimport { LocalizationHelper } from '../../../shared/helpers/localization-helper';\r\nimport { I18nKeyConstants } from './link-to-other-language.constants';\r\nimport { findI18nKey, findTranslationLink } from './link-to-other-language.helpers';\r\n\r\n@Component({\r\n  selector: 'app-link-to-other-language',\r\n  templateUrl: './link-to-other-language.component.html',\r\n  styleUrls: ['./link-to-other-language.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class LinkToOtherLanguageComponent implements OnInit, OnDestroy {\r\n  languages$: Observable<Language[]>;\r\n  selected$: BehaviorSubject<LinkToOtherLanguageData>;\r\n  showLanguages$: BehaviorSubject<boolean>;\r\n  i18nRoot$: BehaviorSubject<string>;\r\n  TranslationLinks = TranslationLinkConstants;\r\n  I18nKeys = I18nKeyConstants;\r\n\r\n  constructor(\r\n    @Inject(MAT_DIALOG_DATA) public dialogData: LinkToOtherLanguageData,\r\n    private languageService: LanguageService,\r\n    private languageInstanceService: LanguageInstanceService,\r\n  ) {\r\n    this.selected$ = new BehaviorSubject({ ...this.dialogData });\r\n    this.showLanguages$ = new BehaviorSubject(this.dialogData.language !== '');\r\n\r\n    const i18nKey = findI18nKey(this.dialogData.linkType);\r\n    this.i18nRoot$ = new BehaviorSubject(`LangMenu.Dialog.${i18nKey}`);\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.languages$ = combineLatest([\r\n      this.languageService.entities$,\r\n      this.languageInstanceService.getCurrentLanguage(this.dialogData.formId)\r\n    ]).pipe(\r\n      map(combined => {\r\n        const languages = combined[0];\r\n        const currentLanguage = combined[1];\r\n        return languages.filter(lang => lang.key !== currentLanguage);\r\n      })\r\n    );\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.selected$.complete();\r\n    this.showLanguages$.complete();\r\n    this.i18nRoot$.complete();\r\n  }\r\n\r\n  select(i18nKey: string) {\r\n    const showLanguages = (i18nKey !== I18nKeyConstants.FromPrimary && i18nKey !== I18nKeyConstants.NoTranslate);\r\n    const newSelected: LinkToOtherLanguageData = { ...this.selected$.value };\r\n\r\n    if (!showLanguages) { newSelected.language = ''; }\r\n    newSelected.linkType = findTranslationLink(i18nKey);\r\n\r\n    this.showLanguages$.next(showLanguages);\r\n    this.selected$.next(newSelected);\r\n    this.i18nRoot$.next(`LangMenu.Dialog.${i18nKey}`);\r\n  }\r\n\r\n  selectLanguage(language: string) {\r\n    this.selected$.next({ ...this.selected$.value, language });\r\n  }\r\n\r\n  isOkDisabled(selected: LinkToOtherLanguageData) {\r\n    const disabled = selected.language === ''\r\n      && selected.linkType !== TranslationLinkConstants.Translate\r\n      && selected.linkType !== TranslationLinkConstants.DontTranslate;\r\n    return disabled;\r\n  }\r\n\r\n  isLanguageDisabled(languageKey: string) {\r\n    if (!this.dialogData.attributes) { return true; }\r\n\r\n    const hasTranslation = LocalizationHelper.isEditableTranslationExist(\r\n      this.dialogData.attributes[this.dialogData.attributeKey],\r\n      languageKey,\r\n      this.dialogData.defaultLanguage\r\n    );\r\n    return !hasTranslation;\r\n  }\r\n}\r\n","import { TranslationLinkConstants } from '../../../shared/constants/translation-link.constants';\r\nimport { I18nKeyConstants } from './link-to-other-language.constants';\r\n\r\nexport function findI18nKey(translationLink: string) {\r\n  switch (translationLink) {\r\n    case TranslationLinkConstants.Translate:\r\n      return I18nKeyConstants.FromPrimary;\r\n    case TranslationLinkConstants.DontTranslate:\r\n      return I18nKeyConstants.NoTranslate;\r\n    case TranslationLinkConstants.LinkReadOnly:\r\n      return I18nKeyConstants.LinkReadOnly;\r\n    case TranslationLinkConstants.LinkReadWrite:\r\n      return I18nKeyConstants.LinkShared;\r\n    case TranslationLinkConstants.LinkCopyFrom:\r\n      return I18nKeyConstants.FromOther;\r\n  }\r\n}\r\n\r\nexport function findTranslationLink(i18nKey: string) {\r\n  switch (i18nKey) {\r\n    case I18nKeyConstants.FromPrimary:\r\n      return TranslationLinkConstants.Translate;\r\n    case I18nKeyConstants.NoTranslate:\r\n      return TranslationLinkConstants.DontTranslate;\r\n    case I18nKeyConstants.LinkReadOnly:\r\n      return TranslationLinkConstants.LinkReadOnly;\r\n    case I18nKeyConstants.LinkShared:\r\n      return TranslationLinkConstants.LinkReadWrite;\r\n    case I18nKeyConstants.FromOther:\r\n      return TranslationLinkConstants.LinkCopyFrom;\r\n  }\r\n}\r\n","export class TranslateGroupMenuHelpers {\r\n\r\n  public static calculateSharedInfoMessage(dimensions: string[], currentLanguage: string): string {\r\n    dimensions = TranslateGroupMenuHelpers.calculateShortDimensions(dimensions, currentLanguage);\r\n    const result = TranslateGroupMenuHelpers.calculateEditAndReadDimensions(dimensions);\r\n    const editableDimensions = result.editableDimensions;\r\n    const readOnlyDimensions = result.readOnlyDimensions;\r\n    let infoMessage = '';\r\n\r\n    const editableExist = editableDimensions.length > 0;\r\n    const readOnlyExist = readOnlyDimensions.length > 0;\r\n    if (editableExist && readOnlyExist) {\r\n      infoMessage = `${editableDimensions.join(', ')}, (${readOnlyDimensions.join(', ')})`;\r\n    } else if (editableExist) {\r\n      infoMessage = editableDimensions.join(', ');\r\n    } else if (readOnlyExist) {\r\n      infoMessage = `(${readOnlyDimensions.join(', ')})`;\r\n    }\r\n\r\n    return infoMessage;\r\n  }\r\n\r\n  private static calculateShortDimensions(dimensions: string[], currentLanguage: string): string[] {\r\n    const dimensionsMap: { [key: string]: string[] } = {};\r\n    const shortCurrentLanguage = currentLanguage.slice(0, currentLanguage.indexOf('-'));\r\n\r\n    dimensionsMap[shortCurrentLanguage] = [];\r\n    dimensionsMap[shortCurrentLanguage].push(shortCurrentLanguage);\r\n\r\n    dimensions.forEach(dimension => {\r\n      const shortDimension = dimension.slice(0, dimension.indexOf('-'));\r\n      const shortNoReadOnly = shortDimension.replace('~', '');\r\n\r\n      if (!dimensionsMap[shortNoReadOnly]) {\r\n        dimensionsMap[shortNoReadOnly] = [];\r\n        dimensionsMap[shortNoReadOnly].push(dimension);\r\n      } else {\r\n        dimensionsMap[shortNoReadOnly].push(dimension);\r\n      }\r\n    });\r\n\r\n    dimensions = dimensions.map(dimension => {\r\n      const shortDimension = dimension.slice(0, dimension.indexOf('-'));\r\n      const shortNoReadOnly = shortDimension.replace('~', '');\r\n\r\n      if (dimensionsMap[shortNoReadOnly].length > 1) {\r\n        return dimension;\r\n      } else {\r\n        return shortDimension;\r\n      }\r\n    });\r\n\r\n    return dimensions;\r\n  }\r\n\r\n  private static calculateEditAndReadDimensions(dimensions: string[]) {\r\n    const editableDimensions: string[] = [];\r\n    const readOnlyDimensions: string[] = [];\r\n\r\n    dimensions.forEach(dimension => {\r\n      if (!dimension.includes('~')) {\r\n        editableDimensions.push(dimension);\r\n      } else {\r\n        readOnlyDimensions.push(dimension.replace('~', ''));\r\n      }\r\n    });\r\n\r\n    return {\r\n      editableDimensions,\r\n      readOnlyDimensions\r\n    };\r\n  }\r\n\r\n}\r\n","<ng-container *ngIf=\"{\r\n  currentLanguage: currentLanguage$ | async,\r\n  defaultLanguage: defaultLanguage$ | async,\r\n  translationState: translationState$ | async,\r\n  disabled: disabled$ | async,\r\n  defaultLanguageMissingValue: defaultLanguageMissingValue$ | async,\r\n  infoMessage: infoMessage$ | async,\r\n  infoMessageLabel: infoMessageLabel$ | async\r\n} as data\">\r\n\r\n  <ng-container *ngIf=\"data.currentLanguage !== data.defaultLanguage\">\r\n\r\n    <div *ngIf=\"fieldConfig.isParentGroup\" fxLayoutAlign=\"end center\">\r\n      <button mat-button fxLayoutAlign=\"end center\" [matMenuTriggerFor]=\"rootMenu\">\r\n        <span fxLayoutAlign=\"end center\">\r\n          {{ ('LangMenu.Translate' | translate).toUpperCase() }} &nbsp;&nbsp;\r\n          <mat-icon class=\"translate-icon\">translate</mat-icon>\r\n        </span>\r\n      </button>\r\n      <mat-menu #rootMenu=\"matMenu\" [overlapTrigger]=\"true\">\r\n        <button mat-menu-item (click)=\"translateAll()\"\r\n          [ngClass]=\"{'menu-item-selected': data.translationState.linkType === translationLinkConstants.Translate}\">\r\n          {{ 'LangMenu.TranslateAll' | translate }}\r\n        </button>\r\n        <button mat-menu-item (click)=\"dontTranslateAll()\"\r\n          [ngClass]=\"{'menu-item-selected': data.translationState.linkType === translationLinkConstants.DontTranslate}\">\r\n          {{ 'LangMenu.NoTranslateAll' | translate }}\r\n        </button>\r\n        <button mat-menu-item (click)=\"openLinkToOtherLanguage()\"\r\n          [ngClass]=\"{'menu-item-selected': data.translationState.language !== ''}\">\r\n          {{ 'LangMenu.Link' | translate }}\r\n        </button>\r\n      </mat-menu>\r\n    </div>\r\n\r\n    <div *ngIf=\"!fieldConfig.isParentGroup\" fxLayoutAlign=\"end center\">\r\n      <div fxLayoutAlign=\"end center\" class=\"shared-languages-container\"\r\n        [ngClass]=\"getTranslationStateClass(data.translationState.linkType)\">\r\n        <div class=\"shared-languages mat-caption\" [ngClass]=\"{'shared-languages--disabled': data.disabled}\">\r\n          {{ data.infoMessageLabel ? (data.infoMessageLabel | translate:{ languages: data.infoMessage }) : '' }}</div>\r\n        <button mat-icon-button [disabled]=\"fieldConfig.disableI18n || data.defaultLanguageMissingValue\"\r\n          [matMenuTriggerFor]=\"rootMenu2\">\r\n          <mat-icon class=\"translate-icon\">translate</mat-icon>\r\n        </button>\r\n      </div>\r\n      <mat-menu #rootMenu2=\"matMenu\" [overlapTrigger]=\"true\">\r\n        <button mat-menu-item (click)=\"translateUnlink(config.field.name)\"\r\n          [ngClass]=\"{'menu-item-selected': data.translationState.linkType === translationLinkConstants.Translate}\">\r\n          {{ 'LangMenu.Translate' | translate }}\r\n        </button>\r\n        <button mat-menu-item (click)=\"linkToDefault(config.field.name)\"\r\n          [ngClass]=\"{'menu-item-selected': data.translationState.linkType === translationLinkConstants.DontTranslate}\">\r\n          {{ 'LangMenu.NoTranslate' | translate }}\r\n        </button>\r\n        <button mat-menu-item (click)=\"openLinkToOtherLanguage()\"\r\n          [ngClass]=\"{'menu-item-selected': data.translationState.language !== ''}\">\r\n          {{ 'LangMenu.Link' | translate }}\r\n        </button>\r\n      </mat-menu>\r\n    </div>\r\n\r\n  </ng-container>\r\n</ng-container>\r\n","import { Component, OnInit, Input, OnDestroy, OnChanges, SimpleChanges, ChangeDetectionStrategy } from '@angular/core';\r\nimport { FormGroup, AbstractControl } from '@angular/forms';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { Observable, Subscription, BehaviorSubject, of } from 'rxjs';\r\nimport { filter, map, startWith, distinctUntilChanged } from 'rxjs/operators';\r\nimport isEqual from 'lodash-es/isEqual';\r\n\r\nimport { EavValue, EavAttributes, EavValues, EavDimensions, Item, ContentType } from '../../../shared/models/eav';\r\nimport { FieldConfigSet, FieldConfigGroup } from '../../../eav-dynamic-form/model/field-config';\r\nimport { InputFieldHelper } from '../../../shared/helpers/input-field-helper';\r\nimport { ItemService } from '../../../shared/store/ngrx-data/item.service';\r\nimport { LanguageInstanceService } from '../../../shared/store/ngrx-data/language-instance.service';\r\nimport { LinkToOtherLanguageComponent } from '../link-to-other-language/link-to-other-language.component';\r\nimport { LinkToOtherLanguageData } from '../../../shared/models/eav/link-to-other-language-data';\r\nimport { LocalizationHelper } from '../../../shared/helpers/localization-helper';\r\nimport { TranslationLinkConstants } from '../../../shared/constants/translation-link.constants';\r\nimport { ValidationHelper } from '../../validators/validation-helper';\r\nimport { TranslateGroupMenuHelpers } from './translate-group-menu.helpers';\r\nimport { InputTypeService } from '../../../shared/store/ngrx-data/input-type.service';\r\nimport { ContentTypeService } from '../../../shared/store/ngrx-data/content-type.service';\r\nimport { angularConsoleLog } from '../../../../ng-dialogs/src/app/shared/helpers/angular-console-log.helper';\r\nimport { EavService } from '../../../shared/services/eav.service';\r\n\r\n@Component({\r\n  selector: 'app-translate-group-menu',\r\n  templateUrl: './translate-group-menu.component.html',\r\n  styleUrls: ['./translate-group-menu.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class TranslateGroupMenuComponent implements OnInit, OnChanges, OnDestroy {\r\n  @Input() config: FieldConfigSet;\r\n  @Input() group: FormGroup;\r\n  @Input() toggleTranslateField: boolean;\r\n\r\n  fieldConfig: FieldConfigGroup;\r\n  control: AbstractControl;\r\n  disabled$: Observable<boolean>;\r\n  translationLinkConstants = TranslationLinkConstants;\r\n  attributes$: Observable<EavAttributes>;\r\n  attributes: EavAttributes;\r\n  currentLanguage$: Observable<string>;\r\n  currentLanguage = '';\r\n  defaultLanguage$: Observable<string>;\r\n  defaultLanguage = '';\r\n  defaultLanguageMissingValue$ = new BehaviorSubject(false);\r\n  headerGroupSlotIsEmpty = false;\r\n  translationState$: BehaviorSubject<LinkToOtherLanguageData> = new BehaviorSubject({\r\n    formId: null,\r\n    linkType: '',\r\n    language: '',\r\n  });\r\n  infoMessage$ = new BehaviorSubject<string>('');\r\n  infoMessageLabel$ = new BehaviorSubject<string>('');\r\n  item: Item;\r\n  contentType: ContentType;\r\n\r\n  private subscription = new Subscription();\r\n\r\n  constructor(\r\n    private dialog: MatDialog,\r\n    private languageInstanceService: LanguageInstanceService,\r\n    private itemService: ItemService,\r\n    private inputTypeService: InputTypeService,\r\n    private contentTypeService: ContentTypeService,\r\n    private eavService: EavService,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.fieldConfig = this.config.field as FieldConfigGroup;\r\n    this.control = this.group.controls[this.config.field.name];\r\n    this.disabled$ = this.fieldConfig.isParentGroup ? of(false) : this.eavService.formDisabledChange$.asObservable().pipe(\r\n      filter(formDisabledSet => (formDisabledSet.formId === this.config.form.formId)\r\n        && (formDisabledSet.entityGuid === this.config.entity.entityGuid)\r\n      ),\r\n      map(formSet => this.control.disabled),\r\n      startWith(this.control.disabled),\r\n      distinctUntilChanged(),\r\n    );\r\n    this.currentLanguage$ = this.languageInstanceService.getCurrentLanguage(this.config.form.formId);\r\n    this.defaultLanguage$ = this.languageInstanceService.getDefaultLanguage(this.config.form.formId);\r\n    this.attributes$ = this.itemService.selectAttributesByEntityId(this.config.entity.entityId, this.config.entity.entityGuid);\r\n    this.subscribeToAttributeValues();\r\n    this.subscribeMenuChange();\r\n    this.subscribeToItemFromStore();\r\n    this.subscribeToContentTypeFromStore();\r\n    // subscribe to language data\r\n    this.subscribeToCurrentLanguageFromStore();\r\n    this.subscribeToDefaultLanguageFromStore();\r\n    this.subscribeToEntityHeaderFromStore();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (changes.toggleTranslateField != null && this.currentLanguage !== this.defaultLanguage && this.control.disabled) {\r\n      this.translateUnlink(this.config.field.name);\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.defaultLanguageMissingValue$.complete();\r\n    this.translationState$.complete();\r\n    this.infoMessage$.complete();\r\n    this.infoMessageLabel$.complete();\r\n    this.subscription.unsubscribe();\r\n  }\r\n\r\n  openLinkToOtherLanguage() {\r\n    const dialogData: LinkToOtherLanguageData = {\r\n      formId: this.config.form.formId,\r\n      linkType: this.translationState$.value.linkType,\r\n      language: this.translationState$.value.language,\r\n      defaultLanguage: this.defaultLanguage,\r\n      attributes: this.attributes,\r\n      attributeKey: this.config.field.name,\r\n    };\r\n    const dialogRef = this.dialog.open(LinkToOtherLanguageComponent, {\r\n      panelClass: 'c-link-to-other-language',\r\n      autoFocus: false,\r\n      width: '350px',\r\n      data: dialogData\r\n    });\r\n    dialogRef.keydownEvents().subscribe(e => {\r\n      const CTRL_S = e.keyCode === 83 && (navigator.platform.match('Mac') ? e.metaKey : e.ctrlKey);\r\n      if (!CTRL_S) { return; }\r\n      e.preventDefault();\r\n    });\r\n    dialogRef.afterClosed().subscribe((actionResult: LinkToOtherLanguageData) => {\r\n      if (!actionResult) { return; }\r\n      this.triggerTranslation(actionResult);\r\n    });\r\n  }\r\n\r\n  translateUnlink(attributeKey: string) {\r\n    if (this.isTranslateDisabled(attributeKey)) { return; }\r\n\r\n    this.itemService.removeItemAttributeDimension(this.config.entity.entityId, attributeKey, this.currentLanguage,\r\n      this.config.entity.entityGuid);\r\n    const defaultValue: EavValue<any> = LocalizationHelper.getValueTranslation(this.attributes[attributeKey],\r\n      this.defaultLanguage, this.defaultLanguage);\r\n    if (defaultValue) {\r\n      const fieldType = InputFieldHelper.getFieldType(this.config, attributeKey);\r\n      this.itemService.addAttributeValue(this.config.entity.entityId, attributeKey, defaultValue.value,\r\n        this.currentLanguage, false, this.config.entity.entityGuid, fieldType);\r\n    } else {\r\n      angularConsoleLog(`${this.currentLanguage}: Cant copy value from ${this.defaultLanguage} because that value does not exist.`);\r\n    }\r\n\r\n    this.refreshControlConfig(attributeKey);\r\n  }\r\n\r\n  linkToDefault(attributeKey: string) {\r\n    if (this.isTranslateDisabled(attributeKey)) { return; }\r\n\r\n    this.itemService.removeItemAttributeDimension(this.config.entity.entityId, attributeKey, this.currentLanguage,\r\n      this.config.entity.entityGuid);\r\n\r\n    this.refreshControlConfig(attributeKey);\r\n  }\r\n\r\n  translateAll() {\r\n    this.setTranslationState(TranslationLinkConstants.Translate, '');\r\n    Object.keys(this.attributes).forEach(attributeKey => {\r\n      this.translateUnlink(attributeKey);\r\n    });\r\n    this.languageInstanceService.triggerLocalizationWrapperMenuChange();\r\n  }\r\n\r\n  dontTranslateAll() {\r\n    this.setTranslationState(TranslationLinkConstants.DontTranslate, '');\r\n    Object.keys(this.attributes).forEach(attributeKey => {\r\n      this.linkToDefault(attributeKey);\r\n    });\r\n    this.languageInstanceService.triggerLocalizationWrapperMenuChange();\r\n  }\r\n\r\n  copyFromAll(languageKey: string) {\r\n    this.setTranslationState(TranslationLinkConstants.LinkCopyFrom, languageKey);\r\n    Object.keys(this.attributes).forEach(attributeKey => {\r\n      this.copyFrom(languageKey, attributeKey);\r\n    });\r\n    this.languageInstanceService.triggerLocalizationWrapperMenuChange();\r\n  }\r\n\r\n  /**\r\n   * Copy value where language is copyFromLanguageKey to value where language is current language.\r\n   * If value of current language don't exist then add new value\r\n   */\r\n  copyFrom(copyFromLanguageKey: string, attributeKey: string) {\r\n    if (this.isTranslateDisabled(attributeKey)) { return; }\r\n\r\n    const attributeValueTranslation: EavValue<any> = LocalizationHelper.getValueTranslation(this.attributes[attributeKey],\r\n      copyFromLanguageKey, this.defaultLanguage);\r\n\r\n    if (attributeValueTranslation) {\r\n      const valueAlreadyExist: boolean = this.attributes\r\n        ? LocalizationHelper.isEditableOrReadonlyTranslationExist(this.attributes[attributeKey], this.currentLanguage, this.defaultLanguage)\r\n        : false;\r\n\r\n      if (valueAlreadyExist) {\r\n        // Copy attribute value where language is languageKey to value where language is current language\r\n        this.itemService.updateItemAttributeValue(this.config.entity.entityId, attributeKey, attributeValueTranslation.value,\r\n          this.currentLanguage, this.defaultLanguage, false, this.config.entity.entityGuid);\r\n      } else {\r\n        // Copy attribute value where language is languageKey to new attribute with current language\r\n        this.itemService.addAttributeValue(this.config.entity.entityId, attributeKey, attributeValueTranslation.value,\r\n          this.currentLanguage, false, this.config.entity.entityGuid, this.config.field.type);\r\n      }\r\n    } else {\r\n      angularConsoleLog(`${this.currentLanguage}: Cant copy value from ${copyFromLanguageKey} because that value does not exist.`);\r\n    }\r\n\r\n    this.refreshControlConfig(attributeKey);\r\n  }\r\n\r\n  linkReadOnlyAll(languageKey: string) {\r\n    this.setTranslationState(TranslationLinkConstants.LinkReadOnly, languageKey);\r\n    Object.keys(this.attributes).forEach(attributeKey => {\r\n      this.linkReadOnly(languageKey, attributeKey);\r\n    });\r\n    this.languageInstanceService.triggerLocalizationWrapperMenuChange();\r\n  }\r\n\r\n  linkReadOnly(languageKey: string, attributeKey: string) {\r\n    if (this.isTranslateDisabled(attributeKey)) { return; }\r\n\r\n    this.setTranslationState(TranslationLinkConstants.LinkReadOnly, languageKey);\r\n    this.itemService.removeItemAttributeDimension(this.config.entity.entityId, attributeKey, this.currentLanguage,\r\n      this.config.entity.entityGuid);\r\n    this.itemService.addItemAttributeDimension(this.config.entity.entityId, attributeKey, this.currentLanguage,\r\n      languageKey, this.defaultLanguage, true, this.config.entity.entityGuid);\r\n    this.refreshControlConfig(attributeKey);\r\n  }\r\n\r\n  linkReadWriteAll(languageKey: string) {\r\n    this.setTranslationState(TranslationLinkConstants.LinkReadWrite, languageKey);\r\n    Object.keys(this.attributes).forEach(attributeKey => {\r\n      this.linkReadWrite(languageKey, attributeKey);\r\n    });\r\n    this.languageInstanceService.triggerLocalizationWrapperMenuChange();\r\n  }\r\n\r\n  linkReadWrite(languageKey: string, attributeKey: string) {\r\n    if (this.isTranslateDisabled(attributeKey)) { return; }\r\n\r\n    this.setTranslationState(TranslationLinkConstants.LinkReadWrite, languageKey);\r\n    this.itemService.removeItemAttributeDimension(this.config.entity.entityId, attributeKey, this.currentLanguage,\r\n      this.config.entity.entityGuid);\r\n    this.itemService.addItemAttributeDimension(this.config.entity.entityId, attributeKey, this.currentLanguage,\r\n      languageKey, this.defaultLanguage, false, this.config.entity.entityGuid);\r\n    this.refreshControlConfig(attributeKey);\r\n  }\r\n\r\n  getTranslationStateClass(linkType: string) {\r\n    switch (linkType) {\r\n      case TranslationLinkConstants.MissingDefaultLangValue:\r\n        return 'eav-localization-missing-default-lang-value';\r\n      case TranslationLinkConstants.Translate:\r\n      case TranslationLinkConstants.LinkCopyFrom:\r\n        return 'eav-localization-translate';\r\n      case TranslationLinkConstants.DontTranslate:\r\n        return '';\r\n      case TranslationLinkConstants.LinkReadOnly:\r\n        return 'eav-localization-link-read-only';\r\n      case TranslationLinkConstants.LinkReadWrite:\r\n        return 'eav-localization-link-read-write';\r\n      default:\r\n        return '';\r\n    }\r\n  }\r\n\r\n  private refreshControlConfig(attributeKey: string) {\r\n    if (this.fieldConfig.isParentGroup) { return; }\r\n    this.setControlDisable(this.attributes[attributeKey], attributeKey, this.currentLanguage, this.defaultLanguage);\r\n    this.readTranslationState(this.attributes[attributeKey], attributeKey, this.currentLanguage, this.defaultLanguage);\r\n    this.setInfoMessage(this.attributes[attributeKey], attributeKey, this.currentLanguage, this.defaultLanguage);\r\n  }\r\n\r\n  private triggerTranslation(actionResult: LinkToOtherLanguageData) {\r\n    if (!isEqual(this.translationState$.value, actionResult)) {\r\n      // need be sure that we have a language selected when a link option is clicked\r\n      switch (actionResult.linkType) {\r\n        case TranslationLinkConstants.Translate:\r\n          this.fieldConfig.isParentGroup ? this.translateAll() : this.translateUnlink(this.config.field.name);\r\n          break;\r\n        case TranslationLinkConstants.DontTranslate:\r\n          this.fieldConfig.isParentGroup ? this.dontTranslateAll() : this.linkToDefault(this.config.field.name);\r\n          break;\r\n        case TranslationLinkConstants.LinkReadOnly:\r\n          this.fieldConfig.isParentGroup\r\n            ? this.linkReadOnlyAll(actionResult.language)\r\n            : this.linkReadOnly(actionResult.language, this.config.field.name);\r\n          break;\r\n        case TranslationLinkConstants.LinkReadWrite:\r\n          this.fieldConfig.isParentGroup\r\n            ? this.linkReadWriteAll(actionResult.language)\r\n            : this.linkReadWrite(actionResult.language, this.config.field.name);\r\n          break;\r\n        case TranslationLinkConstants.LinkCopyFrom:\r\n          this.fieldConfig.isParentGroup\r\n            ? this.copyFromAll(actionResult.language)\r\n            : this.copyFrom(actionResult.language, this.config.field.name);\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n    }\r\n  }\r\n\r\n  private setTranslationState(linkType: string, language: string) {\r\n    const newTranslationState = { ...this.translationState$.value, linkType, language };\r\n    this.translationState$.next(newTranslationState);\r\n  }\r\n\r\n  /** Determine is control disabled or enabled */\r\n  private setControlDisable(attributes: EavValues<any>, attributeKey: string, currentLanguage: string,\r\n    defaultLanguage: string) {\r\n    // Important! if control already disabled through settings then skip\r\n    if (!this.config.field.disabled) {\r\n      // if header group slot is empty disable control\r\n      if (this.headerGroupSlotIsEmpty) {\r\n        this.group.controls[attributeKey].disable({ emitEvent: false });\r\n        this.eavService.formDisabledChange$.next({ formId: this.config.form.formId, entityGuid: this.config.entity.entityGuid });\r\n      } else if (currentLanguage === defaultLanguage) {\r\n        this.group.controls[attributeKey].enable({ emitEvent: false });\r\n        this.eavService.formDisabledChange$.next({ formId: this.config.form.formId, entityGuid: this.config.entity.entityGuid });\r\n      } else { // else set enable/disable depending on editable translation exist\r\n        if (!LocalizationHelper.translationExistsInDefault(attributes, defaultLanguage)) {\r\n          this.group.controls[attributeKey].disable({ emitEvent: false });\r\n          this.eavService.formDisabledChange$.next({ formId: this.config.form.formId, entityGuid: this.config.entity.entityGuid });\r\n          this.defaultLanguageMissingValue$.next(true);\r\n        } else {\r\n          this.defaultLanguageMissingValue$.next(false);\r\n          if (this.isTranslateDisabled(attributeKey)) {\r\n            this.group.controls[attributeKey].disable({ emitEvent: false });\r\n            this.eavService.formDisabledChange$.next({ formId: this.config.form.formId, entityGuid: this.config.entity.entityGuid });\r\n          } else if (LocalizationHelper.isEditableTranslationExist(attributes, currentLanguage, defaultLanguage)) {\r\n            this.group.controls[attributeKey].enable({ emitEvent: false });\r\n            this.eavService.formDisabledChange$.next({ formId: this.config.form.formId, entityGuid: this.config.entity.entityGuid });\r\n          } else if (LocalizationHelper.isReadonlyTranslationExist(attributes, currentLanguage)) {\r\n            this.group.controls[attributeKey].disable({ emitEvent: false });\r\n            this.eavService.formDisabledChange$.next({ formId: this.config.form.formId, entityGuid: this.config.entity.entityGuid });\r\n          } else {\r\n            this.group.controls[attributeKey].disable({ emitEvent: false });\r\n            this.eavService.formDisabledChange$.next({ formId: this.config.form.formId, entityGuid: this.config.entity.entityGuid });\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /** Translate a field configuration (labels, validation, ...) */\r\n  private translateAllConfiguration() {\r\n    const fieldSettings = LocalizationHelper.translateSettings(this.config.field.fullSettings,\r\n      this.currentLanguage, this.defaultLanguage);\r\n    this.config.field.settings = fieldSettings;\r\n    this.config.field.label = this.config.field.settings.Name || null;\r\n    this.config.field.validation = ValidationHelper.getValidations(this.config.field.settings);\r\n    this.config.field.required = ValidationHelper.isRequired(this.config.field.settings);\r\n    this.config.field.settings$?.next(fieldSettings); // must run after validations are recalculated\r\n  }\r\n\r\n  private subscribeToCurrentLanguageFromStore() {\r\n    this.subscription.add(\r\n      this.currentLanguage$.subscribe(currentLanguage => {\r\n        this.currentLanguage = currentLanguage;\r\n        this.translateAllConfiguration();\r\n        this.refreshControlConfig(this.config.field.name);\r\n      })\r\n    );\r\n  }\r\n\r\n  private subscribeToDefaultLanguageFromStore() {\r\n    this.subscription.add(\r\n      this.defaultLanguage$.subscribe(defaultLanguage => {\r\n        this.defaultLanguage = defaultLanguage;\r\n        this.translateAllConfiguration();\r\n        this.refreshControlConfig(this.config.field.name);\r\n      })\r\n    );\r\n  }\r\n\r\n  /** Subscribe to item attribute values */\r\n  private subscribeToAttributeValues() {\r\n    this.subscription.add(\r\n      this.attributes$.subscribe(attributes => {\r\n        this.attributes = attributes;\r\n      })\r\n    );\r\n  }\r\n\r\n  private subscribeToEntityHeaderFromStore() {\r\n    if (this.config.entity.header.Group && this.config.entity.header.Group.SlotCanBeEmpty) {\r\n      this.subscription.add(\r\n        this.itemService.selectHeaderByEntityId(this.config.entity.entityId, this.config.entity.entityGuid).subscribe(header => {\r\n          if (header.Group && !this.fieldConfig.isParentGroup) {\r\n            this.headerGroupSlotIsEmpty = header.Group.SlotIsEmpty;\r\n            this.setControlDisable(this.attributes[this.config.field.name], this.config.field.name,\r\n              this.currentLanguage, this.defaultLanguage);\r\n          }\r\n        })\r\n      );\r\n    }\r\n  }\r\n\r\n  /** Fetch current item */\r\n  private subscribeToItemFromStore() {\r\n    this.subscription.add(\r\n      this.itemService.selectItemById(this.config.entity.entityId).subscribe(item => {\r\n        this.item = item;\r\n      })\r\n    );\r\n  }\r\n\r\n  /** Fetch contentType of current item */\r\n  private subscribeToContentTypeFromStore() {\r\n    const contentTypeId = this.item.entity.type === null\r\n      ? this.item.header.ContentTypeName\r\n      : this.item.entity.type.id;\r\n    this.subscription.add(\r\n      this.contentTypeService.getContentTypeById(contentTypeId).subscribe(contentType => {\r\n        this.contentType = contentType;\r\n      })\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Fetch inputType definition to check if input field of this type shouldn't be translated\r\n   * @param attributeType new attribute type defined in contentTypes\r\n   */\r\n  public isTranslateDisabled(attributeKey: string) {\r\n    if (!LocalizationHelper.translationExistsInDefault(this.attributes[attributeKey], this.defaultLanguage)) { return true; }\r\n    const attributeDef = this.contentType.contentType.attributes.find(attr => attr.name === attributeKey);\r\n    if (attributeDef == null) {\r\n      // since it's not defined it's not disabled. Happens when creating a new metadata entity, like settings for a field\r\n      return false;\r\n    }\r\n\r\n    const calculatedInputType = InputFieldHelper.calculateInputType(attributeDef, this.inputTypeService);\r\n    const disableI18n = LocalizationHelper.isI18nDisabled(this.inputTypeService, calculatedInputType, attributeDef.settings);\r\n    return disableI18n;\r\n  }\r\n\r\n  private readTranslationState(attributes: EavValues<any>, attributeKey: string, currentLanguage: string, defaultLanguage: string) {\r\n    // Determine is control disabled or enabled and info message\r\n    if (!LocalizationHelper.translationExistsInDefault(attributes, defaultLanguage)) {\r\n      this.setTranslationState(TranslationLinkConstants.MissingDefaultLangValue, '');\r\n    } else if (this.isTranslateDisabled(attributeKey)) {\r\n      this.setTranslationState(TranslationLinkConstants.DontTranslate, '');\r\n    } else if (LocalizationHelper.isEditableTranslationExist(attributes, currentLanguage, defaultLanguage)) {\r\n      const editableElements: EavDimensions<string>[] = LocalizationHelper.getValueTranslation(attributes,\r\n        currentLanguage, defaultLanguage)\r\n        .dimensions.filter(f => f.value !== currentLanguage);\r\n      if (editableElements.length > 0) {\r\n        this.setTranslationState(TranslationLinkConstants.LinkReadWrite, editableElements[0].value);\r\n      } else {\r\n        this.setTranslationState(TranslationLinkConstants.Translate, '');\r\n      }\r\n    } else if (LocalizationHelper.isReadonlyTranslationExist(attributes, currentLanguage)) {\r\n      const readOnlyElements: EavDimensions<string>[] = LocalizationHelper.getValueTranslation(attributes,\r\n        currentLanguage, defaultLanguage)\r\n        .dimensions.filter(f => f.value !== currentLanguage);\r\n      this.setTranslationState(TranslationLinkConstants.LinkReadOnly, readOnlyElements[0].value);\r\n    } else {\r\n      this.setTranslationState(TranslationLinkConstants.DontTranslate, '');\r\n    }\r\n  }\r\n\r\n  /** Subscribe triggered when changing all in menu (forAllFields) */\r\n  private subscribeMenuChange() {\r\n    this.subscription.add(\r\n      this.languageInstanceService.localizationWrapperMenuChange$.subscribe(s => {\r\n        if (!this.fieldConfig.isParentGroup) {\r\n          this.refreshControlConfig(this.config.field.name);\r\n        }\r\n      })\r\n    );\r\n  }\r\n\r\n  /** Set info message */\r\n  private setInfoMessage(attributes: EavValues<any>, attributeKey: string, currentLanguage: string, defaultLanguage: string) {\r\n    // Determine whether control is disabled or enabled and info message\r\n    if (this.isTranslateDisabled(attributeKey)) {\r\n      this.infoMessage$.next('');\r\n      this.infoMessageLabel$.next('LangMenu.InAllLanguages');\r\n      return;\r\n    } else if (!LocalizationHelper.translationExistsInDefault(attributes, defaultLanguage)) {\r\n      this.infoMessage$.next(defaultLanguage);\r\n      this.infoMessageLabel$.next('LangMenu.MissingDefaultLangValue');\r\n      return;\r\n    }\r\n\r\n    const isEditableTranslationExist: boolean = LocalizationHelper.isEditableTranslationExist(attributes, currentLanguage, defaultLanguage);\r\n    const isReadonlyTranslationExist: boolean = LocalizationHelper.isReadonlyTranslationExist(attributes, currentLanguage);\r\n\r\n    if (isEditableTranslationExist || isReadonlyTranslationExist) {\r\n      let dimensions: string[] = LocalizationHelper.getValueTranslation(attributes, currentLanguage, defaultLanguage)\r\n        .dimensions.map(d => d.value);\r\n\r\n      dimensions = dimensions.filter(d => !d.includes(currentLanguage));\r\n\r\n      const isShared = dimensions.length > 0;\r\n      if (isShared) {\r\n        this.infoMessage$.next(TranslateGroupMenuHelpers.calculateSharedInfoMessage(dimensions, currentLanguage));\r\n\r\n        if (isEditableTranslationExist) {\r\n          this.infoMessageLabel$.next('LangMenu.In');\r\n        } else if (isReadonlyTranslationExist) {\r\n          this.infoMessageLabel$.next('LangMenu.From');\r\n        }\r\n      } else {\r\n        this.infoMessage$.next('');\r\n        this.infoMessageLabel$.next('');\r\n      }\r\n    } else {\r\n      this.infoMessage$.next('');\r\n      this.infoMessageLabel$.next('LangMenu.UseDefault');\r\n    }\r\n  }\r\n}\r\n","import { Directive, ElementRef, OnInit, OnDestroy, NgZone } from '@angular/core';\r\n\r\n@Directive({ selector: '[appChangeAnchorTarget]' })\r\nexport class ChangeAnchorTargetDirective implements OnInit, OnDestroy {\r\n  private target = '_blank';\r\n  private element: HTMLElement;\r\n  private observer: MutationObserver;\r\n\r\n  constructor(elementRef: ElementRef, private zone: NgZone) {\r\n    this.element = elementRef.nativeElement;\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.zone.runOutsideAngular(() => {\r\n      this.observer = new MutationObserver((mutations: MutationRecord[]) => {\r\n        if (this.element.tagName === 'A') {\r\n          const anchor = this.element as HTMLAnchorElement;\r\n          if (anchor.target !== this.target) {\r\n            anchor.target = this.target;\r\n          }\r\n        }\r\n        const childAnchors = this.element.getElementsByTagName('a');\r\n        // tslint:disable-next-line:prefer-for-of\r\n        for (let i = 0; i < childAnchors.length; i++) {\r\n          const anchor = childAnchors[i];\r\n          if (anchor.target !== this.target) {\r\n            anchor.target = this.target;\r\n          }\r\n        }\r\n      });\r\n      this.observer.observe(this.element, { childList: true, subtree: true });\r\n    });\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.zone.runOutsideAngular(() => {\r\n      this.observer.disconnect();\r\n    });\r\n  }\r\n}\r\n","<mat-card class=\"shadow-bottom-z-1\"\r\n  [ngClass]=\"fieldConfig.isParentGroup ? 'mat-card-group-parent' : 'mat-card-group-child'\">\r\n  <div fxLayout=\"row\" fxLayoutAlign=\"start center\"\r\n    [ngClass]=\"fieldConfig.isParentGroup ? 'mat-card-header-group-parent' : 'mat-card-header-group-child'\" *ngIf=\"{\r\n      collapse: collapse$ | async,\r\n      itemTitle: itemTitle$ | async,\r\n      currentLanguage: currentLanguage$ | async,\r\n      defaultLanguage: defaultLanguage$ | async,\r\n      slotCanBeEmpty: slotCanBeEmpty$ | async,\r\n      slotIsEmpty: slotIsEmpty$ | async\r\n    } as data\">\r\n\r\n    <div fxFlex=\"auto\" fxLayoutAlign=\"start center\" (click)=\"toggleCollapse()\">\r\n      <div fxLayoutAlign=\"start center\" class=\"mat-card-title-group\"\r\n        [ngClass]=\"fieldConfig.isParentGroup ? 'mat-display-1' : 'mat-body-1'\">\r\n        <mat-icon>\r\n          {{ data.collapse ? 'keyboard_arrow_down' : 'keyboard_arrow_up' }}\r\n        </mat-icon>\r\n        <span class=\"title\">\r\n          {{ data.itemTitle || ('ItemCard.DefaultTitle' | translate) }}\r\n        </span>\r\n      </div>\r\n    </div>\r\n    <mat-slide-toggle fxLayoutAlign=\"start center\" *ngIf=\"data.slotCanBeEmpty\" (change)=\"toggleSlotIsEmpty()\"\r\n      [checked]=\"!data.slotIsEmpty\" [disabled]=\"data.currentLanguage !== data.defaultLanguage\"\r\n      [matTooltip]=\"(!data.slotIsEmpty ? 'ItemCard.SlotUsedTrue' : 'ItemCard.SlotUsedFalse') | translate\"\r\n      [matTooltipDisabled]=\"data.currentLanguage !== data.defaultLanguage\">\r\n    </mat-slide-toggle>\r\n    <app-translate-group-menu *ngIf=\"fieldConfig.isParentGroup\" fxLayoutAlign=\"end center\" [config]=\"config\"\r\n      [group]=\"group\">\r\n    </app-translate-group-menu>\r\n  </div>\r\n\r\n  <mat-card-content [ngStyle]=\"{ 'display': (collapse$ | async) ? 'none' : 'block' }\"\r\n    [ngClass]=\"fieldConfig.isParentGroup ? 'mat-card-content-group-parent' : 'mat-card-content-group-child'\">\r\n    <div class=\"mdc-layout-grid\">\r\n      <div class=\"mdc-layout-grid__inner\">\r\n        <div class=\"mdc-layout-grid__cell--span-12 mat-body-1\" align=\"start\" *ngIf=\"description$ | async\">\r\n          <div class=\"description\" appChangeAnchorTarget [innerHtml]=\"(description$ | async) | safeHtml\"></div>\r\n        </div>\r\n        <div class=\"mdc-layout-grid__cell--span-12\">\r\n          <ng-container #fieldComponent></ng-container>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </mat-card-content>\r\n</mat-card>\r\n","import { Component, ViewChild, ViewContainerRef, Input, OnInit, OnDestroy, ChangeDetectionStrategy } from '@angular/core';\r\nimport { FormGroup } from '@angular/forms';\r\nimport { Subscription, Observable, BehaviorSubject } from 'rxjs';\r\nimport { take, map } from 'rxjs/operators';\r\n\r\nimport { FieldWrapper } from '../../../eav-dynamic-form/model/field-wrapper';\r\nimport { EavHeader, ContentType } from '../../../shared/models/eav';\r\nimport { ItemService } from '../../../shared/store/ngrx-data/item.service';\r\nimport { FieldConfigSet, FieldConfigGroup } from '../../../eav-dynamic-form/model/field-config';\r\nimport { LanguageInstanceService } from '../../../shared/store/ngrx-data/language-instance.service';\r\nimport { ContentTypeService } from '../../../shared/store/ngrx-data/content-type.service';\r\nimport { LocalizationHelper } from '../../../shared/helpers/localization-helper';\r\nimport { ValidationHelper } from '../../validators/validation-helper';\r\n\r\n@Component({\r\n  selector: 'app-collapsible-wrapper',\r\n  templateUrl: './collapsible-wrapper.component.html',\r\n  styleUrls: ['./collapsible-wrapper.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class CollapsibleWrapperComponent implements FieldWrapper, OnInit, OnDestroy {\r\n  @ViewChild('fieldComponent', { static: true, read: ViewContainerRef }) fieldComponent: ViewContainerRef;\r\n  @Input() config: FieldConfigSet;\r\n  @Input() group: FormGroup;\r\n\r\n  fieldConfig: FieldConfigGroup;\r\n  collapse$ = new BehaviorSubject(false);\r\n  currentLanguage$: Observable<string>;\r\n  defaultLanguage$: Observable<string>;\r\n  itemTitle$: Observable<string>;\r\n  slotCanBeEmpty$: Observable<boolean>;\r\n  slotIsEmpty$: Observable<boolean>;\r\n  description$: Observable<string>;\r\n\r\n  private header$: Observable<EavHeader>;\r\n  private subscription = new Subscription();\r\n\r\n  constructor(\r\n    private itemService: ItemService,\r\n    private languageInstanceService: LanguageInstanceService,\r\n    private contentTypeService: ContentTypeService,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.fieldConfig = this.config.field as FieldConfigGroup;\r\n    this.header$ = this.itemService.selectHeaderByEntityId(this.config.entity.entityId, this.config.entity.entityGuid);\r\n\r\n    this.collapse$.next(this.fieldConfig.settings$.value.DefaultCollapsed || false);\r\n    this.currentLanguage$ = this.languageInstanceService.getCurrentLanguage(this.config.form.formId);\r\n    this.defaultLanguage$ = this.languageInstanceService.getDefaultLanguage(this.config.form.formId);\r\n    this.slotCanBeEmpty$ = this.header$.pipe(map(header => header?.Group?.SlotCanBeEmpty || false));\r\n    this.slotIsEmpty$ = this.header$.pipe(map(header => header?.Group?.SlotIsEmpty || false));\r\n\r\n    this.itemTitle$ = !this.fieldConfig.isParentGroup\r\n      ? this.fieldConfig.settings$.pipe(map(settings => settings.Name))\r\n      : this.currentLanguage$.pipe(map(currentLanguage => {\r\n        let contentType: ContentType;\r\n        this.contentTypeService.getContentTypeById(this.config.entity.contentTypeId).pipe(take(1)).subscribe(cType => {\r\n          contentType = cType;\r\n        });\r\n        let defaultLanguage: string;\r\n        this.defaultLanguage$.pipe(take(1)).subscribe(defaultLang => {\r\n          defaultLanguage = defaultLang;\r\n        });\r\n        let label: string;\r\n        try {\r\n          const type = contentType.contentType.metadata\r\n            // xx ContentType is a historic bug and should be fixed when JSONs are rechecked\r\n            .find(metadata => metadata.type.name === 'ContentType' || metadata.type.name === 'xx ContentType');\r\n          if (!!type) {\r\n            label = LocalizationHelper.getValueOrDefault(type.attributes.Label, currentLanguage, defaultLanguage)?.value;\r\n          }\r\n          label = label || contentType.contentType.name;\r\n        } catch (error) {\r\n          label = contentType.contentType.name;\r\n        }\r\n        return label;\r\n      }));\r\n\r\n    this.description$ = this.fieldConfig.settings$.pipe(map(settings => {\r\n      if (this.fieldConfig.isParentGroup) {\r\n        return settings.EditInstructions != null ? settings.EditInstructions : '';\r\n      }\r\n      return settings.Notes != null ? settings.Notes : '';\r\n    }));\r\n\r\n    this.subscription.add(this.currentLanguage$.subscribe(currentLanguage => {\r\n      let defaultLanguage: string;\r\n      this.defaultLanguage$.pipe(take(1)).subscribe(defaultLang => {\r\n        defaultLanguage = defaultLang;\r\n      });\r\n      this.translateAllConfiguration(currentLanguage, defaultLanguage);\r\n    }));\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.collapse$.complete();\r\n    this.subscription.unsubscribe();\r\n  }\r\n\r\n  toggleCollapse() {\r\n    this.collapse$.next(!this.collapse$.value);\r\n  }\r\n\r\n  toggleSlotIsEmpty() {\r\n    let header: EavHeader;\r\n    this.header$.pipe(take(1)).subscribe(hdr => {\r\n      header = hdr;\r\n    });\r\n    const newHeader: EavHeader = { ...header, Group: { ...header.Group, SlotIsEmpty: !header.Group.SlotIsEmpty } };\r\n    this.itemService.updateItemHeader(this.config.entity.entityId, this.config.entity.entityGuid, newHeader);\r\n  }\r\n\r\n  private translateAllConfiguration(currentLanguage: string, defaultLanguage: string) {\r\n    const fieldSettings = LocalizationHelper.translateSettings(this.fieldConfig.fullSettings, currentLanguage, defaultLanguage);\r\n    this.fieldConfig.settings = fieldSettings;\r\n    this.fieldConfig.label = this.fieldConfig.settings.Name || null;\r\n    this.fieldConfig.validation = ValidationHelper.getValidations(this.fieldConfig.settings);\r\n    this.fieldConfig.required = ValidationHelper.isRequired(this.fieldConfig.settings);\r\n    this.config.field.settings$?.next(fieldSettings); // must run after validations are recalculated\r\n  }\r\n}\r\n","import { DropzoneConfigExt } from '../../../../edit-types';\r\n\r\nexport class DropzoneConfigInstance implements DropzoneConfigExt {\r\n  /** Subfolder and UsePortalRoot are updated from AdamBrowser */\r\n  disabled: boolean;\r\n  url: string;\r\n  headers: any;\r\n  acceptedFiles: string = null;\r\n  maxFiles = 1000;\r\n  parallelUploads = 1000;\r\n  autoReset: number = null;\r\n  errorReset: number = null;\r\n  cancelReset: number = null;\r\n  /** In MB. Upload will also be stopped on the server if file is larger than allowed */\r\n  maxFilesize = 10000;\r\n  paramName = 'uploadfile';\r\n  maxThumbnailFilesize = 10;\r\n  dictDefaultMessage = '';\r\n  addRemoveLinks = false;\r\n  previewsContainer = '.dropzone-previews';\r\n  /**\r\n   * We need a clickable, because otherwise the entire area is clickable,\r\n   * so i'm just making the preview clickable, as it's not important\r\n   */\r\n  clickable = '.dropzone-previews';\r\n\r\n  constructor(disabled: boolean, url: string, headers: any) {\r\n    this.disabled = disabled;\r\n    this.url = url;\r\n    this.headers = headers;\r\n  }\r\n}\r\n","import { Component, OnInit, ViewContainerRef, ViewChild, AfterViewInit, NgZone, OnDestroy, ChangeDetectionStrategy } from '@angular/core';\r\nimport { DropzoneDirective } from 'ngx-dropzone-wrapper';\r\nimport { BehaviorSubject, Observable, combineLatest } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\nimport { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\n\r\nimport { FieldWrapper } from '../../../eav-dynamic-form/model/field-wrapper';\r\nimport { EavConfig } from '../../../shared/models/eav-configuration';\r\nimport { EavService } from '../../../shared/services/eav.service';\r\nimport { angularConsoleLog } from '../../../../ng-dialogs/src/app/shared/helpers/angular-console-log.helper';\r\nimport { DropzoneConfigInstance } from './dropzone-wrapper.models';\r\nimport { DropzoneConfigExt, AdamPostResponse } from '../../../../edit-types';\r\nimport { BaseComponent } from '../../input-types/base/base.component';\r\nimport { ValidationMessagesService } from '../../validators/validation-messages-service';\r\n\r\n@Component({\r\n  selector: 'app-dropzone-wrapper',\r\n  templateUrl: './dropzone-wrapper.component.html',\r\n  styleUrls: ['./dropzone-wrapper.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class DropzoneWrapperComponent extends BaseComponent<any> implements FieldWrapper, OnInit, AfterViewInit, OnDestroy {\r\n  @ViewChild('fieldComponent', { static: true, read: ViewContainerRef }) fieldComponent: ViewContainerRef;\r\n  @ViewChild(DropzoneDirective) dropzoneRef: DropzoneDirective;\r\n\r\n  dropzoneConfig$ = new BehaviorSubject<DropzoneConfigExt>(null);\r\n  dropzoneDisabled$: Observable<boolean>;\r\n  private eavConfig: EavConfig;\r\n\r\n  constructor(\r\n    eavService: EavService,\r\n    validationMessagesService: ValidationMessagesService,\r\n    private dnnContext: DnnContext,\r\n    private zone: NgZone,\r\n  ) {\r\n    super(eavService, validationMessagesService);\r\n    this.eavConfig = eavService.getEavConfig();\r\n  }\r\n\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n    this.dropzoneDisabled$ = combineLatest([this.disabled$, this.dropzoneConfig$]).pipe(map(combined => {\r\n      const controlDisabled = combined[0];\r\n      const dropzoneConfig = combined[1];\r\n      const dropzoneDisabled = (dropzoneConfig != null) ? dropzoneConfig.disabled : true;\r\n      return controlDisabled || dropzoneDisabled;\r\n    }));\r\n\r\n    this.config.dropzone = {\r\n      setConfig: (config) => {\r\n        this.zone.run(() => {\r\n          this.setConfig(config);\r\n        });\r\n      },\r\n      getConfig: () => this.dropzoneConfig$.value,\r\n      getConfig$: () => this.dropzoneConfig$.asObservable(),\r\n      uploadFile: (image) => {\r\n        this.zone.run(() => {\r\n          this.uploadFile(image);\r\n        });\r\n      }\r\n    };\r\n\r\n    this.config.dropzone.setConfig({});\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    this.config.dropzone.setConfig({\r\n      previewsContainer: '.field-' + this.config.field.index + ' .dropzone-previews',\r\n      clickable: '.field-' + this.config.field.index + ' .invisible-clickable',\r\n    });\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.dropzoneConfig$.complete();\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  onUploadError(args: any) {\r\n    angularConsoleLog('Dropzone upload error. Args:', args);\r\n    this.dropzoneRef.reset();\r\n  }\r\n\r\n  onUploadSuccess(args: any) {\r\n    const response: AdamPostResponse = args[1]; // Gets the server response as second argument.\r\n    if (response.Success) {\r\n      if (this.config.adam) {\r\n        this.config.adam.addFullPath(response);\r\n        this.config.adam.onItemUpload(response);\r\n        this.config.adam.refresh();\r\n      } else {\r\n        alert(`Upload failed because: ADAM reference doesn't exist`);\r\n      }\r\n    } else {\r\n      alert(`Upload failed because: ${response.Error}`);\r\n    }\r\n    this.dropzoneRef.reset();\r\n  }\r\n\r\n  private setConfig(config: Partial<DropzoneConfigExt>) {\r\n    const contentType = this.config.entity.header.ContentTypeName;\r\n    const entityGuid = this.config.entity.header.Guid;\r\n    const field = this.config.field.name;\r\n    const appId = this.eavConfig.appId;\r\n\r\n    const startDisabled = this.config.field.isExternal;\r\n    const url = this.dnnContext.$2sxc.http.apiUrl(`app-content/${contentType}/${entityGuid}/${field}?subfolder=&usePortalRoot=false&appId=${appId}`);\r\n    const headers = this.dnnContext.sxc.webApi.headers();\r\n\r\n    const oldConfig = (this.dropzoneConfig$.value != null)\r\n      ? this.dropzoneConfig$.value\r\n      : new DropzoneConfigInstance(startDisabled, url, headers);\r\n    const newConfig = new DropzoneConfigInstance(startDisabled, url, headers);\r\n\r\n    const newConfigKeys = Object.keys(newConfig);\r\n    for (const key of newConfigKeys) {\r\n      (newConfig as any)[key] = ((config as any)[key] != null) ? (config as any)[key] : (oldConfig as any)[key];\r\n    }\r\n\r\n    // fixes\r\n    const syncUploadLimit = newConfig.maxFiles !== newConfig.parallelUploads;\r\n    if (syncUploadLimit) {\r\n      const uploadLimit = (newConfig.maxFiles >= newConfig.parallelUploads) ? newConfig.maxFiles : newConfig.parallelUploads;\r\n      newConfig.maxFiles = uploadLimit;\r\n      newConfig.parallelUploads = uploadLimit;\r\n    }\r\n    const fixAcceptedFiles = newConfig.acceptedFiles == null || newConfig.acceptedFiles === '';\r\n    if (fixAcceptedFiles) {\r\n      delete newConfig.acceptedFiles; // only way to tell dropzone to accept all files is to remove acceptedFiles from config\r\n    }\r\n\r\n    this.dropzoneConfig$.next(newConfig);\r\n  }\r\n\r\n  private uploadFile(file: File) {\r\n    const dropzone = this.dropzoneRef.dropzone();\r\n    (file as any).upload = { chunked: dropzone.defaultOptions.chunking };\r\n    dropzone.processFile(file);\r\n  }\r\n\r\n}\r\n","<div class=\"dropzone dropzone-container\" [ngClass]=\"{ 'dropzone-disabled': dropzoneDisabled$ | async }\"\r\n  [dropzone]=\"dropzoneConfig$ | async\" [disabled]=\"dropzoneDisabled$ | async\" (error)=\"onUploadError($event)\"\r\n  (success)=\"onUploadSuccess($event)\">\r\n  <ng-container #fieldComponent></ng-container>\r\n</div>\r\n","import { Component, OnInit, OnDestroy, ViewChild, ViewContainerRef, ChangeDetectionStrategy } from '@angular/core';\r\nimport { Observable, BehaviorSubject } from 'rxjs';\r\nimport { take } from 'rxjs/operators';\r\n\r\nimport { FieldWrapper } from '../../../eav-dynamic-form/model/field-wrapper';\r\nimport { LanguageInstanceService } from '../../../shared/store/ngrx-data/language-instance.service';\r\nimport { EditRoutingService } from '../../../shared/services/edit-routing.service';\r\nimport { BaseComponent } from '../../input-types/base/base.component';\r\nimport { EavService } from '../../../shared/services/eav.service';\r\nimport { ValidationMessagesService } from '../../validators/validation-messages-service';\r\n\r\n@Component({\r\n  selector: 'app-eav-localization-wrapper',\r\n  templateUrl: './eav-localization-wrapper.component.html',\r\n  styleUrls: ['./eav-localization-wrapper.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class EavLocalizationComponent extends BaseComponent<any> implements FieldWrapper, OnInit, OnDestroy {\r\n  @ViewChild('fieldComponent', { static: true, read: ViewContainerRef }) fieldComponent: ViewContainerRef;\r\n  currentLanguage$: Observable<string>;\r\n  defaultLanguage$: Observable<string>;\r\n  open$: Observable<boolean>;\r\n  toggleTranslateField$ = new BehaviorSubject(false);\r\n\r\n  constructor(\r\n    eavService: EavService,\r\n    validationMessagesService: ValidationMessagesService,\r\n    private languageInstanceService: LanguageInstanceService,\r\n    private editRoutingService: EditRoutingService,\r\n  ) {\r\n    super(eavService, validationMessagesService);\r\n  }\r\n\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n    this.currentLanguage$ = this.languageInstanceService.getCurrentLanguage(this.config.form.formId);\r\n    this.defaultLanguage$ = this.languageInstanceService.getDefaultLanguage(this.config.form.formId);\r\n    this.open$ = this.editRoutingService.isExpanded(this.config.field.index, this.config.entity.entityGuid);\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.toggleTranslateField$.complete();\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  toggleTranslate() {\r\n    let open: boolean;\r\n    this.open$.pipe(take(1)).subscribe(isOpen => {\r\n      open = isOpen;\r\n    });\r\n    let currentLanguage: string;\r\n    this.currentLanguage$.pipe(take(1)).subscribe(lang => {\r\n      currentLanguage = lang;\r\n    });\r\n    let defaultLanguage: string;\r\n    this.defaultLanguage$.pipe(take(1)).subscribe(lang => {\r\n      defaultLanguage = lang;\r\n    });\r\n    const toggleEnabled = !open && currentLanguage !== defaultLanguage;\r\n    if (!toggleEnabled) { return; }\r\n\r\n    this.toggleTranslateField$.next(!this.toggleTranslateField$.value);\r\n  }\r\n}\r\n","<div class=\"language-wrap\">\r\n  <div class=\"language-wrap__field\" (dblclick)=\"toggleTranslate()\"\r\n    [ngClass]=\"{ 'language-wrap__field-short': (currentLanguage$ | async) !== (defaultLanguage$ | async) }\">\r\n    <ng-container #fieldComponent></ng-container>\r\n  </div>\r\n  <app-translate-group-menu class=\"language-wrap__translate\" [ngClass]=\"{\r\n    'language-wrap__translate--hidden': (currentLanguage$ | async) === (defaultLanguage$ | async)\r\n  }\" [config]=\"config\" [group]=\"group\" [toggleTranslateField]=\"toggleTranslateField$ | async\">\r\n  </app-translate-group-menu>\r\n</div>\r\n","import { trigger, state, transition, style, animate, keyframes } from '@angular/animations';\r\n\r\nexport const ContentExpandAnimation = [\r\n    trigger('itemShrinkAnimation', [\r\n        state('open', style({\r\n            height: '30vh'\r\n        })),\r\n        state('closed', style({\r\n            height: '0vh'\r\n        })),\r\n        transition('open => closed', [\r\n            animate('300ms cubic-bezier(0.4, 0.0, 0.2, 1)'),\r\n        ]),\r\n    ]),\r\n    trigger('contentExpandAnimation', [\r\n        state('closed', style({\r\n            height: '0',\r\n        })),\r\n        state('expanded', style({\r\n            height: 'calc(100vh - {{bottomPixels}})', // 100px on desktop, 50px on mobile\r\n            maxHeight: 'calc(100vh - {{bottomPixels}})',\r\n        }), { params: { bottomPixels: window.innerWidth > 600 ? '100px' : '50px' } }),\r\n        transition('closed => expanded', [\r\n            animate('300ms cubic-bezier(0.4, 0.0, 0.2, 1)', keyframes([\r\n                style({ height: '0vh', overflow: 'hidden' }),\r\n                style({ height: 'calc(100vh - {{bottomPixels}})', overflow: 'hidden' }),\r\n            ])),\r\n        ], { params: { bottomPixels: window.innerWidth > 600 ? '100px' : '50px' } }),\r\n    ]),\r\n];\r\n","import { TranslateService } from '@ngx-translate/core';\r\n\r\nimport { Helper } from '../../../../shared/helpers/helper';\r\nimport { SelectedEntity } from './entity-default.models';\r\nimport { EntityInfo } from '../../../../shared/models/eav/entity-info';\r\n\r\nexport function calculateSelectedEntities(\r\n  fieldValue: string | string[],\r\n  separator: string,\r\n  availableEntities: EntityInfo[],\r\n  translate: TranslateService,\r\n) {\r\n  // name is guid or freetext\r\n  const names = typeof fieldValue === 'string' ? Helper.convertValueToArray(fieldValue, separator) : fieldValue;\r\n  const selectedEntities = names.map(name => {\r\n    const entity = availableEntities.find(e => e.Value === name);\r\n    let label: string;\r\n    if (name == null) {\r\n      label = 'empty slot';\r\n    } else if (typeof fieldValue === 'string') {\r\n      label = entity != null ? entity.Text : name;\r\n    } else {\r\n      label = entity != null ? entity.Text : translate.instant('Fields.Entity.EntityNotFound');\r\n    }\r\n    const selectedEntity: SelectedEntity = {\r\n      value: name,\r\n      label,\r\n      tooltip: `${label} (${name})`,\r\n      isFreeTextOrNotFound: entity == null,\r\n    };\r\n    return selectedEntity;\r\n  });\r\n\r\n  return selectedEntities;\r\n}\r\n","<ng-container *ngIf=\"{\r\n  invalid: invalid$ | async,\r\n  description: description$ | async\r\n} as data\">\r\n  <div class=\"c-fht__container\" [ngClass]=\"{\r\n  'c-fht__container--no-hint': !data.description && !(data.invalid && !disableError),\r\n  'c-fht__container--last': config.field.isLastInGroup,\r\n  'c-fht__container--last--no-hint': config.field.isLastInGroup && !data.description && !(data.invalid && !disableError)\r\n}\">\r\n    <mat-hint *ngIf=\"data.description\" class=\"mat-caption\" (click)=\"toggleHint($event)\"\r\n      [ngClass]=\"control.disabled ? 'c-fht__container-hint--disabled' : 'c-fht__container-hint'\" align=\"start\"\r\n      fxLayout=\"row\" fxLayoutAlign=\"start start\">\r\n      <span class=\"notes-container\" [ngClass]=\"{ 'c-fht__container-hint--ellipsis': !isFullText }\" appChangeAnchorTarget\r\n        [innerHtml]=\"data.description | safeHtml\">\r\n      </span>\r\n    </mat-hint>\r\n    <mat-error *ngIf=\"data.invalid && !disableError\" class=\"mat-caption\">\r\n      {{ getErrorMessage() | translate:{ param:config.field.settings } }}\r\n    </mat-error>\r\n  </div>\r\n</ng-container>\r\n","import { Component, OnInit, Input, ChangeDetectionStrategy } from '@angular/core';\r\nimport { FormGroup, AbstractControl } from '@angular/forms';\r\nimport { Observable } from 'rxjs';\r\nimport { map, startWith } from 'rxjs/operators';\r\n\r\nimport { FieldConfigSet } from '../../../eav-dynamic-form/model/field-config';\r\nimport { ValidationMessagesService } from '../../validators/validation-messages-service';\r\n\r\n@Component({\r\n  selector: 'app-field-helper-text',\r\n  templateUrl: './field-helper-text.component.html',\r\n  styleUrls: ['./field-helper-text.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class FieldHelperTextComponent implements OnInit {\r\n  @Input() config: FieldConfigSet;\r\n  @Input() group: FormGroup;\r\n  @Input() disableError = false;\r\n\r\n  isFullText = false;\r\n  description$: Observable<string>;\r\n  invalid$: Observable<boolean>;\r\n  control: AbstractControl;\r\n\r\n  constructor(private validationMessagesService: ValidationMessagesService) { }\r\n\r\n  ngOnInit() {\r\n    this.control = this.group.controls[this.config.field.name];\r\n    this.invalid$ = this.control.statusChanges.pipe(map(status => status === 'INVALID'), startWith(this.control.invalid));\r\n    this.description$ = this.config.field.settings$.pipe(map(settings => settings.Notes));\r\n  }\r\n\r\n  /** Don't toggle if clicked on an anchor tag or it's children */\r\n  toggleHint(event: MouseEvent) {\r\n    let target = event.target as HTMLElement;\r\n\r\n    if (target.tagName === 'A') { return; }\r\n    while (target && target.classList && !target.classList.contains('notes-container')) {\r\n      target = target.parentNode as HTMLElement;\r\n      if (!target) { return; }\r\n      if (target.tagName === 'A') { return; }\r\n    }\r\n\r\n    this.isFullText = !this.isFullText;\r\n  }\r\n\r\n  getErrorMessage() {\r\n    return this.validationMessagesService.getErrorMessage(this.control, this.config);\r\n  }\r\n}\r\n","<div [ngClass]=\"(dialogIsOpen$ | async) ? 'c-ew__container' : 'u-display-none'\">\r\n  <div class=\"c-ew__backdrop\" (click)=\"closeDialog()\"></div>\r\n  <div fxLayout=\"column\" class=\"c-ew__dialog mat-elevation-z24\">\r\n    <div [ngClass]=\"{ 'c-ew__dialog-header mat-elevation-z2': dialogIsOpen$ | async }\">\r\n      <mat-card class=\"mat-elevation-z0\" fxLayout=\"row\">\r\n        <button mat-icon-button class=\"back-arrow\" fxLayoutAlign=\"center center\"\r\n          [matTooltip]=\"'Form.Buttons.Return.Tip' | translate\" (click)=\"closeDialog()\">\r\n          <mat-icon>arrow_back</mat-icon>\r\n        </button>\r\n        <span fxLayoutAlign=\"center center\" class=\"title mat-display-1\">{{ label$ | async }}</span>\r\n      </mat-card>\r\n    </div>\r\n    <div>\r\n      <div [@itemShrinkAnimation]=\"!(dialogIsOpen$ | async) ? 'open' : 'closed'\">\r\n      </div>\r\n      <div class=\"c-ew__dialog-content u-add-scrollbar u-hide-scrollbar\" [@contentExpandAnimation]=\"{\r\n        value: !(dialogIsOpen$ | async) ? 'closed' : 'expanded',\r\n        params: { bottomPixels: calculateBottomPixels() }\r\n      }\">\r\n        <div class=\"mdc-layout-grid\">\r\n          <div class=\"mdc-layout-grid__inner\">\r\n            <mat-card class=\"mdc-layout-grid__cell--span-12 u-border-radius shadow-bottom-z-1\">\r\n              <ng-container #fieldComponent></ng-container>\r\n            </mat-card>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n<div class=\"c-ew__preview-holder\" *ngIf=\"{\r\n  label: label$ | async,\r\n  required: required$ | async,\r\n  invalid: invalid$ | async,\r\n  touched: control.touched,\r\n  selectedEntities: (selectedEntities$ | async)?.slice(0, 9) || [],\r\n  entitiesNumber: (selectedEntities$ | async)?.length || 0,\r\n  showValidation: showValidation$ | async\r\n} as data\">\r\n  <mat-label class=\"c-ew__preview-label\" [ngClass]=\"{\r\n    'mat-caption' : data.entitiesNumber,\r\n    'mat-empty' : !data.entitiesNumber,\r\n    'mat-error' : data.invalid && data.touched && !config.field.disabled,\r\n    'color__primary' : !(data.invalid && data.touched) && !config.field.disabled,\r\n    'color__label-disabled' : config.field.disabled\r\n  }\">\r\n    {{ data.label }} {{ data.required ? '*': '' }}\r\n  </mat-label>\r\n  <div matRipple [matRippleAnimation]=\"{ enterDuration: 360 }\" class=\"c-ew__preview mat-ripple\" (click)=\"expandDialog()\"\r\n    [ngClass]=\"{\r\n      'c-ew__preview--invalid' : data.invalid && data.touched,\r\n      'c-ew__preview--disabled': config.field.disabled\r\n    }\">\r\n    <div [ngClass]=\"data.entitiesNumber ? 'c-ew__preview-container' : 'c-ew__preview-container--empty'\">\r\n      <div fxLayout=\"row\" fxLayoutAlign=\"start center\">\r\n        <mat-list *ngIf=\"data.entitiesNumber\" fxLayout=\"row\">\r\n          <mat-list-item role=\"listitem\" *ngFor=\"let item of data.selectedEntities; trackBy: trackByFn\">\r\n            <span mat-line>{{ item.label }}</span>\r\n          </mat-list-item>\r\n        </mat-list>\r\n        <span *ngIf=\"data.entitiesNumber > 5\" class=\"more-entities mat-body-1\">\r\n          {{ data.entitiesNumber }}\r\n        </span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <app-field-helper-text [config]=\"config\" [group]=\"group\"></app-field-helper-text>\r\n</div>\r\n","import { Component, OnInit, ViewContainerRef, ViewChild, AfterViewInit, ChangeDetectionStrategy, OnDestroy } from '@angular/core';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { Observable, combineLatest } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\n\r\nimport { FieldWrapper } from '../../../eav-dynamic-form/model/field-wrapper';\r\nimport { ContentExpandAnimation } from '../../../shared/animations/content-expand-animation';\r\nimport { EditRoutingService } from '../../../shared/services/edit-routing.service';\r\nimport { BaseComponent } from '../../input-types/base/base.component';\r\nimport { EavService } from '../../../shared/services/eav.service';\r\nimport { ValidationMessagesService } from '../../validators/validation-messages-service';\r\nimport { SelectedEntity } from '../../input-types/entity/entity-default/entity-default.models';\r\nimport { calculateSelectedEntities } from '../../input-types/entity/entity-default/entity-default.helpers';\r\n\r\n@Component({\r\n  selector: 'app-entity-expandable-wrapper',\r\n  templateUrl: './entity-expandable-wrapper.component.html',\r\n  styleUrls: ['./entity-expandable-wrapper.component.scss'],\r\n  animations: [ContentExpandAnimation],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\n// tslint:disable-next-line:max-line-length\r\nexport class EntityExpandableWrapperComponent extends BaseComponent<string | string[]> implements FieldWrapper, OnInit, AfterViewInit, OnDestroy {\r\n  @ViewChild('fieldComponent', { static: true, read: ViewContainerRef }) fieldComponent: ViewContainerRef;\r\n\r\n  dialogIsOpen$: Observable<boolean>;\r\n  selectedEntities$: Observable<SelectedEntity[]>;\r\n  private separator: string;\r\n\r\n  constructor(\r\n    eavService: EavService,\r\n    validationMessagesService: ValidationMessagesService,\r\n    private translate: TranslateService,\r\n    private editRoutingService: EditRoutingService,\r\n  ) {\r\n    super(eavService, validationMessagesService);\r\n  }\r\n\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n    this.separator = this.config.field.settings$.value.Separator;\r\n    this.dialogIsOpen$ = this.editRoutingService.isExpanded(this.config.field.index, this.config.entity.entityGuid);\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    this.selectedEntities$ = combineLatest([this.value$, this.config.entityCache$]).pipe(map(combined => {\r\n      const fieldValue = combined[0];\r\n      const availableEntities = combined[1];\r\n\r\n      const selected = calculateSelectedEntities(fieldValue, this.separator, availableEntities, this.translate);\r\n      return selected;\r\n    }));\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  calculateBottomPixels() {\r\n    return window.innerWidth > 600 ? '100px' : '50px';\r\n  }\r\n\r\n  trackByFn(index: number, item: SelectedEntity) {\r\n    return item.value;\r\n  }\r\n\r\n  expandDialog() {\r\n    if (this.config.field.disabled) { return; }\r\n    this.editRoutingService.expand(true, this.config.field.index, this.config.entity.entityGuid);\r\n  }\r\n\r\n  closeDialog() {\r\n    this.editRoutingService.expand(false, this.config.field.index, this.config.entity.entityGuid);\r\n  }\r\n}\r\n","import { Observable } from 'rxjs';\r\n\r\nimport { Connector, ConnectorData, FieldConfig, ExperimentalProps } from '../../../../../../../edit-types';\r\nimport { ConnectorDialog } from '../../../../../../../edit-types/src/ConnectorDialog';\r\nimport { UrlHelper } from '../../../../../../shared/helpers/url-helper';\r\nimport { EavConfig } from '../../../../../../shared/models/eav-configuration';\r\nimport { loadScripts } from '../../../../../../../ng-dialogs/src/app/shared/helpers/load-scripts.helper';\r\ndeclare const sxcVersion: string;\r\n\r\nexport class ConnectorInstance<T> implements Connector<T> {\r\n  field$: Observable<FieldConfig>;\r\n  data: ConnectorData<T>;\r\n  dialog: ConnectorDialog<T>;\r\n  loadScript: (...args: any[]) => void;\r\n\r\n  constructor(\r\n    _connectorHost: ConnectorHost<T>,\r\n    value$: Observable<T>,\r\n    public field: FieldConfig,\r\n    public _experimental: ExperimentalProps,\r\n    eavConfig: EavConfig,\r\n  ) {\r\n    this.data = new ConnectorDataInstance<T>(_connectorHost, value$);\r\n    this.dialog = new ConnectorDialogInstance<T>(_connectorHost);\r\n\r\n    this.loadScript = (\r\n      testOrScripts: string | (() => any) | { test: string | (() => any); src: string }[],\r\n      srcOrCallback: string | (() => any),\r\n      callback?: () => any\r\n    ) => {\r\n      // one script (3 parameters: global or test, script url and a callback)\r\n      if (\r\n        (typeof testOrScripts === 'string' || typeof testOrScripts === 'function')\r\n        && typeof srcOrCallback === 'string'\r\n        && typeof callback === 'function'\r\n      ) {\r\n        srcOrCallback = this.resolveTokens(srcOrCallback, eavConfig);\r\n        loadScripts([{ test: testOrScripts, src: srcOrCallback }], callback);\r\n        return;\r\n      }\r\n      // multiple scripts (2 parameters: scripts array and a callback)\r\n      if (Array.isArray(testOrScripts) && typeof srcOrCallback === 'function') {\r\n        for (const script of testOrScripts) {\r\n          script.src = this.resolveTokens(script.src, eavConfig);\r\n        }\r\n        loadScripts(testOrScripts, srcOrCallback);\r\n        return;\r\n      }\r\n      throw new Error('Unrecognized parameters. Please double check your input');\r\n    };\r\n  }\r\n\r\n  resolveTokens(src: string, eavConfig: EavConfig) {\r\n    src = src.replace(/\\[System:Path\\]/i, UrlHelper.getUrlPrefix('system', eavConfig))\r\n      .replace(/\\[Zone:Path\\]/i, UrlHelper.getUrlPrefix('zone', eavConfig))\r\n      .replace(/\\[App:Path\\]/i, UrlHelper.getUrlPrefix('app', eavConfig));\r\n    if (!src.includes('?')) {\r\n      src = `${src}?sxcver=${sxcVersion}`;\r\n    }\r\n    return src;\r\n  }\r\n}\r\n\r\nexport class ConnectorDataInstance<T> implements ConnectorData<T> {\r\n  value$: Observable<T>;\r\n  forceConnectorSave$: Observable<null>;\r\n  value: T;\r\n  clientValueChangeListeners: ((newValue: T) => void)[] = [];\r\n\r\n  constructor(\r\n    private _connectorHost: ConnectorHost<T>,\r\n    value$: Observable<T>\r\n  ) {\r\n    this.value$ = value$;\r\n    this.forceConnectorSave$ = _connectorHost.forceConnectorSave$;\r\n    // Host will complete this observable. Therefore unsubscribe is not required\r\n    this.value$.subscribe(newValue => {\r\n      this.value = newValue;\r\n      this.clientValueChangeListeners.forEach(clientListener => clientListener(newValue));\r\n    });\r\n  }\r\n\r\n  update(newValue: T) {\r\n    this._connectorHost.update(newValue);\r\n  }\r\n\r\n  onValueChange(callback: (newValue: T) => void) {\r\n    this.clientValueChangeListeners.push(callback);\r\n  }\r\n}\r\n\r\nexport class ConnectorDialogInstance<T> implements ConnectorDialog<T> {\r\n  open: (componentTag?: string) => void;\r\n  close: () => void;\r\n\r\n  constructor(_connectorHost: ConnectorHost<T>) {\r\n    this.open = (componentTag?) => _connectorHost.expand(true, componentTag);\r\n    this.close = () => _connectorHost.expand(false);\r\n  }\r\n}\r\n\r\n/** Props and methods available to the connector to communicate with the host */\r\nexport interface ConnectorHost<T> {\r\n  forceConnectorSave$: Observable<null>;\r\n  update: (value: T) => void;\r\n  expand: (expand: boolean, componentTag?: string) => void;\r\n}\r\n","import { NgZone, ElementRef } from '@angular/core';\r\nimport { FormGroup, AbstractControl } from '@angular/forms';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { BehaviorSubject, Subscription } from 'rxjs';\r\nimport { take, filter, map, distinctUntilChanged, startWith } from 'rxjs/operators';\r\n\r\nimport { FieldConfigSet } from '../../../../../eav-dynamic-form/model/field-config';\r\nimport { DnnBridgeService } from '../../../../../shared/services/dnn-bridge.service';\r\nimport { EavService } from '../../../../../shared/services/eav.service';\r\nimport { EavConfig } from '../../../../../shared/models/eav-configuration';\r\nimport { ConnectorInstance, ConnectorHost } from './models/connector-instance.model';\r\nimport { InputFieldHelper } from '../../../../../shared/helpers/input-field-helper';\r\nimport { ContentTypeService } from '../../../../../shared/store/ngrx-data/content-type.service';\r\nimport { FeatureService } from '../../../../../shared/store/ngrx-data/feature.service';\r\nimport { InputTypeService } from '../../../../../shared/store/ngrx-data/input-type.service';\r\nimport { EditRoutingService } from '../../../../../shared/services/edit-routing.service';\r\nimport { ExperimentalProps, InputTypeName, EavCustomInputField } from '../../../../../../edit-types';\r\n\r\nexport class ConnectorHelper {\r\n  private eavConfig: EavConfig;\r\n  private control: AbstractControl;\r\n  private customEl: EavCustomInputField<any>;\r\n  private value$ = new BehaviorSubject<any>(null);\r\n  private subscription = new Subscription();\r\n\r\n  constructor(\r\n    private config: FieldConfigSet,\r\n    private group: FormGroup,\r\n    private customElContainerRef: ElementRef,\r\n    private customElName: string,\r\n    private eavService: EavService,\r\n    private translateService: TranslateService,\r\n    private contentTypeService: ContentTypeService,\r\n    private inputTypeService: InputTypeService,\r\n    private featureService: FeatureService,\r\n    private editRoutingService: EditRoutingService,\r\n    private dnnBridgeService: DnnBridgeService,\r\n    private dialog: MatDialog,\r\n    private zone: NgZone,\r\n  ) {\r\n    this.eavConfig = eavService.getEavConfig();\r\n    this.control = this.group.controls[this.config.field.name];\r\n\r\n    this.subscription.add(this.eavService.formValueChange$.pipe(\r\n      filter(formSet => (formSet.formId === this.config.form.formId) && (formSet.entityGuid === this.config.entity.entityGuid)),\r\n      map(formSet => this.control.value),\r\n      startWith(this.control.value),\r\n      distinctUntilChanged(),\r\n    ).subscribe(newValue => {\r\n      this.value$.next(newValue);\r\n    }));\r\n\r\n    this.customEl = document.createElement(this.customElName) as any;\r\n    this.customEl.connector = this.buildConnector();\r\n    this.customElContainerRef.nativeElement.appendChild(this.customEl);\r\n  }\r\n\r\n  private buildConnector() {\r\n    const connectorHost = this.calculateRegularProps();\r\n    const experimental = this.calculateExperimentalProps();\r\n    const connector = new ConnectorInstance<any>(\r\n      connectorHost,\r\n      this.value$.asObservable(),\r\n      this.config.field,\r\n      experimental,\r\n      this.eavConfig,\r\n    );\r\n    return connector;\r\n  }\r\n\r\n  private calculateRegularProps() {\r\n    const connectorHost: ConnectorHost<any> = {\r\n      forceConnectorSave$: this.eavService.forceConnectorSave$,\r\n      update: (value) => {\r\n        this.zone.run(() => { this.updateControl(this.control, value); });\r\n      },\r\n      expand: (expand, componentTag) => {\r\n        this.zone.run(() => {\r\n          this.editRoutingService.expand(expand, this.config.field.index, this.config.entity.entityGuid, componentTag);\r\n        });\r\n      },\r\n    };\r\n    return connectorHost;\r\n  }\r\n\r\n  private calculateExperimentalProps() {\r\n    let allInputTypeNames: InputTypeName[];\r\n    this.contentTypeService.getContentTypeById(this.config.entity.contentTypeId).pipe(take(1)).subscribe(data => {\r\n      allInputTypeNames = InputFieldHelper.calculateInputTypes(data.contentType.attributes, this.inputTypeService);\r\n    });\r\n\r\n    const experimentalProps: ExperimentalProps = {\r\n      entityGuid: this.config.entity.entityGuid,\r\n      allInputTypeNames,\r\n      formGroup: this.group,\r\n      translateService: this.translateService,\r\n      isExpanded$: this.editRoutingService.isExpanded(this.config.field.index, this.config.entity.entityGuid),\r\n      dropzone: this.config.dropzone,\r\n      adam: this.config.adam,\r\n      updateField: (name, value) => {\r\n        this.zone.run(() => { this.updateControl(this.group.controls[name], value); });\r\n      },\r\n      isFeatureEnabled: (guid) => this.featureService.isFeatureEnabled(guid),\r\n      setFocused: (focused) => {\r\n        this.zone.run(() => { this.config.field.focused$.next(focused); });\r\n      },\r\n      openDnnDialog: (oldValue, params, callback) => {\r\n        this.zone.run(() => { this.openDnnDialog(oldValue, params, callback); });\r\n      },\r\n      getUrlOfIdDnnDialog: (value, callback) => {\r\n        this.zone.run(() => { this.getUrlOfIdDnnDialog(value, callback); });\r\n      },\r\n    };\r\n\r\n    return experimentalProps;\r\n  }\r\n\r\n  private openDnnDialog(oldValue: any, params: any, callback: any) {\r\n    this.dnnBridgeService.open(oldValue, params, callback, this.dialog);\r\n  }\r\n\r\n  private getUrlOfIdDnnDialog(value: string, urlCallback: (value: string) => any) {\r\n    if (!value) { return; }\r\n\r\n    // handle short-ID links like file:17\r\n    const contentType = this.config.entity.header.ContentTypeName;\r\n    const entityGuid = this.config.entity.header.Guid;\r\n    const field = this.config.field.name;\r\n    const urlFromId$ = this.dnnBridgeService.getUrlOfId(value, contentType, entityGuid, field);\r\n\r\n    if (!urlFromId$) {\r\n      urlCallback(value);\r\n      return;\r\n    }\r\n\r\n    urlFromId$.subscribe(data => {\r\n      if (!data) { return; }\r\n      urlCallback(data);\r\n    });\r\n  }\r\n\r\n  private updateControl(control: AbstractControl, value: any) {\r\n    if (control == null || control.disabled) { return; }\r\n\r\n    if (control.value !== value) { control.patchValue(value); }\r\n    if (!control.dirty) { control.markAsDirty(); }\r\n    if (!control.touched) { control.markAsTouched(); }\r\n  }\r\n\r\n  public destroy() {\r\n    this.subscription.unsubscribe();\r\n    this.value$.complete();\r\n    this.customEl?.parentNode.removeChild(this.customEl);\r\n    this.customEl = null;\r\n  }\r\n}\r\n","import { NgZone } from '@angular/core';\r\nimport { ElementEventListener } from '../../../shared/element-event-listener.model';\r\ndeclare const draggingClass: string;\r\ndeclare const windowBodyTimeouts: number[];\r\n\r\nexport class DropzoneDraggingHelper {\r\n  private eventListeners: ElementEventListener[] = [];\r\n\r\n  constructor(private zone: NgZone) { }\r\n\r\n  /** Starts listening for dragover and drop events on a given element */\r\n  attach(htmlEl: HTMLElement) {\r\n    this.zone.runOutsideAngular(() => {\r\n      htmlEl.addEventListener('dragover', dragoverListener, { passive: true });\r\n      htmlEl.addEventListener('drop', dropListener, { passive: true });\r\n\r\n      this.eventListeners.push(\r\n        { element: htmlEl, type: 'dragover', listener: dragoverListener },\r\n        { element: htmlEl, type: 'drop', listener: dropListener },\r\n      );\r\n\r\n      function dragoverListener() {\r\n        clearTimeouts(windowBodyTimeouts); // clear timeouts from global array of timeouts which clear draggingClass from body\r\n        document.body.classList.add(draggingClass);\r\n      }\r\n      function dropListener() {\r\n        document.body.classList.remove(draggingClass);\r\n      }\r\n      function clearTimeouts(timeoutsArray: number[]) {\r\n        for (const timeout of timeoutsArray) {\r\n          clearTimeout(timeout);\r\n        }\r\n        timeoutsArray.splice(0, timeoutsArray.length);\r\n      }\r\n    });\r\n  }\r\n\r\n  /** Removes event listeners from registered elements */\r\n  detach() {\r\n    this.zone.runOutsideAngular(() => {\r\n      this.eventListeners.forEach(eventListener => {\r\n        const element = eventListener.element;\r\n        const type = eventListener.type;\r\n        const listener = eventListener.listener;\r\n        element.removeEventListener(type, listener);\r\n      });\r\n    });\r\n  }\r\n}\r\n","<div [ngClass]=\"(open$ | async) ? 'c-ew__container' : 'u-display-none'\">\r\n  <div #backdrop class=\"c-ew__backdrop\" (click)=\"closeDialog()\"></div>\r\n  <div #dialog fxLayout=\"column\" class=\"c-ew__dialog mat-elevation-z24 u-border-radius\">\r\n    <div [ngClass]=\"{ 'c-ew__dialog-header mat-elevation-z2': (open$ | async) }\">\r\n      <mat-card class=\"mat-elevation-z0\" fxLayout=\"row\">\r\n        <button mat-icon-button class=\"back-arrow\" fxLayoutAlign=\"center center\"\r\n          [matTooltip]=\"'Form.Buttons.Return.Tip' | translate\" (click)=\"closeDialog()\">\r\n          <mat-icon>arrow_back</mat-icon>\r\n        </button>\r\n        <span fxLayoutAlign=\"center center\" class=\"title mat-display-1\">{{ label$ | async }}</span>\r\n      </mat-card>\r\n    </div>\r\n    <div>\r\n      <div [@itemShrinkAnimation]=\"!(open$ | async) ? 'open' : 'closed'\">\r\n      </div>\r\n      <div class=\"c-ew__dialog-content u-border-radius-bottom u-add-scrollbar u-hide-scrollbar\"\r\n        [@contentExpandAnimation]=\"{\r\n          value: !(open$ | async) ? 'closed' : 'expanded',\r\n          params: { bottomPixels: calculateBottomPixels() }\r\n        }\">\r\n        <ng-container #fieldComponent></ng-container>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n<div class=\"c-ew__preview-holder\" *ngIf=\"{\r\n  value: value$ | async,\r\n  label: label$ | async,\r\n  required: required$ | async,\r\n  invalid: invalid$ | async,\r\n  touched: control.touched,\r\n  dirty: control.dirty,\r\n  focused: config.field.focused$ | async,\r\n  disabled: disabled$ | async,\r\n  showValidation: showValidation$ | async\r\n} as data\">\r\n  <mat-label class=\"c-ew__preview-label\" [ngClass]=\"{\r\n    'mat-caption' : data.value,\r\n    'mat-empty' : !data.value,\r\n    'mat-error' : data.invalid && data.touched && !data.disabled,\r\n    'color__primary' : !(data.invalid && data.touched) && !data.disabled,\r\n    'color__label-disabled' : data.disabled,\r\n    'c-ew__preview-label--focused': data.focused\r\n  }\">\r\n    {{ data.label }}\r\n    {{ data.required ? '*': '' }}\r\n  </mat-label>\r\n  <div class=\"c-ew__preview\" [ngClass]=\"{\r\n    'c-ew__preview--invalid' : data.invalid && (data.touched || data.dirty),\r\n    'c-ew__preview--disabled': data.disabled,\r\n    'c-ew__preview--focused': data.focused\r\n  }\">\r\n    <div class=\"c-ew__preview-container\">\r\n      <div #previewContainer class=\"c-ew__preview-content u-hide-scrollbar\" [ngClass]=\"{\r\n        'c-ew__preview-content--disabled': data.disabled\r\n      }\"></div>\r\n    </div>\r\n  </div>\r\n  <app-field-helper-text [config]=\"config\" [group]=\"group\"></app-field-helper-text>\r\n</div>\r\n","import { Component, OnInit, ViewContainerRef, ViewChild, ElementRef, OnDestroy, NgZone, AfterViewInit, ChangeDetectionStrategy } from '@angular/core';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { Observable } from 'rxjs';\r\n\r\nimport { FieldWrapper } from '../../../eav-dynamic-form/model/field-wrapper';\r\nimport { ContentExpandAnimation } from '../../../shared/animations/content-expand-animation';\r\nimport { ConnectorHelper } from '../../input-types/custom/external-web-component/connector/connector.helper';\r\nimport { EavService } from '../../../shared/services/eav.service';\r\nimport { DnnBridgeService } from '../../../shared/services/dnn-bridge.service';\r\nimport { ContentTypeService } from '../../../shared/store/ngrx-data/content-type.service';\r\nimport { FeatureService } from '../../../shared/store/ngrx-data/feature.service';\r\nimport { InputTypeService } from '../../../shared/store/ngrx-data/input-type.service';\r\nimport { DropzoneDraggingHelper } from '../../../shared/services/dropzone-dragging.helper';\r\nimport { EditRoutingService } from '../../../shared/services/edit-routing.service';\r\nimport { BaseComponent } from '../../input-types/base/base.component';\r\nimport { ValidationMessagesService } from '../../validators/validation-messages-service';\r\nimport { angularConsoleLog } from '../../../../ng-dialogs/src/app/shared/helpers/angular-console-log.helper';\r\n\r\n@Component({\r\n  selector: 'app-expandable-wrapper',\r\n  templateUrl: './expandable-wrapper.component.html',\r\n  styleUrls: ['./expandable-wrapper.component.scss'],\r\n  animations: [ContentExpandAnimation],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class ExpandableWrapperComponent extends BaseComponent<string> implements FieldWrapper, OnInit, AfterViewInit, OnDestroy {\r\n  @ViewChild('fieldComponent', { static: true, read: ViewContainerRef }) fieldComponent: ViewContainerRef;\r\n  @ViewChild('previewContainer') previewContainerRef: ElementRef;\r\n  @ViewChild('backdrop') backdropRef: ElementRef;\r\n  @ViewChild('dialog') dialogRef: ElementRef;\r\n\r\n  open$: Observable<boolean>;\r\n\r\n  private connectorCreator: ConnectorHelper;\r\n  private dropzoneDraggingHelper: DropzoneDraggingHelper;\r\n\r\n  constructor(\r\n    eavService: EavService,\r\n    validationMessagesService: ValidationMessagesService,\r\n    private translateService: TranslateService,\r\n    private contentTypeService: ContentTypeService,\r\n    private inputTypeService: InputTypeService,\r\n    private featureService: FeatureService,\r\n    private editRoutingService: EditRoutingService,\r\n    private dnnBridgeService: DnnBridgeService,\r\n    private dialog: MatDialog,\r\n    private zone: NgZone,\r\n  ) {\r\n    super(eavService, validationMessagesService);\r\n  }\r\n\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n    this.open$ = this.editRoutingService.isExpanded(this.config.field.index, this.config.entity.entityGuid);\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    const componentTag = `field-${this.config.field.inputType}`;\r\n    angularConsoleLog('ExpandableWrapper created for:', componentTag);\r\n    this.connectorCreator = new ConnectorHelper(\r\n      this.config,\r\n      this.group,\r\n      this.previewContainerRef,\r\n      componentTag,\r\n      this.eavService,\r\n      this.translateService,\r\n      this.contentTypeService,\r\n      this.inputTypeService,\r\n      this.featureService,\r\n      this.editRoutingService,\r\n      this.dnnBridgeService,\r\n      this.dialog,\r\n      this.zone,\r\n    );\r\n\r\n    this.dropzoneDraggingHelper = new DropzoneDraggingHelper(this.zone);\r\n    this.dropzoneDraggingHelper.attach(this.backdropRef.nativeElement);\r\n    this.dropzoneDraggingHelper.attach(this.dialogRef.nativeElement);\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    angularConsoleLog('ExpandableWrapper destroyed');\r\n    this.connectorCreator.destroy();\r\n    this.dropzoneDraggingHelper.detach();\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  expandDialog() {\r\n    this.editRoutingService.expand(true, this.config.field.index, this.config.entity.entityGuid);\r\n  }\r\n\r\n  closeDialog() {\r\n    this.editRoutingService.expand(false, this.config.field.index, this.config.entity.entityGuid);\r\n  }\r\n\r\n  calculateBottomPixels() {\r\n    return window.innerWidth > 600 ? '100px' : '50px';\r\n  }\r\n}\r\n","import { Component, OnInit, ViewChild, ViewContainerRef, OnDestroy, ChangeDetectionStrategy } from '@angular/core';\r\nimport { Observable } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\n\r\nimport { FieldWrapper } from '../../../eav-dynamic-form/model/field-wrapper';\r\nimport { BaseComponent } from '../../input-types/base/base.component';\r\nimport { EavService } from '../../../shared/services/eav.service';\r\nimport { ValidationMessagesService } from '../../validators/validation-messages-service';\r\n\r\n@Component({\r\n  selector: 'app-hidden-wrapper',\r\n  templateUrl: './hidden-wrapper.component.html',\r\n  styleUrls: ['./hidden-wrapper.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class HiddenWrapperComponent extends BaseComponent<any> implements FieldWrapper, OnInit, OnDestroy {\r\n  @ViewChild('fieldComponent', { static: true, read: ViewContainerRef }) fieldComponent: ViewContainerRef;\r\n\r\n  visibleInEditUI$: Observable<boolean>;\r\n\r\n  constructor(eavService: EavService, validationMessagesService: ValidationMessagesService) {\r\n    super(eavService, validationMessagesService);\r\n  }\r\n\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n    this.visibleInEditUI$ = this.settings$.pipe(map(settings => (settings.VisibleInEditUI === false) ? false : true));\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    super.ngOnDestroy();\r\n  }\r\n}\r\n","<div [hidden]=\"!(visibleInEditUI$ | async)\">\r\n  <ng-container #fieldComponent></ng-container>\r\n</div>\r\n","<!-- header -->\r\n<div [ngClass]=\"(open$ | async) ? 'c-ew__container' : 'u-display-none'\">\r\n  <div #backdrop class=\"c-ew__backdrop\" (click)=\"closeDialog()\"></div>\r\n  <div #dialog fxLayout=\"column\" class=\"c-ew__dialog mat-elevation-z24 u-border-radius\">\r\n    <div [ngClass]=\"{ 'c-ew__dialog-header mat-elevation-z2': (open$ | async) }\">\r\n      <mat-card class=\"mat-elevation-z0\" fxLayout=\"row\">\r\n        <button mat-icon-button class=\"back-arrow\" fxLayoutAlign=\"center center\"\r\n          [matTooltip]=\"'Form.Buttons.Return.Tip' | translate\" (click)=\"closeDialog()\">\r\n          <mat-icon>arrow_back</mat-icon>\r\n        </button>\r\n        <span fxLayoutAlign=\"center center\" class=\"title mat-display-1\">{{ label$ | async }}</span>\r\n      </mat-card>\r\n    </div>\r\n    <div>\r\n      <div [@itemShrinkAnimation]=\"!(open$ | async) ? 'open' : 'closed'\">\r\n      </div>\r\n      <div class=\"c-ew__dialog-content u-border-radius-bottom u-add-scrollbar u-hide-scrollbar\"\r\n        [@contentExpandAnimation]=\"{\r\n          value: !(open$ | async) ? 'closed' : 'expanded',\r\n          params: { bottomPixels: calculateBottomPixels() }\r\n        }\">\r\n        <ng-container #fieldComponent></ng-container>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<!-- preview -->\r\n<div class=\"c-hyperlink-default-field-preview\" *ngIf=\"{\r\n  value: value$ | async,\r\n  preview: preview$ | async,\r\n  label: label$ | async,\r\n  placeholder: placeholder$ | async,\r\n  invalid: invalid$ | async,\r\n  touched: control.touched,\r\n  required: required$ | async,\r\n  disabled: disabled$ | async,\r\n  adamButton: adamButton$ | async,\r\n  pageButton: pageButton$ | async,\r\n  showValidation: showValidation$ | async\r\n} as data\">\r\n  <div class=\"c-ew__preview\" fxLayout=\"row\" fxLayoutAlign=\"start start\" [ngClass]=\"{\r\n    'c-ew__preview--disabled': data.disabled,\r\n    'c-ew__preview--last-in-group': config.field.isLastInGroup\r\n  }\">\r\n    <!-- image / icon -->\r\n    <div class=\"thumbnail-before-input\" [matTooltip]=\"'Fields.Hyperlink.Default.Fullscreen' | translate\"\r\n      [matTooltipDisabled]=\"data.disabled\" [ngClass]=\"{\r\n      'icon-before-input': data.value && !data.preview.isImage,\r\n      'thumbnail-before-input--disabled': data.disabled\r\n    }\" [ngStyle]=\"{ 'background-image': data.value && data.preview.isImage ? data.preview.thumbnailUrl : '' }\"\r\n      (click)=\"expandDialog()\">\r\n      <mat-icon *ngIf=\"data.value && !data.preview.isImage && data.preview.isKnownType\" [matTooltip]=\"data.preview.url\"\r\n        matTooltipPosition=\"right\">\r\n        {{ data.preview.icon }}\r\n      </mat-icon>\r\n      <mat-icon *ngIf=\"data.value && !data.preview.isImage && !data.preview.isKnownType\" [matTooltip]=\"data.preview.url\"\r\n        matTooltipPosition=\"right\" [svgIcon]=\"data.preview.icon\">\r\n      </mat-icon>\r\n    </div>\r\n    <!-- field -->\r\n    <div class=\"c-ew__preview-field--short\" fxFlex=\"auto\">\r\n      <!-- input -->\r\n      <div class=\"hyperlink-input-link-wrapper\">\r\n        <mat-form-field appearance=\"standard\" color=\"accent\" [ngClass]=\"{\r\n          'mat-form-field-invalid': data.invalid && data.touched\r\n        }\">\r\n          <input matInput [matTooltip]=\"'Fields.Hyperlink.Default.Tooltip' | translate\" matTooltipPosition=\"above\"\r\n            [placeholder]=\"data.placeholder\" (change)=\"setValue($event)\" [disabled]=\"data.disabled\"\r\n            (blur)=\"control.markAsTouched()\" [value]=\"data.value\" (keyup)=\"setValue($event)\" appPasteClipboardImage\r\n            [config]=\"config\" [elementType]=\"'input'\">\r\n          <div matSuffix fxLayoutAlign=\"center center\" *ngIf=\"data.adamButton || data.pageButton\">\r\n            <div class=\"c-ew__preview-suffix-text\" fxHide fxShow.gt-xs [ngClass]=\"{\r\n              'c-ew__preview-suffix-text--disabled': data.disabled\r\n            }\">\r\n              {{ data.adamButton ? ('Fields.Hyperlink.AdamFileManager.Hint' | translate) : '' }}\r\n            </div>\r\n            <button mat-icon-button class=\"c-ew__preview-suffix-icon\"\r\n              [matTooltip]=\"'Fields.Hyperlink.Default.Fullscreen' | translate\" appClickStopPropagation\r\n              *ngIf=\"data.adamButton\" [disabled]=\"data.disabled\" (click)=\"expandDialog()\">\r\n              <mat-icon svgIcon=\"apple\"></mat-icon>\r\n            </button>\r\n            <button mat-icon-button class=\"c-ew__preview-suffix-icon\"\r\n              [matTooltip]=\"'Fields.Hyperlink.Default.PageTip' | translate\" appClickStopPropagation\r\n              *ngIf=\"data.pageButton\" [disabled]=\"data.disabled\" (click)=\"openPageDialog()\">\r\n              <mat-icon svgIcon=\"sitemap\"></mat-icon>\r\n            </button>\r\n          </div>\r\n          <mat-label [ngClass]=\"{ 'mat-error' : data.invalid && data.touched }\">\r\n            {{ data.label }}\r\n            {{ data.required ? '*': '' }}\r\n          </mat-label>\r\n        </mat-form-field>\r\n        <!-- link absolutely positioned above input -->\r\n        <div *ngIf=\"data.preview.floatingText\" class=\"hyperlink-floating\" fxHide fxShow.gt-xs>\r\n          <div class=\"hyperlink-floating__value\">{{ data.value }}</div>\r\n          <div class=\"hyperlink-floating__url-box\">\r\n            <a [href]=\"data.preview.url\" target=\"_blank\" tabindex=\"-1\" class=\"hyperlink-floating__url\"\r\n              [matTooltip]=\"data.preview.url\">\r\n              <span>{{ data.preview.floatingText }}</span>\r\n            </a>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <!-- helper text and adam text -->\r\n      <div class=\"c__helper-wrapper\">\r\n        <app-field-helper-text class=\"c__helper-wrapper--left\" [config]=\"config\" [group]=\"group\">\r\n        </app-field-helper-text>\r\n        <div *ngIf=\"data.adamButton\" align=\"end\" class=\"c-ew__preview-field-hint c__helper-wrapper--right\" fxHide\r\n          fxShow.gt-xs>\r\n          <span>{{ 'Fields.Hyperlink.Default.Sponsor' | translate }}</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n","import { Component, OnInit, ViewContainerRef, ViewChild, OnDestroy, AfterViewInit, ElementRef, NgZone, ChangeDetectionStrategy } from '@angular/core';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { Observable, BehaviorSubject } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\n\r\nimport { FieldWrapper } from '../../../eav-dynamic-form/model/field-wrapper';\r\nimport { ContentExpandAnimation } from '../../../shared/animations/content-expand-animation';\r\nimport { FileTypeService } from '../../../shared/services/file-type.service';\r\nimport { DnnBridgeService } from '../../../shared/services/dnn-bridge.service';\r\nimport { EavService } from '../../../shared/services/eav.service';\r\nimport { DropzoneDraggingHelper } from '../../../shared/services/dropzone-dragging.helper';\r\nimport { PagePickerResult } from '../../input-types/dnn-bridge/web-form-bridge/web-form-bridge.models';\r\nimport { EditRoutingService } from '../../../shared/services/edit-routing.service';\r\nimport { BaseComponent } from '../../input-types/base/base.component';\r\nimport { ValidationMessagesService } from '../../validators/validation-messages-service';\r\nimport { Preview } from '../../input-types/hyperlink/hyperlink-default/hyperlink-default.models';\r\n\r\n@Component({\r\n  selector: 'app-hyperlink-default-expandable-wrapper',\r\n  templateUrl: './hyperlink-default-expandable-wrapper.component.html',\r\n  styleUrls: ['./hyperlink-default-expandable-wrapper.component.scss'],\r\n  animations: [ContentExpandAnimation],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\n// tslint:disable-next-line:max-line-length\r\nexport class HyperlinkDefaultExpandableWrapperComponent extends BaseComponent<string> implements FieldWrapper, OnInit, AfterViewInit, OnDestroy {\r\n  @ViewChild('fieldComponent', { static: true, read: ViewContainerRef }) fieldComponent: ViewContainerRef;\r\n  @ViewChild('backdrop') backdropRef: ElementRef;\r\n  @ViewChild('dialog') dialogRef: ElementRef;\r\n\r\n  open$: Observable<boolean>;\r\n  adamButton$: Observable<boolean>;\r\n  pageButton$: Observable<boolean>;\r\n  preview$ = new BehaviorSubject<Preview>({\r\n    url: '',\r\n    thumbnailUrl: '',\r\n    thumbnailPreviewUrl: '',\r\n    floatingText: '',\r\n    isImage: false,\r\n    isKnownType: false,\r\n    icon: '',\r\n  });\r\n  private dropzoneDraggingHelper: DropzoneDraggingHelper;\r\n\r\n  constructor(\r\n    eavService: EavService,\r\n    validationMessagesService: ValidationMessagesService,\r\n    private fileTypeService: FileTypeService,\r\n    private dnnBridgeService: DnnBridgeService,\r\n    private zone: NgZone,\r\n    private dialog: MatDialog,\r\n    private editRoutingService: EditRoutingService,\r\n  ) {\r\n    super(eavService, validationMessagesService);\r\n  }\r\n\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n    this.subscription.add(this.value$.subscribe(value => {\r\n      this.setLink(value);\r\n    }));\r\n    this.open$ = this.editRoutingService.isExpanded(this.config.field.index, this.config.entity.entityGuid);\r\n    this.adamButton$ = this.settings$.pipe(map(settings => settings.Buttons?.includes('adam')));\r\n    this.pageButton$ = this.settings$.pipe(map(settings => settings.Buttons?.includes('page')));\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    this.dropzoneDraggingHelper = new DropzoneDraggingHelper(this.zone);\r\n    this.dropzoneDraggingHelper.attach(this.backdropRef.nativeElement);\r\n    this.dropzoneDraggingHelper.attach(this.dialogRef.nativeElement);\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.dropzoneDraggingHelper.detach();\r\n    this.preview$.complete();\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  calculateBottomPixels() {\r\n    return window.innerWidth > 600 ? '100px' : '50px';\r\n  }\r\n\r\n  setValue(event: Event) {\r\n    const newValue = (event.target as HTMLInputElement).value;\r\n    if (this.control.value === newValue) { return; }\r\n    this.control.patchValue(newValue);\r\n    this.control.markAsDirty();\r\n  }\r\n\r\n  expandDialog() {\r\n    if (this.control.disabled) { return; }\r\n    this.editRoutingService.expand(true, this.config.field.index, this.config.entity.entityGuid);\r\n  }\r\n\r\n  closeDialog() {\r\n    this.editRoutingService.expand(false, this.config.field.index, this.config.entity.entityGuid);\r\n  }\r\n\r\n  openPageDialog() {\r\n    this.dnnBridgeService.open(\r\n      this.control.value,\r\n      {\r\n        Paths: this.config.field.settings.Paths ? this.config.field.settings.Paths : '',\r\n        FileFilter: this.config.field.settings.FileFilter ? this.config.field.settings.FileFilter : ''\r\n      },\r\n      this.processResultOfPagePicker.bind(this),\r\n      this.dialog\r\n    );\r\n  }\r\n\r\n  private processResultOfPagePicker(value: PagePickerResult) {\r\n    // Convert to page:xyz format (if it wasn't cancelled)\r\n    if (!value) { return; }\r\n    this.control.patchValue(`page:${value.id}`);\r\n  }\r\n\r\n  private setLink(value: string) {\r\n    if (!value) { return; }\r\n\r\n    // handle short-ID links like file:17\r\n    const contentType = this.config.entity.header.ContentTypeName;\r\n    const entityGuid = this.config.entity.header.Guid;\r\n    const field = this.config.field.name;\r\n    const urlFromId$ = this.dnnBridgeService.getUrlOfId(value, contentType, entityGuid, field);\r\n\r\n    if (!urlFromId$) {\r\n      const preview: Preview = {\r\n        url: value,\r\n        floatingText: '',\r\n        thumbnailUrl: this.thumbnailUrl(value, 1, true),\r\n        thumbnailPreviewUrl: this.thumbnailUrl(value, 2, false),\r\n        isImage: false,\r\n        isKnownType: false,\r\n        icon: this.fileTypeService.getIconClass(value),\r\n      };\r\n      this.preview$.next(preview);\r\n      return;\r\n    }\r\n\r\n    urlFromId$.subscribe(path => {\r\n      if (!path) { return; }\r\n      const preview: Preview = {\r\n        url: path,\r\n        floatingText: `.../${path.substring(path.lastIndexOf('/') + 1, path.length)}`,\r\n        thumbnailUrl: this.thumbnailUrl(path, 1, true),\r\n        thumbnailPreviewUrl: this.thumbnailUrl(path, 2, false),\r\n        isImage: this.fileTypeService.isImage(path),\r\n        isKnownType: this.fileTypeService.isKnownType(path),\r\n        icon: this.fileTypeService.getIconClass(path),\r\n      };\r\n      this.preview$.next(preview);\r\n    });\r\n  }\r\n\r\n  private thumbnailUrl(url: string, size: number, quote: boolean): string {\r\n    if (size === 1) {\r\n      url = url + '?w=80&h=80&mode=crop';\r\n    }\r\n    if (size === 2) {\r\n      url = url + '?w=500&h=400&mode=max';\r\n    }\r\n    const qt = quote ? '\"' : '';\r\n    return 'url(' + qt + url + qt + ')';\r\n  }\r\n}\r\n","<!-- dialog -->\r\n<div [ngClass]=\"(open$ | async) ? 'c-ew__container' : 'u-display-none'\">\r\n  <div #backdrop class=\"c-ew__backdrop\" (click)=\"closeDialog()\"></div>\r\n  <div #dialog fxLayout=\"column\" class=\"c-ew__dialog mat-elevation-z24 u-border-radius\">\r\n    <div [ngClass]=\"{ 'c-ew__dialog-header mat-elevation-z2': (open$ | async) }\">\r\n      <mat-card class=\"mat-elevation-z0\" fxLayout=\"row\">\r\n        <button mat-icon-button class=\"back-arrow\" fxLayoutAlign=\"center center\"\r\n          [matTooltip]=\"'Form.Buttons.Return.Tip' | translate\" (click)=\"closeDialog()\">\r\n          <mat-icon>arrow_back</mat-icon>\r\n        </button>\r\n        <span fxLayoutAlign=\"center center\" class=\"title mat-display-1\">{{ label$ | async }}</span>\r\n      </mat-card>\r\n    </div>\r\n    <div>\r\n      <div [@itemShrinkAnimation]=\"!(open$ | async) ? 'open' : 'closed'\">\r\n      </div>\r\n      <div\r\n        class=\"c-ew__dialog-content c-ew__dialog-content--empty u-border-radius-bottom u-add-scrollbar u-hide-scrollbar\"\r\n        [@contentExpandAnimation]=\"{\r\n          value: !(open$ | async) ? 'closed' : 'expanded',\r\n          params: { bottomPixels: calculateBottomPixels() }\r\n        }\">\r\n        <ng-container #fieldComponent></ng-container>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<!-- preview -->\r\n<div class=\"c-ew__preview-holder\" *ngIf=\"{\r\n  value: value$ | async,\r\n  label: label$ | async,\r\n  required: required$ | async,\r\n  invalid: invalid$ | async,\r\n  items: (adamItems$ | async).slice(0, 9),\r\n  itemsNumber: (adamItems$ | async).length,\r\n  showValidation: showValidation$ | async\r\n} as data\">\r\n  <mat-label class=\"c-ew__preview-label c-ew__color--primary\" [ngClass]=\"{\r\n    'mat-caption' : data.itemsNumber > 0,\r\n    'mat-empty' : data.itemsNumber === 0,\r\n    'mat-error' : data.invalid && !config.field.disabled,\r\n    'color__primary' : !data.invalid && !config.field.disabled,\r\n    'color__label-disabled' : config.field.disabled\r\n  }\">\r\n    {{ data.label }} {{ data.required ? '*': '' }}\r\n  </mat-label>\r\n  <div matRipple class=\"c-ew__preview mat-ripple\" [matRippleAnimation]=\"{ enterDuration: 360 }\" (click)=\"expandDialog()\"\r\n    [ngClass]=\"{\r\n      'c-ew__preview--invalid': data.invalid,\r\n      'c-ew__preview--disabled': config.field.disabled\r\n    }\">\r\n    <div [ngClass]=\"data.value ? 'c-ew__preview-container' : 'c-ew__preview-container--empty'\">\r\n      <div fxLayout=\"row\" fxLayoutAlign=\"start start\" fxLayoutGap=\"2px\" class=\"c-ew__preview-content\">\r\n        <ng-container *ngFor=\"let item of data.items; trackBy: trackByFn\">\r\n          <!-- folders -->\r\n          <div fxLayout=\"row\" fxLayoutAlign=\"start start\" *ngIf=\"item.IsFolder\">\r\n            <div class=\"adam-browse-background-icon\">\r\n              <mat-icon svgIcon=\"folder\"></mat-icon>\r\n              <div class=\"adam-short-label mat-caption\">{{ item.Name }}</div>\r\n            </div>\r\n          </div>\r\n          <!-- files -->\r\n          <div *ngIf=\"!item.IsFolder\">\r\n            <div *ngIf=\"item.Type !== 'image'\" class=\"adam-browse-background-icon\">\r\n              <mat-icon *ngIf=\"item._isMaterialIcon\">{{ item._icon }}</mat-icon>\r\n              <mat-icon *ngIf=\"!item._isMaterialIcon\" [svgIcon]=\"item._icon\"></mat-icon>\r\n              <div class=\"adam-short-label mat-caption\">{{ item.Name }}</div>\r\n            </div>\r\n            <div *ngIf=\"item.Type === 'image'\" class=\"adam-browse-background-image\">\r\n              <img data-dz-thumbnail=\"\" alt=\"{{ item.Id }}:{{ item.Name }}\"\r\n                src=\"{{ item.FullPath }}?w=78&h=78&mode=crop\">\r\n            </div>\r\n          </div>\r\n        </ng-container>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <!-- hints -->\r\n  <div class=\"mat-caption c-ew__preview-hint\" fxLayout=\"row\" fxLayoutAlign=\"start start\">\r\n    <div class=\"c__helper-wrapper--left\">\r\n      <app-field-helper-text [config]=\"config\" [group]=\"group\"></app-field-helper-text>\r\n    </div>\r\n    <div class=\"c__helper-wrapper--right c-ew__preview-hint-text\" fxHide fxShow.gt-xs>\r\n      <span>{{ 'Fields.Hyperlink.Default.Sponsor' | translate }}</span>\r\n    </div>\r\n  </div>\r\n</div>\r\n","import { Component, OnInit, ViewContainerRef, ViewChild, AfterViewInit, ElementRef, OnDestroy, NgZone, ChangeDetectionStrategy } from '@angular/core';\r\nimport { Observable, BehaviorSubject } from 'rxjs';\r\n\r\nimport { FieldWrapper } from '../../../eav-dynamic-form/model/field-wrapper';\r\nimport { ContentExpandAnimation } from '../../../shared/animations/content-expand-animation';\r\nimport { AdamItem } from '../../../../edit-types';\r\nimport { DropzoneDraggingHelper } from '../../../shared/services/dropzone-dragging.helper';\r\nimport { EditRoutingService } from '../../../shared/services/edit-routing.service';\r\nimport { BaseComponent } from '../../input-types/base/base.component';\r\nimport { EavService } from '../../../shared/services/eav.service';\r\nimport { ValidationMessagesService } from '../../validators/validation-messages-service';\r\n\r\n@Component({\r\n  selector: 'app-hyperlink-library-expandable-wrapper',\r\n  templateUrl: './hyperlink-library-expandable-wrapper.component.html',\r\n  styleUrls: ['./hyperlink-library-expandable-wrapper.component.scss'],\r\n  animations: [ContentExpandAnimation],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\n// tslint:disable-next-line:max-line-length\r\nexport class HyperlinkLibraryExpandableWrapperComponent extends BaseComponent<null> implements FieldWrapper, OnInit, AfterViewInit, OnDestroy {\r\n  @ViewChild('fieldComponent', { static: true, read: ViewContainerRef }) fieldComponent: ViewContainerRef;\r\n  @ViewChild('backdrop') backdropRef: ElementRef;\r\n  @ViewChild('dialog') dialogRef: ElementRef;\r\n\r\n  open$: Observable<boolean>;\r\n  adamItems$ = new BehaviorSubject<AdamItem[]>([]);\r\n  private dropzoneDraggingHelper: DropzoneDraggingHelper;\r\n\r\n  constructor(\r\n    eavService: EavService,\r\n    validationMessagesService: ValidationMessagesService,\r\n    private zone: NgZone,\r\n    private editRoutingService: EditRoutingService,\r\n  ) {\r\n    super(eavService, validationMessagesService);\r\n  }\r\n\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n    this.open$ = this.editRoutingService.isExpanded(this.config.field.index, this.config.entity.entityGuid);\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    this.dropzoneDraggingHelper = new DropzoneDraggingHelper(this.zone);\r\n    this.dropzoneDraggingHelper.attach(this.backdropRef.nativeElement);\r\n    this.dropzoneDraggingHelper.attach(this.dialogRef.nativeElement);\r\n    this.subscription.add(this.config.adam.items$.subscribe(items => {\r\n      this.adamItems$.next(items);\r\n    }));\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.dropzoneDraggingHelper.detach();\r\n    this.adamItems$.complete();\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  calculateBottomPixels() {\r\n    return window.innerWidth > 600 ? '100px' : '50px';\r\n  }\r\n\r\n  trackByFn(index: number, item: AdamItem) {\r\n    return item.Id;\r\n  }\r\n\r\n  expandDialog() {\r\n    if (this.config.field.disabled) { return; }\r\n    this.editRoutingService.expand(true, this.config.field.index, this.config.entity.entityGuid);\r\n  }\r\n\r\n  closeDialog() {\r\n    this.editRoutingService.expand(false, this.config.field.index, this.config.entity.entityGuid);\r\n  }\r\n}\r\n","import 'reflect-metadata';\r\n\r\nexport function InputType(annotation: any) {\r\n  return (target: any) => {\r\n    // Object.defineProperty(target.prototype, 'wrapper', { value: () => annotation.wrapper });\r\n    // const metadata = new Component(annotation);\r\n    Reflect.defineMetadata('inputTypeAnnotations', annotation, target);\r\n  };\r\n}\r\n","<ng-container *ngIf=\"{\r\n  rowCount: rowCount$ | async,\r\n  label: label$ | async,\r\n  placeholder: placeholder$ | async,\r\n  required: required$ | async,\r\n  disabled: disabled$ | async,\r\n  showValidation: showValidation$ | async\r\n} as data\">\r\n\r\n  <mat-form-field [formGroup]=\"group\" appearance=\"standard\" color=\"accent\" [ngClass]=\"{\r\n    'textarea-field': data.rowCount > 1\r\n  }\">\r\n    <input matInput *ngIf=\"data.rowCount <= 1\" [formControlName]=\"config.field.name\" [placeholder]=\"data.placeholder\"\r\n      [required]=\"data.required\">\r\n\r\n    <textarea matInput *ngIf=\"data.rowCount > 1\" [formControlName]=\"config.field.name\" [rows]=\"data.rowCount\"\r\n      [placeholder]=\"data.placeholder\" [required]=\"data.required\">\r\n    </textarea>\r\n\r\n    <mat-label>{{ data.label }}</mat-label>\r\n  </mat-form-field>\r\n\r\n  <app-field-helper-text [config]=\"config\" [group]=\"group\"></app-field-helper-text>\r\n\r\n</ng-container>\r\n","import { Component, OnInit, ChangeDetectionStrategy, OnDestroy } from '@angular/core';\r\nimport { Observable } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\n\r\nimport { InputType } from '../../../../eav-dynamic-form/decorators/input-type.decorator';\r\nimport { WrappersConstants } from '../../../../shared/constants/wrappers.constants';\r\nimport { BaseComponent } from '../../base/base.component';\r\nimport { EavService } from '../../../../shared/services/eav.service';\r\nimport { ValidationMessagesService } from '../../../validators/validation-messages-service';\r\n\r\n@Component({\r\n  // tslint:disable-next-line:component-selector\r\n  selector: 'string-default',\r\n  templateUrl: './string-default.component.html',\r\n  styleUrls: ['./string-default.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\n@InputType({\r\n  wrapper: [WrappersConstants.EavLocalizationWrapper],\r\n})\r\nexport class StringDefaultComponent extends BaseComponent<string> implements OnInit, OnDestroy {\r\n  rowCount$: Observable<number>;\r\n\r\n  constructor(eavService: EavService, validationMessagesService: ValidationMessagesService) {\r\n    super(eavService, validationMessagesService);\r\n  }\r\n\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n    this.rowCount$ = this.settings$.pipe(map(settings => settings.RowCount || 1));\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    super.ngOnDestroy();\r\n  }\r\n}\r\n","import { AbstractControl } from '@angular/forms';\r\nimport { Subscription } from 'rxjs';\r\n\r\nimport { EavConfig } from '../edit/shared/models/eav-configuration';\r\n\r\n/**\r\n * Create a new FieldMaskService instance and access result with resolve\r\n * @example\r\n * const mask = new FieldMaskService(\"[FirstName]\", formGroup.controls);\r\n * const maskValue = mask.resolve();\r\n *\r\n * @param mask a string like \"[FirstName] [LastName]\"\r\n * @param model usually FormGroup controls, passed into here\r\n * @param overloadPreCleanValues a function which will \"scrub\" the found field-values\r\n */\r\nexport class FieldMaskService {\r\n  private mask: string;\r\n  private model: { [key: string]: AbstractControl; };\r\n  private fields: string[] = [];\r\n  private value: string;\r\n  private findFields = /\\[.*?\\]/ig;\r\n  private unwrapField = /[\\[\\]]/ig;\r\n  private subscriptions: Subscription[] = [];\r\n\r\n  constructor(\r\n    mask: string,\r\n    model: { [key: string]: AbstractControl; },\r\n    private changeEvent: (newValue: string) => any,\r\n    overloadPreCleanValues: (key: string, value: string) => string,\r\n    private eavConfig?: EavConfig,\r\n  ) {\r\n    this.mask = mask;\r\n    this.model = model;\r\n    this.fields = this.fieldList();\r\n\r\n    if (overloadPreCleanValues) {\r\n      this.preClean = overloadPreCleanValues;\r\n    }\r\n\r\n    // bind auto-watch only if needed...\r\n    if (model && changeEvent) {\r\n      this.watchAllFields();\r\n    }\r\n  }\r\n\r\n  /** Resolves a mask to the final value */\r\n  resolve(): string {\r\n    let value = this.mask;\r\n    if (this.eavConfig != null && value != null) {\r\n      value = value.replace('[App:AppId]', this.eavConfig.appId);\r\n      value = value.replace('[App:ZoneId]', this.eavConfig.zoneId);\r\n    }\r\n    this.fields.forEach((e, i) => {\r\n      const replaceValue = this.model.hasOwnProperty(e) && this.model[e] && this.model[e].value ? this.model[e].value : '';\r\n      const cleaned = this.preClean(e, replaceValue);\r\n      value = value.replace('[' + e + ']', cleaned);\r\n    });\r\n\r\n    return value;\r\n  }\r\n\r\n  /** Retrieves a list of all fields used in the mask */\r\n  fieldList(): string[] {\r\n    const result: string[] = [];\r\n    if (!this.mask) { return result; }\r\n    const matches = this.mask.match(this.findFields);\r\n    if (matches) {\r\n      matches.forEach((e, i) => {\r\n        const staticName = e.replace(this.unwrapField, '');\r\n        result.push(staticName);\r\n      });\r\n    } else { // TODO: ask is this good\r\n      result.push(this.mask);\r\n    }\r\n    return result;\r\n  }\r\n\r\n  /** Default preClean function */\r\n  private preClean(key: string, value: string): string {\r\n    return value;\r\n  }\r\n\r\n  /** Change-event - will only fire if it really changes */\r\n  private onChange() {\r\n    const maybeNew = this.resolve();\r\n    if (this.value !== maybeNew) {\r\n      this.changeEvent(maybeNew);\r\n    }\r\n    this.value = maybeNew;\r\n  }\r\n\r\n  /** Add watcher and execute onChange */\r\n  private watchAllFields() {\r\n    // add a watch for each field in the field-mask\r\n    this.fields.forEach(field => {\r\n      if (!this.model[field]) { return; }\r\n      const valueSub = this.model[field].valueChanges.subscribe(value => this.onChange());\r\n      this.subscriptions.push(valueSub);\r\n    });\r\n  }\r\n\r\n  destroy() {\r\n    this.subscriptions.forEach(subscription => { subscription.unsubscribe(); });\r\n  }\r\n}\r\n","<ng-container *ngIf=\"{\r\n  disabled: disabled$ | async,\r\n  showValidation: showValidation$ | async\r\n} as data\">\r\n\r\n  <mat-form-field [formGroup]=\"group\" appearance=\"standard\" color=\"accent\">\r\n    <input matInput [formControlName]=\"config.field.name\" (blur)=\"clean(true)\" [placeholder]=\"placeholder$ | async\"\r\n      [required]=\"required$ | async\">\r\n    <mat-label>{{ label$ | async }}</mat-label>\r\n  </mat-form-field>\r\n\r\n  <app-field-helper-text [config]=\"config\" [group]=\"group\"></app-field-helper-text>\r\n\r\n</ng-container>\r\n","import { Component, OnInit, OnDestroy, ChangeDetectionStrategy } from '@angular/core';\r\n\r\nimport { Helper } from '../../../../shared/helpers/helper';\r\nimport { InputType } from '../../../../eav-dynamic-form/decorators/input-type.decorator';\r\nimport { FieldMaskService } from '../../../../../shared/field-mask.service';\r\nimport { WrappersConstants } from '../../../../shared/constants/wrappers.constants';\r\nimport { BaseComponent } from '../../base/base.component';\r\nimport { EavService } from '../../../../shared/services/eav.service';\r\nimport { ValidationMessagesService } from '../../../validators/validation-messages-service';\r\n\r\n@Component({\r\n  // tslint:disable-next-line:component-selector\r\n  selector: 'string-url-path',\r\n  templateUrl: './string-url-path.component.html',\r\n  styleUrls: ['./string-url-path.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\n@InputType({\r\n  wrapper: [WrappersConstants.EavLocalizationWrapper],\r\n})\r\nexport class StringUrlPathComponent extends BaseComponent<string> implements OnInit, OnDestroy {\r\n  private autoGenerateMask: string;\r\n  private allowSlashes: boolean;\r\n  private fieldMaskService: FieldMaskService;\r\n  /** Blocks external update if field was changed manually and doesn't match external updates. WARNING: Doesn't work on language change */\r\n  private lastAutoCopy = '';\r\n\r\n  constructor(eavService: EavService, validationMessagesService: ValidationMessagesService) {\r\n    super(eavService, validationMessagesService);\r\n  }\r\n\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n    this.subscription.add(this.settings$.subscribe(settings => {\r\n      this.autoGenerateMask = settings.AutoGenerateMask || null;\r\n      this.allowSlashes = settings.AllowSlashes || false;\r\n      if (this.fieldMaskService != null) {\r\n        this.fieldMaskService.destroy();\r\n        this.fieldMaskService = null;\r\n      }\r\n      this.fieldMaskService = new FieldMaskService(this.autoGenerateMask, this.group.controls,\r\n        this.onSourcesChanged.bind(this), this.preClean);\r\n    }));\r\n\r\n    // set initial value\r\n    this.onSourcesChanged(this.fieldMaskService.resolve());\r\n\r\n    // clean on value change\r\n    this.subscription.add(this.control.valueChanges.subscribe(value => {\r\n      this.clean(false);\r\n    }));\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  private onSourcesChanged(newValue: string) {\r\n    const value = this.control.value;\r\n    // don't do anything if the current field is not empty and doesn't have the last copy of the stripped value\r\n    if (value && value !== this.lastAutoCopy) { return; }\r\n\r\n    const cleaned = Helper.stripNonUrlCharacters(newValue, this.allowSlashes, true);\r\n    if (!cleaned) { return; }\r\n    this.lastAutoCopy = cleaned;\r\n    if (value === cleaned) { return; }\r\n    this.control.patchValue(cleaned);\r\n  }\r\n\r\n  private preClean(key: string, value: string) {\r\n    return value.replace('/', '-').replace('\\\\', '-'); // remove slashes which could look like path-parts\r\n  }\r\n\r\n  clean(trimEnd: boolean) {\r\n    const value = this.control.value;\r\n    const cleaned = Helper.stripNonUrlCharacters(value, this.allowSlashes, trimEnd);\r\n    if (value === cleaned) { return; }\r\n    this.control.patchValue(cleaned);\r\n  }\r\n}\r\n","<ng-container *ngIf=\"{\r\n  required: required$ | async,\r\n  placeholder: placeholder$ | async,\r\n  label: label$ | async,\r\n  disabled: disabled$ | async,\r\n  enableTextEntry: enableTextEntry$ | async,\r\n  dropdownOptions: dropdownOptions$ | async,\r\n  freeTextMode: freeTextMode$ | async,\r\n  showValidation: showValidation$ | async\r\n} as data\">\r\n\r\n  <mat-form-field [formGroup]=\"group\" appearance=\"standard\" color=\"accent\">\r\n\r\n    <mat-select *ngIf=\"!data.freeTextMode\" [formControlName]=\"config.field.name\" [required]=\"data.required\"\r\n      [placeholder]=\"data.placeholder\">\r\n      <mat-option *ngFor=\"let option of data.dropdownOptions\" [value]=\"option.value\">\r\n        {{ option.label }}\r\n      </mat-option>\r\n    </mat-select>\r\n\r\n    <input matInput *ngIf=\"data.freeTextMode\" [formControlName]=\"config.field.name\" [required]=\"data.required\"\r\n      [placeholder]=\"data.placeholder\">\r\n\r\n    <button matSuffix mat-icon-button *ngIf=\"data.enableTextEntry\" [disabled]=\"data.disabled\" appClickStopPropagation\r\n      (click)=\"toggleFreeTextMode()\">\r\n      <mat-icon [matTooltip]=\"(data.freeTextMode ? 'Fields.String.Dropdown' : 'Fields.String.Freetext') | translate\">\r\n        {{ data.freeTextMode ? 'arrow_drop_down_circle' : 'text_fields' }}\r\n      </mat-icon>\r\n    </button>\r\n\r\n    <mat-label>{{ data.label }}</mat-label>\r\n  </mat-form-field>\r\n\r\n  <app-field-helper-text [config]=\"config\" [group]=\"group\"></app-field-helper-text>\r\n</ng-container>\r\n","import { Component, OnInit, ChangeDetectionStrategy, OnDestroy } from '@angular/core';\r\nimport { Observable, combineLatest, BehaviorSubject } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\n\r\nimport { InputType } from '../../../../eav-dynamic-form/decorators/input-type.decorator';\r\nimport { WrappersConstants } from '../../../../shared/constants/wrappers.constants';\r\nimport { EavService } from '../../../../shared/services/eav.service';\r\nimport { BaseComponent } from '../../base/base.component';\r\nimport { DropdownOption } from './string-dropdown.models';\r\nimport { calculateDropdownOptions } from './string-dropdown.helpers';\r\nimport { ValidationMessagesService } from '../../../validators/validation-messages-service';\r\n\r\n@Component({\r\n  // tslint:disable-next-line:component-selector\r\n  selector: 'string-dropdown',\r\n  templateUrl: './string-dropdown.component.html',\r\n  styleUrls: ['./string-dropdown.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\n@InputType({\r\n  wrapper: [WrappersConstants.EavLocalizationWrapper],\r\n})\r\nexport class StringDropdownComponent extends BaseComponent<string> implements OnInit, OnDestroy {\r\n  enableTextEntry$: Observable<boolean>;\r\n  dropdownOptions$: Observable<DropdownOption[]>;\r\n  freeTextMode$: Observable<boolean>;\r\n  private toggleFreeText$ = new BehaviorSubject(false);\r\n\r\n  constructor(eavService: EavService, validationMessagesService: ValidationMessagesService) {\r\n    super(eavService, validationMessagesService);\r\n  }\r\n\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n    this.enableTextEntry$ = this.settings$.pipe(map(settings => settings.EnableTextEntry || false));\r\n    this.dropdownOptions$ = combineLatest([this.value$, this.settings$]).pipe(map(combined => {\r\n      const value = combined[0];\r\n      const settings = combined[1];\r\n      const dropdownOptions = calculateDropdownOptions(value, settings.DropdownValues);\r\n      return dropdownOptions;\r\n    }));\r\n    this.freeTextMode$ = combineLatest([this.enableTextEntry$, this.toggleFreeText$]).pipe(map(combined => {\r\n      const enableTextEntry = combined[0];\r\n      const freeTextMode = combined[1];\r\n      if (!enableTextEntry) { return false; }\r\n      return freeTextMode;\r\n    }));\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.toggleFreeText$.complete();\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  toggleFreeTextMode() {\r\n    this.toggleFreeText$.next(!this.toggleFreeText$.value);\r\n  }\r\n}\r\n","import { DropdownOption } from './string-dropdown.models';\r\n\r\n/** Takes current value and dropdownValues string from settings and calculates options for dropdown */\r\nexport function calculateDropdownOptions(currentValue: string, dropdownValues: string) {\r\n  let currentValueFound = false;\r\n  let options: DropdownOption[] = [];\r\n  if (dropdownValues) {\r\n    const dropdownValuesArray = dropdownValues.replace(/\\r/g, '').split('\\n');\r\n    options = dropdownValuesArray.map(e => {\r\n      const s = e.split(':');\r\n      const maybeWantedEmptyVal = s[1];\r\n      const key = s.shift();\r\n      const val = s.join(':');\r\n      const option = {\r\n        label: key,\r\n        value: (val || maybeWantedEmptyVal === '') ? val : key\r\n      };\r\n      if (option.value === currentValue) { currentValueFound = true; }\r\n      return option;\r\n    });\r\n  }\r\n  if (!currentValueFound) {\r\n    options.push({\r\n      label: currentValue,\r\n      value: currentValue,\r\n    });\r\n  }\r\n  return options;\r\n}\r\n","<div [hidden]=\"freeTextMode\">\r\n  <div class=\"ed-field\" fxLayout=\"row\" fxLayoutAlign=\"start end\">\r\n    <div\r\n      [ngClass]=\"(settings.EnableCreate && settings.EntityType && !selectedEntities.length && !settings.AllowMultiValue) ? 'ed-field__field-short' : 'ed-field__field'\">\r\n      <div [hidden]=\"!settings.AllowMultiValue && selectedEntities.length\">\r\n        <mat-form-field [formGroup]=\"group\" appearance=\"standard\" color=\"accent\" [ngClass]=\"{\r\n          'mat-form-field-invalid': invalid && touched\r\n        }\">\r\n          <input matInput #autocomplete [placeholder]=\"getPlaceholder()\" [matAutocomplete]=\"auto\"\r\n            [disabled]=\"disabled || !settings.EnableAddExisting\" (blur)=\"control.markAsTouched()\"\r\n            (input)=\"filterSelectionList($event.target.value)\">\r\n          <button mat-icon-button matSuffix [disabled]=\"disabled || !settings.EnableAddExisting\"\r\n            *ngIf=\"!settings.EnableTextEntry\">\r\n            <mat-icon>arrow_drop_down</mat-icon>\r\n          </button>\r\n          <a matSuffix *ngIf=\"settings.EnableTextEntry\" fxLayoutAlign=\"center center\" appClickStopPropagation\r\n            (click)=\"toggleFreeText()\">\r\n            <button mat-icon-button [disabled]=\"disabled\">\r\n              <mat-icon [matTooltip]=\"'Fields.String.Freetext' | translate\">text_fields</mat-icon>\r\n            </button>\r\n            <button mat-icon-button [disabled]=\"disabled\" *ngIf=\"freeTextMode\">\r\n              <mat-icon>arrow_drop_down</mat-icon>\r\n            </button>\r\n          </a>\r\n          <mat-label [ngClass]=\"{ 'mat-error': invalid && touched }\">\r\n            {{ settings.AllowMultiValue ? ('Fields.Entity.Choose' | translate) : label }}\r\n            {{ required ? '*': '' }}\r\n          </mat-label>\r\n        </mat-form-field>\r\n\r\n        <mat-autocomplete #auto=\"matAutocomplete\" (optionSelected)=\"optionSelected($event)\">\r\n          <mat-option *ngFor=\"let item of filteredEntities\" [value]=\"item.Value\"\r\n            [disabled]=\"isOptionDisabled(item.Value)\">\r\n            <span>{{ item.Text ? item.Text : item.Value }}</span>\r\n          </mat-option>\r\n        </mat-autocomplete>\r\n      </div>\r\n    </div>\r\n    <div fxLayoutAlign=\"end center\"\r\n      [ngClass]=\"(settings.EnableCreate && settings.EntityType && !selectedEntities.length && !settings.AllowMultiValue) ? 'ed-field__create-icon' : 'ed-field__create-icon-hide'\">\r\n      <!-- create new entity to add to this list -->\r\n      <button mat-icon-button [matTooltip]=\"'Fields.Entity.New' | translate\" [disabled]=\"disabled || disableAddNew\"\r\n        *ngIf=\"settings.EnableCreate && settings.EntityType && !selectedEntities.length && !settings.AllowMultiValue\"\r\n        (click)=\"openNewEntityDialog()\">\r\n        <mat-icon>add_circle_outline</mat-icon>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<mat-form-field *ngIf=\"freeTextMode\" [formGroup]=\"group\" appearance=\"standard\" color=\"accent\">\r\n  <input matInput [required]=\"required\" [formControlName]=\"config.field.name\" [placeholder]=\"placeholder\">\r\n\r\n  <a matSuffix appClickStopPropagation (click)=\"toggleFreeText()\">\r\n    <button mat-icon-button [disabled]=\"disabled\">\r\n      <mat-icon>arrow_drop_down</mat-icon>\r\n    </button>\r\n  </a>\r\n  <mat-label>{{ label }}</mat-label>\r\n</mat-form-field>\r\n\r\n<div *ngIf=\"debugEnabled$ | async\">debug: <span (click)=\"insertNull()\">add null-item</span></div>\r\n\r\n<app-field-helper-text [config]=\"config\" [group]=\"group\"></app-field-helper-text>\r\n\r\n<!-- add new entity -->\r\n<div *ngIf=\"!freeTextMode && settings.EnableCreate && settings.EntityType && settings.AllowMultiValue\">\r\n  <button mat-mini-fab color=\"accent\" [matTooltip]=\"'Fields.Entity.New' | translate\"\r\n    [disabled]=\"disabled || disableAddNew\" (click)=\"openNewEntityDialog()\">\r\n    <mat-icon>add</mat-icon>\r\n  </button>\r\n</div>\r\n","import { Component, Input, Output, EventEmitter, ViewChild, ElementRef, OnChanges, SimpleChanges, ChangeDetectionStrategy, OnInit } from '@angular/core';\r\nimport { FormGroup, AbstractControl } from '@angular/forms';\r\nimport { MatAutocompleteSelectedEvent } from '@angular/material/autocomplete';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { Observable } from 'rxjs';\r\n\r\nimport { FieldConfigSet } from '../../../../eav-dynamic-form/model/field-config';\r\nimport { FieldSettings } from '../../../../../edit-types';\r\nimport { EntityInfo } from '../../../../shared/models/eav/entity-info';\r\nimport { SelectedEntity } from '../entity-default/entity-default.models';\r\nimport { GlobalConfigurationService } from '../../../../shared/services/global-configuration.service';\r\n\r\n@Component({\r\n  selector: 'app-entity-default-search',\r\n  templateUrl: './entity-default-search.component.html',\r\n  styleUrls: ['./entity-default-search.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class EntityDefaultSearchComponent implements OnInit, OnChanges {\r\n  @ViewChild('autocomplete') autocompleteRef: ElementRef;\r\n\r\n  @Input() config: FieldConfigSet;\r\n  @Input() group: FormGroup;\r\n  @Input() control: AbstractControl;\r\n  @Input() label: string;\r\n  @Input() placeholder: string;\r\n  @Input() required: boolean;\r\n  @Input() invalid: boolean;\r\n  @Input() touched: boolean;\r\n  @Input() disabled: boolean;\r\n  @Input() freeTextMode: boolean;\r\n  @Input() settings: FieldSettings;\r\n  @Input() error: string;\r\n  @Input() disableAddNew: boolean;\r\n  @Input() selectedEntities: SelectedEntity[];\r\n  @Input() availableEntities: EntityInfo[];\r\n\r\n  @Output() toggleFreeTextMode = new EventEmitter<null>();\r\n  @Output() addSelected = new EventEmitter<string>();\r\n  @Output() editEntity = new EventEmitter<string>();\r\n\r\n  filteredEntities: EntityInfo[] = [];\r\n  debugEnabled$: Observable<boolean>;\r\n\r\n  constructor(private translate: TranslateService, private globalConfigurationService: GlobalConfigurationService) { }\r\n\r\n  ngOnInit() {\r\n    this.debugEnabled$ = this.globalConfigurationService.getDebugEnabled();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    const availableEntities: EntityInfo[] = changes.availableEntities?.currentValue;\r\n    if (availableEntities != null) {\r\n      const filter = this.autocompleteRef?.nativeElement.value || '';\r\n      this.filterSelectionList(filter);\r\n    }\r\n  }\r\n\r\n  getPlaceholder() {\r\n    if (this.availableEntities.length) {\r\n      return 'search';\r\n    }\r\n    if (this.error) {\r\n      return this.error;\r\n    }\r\n    return this.translate.instant('Fields.EntityQuery.QueryNoItems');\r\n  }\r\n\r\n  toggleFreeText() {\r\n    if (this.disabled) { return; }\r\n    this.toggleFreeTextMode.emit();\r\n  }\r\n\r\n  filterSelectionList(filter: string) {\r\n    if (filter === '') {\r\n      this.filteredEntities = this.availableEntities;\r\n      return;\r\n    }\r\n    this.filteredEntities = this.availableEntities.filter(option =>\r\n      option.Text\r\n        ? option.Text.toLowerCase().includes(filter.toLowerCase())\r\n        : option.Value.toLowerCase().includes(filter.toLowerCase())\r\n    );\r\n  }\r\n\r\n  optionSelected(event: MatAutocompleteSelectedEvent) {\r\n    const selected: string = event.option.value;\r\n    this.addSelected.emit(selected);\r\n    this.autocompleteRef.nativeElement.value = '';\r\n    this.autocompleteRef.nativeElement.blur();\r\n  }\r\n\r\n  insertNull() {\r\n    this.addSelected.emit(null);\r\n  }\r\n\r\n  isOptionDisabled(value: string) {\r\n    const isSelected = !!this.selectedEntities.find(entity => entity.value === value);\r\n    return isSelected;\r\n  }\r\n\r\n  openNewEntityDialog() {\r\n    this.editEntity.emit(null);\r\n  }\r\n}\r\n","<mat-label class=\"field-label\" *ngIf=\"!settings.AllowMultiValue\" [ngClass]=\"{ 'disabled': disabled }\">\r\n  {{ label }} {{ required ? '*': '' }}\r\n</mat-label>\r\n\r\n<div cdkDropList [cdkDropListDisabled]=\"!settings.AllowMultiValue || disabled\" (cdkDropListDropped)=\"drop($event)\"\r\n  [ngClass]=\"{\r\n    'normal-list': !settings.AllowMultiValue,\r\n    'dnd-list': settings.AllowMultiValue\r\n  }\">\r\n  <!-- Normal list usually shows only one item, but can show \"empty slot\" / \"null-item\" in debug mode -->\r\n  <div *ngFor=\"let item of selectedEntities; trackBy: trackByFn; let index = index\" cdkDrag [ngClass]=\"{\r\n      'normal-item': !settings.AllowMultiValue,\r\n      'dnd-item': settings.AllowMultiValue,\r\n      'disabled': disabled\r\n    }\">\r\n    <div class=\"item-title\" [ngClass]=\"{ 'disabled': disabled }\">\r\n      <mat-icon class=\"item-title__icon\" *ngIf=\"settings.AllowMultiValue\" [matTooltipDisabled]=\"disabled\"\r\n        [matTooltip]=\"'Fields.Entity.DragMove' | translate\">\r\n        drag_handle\r\n      </mat-icon>\r\n      <span class=\"item-title__text\" [matTooltip]=\"item.tooltip\">\r\n        {{ item.label }}\r\n      </span>\r\n    </div>\r\n    <div class=\"item-actions\">\r\n      <!-- Disable edit only if it was disabled in the settings, not if disabled by language change -->\r\n      <button mat-icon-button *ngIf=\"settings.EnableEdit && !item.isFreeTextOrNotFound\"\r\n        [matTooltip]=\"'Fields.Entity.Edit' | translate\" [disabled]=\"config.field.disabled\" appMousedownStopPropagation\r\n        (click)=\"edit(item.value)\">\r\n        <mat-icon>edit</mat-icon>\r\n      </button>\r\n      <button mat-icon-button *ngIf=\"settings.EnableDelete && !item.isFreeTextOrNotFound\"\r\n        [matTooltip]=\"'Fields.Entity.Delete' | translate\" [disabled]=\"disabled\" appMousedownStopPropagation\r\n        (click)=\"deleteItem(item.value)\">\r\n        <mat-icon>delete</mat-icon>\r\n      </button>\r\n      <button mat-icon-button *ngIf=\"settings.EnableRemove\" [matTooltip]=\"'Fields.Entity.Remove' | translate\"\r\n        [disabled]=\"disabled\" appMousedownStopPropagation (click)=\"removeItem(index)\">\r\n        <mat-icon>{{ settings.AllowMultiValue ? 'clear' : 'arrow_drop_down' }}</mat-icon>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</div>\r\n","import { Component, Input, Output, EventEmitter, ChangeDetectionStrategy } from '@angular/core';\r\nimport { CdkDragDrop, moveItemInArray } from '@angular/cdk/drag-drop';\r\n\r\nimport { FieldConfigSet } from '../../../../eav-dynamic-form/model/field-config';\r\nimport { FieldSettings } from '../../../../../edit-types';\r\nimport { SelectedEntity } from '../entity-default/entity-default.models';\r\nimport { ReorderIndexes } from './entity-default-list.models';\r\n\r\n@Component({\r\n  selector: 'app-entity-default-list',\r\n  templateUrl: './entity-default-list.component.html',\r\n  styleUrls: ['./entity-default-list.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class EntityDefaultListComponent {\r\n  @Input() config: FieldConfigSet;\r\n  @Input() label: string;\r\n  @Input() required: boolean;\r\n  @Input() disabled: boolean;\r\n  @Input() freeTextMode: boolean;\r\n  @Input() settings: FieldSettings;\r\n  @Input() selectedEntities: SelectedEntity[];\r\n\r\n  @Output() reorder = new EventEmitter<ReorderIndexes>();\r\n  @Output() removeSelected = new EventEmitter<number>();\r\n  @Output() editEntity = new EventEmitter<string>();\r\n  @Output() deleteEntity = new EventEmitter<string>();\r\n\r\n  constructor() { }\r\n\r\n  trackByFn(index: number, item: SelectedEntity) {\r\n    return item.value;\r\n  }\r\n\r\n  drop(event: CdkDragDrop<any[]>) {\r\n    moveItemInArray(this.selectedEntities, event.previousIndex, event.currentIndex);\r\n    const reorderIndexes: ReorderIndexes = {\r\n      previousIndex: event.previousIndex,\r\n      currentIndex: event.currentIndex,\r\n    };\r\n    this.reorder.emit(reorderIndexes);\r\n  }\r\n\r\n  edit(entityGuid: string) {\r\n    this.editEntity.emit(entityGuid);\r\n  }\r\n\r\n  removeItem(index: number) {\r\n    this.removeSelected.emit(index);\r\n  }\r\n\r\n  deleteItem(entityGuid: string) {\r\n    this.deleteEntity.emit(entityGuid);\r\n  }\r\n}\r\n","<!--\r\n  This template is used for all entity like fields,\r\n  e.g. EntityDefault, EntityContentBlocks, EntityQuery, StringDropdownQuery\r\n-->\r\n<ng-container *ngIf=\"{\r\n  label: label$ | async,\r\n  placeholder: placeholder$ | async,\r\n  required: required$ | async,\r\n  invalid: invalid$ | async,\r\n  touched: control.touched,\r\n  disabled: disabled$ | async,\r\n  freeTextMode: freeTextMode$ | async,\r\n  settings: settings$ | async,\r\n  selectedEntities: selectedEntities$ | async,\r\n  availableEntities: config.entityCache$ | async,\r\n  disableAddNew: disableAddNew$ | async,\r\n  isExpanded: isExpanded$ | async,\r\n  error: error$ | async,\r\n  showValidation: showValidation$ | async\r\n} as data\">\r\n  <app-entity-default-list\r\n    *ngIf=\"!data.freeTextMode && data.selectedEntities.length && (!data.settings.AllowMultiValue || (data.settings.AllowMultiValue && data.isExpanded))\"\r\n    [config]=\"config\" [label]=\"data.label\" [required]=\"data.required\" [disabled]=\"data.disabled\"\r\n    [freeTextMode]=\"data.freeTextMode\" [settings]=\"data.settings\" [selectedEntities]=\"data.selectedEntities\"\r\n    (reorder)=\"reorder($event)\" (removeSelected)=\"removeSelected($event)\" (editEntity)=\"editEntity($event)\"\r\n    (deleteEntity)=\"deleteEntity($event)\">\r\n  </app-entity-default-list>\r\n\r\n  <app-entity-default-search [config]=\"config\" [group]=\"group\" [control]=\"control\" [label]=\"data.label\"\r\n    [placeholder]=\"data.placeholder\" [required]=\"data.required\" [invalid]=\"data.invalid\" [touched]=\"data.touched\"\r\n    [disabled]=\"data.disabled\" [freeTextMode]=\"data.freeTextMode\" [settings]=\"data.settings\"\r\n    [selectedEntities]=\"data.selectedEntities\" [availableEntities]=\"data.availableEntities\"\r\n    [disableAddNew]=\"data.disableAddNew\" [error]=\"data.error\" (toggleFreeTextMode)=\"toggleFreeTextMode()\"\r\n    (addSelected)=\"addSelected($event)\" (editEntity)=\"editEntity($event)\">\r\n  </app-entity-default-search>\r\n</ng-container>\r\n","import { Component, OnInit, OnDestroy, ChangeDetectionStrategy, ViewChild } from '@angular/core';\r\nimport { HttpErrorResponse } from '@angular/common/http';\r\nimport { moveItemInArray } from '@angular/cdk/drag-drop';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { BehaviorSubject, Observable, combineLatest } from 'rxjs';\r\nimport { map, take } from 'rxjs/operators';\r\n\r\nimport { InputType } from '../../../../eav-dynamic-form/decorators/input-type.decorator';\r\nimport { EntityService } from '../../../../shared/services/entity.service';\r\nimport { FieldMaskService } from '../../../../../shared/field-mask.service';\r\nimport { BaseComponent } from '../../base/base.component';\r\nimport { EavService } from '../../../../shared/services/eav.service';\r\nimport { ValidationMessagesService } from '../../../validators/validation-messages-service';\r\nimport { EntityInfo } from '../../../../shared/models/eav/entity-info';\r\nimport { FieldSettings } from '../../../../../edit-types';\r\nimport { EavConfig } from '../../../../shared/models/eav-configuration';\r\nimport { SelectedEntity } from './entity-default.models';\r\nimport { EditForm } from '../../../../../ng-dialogs/src/app/shared/models/edit-form.model';\r\nimport { ReorderIndexes } from '../entity-default-list/entity-default-list.models';\r\nimport { EntityDefaultSearchComponent } from '../entity-default-search/entity-default-search.component';\r\nimport { Helper } from '../../../../shared/helpers/helper';\r\nimport { EditRoutingService } from '../../../../shared/services/edit-routing.service';\r\nimport { calculateSelectedEntities } from './entity-default.helpers';\r\n\r\n@Component({\r\n  // tslint:disable-next-line:component-selector\r\n  selector: 'entity-default',\r\n  templateUrl: './entity-default.component.html',\r\n  styleUrls: ['./entity-default.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\n@InputType({})\r\nexport class EntityDefaultComponent extends BaseComponent<string | string[]> implements OnInit, OnDestroy {\r\n  @ViewChild(EntityDefaultSearchComponent) private entitySearchComponent: EntityDefaultSearchComponent;\r\n\r\n  useQuery = false;\r\n  contentTypeMask: FieldMaskService;\r\n  error$ = new BehaviorSubject('');\r\n  freeTextMode$ = new BehaviorSubject(false);\r\n  disableAddNew$ = new BehaviorSubject(true);\r\n  isExpanded$: Observable<boolean>;\r\n  selectedEntities$: Observable<SelectedEntity[]>;\r\n  eavConfig: EavConfig;\r\n  private separator: string;\r\n\r\n  constructor(\r\n    eavService: EavService,\r\n    validationMessagesService: ValidationMessagesService,\r\n    private entityService: EntityService,\r\n    public translate: TranslateService,\r\n    private editRoutingService: EditRoutingService,\r\n    private snackBar: MatSnackBar,\r\n  ) {\r\n    super(eavService, validationMessagesService);\r\n    this.eavConfig = eavService.getEavConfig();\r\n  }\r\n\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n    this.config.entityCache$ = new BehaviorSubject<EntityInfo[]>([]);\r\n\r\n    this.settings$ = this.settings$.pipe(map(settings => this.calculateSettings(settings)));\r\n    this.separator = this.config.field.settings$.value.Separator;\r\n    this.selectedEntities$ = combineLatest([this.value$, this.config.entityCache$]).pipe(map(combined => {\r\n      const fieldValue = combined[0];\r\n      const availableEntities = combined[1];\r\n\r\n      const selected = calculateSelectedEntities(fieldValue, this.separator, availableEntities, this.translate);\r\n      return selected;\r\n    }));\r\n\r\n    this.isExpanded$ = this.editRoutingService.isExpanded(this.config.field.index, this.config.entity.entityGuid);\r\n\r\n    this.subscription.add(this.settings$.subscribe(settings => {\r\n      this.contentTypeMask?.destroy();\r\n      this.contentTypeMask = new FieldMaskService(\r\n        settings.EntityType,\r\n        this.group.controls,\r\n        !this.useQuery ? this.fetchAvailableEntities.bind(this) : this.updateAddNew.bind(this),\r\n        null,\r\n        this.eavConfig,\r\n      );\r\n    }));\r\n\r\n    if (!this.useQuery) {\r\n      this.fetchAvailableEntities();\r\n    } else {\r\n      this.updateAddNew();\r\n    }\r\n\r\n    this.refreshOnChildClosed();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.error$.complete();\r\n    this.freeTextMode$.complete();\r\n    this.disableAddNew$.complete();\r\n    this.config.entityCache$.complete();\r\n    this.contentTypeMask.destroy();\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  toggleFreeTextMode() {\r\n    this.freeTextMode$.next(!this.freeTextMode$.value);\r\n  }\r\n\r\n  /** Overridden in subclass */\r\n  calculateSettings(settings: FieldSettings) {\r\n    const fixedSettings = { ...settings };\r\n    if (fixedSettings.EntityType == null) { fixedSettings.EntityType = ''; }\r\n    if (fixedSettings.AllowMultiValue == null) { fixedSettings.AllowMultiValue = false; }\r\n    if (fixedSettings.EnableEdit == null) { fixedSettings.EnableEdit = true; }\r\n    if (fixedSettings.EnableCreate == null) { fixedSettings.EnableCreate = true; }\r\n    if (fixedSettings.EnableAddExisting == null) { fixedSettings.EnableAddExisting = true; }\r\n    if (fixedSettings.EnableRemove == null) { fixedSettings.EnableRemove = true; }\r\n    if (fixedSettings.EnableDelete == null) { fixedSettings.EnableDelete = false; }\r\n    return fixedSettings;\r\n  }\r\n\r\n  /** Overridden in subclass */\r\n  fetchAvailableEntities() {\r\n    this.updateAddNew();\r\n    const contentTypeName = this.contentTypeMask.resolve();\r\n    let enableAddExisting: boolean;\r\n    this.settings$.pipe(take(1)).subscribe(settings => {\r\n      enableAddExisting = settings.EnableAddExisting;\r\n    });\r\n    // spm TODO: Should this work like this?\r\n    // check if we should get all or only the selected ones...\r\n    // if we can't add, then we only need one...\r\n    const filterText = enableAddExisting ? null : this.control.value;\r\n    this.entityService.getAvailableEntities(filterText, contentTypeName).subscribe(items => {\r\n      this.config.entityCache$.next(items);\r\n    });\r\n  }\r\n\r\n  updateAddNew() {\r\n    const contentTypeName = this.contentTypeMask.resolve();\r\n    this.disableAddNew$.next(!contentTypeName);\r\n  }\r\n\r\n  reorder(reorderIndexes: ReorderIndexes) {\r\n    this.updateValue('reorder', reorderIndexes);\r\n  }\r\n\r\n  addSelected(guid: string) {\r\n    this.updateValue('add', guid);\r\n  }\r\n\r\n  removeSelected(index: number) {\r\n    this.updateValue('delete', index);\r\n  }\r\n\r\n  editEntity(entityGuid: string) {\r\n    let form: EditForm;\r\n    if (entityGuid == null) {\r\n      const contentTypeName = this.contentTypeMask.resolve();\r\n      form = {\r\n        items: [{ ContentTypeName: contentTypeName }],\r\n      };\r\n    } else {\r\n      let availableEntities: EntityInfo[];\r\n      this.config.entityCache$.pipe(take(1)).subscribe(entities => {\r\n        availableEntities = entities;\r\n      });\r\n      const entity = availableEntities.find(e => e.Value === entityGuid);\r\n      form = {\r\n        items: [{ EntityId: entity.Id }],\r\n      };\r\n    }\r\n    this.editRoutingService.open(this.config.field.index, this.config.entity.entityGuid, form);\r\n  }\r\n\r\n  deleteEntity(entityGuid: string) {\r\n    const entity = this.config.entityCache$.value.find(e => e.Value === entityGuid);\r\n    const id = entity.Id.toString();\r\n    const title = entity.Text;\r\n    const contentType = this.contentTypeMask.resolve();\r\n    let selected: SelectedEntity[];\r\n    this.selectedEntities$.pipe(take(1)).subscribe(entities => {\r\n      selected = entities;\r\n    });\r\n    const index = selected.findIndex(e => e.value === entityGuid);\r\n\r\n    if (!confirm(this.translate.instant('Data.Delete.Question', { title, id }))) { return; }\r\n    this.snackBar.open('Deleting...');\r\n    this.entityService.delete(contentType, id, false).subscribe({\r\n      next: () => {\r\n        this.snackBar.open('Deleted', null, { duration: 2000 });\r\n        this.removeSelected(index);\r\n        this.fetchAvailableEntities();\r\n      },\r\n      error: (err: HttpErrorResponse) => {\r\n        this.snackBar.dismiss();\r\n        if (!confirm(this.translate.instant('Data.Delete.Question', { title, id }))) { return; }\r\n        this.snackBar.open('Deleting...');\r\n        this.entityService.delete(contentType, id, true).subscribe(res2 => {\r\n          this.snackBar.open('Deleted', null, { duration: 2000 });\r\n          this.removeSelected(index);\r\n          this.fetchAvailableEntities();\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  private refreshOnChildClosed() {\r\n    this.subscription.add(this.editRoutingService.childFormClosed().subscribe(() => {\r\n      this.fetchAvailableEntities();\r\n    }));\r\n    this.subscription.add(\r\n      this.editRoutingService.childFormResult(this.config.field.index, this.config.entity.entityGuid).subscribe(result => {\r\n        const newItemGuid = Object.keys(result)[0];\r\n        this.addSelected(newItemGuid);\r\n      })\r\n    );\r\n  }\r\n\r\n  private updateValue(action: 'add' | 'delete' | 'reorder', value: string | number | ReorderIndexes) {\r\n    const valueArray: string[] = (typeof this.control.value === 'string')\r\n      ? Helper.convertValueToArray(this.control.value, this.separator)\r\n      : [...this.control.value];\r\n\r\n    switch (action) {\r\n      case 'add':\r\n        const guid = value as string;\r\n        valueArray.push(guid);\r\n        break;\r\n      case 'delete':\r\n        const index = value as number;\r\n        valueArray.splice(index, 1);\r\n        break;\r\n      case 'reorder':\r\n        const reorderIndexes = value as ReorderIndexes;\r\n        moveItemInArray(valueArray, reorderIndexes.previousIndex, reorderIndexes.currentIndex);\r\n        break;\r\n    }\r\n\r\n    if (typeof this.control.value === 'string') {\r\n      const valueString = Helper.convertArrayToString(valueArray, this.separator);\r\n      this.control.patchValue(valueString);\r\n    } else {\r\n      this.control.patchValue(valueArray);\r\n    }\r\n\r\n    if (!this.control.dirty) {\r\n      this.control.markAsDirty();\r\n    }\r\n\r\n    if (action === 'delete' && !valueArray.length) {\r\n      setTimeout(() => {\r\n        this.entitySearchComponent.autocompleteRef?.nativeElement.focus();\r\n      }, 0);\r\n    }\r\n  }\r\n\r\n}\r\n","import { Component, OnInit, OnDestroy, ChangeDetectionStrategy } from '@angular/core';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { take } from 'rxjs/operators';\r\n\r\nimport { QueryService } from '../../../../shared/services/query.service';\r\nimport { InputType } from '../../../../eav-dynamic-form/decorators/input-type.decorator';\r\nimport { EavService } from '../../../../shared/services/eav.service';\r\nimport { EntityDefaultComponent } from '../entity-default/entity-default.component';\r\nimport { ValidationMessagesService } from '../../../validators/validation-messages-service';\r\nimport { EntityService } from '../../../../shared/services/entity.service';\r\nimport { FieldSettings } from '../../../../../edit-types';\r\nimport { EntityInfo } from '../../../../shared/models/eav/entity-info';\r\nimport { QueryEntity } from './entity-query.models';\r\nimport { EditRoutingService } from '../../../../shared/services/edit-routing.service';\r\nimport { FieldMaskService } from '../../../../../shared/field-mask.service';\r\n\r\n@Component({\r\n  // tslint:disable-next-line:component-selector\r\n  selector: 'entity-query',\r\n  templateUrl: '../entity-default/entity-default.component.html',\r\n  styleUrls: ['../entity-default/entity-default.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\n@InputType({})\r\nexport class EntityQueryComponent extends EntityDefaultComponent implements OnInit, OnDestroy {\r\n  useQuery = true;\r\n  private paramsMask: FieldMaskService;\r\n\r\n  constructor(\r\n    eavService: EavService,\r\n    validationMessagesService: ValidationMessagesService,\r\n    entityService: EntityService,\r\n    translate: TranslateService,\r\n    editRoutingService: EditRoutingService,\r\n    snackBar: MatSnackBar,\r\n    private queryService: QueryService,\r\n  ) {\r\n    super(eavService, validationMessagesService, entityService, translate, editRoutingService, snackBar);\r\n  }\r\n\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n\r\n    this.subscription.add(this.settings$.subscribe(settings => {\r\n      this.paramsMask?.destroy();\r\n      this.paramsMask = new FieldMaskService(\r\n        settings.UrlParameters,\r\n        this.group.controls,\r\n        this.fetchAvailableEntities.bind(this),\r\n        null,\r\n        this.eavConfig,\r\n      );\r\n    }));\r\n\r\n    this.fetchAvailableEntities();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  /** Override function in superclass */\r\n  calculateSettings(settings: FieldSettings) {\r\n    const fixedSettings = super.calculateSettings(settings);\r\n    if (fixedSettings.Query == null) { fixedSettings.Query = ''; }\r\n    if (fixedSettings.StreamName == null || fixedSettings.StreamName === '') { fixedSettings.StreamName = 'Default'; }\r\n    if (fixedSettings.UrlParameters == null) { fixedSettings.UrlParameters = ''; }\r\n    return fixedSettings;\r\n  }\r\n\r\n  /** Override function in superclass */\r\n  fetchAvailableEntities() {\r\n    let settings: FieldSettings;\r\n    this.settings$.pipe(take(1)).subscribe(stngs => {\r\n      settings = stngs;\r\n    });\r\n    if (!settings.Query) {\r\n      alert(`No query defined for ${this.config.field.name} - can't load entities`);\r\n      return;\r\n    }\r\n\r\n    const streamName = settings.StreamName;\r\n    const queryUrl = settings.Query.includes('/') ? settings.Query : `${settings.Query}/${streamName}`;\r\n    const params = this.paramsMask.resolve();\r\n\r\n    this.queryService.getAvailableEntities(queryUrl, true, params).subscribe({\r\n      next: (data) => {\r\n        if (!data) {\r\n          this.error$.next(this.translate.instant('Fields.EntityQuery.QueryError'));\r\n          return;\r\n        }\r\n        if (!data[streamName]) {\r\n          this.error$.next(this.translate.instant('Fields.EntityQuery.QueryStreamNotFound') + streamName);\r\n          return;\r\n        }\r\n        const items: EntityInfo[] = data[streamName].map(this.queryEntityMapping.bind(this));\r\n        this.config.entityCache$.next(items);\r\n      },\r\n      error: (error) => {\r\n        console.error(error);\r\n        console.error(`${this.translate.instant('Fields.EntityQuery.QueryError')} - ${error.data}`);\r\n      }\r\n    });\r\n  }\r\n\r\n  /** Overridden in subclass */\r\n  queryEntityMapping(entity: QueryEntity) {\r\n    const entityInfo: EntityInfo = {\r\n      Id: entity.Id,\r\n      Value: entity.Guid,\r\n      Text: entity.Title,\r\n    };\r\n    return entityInfo;\r\n  }\r\n}\r\n","import { Component, OnInit, OnDestroy, ChangeDetectionStrategy } from '@angular/core';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { take } from 'rxjs/operators';\r\n\r\nimport { InputType } from '../../../../eav-dynamic-form/decorators/input-type.decorator';\r\nimport { EntityQueryComponent } from '../../entity/entity-query/entity-query.component';\r\nimport { EavService } from '../../../../shared/services/eav.service';\r\nimport { ValidationMessagesService } from '../../../validators/validation-messages-service';\r\nimport { EntityService } from '../../../../shared/services/entity.service';\r\nimport { QueryService } from '../../../../shared/services/query.service';\r\nimport { QueryEntity } from '../../entity/entity-query/entity-query.models';\r\nimport { EntityInfo } from '../../../../shared/models/eav/entity-info';\r\nimport { FieldSettings } from '../../../../../edit-types';\r\nimport { EditRoutingService } from '../../../../shared/services/edit-routing.service';\r\n\r\n@Component({\r\n  // tslint:disable-next-line:component-selector\r\n  selector: 'string-dropdown-query',\r\n  templateUrl: '../../entity/entity-default/entity-default.component.html',\r\n  styleUrls: ['../../entity/entity-default/entity-default.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\n@InputType({})\r\nexport class StringDropdownQueryComponent extends EntityQueryComponent implements OnInit, OnDestroy {\r\n\r\n  constructor(\r\n    eavService: EavService,\r\n    validationMessagesService: ValidationMessagesService,\r\n    entityService: EntityService,\r\n    translate: TranslateService,\r\n    editRoutingService: EditRoutingService,\r\n    snackBar: MatSnackBar,\r\n    queryService: QueryService,\r\n  ) {\r\n    super(eavService, validationMessagesService, entityService, translate, editRoutingService, snackBar, queryService);\r\n  }\r\n\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  /** Override function in superclass */\r\n  calculateSettings(settings: FieldSettings) {\r\n    const fixedSettings = super.calculateSettings(settings);\r\n    if (fixedSettings.Value == null) { fixedSettings.Value = ''; }\r\n    if (fixedSettings.Label == null) { fixedSettings.Label = ''; }\r\n    if (fixedSettings.EnableTextEntry == null) { fixedSettings.EnableTextEntry = false; }\r\n    if (fixedSettings.Separator == null || fixedSettings.Separator === '') { fixedSettings.Separator = ','; }\r\n    return fixedSettings;\r\n  }\r\n\r\n  /** Override function in superclass */\r\n  queryEntityMapping(entity: QueryEntity) {\r\n    let settings: FieldSettings;\r\n    this.settings$.pipe(take(1)).subscribe(stngs => {\r\n      settings = stngs;\r\n    });\r\n    const entityInfo: EntityInfo = {\r\n      Id: entity.Id,\r\n      Value: entity[settings.Value],\r\n      Text: entity[settings.Label],\r\n    };\r\n    return entityInfo;\r\n  }\r\n}\r\n","<ng-container *ngIf=\"{\r\n  value: value$ | async,\r\n  disabled: disabled$ | async,\r\n  previewCss: previewCss$ | async,\r\n  showValidation: showValidation$ | async\r\n} as data\">\r\n\r\n  <mat-form-field [formGroup]=\"group\" appearance=\"standard\" color=\"accent\">\r\n    <div class=\"icon-option\">\r\n      <i *ngIf=\"data.value\" class=\"icon-preview {{ data.previewCss }} {{ data.value }}\"></i>\r\n      <input matInput [formControlName]=\"config.field.name\" [placeholder]=\"placeholder$ | async\"\r\n        [required]=\"required$ | async\" [matAutocomplete]=\"auto\">\r\n    </div>\r\n\r\n    <mat-autocomplete #auto=\"matAutocomplete\">\r\n      <cdk-virtual-scroll-viewport itemSize=\"48\" style=\"height: 256px\" minBufferPx=\"500\" maxBufferPx=\"1000\">\r\n        <mat-option *cdkVirtualFor=\"let icon of filteredIcons$ | async\" [value]=\"icon.class\">\r\n          <div class=\"icon-option\">\r\n            <i class=\"icon-preview {{ data.previewCss }} {{ icon.class }}\"></i>\r\n            <span>{{ icon.label }}</span>\r\n          </div>\r\n        </mat-option>\r\n    </cdk-virtual-scroll-viewport>\r\n    </mat-autocomplete>\r\n\r\n    <mat-label>{{ label$ | async }}</mat-label>\r\n  </mat-form-field>\r\n\r\n  <app-field-helper-text [config]=\"config\" [group]=\"group\"></app-field-helper-text>\r\n\r\n</ng-container>\r\n","import { Component, OnInit, ChangeDetectionStrategy, OnDestroy } from '@angular/core';\r\nimport { Observable, BehaviorSubject, combineLatest } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\n\r\nimport { InputType } from '../../../../eav-dynamic-form/decorators/input-type.decorator';\r\nimport { WrappersConstants } from '../../../../shared/constants/wrappers.constants';\r\nimport { ScriptsLoaderService } from '../../../../shared/services/scripts-loader.service';\r\nimport { IconOption } from './string-font-icon-picker.models';\r\nimport { BaseComponent } from '../../base/base.component';\r\nimport { EavService } from '../../../../shared/services/eav.service';\r\nimport { findAllIconsInCss } from './string-font-icon-picker.helpers';\r\nimport { ValidationMessagesService } from '../../../validators/validation-messages-service';\r\n\r\n@Component({\r\n  // tslint:disable-next-line:component-selector\r\n  selector: 'string-font-icon-picker',\r\n  templateUrl: './string-font-icon-picker.component.html',\r\n  styleUrls: ['./string-font-icon-picker.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\n@InputType({\r\n  wrapper: [WrappersConstants.EavLocalizationWrapper],\r\n})\r\nexport class StringFontIconPickerComponent extends BaseComponent<string> implements OnInit, OnDestroy {\r\n  iconOptions$ = new BehaviorSubject<IconOption[]>([]);\r\n  filteredIcons$: Observable<IconOption[]>;\r\n  previewCss$: Observable<string>;\r\n\r\n  constructor(\r\n    eavService: EavService,\r\n    validationMessagesService: ValidationMessagesService,\r\n    private scriptsLoaderService: ScriptsLoaderService,\r\n  ) {\r\n    super(eavService, validationMessagesService);\r\n  }\r\n\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n    this.subscription.add(this.settings$.subscribe(settings => {\r\n      const files = settings.Files || '';\r\n      const cssPrefix = settings.CssPrefix || '';\r\n      const showPrefix = settings.ShowPrefix || false;\r\n      // load each file (usually CSS) in the settings\r\n      this.scriptsLoaderService.load(files.split('\\n'), () => {\r\n        const newIconOptions = findAllIconsInCss(cssPrefix, showPrefix);\r\n        this.iconOptions$.next(newIconOptions);\r\n      });\r\n    }));\r\n    this.previewCss$ = this.settings$.pipe(map(settings => settings.PreviewCss));\r\n    this.filteredIcons$ = combineLatest([this.value$, this.iconOptions$]).pipe(map(combined => {\r\n      const search = combined[0];\r\n      const iconList = combined[1];\r\n      // if we have a filter param, use it, otherwise don't filter\r\n      const filtered = search\r\n        ? iconList.filter(icon => icon.search?.includes(search.toLowerCase()) ?? false)\r\n        : iconList;\r\n      return filtered;\r\n    }));\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.iconOptions$.complete();\r\n    super.ngOnDestroy();\r\n  }\r\n}\r\n","import { IconOption, LoadedIcons } from './string-font-icon-picker.models';\r\n\r\n/** Calculates available css classes with className prefix. WARNING: Expensive operation */\r\nexport function findAllIconsInCss(classPrefix: string, showPrefix: boolean) {\r\n  const foundList: IconOption[] = [];\r\n  const duplicateDetector: LoadedIcons = {};\r\n\r\n  if (!classPrefix) { return foundList; }\r\n\r\n  const truncateLabel = showPrefix ? 0 : classPrefix.length - 1;\r\n\r\n  // tslint:disable-next-line:prefer-for-of\r\n  for (let i = 0; i < document.styleSheets.length; i++) {\r\n    const sheet = document.styleSheets[i] as CSSStyleSheet;\r\n    if (!sheet) { continue; }\r\n\r\n    let rules: CSSRuleList;\r\n    try {\r\n      rules = sheet.rules;\r\n    } catch (error) { /* errors happens if browser denies access to css rules */ }\r\n    if (!rules) {\r\n      try {\r\n        rules = sheet.cssRules;\r\n      } catch (error) { /* errors happens if browser denies access to css rules */ }\r\n    }\r\n    if (!rules) { continue; }\r\n\r\n    // tslint:disable-next-line:prefer-for-of\r\n    for (let j = 0; j < rules.length; j++) {\r\n      const rule = rules[j] as CSSStyleRule;\r\n      if (!(rule.selectorText && rule.selectorText.startsWith(classPrefix))) { continue; }\r\n\r\n      const selector = rule.selectorText;\r\n      const iconClass = selector.substring(0, selector.indexOf(':')).replace('.', '');\r\n      if (duplicateDetector[iconClass]) { continue; }\r\n\r\n      foundList.push({\r\n        rule,\r\n        class: iconClass,\r\n        search: iconClass?.toLowerCase(),\r\n        label: iconClass.substring(truncateLabel),\r\n      });\r\n      duplicateDetector[iconClass] = true;\r\n    }\r\n  }\r\n\r\n  return foundList;\r\n}\r\n","import { TemplateTypes } from './string-template-picker.models';\r\nimport { defaultTokenName, defaultTemplateName } from '../../../../../ng-dialogs/src/app/shared/constants/file-names.constants';\r\n\r\nexport const templateTypes: TemplateTypes = {\r\n  Token: {\r\n    ext: '.html',\r\n    prefix: '',\r\n    suggestion: defaultTokenName,\r\n  },\r\n  'C# Razor': {\r\n    ext: '.cshtml',\r\n    prefix: '_',\r\n    suggestion: defaultTemplateName,\r\n  },\r\n};\r\n","<ng-container *ngIf=\"{\r\n  showValidation: showValidation$ | async\r\n} as data\">\r\n\r\n  <div class=\"picker-wrapper\">\r\n    <mat-form-field [formGroup]=\"group\" appearance=\"standard\" color=\"accent\">\r\n      <mat-select [formControlName]=\"config.field.name\" [required]=\"required$ | async\">\r\n        <mat-option value=\"\">(no file selected)</mat-option>\r\n        <mat-option *ngFor=\"let file of templateOptions$ | async\" [value]=\"file\">\r\n          {{ file }}\r\n        </mat-option>\r\n      </mat-select>\r\n      <mat-label>{{ label$ | async }}</mat-label>\r\n    </mat-form-field>\r\n    <button mat-icon-button matTooltip=\"Create a new file\" [disabled]=\"disabled$ | async\" (click)=\"createTemplate()\">\r\n      <mat-icon>add</mat-icon>\r\n    </button>\r\n  </div>\r\n\r\n  <app-field-helper-text [config]=\"config\" [group]=\"group\"></app-field-helper-text>\r\n\r\n</ng-container>\r\n","import { Component, OnInit, OnDestroy, ChangeDetectionStrategy } from '@angular/core';\r\nimport { BehaviorSubject } from 'rxjs';\r\n\r\nimport { InputType } from '../../../../eav-dynamic-form/decorators/input-type.decorator';\r\nimport { WrappersConstants } from '../../../../shared/constants/wrappers.constants';\r\nimport { FieldMaskService } from '../../../../../shared/field-mask.service';\r\nimport { AssetsService } from '../../../../shared/services/assets.service';\r\nimport { templateTypes } from './string-template-picker.constants';\r\nimport { BaseComponent } from '../../base/base.component';\r\nimport { EavService } from '../../../../shared/services/eav.service';\r\nimport { ValidationMessagesService } from '../../../validators/validation-messages-service';\r\n\r\n@Component({\r\n  // tslint:disable-next-line:component-selector\r\n  selector: 'string-template-picker',\r\n  templateUrl: './string-template-picker.component.html',\r\n  styleUrls: ['./string-template-picker.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\n@InputType({\r\n  wrapper: [WrappersConstants.EavLocalizationWrapper],\r\n})\r\nexport class StringTemplatePickerComponent extends BaseComponent<string> implements OnInit, OnDestroy {\r\n  templateOptions$ = new BehaviorSubject<string[]>([]);\r\n\r\n  private typeWatcher: FieldMaskService;\r\n  private locationWatcher: FieldMaskService;\r\n  private activeSpec = templateTypes.Token;\r\n  private templates: string[] = [];\r\n  private global = false;\r\n  /** Reset only after templates have been fetched once */\r\n  private resetIfNotFound = false;\r\n\r\n  constructor(eavService: EavService, validationMessagesService: ValidationMessagesService, private assetsService: AssetsService) {\r\n    super(eavService, validationMessagesService);\r\n  }\r\n\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n    // set change-watchers to the other values\r\n    this.typeWatcher = new FieldMaskService('[Type]', this.group.controls, this.setFileConfig.bind(this), null);\r\n    this.locationWatcher = new FieldMaskService('[Location]', this.group.controls, this.onLocationChange.bind(this), null);\r\n\r\n    this.setFileConfig(this.typeWatcher.resolve() || 'Token'); // use token setting as default, till the UI tells us otherwise\r\n    this.onLocationChange(this.locationWatcher.resolve() || null); // set initial file list\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.templateOptions$.complete();\r\n    this.typeWatcher.destroy();\r\n    this.locationWatcher.destroy();\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  private setFileConfig(type: string) {\r\n    this.activeSpec = templateTypes[type];\r\n    this.setTemplateOptions();\r\n  }\r\n\r\n  private onLocationChange(location: string) {\r\n    this.global = (location === 'Host File System');\r\n\r\n    this.assetsService.getAll(this.global).subscribe(templates => {\r\n      this.templates = templates;\r\n      this.resetIfNotFound = true;\r\n      this.setTemplateOptions();\r\n    });\r\n  }\r\n\r\n  private setTemplateOptions() {\r\n    let filtered = this.templates;\r\n    const ext = this.activeSpec.ext;\r\n    // new feature in v11 - '.code.xxx' files shouldn't be shown, they are code-behind\r\n    filtered = filtered.filter(template => !template.includes('.code.'));\r\n    filtered = filtered.filter(template => template.slice(template.length - ext.length) === ext);\r\n    this.templateOptions$.next(filtered);\r\n    const resetValue = this.resetIfNotFound && !filtered.find(template => template === this.control.value);\r\n    if (resetValue) { this.control.patchValue(''); }\r\n  }\r\n\r\n  createTemplate() {\r\n    let name = prompt('Enter new file name', this.activeSpec.suggestion); // todo: i18n\r\n    if (!name) { return; }\r\n\r\n    // 1. check for folders\r\n    let path = '';\r\n    name = name.replace('\\\\', '/');\r\n    const foundSlash = name.lastIndexOf('/');\r\n    if (foundSlash > -1) {\r\n      path = name.substring(0, foundSlash + 1); // path with slash\r\n      name = name.substring(foundSlash + 1);\r\n    }\r\n\r\n    // 2. check if extension already provided, otherwise or if not perfect, just attach default\r\n    if (!name.endsWith(this.activeSpec.ext)) {\r\n      name += this.activeSpec.ext;\r\n    }\r\n\r\n    // 3. check if cshtmls have a \"_\" in the file name (not folder, must be the file name part)\r\n    if (this.activeSpec.prefix !== '' && name[0] !== this.activeSpec.prefix) {\r\n      name = this.activeSpec.prefix + name;\r\n    }\r\n\r\n    const fullPath = path + name;\r\n\r\n    // 4. tell service to create it\r\n    this.assetsService.create(fullPath, this.global).subscribe(res => {\r\n      if (res === false) {\r\n        alert('Server reported that create failed - the file probably already exists'); // todo: i18n\r\n      } else {\r\n        this.templates.push(fullPath);\r\n        this.setTemplateOptions();\r\n        this.control.patchValue(fullPath);\r\n      }\r\n    });\r\n  }\r\n\r\n}\r\n","<ng-container *ngIf=\"{\r\n  disabled: disabled$ | async,\r\n  showValidation: showValidation$ | async\r\n} as data\">\r\n\r\n  <div [formGroup]=\"group\">\r\n    <mat-slide-toggle [formControlName]=\"config.field.name\">{{ label$ | async }}</mat-slide-toggle>\r\n    <app-field-helper-text [config]=\"config\" [group]=\"group\" disableError=\"true\"></app-field-helper-text>\r\n  </div>\r\n\r\n</ng-container>\r\n","import { Component, ChangeDetectionStrategy, OnInit, OnDestroy } from '@angular/core';\r\nimport { combineLatest } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\n\r\nimport { InputType } from '../../../../eav-dynamic-form/decorators/input-type.decorator';\r\nimport { WrappersConstants } from '../../../../shared/constants/wrappers.constants';\r\nimport { BaseComponent } from '../../base/base.component';\r\nimport { EavService } from '../../../../shared/services/eav.service';\r\nimport { ValidationMessagesService } from '../../../validators/validation-messages-service';\r\n\r\n@Component({\r\n  // tslint:disable-next-line:component-selector\r\n  selector: 'boolean-default',\r\n  templateUrl: './boolean-default.component.html',\r\n  styleUrls: ['./boolean-default.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\n@InputType({\r\n  wrapper: [WrappersConstants.EavLocalizationWrapper],\r\n})\r\nexport class BooleanDefaultComponent extends BaseComponent<boolean> implements OnInit, OnDestroy {\r\n\r\n  constructor(eavService: EavService, validationMessagesService: ValidationMessagesService) {\r\n    super(eavService, validationMessagesService);\r\n  }\r\n\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n    this.label$ = combineLatest([this.value$, this.settings$, this.label$]).pipe(map(combined => {\r\n      const value = combined[0];\r\n      const settings = combined[1];\r\n      const label = combined[2];\r\n      if (value === true && settings.TitleTrue != null && settings.TitleTrue !== '') {\r\n        return settings.TitleTrue;\r\n      }\r\n      if (value === false && settings.TitleFalse != null && settings.TitleFalse !== '') {\r\n        return settings.TitleFalse;\r\n      }\r\n      return label;\r\n    }));\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    super.ngOnDestroy();\r\n  }\r\n}\r\n","<ng-container *ngIf=\"{\r\n  value: value$ | async,\r\n  showValidation: showValidation$ | async\r\n} as data\">\r\n\r\n  <div [formGroup]=\"group\">\r\n    <mat-slide-toggle [disabled]=\"disabled$ | async\" [checked]=\"data.value\" (toggleChange)=\"toggle()\" [ngClass]=\"{\r\n      'toggle-false': data.value === false,\r\n      'toggle-null': data.value === null\r\n    }\">\r\n      {{ label$ | async }}\r\n    </mat-slide-toggle>\r\n\r\n    <app-field-helper-text [config]=\"config\" [group]=\"group\" disableError=\"true\"></app-field-helper-text>\r\n  </div>\r\n\r\n</ng-container>\r\n","import { Component, OnInit, ChangeDetectionStrategy, OnDestroy } from '@angular/core';\r\nimport { combineLatest } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\n\r\nimport { InputType } from '../../../../eav-dynamic-form/decorators/input-type.decorator';\r\nimport { WrappersConstants } from '../../../../shared/constants/wrappers.constants';\r\nimport { BaseComponent } from '../../base/base.component';\r\nimport { EavService } from '../../../../shared/services/eav.service';\r\nimport { ValidationMessagesService } from '../../../validators/validation-messages-service';\r\n\r\n@Component({\r\n  // tslint:disable-next-line:component-selector\r\n  selector: 'boolean-tristate',\r\n  templateUrl: './boolean-tristate.component.html',\r\n  styleUrls: ['./boolean-tristate.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\n@InputType({\r\n  wrapper: [WrappersConstants.EavLocalizationWrapper],\r\n})\r\nexport class BooleanTristateComponent extends BaseComponent<boolean | ''> implements OnInit, OnDestroy {\r\n\r\n  constructor(eavService: EavService, validationMessagesService: ValidationMessagesService) {\r\n    super(eavService, validationMessagesService);\r\n  }\r\n\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n    this.value$ = this.value$.pipe(map(value => (value === '') ? null : value));\r\n    this.label$ = combineLatest([this.value$, this.settings$, this.label$]).pipe(map(combined => {\r\n      const value = combined[0];\r\n      const settings = combined[1];\r\n      const label = combined[2];\r\n      if (value === true && settings.TitleTrue != null && settings.TitleTrue !== '') {\r\n        return settings.TitleTrue;\r\n      }\r\n      if (value === false && settings.TitleFalse != null && settings.TitleFalse !== '') {\r\n        return settings.TitleFalse;\r\n      }\r\n      if (value === null && settings.TitleIndeterminate != null && settings.TitleIndeterminate !== '') {\r\n        return settings.TitleIndeterminate;\r\n      }\r\n      return label;\r\n    }));\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  toggle() {\r\n    const currentValue: boolean | '' = this.control.value;\r\n    let nextValue: boolean;\r\n    switch (currentValue) {\r\n      case false:\r\n        nextValue = null;\r\n        break;\r\n      case '':\r\n      case null:\r\n        nextValue = true;\r\n        break;\r\n      case true:\r\n        nextValue = false;\r\n        break;\r\n    }\r\n    this.control.patchValue(nextValue);\r\n  }\r\n\r\n}\r\n","<ng-container *ngIf=\"{\r\n  useTimePicker: useTimePicker$ | async,\r\n  placeholder: placeholder$ | async,\r\n  required: required$ | async,\r\n  disabled: disabled$ | async,\r\n  label: label$ | async,\r\n  showValidation: showValidation$ | async\r\n} as data\">\r\n\r\n  <mat-form-field [formGroup]=\"group\" appearance=\"standard\" color=\"accent\" *ngIf=\"!data.useTimePicker\">\r\n    <input matInput [formControlName]=\"config.field.name\" [matDatepicker]=\"picker\" [placeholder]=\"data.placeholder\"\r\n      [required]=\"data.required\">\r\n    <mat-datepicker-toggle matSuffix [for]=\"picker\" [matTooltip]=\"'Fields.DateTime.Open' | translate\">\r\n    </mat-datepicker-toggle>\r\n    <mat-datepicker #picker></mat-datepicker>\r\n    <mat-label>{{ data.label }}</mat-label>\r\n  </mat-form-field>\r\n\r\n  <mat-form-field [formGroup]=\"group\" appearance=\"standard\" color=\"accent\" *ngIf=\"data.useTimePicker\">\r\n    <input matInput [formControlName]=\"config.field.name\" [ngxMatDatetimePicker]=\"picker\"\r\n      [placeholder]=\"data.placeholder\" [required]=\"data.required\">\r\n    <mat-datepicker-toggle matSuffix [for]=\"picker\" [matTooltip]=\"'Fields.DateTime.Open' | translate\">\r\n    </mat-datepicker-toggle>\r\n    <ngx-mat-datetime-picker #picker></ngx-mat-datetime-picker>\r\n    <mat-label>{{ data.label }}</mat-label>\r\n  </mat-form-field>\r\n\r\n  <app-field-helper-text [config]=\"config\" [group]=\"group\"></app-field-helper-text>\r\n</ng-container>\r\n","import { Component, ChangeDetectionStrategy, OnInit, OnDestroy } from '@angular/core';\r\nimport { DateAdapter } from '@angular/material/core';\r\nimport { NgxMatDateAdapter } from '@angular-material-components/datetime-picker';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { Observable } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\n\r\nimport { InputType } from '../../../../eav-dynamic-form/decorators/input-type.decorator';\r\nimport { WrappersConstants } from '../../../../shared/constants/wrappers.constants';\r\nimport { BaseComponent } from '../../base/base.component';\r\nimport { EavService } from '../../../../shared/services/eav.service';\r\nimport { ValidationMessagesService } from '../../../validators/validation-messages-service';\r\n\r\n@Component({\r\n  // tslint:disable-next-line:component-selector\r\n  selector: 'datetime-default',\r\n  templateUrl: './datetime-default.component.html',\r\n  styleUrls: ['./datetime-default.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\n@InputType({\r\n  wrapper: [WrappersConstants.EavLocalizationWrapper],\r\n})\r\nexport class DatetimeDefaultComponent extends BaseComponent<string> implements OnInit, OnDestroy {\r\n  useTimePicker$: Observable<boolean>;\r\n\r\n  constructor(\r\n    eavService: EavService,\r\n    validationMessagesService: ValidationMessagesService,\r\n    private translate: TranslateService,\r\n    private dateAdapter: DateAdapter<any>,\r\n    private ngxDateTimeAdapter: NgxMatDateAdapter<any>,\r\n  ) {\r\n    super(eavService, validationMessagesService);\r\n    const currentLang = this.translate.currentLang;\r\n    this.dateAdapter.setLocale(currentLang);\r\n    this.ngxDateTimeAdapter.setLocale(currentLang);\r\n  }\r\n\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n    this.useTimePicker$ = this.settings$.pipe(map(settings => settings.UseTimePicker));\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    super.ngOnDestroy();\r\n  }\r\n}\r\n","import { Component, OnInit, ChangeDetectionStrategy } from '@angular/core';\r\n\r\n@Component({\r\n  // tslint:disable-next-line:component-selector\r\n  selector: 'empty-default',\r\n  templateUrl: './empty-default.component.html',\r\n  styleUrls: ['./empty-default.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class EmptyDefaultComponent implements OnInit {\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n}\r\n","<ng-container *ngIf=\"{\r\n  disabled: disabled$ | async,\r\n  showValidation: showValidation$ | async\r\n} as data\">\r\n\r\n  <mat-form-field [formGroup]=\"group\" appearance=\"standard\" color=\"accent\">\r\n    <input matInput type=\"number\" [formControlName]=\"config.field.name\" [required]=\"required$ | async\"\r\n      [placeholder]=\"placeholder$ | async\" [min]=\"min$ | async\" [max]=\"max$ | async\">\r\n    <mat-label>{{ label$ | async }}</mat-label>\r\n  </mat-form-field>\r\n  <app-field-helper-text [config]=\"config\" [group]=\"group\"></app-field-helper-text>\r\n\r\n</ng-container>\r\n","import { Component, OnInit, ChangeDetectionStrategy, OnDestroy } from '@angular/core';\r\nimport { Observable } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\n\r\nimport { InputType } from '../../../../eav-dynamic-form/decorators/input-type.decorator';\r\nimport { WrappersConstants } from '../../../../shared/constants/wrappers.constants';\r\nimport { BaseComponent } from '../../base/base.component';\r\nimport { EavService } from '../../../../shared/services/eav.service';\r\nimport { ValidationMessagesService } from '../../../validators/validation-messages-service';\r\n\r\n@Component({\r\n  // tslint:disable-next-line:component-selector\r\n  selector: 'number-default',\r\n  templateUrl: './number-default.component.html',\r\n  styleUrls: ['./number-default.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\n@InputType({\r\n  wrapper: [WrappersConstants.EavLocalizationWrapper],\r\n})\r\nexport class NumberDefaultComponent extends BaseComponent<number> implements OnInit, OnDestroy {\r\n  min$: Observable<number>;\r\n  max$: Observable<number>;\r\n\r\n  constructor(eavService: EavService, validationMessagesService: ValidationMessagesService) {\r\n    super(eavService, validationMessagesService);\r\n  }\r\n\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n    this.min$ = this.settings$.pipe(map(settings => settings.Min));\r\n    this.max$ = this.settings$.pipe(map(settings => settings.Max));\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    super.ngOnDestroy();\r\n  }\r\n}\r\n","<ng-container *ngIf=\"{\r\n  disabled: disabled$ | async,\r\n  buttons: buttons$ | async,\r\n  settings: settings$ | async,\r\n  value: value$ | async,\r\n  preview: preview$ | async,\r\n  showValidation: showValidation$ | async\r\n} as data\">\r\n\r\n  <ng-container *ngIf=\"open$ | async\">\r\n\r\n    <div class=\"fabs-box\">\r\n      <button mat-mini-fab color=\"accent\" [matTooltip]=\"'Fields.Hyperlink.Default.AdamTip' | translate\"\r\n        *ngIf=\"data.buttons.includes('adam')\" [disabled]=\"data.disabled\" (click)=\"toggleAdam(false, false)\">\r\n        <mat-icon svgIcon=\"appleFilled\"></mat-icon>\r\n      </button>\r\n      <button mat-mini-fab color=\"primary\" [matTooltip]=\"'Fields.Hyperlink.Default.PageTip' | translate\"\r\n        *ngIf=\"data.buttons.includes('page')\" [disabled]=\"data.disabled\" (click)=\"openPageDialog()\">\r\n        <mat-icon svgIcon=\"sitemap\"></mat-icon>\r\n      </button>\r\n      <button mat-mini-fab color=\"primary\" [matTooltip]=\"'Fields.Hyperlink.Default.MoreOptions' | translate\"\r\n        *ngIf=\"data.buttons.includes('more')\" [disabled]=\"data.disabled\" [matMenuTriggerFor]=\"menu\">\r\n        <mat-icon>more_vert</mat-icon>\r\n      </button>\r\n    </div>\r\n\r\n    <mat-menu #menu=\"matMenu\" class=\"menu-box\">\r\n      <button mat-menu-item *ngIf=\"data.settings.ShowAdam\" (click)=\"toggleAdam(false, false)\">\r\n        <mat-icon svgIcon=\"appleFilled\"></mat-icon>\r\n        <span>{{ 'Fields.Hyperlink.Default.MenuAdam' | translate }}</span>\r\n      </button>\r\n      <button mat-menu-item *ngIf=\"data.settings.ShowPagePicker\" (click)=\"openPageDialog()\">\r\n        <mat-icon svgIcon=\"sitemap\"></mat-icon>\r\n        <span>{{ 'Fields.Hyperlink.Default.MenuPage' | translate }}</span>\r\n      </button>\r\n      <button mat-menu-item *ngIf=\"data.settings.ShowImageManager\" (click)=\"toggleAdam(true, true)\">\r\n        <mat-icon svgIcon=\"file-image\"></mat-icon>\r\n        <span>{{ 'Fields.Hyperlink.Default.MenuImage' | translate }}</span>\r\n      </button>\r\n      <button mat-menu-item *ngIf=\"data.settings.ShowFileManager\" (click)=\"toggleAdam(true, false)\">\r\n        <mat-icon svgIcon=\"file\"></mat-icon>\r\n        <span>{{ 'Fields.Hyperlink.Default.MenuDocs' | translate }}</span>\r\n      </button>\r\n    </mat-menu>\r\n\r\n    <!-- content -->\r\n    <div class=\"mdc-layout-grid\">\r\n      <div class=\"mdc-layout-grid__inner\">\r\n        <mat-card class=\"mdc-layout-grid__cell--span-12 hyperlink-card shadow-bottom-z-1\">\r\n          <div class=\"hyperlink-input-link-wrapper\">\r\n            <!-- input -->\r\n            <mat-form-field [formGroup]=\"group\" appearance=\"standard\" color=\"accent\">\r\n              <input matInput [formControlName]=\"config.field.name\"\r\n                [matTooltip]=\"'Fields.Hyperlink.Default.Tooltip' | translate\" matTooltipPosition=\"above\"\r\n                [placeholder]=\"placeholder$ | async\" [required]=\"required$ | async\" appPasteClipboardImage\r\n                [config]=\"config\" [elementType]=\"'input'\">\r\n              <mat-label>{{ label$ | async }}</mat-label>\r\n            </mat-form-field>\r\n            <!-- link absolutely positioned above input -->\r\n            <div *ngIf=\"data.preview?.floatingText\" class=\"hyperlink-floating\">\r\n              <div class=\"hyperlink-floating__value\">{{ data.value }}</div>\r\n              <div class=\"hyperlink-floating__url-box\">\r\n                <a [href]=\"data.preview.url\" target=\"_blank\" class=\"hyperlink-floating__url\"\r\n                  [matTooltip]=\"data.preview.url\">\r\n                  <span>{{ data.preview.floatingText }}</span>\r\n                </a>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"preview-wrapper\" *ngIf=\"data.preview\">\r\n            <!-- image -->\r\n            <a [href]=\"data.preview.thumbnailUrl\" target=\"_blank\" *ngIf=\"data.preview.isImage\">\r\n              <div class=\"preview-image-box\">\r\n                <img [src]=\"data.preview.thumbnailPreviewUrl\" class=\"preview-image\" />\r\n              </div>\r\n            </a>\r\n            <!-- icon -->\r\n            <a [href]=\"data.preview.url\" target=\"_blank\" [matTooltip]=\"data.preview.url\" matTooltipPosition=\"right\"\r\n              *ngIf=\"!data.preview.isImage\">\r\n              <div class=\"preview-icon-box\">\r\n                <mat-icon *ngIf=\"data.preview.isKnownType\">{{ data.preview.icon }}</mat-icon>\r\n                <mat-icon *ngIf=\"!data.preview.isKnownType\" [svgIcon]=\"data.preview.icon\"></mat-icon>\r\n              </div>\r\n            </a>\r\n          </div>\r\n        </mat-card>\r\n      </div>\r\n    </div>\r\n\r\n  </ng-container>\r\n</ng-container>\r\n","import { Component, OnInit, OnDestroy, ChangeDetectionStrategy } from '@angular/core';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { Observable, BehaviorSubject } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\n\r\nimport { DnnBridgeService } from '../../../../shared/services/dnn-bridge.service';\r\nimport { EavService } from '../../../../shared/services/eav.service';\r\nimport { FileTypeService } from '../../../../shared/services/file-type.service';\r\nimport { InputType } from '../../../../eav-dynamic-form/decorators/input-type.decorator';\r\nimport { WrappersConstants } from '../../../../shared/constants/wrappers.constants';\r\nimport { PagePickerResult } from '../../dnn-bridge/web-form-bridge/web-form-bridge.models';\r\nimport { BaseComponent } from '../../base/base.component';\r\nimport { ValidationMessagesService } from '../../../validators/validation-messages-service';\r\nimport { AdamItem, AdamPostResponse } from '../../../../../edit-types';\r\nimport { Preview } from './hyperlink-default.models';\r\nimport { FieldSettings } from '../../../../../edit-types';\r\nimport { EditRoutingService } from '../../../../shared/services/edit-routing.service';\r\n\r\n@Component({\r\n  // tslint:disable-next-line:component-selector\r\n  selector: 'hyperlink-default',\r\n  templateUrl: './hyperlink-default.component.html',\r\n  styleUrls: ['./hyperlink-default.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\n@InputType({\r\n  wrapper: [WrappersConstants.DropzoneWrapper, WrappersConstants.EavLocalizationWrapper,\r\n  WrappersConstants.HyperlinkDefaultExpandableWrapper, WrappersConstants.AdamAttachWrapper],\r\n})\r\nexport class HyperlinkDefaultComponent extends BaseComponent<string> implements OnInit, OnDestroy {\r\n  buttons$: Observable<string>;\r\n  open$: Observable<boolean>;\r\n  preview$ = new BehaviorSubject<Preview>({\r\n    url: '',\r\n    thumbnailUrl: '',\r\n    thumbnailPreviewUrl: '',\r\n    floatingText: '',\r\n    isImage: false,\r\n    isKnownType: false,\r\n    icon: '',\r\n  });\r\n\r\n  constructor(\r\n    eavService: EavService,\r\n    validationMessagesService: ValidationMessagesService,\r\n    private fileTypeService: FileTypeService,\r\n    private dnnBridgeService: DnnBridgeService,\r\n    private dialog: MatDialog,\r\n    private editRoutingService: EditRoutingService,\r\n  ) {\r\n    super(eavService, validationMessagesService);\r\n  }\r\n\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n    this.buttons$ = this.settings$.pipe(map(settings => settings.Buttons || 'adam,more'));\r\n    this.open$ = this.editRoutingService.isExpanded(this.config.field.index, this.config.entity.entityGuid);\r\n    this.subscription.add(this.settings$.subscribe(settings => {\r\n      this.attachAdam(settings);\r\n    }));\r\n    this.subscription.add(this.value$.subscribe(value => {\r\n      this.setLink(value);\r\n    }));\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.preview$.complete();\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  // #region dnn-page picker dialog\r\n  openPageDialog() {\r\n    this.dnnBridgeService.open(\r\n      this.control.value,\r\n      {\r\n        Paths: this.config.field.settings.Paths ? this.config.field.settings.Paths : '',\r\n        FileFilter: this.config.field.settings.FileFilter ? this.config.field.settings.FileFilter : '',\r\n      },\r\n      this.processResultOfPagePicker.bind(this),\r\n      this.dialog,\r\n    );\r\n  }\r\n\r\n  private processResultOfPagePicker(value: PagePickerResult) {\r\n    // Convert to page:xyz format (if it wasn't cancelled)\r\n    if (!value) { return; }\r\n    this.control.patchValue(`page:${value.id}`);\r\n  }\r\n  // #endregion\r\n\r\n  private setLink(value: string) {\r\n    if (!value) { return; }\r\n\r\n    // handle short-ID links like file:17\r\n    const contentType = this.config.entity.header.ContentTypeName;\r\n    const entityGuid = this.config.entity.header.Guid;\r\n    const field = this.config.field.name;\r\n    const urlFromId$ = this.dnnBridgeService.getUrlOfId(value, contentType, entityGuid, field);\r\n\r\n    if (!urlFromId$) {\r\n      const preview: Preview = {\r\n        url: value,\r\n        floatingText: '',\r\n        thumbnailUrl: this.thumbnailUrl(value),\r\n        thumbnailPreviewUrl: this.thumbnailUrl(value, 2),\r\n        isImage: false,\r\n        isKnownType: false,\r\n        icon: this.fileTypeService.getIconClass(value),\r\n      };\r\n      this.preview$.next(preview);\r\n      return;\r\n    }\r\n\r\n    urlFromId$.subscribe(path => {\r\n      if (!path) { return; }\r\n      const preview: Preview = {\r\n        url: path,\r\n        floatingText: `.../${path.substring(path.lastIndexOf('/') + 1, path.length)}`,\r\n        thumbnailUrl: this.thumbnailUrl(path),\r\n        thumbnailPreviewUrl: this.thumbnailUrl(path, 2),\r\n        isImage: this.fileTypeService.isImage(path),\r\n        isKnownType: this.fileTypeService.isKnownType(path),\r\n        icon: this.fileTypeService.getIconClass(path),\r\n      };\r\n      this.preview$.next(preview);\r\n    });\r\n  }\r\n\r\n  private thumbnailUrl(link: string, size?: number, quote?: boolean) {\r\n    let result = link;\r\n    if (size === 1) {\r\n      result = result + '?w=72&h=72&mode=crop';\r\n    }\r\n    if (size === 2) {\r\n      result = result + '?w=800&h=800&mode=max';\r\n    }\r\n    const qt = quote ? '\"' : '';\r\n    return qt + result + qt;\r\n  }\r\n\r\n  // #region adam\r\n  toggleAdam(usePortalRoot: boolean, showImagesOnly: boolean) {\r\n    this.config.adam.toggle(usePortalRoot, showImagesOnly);\r\n  }\r\n\r\n  private attachAdam(settings: FieldSettings) {\r\n    this.config.adam.onItemClick = (item: AdamItem) => { this.setValue(item); };\r\n    this.config.adam.onItemUpload = (item: AdamPostResponse) => { this.setValue(item); };\r\n    this.config.adam.setConfig({\r\n      rootSubfolder: settings.Paths,\r\n      fileFilter: settings.FileFilter,\r\n      autoLoad: true,\r\n    });\r\n  }\r\n\r\n  private setValue(item: AdamItem | AdamPostResponse) {\r\n    this.control.patchValue(`file:${item.Id}`);\r\n  }\r\n  //#endregion\r\n}\r\n","import { Component, ChangeDetectionStrategy, OnInit, OnDestroy } from '@angular/core';\r\n\r\nimport { InputType } from '../../../../eav-dynamic-form/decorators/input-type.decorator';\r\nimport { BaseComponent } from '../../base/base.component';\r\nimport { EavService } from '../../../../shared/services/eav.service';\r\nimport { ValidationMessagesService } from '../../../validators/validation-messages-service';\r\n\r\n@Component({\r\n  // tslint:disable-next-line:component-selector\r\n  selector: 'custom-default',\r\n  templateUrl: './custom-default.component.html',\r\n  styleUrls: ['./custom-default.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\n@InputType({\r\n})\r\nexport class CustomDefaultComponent extends BaseComponent<null> implements OnInit, OnDestroy {\r\n\r\n  constructor(eavService: EavService, validationMessagesService: ValidationMessagesService) {\r\n    super(eavService, validationMessagesService);\r\n  }\r\n\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    super.ngOnDestroy();\r\n  }\r\n}\r\n","<div class=\"message\">{{ config.field.name }}: Field configuration is incomplete and should be fixed.</div>\r\n","\r\nimport { Component, OnInit, OnDestroy, ChangeDetectionStrategy } from '@angular/core';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { TranslateService } from '@ngx-translate/core';\r\n\r\nimport { InputType } from '../../../../eav-dynamic-form/decorators/input-type.decorator';\r\nimport { EavService } from '../../../../shared/services/eav.service';\r\nimport { ValidationMessagesService } from '../../../validators/validation-messages-service';\r\nimport { EntityService } from '../../../../shared/services/entity.service';\r\nimport { EntityDefaultComponent } from '../entity-default/entity-default.component';\r\nimport { FieldSettings } from '../../../../../edit-types';\r\nimport { EditRoutingService } from '../../../../shared/services/edit-routing.service';\r\n\r\n@Component({\r\n  // tslint:disable-next-line:component-selector\r\n  selector: 'entity-content-blocks',\r\n  templateUrl: '../entity-default/entity-default.component.html',\r\n  styleUrls: ['../entity-default/entity-default.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\n@InputType({})\r\nexport class EntityContentBlockComponent extends EntityDefaultComponent implements OnInit, OnDestroy {\r\n\r\n  constructor(\r\n    eavService: EavService,\r\n    validationMessagesService: ValidationMessagesService,\r\n    entityService: EntityService,\r\n    translate: TranslateService,\r\n    editRoutingService: EditRoutingService,\r\n    snackBar: MatSnackBar,\r\n  ) {\r\n    super(eavService, validationMessagesService, entityService, translate, editRoutingService, snackBar);\r\n  }\r\n\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  /** Override function in superclass */\r\n  calculateSettings(settings: FieldSettings) {\r\n    const fixedSettings = super.calculateSettings(settings);\r\n    fixedSettings.AllowMultiValue = false;\r\n    fixedSettings.EnableRemove = true;\r\n    fixedSettings.AllowMultiValue = true;\r\n    fixedSettings.EnableAddExisting = false;\r\n    fixedSettings.EnableCreate = false;\r\n    fixedSettings.EnableEdit = false;\r\n    fixedSettings.EntityType = 'ContentGroupReference';\r\n    return fixedSettings;\r\n  }\r\n}\r\n","import { Component, OnDestroy, ViewChild, ElementRef, Input, NgZone, AfterViewInit, ChangeDetectionStrategy } from '@angular/core';\r\nimport { FormGroup } from '@angular/forms';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { MatDialog } from '@angular/material/dialog';\r\n\r\nimport { FieldConfigSet } from '../../../../../eav-dynamic-form/model/field-config';\r\nimport { EavService } from '../../../../../shared/services/eav.service';\r\nimport { DnnBridgeService } from '../../../../../shared/services/dnn-bridge.service';\r\nimport { ContentTypeService } from '../../../../../shared/store/ngrx-data/content-type.service';\r\nimport { ConnectorHelper } from './connector.helper';\r\nimport { FeatureService } from '../../../../../shared/store/ngrx-data/feature.service';\r\nimport { InputTypeService } from '../../../../../shared/store/ngrx-data/input-type.service';\r\nimport { EditRoutingService } from '../../../../../shared/services/edit-routing.service';\r\nimport { angularConsoleLog } from '../../../../../../ng-dialogs/src/app/shared/helpers/angular-console-log.helper';\r\n\r\n@Component({\r\n  selector: 'app-connector',\r\n  templateUrl: './connector.component.html',\r\n  styleUrls: ['./connector.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class ConnectorComponent implements AfterViewInit, OnDestroy {\r\n  @ViewChild('customElContainer') customElContainerRef: ElementRef;\r\n\r\n  @Input() config: FieldConfigSet;\r\n  @Input() group: FormGroup;\r\n\r\n  private connectorCreator: ConnectorHelper;\r\n\r\n  constructor(\r\n    private eavService: EavService,\r\n    private translateService: TranslateService,\r\n    private contentTypeService: ContentTypeService,\r\n    private inputTypeService: InputTypeService,\r\n    private featureService: FeatureService,\r\n    private editRoutingService: EditRoutingService,\r\n    private dnnBridgeService: DnnBridgeService,\r\n    private dialog: MatDialog,\r\n    private zone: NgZone,\r\n  ) { }\r\n\r\n  ngAfterViewInit() {\r\n    const componentTag = history?.state?.componentTag || `field-${this.config.field.inputType}-dialog`;\r\n    angularConsoleLog('Connector created for:', componentTag);\r\n    this.connectorCreator = new ConnectorHelper(\r\n      this.config,\r\n      this.group,\r\n      this.customElContainerRef,\r\n      componentTag,\r\n      this.eavService,\r\n      this.translateService,\r\n      this.contentTypeService,\r\n      this.inputTypeService,\r\n      this.featureService,\r\n      this.editRoutingService,\r\n      this.dnnBridgeService,\r\n      this.dialog,\r\n      this.zone,\r\n    );\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    angularConsoleLog('Connector destroyed');\r\n    this.connectorCreator.destroy();\r\n  }\r\n}\r\n","<div #customElContainer style=\"height:100%; position:relative;\"></div>\r\n","<ng-container *ngIf=\"{\r\n  loading: loading$ | async,\r\n  isExpanded: isExpanded$ | async,\r\n  showValidation: showValidation$ | async\r\n} as data\">\r\n  <mat-spinner *ngIf=\"data.loading\" color=\"accent\"></mat-spinner>\r\n  <app-connector [config]=\"config\" [group]=\"group\" *ngIf=\"!data.loading && data.isExpanded\"></app-connector>\r\n</ng-container>\r\n","import { Component, OnInit, OnDestroy, ChangeDetectionStrategy } from '@angular/core';\r\nimport { Observable, BehaviorSubject } from 'rxjs';\r\nimport { take } from 'rxjs/operators';\r\n\r\nimport { InputType } from '../../../../eav-dynamic-form/decorators/input-type.decorator';\r\nimport { InputType as InputTypeModel } from '../../../../shared/models/eav';\r\nimport { InputTypeService } from '../../../../shared/store/ngrx-data/input-type.service';\r\nimport { ScriptsLoaderService } from '../../../../shared/services/scripts-loader.service';\r\nimport { EditRoutingService } from '../../../../shared/services/edit-routing.service';\r\nimport { angularConsoleLog } from '../../../../../ng-dialogs/src/app/shared/helpers/angular-console-log.helper';\r\nimport { BaseComponent } from '../../base/base.component';\r\nimport { EavService } from '../../../../shared/services/eav.service';\r\nimport { ValidationMessagesService } from '../../../validators/validation-messages-service';\r\n\r\n@Component({\r\n  // tslint:disable-next-line:component-selector\r\n  selector: 'external-web-component',\r\n  templateUrl: './external-web-component.component.html',\r\n  styleUrls: ['./external-web-component.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\n@InputType({})\r\nexport class ExternalWebComponentComponent extends BaseComponent<string> implements OnInit, OnDestroy {\r\n  loading$ = new BehaviorSubject(true);\r\n  isExpanded$: Observable<boolean>;\r\n\r\n  constructor(\r\n    eavService: EavService,\r\n    validationMessagesService: ValidationMessagesService,\r\n    private inputTypeService: InputTypeService,\r\n    private scriptsLoaderService: ScriptsLoaderService,\r\n    private editRoutingService: EditRoutingService,\r\n  ) {\r\n    super(eavService, validationMessagesService);\r\n  }\r\n\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n    this.isExpanded$ = this.editRoutingService.isExpanded(this.config.field.index, this.config.entity.entityGuid);\r\n    this.loadAssets();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.loading$.complete();\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  private loadAssets() {\r\n    let inputType: InputTypeModel;\r\n    this.inputTypeService.getInputTypeById(this.config.field.inputType).pipe(take(1)).subscribe(type => { inputType = type; });\r\n\r\n    const assets = inputType.AngularAssets.split('\\n');\r\n    if (assets.length === 0) { return; }\r\n    this.scriptsLoaderService.load(assets, this.assetsLoaded.bind(this));\r\n  }\r\n\r\n  private assetsLoaded() {\r\n    angularConsoleLog('ExternalWebcomponentComponent', this.config.field.name, 'loaded');\r\n    this.loading$.next(false);\r\n  }\r\n}\r\n","import { Component, OnInit, OnDestroy, ChangeDetectionStrategy } from '@angular/core';\r\nimport { Subscription } from 'rxjs';\r\n\r\nimport { InputType } from '../../../../eav-dynamic-form/decorators/input-type.decorator';\r\nimport { WrappersConstants } from '../../../../shared/constants/wrappers.constants';\r\nimport { CustomValidators } from '../../../validators/custom-validators';\r\nimport { BaseComponent } from '../../base/base.component';\r\nimport { EavService } from '../../../../shared/services/eav.service';\r\nimport { ValidationMessagesService } from '../../../validators/validation-messages-service';\r\nimport { FieldSettings } from '../../../../../edit-types';\r\nimport { AdamControl } from './hyperlink-library.models';\r\n\r\n@Component({\r\n  // tslint:disable-next-line:component-selector\r\n  selector: 'hyperlink-library',\r\n  templateUrl: './hyperlink-library.component.html',\r\n  styleUrls: ['./hyperlink-library.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\n@InputType({\r\n  wrapper: [WrappersConstants.DropzoneWrapper, WrappersConstants.EavLocalizationWrapper,\r\n  WrappersConstants.HyperlinkLibraryExpandableWrapper, WrappersConstants.AdamAttachWrapper],\r\n})\r\nexport class HyperlinkLibraryComponent extends BaseComponent<null> implements OnInit, OnDestroy {\r\n  /** Requires more handling that normal subscriptions */\r\n  private adamValidation: Subscription;\r\n\r\n  constructor(eavService: EavService, validationMessagesService: ValidationMessagesService) {\r\n    super(eavService, validationMessagesService);\r\n  }\r\n\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n    this.subscription.add(this.settings$.subscribe(settings => {\r\n      this.attachAdam(settings);\r\n      this.attachAdamValidator(settings.Required);\r\n    }));\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.adamValidation?.unsubscribe();\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  private attachAdam(settings: FieldSettings) {\r\n    this.config.adam.setConfig({\r\n      allowAssetsInRoot: settings.AllowAssetsInRoot,\r\n      autoLoad: true,\r\n      enableSelect: false,\r\n      rootSubfolder: settings.Paths,\r\n      fileFilter: settings.FileFilter,\r\n      folderDepth: settings.FolderDepth || 0,\r\n      metadataContentTypes: settings.MetadataContentTypes,\r\n    });\r\n  }\r\n\r\n  private attachAdamValidator(required: boolean) {\r\n    if (!required) {\r\n      this.adamValidation?.unsubscribe();\r\n      this.control.setValidators(this.config.field.validation);\r\n      return;\r\n    }\r\n\r\n    const validators = [\r\n      ...this.config.field.validation,\r\n      CustomValidators.validateAdam(),\r\n    ];\r\n    this.control.setValidators(validators);\r\n    this.adamValidation = this.config.adam.items$.subscribe(items => {\r\n      (this.control as AdamControl).adamItems = items.length;\r\n      // onlySelf doesn't update form being valid for some reason\r\n      this.control.updateValueAndValidity(/*{ onlySelf: true }*/);\r\n    });\r\n  }\r\n}\r\n","<ng-container *ngIf=\"{\r\n  disabled: disabled$ | async,\r\n  showValidation: showValidation$ | async\r\n} as data\">\r\n\r\n  <mat-form-field [formGroup]=\"group\" appearance=\"standard\" color=\"accent\" class=\"textarea-field\">\r\n    <textarea matInput [formControlName]=\"config.field.name\" [rows]=\"rowCount$ | async\"\r\n      [placeholder]=\"placeholder$ | async\" [required]=\"required$ | async\"></textarea>\r\n    <mat-label>{{ label$ | async }}</mat-label>\r\n  </mat-form-field>\r\n\r\n  <app-field-helper-text [config]=\"config\" [group]=\"group\"></app-field-helper-text>\r\n\r\n</ng-container>\r\n","import { Component, OnInit, ChangeDetectionStrategy, OnDestroy } from '@angular/core';\r\nimport { Observable } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\n\r\nimport { InputType } from '../../../../eav-dynamic-form/decorators/input-type.decorator';\r\nimport { WrappersConstants } from '../../../../shared/constants/wrappers.constants';\r\nimport { BaseComponent } from '../../base/base.component';\r\nimport { EavService } from '../../../../shared/services/eav.service';\r\nimport { ValidationMessagesService } from '../../../validators/validation-messages-service';\r\n\r\n@Component({\r\n  // tslint:disable-next-line:component-selector\r\n  selector: 'custom-json-editor',\r\n  templateUrl: './custom-json-editor.component.html',\r\n  styleUrls: ['./custom-json-editor.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\n@InputType({\r\n  wrapper: [WrappersConstants.EavLocalizationWrapper],\r\n})\r\nexport class CustomJsonEditorComponent extends BaseComponent<string> implements OnInit, OnDestroy {\r\n  rowCount$: Observable<number>;\r\n\r\n  constructor(eavService: EavService, validationMessagesService: ValidationMessagesService) {\r\n    super(eavService, validationMessagesService);\r\n  }\r\n\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n    this.rowCount$ = this.settings$.pipe(map(settings => settings.Rows || 5));\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    super.ngOnDestroy();\r\n  }\r\n}\r\n","import { ComponentFactoryResolver, ComponentRef, Directive, Input, OnInit, Type, ViewContainerRef } from '@angular/core';\r\nimport { FormGroup } from '@angular/forms';\r\n\r\nimport { FieldConfigSet, FieldConfigGroup } from '../../model/field-config';\r\nimport { FieldWrapper } from '../../model/field-wrapper';\r\nimport { InputTypeConstants } from '../../../../ng-dialogs/src/app/content-type-fields/constants/input-type.constants';\r\n\r\n// components\r\nimport { AdamAttachWrapperComponent } from '../../../eav-material-controls/adam/adam-attach-wrapper/adam-attach-wrapper.component';\r\nimport { CollapsibleFieldWrapperComponent } from '../../../eav-material-controls/wrappers/collapsible-field-wrapper/collapsible-field-wrapper.component';\r\nimport { CollapsibleWrapperComponent } from '../../../eav-material-controls/wrappers';\r\nimport { DropzoneWrapperComponent } from '../../../eav-material-controls/adam/dropzone-wrapper/dropzone-wrapper.component';\r\nimport { EavLocalizationComponent } from '../../../eav-material-controls/wrappers/eav-localization-wrapper/eav-localization-wrapper.component';\r\nimport { EntityExpandableWrapperComponent } from '../../../eav-material-controls/wrappers/entity-expandable-wrapper/entity-expandable-wrapper.component';\r\nimport { ExpandableWrapperComponent } from '../../../eav-material-controls/wrappers/expandable-wrapper/expandable-wrapper.component';\r\nimport { HiddenWrapperComponent } from '../../../eav-material-controls/wrappers/hidden-wrapper/hidden-wrapper.component';\r\nimport { HyperlinkDefaultExpandableWrapperComponent } from '../../../eav-material-controls/wrappers/hyperlink-default-expandable-wrapper/hyperlink-default-expandable-wrapper.component';\r\nimport { HyperlinkLibraryExpandableWrapperComponent } from '../../../eav-material-controls/wrappers/hyperlink-library-expandable-wrapper/hyperlink-library-expandable-wrapper.component';\r\n// tslint:disable-next-line:max-line-length\r\nimport { BooleanDefaultComponent, DatetimeDefaultComponent, EmptyDefaultComponent, EntityDefaultComponent, HyperlinkDefaultComponent, NumberDefaultComponent, StringDefaultComponent, StringDropdownComponent, StringDropdownQueryComponent, StringFontIconPickerComponent, StringTemplatePickerComponent, StringUrlPathComponent } from '../../../eav-material-controls/input-types';\r\nimport { CustomDefaultComponent } from '../../../eav-material-controls/input-types/custom/custom-default/custom-default.component';\r\nimport { EntityContentBlockComponent } from '../../../eav-material-controls/input-types/entity/entity-content-blocks/entity-content-blocks.component';\r\nimport { EntityQueryComponent } from '../../../eav-material-controls/input-types/entity/entity-query/entity-query.component';\r\nimport { ExternalWebComponentComponent } from '../../../eav-material-controls/input-types/custom/external-web-component/external-web-component.component';\r\nimport { HyperlinkLibraryComponent } from '../../../eav-material-controls/input-types/hyperlink/hyperlink-library/hyperlink-library.component';\r\nimport { angularConsoleLog } from '../../../../ng-dialogs/src/app/shared/helpers/angular-console-log.helper';\r\nimport { BooleanTristateComponent } from '../../../eav-material-controls/input-types/boolean/boolean-tristate/boolean-tristate.component';\r\nimport { CustomJsonEditorComponent } from '../../../eav-material-controls/input-types/custom/custom-json-editor/custom-json-editor.component';\r\n\r\n@Directive({ selector: '[appEavField]' })\r\nexport class EavFieldDirective implements OnInit {\r\n  @Input() private config: FieldConfigSet[];\r\n  @Input() private group: FormGroup;\r\n\r\n  private components: { [key: string]: Type<any> } = {\r\n    'app-adam-attach-wrapper': AdamAttachWrapperComponent,\r\n    'app-collapsible-field-wrapper': CollapsibleFieldWrapperComponent,\r\n    'app-collapsible-wrapper': CollapsibleWrapperComponent,\r\n    'app-dropzone-wrapper': DropzoneWrapperComponent,\r\n    'app-eav-localization-wrapper': EavLocalizationComponent,\r\n    'app-entity-expandable-wrapper': EntityExpandableWrapperComponent,\r\n    'app-expandable-wrapper': ExpandableWrapperComponent,\r\n    'app-hidden-wrapper': HiddenWrapperComponent,\r\n    'app-hyperlink-default-expandable-wrapper': HyperlinkDefaultExpandableWrapperComponent,\r\n    'app-hyperlink-library-expandable-wrapper': HyperlinkLibraryExpandableWrapperComponent,\r\n    'boolean-default': BooleanDefaultComponent,\r\n    'boolean-tristate': BooleanTristateComponent,\r\n    'custom-default': CustomDefaultComponent,\r\n    'custom-json-editor': CustomJsonEditorComponent,\r\n    'datetime-default': DatetimeDefaultComponent,\r\n    'empty-default': EmptyDefaultComponent,\r\n    'entity-content-blocks': EntityContentBlockComponent,\r\n    'entity-default': EntityDefaultComponent,\r\n    'entity-query': EntityQueryComponent,\r\n    'external-web-component': ExternalWebComponentComponent,\r\n    'hyperlink-default': HyperlinkDefaultComponent,\r\n    'hyperlink-library': HyperlinkLibraryComponent,\r\n    'number-default': NumberDefaultComponent,\r\n    'string-default': StringDefaultComponent,\r\n    'string-dropdown': StringDropdownComponent,\r\n    'string-dropdown-query': StringDropdownQueryComponent,\r\n    'string-font-icon-picker': StringFontIconPickerComponent,\r\n    'string-template-picker': StringTemplatePickerComponent,\r\n    'string-url-path': StringUrlPathComponent,\r\n  };\r\n\r\n  constructor(private resolver: ComponentFactoryResolver, private container: ViewContainerRef) { }\r\n\r\n  ngOnInit() {\r\n    // Clear container\r\n    this.container.clear();\r\n\r\n    this.config.forEach(controlConfiguration => {\r\n      angularConsoleLog('create controlConfiguration', controlConfiguration);\r\n      this.createFieldOrGroup(this.container, controlConfiguration);\r\n    });\r\n  }\r\n\r\n  /** Create all child fields and groups from fieldConfig in container */\r\n  private createFieldOrGroup(container: ViewContainerRef, fieldConfig: FieldConfigSet) {\r\n    const field = fieldConfig.field as FieldConfigGroup;\r\n    if (field.fieldGroup) {\r\n      this.createGroupComponents(container, fieldConfig);\r\n    } else {\r\n      angularConsoleLog('create createFieldOrGroup:', fieldConfig.field.inputType);\r\n      this.createComponent(container, fieldConfig);\r\n    }\r\n  }\r\n\r\n  /** Create group components with group wrappers in container */\r\n  private createGroupComponents(container: ViewContainerRef, fieldConfig: FieldConfigSet) {\r\n    if (fieldConfig.field.wrappers) {\r\n      container = this.createComponentWrappers(container, fieldConfig, fieldConfig.field.wrappers);\r\n    }\r\n    const field = fieldConfig.field as FieldConfigGroup;\r\n    field.fieldGroup.forEach(controlConfiguration => {\r\n      this.createFieldOrGroup(container, controlConfiguration);\r\n    });\r\n  }\r\n\r\n  /** Create component and component wrappers if component exist */\r\n  private createComponent(container: ViewContainerRef, fieldConfig: FieldConfigSet): ComponentRef<any> {\r\n    if (fieldConfig.field.wrappers) {\r\n      container = this.createComponentWrappers(container, fieldConfig, fieldConfig.field.wrappers);\r\n    }\r\n    angularConsoleLog('EavFieldDirective createComponent inputType:', fieldConfig.field.inputType);\r\n    let componentType: Type<any>;\r\n    if (fieldConfig.field.isExternal) {\r\n      componentType = this.readComponentType(InputTypeConstants.ExternalWebComponent);\r\n    } else {\r\n      componentType = this.readComponentType(fieldConfig.field.inputType);\r\n    }\r\n\r\n    // if inputTypeAnnotations of componentType exist then create component\r\n    const inputTypeAnnotations = Reflect.getMetadata('inputTypeAnnotations', componentType);\r\n    if (inputTypeAnnotations) {\r\n      if (inputTypeAnnotations.wrapper) {\r\n        container = this.createComponentWrappers(container, fieldConfig, inputTypeAnnotations.wrapper);\r\n      }\r\n\r\n      const factory = this.resolver.resolveComponentFactory(componentType);\r\n      const ref = container.createComponent(factory);\r\n\r\n      Object.assign(ref.instance, {\r\n        group: this.group,\r\n        config: fieldConfig\r\n      });\r\n\r\n      return ref;\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  /** Read component type by selector with ComponentFactoryResolver */\r\n  private readComponentType(selector: string): Type<any> {\r\n    // const factories = Array.from((this.resolver as any)._factories.values());\r\n    // const componentType = (factories.find((x: any) => x.selector === selector) as any).componentType;\r\n    const componentType = this.components[selector];\r\n    if (componentType === undefined) {\r\n      console.error(`Missing component class for: ${selector}`);\r\n      return CustomDefaultComponent;\r\n    }\r\n    return componentType;\r\n  }\r\n\r\n  /** Create wrappers in container */\r\n  private createComponentWrappers(container: ViewContainerRef, fieldConfig: FieldConfigSet, wrappers: string[]): ViewContainerRef {\r\n    wrappers.forEach(wrapperName => {\r\n      container = this.createWrapper(container, fieldConfig, wrapperName);\r\n    });\r\n    return container;\r\n  }\r\n\r\n  /** Create wrapper in container */\r\n  private createWrapper(container: ViewContainerRef, fieldConfig: FieldConfigSet, wrapper: string): ViewContainerRef {\r\n    const componentType = this.readComponentType(wrapper);\r\n\r\n    // create component from component type\r\n    const componentFactory = this.resolver.resolveComponentFactory(componentType);\r\n    const ref: ComponentRef<FieldWrapper> = container.createComponent(componentFactory);\r\n\r\n    Object.assign(ref.instance, {\r\n      group: this.group, // this only need if we have form groups\r\n      config: fieldConfig\r\n    });\r\n\r\n    return ref.instance.fieldComponent;\r\n  }\r\n}\r\n","import { Component, EventEmitter, Input, OnInit, Output, OnDestroy, ChangeDetectionStrategy } from '@angular/core';\r\nimport { FormGroup, FormBuilder } from '@angular/forms';\r\nimport { Subscription } from 'rxjs';\r\n\r\nimport { FieldConfigSet, FieldConfigGroup } from '../../model/field-config';\r\nimport { angularConsoleLog } from '../../../../ng-dialogs/src/app/shared/helpers/angular-console-log.helper';\r\n\r\n@Component({\r\n  selector: 'app-eav-form',\r\n  templateUrl: './eav-form.component.html',\r\n  styleUrls: ['./eav-form.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class EavFormComponent implements OnInit, OnDestroy {\r\n  @Input() config: FieldConfigSet[] = [];\r\n  @Output() private formSubmit = new EventEmitter<void>();\r\n  @Output() private formValueChange = new EventEmitter<any>();\r\n\r\n  form: FormGroup = new FormGroup({});\r\n  private subscription = new Subscription();\r\n\r\n  constructor(private formBuilder: FormBuilder) { }\r\n\r\n  ngOnInit() {\r\n    this.createControlsInFormGroup(this.config);\r\n\r\n    this.subscription.add(\r\n      this.form.valueChanges.subscribe(val => {\r\n        this.formValueChange.emit(val);\r\n      })\r\n    );\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.subscription.unsubscribe();\r\n  }\r\n\r\n  submitOutside() {\r\n    angularConsoleLog('form save');\r\n    // Use this to emit value out\r\n    this.formSubmit.emit();\r\n  }\r\n\r\n  /**\r\n   * Patch values to formGroup. It accepts an object with control names as keys and will do it's best to\r\n   * match the values to the correct controls in the group.\r\n   * If emitEvent is true, this change will cause a valueChanges event on the FormGroup to be emitted.\r\n   * This defaults to true (as it falls through to updateValueAndValidity)\r\n   */\r\n  patchValue(values: { [key: string]: any }, emitEvent: boolean) {\r\n    this.form.patchValue(values, { emitEvent });\r\n  }\r\n\r\n  /** Check if value in form changed */\r\n  valueIsChanged(values: { [key: string]: any }) {\r\n    let valueIsChanged = false;\r\n\r\n    const valueKeys = Object.keys(values);\r\n    for (const valueKey of valueKeys) {\r\n      if (values[valueKey] !== this.form.value[valueKey]) {\r\n        valueIsChanged = true;\r\n        break;\r\n      }\r\n    }\r\n\r\n    // spm isn't this always true? Something could be wrong here\r\n    angularConsoleLog('VALUECHANGED:', valueIsChanged, 'VALUES:', values, 'FORM VALUES:', this.form.value);\r\n    return valueIsChanged;\r\n  }\r\n\r\n  /** Create form from configuration */\r\n  private createControlsInFormGroup(fieldConfigArray: FieldConfigSet[]) {\r\n    try {\r\n      fieldConfigArray.forEach(fieldConfig => {\r\n        const field = fieldConfig.field as FieldConfigGroup;\r\n        if (field.fieldGroup) {\r\n          this.createControlsInFormGroup(field.fieldGroup);\r\n        } else {\r\n          this.form.addControl(fieldConfig.field.name, this.createControl(fieldConfig));\r\n        }\r\n      });\r\n      return this.form;\r\n    } catch (error) {\r\n      console.error(`Error creating form controls: ${error}\\nFieldConfig: ${fieldConfigArray}`);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /** Create form control */\r\n  private createControl(config: FieldConfigSet) {\r\n    try {\r\n      const { disabled, validation, initialValue } = config.field;\r\n      return this.formBuilder.control({ disabled, value: initialValue }, validation);\r\n    } catch (error) {\r\n      console.error(`Error creating form control: ${error}\\nConfig: ${config}`);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n}\r\n","<form class=\"dynamic-form\" [formGroup]=\"form\">\r\n  <ng-container appEavField [config]=\"config\" [group]=\"form\">\r\n  </ng-container>\r\n</form>\r\n","<div *ngIf=\"contentType$ | async\">\r\n  <app-eav-form [config]=\"itemFields$ | async\" (formSubmit)=\"submit()\" (formValueChange)=\"formValueChange($event)\">\r\n  </app-eav-form>\r\n</div>\r\n","import { EventEmitter, Input, OnDestroy, OnInit, Output, Component, ViewChild, ChangeDetectionStrategy, OnChanges, SimpleChanges } from '@angular/core';\r\nimport { Action } from '@ngrx/store';\r\nimport { Actions, ofType } from '@ngrx/effects';\r\nimport { Observable, Subscription } from 'rxjs';\r\nimport { filter } from 'rxjs/operators';\r\n\r\nimport { ContentType, Item } from '../../shared/models/eav';\r\nimport { ContentTypeService } from '../../shared/store/ngrx-data/content-type.service';\r\nimport { EavFormComponent } from '../../eav-dynamic-form/components/eav-form/eav-form.component';\r\nimport { EavService } from '../../shared/services/eav.service';\r\nimport { FieldConfigSet } from '../../eav-dynamic-form/model/field-config';\r\nimport { ItemService } from '../../shared/store/ngrx-data/item.service';\r\nimport { LocalizationHelper } from '../../shared/helpers/localization-helper';\r\nimport * as fromItems from '../../shared/store/actions/item.actions';\r\nimport { BuildFieldsService } from './build-fields.service';\r\nimport { InputFieldHelper } from '../../shared/helpers/input-field-helper';\r\nimport { LanguageInstanceService } from '../../shared/store/ngrx-data/language-instance.service';\r\n\r\n@Component({\r\n  selector: 'app-item-edit-form',\r\n  templateUrl: './item-edit-form.component.html',\r\n  styleUrls: ['./item-edit-form.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class ItemEditFormComponent implements OnInit, OnDestroy, OnChanges {\r\n  @ViewChild(EavFormComponent) form: EavFormComponent;\r\n  @Input() item: Item;\r\n  @Input() private formId: number;\r\n  @Output() private itemFormValueChange = new EventEmitter<void>();\r\n\r\n  contentType$: Observable<ContentType>;\r\n  itemFields$: Observable<FieldConfigSet[]>;\r\n  currentLanguage: string;\r\n\r\n  private defaultLanguage: string;\r\n  private subscription = new Subscription();\r\n\r\n  constructor(\r\n    private languageInstanceService: LanguageInstanceService,\r\n    private itemService: ItemService,\r\n    private contentTypeService: ContentTypeService,\r\n    private eavService: EavService,\r\n    private actions$: Actions,\r\n    private buildFieldsService: BuildFieldsService,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.subscription.add(\r\n      this.languageInstanceService.getDefaultLanguage(this.formId).subscribe(defaultLang => {\r\n        this.defaultLanguage = defaultLang;\r\n      })\r\n    );\r\n\r\n    this.subscription.add(\r\n      this.languageInstanceService.getCurrentLanguage(this.formId).subscribe(currentLang => {\r\n        this.currentLanguage = currentLang;\r\n        this.setFormValues();\r\n      })\r\n    );\r\n\r\n    // create input fields from content type\r\n    const contentTypeId = InputFieldHelper.getContentTypeId(this.item);\r\n    this.contentType$ = this.contentTypeService.getContentTypeById(contentTypeId);\r\n    this.itemFields$ = this.buildFieldsService.buildFields(\r\n      this.contentType$,\r\n      this.item,\r\n      this.formId,\r\n      this.currentLanguage,\r\n      this.defaultLanguage,\r\n    );\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.subscription.unsubscribe();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (changes.item != null) {\r\n      this.setFormValues();\r\n    }\r\n  }\r\n\r\n  /** Observe is item form is saved */\r\n  formSaveObservable() {\r\n    return this.actions$.pipe(\r\n      ofType(fromItems.SAVE_ITEM_ATTRIBUTES_VALUES),\r\n      filter((action: fromItems.SaveItemAttributesValuesAction) =>\r\n        this.item.entity.id === 0 ? this.item.entity.guid === action.item.entity.guid : this.item.entity.id === action.item.entity.id\r\n      ),\r\n    ) as Observable<Action>;\r\n  }\r\n\r\n  /**\r\n   * Update NGRX/store on form value change\r\n   * @param values key:value list of fields from form\r\n   */\r\n  formValueChange(values: { [key: string]: any }) {\r\n    this.itemService.updateItemAttributesValues(\r\n      this.item.entity.id,\r\n      values,\r\n      this.currentLanguage,\r\n      this.defaultLanguage,\r\n      this.item.entity.guid,\r\n    );\r\n\r\n    this.itemFormValueChange.emit();\r\n  }\r\n\r\n  submit() {\r\n    if (this.form.form.valid || this.checkAreAllControlsDisabled() || (this.item.header.Group && this.item.header.Group.SlotCanBeEmpty)) {\r\n      this.eavService.saveItem(this.item);\r\n    }\r\n  }\r\n\r\n  checkAreAllControlsDisabled() {\r\n    let allDisabled = true;\r\n    const controlKeys = Object.keys(this.form.form.controls);\r\n    for (const key of controlKeys) {\r\n      if (!this.form.form.controls[key].disabled) {\r\n        allDisabled = false;\r\n        break;\r\n      }\r\n    }\r\n    return allDisabled;\r\n  }\r\n\r\n  private setFormValues() {\r\n    if (!this.form) { return; }\r\n\r\n    const formValues: { [name: string]: any } = {};\r\n    Object.keys(this.item.entity.attributes).forEach(attributeKey => {\r\n      formValues[attributeKey] = LocalizationHelper.translate(\r\n        this.currentLanguage,\r\n        this.defaultLanguage,\r\n        this.item.entity.attributes[attributeKey],\r\n        null,\r\n      );\r\n    });\r\n\r\n    // spm true only on language change?\r\n    if (this.form.valueIsChanged(formValues)) {\r\n      // set new values to form\r\n      this.form.patchValue(formValues, false);\r\n    }\r\n    // important to be after patchValue\r\n    this.eavService.formValueChange$.next({\r\n      formId: this.formId,\r\n      entityGuid: this.item.entity.guid,\r\n      entityValues: formValues,\r\n    });\r\n  }\r\n\r\n}\r\n","import { EavValues } from '../eav';\r\nimport { angularConsoleLog } from '../../../../ng-dialogs/src/app/shared/helpers/angular-console-log.helper';\r\n\r\nexport class Value1<T> {\r\n  [key: string]: T;\r\n\r\n  public static create<T>(eavValues: EavValues<T>): Value1<T> {\r\n    const newValue1: Value1<T> = {};\r\n    angularConsoleLog('eavValues.values.forEach: ', eavValues.values);\r\n    eavValues.values.forEach(eavValue => {\r\n      const allDimensions = eavValue.dimensions.map(d => d.value).join();\r\n      newValue1[allDimensions] = eavValue.value;\r\n    });\r\n    return newValue1;\r\n  }\r\n}\r\n","import { Attribute1 } from './attribute1';\r\nimport { EavAttributes } from '../eav';\r\nimport { Value1 } from './value1';\r\n\r\nexport class Attributes1<T> {\r\n  [key: string]: Attribute1<T>;\r\n\r\n  public static create<T>(eavAttributes: EavAttributes): Attributes1<T> {\r\n    const newAttribute1: Attributes1<T> = new Attributes1<T>();\r\n\r\n    Object.keys(eavAttributes).forEach(eavAttributeKey => {\r\n      const type = eavAttributes[eavAttributeKey].type;\r\n      if (!newAttribute1[type]) { newAttribute1[type] = {}; }\r\n      newAttribute1[type][eavAttributeKey] = Value1.create<T>(eavAttributes[eavAttributeKey]);\r\n    });\r\n    return newAttribute1;\r\n  }\r\n}\r\n","export class Type1 {\r\n    Id: string;\r\n    Name: string;\r\n\r\n    constructor(Id: string, Name: string) {\r\n        this.Id = Id;\r\n        this.Name = Name;\r\n    }\r\n}\r\n","import { EavFor } from '../eav';\r\n\r\nexport class For1 {\r\n  Target: string;\r\n  Number?: number;\r\n  String?: string;\r\n  Guid?: string;\r\n\r\n  constructor(entityFor: EavFor) {\r\n    this.Target = entityFor.Target;\r\n    if (entityFor.Number) {\r\n      this.Number = entityFor.Number;\r\n    }\r\n    if (entityFor.String) {\r\n      this.String = entityFor.String;\r\n    }\r\n    if (entityFor.Guid) {\r\n      this.Guid = entityFor.Guid;\r\n    }\r\n  }\r\n}\r\n","import { Attributes1 } from './attributes1';\r\nimport { Type1 } from './type1';\r\nimport { EavEntity } from '../eav';\r\nimport { For1 } from './for1';\r\n\r\nexport class Entity1 {\r\n  Id: number;\r\n  Version: number;\r\n  Guid: string;\r\n  Type: Type1;\r\n  Attributes: Attributes1<any>;\r\n  Owner: string;\r\n  Metadata: Entity1[];\r\n  For?: For1;\r\n\r\n  constructor(\r\n    Id: number,\r\n    Version: number,\r\n    Guid: string,\r\n    Type: Type1,\r\n    Attributes: Attributes1<any>,\r\n    Owner: string,\r\n    Metadata: Entity1[],\r\n    For?: For1,\r\n  ) {\r\n    this.Id = Id;\r\n    this.Version = Version;\r\n    this.Guid = Guid;\r\n    this.Type = Type;\r\n    this.Attributes = Attributes;\r\n    this.Owner = Owner;\r\n    this.Metadata = Metadata;\r\n    if (For) { this.For = For; }\r\n  }\r\n\r\n  public static create(entity: EavEntity): Entity1 {\r\n    const attributes1 = Attributes1.create(entity.attributes);\r\n    const metaData1 = this.createArray(entity.metadata);\r\n    const for1 = entity.For ? new For1(entity.For) : null;\r\n\r\n    return new Entity1(\r\n      entity.id,\r\n      entity.version,\r\n      entity.guid,\r\n      new Type1(entity.type.id, entity.type.name),\r\n      attributes1,\r\n      entity.owner,\r\n      metaData1,\r\n      for1,\r\n    );\r\n  }\r\n\r\n  public static createArray(eavEntityArray: EavEntity[]): Entity1[] {\r\n    if (!eavEntityArray) { return null; }\r\n    const metaData1Array: Entity1[] = new Array<Entity1>();\r\n    eavEntityArray.forEach(eavEntity => {\r\n      metaData1Array.push(Entity1.create(eavEntity));\r\n    });\r\n    return metaData1Array;\r\n  }\r\n}\r\n","import { Entity1 } from './entity1';\r\n// import { JsonHeader1 } from './json-header1';\r\nimport { Item } from '../eav/item';\r\nimport { EavHeader } from '../eav';\r\n\r\nexport class JsonItem1 {\r\n  // Header: JsonHeader1;\r\n  Header: EavHeader;\r\n  Entity: Entity1;\r\n\r\n  constructor(Header: EavHeader, Entity: Entity1) {\r\n    this.Header = Header;\r\n    this.Entity = Entity;\r\n  }\r\n\r\n  public static create(item: Item): JsonItem1 {\r\n    return new JsonItem1(\r\n      // JsonHeader1.create(item.header),\r\n      item.header,\r\n      Entity1.create(item.entity)\r\n    );\r\n  }\r\n}\r\n","import { Component, OnInit, Inject, ChangeDetectionStrategy } from '@angular/core';\r\nimport { MatSnackBarRef, MAT_SNACK_BAR_DATA } from '@angular/material/snack-bar';\r\n\r\nimport { UnsavedChangesSnackData } from './snack-bar-unsaved-changes.models';\r\n\r\n@Component({\r\n  selector: 'app-snack-bar-unsaved-changes',\r\n  templateUrl: './snack-bar-unsaved-changes.component.html',\r\n  styleUrls: ['./snack-bar-unsaved-changes.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class SnackBarUnsavedChangesComponent implements OnInit {\r\n\r\n  constructor(\r\n    private snackRef: MatSnackBarRef<SnackBarUnsavedChangesComponent>,\r\n    @Inject(MAT_SNACK_BAR_DATA) private snackBarData: UnsavedChangesSnackData,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  saveChanges(save: boolean) {\r\n    this.snackBarData.save = save;\r\n    this.snackRef.dismissWithAction();\r\n  }\r\n}\r\n","<span class=\"error-message\">{{ 'Errors.UnsavedChanges' | translate }}</span>\r\n\r\n<div fxLayoutAlign=\"end end\">\r\n  <button mat-button color=\"accent\" (click)=\"saveChanges(false)\">\r\n    {{ ('General.Buttons.NotSave' | translate).toUpperCase() }}\r\n  </button>\r\n  <button mat-button color=\"accent\" (click)=\"saveChanges(true)\">\r\n    {{ ('General.Buttons.Save' | translate).toUpperCase()}}\r\n  </button>\r\n</div>\r\n","<div class=\"save-errors-container\">\r\n  <div>{{ 'Errors.SaveErrors' | translate }}</div>\r\n  <br />\r\n  <div *ngFor=\"let error of fieldErrors;\">\r\n    <span>{{ error.field }}<span>: {{ error.message | translate }}</span></span>\r\n  </div>\r\n</div>\r\n","import { Component, Inject, OnInit, ChangeDetectionStrategy } from '@angular/core';\r\nimport { MAT_SNACK_BAR_DATA } from '@angular/material/snack-bar';\r\n\r\nimport { SaveErrorsSnackData } from './snack-bar-save-errors.models';\r\nimport { FieldErrorMessage } from '../../../shared/models/eav/field-error-message';\r\n\r\n@Component({\r\n  selector: 'app-snack-bar-save-errors',\r\n  templateUrl: './snack-bar-save-errors.component.html',\r\n  styleUrls: ['./snack-bar-save-errors.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class SnackBarSaveErrorsComponent implements OnInit {\r\n  fieldErrors: FieldErrorMessage[] = [];\r\n\r\n  constructor(@Inject(MAT_SNACK_BAR_DATA) private snackBarData: SaveErrorsSnackData) { }\r\n\r\n  ngOnInit() {\r\n    this.fieldErrors = this.snackBarData.fieldErrors;\r\n  }\r\n}\r\n","import { ActivatedRoute } from '@angular/router';\r\n\r\nimport { Language } from '../../shared/models/eav';\r\n\r\nexport function calculateIsParentDialog(route: ActivatedRoute) {\r\n  let editDialogCount = 0;\r\n  for (const path of route.snapshot.pathFromRoot) {\r\n    if (path.url.length <= 0) { continue; }\r\n    for (const urlSegment of path.url) {\r\n      if (urlSegment.path !== 'edit') { continue; }\r\n      editDialogCount++;\r\n    }\r\n  }\r\n  return editDialogCount === 1;\r\n}\r\n\r\nexport function sortLanguages(primaryLangKey: string, languages: Language[]) {\r\n  if (languages.length === 0) { return languages; }\r\n\r\n  let primaryLang: Language;\r\n  const sameLangs: Language[] = [];\r\n  const otherLangs: Language[] = [];\r\n  for (const language of languages) {\r\n    if (language.key === primaryLangKey) {\r\n      primaryLang = language;\r\n    } else if (language.key.startsWith(primaryLangKey.split('-')[0])) {\r\n      sameLangs.push(language);\r\n    } else {\r\n      otherLangs.push(language);\r\n    }\r\n  }\r\n  sameLangs.sort(alphabetCompare);\r\n  otherLangs.sort(alphabetCompare);\r\n\r\n  if (!primaryLang) {\r\n    return [...sameLangs, ...otherLangs];\r\n  } else {\r\n    return [primaryLang, ...sameLangs, ...otherLangs];\r\n  }\r\n}\r\n\r\nfunction alphabetCompare(a: Language, b: Language) {\r\n  if (a.key < b.key) { return -1; }\r\n  if (a.key > b.key) { return 1; }\r\n  return 0;\r\n}\r\n","export type PublishMode = 'branch' | 'show' | 'hide';\r\n\r\nexport class PublishModeConstants {\r\n  public static readonly Show = 'show';\r\n  public static readonly Hide = 'hide';\r\n  public static readonly Branch = 'branch';\r\n}\r\n","import { Component, OnInit, ChangeDetectionStrategy, Inject } from '@angular/core';\r\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\r\n\r\nimport { PublishMode, PublishModeConstants } from '../../../eav-item-dialog/multi-item-edit-form/multi-item-edit-form.constants';\r\n\r\n@Component({\r\n  selector: 'app-save-status-dialog',\r\n  templateUrl: './save-status-dialog.component.html',\r\n  styleUrls: ['./save-status-dialog.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class SaveStatusDialogComponent implements OnInit {\r\n  publishMode: PublishMode;\r\n  Modes = PublishModeConstants;\r\n\r\n  constructor(private dialogRef: MatDialogRef<SaveStatusDialogComponent>, @Inject(MAT_DIALOG_DATA) private data: PublishMode) { }\r\n\r\n  ngOnInit() {\r\n    this.publishMode = this.data;\r\n  }\r\n\r\n  setMode(mode: PublishMode) {\r\n    this.dialogRef.close(mode);\r\n  }\r\n}\r\n","<mat-card>\r\n  <div class=\"mat-card__header\">\r\n    <div class=\"mat-card__title\">{{ 'SaveMode.Dialog.Title' | translate }}</div>\r\n    <div class=\"mat-card__description\">{{ 'SaveMode.Dialog.Intro' | translate }}</div>\r\n  </div>\r\n\r\n  <mat-nav-list toggle>\r\n\r\n    <mat-list-item (click)=\"setMode(Modes.Show)\" [ngClass]=\"{ 'mat-list-item-focus': publishMode === Modes.Show }\">\r\n      <mat-icon matListIcon color=\"accent\">visibility</mat-icon>\r\n      <div matLine class=\"mat-list-item__title\">{{ 'SaveMode.Dialog.Show.Title' | translate }}</div>\r\n      <div matLine class=\"mat-list-item__body\">{{ 'SaveMode.Dialog.Show.Body' | translate }}</div>\r\n    </mat-list-item>\r\n\r\n    <mat-list-item (click)=\"setMode(Modes.Hide)\" [ngClass]=\"{ 'mat-list-item-focus': publishMode === Modes.Hide }\">\r\n      <mat-icon matListIcon color=\"accent\">visibility_off</mat-icon>\r\n      <div matLine class=\"mat-list-item__title\">{{ 'SaveMode.Dialog.Hide.Title' | translate }}</div>\r\n      <div matLine class=\"mat-list-item__body\">{{ 'SaveMode.Dialog.Hide.Body' | translate }}</div>\r\n    </mat-list-item>\r\n\r\n    <mat-list-item (click)=\"setMode(Modes.Branch)\" [ngClass]=\"{ 'mat-list-item-focus': publishMode === Modes.Branch }\">\r\n      <mat-icon matListIcon color=\"accent\" svgIcon=\"draft-branch\"></mat-icon>\r\n      <div matLine class=\"mat-list-item__title\">{{ 'SaveMode.Dialog.Branch.Title' | translate }}</div>\r\n      <div matLine class=\"mat-list-item__body\">{{ 'SaveMode.Dialog.Branch.Body' | translate }}</div>\r\n    </mat-list-item>\r\n\r\n  </mat-nav-list>\r\n</mat-card>\r\n","import { NgZone } from '@angular/core';\r\nimport { ElementEventListener } from '../../../../../shared/element-event-listener.model';\r\n\r\nexport class MouseScrollHelper {\r\n  private oldScrollBehavior: string;\r\n  private positionX: number;\r\n  private headerDownListener: ElementEventListener;\r\n  private eventListeners: ElementEventListener[] = [];\r\n\r\n  constructor(\r\n    private ngZone: NgZone,\r\n    private header: HTMLElement,\r\n    private areButtonsDisabled: () => boolean\r\n  ) {\r\n    this.ngZone.runOutsideAngular(() => {\r\n      const registerScroll = this.registerScroll.bind(this);\r\n      this.header.addEventListener('pointerdown', registerScroll, { passive: true });\r\n      this.headerDownListener = { element: this.header, type: 'pointerdown', listener: registerScroll };\r\n    });\r\n  }\r\n\r\n  destroy() {\r\n    this.ngZone.runOutsideAngular(() => {\r\n      this.headerDownListener.element.removeEventListener(this.headerDownListener.type, this.headerDownListener.listener);\r\n      this.headerDownListener = null;\r\n      this.eventListeners.forEach(evList => {\r\n        evList.element.removeEventListener(evList.type, evList.listener);\r\n        evList = null;\r\n      });\r\n      this.eventListeners = null;\r\n    });\r\n    this.ngZone = null;\r\n    this.header = null;\r\n    this.areButtonsDisabled = null;\r\n  }\r\n\r\n  private registerScroll(event: MouseEvent) {\r\n    const disabled = this.areButtonsDisabled();\r\n    if (disabled || event.button !== 0) { return; }\r\n\r\n    window.getSelection().removeAllRanges();\r\n    this.oldScrollBehavior = getComputedStyle(this.header).getPropertyValue('scroll-behavior');\r\n\r\n    this.header.style.scrollBehavior = 'auto';\r\n    this.positionX = event.pageX;\r\n\r\n    const doScroll = this.doScroll.bind(this);\r\n    const removeScroll = this.removeScroll.bind(this);\r\n    document.addEventListener('pointermove', doScroll, { passive: true });\r\n    document.addEventListener('pointerup', removeScroll, { passive: true });\r\n    document.addEventListener('pointerleave', removeScroll, { passive: true });\r\n    this.eventListeners.push(\r\n      { element: document, type: 'pointermove', listener: doScroll },\r\n      { element: document, type: 'pointerup', listener: removeScroll },\r\n      { element: document, type: 'pointerleave', listener: removeScroll },\r\n    );\r\n  }\r\n\r\n  private removeScroll() {\r\n    this.header.style.scrollBehavior = this.oldScrollBehavior;\r\n\r\n    this.eventListeners.forEach(evList => {\r\n      evList.element.removeEventListener(evList.type, evList.listener);\r\n      evList = null;\r\n    });\r\n    this.eventListeners.splice(0, this.eventListeners.length);\r\n  }\r\n\r\n  private doScroll(event: MouseEvent) {\r\n    const newPositionX = event.pageX;\r\n    if (newPositionX < this.positionX) {\r\n      this.header.scrollLeft += this.positionX - newPositionX;\r\n    } else if (newPositionX > this.positionX) {\r\n      this.header.scrollLeft += -(newPositionX - this.positionX);\r\n    }\r\n    this.positionX = newPositionX;\r\n  }\r\n}\r\n","import { NgZone } from '@angular/core';\r\nimport { ElementEventListener } from '../../../../../shared/element-event-listener.model';\r\n\r\nexport class CenterSelectedHelper {\r\n  private positionX: number;\r\n  private positionY: number;\r\n  private moveThreshold = 2; // Pixels for which header can be scrolled while clicking to still register as click\r\n  private stopClick = false;\r\n  private eventListeners: ElementEventListener[] = [];\r\n\r\n  constructor(\r\n    private ngZone: NgZone,\r\n    private header: HTMLElement,\r\n  ) {\r\n    this.ngZone.runOutsideAngular(() => {\r\n      const checkIfMouseMoved = this.checkIfMouseMoved.bind(this);\r\n      document.addEventListener('mouseup', checkIfMouseMoved, { passive: true });\r\n      this.eventListeners.push({ element: document, type: 'mouseup', listener: checkIfMouseMoved });\r\n    });\r\n  }\r\n\r\n  lngButtonDown(event: MouseEvent) {\r\n    this.ngZone.runOutsideAngular(() => {\r\n      this.saveInitialPosition(event);\r\n    });\r\n  }\r\n\r\n  lngButtonClick(event: MouseEvent) {\r\n    this.ngZone.runOutsideAngular(() => {\r\n      this.doMove(event);\r\n    });\r\n  }\r\n\r\n  stopClickIfMouseMoved() {\r\n    return this.stopClick;\r\n  }\r\n\r\n  destroy() {\r\n    this.ngZone.runOutsideAngular(() => {\r\n      this.eventListeners.forEach(evList => {\r\n        evList.element.removeEventListener(evList.type, evList.listener);\r\n        evList = null;\r\n      });\r\n      this.eventListeners = null;\r\n    });\r\n  }\r\n\r\n  private saveInitialPosition(event: MouseEvent) {\r\n    this.stopClick = false;\r\n    this.positionX = event.pageX;\r\n    this.positionY = event.pageY;\r\n  }\r\n\r\n  private checkIfMouseMoved(event: MouseEvent) {\r\n    if (!this.positionX || !this.positionY) {\r\n      this.stopClick = false;\r\n      return;\r\n    }\r\n    const newPositionX = event.pageX;\r\n    const newPositionY = event.pageY;\r\n\r\n    const newTotal = newPositionX + newPositionY;\r\n    const oldTotal = this.positionX + this.positionY;\r\n\r\n    this.stopClick = Math.abs(oldTotal - newTotal) > this.moveThreshold;\r\n    this.positionX = null;\r\n    this.positionY = null;\r\n  }\r\n\r\n  private doMove(event: MouseEvent) {\r\n    if (this.stopClick) { return; }\r\n\r\n    const button = event.target as HTMLButtonElement;\r\n    const buttonOffset = button.getBoundingClientRect().left;\r\n    const buttonWidth = button.getBoundingClientRect().width;\r\n    const headerOffset = this.header.getBoundingClientRect().left;\r\n    const headerWidth = this.header.getBoundingClientRect().width;\r\n\r\n    const currentPosition = buttonOffset + buttonWidth / 2;\r\n    const moveTo = headerOffset + headerWidth / 2;\r\n\r\n    this.header.scrollLeft += currentPosition - moveTo;\r\n  }\r\n}\r\n","import { NgZone } from '@angular/core';\r\nimport { ElementEventListener } from '../../../../../shared/element-event-listener.model';\r\n\r\nexport class ShowShadowsHelper {\r\n  private maxScrollLeft: number;\r\n  private hidden = 'hidden'; // CSS class which hides shadows\r\n  private eventListeners: ElementEventListener[] = [];\r\n\r\n  constructor(\r\n    private ngZone: NgZone,\r\n    private header: HTMLElement,\r\n    private leftShadow: HTMLElement,\r\n    private rightShadow: HTMLElement,\r\n  ) {\r\n    this.ngZone.runOutsideAngular(() => {\r\n      this.calculateShadows();\r\n\r\n      const calculateShadows = this.calculateShadows.bind(this);\r\n      this.header.addEventListener('scroll', calculateShadows, { passive: true });\r\n      window.addEventListener('resize', calculateShadows, { passive: true });\r\n      this.eventListeners.push(\r\n        { element: this.header, type: 'scroll', listener: calculateShadows },\r\n        { element: window, type: 'resize', listener: calculateShadows },\r\n      );\r\n    });\r\n  }\r\n\r\n  destroy() {\r\n    this.ngZone.runOutsideAngular(() => {\r\n      this.eventListeners.forEach(evList => {\r\n        evList.element.removeEventListener(evList.type, evList.listener);\r\n        evList = null;\r\n      });\r\n      this.eventListeners = null;\r\n    });\r\n    this.ngZone = null;\r\n    this.header = null;\r\n    this.leftShadow = null;\r\n    this.rightShadow = null;\r\n  }\r\n\r\n  private calculateShadows() {\r\n    this.maxScrollLeft = this.header.scrollWidth - this.header.clientWidth;\r\n\r\n    if (this.maxScrollLeft === 0) {\r\n      this.hideBoth();\r\n    } else if (this.header.scrollLeft === 0) {\r\n      this.hideLeft();\r\n    } else if (this.header.scrollLeft === this.maxScrollLeft) {\r\n      this.hideRight();\r\n    } else {\r\n      this.showBoth();\r\n    }\r\n  }\r\n\r\n  private hideBoth() {\r\n    this.leftShadow.classList.add(this.hidden);\r\n    this.rightShadow.classList.add(this.hidden);\r\n  }\r\n\r\n  private hideLeft() {\r\n    this.leftShadow.classList.add(this.hidden);\r\n    this.rightShadow.classList.remove(this.hidden);\r\n  }\r\n\r\n  private hideRight() {\r\n    this.leftShadow.classList.remove(this.hidden);\r\n    this.rightShadow.classList.add(this.hidden);\r\n  }\r\n\r\n  private showBoth() {\r\n    this.leftShadow.classList.remove(this.hidden);\r\n    this.rightShadow.classList.remove(this.hidden);\r\n  }\r\n}\r\n","import { Language } from '../../../../shared/models/eav';\r\n\r\nexport interface LanguageButton extends Language {\r\n  buttonText: string;\r\n}\r\n\r\n/** Calculates properties of language buttons, e.g. name to be desplayed */\r\nexport function calculateLanguageButtons(languages: Language[]): LanguageButton[] {\r\n  const languageButtons: LanguageButton[] = [];\r\n  const regionlessNamesCount: { [key: string]: number } = {};\r\n\r\n  // count the number of repetitions of the same language without region key\r\n  // e.g. English (United States) and English (Australia) are both English\r\n  languages.forEach(language => {\r\n    const regionlessName = removeRegionName(language.name);\r\n    if (regionlessNamesCount[regionlessName]) {\r\n      regionlessNamesCount[regionlessName]++;\r\n    } else {\r\n      regionlessNamesCount[regionlessName] = 1;\r\n    }\r\n  });\r\n\r\n  // if language repeats, append language key to name which will be displayed\r\n  languages.forEach(language => {\r\n    const regionlessName = removeRegionName(language.name);\r\n\r\n    languageButtons.push({\r\n      name: language.name,\r\n      key: language.key,\r\n      buttonText: (regionlessNamesCount[regionlessName] > 1) ? `${regionlessName} (${language.key})` : regionlessName,\r\n    });\r\n  });\r\n\r\n  return languageButtons;\r\n}\r\n\r\n/** Returns name without region, e.g. ENGLISH from English (United Stated) */\r\nfunction removeRegionName(languageName: string): string {\r\n  return languageName.substring(0, languageName.indexOf('(') > 0 ? languageName.indexOf('(') - 1 : 100).toLocaleUpperCase();\r\n}\r\n","<div class=\"scrollable__overlay\" *ngIf=\"{\r\n  currentLanguage: currentLanguage$ | async\r\n} as data\">\r\n  <div #leftShadow class=\"scrollable__overlay--left-shadow\"></div>\r\n  <div #rightShadow class=\"scrollable__overlay--right-shadow\"></div>\r\n  <div #scrollable class=\"scrollable lang-switch\" (click)=\"showError()\">\r\n    <button mat-flat-button class=\"lang-switch__button\" *ngFor=\"let langButton of (languageButtons$ | async)\"\r\n      [disabled]=\"!formsAreValid && data.currentLanguage !== langButton.key && !allControlsAreDisabled\"\r\n      [color]=\"data.currentLanguage === langButton.key ? 'accent' : 'white'\" (mousedown)=\"lngButtonMouseDown($event)\"\r\n      (click)=\"lngButtonClick($event, langButton)\" [matTooltip]=\"langButton.name\">\r\n      {{ langButton.buttonText }}\r\n    </button>\r\n  </div>\r\n</div>\r\n","import { Component, Input, ViewChild, AfterViewInit, ElementRef, OnDestroy, OnInit, NgZone, ChangeDetectionStrategy } from '@angular/core';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { Observable } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\n\r\nimport { Language } from '../../../shared/models/eav';\r\nimport { LanguageService } from '../../../shared/store/ngrx-data/language.service';\r\nimport { LanguageInstanceService } from '../../../shared/store/ngrx-data/language-instance.service';\r\nimport { MouseScrollHelper } from './eav-language-switcher-services/mouse-scroll-helper';\r\nimport { CenterSelectedHelper } from './eav-language-switcher-services/center-selected-helper';\r\nimport { ShowShadowsHelper } from './eav-language-switcher-services/show-shadows-helper';\r\nimport { LanguageButton, calculateLanguageButtons } from './eav-language-switcher-services/eav-language-switcher.helpers';\r\n\r\n@Component({\r\n  selector: 'app-eav-language-switcher',\r\n  templateUrl: './eav-language-switcher.component.html',\r\n  styleUrls: ['./eav-language-switcher.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class EavLanguageSwitcherComponent implements OnInit, AfterViewInit, OnDestroy {\r\n  @ViewChild('scrollable') headerRef: ElementRef;\r\n  @ViewChild('leftShadow') leftShadowRef: ElementRef;\r\n  @ViewChild('rightShadow') rightShadowRef: ElementRef;\r\n  @Input() formId: number;\r\n  @Input() formsAreValid: boolean;\r\n  @Input() allControlsAreDisabled: boolean;\r\n\r\n  languageButtons$: Observable<LanguageButton[]>;\r\n  currentLanguage$: Observable<string>;\r\n\r\n  private centerSelectedService: CenterSelectedHelper;\r\n  private mouseScrollHelper: MouseScrollHelper;\r\n  private showShadowsService: ShowShadowsHelper;\r\n\r\n  constructor(\r\n    private languageService: LanguageService,\r\n    private languageInstanceService: LanguageInstanceService,\r\n    private ngZone: NgZone,\r\n    private snackBar: MatSnackBar,\r\n    private translate: TranslateService,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.languageButtons$ = this.languageService.entities$.pipe(map(langs => calculateLanguageButtons(langs)));\r\n    this.currentLanguage$ = this.languageInstanceService.getCurrentLanguage(this.formId);\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    this.showShadowsService = new ShowShadowsHelper(this.ngZone, this.headerRef.nativeElement,\r\n      this.leftShadowRef.nativeElement, this.rightShadowRef.nativeElement);\r\n    this.mouseScrollHelper = new MouseScrollHelper(this.ngZone, this.headerRef.nativeElement, this.areButtonsDisabled.bind(this));\r\n    this.centerSelectedService = new CenterSelectedHelper(this.ngZone, this.headerRef.nativeElement);\r\n  }\r\n\r\n  areButtonsDisabled() {\r\n    return !this.formsAreValid && !this.allControlsAreDisabled;\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.centerSelectedService.destroy();\r\n    this.mouseScrollHelper.destroy();\r\n    this.showShadowsService.destroy();\r\n  }\r\n\r\n  lngButtonMouseDown(event: MouseEvent) {\r\n    this.centerSelectedService.lngButtonDown(event);\r\n  }\r\n\r\n  lngButtonClick(event: MouseEvent, language: Language) {\r\n    this.centerSelectedService.lngButtonClick(event);\r\n\r\n    if (!this.centerSelectedService.stopClickIfMouseMoved()) {\r\n      this.languageInstanceService.updateCurrentLanguage(this.formId, language.key);\r\n    }\r\n  }\r\n\r\n  showError() {\r\n    if (!this.areButtonsDisabled()) { return; }\r\n    this.snackBar.open(this.translate.instant('Message.CantSwitchLanguage'), null, { duration: 2000 });\r\n  }\r\n}\r\n","<mat-card class=\"header\">\r\n  <button mat-icon-button class=\"header__exit-button\" (click)=\"close()\"\r\n    [matTooltip]=\"(isParentDialog ? 'Form.Buttons.Exit.Tip' : 'Form.Buttons.Return.Tip') | translate\">\r\n    <mat-icon>{{ isParentDialog ? 'clear' : 'arrow_back' }}</mat-icon>\r\n  </button>\r\n\r\n  <div class=\"header__langs\">\r\n    <app-eav-language-switcher *ngIf=\"hasLanguages$ | async\" [formId]=\"formId\" [formsAreValid]=\"formsAreValid\"\r\n      [allControlsAreDisabled]=\"allControlsAreDisabled\">\r\n    </app-eav-language-switcher>\r\n  </div>\r\n\r\n  <button mat-button class=\"header__publish-button\" (click)=\"openSaveStatusDialog()\"\r\n    matTooltip=\"{{ 'SaveMode.' + publishMode + '.Tip' | translate }}\">\r\n    <span class=\"header__publish-mode\">\r\n      {{ 'SaveMode.Label' | translate }}\r\n      <b>{{ ('SaveMode.' + publishMode | translate: '').toUpperCase() }}</b>\r\n    </span>\r\n  </button>\r\n</mat-card>\r\n","import { Component, OnInit, Input, ChangeDetectionStrategy, Output, EventEmitter } from '@angular/core';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { Observable } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\n\r\nimport { SaveStatusDialogComponent } from '../../eav-material-controls/dialogs/save-status-dialog/save-status-dialog.component';\r\nimport { LanguageService } from '../../shared/store/ngrx-data/language.service';\r\nimport { PublishMode } from '../multi-item-edit-form/multi-item-edit-form.constants';\r\n\r\n@Component({\r\n  selector: 'app-multi-item-edit-form-header',\r\n  templateUrl: './multi-item-edit-form-header.component.html',\r\n  styleUrls: ['./multi-item-edit-form-header.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class MultiItemEditFormHeaderComponent implements OnInit {\r\n  @Input() formId: number;\r\n  @Input() formsAreValid: boolean;\r\n  @Input() allControlsAreDisabled: boolean;\r\n  @Input() isParentDialog: boolean;\r\n  @Input() publishMode: PublishMode;\r\n  @Output() closeDialog = new EventEmitter<null>();\r\n  @Output() setPublishMode = new EventEmitter<PublishMode>();\r\n\r\n  hasLanguages$: Observable<boolean>;\r\n\r\n  constructor(private dialog: MatDialog, private languageService: LanguageService) { }\r\n\r\n  ngOnInit() {\r\n    this.hasLanguages$ = this.languageService.entities$.pipe(map(languages => languages.length > 0));\r\n  }\r\n\r\n  close() {\r\n    this.closeDialog.emit();\r\n  }\r\n\r\n  openSaveStatusDialog() {\r\n    const dialogRef = this.dialog.open(SaveStatusDialogComponent, {\r\n      panelClass: 'c-save-status-dialog',\r\n      autoFocus: false,\r\n      width: '350px',\r\n      data: this.publishMode\r\n    });\r\n    dialogRef.keydownEvents().subscribe(e => {\r\n      const CTRL_S = e.keyCode === 83 && (navigator.platform.match('Mac') ? e.metaKey : e.ctrlKey);\r\n      if (!CTRL_S) { return; }\r\n      e.preventDefault();\r\n    });\r\n    dialogRef.afterClosed().subscribe((res: PublishMode) => {\r\n      if (res == null) { return; }\r\n      this.setPublishMode.emit(res);\r\n    });\r\n  }\r\n}\r\n","<ng-container *ngIf=\"{\r\n  showDebugInfo: showDebugInfo$ | async,\r\n  items: items$ | async\r\n} as data\">\r\n\r\n  <mat-card fxLayout=\"column\" fxLayoutAlign=\"center start\" [ngClass]=\"{ 'debug-enabled': data.showDebugInfo }\">\r\n    <div class=\"debug-buttons-container\" fxLayout=\"row\" fxLayoutAlign=\"space-between center\">\r\n      <button mat-icon-button [matTooltip]=\"'General.Buttons.Debug' | translate\" (click)=\"toggleDebugInfo()\">\r\n        <mat-icon>offline_bolt</mat-icon>\r\n      </button>\r\n      <div>2sxc {{ sxcVer }}</div>\r\n      <!-- copy of the button to keep 2sxc version text correctly aligned in the middle -->\r\n      <button mat-icon-button class=\"hidden\">\r\n        <mat-icon>offline_bolt</mat-icon>\r\n      </button>\r\n    </div>\r\n    <div *ngIf=\"data.showDebugInfo\" class=\"debug-info-container\">\r\n      <textarea readonly class=\"debug-dump\">{{ data.items | json }}</textarea>\r\n    </div>\r\n  </mat-card>\r\n</ng-container>\r\n","import { Component, OnInit, Output, EventEmitter, ChangeDetectionStrategy, OnDestroy } from '@angular/core';\r\nimport { Observable, BehaviorSubject } from 'rxjs';\r\n\r\nimport { ItemService } from '../../shared/store/ngrx-data/item.service';\r\nimport { Item } from '../../shared/models/eav';\r\ndeclare const sxcVersion: string;\r\n\r\n@Component({\r\n  selector: 'app-multi-item-edit-form-debug',\r\n  templateUrl: './multi-item-edit-form-debug.component.html',\r\n  styleUrls: ['./multi-item-edit-form-debug.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class MultiItemEditFormDebugComponent implements OnInit, OnDestroy {\r\n  @Output() debugInfoOpened = new EventEmitter<boolean>();\r\n\r\n  sxcVer = sxcVersion.substring(0, sxcVersion.lastIndexOf('\\.'));\r\n  showDebugInfo$ = new BehaviorSubject(false);\r\n  items$: Observable<Item[]>;\r\n\r\n  constructor(private itemService: ItemService) { }\r\n\r\n  ngOnInit() {\r\n    this.items$ = this.itemService.selectAllItems();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.showDebugInfo$.complete();\r\n  }\r\n\r\n  toggleDebugInfo() {\r\n    this.showDebugInfo$.next(!this.showDebugInfo$.value);\r\n    this.debugInfoOpened.emit(this.showDebugInfo$.value);\r\n  }\r\n}\r\n","<router-outlet></router-outlet>\r\n\r\n<ng-container *ngIf=\"{\r\n  items: items$ | async,\r\n  formsAreValid: formsAreValid$ | async,\r\n  allControlsAreDisabled: allControlsAreDisabled$ | async,\r\n  publishMode: publishMode$ | async,\r\n  reduceSaveButton: reduceSaveButton$ | async,\r\n  debugEnabled: debugEnabled$ | async,\r\n  debugInfoIsOpen: debugInfoIsOpen$ | async,\r\n  hideHeader: hideHeader$ | async,\r\n  slide: slide$ | async\r\n} as data\">\r\n  <div mat-dialog-container (click)=\"toggleDebugEnabled($event)\" style=\"position: relative\">\r\n    <div mat-dialog-actions class=\"form-header-container\" [ngClass]=\"{ 'u-display-none': data.hideHeader }\">\r\n      <app-multi-item-edit-form-header class=\"multi-item-edit-form-header\" [formId]=\"formId\"\r\n        [formsAreValid]=\"data.formsAreValid\" [allControlsAreDisabled]=\"data.allControlsAreDisabled\"\r\n        [isParentDialog]=\"isParentDialog\" [publishMode]=\"data.publishMode\" (closeDialog)=\"closeDialog()\"\r\n        (setPublishMode)=\"setPublishMode($event)\">\r\n      </app-multi-item-edit-form-header>\r\n    </div>\r\n    <div style=\"position: relative\">\r\n      <div mat-dialog-content class=\"u-hide-scrollbar\" [ngClass]=\"{\r\n        'debug-enabled': data.debugEnabled,\r\n        'debug-info-is-open': data.debugInfoIsOpen,\r\n        'hide-header-height-fix': data.hideHeader\r\n      }\">\r\n        <div class=\"mdc-layout-grid\">\r\n          <div class=\"mdc-layout-grid__inner\">\r\n            <div #slideable class=\"mdc-layout-grid__cell--span-12\" [ngClass]=\"data.slide\">\r\n              <div *ngFor=\"let item of data.items; trackBy: trackByFn\">\r\n                <app-item-edit-form [item]=\"item\" [formId]=\"formId\" (itemFormValueChange)=\"formValueChange()\">\r\n                </app-item-edit-form>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"c-multi-item-dialog__save-container\">\r\n          <div class=\"c-multi-item-dialog__save-button\">\r\n            <button mat-fab class=\"mat-elevation-z24\" [matTooltip]=\"'Form.Buttons.Save.Tip' | translate\" [ngClass]=\"{\r\n              'mat-fab--compact' : data.reduceSaveButton,\r\n              'mat-fab--extended' : !data.reduceSaveButton,\r\n              'mat-fab--disabled' : !data.formsAreValid && !data.allControlsAreDisabled\r\n            }\" (click)=\"saveAll(true)\">\r\n              <mat-icon>done</mat-icon>\r\n              {{ data.reduceSaveButton ? '' : ('Form.Buttons.Save' | translate).toUpperCase() }}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <app-multi-item-edit-form-debug mat-dialog-actions *ngIf=\"data.debugEnabled\"\r\n      (debugInfoOpened)=\"debugInfoOpened($event)\">\r\n    </app-multi-item-edit-form-debug>\r\n  </div>\r\n</ng-container>\r\n","// tslint:disable-next-line:max-line-length\r\nimport { Component, OnInit, QueryList, ViewChildren, ChangeDetectorRef, OnDestroy, AfterViewChecked, ViewChild, ElementRef, ChangeDetectionStrategy } from '@angular/core';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { MatDialogRef } from '@angular/material/dialog';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { Action } from '@ngrx/store';\r\nimport { Actions, ofType } from '@ngrx/effects';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { Observable, zip, of, Subscription, BehaviorSubject, merge, fromEvent } from 'rxjs';\r\nimport { switchMap, map, tap, catchError, take, pairwise, filter, delay } from 'rxjs/operators';\r\nimport 'reflect-metadata';\r\n\r\nimport * as fromItems from '../../shared/store/actions/item.actions';\r\nimport { Item, Language } from '../../shared/models/eav';\r\nimport { ContentTypeService } from '../../shared/store/ngrx-data/content-type.service';\r\nimport { GlobalConfigurationService } from '../../shared/services/global-configuration.service';\r\nimport { ItemEditFormComponent } from '../item-edit-form/item-edit-form.component';\r\nimport { ItemService } from '../../shared/store/ngrx-data/item.service';\r\nimport { EavService } from '../../shared/services/eav.service';\r\nimport { LanguageService } from '../../shared/store/ngrx-data/language.service';\r\nimport { LanguageInstanceService } from '../../shared/store/ngrx-data/language-instance.service';\r\nimport { ValidationMessagesService } from '../../eav-material-controls/validators/validation-messages-service';\r\nimport { JsonItem1 } from '../../shared/models/json-format-v1';\r\nimport { EavConfig } from '../../shared/models/eav-configuration';\r\nimport { InputTypeService } from '../../shared/store/ngrx-data/input-type.service';\r\nimport { FeatureService } from '../../shared/store/ngrx-data/feature.service';\r\nimport { SnackBarUnsavedChangesComponent } from '../../eav-material-controls/dialogs/snack-bar-unsaved-changes/snack-bar-unsaved-changes.component';\r\nimport { SnackBarSaveErrorsComponent } from '../../eav-material-controls/dialogs/snack-bar-save-errors/snack-bar-save-errors.component';\r\nimport { FieldErrorMessage } from '../../shared/models/eav/field-error-message';\r\nimport { LoadIconsService } from '../../shared/services/load-icons.service';\r\nimport { sortLanguages, calculateIsParentDialog } from './multi-item-edit-form.helpers';\r\nimport { EditRoutingService } from '../../shared/services/edit-routing.service';\r\nimport { angularConsoleLog } from '../../../ng-dialogs/src/app/shared/helpers/angular-console-log.helper';\r\nimport { UnsavedChangesSnackData } from '../../eav-material-controls/dialogs/snack-bar-unsaved-changes/snack-bar-unsaved-changes.models';\r\nimport { SaveErrorsSnackData } from '../../eav-material-controls/dialogs/snack-bar-save-errors/snack-bar-save-errors.models';\r\nimport { PublishMode, PublishModeConstants } from './multi-item-edit-form.constants';\r\n\r\n@Component({\r\n  selector: 'app-multi-item-edit-form',\r\n  templateUrl: './multi-item-edit-form.component.html',\r\n  styleUrls: ['./multi-item-edit-form.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class MultiItemEditFormComponent implements OnInit, OnDestroy, AfterViewChecked {\r\n  @ViewChildren(ItemEditFormComponent) private itemEditFormRefs: QueryList<ItemEditFormComponent>;\r\n  @ViewChild('slideable') private slideableRef: ElementRef<HTMLDivElement>;\r\n\r\n  isParentDialog: boolean;\r\n  formId = Math.floor(Math.random() * 99999);\r\n  formsAreValid$ = new BehaviorSubject(false);\r\n  allControlsAreDisabled$ = new BehaviorSubject(true);\r\n  items$: Observable<Item[]>;\r\n\r\n  publishMode$ = new BehaviorSubject<PublishMode>('hide');\r\n  reduceSaveButton$ = new BehaviorSubject(false);\r\n  hideHeader$: Observable<boolean>;\r\n  debugEnabled$ = this.globalConfigurationService.getDebugEnabled().pipe(\r\n    tap(debugEnabled => {\r\n      if (this.debugInfoIsOpen$.value && !debugEnabled) {\r\n        this.debugInfoIsOpen$.next(false);\r\n      }\r\n    })\r\n  );\r\n  debugInfoIsOpen$ = new BehaviorSubject(false);\r\n  slide$: Observable<string>;\r\n\r\n  private formErrors: { [key: string]: string }[] = [];\r\n  private formsAreDirty: { [key: string]: boolean } = {};\r\n  private formSaveAllObservables$: Observable<Action>[] = [];\r\n  private eavConfig: EavConfig;\r\n  private createMode = false;\r\n  private formIsSaved = false;\r\n  private subscriptions: Subscription[] = [];\r\n\r\n  constructor(\r\n    private dialogRef: MatDialogRef<MultiItemEditFormComponent>,\r\n    private actions$: Actions,\r\n    private changeDetectorRef: ChangeDetectorRef,\r\n    private contentTypeService: ContentTypeService,\r\n    private globalConfigurationService: GlobalConfigurationService,\r\n    private eavService: EavService,\r\n    private featureService: FeatureService,\r\n    private inputTypeService: InputTypeService,\r\n    private itemService: ItemService,\r\n    private languageService: LanguageService,\r\n    private languageInstanceService: LanguageInstanceService,\r\n    private snackBar: MatSnackBar,\r\n    private translate: TranslateService,\r\n    private validationMessagesService: ValidationMessagesService,\r\n    private loadIconsService: LoadIconsService,\r\n    private route: ActivatedRoute,\r\n    private editRoutingService: EditRoutingService,\r\n  ) {\r\n    this.eavService.setEavConfig(this.route);\r\n    this.eavConfig = this.eavService.getEavConfig();\r\n    const isoLangCode = this.eavConfig.lang.split('-')[0];\r\n    this.translate.use(isoLangCode);\r\n\r\n    this.editRoutingService.init(this.route, this.formId);\r\n    this.loadIconsService.load();\r\n\r\n    // Load language data only for parent dialog to not overwrite languages when opening child dialogs\r\n    this.isParentDialog = calculateIsParentDialog(this.route);\r\n    if (this.isParentDialog) {\r\n      const sortedLanguages = sortLanguages(this.eavConfig.langpri, JSON.parse(this.eavConfig.langs));\r\n      this.languageService.loadLanguages(sortedLanguages);\r\n    }\r\n    this.languageInstanceService.addLanguageInstance(this.formId, this.eavConfig.lang, this.eavConfig.langpri, this.eavConfig.lang, false);\r\n  }\r\n\r\n  ngOnInit() {\r\n    setTimeout(() => { this.reduceSaveButton$.next(true); }, 5000);\r\n    this.fetchFormData();\r\n    this.languageChangeSubscribe();\r\n    this.dialogBackdropClickSubscribe();\r\n    this.saveFormMessagesSubscribe();\r\n    this.formSetValueChangeSubscribe();\r\n    this.checkFormsState();\r\n  }\r\n\r\n  ngAfterViewChecked() {\r\n    this.attachAllSaveFormObservables();\r\n    this.changeDetectorRef.detectChanges(); // 2020-06-19 SPM TODO: remove when form is stable. ATM a whole lot of stuff breaks without it\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.reduceSaveButton$.complete();\r\n    this.debugInfoIsOpen$.complete();\r\n    this.formsAreValid$.complete();\r\n    this.allControlsAreDisabled$.complete();\r\n    this.publishMode$.complete();\r\n    this.subscriptions.forEach(subscription => { subscription.unsubscribe(); });\r\n    this.languageInstanceService.removeLanguageInstance(this.formId);\r\n\r\n    if (this.isParentDialog) {\r\n      // clear the rest of the store\r\n      this.languageInstanceService.clearCache();\r\n      this.languageService.clearCache();\r\n      this.itemService.clearCache();\r\n      this.inputTypeService.clearCache();\r\n      this.featureService.clearCache();\r\n      this.contentTypeService.clearCache();\r\n    }\r\n  }\r\n\r\n  toggleDebugEnabled(event: MouseEvent) {\r\n    const CTRL_SHIFT_ALT_CLICK = (navigator.platform.match('Mac') ? event.metaKey : event.ctrlKey) && event.shiftKey && event.altKey;\r\n    if (CTRL_SHIFT_ALT_CLICK) {\r\n      this.globalConfigurationService.toggleDebugEnabled();\r\n    }\r\n  }\r\n\r\n  /** Close form dialog or if close is disabled show a message */\r\n  closeDialog(saveResult?: any) {\r\n    if (this.dialogRef.disableClose) {\r\n      this.snackBarYouHaveUnsavedChanges();\r\n    } else {\r\n      this.dialogRef.close(this.createMode ? saveResult : undefined);\r\n    }\r\n  }\r\n\r\n  setPublishMode(publishMode: PublishMode) {\r\n    // if publish mode is prohibited, revert to default\r\n    if (this.eavConfig.versioningOptions[publishMode] == null) {\r\n      publishMode = Object.keys(this.eavConfig.versioningOptions)[0] as PublishMode;\r\n    }\r\n    this.publishMode$.next(publishMode);\r\n  }\r\n\r\n  trackByFn(index: number, item: Item) {\r\n    return item.entity.id === 0 ? item.entity.guid : item.entity.id;\r\n  }\r\n\r\n  formValueChange() {\r\n    this.checkFormsState();\r\n    this.formErrors = [];\r\n  }\r\n\r\n  /** Save all forms */\r\n  saveAll(close: boolean) {\r\n    this.eavService.forceConnectorSave$.next();\r\n    // start gathering submit data with a timeout to let custom components which run outside Angular zone to save their values\r\n    setTimeout(() => {\r\n      if (this.formsAreValid$.value || this.allControlsAreDisabled$.value) {\r\n        this.itemEditFormRefs.forEach(itemEditFormComponent => {\r\n          itemEditFormComponent.form.submitOutside();\r\n        });\r\n        angularConsoleLog('saveAll', close);\r\n        this.snackBar.open(this.translate.instant('Message.Saving'), null, { duration: 2000 });\r\n        if (close) { this.formIsSaved = true; }\r\n      } else {\r\n        this.calculateAllValidationMessages();\r\n        const fieldErrors: FieldErrorMessage[] = [];\r\n        this.formErrors.forEach(formError => {\r\n          Object.keys(formError).forEach(key => {\r\n            fieldErrors.push({ field: key, message: formError[key] });\r\n          });\r\n        });\r\n        const data: SaveErrorsSnackData = {\r\n          fieldErrors,\r\n        };\r\n        this.snackBar.openFromComponent(SnackBarSaveErrorsComponent, {\r\n          data,\r\n          duration: 5000,\r\n        });\r\n      }\r\n    }, 100);\r\n  }\r\n\r\n  debugInfoOpened(opened: boolean) {\r\n    this.debugInfoIsOpen$.next(opened);\r\n  }\r\n\r\n  private fetchFormData() {\r\n    this.eavService.fetchFormData(this.eavConfig.items).subscribe(formData => {\r\n      this.itemService.loadItems(formData.Items);\r\n      // we assume that input type and content type data won't change between loading parent and child forms\r\n      this.inputTypeService.addInputTypes(formData.InputTypes);\r\n      this.contentTypeService.addContentTypes(formData.ContentTypes);\r\n      this.featureService.loadFeatures(formData.Features);\r\n\r\n      const publishMode: PublishMode = formData.DraftShouldBranch\r\n        ? PublishModeConstants.Branch\r\n        : formData.IsPublished ? PublishModeConstants.Show : PublishModeConstants.Hide;\r\n      this.setPublishMode(publishMode);\r\n\r\n      this.hideHeader$ = this.languageInstanceService.getHideHeader(this.formId);\r\n      this.slide$ = merge(\r\n        this.languageInstanceService.getCurrentLanguage(this.formId).pipe(\r\n          pairwise(),\r\n          map(combined => {\r\n            const previous = combined[0];\r\n            const current = combined[1];\r\n            let languages: Language[];\r\n            this.languageService.entities$.pipe(take(1)).subscribe(langs => {\r\n              languages = langs;\r\n            });\r\n            const previousLangIndex = languages.findIndex(l => l.key === previous);\r\n            const currentLangIndex = languages.findIndex(l => l.key === current);\r\n            const slide = (previousLangIndex > currentLangIndex) ? 'previous' : 'next';\r\n            return slide;\r\n          }),\r\n        ),\r\n        fromEvent(this.slideableRef.nativeElement, 'animationend').pipe(\r\n          filter((event: AnimationEvent) => event.animationName === 'move-next' || event.animationName === 'move-previous'),\r\n          map(() => ''),\r\n          delay(0), // small delay because animationend fires a bit too early\r\n        ),\r\n      );\r\n\r\n      // if current language !== default language check whether default language has value in all items\r\n      if (this.eavConfig.lang !== this.eavConfig.langpri) {\r\n        const valuesExistInDefaultLanguage = this.itemService.valuesExistInDefaultLanguage(\r\n          formData.Items.map(item => (item.Entity.Id === 0 ? item.Entity.Guid : item.Entity.Id)),\r\n          this.eavConfig.langpri,\r\n          this.inputTypeService,\r\n          this.contentTypeService,\r\n        );\r\n        if (!valuesExistInDefaultLanguage) {\r\n          this.languageInstanceService.updateCurrentLanguage(this.formId, this.eavConfig.langpri);\r\n          this.snackBar.open(\r\n            this.translate.instant('Message.SwitchedLanguageToDefault', { language: this.eavConfig.langpri }),\r\n            null,\r\n            { duration: 5000 },\r\n          );\r\n        }\r\n      }\r\n\r\n      this.items$ = this.itemService.selectItemsByIdList(\r\n        formData.Items.map(item => (item.Entity.Id === 0 ? item.Entity.Guid : item.Entity.Id))\r\n      );\r\n      this.items$.pipe(take(1)).subscribe(items => {\r\n        if (items?.length > 0 && items[0].entity.id === 0) {\r\n          this.createMode = true;\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  private languageChangeSubscribe() {\r\n    this.subscriptions.push(\r\n      this.languageInstanceService.getCurrentLanguage(this.formId).subscribe(language => {\r\n        this.formErrors = []; // on current language change reset form errors\r\n      }),\r\n    );\r\n  }\r\n\r\n  private dialogBackdropClickSubscribe() {\r\n    this.subscriptions.push(\r\n      fromEvent(window, 'beforeunload').subscribe((event: BeforeUnloadEvent) => {\r\n        if (!this.dialogRef.disableClose) { return; }\r\n        event.preventDefault();\r\n        event.returnValue = ''; // fix for Chrome\r\n        this.snackBarYouHaveUnsavedChanges();\r\n      })\r\n    );\r\n\r\n    this.dialogRef.backdropClick().subscribe(event => {\r\n      this.closeDialog();\r\n    });\r\n\r\n    this.dialogRef.keydownEvents().subscribe(event => {\r\n      const ESCAPE = event.keyCode === 27;\r\n      if (ESCAPE) {\r\n        this.closeDialog();\r\n        return;\r\n      }\r\n      const CTRL_S = (navigator.platform.match('Mac') ? event.metaKey : event.ctrlKey) && event.keyCode === 83;\r\n      if (CTRL_S) {\r\n        event.preventDefault();\r\n        this.saveAll(false);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Display form messages on form success or form error.\r\n   * Imortant: this is subscribed to an all open dialogs, a forms are distinguished by this.formIsSaved variable.\r\n   * TODO: need to distinguished form by forms data\r\n   */\r\n  private saveFormMessagesSubscribe() {\r\n    this.subscriptions.push(\r\n      this.actions$\r\n        .pipe(ofType(fromItems.SAVE_ITEM_ATTRIBUTES_VALUES_SUCCESS))\r\n        .subscribe((action: fromItems.SaveItemAttributesValuesSuccessAction) => {\r\n          this.itemService.updateItemId(action.data);\r\n          angularConsoleLog('success END: ', action.data);\r\n          this.snackBar.open(this.translate.instant('Message.Saved'), null, { duration: 2000 });\r\n          this.dialogRef.disableClose = false;\r\n          if (this.formIsSaved) {\r\n            this.closeDialog(action.data);\r\n          }\r\n        })\r\n    );\r\n    this.subscriptions.push(\r\n      this.actions$\r\n        .pipe(ofType(fromItems.SAVE_ITEM_ATTRIBUTES_VALUES_ERROR))\r\n        .subscribe((action: fromItems.SaveItemAttributesValuesErrorAction) => {\r\n          angularConsoleLog('error END', action.error);\r\n          this.snackBar.open('Error', null, { duration: 2000 });\r\n        })\r\n    );\r\n  }\r\n\r\n  private formSetValueChangeSubscribe() {\r\n    this.subscriptions.push(\r\n      this.eavService.formValueChange$.pipe(\r\n        filter(formSet => formSet.formId === this.formId)\r\n      ).subscribe(formSet => {\r\n        this.checkFormsState();\r\n      })\r\n    );\r\n  }\r\n\r\n  private checkFormsState() {\r\n    if (this.itemEditFormRefs?.length > 0 && this.itemEditFormRefs?.first.currentLanguage) {\r\n      let formsAreValid = true;\r\n      let allControlsAreDisabled = true;\r\n      this.formsAreDirty[this.itemEditFormRefs.first.currentLanguage] = false;\r\n\r\n      this.itemEditFormRefs.forEach(itemEditFormComponent => {\r\n        if (\r\n          itemEditFormComponent.form.form.invalid === true\r\n          && (!itemEditFormComponent.item.header.Group || itemEditFormComponent.item.header.Group.SlotCanBeEmpty === false)\r\n        ) {\r\n          formsAreValid = false;\r\n        }\r\n        if (itemEditFormComponent.form.form.dirty) {\r\n          this.formsAreDirty[itemEditFormComponent.currentLanguage] = true;\r\n        }\r\n        if (!itemEditFormComponent.checkAreAllControlsDisabled()) {\r\n          allControlsAreDisabled = false;\r\n        }\r\n      });\r\n\r\n      if (this.formsAreValid$.value !== formsAreValid) {\r\n        this.formsAreValid$.next(formsAreValid);\r\n      }\r\n\r\n      if (this.allControlsAreDisabled$.value !== allControlsAreDisabled) {\r\n        this.allControlsAreDisabled$.next(allControlsAreDisabled);\r\n      }\r\n    }\r\n    this.dialogRef.disableClose = this.areFormsDirtyAnyLanguage();\r\n  }\r\n\r\n  /** Determine is from is dirty on any language. If any form is dirty we need to ask to save */\r\n  private areFormsDirtyAnyLanguage() {\r\n    let isDirty = false;\r\n    const langKeys = Object.keys(this.formsAreDirty);\r\n    for (const langKey of langKeys) {\r\n      if (this.formsAreDirty[langKey] === true) {\r\n        isDirty = true;\r\n        break;\r\n      }\r\n    }\r\n    return isDirty;\r\n  }\r\n\r\n  /** Fill in all error validation messages from all forms */\r\n  private calculateAllValidationMessages() {\r\n    this.formErrors = [];\r\n    this.itemEditFormRefs?.forEach(itemEditFormComponent => {\r\n      if (!itemEditFormComponent.form.form.invalid) { return; }\r\n      this.formErrors.push(this.validationMessagesService.validateForm(itemEditFormComponent.form.form, false));\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Attach all save form observables from child itemEditFormComponent and\r\n   * subscribe to all observables with one subscribe (observable zip function).\r\n   * It also initially checks the status of the form (invalid, dirty ...)\r\n   */\r\n  private attachAllSaveFormObservables() {\r\n    if (this.formSaveAllObservables$.length === 0) {\r\n      this.itemEditFormRefs?.forEach(itemEditFormComponent => {\r\n        this.formSaveAllObservables$.push(itemEditFormComponent.formSaveObservable());\r\n      });\r\n\r\n      // only called once when a formSaveAllObservables array is filled\r\n      if (this.formSaveAllObservables$.length > 0) {\r\n        this.saveFormSubscribe();\r\n        this.checkFormsState();\r\n      }\r\n    }\r\n  }\r\n\r\n  /** With zip function look all forms submit observables and when all finish save all data */\r\n  private saveFormSubscribe() {\r\n    this.subscriptions.push(\r\n      zip(...this.formSaveAllObservables$)\r\n        .pipe(\r\n          switchMap((actions: fromItems.SaveItemAttributesValuesAction[]) => {\r\n            angularConsoleLog('ZIP ACTIONS ITEM: ', JsonItem1.create(actions[0].item));\r\n            const allItems: JsonItem1[] = [];\r\n            actions.forEach(action => {\r\n              const item = JsonItem1.create(action.item);\r\n              // do not try to save item which doesn't have any fields, nothing could have changed about it\r\n              if (Object.keys(item.Entity.Attributes).length > 0) {\r\n                allItems.push(item);\r\n              }\r\n            });\r\n            const body = {\r\n              Items: allItems,\r\n              IsPublished: this.publishMode$.value === PublishModeConstants.Show,\r\n              DraftShouldBranch: this.publishMode$.value === PublishModeConstants.Branch,\r\n            };\r\n            return this.eavService.saveFormData(this.eavConfig.partOfPage, JSON.stringify(body)).pipe(\r\n              map(data => {\r\n                this.eavService.saveItemSuccess(data);\r\n              }),\r\n              tap(data => angularConsoleLog('working'))\r\n            );\r\n          }),\r\n          catchError(err => of(this.eavService.saveItemError(err)))\r\n        )\r\n        .subscribe()\r\n    );\r\n  }\r\n\r\n  /** Open snackbar when snack bar not saved */\r\n  public snackBarYouHaveUnsavedChanges() {\r\n    const data: UnsavedChangesSnackData = {\r\n      save: false,\r\n    };\r\n    const snackBarRef = this.snackBar.openFromComponent(SnackBarUnsavedChangesComponent, {\r\n      data,\r\n      duration: 5000,\r\n    });\r\n\r\n    snackBarRef.onAction().subscribe(() => {\r\n      if (snackBarRef.containerInstance.snackBarConfig.data.save) {\r\n        this.saveAll(true);\r\n      } else {\r\n        this.dialogRef.disableClose = false;\r\n        this.closeDialog();\r\n      }\r\n    });\r\n  }\r\n\r\n}\r\n","import arrayPush from './_arrayPush.js';\nimport isArray from './isArray.js';\n\n/**\n * The base implementation of `getAllKeys` and `getAllKeysIn` which uses\n * `keysFunc` and `symbolsFunc` to get the enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @param {Function} symbolsFunc The function to get the symbols of `object`.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction baseGetAllKeys(object, keysFunc, symbolsFunc) {\n  var result = keysFunc(object);\n  return isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n}\n\nexport default baseGetAllKeys;\n","import root from './_root.js';\n\n/** Built-in value references. */\nvar Uint8Array = root.Uint8Array;\n\nexport default Uint8Array;\n","/**\n * A specialized version of `_.filter` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction arrayFilter(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (predicate(value, index, array)) {\n      result[resIndex++] = value;\n    }\n  }\n  return result;\n}\n\nexport default arrayFilter;\n","import arrayFilter from './_arrayFilter.js';\nimport stubArray from './stubArray.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols;\n\n/**\n * Creates an array of the own enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbols = !nativeGetSymbols ? stubArray : function(object) {\n  if (object == null) {\n    return [];\n  }\n  object = Object(object);\n  return arrayFilter(nativeGetSymbols(object), function(symbol) {\n    return propertyIsEnumerable.call(object, symbol);\n  });\n};\n\nexport default getSymbols;\n","/*! *****************************************************************************\nCopyright (C) Microsoft. All rights reserved.\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\nthis file except in compliance with the License. You may obtain a copy of the\nLicense at http://www.apache.org/licenses/LICENSE-2.0\n\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\nMERCHANTABLITY OR NON-INFRINGEMENT.\n\nSee the Apache Version 2.0 License for specific language governing permissions\nand limitations under the License.\n***************************************************************************** */\nvar Reflect;\n(function (Reflect) {\n    // Metadata Proposal\n    // https://rbuckton.github.io/reflect-metadata/\n    (function (factory) {\n        var root = typeof global === \"object\" ? global :\n            typeof self === \"object\" ? self :\n                typeof this === \"object\" ? this :\n                    Function(\"return this;\")();\n        var exporter = makeExporter(Reflect);\n        if (typeof root.Reflect === \"undefined\") {\n            root.Reflect = Reflect;\n        }\n        else {\n            exporter = makeExporter(root.Reflect, exporter);\n        }\n        factory(exporter);\n        function makeExporter(target, previous) {\n            return function (key, value) {\n                if (typeof target[key] !== \"function\") {\n                    Object.defineProperty(target, key, { configurable: true, writable: true, value: value });\n                }\n                if (previous)\n                    previous(key, value);\n            };\n        }\n    })(function (exporter) {\n        var hasOwn = Object.prototype.hasOwnProperty;\n        // feature test for Symbol support\n        var supportsSymbol = typeof Symbol === \"function\";\n        var toPrimitiveSymbol = supportsSymbol && typeof Symbol.toPrimitive !== \"undefined\" ? Symbol.toPrimitive : \"@@toPrimitive\";\n        var iteratorSymbol = supportsSymbol && typeof Symbol.iterator !== \"undefined\" ? Symbol.iterator : \"@@iterator\";\n        var supportsCreate = typeof Object.create === \"function\"; // feature test for Object.create support\n        var supportsProto = { __proto__: [] } instanceof Array; // feature test for __proto__ support\n        var downLevel = !supportsCreate && !supportsProto;\n        var HashMap = {\n            // create an object in dictionary mode (a.k.a. \"slow\" mode in v8)\n            create: supportsCreate\n                ? function () { return MakeDictionary(Object.create(null)); }\n                : supportsProto\n                    ? function () { return MakeDictionary({ __proto__: null }); }\n                    : function () { return MakeDictionary({}); },\n            has: downLevel\n                ? function (map, key) { return hasOwn.call(map, key); }\n                : function (map, key) { return key in map; },\n            get: downLevel\n                ? function (map, key) { return hasOwn.call(map, key) ? map[key] : undefined; }\n                : function (map, key) { return map[key]; },\n        };\n        // Load global or shim versions of Map, Set, and WeakMap\n        var functionPrototype = Object.getPrototypeOf(Function);\n        var usePolyfill = typeof process === \"object\" && process.env && process.env[\"REFLECT_METADATA_USE_MAP_POLYFILL\"] === \"true\";\n        var _Map = !usePolyfill && typeof Map === \"function\" && typeof Map.prototype.entries === \"function\" ? Map : CreateMapPolyfill();\n        var _Set = !usePolyfill && typeof Set === \"function\" && typeof Set.prototype.entries === \"function\" ? Set : CreateSetPolyfill();\n        var _WeakMap = !usePolyfill && typeof WeakMap === \"function\" ? WeakMap : CreateWeakMapPolyfill();\n        // [[Metadata]] internal slot\n        // https://rbuckton.github.io/reflect-metadata/#ordinary-object-internal-methods-and-internal-slots\n        var Metadata = new _WeakMap();\n        /**\n         * Applies a set of decorators to a property of a target object.\n         * @param decorators An array of decorators.\n         * @param target The target object.\n         * @param propertyKey (Optional) The property key to decorate.\n         * @param attributes (Optional) The property descriptor for the target key.\n         * @remarks Decorators are applied in reverse order.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     Example = Reflect.decorate(decoratorsArray, Example);\n         *\n         *     // property (on constructor)\n         *     Reflect.decorate(decoratorsArray, Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     Reflect.decorate(decoratorsArray, Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     Object.defineProperty(Example, \"staticMethod\",\n         *         Reflect.decorate(decoratorsArray, Example, \"staticMethod\",\n         *             Object.getOwnPropertyDescriptor(Example, \"staticMethod\")));\n         *\n         *     // method (on prototype)\n         *     Object.defineProperty(Example.prototype, \"method\",\n         *         Reflect.decorate(decoratorsArray, Example.prototype, \"method\",\n         *             Object.getOwnPropertyDescriptor(Example.prototype, \"method\")));\n         *\n         */\n        function decorate(decorators, target, propertyKey, attributes) {\n            if (!IsUndefined(propertyKey)) {\n                if (!IsArray(decorators))\n                    throw new TypeError();\n                if (!IsObject(target))\n                    throw new TypeError();\n                if (!IsObject(attributes) && !IsUndefined(attributes) && !IsNull(attributes))\n                    throw new TypeError();\n                if (IsNull(attributes))\n                    attributes = undefined;\n                propertyKey = ToPropertyKey(propertyKey);\n                return DecorateProperty(decorators, target, propertyKey, attributes);\n            }\n            else {\n                if (!IsArray(decorators))\n                    throw new TypeError();\n                if (!IsConstructor(target))\n                    throw new TypeError();\n                return DecorateConstructor(decorators, target);\n            }\n        }\n        exporter(\"decorate\", decorate);\n        // 4.1.2 Reflect.metadata(metadataKey, metadataValue)\n        // https://rbuckton.github.io/reflect-metadata/#reflect.metadata\n        /**\n         * A default metadata decorator factory that can be used on a class, class member, or parameter.\n         * @param metadataKey The key for the metadata entry.\n         * @param metadataValue The value for the metadata entry.\n         * @returns A decorator function.\n         * @remarks\n         * If `metadataKey` is already defined for the target and target key, the\n         * metadataValue for that key will be overwritten.\n         * @example\n         *\n         *     // constructor\n         *     @Reflect.metadata(key, value)\n         *     class Example {\n         *     }\n         *\n         *     // property (on constructor, TypeScript only)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         static staticProperty;\n         *     }\n         *\n         *     // property (on prototype, TypeScript only)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         property;\n         *     }\n         *\n         *     // method (on constructor)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         static staticMethod() { }\n         *     }\n         *\n         *     // method (on prototype)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         method() { }\n         *     }\n         *\n         */\n        function metadata(metadataKey, metadataValue) {\n            function decorator(target, propertyKey) {\n                if (!IsObject(target))\n                    throw new TypeError();\n                if (!IsUndefined(propertyKey) && !IsPropertyKey(propertyKey))\n                    throw new TypeError();\n                OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, propertyKey);\n            }\n            return decorator;\n        }\n        exporter(\"metadata\", metadata);\n        /**\n         * Define a unique metadata entry on the target.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param metadataValue A value that contains attached metadata.\n         * @param target The target object on which to define metadata.\n         * @param propertyKey (Optional) The property key for the target.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example);\n         *\n         *     // property (on constructor)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example.prototype, \"method\");\n         *\n         *     // decorator factory as metadata-producing annotation.\n         *     function MyAnnotation(options): Decorator {\n         *         return (target, key?) => Reflect.defineMetadata(\"custom:annotation\", options, target, key);\n         *     }\n         *\n         */\n        function defineMetadata(metadataKey, metadataValue, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, propertyKey);\n        }\n        exporter(\"defineMetadata\", defineMetadata);\n        /**\n         * Gets a value indicating whether the target object or its prototype chain has the provided metadata key defined.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns `true` if the metadata key was defined on the target object or its prototype chain; otherwise, `false`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function hasMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryHasMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"hasMetadata\", hasMetadata);\n        /**\n         * Gets a value indicating whether the target object has the provided metadata key defined.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns `true` if the metadata key was defined on the target object; otherwise, `false`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function hasOwnMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryHasOwnMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"hasOwnMetadata\", hasOwnMetadata);\n        /**\n         * Gets the metadata value for the provided metadata key on the target object or its prototype chain.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns The metadata value for the metadata key if found; otherwise, `undefined`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function getMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryGetMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"getMetadata\", getMetadata);\n        /**\n         * Gets the metadata value for the provided metadata key on the target object.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns The metadata value for the metadata key if found; otherwise, `undefined`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function getOwnMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryGetOwnMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"getOwnMetadata\", getOwnMetadata);\n        /**\n         * Gets the metadata keys defined on the target object or its prototype chain.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns An array of unique metadata keys.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getMetadataKeys(Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getMetadataKeys(Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getMetadataKeys(Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getMetadataKeys(Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getMetadataKeys(Example.prototype, \"method\");\n         *\n         */\n        function getMetadataKeys(target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryMetadataKeys(target, propertyKey);\n        }\n        exporter(\"getMetadataKeys\", getMetadataKeys);\n        /**\n         * Gets the unique metadata keys defined on the target object.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns An array of unique metadata keys.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getOwnMetadataKeys(Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getOwnMetadataKeys(Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getOwnMetadataKeys(Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getOwnMetadataKeys(Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getOwnMetadataKeys(Example.prototype, \"method\");\n         *\n         */\n        function getOwnMetadataKeys(target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryOwnMetadataKeys(target, propertyKey);\n        }\n        exporter(\"getOwnMetadataKeys\", getOwnMetadataKeys);\n        /**\n         * Deletes the metadata entry from the target object with the provided key.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns `true` if the metadata entry was found and deleted; otherwise, false.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function deleteMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            var metadataMap = GetOrCreateMetadataMap(target, propertyKey, /*Create*/ false);\n            if (IsUndefined(metadataMap))\n                return false;\n            if (!metadataMap.delete(metadataKey))\n                return false;\n            if (metadataMap.size > 0)\n                return true;\n            var targetMetadata = Metadata.get(target);\n            targetMetadata.delete(propertyKey);\n            if (targetMetadata.size > 0)\n                return true;\n            Metadata.delete(target);\n            return true;\n        }\n        exporter(\"deleteMetadata\", deleteMetadata);\n        function DecorateConstructor(decorators, target) {\n            for (var i = decorators.length - 1; i >= 0; --i) {\n                var decorator = decorators[i];\n                var decorated = decorator(target);\n                if (!IsUndefined(decorated) && !IsNull(decorated)) {\n                    if (!IsConstructor(decorated))\n                        throw new TypeError();\n                    target = decorated;\n                }\n            }\n            return target;\n        }\n        function DecorateProperty(decorators, target, propertyKey, descriptor) {\n            for (var i = decorators.length - 1; i >= 0; --i) {\n                var decorator = decorators[i];\n                var decorated = decorator(target, propertyKey, descriptor);\n                if (!IsUndefined(decorated) && !IsNull(decorated)) {\n                    if (!IsObject(decorated))\n                        throw new TypeError();\n                    descriptor = decorated;\n                }\n            }\n            return descriptor;\n        }\n        function GetOrCreateMetadataMap(O, P, Create) {\n            var targetMetadata = Metadata.get(O);\n            if (IsUndefined(targetMetadata)) {\n                if (!Create)\n                    return undefined;\n                targetMetadata = new _Map();\n                Metadata.set(O, targetMetadata);\n            }\n            var metadataMap = targetMetadata.get(P);\n            if (IsUndefined(metadataMap)) {\n                if (!Create)\n                    return undefined;\n                metadataMap = new _Map();\n                targetMetadata.set(P, metadataMap);\n            }\n            return metadataMap;\n        }\n        // 3.1.1.1 OrdinaryHasMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinaryhasmetadata\n        function OrdinaryHasMetadata(MetadataKey, O, P) {\n            var hasOwn = OrdinaryHasOwnMetadata(MetadataKey, O, P);\n            if (hasOwn)\n                return true;\n            var parent = OrdinaryGetPrototypeOf(O);\n            if (!IsNull(parent))\n                return OrdinaryHasMetadata(MetadataKey, parent, P);\n            return false;\n        }\n        // 3.1.2.1 OrdinaryHasOwnMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinaryhasownmetadata\n        function OrdinaryHasOwnMetadata(MetadataKey, O, P) {\n            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);\n            if (IsUndefined(metadataMap))\n                return false;\n            return ToBoolean(metadataMap.has(MetadataKey));\n        }\n        // 3.1.3.1 OrdinaryGetMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarygetmetadata\n        function OrdinaryGetMetadata(MetadataKey, O, P) {\n            var hasOwn = OrdinaryHasOwnMetadata(MetadataKey, O, P);\n            if (hasOwn)\n                return OrdinaryGetOwnMetadata(MetadataKey, O, P);\n            var parent = OrdinaryGetPrototypeOf(O);\n            if (!IsNull(parent))\n                return OrdinaryGetMetadata(MetadataKey, parent, P);\n            return undefined;\n        }\n        // 3.1.4.1 OrdinaryGetOwnMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarygetownmetadata\n        function OrdinaryGetOwnMetadata(MetadataKey, O, P) {\n            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);\n            if (IsUndefined(metadataMap))\n                return undefined;\n            return metadataMap.get(MetadataKey);\n        }\n        // 3.1.5.1 OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarydefineownmetadata\n        function OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P) {\n            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ true);\n            metadataMap.set(MetadataKey, MetadataValue);\n        }\n        // 3.1.6.1 OrdinaryMetadataKeys(O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarymetadatakeys\n        function OrdinaryMetadataKeys(O, P) {\n            var ownKeys = OrdinaryOwnMetadataKeys(O, P);\n            var parent = OrdinaryGetPrototypeOf(O);\n            if (parent === null)\n                return ownKeys;\n            var parentKeys = OrdinaryMetadataKeys(parent, P);\n            if (parentKeys.length <= 0)\n                return ownKeys;\n            if (ownKeys.length <= 0)\n                return parentKeys;\n            var set = new _Set();\n            var keys = [];\n            for (var _i = 0, ownKeys_1 = ownKeys; _i < ownKeys_1.length; _i++) {\n                var key = ownKeys_1[_i];\n                var hasKey = set.has(key);\n                if (!hasKey) {\n                    set.add(key);\n                    keys.push(key);\n                }\n            }\n            for (var _a = 0, parentKeys_1 = parentKeys; _a < parentKeys_1.length; _a++) {\n                var key = parentKeys_1[_a];\n                var hasKey = set.has(key);\n                if (!hasKey) {\n                    set.add(key);\n                    keys.push(key);\n                }\n            }\n            return keys;\n        }\n        // 3.1.7.1 OrdinaryOwnMetadataKeys(O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinaryownmetadatakeys\n        function OrdinaryOwnMetadataKeys(O, P) {\n            var keys = [];\n            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);\n            if (IsUndefined(metadataMap))\n                return keys;\n            var keysObj = metadataMap.keys();\n            var iterator = GetIterator(keysObj);\n            var k = 0;\n            while (true) {\n                var next = IteratorStep(iterator);\n                if (!next) {\n                    keys.length = k;\n                    return keys;\n                }\n                var nextValue = IteratorValue(next);\n                try {\n                    keys[k] = nextValue;\n                }\n                catch (e) {\n                    try {\n                        IteratorClose(iterator);\n                    }\n                    finally {\n                        throw e;\n                    }\n                }\n                k++;\n            }\n        }\n        // 6 ECMAScript Data Typ0es and Values\n        // https://tc39.github.io/ecma262/#sec-ecmascript-data-types-and-values\n        function Type(x) {\n            if (x === null)\n                return 1 /* Null */;\n            switch (typeof x) {\n                case \"undefined\": return 0 /* Undefined */;\n                case \"boolean\": return 2 /* Boolean */;\n                case \"string\": return 3 /* String */;\n                case \"symbol\": return 4 /* Symbol */;\n                case \"number\": return 5 /* Number */;\n                case \"object\": return x === null ? 1 /* Null */ : 6 /* Object */;\n                default: return 6 /* Object */;\n            }\n        }\n        // 6.1.1 The Undefined Type\n        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-undefined-type\n        function IsUndefined(x) {\n            return x === undefined;\n        }\n        // 6.1.2 The Null Type\n        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-null-type\n        function IsNull(x) {\n            return x === null;\n        }\n        // 6.1.5 The Symbol Type\n        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-symbol-type\n        function IsSymbol(x) {\n            return typeof x === \"symbol\";\n        }\n        // 6.1.7 The Object Type\n        // https://tc39.github.io/ecma262/#sec-object-type\n        function IsObject(x) {\n            return typeof x === \"object\" ? x !== null : typeof x === \"function\";\n        }\n        // 7.1 Type Conversion\n        // https://tc39.github.io/ecma262/#sec-type-conversion\n        // 7.1.1 ToPrimitive(input [, PreferredType])\n        // https://tc39.github.io/ecma262/#sec-toprimitive\n        function ToPrimitive(input, PreferredType) {\n            switch (Type(input)) {\n                case 0 /* Undefined */: return input;\n                case 1 /* Null */: return input;\n                case 2 /* Boolean */: return input;\n                case 3 /* String */: return input;\n                case 4 /* Symbol */: return input;\n                case 5 /* Number */: return input;\n            }\n            var hint = PreferredType === 3 /* String */ ? \"string\" : PreferredType === 5 /* Number */ ? \"number\" : \"default\";\n            var exoticToPrim = GetMethod(input, toPrimitiveSymbol);\n            if (exoticToPrim !== undefined) {\n                var result = exoticToPrim.call(input, hint);\n                if (IsObject(result))\n                    throw new TypeError();\n                return result;\n            }\n            return OrdinaryToPrimitive(input, hint === \"default\" ? \"number\" : hint);\n        }\n        // 7.1.1.1 OrdinaryToPrimitive(O, hint)\n        // https://tc39.github.io/ecma262/#sec-ordinarytoprimitive\n        function OrdinaryToPrimitive(O, hint) {\n            if (hint === \"string\") {\n                var toString_1 = O.toString;\n                if (IsCallable(toString_1)) {\n                    var result = toString_1.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n                var valueOf = O.valueOf;\n                if (IsCallable(valueOf)) {\n                    var result = valueOf.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n            }\n            else {\n                var valueOf = O.valueOf;\n                if (IsCallable(valueOf)) {\n                    var result = valueOf.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n                var toString_2 = O.toString;\n                if (IsCallable(toString_2)) {\n                    var result = toString_2.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n            }\n            throw new TypeError();\n        }\n        // 7.1.2 ToBoolean(argument)\n        // https://tc39.github.io/ecma262/2016/#sec-toboolean\n        function ToBoolean(argument) {\n            return !!argument;\n        }\n        // 7.1.12 ToString(argument)\n        // https://tc39.github.io/ecma262/#sec-tostring\n        function ToString(argument) {\n            return \"\" + argument;\n        }\n        // 7.1.14 ToPropertyKey(argument)\n        // https://tc39.github.io/ecma262/#sec-topropertykey\n        function ToPropertyKey(argument) {\n            var key = ToPrimitive(argument, 3 /* String */);\n            if (IsSymbol(key))\n                return key;\n            return ToString(key);\n        }\n        // 7.2 Testing and Comparison Operations\n        // https://tc39.github.io/ecma262/#sec-testing-and-comparison-operations\n        // 7.2.2 IsArray(argument)\n        // https://tc39.github.io/ecma262/#sec-isarray\n        function IsArray(argument) {\n            return Array.isArray\n                ? Array.isArray(argument)\n                : argument instanceof Object\n                    ? argument instanceof Array\n                    : Object.prototype.toString.call(argument) === \"[object Array]\";\n        }\n        // 7.2.3 IsCallable(argument)\n        // https://tc39.github.io/ecma262/#sec-iscallable\n        function IsCallable(argument) {\n            // NOTE: This is an approximation as we cannot check for [[Call]] internal method.\n            return typeof argument === \"function\";\n        }\n        // 7.2.4 IsConstructor(argument)\n        // https://tc39.github.io/ecma262/#sec-isconstructor\n        function IsConstructor(argument) {\n            // NOTE: This is an approximation as we cannot check for [[Construct]] internal method.\n            return typeof argument === \"function\";\n        }\n        // 7.2.7 IsPropertyKey(argument)\n        // https://tc39.github.io/ecma262/#sec-ispropertykey\n        function IsPropertyKey(argument) {\n            switch (Type(argument)) {\n                case 3 /* String */: return true;\n                case 4 /* Symbol */: return true;\n                default: return false;\n            }\n        }\n        // 7.3 Operations on Objects\n        // https://tc39.github.io/ecma262/#sec-operations-on-objects\n        // 7.3.9 GetMethod(V, P)\n        // https://tc39.github.io/ecma262/#sec-getmethod\n        function GetMethod(V, P) {\n            var func = V[P];\n            if (func === undefined || func === null)\n                return undefined;\n            if (!IsCallable(func))\n                throw new TypeError();\n            return func;\n        }\n        // 7.4 Operations on Iterator Objects\n        // https://tc39.github.io/ecma262/#sec-operations-on-iterator-objects\n        function GetIterator(obj) {\n            var method = GetMethod(obj, iteratorSymbol);\n            if (!IsCallable(method))\n                throw new TypeError(); // from Call\n            var iterator = method.call(obj);\n            if (!IsObject(iterator))\n                throw new TypeError();\n            return iterator;\n        }\n        // 7.4.4 IteratorValue(iterResult)\n        // https://tc39.github.io/ecma262/2016/#sec-iteratorvalue\n        function IteratorValue(iterResult) {\n            return iterResult.value;\n        }\n        // 7.4.5 IteratorStep(iterator)\n        // https://tc39.github.io/ecma262/#sec-iteratorstep\n        function IteratorStep(iterator) {\n            var result = iterator.next();\n            return result.done ? false : result;\n        }\n        // 7.4.6 IteratorClose(iterator, completion)\n        // https://tc39.github.io/ecma262/#sec-iteratorclose\n        function IteratorClose(iterator) {\n            var f = iterator[\"return\"];\n            if (f)\n                f.call(iterator);\n        }\n        // 9.1 Ordinary Object Internal Methods and Internal Slots\n        // https://tc39.github.io/ecma262/#sec-ordinary-object-internal-methods-and-internal-slots\n        // 9.1.1.1 OrdinaryGetPrototypeOf(O)\n        // https://tc39.github.io/ecma262/#sec-ordinarygetprototypeof\n        function OrdinaryGetPrototypeOf(O) {\n            var proto = Object.getPrototypeOf(O);\n            if (typeof O !== \"function\" || O === functionPrototype)\n                return proto;\n            // TypeScript doesn't set __proto__ in ES5, as it's non-standard.\n            // Try to determine the superclass constructor. Compatible implementations\n            // must either set __proto__ on a subclass constructor to the superclass constructor,\n            // or ensure each class has a valid `constructor` property on its prototype that\n            // points back to the constructor.\n            // If this is not the same as Function.[[Prototype]], then this is definately inherited.\n            // This is the case when in ES6 or when using __proto__ in a compatible browser.\n            if (proto !== functionPrototype)\n                return proto;\n            // If the super prototype is Object.prototype, null, or undefined, then we cannot determine the heritage.\n            var prototype = O.prototype;\n            var prototypeProto = prototype && Object.getPrototypeOf(prototype);\n            if (prototypeProto == null || prototypeProto === Object.prototype)\n                return proto;\n            // If the constructor was not a function, then we cannot determine the heritage.\n            var constructor = prototypeProto.constructor;\n            if (typeof constructor !== \"function\")\n                return proto;\n            // If we have some kind of self-reference, then we cannot determine the heritage.\n            if (constructor === O)\n                return proto;\n            // we have a pretty good guess at the heritage.\n            return constructor;\n        }\n        // naive Map shim\n        function CreateMapPolyfill() {\n            var cacheSentinel = {};\n            var arraySentinel = [];\n            var MapIterator = /** @class */ (function () {\n                function MapIterator(keys, values, selector) {\n                    this._index = 0;\n                    this._keys = keys;\n                    this._values = values;\n                    this._selector = selector;\n                }\n                MapIterator.prototype[\"@@iterator\"] = function () { return this; };\n                MapIterator.prototype[iteratorSymbol] = function () { return this; };\n                MapIterator.prototype.next = function () {\n                    var index = this._index;\n                    if (index >= 0 && index < this._keys.length) {\n                        var result = this._selector(this._keys[index], this._values[index]);\n                        if (index + 1 >= this._keys.length) {\n                            this._index = -1;\n                            this._keys = arraySentinel;\n                            this._values = arraySentinel;\n                        }\n                        else {\n                            this._index++;\n                        }\n                        return { value: result, done: false };\n                    }\n                    return { value: undefined, done: true };\n                };\n                MapIterator.prototype.throw = function (error) {\n                    if (this._index >= 0) {\n                        this._index = -1;\n                        this._keys = arraySentinel;\n                        this._values = arraySentinel;\n                    }\n                    throw error;\n                };\n                MapIterator.prototype.return = function (value) {\n                    if (this._index >= 0) {\n                        this._index = -1;\n                        this._keys = arraySentinel;\n                        this._values = arraySentinel;\n                    }\n                    return { value: value, done: true };\n                };\n                return MapIterator;\n            }());\n            return /** @class */ (function () {\n                function Map() {\n                    this._keys = [];\n                    this._values = [];\n                    this._cacheKey = cacheSentinel;\n                    this._cacheIndex = -2;\n                }\n                Object.defineProperty(Map.prototype, \"size\", {\n                    get: function () { return this._keys.length; },\n                    enumerable: true,\n                    configurable: true\n                });\n                Map.prototype.has = function (key) { return this._find(key, /*insert*/ false) >= 0; };\n                Map.prototype.get = function (key) {\n                    var index = this._find(key, /*insert*/ false);\n                    return index >= 0 ? this._values[index] : undefined;\n                };\n                Map.prototype.set = function (key, value) {\n                    var index = this._find(key, /*insert*/ true);\n                    this._values[index] = value;\n                    return this;\n                };\n                Map.prototype.delete = function (key) {\n                    var index = this._find(key, /*insert*/ false);\n                    if (index >= 0) {\n                        var size = this._keys.length;\n                        for (var i = index + 1; i < size; i++) {\n                            this._keys[i - 1] = this._keys[i];\n                            this._values[i - 1] = this._values[i];\n                        }\n                        this._keys.length--;\n                        this._values.length--;\n                        if (key === this._cacheKey) {\n                            this._cacheKey = cacheSentinel;\n                            this._cacheIndex = -2;\n                        }\n                        return true;\n                    }\n                    return false;\n                };\n                Map.prototype.clear = function () {\n                    this._keys.length = 0;\n                    this._values.length = 0;\n                    this._cacheKey = cacheSentinel;\n                    this._cacheIndex = -2;\n                };\n                Map.prototype.keys = function () { return new MapIterator(this._keys, this._values, getKey); };\n                Map.prototype.values = function () { return new MapIterator(this._keys, this._values, getValue); };\n                Map.prototype.entries = function () { return new MapIterator(this._keys, this._values, getEntry); };\n                Map.prototype[\"@@iterator\"] = function () { return this.entries(); };\n                Map.prototype[iteratorSymbol] = function () { return this.entries(); };\n                Map.prototype._find = function (key, insert) {\n                    if (this._cacheKey !== key) {\n                        this._cacheIndex = this._keys.indexOf(this._cacheKey = key);\n                    }\n                    if (this._cacheIndex < 0 && insert) {\n                        this._cacheIndex = this._keys.length;\n                        this._keys.push(key);\n                        this._values.push(undefined);\n                    }\n                    return this._cacheIndex;\n                };\n                return Map;\n            }());\n            function getKey(key, _) {\n                return key;\n            }\n            function getValue(_, value) {\n                return value;\n            }\n            function getEntry(key, value) {\n                return [key, value];\n            }\n        }\n        // naive Set shim\n        function CreateSetPolyfill() {\n            return /** @class */ (function () {\n                function Set() {\n                    this._map = new _Map();\n                }\n                Object.defineProperty(Set.prototype, \"size\", {\n                    get: function () { return this._map.size; },\n                    enumerable: true,\n                    configurable: true\n                });\n                Set.prototype.has = function (value) { return this._map.has(value); };\n                Set.prototype.add = function (value) { return this._map.set(value, value), this; };\n                Set.prototype.delete = function (value) { return this._map.delete(value); };\n                Set.prototype.clear = function () { this._map.clear(); };\n                Set.prototype.keys = function () { return this._map.keys(); };\n                Set.prototype.values = function () { return this._map.values(); };\n                Set.prototype.entries = function () { return this._map.entries(); };\n                Set.prototype[\"@@iterator\"] = function () { return this.keys(); };\n                Set.prototype[iteratorSymbol] = function () { return this.keys(); };\n                return Set;\n            }());\n        }\n        // naive WeakMap shim\n        function CreateWeakMapPolyfill() {\n            var UUID_SIZE = 16;\n            var keys = HashMap.create();\n            var rootKey = CreateUniqueKey();\n            return /** @class */ (function () {\n                function WeakMap() {\n                    this._key = CreateUniqueKey();\n                }\n                WeakMap.prototype.has = function (target) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);\n                    return table !== undefined ? HashMap.has(table, this._key) : false;\n                };\n                WeakMap.prototype.get = function (target) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);\n                    return table !== undefined ? HashMap.get(table, this._key) : undefined;\n                };\n                WeakMap.prototype.set = function (target, value) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ true);\n                    table[this._key] = value;\n                    return this;\n                };\n                WeakMap.prototype.delete = function (target) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);\n                    return table !== undefined ? delete table[this._key] : false;\n                };\n                WeakMap.prototype.clear = function () {\n                    // NOTE: not a real clear, just makes the previous data unreachable\n                    this._key = CreateUniqueKey();\n                };\n                return WeakMap;\n            }());\n            function CreateUniqueKey() {\n                var key;\n                do\n                    key = \"@@WeakMap@@\" + CreateUUID();\n                while (HashMap.has(keys, key));\n                keys[key] = true;\n                return key;\n            }\n            function GetOrCreateWeakMapTable(target, create) {\n                if (!hasOwn.call(target, rootKey)) {\n                    if (!create)\n                        return undefined;\n                    Object.defineProperty(target, rootKey, { value: HashMap.create() });\n                }\n                return target[rootKey];\n            }\n            function FillRandomBytes(buffer, size) {\n                for (var i = 0; i < size; ++i)\n                    buffer[i] = Math.random() * 0xff | 0;\n                return buffer;\n            }\n            function GenRandomBytes(size) {\n                if (typeof Uint8Array === \"function\") {\n                    if (typeof crypto !== \"undefined\")\n                        return crypto.getRandomValues(new Uint8Array(size));\n                    if (typeof msCrypto !== \"undefined\")\n                        return msCrypto.getRandomValues(new Uint8Array(size));\n                    return FillRandomBytes(new Uint8Array(size), size);\n                }\n                return FillRandomBytes(new Array(size), size);\n            }\n            function CreateUUID() {\n                var data = GenRandomBytes(UUID_SIZE);\n                // mark as random - RFC 4122  4.4\n                data[6] = data[6] & 0x4f | 0x40;\n                data[8] = data[8] & 0xbf | 0x80;\n                var result = \"\";\n                for (var offset = 0; offset < UUID_SIZE; ++offset) {\n                    var byte = data[offset];\n                    if (offset === 4 || offset === 6 || offset === 8)\n                        result += \"-\";\n                    if (byte < 16)\n                        result += \"0\";\n                    result += byte.toString(16).toLowerCase();\n                }\n                return result;\n            }\n        }\n        // uses a heuristic used by v8 and chakra to force an object into dictionary mode.\n        function MakeDictionary(obj) {\n            obj.__ = undefined;\n            delete obj.__;\n            return obj;\n        }\n    });\n})(Reflect || (Reflect = {}));\n"],"sourceRoot":"webpack:///"}