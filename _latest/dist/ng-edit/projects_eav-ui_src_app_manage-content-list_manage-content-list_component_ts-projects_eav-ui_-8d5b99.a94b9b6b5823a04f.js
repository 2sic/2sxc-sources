"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_manage-content-list_manage-content-list_component_ts-projects_eav-ui_-8d5b99"],{5026:(b,l,o)=>{o.r(l),o.d(l,{ManageContentListComponent:()=>K});var c=o(6571),m=o(2275),t=o(9148),r=o(4175),h=o(7941),g=o(3840),u=o(2159),C=o(852),v=o(2938),P=o(3620),D=o(4699),L=o(1459),O=o(4601),M=o(3216),p=o(334),T=o(8471),f=o(7993),R=o(9669),k=o(3347);const B=(s,d)=>d.Index+"+"+d.Id;function j(s,d){if(1&s){const n=t.RV6();t.j41(0,"span"),t.EFF(1),t.k0s(),t.j41(2,"button",13),t.bIt("click",function(){t.eBV(n);const i=t.XpG(3);return t.Njj(i.editHeader())}),t.j41(3,"mat-icon"),t.EFF(4,"edit"),t.k0s()()}if(2&s){const n=t.XpG(3);t.R7$(),t.JRh(n.header()().Title)}}function F(s,d){1&s&&(t.EFF(0),t.nI1(1,"translate")),2&s&&t.SpI(" ",t.bMT(1,1,"ManageContentList.NoHeader")," ")}function y(s,d){if(1&s&&(t.j41(0,"p"),t.EFF(1),t.nI1(2,"translate"),t.k0s(),t.j41(3,"p"),t.DNE(4,j,5,1)(5,F,2,3),t.k0s()),2&s){const n=t.XpG(2);t.R7$(),t.SpI(" ",t.bMT(2,2,"ManageContentList.Description")," "),t.R7$(3),t.vxM(n.header()().Type?4:5)}}function U(s,d){if(1&s&&(t.j41(0,"p",5),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&s){let n;const e=t.XpG(2);t.R7$(),t.SpI(" ",t.bMT(2,1,"ManageContentList."+(e.reordered()?"ListHasBeenReordered":(null==(n=e.items())?null:n.length)<25?"SortItems":"SortLotsOfItems"))," ")}}function $(s,d){if(1&s){const n=t.RV6();t.j41(0,"div",7)(1,"div",14)(2,"mat-icon",15),t.EFF(3,"drag_handle"),t.k0s(),t.j41(4,"span",16),t.EFF(5),t.k0s()(),t.j41(6,"div")(7,"button",17),t.bIt("click",function(){const i=t.eBV(n).$implicit,a=t.XpG(2);return t.Njj(a.addFromExisting(i.Index))}),t.j41(8,"mat-icon"),t.EFF(9,"playlist_add"),t.k0s()(),t.j41(10,"button",18),t.bIt("click",function(){const i=t.eBV(n).$implicit,a=t.XpG(2);return t.Njj(a.addBelow(i.Index))}),t.j41(11,"mat-icon"),t.EFF(12,"add"),t.k0s()(),t.j41(13,"button",19),t.bIt("click",function(){const i=t.eBV(n).$implicit,a=t.XpG(2);return t.Njj(a.remove(i))}),t.j41(14,"mat-icon"),t.EFF(15,"remove"),t.k0s()(),t.j41(16,"button",20),t.bIt("click",function(){const i=t.eBV(n).$implicit,a=t.XpG(2);return t.Njj(a.editItem(i.Id))}),t.j41(17,"mat-icon"),t.EFF(18,"edit"),t.k0s()()()()}if(2&s){const n=d.$implicit,e=t.XpG(2);t.R7$(4),t.FCK("tippy","",n.Title," (",n.Id,")"),t.R7$(),t.Lme(" ",n.Title," (",n.Id,") "),t.R7$(2),t.Y8G("disabled",0===n.Id),t.R7$(3),t.Y8G("disabled",0===n.Id||e.reordered()),t.R7$(3),t.Y8G("disabled",e.reordered()),t.R7$(3),t.Y8G("disabled",0===n.Id)}}function A(s,d){if(1&s){const n=t.RV6();t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.EFF(3),t.nI1(4,"translate"),t.k0s()(),t.j41(5,"div",3),t.nrm(6,"router-outlet"),t.j41(7,"div",4),t.DNE(8,y,6,4)(9,U,3,3,"p",5),t.j41(10,"div",6),t.bIt("cdkDropListDropped",function(i){t.eBV(n);const a=t.XpG();return t.Njj(a.drop(i))}),t.Z7z(11,$,19,9,"div",7,B),t.k0s()()(),t.j41(13,"mat-dialog-actions",8)(14,"button",9),t.bIt("click",function(){t.eBV(n);const i=t.XpG();return t.Njj(i.closeDialog())}),t.EFF(15),t.nI1(16,"translate"),t.k0s(),t.j41(17,"button",10),t.bIt("click",function(){t.eBV(n);const i=t.XpG();return t.Njj(i.saveList())}),t.EFF(18),t.nI1(19,"translate"),t.k0s(),t.j41(20,"button",11),t.bIt("click",function(){t.eBV(n);const i=t.XpG();return t.Njj(i.saveAndCloseList())}),t.j41(21,"mat-icon",12),t.EFF(22,"done"),t.k0s()()()()}if(2&s){const n=t.XpG();t.R7$(3),t.JRh(t.bMT(4,5,"ManageContentList.Title")),t.R7$(5),t.vxM(n.header()()?8:-1),t.R7$(),t.vxM(n.items()?9:-1),t.R7$(2),t.Dyx(n.items()),t.R7$(4),t.JRh(t.bMT(16,7,"General.Buttons.Cancel")),t.R7$(3),t.JRh(t.bMT(19,9,"General.Buttons.Save"))}}let K=(()=>{class s{#n;#e;#o;constructor(n,e,i){this.dialog=n,this.snackBar=e,this.translate=i,this.hostClass="dialog-component",this.#n=(0,v.d)(T.c),this.#e=(0,v.d)(R.y),this.#o=(0,v.d)(D.L),this.items=(0,f.KX)("items",null),this.#t=(0,P.C)(this.#n.getParams(["guid","part","index"]),a=>({id:null,guid:a.guid,part:a.part,index:parseInt(a.index,10)})),this.refresh=(0,t.vPA)(0),this.header=(0,t.EWP)(()=>(this.refresh(),this.#e.getHeader(this.#t,void 0))),this.reordered=(0,f.KX)("reordered",!1)}#t;ngOnInit(){this.#i(),this.#a(),this.#n.doOnDialogClosed(()=>{this.#i(!0),this.#s()})}#a(){this.#o.getCurrent$().subscribe(n=>{this.translate.setDefaultLang(n.Context.Language.Primary.split("-")[0]),this.translate.use(n.Context.Language.Current.split("-")[0])})}closeDialog(){this.dialog.close()}saveList(){this.snackBar.open("Saving..."),this.#e.saveList(this.#t,this.items()).subscribe(()=>{this.snackBar.open("Saved",null,{duration:2e3}),this.#i(),this.#s()})}saveAndCloseList(){this.snackBar.open("Saving..."),this.#e.saveList(this.#t,this.items()).subscribe(()=>{this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()})}editHeader(){const n={items:[p.c.relationship(this.#t.guid,"listcontent",0,0===this.header()().Id),p.c.relationship(this.#t.guid,"listpresentation",0,0===this.header()().Id)]},e=(0,M.s)(n);this.#n.navRelative([`edit/${e}`])}editItem(n){const e={items:[p.c.editId(n)]},i=(0,M.s)(e);this.#n.navRelative([`edit/${i}`])}addFromExisting(n){this.#n.navRelative([`${this.#t.guid}/${this.#t.part}/${n+1}/replace`],{queryParams:{add:!0}})}addBelow(n){const e={items:[p.c.relationship(this.#t.guid,this.#t.part,n+1,!0)]},i=(0,M.s)(e);this.#n.navRelative([`edit/${i}`])}remove(n){confirm(this.translate.instant("ManageContentList.ConfirmRemove"))&&(this.snackBar.open("Removing..."),this.#e.removeItem(this.#t,n.Index).subscribe(()=>{this.snackBar.open("Removed",null,{duration:2e3}),this.#i()}))}drop(n){const e=[...this.items()];(0,c.HD)(e,n.previousIndex,n.currentIndex),this.items.set(e),this.reordered.set(!0)}#i(n=!1){this.#e.getList(this.#t).subscribe(e=>{if(this.reordered()){const i=this.items().map(_=>_.Id);if(this.items().length===e.length&&!e.some(_=>!i.includes(_.Id))&&n){const _=this.items().map(E=>E.Index);e.sort((E,G)=>{const x=_.indexOf(E.Index),I=_.indexOf(G.Index);return-1===x||-1===I?0:x-I})}else n&&this.snackBar.open("List was changed from somewhere else. Order of items is reset",null,{duration:5e3})}this.items.set(e),this.reordered.set(!1)})}#s(){this.refresh.set(this.refresh()+1)}static{this.\u0275fac=function(e){return new(e||s)(t.rXU(h.CP),t.rXU(k.UG),t.rXU(C.c$))}}static{this.\u0275cmp=t.VBU({type:s,selectors:[["app-manage-content-list"]],hostVars:1,hostBindings:function(e,i){2&e&&t.Mr5("className",i.hostClass)},standalone:!0,features:[t.aNF],decls:1,vars:1,consts:[[1,"eav-dialog","eav-no-scrollbar"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],["cdkScrollable","",1,"dialog-component-content","fancy-scrollbar-light"],[1,"eav-sort-title"],["cdkDropList","",1,"eav-dnd-list",3,"cdkDropListDropped"],["cdkDrag","",1,"eav-dnd-item"],["align","end"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"click"],["mat-raised-button","","color","accent","tippyTranslate","Form.Buttons.SaveAndClose",3,"click"],[1,"eav-raised-button-icon"],["mat-icon-button","","tippy","Edit header",3,"click"],[1,"eav-dnd-item__title"],["tippy","Drag to reorder the list",1,"eav-dnd-item__title-icon"],[1,"eav-dnd-item__title-text",3,"tippy"],["mat-icon-button","","tippyTranslate","Fields.Picker.AddExistingItem","appMousedownStopPropagation","",3,"click","disabled"],["mat-icon-button","","tippyTranslate","Fields.Picker.AddItemBelow","appMousedownStopPropagation","",3,"click","disabled"],["mat-icon-button","","tippyTranslate","Fields.Picker.Remove","appMousedownStopPropagation","",3,"click","disabled"],["mat-icon-button","","tippyTranslate","Fields.Picker.Edit","appMousedownStopPropagation","",3,"click","disabled"]],template:function(e,i){1&e&&t.DNE(0,A,23,11,"div",0),2&e&&t.vxM(i.header()&&i.items()?0:-1)},dependencies:[u.n3,m.uv,r.Hl,r.$z,r.iY,g.m_,g.An,c.O7,c.T1,h.E7,C.h,C.D9,h.hM,O.e,L.z],styles:[".eav-sort-title[_ngcontent-%COMP%]{padding-top:16px}.eav-dnd-list[_ngcontent-%COMP%]{margin:16px 0;border:1px solid #ccc;border-radius:4px;overflow:hidden}.eav-dnd-item[_ngcontent-%COMP%]{cursor:move;height:40px;border-bottom:1px solid #ccc;padding:0 8px;display:flex;align-items:center;justify-content:space-between;background:#fff;box-sizing:border-box;font-size:14px}.eav-dnd-item[_ngcontent-%COMP%]:last-child{border:none}.eav-dnd-item__title[_ngcontent-%COMP%]{display:flex;align-items:center;overflow:hidden;max-width:80%}.eav-dnd-item__title-icon[_ngcontent-%COMP%]{margin-right:8px;opacity:.4}.eav-dnd-item__title-text[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.dnd-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .dnd-item[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}"]})}}return s})()},4979:(b,l,o)=>{o.d(l,{V:()=>t});var c=o(7092),m=o(9148);let t=(()=>{class r{constructor(){this.subscriptions=new c.yU}ngOnDestroy(){this.destroy()}destroy(){this.subscriptions.unsubscribe()}static{this.\u0275fac=function(u){return new(u||r)}}static{this.\u0275prov=m.jDH({token:r,factory:r.\u0275fac})}}return r})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/18.05.01/dist/ng-edit/projects_eav-ui_src_app_manage-content-list_manage-content-list_component_ts-projects_eav-ui_-8d5b99.a94b9b6b5823a04f.js.map