"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_apps-management_licence-info_license-info_component_ts"],{1191:(I,F,s)=>{s.d(F,{O:()=>D});var e=s(9148),C=s(4175),g=s(3777),h=s(7941),t=s(3840),x=s(852),_=s(2938),m=s(9914),R=s(5081),M=s(7993);function E(c,O){if(1&c&&(e.j41(0,"div",1)(1,"div",2),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"div",3)(5,"span"),e.EFF(6),e.nI1(7,"translate"),e.k0s()()()),2&c){const l=e.XpG(2);e.R7$(2),e.SpI("",e.bMT(3,2,"Features.Status"),":"),e.R7$(4),e.JRh(e.bMT(7,4,l.feature().isEnabled?"Features.Active":"Features.NotActive"))}}function T(c,O){if(1&c){const l=e.RV6();e.j41(0,"div",1)(1,"div",2),e.EFF(2,"GUID:"),e.k0s(),e.j41(3,"div",8)(4,"span",4),e.bIt("click",function(){e.eBV(l);const v=e.XpG(2);return e.Njj(v.clipboard.copyToClipboard(v.feature().guid))}),e.EFF(5),e.k0s()()()}if(2&c){const l=e.XpG(2);e.R7$(5),e.JRh(l.feature().guid)}}function r(c,O){if(1&c){const l=e.RV6();e.j41(0,"button",9),e.bIt("click",function(){e.eBV(l);const v=e.XpG(2);return e.Njj(v.dialog.close())}),e.EFF(1,"Close"),e.k0s()}}function d(c,O){if(1&c){const l=e.RV6();e.j41(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),e.EFF(3),e.k0s()(),e.j41(4,"mat-card-content"),e.nrm(5,"p",0),e.nI1(6,"safeHtml"),e.j41(7,"div",1)(8,"div",2),e.EFF(9,"ID:"),e.k0s(),e.j41(10,"div",3)(11,"span",4),e.bIt("click",function(){e.eBV(l);const v=e.XpG();return e.Njj(v.clipboard.copyToClipboard(v.feature().nameId))}),e.EFF(12),e.k0s()()(),e.DNE(13,E,8,6,"div",1)(14,T,6,1,"div",1),e.j41(15,"div",1)(16,"div",2),e.EFF(17,"Security Rating:"),e.k0s(),e.j41(18,"div",3)(19,"span"),e.EFF(20),e.k0s()()()(),e.j41(21,"mat-card-actions",5)(22,"a",6)(23,"mat-icon"),e.EFF(24,"open_in_new"),e.k0s(),e.EFF(25," Find out more "),e.k0s(),e.DNE(26,r,2,0,"button",7),e.k0s()()}if(2&c){const l=e.XpG();e.R7$(3),e.JRh(l.feature().name),e.R7$(2),e.Y8G("innerHtml",e.bMT(6,8,l.feature().description),e.npT),e.R7$(7),e.JRh(l.feature().nameId),e.R7$(),e.vxM(l.mySpecs().showStatus?13:-1),e.R7$(),e.vxM(l.mySpecs().showGuid?14:-1),e.R7$(6),e.JRh(l.feature().security.Impact+": "+l.feature().security.Message),e.R7$(2),e.Y8G("href",l.feature().link,e.B4B),e.R7$(4),e.vxM(0!=l.mySpecs().showClose?26:-1)}}let D=(()=>{class c{constructor(l,f){this.dialogSpecs=l,this.dialog=f,this.specs=(0,e.hFB)(),this.mySpecs=(0,M.bo)("mySpecs",()=>this.specs()??this.dialogSpecs),this.feature=(0,M.bo)("feature",()=>this.mySpecs()?.feature),this.clipboard=(0,_.d)(R.W)}static{this.\u0275fac=function(f){return new(f||c)(e.rXU(h.Vh,8),e.rXU(h.CP))}}static{this.\u0275cmp=e.VBU({type:c,selectors:[["app-feature-details-dialog"]],inputs:{specs:[1,"specs"]},standalone:!0,features:[e.aNF],decls:1,vars:1,consts:[[3,"innerHtml"],[1,"eav-info-row"],[1,"eav-info-row__label"],[1,"eav-info-row__value"],[3,"click"],["align","end"],["target","_blank","mat-raised-button","","color","accent",1,"eav-card-action-button",3,"href"],["mat-raised-button","",1,"eav-card-action-button"],[1,"eav-info-row__value","eav_click"],["mat-raised-button","",1,"eav-card-action-button",3,"click"]],template:function(f,v){1&f&&e.DNE(0,d,27,10,"mat-card"),2&f&&e.vxM(v.feature()?0:-1)},dependencies:[g.Hu,g.RN,g.YY,g.m2,g.MM,g.dh,C.Hl,C.It,C.$z,t.m_,t.An,m.$,x.h,x.D9],encapsulation:2})}}return c})()},8045:(I,F,s)=>{s.r(F),s.d(F,{LicenseInfoComponent:()=>Z});var e=s(9841),C=s(9509),g=s(8824),h=s(316),t=s(9148),x=s(4175),_=s(7941),m=s(353),R=s(3840),M=s(2159),E=s(4205),T=s(3037),r=s(6647),d=s(1318),D=s(9452),c=s(8764),O=s(271),l=s(1870),f=s(1873),v=s(4581),L=s(2938);class P{static expandFeature(p){return{...p,...P.getExpiration(p?.expiration)}}static expandLicense(p){try{const n=p?.Features?.map(o=>o.expiration).sort()[0];return null==n?p:{...p,...P.getExpiration(n)}}catch{return p}}static getExpiration(p){const n=(u,q)=>({ExpMessage:(null!=u?u+" ":"")+q,ExpIcon:u,ExpWarningIcon:"\u2705"!=u?u:null}),a=p?.split("T")[0];if(null==a)return n(null,null);if(a.startsWith("9999"))return n("\u2705","never");const o=new Date(a);return o<new Date?n("\u{1f6d1}","expired"):o.toDateString()===(new Date).toDateString()?n("\u26a0\ufe0f","today"):o.toDateString()===new Date((new Date).setDate((new Date).getDate()+1)).toDateString()?n("\u26a0\ufe0f","tomorrow"):o<new Date((new Date).setDate((new Date).getDate()+30))?n("\u26a0\ufe0f",a):a.endsWith("12-31")?n("\u2705",`EOY ${a.split("-")[0]}`):n("\u2753",a)}}var y=s(1828),U=s(1960),B=s(6378),$=s(251),b=s(4601),A=s(7037),G=s(8471),S=s(3992);let W=(()=>{class i{transform(n){return`${n.Features.filter(a=>a.isEnabled).length}/${n.Features.length}`}static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275pipe=t.EJ8({name:"activeFeaturesCount",type:i,pure:!0,standalone:!0})}}return i})(),N=(()=>{class i{constructor(n){this.itemsCount=(0,t.hFB)(0),this.headerHeight=(0,t.hFB)(32),this.rowHeight=(0,t.hFB)(48),this.maxRows=(0,t.hFB)(100),this.extraHeight=2,this.element=n.nativeElement}ngOnChanges(n){if(null!=n.itemsCount){const a=0===this.itemsCount()?2:this.itemsCount()>this.maxRows()?this.maxRows():this.itemsCount();this.element.style.height=`${this.headerHeight()+a*this.rowHeight()+this.extraHeight}px`}}static{this.\u0275fac=function(a){return new(a||i)(t.rXU(t.aKT))}}static{this.\u0275dir=t.FsC({type:i,selectors:[["","appAgGridHeight",""]],inputs:{itemsCount:[1,"itemsCount"],headerHeight:[1,"headerHeight"],rowHeight:[1,"rowHeight"],maxRows:[1,"maxRows"]},standalone:!0,features:[t.OA$]})}}return i})();var w=s(1191);let K=(()=>{class i{agInit(n){this.value=n.value,this.feature=n.data}refresh(n){return!0}static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-features-list-enabled-reason"]],standalone:!0,features:[t.aNF],decls:2,vars:2,consts:[[3,"tippy"]],template:function(a,o){1&a&&(t.j41(0,"div",0),t.EFF(1),t.k0s()),2&a&&(t.Y8G("tippy",o.feature.enabledReasonDetailed),t.R7$(),t.JRh(o.value))},dependencies:[b.e],encapsulation:2})}}return i})(),H=(()=>{class i{agInit(n){this.value=n.value}refresh(n){return!0}static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-features-list-enabled"]],standalone:!0,features:[t.aNF],decls:3,vars:1,consts:[[1,"icon-container"]],template:function(a,o){1&a&&(t.j41(0,"div",0)(1,"mat-icon"),t.EFF(2),t.k0s()()),2&a&&(t.R7$(2),t.JRh(o.value?"check_box":"check_box_outline_blank"))},dependencies:[R.m_,R.An],encapsulation:2})}}return i})();var j=s(8827);const V=(i,p)=>({"toggle-false":i,"toggle-null":p});let k=(()=>{class i{agInit(n){this.params=n,this.value=n.value,this.disabled=n.isDisabled(n.data),this.tooltip=n.tooltipGetter(n.data)}refresh(n){return this.disabled=this.params.isDisabled(this.params.data),!0}toggle(){const n=this.params.data;let a;switch(this.value){case!1:a=null;break;case null:a=!0;break;case!0:a=!1}this.value=a,this.params.onToggle(n,a)}static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-features-status"]],standalone:!0,features:[t.aNF],decls:1,vars:7,consts:[[3,"change","checked","tippy","disabled","ngClass"]],template:function(a,o){1&a&&(t.j41(0,"mat-slide-toggle",0),t.bIt("change",function(){return o.toggle()}),t.k0s()),2&a&&t.Y8G("checked",o.value)("tippy",o.tooltip)("disabled",o.disabled)("ngClass",t.l_i(4,V,!1===o.value,null===o.value))},dependencies:[j.mV,j.sG,h.YU,b.e],styles:["[_nghost-%COMP%]{height:100%;display:flex;padding-left:12px;padding-right:12px;align-items:center}.mat-mdc-slide-toggle[_ngcontent-%COMP%]{padding-top:0}  .toggle-false.mat-mdc-slide-toggle:not(.mat-mdc-slide-toggle-checked):not(.mat-disabled) .mdc-switch__track:before{background-color:orange!important}  .toggle-null .mdc-switch__handle{margin-left:8px}"]})}}return i})(),J=(()=>{class i{transform(n){return Array.isArray(n)?[...n].sort((o,u)=>o.Priority<u.Priority?-1:o.Priority>u.Priority?1:0):n}static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275pipe=t.EJ8({name:"licensesOrder",type:i,pure:!0,standalone:!0})}}return i})();const X=i=>({expanded:i});function Y(i,p){if(1&i&&t.nrm(0,"ag-grid-angular",9),2&i){const n=t.XpG().$implicit,a=t.XpG(2);t.Y8G("rowData",n.Features)("gridOptions",a.gridOptions)("itemsCount",null==n.Features?null:n.Features.length)}}function z(i,p){if(1&i&&(t.j41(0,"mat-expansion-panel",null,0)(2,"mat-expansion-panel-header")(3,"mat-panel-title")(4,"mat-icon",5),t.EFF(5),t.k0s(),t.j41(6,"div")(7,"div",6)(8,"span"),t.EFF(9),t.k0s(),t.j41(10,"span",7),t.EFF(11),t.nI1(12,"activeFeaturesCount"),t.k0s(),t.j41(13,"span"),t.EFF(14),t.k0s()(),t.j41(15,"div",8),t.EFF(16),t.k0s()()()(),t.DNE(17,Y,1,3,"ag-grid-angular",9),t.k0s()),2&i){const n=p.$implicit,a=t.sdS(1);t.R7$(4),t.Y8G("tippy",n.IsEnabled?"License is active":"License is not active"),t.R7$(),t.JRh(n.IsEnabled?"check_circle_outline":"cancel"),t.R7$(4),t.JRh(n.Name),t.R7$(2),t.JRh(t.bMT(12,8,n)),t.R7$(3),t.SpI(" ",n.ExpWarningIcon,""),t.R7$(),t.Y8G("ngClass",t.eq3(10,X,a.expanded)),t.R7$(),t.SpI(" ",n.Description," "),t.R7$(),t.vxM(a.expanded?17:-1)}}function Q(i,p){1&i&&(t.j41(0,"mat-accordion",1),t.Z7z(1,z,18,12,"mat-expansion-panel",null,t.BUC().trackLicenses,!0),t.nI1(3,"licensesOrder"),t.k0s()),2&i&&(t.R7$(),t.Dyx(t.bMT(3,0,p.licenses)))}let Z=(()=>{class i{#e;#n;#a;constructor(n,a,o){this.matDialog=n,this.viewContainerRef=a,this.changeDetectorRef=o,this.gridOptions=this.#o(),this.#e=new E.B,this.#n=(0,L.d)(S.b),this.#a=(0,L.d)(G.c),this.disabled=(0,t.vPA)(!1),this.#t=(0,t.vPA)(0),this.licensesSig=(0,t.EWP)(()=>(this.#t(),this.disabled.set(!1),this.#n.getLicensesSig())),g.syG.registerModules([C.Q])}#t;ngOnInit(){this.#a.doOnDialogClosed(()=>{this.#e.next(),this.#t.set(this.#t()+1)}),this.viewModel$=this.#e.pipe((0,T.Z)(void 0),(0,r.n)(()=>this.#n.getLicenses().pipe((0,d.W)(()=>(0,D.of)(void 0)))),(0,c.M)(()=>{this.disabled.set(!1)}),(0,O.T)(n=>n.map(a=>({...P.expandLicense(a),Features:a.Features.map(o=>P.expandFeature(o))}))),(0,l.u)()).pipe((0,O.T)(n=>({licenses:n})))}trackLicenses(n,a){return a.Guid}openRegistration(){const n=this.#a.router;n.navigate([n.url.replace("license","")+"/registration"])}#s(n){this.matDialog.open(w.O,{autoFocus:!1,data:{feature:n,showGuid:!0,showStatus:!0},viewContainerRef:this.viewContainerRef,width:"600px"}),this.changeDetectorRef.markForCheck()}#i(n,a){this.disabled.set(!0),(0,f.p)([this.#n.saveFeatures([{FeatureGuid:n.guid,Enabled:a}]),(0,v.O)(100)]).subscribe({error:()=>{this.#t.set(this.#t()+1),this.#e.next()},next:()=>{this.#t.set(this.#t()+1),this.#e.next()}})}#o(){return{...$.C,columnDefs:[{...y.r.ItemsText,headerName:"ID",field:"nameId",width:200,cellClass:"no-outline",cellRenderer:B.L,cellRendererParams:{tooltipGetter:o=>o.nameId}},{...y.r.TextWideFlex3,headerName:"Name",field:"name",cellClass:"primary-action highlight".split(" "),onCellClicked:a=>{this.#s(a.data)}},{headerName:"Enabled",field:"isEnabled",width:80,cellClass:"no-outline",headerClass:"dense",sortable:!0,filter:U.y,cellRenderer:H},{...y.r.TextNarrow,headerName:"Reason",field:"enabledReason",cellRenderer:K},{...y.r.ItemsText,headerName:"Expiration",field:"ExpMessage",sortable:!1,width:120,tooltipValueGetter:a=>a.data?.expiration},{...y.r.ActionsPinnedRight7,headerName:"",field:"enabledInConfiguration",cellRenderer:k,cellRendererParams:()=>({isDisabled:o=>!o.isConfigurable||this.disabled(),onToggle:(o,u)=>this.#i(o,u),tooltipGetter:o=>o.isConfigurable?"Toggle off | default | on":"This feature can't be configured"})}]}}static{this.\u0275fac=function(a){return new(a||i)(t.rXU(_.bZ),t.rXU(t.c1b),t.rXU(t.gRc))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-license-info"]],viewQuery:function(a,o){if(1&a&&t.GBs(e.xs,5),2&a){let u;t.mGM(u=t.lsd())&&(o.gridRef=u.first)}},standalone:!0,features:[t.aNF],decls:9,vars:3,consts:[["panel",""],["multi",""],["align","start"],["mat-button","","tippy","Registration",1,"eav-button__with-icon",3,"click"],[1,"eav-icon"],[1,"panel-icon",3,"tippy"],[1,"panel-title"],[1,"active-features-count"],[1,"panel-description",3,"ngClass"],["appAgGridHeight","",1,"ag-theme-material",3,"rowData","gridOptions","itemsCount"]],template:function(a,o){if(1&a&&(t.DNE(0,Q,4,2,"mat-accordion",1),t.nI1(1,"async"),t.j41(2,"mat-dialog-actions",2)(3,"button",3),t.bIt("click",function(){return o.openRegistration()}),t.j41(4,"mat-icon",4),t.EFF(5,"app_registration"),t.k0s(),t.j41(6,"span"),t.EFF(7,"Registration"),t.k0s()()(),t.nrm(8,"router-outlet")),2&a){let u;t.vxM((u=t.bMT(1,1,o.viewModel$))?0:-1,u)}},dependencies:[m.MY,m.BS,m.GK,m.Z2,m.WN,R.m_,R.An,h.YU,A.p,e.xs,N,_.E7,x.Hl,x.$z,M.n3,h.Jj,J,W,b.e],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;padding-top:20px;box-sizing:border-box;position:relative}.mat-expansion-panel-header[_ngcontent-%COMP%]{padding-top:4px;padding-bottom:4px}.mat-expansion-panel-header[_ngcontent-%COMP%]     .mat-content{max-height:100%}.panel-icon[_ngcontent-%COMP%]{margin-right:16px}.panel-title[_ngcontent-%COMP%]{font-size:14px}.active-features-count[_ngcontent-%COMP%]{display:inline-block;margin-left:8px;color:#fff;font-size:12px;border-radius:12px;padding:2px 6px;background-color:#002753;border:1px solid rgba(29,39,61,.44);box-sizing:border-box;-webkit-user-select:none;user-select:none;white-space:nowrap}.panel-description[_ngcontent-%COMP%]{padding-top:4px;font-size:12px;color:#0000008a;overflow:hidden;text-overflow:ellipsis;max-height:1em;line-height:1em}.panel-description.expanded[_ngcontent-%COMP%]{max-height:3em}.eav-button__with-icon[_ngcontent-%COMP%]   .eav-icon[_ngcontent-%COMP%]{font-size:24px;height:24px;width:24px}"]})}}return i})()},8471:(I,F,s)=>{s.d(F,{c:()=>M});var e=s(2159),C=s(1567),g=s(3037),h=s(271),t=s(5057),x=s(4435),_=s(4979),m=s(9148);const R={doOnDialogClosed:!0};let M=(()=>{class E extends _.V{constructor(r,d){super(),this.router=r,this.route=d,this.log=(0,x.T)({DialogRoutingService:E},R)}get snapshot(){return this.route.snapshot}get url(){return this.router.url}getParam(r){return this.route.snapshot.paramMap.get(r)}getParams(r){const d=this.route.snapshot.paramMap;return r.reduce((D,c)=>(D[c]=d.get(c),D),{})}getQueryParam(r){return this.route.snapshot.queryParamMap.get(r)}getQueryParams(r){const d=this.route.snapshot.queryParamMap;return r.reduce((D,c)=>(D[c]=d.get(c),D),{})}state(){return this.router.getCurrentNavigation().extras?.state}doOnDialogClosed(r){const d=this.log.fnIf("doOnDialogClosed");this.subscriptions.add(this.childDialogClosed$().subscribe(()=>r())),d.end()}urlSubRoute(r){const d=this.router.createUrlTree([r],{relativeTo:this.route});return this.router.serializeUrl(d)}navPath(r,d){return this.router.navigate([r],d)}navRelative(r,d){return this.router.navigate(r,{...d,relativeTo:this.route})}childDialogClosed$(){return this.router.events.pipe((0,C.p)(r=>r instanceof e.wF),(0,g.Z)(!!this.route.snapshot.firstChild),(0,h.T)(()=>!!this.route.snapshot.firstChild),(0,t.J)(),(0,C.p)(([r,d])=>r&&!d))}static{this.\u0275fac=function(d){return new(d||E)(m.KVO(e.Ix),m.KVO(e.nX))}}static{this.\u0275prov=m.jDH({token:E,factory:E.\u0275fac})}}return E})()},4979:(I,F,s)=>{s.d(F,{V:()=>g});var e=s(7092),C=s(9148);let g=(()=>{class h{constructor(){this.subscriptions=new e.yU}ngOnDestroy(){this.destroy()}destroy(){this.subscriptions.unsubscribe()}static{this.\u0275fac=function(_){return new(_||h)}}static{this.\u0275prov=C.jDH({token:h,factory:h.\u0275fac})}}return h})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/18.06.00/dist/ng-edit/projects_eav-ui_src_app_apps-management_licence-info_license-info_component_ts.5ba9a5e9c041fb42.js.map