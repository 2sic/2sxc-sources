"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_permissions_permissions_component_ts"],{61:(P,u,t)=>{t.r(u),t.d(u,{PermissionsComponent:()=>I});var d=t(6317),n=t(60),l=t(2087),g=t(4153),c=t(941),y=t(2225),e=t(3184),C=t(1130),h=t(6190),p=t(5590);let a=(()=>{class m{agInit(i){this.params=i}refresh(i){return!0}deletePermission(){this.params.onDelete(this.params.data)}}return m.\u0275fac=function(i){return new(i||m)},m.\u0275cmp=e.Xpm({type:m,selectors:[["app-permissions-actions"]],decls:4,vars:0,consts:[[1,"actions-component"],["matRipple","","tippy","Delete",1,"like-button","highlight",3,"click"]],template:function(i,s){1&i&&(e.TgZ(0,"div",0)(1,"div",1),e.NdJ("click",function(){return s.deletePermission()}),e.TgZ(2,"mat-icon"),e._uU(3,"delete"),e.qZA()()())},directives:[C.wG,h.$,p.Hw],styles:[""]}),m})();var r=t(2023),f=t(2977),T=t(5758),D=t(2528),E=t(7317),M=t(1350),b=t(6362);let I=(()=>{class m extends n.H{constructor(i,s,o,O,_){super(i,s),this.router=i,this.route=s,this.dialogRef=o,this.permissionsService=O,this.snackBar=_,this.permissions$=new d.X(void 0),this.gridOptions=this.buildGridOptions(),this.targetType=parseInt(this.route.snapshot.paramMap.get("targetType"),10),this.keyType=this.route.snapshot.paramMap.get("keyType"),this.key=this.route.snapshot.paramMap.get("key"),this.prefills={[c.Zy.metadata.language.targetType]:{PermissionType:"language"}}}ngOnInit(){this.fetchPermissions(),this.subscription.add(this.refreshOnChildClosedShallow().subscribe(()=>{this.fetchPermissions()}))}ngOnDestroy(){this.permissions$.complete(),super.ngOnDestroy()}closeDialog(){this.dialogRef.close()}fetchPermissions(){this.permissionsService.getAll(this.targetType,this.keyType,this.key).subscribe(i=>{this.permissions$.next(i)})}editPermission(i){var s,o;let O;O=null==i?{items:[Object.assign({ContentTypeName:c.Zy.contentTypes.permissions,For:Object.assign(Object.assign(Object.assign({Target:null!==(o=null===(s=Object.values(c.Zy.metadata).find(x=>x.targetType===this.targetType))||void 0===s?void 0:s.target)&&void 0!==o?o:this.targetType.toString(),TargetType:this.targetType},this.keyType===c.Zy.keyTypes.guid&&{Guid:this.key}),this.keyType===c.Zy.keyTypes.number&&{Number:parseInt(this.key,10)}),this.keyType===c.Zy.keyTypes.string&&{String:this.key})},this.prefills[this.targetType]&&{Prefill:this.prefills[this.targetType]})]}:{items:[{EntityId:i.Id}]};const _=(0,y.f)(O);this.router.navigate([`edit/${_}`],{relativeTo:this.route})}deletePermission(i){!confirm(`Delete '${i.Title}' (${i.Id})?`)||(this.snackBar.open("Deleting..."),this.permissionsService.delete(i.Id).subscribe(()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchPermissions()}))}buildGridOptions(){return Object.assign(Object.assign({},g.f),{columnDefs:[{headerName:"ID",field:"Id",width:70,headerClass:"dense",cellClass:"id-action no-padding no-outline".split(" "),sortable:!0,filter:"agNumberColumnFilter",valueGetter:s=>s.data.Id,cellRenderer:l.m,cellRendererParams:{tooltipGetter:o=>`ID: ${o.Id}\nGUID: ${o.Guid}`}},{field:"Name",flex:2,minWidth:250,cellClass:"primary-action highlight".split(" "),sortable:!0,sort:"asc",filter:"agTextColumnFilter",onCellClicked:s=>{this.editPermission(s.data)},valueGetter:s=>s.data.Title},{field:"Identity",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:s=>s.data.Identity},{field:"Condition",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:s=>s.data.Condition},{field:"Grant",width:70,headerClass:"dense",cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:s=>s.data.Grant},{width:42,cellClass:"secondary-action no-padding".split(" "),pinned:"right",cellRenderer:a,cellRendererParams:(()=>({onDelete:o=>this.deletePermission(o)}))()}]})}}return m.\u0275fac=function(i){return new(i||m)(e.Y36(f.F0),e.Y36(f.gz),e.Y36(T.so),e.Y36(r.q),e.Y36(D.ux))},m.\u0275cmp=e.Xpm({type:m,selectors:[["app-permissions"]],features:[e.qOj],decls:16,vars:4,consts:[[1,"nav-component-wrapper"],["mat-dialog-title",""],[1,"dialog-title-box"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","gridOptions"],[1,"grid-more-actions-box"],["mat-fab","","mat-elevation-z24","","tippy","Create a new permission",1,"grid-fab",3,"click"]],template:function(i,s){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div"),e._uU(4,"Permissions"),e.qZA(),e.TgZ(5,"button",3),e.NdJ("click",function(){return s.closeDialog()}),e.TgZ(6,"mat-icon"),e._uU(7,"close"),e.qZA()()()(),e._UZ(8,"router-outlet"),e.TgZ(9,"div",4),e._UZ(10,"ag-grid-angular",5),e.ALo(11,"async"),e._UZ(12,"div",6),e.TgZ(13,"button",7),e.NdJ("click",function(){return s.editPermission(null)}),e.TgZ(14,"mat-icon"),e._uU(15,"add"),e.qZA()()()()),2&i&&(e.xp6(10),e.Q6J("rowData",e.lcZ(11,2,s.permissions$))("gridOptions",s.gridOptions))},directives:[T.uh,E.lW,h.$,p.Hw,f.lC,M.N8],pipes:[b.Ov],styles:[""]}),m})()},60:(P,u,t)=>{t.d(u,{H:()=>C});var d=t(2977),n=t(7714),l=t(116),g=t(4874),c=t(635),y=t(679),e=t(3184);let C=(()=>{class h{constructor(a,r){this.router=a,this.route=r,this.subscription=new n.w0}ngOnDestroy(){this.subscription.unsubscribe()}refreshOnChildClosedDeep(){return this.router.events.pipe((0,l.h)(a=>a instanceof d.m2),(0,g.O)(!!this.route.snapshot.firstChild.firstChild),(0,c.U)(()=>!!this.route.snapshot.firstChild.firstChild),(0,y.G)(),(0,l.h)(([a,r])=>a&&!r))}refreshOnChildClosedShallow(){return this.router.events.pipe((0,l.h)(a=>a instanceof d.m2),(0,g.O)(!!this.route.snapshot.firstChild),(0,c.U)(()=>!!this.route.snapshot.firstChild),(0,y.G)(),(0,l.h)(([a,r])=>a&&!r))}}return h.\u0275fac=function(a){return new(a||h)(e.Y36(d.F0),e.Y36(d.gz))},h.\u0275dir=e.lG2({type:h}),h})()},2087:(P,u,t)=>{t.d(u,{m:()=>h});var d=t(9673),n=t(3184),l=t(2528),g=t(1130),c=t(6190),y=t(6362),e=t(5590);const C=function(p,a){return{"align-start":p,"align-end":a}};let h=(()=>{class p{constructor(r){this.snackBar=r}agInit(r){this.id=r.value,this.align="number"==typeof this.id?"end":"start",this.tooltip=r.tooltipGetter(r.data)}refresh(r){return!0}copy(){(0,d.v)(this.tooltip),this.snackBar.open("Copied to clipboard",null,{duration:2e3})}}return p.\u0275fac=function(r){return new(r||p)(n.Y36(l.ux))},p.\u0275cmp=n.Xpm({type:p,selectors:[["app-id-field"]],decls:5,vars:6,consts:[["matRipple","",1,"id-box","highlight",3,"tippy","ngClass","click"],[1,"id"],[1,"icon"]],template:function(r,f){1&r&&(n.TgZ(0,"div",0),n.NdJ("click",function(){return f.copy()}),n.TgZ(1,"span",1),n._uU(2),n.qZA(),n.TgZ(3,"mat-icon",2),n._uU(4,"file_copy"),n.qZA()()),2&r&&(n.Q6J("tippy",f.tooltip)("ngClass",n.WLB(3,C,"start"===f.align,"end"===f.align)),n.xp6(2),n.Oqu(f.id))},directives:[g.wG,c.$,y.mk,e.Hw],styles:[".id-box[_ngcontent-%COMP%]{padding:0 8px;height:100%;display:flex;align-items:center}.id-box.align-start[_ngcontent-%COMP%]{justify-content:flex-start}.id-box.align-end[_ngcontent-%COMP%]{justify-content:flex-end}.id-box[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{max-width:100%;text-overflow:ellipsis;overflow:hidden}.id-box[_ngcontent-%COMP%]:hover{text-decoration:none}.id-box[_ngcontent-%COMP%]:hover   .id[_ngcontent-%COMP%]{display:none}.id-box[_ngcontent-%COMP%]:not(:hover)   .icon[_ngcontent-%COMP%]{display:none}"]}),p})()},4153:(P,u,t)=>{t.d(u,{f:()=>d});const d={accentedSort:!0,animateRows:!0,enableCellTextSelection:!0,headerHeight:32,suppressScrollOnNewData:!0,valueCache:!0,defaultColDef:{filterParams:{newRowsAction:"keep"}},tooltipShowDelay:0,tooltipHideDelay:1e5,suppressMovableColumns:!0}},9673:(P,u,t)=>{function d(n){const l=document.createElement("textarea");l.value=n,l.setAttribute("readonly",""),l.style.position="absolute",l.style.left="-9999px",document.body.appendChild(l);const g=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);l.select(),document.execCommand("copy"),document.body.removeChild(l),g&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(g))}t.d(u,{v:()=>d})}}]);
//# sourceMappingURL=https://sources.2sxc.org/15.01.00/ng-edit/projects_eav-ui_src_app_permissions_permissions_component_ts.248839582e2066d0.js.map