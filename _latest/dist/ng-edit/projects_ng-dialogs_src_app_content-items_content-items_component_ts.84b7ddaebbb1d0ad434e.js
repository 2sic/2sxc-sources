(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_ng-dialogs_src_app_content-items_content-items_component_ts","projects_ng-dialogs_src_app_shared_directives_click-stop-propagation_directive_ts","projects_ng-dialogs_src_app_app-administration_services_app-dialog-config_service_ts-_31ae0","projects_ng-dialogs_src_app_app-administration_services_app-dialog-config_service_ts-_31ae1"],{2887:function(t,e,n){"use strict";n.d(e,{K:function(){return s}});var i=n(1785),o=n(2693),r=n(3582),a=n(2837),s=function(){function t(t,e,n){this.http=t,this.context=e,this.dnnContext=n}return t.prototype.getDialogSettings=function(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/dialog/settings"),{params:{appId:null!=t?t:this.context.appId.toString()}})},t.\u0275fac=function(e){return new(e||t)(i.LFG(o.eN),i.LFG(r._),i.LFG(a._y))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t}()},3466:function(t,e,n){"use strict";n.d(e,{T:function(){return p}});var i=n(3475),o=n(1785),r=n(2693),a=n(3582),s=n(2837),p=function(){function t(t,e,n){this.http=t,this.context=e,this.dnnContext=n}return t.prototype.getContentInfo=function(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(i.v+"Get"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),scope:t}})},t.prototype.exportParts=function(t,e,n){var o=this.dnnContext.$2sxc.http.apiUrl(i.v+"Export")+"?appId="+this.context.appId.toString()+"&zoneId="+this.context.zoneId.toString()+"&contentTypeIdsString="+t.join(";")+"&entityIdsString="+e.join(";")+"&templateIdsString="+n.join(";");window.open(o,"_blank","")},t.\u0275fac=function(e){return new(e||t)(o.LFG(r.eN),o.LFG(a._),o.LFG(s._y))},t.\u0275prov=o.Yz7({token:t,factory:t.\u0275fac}),t}()},271:function(t,e,n){"use strict";n.d(e,{v:function(){return p}});var i=n(6466),o=n(1785),r=n(2693),a=n(3582),s=n(2837),p=function(){function t(t,e,n){this.http=t,this.context=e,this.dnnContext=n}return t.prototype.getAppInfo=function(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(i.H+"Statistics"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})},t.prototype.exportApp=function(t,e){var n=this.dnnContext.$2sxc.http.apiUrl(i.H+"Export")+"?appId="+this.context.appId+"&zoneId="+this.context.zoneId+"&includeContentGroups="+t+"&resetAppGuid="+e;window.open(n,"_blank","")},t.prototype.exportForVersionControl=function(t,e){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(i.H+"SaveData"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),includeContentGroups:t.toString(),resetAppGuid:e.toString()}})},t.\u0275fac=function(e){return new(e||t)(o.LFG(r.eN),o.LFG(a._),o.LFG(s._y))},t.\u0275prov=o.Yz7({token:t,factory:t.\u0275fac}),t}()},3475:function(t,e,n){"use strict";n.d(e,{v:function(){return p},z:function(){return u}});var i=n(6466),o=n(1785),r=n(2693),a=n(3582),s=n(2837),p="admin/appParts/",u=function(){function t(t,e,n){this.http=t,this.context=e,this.dnnContext=n}return t.prototype.importAppParts=function(t){var e=new FormData;return e.append("File",t),this.http.post(this.dnnContext.$2sxc.http.apiUrl(p+"Import"),e,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})},t.prototype.resetApp=function(){return this.http.post(this.dnnContext.$2sxc.http.apiUrl(i.H+"Reset"),{},{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})},t.\u0275fac=function(e){return new(e||t)(o.LFG(r.eN),o.LFG(a._),o.LFG(s._y))},t.\u0275prov=o.Yz7({token:t,factory:t.\u0275fac}),t}()},5151:function(t,e,n){"use strict";n.d(e,{Kw:function(){return i.K},sF:function(){return o.s},vG:function(){return r.vG},bf:function(){return r.bf},Az:function(){return r.Az},TB:function(){return r.TB},cv:function(){return r.cv},nt:function(){return r.nt},h3:function(){return a.h}});var i=n(2887),o=n(2832),r=(n(3466),n(271),n(3475),n(2394)),a=n(1916);n(7915)},2394:function(t,e,n){"use strict";n.d(e,{cv:function(){return l},Az:function(){return d},nt:function(){return f},TB:function(){return h},bf:function(){return g},vG:function(){return m}});var i=n(9764),o=n(3982),r=n(1407),a=n(8442),s=n(1785),p=n(2693),u=n(3582),c=n(2837),l="admin/query/Run",d="admin/query/DebugStream",f="admin/query/Save",h="admin/query/Get",g="admin/query/DataSources",m=function(){function t(t,e,n){this.http=t,this.context=e,this.dnnContext=n}return t.prototype.getAll=function(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(r.PS),{params:{appId:this.context.appId.toString(),contentType:t}})},t.prototype.importQuery=function(t){var e=this;return(0,i.D)((0,a.s)(t)).pipe((0,o.zg)(function(t){return e.http.post(e.dnnContext.$2sxc.http.apiUrl("admin/query/import"),{AppId:e.context.appId.toString(),ContentBase64:t})}))},t.prototype.clonePipeline=function(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/query/Clone"),{params:{Id:t.toString(),appId:this.context.appId.toString()}})},t.prototype.delete=function(t){return this.http.delete(this.dnnContext.$2sxc.http.apiUrl("admin/query/Delete"),{params:{appId:this.context.appId.toString(),Id:t.toString()}})},t.\u0275fac=function(e){return new(e||t)(s.LFG(p.eN),s.LFG(u._),s.LFG(c._y))},t.\u0275prov=s.Yz7({token:t,factory:t.\u0275fac}),t}()},1916:function(t,e,n){"use strict";n.d(e,{h:function(){return s}});var i=n(1785),o=n(2693),r=n(3582),a=n(2837),s=function(){function t(t,e,n){this.http=t,this.context=e,this.dnnContext=n}return t.prototype.getAll=function(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/view/all"),{params:{appId:this.context.appId.toString()}})},t.prototype.delete=function(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/view/delete"),{params:{appId:this.context.appId.toString(),Id:t.toString()}})},t.prototype.import=function(t){var e=new FormData;return e.append("File",t),this.http.post(this.dnnContext.$2sxc.http.apiUrl("admin/view/import"),e,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})},t.prototype.export=function(t){var e=this.dnnContext.$2sxc.http.apiUrl("admin/view/json")+"?appId="+this.context.appId+"&viewId="+t;window.open(e,"_blank","")},t.prototype.getPolymorphism=function(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/view/polymorphism"),{params:{appId:this.context.appId.toString()}})},t.prototype.getUsage=function(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/view/usage"),{params:{appId:this.context.appId.toString(),guid:t}})},t.\u0275fac=function(e){return new(e||t)(i.LFG(o.eN),i.LFG(r._),i.LFG(a._y))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t}()},7915:function(t,e,n){"use strict";n.d(e,{n:function(){return u}});var i=n(9996),o=n(1407),r=n(1785),a=n(2693),s=n(3582),p=n(2837),u=function(){function t(t,e,n){this.http=t,this.context=e,this.dnnContext=n}return t.prototype.getAll=function(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(o.nu),{params:{appId:this.context.appId.toString(),global:"false",path:"",mask:"*Controller.cs",withSubfolders:"true"}}).pipe((0,i.U)(function(t){return t.map(function(t){var e=t.lastIndexOf("/"),n=t.lastIndexOf("."),i=t.substring(0,e),o=t.substring(e+1,n);return{path:t,folder:i,name:o}})}))},t.prototype.create=function(t,e){return this.http.post(this.dnnContext.$2sxc.http.apiUrl(o.yE),{},{params:{appId:this.context.appId.toString(),global:"false",purpose:"auto",path:t,templateKey:e}})},t.prototype.details=function(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(o.BQ),{params:{path:t}})},t.\u0275fac=function(e){return new(e||t)(r.LFG(a.eN),r.LFG(s._),r.LFG(p._y))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t}()},6538:function(t,e,n){"use strict";n.r(e),n.d(e,{ContentItemsComponent:function(){return Kt}});var i=n(4762),o=n(9206),r=n(1282),a=n(8512),s=n(7570),p=n(3835),u=n(611),c=n(6238),l=n(9996),d=n(2855),f=n(3667),h=n(753),g=n(7867),m=n(1785),y=n(3070),v=n(9550),T=n(1041),x=["valueInput"],C=function(){function t(){this.filter="",this.idFilterString=""}return t.prototype.agInit=function(t){this.params=t},t.prototype.isFilterActive=function(){return""!==this.filter||this.idFilter.length>0},t.prototype.doesFilterPass=function(t){var e,n=this;if(""!==this.filter){var i=this.params.valueGetter(t.node);if(null==i)return!1;if(!i.some(function(t){return!!t&&t.includes(n.filter)}))return!1}if(this.idFilter.length>0){var o=null===(e=t.data[this.params.colDef.headerName])||void 0===e?void 0:e[0];if(null==o)return!1;if(!this.idFilter.includes(o.Id))return!1}return!0},t.prototype.getModel=function(){if(this.isFilterActive())return{filterType:"entity",filter:this.filter,idFilter:this.idFilter}},t.prototype.setModel=function(t){var e,n,i,o;this.filter=null!==(e=null==t?void 0:t.filter)&&void 0!==e?e:"",this.idFilter=null!==(n=null==t?void 0:t.idFilter)&&void 0!==n?n:[],this.idFilterString=null!==(o=null===(i=null==t?void 0:t.idFilter)||void 0===i?void 0:i.join(","))&&void 0!==o?o:""},t.prototype.afterGuiAttached=function(t){this.valueInputRef.nativeElement.focus()},t.prototype.updateIdFilter=function(){this.idFilter=this.idFilterString.split(",").map(function(t){return parseInt(t,10)}).filter(function(t){return!isNaN(t)})},t.prototype.filterChanged=function(){this.params.filterChangedCallback()},t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-entity-filter"]],viewQuery:function(t,e){var n;1&t&&m.Gf(x,5),2&t&&m.iGM(n=m.CRH())&&(e.valueInputRef=n.first)},decls:9,vars:2,consts:[["appearance","standard","color","accent"],["matInput","","type","text",3,"ngModel","ngModelChange"],["valueInput",""]],template:function(t,e){1&t&&(m.TgZ(0,"mat-form-field",0),m.TgZ(1,"mat-label"),m._uU(2,"Value"),m.qZA(),m.TgZ(3,"input",1,2),m.NdJ("ngModelChange",function(t){return e.filter=t})("ngModelChange",function(){return e.filterChanged()}),m.qZA(),m.qZA(),m.TgZ(5,"mat-form-field",0),m.TgZ(6,"mat-label"),m._uU(7,"IDs (comma separated)"),m.qZA(),m.TgZ(8,"input",1),m.NdJ("ngModelChange",function(t){return e.idFilterString=t})("ngModelChange",function(){return e.updateIdFilter(),e.filterChanged()}),m.qZA(),m.qZA()),2&t&&(m.xp6(3),m.Q6J("ngModel",e.filter),m.xp6(5),m.Q6J("ngModel",e.idFilterString))},directives:[y.KE,y.hX,v.Nt,T.Fj,T.JJ,T.On],styles:["[_nghost-%COMP%]{display:block;padding:16px 12px 2px}.mat-form-field[_ngcontent-%COMP%]{display:block;width:150px}"]}),t}(),Z=n(6085),b=n(8579),I=n(5803),k=n(5549),_=n(9081),A=n(2420),w=n(7064),q=n(7512),N=n(7307),M=n(7070),S=function(){function t(){}return t.prototype.agInit=function(t){this.params=t,this.item=t.data},t.prototype.refresh=function(t){return!0},t.prototype.clone=function(){this.params.onClone(this.item)},t.prototype.export=function(){this.params.onExport(this.item)},t.prototype.deleteItem=function(){this.params.onDelete(this.item)},t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-content-items-actions"]],decls:17,vars:1,consts:[[1,"actions-component"],["matRipple","","tippy","Copy",1,"like-button","highlight",3,"click"],["matRipple","","tippy","Export",1,"like-button","highlight",3,"click"],["matRipple","","tippy","More",1,"like-button","highlight",3,"matMenuTriggerFor"],[1,"grid-more-menu"],["menu","matMenu"],["mat-menu-item","",3,"click"]],template:function(t,e){if(1&t&&(m.TgZ(0,"div",0),m.TgZ(1,"div",1),m.NdJ("click",function(){return e.clone()}),m.TgZ(2,"mat-icon"),m._uU(3,"file_copy"),m.qZA(),m.qZA(),m.TgZ(4,"div",2),m.NdJ("click",function(){return e.export()}),m.TgZ(5,"mat-icon"),m._uU(6,"cloud_download"),m.qZA(),m.qZA(),m.TgZ(7,"div",3),m.TgZ(8,"mat-icon"),m._uU(9,"more_horiz"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(10,"mat-menu",4,5),m.TgZ(12,"button",6),m.NdJ("click",function(){return e.deleteItem()}),m.TgZ(13,"mat-icon"),m._uU(14,"delete"),m.qZA(),m.TgZ(15,"span"),m._uU(16,"Delete"),m.qZA(),m.qZA(),m.qZA()),2&t){var n=m.MAs(11);m.xp6(7),m.Q6J("matMenuTriggerFor",n)}},directives:[w.wG,q.$,N.Hw,M.p6,M.VK,M.OP],styles:[""]}),t}(),F=n(1116);function U(t,e){if(1&t&&(m.TgZ(0,"span",2),m._uU(1),m.qZA()),2&t){var n=m.oxw();m.xp6(1),m.Oqu(n.entities)}}var J=function(){function t(){}return t.prototype.agInit=function(t){Array.isArray(t.value)&&(this.encodedValue=this.htmlEncode(t.value.join(", ")),t.colDef.allowMultiValue&&(this.entities=t.value.length))},t.prototype.refresh=function(t){return!0},t.prototype.htmlEncode=function(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-content-items-entity"]],decls:3,vars:3,consts:[[3,"tippy"],["class","more-entities",4,"ngIf"],[1,"more-entities"]],template:function(t,e){1&t&&(m.TgZ(0,"div",0),m.YNc(1,U,2,1,"span",1),m._uU(2),m.qZA()),2&t&&(m.Q6J("tippy",e.encodedValue),m.xp6(1),m.Q6J("ngIf",e.entities),m.xp6(1),m.hij(" ",e.encodedValue,"\n"))},directives:[q.$,F.O5],styles:[".more-entities[_ngcontent-%COMP%]{padding:0 8px;border-radius:10px;border:1px solid rgba(29,39,61,.44);-webkit-user-select:none;user-select:none}"]}),t}(),O=n(7217),$=function(t){return{"hide-until-row-hover":t}},Q=function(){function t(){}return t.prototype.agInit=function(t){var e,n;this.value=t.value,this.params=t,this.item=t.data,this.metadataCount=null!==(n=null===(e=this.item.Metadata)||void 0===e?void 0:e.length)&&void 0!==n?n:0,this.metadataTooltip=this.item.For?"This item is metadata for:\nType: "+this.item.For.Target+(this.item.For.Number?"\nNumber: "+this.item.For.Number:"")+(this.item.For.String?"\nString: "+this.item.For.String:"")+(this.item.For.Guid?"\nGuid: "+this.item.For.Guid:"")+(this.item.For.Title?"\nTitle: "+this.item.For.Title:""):"This item is not metadata.",this.metadataTooltip+="\n\nThis item has "+(this.metadataCount>0?this.metadataCount:"no")+" other metadata "+(1===this.metadataCount?"item":"items")+" attached to it."},t.prototype.refresh=function(t){return!0},t.prototype.openMetadata=function(){this.params.onOpenMetadata(this.item)},t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-content-items-status"]],decls:7,vars:8,consts:[[1,"actions-component"],[1,"like-button","button-publish",3,"tippy"],["matRipple","",1,"like-button","highlight",3,"ngClass","tippy","click"],["matBadgeColor","accent","matBadgeSize","small",3,"matBadge"]],template:function(t,e){1&t&&(m.TgZ(0,"div",0),m.TgZ(1,"div",1),m.TgZ(2,"mat-icon"),m._uU(3),m.qZA(),m.qZA(),m.TgZ(4,"div",2),m.NdJ("click",function(){return e.openMetadata()}),m.TgZ(5,"mat-icon",3),m._uU(6),m.qZA(),m.qZA(),m.qZA()),2&t&&(m.xp6(1),m.Q6J("tippy",e.value.published?"Published":"Not published"),m.xp6(2),m.Oqu(e.value.published?"visibility":"visibility_off"),m.xp6(1),m.Q6J("ngClass",m.VKq(6,$,0===e.metadataCount&&!e.value.metadata))("tippy",e.metadataTooltip),m.xp6(1),m.Q6J("matBadge",e.metadataCount>0?e.metadataCount:null),m.xp6(1),m.hij(" ",e.value.metadata?"loyalty":"local_offer"," "))},directives:[q.$,N.Hw,w.wG,F.mk,O.k],styles:[".button-publish[_ngcontent-%COMP%]{cursor:default!important}.button-publish[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{color:initial!important}.hide-until-row-hover[_ngcontent-%COMP%]{visibility:hidden}  .ag-row-hover .hide-until-row-hover{visibility:visible}"]}),t}(),G=n(7436),Y=function(){function t(){this.published="",this.metadata="",this.hasMetadata=""}return t.prototype.agInit=function(t){this.params=t},t.prototype.isFilterActive=function(){return""!==this.published||""!==this.metadata||""!==this.hasMetadata},t.prototype.doesFilterPass=function(t){var e,n,i,o=this.params.valueGetter(t.node);return e=""===this.published||null!=o.published&&o.published.toString()===this.published,n=""===this.metadata||null!=o.metadata&&o.metadata.toString()===this.metadata,i=""===this.hasMetadata||null!=o.hasMetadata&&o.hasMetadata.toString()===this.hasMetadata,e&&n&&i},t.prototype.getModel=function(){if(this.isFilterActive())return{filterType:"pub-meta",published:this.published,metadata:this.metadata,hasMetadata:this.hasMetadata}},t.prototype.setModel=function(t){this.published=t?t.published:"",this.metadata=t?t.metadata:"",this.hasMetadata=t?t.hasMetadata:""},t.prototype.afterGuiAttached=function(t){},t.prototype.filterChanged=function(){this.params.filterChangedCallback()},t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-pub-meta-filter"]],decls:27,vars:3,consts:[[1,"title"],[3,"ngModel","ngModelChange"],["value",""],["value","true"],["value","false"]],template:function(t,e){1&t&&(m.TgZ(0,"div",0),m._uU(1,"Published"),m.qZA(),m.TgZ(2,"mat-radio-group",1),m.NdJ("ngModelChange",function(t){return e.published=t})("ngModelChange",function(){return e.filterChanged()}),m.TgZ(3,"mat-radio-button",2),m._uU(4,"All"),m.qZA(),m.TgZ(5,"mat-radio-button",3),m._uU(6,"Published"),m.qZA(),m.TgZ(7,"mat-radio-button",4),m._uU(8,"Not published"),m.qZA(),m.qZA(),m.TgZ(9,"div",0),m._uU(10,"Is Metadata"),m.qZA(),m.TgZ(11,"mat-radio-group",1),m.NdJ("ngModelChange",function(t){return e.metadata=t})("ngModelChange",function(){return e.filterChanged()}),m.TgZ(12,"mat-radio-button",2),m._uU(13,"All"),m.qZA(),m.TgZ(14,"mat-radio-button",3),m._uU(15,"Is metadata"),m.qZA(),m.TgZ(16,"mat-radio-button",4),m._uU(17,"Is not metadata"),m.qZA(),m.qZA(),m.TgZ(18,"div",0),m._uU(19,"Has Metadata"),m.qZA(),m.TgZ(20,"mat-radio-group",1),m.NdJ("ngModelChange",function(t){return e.hasMetadata=t})("ngModelChange",function(){return e.filterChanged()}),m.TgZ(21,"mat-radio-button",2),m._uU(22,"All"),m.qZA(),m.TgZ(23,"mat-radio-button",3),m._uU(24,"Has metadata"),m.qZA(),m.TgZ(25,"mat-radio-button",4),m._uU(26,"Has no metadata"),m.qZA(),m.qZA()),2&t&&(m.xp6(2),m.Q6J("ngModel",e.published),m.xp6(9),m.Q6J("ngModel",e.metadata),m.xp6(9),m.Q6J("ngModel",e.hasMetadata))},directives:[G.VQ,T.JJ,T.On,G.U0],styles:[".title[_ngcontent-%COMP%]{padding:12px 12px 0}.mat-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;overflow:hidden;padding:12px;width:160px;height:104px}"]}),t}(),D=n(447),P=n(1906),E=n(1305),R=n(8720),z=n(9529),V=n(7289),L=n(2935),j=n(3582),K=n(5223),H=n(5151),B=n(3841),X=n(7110),W=n(1271),tt=n(9572),et=n(4369);function nt(t,e){if(1&t&&(m.TgZ(0,"mat-option",26),m._uU(1),m.qZA()),2&t){var n=e.$implicit;m.Q6J("value",n.type),m.xp6(1),m.hij(" ",n.label," ")}}function it(t,e){if(1&t&&(m.TgZ(0,"mat-option",26),m._uU(1),m.qZA()),2&t){var n=m.oxw(2).ngIf;m.Q6J("value",n.formValues.targetType),m.xp6(1),m.hij(" ",n.formValues.targetType," ")}}function ot(t,e){if(1&t&&(m.TgZ(0,"mat-select",24),m.YNc(1,nt,2,2,"mat-option",12),m.YNc(2,it,2,2,"mat-option",25),m.qZA()),2&t){var n=m.oxw().ngIf,i=m.oxw();m.xp6(1),m.Q6J("ngForOf",i.targetTypeOptions),m.xp6(1),m.Q6J("ngIf",n.unknownTargetType)}}function rt(t,e){1&t&&m._UZ(0,"input",27)}function at(t,e){1&t&&(m.TgZ(0,"app-field-hint",28),m._uU(1," Warning: you entered an unknown target type. This may work or may not. Please be sure you know what you're doing "),m.qZA()),2&t&&m.Q6J("isError",!1)}function st(t,e){if(1&t&&(m.TgZ(0,"app-field-hint",28),m._uU(1),m.qZA()),2&t){var n=m.oxw().ngIf;m.Q6J("isError",!1),m.xp6(1),m.Oqu(n.targetTypeHint)}}function pt(t,e){1&t&&(m.TgZ(0,"app-field-hint",28),m._uU(1," This field is required "),m.qZA()),2&t&&m.Q6J("isError",!0)}function ut(t,e){1&t&&(m.TgZ(0,"app-field-hint",28),m._uU(1," Must be a whole number "),m.qZA()),2&t&&m.Q6J("isError",!0)}function ct(t,e){if(1&t&&(m.TgZ(0,"mat-option",26),m._uU(1),m.qZA()),2&t){var n=e.$implicit;m.Q6J("value",n),m.xp6(1),m.hij(" ",n," ")}}function lt(t,e){1&t&&(m.TgZ(0,"app-field-hint",28),m._uU(1," This field is required "),m.qZA()),2&t&&m.Q6J("isError",!0)}function dt(t,e){if(1&t&&(m.TgZ(0,"mat-option",26),m._uU(1),m.qZA()),2&t){var n=e.$implicit;m.Q6J("value",n.StaticName),m.xp6(1),m.hij(" ",n.Label," ")}}function ft(t,e){if(1&t&&(m.TgZ(0,"mat-form-field",7),m.TgZ(1,"mat-label"),m._uU(2,"Content Type"),m.qZA(),m.TgZ(3,"mat-select",29),m.YNc(4,dt,2,2,"mat-option",12),m.qZA(),m.qZA()),2&t){var n=m.oxw().ngIf;m.xp6(3),m.Q6J("placeholder",n.contentTypes.length?"":"No items found"),m.xp6(1),m.Q6J("ngForOf",n.contentTypes)}}function ht(t,e){if(1&t&&(m.TgZ(0,"mat-option",26),m._uU(1),m.qZA()),2&t){var n=e.$implicit;m.Q6J("value",n.value),m.xp6(1),m.hij(" ",n.name," ")}}function gt(t,e){if(1&t&&(m.TgZ(0,"mat-form-field",7),m.TgZ(1,"mat-label"),m._uU(2,"Scope"),m.qZA(),m.TgZ(3,"mat-select",30),m.YNc(4,ht,2,2,"mat-option",12),m.TgZ(5,"mat-option",26),m._uU(6,"Other..."),m.qZA(),m.qZA(),m.qZA()),2&t){var n=m.oxw().ngIf,i=m.oxw();m.xp6(3),m.Q6J("placeholder",n.scopeOptions.length?"":"No items found"),m.xp6(1),m.Q6J("ngForOf",n.scopeOptions),m.xp6(1),m.Q6J("value",i.dropdownInsertValue)}}function mt(t,e){1&t&&m.GkF(0)}function yt(t,e){if(1&t&&(m.TgZ(0,"mat-option",26),m._uU(1),m.qZA()),2&t){var n=e.$implicit;m.Q6J("value",n.Guid),m.xp6(1),m.AsE(" ",n.Title," (",n.Id,") ")}}function vt(t,e){if(1&t&&(m.TgZ(0,"mat-select",36),m.YNc(1,yt,2,3,"mat-option",12),m.qZA()),2&t){var n=m.oxw(3).ngIf;m.Q6J("placeholder",n.contentItems.length?"":"No items found"),m.xp6(1),m.Q6J("ngForOf",n.contentItems)}}function Tt(t,e){1&t&&m._UZ(0,"input",37)}function xt(t,e){if(1&t&&(m.ynx(0),m.YNc(1,vt,2,2,"mat-select",34),m.YNc(2,Tt,1,0,"input",35),m.BQk()),2&t){var n=m.oxw(2).ngIf;m.xp6(1),m.Q6J("ngIf",n.guidedKey),m.xp6(1),m.Q6J("ngIf",!n.guidedKey)}}function Ct(t,e){if(1&t&&(m.TgZ(0,"mat-option",26),m._uU(1),m.qZA()),2&t){var n=e.$implicit;m.Q6J("value",n.StaticName),m.xp6(1),m.hij(" ",n.Label," ")}}function Zt(t,e){if(1&t&&(m.TgZ(0,"mat-select",36),m.YNc(1,Ct,2,2,"mat-option",12),m.qZA()),2&t){var n=m.oxw(3).ngIf;m.Q6J("placeholder",n.contentTypes.length?"":"No items found"),m.xp6(1),m.Q6J("ngForOf",n.contentTypes)}}function bt(t,e){1&t&&m._UZ(0,"input",37)}function It(t,e){if(1&t&&(m.ynx(0),m.YNc(1,Zt,2,2,"mat-select",34),m.YNc(2,bt,1,0,"input",35),m.BQk()),2&t){var n=m.oxw(2).ngIf;m.xp6(1),m.Q6J("ngIf",n.guidedKey),m.xp6(1),m.Q6J("ngIf",!n.guidedKey)}}function kt(t,e){1&t&&m.GkF(0)}function _t(t,e){if(1&t&&(m.ynx(0),m.YNc(1,kt,1,0,"ng-container",38),m.BQk()),2&t){m.oxw(2);var n=m.MAs(39);m.xp6(1),m.Q6J("ngTemplateOutlet",n)}}function At(t,e){if(1&t&&(m.ynx(0,31),m.YNc(1,xt,3,2,"ng-container",32),m.YNc(2,It,3,2,"ng-container",32),m.YNc(3,_t,2,1,"ng-container",33),m.BQk()),2&t){var n=m.oxw().ngIf,i=m.oxw();m.Q6J("ngSwitch",n.formValues.targetType),m.xp6(1),m.Q6J("ngSwitchCase",i.eavConstants.metadata.entity.type),m.xp6(1),m.Q6J("ngSwitchCase",i.eavConstants.metadata.contentType.type)}}function wt(t,e){1&t&&m._UZ(0,"input",37)}function qt(t,e){1&t&&m._UZ(0,"input",40)}function Nt(t,e){if(1&t&&(m.YNc(0,wt,1,0,"input",35),m.YNc(1,qt,1,0,"input",39)),2&t){var n=m.oxw().ngIf,i=m.oxw();m.Q6J("ngIf",n.formValues.keyType!==i.eavConstants.keyTypes.number),m.xp6(1),m.Q6J("ngIf",n.formValues.keyType===i.eavConstants.keyTypes.number)}}var Mt=function(t){return{active:t}};function St(t,e){if(1&t){var n=m.EpF();m.TgZ(0,"div",41),m.TgZ(1,"button",42),m.NdJ("click",function(){return m.CHM(n),m.oxw(2).toggleGuidedKey(!0)}),m.TgZ(2,"mat-icon"),m._uU(3,"search"),m.qZA(),m.qZA(),m.TgZ(4,"button",43),m.NdJ("click",function(){return m.CHM(n),m.oxw(2).toggleGuidedKey(!1)}),m.TgZ(5,"mat-icon"),m._uU(6,"text_fields"),m.qZA(),m.qZA(),m.qZA()}if(2&t){var i=m.oxw().ngIf;m.xp6(1),m.Q6J("ngClass",m.VKq(2,Mt,i.guidedKey)),m.xp6(3),m.Q6J("ngClass",m.VKq(4,Mt,!i.guidedKey))}}function Ft(t,e){1&t&&(m.TgZ(0,"app-field-hint",28),m._uU(1," This field is required "),m.qZA()),2&t&&m.Q6J("isError",!0)}function Ut(t,e){1&t&&(m.TgZ(0,"app-field-hint",28),m._uU(1," Must be a whole number "),m.qZA()),2&t&&m.Q6J("isError",!0)}function Jt(t,e){1&t&&(m.TgZ(0,"app-field-hint",28),m._uU(1," Must be a valid GUID "),m.qZA()),2&t&&m.Q6J("isError",!0)}function Ot(t,e){if(1&t){var n=m.EpF();m.ynx(0),m.TgZ(1,"div",1),m.TgZ(2,"div",2),m._uU(3,"Create Metadata"),m.qZA(),m.qZA(),m.TgZ(4,"p",3),m._uU(5," This is a special operation to add an item which is metadata for another item, see "),m.TgZ(6,"a",4),m._uU(7,"docs"),m.qZA(),m._uU(8,". "),m.qZA(),m.TgZ(9,"form",5),m.TgZ(10,"div",6),m.TgZ(11,"mat-form-field",7),m.TgZ(12,"mat-label"),m._uU(13,"Target"),m.qZA(),m.YNc(14,ot,3,2,"mat-select",8),m.YNc(15,rt,1,0,"input",9),m.qZA(),m.YNc(16,at,2,1,"app-field-hint",10),m.YNc(17,st,2,2,"app-field-hint",10),m.YNc(18,pt,2,1,"app-field-hint",10),m.YNc(19,ut,2,1,"app-field-hint",10),m.TgZ(20,"mat-form-field",7),m.TgZ(21,"mat-label"),m._uU(22,"Key type"),m.qZA(),m.TgZ(23,"mat-select",11),m.YNc(24,ct,2,2,"mat-option",12),m.qZA(),m.qZA(),m.YNc(25,lt,2,1,"app-field-hint",10),m.YNc(26,ft,5,2,"mat-form-field",13),m.YNc(27,gt,7,3,"mat-form-field",13),m.TgZ(28,"app-field-hint"),m._uU(29," The scope should almost never be changed - "),m.TgZ(30,"a",14),m._uU(31,"see help"),m.qZA(),m.qZA(),m.TgZ(32,"mat-form-field",7),m.TgZ(33,"mat-label"),m._uU(34,"Key"),m.qZA(),m.YNc(35,mt,1,0,"ng-container",15),m.YNc(36,At,4,3,"ng-template",null,16,m.W1O),m.YNc(38,Nt,2,2,"ng-template",null,17,m.W1O),m.YNc(40,St,7,6,"div",18),m.qZA(),m.YNc(41,Ft,2,1,"app-field-hint",10),m.YNc(42,Ut,2,1,"app-field-hint",10),m.YNc(43,Jt,2,1,"app-field-hint",10),m.qZA(),m.TgZ(44,"div",19),m.TgZ(45,"mat-slide-toggle",20),m.NdJ("change",function(t){return m.CHM(n),m.oxw().toggleGuidedMode(t)}),m._uU(46),m.qZA(),m._UZ(47,"div",21),m.TgZ(48,"button",22),m.NdJ("click",function(){return m.CHM(n),m.oxw().closeDialog()}),m._uU(49,"Cancel"),m.qZA(),m.TgZ(50,"button",23),m.NdJ("click",function(){return m.CHM(n),m.oxw().confirm()}),m._uU(51," Confirm "),m.qZA(),m.qZA(),m.qZA(),m.BQk()}if(2&t){var i=e.ngIf,o=m.MAs(37),r=m.MAs(39),a=m.oxw();m.xp6(9),m.Q6J("formGroup",a.form),m.xp6(5),m.Q6J("ngIf",i.guidedMode),m.xp6(1),m.Q6J("ngIf",!i.guidedMode),m.xp6(1),m.Q6J("ngIf",a.form.controls.targetType.touched&&!a.form.controls.targetType.invalid&&i.unknownTargetType),m.xp6(1),m.Q6J("ngIf",i.targetTypeHint),m.xp6(1),m.Q6J("ngIf",a.form.controls.targetType.touched&&(null==a.form.controls.targetType.errors?null:a.form.controls.targetType.errors.required)),m.xp6(1),m.Q6J("ngIf",a.form.controls.targetType.touched&&(null==a.form.controls.targetType.errors?null:a.form.controls.targetType.errors.pattern)),m.xp6(5),m.Q6J("ngForOf",i.keyTypeOptions),m.xp6(1),m.Q6J("ngIf",a.form.controls.keyType.touched&&(null==a.form.controls.keyType.errors?null:a.form.controls.keyType.errors.required)),m.xp6(1),m.Q6J("ngIf",i.guidedMode&&i.formValues.targetType===a.eavConstants.metadata.entity.type),m.xp6(1),m.Q6J("ngIf",i.guidedMode&&(i.formValues.targetType===a.eavConstants.metadata.entity.type||i.formValues.targetType===a.eavConstants.metadata.contentType.type)),m.xp6(8),m.Q6J("ngIf",i.guidedMode)("ngIfThen",o)("ngIfElse",r),m.xp6(5),m.Q6J("ngIf",i.guidedMode&&i.guidedKeyExists),m.xp6(1),m.Q6J("ngIf",a.form.controls.key.touched&&(null==a.form.controls.key.errors?null:a.form.controls.key.errors.required)),m.xp6(1),m.Q6J("ngIf",a.form.controls.key.touched&&(null==a.form.controls.key.errors?null:a.form.controls.key.errors.patternWholeNumber)),m.xp6(1),m.Q6J("ngIf",a.form.controls.key.touched&&(null==a.form.controls.key.errors?null:a.form.controls.key.errors.patternGuid)),m.xp6(2),m.Q6J("tippy",i.guidedMode?"Guided mode helps you select options that work":"Manual mode is for advanced uses and allows you to insert any values")("checked",i.guidedMode),m.xp6(1),m.hij(" ",i.guidedMode?"Guided":"Manual"," "),m.xp6(4),m.Q6J("disabled",!a.form.valid)}}var $t=function(){function t(t,e,n,i){this.dialogRef=t,this.context=e,this.contentItemsService=n,this.contentTypesService=i,this.hostClass="dialog-component",this.eavConstants=I.Z,this.dropdownInsertValue=z.G}return t.prototype.ngOnInit=function(){var t,e=this;this.subscription=new s.w,this.targetTypeOptions=Object.values(I.Z.metadata).map(function(t){return(0,i.pi)({},t)}),this.keyTypeOptions=Object.values(I.Z.keyTypes),this.keyTypeOptions$=new a.X([]),this.scopeOptions$=new a.X([]),this.guidedMode$=new a.X(!0),this.contentItems$=new a.X([]),this.contentTypes$=new a.X([]),this.guidedKey$=new a.X(!0),this.fetchScopes(),this.form=new T.cw({}),this.form.addControl("targetType",new T.NI(I.Z.metadata.entity.type,[T.kI.required,T.kI.pattern(/^[0-9]+$/)])),this.form.addControl("keyType",new T.NI(I.Z.metadata.entity.keyType,[T.kI.required])),this.form.addControl("contentTypeForContentItems",new T.NI(null)),this.form.addControl("scopeForContentTypes",new T.NI(I.Z.scopes.default.value)),this.form.addControl("key",new T.NI(null,[T.kI.required,(t=this.form,function(e){if(!e.value)return null;var n=t.controls.keyType.value,i=e.value.toString();switch(n){case I.Z.keyTypes.number:return/^[0-9]+$/.test(i)?null:{patternWholeNumber:!0};case I.Z.keyTypes.guid:var o=["{","}"].some(function(t){return i.includes(t)}),r=i.substring(o?1:0,o?i.length-1:i.length);return(0,V.M)().test(r)?null:{patternGuid:!0};case I.Z.keyTypes.string:default:return null}})])),this.subscription.add(this.form.controls.scopeForContentTypes.valueChanges.pipe((0,c.O)(this.form.controls.scopeForContentTypes.value),(0,R.x)()).subscribe(function(t){null!=e.form.controls.contentTypeForContentItems.value&&e.form.controls.contentTypeForContentItems.patchValue(null),t===z.G?(t=prompt("This is an advanced feature to show content-types of another scope. Don't use this if you don't know what you're doing, as content-types of other scopes are usually hidden for a good reason.")||I.Z.scopes.default.value,e.scopeOptions$.value.some(function(e){return e.value===t})||e.scopeOptions$.next((0,i.ev)([{name:t,value:t}],(0,i.CR)(e.scopeOptions$.value))),e.form.controls.scopeForContentTypes.patchValue(t)):e.fetchContentTypes(t)})),this.subscription.add((0,P.T)(this.form.controls.targetType.valueChanges.pipe((0,R.x)()),this.form.controls.keyType.valueChanges.pipe((0,R.x)())).subscribe(function(){e.guidedKey$.next(!0),null!=e.form.getRawValue().key&&e.form.patchValue({key:null})})),this.subscription.add(this.form.controls.contentTypeForContentItems.valueChanges.pipe((0,c.O)(this.form.controls.contentTypeForContentItems.value),(0,R.x)()).subscribe(function(t){var n=e.form.getRawValue();n.targetType===I.Z.metadata.entity.type&&null!=n.key&&e.form.patchValue({key:null}),e.contentItemsService.getAll(t).subscribe(function(t){e.contentItems$.next(t)})}));var n=this.form.valueChanges.pipe((0,c.O)(this.form.getRawValue()),(0,l.U)(function(){return e.form.getRawValue()}),(0,R.x)(D.iX.objectsEqual));this.subscription.add((0,E.aj)([n,this.guidedMode$]).subscribe(function(t){var n=(0,i.CR)(t,2),o=n[0],r=n[1],a=e.targetTypeOptions.find(function(t){return t.type===o.targetType}),s=r&&a?[a.keyType]:(0,i.ev)([],(0,i.CR)(e.keyTypeOptions));D.iX.arraysEqual(s,e.keyTypeOptions$.value)||e.keyTypeOptions$.next(s);var p={};e.keyTypeOptions$.value.includes(o.keyType)||(p.keyType=e.keyTypeOptions$.value[0]);var u=r&&o.targetType===I.Z.metadata.app.type;u&&o.key!==e.context.appId&&(p.key=e.context.appId),Object.keys(p).length&&e.form.patchValue(p),D.iX.disableControl(e.form.controls.keyType,r&&e.keyTypeOptions$.value.length<=1),D.iX.disableControl(e.form.controls.key,u)})),this.templateVars$=(0,E.aj)([(0,E.aj)([this.guidedMode$,this.keyTypeOptions$,this.scopeOptions$,this.contentItems$,this.contentTypes$]),(0,E.aj)([n,this.guidedKey$])]).pipe((0,l.U)(function(t){var n,o=(0,i.CR)(t,2),r=(0,i.CR)(o[0],5),a=r[0],s=r[1],p=r[2],u=r[3],c=r[4],l=(0,i.CR)(o[1],2),d=l[0],f=l[1];return{guidedMode:a,unknownTargetType:!e.targetTypeOptions.some(function(t){return t.type===d.targetType}),targetTypeHint:a&&(null===(n=e.targetTypeOptions.find(function(t){return t.type===d.targetType}))||void 0===n?void 0:n.hint),keyTypeOptions:s,scopeOptions:p,guidedKey:f,guidedKeyExists:[I.Z.metadata.entity.type,I.Z.metadata.contentType.type].includes(d.targetType),formValues:d,contentItems:u,contentTypes:c}}))},t.prototype.ngOnDestroy=function(){this.guidedMode$.complete(),this.keyTypeOptions$.complete(),this.contentItems$.complete(),this.contentTypes$.complete(),this.guidedKey$.complete(),this.subscription.unsubscribe()},t.prototype.closeDialog=function(t){this.dialogRef.close(t)},t.prototype.toggleGuidedKey=function(t){this.guidedKey$.next(t)},t.prototype.toggleGuidedMode=function(t){this.guidedMode$.next(t.checked)},t.prototype.confirm=function(){var t,e,n=this.form.getRawValue(),i={target:null!==(e=null===(t=this.targetTypeOptions.find(function(t){return t.type===n.targetType}))||void 0===t?void 0:t.target)&&void 0!==e?e:n.targetType.toString(),keyType:n.keyType,key:n.keyType===I.Z.keyTypes.guid?n.key.replace(/{|}/g,""):n.key.toString()};this.closeDialog(i)},t.prototype.fetchContentTypes=function(t){var e=this;this.contentTypesService.retrieveContentTypes(t).subscribe(function(t){e.contentTypes$.next(t)})},t.prototype.fetchScopes=function(){var t=this;this.contentTypesService.getScopes().subscribe(function(e){t.scopeOptions$.next(e)})},t.\u0275fac=function(e){return new(e||t)(m.Y36(L.so),m.Y36(j._),m.Y36(K.l),m.Y36(H.sF))},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-create-metadata-dialog"]],hostVars:1,hostBindings:function(t,e){2&t&&m.Ikx("className",e.hostClass)},decls:2,vars:3,consts:[[4,"ngIf"],["mat-dialog-title",""],[1,"dialog-title-box"],[1,"dialog-description"],["href","http://r.2sxc.org/metadata","target","_blank"],[1,"dialog-form",3,"formGroup"],[1,"dialog-form-content","fancy-scrollbar-light"],["appearance","standard","color","accent"],["formControlName","targetType","required","",4,"ngIf"],["matInput","","type","number","min","0","formControlName","targetType","required","",4,"ngIf"],[3,"isError",4,"ngIf"],["formControlName","keyType","required",""],[3,"value",4,"ngFor","ngForOf"],["appearance","standard","color","accent",4,"ngIf"],["href","https://2sxc.org/help?tag=scope","target","_blank","appClickStopPropagation",""],[4,"ngIf","ngIfThen","ngIfElse"],["specialKeyInputs",""],["defaultKeyInput",""],["matSuffix","","class","selection-suffix",4,"ngIf"],[1,"dialog-form-actions"],["color","accent",3,"tippy","checked","change"],[1,"spacer"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],["formControlName","targetType","required",""],[3,"value",4,"ngIf"],[3,"value"],["matInput","","type","number","min","0","formControlName","targetType","required",""],[3,"isError"],["formControlName","contentTypeForContentItems",3,"placeholder"],["formControlName","scopeForContentTypes",3,"placeholder"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["formControlName","key","required","",3,"placeholder",4,"ngIf"],["matInput","","type","text","formControlName","key","required","",4,"ngIf"],["formControlName","key","required","",3,"placeholder"],["matInput","","type","text","formControlName","key","required",""],[4,"ngTemplateOutlet"],["matInput","","type","number","formControlName","key","required","",4,"ngIf"],["matInput","","type","number","formControlName","key","required",""],["matSuffix","",1,"selection-suffix"],["mat-icon-button","","type","button","tippy","Pick existing value",3,"ngClass","click"],["mat-icon-button","","type","button","tippy","Manual entry",3,"ngClass","click"]],template:function(t,e){1&t&&(m.YNc(0,Ot,52,22,"ng-container",0),m.ALo(1,"async")),2&t&&m.Q6J("ngIf",m.lcZ(1,1,e.templateVars$))},directives:[F.O5,L.uh,T._Y,T.JL,T.sg,y.KE,y.hX,B.gD,T.JJ,T.u,T.Q7,F.sg,X.Y,W.E,tt.Rr,q.$,et.lW,w.ey,v.Nt,T.qQ,T.wV,T.Fj,F.RF,F.n9,F.ED,F.tP,y.R9,F.mk,N.Hw],pipes:[F.Ov],styles:[".dialog-form-content[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]:not(:first-of-type){margin-top:8px}"]}),t}(),Qt=n(2832),Gt=n(7553),Yt=n(3653),Dt=n(3589),Pt=n(9886),Et=n(6146),Rt=n(9825),zt=n(5921),Vt=n(6207);function Lt(t,e){1&t&&(m._UZ(0,"div",14),m.ALo(1,"safeHtml")),2&t&&m.Q6J("innerHTML",m.lcZ(1,1,e.ngIf),m.oJD)}function jt(t,e){if(1&t){var n=m.EpF();m.TgZ(0,"button",15),m.NdJ("click",function(){return m.CHM(n),m.oxw().debugFilter()}),m.TgZ(1,"mat-icon"),m._uU(2,"filter_list"),m.qZA(),m.TgZ(3,"span"),m._uU(4,"Filter"),m.qZA(),m.qZA()}}var Kt=function(){function t(t,e,n,r,p,u,c,l,d,f,h,m){this.dialogRef=t,this.contentTypesService=e,this.router=n,this.route=r,this.contentItemsService=p,this.entitiesService=u,this.contentExportService=c,this.snackBar=l,this.globalConfigService=d,this.dialog=f,this.viewContainerRef=h,this.changeDetectorRef=m,this.contentType$=new a.X(null),this.items$=new a.X(null),this.debugEnabled$=this.globalConfigService.getDebugEnabled$(),this.modules=o.F$,this.gridOptions=(0,i.pi)((0,i.pi)({},b.f),{frameworkComponents:{pubMetaFilterComponent:Y,booleanFilterComponent:g.U,entityFilterComponent:C,idFieldComponent:Z.m,contentItemsStatusComponent:Q,contentItemsActionsComponent:S,contentItemsEntityComponent:J}}),this.gridApi$=new a.X(null),this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName"),this.subscription=new s.w}return t.prototype.ngOnInit=function(){this.fetchContentType(),this.fetchItems(),this.fetchColumns(),this.refreshOnChildClosed()},t.prototype.ngOnDestroy=function(){this.contentType$.complete(),this.items$.complete(),this.gridApi$.complete(),this.subscription.unsubscribe()},t.prototype.closeDialog=function(){this.dialogRef.close()},t.prototype.onGridReady=function(t){this.gridApi$.next(t.api)},t.prototype.fetchContentType=function(){var t=this;this.contentTypesService.retrieveContentType(this.contentTypeStaticName).subscribe(function(e){t.contentType$.next(e)})},t.prototype.fetchItems=function(){var t=this;this.contentItemsService.getAll(this.contentTypeStaticName).subscribe(function(e){t.items$.next(e)})},t.prototype.fetchColumns=function(){var t=this;this.contentItemsService.getColumns(this.contentTypeStaticName).subscribe(function(e){var n=t.buildColumnDefs(e),o=function(t,e){var n,o;if(t){var r;"="===t.charAt(t.length-1)&&(t=atob(t));try{r=JSON.parse(t)}catch(p){console.error("Can't parse JSON with filters from url:",t)}if(r){var a={};if(r.IsPublished||r.IsMetadata){var s={filterType:"pub-meta",published:null!==(n=r.IsPublished)&&void 0!==n?n:"",metadata:null!==(o=r.IsMetadata)&&void 0!==o?o:"",hasMetadata:""};a.Status=s}return Object.entries(r).filter(function(t){var e=(0,i.CR)(t,2)[0];return"IsPublished"!==e&&"IsMetadata"!==e}).forEach(function(t){var n,o=(0,i.CR)(t,2),r=o[0],s=o[1],p=e.find(function(t){return t.headerName===r});if("entityFilterComponent"!==(null==p?void 0:p.filter))"string"==typeof s?a[r]=u={filterType:"text",type:"equals",filter:s}:"number"==typeof s?a[r]=u={filterType:"number",type:"equals",filter:s,filterTo:null}:"boolean"==typeof s&&(u={filterType:"boolean",filter:s.toString()},a[r]=u);else{var u={filterType:"entity",filter:"string"==typeof(s=null!==(n=D.iX.tryParse(s))&&void 0!==n?n:s)?s:void 0,idFilter:"number"==typeof s?[s]:Array.isArray(s)?s.filter(function(t){return"number"==typeof t}):void 0};a[r]=u}}),a}}}(sessionStorage.getItem(k.JA),n);t.gridApi$.value?t.setColumnDefs(n,o):t.gridApi$.pipe((0,p.h)(function(t){return null!=t}),(0,u.q)(1)).subscribe(function(e){t.setColumnDefs(n,o)})})},t.prototype.setColumnDefs=function(t,e){this.gridApi$.value.setColumnDefs(t),e&&((0,_.P)("Will try to apply filter:",e),this.gridApi$.value.setFilterModel(e))},t.prototype.openMetadata=function(t){var e=h.U.getUrlEntity(t.Guid,"Metadata for Entity: "+t._Title+" ("+t.Id+")",this.contentTypeStaticName);this.router.navigate([e],{relativeTo:this.route})},t.prototype.editItem=function(t){var e=null==t?void 0:t.data,n=(0,A.f)({items:[null==e?{ContentTypeName:this.contentTypeStaticName}:{EntityId:e.Id}]});this.router.navigate(["edit/"+n],{relativeTo:this.route})},t.prototype.exportContent=function(){var t=this.gridApi$.value.getFilterModel(),e=Object.keys(t).length>0,n=[];e&&this.gridApi$.value.forEachNodeAfterFilterAndSort(function(t){n.push(t.data.Id)}),this.router.navigate(["export/"+this.contentTypeStaticName+(n.length>0?"/"+n:"")],{relativeTo:this.route})},t.prototype.filesDropped=function(t){var e=t[0];switch(e.name.substring(e.name.lastIndexOf(".")+1).toLocaleLowerCase()){case"xml":this.importContent(t);break;case"json":this.importItem(t)}},t.prototype.importContent=function(t){this.router.navigate([this.contentTypeStaticName+"/import"],{relativeTo:this.route,state:{files:t}})},t.prototype.importItem=function(t){this.router.navigate(["import"],{relativeTo:this.route,state:{files:t}})},t.prototype.createMetadata=function(){var t=this;this.dialog.open($t,{autoFocus:!1,viewContainerRef:this.viewContainerRef,width:"650px"}).afterClosed().pipe((0,u.q)(1)).subscribe(function(e){if(null!=e){var n={items:[{ContentTypeName:t.contentTypeStaticName,For:(0,i.pi)((0,i.pi)((0,i.pi)({Target:e.target},e.keyType===I.Z.keyTypes.guid&&{Guid:e.key}),e.keyType===I.Z.keyTypes.number&&{Number:parseInt(e.key,10)}),e.keyType===I.Z.keyTypes.string&&{String:e.key})}]},o=(0,A.f)(n);t.router.navigate(["edit/"+o],{relativeTo:t.route}),t.changeDetectorRef.markForCheck()}})},t.prototype.debugFilter=function(){console.warn("Current filter:",this.gridApi$.value.getFilterModel()),alert("Check console for filter information")},t.prototype.refreshOnChildClosed=function(){var t=this;this.subscription.add(this.router.events.pipe((0,p.h)(function(t){return t instanceof r.m2}),(0,c.O)(!!this.route.snapshot.firstChild),(0,l.U)(function(){return!!t.route.snapshot.firstChild}),(0,d.G)(),(0,p.h)(function(t){var e=(0,i.CR)(t,2);return e[0]&&!e[1]})).subscribe(function(){t.fetchItems()}))},t.prototype.buildColumnDefs=function(t){var e,n,o=[{headerName:"ID",field:"Id",width:70,headerClass:"dense",cellClass:"id-action no-padding no-outline",cellRenderer:"idFieldComponent",sortable:!0,filter:"agTextColumnFilter",cellRendererParams:{tooltipGetter:function(t){return"ID: "+t.Id+"\nRepoID: "+t._RepositoryId+"\nGUID: "+t.Guid}}},{headerName:"Status",field:"Status",width:82,headerClass:"dense",cellClass:"secondary-action no-padding",filter:"pubMetaFilterComponent",cellRenderer:"contentItemsStatusComponent",valueGetter:this.valueGetterStatus,cellRendererParams:{onOpenMetadata:this.openMetadata.bind(this)}},{headerName:"Item (Entity)",field:"_Title",flex:2,minWidth:250,cellClass:"primary-action highlight",sortable:!0,filter:"agTextColumnFilter",onCellClicked:this.editItem.bind(this)},{headerName:"Stats",headerTooltip:"Used by others / uses others",field:"_Used",width:70,headerClass:"dense",cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:this.valueGetterUsage},{cellClass:"secondary-action no-padding",width:122,cellRenderer:"contentItemsActionsComponent",pinned:"right",cellRendererParams:{onClone:this.clone.bind(this),onExport:this.export.bind(this),onDelete:this.delete.bind(this)}}];try{for(var r=(0,i.XA)(t),a=r.next();!a.done;a=r.next()){var s=a.value,p={headerName:s.StaticName,field:s.StaticName,flex:2,minWidth:250,cellClass:"no-outline",sortable:!0};switch(s.Type){case f.Q.Entity:try{p.allowMultiValue=s.Metadata.Entity.AllowMultiValue}catch(u){p.allowMultiValue=!0}p.cellRenderer="contentItemsEntityComponent",p.valueGetter=this.valueGetterEntityField,p.filter="entityFilterComponent";break;case f.Q.DateTime:try{p.useTimePicker=s.Metadata.DateTime.UseTimePicker}catch(u){p.useTimePicker=!1}p.valueGetter=this.valueGetterDateTime,p.filter="agTextColumnFilter";break;case f.Q.Boolean:p.valueGetter=this.valueGetterBoolean,p.filter="booleanFilterComponent";break;case f.Q.Number:p.filter="agNumberColumnFilter";break;default:p.filter="agTextColumnFilter"}o.push(p)}}catch(c){e={error:c}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return o},t.prototype.clone=function(t){var e=(0,A.f)({items:[{ContentTypeName:this.contentTypeStaticName,DuplicateEntity:t.Id}]});this.router.navigate(["edit/"+e],{relativeTo:this.route})},t.prototype.export=function(t){this.contentExportService.exportEntity(t.Id,this.contentTypeStaticName,!0)},t.prototype.delete=function(t){var e=this;confirm("Delete '"+t._Title+"' ("+t._RepositoryId+")?")&&(this.snackBar.open("Deleting..."),this.entitiesService.delete(this.contentTypeStaticName,t._RepositoryId,!1).subscribe({next:function(){e.snackBar.open("Deleted",null,{duration:2e3}),e.fetchItems()},error:function(n){e.snackBar.dismiss(),confirm(n.error.ExceptionMessage+"\n\nDo you want to force delete '"+t._Title+"' ("+t._RepositoryId+")?")&&(e.snackBar.open("Deleting..."),e.entitiesService.delete(e.contentTypeStaticName,t._RepositoryId,!0).subscribe(function(){e.snackBar.open("Deleted",null,{duration:2e3}),e.fetchItems()}))}}))},t.prototype.valueGetterStatus=function(t){var e=t.data;return{published:e.IsPublished,metadata:!!e.For,hasMetadata:!!e.Metadata&&e.Metadata.length>0}},t.prototype.valueGetterUsage=function(t){var e=t.data;return e._Used+" / "+e._Uses},t.prototype.valueGetterEntityField=function(t){var e=t.data[t.colDef.field];return 0===e.length?null:e.map(function(t){return t.Title})},t.prototype.valueGetterDateTime=function(t){var e=t.data[t.colDef.field];return e?t.colDef.useTimePicker?e.substring(0,19).replace("T"," "):e.substring(0,10):null},t.prototype.valueGetterBoolean=function(t){var e=t.data[t.colDef.field];return"boolean"!=typeof e?null:e.toString()},t.\u0275fac=function(e){return new(e||t)(m.Y36(L.so),m.Y36(Qt.s),m.Y36(r.F0),m.Y36(r.gz),m.Y36(K.l),m.Y36(Gt.g),m.Y36(Yt.i),m.Y36(Dt.ux),m.Y36(Pt.bE),m.Y36(L.uw),m.Y36(m.s_b),m.Y36(m.sBO))},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-content-items"]],decls:41,vars:15,consts:[["appToggleDebug","",1,"nav-component-wrapper"],["mat-dialog-title",""],[1,"dialog-title-box"],["mat-icon-button","","tippy","Close dialog",3,"click"],[3,"innerHTML",4,"ngIf"],[1,"grid-wrapper"],["appDragAndDrop","",1,"ag-theme-material",3,"rowData","modules","gridOptions","allowedFileTypes","gridReady","filesDropped"],[1,"grid-more-actions-box"],["mat-button","","tippy","Export xml list",3,"click"],["mat-button","","tippy","Import xml list",3,"click"],["mat-button","","tippy","Import single json item",3,"click"],["mat-button","","tippy","Create metadata",3,"click"],["mat-button","","color","accent","tippy","Print filter to console",3,"click",4,"ngIf"],["mat-fab","","mat-elevation-z24","","tippy","Add item",1,"grid-fab",3,"click"],[3,"innerHTML"],["mat-button","","color","accent","tippy","Print filter to console",3,"click"]],template:function(t,e){var n,i;1&t&&(m.TgZ(0,"div",0),m.TgZ(1,"div",1),m.TgZ(2,"div",2),m.TgZ(3,"div"),m._uU(4),m.ALo(5,"async"),m.qZA(),m.TgZ(6,"button",3),m.NdJ("click",function(){return e.closeDialog()}),m.TgZ(7,"mat-icon"),m._uU(8,"close"),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m._UZ(9,"router-outlet"),m.YNc(10,Lt,2,3,"div",4),m.ALo(11,"async"),m.TgZ(12,"div",5),m.TgZ(13,"ag-grid-angular",6),m.NdJ("gridReady",function(t){return e.onGridReady(t)})("filesDropped",function(t){return e.filesDropped(t)}),m.ALo(14,"async"),m.qZA(),m.TgZ(15,"div",7),m.TgZ(16,"button",8),m.NdJ("click",function(){return e.exportContent()}),m.TgZ(17,"mat-icon"),m._uU(18,"cloud_download"),m.qZA(),m.TgZ(19,"span"),m._uU(20,"Data"),m.qZA(),m.qZA(),m.TgZ(21,"button",9),m.NdJ("click",function(){return e.importContent()}),m.TgZ(22,"mat-icon"),m._uU(23,"cloud_upload"),m.qZA(),m.TgZ(24,"span"),m._uU(25,"Data"),m.qZA(),m.qZA(),m.TgZ(26,"button",10),m.NdJ("click",function(){return e.importItem()}),m.TgZ(27,"mat-icon"),m._uU(28,"cloud_upload"),m.qZA(),m.TgZ(29,"span"),m._uU(30,"Item"),m.qZA(),m.qZA(),m.TgZ(31,"button",11),m.NdJ("click",function(){return e.createMetadata()}),m.TgZ(32,"mat-icon"),m._uU(33,"local_offer"),m.qZA(),m.TgZ(34,"span"),m._uU(35,"Create Metadata"),m.qZA(),m.qZA(),m.YNc(36,jt,5,0,"button",12),m.ALo(37,"async"),m.qZA(),m.TgZ(38,"button",13),m.NdJ("click",function(){return e.editItem(null)}),m.TgZ(39,"mat-icon"),m._uU(40,"add"),m.qZA(),m.qZA(),m.qZA(),m.qZA()),2&t&&(m.xp6(4),m.hij("",null==(n=m.lcZ(5,7,e.contentType$))?null:n.Name," Data"),m.xp6(6),m.Q6J("ngIf",null==(i=m.lcZ(11,9,e.contentType$))||null==i.Properties?null:i.Properties.ListInstructions),m.xp6(3),m.Q6J("rowData",m.lcZ(14,11,e.items$))("modules",e.modules)("gridOptions",e.gridOptions)("allowedFileTypes","xml,json"),m.xp6(23),m.Q6J("ngIf",m.lcZ(37,13,e.debugEnabled$)))},directives:[Et.D,L.uh,et.lW,q.$,N.Hw,r.lC,F.O5,Rt.N8,zt.z],pipes:[F.Ov,Vt.z],styles:[""]}),t}()},6466:function(t,e,n){"use strict";n.d(e,{H:function(){return s},a:function(){return p}});var i=n(1785),o=n(2693),r=n(3582),a=n(2837),s="admin/app/",p=function(){function t(t,e,n){this.http=t,this.context=e,this.dnnContext=n}return t.prototype.importApp=function(t,e){var n=new FormData;return n.append("File",t),n.append("Name",e||""),this.http.post(this.dnnContext.$2sxc.http.apiUrl(s+"Import"),n,{params:{zoneId:this.context.zoneId.toString()}})},t.\u0275fac=function(e){return new(e||t)(i.LFG(o.eN),i.LFG(r._),i.LFG(a._y))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t}()},7110:function(t,e,n){"use strict";n.d(e,{Y:function(){return f}});var i=n(1785),o=n(1116),r=n(3070);function a(t,e){1&t&&i.GkF(0)}function s(t,e){if(1&t&&(i.TgZ(0,"mat-hint"),i.YNc(1,a,1,0,"ng-container",3),i.qZA()),2&t){i.oxw();var n=i.MAs(4);i.xp6(1),i.Q6J("ngTemplateOutlet",n)}}function p(t,e){1&t&&i.GkF(0)}function u(t,e){if(1&t&&(i.TgZ(0,"mat-error"),i.YNc(1,p,1,0,"ng-container",3),i.qZA()),2&t){i.oxw();var n=i.MAs(4);i.xp6(1),i.Q6J("ngTemplateOutlet",n)}}function c(t,e){1&t&&i.Hsn(0)}var l=function(t){return{"hint-box__short":t}},d=["*"],f=function(){function t(){this.isError=!1,this.isShort=!0}return t.prototype.toggleIsShort=function(){this.isShort=!this.isShort},t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-field-hint"]],inputs:{isError:"isError"},ngContentSelectors:d,decls:5,vars:6,consts:[[1,"hint-box",3,"ngClass","ngSwitch","click"],[4,"ngSwitchCase"],["content",""],[4,"ngTemplateOutlet"]],template:function(t,e){1&t&&(i.F$t(),i.TgZ(0,"div",0),i.NdJ("click",function(){return e.toggleIsShort()}),i.YNc(1,s,2,1,"mat-hint",1),i.YNc(2,u,2,1,"mat-error",1),i.qZA(),i.YNc(3,c,1,0,"ng-template",null,2,i.W1O)),2&t&&(i.Q6J("ngClass",i.VKq(4,l,e.isShort))("ngSwitch",e.isError),i.xp6(1),i.Q6J("ngSwitchCase",!1),i.xp6(1),i.Q6J("ngSwitchCase",!0))},directives:[o.mk,o.RF,o.n9,r.bx,o.tP,r.TO],styles:[".hint-box[_ngcontent-%COMP%]{margin-top:4px}.hint-box[_ngcontent-%COMP%]   .mat-error[_ngcontent-%COMP%], .hint-box[_ngcontent-%COMP%]   .mat-hint[_ngcontent-%COMP%]{font-size:12px;display:block}.hint-box__short[_ngcontent-%COMP%]   .mat-error[_ngcontent-%COMP%], .hint-box__short[_ngcontent-%COMP%]   .mat-hint[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]}),t}()},6085:function(t,e,n){"use strict";n.d(e,{m:function(){return u}});var i=n(8838),o=n(1785),r=n(3589),a=n(7064),s=n(7512),p=n(7307),u=function(){function t(t){this.snackBar=t}return t.prototype.agInit=function(t){this.id=t.value,this.tooltip=t.tooltipGetter(t.data)},t.prototype.refresh=function(t){return!0},t.prototype.copy=function(){(0,i.v)(this.tooltip),this.snackBar.open("Copied to clipboard",null,{duration:2e3})},t.\u0275fac=function(e){return new(e||t)(o.Y36(r.ux))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-id-field"]],decls:5,vars:2,consts:[["matRipple","",1,"id-box","highlight",3,"tippy","click"],[1,"id"],[1,"icon"]],template:function(t,e){1&t&&(o.TgZ(0,"div",0),o.NdJ("click",function(){return e.copy()}),o.TgZ(1,"span",1),o._uU(2),o.qZA(),o.TgZ(3,"mat-icon",2),o._uU(4,"file_copy"),o.qZA(),o.qZA()),2&t&&(o.Q6J("tippy",e.tooltip),o.xp6(2),o.Oqu(e.id))},directives:[a.wG,s.$,p.Hw],styles:[".id-box[_ngcontent-%COMP%]{padding:0 8px;text-align:end;height:100%;display:flex;align-items:center;justify-content:flex-end}.id-box[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{max-width:100%;text-overflow:ellipsis;overflow:hidden}.id-box[_ngcontent-%COMP%]:hover{text-decoration:none}.id-box[_ngcontent-%COMP%]:hover   .id[_ngcontent-%COMP%], .id-box[_ngcontent-%COMP%]:not(:hover)   .icon[_ngcontent-%COMP%]{display:none}"]}),t}()},7289:function(t,e,n){"use strict";function i(){return/^[a-f0-9]{8}(?:-[a-f0-9]{4}){3}-[a-f0-9]{12}$/i}n.d(e,{M:function(){return i}})},1271:function(t,e,n){"use strict";n.d(e,{E:function(){return o}});var i=n(1785),o=function(){function t(){}return t.prototype.onClick=function(t){t.stopPropagation()},t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=i.lG2({type:t,selectors:[["","appClickStopPropagation",""]],hostBindings:function(t,e){1&t&&i.NdJ("click",function(t){return e.onClick(t)})}}),t}()},6146:function(t,e,n){"use strict";n.d(e,{D:function(){return r}});var i=n(1785),o=n(9886),r=function(){function t(t){this.globalConfigService=t}return t.prototype.onClick=function(t){(navigator.platform.match("Mac")?t.metaKey:t.ctrlKey)&&t.shiftKey&&t.altKey&&(this.globalConfigService.toggleDebugEnabled(),window.getSelection().removeAllRanges())},t.\u0275fac=function(e){return new(e||t)(i.Y36(o.bE))},t.\u0275dir=i.lG2({type:t,selectors:[["","appToggleDebug",""]],hostBindings:function(t,e){1&t&&i.NdJ("click",function(t){return e.onClick(t)})}}),t}()},8838:function(t,e,n){"use strict";function i(t){var e=document.createElement("textarea");e.value=t,e.setAttribute("readonly",""),e.style.position="absolute",e.style.left="-9999px",document.body.appendChild(e);var n=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);e.select(),document.execCommand("copy"),document.body.removeChild(e),n&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(n))}n.d(e,{v:function(){return i}})},6207:function(t,e,n){"use strict";n.d(e,{z:function(){return r}});var i=n(1785),o=n(9624),r=function(){function t(t){this.sanitizer=t}return t.prototype.transform=function(t){return this.sanitizer.bypassSecurityTrustHtml(t)},t.\u0275fac=function(e){return new(e||t)(i.Y36(o.H7,16))},t.\u0275pipe=i.Yjl({name:"safeHtml",type:t,pure:!0}),t}()}}]);
//# sourceMappingURL=https://sources.2sxc.org/13.00.00/ng-edit/projects_ng-dialogs_src_app_content-items_content-items_component_ts.84b7ddaebbb1d0ad434e.js.map