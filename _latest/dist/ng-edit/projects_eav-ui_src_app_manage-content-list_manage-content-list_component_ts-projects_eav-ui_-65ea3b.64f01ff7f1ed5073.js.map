{"version":3,"file":"projects_eav-ui_src_app_manage-content-list_manage-content-list_component_ts-projects_eav-ui_-65ea3b.64f01ff7f1ed5073.js","mappings":"0cAmCwB,IAAGA,EAAAC,2CArBbC,MAAA,UAAMA,MAAA,GAAoBA,QAC1BA,MAAA,eAA4CA,MAAA,mBAAAA,MAAAC,GAAA,MAAAC,EAAAF,MAAA,UAAAA,MAASE,EAAAC,aAAY,GAC/DH,MAAA,cAAUA,MAAA,UACZA,mCAHMA,cAAAE,EAAAE,SAAAC,8BAMNL,MAAA,8BAAAA,MAAA,IAAAA,MAAA,gEAXJA,MAAA,OACEA,MAAA,wBACFA,QACAA,MAAA,OAOEA,MANA,EAAAM,EAAA,IAMAN,CANqB,EAAAO,EAAA,KASvBP,+BAZEA,cAAA,IAAAA,MAAA,0CAGAA,MAAA,GAAAA,MAAA,EAAAE,EAAAE,SAAAI,KAAA,+BAYFR,MAAA,SACEA,MAAA,wBAGFA,qCAHEA,cAAA,IAAAA,MAAA,0BAAAE,EAAAO,YAAA,+BAAAC,EAAAR,EAAAS,SAAA,KAAAD,EAAAE,QAAA,iFAYIZ,MAFJ,UAEIA,CAF8B,WAE9BA,CAD+B,iBAC6CA,MAAA,iBAAWA,QACvFA,MAAA,aACEA,MAAA,GAEJA,UAGEA,MAFF,QAEEA,CAFG,oCAG0BA,MAAA,yBAAAa,EAAAb,MAAAc,GAAAC,UAAAb,EAAAF,MAAA,UAAAA,MAASE,EAAAc,gBAAAH,EAAAI,OAA2B,GAC/DjB,MAAA,cAAUA,MAAA,mBACZA,UACAA,MAAA,sCAC4CA,MAAA,yBAAAa,EAAAb,MAAAc,GAAAC,UAAAb,EAAAF,MAAA,UAAAA,MAASE,EAAAgB,SAAAL,EAAAI,OAAoB,GACvEjB,MAAA,eAAUA,MAAA,UACZA,UACAA,MAAA,sCAC2BA,MAAA,yBAAAa,EAAAb,MAAAc,GAAAC,UAAAb,EAAAF,MAAA,UAAAA,MAASE,EAAAiB,OAAAN,GAAY,GAC9Cb,MAAA,eAAUA,MAAA,aACZA,UACAA,MAAA,sCAC6BA,MAAA,yBAAAa,EAAAb,MAAAc,GAAAC,UAAAb,EAAAF,MAAA,UAAAA,MAASE,EAAAkB,SAAAP,EAAAd,IAAiB,GACrDC,MAAA,eAAUA,MAAA,WAGhBA,qDAvB2CA,MAAA,GAAAA,MAAA,WAAAa,EAAAR,MAAA,KAAAQ,EAAAd,GAAA,KACrCC,cAAA,IAAAa,EAAAR,MAAA,KAAAQ,EAAAd,GAAA,MAKsBC,MAAA,GACtBA,MADsB,QAAAA,MAAA,sCACtBA,CAD2E,eAAAa,EAAAd,IAIrDC,MAAA,GACtBA,MADsB,QAAAA,MAAA,oCACtBA,CADwE,eAAAa,EAAAd,IAAAG,EAAAO,aAIlDT,MAAA,GACtBA,MADsB,QAAAA,MAAA,8BACtBA,CADkE,WAAAE,EAAAO,aAI5CT,MAAA,GACtBA,MADsB,QAAAA,MAAA,4BACtBA,CADgE,eAAAa,EAAAd,6CAtD5EC,MAFJ,UAEIA,CAFqC,UAErCA,CAD6B,WACSA,MAAA,wBACxCA,UACAA,MAAA,WACEA,MAAA,mBACAA,MAAA,WAiBEA,MAhBA,EAAAqB,EAAA,IAgBArB,CAhBgB,EAAAsB,EAAA,WAyBhBtB,MAAA,YAAsCA,MAAA,8BAAAuB,GAAAvB,MAAAwB,GAAA,MAAAtB,EAAAF,QAAA,OAAAA,MAAsBE,EAAAuB,KAAAF,GAAY,GAEtEvB,MAAA,GAAA0B,EAAA,cAAAC,GA+BN3B,YAEEA,MADF,0BACEA,CAD8B,eACJA,MAAA,mBAAAA,MAAAwB,GAAA,MAAAtB,EAAAF,QAAA,OAAAA,MAASE,EAAA0B,cAAa,GAAE5B,MAAA,0BAAwCA,QAC1FA,MAAA,gBAAyCA,MAAA,mBAAAA,MAAAwB,GAAA,MAAAtB,EAAAF,QAAA,OAAAA,MAASE,EAAA2B,WAAU,GAAE7B,MAAA,0BAAsCA,QACpGA,MAAA,sCAAyCA,MAAA,mBAAAA,MAAAwB,GAAA,MAAAtB,EAAAF,QAAA,OAAAA,MAASE,EAAA4B,mBAAkB,GAClE9B,MAAA,kBAAyCA,MAAA,WAG/CA,sCAvE0CA,MAAA,GAAAA,YAAA,gCAKpCA,MAAA,GAAAA,MAAA,EAAAE,EAAAE,SAAA,MAgBAJ,cAAA,EAAAE,EAAAS,QAAA,MAWEX,MAAA,GAAAA,MAAAE,EAAAS,SAiC8CX,MAAA,GAAAA,YAAA,gCACYA,MAAA,GAAAA,YAAA,+BACQA,MAAA,GAAAA,MAAA,QAAAA,MAAA,qCC9BrE,IAAM+B,EAA0B,MAAjC,MAAOA,EAGXC,GACAC,GACAC,GAEAC,YACUC,EACAC,EACAC,GAFAC,KAAAH,YACAG,KAAAF,WACAE,KAAAD,YATgBC,KAAAC,UAAY,mBAEtCD,MAAAP,KAAgBS,KAAUC,KAC1BH,MAAAN,KAAmBQ,KAAUE,KAC7BJ,MAAAL,KAAmBO,KAAUG,KAQnBL,KAAA5B,SAAQkC,MAAyB,QAAS,MAC1CN,KAAAnC,UAASyC,MAAuB,SAAU,MAEpDN,MAAAO,KAAgBC,KAAQR,MAAKP,EAAcgB,UAAU,CAAC,OAAQ,OAAQ,UAAWC,KAC/EC,GAAI,KACJC,KAAMF,EAAEE,KACRC,KAAMH,EAAEG,KACRC,MAAOC,SAASL,EAAEI,MAAO,OAEjBd,KAAA9B,aAAYoC,MAAU,aAAa,EAXzC,CAKJC,GAQAS,WACEhB,MAAKiB,IACLjB,MAAKkB,IACLlB,MAAKmB,IACLnB,MAAKP,EAAc2B,iBAAiB,KAClCpB,MAAKiB,GAAW,GAChBjB,MAAKkB,GAAY,EAErB,CAEAC,KACEnB,MAAKL,EAAiB0B,cAAcC,UAAUC,IAC5CvB,KAAKD,UAAUyB,eAAeD,EAAeE,QAAQC,SAASC,QAAQC,MAAM,KAAK,IACjF5B,KAAKD,UAAU8B,IAAIN,EAAeE,QAAQC,SAASI,QAAQF,MAAM,KAAK,GAAE,EAE5E,CAEUvC,cACRW,KAAKH,UAAUkC,OACjB,CAEUzC,WACRU,KAAKF,SAASkC,KAAK,aACnBhC,MAAKN,EAAiBJ,SAASU,MAAKO,EAAeP,KAAK5B,SAASkD,UAAU,KACzEtB,KAAKF,SAASkC,KAAK,QAAS,KAAM,CAAEC,SAAU,MAC9CjC,MAAKiB,IACLjB,MAAKkB,GAAY,EAErB,CAEU3B,mBACRS,KAAKF,SAASkC,KAAK,aACnBhC,MAAKN,EAAiBJ,SAASU,MAAKO,EAAeP,KAAK5B,SAASkD,UAAU,KACzEtB,KAAKF,SAASkC,KAAK,QAAS,KAAM,CAAEC,SAAU,MAC9CjC,KAAKX,aAAW,EAEpB,CAEUzB,aACR,MAAMsE,EAAiB,CACrB9D,MAAO,CACL+D,IAASC,aAAapC,MAAKO,EAAcK,KAAM,cAAe,EAAwB,IAArBZ,KAAKnC,SAASL,IAC/E2E,IAASC,aAAapC,MAAKO,EAAcK,KAAM,mBAAoB,EAAwB,IAArBZ,KAAKnC,SAASL,MAGlF6E,KAAUC,KAAiBJ,GACjClC,MAAKP,EAAc8C,YAAY,CAAC,QAAQF,KAC1C,CAEUxD,SAAS8B,GACjB,MAAMuB,EAAiB,CACrB9D,MAAO,CAAC+D,IAASK,OAAO7B,KAEpB0B,KAAUC,KAAiBJ,GACjClC,MAAKP,EAAc8C,YAAY,CAAC,QAAQF,KAC1C,CAEU5D,gBAAgBqC,GAExBd,MAAKP,EAAc8C,YAAY,CAAC,GAAGvC,MAAKO,EAAcK,QAAQZ,MAAKO,EAAcM,QAAQC,EAAQ,aAAc,CAAE2B,YAD7F,CAAEC,KAAK,IAE7B,CAEA/D,SAASmC,GACP,MAAMoB,EAAiB,CACrB9D,MAAO,CAAE+D,IAASC,aAAapC,MAAKO,EAAcK,KAAMZ,MAAKO,EAAcM,KAAMC,EAAQ,GAAG,KAExFuB,KAAUC,KAAiBJ,GACjClC,MAAKP,EAAc8C,YAAY,CAAC,QAAQF,KAC1C,CAEUzD,OAAO+D,GACVC,QAAQ5C,KAAKD,UAAU8C,QAAQ,sCACpC7C,KAAKF,SAASkC,KAAK,eACnBhC,MAAKN,EAAiBoD,WAAW9C,MAAKO,EAAeoC,EAAKjE,OAAO4C,UAAU,KACzEtB,KAAKF,SAASkC,KAAK,UAAW,KAAM,CAAEC,SAAU,MAChDjC,MAAKiB,GAAU,GAEnB,CAEU/B,KAAK6D,GACb,MAAM3E,EAAQ,IAAI4B,KAAK5B,UACvB4E,QAAgB5E,EAAO2E,EAAME,cAAeF,EAAMG,cAClDlD,KAAK5B,MAAM+E,IAAI/E,GACf4B,KAAK9B,UAAUiF,KAAI,EACrB,CAEAlC,GAAWmC,GAAY,GACrBpD,MAAKN,EAAiB2D,QAAQrD,MAAKO,GAAee,UAAUlD,IAC1D,GAAI4B,KAAK9B,YAAa,CACpB,MAAMoF,EAAStD,KAAK5B,QAAQmF,IAAIZ,GAAQA,EAAKnF,IAG7C,GAFmBwC,KAAK5B,QAAQC,SAAWD,EAAMC,SAAUD,EAAMoF,KAAKb,IAASW,EAAOG,SAASd,EAAKnF,MAEjF4F,EAAW,CAC5B,MAAMM,EAAY1D,KAAK5B,QAAQmF,IAAIZ,GAAQA,EAAKjE,OAChDN,EAAMuF,KAAK,CAACC,EAAGC,KACb,MAAMC,EAASJ,EAAUK,QAAQH,EAAElF,OAC7BsF,EAASN,EAAUK,QAAQF,EAAEnF,OACnC,OAAe,IAAXoF,IAA4B,IAAXE,EAAwB,EACtCF,EAASE,SAETZ,GACTpD,KAAKF,SAASkC,KAAK,gEAAiE,KAAM,CAAEC,SAAU,MAE1GjC,KAAK5B,MAAM+E,IAAI/E,GACf4B,KAAK9B,UAAUiF,KAAI,EAAK,EAE5B,CAEAjC,KACElB,MAAKN,EAAiBuE,UAAUjE,MAAKO,GAClCe,UAAUzD,GAAUmC,KAAKnC,OAAOsF,IAAItF,GACzC,CAACqG,SAAAlE,KAAA,mBAAAmE,iBAvIU3E,GAA0B/B,MAAA2G,MAAA3G,MAAA4G,MAAA5G,MAAA6G,MAAA,EAAAJ,SAAAlE,KAAA,UAAAuE,EAAAC,IAAA,MAA1BhF,EAA0BiF,UAAA,8BAAAC,SAAA,EAAAC,aAAA,SAAAC,EAAAC,GAAA,EAAAD,GAA1BnH,MAAA,YAAAoH,EAAA5E,81BDxCbxC,MAAA,EAAAqH,EAAA,oBAAArH,MAAA,EAAAoH,EAAAhH,UAAAgH,EAAAzG,QAAA,qBC2BI2G,KACAC,KACAC,KAAeC,UACfC,KAAaC,KACbC,KACAC,KACAC,KACAC,IAAelB,KACfmB,KACAC,IACAC,KAAiCC,OAAA,upCAGxBpG,CAA0B,kFC3BhC,IAAMqG,EAAe,MAAtB,MAAOA,EAMXjG,cAJUI,KAAA8F,cAAaC,OAAOC,MACpBhG,KAAAiG,QAAOF,OAAOG,MACdlG,KAAAmG,WAAUJ,OAAOtE,IAEX,CAON2E,OAAOC,GACf,OAAOrG,KAAK8F,WAAWQ,MAAML,KAAKG,OAAOC,EAC3C,CAKA,SAAcE,GAAU,OAAOvG,KAAKmG,QAAQI,MAAMC,UAAY,CAK9D,UAAcC,GAAW,OAAOzG,KAAKmG,QAAQM,OAAOD,UAAY,CAACtC,SAAAlE,KAAA,mBAAAmE,iBAzBtD0B,EAAe,EAAA3B,SAAAlE,KAAA,WAAA0G,EAAAC,IAAA,OAAfd,EAAee,QAAff,EAAegB,mBAAfhB,CAAe","names":["$item","Id","i0","_r2","ctx_r2","editHeader","header","Title","ManageContentListComponent_Conditional_0_Conditional_8_Conditional_4_Template","ManageContentListComponent_Conditional_0_Conditional_8_Conditional_5_Template","Type","reordered","tmp_2_0","items","length","item_r5","_r4","$implicit","addFromExisting","Index","addBelow","remove","editItem","ManageContentListComponent_Conditional_0_Conditional_8_Template","ManageContentListComponent_Conditional_0_Conditional_9_Template","$event","_r1","drop","ManageContentListComponent_Conditional_0_For_12_Template","_forTrack0","closeDialog","saveList","saveAndCloseList","ManageContentListComponent","#dialogRoutes","#contentGroupSvc","#dialogConfigSvc","constructor","dialogRef","snackBar","translate","this","hostClass","transient","DialogRoutingService","ContentGroupService","DialogConfigAppService","signalObj","#contentGroup","convert","getParams","p","id","guid","part","index","parseInt","ngOnInit","#fetchList","#fetchHeader","#fetchDialogSettings","doOnDialogClosed","getCurrent$","subscribe","dialogSettings","setDefaultLang","Context","Language","Primary","split","use","Current","close","open","duration","form","EditPrep","relationship","formUrl","convertFormToUrl","navRelative","editId","queryParams","add","item","confirm","instant","removeItem","event","moveItemInArray","previousIndex","currentIndex","set","keepOrder","getList","oldIds","map","some","includes","sortOrder","sort","a","b","aIndex","indexOf","bIndex","getHeader","static","t","i1","i2","i3","_angular_core__WEBPACK_IMPORTED_MODULE_5__","VBU","selectors","hostVars","hostBindings","rf","ctx","ManageContentListComponent_Conditional_0_Template","RouterOutlet","CdkScrollable","MatButtonModule","i4","MatIconModule","i5","CdkDropList","CdkDrag","MatDialogActions","TranslateModule","MatDialogModule","TippyDirective","MousedownStopPropagationDirective","styles","HttpServiceBase","dnnContext","inject","DnnContext","http","HttpClient","context","apiUrl","name","$2sxc","appId","toString","zoneId","_angular_core__WEBPACK_IMPORTED_MODULE_1__","jDH","factory","Éµfac"],"ignoreList":[],"sourceRoot":"webpack:///","sources":["./projects/eav-ui/src/app/manage-content-list/manage-content-list.component.html","./projects/eav-ui/src/app/manage-content-list/manage-content-list.component.ts","./projects/eav-ui/src/app/shared/services/http-service-base.ts"],"sourcesContent":["@if (header() && items()) {\r\n  <div class=\"eav-dialog eav-no-scrollbar\">\r\n    <div class=\"eav-dialog-header\">\r\n      <div class=\"eav-dialog-header__title\">{{'ManageContentList.Title' | translate}}</div>\r\n    </div>\r\n    <div class=\"eav-dialog-content\">\r\n      <router-outlet></router-outlet>\r\n      <div class=\"dialog-component-content fancy-scrollbar-light\" cdkScrollable>\r\n        @if (header()) {\r\n          <p>\r\n            {{'ManageContentList.Description' | translate}}\r\n          </p>\r\n          <p>\r\n            @if (header().Type) {\r\n              <span>{{ header().Title }}</span>\r\n              <button mat-icon-button tippy=\"Edit header\" (click)=\"editHeader()\">\r\n                <mat-icon>edit</mat-icon>\r\n              </button>\r\n            }\r\n            @else {\r\n              {{'ManageContentList.NoHeader' | translate}}\r\n            }\r\n          </p>\r\n        }\r\n        @if (items()) {\r\n          <p class=\"eav-sort-title\">\r\n            {{ 'ManageContentList.' + (reordered() ? 'ListHasBeenReordered' : (items()?.length < 25 ? 'SortItems' : 'SortLotsOfItems'))\r\n              | translate\r\n            }}\r\n          </p>\r\n        }\r\n\r\n        <!-- Items - with drag-and-drop -->\r\n        <div class=\"eav-dnd-list\" cdkDropList (cdkDropListDropped)=\"drop($event)\">\r\n          <!-- we use both Index and Id because all demo items have Id=0 -->\r\n          @for (item of items(); track (item.Index + '+' + item.Id)) {\r\n            <div class=\"eav-dnd-item\" cdkDrag>\r\n              <div class=\"eav-dnd-item__title\">\r\n                <mat-icon class=\"eav-dnd-item__title-icon\" tippy=\"Drag to reorder the list\">drag_handle</mat-icon>\r\n                <span class=\"eav-dnd-item__title-text\" tippy=\"{{ item.Title }} ({{ item.Id }})\">\r\n                  {{ item.Title }} ({{ item.Id }})\r\n                </span>\r\n              </div>\r\n              <div>\r\n                <!-- most buttons should only exist if it has a real ID, except for remove - which should also remove null-entries -->\r\n                <button mat-icon-button [tippy]=\"'Fields.Picker.AddExistingItem' | translate\" appMousedownStopPropagation\r\n                  [disabled]=\"item.Id === 0\" (click)=\"addFromExisting(item.Index)\">\r\n                  <mat-icon>playlist_add</mat-icon>\r\n                </button>\r\n                <button mat-icon-button [tippy]=\"'Fields.Picker.AddItemBelow' | translate\" appMousedownStopPropagation\r\n                  [disabled]=\"item.Id === 0 || reordered()\" (click)=\"addBelow(item.Index)\">\r\n                  <mat-icon>add</mat-icon>\r\n                </button>\r\n                <button mat-icon-button [tippy]=\"'Fields.Picker.Remove' | translate\" appMousedownStopPropagation\r\n                  [disabled]=\"reordered()\" (click)=\"remove(item)\">\r\n                  <mat-icon>remove</mat-icon>\r\n                </button>\r\n                <button mat-icon-button [tippy]=\"'Fields.Picker.Edit' | translate\" appMousedownStopPropagation\r\n                  [disabled]=\"item.Id === 0\" (click)=\"editItem(item.Id)\">\r\n                  <mat-icon>edit</mat-icon>\r\n                </button>\r\n              </div>\r\n            </div>\r\n          }\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <mat-dialog-actions align=\"end\">\r\n      <button mat-raised-button (click)=\"closeDialog()\">{{'General.Buttons.Cancel' | translate}}</button>\r\n      <button mat-raised-button color=\"accent\" (click)=\"saveList()\">{{'General.Buttons.Save' | translate}}</button>\r\n      <button mat-raised-button color=\"accent\" (click)=\"saveAndCloseList()\" [tippy]=\"'Form.Buttons.SaveAndClose' | translate\">\r\n        <mat-icon class=\"eav-raised-button-icon\">done</mat-icon>\r\n      </button>\r\n    </mat-dialog-actions>\r\n  </div>\r\n}\r\n","import { CdkDragDrop, moveItemInArray, CdkDropList, CdkDrag } from '@angular/cdk/drag-drop';\r\nimport { Component, HostBinding, OnInit } from '@angular/core';\r\nimport { MatDialogRef, MatDialogActions, MatDialogModule } from '@angular/material/dialog';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { RouterOutlet } from '@angular/router';\r\nimport { convertFormToUrl } from '../shared/helpers/url-prep.helper';\r\nimport { EditForm, EditPrep } from '../shared/models/edit-form.model';\r\nimport { ContentGroup } from './models/content-group.model';\r\nimport { GroupHeader } from './models/group-header.model';\r\nimport { ContentGroupService } from './services/content-group.service';\r\nimport { TranslateService, TranslateModule } from '@ngx-translate/core';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { CdkScrollable } from '@angular/cdk/scrolling';\r\nimport { TippyDirective } from '../shared/directives/tippy.directive';\r\nimport { MousedownStopPropagationDirective } from '../shared/directives/mousedown-stop-propagation.directive';\r\nimport { convert, transient } from '../core';\r\nimport { DialogConfigAppService } from '../app-administration/services/dialog-config-app.service';\r\nimport { DialogRoutingService } from '../shared/routing/dialog-routing.service';\r\nimport { signalObj } from '../shared/signals/signal.utilities';\r\n\r\n@Component({\r\n  selector: 'app-manage-content-list',\r\n  templateUrl: './manage-content-list.component.html',\r\n  styleUrls: ['./manage-content-list.component.scss'],\r\n  standalone: true,\r\n  imports: [\r\n    RouterOutlet,\r\n    CdkScrollable,\r\n    MatButtonModule,\r\n    MatIconModule,\r\n    CdkDropList,\r\n    CdkDrag,\r\n    MatDialogActions,\r\n    TranslateModule,\r\n    MatDialogModule,\r\n    TippyDirective,\r\n    MousedownStopPropagationDirective,\r\n  ],\r\n})\r\nexport class ManageContentListComponent implements OnInit {\r\n  @HostBinding('className') hostClass = 'dialog-component';\r\n\r\n  #dialogRoutes = transient(DialogRoutingService);\r\n  #contentGroupSvc = transient(ContentGroupService);\r\n  #dialogConfigSvc = transient(DialogConfigAppService);\r\n\r\n  constructor(\r\n    private dialogRef: MatDialogRef<ManageContentListComponent>,\r\n    private snackBar: MatSnackBar,\r\n    private translate: TranslateService,\r\n  ) { }\r\n\r\n  protected items = signalObj<GroupHeader[]>('items', null);\r\n  protected header = signalObj<GroupHeader>('header', null);\r\n\r\n  #contentGroup = convert(this.#dialogRoutes.getParams(['guid', 'part', 'index']), p => ({\r\n    id: null,\r\n    guid: p.guid,\r\n    part: p.part,\r\n    index: parseInt(p.index, 10),\r\n  }));\r\n  protected reordered = signalObj('reordered', false);\r\n\r\n  ngOnInit() {\r\n    this.#fetchList();\r\n    this.#fetchHeader();\r\n    this.#fetchDialogSettings();\r\n    this.#dialogRoutes.doOnDialogClosed(() => {\r\n      this.#fetchList(true);\r\n      this.#fetchHeader();\r\n    });\r\n  }\r\n\r\n  #fetchDialogSettings() {\r\n    this.#dialogConfigSvc.getCurrent$().subscribe(dialogSettings => {\r\n      this.translate.setDefaultLang(dialogSettings.Context.Language.Primary.split('-')[0]);\r\n      this.translate.use(dialogSettings.Context.Language.Current.split('-')[0]);\r\n    });\r\n  }\r\n\r\n  protected closeDialog() {\r\n    this.dialogRef.close();\r\n  }\r\n\r\n  protected saveList() {\r\n    this.snackBar.open('Saving...');\r\n    this.#contentGroupSvc.saveList(this.#contentGroup, this.items()).subscribe(() => {\r\n      this.snackBar.open('Saved', null, { duration: 2000 });\r\n      this.#fetchList();\r\n      this.#fetchHeader();\r\n    });\r\n  }\r\n\r\n  protected saveAndCloseList() {\r\n    this.snackBar.open('Saving...');\r\n    this.#contentGroupSvc.saveList(this.#contentGroup, this.items()).subscribe(() => {\r\n      this.snackBar.open('Saved', null, { duration: 2000 });\r\n      this.closeDialog();\r\n    });\r\n  }\r\n\r\n  protected editHeader() {\r\n    const form: EditForm = {\r\n      items: [\r\n        EditPrep.relationship(this.#contentGroup.guid, 'listcontent', 0, this.header().Id === 0),\r\n        EditPrep.relationship(this.#contentGroup.guid, 'listpresentation', 0, this.header().Id === 0),\r\n      ],\r\n    };\r\n    const formUrl = convertFormToUrl(form);\r\n    this.#dialogRoutes.navRelative([`edit/${formUrl}`]);\r\n  }\r\n\r\n  protected editItem(id: number) {\r\n    const form: EditForm = {\r\n      items: [EditPrep.editId(id)],\r\n    };\r\n    const formUrl = convertFormToUrl(form);\r\n    this.#dialogRoutes.navRelative([`edit/${formUrl}`]);\r\n  }\r\n\r\n  protected addFromExisting(index: number) {\r\n    const queryParams = { add: true };\r\n    this.#dialogRoutes.navRelative([`${this.#contentGroup.guid}/${this.#contentGroup.part}/${index + 1}/replace`], { queryParams });\r\n  }\r\n\r\n  addBelow(index: number) {\r\n    const form: EditForm = {\r\n      items: [ EditPrep.relationship(this.#contentGroup.guid, this.#contentGroup.part, index + 1, true) ],\r\n    };\r\n    const formUrl = convertFormToUrl(form);\r\n    this.#dialogRoutes.navRelative([`edit/${formUrl}`]);\r\n  }\r\n\r\n  protected remove(item: GroupHeader) {\r\n    if (!confirm(this.translate.instant('ManageContentList.ConfirmRemove'))) return;\r\n    this.snackBar.open('Removing...');\r\n    this.#contentGroupSvc.removeItem(this.#contentGroup, item.Index).subscribe(() => {\r\n      this.snackBar.open('Removed', null, { duration: 2000 });\r\n      this.#fetchList();\r\n    });\r\n  }\r\n\r\n  protected drop(event: CdkDragDrop<GroupHeader[]>) {\r\n    const items = [...this.items()];\r\n    moveItemInArray(items, event.previousIndex, event.currentIndex);\r\n    this.items.set(items);\r\n    this.reordered.set(true);\r\n  }\r\n\r\n  #fetchList(keepOrder = false) {\r\n    this.#contentGroupSvc.getList(this.#contentGroup).subscribe(items => {\r\n      if (this.reordered()) {\r\n        const oldIds = this.items().map(item => item.Id);\r\n        const idsChanged = this.items().length !== items.length || items.some(item => !oldIds.includes(item.Id));\r\n        // for usecase where list is fetched on child closed and wasn't changed in the meantime keeps the order before child was opened\r\n        if (!idsChanged && keepOrder) {\r\n          const sortOrder = this.items().map(item => item.Index);\r\n          items.sort((a, b) => {\r\n            const aIndex = sortOrder.indexOf(a.Index);\r\n            const bIndex = sortOrder.indexOf(b.Index);\r\n            if (aIndex === -1 || bIndex === -1) { return 0; }\r\n            return aIndex - bIndex;\r\n          });\r\n        } else if (keepOrder)\r\n          this.snackBar.open('List was changed from somewhere else. Order of items is reset', null, { duration: 5000 });\r\n      }\r\n      this.items.set(items);\r\n      this.reordered.set(false);\r\n    });\r\n  }\r\n\r\n  #fetchHeader() {\r\n    this.#contentGroupSvc.getHeader(this.#contentGroup)\r\n      .subscribe(header => this.header.set(header));\r\n  }\r\n}\r\n","import { inject, Injectable } from '@angular/core';\r\nimport { Context as DnnContext } from '@2sic.com/sxc-angular';\r\nimport { Context } from '../../shared/services/context';\r\nimport { HttpClient } from '@angular/common/http';\r\n\r\n/**\r\n * Base class for all services that need to make HTTP calls.\r\n * Provides important typical information and services, especially\r\n * * apiUrl(name) - to get the full API URL\r\n * * appId - the current app id\r\n * * zoneId - the current zone id\r\n */\r\n@Injectable()\r\nexport class HttpServiceBase {\r\n\r\n  protected dnnContext = inject(DnnContext);\r\n  protected http = inject(HttpClient);\r\n  protected context = inject(Context);\r\n\r\n  constructor() { }\r\n\r\n  /**\r\n   * Convert a short 2sxc-url into the correct full URL on the system.\r\n   * @param name 2sxc-style short url\r\n   * @returns \r\n   */\r\n  protected apiUrl(name: string) {\r\n    return this.dnnContext.$2sxc.http.apiUrl(name);\r\n  }\r\n\r\n  /**\r\n   * The current app id\r\n   */\r\n  protected get appId() { return this.context.appId.toString(); }\r\n\r\n  /**\r\n   * The current zone id\r\n   */\r\n  protected get zoneId() { return this.context.zoneId.toString(); }\r\n}"],"x_google_ignoreList":[]}