{"version":3,"file":"projects_eav-ui_src_app_apps-management_create-inherited-app_create-inherited-app_component_t-13e0b6.9924618ef8b7d276.js","mappings":"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","names":["i0","app_r1","Id","Name","CreateInheritedAppComponent","constructor","dialogRef","snackBar","this","hostClass","loading","signal","inheritableApps","undefined","appsListService","transient","AppsListService","form","buildForm","ngOnInit","fetchInheritedApps","closeDialog","close","create","disable","set","inheritId","controls","value","name","find","app","open","subscribe","error","enable","duration","next","getInheritable","UntypedFormGroup","UntypedFormControl","Validators","required","static","t","i1","i2","_angular_core__WEBPACK_IMPORTED_MODULE_1__","VBU","selectors","hostVars","hostBindings","rf","ctx","CreateInheritedAppComponent_For_14_Template","CreateInheritedAppComponent_Conditional_15_Template","length","touched","errors","valid","RouterOutlet","FormsModule","i3","ReactiveFormsModule","MatFormFieldModule","i4","MatSelectModule","i5","i6","MatOptionModule","MatDialogActions","MatButtonModule","i7","FieldHintComponent","webApiAppRoot","ImportAppService","http","context","dnnContext","importApp","file","changedName","retryOnDuplicate","formData","FormData","append","post","$2sxc","apiUrl","params","zoneId","toString","pipe","switchMap","result","Messages","MessageType","FileUploadMessageTypes","Warning","folderName","prompt","Text","of","_angular_core__WEBPACK_IMPORTED_MODULE_4__","jDH","factory","Éµfac","FieldHintComponent_Case_1_ng_container_1_Template","content_r2","FieldHintComponent_Case_2_ng_container_1_Template","isError","isShort","toggleIsShort","_angular_core__WEBPACK_IMPORTED_MODULE_0__","inputs","standalone","features","ngContentSelectors","_c0","decls","vars","consts","template","_r1","FieldHintComponent_Case_1_Template","FieldHintComponent_Case_2_Template","FieldHintComponent_ng_template_3_Template","_c1","tmp_2_0","NgClass","NgTemplateOutlet","styles","HttpServiceBase","inject","DnnContext","HttpClient","Context","appId"],"ignoreList":[],"sourceRoot":"webpack:///","sources":["./projects/eav-ui/src/app/apps-management/create-inherited-app/create-inherited-app.component.html","./projects/eav-ui/src/app/apps-management/create-inherited-app/create-inherited-app.component.ts","./projects/eav-ui/src/app/import-app/services/import-app.service.ts","./projects/eav-ui/src/app/shared/components/field-hint/field-hint.component.html","./projects/eav-ui/src/app/shared/components/field-hint/field-hint.component.ts","./projects/eav-ui/src/app/shared/services/http-service-base.ts"],"sourcesContent":["<div class=\"eav-dialog\">\r\n  <div class=\"eav-dialog-header\">\r\n    <div class=\"eav-dialog-header__title\">Create inherited App</div>\r\n  </div>\r\n  <div class=\"eav-dialog-content\">\r\n    <router-outlet></router-outlet>\r\n    <p>\r\n      Create an App which inherits everything (data, views, queries) from a global App. Only Apps which were\r\n      specifically\r\n      marked for this will be listed here, and these apps must already have been loaded into Cache. If you don't see the\r\n      App you expect, make sure that has happened.\r\n    </p>\r\n    <form [formGroup]=\"form\">\r\n      <mat-form-field color=\"accent\" class=\"eav-mat-form-field\">\r\n        <mat-label>Inherit App</mat-label>\r\n        <mat-select formControlName=\"inheritId\"\r\n          [placeholder]=\"inheritableApps() === undefined ? 'Loading...' : inheritableApps() === null || inheritableApps().length === 0 ? 'No inheritable apps found' : ''\">\r\n          @for (app of inheritableApps(); track app) {\r\n          <mat-option [value]=\"app.Id\">\r\n            {{ app.Name }}\r\n          </mat-option>\r\n          }\r\n        </mat-select>\r\n      </mat-form-field>\r\n      @if (form.controls.inheritId.touched && form.controls.inheritId.errors?.required) {\r\n      <app-field-hint [isError]=\"true\">\r\n        Required\r\n      </app-field-hint>\r\n      }\r\n    </form>\r\n  </div>\r\n  <mat-dialog-actions align=\"end\">\r\n    <button type=\"button\" mat-raised-button [disabled]=\"loading()\" (click)=\"closeDialog()\">\r\n      Cancel\r\n    </button>\r\n    <button type=\"button\" mat-raised-button color=\"accent\" [disabled]=\"loading() || !form.valid\" (click)=\"create()\">\r\n      Create\r\n    </button>\r\n  </mat-dialog-actions>\r\n</div>\r\n","import { Component, HostBinding, OnInit, signal } from '@angular/core';\r\nimport { UntypedFormControl, UntypedFormGroup, Validators, FormsModule, ReactiveFormsModule } from '@angular/forms';\r\nimport { MatDialogRef, MatDialogActions } from '@angular/material/dialog';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { App } from '../models/app.model';\r\nimport { AppsListService } from '../services/apps-list.service';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatOptionModule } from '@angular/material/core';\r\nimport { MatSelectModule } from '@angular/material/select';\r\nimport { MatFormFieldModule } from '@angular/material/form-field';\r\nimport { RouterOutlet } from '@angular/router';\r\nimport { FieldHintComponent } from '../../shared/components/field-hint/field-hint.component';\r\nimport { transient } from '../../core';\r\n\r\n@Component({\r\n  selector: 'app-create-inherited-app',\r\n  templateUrl: './create-inherited-app.component.html',\r\n  styleUrls: ['./create-inherited-app.component.scss'],\r\n  standalone: true,\r\n  imports: [\r\n    RouterOutlet,\r\n    FormsModule,\r\n    ReactiveFormsModule,\r\n    MatFormFieldModule,\r\n    MatSelectModule,\r\n    MatOptionModule,\r\n    MatDialogActions,\r\n    MatButtonModule,\r\n    FieldHintComponent\r\n  ],\r\n})\r\nexport class CreateInheritedAppComponent implements OnInit{\r\n  @HostBinding('className') hostClass = 'dialog-component';\r\n\r\n  form: UntypedFormGroup;\r\n\r\n  loading = signal<boolean>(false);\r\n  inheritableApps = signal<App[] | undefined>(undefined);\r\n\r\n  private appsListService = transient(AppsListService);\r\n\r\n  constructor(\r\n    private dialogRef: MatDialogRef<CreateInheritedAppComponent>,\r\n    private snackBar: MatSnackBar,\r\n  ) {\r\n    this.form = this.buildForm();\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.fetchInheritedApps();\r\n\r\n  }\r\n\r\n  closeDialog(): void {\r\n    this.dialogRef.close();\r\n  }\r\n\r\n  create(): void {\r\n    this.form.disable();\r\n    this.loading.set(true);\r\n    const inheritId = this.form.controls.inheritId.value;\r\n    // TODO:: remove after test\r\n    // const name = this.inheritableApps$.value.find(app => app.Id === inheritId).Name;\r\n    const name = this.inheritableApps().find(app => app.Id === inheritId).Name;\r\n    this.snackBar.open('Creating inherited app...');\r\n    this.appsListService.create(name, inheritId).subscribe({\r\n      error: () => {\r\n        this.form.enable();\r\n    this.loading.set(false);\r\n\r\n        this.snackBar.open('Failed to create inherited app. Please check console for more information', undefined, { duration: 3000 });\r\n      },\r\n      next: () => {\r\n        this.form.enable();\r\n        this.snackBar.open('Created inherited app', undefined, { duration: 2000 });\r\n        this.closeDialog();\r\n      },\r\n    });\r\n  }\r\n\r\n  private fetchInheritedApps(): void {\r\n    this.appsListService.getInheritable().subscribe({\r\n      error: () => {\r\n        this.inheritableApps.set(null);\r\n      },\r\n      next: (inheritableApps) => {\r\n        this.inheritableApps.set(inheritableApps);\r\n      },\r\n    });\r\n  }\r\n\r\n  private buildForm(): UntypedFormGroup {\r\n    const form = new UntypedFormGroup({\r\n      inheritId: new UntypedFormControl(null, [Validators.required]),\r\n    });\r\n    return form;\r\n  }\r\n}\r\n","import { Context as DnnContext } from '@2sic.com/sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { Observable, of, switchMap } from 'rxjs';\r\nimport { FileUploadMessageTypes, FileUploadResult } from '../../shared/components/file-upload-dialog';\r\nimport { Context } from '../../shared/services/context';\r\n\r\nexport const webApiAppRoot = 'admin/app/';\r\n\r\n@Injectable()\r\nexport class ImportAppService {\r\n  constructor(private http: HttpClient, private context: Context, private dnnContext: DnnContext) { }\r\n\r\n  importApp(file: File, changedName: string, retryOnDuplicate = false): Observable<FileUploadResult> {\r\n    const formData = new FormData();\r\n    formData.append('File', file);\r\n    formData.append('Name', changedName ?? '');\r\n    return this.http.post<FileUploadResult>(this.dnnContext.$2sxc.http.apiUrl(webApiAppRoot + 'Import'), formData, {\r\n      params: { zoneId: this.context.zoneId.toString() }\r\n    }).pipe(\r\n      switchMap(result => {\r\n        if (retryOnDuplicate && result.Messages[0]?.MessageType === FileUploadMessageTypes.Warning) {\r\n          const folderName = prompt(result.Messages[0].Text + ' Would you like to install it using another folder name?');\r\n          if (folderName) {\r\n            return this.importApp(file, folderName, true);\r\n          }\r\n        }\r\n        return of(result);\r\n      }),\r\n    );\r\n  }\r\n}\r\n","<div class=\"hint-box\" (click)=\"toggleIsShort()\" [ngClass]=\"{ 'hint-box__short': isShort }\">\r\n  @switch (isError) {\r\n    @case (false) {\r\n      <mat-hint>\r\n        <ng-container *ngTemplateOutlet=\"content\"></ng-container>\r\n      </mat-hint>\r\n    }\r\n    @case (true) {\r\n      <mat-error>\r\n        <ng-container *ngTemplateOutlet=\"content\"></ng-container>\r\n      </mat-error>\r\n    }\r\n  }\r\n</div>\r\n\r\n<ng-template #content>\r\n  <ng-content></ng-content>\r\n</ng-template>\r\n","import { NgClass, NgTemplateOutlet } from '@angular/common';\r\nimport { Component, Input } from '@angular/core';\r\nimport { MatFormFieldModule } from '@angular/material/form-field';\r\n\r\n@Component({\r\n  selector: 'app-field-hint',\r\n  templateUrl: './field-hint.component.html',\r\n  styleUrls: ['./field-hint.component.scss'],\r\n  standalone: true,\r\n  imports: [\r\n    MatFormFieldModule,\r\n    NgClass,\r\n    NgTemplateOutlet\r\n  ]\r\n})\r\nexport class FieldHintComponent {\r\n  @Input() isError = false;\r\n  isShort = true;\r\n\r\n  constructor() { }\r\n\r\n  toggleIsShort() {\r\n    this.isShort = !this.isShort;\r\n  }\r\n}\r\n","import { inject, Injectable } from '@angular/core';\r\nimport { Context as DnnContext } from '@2sic.com/sxc-angular';\r\nimport { Context } from '../../shared/services/context';\r\nimport { HttpClient } from '@angular/common/http';\r\n\r\n/**\r\n * Base class for all services that need to make HTTP calls.\r\n * Provides important typical information and services, especially\r\n * * apiUrl(name) - to get the full API URL\r\n * * appId - the current app id\r\n * * zoneId - the current zone id\r\n */\r\n@Injectable()\r\nexport class HttpServiceBase {\r\n\r\n  protected dnnContext = inject(DnnContext);\r\n  protected http = inject(HttpClient);\r\n  protected context = inject(Context);\r\n\r\n  constructor() { }\r\n\r\n  /**\r\n   * Convert a short 2sxc-url into the correct full URL on the system.\r\n   * @param name 2sxc-style short url\r\n   * @returns \r\n   */\r\n  protected apiUrl(name: string) {\r\n    return this.dnnContext.$2sxc.http.apiUrl(name);\r\n  }\r\n\r\n  /**\r\n   * The current app id\r\n   */\r\n  protected get appId() { return this.context.appId.toString(); }\r\n\r\n  /**\r\n   * The current zone id\r\n   */\r\n  protected get zoneId() { return this.context.zoneId.toString(); }\r\n}"],"x_google_ignoreList":[]}