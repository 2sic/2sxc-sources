{"version":3,"mappings":"+ZAkBQA,yBACEA,SACFA,kCAFmDA,oBACjDA,sDAINA,6BAEEA,sBACFA,cAFEA,4DAxBNA,SACEA,iBAAsB,WACUA,gCAAoBA,UAGpDA,yBAEAA,eACEA,iSAGFA,QAEAA,kBAAyB,qBAAzBA,CAAyB,eAEVA,wBAAWA,QACtBA,yBAEEA,+BAGFA,UAEFA,mCAIFA,QAEAA,kBAAsC,gBAC4BA,iDAASC,gBACvED,qBACFA,QACAA,sBAA8FA,iDAASE,WACrGF,qBACFA,UAEJA,yCAxBQA,mCAIAA,4JAC4BA,4CAKfA,kJAOuBA,qCAGeA,qDCpBpD,IAAMG,EAAb,MAAM,QASJC,YACUC,EACAC,EACAC,GAFAC,iBACAA,uBACAA,gBAXgBA,eAAY,mBAapCA,KAAKC,KAAOD,KAAKE,YACjBF,KAAKG,SAAW,IAAIC,KAAgB,GACpCJ,KAAKK,iBAAmB,IAAID,SAAuBE,GACnDN,KAAKO,YAAaC,OAAc,CAACR,KAAKG,SAAUH,KAAKK,mBAAmBI,MACtEC,OAAI,EAAEC,EAASC,MACN,CAAED,UAASC,sBAKxBC,WACEb,KAAKc,qBAIPC,cACEf,KAAKG,SAASa,WACdhB,KAAKK,iBAAiBW,WAGxBC,cACEjB,KAAKH,UAAUqB,QAGjBC,SACEnB,KAAKC,KAAKmB,UACVpB,KAAKG,SAASkB,MAAK,GACnB,MAAMC,EAAYtB,KAAKC,KAAKsB,SAASD,UAAUE,MACzCC,EAAOzB,KAAKK,iBAAiBmB,MAAME,KAAKC,GAAOA,EAAIC,KAAON,GAAWO,KAC3E7B,KAAKD,SAAS+B,KAAK,6BACnB9B,KAAKF,gBAAgBqB,OAAOM,EAAMH,GAAWS,UAAU,CACrDC,MAAO,KACLhC,KAAKC,KAAKgC,SACVjC,KAAKG,SAASkB,MAAK,GACnBrB,KAAKD,SAAS+B,KAAK,iFAA6ExB,EAAW,CAAE4B,SAAU,OAEzHb,KAAM,KACJrB,KAAKC,KAAKgC,SACVjC,KAAKD,SAAS+B,KAAK,6BAAyBxB,EAAW,CAAE4B,SAAU,MACnElC,KAAKiB,iBAKHH,qBACNd,KAAKF,gBAAgBqC,iBAAiBJ,UAAU,CAC9CC,MAAO,KACLhC,KAAKK,iBAAiBgB,KAAK,OAE7BA,KAAOT,IACLZ,KAAKK,iBAAiBgB,KAAKT,MAKzBV,YAIN,OAHa,IAAIkC,KAAU,CACzBd,UAAW,IAAIe,KAAY,KAAM,CAACC,gEAvE3B3C,GAA2BH,6DAA3BG,EAA2B4C,omBDbxC/C,wDAAeA,wJCaFG,GAAb,2FCXIH,kCADFA,oBACEA,gCACFA,uCADiBA,2DAIfA,kCADFA,qBACEA,gCACFA,uCADiBA,2DAKjBA,kECJK,IAAMgD,EAAb,MAAM,QAIJ5C,cAHSI,cAAU,EACnBA,cAAU,EAIVyC,gBACEzC,KAAK0C,SAAW1C,KAAK0C,sDAPZF,8BAAkBD,mPDP/B/C,iBAAsBA,gCAASmD,oBAC7BnD,4BAIAA,6BAGFA,QAEAA,iDAVgDA,sCAA0C,sBAC7EA,kCAICA,keCEDgD,GAAb","names":["i0","ctx_r5","ctx_r7","CreateInheritedAppComponent","constructor","dialogRef","appsListService","snackBar","this","form","buildForm","loading$","BehaviorSubject","inheritableApps$","undefined","viewModel$","combineLatest","pipe","map","loading","inheritableApps","ngOnInit","fetchInheritedApps","ngOnDestroy","complete","closeDialog","close","create","disable","next","inheritId","controls","value","name","find","app","Id","Name","open","subscribe","error","enable","duration","getInheritable","FormGroup","FormControl","Validators","selectors","FieldHintComponent","toggleIsShort","isShort","ctx"],"sources":["./projects/eav-ui/src/app/apps-management/create-inherited-app/create-inherited-app.component.html","./projects/eav-ui/src/app/apps-management/create-inherited-app/create-inherited-app.component.ts","./projects/eav-ui/src/app/shared/components/field-hint/field-hint.component.html","./projects/eav-ui/src/app/shared/components/field-hint/field-hint.component.ts"],"sourcesContent":["<ng-container *ngIf=\"viewModel$ | async as vm\">\r\n  <div mat-dialog-title>\r\n    <div class=\"dialog-title-box\">Create inherited App</div>\r\n  </div>\r\n\r\n  <router-outlet></router-outlet>\r\n\r\n  <p class=\"dialog-description\">\r\n    Create an App which inherits everything (data, views, queries) from a global App. Only Apps which were specifically\r\n    marked for this will be listed here, and these apps must already have been loaded into Cache. If you don't see the\r\n    App you expect, make sure that has happened.\r\n  </p>\r\n\r\n  <form [formGroup]=\"form\">\r\n    <mat-form-field appearance=\"standard\" color=\"accent\">\r\n      <mat-label>Inherit App</mat-label>\r\n      <mat-select formControlName=\"inheritId\"\r\n        [placeholder]=\"vm.inheritableApps === undefined ? 'Loading...' : vm.inheritableApps === null || vm.inheritableApps.length === 0 ? 'No inheritable apps found' : ''\">\r\n        <mat-option *ngFor=\"let app of vm.inheritableApps\" [value]=\"app.Id\">\r\n          {{ app.Name }}\r\n        </mat-option>\r\n      </mat-select>\r\n    </mat-form-field>\r\n    <app-field-hint *ngIf=\"form.controls.inheritId.touched && form.controls.inheritId.errors?.required\"\r\n      [isError]=\"true\">\r\n      Required\r\n    </app-field-hint>\r\n  </form>\r\n\r\n  <div class=\"dialog-component-actions\">\r\n    <button type=\"button\" mat-raised-button [disabled]=\"vm.loading\" (click)=\"closeDialog()\">\r\n      Cancel\r\n    </button>\r\n    <button type=\"button\" mat-raised-button color=\"accent\" [disabled]=\"vm.loading || !form.valid\" (click)=\"create()\">\r\n      Create\r\n    </button>\r\n  </div>\r\n</ng-container>\r\n","import { Component, HostBinding, OnDestroy, OnInit } from '@angular/core';\r\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\r\nimport { MatDialogRef } from '@angular/material/dialog';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { BehaviorSubject, Observable, combineLatest, map } from 'rxjs';\r\nimport { App } from '../models/app.model';\r\nimport { AppsListService } from '../services/apps-list.service';\r\n\r\n@Component({\r\n  selector: 'app-create-inherited-app',\r\n  templateUrl: './create-inherited-app.component.html',\r\n  styleUrls: ['./create-inherited-app.component.scss'],\r\n})\r\nexport class CreateInheritedAppComponent implements OnInit, OnDestroy {\r\n  @HostBinding('className') hostClass = 'dialog-component';\r\n\r\n  form: FormGroup;\r\n  loading$: BehaviorSubject<boolean>;\r\n  inheritableApps$: BehaviorSubject<App[] | undefined | null>;\r\n\r\n  viewModel$: Observable<CreateInheritedAppViewModel>;\r\n\r\n  constructor(\r\n    private dialogRef: MatDialogRef<CreateInheritedAppComponent>,\r\n    private appsListService: AppsListService,\r\n    private snackBar: MatSnackBar,\r\n  ) {\r\n    this.form = this.buildForm();\r\n    this.loading$ = new BehaviorSubject(false);\r\n    this.inheritableApps$ = new BehaviorSubject<App[]>(undefined);\r\n    this.viewModel$ = combineLatest([this.loading$, this.inheritableApps$]).pipe(\r\n      map(([loading, inheritableApps]) => {\r\n        return { loading, inheritableApps };\r\n      }),\r\n    );\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.fetchInheritedApps();\r\n\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.loading$.complete();\r\n    this.inheritableApps$.complete();\r\n  }\r\n\r\n  closeDialog(): void {\r\n    this.dialogRef.close();\r\n  }\r\n\r\n  create(): void {\r\n    this.form.disable();\r\n    this.loading$.next(true);\r\n    const inheritId = this.form.controls.inheritId.value;\r\n    const name = this.inheritableApps$.value.find(app => app.Id === inheritId).Name;\r\n    this.snackBar.open('Creating inherited app...');\r\n    this.appsListService.create(name, inheritId).subscribe({\r\n      error: () => {\r\n        this.form.enable();\r\n        this.loading$.next(false);\r\n        this.snackBar.open('Failed to create inherited app. Please check console for more information', undefined, { duration: 3000 });\r\n      },\r\n      next: () => {\r\n        this.form.enable();\r\n        this.snackBar.open('Created inherited app', undefined, { duration: 2000 });\r\n        this.closeDialog();\r\n      },\r\n    });\r\n  }\r\n\r\n  private fetchInheritedApps(): void {\r\n    this.appsListService.getInheritable().subscribe({\r\n      error: () => {\r\n        this.inheritableApps$.next(null);\r\n      },\r\n      next: (inheritableApps) => {\r\n        this.inheritableApps$.next(inheritableApps);\r\n      },\r\n    });\r\n  }\r\n\r\n  private buildForm(): FormGroup {\r\n    const form = new FormGroup({\r\n      inheritId: new FormControl(null, [Validators.required]),\r\n    });\r\n    return form;\r\n  }\r\n}\r\n\r\ninterface CreateInheritedAppViewModel { \r\n  loading: boolean;\r\n  inheritableApps: App[] | undefined | null;\r\n}\r\n","<div class=\"hint-box\" (click)=\"toggleIsShort()\" [ngClass]=\"{ 'hint-box__short': isShort }\" [ngSwitch]=\"isError\">\r\n  <mat-hint *ngSwitchCase=\"false\">\r\n    <ng-container *ngTemplateOutlet=\"content\"></ng-container>\r\n  </mat-hint>\r\n\r\n  <mat-error *ngSwitchCase=\"true\">\r\n    <ng-container *ngTemplateOutlet=\"content\"></ng-container>\r\n  </mat-error>\r\n</div>\r\n\r\n<ng-template #content>\r\n  <ng-content></ng-content>\r\n</ng-template>\r\n","import { Component, Input } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-field-hint',\r\n  templateUrl: './field-hint.component.html',\r\n  styleUrls: ['./field-hint.component.scss'],\r\n})\r\nexport class FieldHintComponent {\r\n  @Input() isError = false;\r\n  isShort = true;\r\n\r\n  constructor() { }\r\n\r\n  toggleIsShort() {\r\n    this.isShort = !this.isShort;\r\n  }\r\n}\r\n"],"sourceRoot":"webpack:///","file":"projects_eav-ui_src_app_apps-management_create-inherited-app_create-inherited-app_component_ts.a395a11cb30e7189.js"}