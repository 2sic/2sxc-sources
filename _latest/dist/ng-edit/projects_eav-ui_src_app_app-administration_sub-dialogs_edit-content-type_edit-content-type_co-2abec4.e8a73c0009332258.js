"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_app-administration_sub-dialogs_edit-content-type_edit-content-type_co-2abec4"],{8407:(V,h,i)=>{i.r(h),i.d(h,{EditContentTypeComponent:()=>D});var s=i(4456),m=i(4175),u=i(4646),f=i(7941),p=i(353),r=i(4950),g=i(3840),v=i(7984),y=i(5175),S=i(2938),N=i(3758),C=i(5858),F=i(52),b=i(9333),j=i(4601),k=i(4435),l=i(7993);const T=/(^[A-Za-z][A-Za-z0-9]*$)|(^@[A-Za-z][A-Za-z0-9\-]*$)/.toString(),x=T.substring(1,T.toString().length-1);var I=i(7693),t=i(7580),R=i(2159),G=i(3347);function $(a,d){1&a&&(t.j41(0,"app-field-hint",19),t.EFF(1,"This field is required"),t.k0s()),2&a&&t.Y8G("isError",!0)}function X(a,d){if(1&a&&(t.j41(0,"app-field-hint",19),t.EFF(1),t.k0s()),2&a){const e=t.XpG(3);t.Y8G("isError",!0),t.R7$(),t.JRh(e.contentTypeNameError)}}function O(a,d){if(1&a&&t.DNE(0,$,2,1,"app-field-hint",19)(1,X,2,2,"app-field-hint",19),2&a){t.XpG();const e=t.sdS(9);t.vxM(e.errors.required?0:-1),t.R7$(),t.vxM(e.errors.pattern?1:-1)}}function A(a,d){if(1&a&&(t.j41(0,"mat-option",12),t.EFF(1),t.k0s()),2&a){const e=d.$implicit;t.Y8G("value",e.value),t.R7$(),t.SpI(" ",e.name," ")}}function Y(a,d){if(1&a&&(t.j41(0,"div",7)(1,"h3"),t.EFF(2,"Shared Content Type (Ghost)"),t.k0s(),t.j41(3,"p"),t.EFF(4,"Note: this can't be edited in the UI, for now if you really know what you're doing, do it in the DB"),t.k0s(),t.j41(5,"p"),t.EFF(6),t.k0s()()),2&a){const e=t.XpG(2);t.R7$(6),t.SpI("Uses Type Definition of: ",e.contentType().SharedDefId,"")}}function B(a,d){if(1&a){const e=t.RV6();t.j41(0,"form",5,0),t.bIt("ngSubmit",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.save())}),t.j41(2,"div",6)(3,"div")(4,"div",7)(5,"mat-form-field",8)(6,"mat-label"),t.EFF(7,"Name"),t.k0s(),t.j41(8,"input",9,1),t.bIt("ngModelChange",function(n){t.eBV(e);const c=t.XpG();return t.Njj(c.changeContentTypeName(n))}),t.k0s()(),t.DNE(10,O,2,2),t.k0s(),t.j41(11,"mat-accordion")(12,"mat-expansion-panel")(13,"mat-expansion-panel-header")(14,"mat-panel-title"),t.EFF(15,"Advanced"),t.k0s(),t.nrm(16,"mat-panel-description"),t.k0s(),t.j41(17,"div",7)(18,"div",10)(19,"mat-form-field",8)(20,"mat-label"),t.EFF(21,"Scope"),t.k0s(),t.j41(22,"mat-select",11),t.bIt("ngModelChange",function(n){t.eBV(e);const c=t.XpG();return t.Njj(c.changeScope(n))}),t.Z7z(23,A,2,2,"mat-option",12,t.fX1),t.j41(25,"mat-option",12),t.EFF(26,"Other..."),t.k0s()()(),t.j41(27,"button",13),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.unlockScope())}),t.j41(28,"mat-icon"),t.EFF(29),t.k0s()()(),t.j41(30,"app-field-hint"),t.EFF(31," The scope should almost never be changed - "),t.j41(32,"a",14),t.EFF(33,"see help"),t.k0s()()(),t.j41(34,"div",7)(35,"mat-form-field",8)(36,"mat-label"),t.EFF(37,"Static Name"),t.k0s(),t.nrm(38,"input",15),t.k0s()(),t.DNE(39,Y,7,1,"div",7),t.k0s()()()(),t.j41(40,"mat-dialog-actions",16)(41,"button",17),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.closeDialog())}),t.EFF(42,"Cancel"),t.k0s(),t.j41(43,"button",18),t.EFF(44,"Save"),t.k0s()()()}if(2&a){const e=t.sdS(1),o=t.sdS(9),n=t.XpG();t.R7$(8),t.Y8G("pattern",n.contentTypeNamePattern)("ngModel",n.contentType().Name),t.R7$(2),t.vxM(o.touched&&o.errors?10:-1),t.R7$(),t.Y8G("@.disabled",n.disableAnimation()),t.R7$(11),t.Y8G("ngModel",n.contentType().Scope)("disabled",n.lockScope()),t.R7$(),t.Dyx(n.scopeOptions()),t.R7$(2),t.Y8G("value",n.dropdownInsertValue),t.R7$(2),t.Y8G("tippy",n.lockScope()?"Unlock":"Lock"),t.R7$(2),t.SpI(" ",n.lockScope()?"lock":"lock_open"," "),t.R7$(9),t.Y8G("ngModel",n.contentType().NameId),t.R7$(),t.vxM(n.contentType().SharedDefId?39:-1),t.R7$(4),t.Y8G("disabled",!e.form.valid||n.loading())}}let D=(()=>{class a{#e;#t;#n;constructor(e,o,n){this.dialog=e,this.route=o,this.snackBar=n,this.log=(0,k.Tq)({EditContentTypeComponent:a}),this.hostClass="dialog-component",this.#e=(0,S.d)(I.g),this.#t=this.route.snapshot.parent.paramMap.get("scope"),this.#n=this.route.snapshot.paramMap.get("contentTypeStaticName"),this.contentTypeNamePattern=x,this.contentTypeNameError="Standard letters and numbers are allowed. Must start with a letter.",this.dropdownInsertValue=C.O,this.modeIsEdit=!!this.#n,this.lockScope=(0,l.KX)("lockScope",!0),this.disableAnimation=(0,l.KX)("disableAnimation",!0),this.loading=(0,l.KX)("loading",!1),this.contentType=(0,l.KX)("contentType",{StaticName:"",Name:"",Description:"",Scope:this.#t,ChangeNameId:!1,NewNameId:""}),this.#i=this.#e.getScopesSig(void 0),this.#o=(0,l.KX)("scopeOptionsManual",[]),this.scopeOptions=(0,l.bo)("scopeOptions",()=>{const c=this.#i(),E=this.#o();return c?E.concat(this.#s(c)):E}),this.log.a("constructor"),this.#a()}#a(){this.modeIsEdit&&this.#e.retrieveContentType(this.#n).subscribe(e=>{this.contentType.set({...e,ChangeNameId:!1,NewNameId:e.NameId})})}#i;#o;#s(e){const o=[];return e.forEach(n=>{o.some(c=>c.value===n.value)||o.push(n)}),o.some(n=>n.value===this.#t)||o.push({name:this.#t,value:this.#t}),o}ngAfterViewInit(){setTimeout(()=>this.disableAnimation.set(!1))}closeDialog(){this.dialog.close()}changeContentTypeName(e){this.contentType.set({...this.contentType(),Name:e})}changeScope(e){e===C.O&&(e=prompt("This is an advanced feature to show content-types of another scope. Don't use this if you don't know what you're doing, as content-types of other scopes are usually hidden for a good reason.")||F.YX.scopes.default.value,this.scopeOptions().some(o=>o.value===e)||this.#o.set([{name:e,value:e},...this.scopeOptions()])),this.contentType.set({...this.contentType(),Scope:e})}unlockScope(){this.lockScope.set(!this.lockScope()),this.lockScope()&&this.contentType.set({...this.contentType(),Scope:this.#t})}save(){this.loading.set(!0),this.snackBar.open("Saving..."),this.#e.save(this.contentType()).subscribe(e=>{this.loading.set(!1),this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()}),document.activeElement instanceof HTMLElement&&document.activeElement.blur()}static{this.\u0275fac=function(o){return new(o||a)(t.rXU(f.CP),t.rXU(R.nX),t.rXU(G.UG))}}static{this.\u0275cmp=t.VBU({type:a,selectors:[["app-edit-content-type"]],hostVars:1,hostBindings:function(o,n){2&o&&t.Mr5("className",n.hostClass)},decls:5,vars:2,consts:[["ngForm","ngForm"],["name","ngModel"],[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[3,"ngSubmit"],[1,"eav-dialog-content"],[1,"eav-edit-input"],["color","accent",1,"eav-mat-form-field"],["matInput","","type","text","required","","name","Name",3,"ngModelChange","pattern","ngModel"],[1,"eav-form-and-button"],["name","Scope",3,"ngModelChange","ngModel","disabled"],[3,"value"],["mat-icon-button","","type","button","matTextSuffix","",1,"eav-scope-button",3,"click","tippy"],["href","https://2sxc.org/help?tag=scope","target","_blank","appClickStopPropagation",""],["matInput","","type","text","name","StaticName","disabled","",3,"ngModel"],["align","end"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","submit","color","accent",3,"disabled"],[3,"isError"]],template:function(o,n){1&o&&(t.j41(0,"div",2)(1,"div",3)(2,"div",4),t.EFF(3),t.k0s()(),t.DNE(4,B,45,12,"form"),t.k0s()),2&o&&(t.R7$(3),t.JRh(n.modeIsEdit?"Edit Content Type":"New Content Type"),t.R7$(),t.vxM(n.contentType()?4:-1))},dependencies:[s.YN,s.qT,s.me,s.BC,s.cb,s.YS,s.R_,s.vS,s.cV,r.RG,r.rl,r.nJ,r.yw,v.fS,v.fg,p.MY,p.BS,p.GK,p.Z2,p.WN,p.Q6,y.Ve,y.VO,u.wT,u.Sy,m.Hl,m.$z,m.iY,g.m_,g.An,f.E7,N.F,b.c,j.e],styles:[".eav-edit-input[_ngcontent-%COMP%]{padding-bottom:8px}.eav-form-and-button[_ngcontent-%COMP%]{display:flex;align-items:baseline;justify-content:space-between}.eav-form-and-button[_ngcontent-%COMP%]   .eav-scope-button[_ngcontent-%COMP%]{margin-left:8px}"]})}}return a})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/19.01.00/dist/ng-edit/projects_eav-ui_src_app_app-administration_sub-dialogs_edit-content-type_edit-content-type_co-2abec4.e8a73c0009332258.js.map