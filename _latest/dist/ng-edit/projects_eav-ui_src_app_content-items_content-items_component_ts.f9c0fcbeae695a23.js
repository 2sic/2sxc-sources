"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_content-items_content-items_component_ts","projects_eav-ui_src_app_shared_directives_click-stop-propagation_directive_ts","projects_eav-ui_src_app_app-administration_services_app-dialog-config_service_ts-_86580","projects_eav-ui_src_app_app-administration_services_app-dialog-config_service_ts-_86581"],{9731:(P,I,a)=>{a.d(I,{K:()=>T});var s=a(1650),d=a(9736),_=a(3738),x=a(3488),y=a(2611),f=a(1699),m=a(4860),h=a(6232),M=a(7648);let T=(()=>{var p;class C{constructor(v,g,O,F,Z){this.http=v,this.context=g,this.dnnContext=O,this.globalConfigService=F,this.dialogSettings$={},Z.loadFromService(this)}getShared$(v){return v??=this.context.appId,this.dialogSettings$[v]||(this.dialogSettings$[v]=this.getDialogSettings(v).pipe((0,s.d)({refCount:!1}))),this.dialogSettings$[v]}getDialogSettings(v){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/dialog/settings"),{params:{appId:v??this.context.appId.toString()}}).pipe((0,d.U)(g=>(g.Context.Language.List=g.Context.Language.List.filter(O=>O.IsEnabled),g)),(0,_.b)(g=>{this.globalConfigService.allowDebug(g.Context.Enable.DebugMode)}))}}return(p=C).\u0275fac=function(v){return new(v||p)(f.LFG(m.eN),f.LFG(y._),f.LFG(h._y),f.LFG(x.bE),f.LFG(M.k))},p.\u0275prov=f.Yz7({token:p,factory:p.\u0275fac}),C})()},2369:(P,I,a)=>{a.d(I,{T:()=>f});var s=a(2611),d=a(3379),_=a(1699),x=a(4860),y=a(6232);let f=(()=>{var m;class h{constructor(u,T,p){this.http=u,this.context=T,this.dnnContext=p}getContentInfo(u){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(d.v+"Get"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),scope:u}})}exportParts(u,T,p){const C=this.dnnContext.$2sxc.http.apiUrl(d.v+"Export")+"?appId="+this.context.appId.toString()+"&zoneId="+this.context.zoneId.toString()+"&contentTypeIdsString="+u.join(";")+"&entityIdsString="+T.join(";")+"&templateIdsString="+p.join(";");window.open(C,"_blank","")}}return(m=h).\u0275fac=function(u){return new(u||m)(_.LFG(x.eN),_.LFG(s._),_.LFG(y._y))},m.\u0275prov=_.Yz7({token:m,factory:m.\u0275fac}),h})()},2091:(P,I,a)=>{a.d(I,{v:()=>f});var s=a(4173),d=a(2611),_=a(1699),x=a(4860),y=a(6232);let f=(()=>{var m;class h{constructor(u,T,p){this.http=u,this.context=T,this.dnnContext=p}getAppInfo(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(s.H+"Statistics"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}exportApp(u,T){const p=this.dnnContext.$2sxc.http.apiUrl(s.H+"Export")+"?appId="+this.context.appId+"&zoneId="+this.context.zoneId+"&includeContentGroups="+u+"&resetAppGuid="+T;window.open(p,"_blank","")}exportForVersionControl({includeContentGroups:u,resetAppGuid:T,withFiles:p}){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(s.H+"SaveData"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),includeContentGroups:u.toString(),resetAppGuid:T.toString(),withPortalFiles:p.toString()}})}}return(m=h).\u0275fac=function(u){return new(u||m)(_.LFG(x.eN),_.LFG(d._),_.LFG(y._y))},m.\u0275prov=_.Yz7({token:m,factory:m.\u0275fac}),h})()},3379:(P,I,a)=>{a.d(I,{v:()=>f,z:()=>m});var s=a(4173),d=a(2611),_=a(1699),x=a(4860),y=a(6232);const f="admin/appParts/";let m=(()=>{var h;class M{constructor(T,p,C){this.http=T,this.context=p,this.dnnContext=C}importAppParts(T){const p=new FormData;return p.append("File",T),this.http.post(this.dnnContext.$2sxc.http.apiUrl(f+"Import"),p,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}resetApp(T){return this.http.post(this.dnnContext.$2sxc.http.apiUrl(s.H+"Reset"),{},{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),withPortalFiles:T.toString()}})}}return(h=M).\u0275fac=function(T){return new(T||h)(_.LFG(x.eN),_.LFG(d._),_.LFG(y._y))},h.\u0275prov=_.Yz7({token:h,factory:h.\u0275fac}),M})()},1217:(P,I,a)=>{a.d(I,{Az:()=>f.Az,Kw:()=>s.K,TB:()=>f.TB,bf:()=>f.bf,cv:()=>f.cv,h3:()=>m.h,nt:()=>f.nt,sF:()=>d.s,vG:()=>f.vG});var s=a(9731),d=a(5530),f=(a(2369),a(2091),a(3379),a(7749)),m=a(6992)},7749:(P,I,a)=>{a.d(I,{Az:()=>t,TB:()=>g,bf:()=>O,cv:()=>C,nt:()=>v,vG:()=>F});var s=a(6253),d=a(1891),_=a(9736),x=a(400),y=a(237),f=a(2611),m=a(1699),h=a(4860),M=a(6232);const C="admin/query/Run",t="admin/query/DebugStream",v="admin/query/Save",g="admin/query/Get",O="admin/query/DataSources";let F=(()=>{var Z;class L{constructor(D,S,k){this.http=D,this.context=S,this.dnnContext=k}getAll(D){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(x.PS),{params:{appId:this.context.appId.toString(),contentType:D}})}importQuery(D){return(0,s.D)((0,y.s)(D)).pipe((0,d.w)(S=>this.http.post(this.dnnContext.$2sxc.http.apiUrl("admin/query/import"),{AppId:this.context.appId.toString(),ContentBase64:S})),(0,_.U)(S=>({Success:S,Messages:[]})))}clonePipeline(D){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/query/Clone"),{params:{Id:D.toString(),appId:this.context.appId.toString()}})}delete(D){return this.http.delete(this.dnnContext.$2sxc.http.apiUrl("admin/query/Delete"),{params:{appId:this.context.appId.toString(),Id:D.toString()}})}}return(Z=L).\u0275fac=function(D){return new(D||Z)(m.LFG(h.eN),m.LFG(f._),m.LFG(M._y))},Z.\u0275prov=m.Yz7({token:Z,factory:Z.\u0275fac}),L})()},6992:(P,I,a)=>{a.d(I,{h:()=>T});var s=a(2611),d=a(1699),_=a(4860),x=a(6232);const y="admin/view/",f=y+"all",m=y+"delete",h=y+"import",M=y+"polymorphism",u=y+"usage";let T=(()=>{var p;class C{constructor(v,g,O){this.http=v,this.context=g,this.dnnContext=O}getAll(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(f),{params:{appId:this.context.appId.toString()}})}delete(v){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(m),{params:{appId:this.context.appId.toString(),Id:v.toString()}})}import(v){const g=new FormData;return g.append("File",v),this.http.post(this.dnnContext.$2sxc.http.apiUrl(h),g,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}export(v){const g=this.dnnContext.$2sxc.http.apiUrl(y+"json")+"?appId="+this.context.appId+"&viewId="+v;window.open(g,"_blank","")}getPolymorphism(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(M),{params:{appId:this.context.appId.toString()}})}getUsage(v){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(u),{params:{appId:this.context.appId.toString(),guid:v}})}}return(p=C).\u0275fac=function(v){return new(v||p)(d.LFG(_.eN),d.LFG(s._),d.LFG(x._y))},p.\u0275prov=d.Yz7({token:p,factory:p.\u0275fac}),C})()},1352:(P,I,a)=>{a.r(I),a.d(I,{ContentItemsComponent:()=>me});var s=a(9877),d=a(8071),_=a(3839),x=a(9736),y=a(4520),f=a(1527),m=a(5530),h=a(4323),M=a(6191),u=a(3488),T=a(3955),p=a(6041),C=a(8730),t=a(1699),v=a(1268),g=a(8849),O=a(9674);const F=["valueInput"];let Z=(()=>{var o;class c{constructor(){this.filter="",this.idFilterString="",this.idFilter=[]}agInit(e){this.filterParams=e}isFilterActive(){return""!==this.filter||this.idFilter.length>0}doesFilterPass(e){if(""!==this.filter){const r=this.filterParams.valueGetter({api:this.filterParams.api,colDef:this.filterParams.colDef,column:this.filterParams.column,columnApi:this.filterParams.columnApi,context:this.filterParams.context,data:e.node.data,getValue:l=>e.node.data[l],node:e.node});if(null==r||!r.some(l=>!!l&&l.includes(this.filter)))return!1}if(this.idFilter.length>0){const n=e.data[this.filterParams.colDef.headerName];if(null==n||!this.idFilter.some(r=>n.some(l=>l.Id===r)))return!1}return!0}getModel(){return this.isFilterActive()?{filterType:"entity",filter:this.filter,idFilter:this.idFilter}:void 0}setModel(e){this.filter=e?.filter??"",this.idFilter=e?.idFilter??[],this.idFilterString=e?.idFilter?.join(",")??""}afterGuiAttached(e){this.valueInputRef.nativeElement.focus()}updateIdFilter(){this.idFilter=this.idFilterString.split(",").map(e=>parseInt(e,10)).filter(e=>!isNaN(e))}filterChanged(){this.filterParams.filterChangedCallback()}}return(o=c).\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-entity-filter"]],viewQuery:function(e,n){if(1&e&&t.Gf(F,5),2&e){let r;t.iGM(r=t.CRH())&&(n.valueInputRef=r.first)}},decls:9,vars:2,consts:[["color","accent"],["matInput","","type","text",3,"ngModel","ngModelChange"],["valueInput",""]],template:function(e,n){1&e&&(t.TgZ(0,"mat-form-field",0)(1,"mat-label"),t._uU(2,"Value"),t.qZA(),t.TgZ(3,"input",1,2),t.NdJ("ngModelChange",function(l){return n.filter=l})("ngModelChange",function(){return n.filterChanged()}),t.qZA()(),t.TgZ(5,"mat-form-field",0)(6,"mat-label"),t._uU(7,"IDs (comma separated)"),t.qZA(),t.TgZ(8,"input",1),t.NdJ("ngModelChange",function(l){return n.idFilterString=l})("ngModelChange",function(){return n.updateIdFilter(),n.filterChanged()}),t.qZA()()),2&e&&(t.xp6(3),t.Q6J("ngModel",n.filter),t.xp6(5),t.Q6J("ngModel",n.idFilterString))},dependencies:[v.KE,v.hX,g.Fj,g.JJ,g.On,O.Nt],styles:["[_nghost-%COMP%]{display:block;padding:16px 12px 2px}.mat-mdc-form-field[_ngcontent-%COMP%]{display:block;width:150px}"]}),c})();var L=a(5253),Y=a(6433),D=a(196),S=a(6115),k=a(1766),H=a(2957),N=a(9498),G=a(6515),j=a(257),Q=a(8128);function nt(o,c){if(1&o){const i=t.EpF();t.TgZ(0,"button",7),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.deleteItem())}),t.TgZ(1,"mat-icon"),t._uU(2,"delete"),t.qZA(),t.TgZ(3,"span"),t._uU(4,"Delete"),t.qZA()()}if(2&o){const i=t.oxw();t.Q6J("disabled",i.item._EditInfo.DisableDelete)}}let ot=(()=>{var o;class c{agInit(e){this.params=e,this.item=e.data}refresh(e){return!0}clone(){this.params.onClone(this.item)}export(){this.params.onExport(this.item)}deleteItem(){this.params.onDelete(this.item)}}return(o=c).\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-content-items-actions"]],decls:13,vars:1,consts:[[1,"actions-component"],["matRipple","","tippy","Copy",1,"eav-grid-action-button","highlight",3,"click"],["matRipple","","tippy","Export",1,"eav-grid-action-button","highlight",3,"click"],["matRipple","","tippy","More",1,"eav-grid-action-button","highlight",3,"matMenuTriggerFor"],[1,"grid-more-menu"],["menu","matMenu"],["matMenuContent",""],["mat-menu-item","",3,"disabled","click"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.NdJ("click",function(){return n.clone()}),t.TgZ(2,"mat-icon"),t._uU(3,"file_copy"),t.qZA()(),t.TgZ(4,"div",2),t.NdJ("click",function(){return n.export()}),t.TgZ(5,"mat-icon"),t._uU(6,"cloud_download"),t.qZA()(),t.TgZ(7,"div",3)(8,"mat-icon"),t._uU(9,"more_horiz"),t.qZA()()(),t.TgZ(10,"mat-menu",4,5),t.YNc(12,nt,5,1,"ng-template",6),t.qZA()),2&e){const r=t.MAs(11);t.xp6(7),t.Q6J("matMenuTriggerFor",r)}},dependencies:[N.$,G.Hw,j.wG,Q.VK,Q.OP,Q.KA,Q.p6]}),c})();var b=a(6575);function at(o,c){if(1&o&&(t.TgZ(0,"span",2),t._uU(1),t.qZA()),2&o){const i=t.oxw();t.xp6(1),t.Oqu(i.entities)}}let it=(()=>{var o;class c{agInit(e){Array.isArray(e.value)&&(this.encodedValue=this.htmlEncode(e.value.join(", ")),e.colDef.allowMultiValue&&(this.entities=e.value.length))}refresh(e){return!0}htmlEncode(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}}return(o=c).\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-content-items-entity"]],decls:3,vars:3,consts:[[3,"tippy"],["class","more-entities",4,"ngIf"],[1,"more-entities"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.YNc(1,at,2,1,"span",1),t._uU(2),t.qZA()),2&e&&(t.Q6J("tippy",n.encodedValue),t.xp6(1),t.Q6J("ngIf",n.entities),t.xp6(1),t.hij(" ",n.encodedValue,"\n"))},dependencies:[b.O5,N.$],styles:[".more-entities[_ngcontent-%COMP%]{padding:0 8px;border-radius:10px;border:1px solid rgba(29,39,61,.44);-webkit-user-select:none;user-select:none}"]}),c})();var rt=a(5392);const st=function(o){return{"hide-until-row-hover":o}};function lt(o,c){if(1&o){const i=t.EpF();t.TgZ(0,"div",4),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.openMetadata())}),t.TgZ(1,"mat-icon",5),t._uU(2),t.qZA()()}if(2&o){const i=t.oxw();t.Q6J("ngClass",t.VKq(5,st,!i.metadataCount&&!i.value.metadata))("tippy",i.metadataTooltip),t.xp6(1),t.Q6J("matBadge",i.metadataCount)("matBadgeHidden",!i.metadataCount),t.xp6(1),t.hij("",i.value.metadata?"loyalty":"local_offer"," ")}}function ct(o,c){if(1&o&&(t.TgZ(0,"div",6)(1,"mat-icon",7),t._uU(2),t.qZA()()),2&o){const i=t.oxw();t.xp6(1),t.Q6J("matBadge",i.metadataCount)("matBadgeHidden",!i.metadataCount),t.xp6(1),t.hij("",i.value.metadata?"loyalty":"local_offer"," ")}}let pt=(()=>{var o;class c{agInit(e){this.value=e.value,this.params=e,this.item=e.data,this.disableMetadata=this.item._EditInfo.DisableMetadata,this.metadataCount=this.item.Metadata?.length??0,this.metadataTooltip=this.item.For?`This item is metadata for:\nTarget: ${this.item.For.Target}\nTargetType: ${this.item.For.TargetType}`+(this.item.For.Number?`\nNumber: ${this.item.For.Number}`:"")+(this.item.For.String?`\nString: ${this.item.For.String}`:"")+(this.item.For.Guid?`\nGuid: ${this.item.For.Guid}`:"")+(this.item.For.Title?`\nTitle: ${this.item.For.Title}`:""):"This item is not metadata.",this.metadataTooltip+=`\n\nThis item has ${this.metadataCount>0?this.metadataCount:"no"} other metadata ${1===this.metadataCount?"item":"items"} attached to it.`}refresh(e){return!0}openMetadata(){this.params.onOpenMetadata(this.item)}}return(o=c).\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-content-items-status"]],decls:6,vars:4,consts:[[1,"actions-component"],[1,"eav-grid-action-button","icon",3,"tippy"],["class","eav-grid-action-button highlight","matRipple","",3,"ngClass","tippy","click",4,"ngIf"],["class","eav-grid-action-button disabled",4,"ngIf"],["matRipple","",1,"eav-grid-action-button","highlight",3,"ngClass","tippy","click"],["matBadgeColor","accent","matBadgeSize","small","matBadgePosition","below after","aria-hidden","false",3,"matBadge","matBadgeHidden"],[1,"eav-grid-action-button","disabled"],["matBadgeColor","accent","matBadgeSize","small","matBadgeDisabled","true","matBadgePosition","below after","aria-hidden","false",3,"matBadge","matBadgeHidden"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"mat-icon"),t._uU(3),t.qZA()(),t.YNc(4,lt,3,7,"div",2),t.YNc(5,ct,3,3,"div",3),t.qZA()),2&e&&(t.xp6(1),t.Q6J("tippy",n.value.published?"Published":"Not published"),t.xp6(2),t.Oqu(n.value.published?"visibility":"visibility_off"),t.xp6(1),t.Q6J("ngIf",!n.disableMetadata),t.xp6(1),t.Q6J("ngIf",n.disableMetadata&&!(!n.metadataCount&&!n.value.metadata)))},dependencies:[b.mk,b.O5,N.$,G.Hw,j.wG,rt.k],styles:[".hide-until-row-hover[_ngcontent-%COMP%]{visibility:hidden}  .ag-row-hover .hide-until-row-hover{visibility:visible}"]}),c})();var R=a(926),V=a(5043),B=a(3317),_t=a(7835),mt=a(1217),ut=a(9097),X=a(8834),gt=a(2611),q=a(7100),ht=a(3188);function ft(o){return c=>{if(!c.value)return null;const i=o.controls.keyType.value,e=c.value.toString();switch(i){case D.Zy.keyTypes.number:return/^[0-9]+$/.test(e)?null:{patternWholeNumber:!0};case D.Zy.keyTypes.guid:const r=["{","}"].some(A=>e.includes(A)),l=e.substring(r?1:0,r?e.length-1:e.length);return(0,ht.M)().test(l)?null:{patternGuid:!0};default:return null}}}var K=a(6861),Ct=a(9851),yt=a(131),J=a(895),Tt=a(6355),vt=a(9293);function xt(o,c){if(1&o&&(t.TgZ(0,"mat-option",25),t._uU(1),t.qZA()),2&o){const i=c.$implicit;t.Q6J("value",i.targetType),t.xp6(1),t.hij(" ",i.label," ")}}function Mt(o,c){if(1&o&&(t.TgZ(0,"mat-option",25),t._uU(1),t.qZA()),2&o){const i=t.oxw(2).ngIf;t.Q6J("value",i.formValues.targetType),t.xp6(1),t.hij(" ",i.formValues.targetType," ")}}function It(o,c){if(1&o&&(t.TgZ(0,"mat-select",23),t.YNc(1,xt,2,2,"mat-option",12),t.YNc(2,Mt,2,2,"mat-option",24),t.qZA()),2&o){const i=t.oxw().ngIf,e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.targetTypeOptions),t.xp6(1),t.Q6J("ngIf",i.unknownTargetType)}}function Dt(o,c){1&o&&t._UZ(0,"input",26)}function Et(o,c){1&o&&(t.TgZ(0,"app-field-hint",27),t._uU(1," Warning: you entered an unknown target type. This may work or may not. Please be sure you know what you're doing "),t.qZA()),2&o&&t.Q6J("isError",!1)}function At(o,c){if(1&o&&(t.TgZ(0,"app-field-hint",27),t._uU(1),t.qZA()),2&o){const i=t.oxw().ngIf;t.Q6J("isError",!1),t.xp6(1),t.Oqu(i.targetTypeHint)}}function Pt(o,c){1&o&&(t.TgZ(0,"app-field-hint",27),t._uU(1," This field is required "),t.qZA()),2&o&&t.Q6J("isError",!0)}function Ot(o,c){1&o&&(t.TgZ(0,"app-field-hint",27),t._uU(1," Must be a whole number "),t.qZA()),2&o&&t.Q6J("isError",!0)}function bt(o,c){if(1&o&&(t.TgZ(0,"mat-option",25),t._uU(1),t.qZA()),2&o){const i=c.$implicit;t.Q6J("value",i),t.xp6(1),t.hij(" ",i," ")}}function Zt(o,c){1&o&&(t.TgZ(0,"app-field-hint",27),t._uU(1," This field is required "),t.qZA()),2&o&&t.Q6J("isError",!0)}function Ut(o,c){if(1&o&&(t.TgZ(0,"mat-option",25),t._uU(1),t.qZA()),2&o){const i=c.$implicit;t.Q6J("value",i.StaticName),t.xp6(1),t.hij(" ",i.Label," ")}}function Ft(o,c){if(1&o&&(t.TgZ(0,"mat-form-field",7)(1,"mat-label"),t._uU(2,"Content Type"),t.qZA(),t.TgZ(3,"mat-select",28),t.YNc(4,Ut,2,2,"mat-option",12),t.qZA()()),2&o){const i=t.oxw().ngIf;t.xp6(3),t.Q6J("placeholder",i.contentTypes.length?"":"No items found"),t.xp6(1),t.Q6J("ngForOf",i.contentTypes)}}function St(o,c){if(1&o&&(t.TgZ(0,"mat-option",25),t._uU(1),t.qZA()),2&o){const i=c.$implicit;t.Q6J("value",i.value),t.xp6(1),t.hij(" ",i.name," ")}}function Nt(o,c){if(1&o&&(t.TgZ(0,"mat-form-field",7)(1,"mat-label"),t._uU(2,"Scope"),t.qZA(),t.TgZ(3,"mat-select",29),t.YNc(4,St,2,2,"mat-option",12),t.TgZ(5,"mat-option",25),t._uU(6,"Other..."),t.qZA()()()),2&o){const i=t.oxw().ngIf,e=t.oxw();t.xp6(3),t.Q6J("placeholder",i.scopeOptions.length?"":"No items found"),t.xp6(1),t.Q6J("ngForOf",i.scopeOptions),t.xp6(1),t.Q6J("value",e.dropdownInsertValue)}}function Rt(o,c){1&o&&t.GkF(0)}function Bt(o,c){if(1&o&&(t.TgZ(0,"mat-option",25),t._uU(1),t.qZA()),2&o){const i=c.$implicit;t.Q6J("value",i.Guid),t.xp6(1),t.AsE(" ",i.Title," (",i.Id,") ")}}function Kt(o,c){if(1&o&&(t.TgZ(0,"mat-select",35),t.YNc(1,Bt,2,3,"mat-option",12),t.qZA()),2&o){const i=t.oxw(3).ngIf;t.Q6J("placeholder",i.contentItems.length?"":"No items found"),t.xp6(1),t.Q6J("ngForOf",i.contentItems)}}function Jt(o,c){1&o&&t._UZ(0,"input",36)}function wt(o,c){if(1&o&&(t.ynx(0),t.YNc(1,Kt,2,2,"mat-select",33),t.YNc(2,Jt,1,0,"input",34),t.BQk()),2&o){const i=t.oxw(2).ngIf;t.xp6(1),t.Q6J("ngIf",i.guidedKey),t.xp6(1),t.Q6J("ngIf",!i.guidedKey)}}function $t(o,c){if(1&o&&(t.TgZ(0,"mat-option",25),t._uU(1),t.qZA()),2&o){const i=c.$implicit;t.Q6J("value",i.StaticName),t.xp6(1),t.hij(" ",i.Label," ")}}function Lt(o,c){if(1&o&&(t.TgZ(0,"mat-select",35),t.YNc(1,$t,2,2,"mat-option",12),t.qZA()),2&o){const i=t.oxw(3).ngIf;t.Q6J("placeholder",i.contentTypes.length?"":"No items found"),t.xp6(1),t.Q6J("ngForOf",i.contentTypes)}}function kt(o,c){1&o&&t._UZ(0,"input",36)}function Gt(o,c){if(1&o&&(t.ynx(0),t.YNc(1,Lt,2,2,"mat-select",33),t.YNc(2,kt,1,0,"input",34),t.BQk()),2&o){const i=t.oxw(2).ngIf;t.xp6(1),t.Q6J("ngIf",i.guidedKey),t.xp6(1),t.Q6J("ngIf",!i.guidedKey)}}function Qt(o,c){1&o&&t.GkF(0)}function Wt(o,c){if(1&o&&(t.ynx(0),t.YNc(1,Qt,1,0,"ng-container",37),t.BQk()),2&o){t.oxw(2);const i=t.MAs(40);t.xp6(1),t.Q6J("ngTemplateOutlet",i)}}function Yt(o,c){if(1&o&&(t.ynx(0,30),t.YNc(1,wt,3,2,"ng-container",31),t.YNc(2,Gt,3,2,"ng-container",31),t.YNc(3,Wt,2,1,"ng-container",32),t.BQk()),2&o){const i=t.oxw().ngIf,e=t.oxw();t.Q6J("ngSwitch",i.formValues.targetType),t.xp6(1),t.Q6J("ngSwitchCase",e.eavConstants.metadata.entity.targetType),t.xp6(1),t.Q6J("ngSwitchCase",e.eavConstants.metadata.contentType.targetType)}}function Ht(o,c){1&o&&t._UZ(0,"input",36)}function jt(o,c){1&o&&t._UZ(0,"input",39)}function Vt(o,c){if(1&o&&(t.YNc(0,Ht,1,0,"input",34),t.YNc(1,jt,1,0,"input",38)),2&o){const i=t.oxw().ngIf,e=t.oxw();t.Q6J("ngIf",i.formValues.keyType!==e.eavConstants.keyTypes.number),t.xp6(1),t.Q6J("ngIf",i.formValues.keyType===e.eavConstants.keyTypes.number)}}const tt=function(o){return{active:o}};function zt(o,c){if(1&o){const i=t.EpF();t.TgZ(0,"div",40)(1,"button",41),t.NdJ("click",function(){t.CHM(i);const n=t.oxw(2);return t.KtG(n.toggleGuidedKey(!0))}),t.TgZ(2,"mat-icon",42),t._uU(3,"search"),t.qZA()(),t.TgZ(4,"button",43),t.NdJ("click",function(){t.CHM(i);const n=t.oxw(2);return t.KtG(n.toggleGuidedKey(!1))}),t.TgZ(5,"mat-icon",42),t._uU(6,"text_fields"),t.qZA()()()}if(2&o){const i=t.oxw().ngIf;t.xp6(1),t.Q6J("ngClass",t.VKq(2,tt,i.guidedKey)),t.xp6(3),t.Q6J("ngClass",t.VKq(4,tt,!i.guidedKey))}}function Xt(o,c){1&o&&(t.TgZ(0,"app-field-hint",27),t._uU(1," This field is required "),t.qZA()),2&o&&t.Q6J("isError",!0)}function qt(o,c){1&o&&(t.TgZ(0,"app-field-hint",27),t._uU(1," Must be a whole number "),t.qZA()),2&o&&t.Q6J("isError",!0)}function te(o,c){1&o&&(t.TgZ(0,"app-field-hint",27),t._uU(1," Must be a valid GUID "),t.qZA()),2&o&&t.Q6J("isError",!0)}function ee(o,c){if(1&o){const i=t.EpF();t.ynx(0),t.TgZ(1,"div",1)(2,"div",2)(3,"div",3),t._uU(4,"Create Metadata"),t.qZA()(),t.TgZ(5,"div",4)(6,"p"),t._uU(7," This is a special operation to add an item which is metadata for another item, see "),t.TgZ(8,"a",5),t._uU(9,"docs"),t.qZA(),t._uU(10,". "),t.qZA(),t.TgZ(11,"form",6)(12,"mat-form-field",7)(13,"mat-label"),t._uU(14,"Target"),t.qZA(),t.YNc(15,It,3,2,"mat-select",8),t.YNc(16,Dt,1,0,"input",9),t.qZA(),t.YNc(17,Et,2,1,"app-field-hint",10),t.YNc(18,At,2,2,"app-field-hint",10),t.YNc(19,Pt,2,1,"app-field-hint",10),t.YNc(20,Ot,2,1,"app-field-hint",10),t.TgZ(21,"mat-form-field",7)(22,"mat-label"),t._uU(23,"Key type"),t.qZA(),t.TgZ(24,"mat-select",11),t.YNc(25,bt,2,2,"mat-option",12),t.qZA()(),t.YNc(26,Zt,2,1,"app-field-hint",10),t.YNc(27,Ft,5,2,"mat-form-field",13),t.YNc(28,Nt,7,3,"mat-form-field",13),t.TgZ(29,"app-field-hint"),t._uU(30," The scope should almost never be changed - "),t.TgZ(31,"a",14),t._uU(32,"see help"),t.qZA()(),t.TgZ(33,"mat-form-field",7)(34,"mat-label"),t._uU(35,"Key"),t.qZA(),t.YNc(36,Rt,1,0,"ng-container",15),t.YNc(37,Yt,4,3,"ng-template",null,16,t.W1O),t.YNc(39,Vt,2,2,"ng-template",null,17,t.W1O),t.YNc(41,zt,7,6,"div",18),t.qZA(),t.YNc(42,Xt,2,1,"app-field-hint",10),t.YNc(43,qt,2,1,"app-field-hint",10),t.YNc(44,te,2,1,"app-field-hint",10),t.qZA()(),t.TgZ(45,"mat-dialog-actions",19)(46,"mat-slide-toggle",20),t.NdJ("change",function(n){t.CHM(i);const r=t.oxw();return t.KtG(r.toggleGuidedMode(n))}),t._uU(47),t.qZA(),t.TgZ(48,"div")(49,"button",21),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.closeDialog())}),t._uU(50,"Cancel"),t.qZA(),t.TgZ(51,"button",22),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.confirm())}),t._uU(52," Confirm "),t.qZA()()()(),t.BQk()}if(2&o){const i=c.ngIf,e=t.MAs(38),n=t.MAs(40),r=t.oxw();t.xp6(11),t.Q6J("formGroup",r.form),t.xp6(4),t.Q6J("ngIf",i.guidedMode),t.xp6(1),t.Q6J("ngIf",!i.guidedMode),t.xp6(1),t.Q6J("ngIf",r.form.controls.targetType.touched&&!r.form.controls.targetType.invalid&&i.unknownTargetType),t.xp6(1),t.Q6J("ngIf",i.targetTypeHint),t.xp6(1),t.Q6J("ngIf",r.form.controls.targetType.touched&&(null==r.form.controls.targetType.errors?null:r.form.controls.targetType.errors.required)),t.xp6(1),t.Q6J("ngIf",r.form.controls.targetType.touched&&(null==r.form.controls.targetType.errors?null:r.form.controls.targetType.errors.pattern)),t.xp6(5),t.Q6J("ngForOf",i.keyTypeOptions),t.xp6(1),t.Q6J("ngIf",r.form.controls.keyType.touched&&(null==r.form.controls.keyType.errors?null:r.form.controls.keyType.errors.required)),t.xp6(1),t.Q6J("ngIf",i.guidedMode&&i.formValues.targetType===r.eavConstants.metadata.entity.targetType),t.xp6(1),t.Q6J("ngIf",i.guidedMode&&(i.formValues.targetType===r.eavConstants.metadata.entity.targetType||i.formValues.targetType===r.eavConstants.metadata.contentType.targetType)),t.xp6(8),t.Q6J("ngIf",i.guidedMode)("ngIfThen",e)("ngIfElse",n),t.xp6(5),t.Q6J("ngIf",i.guidedMode&&i.guidedKeyExists),t.xp6(1),t.Q6J("ngIf",r.form.controls.key.touched&&(null==r.form.controls.key.errors?null:r.form.controls.key.errors.required)),t.xp6(1),t.Q6J("ngIf",r.form.controls.key.touched&&(null==r.form.controls.key.errors?null:r.form.controls.key.errors.patternWholeNumber)),t.xp6(1),t.Q6J("ngIf",r.form.controls.key.touched&&(null==r.form.controls.key.errors?null:r.form.controls.key.errors.patternGuid)),t.xp6(2),t.Q6J("tippy",i.guidedMode?"Guided mode helps you select options that work":"Manual mode is for advanced uses and allows you to insert any values")("checked",i.guidedMode),t.xp6(1),t.hij(" ",i.guidedMode?"Guided":"Manual"," "),t.xp6(4),t.Q6J("disabled",!r.form.valid)}}let ne=(()=>{var o;class c extends ut.f{constructor(e,n,r,l){super(),this.dialogRef=e,this.context=n,this.contentItemsService=r,this.contentTypesService=l,this.hostClass="dialog-component",this.eavConstants=D.Zy,this.dropdownInsertValue=X.G}ngOnInit(){this.targetTypeOptions=Object.values(D.Zy.metadata).map(n=>({...n})),this.keyTypeOptions=Object.values(D.Zy.keyTypes),this.keyTypeOptions$=new d.X([]),this.scopeOptions$=new d.X([]),this.guidedMode$=new d.X(!0),this.contentItems$=new d.X([]),this.contentTypes$=new d.X([]),this.guidedKey$=new d.X(!0),this.fetchScopes(),this.form=new g.nJ({}),this.form.addControl("targetType",new g.p4(D.Zy.metadata.entity.targetType,[g.kI.required,g.kI.pattern(/^[0-9]+$/)])),this.form.addControl("keyType",new g.p4(D.Zy.metadata.entity.keyType,[g.kI.required])),this.form.addControl("contentTypeForContentItems",new g.p4(null)),this.form.addControl("scopeForContentTypes",new g.p4(D.Zy.scopes.default.value)),this.form.addControl("key",new g.p4(null,[g.kI.required,ft(this.form)])),this.subscription.add(this.form.controls.scopeForContentTypes.valueChanges.pipe((0,V.O)(this.form.controls.scopeForContentTypes.value),(0,B.x)()).subscribe(n=>{null!=this.form.controls.contentTypeForContentItems.value&&this.form.controls.contentTypeForContentItems.patchValue(null),n===X.G?(n=prompt("This is an advanced feature to show content-types of another scope. Don't use this if you don't know what you're doing, as content-types of other scopes are usually hidden for a good reason.")||D.Zy.scopes.default.value,this.scopeOptions$.value.some(r=>r.value===n)||this.scopeOptions$.next([{name:n,value:n},...this.scopeOptions$.value]),this.form.controls.scopeForContentTypes.patchValue(n)):this.fetchContentTypes(n)})),this.subscription.add((0,_t.T)(this.form.controls.targetType.valueChanges.pipe((0,B.x)()),this.form.controls.keyType.valueChanges.pipe((0,B.x)())).subscribe(()=>{this.guidedKey$.next(!0),null!=this.form.getRawValue().key&&this.form.patchValue({key:null})})),this.subscription.add(this.form.controls.contentTypeForContentItems.valueChanges.pipe((0,V.O)(this.form.controls.contentTypeForContentItems.value),(0,B.x)()).subscribe(n=>{const r=this.form.getRawValue();r.targetType===D.Zy.metadata.entity.targetType&&null!=r.key&&this.form.patchValue({key:null}),this.contentItemsService.getAll(n).subscribe(l=>{this.contentItems$.next(l)})}));const e=this.form.valueChanges.pipe((0,V.O)(this.form.getRawValue()),(0,x.U)(()=>this.form.getRawValue()),(0,B.x)(R.iX.objectsEqual));this.subscription.add((0,_.a)([e,this.guidedMode$]).subscribe(([n,r])=>{const l=this.targetTypeOptions.find(W=>W.targetType===n.targetType),E=r&&l?[l.keyType]:[...this.keyTypeOptions];R.iX.arraysEqual(E,this.keyTypeOptions$.value)||this.keyTypeOptions$.next(E);const A={};this.keyTypeOptions$.value.includes(n.keyType)||(A.keyType=this.keyTypeOptions$.value[0]);const U=r&&n.targetType===D.Zy.metadata.app.targetType;U&&n.key!==this.context.appId&&(A.key=this.context.appId),Object.keys(A).length&&this.form.patchValue(A),R.iX.disableControl(this.form.controls.keyType,r&&this.keyTypeOptions$.value.length<=1),R.iX.disableControl(this.form.controls.key,U)})),this.viewModel$=(0,_.a)([(0,_.a)([this.guidedMode$,this.keyTypeOptions$,this.scopeOptions$,this.contentItems$,this.contentTypes$]),(0,_.a)([e,this.guidedKey$])]).pipe((0,x.U)(([[n,r,l,E,A],[U,w]])=>({guidedMode:n,unknownTargetType:!this.targetTypeOptions.some($=>$.targetType===U.targetType),targetTypeHint:n&&this.targetTypeOptions.find($=>$.targetType===U.targetType)?.hint,keyTypeOptions:r,scopeOptions:l,guidedKey:w,guidedKeyExists:[D.Zy.metadata.entity.targetType,D.Zy.metadata.contentType.targetType].includes(U.targetType),formValues:U,contentItems:E,contentTypes:A})))}ngOnDestroy(){this.guidedMode$.complete(),this.keyTypeOptions$.complete(),this.contentItems$.complete(),this.contentTypes$.complete(),this.guidedKey$.complete(),super.ngOnDestroy()}closeDialog(e){this.dialogRef.close(e)}toggleGuidedKey(e){this.guidedKey$.next(e)}toggleGuidedMode(e){this.guidedMode$.next(e.checked)}confirm(){const e=this.form.getRawValue(),n={target:this.targetTypeOptions.find(r=>r.targetType===e.targetType)?.target,targetType:e.targetType,keyType:e.keyType,key:e.keyType===D.Zy.keyTypes.guid?e.key.replace(/{|}/g,""):e.key.toString()};this.closeDialog(n)}fetchContentTypes(e){this.contentTypesService.retrieveContentTypes(e).subscribe(n=>{this.contentTypes$.next(n)})}fetchScopes(){this.contentTypesService.getScopes().subscribe(e=>{this.scopeOptions$.next(e)})}}return(o=c).\u0275fac=function(e){return new(e||o)(t.Y36(K.so),t.Y36(gt._),t.Y36(q.l),t.Y36(mt.sF))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-create-metadata-dialog"]],hostVars:1,hostBindings:function(e,n){2&e&&t.Ikx("className",n.hostClass)},features:[t.qOj],decls:2,vars:3,consts:[[4,"ngIf"],[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],["href","https://go.2sxc.org/metadata","target","_blank"],[3,"formGroup"],["color","accent",1,"eav-form-field"],["formControlName","targetType","required","",4,"ngIf"],["matInput","","type","number","min","0","formControlName","targetType","required","",4,"ngIf"],[3,"isError",4,"ngIf"],["formControlName","keyType","required",""],[3,"value",4,"ngFor","ngForOf"],["color","accent","class","eav-form-field",4,"ngIf"],["href","https://2sxc.org/help?tag=scope","target","_blank","appClickStopPropagation",""],[4,"ngIf","ngIfThen","ngIfElse"],["specialKeyInputs",""],["defaultKeyInput",""],["matTextSuffix","","class","eav-selection-suffix",4,"ngIf"],[1,"eav-dialog-actions"],["color","accent",3,"tippy","checked","change"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],["formControlName","targetType","required",""],[3,"value",4,"ngIf"],[3,"value"],["matInput","","type","number","min","0","formControlName","targetType","required",""],[3,"isError"],["formControlName","contentTypeForContentItems",3,"placeholder"],["formControlName","scopeForContentTypes",3,"placeholder"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["formControlName","key","required","",3,"placeholder",4,"ngIf"],["matInput","","type","text","formControlName","key","required","",4,"ngIf"],["formControlName","key","required","",3,"placeholder"],["matInput","","type","text","formControlName","key","required",""],[4,"ngTemplateOutlet"],["matInput","","type","number","formControlName","key","required","",4,"ngIf"],["matInput","","type","number","formControlName","key","required",""],["matTextSuffix","",1,"eav-selection-suffix"],["mat-icon-button","","type","button","tippy","Pick existing value",1,"eav-selection-suffix-button",3,"ngClass","click"],[1,"eav-icon"],["mat-icon-button","","type","button","tippy","Manual entry",1,"eav-selection-suffix-button",3,"ngClass","click"]],template:function(e,n){1&e&&(t.YNc(0,ee,53,22,"ng-container",0),t.ALo(1,"async")),2&e&&t.Q6J("ngIf",t.lcZ(1,1,n.viewModel$))},dependencies:[b.mk,b.sg,b.O5,b.tP,b.RF,b.n9,b.ED,Ct.Y,yt.E,N.$,K.H8,J.lW,J.RK,G.Hw,g._Y,g.Fj,g.wV,g.JJ,g.JL,g.Q7,g.qQ,O.Nt,v.KE,v.hX,v.R9,Tt.gD,j.ey,g.sg,g.u,vt.Rr,b.Ov]}),c})();var et=a(2106);let oe=(()=>{var o;class c{constructor(){this.published="",this.metadata="",this.hasMetadata=""}agInit(e){this.filterParams=e}isFilterActive(){return""!==this.published||""!==this.metadata||""!==this.hasMetadata}doesFilterPass(e){let n=!1,r=!1,l=!1;const A=this.filterParams.valueGetter({api:this.filterParams.api,colDef:this.filterParams.colDef,column:this.filterParams.column,columnApi:this.filterParams.columnApi,context:this.filterParams.context,data:e.node.data,getValue:U=>e.node.data[U],node:e.node});return n=""===this.published||null!=A.published&&A.published.toString()===this.published,r=""===this.metadata||null!=A.metadata&&A.metadata.toString()===this.metadata,l=""===this.hasMetadata||null!=A.hasMetadata&&A.hasMetadata.toString()===this.hasMetadata,n&&r&&l}getModel(){return this.isFilterActive()?{filterType:"pub-meta",published:this.published,metadata:this.metadata,hasMetadata:this.hasMetadata}:void 0}setModel(e){this.published=e?e.published:"",this.metadata=e?e.metadata:"",this.hasMetadata=e?e.hasMetadata:""}afterGuiAttached(e){}filterChanged(){this.filterParams.filterChangedCallback()}}return(o=c).\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-pub-meta-filter"]],decls:27,vars:3,consts:[[1,"title"],[3,"ngModel","ngModelChange"],["value",""],["value","true"],["value","false"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t._uU(1,"Published"),t.qZA(),t.TgZ(2,"mat-radio-group",1),t.NdJ("ngModelChange",function(l){return n.published=l})("ngModelChange",function(){return n.filterChanged()}),t.TgZ(3,"mat-radio-button",2),t._uU(4,"All"),t.qZA(),t.TgZ(5,"mat-radio-button",3),t._uU(6,"Published"),t.qZA(),t.TgZ(7,"mat-radio-button",4),t._uU(8,"Not published"),t.qZA()(),t.TgZ(9,"div",0),t._uU(10,"Is Metadata"),t.qZA(),t.TgZ(11,"mat-radio-group",1),t.NdJ("ngModelChange",function(l){return n.metadata=l})("ngModelChange",function(){return n.filterChanged()}),t.TgZ(12,"mat-radio-button",2),t._uU(13,"All"),t.qZA(),t.TgZ(14,"mat-radio-button",3),t._uU(15,"Is metadata"),t.qZA(),t.TgZ(16,"mat-radio-button",4),t._uU(17,"Is not metadata"),t.qZA()(),t.TgZ(18,"div",0),t._uU(19,"Has Metadata"),t.qZA(),t.TgZ(20,"mat-radio-group",1),t.NdJ("ngModelChange",function(l){return n.hasMetadata=l})("ngModelChange",function(){return n.filterChanged()}),t.TgZ(21,"mat-radio-button",2),t._uU(22,"All"),t.qZA(),t.TgZ(23,"mat-radio-button",3),t._uU(24,"Has metadata"),t.qZA(),t.TgZ(25,"mat-radio-button",4),t._uU(26,"Has no metadata"),t.qZA()()),2&e&&(t.xp6(2),t.Q6J("ngModel",n.published),t.xp6(9),t.Q6J("ngModel",n.metadata),t.xp6(9),t.Q6J("ngModel",n.hasMetadata))},dependencies:[g.JJ,g.On,et.VQ,et.U0],styles:[".title[_ngcontent-%COMP%]{padding:12px 12px 0}.mat-mdc-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;overflow:hidden;padding:12px;width:160px;height:104px}"]}),c})();var ae=a(1092),z=a(91),ie=a(9409),re=a(2849),se=a(40),le=a(8621),ce=a(6537);function pe(o,c){1&o&&(t._UZ(0,"div",18),t.ALo(1,"safeHtml")),2&o&&t.Q6J("innerHTML",t.lcZ(1,1,c.ngIf),t.oJD)}function de(o,c){if(1&o){const i=t.EpF();t.TgZ(0,"button",19),t.NdJ("click",function(){t.CHM(i);const n=t.oxw(2);return t.KtG(n.debugFilter())}),t.TgZ(1,"mat-icon",12),t._uU(2,"filter_list"),t.qZA(),t.TgZ(3,"span"),t._uU(4,"Filter"),t.qZA()()}}function _e(o,c){if(1&o){const i=t.EpF();t.TgZ(0,"div",1)(1,"div",2)(2,"div",3),t._uU(3),t.qZA(),t.TgZ(4,"button",4),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.closeDialog())}),t.TgZ(5,"mat-icon"),t._uU(6,"close"),t.qZA()()(),t.TgZ(7,"div",5),t._UZ(8,"router-outlet"),t.YNc(9,pe,2,3,"div",6),t.TgZ(10,"div",7)(11,"ag-grid-angular",8),t.NdJ("gridReady",function(n){t.CHM(i);const r=t.oxw();return t.KtG(r.onGridReady(n))})("filesDropped",function(n){t.CHM(i);const r=t.oxw();return t.KtG(r.filesDropped(n))}),t.qZA()()(),t.TgZ(12,"mat-dialog-actions",9)(13,"div",10)(14,"button",11),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.exportContent())}),t.TgZ(15,"mat-icon",12),t._uU(16,"cloud_download"),t.qZA(),t.TgZ(17,"span"),t._uU(18,"Data"),t.qZA()(),t.TgZ(19,"button",13),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.importContent())}),t.TgZ(20,"mat-icon",12),t._uU(21,"cloud_upload"),t.qZA(),t.TgZ(22,"span"),t._uU(23,"Data"),t.qZA()(),t.TgZ(24,"button",14),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.importItem())}),t.TgZ(25,"mat-icon",12),t._uU(26,"cloud_upload"),t.qZA(),t.TgZ(27,"span"),t._uU(28,"Item"),t.qZA()(),t.TgZ(29,"button",15),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.createMetadata())}),t.TgZ(30,"mat-icon",12),t._uU(31,"local_offer"),t.qZA(),t.TgZ(32,"span"),t._uU(33,"Create Metadata"),t.qZA()(),t.YNc(34,de,5,0,"button",16),t.qZA(),t.TgZ(35,"button",17),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.editItem(null))}),t.TgZ(36,"mat-icon"),t._uU(37,"add"),t.qZA()()()()}if(2&o){const i=c.ngIf,e=t.oxw();t.xp6(3),t.hij(" ",i.contentType.Label||i.contentType.Name," Data "),t.xp6(6),t.Q6J("ngIf",null==i.contentType||null==i.contentType.Properties?null:i.contentType.Properties.ListInstructions),t.xp6(2),t.Q6J("rowData",i.items)("gridOptions",e.gridOptions)("allowedFileTypes","xml,json"),t.xp6(23),t.Q6J("ngIf",i.debugEnabled)}}let me=(()=>{var o;class c extends p.H{constructor(e,n,r,l,E,A,U,w,W,$,ue,ge){super(e,n),this.router=e,this.route=n,this.dialogRef=r,this.contentTypesService=l,this.contentItemsService=E,this.entitiesService=A,this.contentExportService=U,this.snackBar=w,this.globalConfigService=W,this.dialog=$,this.viewContainerRef=ue,this.changeDetectorRef=ge,this.contentType$=new s.x,this.items$=new d.X(void 0),this.gridOptions={...Y.f},this.gridApi$=new d.X(null),this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName")}ngOnInit(){this.fetchContentType(),this.fetchItems(),this.fetchColumns(),this.subscription.add(this.refreshOnChildClosedShallow().subscribe(()=>{this.fetchItems()})),this.viewModel$=(0,_.a)([this.contentType$,this.items$,this.globalConfigService.getDebugEnabled$()]).pipe((0,x.U)(([e,n,r])=>({contentType:e,items:n,debugEnabled:r})))}ngOnDestroy(){this.contentType$.complete(),this.items$.complete(),this.gridApi$.complete(),super.ngOnDestroy()}closeDialog(){this.dialogRef.close()}onGridReady(e){this.gridApi$.next(e.api)}fetchContentType(){this.contentTypesService.retrieveContentType(this.contentTypeStaticName).subscribe(e=>{this.contentType$.next(e)})}fetchItems(){this.contentItemsService.getAll(this.contentTypeStaticName).subscribe(e=>{this.items$.next(e)})}fetchColumns(){this.contentItemsService.getColumns(this.contentTypeStaticName).subscribe(e=>{const n=this.buildColumnDefs(e),r=function dt(o,c){if(!o)return;let i;"="===o.charAt(o.length-1)&&(o=atob(o));try{i=JSON.parse(o)}catch{console.error("Can't parse JSON with filters from url:",o)}if(!i)return;const e={};return(i.IsPublished||i.IsMetadata)&&(e.Status={filterType:"pub-meta",published:i.IsPublished??"",metadata:i.IsMetadata??"",hasMetadata:""}),Object.entries(i).filter(([n,r])=>"IsPublished"!==n&&"IsMetadata"!==n).forEach(([n,r])=>{if(c.find(E=>E.headerName===n)?.filter!==Z){if("string"==typeof r)e[n]={filterType:"text",type:"equals",filter:r};else if("number"==typeof r)e[n]={filterType:"number",type:"equals",filter:r,filterTo:null};else if("boolean"==typeof r){const E={filterType:"boolean",filter:r.toString()};e[n]=E}}else{const E={filterType:"entity",filter:"string"==typeof(r=R.iX.tryParse(r)??r)?r:void 0,idFilter:"number"==typeof r?[r]:Array.isArray(r)?r.filter(A=>"number"==typeof A):void 0};e[n]=E}}),e}(sessionStorage.getItem(S.JA),n);this.gridApi$.value?this.setColumnDefs(n,r):this.gridApi$.pipe((0,y.h)(l=>null!=l),(0,f.q)(1)).subscribe(l=>{this.setColumnDefs(n,r)})})}setColumnDefs(e,n){this.gridApi$.value.setColumnDefs(e),n&&((0,k.P)("Will try to apply filter:",n),this.gridApi$.value.setFilterModel(n))}openMetadata(e){const n=T.U.getUrlEntity(e.Guid,`Metadata for Entity: ${e._Title} (${e.Id})`,this.contentTypeStaticName);this.router.navigate([n],{relativeTo:this.route})}editItem(e){const r=(0,H.f)({items:[null==e?{ContentTypeName:this.contentTypeStaticName}:{EntityId:e.Id}]});this.router.navigate([`edit/${r}`],{relativeTo:this.route})}exportContent(){const e=this.gridApi$.value.getFilterModel(),n=Object.keys(e).length>0,r=[];n&&this.gridApi$.value.forEachNodeAfterFilterAndSort(l=>{r.push(l.data.Id)}),this.router.navigate([`export/${this.contentTypeStaticName}${r.length>0?`/${r}`:""}`],{relativeTo:this.route})}filesDropped(e){const n=e[0];switch(n.name.substring(n.name.lastIndexOf(".")+1).toLocaleLowerCase()){case"xml":this.importContent(e);break;case"json":this.importItem(e)}}importContent(e){this.router.navigate([`${this.contentTypeStaticName}/import`],{relativeTo:this.route,state:{files:e}})}importItem(e){this.router.navigate(["import"],{relativeTo:this.route,state:{files:e}})}createMetadata(){this.dialog.open(ne,{autoFocus:!1,viewContainerRef:this.viewContainerRef,width:"650px"}).afterClosed().subscribe(n=>{if(null==n)return;const r={items:[{ContentTypeName:this.contentTypeStaticName,For:{Target:n.target??n.targetType.toString(),TargetType:n.targetType,...n.keyType===D.Zy.keyTypes.guid&&{Guid:n.key},...n.keyType===D.Zy.keyTypes.number&&{Number:parseInt(n.key,10)},...n.keyType===D.Zy.keyTypes.string&&{String:n.key}}}]},l=(0,H.f)(r);this.router.navigate([`edit/${l}`],{relativeTo:this.route}),this.changeDetectorRef.markForCheck()})}debugFilter(){console.warn("Current filter:",this.gridApi$.value.getFilterModel()),this.snackBar.open("Check console for filter information",void 0,{duration:3e3})}buildColumnDefs(e){const n=[{headerName:"ID",field:"Id",width:70,headerClass:"dense",sortable:!0,filter:"agNumberColumnFilter",cellClass:r=>("id-action no-padding no-outline "+(r.data._EditInfo.ReadOnly?"disabled":"")).split(" "),valueGetter:r=>r.data.Id,cellRenderer:L.m,cellRendererParams:{tooltipGetter:l=>`ID: ${l.Id}\nRepoID: ${l._RepositoryId}\nGUID: ${l.Guid}`}},{field:"Status",width:82,headerClass:"dense",cellClass:"secondary-action no-padding".split(" "),filter:oe,valueGetter:r=>{const l=r.data;return{published:l.IsPublished,metadata:!!l.For,hasMetadata:!!l.Metadata&&l.Metadata.length>0}},cellRenderer:pt,cellRendererParams:(()=>({onOpenMetadata:l=>this.openMetadata(l)}))()},{headerName:"Item (Entity)",field:"_Title",flex:2,minWidth:250,cellClass:"primary-action highlight".split(" "),sortable:!0,filter:"agTextColumnFilter",onCellClicked:r=>{this.editItem(r.data)},valueGetter:r=>r.data._Title},{headerName:"Stats",headerTooltip:"Used by others / uses others",field:"_Used",width:70,headerClass:"dense",cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:r=>{const l=r.data;return`${l._Used} / ${l._Uses}`}},{cellClass:"secondary-action no-padding".split(" "),width:122,pinned:"right",cellRenderer:ot,cellRendererParams:(()=>({onClone:l=>this.clone(l),onExport:l=>this.export(l),onDelete:l=>this.delete(l)}))()}];for(const r of e){const l={headerName:r.StaticName,field:r.StaticName,flex:2,minWidth:250,cellClass:"no-outline",sortable:!0};switch(r.Type){case M.Q.Entity:l.allowMultiValue=r.Metadata?.Entity?.AllowMultiValue??!0,l.cellRenderer=it,l.valueGetter=this.valueGetterEntityField,l.filter=Z;break;case M.Q.DateTime:l.useTimePicker=r.Metadata?.DateTime?.UseTimePicker??!1,l.valueGetter=this.valueGetterDateTime,l.filter="agTextColumnFilter";break;case M.Q.Boolean:l.valueGetter=this.valueGetterBoolean,l.filter=C.U;break;case M.Q.Number:l.filter="agNumberColumnFilter";break;default:l.filter="agTextColumnFilter"}n.push(l)}return n}clone(e){const r=(0,H.f)({items:[{ContentTypeName:this.contentTypeStaticName,DuplicateEntity:e.Id}]});this.router.navigate([`edit/${r}`],{relativeTo:this.route})}export(e){this.contentExportService.exportEntity(e.Id,this.contentTypeStaticName,!0)}delete(e){confirm(`Delete '${e._Title}' (${e._RepositoryId})?`)&&(this.snackBar.open("Deleting..."),this.entitiesService.delete(this.contentTypeStaticName,e._RepositoryId,!1).subscribe({next:()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchItems()},error:n=>{this.snackBar.dismiss(),confirm(`${n.error.ExceptionMessage}\n\nDo you want to force delete '${e._Title}' (${e._RepositoryId})?`)&&(this.snackBar.open("Deleting..."),this.entitiesService.delete(this.contentTypeStaticName,e._RepositoryId,!0).subscribe(()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchItems()}))}}))}valueGetterEntityField(e){const n=e.data[e.colDef.field];return 0===n.length?null:n.map(r=>r.Title)}valueGetterDateTime(e){const n=e.data[e.colDef.field];return n?e.colDef.useTimePicker?n.replace("T"," ").replace("Z",""):n.split("T")[0]:null}valueGetterBoolean(e){const n=e.data[e.colDef.field];return"boolean"!=typeof n?null:n.toString()}}return(o=c).\u0275fac=function(e){return new(e||o)(t.Y36(z.F0),t.Y36(z.gz),t.Y36(K.so),t.Y36(m.s),t.Y36(q.l),t.Y36(ae.g),t.Y36(h.i),t.Y36(ie.ux),t.Y36(u.bE),t.Y36(K.uw),t.Y36(t.s_b),t.Y36(t.sBO))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-content-items"]],features:[t.qOj],decls:2,vars:3,consts:[["appToggleDebug","","class","eav-dialog nav-component-wrapper",4,"ngIf"],["appToggleDebug","",1,"eav-dialog","nav-component-wrapper"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"eav-dialog-content","nav-component-wrapper"],[3,"innerHTML",4,"ngIf"],[1,"grid-wrapper"],["appDragAndDrop","",1,"ag-theme-material",3,"rowData","gridOptions","allowedFileTypes","gridReady","filesDropped"],[1,"eav-dialog-actions"],[1,"eav-dialog-actions-div"],["mat-button","","tippy","Export xml list",1,"eav-button__with-icon",3,"click"],[1,"eav-icon"],["mat-button","","tippy","Import xml list",1,"eav-button__with-icon",3,"click"],["mat-button","","tippy","Import single json item",1,"eav-button__with-icon",3,"click"],["mat-button","","tippy","Create metadata",1,"eav-button__with-icon",3,"click"],["mat-button","","class","eav-button__with-icon","color","accent","tippy","Print filter to console",3,"click",4,"ngIf"],["mat-fab","","mat-elevation-z24","","tippy","Add item",1,"grid-fab",3,"click"],[3,"innerHTML"],["mat-button","","color","accent","tippy","Print filter to console",1,"eav-button__with-icon",3,"click"]],template:function(e,n){1&e&&(t.YNc(0,_e,38,6,"div",0),t.ALo(1,"async")),2&e&&t.Q6J("ngIf",t.lcZ(1,1,n.viewModel$))},dependencies:[b.O5,z.lC,re.z,se.D,N.$,K.H8,J.lW,J.RK,J.cs,G.Hw,le.N8,b.Ov,ce.z]}),c})()},4173:(P,I,a)=>{a.d(I,{H:()=>h,a:()=>M});var s=a(1891),d=a(4980),_=a(7503),x=a(2611),y=a(1699),f=a(4860),m=a(6232);const h="admin/app/";let M=(()=>{var u;class T{constructor(C,t,v){this.http=C,this.context=t,this.dnnContext=v}importApp(C,t,v=!1){const g=new FormData;return g.append("File",C),g.append("Name",t??""),this.http.post(this.dnnContext.$2sxc.http.apiUrl(h+"Import"),g,{params:{zoneId:this.context.zoneId.toString()}}).pipe((0,s.w)(O=>{if(v&&O.Messages[0]?.MessageType===_.DS.Warning){const F=prompt(O.Messages[0].Text+" Would you like to install it using another folder name?");if(F)return this.importApp(C,F,!0)}return(0,d.of)(O)}))}}return(u=T).\u0275fac=function(C){return new(C||u)(y.LFG(f.eN),y.LFG(x._),y.LFG(m._y))},u.\u0275prov=y.Yz7({token:u,factory:u.\u0275fac}),T})()},6041:(P,I,a)=>{a.d(I,{H:()=>h});var s=a(91),d=a(4520),_=a(5043),x=a(9736),y=a(9422),f=a(9097),m=a(1699);let h=(()=>{var M;class u extends f.f{constructor(p,C){super(),this.router=p,this.route=C}ngOnDestroy(){super.ngOnDestroy()}refreshOnChildClosedDeep(){return this.router.events.pipe((0,d.h)(p=>p instanceof s.m2),(0,_.O)(!!this.route.snapshot.firstChild.firstChild),(0,x.U)(()=>!!this.route.snapshot.firstChild.firstChild),(0,y.G)(),(0,d.h)(([p,C])=>p&&!C))}refreshOnChildClosedShallow(){return this.router.events.pipe((0,d.h)(p=>p instanceof s.m2),(0,_.O)(!!this.route.snapshot.firstChild),(0,x.U)(()=>!!this.route.snapshot.firstChild),(0,y.G)(),(0,d.h)(([p,C])=>p&&!C))}}return(M=u).\u0275fac=function(p){return new(p||M)(m.Y36(s.F0),m.Y36(s.gz))},M.\u0275dir=m.lG2({type:M,features:[m.qOj]}),u})()},8730:(P,I,a)=>{a.d(I,{U:()=>x});var s=a(1699),d=a(8849),_=a(2106);let x=(()=>{var y;class f{constructor(){this.filter=""}agInit(h){this.filterParams=h}isFilterActive(){return""!==this.filter}doesFilterPass(h){const u=this.filterParams.valueGetter({api:this.filterParams.api,colDef:this.filterParams.colDef,column:this.filterParams.column,columnApi:this.filterParams.columnApi,context:this.filterParams.context,data:h.node.data,getValue:T=>h.node.data[T],node:h.node});return null!=u&&u.toString()===this.filter}getModel(){if(this.isFilterActive())return{filterType:"boolean",filter:this.filter}}setModel(h){this.filter=h?h.filter:""}afterGuiAttached(h){}filterChanged(){this.filterParams.filterChangedCallback()}}return(y=f).\u0275fac=function(h){return new(h||y)},y.\u0275cmp=s.Xpm({type:y,selectors:[["app-boolean-filter"]],decls:7,vars:1,consts:[[3,"ngModel","ngModelChange"],["value",""],["value","true"],["value","false"]],template:function(h,M){1&h&&(s.TgZ(0,"mat-radio-group",0),s.NdJ("ngModelChange",function(T){return M.filter=T})("ngModelChange",function(){return M.filterChanged()}),s.TgZ(1,"mat-radio-button",1),s._uU(2,"All"),s.qZA(),s.TgZ(3,"mat-radio-button",2),s._uU(4,"True"),s.qZA(),s.TgZ(5,"mat-radio-button",3),s._uU(6,"False"),s.qZA()()),2&h&&s.Q6J("ngModel",M.filter)},dependencies:[d.JJ,d.On,_.VQ,_.U0],styles:[".mat-mdc-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;overflow:hidden;padding:12px;width:160px;height:104px}"]}),f})()},9851:(P,I,a)=>{a.d(I,{Y:()=>T});var s=a(1699),d=a(6575),_=a(1268);function x(p,C){1&p&&s.GkF(0)}function y(p,C){if(1&p&&(s.TgZ(0,"mat-hint"),s.YNc(1,x,1,0,"ng-container",3),s.qZA()),2&p){s.oxw();const t=s.MAs(4);s.xp6(1),s.Q6J("ngTemplateOutlet",t)}}function f(p,C){1&p&&s.GkF(0)}function m(p,C){if(1&p&&(s.TgZ(0,"mat-error"),s.YNc(1,f,1,0,"ng-container",3),s.qZA()),2&p){s.oxw();const t=s.MAs(4);s.xp6(1),s.Q6J("ngTemplateOutlet",t)}}function h(p,C){1&p&&s.Hsn(0)}const M=function(p){return{"hint-box__short":p}},u=["*"];let T=(()=>{var p;class C{constructor(){this.isError=!1,this.isShort=!0}toggleIsShort(){this.isShort=!this.isShort}}return(p=C).\u0275fac=function(v){return new(v||p)},p.\u0275cmp=s.Xpm({type:p,selectors:[["app-field-hint"]],inputs:{isError:"isError"},ngContentSelectors:u,decls:5,vars:6,consts:[[1,"hint-box",3,"ngClass","ngSwitch","click"],[4,"ngSwitchCase"],["content",""],[4,"ngTemplateOutlet"]],template:function(v,g){1&v&&(s.F$t(),s.TgZ(0,"div",0),s.NdJ("click",function(){return g.toggleIsShort()}),s.YNc(1,y,2,1,"mat-hint",1),s.YNc(2,m,2,1,"mat-error",1),s.qZA(),s.YNc(3,h,1,0,"ng-template",null,2,s.W1O)),2&v&&(s.Q6J("ngClass",s.VKq(4,M,g.isShort))("ngSwitch",g.isError),s.xp6(1),s.Q6J("ngSwitchCase",!1),s.xp6(1),s.Q6J("ngSwitchCase",!0))},dependencies:[d.mk,d.tP,d.RF,d.n9,_.bx,_.TO],styles:[".hint-box[_ngcontent-%COMP%]{margin-top:4px}.hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{font-size:12px;display:block}.hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]}),C})()},5253:(P,I,a)=>{a.d(I,{m:()=>M});var s=a(4472),d=a(1699),_=a(9409),x=a(6575),y=a(257),f=a(6515),m=a(9498);const h=function(u,T){return{"align-start":u,"align-end":T}};let M=(()=>{var u;class T{constructor(C){this.snackBar=C}agInit(C){this.id=C.value,this.align="number"==typeof this.id?"end":"start",this.tooltip=C.tooltipGetter(C.data)}refresh(C){return!0}copy(){(0,s.v)(this.tooltip),this.snackBar.open("Copied to clipboard",null,{duration:2e3})}}return(u=T).\u0275fac=function(C){return new(C||u)(d.Y36(_.ux))},u.\u0275cmp=d.Xpm({type:u,selectors:[["app-id-field"]],decls:5,vars:6,consts:[["matRipple","",1,"id-box","highlight",3,"tippy","ngClass","click"],[1,"id"],[1,"icon"]],template:function(C,t){1&C&&(d.TgZ(0,"div",0),d.NdJ("click",function(){return t.copy()}),d.TgZ(1,"span",1),d._uU(2),d.qZA(),d.TgZ(3,"mat-icon",2),d._uU(4,"file_copy"),d.qZA()()),2&C&&(d.Q6J("tippy",t.tooltip)("ngClass",d.WLB(3,h,"start"===t.align,"end"===t.align)),d.xp6(2),d.Oqu(t.id))},dependencies:[x.mk,y.wG,f.Hw,m.$],styles:[".id-box[_ngcontent-%COMP%]{padding:0 8px;height:100%;display:flex;align-items:center}.id-box.align-start[_ngcontent-%COMP%]{justify-content:flex-start}.id-box.align-end[_ngcontent-%COMP%]{justify-content:flex-end}.id-box[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{max-width:100%;text-overflow:ellipsis;overflow:hidden}.id-box[_ngcontent-%COMP%]:hover{text-decoration:none}.id-box[_ngcontent-%COMP%]:hover   .id[_ngcontent-%COMP%]{display:none}.id-box[_ngcontent-%COMP%]:not(:hover)   .icon[_ngcontent-%COMP%]{display:none}"]}),T})()},6433:(P,I,a)=>{a.d(I,{f:()=>s});const s={accentedSort:!0,animateRows:!0,enableCellTextSelection:!0,headerHeight:32,suppressScrollOnNewData:!0,valueCache:!0,defaultColDef:{filterParams:{newRowsAction:"keep"}},tooltipShowDelay:0,tooltipHideDelay:1e5,suppressMovableColumns:!0}},3188:(P,I,a)=>{function s(){return/^[a-f0-9]{8}(?:-[a-f0-9]{4}){3}-[a-f0-9]{12}$/i}a.d(I,{M:()=>s})},131:(P,I,a)=>{a.d(I,{E:()=>d});var s=a(1699);let d=(()=>{var _;class x{onClick(f){f.stopPropagation()}}return(_=x).\u0275fac=function(f){return new(f||_)},_.\u0275dir=s.lG2({type:_,selectors:[["","appClickStopPropagation",""]],hostBindings:function(f,m){1&f&&s.NdJ("click",function(M){return m.onClick(M)})}}),x})()},40:(P,I,a)=>{a.d(I,{D:()=>_});var s=a(3488),d=a(1699);let _=(()=>{var x;class y{constructor(m){this.globalConfigService=m}onClick(m){(navigator.platform.match("Mac")?m.metaKey:m.ctrlKey)&&m.shiftKey&&m.altKey&&(this.globalConfigService.toggleDebugEnabled(),window.getSelection().removeAllRanges())}}return(x=y).\u0275fac=function(m){return new(m||x)(d.Y36(s.bE))},x.\u0275dir=d.lG2({type:x,selectors:[["","appToggleDebug",""]],hostBindings:function(m,h){1&m&&d.NdJ("click",function(u){return h.onClick(u)})}}),y})()},4472:(P,I,a)=>{function s(d){const _=document.createElement("textarea");_.value=d,_.setAttribute("readonly",""),_.style.position="absolute",_.style.left="-9999px",document.body.appendChild(_);const x=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);_.select(),document.execCommand("copy"),document.body.removeChild(_),x&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(x))}a.d(I,{v:()=>s})}}]);
//# sourceMappingURL=https://sources.2sxc.org/16.17.00/dist/ng-edit/projects_eav-ui_src_app_content-items_content-items_component_ts.f9c0fcbeae695a23.js.map