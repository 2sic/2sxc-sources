{"version":3,"mappings":"mZAWO,IAAMA,EAAb,MAAM,QAKJC,OAAOC,GACLC,KAAKD,OAASA,EACdC,KAAKC,SAAWD,KAAKD,OAAOG,KAG9BC,QAAQJ,GACN,OAAO,EAGTK,kBACEJ,KAAKD,OAAOM,kBAAkBL,KAAKC,wDAf1BJ,8BAAoCS,6TCXjDC,iBAA+B,WACoCA,gCAASC,sBACxED,sBACgFA,kBAAMA,mBAD5EA,wDAAuC,+FDSxCV,GAAb,+CEQO,IAAMY,EAAb,MAAM,QAMJC,YACUC,EACAC,EACAC,EACAC,GAHAd,iBACAA,mBACAA,cACAA,aAERA,KAAKe,aAAe,IAAIC,KACxBhB,KAAKiB,WAAa,IAAIC,SAAuDC,GAC7EnB,KAAKoB,YAAcpB,KAAKqB,mBAG1BC,WACEtB,KAAKuB,eACLvB,KAAKwB,uBAGPC,cACEzB,KAAKiB,WAAWS,WAChB1B,KAAKe,aAAaY,cAGpBC,cACE5B,KAAKW,UAAUkB,QAGjBzB,gBAAgBH,GACdD,KAAKa,OAAOiB,SAAS,CAACC,oBAA+B9B,EAAS+B,SAAU,CAAEC,WAAYjC,KAAKc,QAGrFS,eACNvB,KAAKY,YAAYsB,0BAA0BC,UAAU,CACnDC,MAAO,KACLpC,KAAKiB,WAAWoB,UAAKlB,IAEvBkB,KAAOC,IACLtC,KAAKiB,WAAWoB,KAAKC,MAKnBd,uBACNxB,KAAKe,aAAawB,IAChBvC,KAAKa,OAAO2B,OAAOC,QACjBC,KAAOC,GAASA,aAAiBC,OACjCC,SAAY7C,KAAKc,MAAMgC,SAASC,eAChCC,KAAI,MAAQhD,KAAKc,MAAMgC,SAASC,aAChCE,UACAP,OAAO,EAAEQ,EAAUC,KAAcD,IAAaC,IAC9ChB,UAAU,KACVnC,KAAKuB,kBAKHF,mBAmDN,OAlDiB+B,+BACZC,KAAkB,CACrBC,WAAY,CACV,CACEC,WAAY,KACZC,MAAO,KACPC,MAAO,GACPC,YAAa,QACbC,UAAW,kCAAkCC,MAAM,KACnDC,UAAU,EACVnB,OAAQ,qBACRoB,YAAc/D,GAC8BA,EAAOG,KACjC6D,KAElBC,aAAcC,IACdC,mBACyD,CACrDC,cAAgBlE,GAAa,OAAOA,EAAS8D,SAKnD,CACEP,MAAO,OACPY,KAAM,EACNC,SAAU,IACVV,UAAW,aACXE,UAAU,EACVS,KAAM,MACN5B,OAAQ,qBACRoB,YAAc/D,GAC8BA,EAAOG,KACjCqE,SAGpB,CACEd,MAAO,GACPE,UAAW,8BAA8BC,MAAM,KAC/CY,OAAQ,QACRR,aAAcnE,EACdqE,mBAAqB,MAC+B,CAChD7D,kBAAoBJ,GAAaD,KAAKI,gBAAgBH,KAFrC,qDAtGlBQ,GAA4BF,yEAA5BE,EAA4BH,4VCnBzCC,iBAAmC,UAAnCA,CAAmC,UAAnCA,CAAmC,SAGxBA,gCAAoBA,QACzBA,oBAA6CA,gCAASC,kBACpDD,oBAAUA,iBAAKA,cAKrBA,eACEA,6NAGFA,QAEAA,0BAEAA,kBACEA,gDAGAA,kBACFA,iBAJ6CA,oDAA8B,oGDAhEE,GAAb","names":["LanguagesPermissionsActionsComponent","agInit","params","this","language","data","refresh","openPermissions","onOpenPermissions","selectors","i0","ctx","LanguagePermissionsComponent","constructor","dialogRef","zoneService","router","route","subscription","Subscription","languages$","BehaviorSubject","undefined","gridOptions","buildGridOptions","ngOnInit","getLanguages","refreshOnChildClosed","ngOnDestroy","complete","unsubscribe","closeDialog","close","navigate","GoToPermissions","NameId","relativeTo","getLanguagesPermissions","subscribe","error","next","languages","add","events","pipe","filter","event","NavigationEnd","startWith","snapshot","firstChild","map","pairwise","hadChild","hasChild","Object","defaultGridOptions","columnDefs","headerName","field","width","headerClass","cellClass","split","sortable","valueGetter","Code","cellRenderer","IdFieldComponent","cellRendererParams","tooltipGetter","flex","minWidth","sort","Culture","pinned"],"sources":["./projects/eav-ui/src/app/app-administration/sub-dialogs/language-permissions/languages-permissions-actions/languages-permissions-actions.component.ts","./projects/eav-ui/src/app/app-administration/sub-dialogs/language-permissions/languages-permissions-actions/languages-permissions-actions.component.html","./projects/eav-ui/src/app/app-administration/sub-dialogs/language-permissions/language-permissions.component.ts","./projects/eav-ui/src/app/app-administration/sub-dialogs/language-permissions/language-permissions.component.html"],"sourcesContent":["import { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { ICellRendererParams } from '@ag-grid-community/core';\r\nimport { Component } from '@angular/core';\r\nimport { SiteLanguagePermissions } from '../../../../apps-management/models/site-language.model';\r\nimport { LanguagesPermissionsActionsParams } from './languages-permissions-actions.models';\r\n\r\n@Component({\r\n  selector: 'app-languages-permissions-actions',\r\n  templateUrl: './languages-permissions-actions.component.html',\r\n  styleUrls: ['./languages-permissions-actions.component.scss'],\r\n})\r\nexport class LanguagesPermissionsActionsComponent implements ICellRendererAngularComp {\r\n  language: SiteLanguagePermissions;\r\n\r\n  private params: ICellRendererParams & LanguagesPermissionsActionsParams;\r\n\r\n  agInit(params: ICellRendererParams & LanguagesPermissionsActionsParams): void {\r\n    this.params = params;\r\n    this.language = this.params.data;\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n\r\n  openPermissions(): void {\r\n    this.params.onOpenPermissions(this.language);\r\n  }\r\n}\r\n","<div class=\"actions-component\">\r\n  <div class=\"like-button highlight\" matRipple tippy=\"Permissions\" (click)=\"openPermissions()\">\r\n    <mat-icon [matBadge]=\"language.Permissions.Count\" matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n      [matBadgeHidden]=\"!language.Permissions.Count\" matBadgePosition=\"below after\">person</mat-icon>\r\n  </div>\r\n</div>","import { GridOptions } from '@ag-grid-community/core';\r\nimport { Component, OnDestroy, OnInit } from '@angular/core';\r\nimport { MatDialogRef } from '@angular/material/dialog';\r\nimport { ActivatedRoute, NavigationEnd, Router } from '@angular/router';\r\nimport { BehaviorSubject, filter, map, pairwise, startWith, Subscription } from 'rxjs';\r\nimport { SiteLanguagePermissions } from '../../../apps-management/models/site-language.model';\r\nimport { ZoneService } from '../../../apps-management/services/zone.service';\r\nimport { GoToPermissions } from '../../../permissions';\r\nimport { IdFieldComponent } from '../../../shared/components/id-field/id-field.component';\r\nimport { IdFieldParams } from '../../../shared/components/id-field/id-field.models';\r\nimport { defaultGridOptions } from '../../../shared/constants/default-grid-options.constants';\r\nimport { LanguagesPermissionsActionsComponent } from './languages-permissions-actions/languages-permissions-actions.component';\r\nimport { LanguagesPermissionsActionsParams } from './languages-permissions-actions/languages-permissions-actions.models';\r\n\r\n@Component({\r\n  selector: 'app-language-permissions',\r\n  templateUrl: './language-permissions.component.html',\r\n  styleUrls: ['./language-permissions.component.scss'],\r\n})\r\nexport class LanguagePermissionsComponent implements OnInit, OnDestroy {\r\n  languages$: BehaviorSubject<SiteLanguagePermissions[] | undefined>;\r\n  gridOptions: GridOptions;\r\n\r\n  private subscription: Subscription;\r\n\r\n  constructor(\r\n    private dialogRef: MatDialogRef<LanguagePermissionsComponent>,\r\n    private zoneService: ZoneService,\r\n    private router: Router,\r\n    private route: ActivatedRoute,\r\n  ) {\r\n    this.subscription = new Subscription();\r\n    this.languages$ = new BehaviorSubject<SiteLanguagePermissions[] | undefined>(undefined);\r\n    this.gridOptions = this.buildGridOptions();\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.getLanguages();\r\n    this.refreshOnChildClosed();\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.languages$.complete();\r\n    this.subscription.unsubscribe();\r\n  }\r\n\r\n  closeDialog(): void {\r\n    this.dialogRef.close();\r\n  }\r\n\r\n  openPermissions(language: SiteLanguagePermissions): void {\r\n    this.router.navigate([GoToPermissions.getUrlLanguage(language.NameId)], { relativeTo: this.route });\r\n  }\r\n\r\n  private getLanguages(): void {\r\n    this.zoneService.getLanguagesPermissions().subscribe({\r\n      error: () => {\r\n        this.languages$.next(undefined);\r\n      },\r\n      next: (languages) => {\r\n        this.languages$.next(languages);\r\n      },\r\n    });\r\n  }\r\n\r\n  private refreshOnChildClosed() {\r\n    this.subscription.add(\r\n      this.router.events.pipe(\r\n        filter(event => event instanceof NavigationEnd),\r\n        startWith(!!this.route.snapshot.firstChild),\r\n        map(() => !!this.route.snapshot.firstChild),\r\n        pairwise(),\r\n        filter(([hadChild, hasChild]) => hadChild && !hasChild),\r\n      ).subscribe(() => {\r\n        this.getLanguages();\r\n      })\r\n    );\r\n  }\r\n\r\n  private buildGridOptions(): GridOptions {\r\n    const gridOptions: GridOptions = {\r\n      ...defaultGridOptions,\r\n      columnDefs: [\r\n        {\r\n          headerName: 'ID',\r\n          field: 'Id',\r\n          width: 70,\r\n          headerClass: 'dense',\r\n          cellClass: 'id-action no-padding no-outline'.split(' '),\r\n          sortable: true,\r\n          filter: 'agTextColumnFilter',\r\n          valueGetter: (params) => {\r\n            const language: SiteLanguagePermissions = params.data;\r\n            return language.Code;\r\n          },\r\n          cellRenderer: IdFieldComponent,\r\n          cellRendererParams: (() => {\r\n            const params: IdFieldParams<SiteLanguagePermissions> = {\r\n              tooltipGetter: (language) => `ID: ${language.Code}`,\r\n            };\r\n            return params;\r\n          })(),\r\n        },\r\n        {\r\n          field: 'Name',\r\n          flex: 2,\r\n          minWidth: 250,\r\n          cellClass: 'no-outline',\r\n          sortable: true,\r\n          sort: 'asc',\r\n          filter: 'agTextColumnFilter',\r\n          valueGetter: (params) => {\r\n            const language: SiteLanguagePermissions = params.data;\r\n            return language.Culture;\r\n          },\r\n        },\r\n        {\r\n          width: 42,\r\n          cellClass: 'secondary-action no-padding'.split(' '),\r\n          pinned: 'right',\r\n          cellRenderer: LanguagesPermissionsActionsComponent,\r\n          cellRendererParams: (() => {\r\n            const params: LanguagesPermissionsActionsParams = {\r\n              onOpenPermissions: (language) => this.openPermissions(language),\r\n            };\r\n            return params;\r\n          })(),\r\n        },\r\n      ],\r\n    };\r\n    return gridOptions;\r\n  }\r\n}\r\n","<div class=\"nav-component-wrapper\">\r\n  <div mat-dialog-title>\r\n    <div class=\"dialog-title-box\">\r\n      <div>Language permissions</div>\r\n      <button mat-icon-button tippy=\"Close dialog\" (click)=\"closeDialog()\">\r\n        <mat-icon>close</mat-icon>\r\n      </button>\r\n    </div>\r\n  </div>\r\n\r\n  <p class=\"dialog-description\">\r\n    If no language permissions are defined, all editors can edit all languages.\r\n    As soon as you set any language permission, only the specified users\r\n    (or users in the specified groups) can edit these permissions.\r\n  </p>\r\n\r\n  <router-outlet></router-outlet>\r\n\r\n  <div class=\"grid-wrapper\">\r\n    <ag-grid-angular class=\"ag-theme-material\" [rowData]=\"languages$ | async\" [gridOptions]=\"gridOptions\">\r\n    </ag-grid-angular>\r\n\r\n    <div class=\"grid-more-actions-box\"></div>\r\n  </div>\r\n</div>"],"sourceRoot":"webpack:///","file":"projects_eav-ui_src_app_app-administration_sub-dialogs_language-permissions_language-permissi-a91b40.1c780fd06632c2a3.js"}