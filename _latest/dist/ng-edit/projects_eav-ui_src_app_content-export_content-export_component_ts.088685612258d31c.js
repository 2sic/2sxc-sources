"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_content-export_content-export_component_ts"],{533:(P,C,e)=>{e.d(C,{m:()=>c});var d=e(604),m=e(7488),M=e(8600),E=e(6698),h=e(6028),f=e(9244),I=e(316),v=e(2376),l=e(4896),O=e(1332);let c=(()=>{class t extends I.o{constructor(s,g,_,u){super(new v.W("AppDialogConfigService",!1)),this.http=s,this.context=g,this.globalConfigService=_,this.dialogSettings$={},this.log.add("using context #",this.context.log.svcId),u.loadFromService(this)}ngOnDestroy(){super.destroy()}getCurrent$(){const s=this.context.appId;return this.log.add("getCurrent$","appId",s),this.getShared$(s)}getSitePrimaryApp$(){return this.getCurrent$().pipe((0,d.k)(s=>s?.Context.Site.PrimaryApp))}getGlobalPrimaryApp$(){return this.getCurrent$().pipe((0,d.k)(s=>s?.Context.System.PrimaryApp))}getShared$(s){return this.log.add("getShared$","appId",s),this.dialogSettings$[s]??=this.getDialogSettings(s,"getShared$").pipe((0,m.C)({refCount:!1})),this.dialogSettings$[s]}getDialogSettings(s,g){return this.log.add("getDialogSettings","appId",s,"reqBy",g),this.http.get("admin/dialog/settings",{params:{appId:s??this.context.appId.toString()}}).pipe((0,d.k)(_=>(_.Context.Language.List=_.Context.Language.List.filter(u=>u.IsEnabled),_)),(0,M.y)(_=>{this.globalConfigService.allowDebug(_.Context.Enable.DebugMode)}))}static#t=this.\u0275fac=function(g){return new(g||t)(l.CoB(O.KK),l.CoB(h.e),l.CoB(E.Sq),l.CoB(f.E))};static#e=this.\u0275prov=l.wxM({token:t,factory:t.\u0275fac})}return t})()},5644:(P,C,e)=>{e.r(C),e.d(C,{ContentExportComponent:()=>u});var d=e(600),m=e(4844),M=e(4816),E=e(533),h=e(692),f=e(1292),I=e(5056),v=e(4672),l=e(1232),O=e(6176),x=e(7872),p=e(244),c=e(1904),t=e(4896),T=e(5204);function s(i,D){if(1&i&&(t.I0R(0,"mat-option",22),t.OEk(1),t.C$Y()),2&i){const o=D.$implicit;t.E7m("value",o.NameId),t.yG2(1),t.cNF(o.NameId)}}function g(i,D){if(1&i&&(t.I0R(0,"mat-radio-button",14),t.OEk(1),t.C$Y()),2&i){const o=t.GaO(2);t.yG2(1),t.oRS(" Export selected ",o.itemIds.length," items ")}}function _(i,D){if(1&i){const o=t.KQA();t.I0R(0,"form",null,3)(2,"div",4)(3,"p"),t.OEk(4," This will generate an XML file which you can edit in Excel. If you just want to import new data, use this to export the schema that you can then fill in using Excel. Please visit "),t.I0R(5,"a",5),t.OEk(6,"https://2sxc.org/help"),t.C$Y(),t.OEk(7," for more instructions. "),t.C$Y(),t.I0R(8,"div",6)(9,"div")(10,"mat-form-field",7)(11,"mat-label"),t.OEk(12,"Languages"),t.C$Y(),t.I0R(13,"mat-select",8),t.qCj("ngModelChange",function(a){t.usT(o);const r=t.GaO();return t.CGJ(r.formValues.language=a)}),t.I0R(14,"mat-option",9),t.OEk(15,"All"),t.C$Y(),t.c53(16,s,2,2,"mat-option",22,t.oxv),t.C$Y()()(),t.I0R(18,"div")(19,"p",10),t.OEk(20,"Export data"),t.C$Y(),t.I0R(21,"mat-radio-group",11),t.qCj("ngModelChange",function(a){t.usT(o);const r=t.GaO();return t.CGJ(r.formValues.recordExport=a)}),t.I0R(22,"mat-radio-button",12),t.OEk(23,"No, just export blank data schema (for new data import) "),t.C$Y(),t.I0R(24,"mat-radio-button",13),t.OEk(25,"Yes, export all content-items"),t.C$Y(),t.yuY(26,g,2,1,"mat-radio-button",14),t.C$Y()(),t.I0R(27,"div")(28,"p",10),t.OEk(29,"Value references to other languages"),t.C$Y(),t.I0R(30,"mat-radio-group",15),t.qCj("ngModelChange",function(a){t.usT(o);const r=t.GaO();return t.CGJ(r.formValues.languageReferences=a)}),t.I0R(31,"mat-radio-button",16),t.OEk(32,"Keep references to other languages (for re-import) "),t.C$Y(),t.I0R(33,"mat-radio-button",17),t.OEk(34,"Replace references with values"),t.C$Y()()(),t.I0R(35,"div")(36,"p",10),t.OEk(37,"File / page references"),t.C$Y(),t.I0R(38,"mat-radio-group",18),t.qCj("ngModelChange",function(a){t.usT(o);const r=t.GaO();return t.CGJ(r.formValues.resourcesReferences=a)}),t.I0R(39,"mat-radio-button",16),t.OEk(40,"Keep references (for re-import, for example Page:4711) "),t.C$Y(),t.I0R(41,"mat-radio-button",17),t.OEk(42,"Replace references with real URLs (for example /Portals/0...) "),t.C$Y()()()()(),t.I0R(43,"mat-dialog-actions",19)(44,"button",20),t.qCj("click",function(){t.usT(o);const a=t.GaO();return t.CGJ(a.closeDialog())}),t.OEk(45,"Cancel"),t.C$Y(),t.I0R(46,"button",21),t.qCj("click",function(){t.usT(o);const a=t.GaO();return t.CGJ(a.exportContent())}),t.OEk(47," Export Data "),t.C$Y()()()}if(2&i){const o=t.Gew(1),n=t.GaO();t.yG2(13),t.E7m("ngModel",n.formValues.language),t.yG2(3),t.oho(n.languages),t.yG2(5),t.E7m("ngModel",n.formValues.recordExport),t.yG2(5),t.C0Y(26,n.hasIdList?26:-1),t.yG2(4),t.E7m("ngModel",n.formValues.languageReferences)("disabled","Blank"===n.formValues.recordExport),t.yG2(8),t.E7m("ngModel",n.formValues.resourcesReferences)("disabled","Blank"===n.formValues.recordExport),t.yG2(8),t.E7m("disabled",!o.form.valid)}}let u=(()=>{class i{constructor(o,n,a,r,y){this.dialogRef=o,this.route=n,this.contentExportService=a,this.appDialogConfigService=r,this.contentTypesService=y,this.hostClass="dialog-component",this.hasIdList=!1,this.loading$=new m.g(!1),this.contentType$=new m.g(null),this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName");const R=this.route.snapshot.paramMap.get("selectedIds");this.hasIdList=!!R,this.hasIdList&&(this.itemIds=R.split(",").map(L=>parseInt(L,10)))}ngOnInit(){this.loading$.next(!0);const o=this.contentTypesService.retrieveContentType(this.contentTypeStaticName),n=this.appDialogConfigService.getCurrent$();(0,M.y)([o,n]).subscribe(([a,r])=>{this.contentType$.next(a),this.languages=r.Context.Language.List,this.formValues={defaultLanguage:r.Context.Language.Primary,contentTypeStaticName:this.contentTypeStaticName,language:"",recordExport:this.hasIdList?"Selection":"All",languageReferences:"Link",resourcesReferences:"Link"},this.loading$.next(!1)})}ngOnDestroy(){this.contentType$.complete(),this.loading$.complete()}closeDialog(){this.dialogRef.close()}exportContent(){this.contentExportService.exportContent(this.formValues,this.hasIdList&&"Selection"===this.formValues.recordExport?this.itemIds:null)}static#t=this.\u0275fac=function(n){return new(n||i)(t.GI1(d.yI),t.GI1(T.gV),t.GI1(f.M),t.GI1(E.m),t.GI1(h.X))};static#e=this.\u0275cmp=t.In1({type:i,selectors:[["app-content-export"]],hostVars:1,hostBindings:function(n,a){2&n&&t.SoX("className",a.hostClass)},standalone:!0,features:[t.M5G([f.M,h.X,E.m]),t.UHJ],decls:7,vars:6,consts:[[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["ngForm","ngForm"],[1,"eav-dialog-content"],["href","https://2sxc.org/help","target","_blank"],[1,"dialog-form-content","fancy-scrollbar-light"],["color","accent",2,"width","100%"],["name","Language",3,"ngModel","ngModelChange"],["value",""],[1,"eav-radio-group-label"],["name","RecordExport",1,"eav-radio-group",3,"ngModel","ngModelChange"],["value","Blank"],["value","All"],["value","Selection"],["name","LanguageReferences",1,"eav-radio-group",3,"ngModel","disabled","ngModelChange"],["value","Link"],["value","Resolve"],["name","ResourcesReferences",1,"eav-radio-group",3,"ngModel","disabled","ngModelChange"],["align","end"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click"],[3,"value"]],template:function(n,a){if(1&n&&(t.I0R(0,"div",0)(1,"div",1)(2,"div",2),t.OEk(3),t.wVc(4,"async"),t.C$Y()(),t.yuY(5,_,48,8,"form"),t.wVc(6,"async"),t.C$Y()),2&n){let r;t.yG2(3),t.oRS("Export ",null==(r=t.kDX(4,2,a.contentType$))?null:r.Name,""),t.yG2(2),t.C0Y(5,!1===t.kDX(6,4,a.loading$)?5:-1)}},dependencies:[c.y,c.sz,c.ue,c.u,c._G,c.SC,p.wb,p.Up,p.w5,x.d5,x.kX,O.I5,O.Ax,l.yk,l.cv,l.cT,d.Yp,v.oJ,v.Gw,I.a],styles:[".eav-radio-group-label[_ngcontent-%COMP%]{font-size:18px;margin:24px 0 0}.eav-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:8px 0}"]})}return i})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/17.06.03/dist/ng-edit/projects_eav-ui_src_app_content-export_content-export_component_ts.088685612258d31c.js.map