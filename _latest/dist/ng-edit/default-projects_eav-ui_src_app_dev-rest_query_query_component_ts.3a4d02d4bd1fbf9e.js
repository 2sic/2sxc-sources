"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["default-projects_eav-ui_src_app_dev-rest_query_query_component_ts"],{3791:(ot,C,n)=>{n.r(C),n.d(C,{DevRestQueryComponent:()=>et});var b=n(2159),j=n(5797),v=n(9999),x=n(271),F=n(1870),l=n(1961),D=n(5445),S=n(4096),w=n(52),N=n(8873),M=n(1091);function G(a,r,e,s,i,d,o){const p="/"!==s[0]&&!s.startsWith("http");o&&o.length&&"?"!==o[0]&&(o="?"+o);const m=p?`${o}${o?"&":"?"}PageId=${e.tabId}&ModuleId=${e.moduleId}`:"",h=a.http.apiUrl(s)+m,c=s+o,u=`${s}/${d??"Default"}${o}`;return[new l.b2(p,"GET",c,"read all query streams","Read list of all items",!0,T(r,c,e),h),new l.b2(p,"GET",u,"read only Stream Default","Read list of all items",!0,T(r,u,e),h)]}function T(a,r,e,s){const i=e.moduleId,d="/"!==r[0],o=[],p=`${r}?PageId=${e.tabId}&ModuleId=${i}`;a.inSameContext&&o.push(new l.EI("Example with global $2sxc and event-context","This example finds the context information from the HTML where an action started.",`\n<button onclick="$2sxc(this).webApi.get('${r}').then(data => console.log(data))">\n  get it\n</button>`,!1,[l.Ms])),a.in2sxc&&o.push(new l.EI(`Example with global $2sxc and a Module-Id ${i}`,"This is how you get the context when your code doesn't start with a DOM context, so you need the moduleId.",`\n// get the sxc-controller for this module\nvar sxc = $2sxc(${i});\n// now get the data in the promise\nsxc.webApi.get('${r}')\n  .then(data => {\n    console.log(data)\n  });`,!1,[l.Ms]),new l.EI("Same example as one-liner","This is the same as above, but as a one-liner so you can run it directly in the F12 console right now.",`$2sxc(${i}).webApi.get('${r}').then(data => console.log('just got:', data));`,!0)),a.in2sxc&&a.inSameContext&&o.push(new l.EI("Example where you get the Module-Id from Razor","This example doesn't use a fixed moduleId but let's the Razor add the current moduleId when the page is rendered.",`\n// this will be replaced on the server with the ID\nvar moduleId = @Dnn.Module.ModuleID;\nvar sxc = $2sxc(moduleId);\nvar promise = sxc.webApi.get('${r}');`,!1,[l.Ms]));const m=d?`$2sxc.http.apiUrl('${r}')`:`'${r}'`,h=d?`$2sxc.http.apiUrl('${p}')`:`'${p}'`;return a.inSameSite?(o.push(new l.EI("Using jQuery inside DNN","This example uses jQuery instead of the $2sxc to do the AJAX call.\n      It shows you how to resolve the virtual path for use in other ways.",`\nvar endpoint = ${m};\n$.ajax({\n  url:endpoint,\n  beforeSend: $.dnnSF(${i}).setModuleHeaders\n}).then(data => {\n  console.log('Got this data:', data);\n})`,!1,[])),o.push(new l.EI("Using jQuery as single-liner","The same example as above, just as single-liner so you can test it directly in the F12 console.\n      This will only work if you're on a DNN page with this module.",`$.ajax({url: ${m}, beforeSend: $.dnnSF(${i}).setModuleHeaders }).then(data => console.log(data))`,!1,[])),o.push(new l.EI("Using jQuery and add Context in URL","This example uses jQuery instead of the $2sxc to do the AJAX call.\n      But instead of using the DNN Services Framework it adds relevant headers to the url.",`\n$.ajax(${h}).then(data => {\n  console.log('Got this data:', data);\n})`,!1,[])),o.push(new l.EI("Using jQuery with url-context as single-liner","The same example as above, just as single-liner so you can test it directly in the F12 console.\n      This will work on a DNN page which has jQuery activated. ",`$.ajax(${h}).then(data => console.log(data))`,!1,[]))):(o.push(new l.EI("Using jQuery in another Site or External","This example uses jQuery and doesn't use $2sxc or the DNN ServicesFramework,\n      because they would be either missing, or give wrong context-headers.",`\n$.ajax('${r}').then(data => {\n  console.log('Got this data:', data);\n})`,!1,[l.Qd])),o.push(new l.EI("Using jQuery with Context in URL","This example uses jQuery and includes a module-context. This is unusual for external access, but may be needed sometime.",`\n$.ajax('${p}').then(data => {\n  console.log('Got this data:', data);\n})`,!1,[l.Qd]))),o}var P=n(316),U=n(1585),k=n(1426),A=n(5630),R=n(7984),$=n(5944),X=n(2422),O=n(6768),t=n(8559);let V=(()=>{class a{constructor(){this.scenarios=l.vm}ngOnInit(){}static#t=this.\u0275fac=function(s){return new(s||a)};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["app-dev-query-introduction"]],inputs:{data:"data"},standalone:!0,features:[t.aNF],decls:12,vars:0,consts:[["href","https://docs.2sxc.org/index.html","target","_blank"],["href","https://docs.2sxc.org/basics/query/index.html","target","_blank"],["href","https://docs.2sxc.org/web-api/query-rest-web-api.html","target","_blank"]],template:function(s,i){1&s&&(t.j41(0,"p"),t.EFF(1," To learn more about queries you may want to read these "),t.j41(2,"a",0),t.EFF(3,"docs"),t.k0s(),t.EFF(4,":\n"),t.k0s(),t.j41(5,"ul")(6,"li")(7,"a",1),t.EFF(8,"Queries in 2sxc"),t.k0s()(),t.j41(9,"li")(10,"a",2),t.EFF(11,"Query REST API"),t.k0s()()())},encapsulation:2})}return a})();var f=n(8223),Y=n(1708),E=n(3840),I=n(4175),B=n(7896),Q=n(5437),L=n(7941),H=n(4821);function z(a,r){if(1&a){const e=t.RV6();t.j41(0,"button",16),t.bIt("click",function(){t.eBV(e);const i=t.XpG(2);return t.Njj(i.closeDialog())}),t.j41(1,"mat-icon"),t.EFF(2,"close"),t.k0s()()}}function J(a,r){1&a&&(t.j41(0,"div",17)(1,"mat-icon"),t.EFF(2,"emoji_objects"),t.k0s(),t.j41(3,"span"),t.EFF(4,"Introduction"),t.k0s()())}function W(a,r){if(1&a&&(t.j41(0,"div",18)(1,"mat-icon"),t.EFF(2,"code_curly"),t.k0s(),t.j41(3,"span"),t.EFF(4),t.k0s()()),2&a){const e=t.XpG();t.Y8G("tippy",(e.scenario.useVirtual?"Virtual ":"Absolute ")+"REST URLs"),t.R7$(4),t.SpI("Call ",e.scenario.useVirtual?"Virtual":"Absolute"," REST URLs")}}function _(a,r){1&a&&(t.j41(0,"mat-icon"),t.EFF(1,"warning"),t.k0s())}function K(a,r){if(1&a&&(t.j41(0,"div",19)(1,"mat-icon"),t.EFF(2,"person"),t.k0s(),t.j41(3,"span"),t.EFF(4),t.k0s(),t.DNE(5,_,2,0,"mat-icon"),t.k0s()),2&a){const e=t.XpG();t.R7$(4),t.SpI("Permissions (",e.permissions.length,")"),t.R7$(),t.vxM(5,e.permissions.length?-1:5)}}function Z(a,r){1&a&&(t.j41(0,"div",20)(1,"mat-icon"),t.EFF(2,"perm_device_information"),t.k0s(),t.j41(3,"span"),t.EFF(4,"HTTP headers & \xa0"),t.j41(5,"code"),t.EFF(6,"/auto/"),t.k0s()()())}function q(a,r){if(1&a){const e=t.RV6();t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.EFF(3,"Using REST with Query:\xa0 "),t.j41(4,"code"),t.EFF(5),t.k0s()(),t.DNE(6,z,3,0,"button",3),t.k0s(),t.j41(7,"div",4),t.nrm(8,"router-outlet"),t.j41(9,"app-selector-with-help",5),t.bIt("valueChange",function(i){t.eBV(e);const d=t.XpG();return t.Njj(d.changeScenario(i))}),t.k0s(),t.j41(10,"mat-tab-group",6)(11,"mat-tab"),t.DNE(12,J,5,0,"div",7),t.nrm(13,"app-dev-query-introduction",8)(14,"app-dev-rest-tab-introduction",8),t.k0s(),t.j41(15,"mat-tab"),t.DNE(16,W,5,2,"div",9),t.nrm(17,"app-dev-rest-tab-examples-intro",8),t.j41(18,"div",10)(19,"mat-form-field",11)(20,"mat-label"),t.EFF(21,"Stream Name(s) to Limit, comma-separated"),t.k0s(),t.j41(22,"input",12),t.bIt("input",function(i){t.eBV(e);const d=t.XpG();return t.Njj(d.updateStreams(i))}),t.k0s()(),t.j41(23,"mat-form-field",11)(24,"mat-label"),t.EFF(25,"Additional Url Parameters"),t.k0s(),t.j41(26,"input",13),t.bIt("input",function(i){t.eBV(e);const d=t.XpG();return t.Njj(d.updateParams(i))}),t.k0s()()(),t.nrm(27,"app-dev-rest-urls-and-code",8),t.k0s(),t.j41(28,"mat-tab"),t.DNE(29,K,6,2,"div",14),t.nrm(30,"app-dev-rest-tab-permissions",8),t.k0s(),t.j41(31,"mat-tab"),t.DNE(32,Z,7,0,"div",15),t.nrm(33,"app-dev-rest-tab-headers",8),t.k0s()()()()}if(2&a){const e=r,s=t.XpG();t.R7$(5),t.JRh(e.name),t.R7$(),t.vxM(6,s.isSideNavContent?-1:6),t.R7$(3),t.Y8G("items",s.scenarios)("value",e.scenario.key),t.R7$(4),t.Y8G("data",e),t.R7$(),t.Y8G("data",e),t.R7$(3),t.Y8G("data",e),t.R7$(5),t.Y8G("value",s.streamNames$.value),t.R7$(4),t.Y8G("value",s.urlParams$.value),t.R7$(),t.Y8G("data",e),t.R7$(3),t.Y8G("data",e),t.R7$(3),t.Y8G("data",e)}}let et=(()=>{class a extends M.n{constructor(e,s,i,d,o){const p=(0,Q.d)(S.Kn);super(e,s,o,i,d,p),this.hostClass="dialog-component",this.urlParams$=new j.t(""),this.streamNames$=new j.t("Default"),this.pipelinesService=(0,Q.d)(D.xR),this.isSideNavContent=this.router.url.includes(l.N5.routeQuery);const m=(0,v.z)([d.paramMap.pipe((0,x.T)(c=>c.get(l.N5.paramQuery))),this.pipelinesService.getAll(w.YX.contentTypes.query).pipe((0,F.u)())]).pipe((0,x.T)(([c,u])=>u.find(g=>g.Guid===c)),(0,F.u)());this.permissions$=this.buildPermissionStream(l.N5.paramQuery);const h=(0,v.z)([m,this.scenario$,this.dialogSettings$]).pipe((0,x.T)(([c,u,g])=>{const y="app/{appname}/query/{queryname}".replace("{queryname}",c.Name).replace("{appname}",u.inSameContext?"auto":encodeURI(g.Context.App.Folder));return this.rootBasedOnScenario(y,u)}));this.viewModel$=(0,v.z)([(0,v.z)([m,this.scenario$,this.permissions$]),(0,v.z)([h,this.dialogSettings$]),(0,v.z)([this.streamNames$,this.urlParams$])]).pipe((0,x.T)(([[c,u,g],[y,at],[nt,st]])=>({...this.buildBaseViewModel(c.Name,c.Guid,at,g,y,u),query:c,apiCalls:G(o.$2sxc,u,e,y,0,nt,st)})))}updateStreams(e){this.streamNames$.next(e.target.value)}updateParams(e){this.urlParams$.next(e.target.value)}static#t=this.\u0275fac=function(s){return new(s||a)(t.rXU(N.o),t.rXU(L.CP),t.rXU(b.Ix),t.rXU(b.nX),t.rXU(H.ob))};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["app-dev-rest-query"]],hostVars:1,hostBindings:function(s,i){2&s&&t.Mr5("className",i.hostClass)},standalone:!0,features:[t.Vt3,t.aNF],decls:2,vars:3,consts:[[1,"eav-dialog","eav-no-scrollbar"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog"],[1,"eav-dialog-content"],["label","Choose Scenario",3,"valueChange","items","value"],["dynamicHeight","","color","accent",1,"mat-tab-group-fit-height","mat-tab-group-fancy-scrollbar","default-fonts"],["class","mat-tab-label-box","tippy","Introduction",4,"matTabLabel"],[3,"data"],["class","mat-tab-label-box",3,"tippy",4,"matTabLabel"],[1,"params-form"],["color","accent",1,"eav-mat-form-field"],["matInput","","placeholder","Default",3,"input","value"],["matInput","","placeholder","?id=27",3,"input","value"],["class","mat-tab-label-box","tippy","Permissions",4,"matTabLabel"],["class","mat-tab-label-box","tippy","HTTP headers and auto",4,"matTabLabel"],["mat-icon-button","","tippy","Close dialog",3,"click"],["tippy","Introduction",1,"mat-tab-label-box"],[1,"mat-tab-label-box",3,"tippy"],["tippy","Permissions",1,"mat-tab-label-box"],["tippy","HTTP headers and auto",1,"mat-tab-label-box"]],template:function(s,i){if(1&s&&(t.DNE(0,q,34,12,"div",0),t.nI1(1,"async")),2&s){let d;t.vxM(0,(d=t.bMT(1,1,i.viewModel$))?0:-1,d)}},dependencies:[I.Hl,I.iY,B.e,E.m_,E.An,b.n3,Y.Y,f.RI,f.ES,f.mq,f.T8,V,O.M,X.R,$.RG,$.rl,$.nJ,R.fS,R.fg,A.X,k.Q,U.J,P.Jj],styles:["[_nghost-%COMP%]     code, code[_ngcontent-%COMP%], pre[_ngcontent-%COMP%]{padding-left:2px;padding-right:2px;background-color:#eee}pre[_ngcontent-%COMP%]{white-space:pre-wrap;word-break:keep-all}.rest-urls-accordion[_ngcontent-%COMP%]{display:block;margin:8px}.rest-urls-title[_ngcontent-%COMP%]{display:flex;align-items:center}.code-example[_ngcontent-%COMP%]{position:relative}.code-example__text[_ngcontent-%COMP%]{min-height:40px}.code-example__copy[_ngcontent-%COMP%]{position:absolute;top:0;right:0}.params-form[_ngcontent-%COMP%]{display:flex;max-width:600px}.params-form[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]:not(:first-of-type){margin-left:8px}.form-with-textarea[_ngcontent-%COMP%]{max-width:600px}"]})}return a})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/18.00.01/dist/ng-edit/default-projects_eav-ui_src_app_dev-rest_query_query_component_ts.3a4d02d4bd1fbf9e.js.map