"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_content-export_content-export_component_ts-projects_eav-ui_src_app_sh-5eade4"],{2743:(T,M,e)=>{e.d(M,{b:()=>v});var s=e(8873),O=e(8147),u=e(6163),h=e(8559);let v=(()=>{class r{constructor(n,o){this.contextSvcShared=n,this.context=o,this.log=new O.B("DialogConfigService",!1)}getCurrent$(){const n=this.context.appId;return this.log.a(`getCurrent$ - appId:${n}`),this.contextSvcShared.getShared$(n)}static#t=this.\u0275fac=function(o){return new(o||r)(h.KVO(u.t),h.KVO(s.o))};static#e=this.\u0275prov=h.jDH({token:r,factory:r.\u0275fac})}return r})()},7693:(T,M,e)=>{e.d(M,{X:()=>m,g:()=>P});var s=e(271),O=e(8873),u=e(8559),h=e(6443),C=e(4821);const m="admin/type/",a="admin/type/scopes";let P=(()=>{class t{constructor(i,g,f){this.http=i,this.context=g,this.dnnContext=f}apiUrl(i){return this.dnnContext.$2sxc.http.apiUrl(i)}retrieveContentType(i){return this.http.get(this.apiUrl("admin/type/get"),{params:{appId:this.context.appId.toString(),contentTypeId:i}})}retrieveContentTypes(i){return this.http.get(this.apiUrl("admin/type/list"),{params:{appId:this.context.appId.toString(),scope:i}})}getScopes(){return this.http.get(this.apiUrl(a),{params:{appId:this.context.appId.toString()}}).pipe((0,s.T)(i=>{const g=i.old;return Object.keys(g).map(I=>({name:g[I],value:I}))}))}getScopesV2(){return this.http.get(this.apiUrl(a),{params:{appId:this.context.appId.toString()}}).pipe((0,s.T)(i=>i.scopes))}save(i){return this.http.post(this.apiUrl("admin/type/save"),i,{params:{appid:this.context.appId.toString()}})}delete(i){return this.http.delete(this.apiUrl("admin/type/delete"),{params:{appid:this.context.appId.toString(),staticName:i.StaticName}})}import(i){const g=new FormData;for(const f of i)g.append("File",f);return this.http.post(this.apiUrl("admin/type/import"),g,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}createGhost(i){return this.http.post(this.apiUrl("admin/type/addghost"),null,{params:{appid:this.context.appId.toString(),sourceStaticName:i}})}static#t=this.\u0275fac=function(g){return new(g||t)(u.KVO(h.Qq),u.KVO(O.o),u.KVO(C.ob))};static#e=this.\u0275prov=u.jDH({token:t,factory:t.\u0275fac})}return t})()},6163:(T,M,e)=>{e.d(M,{t:()=>l});var s=e(6301),O=e(271),u=e(8764),h=e(8873),C=e(8147),m=e(9431),v=e(8559),r=e(6443);let l=(()=>{class c{constructor(t,x,i){this.http=t,this.context=x,this.globalConfigService=i,this.log=new C.B("GlobalDialogConfigService",!1),this.dialogSettings$={},this.log.a(`using context #${this.context.log.svcId}`)}getShared$(t){return this.log.a("getShared$ appId: "+t),this.dialogSettings$[t]??=this.getDialogSettings(t,"getShared$").pipe((0,s.t)({refCount:!1})),this.dialogSettings$[t]}getDialogSettings(t,x){return this.log.a("getDialogSettings",{appId:t,reqBy:x}),this.http.get("admin/dialog/settings",{params:{appId:t??this.context.appId.toString()}}).pipe((0,O.T)(i=>(i.Context.Language.List=i.Context.Language.List.filter(g=>g.IsEnabled),i)),(0,u.M)(i=>{this.globalConfigService.allowDebug(i.Context.Enable.DebugMode)}))}static#t=this.\u0275fac=function(x){return new(x||c)(v.KVO(r.Qq),v.KVO(h.o),v.KVO(m.B))};static#e=this.\u0275prov=v.jDH({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})()},5727:(T,M,e)=>{e.r(M),e.d(M,{ContentExportComponent:()=>I});var s=e(7941),O=e(5797),u=e(1873),h=e(7693),C=e(6360),m=e(316),v=e(4175),r=e(3804),a=e(5060),n=e(5175),o=e(5944),l=e(4456),c=e(5437),P=e(2743),t=e(8559),x=e(2159);function i(D,b){if(1&D&&(t.j41(0,"mat-option",10),t.EFF(1),t.k0s()),2&D){const p=b.$implicit;t.Y8G("value",p.NameId),t.R7$(),t.JRh(p.NameId)}}function g(D,b){if(1&D&&(t.j41(0,"mat-radio-button",15),t.EFF(1),t.k0s()),2&D){const p=t.XpG(2);t.R7$(),t.SpI(" Export selected ",p.itemIds.length," items ")}}function f(D,b){if(1&D){const p=t.RV6();t.j41(0,"form",null,0)(2,"div",4)(3,"p"),t.EFF(4," This will generate an XML file which you can edit in Excel. If you just want to import new data, use this to export the schema that you can then fill in using Excel. Please visit "),t.j41(5,"a",5),t.EFF(6,"https://2sxc.org/help"),t.k0s(),t.EFF(7," for more instructions. "),t.k0s(),t.j41(8,"div",6)(9,"div")(10,"mat-form-field",7)(11,"mat-label"),t.EFF(12,"Languages"),t.k0s(),t.j41(13,"mat-select",8),t.mxI("ngModelChange",function(_){t.eBV(p);const E=t.XpG();return t.DH7(E.formValues.language,_)||(E.formValues.language=_),t.Njj(_)}),t.j41(14,"mat-option",9),t.EFF(15,"All"),t.k0s(),t.Z7z(16,i,2,2,"mat-option",10,t.fX1),t.k0s()()(),t.j41(18,"div")(19,"p",11),t.EFF(20,"Export data"),t.k0s(),t.j41(21,"mat-radio-group",12),t.mxI("ngModelChange",function(_){t.eBV(p);const E=t.XpG();return t.DH7(E.formValues.recordExport,_)||(E.formValues.recordExport=_),t.Njj(_)}),t.j41(22,"mat-radio-button",13),t.EFF(23,"No, just export blank data schema (for new data import) "),t.k0s(),t.j41(24,"mat-radio-button",14),t.EFF(25,"Yes, export all content-items"),t.k0s(),t.DNE(26,g,2,1,"mat-radio-button",15),t.k0s()(),t.j41(27,"div")(28,"p",11),t.EFF(29,"Value references to other languages"),t.k0s(),t.j41(30,"mat-radio-group",16),t.mxI("ngModelChange",function(_){t.eBV(p);const E=t.XpG();return t.DH7(E.formValues.languageReferences,_)||(E.formValues.languageReferences=_),t.Njj(_)}),t.j41(31,"mat-radio-button",17),t.EFF(32,"Keep references to other languages (for re-import) "),t.k0s(),t.j41(33,"mat-radio-button",18),t.EFF(34,"Replace references with values"),t.k0s()()(),t.j41(35,"div")(36,"p",11),t.EFF(37,"File / page references"),t.k0s(),t.j41(38,"mat-radio-group",19),t.mxI("ngModelChange",function(_){t.eBV(p);const E=t.XpG();return t.DH7(E.formValues.resourcesReferences,_)||(E.formValues.resourcesReferences=_),t.Njj(_)}),t.j41(39,"mat-radio-button",17),t.EFF(40,"Keep references (for re-import, for example Page:4711) "),t.k0s(),t.j41(41,"mat-radio-button",18),t.EFF(42,"Replace references with real URLs (for example /Portals/0...) "),t.k0s()()()()(),t.j41(43,"mat-dialog-actions",20)(44,"button",21),t.bIt("click",function(){t.eBV(p);const _=t.XpG();return t.Njj(_.closeDialog())}),t.EFF(45,"Cancel"),t.k0s(),t.j41(46,"button",22),t.bIt("click",function(){t.eBV(p);const _=t.XpG();return t.Njj(_.exportContent())}),t.EFF(47," Export Data "),t.k0s()()()}if(2&D){const p=t.sdS(1),d=t.XpG();t.R7$(13),t.R50("ngModel",d.formValues.language),t.R7$(3),t.Dyx(d.languages),t.R7$(5),t.R50("ngModel",d.formValues.recordExport),t.R7$(5),t.vxM(26,d.hasIdList?26:-1),t.R7$(4),t.R50("ngModel",d.formValues.languageReferences),t.Y8G("disabled","Blank"===d.formValues.recordExport),t.R7$(8),t.R50("ngModel",d.formValues.resourcesReferences),t.Y8G("disabled","Blank"===d.formValues.recordExport),t.R7$(8),t.Y8G("disabled",!p.form.valid)}}let I=(()=>{class D{constructor(p,d){this.dialogRef=p,this.route=d,this.hostClass="dialog-component",this.contentExportService=(0,c.d)(C.D),this.contentTypesService=(0,c.d)(h.g),this.dialogConfigSvc=(0,c.d)(P.b),this.hasIdList=!1,this.loading$=new O.t(!1),this.contentType$=new O.t(null),this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName");const _=this.route.snapshot.paramMap.get("selectedIds");this.hasIdList=!!_,this.hasIdList&&(this.itemIds=_.split(",").map(E=>parseInt(E,10)))}ngOnInit(){this.loading$.next(!0);const p=this.contentTypesService.retrieveContentType(this.contentTypeStaticName),d=this.dialogConfigSvc.getCurrent$();(0,u.p)([p,d]).subscribe(([_,E])=>{this.contentType$.next(_),this.languages=E.Context.Language.List,this.formValues={defaultLanguage:E.Context.Language.Primary,contentTypeStaticName:this.contentTypeStaticName,language:"",recordExport:this.hasIdList?"Selection":"All",languageReferences:"Link",resourcesReferences:"Link"},this.loading$.next(!1)})}ngOnDestroy(){this.contentType$.complete(),this.loading$.complete()}closeDialog(){this.dialogRef.close()}exportContent(){this.contentExportService.exportContent(this.formValues,this.hasIdList&&"Selection"===this.formValues.recordExport?this.itemIds:null)}static#t=this.\u0275fac=function(d){return new(d||D)(t.rXU(s.CP),t.rXU(x.nX))};static#e=this.\u0275cmp=t.VBU({type:D,selectors:[["app-content-export"]],hostVars:1,hostBindings:function(d,_){2&d&&t.Mr5("className",_.hostClass)},standalone:!0,features:[t.aNF],decls:7,vars:6,consts:[["ngForm","ngForm"],[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],["href","https://2sxc.org/help","target","_blank"],[1,"dialog-form-content","fancy-scrollbar-light"],["color","accent",1,"eav-mat-form-field"],["name","Language",3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"eav-radio-group-label"],["name","RecordExport",1,"eav-radio-group",3,"ngModelChange","ngModel"],["value","Blank"],["value","All"],["value","Selection"],["name","LanguageReferences",1,"eav-radio-group",3,"ngModelChange","ngModel","disabled"],["value","Link"],["value","Resolve"],["name","ResourcesReferences",1,"eav-radio-group",3,"ngModelChange","ngModel","disabled"],["align","end"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"click","disabled"]],template:function(d,_){if(1&d&&(t.j41(0,"div",1)(1,"div",2)(2,"div",3),t.EFF(3),t.nI1(4,"async"),t.k0s()(),t.DNE(5,f,48,8,"form"),t.nI1(6,"async"),t.k0s()),2&d){let E;t.R7$(3),t.SpI("Export ",null==(E=t.bMT(4,2,_.contentType$))?null:E.Name,""),t.R7$(2),t.vxM(5,!1===t.bMT(6,4,_.loading$)?5:-1)}},dependencies:[l.YN,l.qT,l.BC,l.cb,l.vS,l.cV,o.RG,o.rl,o.nJ,n.Ve,n.VO,a.wT,a.Sy,r.Wk,r.VT,r._g,s.E7,v.Hl,v.$z,m.Jj],styles:[".eav-radio-group-label[_ngcontent-%COMP%]{font-size:18px;margin:24px 0 0}.eav-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:8px 0}"]})}return D})()},9234:(T,M,e)=>{e.d(M,{Gg:()=>P,Tr:()=>t,gb:()=>c});var s=e(1567),O=e(6647),u=e(6301),h=e(271),C=e(4979),m=e(8147),v=e(4839),r=e(5437),a=e(8559),n=e(6443),o=e(4821);const c="admin/entity/",P="admin/entity/list";let t=(()=>{class x extends C.V{constructor(g,f){super(new m.B("EntityService",!1)),this.http=g,this.dnnContext=f,this.queryService=(0,r.d)(v.c)}getEntities$(g){return g.pipe((0,s.p)(f=>null!=f),(0,O.n)(f=>this.getAvailableEntities(f.contentTypeName).pipe((0,u.t)(1))))}getAvailableEntities(g,f){var I=this.log.rxTap("getEntities",{enabled:!0});return this.queryService.getEntities({contentTypes:[g],itemIds:f,fields:"Id,Guid,Title",log:"getAvailableEntities"}).pipe(I.pipe(),(0,h.T)(D=>D.Default))}delete(g,f,I,D,b,p){return this.http.delete(this.dnnContext.$2sxc.http.apiUrl(c+"delete"),{params:{contentType:f,id:I.toString(),appId:g,force:D.toString(),...b&&{parentId:b.toString()},...b&&p&&{parentField:p}}})}static#t=this.\u0275fac=function(f){return new(f||x)(a.KVO(n.Qq),a.KVO(o.ob))};static#e=this.\u0275prov=a.jDH({token:x,factory:x.\u0275fac})}return x})()},9431:(T,M,e)=>{e.d(M,{B:()=>C});var s=e(8559),O=e(9074),u=e(8172),h=e(3347);let C=(()=>{class m{constructor(r){this.snackBar=r,this.debugState=(0,s.vPA)(null),this.isDebug=(0,s.EWP)(()=>!!this.debugState()?.allowDebugMode&&!!this.debugState()?.debugEnabled),this.debugEnabled$=(0,O.br)(this.isDebug);const a={id:0,debugEnabled:"true"===sessionStorage.getItem(u.tn),allowDebugMode:!1};this.debugState.set(a)}allowDebug(r){const a=this.debugState();if(a.allowDebugMode===r)return;const n={...a,allowDebugMode:r};this.debugState.set(n)}toggleDebugEnabled(){const r=this.debugState();if(!r.allowDebugMode)return void this.snackBar.open("You do not have permissions to enter developer mode",null,{duration:3e3});const a={...r,debugEnabled:!r.debugEnabled};this.debugState.set(a),this.snackBar.open(a.debugEnabled?"developer mode on":"developer mode off",null,{duration:3e3})}static#t=this.\u0275fac=function(a){return new(a||m)(s.KVO(h.UG))};static#e=this.\u0275prov=s.jDH({token:m,factory:m.\u0275fac,providedIn:"root"})}return m})()},4839:(T,M,e)=>{e.d(M,{c:()=>v});var s=e(8147),O=e(4979),u=e(8873),h=e(8559),C=e(6443);let v=(()=>{class r extends O.V{constructor(n,o){super(new s.B("QueryService",!1)),this.http=n,this.context=o}getAvailableEntities(n,o,l,c){this.log.a("getAvailableEntities",{queryUrl:n,params:o,fields:l,entitiesFilter:c});const P=!!o,g=(((o?.toLocaleLowerCase()??"").includes("appid=")?"":`&appId=${this.context.appId}`)+(P?`&${o}`:"")+"&$select="+(l??"")).substring(1);return this.http.post(`app/auto/query/${n}?${g}`,{Guids:c})}getEntities({contentTypes:n,itemIds:o,fields:l,log:c}){this.log.a(`getEntities(${c})`,{contentTypes:n,itemIds:o,fields:l});const t=("&typeNames="+(n?.join(",")??"")+`&appId=${this.context.appId}&itemIds=`+(o?.join(",")??"")+"&$select="+(l??"")).substring(1);return this.http.post(`app/auto/query/System.EntityPicker/Default?${t}`,{})}static#t=this.\u0275fac=function(o){return new(o||r)(h.KVO(C.Qq),h.KVO(u.o))};static#e=this.\u0275prov=h.jDH({token:r,factory:r.\u0275fac})}return r})()},9074:(T,M,e)=>{e.d(M,{br:()=>v,ot:()=>r});var s=e(8559),O=e(6042);function v(a,n){!n?.injector&&(0,s.Af3)(v);const o=n?.injector??(0,s.WQX)(s.zZn),l=new O.m(1),c=(0,s.QZP)(()=>{let P;try{P=a()}catch(t){return void(0,s.O8t)(()=>l.error(t))}(0,s.O8t)(()=>l.next(P))},{injector:o,manualCleanup:!0});return o.get(s.abz).onDestroy(()=>{c.destroy(),l.complete()}),l.asObservable()}function r(a,n){const o=!n?.manualCleanup;o&&!n?.injector&&(0,s.Af3)(r);const l=o?n?.injector?.get(s.abz)??(0,s.WQX)(s.abz):null;let c;c=(0,s.vPA)(n?.requireSync?{kind:0}:{kind:1,value:n?.initialValue});const P=a.subscribe({next:t=>c.set({kind:1,value:t}),error:t=>{if(n?.rejectErrors)throw t;c.set({kind:2,error:t})}});return l?.onDestroy(P.unsubscribe.bind(P)),(0,s.EWP)(()=>{const t=c();switch(t.kind){case 1:return t.value;case 2:throw t.error;case 0:throw new s.wOt(601,"`toSignal()` called with `requireSync` but `Observable` did not emit synchronously.")}})}}}]);
//# sourceMappingURL=https://sources.2sxc.org/18.00.01/dist/ng-edit/projects_eav-ui_src_app_content-export_content-export_component_ts-projects_eav-ui_src_app_sh-5eade4.61fcac91bbe19f61.js.map