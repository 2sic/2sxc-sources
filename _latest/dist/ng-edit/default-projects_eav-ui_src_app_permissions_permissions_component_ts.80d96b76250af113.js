"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["default-projects_eav-ui_src_app_permissions_permissions_component_ts"],{2871:(T,g,t)=>{t.d(g,{J:()=>a});var h=t(3840),c=t(8559);let a=(()=>{class _{constructor(){this.trueIcon="check_circle",this.falseIcon="circle"}agInit(d){let i=d.value;d.reverse&&(i=!i),d.trueIcon&&(this.trueIcon=d.trueIcon),d.falseIcon&&(this.falseIcon=d.falseIcon),this.icon=i?this.trueIcon:this.falseIcon}refresh(d){return!0}static#t=this.\u0275fac=function(i){return new(i||_)};static#e=this.\u0275cmp=c.VBU({type:_,selectors:[["app-rest-api-true-false"]],standalone:!0,features:[c.aNF],decls:3,vars:1,consts:[[1,"icon-container"]],template:function(i,p){1&i&&(c.j41(0,"div",0)(1,"mat-icon"),c.EFF(2),c.k0s()()),2&i&&(c.R7$(2),c.JRh(p.icon))},dependencies:[h.m_,h.An],encapsulation:2})}return _})()},2458:(T,g,t)=>{t.r(g),t.d(g,{PermissionsComponent:()=>B});var h=t(7941),c=t(2159),a=t(5797),_=t(9999),e=t(271),d=t(1735),i=t(6378),p=t(251),o=t(52),l=t(3216),s=t(3840),r=t(5060),n=t(8559);let m=(()=>{class O{agInit(u){this.params=u}refresh(u){return!0}deletePermission(){this.params.onDelete(this.params.data)}static#t=this.\u0275fac=function(f){return new(f||O)};static#e=this.\u0275cmp=n.VBU({type:O,selectors:[["app-permissions-actions"]],standalone:!0,features:[n.aNF],decls:4,vars:0,consts:[[1,"actions-component"],["matRipple","","tippy","Delete",1,"eav-grid-action-button","highlight",3,"click"]],template:function(f,E){1&f&&(n.j41(0,"div",0)(1,"div",1),n.bIt("click",function(){return E.deletePermission()}),n.j41(2,"mat-icon"),n.EFF(3,"delete"),n.k0s()()())},dependencies:[r.pZ,r.r6,s.m_,s.An]})}return O})();var v=t(4900),C=t(1828),R=t(316),P=t(4175),D=t(7037),y=t(5437),I=t(3347),x=t(9841);function A(O,U){if(1&O){const u=n.RV6();n.j41(0,"div",0)(1,"div",1)(2,"div",2),n.EFF(3,"Permissions"),n.k0s(),n.j41(4,"button",3),n.bIt("click",function(){n.eBV(u);const E=n.XpG();return n.Njj(E.closeDialog())}),n.j41(5,"mat-icon"),n.EFF(6,"close"),n.k0s()()(),n.j41(7,"div",4),n.nrm(8,"router-outlet"),n.j41(9,"div",5),n.nrm(10,"ag-grid-angular",6),n.k0s(),n.j41(11,"mat-dialog-actions",7)(12,"button",8),n.bIt("click",function(){n.eBV(u);const E=n.XpG();return n.Njj(E.editPermission(null))}),n.j41(13,"mat-icon"),n.EFF(14,"add"),n.k0s()()()()()}if(2&O){const u=n.XpG();n.R7$(10),n.Y8G("rowData",U.permissions)("gridOptions",u.gridOptions)}}let B=(()=>{class O extends d.V{constructor(u,f,E,M){super(u,f),this.router=u,this.route=f,this.dialogRef=E,this.snackBar=M,this.permissions$=new a.t(void 0),this.gridOptions=this.buildGridOptions(),this.targetType=parseInt(this.route.snapshot.paramMap.get("targetType"),10),this.keyType=this.route.snapshot.paramMap.get("keyType"),this.key=this.route.snapshot.paramMap.get("key"),this.prefills={[o.YX.metadata.language.targetType]:{PermissionType:"language"}},this.permissionsService=(0,y.d)(v.K)}ngOnInit(){this.fetchPermissions(),this.subscriptions.add(this.childDialogClosed$().subscribe(()=>{this.fetchPermissions()})),this.viewModel$=(0,_.z)([this.permissions$]).pipe((0,e.T)(([u])=>({permissions:u})))}ngOnDestroy(){this.permissions$.complete(),super.ngOnDestroy()}closeDialog(){this.dialogRef.close()}fetchPermissions(){this.permissionsService.getAll(this.targetType,this.keyType,this.key).subscribe(u=>{this.permissions$.next(u)})}editPermission(u){let f;f=null==u?{items:[{ContentTypeName:o.YX.contentTypes.permissions,For:{Target:Object.values(o.YX.metadata).find(M=>M.targetType===this.targetType)?.target??this.targetType.toString(),TargetType:this.targetType,...this.keyType===o.YX.keyTypes.guid&&{Guid:this.key},...this.keyType===o.YX.keyTypes.number&&{Number:parseInt(this.key,10)},...this.keyType===o.YX.keyTypes.string&&{String:this.key}},...this.prefills[this.targetType]&&{Prefill:this.prefills[this.targetType]}}]}:{items:[{EntityId:u.Id}]};const E=(0,l.s)(f);this.router.navigate([`edit/${E}`],{relativeTo:this.route})}deletePermission(u){confirm(`Delete '${u.Title}' (${u.Id})?`)&&(this.snackBar.open("Deleting..."),this.permissionsService.delete(u.Id).subscribe(()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchPermissions()}))}buildGridOptions(){return{...p.C,columnDefs:[{...C.r.Id,cellRenderer:i.L,cellRendererParams:{tooltipGetter:E=>`ID: ${E.Id}\nGUID: ${E.Guid}`}},{...C.r.TextWide,headerName:"Name",field:"Title",sort:"asc",onCellClicked:f=>{this.editPermission(f.data)}},{...C.r.TextWide,field:"Identity"},{...C.r.TextWide,field:"Condition"},{...C.r.Character,field:"Grant"},{...C.r.ActionsPinnedRight1,cellRenderer:m,cellRendererParams:{onDelete:E=>this.deletePermission(E)}}]}}static#t=this.\u0275fac=function(f){return new(f||O)(n.rXU(c.Ix),n.rXU(c.nX),n.rXU(h.CP),n.rXU(I.UG))};static#e=this.\u0275cmp=n.VBU({type:O,selectors:[["app-permissions"]],standalone:!0,features:[n.Vt3,n.aNF],decls:2,vars:3,consts:[[1,"eav-dialog","nav-component-wrapper"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"eav-dialog-content","nav-component-wrapper"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","gridOptions"],["align","end"],["mat-fab","","mat-elevation-z24","","tippy","Create a new permission",1,"grid-fab",3,"click"]],template:function(f,E){if(1&f&&(n.DNE(0,A,15,2,"div",0),n.nI1(1,"async")),2&f){let M;n.vxM(0,(M=n.bMT(1,1,E.viewModel$))?0:-1,M)}},dependencies:[P.Hl,P.iY,P.Sr,s.m_,s.An,c.n3,h.E7,R.Jj,D.p,x.xs]})}return O})()},401:(T,g,t)=>{t.d(g,{T:()=>d});var h=t(8873),c=t(8559),a=t(6443),_=t(4821);let d=(()=>{class i{constructor(o,l,s){this.http=o,this.context=l,this.dnnContext=s}getMetadata(o,l,s,r){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/metadata/get"),{params:{appId:this.context.appId.toString(),targetType:o.toString(),keyType:l,key:s.toString(),...r&&{contentType:r}}})}static#t=this.\u0275fac=function(l){return new(l||i)(c.KVO(a.Qq),c.KVO(h.o),c.KVO(_.ob))};static#e=this.\u0275prov=c.jDH({token:i,factory:i.\u0275fac})}return i})()},4900:(T,g,t)=>{t.d(g,{K:()=>i});var h=t(271),c=t(6817),a=t(52),_=t(401),e=t(5437),d=t(8559);let i=(()=>{class p{constructor(){this.metadataService=(0,e.d)(_.T),this.entitiesService=(0,e.d)(c.R)}getAll(l,s,r){return this.metadataService.getMetadata(l,s,r,a.YX.contentTypes.permissions).pipe((0,h.T)(n=>n.Items))}delete(l){return this.entitiesService.delete(a.YX.contentTypes.permissions,l,!1)}static#t=this.\u0275fac=function(s){return new(s||p)};static#e=this.\u0275prov=d.jDH({token:p,factory:p.\u0275fac})}return p})()},8991:(T,g,t)=>{t.d(g,{N:()=>s});const h={states:{true:{tooltip:"true/on",icon:"radio_button_checked"},false:{tooltip:"false/off",icon:"radio_button_unchecked"}}};var c=t(7896),a=t(3840),_=t(316),e=t(8559);const d=r=>({clickable:r});function i(r,n){1&r&&e.eu8(0)}function p(r,n){if(1&r&&(e.j41(0,"a",2),e.DNE(1,i,1,0,"ng-container",3),e.k0s()),2&r){const m=e.XpG(),v=e.sdS(4);e.Y8G("href",m.data.url,e.B4B),e.R7$(),e.Y8G("ngTemplateOutlet",v)}}function o(r,n){if(1&r&&(e.j41(0,"div",4)(1,"mat-icon"),e.EFF(2),e.k0s()()),2&r){const m=e.XpG();e.Y8G("ngClass",e.eq3(3,d,m.data.clickable))("tippy",m.data.tooltip),e.R7$(2),e.JRh(m.data.icon)}}function l(r,n){if(1&r&&(e.j41(0,"div",4)(1,"mat-icon"),e.EFF(2),e.k0s()()),2&r){const m=e.XpG();e.Y8G("ngClass",e.eq3(3,d,m.data.clickable))("tippy",m.data.tooltip),e.R7$(2),e.JRh(m.data.icon)}}let s=(()=>{class r{agInit(m){this.value=m.value,this.allSettings=m.settings?.(m.data)??h;const v=this.allSettings.states[this.value?"true":"false"];this.data={...v,url:v.url??v.getUrl?.(m.data)}}refresh(m){return!0}static#t=this.\u0275fac=function(v){return new(v||r)};static#e=this.\u0275cmp=e.VBU({type:r,selectors:[["app-ag-bool-icon-renderer"]],standalone:!0,features:[e.aNF],decls:5,vars:1,consts:[["showIcon",""],[1,"icon-container"],["target","_blank",3,"href"],[4,"ngTemplateOutlet"],[1,"icon-cell","icon",3,"ngClass","tippy"]],template:function(v,C){1&v&&(e.j41(0,"div",1),e.DNE(1,p,2,2,"a",2)(2,o,3,5),e.k0s(),e.DNE(3,l,3,5,"ng-template",null,0,e.C5r)),2&v&&(e.R7$(),e.vxM(1,C.data.url?1:2))},dependencies:[c.e,a.m_,a.An,_.YU],encapsulation:2})}return r})()},1828:(T,g,t)=>{t.d(g,{r:()=>_});var h=t(1960),c=t(8991),a=t(2871);class _{static#t=this.ActionsPinnedRight1={width:42,cellClass:"secondary-action no-padding".split(" "),pinned:"right"};static#e=this.ActionsPinnedRight3={width:122,cellClass:"secondary-action no-padding".split(" "),pinned:"right"};static#n=this.ActionsPinnedRight4={width:162,cellClass:"secondary-action no-padding".split(" "),pinned:"right"};static#s=this.ActionsPinnedRight5={width:202,cellClass:"secondary-action no-padding".split(" "),pinned:"right"};static#i=this.ActionsPinnedRight6={width:82,cellClass:"secondary-action no-padding".split(" "),pinned:"right"};static#a=this.ActionsPinnedRight7={width:62,cellClass:"secondary-action no-outline no-padding".split(" "),pinned:"right"};static#o=this.IconShow={headerName:"Show",width:70,headerClass:"dense",cellClass:"icons no-outline".split(" "),sortable:!0,filter:h.y,valueGetter:d=>!d.data.IsHidden,cellRenderer:c.N};static#l=this.Items={width:102,headerClass:"dense",cellClass:"secondary-action no-padding".split(" "),sortable:!0,filter:"agNumberColumnFilter"};static#r=this.Fields={width:94,headerClass:"dense",cellClass:"secondary-action no-padding".split(" "),sortable:!0,filter:"agNumberColumnFilter"};static#c=this.Character={width:70,headerClass:"dense",cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter"};static#d=this.Id={headerName:"ID",field:"Id",width:70,headerClass:"dense",cellClass:"id-action no-padding no-outline".split(" "),sortable:!0,filter:"agNumberColumnFilter"};static#p=this.Boolean={width:70,headerClass:"dense",cellClass:"number-cell no-outline".split(" "),sortable:!0};static#h=this.Boolean2={width:100,sortable:!0,cellClass:"no-outline",filter:h.y};static#_=this.Boolean3={headerClass:"dense",width:80,cellClass:"no-outline",cellRenderer:a.J,cellRendererParams:{reverse:!1}};static#u=this.Number={width:70,headerClass:"dense",cellClass:"number-cell no-outline".split(" "),sortable:!0,filter:"agNumberColumnFilter"};static#m=this.TextWideType={flex:3,minWidth:250,cellClass:"primary-action highlight".split(" "),sortable:!0,filter:"agTextColumnFilter"};static#g=this.TextWide={flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter"};static#f=this.TextWideMin100={flex:1,minWidth:100,sortable:!0,filter:"agTextColumnFilter"};static#E=this.TextWideFlex3={flex:3,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter"};static#v=this.TextNarrow={flex:1,minWidth:150,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter"};static#C=this.TextWideActionClass={flex:2,minWidth:250,cellClass:"primary-action no-padding no-outline".split(" "),sortable:!0,filter:"agTextColumnFilter"}}},1735:(T,g,t)=>{t.d(g,{V:()=>o});var h=t(2159),c=t(1567),a=t(3037),_=t(271),e=t(5057),d=t(3176),i=t(8147);class o extends d.${constructor(s,r,n){super(),this.router=s,this.route=r,this.log=n,this.log??=new i.B("BaseComponent",!1)}childDialogClosed$(){return this.router.events.pipe((0,c.p)(s=>s instanceof h.wF),(0,a.Z)(!!this.route.snapshot.firstChild),(0,_.T)(()=>!!this.route.snapshot.firstChild),(0,e.J)(),(0,c.p)(([s,r])=>s&&!r))}}},1960:(T,g,t)=>{t.d(g,{y:()=>_});var h=t(4456),c=t(3804),a=t(8559);let _=(()=>{class e{constructor(){this.filter=""}agInit(i){this.filterParams=i}isFilterActive(){return""!==this.filter}doesFilterPass(i){const o=this.filterParams.valueGetter({api:this.filterParams.api,colDef:this.filterParams.colDef,column:this.filterParams.column,columnApi:this.filterParams.columnApi,context:this.filterParams.context,data:i.node.data,getValue:l=>i.node.data[l],node:i.node});return null!=o&&o.toString()===this.filter}getModel(){if(this.isFilterActive())return{filterType:"boolean",filter:this.filter}}setModel(i){this.filter=i?i.filter:""}afterGuiAttached(i){}filterChanged(){this.filterParams.filterChangedCallback()}static#t=this.\u0275fac=function(p){return new(p||e)};static#e=this.\u0275cmp=a.VBU({type:e,selectors:[["app-boolean-filter"]],standalone:!0,features:[a.aNF],decls:7,vars:1,consts:[[3,"ngModelChange","ngModel"],["value",""],["value","true"],["value","false"]],template:function(p,o){1&p&&(a.j41(0,"mat-radio-group",0),a.mxI("ngModelChange",function(s){return a.DH7(o.filter,s)||(o.filter=s),s}),a.bIt("ngModelChange",function(){return o.filterChanged()}),a.j41(1,"mat-radio-button",1),a.EFF(2,"All"),a.k0s(),a.j41(3,"mat-radio-button",2),a.EFF(4,"True"),a.k0s(),a.j41(5,"mat-radio-button",3),a.EFF(6,"False"),a.k0s()()),2&p&&a.R50("ngModel",o.filter)},dependencies:[h.YN,h.BC,h.vS,c.Wk,c.VT,c._g],styles:[".mat-mdc-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;overflow:hidden;padding:12px;width:160px;height:104px}"]})}return e})()},6378:(T,g,t)=>{t.d(g,{L:()=>p});var h=t(519),c=t(316),a=t(3840),_=t(7896),e=t(8559),d=t(3347);const i=(o,l)=>({"align-start":o,"align-end":l});let p=(()=>{class o{constructor(s){this.snackBar=s}agInit(s){this.id=s.value,this.align="number"==typeof this.id?"end":"start",this.tooltip=s.tooltipGetter(s.data)}refresh(s){return!0}copy(){(0,h.l)(this.tooltip),this.snackBar.open("Copied to clipboard",null,{duration:2e3})}static#t=this.\u0275fac=function(r){return new(r||o)(e.rXU(d.UG))};static#e=this.\u0275cmp=e.VBU({type:o,selectors:[["app-id-field"]],standalone:!0,features:[e.aNF],decls:5,vars:6,consts:[["matRipple","",1,"id-box","highlight",3,"click","tippy","ngClass"],[1,"id"],[1,"icon"]],template:function(r,n){1&r&&(e.j41(0,"div",0),e.bIt("click",function(){return n.copy()}),e.j41(1,"span",1),e.EFF(2),e.k0s(),e.j41(3,"mat-icon",2),e.EFF(4,"file_copy"),e.k0s()()),2&r&&(e.Y8G("tippy",n.tooltip)("ngClass",e.l_i(3,i,"start"===n.align,"end"===n.align)),e.R7$(2),e.JRh(n.id))},dependencies:[c.YU,a.m_,a.An,_.e],styles:[".id-box[_ngcontent-%COMP%]{padding:0 8px;height:100%;display:flex;align-items:center}.id-box.align-start[_ngcontent-%COMP%]{justify-content:flex-start}.id-box.align-end[_ngcontent-%COMP%]{justify-content:flex-end}.id-box[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{max-width:100%;text-overflow:ellipsis;overflow:hidden}.id-box[_ngcontent-%COMP%]:hover{text-decoration:none}.id-box[_ngcontent-%COMP%]:hover   .id[_ngcontent-%COMP%]{display:none}.id-box[_ngcontent-%COMP%]:not(:hover)   .icon[_ngcontent-%COMP%]{display:none}"]})}return o})()},6817:(T,g,t)=>{t.d(g,{R:()=>d});var h=t(8873),c=t(9234),a=t(8559),_=t(6443),e=t(4821);let d=(()=>{class i{constructor(o,l,s){this.http=o,this.context=l,this.dnnContext=s}create(o,l){return this.http.post(`app/auto/data/${o}`,l,{params:{appId:this.context.appId,zoneId:this.context.zoneId}})}update(o,l,s){return this.http.post(`app/auto/data/${o}/${l}`,s,{params:{appId:this.context.appId,zoneId:this.context.zoneId}})}delete(o,l,s){return this.http.delete(this.dnnContext.$2sxc.http.apiUrl(c.gb+"delete"),{params:{contentType:o,id:l.toString(),appId:this.context.appId.toString(),force:s.toString()}})}static#t=this.\u0275fac=function(l){return new(l||i)(a.KVO(_.Qq),a.KVO(h.o),a.KVO(e.ob))};static#e=this.\u0275prov=a.jDH({token:i,factory:i.\u0275fac})}return i})()},9234:(T,g,t)=>{t.d(g,{Gg:()=>m,Tr:()=>v,gb:()=>n});var h=t(1567),c=t(6647),a=t(6301),_=t(271),e=t(4979),d=t(8147),i=t(4839),p=t(5437),o=t(8559),l=t(6443),s=t(4821);const n="admin/entity/",m="admin/entity/list";let v=(()=>{class C extends e.V{constructor(P,D){super(new d.B("EntityService",!1)),this.http=P,this.dnnContext=D,this.queryService=(0,p.d)(i.c)}getEntities$(P){return P.pipe((0,h.p)(D=>null!=D),(0,c.n)(D=>this.getAvailableEntities(D.contentTypeName).pipe((0,a.t)(1))))}getAvailableEntities(P,D){var y=this.log.rxTap("getEntities",{enabled:!0});return this.queryService.getEntities({contentTypes:[P],itemIds:D,fields:"Id,Guid,Title",log:"getAvailableEntities"}).pipe(y.pipe(),(0,_.T)(I=>I.Default))}delete(P,D,y,I,x,A){return this.http.delete(this.dnnContext.$2sxc.http.apiUrl(n+"delete"),{params:{contentType:D,id:y.toString(),appId:P,force:I.toString(),...x&&{parentId:x.toString()},...x&&A&&{parentField:A}}})}static#t=this.\u0275fac=function(D){return new(D||C)(o.KVO(l.Qq),o.KVO(s.ob))};static#e=this.\u0275prov=o.jDH({token:C,factory:C.\u0275fac})}return C})()},4839:(T,g,t)=>{t.d(g,{c:()=>i});var h=t(8147),c=t(4979),a=t(8873),_=t(8559),e=t(6443);let i=(()=>{class p extends c.V{constructor(l,s){super(new h.B("QueryService",!1)),this.http=l,this.context=s}getAvailableEntities(l,s,r,n){this.log.a("getAvailableEntities",{queryUrl:l,params:s,fields:r,entitiesFilter:n});const m=!!s,P=(((s?.toLocaleLowerCase()??"").includes("appid=")?"":`&appId=${this.context.appId}`)+(m?`&${s}`:"")+"&$select="+(r??"")).substring(1);return this.http.post(`app/auto/query/${l}?${P}`,{Guids:n})}getEntities({contentTypes:l,itemIds:s,fields:r,log:n}){this.log.a(`getEntities(${n})`,{contentTypes:l,itemIds:s,fields:r});const v=("&typeNames="+(l?.join(",")??"")+`&appId=${this.context.appId}&itemIds=`+(s?.join(",")??"")+"&$select="+(r??"")).substring(1);return this.http.post(`app/auto/query/System.EntityPicker/Default?${v}`,{})}static#t=this.\u0275fac=function(s){return new(s||p)(_.KVO(e.Qq),_.KVO(a.o))};static#e=this.\u0275prov=_.jDH({token:p,factory:p.\u0275fac})}return p})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/18.00.01/dist/ng-edit/default-projects_eav-ui_src_app_permissions_permissions_component_ts.80d96b76250af113.js.map