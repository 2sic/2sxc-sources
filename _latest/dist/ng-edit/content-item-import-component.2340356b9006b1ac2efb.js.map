{"version":3,"sources":["./src/app/content-items/ag-grid-components/content-item-import/content-item-import.component.html","./src/app/content-items/ag-grid-components/content-item-import/content-item-import.component.ts"],"names":["dialogData","dialogRef","contentItemsService","hostClass","isImporting$","importFile$","importResult$","templateVars$","this","pipe","isImporting","importFile","importResult","ngOnInit","files","next","importContentItem","ngOnDestroy","complete","closeDialog","close","filesDropped","fileChange","event","target","importItem","value","subscribe","res","Succeeded","Messages","error","Text","ExceptionMessage","MessageType","ContentItemImportComponent"],"mappings":"uUAME,yB,sBAYE,iBACE,mFACF,Q,sBACA,iBACE,4EACF,Q,8HACA,iBAKE,QACF,Q,uBAN4E,gFAK1E,8B,yBAZJ,iBACE,uBAGA,uBAGA,uBAOF,Q,uBAbO,8CAGA,+CAGA,iD,qCAUL,QACE,oBAA0B,iEAAwB,iBAAM,OACxD,oBACE,uEACA,mBACF,OACF,O,0BAJ2C,uE,qCAK3C,QACE,oBAAyC,iEAAwB,gBAAK,OACxE,Q,qCA3CJ,gBAAoB,0EAElB,gBACE,gBAA8B,oCAAyB,OACzD,OAEA,8BAEA,cAA8B,kEAAuD,OAErF,cACE,mBAAuF,iDAAS,WAC9F,eAAM,SAA+E,OACvF,OACA,qBAA8B,kEAA9B,OACF,OAEA,uBAgBA,kBACE,iCAOA,iCAGF,OACF,O,qBAvCe,mCAK8C,uCACjD,8EAKoE,oCAiB9D,uEAOA,yEC/BlB,iBAgBE,WACmCA,EACzBC,EACAC,GAFyB,KAAAF,aACzB,KAAAC,YACA,KAAAC,sBAZgB,KAAAC,UAAY,mBAE9B,KAAAC,aAAe,IAAI,KAAgB,GACnC,KAAAC,YAAc,IAAI,IAAsB,MACxC,KAAAC,cAAgB,IAAI,IAAiC,MAC7D,KAAAC,cAAgB,YAAc,CAACC,KAAKJ,aAAcI,KAAKH,YAAaG,KAAKF,gBAAgBG,KACvF,aAAI,SAAC,G,IAAA,mBAA4C,OAAGC,YAA9C,KAA2DC,WAA9C,KAA0DC,aAA9C,U,OASjC,YAAAC,SAAA,WAC+B,MAAzBL,KAAKR,WAAWc,QAClBN,KAAKH,YAAYU,KAAKP,KAAKR,WAAWc,MAAM,IAC5CN,KAAKQ,sBAIT,YAAAC,YAAA,WACET,KAAKJ,aAAac,WAClBV,KAAKH,YAAYa,WACjBV,KAAKF,cAAcY,YAGrB,YAAAC,YAAA,WACEX,KAAKP,UAAUmB,SAGjB,YAAAC,aAAA,SAAaP,GAEXN,KAAKH,YAAYU,KADED,EAAM,IAEzBN,KAAKF,cAAcS,KAAK,MACxBP,KAAKQ,qBAGP,YAAAM,WAAA,SAAWC,GAETf,KAAKH,YAAYU,KADGQ,EAAMC,OAA4BV,MAAM,IAE5DN,KAAKF,cAAcS,KAAK,OAG1B,YAAAC,kBAAA,sBACER,KAAKJ,aAAaW,MAAK,GACvBP,KAAKN,oBAAoBuB,WAAWjB,KAAKH,YAAYqB,OAAOC,UAAU,CACpEZ,KAAM,SAAAa,GACJ,EAAKxB,aAAaW,MAAK,GACvB,EAAKT,cAAcS,KAAK,CACtBc,WAAW,EACXC,SAAU,MAGdC,MAAO,SAACA,GACN,EAAK3B,aAAaW,MAAK,GACvB,EAAKT,cAAcS,KAAK,CACtBc,WAAW,EACXC,SAAU,CAAC,CAAEE,KAAMD,EAAMA,MAAME,iBAAkBC,YAAa,U,sCA5D3DC,GAA0B,KAW3B,KAAe,sB,uBAXdA,EAA0B,mF,2lCDhBvC,uB,sBAA0D,wC,iJCU1D","file":"content-item-import-component.2340356b9006b1ac2efb.js","sourcesContent":["<div appDragAndDrop (filesDropped)=\"filesDropped($event)\" *ngIf=\"(templateVars$ | async) as data\">\r\n\r\n  <div mat-dialog-title>\r\n    <div class=\"dialog-title-box\">Import a single JSON Item</div>\r\n  </div>\r\n\r\n  <mat-spinner *ngIf=\"data.isImporting\" mode=\"indeterminate\" diameter=\"20\" color=\"accent\"></mat-spinner>\r\n\r\n  <p class=\"dialog-description\">Select a single JSON item from your computer to import.</p>\r\n\r\n  <div>\r\n    <button mat-raised-button matTooltip=\"Open file browser\" [disabled]=\"data.isImporting\" (click)=\"fileInput.click()\">\r\n      <span>{{ data.importFile ? data.importFile.name : 'Select file (or drag and drop)' }}</span>\r\n    </button>\r\n    <input #fileInput type=\"file\" (change)=\"fileChange($event)\" class=\"hide\" />\r\n  </div>\r\n\r\n  <div class=\"dialog-component-content fancy-scrollbar-light import-result-box\" *ngIf=\"data.importResult\">\r\n    <div *ngIf=\"data.importResult.Succeeded\" class=\"sxc-message sxc-message-info\">\r\n      The import has been done. See the messages below for more information.\r\n    </div>\r\n    <div *ngIf=\"!data.importResult.Succeeded\" class=\"sxc-message sxc-message-error\">\r\n      The import failed. See the messages below for more information.\r\n    </div>\r\n    <div *ngFor=\"let message of data.importResult.Messages\" class=\"sxc-message\" [ngClass]=\"{\r\n      'sxc-message-warning': message.MessageType === 0,\r\n      'sxc-message-success': message.MessageType === 1,\r\n      'sxc-message-error': message.MessageType === 2\r\n    }\">\r\n      {{ message.Text }}\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"dialog-component-actions\">\r\n    <ng-container *ngIf=\"!data.importResult?.Succeeded\">\r\n      <button mat-raised-button (click)=\"closeDialog()\">Cancel</button>\r\n      <button mat-raised-button color=\"accent\" [disabled]=\"!data.importFile || data.isImporting || data.importResult\"\r\n        (click)=\"importContentItem()\">\r\n        Import\r\n      </button>\r\n    </ng-container>\r\n    <ng-container *ngIf=\"data.importResult?.Succeeded\">\r\n      <button mat-raised-button color=\"accent\" (click)=\"closeDialog()\">Close</button>\r\n    </ng-container>\r\n  </div>\r\n</div>\r\n","import { Component, OnInit, HostBinding, OnDestroy, Inject, ChangeDetectionStrategy } from '@angular/core';\r\nimport { HttpErrorResponse } from '@angular/common/http';\r\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\r\nimport { BehaviorSubject, combineLatest } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\n\r\nimport { ContentItemsService } from '../../services/content-items.service';\r\nimport { ImportAppResult } from '../../../import-app/models/import-app-result.model';\r\nimport { ImportAppDialogData } from '../../../import-app/import-app-dialog.config';\r\n\r\n@Component({\r\n  selector: 'app-content-item-import',\r\n  templateUrl: './content-item-import.component.html',\r\n  styleUrls: ['./content-item-import.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class ContentItemImportComponent implements OnInit, OnDestroy {\r\n  @HostBinding('className') hostClass = 'dialog-component';\r\n\r\n  private isImporting$ = new BehaviorSubject(false);\r\n  private importFile$ = new BehaviorSubject<File>(null);\r\n  private importResult$ = new BehaviorSubject<ImportAppResult>(null);\r\n  templateVars$ = combineLatest([this.isImporting$, this.importFile$, this.importResult$]).pipe(\r\n    map(([isImporting, importFile, importResult]) => ({ isImporting, importFile, importResult })),\r\n  );\r\n\r\n  constructor(\r\n    @Inject(MAT_DIALOG_DATA) private dialogData: ImportAppDialogData,\r\n    private dialogRef: MatDialogRef<ContentItemImportComponent>,\r\n    private contentItemsService: ContentItemsService,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    if (this.dialogData.files != null) {\r\n      this.importFile$.next(this.dialogData.files[0]);\r\n      this.importContentItem();\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.isImporting$.complete();\r\n    this.importFile$.complete();\r\n    this.importResult$.complete();\r\n  }\r\n\r\n  closeDialog() {\r\n    this.dialogRef.close();\r\n  }\r\n\r\n  filesDropped(files: FileList) {\r\n    const importFile = files[0];\r\n    this.importFile$.next(importFile);\r\n    this.importResult$.next(null);\r\n    this.importContentItem();\r\n  }\r\n\r\n  fileChange(event: Event) {\r\n    const importFile = (event.target as HTMLInputElement).files[0];\r\n    this.importFile$.next(importFile);\r\n    this.importResult$.next(null);\r\n  }\r\n\r\n  importContentItem() {\r\n    this.isImporting$.next(true);\r\n    this.contentItemsService.importItem(this.importFile$.value).subscribe({\r\n      next: res => {\r\n        this.isImporting$.next(false);\r\n        this.importResult$.next({\r\n          Succeeded: true,\r\n          Messages: [],\r\n        });\r\n      },\r\n      error: (error: HttpErrorResponse) => {\r\n        this.isImporting$.next(false);\r\n        this.importResult$.next({\r\n          Succeeded: false,\r\n          Messages: [{ Text: error.error.ExceptionMessage, MessageType: 2 }],\r\n        });\r\n      }\r\n    });\r\n  }\r\n}\r\n"],"sourceRoot":"webpack:///"}