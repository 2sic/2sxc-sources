"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_content-export_content-export_component_ts"],{7693:(y,E,o)=>{o.d(E,{X:()=>C,g:()=>D});var g=o(7580),p=o(271),f=o(6474);const C="admin/type/",u="admin/type/get",m="admin/type/list",d="admin/type/scopes";let D=(()=>{class l extends f.D{retrieveContentType(t){return this.getHttpApiUrl(u,{params:{appId:this.appId,contentTypeId:t}})}retrieveContentTypeSig(t,r){return this.getSignal(u,{params:{appId:this.appId,contentTypeId:t}},r)}retrieveContentTypes(t){return this.getHttpApiUrl(m,{params:{appId:this.appId,scope:t}})}retrieveContentTypesSig(t,r){return this.getSignal(m,{params:{appId:this.appId,scope:t}},r)}getScopes(){return this.getHttpApiUrl(d,{params:{appId:this.appId}}).pipe((0,p.T)(t=>{const r=t.old;return Object.keys(r).map(c=>({name:r[c],value:c}))}))}getScopesSig(t){const r=this.getSignal(d,{params:{appId:this.appId}},t);return(0,g.EWP)(()=>{const c=r();if(!c||!c.old)return[];const I=c.old;return Object.keys(I).map(M=>({name:I[M],value:M}))})}getScopesV2(){return this.getHttpApiUrl(d,{params:{appId:this.appId}}).pipe((0,p.T)(t=>t.scopes))}save(t){return this.http.post(this.apiUrl("admin/type/save"),t,{params:{appid:this.appId}})}delete(t){return this.http.delete(this.apiUrl("admin/type/delete"),{params:{appid:this.appId,staticName:t.NameId}})}import(t){const r=new FormData;for(const _ of t)r.append("File",_);return this.http.post(this.apiUrl("admin/type/import"),r,{params:{appId:this.appId,zoneId:this.zoneId}})}createGhost(t){return this.http.post(this.apiUrl("admin/type/addghost"),null,{params:{appid:this.appId,sourceNameId:t}})}static{this.\u0275fac=(()=>{let t;return function(_){return(t||(t=g.xGo(l)))(_||l)}})()}static{this.\u0275prov=g.jDH({token:l,factory:l.\u0275fac})}}return l})()},5727:(y,E,o)=>{o.r(E),o.d(E,{ContentExportComponent:()=>M});var g=o(316),p=o(4456),f=o(4175),C=o(4646),u=o(7941),m=o(4950),d=o(3804),v=o(5175),x=o(5797),T=o(1873),h=o(2938),D=o(7693),l=o(4699),O=o(6360),t=o(7580),r=o(2159);function _(i,R){if(1&i&&(t.j41(0,"mat-option",10),t.EFF(1),t.k0s()),2&i){const a=R.$implicit;t.Y8G("value",a.NameId),t.R7$(),t.JRh(a.NameId)}}function c(i,R){if(1&i&&(t.j41(0,"mat-radio-button",15),t.EFF(1),t.k0s()),2&i){const a=t.XpG(2);t.R7$(),t.SpI(" Export selected ",a.itemIds.length," items ")}}function I(i,R){if(1&i){const a=t.RV6();t.j41(0,"form",null,0)(2,"div",4)(3,"p"),t.EFF(4," This will generate an XML file which you can edit in Excel. If you just want to import new data, use this to export the schema that you can then fill in using Excel. Please visit "),t.j41(5,"a",5),t.EFF(6,"https://2sxc.org/help"),t.k0s(),t.EFF(7," for more instructions. "),t.k0s(),t.j41(8,"div",6)(9,"div")(10,"mat-form-field",7)(11,"mat-label"),t.EFF(12,"Languages"),t.k0s(),t.j41(13,"mat-select",8),t.mxI("ngModelChange",function(e){t.eBV(a);const s=t.XpG();return t.DH7(s.formValues.language,e)||(s.formValues.language=e),t.Njj(e)}),t.j41(14,"mat-option",9),t.EFF(15,"All"),t.k0s(),t.Z7z(16,_,2,2,"mat-option",10,t.fX1),t.k0s()()(),t.j41(18,"div")(19,"p",11),t.EFF(20,"Export data"),t.k0s(),t.j41(21,"mat-radio-group",12),t.mxI("ngModelChange",function(e){t.eBV(a);const s=t.XpG();return t.DH7(s.formValues.recordExport,e)||(s.formValues.recordExport=e),t.Njj(e)}),t.j41(22,"mat-radio-button",13),t.EFF(23,"No, just export blank data schema (for new data import) "),t.k0s(),t.j41(24,"mat-radio-button",14),t.EFF(25,"Yes, export all content-items"),t.k0s(),t.DNE(26,c,2,1,"mat-radio-button",15),t.k0s()(),t.j41(27,"div")(28,"p",11),t.EFF(29,"Value references to other languages"),t.k0s(),t.j41(30,"mat-radio-group",16),t.mxI("ngModelChange",function(e){t.eBV(a);const s=t.XpG();return t.DH7(s.formValues.languageReferences,e)||(s.formValues.languageReferences=e),t.Njj(e)}),t.j41(31,"mat-radio-button",17),t.EFF(32,"Keep references to other languages (for re-import) "),t.k0s(),t.j41(33,"mat-radio-button",18),t.EFF(34,"Replace references with values"),t.k0s()()(),t.j41(35,"div")(36,"p",11),t.EFF(37,"File / page references"),t.k0s(),t.j41(38,"mat-radio-group",19),t.mxI("ngModelChange",function(e){t.eBV(a);const s=t.XpG();return t.DH7(s.formValues.resourcesReferences,e)||(s.formValues.resourcesReferences=e),t.Njj(e)}),t.j41(39,"mat-radio-button",17),t.EFF(40,"Keep references (for re-import, for example Page:4711) "),t.k0s(),t.j41(41,"mat-radio-button",18),t.EFF(42,"Replace references with real URLs (for example /Portals/0...) "),t.k0s()()()()(),t.j41(43,"mat-dialog-actions",20)(44,"button",21),t.bIt("click",function(){t.eBV(a);const e=t.XpG();return t.Njj(e.closeDialog())}),t.EFF(45,"Cancel"),t.k0s(),t.j41(46,"button",22),t.bIt("click",function(){t.eBV(a);const e=t.XpG();return t.Njj(e.exportContent())}),t.EFF(47,"Export Data"),t.k0s()()()}if(2&i){const a=t.sdS(1),n=t.XpG();t.R7$(13),t.R50("ngModel",n.formValues.language),t.R7$(3),t.Dyx(n.languages),t.R7$(5),t.R50("ngModel",n.formValues.recordExport),t.R7$(5),t.vxM(n.hasIdList?26:-1),t.R7$(4),t.R50("ngModel",n.formValues.languageReferences),t.Y8G("disabled","Blank"===n.formValues.recordExport),t.R7$(8),t.R50("ngModel",n.formValues.resourcesReferences),t.Y8G("disabled","Blank"===n.formValues.recordExport),t.R7$(8),t.Y8G("disabled",!a.form.valid)}}let M=(()=>{class i{constructor(a,n){this.dialog=a,this.route=n,this.hostClass="dialog-component",this.contentExportService=(0,h.d)(O.D),this.contentTypesService=(0,h.d)(D.g),this.dialogConfigSvc=(0,h.d)(l.L),this.hasIdList=!1,this.loading$=new x.t(!1),this.contentType$=new x.t(null),this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName");const e=this.route.snapshot.paramMap.get("selectedIds");this.hasIdList=!!e,this.hasIdList&&(this.itemIds=e.split(",").map(s=>parseInt(s,10)))}ngOnInit(){this.loading$.next(!0);const a=this.contentTypesService.retrieveContentType(this.contentTypeStaticName),n=this.dialogConfigSvc.getCurrent$();(0,T.p)([a,n]).subscribe(([e,s])=>{this.contentType$.next(e),this.languages=s.Context.Language.List,this.formValues={defaultLanguage:s.Context.Language.Primary,contentTypeStaticName:this.contentTypeStaticName,language:"",recordExport:this.hasIdList?"Selection":"All",languageReferences:"Link",resourcesReferences:"Link"},this.loading$.next(!1)})}ngOnDestroy(){this.contentType$.complete(),this.loading$.complete()}closeDialog(){this.dialog.close()}exportContent(){this.contentExportService.exportContent(this.formValues,this.hasIdList&&"Selection"===this.formValues.recordExport?this.itemIds:null)}static{this.\u0275fac=function(n){return new(n||i)(t.rXU(u.CP),t.rXU(r.nX))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-content-export"]],hostVars:1,hostBindings:function(n,e){2&n&&t.Mr5("className",e.hostClass)},decls:7,vars:6,consts:[["ngForm","ngForm"],[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],["href","https://2sxc.org/help","target","_blank"],[1,"dialog-form-content","fancy-scrollbar-light"],["color","accent",1,"eav-mat-form-field"],["name","Language",3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"eav-radio-group-label"],["name","RecordExport",1,"eav-radio-group",3,"ngModelChange","ngModel"],["value","Blank"],["value","All"],["value","Selection"],["name","LanguageReferences",1,"eav-radio-group",3,"ngModelChange","ngModel","disabled"],["value","Link"],["value","Resolve"],["name","ResourcesReferences",1,"eav-radio-group",3,"ngModelChange","ngModel","disabled"],["align","end"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"click","disabled"]],template:function(n,e){if(1&n&&(t.j41(0,"div",1)(1,"div",2)(2,"div",3),t.EFF(3),t.nI1(4,"async"),t.k0s()(),t.DNE(5,I,48,8,"form"),t.nI1(6,"async"),t.k0s()),2&n){let s;t.R7$(3),t.SpI("Export ",null==(s=t.bMT(4,2,e.contentType$))?null:s.Name,""),t.R7$(2),t.vxM(!1===t.bMT(6,4,e.loading$)?5:-1)}},dependencies:[p.YN,p.qT,p.BC,p.cb,p.vS,p.cV,m.RG,m.rl,m.nJ,v.Ve,v.VO,C.wT,C.Sy,d.Wk,d.VT,d._g,u.E7,f.Hl,f.$z,g.Jj],styles:[".eav-radio-group-label[_ngcontent-%COMP%]{font-size:18px;margin:24px 0 0}.eav-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:8px 0}"]})}}return i})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/19.00.00/dist/ng-edit/projects_eav-ui_src_app_content-export_content-export_component_ts.780c956c3498c57f.js.map