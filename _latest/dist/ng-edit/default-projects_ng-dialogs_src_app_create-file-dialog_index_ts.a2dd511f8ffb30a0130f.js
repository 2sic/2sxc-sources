(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["default-projects_ng-dialogs_src_app_create-file-dialog_index_ts"],{9137:function(t,e,n){"use strict";n.d(e,{tk:function(){return c}});var i=n(4762),o=n(9996),a=n(1407),l=n(5549),r=n(1785),s=n(2693),p=n(3582),u=n(2837),c=function(){function t(t,e,n){var i;this.http=t,this.context=e,this.dnnContext=n,this.isShared=null!==(i=sessionStorage.getItem(l.PH))&&void 0!==i?i:(!1).toString()}return t.prototype.get=function(t,e){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(a.pJ),{params:(0,i.pi)({appId:this.context.appId.toString(),global:this.isShared},this.templateIdOrPath(t,e))}).pipe((0,o.U)(function(t){if("auto"===t.Type.toLocaleLowerCase())switch(t.Extension.toLocaleLowerCase()){case".cs":case".cshtml":t.Type="Razor";break;case".html":case".css":case".js":t.Type="Token"}return t}))},t.prototype.save=function(t,e,n){return this.http.post(this.dnnContext.$2sxc.http.apiUrl(a.pJ),e,{params:(0,i.pi)({appId:this.context.appId.toString(),global:this.isShared},this.templateIdOrPath(t,n))})},t.prototype.getTemplates=function(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(a.nu),{params:{appId:this.context.appId.toString(),global:this.isShared,withSubfolders:"true"}})},t.prototype.getPredefinedTemplates=function(t,e){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/appfiles/GetTemplates"),{params:(0,i.pi)((0,i.pi)({},t&&{purpose:t}),e&&{type:e})})},t.prototype.getPreview=function(t,e){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/appfiles/preview"),{params:{appId:this.context.appId.toString(),path:t,templateKey:e,global:this.isShared}})},t.prototype.createTemplate=function(t,e){return this.http.post(this.dnnContext.$2sxc.http.apiUrl(a.yE),{},{params:{appId:this.context.appId.toString(),global:this.isShared,purpose:"auto",path:t,templateKey:e}})},t.prototype.templateIdOrPath=function(t,e){var n;if(/^[0-9]*$/g.test(t)){var o=null===(n=e.find(function(e){var n;return(null===(n=e.EntityId)||void 0===n?void 0:n.toString())===t}))||void 0===n?void 0:n.Path;return(0,i.pi)({templateId:t},null!=o&&{path:o})}return{path:t}},t.\u0275fac=function(e){return new(e||t)(r.LFG(s.eN),r.LFG(p._),r.LFG(u._y))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t}()},7237:function(t,e,n){"use strict";n.d(e,{U:function(){return z},q:function(){return X}});var i=n(4762),o=n(1041),a=n(2935),l=n(7570),r=n(8512),s=n(1305),p=n(8569),u=n(878),c=n(3148),f=n(1110),d=n(6238),h=n(8720),g=n(9996),m=n(6599),v=n(8784),x=n(2250),b=n(1112),y=n(1998),Z=n(6673),w=(n(6882),{leading:!0,trailing:!1}),_=function(){function t(e,n,i,o){(0,b.Z)(this,t),this.duration=e,this.scheduler=n,this.leading=i,this.trailing=o}return(0,y.Z)(t,[{key:"call",value:function(t,e){return e.subscribe(new C(t,this.duration,this.scheduler,this.leading,this.trailing))}}]),t}(),C=function(t){(0,v.Z)(n,t);var e=(0,x.Z)(n);function n(t,i,o,a,l){var r;return(0,b.Z)(this,n),(r=e.call(this,t)).duration=i,r.scheduler=o,r.leading=a,r.trailing=l,r._hasTrailingValue=!1,r._trailingValue=null,r}return(0,y.Z)(n,[{key:"_next",value:function(t){this.throttled?this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(T,this.duration,{subscriber:this})),this.leading?this.destination.next(t):this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0))}},{key:"_complete",value:function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()}},{key:"clearThrottle",value:function(){var t=this.throttled;t&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),t.unsubscribe(),this.remove(t),this.throttled=null)}}]),n}(Z.L);function T(t){t.subscriber.clearThrottle()}var P=n(4689),q=n(447),I=n(1785),O=n(9137),A=n(1116),k=n(3070),N=n(3841),U=n(9550),V=function(){function t(t,e){this.matInput=t,this.elementRef=e,this.autofocusSelectValue=!1}return t.prototype.ngOnInit=function(){var t=this;setTimeout(function(){t.matInput.focus(),t.toBoolean(t.autofocusSelectValue)&&t.elementRef.nativeElement.setSelectionRange(0,t.matInput.value.length)})},t.prototype.toBoolean=function(t){if("boolean"==typeof t)return t;if("string"==typeof t){var e=t.toLocaleLowerCase();return"true"===e||"false"!==e&&void 0}return null==t?t:void 0},t.\u0275fac=function(e){return new(e||t)(I.Y36(U.Nt),I.Y36(I.SBq))},t.\u0275dir=I.lG2({type:t,selectors:[["","appMatInputAutofocus",""]],inputs:{autofocusSelectValue:"autofocusSelectValue"}}),t}(),S=n(4369),$=n(7064),K=n(7110),J=n(7672);function M(t,e){if(1&t&&(I.TgZ(0,"mat-option",20),I._uU(1),I.qZA()),2&t){var n=e.$implicit;I.Q6J("value",n),I.xp6(1),I.hij(" ",n," ")}}function Q(t,e){if(1&t&&(I.TgZ(0,"mat-option",20),I._uU(1),I.qZA()),2&t){var n=e.$implicit;I.Q6J("value",n),I.xp6(1),I.hij(" ",n," ")}}function E(t,e){if(1&t&&(I.TgZ(0,"mat-option",20),I._uU(1),I.qZA()),2&t){var n=e.$implicit;I.Q6J("value",n.Key),I.xp6(1),I.hij(" ",n.Name," ")}}function j(t,e){1&t&&(I.TgZ(0,"app-field-hint",21),I._uU(1," This field is required "),I.qZA()),2&t&&I.Q6J("isError",!0)}function Y(t,e){1&t&&(I.ynx(0),I._UZ(1,"mat-spinner",22),I._UZ(2,"div",23),I.BQk())}var D=function(t){return{disabled:t}};function F(t,e){if(1&t&&(I.ynx(0),I.TgZ(1,"div",24),I.TgZ(2,"label",25),I._uU(3,"Preview"),I.qZA(),I.qZA(),I.TgZ(4,"pre",26),I._uU(5),I.qZA(),I.BQk()),2&t){var n=I.oxw().ngIf;I.xp6(2),I.Q6J("ngClass",I.VKq(3,D,n.loadingPreview)),I.xp6(2),I.Q6J("ngClass",I.VKq(5,D,n.loadingPreview)),I.xp6(1),I.Oqu(n.preview)}}function L(t,e){if(1&t&&(I.TgZ(0,"div",27),I._uU(1),I.qZA()),2&t){var n=I.oxw().ngIf;I.xp6(1),I.hij(" ",n.previewError," ")}}function R(t,e){if(1&t){var n=I.EpF();I.ynx(0),I.TgZ(1,"div",1),I.TgZ(2,"div",2),I.TgZ(3,"span"),I._uU(4,"Create"),I.qZA(),I.TgZ(5,"span",3),I._uU(6),I.qZA(),I.qZA(),I.qZA(),I.TgZ(7,"form",4),I.TgZ(8,"div",5),I.TgZ(9,"div",6),I.TgZ(10,"div",7),I.TgZ(11,"mat-form-field",8),I.TgZ(12,"mat-label"),I._uU(13,"Platform"),I.qZA(),I.TgZ(14,"mat-select",9),I.YNc(15,M,2,2,"mat-option",10),I.qZA(),I.qZA(),I.qZA(),I.TgZ(16,"div",7),I.TgZ(17,"mat-form-field",8),I.TgZ(18,"mat-label"),I._uU(19,"Purpose"),I.qZA(),I.TgZ(20,"mat-select",11),I.YNc(21,Q,2,2,"mat-option",10),I.qZA(),I.qZA(),I.qZA(),I.qZA(),I.TgZ(22,"div",12),I.TgZ(23,"mat-form-field",8),I.TgZ(24,"mat-label"),I._uU(25,"Template"),I.qZA(),I.TgZ(26,"mat-select",13),I.YNc(27,E,2,2,"mat-option",10),I.qZA(),I.qZA(),I.qZA(),I.TgZ(28,"div",12),I.TgZ(29,"mat-form-field",8),I.TgZ(30,"mat-label"),I._uU(31,"Name"),I.qZA(),I._UZ(32,"input",14),I.qZA(),I.YNc(33,j,2,1,"app-field-hint",15),I.qZA(),I.qZA(),I.TgZ(34,"div",16),I.YNc(35,Y,3,0,"ng-container",0),I.TgZ(36,"button",17),I.NdJ("click",function(){return I.CHM(n),I.oxw().closeDialog()}),I._uU(37,"Cancel"),I.qZA(),I.TgZ(38,"button",18),I.NdJ("click",function(){return I.CHM(n),I.oxw().confirm()}),I._uU(39," Create "),I.qZA(),I.qZA(),I.YNc(40,F,6,7,"ng-container",0),I.YNc(41,L,2,1,"div",19),I.qZA(),I.BQk()}if(2&t){var i=e.ngIf,o=I.oxw();I.xp6(6),I.Oqu(o.controls.finalName.value||(o.controls.folder.value?o.controls.folder.value.trim()+"/":"")),I.xp6(1),I.Q6J("formGroup",o.form),I.xp6(8),I.Q6J("ngForOf",i.platforms),I.xp6(6),I.Q6J("ngForOf",i.purposes),I.xp6(6),I.Q6J("ngForOf",i.templates),I.xp6(6),I.Q6J("ngIf",o.controls.name.touched&&(null==o.controls.name.errors?null:o.controls.name.errors.required)),I.xp6(2),I.Q6J("ngIf",i.loadingPreview),I.xp6(3),I.Q6J("disabled",!o.form.valid||i.loadingPreview||!i.previewValid),I.xp6(2),I.Q6J("ngIf",i.preview),I.xp6(1),I.Q6J("ngIf",!i.loadingPreview&&i.previewError)}}var z=function(){function t(t,e,n){this.dialogData=t,this.dialogRef=e,this.sourceService=n,this.hostClass="dialog-component",this.all="All"}return t.prototype.ngOnInit=function(){this.subscription=new l.w,this.templates$=new r.X([]),this.loadingPreview$=new r.X(!1),this.buildForm(),this.fetchTemplates(),this.buildTemplateVars()},t.prototype.ngOnDestroy=function(){this.templates$.complete(),this.loadingPreview$.complete(),this.subscription.unsubscribe()},t.prototype.closeDialog=function(t){this.dialogRef.close(t)},t.prototype.confirm=function(){var t=this.form.getRawValue();this.closeDialog({name:t.finalName,templateKey:t.templateKey})},t.prototype.fetchTemplates=function(){var t=this;this.sourceService.getPredefinedTemplates(this.dialogData.purpose,this.dialogData.type).subscribe(function(e){t.controls.templateKey.value!==e.Default&&t.controls.templateKey.patchValue(e.Default),t.templates$.next(e.Templates)})},t.prototype.buildForm=function(){var t,e,n=this;this.form=new o.cw({platform:new o.NI(this.all),purpose:new o.NI({value:null!==(t=this.dialogData.purpose)&&void 0!==t?t:this.all,disabled:null!=this.dialogData.purpose}),templateKey:new o.NI(null,o.kI.required),name:new o.NI(null,o.kI.required),finalName:new o.NI({value:null,disabled:!0}),folder:new o.NI({value:null!==(e=this.dialogData.folder)&&void 0!==e?e:"",disabled:!0})}),this.controls=this.form.controls,this.subscription.add((0,s.aj)([this.templates$,this.controls.templateKey.valueChanges.pipe((0,d.O)(this.controls.templateKey.value),(0,h.x)())]).subscribe(function(t){var e,o=(0,i.CR)(t,2),a=o[1],l=o[0].find(function(t){return t.Key===a}),r=null!==(e=null==l?void 0:l.SuggestedFileName)&&void 0!==e?e:null;n.controls.name.value!==r&&n.controls.name.patchValue(r)})),this.subscription.add((0,s.aj)([this.templates$,this.controls.templateKey.valueChanges.pipe((0,d.O)(this.controls.templateKey.value),(0,h.x)()),this.controls.name.valueChanges.pipe((0,d.O)(this.controls.name.value),(0,h.x)()),this.controls.folder.valueChanges.pipe((0,d.O)(this.controls.folder.value),(0,h.x)())]).subscribe(function(t){var e,o,a,l=(0,i.CR)(t,4),r=l[1],s=l[2],p=l[3],u=l[0].find(function(t){return t.Key===r}),c=null;s&&(p=p.trim(),s=q.vl.sanitizePath(s.trim()),c=((p?p+"/":"")+(s=""+(null!==(e=null==u?void 0:u.Prefix)&&void 0!==e?e:"")+s+(null!==(o=null==u?void 0:u.Suffix)&&void 0!==o?o:"")+(null!==(a=null==u?void 0:u.Extension)&&void 0!==a?a:""))).replace(/\/{2,}/g,"/")),n.controls.finalName.value!==c&&n.controls.finalName.patchValue(c)}))},t.prototype.buildTemplateVars=function(){var t=this,e=this.templates$.pipe((0,g.U)(function(e){var n,i=((n={})[t.all]=t.all,n);return e.forEach(function(t){var e;null===(e=t.Platforms)||void 0===e||e.forEach(function(t){i[t]=t})}),Object.keys(i)})),n=this.templates$.pipe((0,g.U)(function(e){var n,i=((n={})[t.all]=t.all,n);return e.forEach(function(t){i[t.Purpose]=t.Purpose}),Object.keys(i)})),o=(0,s.aj)([this.templates$,this.controls.platform.valueChanges.pipe((0,d.O)(this.controls.platform.value),(0,h.x)()),this.controls.purpose.valueChanges.pipe((0,d.O)(this.controls.purpose.value),(0,h.x)())]).pipe((0,g.U)(function(e){var n=(0,i.CR)(e,3),o=n[1],a=n[2];return n[0].filter(function(e){var n,i;return(o===t.all||null!==(i=null===(n=e.Platforms)||void 0===n?void 0:n.includes(o))&&void 0!==i&&i)&&(a===t.all||e.Purpose===a)})}),(0,m.b)(function(e){var n,i;if(!e.some(function(e){return e.Key===t.controls.templateKey.value})){var o=null!==(i=null===(n=e[0])||void 0===n?void 0:n.Key)&&void 0!==i?i:null;t.controls.templateKey.value!==o&&t.controls.templateKey.patchValue(o)}})),a=(0,s.aj)([this.controls.finalName.valueChanges.pipe((0,d.O)(this.controls.finalName.value),(0,h.x)()),this.controls.templateKey.valueChanges.pipe((0,d.O)(this.controls.templateKey.value),(0,h.x)())]).pipe(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p.P,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:w;return function(i){return i.lift(new _(t,e,n.leading,n.trailing))}}(100,p.z,{leading:!0,trailing:!0}),(0,m.b)(function(){t.loadingPreview$.next(!0)}),(0,P.w)(function(e){var n=(0,i.CR)(e,2),o=n[0],a=n[1];return o&&a?(0,c.D)([t.sourceService.getPreview(o,a),(0,f.H)(500)]).pipe((0,g.U)(function(t){return(0,i.CR)(t,1)[0]})):(0,u.of)(void 0)}),(0,m.b)(function(){t.loadingPreview$.next(!1)}));this.templateVars$=(0,s.aj)([e,n,o,a,this.loadingPreview$]).pipe((0,g.U)(function(t){var e,n=(0,i.CR)(t,5),o=n[3];return{platforms:n[0],purposes:n[1],templates:n[2],loadingPreview:n[4],preview:null==o?void 0:o.Preview,previewValid:null!==(e=null==o?void 0:o.IsValid)&&void 0!==e&&e,previewError:null==o?void 0:o.Error}}))},t.\u0275fac=function(e){return new(e||t)(I.Y36(a.WI),I.Y36(a.so),I.Y36(O.tk))},t.\u0275cmp=I.Xpm({type:t,selectors:[["app-create-file-dialog"]],hostVars:1,hostBindings:function(t,e){2&t&&I.Ikx("className",e.hostClass)},decls:2,vars:3,consts:[[4,"ngIf"],["mat-dialog-title",""],[1,"dialog-title-box","hide-scrollbar"],[1,"file-name"],[1,"dialog-form",3,"formGroup"],[1,"dialog-form-content","fancy-scrollbar-light"],[1,"field-container","multiple"],[1,"multiple-field"],["appearance","standard","color","accent"],["formControlName","platform"],[3,"value",4,"ngFor","ngForOf"],["formControlName","purpose"],[1,"field-container"],["formControlName","templateKey"],["matInput","","type","text","formControlName","name","required","","appMatInputAutofocus","","autofocusSelectValue","true"],[3,"isError",4,"ngIf"],[1,"dialog-form-actions"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],["class","preview-error",4,"ngIf"],[3,"value"],[3,"isError"],["mode","indeterminate","diameter","20","color","accent"],[1,"spacer"],[1,"preview-label-box"],[1,"preview-label",3,"ngClass"],[1,"fancy-scrollbar-light",3,"ngClass"],[1,"preview-error"]],template:function(t,e){1&t&&(I.YNc(0,R,42,10,"ng-container",0),I.ALo(1,"async")),2&t&&I.Q6J("ngIf",I.lcZ(1,1,e.templateVars$))},directives:[A.O5,o._Y,o.JL,o.sg,k.KE,k.hX,N.gD,o.JJ,o.u,A.sg,U.Nt,o.Fj,o.Q7,V,S.lW,$.ey,K.Y,J.$g,A.mk],pipes:[A.Ov],styles:[".dialog-title-box[_ngcontent-%COMP%]{justify-content:flex-start;align-items:baseline;line-height:normal;white-space:nowrap;overflow-x:auto}.dialog-title-box[_ngcontent-%COMP%]   .file-name[_ngcontent-%COMP%]{font-size:20px;margin-left:8px;background-color:#d3d3d3}.field-container[_ngcontent-%COMP%]:not(:first-of-type){margin-top:8px}.field-container.multiple[_ngcontent-%COMP%]{display:flex}.field-container.multiple[_ngcontent-%COMP%]   .multiple-field[_ngcontent-%COMP%]{flex:1}.field-container.multiple[_ngcontent-%COMP%]   .multiple-field[_ngcontent-%COMP%]:not(:first-of-type){margin-left:8px}.dialog-form-actions[_ngcontent-%COMP%], .dialog-form-content[_ngcontent-%COMP%]{flex-shrink:0}pre[_ngcontent-%COMP%]{flex-grow:1;flex-shrink:1;font-family:monospace}pre.disabled[_ngcontent-%COMP%]{color:rgba(29,39,61,.24)}.preview-label-box[_ngcontent-%COMP%]{position:relative}.preview-label-box[_ngcontent-%COMP%]   .preview-label[_ngcontent-%COMP%]{position:absolute;top:-20px;left:0;font-size:12px;color:rgba(0,0,0,.6);pointer-events:none}.preview-label-box[_ngcontent-%COMP%]   .preview-label.disabled[_ngcontent-%COMP%]{color:rgba(29,39,61,.44)}.preview-error[_ngcontent-%COMP%]{margin-bottom:10px;font-size:14px;color:red}pre[_ngcontent-%COMP%]{display:block;padding:9.5px;margin:0 0 10px;font-size:13px;line-height:1.42857143;color:#333;word-break:break-all;word-wrap:break-word;background-color:#f5f5f5;border:1px solid #ccc;border-radius:4px;overflow-x:auto}"]}),t}(),B=n(3582),G=n(2677),X=function(){function t(){}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=I.oAB({type:t}),t.\u0275inj=I.cJS({providers:[B._,O.tk],imports:[[A.ez,G.q,S.ot,N.LD,o.UX,k.lN,U.c,J.Cq]]}),t}()}}]);
//# sourceMappingURL=https://sources.2sxc.org/13.01.00/ng-edit/default-projects_ng-dialogs_src_app_create-file-dialog_index_ts.a2dd511f8ffb30a0130f.js.map