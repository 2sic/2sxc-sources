"use strict";(self.webpackChunkng_dialogs=self.webpackChunkng_dialogs||[]).push([["projects_ng-dialogs_src_app_content-type-fields_edit-content-type-fields_edit-content-type-fi-0ac826"],{4333:function(K,Z,o){o.r(Z),o.d(Z,{EditContentTypeFieldsComponent:function(){return Oe}});var I=o(6170),A=o(2090),r=o(8069),C=o(8047),g=o(587),x=o(6317),b=o(7714),S=o(1640),O=o(745),H=o(4382),F=o(1944),Q=function(s,n){return s.push(n),s};var f=o(1203),T=o(9525),_=o(635),U=o(116),w=o(3853),z=o(3158),V=/^[A-Za-z][A-Za-z0-9]+$/,G=o(5005),X=o(9702),Y=o(1226),$=o(6565),ee=o(4722),te=o(5106),R={Boolean:{label:"Boolean (yes/no)",description:"Yes/no or true/false values"},Custom:{label:"Custom - ui-tools or custom types",description:"Use for things like gps-pickers (which writes into multiple fields) or for custom-data which serializes something exotic into the db like an array, a custom json or anything"},DateTime:{label:"Date and/or time",description:"For date, time or combined values"},Empty:{label:"Empty - for form-titles etc.",description:"Use to structure your form"},Entity:{label:"Entity (other content-items)",description:"One or more other content-items"},Hyperlink:{label:"Link / file reference",description:"Hyperlink or reference to a picture / file"},Number:{label:"Number",description:"Any kind of number"},String:{label:"Text / string",description:"Any kind of text"}},e=o(7133),B=o(5758),ie=o(2977),oe=o(2528),M=o(6362),ae=o(7317),L=o(4770),se=o(4683),re=function(){var i=function(){function s(){(0,r.Z)(this,s),this.reservedNames={}}return(0,C.Z)(s,[{key:"validate",value:function(t){if(!t.value)return null;var a=t.value.toLocaleLowerCase(),p=Object.keys(this.reservedNames).find(function(l){return l.toLocaleLowerCase()===a});return p?{reservedNames:this.reservedNames[p]}:null}}]),s}();return i.\u0275fac=function(n){return new(n||i)},i.\u0275dir=e.lG2({type:i,selectors:[["","appReservedNames",""]],inputs:{reservedNames:["appReservedNames","reservedNames"]},features:[e._Bn([{provide:g.Cf,useExisting:i,multi:!0}])]}),i}(),j=o(1434),le=o(5590),pe=o(3135),de=o(1130),ce=["ngForm"];function ue(i,s){1&i&&(e.ynx(0),e._uU(1,"Fields"),e.BQk())}function fe(i,s){1&i&&(e.ynx(0),e._uU(1,"Add Fields"),e.BQk())}function me(i,s){1&i&&(e.ynx(0),e._uU(1,"Edit Field"),e.BQk())}function ve(i,s){if(1&i&&(e.TgZ(0,"app-field-hint",22),e._uU(1),e.qZA()),2&i){var n=e.oxw(4);e.Q6J("isError",!0),e.xp6(1),e.Oqu(n.fieldNameError)}}function ge(i,s){if(1&i&&(e.TgZ(0,"app-field-hint",22),e._uU(1),e.qZA()),2&i){e.oxw(2);var n=e.MAs(6);e.Q6J("isError",!0),e.xp6(1),e.hij(" ",n.errors.reservedNames," ")}}function he(i,s){if(1&i&&(e.ynx(0),e.YNc(1,ve,2,2,"app-field-hint",21),e.YNc(2,ge,2,2,"app-field-hint",21),e.BQk()),2&i){e.oxw();var n=e.MAs(6);e.xp6(1),e.Q6J("ngIf",n.errors.pattern),e.xp6(1),e.Q6J("ngIf",n.errors.reservedNames)}}function Te(i,s){if(1&i&&(e.TgZ(0,"mat-option",23),e.TgZ(1,"mat-icon"),e._uU(2),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.qZA(),e.qZA()),2&i){var n=s.$implicit;e.Q6J("value",n.name),e.xp6(2),e.Oqu(n.icon),e.xp6(2),e.Oqu(n.label)}}function ye(i,s){if(1&i&&(e.TgZ(0,"mat-icon",19),e._uU(1),e.qZA()),2&i){var n=e.oxw().$implicit;e.xp6(1),e.Oqu(n.icon)}}var Ce=function(s){return{"input-obsolete":s}};function _e(i,s){if(1&i&&(e.TgZ(0,"mat-option",24),e.TgZ(1,"span"),e._uU(2),e.qZA(),e.YNc(3,ye,2,1,"mat-icon",25),e.qZA()),2&i){var n=s.$implicit;e.Q6J("value",n.inputType)("ngClass",e.VKq(4,Ce,n.isObsolete)),e.xp6(2),e.Oqu(n.label),e.xp6(1),e.Q6J("ngIf",n.icon)}}function Ze(i,s){if(1&i){var n=e.EpF();e.TgZ(0,"div",11),e.TgZ(1,"div",12),e.TgZ(2,"mat-form-field",13),e.TgZ(3,"mat-label"),e._uU(4,"Name"),e.qZA(),e.TgZ(5,"input",14,15),e.NdJ("ngModelChange",function(u){return e.CHM(n).$implicit.StaticName=u}),e.qZA(),e.qZA(),e.YNc(7,he,3,2,"ng-container",2),e.qZA(),e.TgZ(8,"div",12),e.TgZ(9,"mat-form-field",13),e.TgZ(10,"mat-label"),e._uU(11,"Data Type"),e.qZA(),e.TgZ(12,"mat-select",16),e.NdJ("selectionChange",function(){var c=e.CHM(n).index,v=e.oxw(2);return v.filterInputTypeOptions(c),v.resetInputType(c),v.calculateHints(c)})("ngModelChange",function(u){return e.CHM(n).$implicit.Type=u}),e.TgZ(13,"mat-select-trigger"),e.TgZ(14,"mat-icon",17),e._uU(15),e.qZA(),e.TgZ(16,"span"),e._uU(17),e.qZA(),e.qZA(),e.YNc(18,Te,5,3,"mat-option",18),e.qZA(),e.qZA(),e.TgZ(19,"app-field-hint"),e._uU(20),e.qZA(),e.qZA(),e.TgZ(21,"div",12),e.TgZ(22,"mat-form-field",13),e.TgZ(23,"mat-label"),e._uU(24,"Input Type"),e.qZA(),e.TgZ(25,"mat-select",16),e.NdJ("selectionChange",function(){var c=e.CHM(n).index;return e.oxw(2).calculateHints(c)})("ngModelChange",function(u){return e.CHM(n).$implicit.InputType=u}),e.TgZ(26,"mat-select-trigger"),e.TgZ(27,"span"),e._uU(28),e.qZA(),e.TgZ(29,"mat-icon",19),e._uU(30),e.qZA(),e.qZA(),e.YNc(31,_e,4,6,"mat-option",20),e.qZA(),e.qZA(),e.TgZ(32,"app-field-hint"),e._uU(33),e.qZA(),e.qZA(),e.qZA()}if(2&i){var y,m,t=s.$implicit,a=s.index,p=e.MAs(6),l=e.oxw(2);e.xp6(5),e.Q6J("pattern",l.fieldNamePattern)("appReservedNames",l.reservedNames)("ngModel",t.StaticName)("name","StaticName"+a)("disabled","inputType"===l.editMode),e.xp6(2),e.Q6J("ngIf",p.touched&&p.errors),e.xp6(5),e.Q6J("ngModel",t.Type)("name","Type"+a)("disabled",null!=l.editMode),e.xp6(3),e.Oqu(l.findIcon(t.Type)),e.xp6(2),e.Oqu(t.Type),e.xp6(1),e.Q6J("ngForOf",l.dataTypes),e.xp6(2),e.Oqu(l.dataTypeHints[a]),e.xp6(5),e.Q6J("ngModel",t.InputType)("name","InputType"+a)("disabled","name"===l.editMode),e.xp6(3),e.Oqu(null==(y=l.getInputTypeOption(t.InputType))?null:y.label),e.xp6(2),e.Oqu(null==(m=l.getInputTypeOption(t.InputType))?null:m.icon),e.xp6(1),e.Q6J("ngForOf",l.filteredInputTypeOptions[a]),e.xp6(2),e.Oqu(l.inputTypeHints[a])}}function xe(i,s){if(1&i){var n=e.EpF();e.TgZ(0,"form",4,5),e.NdJ("ngSubmit",function(){return e.CHM(n),e.oxw().save()}),e.TgZ(2,"div",6),e.YNc(3,Ze,34,20,"div",7),e.qZA(),e.TgZ(4,"div",8),e.TgZ(5,"button",9),e.NdJ("click",function(){return e.CHM(n),e.oxw().closeDialog()}),e._uU(6,"Cancel"),e.qZA(),e.TgZ(7,"button",10),e.ALo(8,"async"),e._uU(9," Save "),e.qZA(),e.qZA(),e.qZA()}if(2&i){var t=e.MAs(1),a=e.oxw();e.xp6(3),e.Q6J("ngForOf",a.fields),e.xp6(4),e.Q6J("disabled",!t.form.valid||e.lcZ(8,2,a.saving$))}}var Oe=function(){var i=function(){function s(n,t,a,p,l){var y=this;(0,r.Z)(this,s),this.dialogRef=n,this.route=t,this.contentTypesService=a,this.contentTypesFieldsService=p,this.snackBar=l,this.hostClass="dialog-component",this.fields=[],this.filteredInputTypeOptions=[],this.dataTypeHints=[],this.inputTypeHints=[],this.fieldNamePattern=V,this.fieldNameError="Standard letters and numbers are allowed. Must start with a letter.",this.findIcon=$.x,this.loading$=new x.X(!0),this.saving$=new x.X(!1),this.subscription=new b.w0,this.dialogRef.disableClose=!0,this.subscription.add(this.dialogRef.backdropClick().subscribe(function(m){y.form.dirty&&!confirm("You have unsaved changes. Are you sure you want to close this dialog?")||y.closeDialog()}))}return(0,C.Z)(s,[{key:"ngOnInit",value:function(){var t=this;this.editMode=this.route.snapshot.paramMap.get("editMode");var a=this.route.snapshot.paramMap.get("contentTypeStaticName"),p=this.contentTypesService.retrieveContentType(a).pipe((0,f.B)()),l=p.pipe((0,T.z)(function(u){return t.contentTypesFieldsService.getFields(u.StaticName)})),y=this.contentTypesFieldsService.typeListRetrieve().pipe((0,_.U)(function(u){return function ne(i){var t,s=[],n=(0,te.Z)(i);try{for(n.s();!(t=n.n()).done;){var a=t.value;s.push({name:a,label:R[a].label,icon:(0,$.x)(a),description:R[a].description})}}catch(p){n.e(p)}finally{n.f()}return s}(u)})),m=this.contentTypesFieldsService.getInputTypesList(),h=this.contentTypesFieldsService.getReservedNames();(0,S.D)([p,l,y,m,h]).subscribe(function(u){var c=(0,A.Z)(u,5),N=c[1],Fe=c[2],Me=c[3],Ne=c[4];t.contentType=c[0],t.dataTypes=Fe,t.inputTypeOptions=Me;var k={};if(N.forEach(function(D){k[D.StaticName]="Field with this name already exists"}),t.reservedNames=Object.assign(Object.assign({},Ne),k),null!=t.editMode){var Ee=t.route.snapshot.paramMap.get("id")?parseInt(t.route.snapshot.paramMap.get("id"),10):null,q=N.find(function(D){return D.Id===Ee});"name"===t.editMode&&delete t.reservedNames[q.StaticName],t.fields.push(q)}else for(var P=1;P<=8;P++)t.fields.push({Id:0,Type:X.Q.String,InputType:Y.v.StringDefault,StaticName:"",IsTitle:0===N.length,SortOrder:N.length+P});for(var E=0;E<t.fields.length;E++)t.filterInputTypeOptions(E),t.calculateHints(E);t.loading$.next(!1)})}},{key:"ngOnDestroy",value:function(){this.loading$.complete(),this.saving$.complete(),this.subscription.unsubscribe()}},{key:"closeDialog",value:function(){this.dialogRef.close()}},{key:"filterInputTypeOptions",value:function(t){var a=this;this.filteredInputTypeOptions[t]=this.inputTypeOptions.filter(function(p){return p.dataType===a.fields[t].Type.toLocaleLowerCase()})}},{key:"resetInputType",value:function(t){var a=this.fields[t].Type.toLocaleLowerCase()+Y.v.DefaultSuffix;this.filteredInputTypeOptions[t].some(function(l){return l.inputType===a})||(a=this.filteredInputTypeOptions[t][0].inputType),this.fields[t].InputType=a}},{key:"calculateHints",value:function(t){var p,l,a=this,y=this.dataTypes.find(function(h){return h.name===a.fields[t].Type}),m=this.inputTypeOptions.find(function(h){return h.inputType===a.fields[t].InputType});this.dataTypeHints[t]=null!==(p=null==y?void 0:y.description)&&void 0!==p?p:"",this.inputTypeHints[t]=(null==m?void 0:m.isObsolete)?"OBSOLETE - ".concat(m.obsoleteMessage):null!==(l=null==m?void 0:m.description)&&void 0!==l?l:""}},{key:"getInputTypeOption",value:function(t){return this.inputTypeOptions.find(function(a){return a.inputType===t})}},{key:"save",value:function(){var t=this;if(this.saving$.next(!0),this.snackBar.open("Saving..."),null!=this.editMode){var a=this.fields[0];"name"===this.editMode?this.contentTypesFieldsService.rename(a.Id,this.contentType.Id,a.StaticName).subscribe(function(){t.saving$.next(!1),t.snackBar.open("Saved",null,{duration:2e3}),t.closeDialog()}):"inputType"===this.editMode&&this.contentTypesFieldsService.updateInputType(a.Id,a.StaticName,a.InputType).subscribe(function(){t.saving$.next(!1),t.snackBar.open("Saved",null,{duration:2e3}),t.closeDialog()})}else O.of.apply(void 0,(0,I.Z)(this.fields)).pipe((0,U.h)(function(p){return!!p.StaticName}),(0,w.b)(function(p){return t.contentTypesFieldsService.add(p,t.contentType.Id).pipe((0,z.K)(function(l){return(0,O.of)(null)}))}),function d(){return(0,F.e)(function(i,s){(function J(i,s){return(0,F.e)((0,H.U)(i,s,arguments.length>=2,!1,!0))})(Q,[])(i).subscribe(s)})}()).subscribe(function(p){t.saving$.next(!1),t.snackBar.open("Saved",null,{duration:2e3}),t.closeDialog()})}}]),s}();return i.\u0275fac=function(n){return new(n||i)(e.Y36(B.so),e.Y36(ie.gz),e.Y36(G.s),e.Y36(ee.Mr),e.Y36(oe.ux))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-edit-content-type-fields"]],viewQuery:function(n,t){var a;1&n&&e.Gf(ce,5,g.F),2&n&&e.iGM(a=e.CRH())&&(t.form=a.first)},hostVars:1,hostBindings:function(n,t){2&n&&e.Ikx("className",t.hostClass)},decls:7,vars:6,consts:[["mat-dialog-title",""],[1,"dialog-title-box"],[4,"ngIf"],["class","dialog-form",3,"ngSubmit",4,"ngIf"],[1,"dialog-form",3,"ngSubmit"],["ngForm","ngForm"],[1,"dialog-form-content","fancy-scrollbar-light"],["class","row-container",4,"ngFor","ngForOf"],[1,"dialog-form-actions"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","submit","color","accent",3,"disabled"],[1,"row-container"],[1,"edit-input"],["appearance","standard","color","accent"],["matInput","",3,"pattern","appReservedNames","ngModel","name","disabled","ngModelChange"],["staticName","ngModel"],[3,"ngModel","name","disabled","selectionChange","ngModelChange"],[1,"type-icon"],[3,"value",4,"ngFor","ngForOf"],[1,"input-icon"],[3,"value","ngClass",4,"ngFor","ngForOf"],[3,"isError",4,"ngIf"],[3,"isError"],[3,"value"],[3,"value","ngClass"],["class","input-icon",4,"ngIf"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.YNc(2,ue,2,0,"ng-container",2),e.YNc(3,fe,2,0,"ng-container",2),e.YNc(4,me,2,0,"ng-container",2),e.qZA(),e.qZA(),e.YNc(5,xe,10,4,"form",3),e.ALo(6,"async")),2&n&&(e.xp6(2),e.Q6J("ngIf",void 0===t.editMode),e.xp6(1),e.Q6J("ngIf",null===t.editMode),e.xp6(1),e.Q6J("ngIf",null!=t.editMode),e.xp6(1),e.Q6J("ngIf",!1===e.lcZ(6,4,t.loading$)))},directives:[B.uh,M.O5,g._Y,g.JL,g.F,M.sg,ae.lW,L.KE,L.hX,se.Nt,g.Fj,g.c5,re,g.JJ,g.On,j.gD,j.$L,le.Hw,pe.Y,de.ey,M.mk],pipes:[M.Ov],styles:[".row-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.edit-input[_ngcontent-%COMP%]{padding-bottom:8px;width:30%}.type-icon[_ngcontent-%COMP%]{width:inherit;height:inherit;margin-right:8px;font-size:inherit;vertical-align:top;line-height:inherit}.input-icon[_ngcontent-%COMP%]{width:inherit;height:inherit;margin-left:8px;font-size:inherit;vertical-align:top;line-height:inherit}.input-obsolete[_ngcontent-%COMP%]{-webkit-text-decoration:black line-through;text-decoration:black line-through;color:#696969}"]}),i}()},3135:function(K,Z,o){o.d(Z,{Y:function(){return Q}});var I=o(8069),A=o(8047),r=o(7133),C=o(6362),g=o(4770);function x(d,f){1&d&&r.GkF(0)}function b(d,f){if(1&d&&(r.TgZ(0,"mat-hint"),r.YNc(1,x,1,0,"ng-container",3),r.qZA()),2&d){r.oxw();var T=r.MAs(4);r.xp6(1),r.Q6J("ngTemplateOutlet",T)}}function S(d,f){1&d&&r.GkF(0)}function O(d,f){if(1&d&&(r.TgZ(0,"mat-error"),r.YNc(1,S,1,0,"ng-container",3),r.qZA()),2&d){r.oxw();var T=r.MAs(4);r.xp6(1),r.Q6J("ngTemplateOutlet",T)}}function H(d,f){1&d&&r.Hsn(0)}var F=function(f){return{"hint-box__short":f}},J=["*"],Q=function(){var d=function(){function f(){(0,I.Z)(this,f),this.isError=!1,this.isShort=!0}return(0,A.Z)(f,[{key:"toggleIsShort",value:function(){this.isShort=!this.isShort}}]),f}();return d.\u0275fac=function(T){return new(T||d)},d.\u0275cmp=r.Xpm({type:d,selectors:[["app-field-hint"]],inputs:{isError:"isError"},ngContentSelectors:J,decls:5,vars:6,consts:[[1,"hint-box",3,"ngClass","ngSwitch","click"],[4,"ngSwitchCase"],["content",""],[4,"ngTemplateOutlet"]],template:function(T,_){1&T&&(r.F$t(),r.TgZ(0,"div",0),r.NdJ("click",function(){return _.toggleIsShort()}),r.YNc(1,b,2,1,"mat-hint",1),r.YNc(2,O,2,1,"mat-error",1),r.qZA(),r.YNc(3,H,1,0,"ng-template",null,2,r.W1O)),2&T&&(r.Q6J("ngClass",r.VKq(4,F,_.isShort))("ngSwitch",_.isError),r.xp6(1),r.Q6J("ngSwitchCase",!1),r.xp6(1),r.Q6J("ngSwitchCase",!0))},directives:[C.mk,C.RF,C.n9,g.bx,C.tP,g.TO],styles:[".hint-box[_ngcontent-%COMP%]{margin-top:4px}.hint-box[_ngcontent-%COMP%]   .mat-hint[_ngcontent-%COMP%], .hint-box[_ngcontent-%COMP%]   .mat-error[_ngcontent-%COMP%]{font-size:12px;display:block}.hint-box__short[_ngcontent-%COMP%]   .mat-hint[_ngcontent-%COMP%], .hint-box__short[_ngcontent-%COMP%]   .mat-error[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]}),d}()}}]);
//# sourceMappingURL=https://sources.2sxc.org/13.01.00/ng-edit/projects_ng-dialogs_src_app_content-type-fields_edit-content-type-fields_edit-content-type-fi-0ac826.57a53fedb2e549b0.js.map