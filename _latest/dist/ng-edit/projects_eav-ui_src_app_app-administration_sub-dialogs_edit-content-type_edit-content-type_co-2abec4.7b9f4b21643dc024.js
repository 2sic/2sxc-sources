"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_app-administration_sub-dialogs_edit-content-type_edit-content-type_co-2abec4"],{8407:(Z,h,o)=>{o.r(h),o.d(h,{EditContentTypeComponent:()=>U});var c=o(34456),u=o(84175),S=o(31403),g=o(81863),p=o(90353),F=o(31016),v=o(93840),f=o(59791),y=o(64043),N=o(12938),M=o(43758),C=o(5858),b=o(50052),j=o(39333),x=o(34601),k=o(34435),d=o(67993);const T=/(^[A-Za-z][A-Za-z0-9]*$)|(^@[A-Za-z][A-Za-z0-9\-]*$)/.toString(),I=T.substring(1,T.toString().length-1);var G=o(17693),t=o(99293),s=o(44444),X=o(29658),$=o(3347),m=o(87698),O=o(23731),B=o(88622);function V(a,r){1&a&&(t.j41(0,"app-field-hint",19),t.EFF(1,"This field is required"),t.k0s()),2&a&&t.Y8G("isError",!0)}function A(a,r){if(1&a&&(t.j41(0,"app-field-hint",19),t.EFF(1),t.k0s()),2&a){const n=t.XpG(3);t.Y8G("isError",!0),t.R7$(),t.JRh(n.contentTypeNameError)}}function D(a,r){if(1&a&&(t.nVh(0,V,2,1,"app-field-hint",19),t.nVh(1,A,2,2,"app-field-hint",19)),2&a){t.XpG();const n=t.sdS(9);t.vxM(n.errors.required?0:-1),t.R7$(),t.vxM(n.errors.pattern?1:-1)}}function Y(a,r){if(1&a&&(t.j41(0,"mat-option",12),t.EFF(1),t.k0s()),2&a){const n=r.$implicit;t.Y8G("value",n.value),t.R7$(),t.SpI(" ",n.name," ")}}function z(a,r){if(1&a&&(t.j41(0,"div",7)(1,"h3"),t.EFF(2,"Shared Content Type (Ghost)"),t.k0s(),t.j41(3,"p"),t.EFF(4,"Note: this can't be edited in the UI, for now if you really know what you're doing, do it in the DB"),t.k0s(),t.j41(5,"p"),t.EFF(6),t.k0s()()),2&a){const n=t.XpG(2);t.R7$(6),t.SpI("Uses Type Definition of: ",n.contentType().SharedDefId)}}function P(a,r){if(1&a){const n=t.RV6();t.j41(0,"form",5,0),t.bIt("ngSubmit",function(){s.eBV(n);const e=t.XpG();return s.Njj(e.save())}),t.j41(2,"div",6)(3,"div")(4,"div",7)(5,"mat-form-field",8)(6,"mat-label"),t.EFF(7,"Name"),t.k0s(),t.j41(8,"input",9,1),t.bIt("ngModelChange",function(e){s.eBV(n);const l=t.XpG();return s.Njj(l.changeContentTypeName(e))}),t.k0s()(),t.nVh(10,D,2,2),t.k0s(),t.j41(11,"mat-accordion")(12,"mat-expansion-panel")(13,"mat-expansion-panel-header")(14,"mat-panel-title"),t.EFF(15,"Advanced"),t.k0s(),t.nrm(16,"mat-panel-description"),t.k0s(),t.j41(17,"div",7)(18,"div",10)(19,"mat-form-field",8)(20,"mat-label"),t.EFF(21,"Scope"),t.k0s(),t.j41(22,"mat-select",11),t.bIt("ngModelChange",function(e){s.eBV(n);const l=t.XpG();return s.Njj(l.changeScope(e))}),t.Z7z(23,Y,2,2,"mat-option",12,t.fX1),t.j41(25,"mat-option",12),t.EFF(26,"Other..."),t.k0s()()(),t.j41(27,"button",13),t.bIt("click",function(){s.eBV(n);const e=t.XpG();return s.Njj(e.unlockScope())}),t.j41(28,"mat-icon"),t.EFF(29),t.k0s()()(),t.j41(30,"app-field-hint"),t.EFF(31," The scope should almost never be changed - "),t.j41(32,"a",14),t.EFF(33,"see help"),t.k0s()()(),t.j41(34,"div",7)(35,"mat-form-field",8)(36,"mat-label"),t.EFF(37,"Static Name"),t.k0s(),t.nrm(38,"input",15),t.k0s()(),t.nVh(39,z,7,1,"div",7),t.k0s()()()(),t.j41(40,"mat-dialog-actions",16)(41,"button",17),t.bIt("click",function(){s.eBV(n);const e=t.XpG();return s.Njj(e.closeDialog())}),t.EFF(42,"Cancel"),t.k0s(),t.j41(43,"button",18),t.EFF(44,"Save"),t.k0s()()()}if(2&a){const n=t.sdS(1),i=t.sdS(9),e=t.XpG();t.R7$(8),t.Y8G("pattern",e.contentTypeNamePattern)("ngModel",e.contentType().Name),t.R7$(2),t.vxM(i.touched&&i.errors?10:-1),t.R7$(),t.Y8G("@.disabled",e.disableAnimation()),t.R7$(11),t.Y8G("ngModel",e.contentType().Scope)("disabled",e.lockScope()),t.R7$(),t.Dyx(e.scopeOptions()),t.R7$(2),t.Y8G("value",e.dropdownInsertValue),t.R7$(2),t.Y8G("tippy",e.lockScope()?"Unlock":"Lock"),t.R7$(2),t.SpI(" ",e.lockScope()?"lock":"lock_open"," "),t.R7$(9),t.Y8G("ngModel",e.contentType().NameId),t.R7$(),t.vxM(e.contentType().SharedDefId?39:-1),t.R7$(4),t.Y8G("disabled",!n.form.valid||e.loading())}}let U=(()=>{class a{#n;#t;#e;constructor(n,i,e){this.dialog=n,this.route=i,this.snackBar=e,this.log=(0,k.Tq)({EditContentTypeComponent:a}),this.hostClass="dialog-component",this.#n=(0,N.d)(G.g),this.#t=this.route.snapshot.parent.paramMap.get("scope"),this.#e=this.route.snapshot.paramMap.get("contentTypeStaticName"),this.contentTypeNamePattern=I,this.contentTypeNameError="Standard letters and numbers are allowed. Must start with a letter.",this.dropdownInsertValue=C.O,this.modeIsEdit=!!this.#e,this.lockScope=(0,d.KX)("lockScope",!0),this.disableAnimation=(0,d.KX)("disableAnimation",!0),this.loading=(0,d.KX)("loading",!1),this.contentType=(0,d.KX)("contentType",{StaticName:"",Name:"",Description:"",Scope:this.#t,ChangeNameId:!1,NewNameId:""}),this.#i=this.#n.getScopesSig(),this.#o=(0,d.KX)("scopeOptionsManual",[]),this.scopeOptions=(0,d.bo)("scopeOptions",()=>{const l=this.#i(),E=this.#o();return l?E.concat(this.#s(l)):E}),this.log.a("constructor"),this.#a()}#a(){this.modeIsEdit&&this.#n.retrieveContentType(this.#e).subscribe(n=>{this.contentType.set({...n,ChangeNameId:!1,NewNameId:n.NameId})})}#i;#o;#s(n){const i=[];return n.forEach(e=>{i.some(l=>l.value===e.value)||i.push(e)}),i.some(e=>e.value===this.#t)||i.push({name:this.#t,value:this.#t}),i}ngAfterViewInit(){setTimeout(()=>this.disableAnimation.set(!1))}closeDialog(){this.dialog.close()}changeContentTypeName(n){this.contentType.set({...this.contentType(),Name:n})}changeScope(n){n===C.O&&(n=prompt("This is an advanced feature to show content-types of another scope. Don't use this if you don't know what you're doing, as content-types of other scopes are usually hidden for a good reason.")||b.YX.scopes.default.value,this.scopeOptions().some(i=>i.value===n)||this.#o.set([{name:n,value:n},...this.scopeOptions()])),this.contentType.set({...this.contentType(),Scope:n})}unlockScope(){this.lockScope.set(!this.lockScope()),this.lockScope()&&this.contentType.set({...this.contentType(),Scope:this.#t})}save(){this.loading.set(!0),this.snackBar.open("Saving..."),this.#n.save(this.contentType()).subscribe(n=>{this.loading.set(!1),this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()}),document.activeElement instanceof HTMLElement&&document.activeElement.blur()}static#c=this.\u0275fac=function(i){return new(i||a)(t.rXU(g.k),t.rXU(X.nX),t.rXU($.UG))};static#l=this.\u0275cmp=t.VBU({type:a,selectors:[["app-edit-content-type"]],hostVars:1,hostBindings:function(i,e){2&i&&t.Avn("className",e.hostClass)},decls:5,vars:2,consts:[["ngForm","ngForm"],["name","ngModel"],[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[3,"ngSubmit"],[1,"eav-dialog-content"],[1,"eav-edit-input"],["color","accent",1,"eav-mat-form-field"],["matInput","","type","text","required","","name","Name",3,"ngModelChange","pattern","ngModel"],[1,"eav-form-and-button"],["name","Scope",3,"ngModelChange","ngModel","disabled"],[3,"value"],["mat-icon-button","","type","button","matTextSuffix","",1,"eav-scope-button",3,"click","tippy"],["href","https://2sxc.org/help?tag=scope","target","_blank","appClickStopPropagation",""],["matInput","","type","text","name","StaticName","disabled","",3,"ngModel"],["align","end"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","submit","color","accent",3,"disabled"],[3,"isError"]],template:function(i,e){1&i&&(t.j41(0,"div",2)(1,"div",3)(2,"div",4),t.EFF(3),t.k0s()(),t.nVh(4,P,45,12,"form"),t.k0s()),2&i&&(t.R7$(3),t.JRh(e.modeIsEdit?"Edit Content Type":"New Content Type"),t.R7$(),t.vxM(e.contentType()?4:-1))},dependencies:[c.YN,c.qT,c.me,c.BC,c.cb,c.YS,c.R_,c.vS,c.cV,F.M,m.j,m.M,m.g,f.fS,f.fg,p.MY,p.BS,p.GK,p.Z2,p.WN,p.Q6,y.M,y.g,O.M,S.M,u.Hl,u.$z,B.M,v.m_,v.An,g.M,M.F,j.c,x.e],styles:[".eav-edit-input[_ngcontent-%COMP%]{padding-bottom:8px}.eav-form-and-button[_ngcontent-%COMP%]{display:flex;align-items:baseline;justify-content:space-between}.eav-form-and-button[_ngcontent-%COMP%]   .eav-scope-button[_ngcontent-%COMP%]{margin-left:8px}"]})}return a})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/20.00.00/dist/ng-edit/projects_eav-ui_src_app_app-administration_sub-dialogs_edit-content-type_edit-content-type_co-2abec4.7b9f4b21643dc024.js.map