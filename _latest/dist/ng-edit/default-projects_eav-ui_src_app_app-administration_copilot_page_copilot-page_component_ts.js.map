{"version":3,"file":"default-projects_eav-ui_src_app_app-administration_copilot_page_copilot-page_component_ts.js","mappings":"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","sources":["./projects/eav-ui/src/app/app-administration/copilot/copilot-generator.component.ts","./projects/eav-ui/src/app/app-administration/copilot/copilot-generator.component.html","./projects/eav-ui/src/app/app-administration/copilot/copilot-service.ts","./projects/eav-ui/src/app/app-administration/copilot/page/copilot-page.component.ts","./projects/eav-ui/src/app/app-administration/copilot/page/copilot-page.component.html"],"sourcesContent":["import { CommonModule } from '@angular/common';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Component, input } from '@angular/core';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatCardModule } from '@angular/material/card';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatSelectModule } from '@angular/material/select';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { map, take } from 'rxjs';\r\nimport { transient } from '../../../../../core';\r\nimport { RichResult } from '../../shared/models/rich-result';\r\nimport { Context } from '../../shared/services/context';\r\nimport { CopilotService } from './copilot-service';\r\n\r\n@Component({\r\n    selector: 'app-copilot-generator',\r\n    templateUrl: './copilot-generator.component.html',\r\n    imports: [\r\n        MatSelectModule,\r\n        MatButtonModule,\r\n        MatCardModule,\r\n        MatIconModule,\r\n        CommonModule,\r\n    ]\r\n})\r\nexport class CopilotGeneratorComponent {\r\n\r\n  outputType = input<string>();\r\n  title? = input<string>('Copilot Generator');\r\n  private copilotSvc = transient(CopilotService);\r\n\r\n  webApiGeneratedCode: string = 'admin/code/generateDataModels';\r\n  editions$ = this.copilotSvc.getEditions();\r\n\r\n  generators$ = this.copilotSvc.getGenerators()\r\n    .pipe(\r\n      map((gens) => gens.filter(g => g.outputType === this.outputType()))\r\n    );\r\n\r\n  selectedGenerator$ = this.generators$.pipe(map(gens => gens.find(g => g.name === this.selectedGenerator)));\r\n\r\n  selectedGenerator = '';\r\n  selectedEdition = '';\r\n\r\n  constructor(\r\n    private http: HttpClient,\r\n    private context: Context,\r\n    private snackBar: MatSnackBar,\r\n  ) { }\r\n\r\n  ngOnInit(): void {\r\n    this.generators$.pipe(take(1)).subscribe(gens => {\r\n      this.selectedGenerator = gens[0]?.name ?? '';\r\n    });\r\n    this.copilotSvc.specs.pipe(take(1)).subscribe(specs => {\r\n      // this.selectedGenerator = specs.generators[0]?.name ?? '';\r\n      this.selectedEdition = specs.editions.find(e => e.isDefault)?.name ?? '';\r\n    });\r\n  }\r\n\r\n  autoGeneratedCode() {\r\n    this.http.get<RichResult>(this.webApiGeneratedCode, {\r\n      params: {\r\n        appId: this.context.appId.toString(),\r\n        edition: this.selectedEdition,\r\n        generator: this.selectedGenerator,\r\n      }\r\n    }).subscribe(d => {\r\n      console.log(d);\r\n      this.snackBar.open(d.message + `\\n (this took ${d.timeTaken}ms)`, null, { duration: 5000, });\r\n    });\r\n  }\r\n\r\n}\r\n","<div class=\"eav-cards-box\">\r\n  <mat-card class=\"eav-card\">\r\n    <mat-card-header class=\"eav-card-header\">\r\n      <mat-card-title>{{ title() }}</mat-card-title>\r\n      <mat-icon>support_agent</mat-icon>\r\n    </mat-card-header>\r\n    <mat-card-content>\r\n\r\n      <br>\r\n      <!-- Generator select -->\r\n      @if (generators$ | async; as generators) {\r\n        <mat-form-field color=\"accent\" class=\"eav-mat-form-field\">\r\n          <mat-label>Generator</mat-label>\r\n          <mat-select required [(value)]=\"selectedGenerator\">\r\n            <mat-select-trigger>\r\n              {{ selectedGenerator }}\r\n            </mat-select-trigger>\r\n              @for (generator of generators.sort() ; track generator) {\r\n                <mat-option [value]=\"generator.name\">\r\n                  <strong>{{ generator.name }} v{{ generator.version }}</strong><br>\r\n                  {{ generator.description }}\r\n                </mat-option>\r\n              }\r\n          </mat-select>\r\n          @if (selectedGenerator$ | async; as selectedGenerator) {\r\n            <mat-hint [innerHTML]=\"selectedGenerator.descriptionHtml\"></mat-hint>\r\n          }\r\n        </mat-form-field>\r\n        <br>\r\n      }\r\n\r\n      <br>\r\n      <!-- Edition select -->\r\n      @if (editions$ | async; as editions) {\r\n        <mat-form-field color=\"accent\" class=\"eav-mat-form-field\">\r\n          <mat-label>Select an Edition to generate code for</mat-label>\r\n          <mat-select required [(value)]=\"selectedEdition\">\r\n              @for (edition of editions.sort() ; track edition) {\r\n                <mat-option [value]=\"edition.name\">\r\n                  <strong>{{ edition.label }}</strong> ({{ edition.description }})\r\n                </mat-option>\r\n              }\r\n          </mat-select>\r\n          <mat-hint>\r\n            Editions are managed in the <code>/App_Data/app.json</code> file.\r\n            See <a href=\"https://go.2sxc.org/app-json\" target=\"_blank\">docs</a>.\r\n          </mat-hint>\r\n        </mat-form-field>\r\n      }\r\n\r\n    </mat-card-content>\r\n    <div class=\"eav-card-space-div\"></div>\r\n    <mat-card-actions align=\"end\">\r\n      <button mat-button class=\"eav-button__with-icon\" (click)=\"autoGeneratedCode()\">\r\n        <mat-icon class=\"eav-icon\">code</mat-icon>\r\n        <span>Generate Code</span>\r\n      </button>\r\n    </mat-card-actions>\r\n  </mat-card>\r\n</div>\r\n","import { Injectable } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Context } from '../../shared/services/context';\r\nimport { EditionData, EditionDataDto } from './edition-data';\r\nimport { map, shareReplay } from 'rxjs';\r\nimport { Edition, EditionDto } from './edition';\r\nimport { classLog } from '../../shared/logging';\r\n\r\n@Injectable()\r\nexport class CopilotService {\r\n  \r\n  log = classLog({CopilotService});\r\n\r\n  static webApiEditions: string = 'admin/code/getEditions';\r\n  static webApiGeneratedCode: string = 'admin/code/generateDataModels';\r\n\r\n  public specs = this.#getCopilotSpecs();\r\n\r\n  constructor(private http: HttpClient, private context: Context) { }\r\n\r\n  getEditions() {\r\n    return this.specs.pipe(map(data => data.editions));\r\n  }\r\n\r\n  getDefaultEdition() {\r\n    return this.specs.pipe(map(data => data.editions.find(e => e.isDefault)));\r\n  }\r\n\r\n  getGenerators() {\r\n    return this.specs.pipe(map(data => data.generators));\r\n  }\r\n\r\n  #getCopilotSpecs() {\r\n    return this.http.get<EditionDataDto>(CopilotService.webApiEditions, {\r\n      params: {\r\n        appId: this.context.appId.toString()\r\n      }\r\n    }).pipe(\r\n      map((data) => {\r\n        const defaultOrFirst = this.#findDefaultEdition(data.editions);\r\n        const editions = data.editions.map(d => {\r\n          const isDefault = d == defaultOrFirst;\r\n          return {\r\n            ...d,\r\n            isDefault,\r\n            description: (d.description || \"no description provided\") + (isDefault ? ' ✅' : ''),\r\n            label: `/${d.name}/AppCode/Data`.replace(/\\/\\//g, '/'),\r\n          } as Edition;\r\n        });\r\n\r\n        return { ...data, editions } as EditionData;\r\n      }),\r\n      shareReplay(1),\r\n    );\r\n  }\r\n\r\n  #findDefaultEdition(editions: EditionDto[]): EditionDto {\r\n    return editions.find(d => d.isDefault) ?? editions.find(d => d.name === '') ?? editions[0];\r\n  }\r\n\r\n}","import { Component } from '@angular/core';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { CopilotSpec } from '../copilot-specs';\r\nimport { CopilotGeneratorComponent } from '../copilot-generator.component';\r\n\r\n@Component({\r\n    selector: 'app-data-copilot',\r\n    templateUrl: './copilot-page.component.html',\r\n    styleUrl: './copilot-page.component.scss',\r\n    imports: [\r\n        CopilotGeneratorComponent\r\n    ]\r\n})\r\nexport class CopilotPageComponent {\r\n\r\n  data: CopilotSpec;\r\n\r\n  constructor(activatedRoute: ActivatedRoute) {\r\n    this.data = activatedRoute.snapshot.data as CopilotSpec;\r\n  }\r\n\r\n}\r\n","<div class=\"outer-container\">\r\n  <h1>{{data.heading}}</h1>\r\n  <p>\r\n    {{data.intro}}\r\n  </p>\r\n</div>\r\n\r\n<app-copilot-generator [outputType]=\"data.outputType\" [title]=\"data.title\"></app-copilot-generator>\r\n"],"names":["CommonModule","HttpClient","input","MatButtonModule","MatCardModule","MatIconModule","MatSelectModule","MatSnackBar","map","take","transient","Context","CopilotService","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵelement","ɵɵproperty","generator_r3","name","ɵɵadvance","ɵɵtextInterpolate2","version","ɵɵtextInterpolate1","description","ctx","descriptionHtml","ɵɵsanitizeHtml","ɵɵtwoWayListener","CopilotGeneratorComponent_Conditional_9_Template_mat_select_valueChange_3_listener","$event","ɵɵrestoreView","_r1","ctx_r1","ɵɵnextContext","ɵɵtwoWayBindingSet","selectedGenerator","ɵɵresetView","ɵɵrepeaterCreate","CopilotGeneratorComponent_Conditional_9_For_7_Template","ɵɵrepeaterTrackByIdentity","ɵɵtemplate","CopilotGeneratorComponent_Conditional_9_Conditional_8_Template","ɵɵtwoWayProperty","ɵɵrepeater","sort","ɵɵconditional","tmp_5_0","ɵɵpipeBind1","selectedGenerator$","edition_r5","ɵɵtextInterpolate","label","CopilotGeneratorComponent_Conditional_12_Template_mat_select_valueChange_3_listener","_r4","selectedEdition","CopilotGeneratorComponent_Conditional_12_For_5_Template","CopilotGeneratorComponent","constructor","http","context","snackBar","outputType","title","copilotSvc","webApiGeneratedCode","editions$","getEditions","generators$","getGenerators","pipe","gens","filter","g","find","ngOnInit","subscribe","specs","editions","e","isDefault","autoGeneratedCode","get","params","appId","toString","edition","generator","d","console","log","open","message","timeTaken","duration","ɵɵdirectiveInject","i1","i2","i3","selectors","inputs","decls","vars","consts","template","CopilotGeneratorComponent_Template","rf","CopilotGeneratorComponent_Conditional_9_Template","CopilotGeneratorComponent_Conditional_12_Template","ɵɵlistener","CopilotGeneratorComponent_Template_button_click_16_listener","tmp_1_0","tmp_2_0","i4","MatFormField","MatLabel","MatHint","i5","MatSelect","MatSelectTrigger","i6","MatOption","i7","MatButton","i8","MatCard","MatCardActions","MatCardContent","MatCardHeader","MatCardTitle","i9","MatIcon","i10","AsyncPipe","encapsulation","shareReplay","classLog","webApiEditions","getCopilotSpecs","data","getDefaultEdition","generators","#getCopilotSpecs","_a","defaultOrFirst","findDefaultEdition","replace","#findDefaultEdition","ɵɵinject","factory","ɵfac","ActivatedRoute","CopilotPageComponent","activatedRoute","snapshot","CopilotPageComponent_Template","heading","intro","styles"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}