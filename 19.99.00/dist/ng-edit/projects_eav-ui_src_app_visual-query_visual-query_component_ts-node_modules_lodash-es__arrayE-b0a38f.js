"use strict";
(self["webpackChunkeav_ui"] = self["webpackChunkeav_ui"] || []).push([["projects_eav-ui_src_app_visual-query_visual-query_component_ts-node_modules_lodash-es__arrayE-b0a38f"],{

/***/ 2628:
/*!*******************************************************************************!*\
  !*** ./projects/eav-ui/src/app/visual-query/services/visual-query.service.ts ***!
  \*******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   VisualQueryStateService: () => (/* binding */ VisualQueryStateService)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @angular/core */ 37580);
/* harmony import */ var _angular_platform_browser__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @angular/platform-browser */ 80436);
/* harmony import */ var lodash_es_cloneDeep__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! lodash-es/cloneDeep */ 85237);
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! rxjs */ 10819);
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! rxjs */ 18537);
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! rxjs */ 51567);
/* harmony import */ var _app_administration_services_content_types_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../app-administration/services/content-types.service */ 17693);
/* harmony import */ var _permissions_services_metadata_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../permissions/services/metadata.service */ 80401);
/* harmony import */ var _shared_constants_eav_constants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../shared/constants/eav.constants */ 50052);
/* harmony import */ var _shared_helpers_url_prep_helper__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../shared/helpers/url-prep.helper */ 43216);
/* harmony import */ var _shared_models_edit_form_model__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../shared/models/edit-form.model */ 70334);
/* harmony import */ var _query_definition_service__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./query-definition.service */ 55871);
/* harmony import */ var _core__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../../core */ 88692);
/* harmony import */ var _edit_dialog_main_keyboard_shortcuts__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../edit/dialog/main/keyboard-shortcuts */ 32760);
/* harmony import */ var _shared_helpers_json_helpers__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../shared/helpers/json.helpers */ 4038);
/* harmony import */ var _shared_routing_dialog_routing_service__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../shared/routing/dialog-routing.service */ 60852);
/* harmony import */ var _shared_services_service_base__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../shared/services/service-base */ 4979);
/* harmony import */ var _plumb_editor_datasource_helpers__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../plumb-editor/datasource.helpers */ 9480);
/* harmony import */ var _query_result_query_result_component__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../query-result/query-result.component */ 60453);
/* harmony import */ var _stream_error_result_stream_error_result_component__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../stream-error-result/stream-error-result.component */ 34955);
/* harmony import */ var _angular_material_snack_bar__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! @angular/material/snack-bar */ 3347);
/* harmony import */ var _angular_material_dialog__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! @angular/material/dialog */ 12587);












// tslint:disable-next-line:max-line-length











/**
 * Service containing the state for the visual query.
 * It's shared, so should not be used with transient(...);
 */
class VisualQueryStateService extends _shared_services_service_base__WEBPACK_IMPORTED_MODULE_10__.ServiceBase {
  #contentTypesSvc;
  #metadataSvc;
  #queryDefSvc;
  #dialogRoute;
  #titleSvc;
  #pipelineId;
  #refreshPipeline;
  #refreshDataSourceConfigs;
  constructor(snackBar, matDialog, viewContainerRef, zone, changeDetectorRef) {
    super();
    this.snackBar = snackBar;
    this.matDialog = matDialog;
    this.viewContainerRef = viewContainerRef;
    this.zone = zone;
    this.changeDetectorRef = changeDetectorRef;
    this.#contentTypesSvc = (0,_core__WEBPACK_IMPORTED_MODULE_6__.transient)(_app_administration_services_content_types_service__WEBPACK_IMPORTED_MODULE_0__.ContentTypesService);
    this.#metadataSvc = (0,_core__WEBPACK_IMPORTED_MODULE_6__.transient)(_permissions_services_metadata_service__WEBPACK_IMPORTED_MODULE_1__.MetadataService);
    this.#queryDefSvc = (0,_core__WEBPACK_IMPORTED_MODULE_6__.transient)(_query_definition_service__WEBPACK_IMPORTED_MODULE_5__.QueryDefinitionService);
    this.#dialogRoute = (0,_core__WEBPACK_IMPORTED_MODULE_6__.transient)(_shared_routing_dialog_routing_service__WEBPACK_IMPORTED_MODULE_9__.DialogRoutingService);
    this.#titleSvc = (0,_core__WEBPACK_IMPORTED_MODULE_6__.transient)(_angular_platform_browser__WEBPACK_IMPORTED_MODULE_14__.Title);
    this.pipelineModel = (0,_angular_core__WEBPACK_IMPORTED_MODULE_15__.signal)(null);
    this.dataSources = (0,_angular_core__WEBPACK_IMPORTED_MODULE_15__.signal)(null);
    this.dataSourceConfigs = (0,_angular_core__WEBPACK_IMPORTED_MODULE_15__.signal)({});
    this.putEntityCountOnConnections$ = new rxjs__WEBPACK_IMPORTED_MODULE_16__.Subject();
    this.#pipelineId = parseInt(this.#dialogRoute.getParam('pipelineId'), 10);
    this.#refreshPipeline = false;
    this.#refreshDataSourceConfigs = false;
  }
  ngOnDestroy() {
    this.putEntityCountOnConnections$.complete();
    super.ngOnDestroy();
  }
  init() {
    this.#fetchDataSources(() => this.#fetchPipeline(true, true, false));
    this.#attachKeyboardSave();
    this.#dialogRoute.doOnDialogClosed(() => {
      if (this.#refreshPipeline || this.#refreshDataSourceConfigs) this.#fetchPipeline(this.#refreshPipeline, this.#refreshDataSourceConfigs, this.#refreshPipeline);
      this.#refreshPipeline = false;
      this.#refreshDataSourceConfigs = false;
    });
  }
  editPipelineEntity() {
    // save Pipeline, then open Edit Dialog
    this.#savePipeline(() => {
      const form = {
        items: [_shared_models_edit_form_model__WEBPACK_IMPORTED_MODULE_4__.EditPrep.editId(this.pipelineModel().Pipeline.EntityId)]
      };
      const formUrl = (0,_shared_helpers_url_prep_helper__WEBPACK_IMPORTED_MODULE_3__.convertFormToUrl)(form);
      this.#dialogRoute.navRelative([`edit/${formUrl}`]);
      this.#refreshPipeline = true;
    });
  }
  saveAndRun(save, run) {
    if (save && run) return this.#savePipeline(() => this.runPipeline());
    if (save) return this.#savePipeline();
    if (run) return this.runPipeline();
  }
  showDataSourceDetails(showDetails) {
    const query = (0,lodash_es_cloneDeep__WEBPACK_IMPORTED_MODULE_17__["default"])(this.pipelineModel());
    const designerData = _shared_helpers_json_helpers__WEBPACK_IMPORTED_MODULE_8__.JsonHelpers.tryParse(query.Pipeline.VisualDesignerData) ?? {};
    designerData.ShowDataSourceDetails = showDetails;
    query.Pipeline.VisualDesignerData = JSON.stringify(designerData);
    this.pipelineModel.set(query);
  }
  addDataSource(dataSource) {
    const query = (0,lodash_es_cloneDeep__WEBPACK_IMPORTED_MODULE_17__["default"])(this.pipelineModel());
    const newSource = {
      Description: '',
      EntityGuid: 'unsaved' + (query.DataSources.length + 1),
      EntityId: undefined,
      Name: dataSource.Name,
      PartAssemblyAndType: dataSource.PartAssemblyAndType,
      VisualDesignerData: {
        Top: 100,
        Left: 100
      }
    };
    query.DataSources.push(newSource);
    this.pipelineModel.set(query);
    this.#savePipeline();
  }
  removeDataSource(pipelineDataSourceGuid, connections, streamsOut) {
    const query = (0,lodash_es_cloneDeep__WEBPACK_IMPORTED_MODULE_17__["default"])(this.pipelineModel());
    query.DataSources = query.DataSources.filter(pipelineDS => pipelineDS.EntityGuid !== pipelineDataSourceGuid);
    query.Pipeline.StreamWiring = connections;
    query.Pipeline.StreamsOut = streamsOut;
    this.pipelineModel.set(query);
  }
  renameDataSource(pipelineDataSourceGuid, name) {
    const query = (0,lodash_es_cloneDeep__WEBPACK_IMPORTED_MODULE_17__["default"])(this.pipelineModel());
    const dataSource = query.DataSources.find(pipelineDS => pipelineDS.EntityGuid === pipelineDataSourceGuid);
    dataSource.Name = name;
    this.pipelineModel.set(query);
  }
  changeDataSourceDescription(pipelineDataSourceGuid, description) {
    const query = (0,lodash_es_cloneDeep__WEBPACK_IMPORTED_MODULE_17__["default"])(this.pipelineModel());
    const dataSource = query.DataSources.find(pipelineDS => pipelineDS.EntityGuid === pipelineDataSourceGuid);
    dataSource.Description = description;
    this.pipelineModel.set(query);
  }
  changeConnections(connections, streamsOut) {
    const query = (0,lodash_es_cloneDeep__WEBPACK_IMPORTED_MODULE_17__["default"])(this.pipelineModel());
    query.Pipeline.StreamWiring = connections;
    query.Pipeline.StreamsOut = streamsOut;
    this.pipelineModel.set(query);
  }
  changeDataSourcePosition(pipelineDataSourceGuid, position) {
    const query = (0,lodash_es_cloneDeep__WEBPACK_IMPORTED_MODULE_17__["default"])(this.pipelineModel());
    const dataSource = query.DataSources.find(pipelineDS => pipelineDS.EntityGuid === pipelineDataSourceGuid);
    if (!dataSource) {
      // spm NOTE: fixes problem where dataSource position can't be updated if dataSource with guid unsavedXX gets saved while dragging.
      // Can happen if dataSource is just added and user drags it and save happens.
      return;
    }
    dataSource.VisualDesignerData = {
      ...dataSource.VisualDesignerData,
      ...position
    };
    this.pipelineModel.set(query);
  }
  #calculateDataSourceConfigs(dataSources) {
    const dataSourceConfigs = {};
    dataSources.forEach(dataSource => {
      if (dataSource.EntityId == null) return;
      dataSourceConfigs[dataSource.EntityId] = [];
      dataSource.Metadata?.forEach(metadataItem => {
        Object.entries(metadataItem).forEach(([attributeName, attributeValue]) => {
          if (attributeValue == null || attributeValue === '') return;
          if (['Created', 'Guid', 'Id', 'Modified', 'Title', '_Type'].includes(attributeName)) return;
          if (Array.isArray(attributeValue) && attributeValue[0]?.Title !== null && attributeValue[0]?.Id !== null) {
            attributeValue = `${attributeValue[0].Title} (${attributeValue[0].Id})`;
          }
          const dataSourceConfig = {
            name: attributeName,
            value: attributeValue
          };
          dataSourceConfigs[dataSource.EntityId].push(dataSourceConfig);
        });
      });
    });
    this.dataSourceConfigs.set(dataSourceConfigs);
  }
  editDataSource(pipelineDataSource) {
    const dataSource = (0,_plumb_editor_datasource_helpers__WEBPACK_IMPORTED_MODULE_11__.findDefByType)(this.dataSources(), pipelineDataSource.PartAssemblyAndType);
    const contentTypeName = dataSource.ContentType;
    const {
      targetType,
      keyType
    } = _shared_constants_eav_constants__WEBPACK_IMPORTED_MODULE_2__.eavConstants.metadata.entity;
    const key = pipelineDataSource.EntityGuid;
    // query for existing Entity
    this.#metadataSvc.getMetadata(targetType, keyType, key, contentTypeName).subscribe(metadata => {
      // edit existing Entity
      if (metadata.Items.length) {
        const form = {
          items: [_shared_models_edit_form_model__WEBPACK_IMPORTED_MODULE_4__.EditPrep.editId(metadata.Items[0].Id)]
        };
        const formUrl = (0,_shared_helpers_url_prep_helper__WEBPACK_IMPORTED_MODULE_3__.convertFormToUrl)(form);
        this.#dialogRoute.navRelative([`edit/${formUrl}`]);
        this.#refreshDataSourceConfigs = true;
        return;
      }
      // Check if the type exists, and if yes, create new Entity
      this.#contentTypesSvc.retrieveContentType(contentTypeName).subscribe({
        next: contentType => {
          if (contentType == null) {
            this.snackBar.open('DataSource doesn\'t have any configuration', undefined, {
              duration: 3000
            });
            return;
          }
          const form = {
            items: [_shared_models_edit_form_model__WEBPACK_IMPORTED_MODULE_4__.EditPrep.newMetadata(key, contentTypeName, _shared_constants_eav_constants__WEBPACK_IMPORTED_MODULE_2__.eavConstants.metadata.entity)]
          };
          const formUrl = (0,_shared_helpers_url_prep_helper__WEBPACK_IMPORTED_MODULE_3__.convertFormToUrl)(form);
          this.#dialogRoute.navRelative([`edit/${formUrl}`]);
          this.#refreshDataSourceConfigs = true;
        },
        error: error => {
          const message = 'Server reports error - this usually means that this DataSource doesn\'t have any configuration';
          this.snackBar.open(message, undefined, {
            duration: 3000
          });
        }
      });
    });
  }
  #savePipeline(callback) {
    this.snackBar.open('Saving...');
    this.#queryDefSvc.savePipeline(this.pipelineModel()).subscribe({
      next: pipelineModel => {
        this.snackBar.open('Saved', null, {
          duration: 2000
        });
        this.pipelineModel.set(pipelineModel);
        if (callback != null) {
          callback();
        }
      },
      error: error => {
        this.snackBar.open('Save Pipeline failed', null, {
          duration: 2000
        });
      }
    });
  }
  runPipeline(top = 25) {
    this.snackBar.open('Running query...');
    this.#queryDefSvc.runPipeline(this.pipelineModel().Pipeline.EntityId, top).subscribe({
      next: pipelineResult => {
        this.snackBar.open('Query worked', null, {
          duration: 2000
        });
        this.queryResult = pipelineResult;
        this.#showQueryResult(pipelineResult, top);
        console.warn(pipelineResult);
        // push cloned pipelineModel to reset jsPlumb
        this.pipelineModel.set((0,lodash_es_cloneDeep__WEBPACK_IMPORTED_MODULE_17__["default"])(this.pipelineModel()));
        setTimeout(() => {
          this.putEntityCountOnConnections$.next(pipelineResult);
        });
      },
      error: error => {
        this.snackBar.open('Query failed', null, {
          duration: 2000
        });
      }
    });
  }
  debugStream(stream, top = 25) {
    if (stream.Error) return this.#showStreamErrorResult(stream);
    if (stream.Count === 0) return;
    this.snackBar.open('Running stream...');
    const pipelineId = this.pipelineModel().Pipeline.EntityId;
    this.#queryDefSvc.debugStream(pipelineId, stream.Source, stream.SourceOut, top).subscribe({
      next: streamResult => {
        this.snackBar.open('Stream worked', null, {
          duration: 2000
        });
        const pipelineDataSource = this.pipelineModel().DataSources.find(ds => ds.EntityGuid === stream.Source);
        const debugStream = {
          name: stream.SourceOut,
          source: stream.Source,
          sourceName: pipelineDataSource.Name,
          original: stream
        };
        this.#showQueryResult(streamResult, top, debugStream);
        console.warn(streamResult);
      },
      error: _ => {
        this.snackBar.open('Stream failed', null, {
          duration: 2000
        });
      }
    });
  }
  #fetchPipeline(refreshPipeline, refreshDataSourceConfigs, showSnackBar) {
    if (showSnackBar) this.snackBar.open('Reloading query, please wait...');
    this.#queryDefSvc.fetchPipeline(this.#pipelineId, this.dataSources()).subscribe(pipelineModel => {
      if (showSnackBar) this.snackBar.open('Query reloaded', null, {
        duration: 2000
      });
      this.#titleSvc.setTitle(`${pipelineModel.Pipeline.Name} - Visual Query`);
      if (refreshPipeline) this.pipelineModel.set(pipelineModel);
      if (refreshDataSourceConfigs) this.#calculateDataSourceConfigs(pipelineModel.DataSources);
    });
  }
  #showQueryResult(result, top, debugStream) {
    const dialogData = {
      result,
      debugStream,
      top
    };
    this.matDialog.open(_query_result_query_result_component__WEBPACK_IMPORTED_MODULE_12__.QueryResultComponent, {
      autoFocus: false,
      backdropClass: 'dialog-backdrop',
      closeOnNavigation: false,
      data: dialogData,
      panelClass: ['dialog-panel', `dialog-panel-medium`, 'no-scrollbar'],
      // spm NOTE: position used to force align-items: flex-start; on cdk-global-overlay-wrapper.
      // Real top margin is overwritten in css e.g. dialog-panel-large
      position: {
        top: '0'
      },
      viewContainerRef: this.viewContainerRef
    });
    this.changeDetectorRef.markForCheck();
  }
  #showStreamErrorResult(stream) {
    const dialogData = {
      errorData: stream.ErrorData
    };
    this.matDialog.open(_stream_error_result_stream_error_result_component__WEBPACK_IMPORTED_MODULE_13__.StreamErrorResultComponent, {
      autoFocus: false,
      backdropClass: 'dialog-backdrop',
      closeOnNavigation: false,
      data: dialogData,
      panelClass: ['dialog-panel', `dialog-panel-medium`, 'no-scrollbar'],
      // spm NOTE: position used to force align-items: flex-start; on cdk-global-overlay-wrapper.
      // Real top margin is overwritten in css e.g. dialog-panel-large
      position: {
        top: '0'
      },
      viewContainerRef: this.viewContainerRef
    });
    this.changeDetectorRef.markForCheck();
  }
  #fetchDataSources(callback) {
    this.#queryDefSvc.fetchDataSources().subscribe(dataSources => {
      this.dataSources.set(dataSources);
      callback();
    });
  }
  #attachKeyboardSave() {
    this.zone.runOutsideAngular(() => {
      this.subscriptions.add((0,rxjs__WEBPACK_IMPORTED_MODULE_18__.fromEvent)(window, 'keydown').pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_19__.filter)(() => !this.#dialogRoute.snapshot.firstChild), (0,rxjs__WEBPACK_IMPORTED_MODULE_19__.filter)(event => (0,_edit_dialog_main_keyboard_shortcuts__WEBPACK_IMPORTED_MODULE_7__.isCtrlS)(event))).subscribe(event => {
        event.preventDefault();
        this.zone.run(() => {
          this.#savePipeline();
        });
      }));
    });
  }
  static {
    this.ɵfac = function VisualQueryStateService_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || VisualQueryStateService)(_angular_core__WEBPACK_IMPORTED_MODULE_15__["ɵɵinject"](_angular_material_snack_bar__WEBPACK_IMPORTED_MODULE_20__.MatSnackBar), _angular_core__WEBPACK_IMPORTED_MODULE_15__["ɵɵinject"](_angular_material_dialog__WEBPACK_IMPORTED_MODULE_21__.MatDialog), _angular_core__WEBPACK_IMPORTED_MODULE_15__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_15__.ViewContainerRef), _angular_core__WEBPACK_IMPORTED_MODULE_15__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_15__.NgZone), _angular_core__WEBPACK_IMPORTED_MODULE_15__["ɵɵinject"](_angular_core__WEBPACK_IMPORTED_MODULE_15__.ChangeDetectorRef));
    };
  }
  static {
    this.ɵprov = /*@__PURE__*/_angular_core__WEBPACK_IMPORTED_MODULE_15__["ɵɵdefineInjectable"]({
      token: VisualQueryStateService,
      factory: VisualQueryStateService.ɵfac
    });
  }
}

/***/ }),

/***/ 4981:
/*!*****************************************************************!*\
  !*** ./projects/eav-ui/src/app/shared/helpers/array.helpers.ts ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ArrayHelpers: () => (/* binding */ ArrayHelpers)
/* harmony export */ });
class ArrayHelpers {
  /**
   * Toggles an item in an array. If the item is not in the array, it is added. If it is in the array, it is removed.
   * @param item The item to toggle
   * @param array The array to toggle the item in
   */
  static toggleInArray(item, array) {
    const index = array.indexOf(item);
    if (index === -1) {
      array.push(item);
    } else {
      array.splice(index, 1);
    }
    return array;
  }
}
// function onlyUnique<T extends unknown>(value: T, index: number, array: T[]): boolean {
//   return array.indexOf(value) === index;
// }

/***/ }),

/***/ 9480:
/*!*********************************************************************************!*\
  !*** ./projects/eav-ui/src/app/visual-query/plumb-editor/datasource.helpers.ts ***!
  \*********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   findDefByType: () => (/* binding */ findDefByType),
/* harmony export */   getEndpointLabel: () => (/* binding */ getEndpointLabel)
/* harmony export */ });
function findDefByType(dataSources, partAssemblyAndType) {
  return dataSources.find(ds => ds.PartAssemblyAndType === partAssemblyAndType);
}
function getEndpointLabel(endpoint) {
  return endpoint.getOverlay('endpointLabel').label;
}

/***/ }),

/***/ 11878:
/*!****************************************************!*\
  !*** ./node_modules/lodash-es/_baseAssignValue.js ***!
  \****************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _defineProperty_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./_defineProperty.js */ 17797);


/**
 * The base implementation of `assignValue` and `assignMergeValue` without
 * value checks.
 *
 * @private
 * @param {Object} object The object to modify.
 * @param {string} key The key of the property to assign.
 * @param {*} value The value to assign.
 */
function baseAssignValue(object, key, value) {
  if (key == '__proto__' && _defineProperty_js__WEBPACK_IMPORTED_MODULE_0__["default"]) {
    (0,_defineProperty_js__WEBPACK_IMPORTED_MODULE_0__["default"])(object, key, {
      'configurable': true,
      'enumerable': true,
      'value': value,
      'writable': true
    });
  } else {
    object[key] = value;
  }
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (baseAssignValue);

/***/ }),

/***/ 12710:
/*!****************************************************************************************************!*\
  !*** ./projects/eav-ui/src/app/visual-query/plumb-editor/rename-stream/rename-stream.component.ts ***!
  \****************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   RenameStreamComponent: () => (/* binding */ RenameStreamComponent)
/* harmony export */ });
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! @angular/common */ 60316);
/* harmony import */ var _angular_forms__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @angular/forms */ 34456);
/* harmony import */ var _angular_material_button__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @angular/material/button */ 84175);
/* harmony import */ var _angular_material_core__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! @angular/material/core */ 74646);
/* harmony import */ var _angular_material_dialog__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @angular/material/dialog */ 12587);
/* harmony import */ var _angular_material_form_field__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @angular/material/form-field */ 24950);
/* harmony import */ var _angular_material_icon__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @angular/material/icon */ 93840);
/* harmony import */ var _angular_material_input__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @angular/material/input */ 95541);
/* harmony import */ var _angular_material_select__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @angular/material/select */ 25175);
/* harmony import */ var _angular_material_slide_toggle__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! @angular/material/slide-toggle */ 8827);
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! rxjs */ 63037);
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! rxjs */ 91817);
/* harmony import */ var _core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../../core */ 88692);
/* harmony import */ var _app_administration_services__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../app-administration/services */ 75445);
/* harmony import */ var _shared_components_base_component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../shared/components/base.component */ 43176);
/* harmony import */ var _shared_components_field_hint_field_hint_component__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../shared/components/field-hint/field-hint.component */ 43758);
/* harmony import */ var _shared_constants_eav_constants__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../shared/constants/eav.constants */ 50052);
/* harmony import */ var _shared_directives_click_stop_propagation_directive__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../shared/directives/click-stop-propagation.directive */ 39333);
/* harmony import */ var _services_visual_query_service__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../services/visual-query.service */ 2628);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @angular/core */ 37580);






























const _c0 = a0 => ({
  "active": a0
});
function RenameStreamComponent_Conditional_9_Conditional_4_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](0, "app-field-hint");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](1, " You will get suggestions for out-streams after you run query ");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]();
  }
}
function RenameStreamComponent_Conditional_9_Conditional_5_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](0, "app-field-hint", 12);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](1, " This field is required ");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]();
  }
  if (rf & 2) {
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵproperty"]("isError", true);
  }
}
function RenameStreamComponent_Conditional_9_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](0, "mat-form-field", 10)(1, "mat-label");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](2, "Label");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelement"](3, "input", 11);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtemplate"](4, RenameStreamComponent_Conditional_9_Conditional_4_Template, 2, 0, "app-field-hint")(5, RenameStreamComponent_Conditional_9_Conditional_5_Template, 2, 1, "app-field-hint", 12);
  }
  if (rf & 2) {
    const ctx_r0 = _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵnextContext"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵadvance"](4);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵconditional"](ctx_r0.isSource && !ctx_r0.pipelineResultExists ? 4 : -1);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵadvance"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵconditional"](ctx_r0.controls.label.touched && (ctx_r0.controls.label.errors == null ? null : ctx_r0.controls.label.errors.required) ? 5 : -1);
  }
}
function RenameStreamComponent_Conditional_10_Conditional_0_For_5_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](0, "mat-option", 19);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]();
  }
  if (rf & 2) {
    const scopeOption_r3 = ctx.$implicit;
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵproperty"]("value", scopeOption_r3.value);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵadvance"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtextInterpolate1"](" ", scopeOption_r3.name, " ");
  }
}
function RenameStreamComponent_Conditional_10_Conditional_0_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](0, "mat-form-field", 10)(1, "mat-label");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](2, "Scope");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](3, "mat-select", 18);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵrepeaterCreate"](4, RenameStreamComponent_Conditional_10_Conditional_0_For_5_Template, 2, 2, "mat-option", 19, _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵrepeaterTrackByIdentity"]);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]()();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](6, "app-field-hint");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](7, " The scope should almost never be changed - ");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](8, "a", 20);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](9, "see help");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]()();
  }
  if (rf & 2) {
    const ctx_r0 = _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵnextContext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵadvance"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵproperty"]("placeholder", !ctx_r0.scopeOptions.length ? "No items found" : "");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵadvance"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵrepeater"](ctx_r0.scopeOptions);
  }
}
function RenameStreamComponent_Conditional_10_Conditional_4_For_2_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](0, "mat-option", 19);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]();
  }
  if (rf & 2) {
    const labelOption_r4 = ctx.$implicit;
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵproperty"]("value", labelOption_r4);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵadvance"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtextInterpolate1"](" ", labelOption_r4, " ");
  }
}
function RenameStreamComponent_Conditional_10_Conditional_4_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](0, "mat-select", 13);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵrepeaterCreate"](1, RenameStreamComponent_Conditional_10_Conditional_4_For_2_Template, 2, 2, "mat-option", 19, _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵrepeaterTrackByIdentity"]);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]();
  }
  if (rf & 2) {
    const ctx_r0 = _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵnextContext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵproperty"]("placeholder", !ctx_r0.labelOptions.length ? "No items found" : "");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵadvance"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵrepeater"](ctx_r0.labelOptions);
  }
}
function RenameStreamComponent_Conditional_10_Conditional_5_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelement"](0, "input", 11);
  }
}
function RenameStreamComponent_Conditional_10_Conditional_13_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](0, "app-field-hint", 12);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](1, " This field is required ");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]();
  }
  if (rf & 2) {
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵproperty"]("isError", true);
  }
}
function RenameStreamComponent_Conditional_10_Template(rf, ctx) {
  if (rf & 1) {
    const _r2 = _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtemplate"](0, RenameStreamComponent_Conditional_10_Conditional_0_Template, 10, 1);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](1, "mat-form-field", 10)(2, "mat-label");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](3, "Label");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtemplate"](4, RenameStreamComponent_Conditional_10_Conditional_4_Template, 3, 1, "mat-select", 13)(5, RenameStreamComponent_Conditional_10_Conditional_5_Template, 1, 0, "input", 11);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](6, "div", 14)(7, "button", 15);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵlistener"]("click", function RenameStreamComponent_Conditional_10_Template_button_click_7_listener() {
      _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵrestoreView"](_r2);
      const ctx_r0 = _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵnextContext"]();
      return _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵresetView"](ctx_r0.toggleGuidedLabel(true));
    });
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](8, "mat-icon", 16);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](9, "search");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]()();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](10, "button", 17);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵlistener"]("click", function RenameStreamComponent_Conditional_10_Template_button_click_10_listener() {
      _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵrestoreView"](_r2);
      const ctx_r0 = _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵnextContext"]();
      return _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵresetView"](ctx_r0.toggleGuidedLabel(false));
    });
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](11, "mat-icon", 16);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](12, "text_fields");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]()()()();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtemplate"](13, RenameStreamComponent_Conditional_10_Conditional_13_Template, 2, 1, "app-field-hint", 12);
  }
  if (rf & 2) {
    const ctx_r0 = _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵnextContext"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵconditional"](ctx_r0.advancedMode && ctx_r0.guidedLabel ? 0 : -1);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵadvance"](4);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵconditional"](ctx_r0.guidedLabel ? 4 : -1);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵadvance"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵconditional"](!ctx_r0.guidedLabel ? 5 : -1);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵproperty"]("ngClass", _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵpureFunction1"](6, _c0, ctx_r0.guidedLabel));
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵadvance"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵproperty"]("ngClass", _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵpureFunction1"](8, _c0, !ctx_r0.guidedLabel));
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵadvance"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵconditional"](ctx_r0.controls.label.touched && (ctx_r0.controls.label.errors == null ? null : ctx_r0.controls.label.errors.required) ? 13 : -1);
  }
}
function RenameStreamComponent_Conditional_13_Template(rf, ctx) {
  if (rf & 1) {
    const _r5 = _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](0, "mat-slide-toggle", 21);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵlistener"]("change", function RenameStreamComponent_Conditional_13_Template_mat_slide_toggle_change_0_listener($event) {
      _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵrestoreView"](_r5);
      const ctx_r0 = _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵnextContext"]();
      return _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵresetView"](ctx_r0.toggleAdvancedMode($event));
    });
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]();
  }
  if (rf & 2) {
    const ctx_r0 = _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵnextContext"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵproperty"]("checked", ctx_r0.advancedMode);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵadvance"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtextInterpolate1"](" ", ctx_r0.advancedMode ? "Advanced" : "Simple", " ");
  }
}
class RenameStreamComponent extends _shared_components_base_component__WEBPACK_IMPORTED_MODULE_2__.BaseComponent {
  #contentTypesSvc;
  constructor(dialogData, dialog, visualQueryService, changeDetectorRef) {
    super();
    this.dialogData = dialogData;
    this.dialog = dialog;
    this.visualQueryService = visualQueryService;
    this.changeDetectorRef = changeDetectorRef;
    this.hostClass = 'dialog-component';
    this.isSource = this.dialogData.isSource;
    this.pipelineResultExists = this.visualQueryService.queryResult != null;
    this.scopeOptions = [];
    this.labelOptions = [];
    this.guidedLabel = true;
    this.advancedMode = false;
    this.#contentTypesSvc = (0,_core__WEBPACK_IMPORTED_MODULE_0__.transient)(_app_administration_services__WEBPACK_IMPORTED_MODULE_1__.ContentTypesService);
  }
  ngOnInit() {
    this.#buildForm();
  }
  closeDialog(label) {
    this.dialog.close(label);
  }
  toggleGuidedLabel(guidedLabel) {
    this.guidedLabel = guidedLabel;
  }
  toggleAdvancedMode(event) {
    this.advancedMode = event.checked;
  }
  rename() {
    const formValue = this.form.getRawValue();
    this.closeDialog(formValue.label);
  }
  #buildForm() {
    this.form = new _angular_forms__WEBPACK_IMPORTED_MODULE_8__.UntypedFormGroup({
      label: new _angular_forms__WEBPACK_IMPORTED_MODULE_8__.UntypedFormControl(this.dialogData.label, _angular_forms__WEBPACK_IMPORTED_MODULE_8__.Validators.required),
      scope: new _angular_forms__WEBPACK_IMPORTED_MODULE_8__.UntypedFormControl(_shared_constants_eav_constants__WEBPACK_IMPORTED_MODULE_4__.eavConstants.scopes.default.value)
    });
    this.controls = this.form.controls;
    if (!this.isSource || !this.pipelineResultExists) return;
    this.subscriptions.add(this.controls.scope.valueChanges.pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_9__.startWith)(this.controls.scope.value), (0,rxjs__WEBPACK_IMPORTED_MODULE_10__.distinctUntilChanged)()).subscribe(scope => {
      this.labelOptions = Object.values(this.visualQueryService.queryResult.Sources).find(source => source.Guid === this.dialogData.pipelineDataSourceGuid).Out.filter(out => out.Scope === scope).map(out => out.Name);
      if (!this.labelOptions.includes(this.controls.label.value) && this.controls.label.value != null) this.controls.label.patchValue(null);
    }));
    this.#contentTypesSvc.getScopes().subscribe(scopes => {
      const sourceOut = Object.values(this.visualQueryService.queryResult.Sources).find(source => source.Guid === this.dialogData.pipelineDataSourceGuid).Out;
      const filtered = scopes.filter(s => sourceOut.some(o => o.Scope === s.value));
      this.scopeOptions = filtered;
      this.changeDetectorRef.markForCheck();
    });
  }
  static {
    this.ɵfac = function RenameStreamComponent_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || RenameStreamComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵdirectiveInject"](_angular_material_dialog__WEBPACK_IMPORTED_MODULE_11__.MAT_DIALOG_DATA), _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵdirectiveInject"](_angular_material_dialog__WEBPACK_IMPORTED_MODULE_11__.MatDialogRef), _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵdirectiveInject"](_services_visual_query_service__WEBPACK_IMPORTED_MODULE_6__.VisualQueryStateService), _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵdirectiveInject"](_angular_core__WEBPACK_IMPORTED_MODULE_7__.ChangeDetectorRef));
    };
  }
  static {
    this.ɵcmp = /*@__PURE__*/_angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵdefineComponent"]({
      type: RenameStreamComponent,
      selectors: [["app-rename-stream"]],
      hostVars: 1,
      hostBindings: function RenameStreamComponent_HostBindings(rf, ctx) {
        if (rf & 2) {
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵhostProperty"]("className", ctx.hostClass);
        }
      },
      features: [_angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵInheritDefinitionFeature"]],
      decls: 19,
      vars: 5,
      consts: [[1, "eav-dialog"], [1, "eav-dialog-header"], [1, "eav-dialog-header__title"], ["mat-icon-button", "", "tippy", "Close dialog", 3, "click"], [1, "eav-dialog-content"], [3, "formGroup"], [1, "eav-dialog-actions"], ["color", "accent", 3, "checked"], ["mat-raised-button", "", "type", "button", 3, "click"], ["mat-raised-button", "", "type", "button", "color", "accent", 3, "click", "disabled"], ["color", "accent", 1, "eav-mat-form-field"], ["matInput", "", "type", "text", "formControlName", "label", "required", ""], [3, "isError"], ["formControlName", "label", "required", "", 3, "placeholder"], ["matTextSuffix", "", 1, "eav-selection-suffix"], ["mat-icon-button", "", "type", "button", "tippy", "Pick existing value", 1, "eav-selection-suffix-button", 3, "click", "ngClass"], [1, "eav-icon"], ["mat-icon-button", "", "type", "button", "tippy", "Manual entry", 1, "eav-selection-suffix-button", 3, "click", "ngClass"], ["formControlName", "scope", 3, "placeholder"], [3, "value"], ["href", "https://2sxc.org/help?tag=scope", "target", "_blank", "appClickStopPropagation", ""], ["color", "accent", 3, "change", "checked"]],
      template: function RenameStreamComponent_Template(rf, ctx) {
        if (rf & 1) {
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](0, "div", 0)(1, "div", 1)(2, "div", 2);
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](3, "Rename stream");
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]();
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](4, "button", 3);
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵlistener"]("click", function RenameStreamComponent_Template_button_click_4_listener() {
            return ctx.closeDialog();
          });
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](5, "mat-icon");
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](6, "close");
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]()()();
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](7, "div", 4)(8, "form", 5);
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtemplate"](9, RenameStreamComponent_Conditional_9_Template, 6, 2)(10, RenameStreamComponent_Conditional_10_Template, 14, 10);
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]()();
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](11, "mat-dialog-actions", 6)(12, "div");
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtemplate"](13, RenameStreamComponent_Conditional_13_Template, 2, 2, "mat-slide-toggle", 7);
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]();
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](14, "div")(15, "button", 8);
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵlistener"]("click", function RenameStreamComponent_Template_button_click_15_listener() {
            return ctx.closeDialog();
          });
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](16, "Cancel");
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]();
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](17, "button", 9);
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵlistener"]("click", function RenameStreamComponent_Template_button_click_17_listener() {
            return ctx.rename();
          });
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](18, " Rename ");
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]()()()();
        }
        if (rf & 2) {
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵadvance"](8);
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵproperty"]("formGroup", ctx.form);
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵadvance"]();
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵconditional"](!ctx.isSource || !ctx.pipelineResultExists ? 9 : -1);
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵadvance"]();
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵconditional"](ctx.isSource && ctx.pipelineResultExists ? 10 : -1);
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵadvance"](3);
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵconditional"](ctx.isSource && ctx.pipelineResultExists ? 13 : -1);
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵadvance"](4);
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵproperty"]("disabled", !ctx.form.valid);
        }
      },
      dependencies: [_angular_material_button__WEBPACK_IMPORTED_MODULE_12__.MatButtonModule, _angular_material_button__WEBPACK_IMPORTED_MODULE_12__.MatButton, _angular_material_button__WEBPACK_IMPORTED_MODULE_12__.MatIconButton, _angular_material_icon__WEBPACK_IMPORTED_MODULE_13__.MatIconModule, _angular_material_icon__WEBPACK_IMPORTED_MODULE_13__.MatIcon, _angular_forms__WEBPACK_IMPORTED_MODULE_8__.FormsModule, _angular_forms__WEBPACK_IMPORTED_MODULE_8__["ɵNgNoValidate"], _angular_forms__WEBPACK_IMPORTED_MODULE_8__.DefaultValueAccessor, _angular_forms__WEBPACK_IMPORTED_MODULE_8__.NgControlStatus, _angular_forms__WEBPACK_IMPORTED_MODULE_8__.NgControlStatusGroup, _angular_forms__WEBPACK_IMPORTED_MODULE_8__.RequiredValidator, _angular_forms__WEBPACK_IMPORTED_MODULE_8__.ReactiveFormsModule, _angular_forms__WEBPACK_IMPORTED_MODULE_8__.FormGroupDirective, _angular_forms__WEBPACK_IMPORTED_MODULE_8__.FormControlName, _angular_material_form_field__WEBPACK_IMPORTED_MODULE_14__.MatFormFieldModule, _angular_material_form_field__WEBPACK_IMPORTED_MODULE_14__.MatFormField, _angular_material_form_field__WEBPACK_IMPORTED_MODULE_14__.MatLabel, _angular_material_form_field__WEBPACK_IMPORTED_MODULE_14__.MatSuffix, _angular_material_input__WEBPACK_IMPORTED_MODULE_15__.MatInputModule, _angular_material_input__WEBPACK_IMPORTED_MODULE_15__.MatInput, _angular_material_select__WEBPACK_IMPORTED_MODULE_16__.MatSelectModule, _angular_material_select__WEBPACK_IMPORTED_MODULE_16__.MatSelect, _angular_material_core__WEBPACK_IMPORTED_MODULE_17__.MatOption, _angular_material_core__WEBPACK_IMPORTED_MODULE_17__.MatOptionModule, _angular_common__WEBPACK_IMPORTED_MODULE_18__.NgClass, _angular_material_dialog__WEBPACK_IMPORTED_MODULE_11__.MatDialogActions, _angular_material_slide_toggle__WEBPACK_IMPORTED_MODULE_19__.MatSlideToggleModule, _angular_material_slide_toggle__WEBPACK_IMPORTED_MODULE_19__.MatSlideToggle, _shared_components_field_hint_field_hint_component__WEBPACK_IMPORTED_MODULE_3__.FieldHintComponent, _shared_directives_click_stop_propagation_directive__WEBPACK_IMPORTED_MODULE_5__.ClickStopPropagationDirective],
      encapsulation: 2
    });
  }
}

/***/ }),

/***/ 17797:
/*!***************************************************!*\
  !*** ./node_modules/lodash-es/_defineProperty.js ***!
  \***************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _getNative_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./_getNative.js */ 74740);

var defineProperty = function () {
  try {
    var func = (0,_getNative_js__WEBPACK_IMPORTED_MODULE_0__["default"])(Object, 'defineProperty');
    func({}, '', {});
    return func;
  } catch (e) {}
}();
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (defineProperty);

/***/ }),

/***/ 19727:
/*!***********************************************************************************!*\
  !*** ./projects/eav-ui/src/app/visual-query/plumb-editor/plumb-editor.helpers.ts ***!
  \***********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   calculateTypeInfos: () => (/* binding */ calculateTypeInfos),
/* harmony export */   guiTypes: () => (/* binding */ guiTypes)
/* harmony export */ });
/* harmony import */ var _datasource_helpers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./datasource.helpers */ 9480);

const guiTypes = {
  App: {
    Name: 'App',
    Label: 'App DataSources',
    Icon: 'star',
    UiHint: 'DataSources from the current App'
  },
  Cache: {
    Name: 'Cache',
    Icon: 'history',
    UiHint: 'Caching of data'
  },
  Filter: {
    Name: 'Filter',
    Icon: 'filter_list',
    UiHint: 'Filter data - usually returning less items than came in'
  },
  Logic: {
    Name: 'Logic',
    Icon: 'share',
    UiHint: 'Logic operations - usually choosing between different streams'
  },
  Lookup: {
    Name: 'Lookup',
    Icon: 'search',
    UiHint: 'Lookup operation - usually looking for other data based on a criteria'
  },
  Modify: {
    Name: 'Modify',
    Icon: 'edit_attributes',
    UiHint: 'Modify data - usually changing, adding or removing values'
  },
  Security: {
    Name: 'Security',
    Icon: 'account_circle',
    UiHint: 'Security - usually limit what the user sees based on his identity'
  },
  Sort: {
    Name: 'Sort',
    Icon: 'sort',
    UiHint: 'Sort the items'
  },
  Source: {
    Name: 'Source',
    Icon: 'cloud_upload',
    UiHint: 'Source of new data - usually SQL, CSV or similar'
  },
  Target: {
    Name: 'Target',
    Icon: 'adjust',
    UiHint: 'Target - usually just a destination of data'
  },
  Unknown: {
    Name: 'Unknown',
    Icon: 'fiber_manual_record',
    UiHint: 'Unknown type'
  },
  Debug: {
    Name: 'Debug',
    Icon: 'bug_report',
    UiHint: 'Debugging Tools'
  },
  System: {
    Name: 'System',
    Icon: 'military_tech',
    UiHint: 'System Data'
  }
};
function calculateTypeInfos(pipelineDataSources, dataSources) {
  const typeInfos = {};
  for (const pipelineDataSource of pipelineDataSources) {
    const ds = (0,_datasource_helpers__WEBPACK_IMPORTED_MODULE_0__.findDefByType)(dataSources, pipelineDataSource.PartAssemblyAndType);
    const typeInfo = ds ? {
      ...(ds.PrimaryType ? guiTypes[ds.PrimaryType] : guiTypes.Unknown),
      DynamicIn: ds.DynamicIn ?? false,
      DynamicOut: ds.OutMode != 'static',
      Icon: ds.Icon,
      UiHint: ds.UiHint,
      HelpLink: ds.HelpLink,
      outMode: ds.OutMode,
      // ...(ds.Icon ? { Icon: ds.Icon } : {}),
      // ...(ds.UiHint ? { UiHint: ds.UiHint } : {}),
      // ...(ds.OutMode != null ? { OutMode: ds.OutMode } : {}),
      // ...(ds.HelpLink != null ? { HelpLink: ds.HelpLink } : {}),
      ...(ds.EnableConfig != null ? {
        EnableConfig: ds.EnableConfig
      } : {})
    } : {
      ...guiTypes.Unknown,
      DynamicOut: false,
      DynamicIn: false,
      outMode: 'static'
    };
    // console.log("2dm test", pipelineDataSource, ds, typeInfo);
    typeInfos[pipelineDataSource.EntityGuid] = typeInfo;
  }
  return typeInfos;
}

/***/ }),

/***/ 23840:
/*!*******************************************************************************************!*\
  !*** ./projects/eav-ui/src/app/shared/directives/mousedown-stop-propagation.directive.ts ***!
  \*******************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   MousedownStopPropagationDirective: () => (/* binding */ MousedownStopPropagationDirective)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 37580);

class MousedownStopPropagationDirective {
  onMousedown(event) {
    event.stopPropagation();
  }
  static {
    this.ɵfac = function MousedownStopPropagationDirective_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || MousedownStopPropagationDirective)();
    };
  }
  static {
    this.ɵdir = /*@__PURE__*/_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefineDirective"]({
      type: MousedownStopPropagationDirective,
      selectors: [["", "appMousedownStopPropagation", ""]],
      hostBindings: function MousedownStopPropagationDirective_HostBindings(rf, ctx) {
        if (rf & 1) {
          _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵlistener"]("mousedown", function MousedownStopPropagationDirective_mousedown_HostBindingHandler($event) {
            return ctx.onMousedown($event);
          });
        }
      }
    });
  }
}

/***/ }),

/***/ 30555:
/*!*************************************************************************************!*\
  !*** ./projects/eav-ui/src/app/visual-query/run-explorer/run-explorer.component.ts ***!
  \*************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   RunExplorerComponent: () => (/* binding */ RunExplorerComponent)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @angular/core */ 37580);
/* harmony import */ var _angular_material_button__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @angular/material/button */ 84175);
/* harmony import */ var _angular_material_icon__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @angular/material/icon */ 93840);
/* harmony import */ var _angular_material_slide_toggle__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @angular/material/slide-toggle */ 8827);
/* harmony import */ var _core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../core */ 88692);
/* harmony import */ var _dev_rest__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../dev-rest */ 13488);
/* harmony import */ var _shared_helpers_json_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../shared/helpers/json.helpers */ 4038);
/* harmony import */ var _shared_routing_dialog_routing_service__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../shared/routing/dialog-routing.service */ 60852);
/* harmony import */ var _shared_services_context__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../shared/services/context */ 68873);
/* harmony import */ var _services_visual_query_service__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../services/visual-query.service */ 2628);
/* harmony import */ var _run_explorer_helpers__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./run-explorer.helpers */ 78465);

















function RunExplorerComponent_Conditional_0_Conditional_20_For_2_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](0, "li");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]();
  }
  if (rf & 2) {
    const param_r3 = ctx.$implicit;
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵadvance"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtextInterpolate1"](" ", param_r3, " ");
  }
}
function RunExplorerComponent_Conditional_0_Conditional_20_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](0, "ul", 9);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵrepeaterCreate"](1, RunExplorerComponent_Conditional_0_Conditional_20_For_2_Template, 2, 1, "li", null, _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵrepeaterTrackByIdentity"]);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]();
  }
  if (rf & 2) {
    let tmp_2_0;
    const ctx_r1 = _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵnextContext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵadvance"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵrepeater"]((tmp_2_0 = ctx_r1.vsSvc.pipelineModel().Pipeline.Params) == null ? null : tmp_2_0.split("\n"));
  }
}
function RunExplorerComponent_Conditional_0_Conditional_24_For_2_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](0, "li");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]();
  }
  if (rf & 2) {
    const param_r4 = ctx.$implicit;
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵadvance"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtextInterpolate1"](" ", param_r4, " ");
  }
}
function RunExplorerComponent_Conditional_0_Conditional_24_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](0, "ul", 9);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵrepeaterCreate"](1, RunExplorerComponent_Conditional_0_Conditional_24_For_2_Template, 2, 1, "li", null, _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵrepeaterTrackByIdentity"]);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]();
  }
  if (rf & 2) {
    let tmp_2_0;
    const ctx_r1 = _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵnextContext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵadvance"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵrepeater"]((tmp_2_0 = ctx_r1.vsSvc.pipelineModel().Pipeline.TestParameters) == null ? null : tmp_2_0.split("\n"));
  }
}
function RunExplorerComponent_Conditional_0_Conditional_25_Template(rf, ctx) {
  if (rf & 1) {
    const _r5 = _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](0, "div", 5)(1, "span", 12);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](2, "Show DataSource Params");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](3, "mat-slide-toggle", 13);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵlistener"]("change", function RunExplorerComponent_Conditional_0_Conditional_25_Template_mat_slide_toggle_change_3_listener($event) {
      _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵrestoreView"](_r5);
      const ctx_r1 = _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵnextContext"](2);
      return _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵresetView"](ctx_r1.showDataSourceDetails($event));
    });
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]()();
  }
  if (rf & 2) {
    const ctx_r1 = _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵnextContext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵadvance"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵproperty"]("checked", ctx_r1.visualDesignerDataSig().ShowDataSourceDetails);
  }
}
function RunExplorerComponent_Conditional_0_Conditional_26_Conditional_0_For_8_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelement"](0, "li", 16);
  }
  if (rf & 2) {
    const warning_r6 = ctx.$implicit;
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵproperty"]("innerHTML", warning_r6, _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵsanitizeHtml"]);
  }
}
function RunExplorerComponent_Conditional_0_Conditional_26_Conditional_0_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](0, "div", 14)(1, "div", 6)(2, "span");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](3, "Warnings");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](4, "mat-icon", 15);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](5, "warning");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]()();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](6, "ol", 9);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵrepeaterCreate"](7, RunExplorerComponent_Conditional_0_Conditional_26_Conditional_0_For_8_Template, 1, 1, "li", 16, _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵrepeaterTrackByIdentity"]);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]()();
  }
  if (rf & 2) {
    const ctx_r1 = _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵnextContext"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵadvance"](7);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵrepeater"](ctx_r1.warningSig());
  }
}
function RunExplorerComponent_Conditional_0_Conditional_26_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtemplate"](0, RunExplorerComponent_Conditional_0_Conditional_26_Conditional_0_Template, 9, 0, "div", 14);
  }
  if (rf & 2) {
    const ctx_r1 = _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵnextContext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵconditional"](ctx_r1.warningSig().length ? 0 : -1);
  }
}
function RunExplorerComponent_Conditional_0_Conditional_27_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](0, "div", 10)(1, "div", 6);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](2, "Query Description");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](3, "div");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](4);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]()();
  }
  if (rf & 2) {
    const ctx_r1 = _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵnextContext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵadvance"](4);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtextInterpolate"](ctx_r1.vsSvc.pipelineModel().Pipeline.Description);
  }
}
function RunExplorerComponent_Conditional_0_Template(rf, ctx) {
  if (rf & 1) {
    const _r1 = _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](0, "div", 0)(1, "div", 1)(2, "div", 2)(3, "button", 3);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵlistener"]("click", function RunExplorerComponent_Conditional_0_Template_button_click_3_listener() {
      _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵrestoreView"](_r1);
      const ctx_r1 = _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵnextContext"]();
      return _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵresetView"](ctx_r1.saveAndRunQuery(true, true));
    });
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](4, "Save and run");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](5, "button", 4);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵlistener"]("click", function RunExplorerComponent_Conditional_0_Template_button_click_5_listener() {
      _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵrestoreView"](_r1);
      const ctx_r1 = _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵnextContext"]();
      return _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵresetView"](ctx_r1.saveAndRunQuery(false, true));
    });
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](6, "Run");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](7, "button", 4);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵlistener"]("click", function RunExplorerComponent_Conditional_0_Template_button_click_7_listener() {
      _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵrestoreView"](_r1);
      const ctx_r1 = _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵnextContext"]();
      return _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵresetView"](ctx_r1.saveAndRunQuery(true, false));
    });
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](8, "Save");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]()();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](9, "div", 5)(10, "div", 6)(11, "div");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](12, "Query Parameters");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](13, "div")(14, "button", 7);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵlistener"]("click", function RunExplorerComponent_Conditional_0_Template_button_click_14_listener() {
      _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵrestoreView"](_r1);
      const ctx_r1 = _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵnextContext"]();
      return _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵresetView"](ctx_r1.editPipeline());
    });
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](15, "mat-icon");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](16, "edit");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]()();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](17, "button", 8);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵlistener"]("click", function RunExplorerComponent_Conditional_0_Template_button_click_17_listener() {
      _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵrestoreView"](_r1);
      const ctx_r1 = _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵnextContext"]();
      return _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵresetView"](ctx_r1.openParamsHelp());
    });
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](18, "mat-icon");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](19, "info");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]()()()();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtemplate"](20, RunExplorerComponent_Conditional_0_Conditional_20_Template, 3, 0, "ul", 9);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](21, "div", 5)(22, "div", 6);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](23, "Test Parameters");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtemplate"](24, RunExplorerComponent_Conditional_0_Conditional_24_Template, 3, 0, "ul", 9);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtemplate"](25, RunExplorerComponent_Conditional_0_Conditional_25_Template, 4, 1, "div", 5)(26, RunExplorerComponent_Conditional_0_Conditional_26_Template, 1, 1)(27, RunExplorerComponent_Conditional_0_Conditional_27_Template, 5, 1, "div", 10);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](28, "div", 11)(29, "button", 4);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵlistener"]("click", function RunExplorerComponent_Conditional_0_Template_button_click_29_listener() {
      _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵrestoreView"](_r1);
      const ctx_r1 = _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵnextContext"]();
      return _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵresetView"](ctx_r1.openRestApi());
    });
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](30, "span");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](31, "Use in JSON / REST API");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementStart"](32, "mat-icon");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtext"](33, "code_curly");
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵelementEnd"]()()()()();
  }
  if (rf & 2) {
    let tmp_1_0;
    let tmp_2_0;
    const ctx_r1 = _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵnextContext"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵadvance"](20);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵconditional"](((tmp_1_0 = ctx_r1.vsSvc.pipelineModel().Pipeline.Params) == null ? null : tmp_1_0.length) ? 20 : -1);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵadvance"](4);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵconditional"](((tmp_2_0 = ctx_r1.vsSvc.pipelineModel().Pipeline.TestParameters) == null ? null : tmp_2_0.length) ? 24 : -1);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵadvance"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵconditional"](ctx_r1.visualDesignerDataSig() ? 25 : -1);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵadvance"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵconditional"](ctx_r1.warningSig() ? 26 : -1);
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵadvance"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵconditional"](ctx_r1.vsSvc.pipelineModel().Pipeline.Description ? 27 : -1);
  }
}
class RunExplorerComponent {
  #dialogRouter;
  constructor(context, vsSvc) {
    this.context = context;
    this.vsSvc = vsSvc;
    this.warningSig = (0,_angular_core__WEBPACK_IMPORTED_MODULE_7__.signal)((0,_run_explorer_helpers__WEBPACK_IMPORTED_MODULE_6__.calculateWarnings)(this.vsSvc?.pipelineModel() ?? null, this.context));
    this.visualDesignerDataSig = (0,_angular_core__WEBPACK_IMPORTED_MODULE_7__.signal)(_shared_helpers_json_helpers__WEBPACK_IMPORTED_MODULE_2__.JsonHelpers.tryParse(this.vsSvc?.pipelineModel()?.Pipeline.VisualDesignerData) ?? {});
    this.#dialogRouter = (0,_core__WEBPACK_IMPORTED_MODULE_0__.transient)(_shared_routing_dialog_routing_service__WEBPACK_IMPORTED_MODULE_3__.DialogRoutingService);
  }
  editPipeline() {
    this.vsSvc.editPipelineEntity();
  }
  openParamsHelp() {
    window.open('https://go.2sxc.org/QueryParams', '_blank');
  }
  saveAndRunQuery(save, run) {
    this.vsSvc.saveAndRun(save, run);
  }
  showDataSourceDetails(event) {
    this.vsSvc.showDataSourceDetails(event.checked);
  }
  openRestApi() {
    const queryGuid = this.vsSvc.pipelineModel().Pipeline.EntityGuid;
    this.#dialogRouter.navRelative([_dev_rest__WEBPACK_IMPORTED_MODULE_1__.GoToDevRest.getUrlQueryDialog(queryGuid)]);
  }
  static {
    this.ɵfac = function RunExplorerComponent_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || RunExplorerComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵdirectiveInject"](_shared_services_context__WEBPACK_IMPORTED_MODULE_4__.Context), _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵdirectiveInject"](_services_visual_query_service__WEBPACK_IMPORTED_MODULE_5__.VisualQueryStateService));
    };
  }
  static {
    this.ɵcmp = /*@__PURE__*/_angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵdefineComponent"]({
      type: RunExplorerComponent,
      selectors: [["app-run-explorer"]],
      decls: 1,
      vars: 1,
      consts: [[1, "editor-active-explorer", "fancy-scrollbar-dark"], [1, "wrapper"], [1, "actions"], ["mat-raised-button", "", "color", "accent", 1, "action", 3, "click"], ["mat-raised-button", "", 1, "action", 3, "click"], [1, "parameters"], [1, "title"], ["mat-icon-button", "", "tippy", "Edit parameters", 3, "click"], ["mat-icon-button", "", "tippy", "Query Params Docs", 3, "click"], [1, "values"], [1, "description"], [1, "footer-actions"], [1, "eav-slide-toggle-label"], ["color", "primary", 3, "change", "checked"], [1, "warnings"], [2, "color", "red"], [3, "innerHTML"]],
      template: function RunExplorerComponent_Template(rf, ctx) {
        if (rf & 1) {
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵtemplate"](0, RunExplorerComponent_Conditional_0_Template, 34, 5, "div", 0);
        }
        if (rf & 2) {
          _angular_core__WEBPACK_IMPORTED_MODULE_7__["ɵɵconditional"](ctx.vsSvc.pipelineModel() ? 0 : -1);
        }
      },
      dependencies: [_angular_material_button__WEBPACK_IMPORTED_MODULE_8__.MatButtonModule, _angular_material_button__WEBPACK_IMPORTED_MODULE_8__.MatButton, _angular_material_button__WEBPACK_IMPORTED_MODULE_8__.MatIconButton, _angular_material_icon__WEBPACK_IMPORTED_MODULE_9__.MatIconModule, _angular_material_icon__WEBPACK_IMPORTED_MODULE_9__.MatIcon, _angular_material_slide_toggle__WEBPACK_IMPORTED_MODULE_10__.MatSlideToggleModule, _angular_material_slide_toggle__WEBPACK_IMPORTED_MODULE_10__.MatSlideToggle],
      styles: [".wrapper[_ngcontent-%COMP%] {\n  padding: 24px;\n}\n\n.actions[_ngcontent-%COMP%], \n.footer-actions[_ngcontent-%COMP%] {\n  display: flex;\n  flex-direction: column;\n  padding-bottom: 32px;\n}\n.actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]:not(:last-of-type), \n.footer-actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]:not(:last-of-type) {\n  margin-bottom: 8px;\n}\n\n.parameters[_ngcontent-%COMP%], \n.warnings[_ngcontent-%COMP%], \n.description[_ngcontent-%COMP%] {\n  margin: 16px 0;\n}\n.parameters[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], \n.warnings[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], \n.description[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%] {\n  height: 40px;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  font-size: 14px;\n}\n.parameters[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], \n.warnings[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], \n.description[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%] {\n  -webkit-user-select: none;\n          user-select: none;\n}\n\n.parameters[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%], \n.warnings[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%] {\n  margin: 0;\n  padding-left: 16px;\n}\n.parameters[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   li[_ngcontent-%COMP%], \n.warnings[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   li[_ngcontent-%COMP%] {\n  padding: 1px 0;\n}\n\n.eav-slide-toggle-label[_ngcontent-%COMP%] {\n  margin-right: 4px;\n  font-size: 14px;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJ1bi1leHBsb3Jlci5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGFBQUE7QUFDRjs7QUFFQTs7RUFFRSxhQUFBO0VBQ0Esc0JBQUE7RUFDQSxvQkFBQTtBQUNGO0FBQ0U7O0VBQ0Usa0JBQUE7QUFFSjs7QUFFQTs7O0VBR0UsY0FBQTtBQUNGO0FBQ0U7OztFQUNFLFlBQUE7RUFDQSxhQUFBO0VBQ0EsbUJBQUE7RUFDQSw4QkFBQTtFQUNBLGVBQUE7QUFHSjtBQURJOzs7RUFDRSx5QkFBQTtVQUFBLGlCQUFBO0FBS047O0FBRUU7O0VBQ0UsU0FBQTtFQUNBLGtCQUFBO0FBRUo7QUFBSTs7RUFDRSxjQUFBO0FBR047O0FBRUE7RUFDRSxpQkFBQTtFQUNBLGVBQUE7QUFDRiIsImZpbGUiOiJydW4tZXhwbG9yZXIuY29tcG9uZW50LnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIud3JhcHBlciB7XHJcbiAgcGFkZGluZzogMjRweDtcclxufVxyXG5cclxuLmFjdGlvbnMsXHJcbi5mb290ZXItYWN0aW9ucyB7XHJcbiAgZGlzcGxheTogZmxleDtcclxuICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG4gIHBhZGRpbmctYm90dG9tOiAzMnB4O1xyXG5cclxuICAuYWN0aW9uOm5vdCg6bGFzdC1vZi10eXBlKSB7XHJcbiAgICBtYXJnaW4tYm90dG9tOiA4cHg7XHJcbiAgfVxyXG59XHJcblxyXG4ucGFyYW1ldGVycyxcclxuLndhcm5pbmdzLFxyXG4uZGVzY3JpcHRpb24ge1xyXG4gIG1hcmdpbjogMTZweCAwO1xyXG5cclxuICAudGl0bGUge1xyXG4gICAgaGVpZ2h0OiA0MHB4O1xyXG4gICAgZGlzcGxheTogZmxleDtcclxuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XHJcbiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XHJcbiAgICBmb250LXNpemU6IDE0cHg7XHJcblxyXG4gICAgLm1hdC1pY29uIHtcclxuICAgICAgdXNlci1zZWxlY3Q6IG5vbmU7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG4ucGFyYW1ldGVycyxcclxuLndhcm5pbmdzIHtcclxuICAudmFsdWVzIHtcclxuICAgIG1hcmdpbjogMDtcclxuICAgIHBhZGRpbmctbGVmdDogMTZweDtcclxuXHJcbiAgICBsaSB7XHJcbiAgICAgIHBhZGRpbmc6IDFweCAwO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuLmVhdi1zbGlkZS10b2dnbGUtbGFiZWwge1xyXG4gIG1hcmdpbi1yaWdodDogNHB4O1xyXG4gIGZvbnQtc2l6ZTogMTRweDtcclxufVxyXG4vLyAuZm9vdGVyLWFjdGlvbnMge1xyXG4vLyAgIGRpc3BsYXk6IGZsZXg7XHJcbi8vICAganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZDtcclxuLy8gfVxyXG4iXX0= */\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3Byb2plY3RzL2Vhdi11aS9zcmMvYXBwL3Zpc3VhbC1xdWVyeS9ydW4tZXhwbG9yZXIvcnVuLWV4cGxvcmVyLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsYUFBQTtBQUNGOztBQUVBOztFQUVFLGFBQUE7RUFDQSxzQkFBQTtFQUNBLG9CQUFBO0FBQ0Y7QUFDRTs7RUFDRSxrQkFBQTtBQUVKOztBQUVBOzs7RUFHRSxjQUFBO0FBQ0Y7QUFDRTs7O0VBQ0UsWUFBQTtFQUNBLGFBQUE7RUFDQSxtQkFBQTtFQUNBLDhCQUFBO0VBQ0EsZUFBQTtBQUdKO0FBREk7OztFQUNFLHlCQUFBO1VBQUEsaUJBQUE7QUFLTjs7QUFFRTs7RUFDRSxTQUFBO0VBQ0Esa0JBQUE7QUFFSjtBQUFJOztFQUNFLGNBQUE7QUFHTjs7QUFFQTtFQUNFLGlCQUFBO0VBQ0EsZUFBQTtBQUNGO0FBRUEsNHVEQUE0dUQiLCJzb3VyY2VzQ29udGVudCI6WyIud3JhcHBlciB7XHJcbiAgcGFkZGluZzogMjRweDtcclxufVxyXG5cclxuLmFjdGlvbnMsXHJcbi5mb290ZXItYWN0aW9ucyB7XHJcbiAgZGlzcGxheTogZmxleDtcclxuICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG4gIHBhZGRpbmctYm90dG9tOiAzMnB4O1xyXG5cclxuICAuYWN0aW9uOm5vdCg6bGFzdC1vZi10eXBlKSB7XHJcbiAgICBtYXJnaW4tYm90dG9tOiA4cHg7XHJcbiAgfVxyXG59XHJcblxyXG4ucGFyYW1ldGVycyxcclxuLndhcm5pbmdzLFxyXG4uZGVzY3JpcHRpb24ge1xyXG4gIG1hcmdpbjogMTZweCAwO1xyXG5cclxuICAudGl0bGUge1xyXG4gICAgaGVpZ2h0OiA0MHB4O1xyXG4gICAgZGlzcGxheTogZmxleDtcclxuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XHJcbiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XHJcbiAgICBmb250LXNpemU6IDE0cHg7XHJcblxyXG4gICAgLm1hdC1pY29uIHtcclxuICAgICAgdXNlci1zZWxlY3Q6IG5vbmU7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG4ucGFyYW1ldGVycyxcclxuLndhcm5pbmdzIHtcclxuICAudmFsdWVzIHtcclxuICAgIG1hcmdpbjogMDtcclxuICAgIHBhZGRpbmctbGVmdDogMTZweDtcclxuXHJcbiAgICBsaSB7XHJcbiAgICAgIHBhZGRpbmc6IDFweCAwO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuLmVhdi1zbGlkZS10b2dnbGUtbGFiZWwge1xyXG4gIG1hcmdpbi1yaWdodDogNHB4O1xyXG4gIGZvbnQtc2l6ZTogMTRweDtcclxufVxyXG4vLyAuZm9vdGVyLWFjdGlvbnMge1xyXG4vLyAgIGRpc3BsYXk6IGZsZXg7XHJcbi8vICAganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZDtcclxuLy8gfVxyXG4iXSwic291cmNlUm9vdCI6IiJ9 */"]
    });
  }
}

/***/ }),

/***/ 32549:
/*!*************************************************!*\
  !*** ./node_modules/lodash-es/_getPrototype.js ***!
  \*************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _overArg_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./_overArg.js */ 69093);


/** Built-in value references. */
var getPrototype = (0,_overArg_js__WEBPACK_IMPORTED_MODULE_0__["default"])(Object.getPrototypeOf, Object);
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (getPrototype);

/***/ }),

/***/ 32760:
/*!************************************************************************!*\
  !*** ./projects/eav-ui/src/app/edit/dialog/main/keyboard-shortcuts.ts ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   isCtrlS: () => (/* binding */ isCtrlS),
/* harmony export */   isEscape: () => (/* binding */ isEscape)
/* harmony export */ });
function isEscape(event) {
  return event.key === 'Escape';
}
function isCtrlS(event) {
  return (event.key === 's' || event.key === 'S') && (event.ctrlKey || event.metaKey);
}

/***/ }),

/***/ 34697:
/*!***********************************************************************************!*\
  !*** ./projects/eav-ui/src/app/visual-query/add-explorer/add-explorer.helpers.ts ***!
  \***********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   filterAndSortDataSources: () => (/* binding */ filterAndSortDataSources)
/* harmony export */ });
/* harmony import */ var lodash_es_cloneDeep__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lodash-es/cloneDeep */ 85237);
/* harmony import */ var _shared_constants_eav_constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../shared/constants/eav.constants */ 50052);


function filterAndSortDataSources(dataSources, maxDifficulty) {
  if (!dataSources) return;
  const cloned = (0,lodash_es_cloneDeep__WEBPACK_IMPORTED_MODULE_1__["default"])(dataSources);
  const filtered = cloned.filter(dataSource => dataSource.Difficulty <= maxDifficulty && dataSource.PartAssemblyAndType !== _shared_constants_eav_constants__WEBPACK_IMPORTED_MODULE_0__.eavConstants.pipelineDesigner.outDataSource.PartAssemblyAndType);
  filtered.sort((a, b) => a.Name.toLocaleLowerCase().localeCompare(b.Name.toLocaleLowerCase()));
  const sorted = {};
  for (const dataSource of filtered) {
    const type = dataSource.PrimaryType;
    if (sorted[type]) {
      sorted[type].push(dataSource);
    } else {
      sorted[type] = [dataSource];
    }
  }
  return sorted;
}

/***/ }),

/***/ 34955:
/*!***************************************************************************************************!*\
  !*** ./projects/eav-ui/src/app/visual-query/stream-error-result/stream-error-result.component.ts ***!
  \***************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   StreamErrorResultComponent: () => (/* binding */ StreamErrorResultComponent)
/* harmony export */ });
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @angular/common */ 60316);
/* harmony import */ var _angular_material_button__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/material/button */ 84175);
/* harmony import */ var _angular_material_dialog__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/material/dialog */ 12587);
/* harmony import */ var _angular_material_icon__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/material/icon */ 93840);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 37580);








class StreamErrorResultComponent {
  constructor(dialogData, dialog) {
    this.dialogData = dialogData;
    this.dialog = dialog;
  }
  ngOnInit() {
    this.errorData = this.dialogData.errorData;
  }
  closeDialog() {
    this.dialog.close();
  }
  openInsights() {
    window.open(window.$2sxc.http.apiUrl('sys/insights/logs?key=web-api-query'), '_blank');
  }
  static {
    this.ɵfac = function StreamErrorResultComponent_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || StreamErrorResultComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdirectiveInject"](_angular_material_dialog__WEBPACK_IMPORTED_MODULE_1__.MAT_DIALOG_DATA), _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdirectiveInject"](_angular_material_dialog__WEBPACK_IMPORTED_MODULE_1__.MatDialogRef));
    };
  }
  static {
    this.ɵcmp = /*@__PURE__*/_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefineComponent"]({
      type: StreamErrorResultComponent,
      selectors: [["app-stream-error-result"]],
      decls: 17,
      vars: 3,
      consts: [[1, "eav-dialog"], [1, "eav-dialog-header"], [1, "eav-dialog-header__title"], ["mat-icon-button", "", "tippy", "Close dialog", 3, "click"], [1, "eav-dialog-content"], ["align", "end"], ["mat-button", "", "tippy", "Open 2sxc Insights", 1, "eav-button__with-icon", 3, "click"], [1, "eav-icon"]],
      template: function StreamErrorResultComponent_Template(rf, ctx) {
        if (rf & 1) {
          _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementStart"](0, "div", 0)(1, "div", 1)(2, "div", 2);
          _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtext"](3, "Stream Error Results");
          _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementEnd"]();
          _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementStart"](4, "button", 3);
          _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵlistener"]("click", function StreamErrorResultComponent_Template_button_click_4_listener() {
            return ctx.closeDialog();
          });
          _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementStart"](5, "mat-icon");
          _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtext"](6, "close");
          _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementEnd"]()()();
          _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementStart"](7, "div", 4)(8, "pre");
          _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtext"](9);
          _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵpipe"](10, "json");
          _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementEnd"]()();
          _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementStart"](11, "mat-dialog-actions", 5)(12, "button", 6);
          _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵlistener"]("click", function StreamErrorResultComponent_Template_button_click_12_listener() {
            return ctx.openInsights();
          });
          _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementStart"](13, "mat-icon", 7);
          _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtext"](14, "speed");
          _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementEnd"]();
          _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementStart"](15, "span");
          _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtext"](16, "Insights");
          _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementEnd"]()()()();
        }
        if (rf & 2) {
          _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵadvance"](9);
          _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtextInterpolate"](_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵpipeBind1"](10, 1, ctx.errorData));
        }
      },
      dependencies: [_angular_material_button__WEBPACK_IMPORTED_MODULE_2__.MatButtonModule, _angular_material_button__WEBPACK_IMPORTED_MODULE_2__.MatButton, _angular_material_button__WEBPACK_IMPORTED_MODULE_2__.MatIconButton, _angular_material_icon__WEBPACK_IMPORTED_MODULE_3__.MatIconModule, _angular_material_icon__WEBPACK_IMPORTED_MODULE_3__.MatIcon, _angular_material_dialog__WEBPACK_IMPORTED_MODULE_1__.MatDialogActions, _angular_common__WEBPACK_IMPORTED_MODULE_4__.JsonPipe],
      styles: [".description[_ngcontent-%COMP%] {\n  font-size: 14px;\n}\n\npre[_ngcontent-%COMP%] {\n  display: block;\n  padding: 9.5px;\n  margin: 0 0 10px;\n  font-size: 13px;\n  line-height: 1.42857143;\n  color: #333;\n  word-break: break-all;\n  word-wrap: break-word;\n  background-color: #f5f5f5;\n  border: 1px solid #ccc;\n  border-radius: 4px;\n  overflow-x: auto;\n}\n\n.mat-icon[_ngcontent-%COMP%] {\n  margin-right: 4px;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInN0cmVhbS1lcnJvci1yZXN1bHQuY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxlQUFBO0FBQ0Y7O0FBRUE7RUFDRSxjQUFBO0VBQ0EsY0FBQTtFQUNBLGdCQUFBO0VBQ0EsZUFBQTtFQUNBLHVCQUFBO0VBQ0EsV0FBQTtFQUNBLHFCQUFBO0VBQ0EscUJBQUE7RUFDQSx5QkFBQTtFQUNBLHNCQUFBO0VBQ0Esa0JBQUE7RUFDQSxnQkFBQTtBQUNGOztBQUVBO0VBQ0UsaUJBQUE7QUFDRiIsImZpbGUiOiJzdHJlYW0tZXJyb3ItcmVzdWx0LmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmRlc2NyaXB0aW9uIHtcclxuICBmb250LXNpemU6IDE0cHg7XHJcbn1cclxuXHJcbnByZSB7XHJcbiAgZGlzcGxheTogYmxvY2s7XHJcbiAgcGFkZGluZzogOS41cHg7XHJcbiAgbWFyZ2luOiAwIDAgMTBweDtcclxuICBmb250LXNpemU6IDEzcHg7XHJcbiAgbGluZS1oZWlnaHQ6IDEuNDI4NTcxNDM7XHJcbiAgY29sb3I6ICMzMzM7XHJcbiAgd29yZC1icmVhazogYnJlYWstYWxsO1xyXG4gIHdvcmQtd3JhcDogYnJlYWstd29yZDtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjVmNWY1O1xyXG4gIGJvcmRlcjogMXB4IHNvbGlkICNjY2M7XHJcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xyXG4gIG92ZXJmbG93LXg6IGF1dG87XHJcbn1cclxuXHJcbi5tYXQtaWNvbiB7XHJcbiAgbWFyZ2luLXJpZ2h0OiA0cHg7XHJcbn1cclxuIl19 */\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3Byb2plY3RzL2Vhdi11aS9zcmMvYXBwL3Zpc3VhbC1xdWVyeS9zdHJlYW0tZXJyb3ItcmVzdWx0L3N0cmVhbS1lcnJvci1yZXN1bHQuY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxlQUFBO0FBQ0Y7O0FBRUE7RUFDRSxjQUFBO0VBQ0EsY0FBQTtFQUNBLGdCQUFBO0VBQ0EsZUFBQTtFQUNBLHVCQUFBO0VBQ0EsV0FBQTtFQUNBLHFCQUFBO0VBQ0EscUJBQUE7RUFDQSx5QkFBQTtFQUNBLHNCQUFBO0VBQ0Esa0JBQUE7RUFDQSxnQkFBQTtBQUNGOztBQUVBO0VBQ0UsaUJBQUE7QUFDRjtBQUNBLG9oQ0FBb2hDIiwic291cmNlc0NvbnRlbnQiOlsiLmRlc2NyaXB0aW9uIHtcclxuICBmb250LXNpemU6IDE0cHg7XHJcbn1cclxuXHJcbnByZSB7XHJcbiAgZGlzcGxheTogYmxvY2s7XHJcbiAgcGFkZGluZzogOS41cHg7XHJcbiAgbWFyZ2luOiAwIDAgMTBweDtcclxuICBmb250LXNpemU6IDEzcHg7XHJcbiAgbGluZS1oZWlnaHQ6IDEuNDI4NTcxNDM7XHJcbiAgY29sb3I6ICMzMzM7XHJcbiAgd29yZC1icmVhazogYnJlYWstYWxsO1xyXG4gIHdvcmQtd3JhcDogYnJlYWstd29yZDtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjVmNWY1O1xyXG4gIGJvcmRlcjogMXB4IHNvbGlkICNjY2M7XHJcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xyXG4gIG92ZXJmbG93LXg6IGF1dG87XHJcbn1cclxuXHJcbi5tYXQtaWNvbiB7XHJcbiAgbWFyZ2luLXJpZ2h0OiA0cHg7XHJcbn1cclxuIl0sInNvdXJjZVJvb3QiOiIifQ== */"]
    });
  }
}

/***/ }),

/***/ 44051:
/*!********************************************************************************!*\
  !*** ./projects/eav-ui/src/app/visual-query/plumb-editor/plumber-constants.ts ***!
  \********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   dataSrcIdPrefix: () => (/* binding */ dataSrcIdPrefix),
/* harmony export */   domIdOfGuid: () => (/* binding */ domIdOfGuid),
/* harmony export */   guidOfDomId: () => (/* binding */ guidOfDomId)
/* harmony export */ });
const dataSrcIdPrefix = 'dataSource_';
function domIdOfGuid(guid) {
  return dataSrcIdPrefix + guid;
}
function guidOfDomId(domId) {
  return domId.replace(dataSrcIdPrefix, '');
}

/***/ }),

/***/ 45839:
/*!**********************************************!*\
  !*** ./node_modules/lodash-es/_arrayEach.js ***!
  \**********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/**
 * A specialized version of `_.forEach` for arrays without support for
 * iteratee shorthands.
 *
 * @private
 * @param {Array} [array] The array to iterate over.
 * @param {Function} iteratee The function invoked per iteration.
 * @returns {Array} Returns `array`.
 */
function arrayEach(array, iteratee) {
  var index = -1,
    length = array == null ? 0 : array.length;
  while (++index < length) {
    if (iteratee(array[index], index, array) === false) {
      break;
    }
  }
  return array;
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (arrayEach);

/***/ }),

/***/ 47709:
/*!*************************************************************************************!*\
  !*** ./projects/eav-ui/src/app/visual-query/plumb-editor/plumb-editor.component.ts ***!
  \*************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   PlumbEditorComponent: () => (/* binding */ PlumbEditorComponent)
/* harmony export */ });
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! @angular/common */ 60316);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @angular/core */ 37580);
/* harmony import */ var _angular_material_icon__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! @angular/material/icon */ 93840);
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! rxjs */ 75797);
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! rxjs */ 70271);
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! rxjs */ 19999);
/* harmony import */ var _core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../core */ 88692);
/* harmony import */ var _shared_components_base_component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../shared/components/base.component */ 43176);
/* harmony import */ var _shared_constants_eav_constants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../shared/constants/eav.constants */ 50052);
/* harmony import */ var _shared_directives_mousedown_stop_propagation_directive__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../shared/directives/mousedown-stop-propagation.directive */ 23840);
/* harmony import */ var _shared_helpers_json_helpers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../shared/helpers/json.helpers */ 4038);
/* harmony import */ var _shared_helpers_load_scripts_helper__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../shared/helpers/load-scripts.helper */ 33518);
/* harmony import */ var _shared_logging__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../shared/logging */ 34435);
/* harmony import */ var _services_query_definition_service__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../services/query-definition.service */ 55871);
/* harmony import */ var _services_visual_query_service__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../services/visual-query.service */ 2628);
/* harmony import */ var _datasource_helpers__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./datasource.helpers */ 9480);
/* harmony import */ var _plumb_editor_helpers__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./plumb-editor.helpers */ 19727);
/* harmony import */ var _plumber_constants__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./plumber-constants */ 44051);
/* harmony import */ var _plumber_helper__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./plumber.helper */ 59117);
/* harmony import */ var _angular_material_dialog__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! @angular/material/dialog */ 12587);
// tslint:disable-next-line:max-line-length






















const _c0 = ["domRoot"];
const _c1 = ["domDataSource"];
const _c2 = (a0, a1, a2) => ({
  top: a0,
  left: a1,
  "min-width": a2
});
const _c3 = a0 => ({
  "show-details": a0
});
function PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_5_Template(rf, ctx) {
  if (rf & 1) {
    const _r2 = _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementStart"](0, "mat-icon", 16);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵlistener"]("click", function PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_5_Template_mat_icon_click_0_listener() {
      _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵrestoreView"](_r2);
      const dataSource_r3 = _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵnextContext"]().$implicit;
      const ctx_r3 = _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵnextContext"](3);
      return _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵresetView"](ctx_r3.configureDataSource(dataSource_r3));
    });
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵtext"](1, " settings ");
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementEnd"]();
  }
}
function PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_6_Template(rf, ctx) {
  if (rf & 1) {
    const _r5 = _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementStart"](0, "mat-icon", 17);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵlistener"]("click", function PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_6_Template_mat_icon_click_0_listener() {
      _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵrestoreView"](_r5);
      const dataSource_r3 = _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵnextContext"]().$implicit;
      const ctx_r3 = _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵnextContext"](3);
      return _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵresetView"](ctx_r3.openHelp(ctx_r3.typeInfos()[dataSource_r3.EntityGuid].HelpLink));
    });
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵtext"](1, " help_outline ");
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementEnd"]();
  }
}
function PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_8_Template(rf, ctx) {
  if (rf & 1) {
    const _r6 = _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementStart"](0, "mat-icon", 18);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵlistener"]("click", function PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_8_Template_mat_icon_click_0_listener() {
      _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵrestoreView"](_r6);
      const dataSource_r3 = _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵnextContext"]().$implicit;
      const ctx_r3 = _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵnextContext"](3);
      return _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵresetView"](ctx_r3.remove(dataSource_r3));
    });
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵtext"](1, " delete ");
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementEnd"]();
  }
}
function PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_21_For_3_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementStart"](0, "tr", 21)(1, "td", 22);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵtext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementStart"](3, "td", 23);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵtext"](4);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementEnd"]()();
  }
  if (rf & 2) {
    const config_r7 = ctx.$implicit;
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵadvance"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵproperty"]("title", config_r7.name);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵadvance"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵtextInterpolate"](config_r7.name);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵadvance"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵproperty"]("title", config_r7.value);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵadvance"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵtextInterpolate"](config_r7.value);
  }
}
function PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_21_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelement"](0, "hr", 19);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementStart"](1, "table", 20);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵrepeaterCreate"](2, PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_21_For_3_Template, 5, 4, "tr", 21, _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵrepeaterTrackByIdentity"]);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementEnd"]();
  }
  if (rf & 2) {
    const dataSource_r3 = _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵnextContext"]().$implicit;
    const ctx_r3 = _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵnextContext"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵrepeater"](ctx_r3.visQuerySvc.dataSourceConfigs()[dataSource_r3.EntityId]);
  }
}
function PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_24_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelement"](0, "div", 14);
  }
}
function PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_25_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelement"](0, "div", 15);
  }
}
function PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Template(rf, ctx) {
  if (rf & 1) {
    const _r1 = _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementStart"](0, "div", 3, 1)(2, "div", 4)(3, "mat-icon", 5);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵtext"](4);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵtemplate"](5, PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_5_Template, 2, 0, "mat-icon", 6)(6, PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_6_Template, 2, 0, "mat-icon", 7);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementStart"](7, "div", 8);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵtemplate"](8, PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_8_Template, 2, 0, "mat-icon", 9);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementStart"](9, "div", 10);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵlistener"]("click", function PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Template_div_click_9_listener() {
      const dataSource_r3 = _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵrestoreView"](_r1).$implicit;
      const ctx_r3 = _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵnextContext"](3);
      return _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵresetView"](ctx_r3.visQuerySvc.pipelineModel().Pipeline.AllowEdit && ctx_r3.editName(dataSource_r3));
    });
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementStart"](10, "span");
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵtext"](11);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementStart"](12, "mat-icon", 11);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵtext"](13, "edit");
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementEnd"]()();
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelement"](14, "br");
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementStart"](15, "div", 12);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵlistener"]("click", function PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Template_div_click_15_listener() {
      const dataSource_r3 = _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵrestoreView"](_r1).$implicit;
      const ctx_r3 = _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵnextContext"](3);
      return _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵresetView"](ctx_r3.visQuerySvc.pipelineModel().Pipeline.AllowEdit && ctx_r3.editDescription(dataSource_r3));
    });
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementStart"](16, "span");
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵtext"](17);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementStart"](18, "mat-icon", 11);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵtext"](19, "edit");
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementEnd"]()();
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelement"](20, "br");
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵtemplate"](21, PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_21_Template, 4, 0);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementStart"](22, "div", 13);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵtext"](23);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵtemplate"](24, PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_24_Template, 1, 0, "div", 14)(25, PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Conditional_25_Template, 1, 0, "div", 15);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementEnd"]();
  }
  if (rf & 2) {
    let tmp_16_0;
    let tmp_24_0;
    const dataSource_r3 = ctx.$implicit;
    const ctx_r3 = _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵnextContext"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵproperty"]("id", ctx_r3.domIdOfGuid(dataSource_r3.EntityGuid))("ngStyle", _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵpureFunction3"](15, _c2, dataSource_r3.VisualDesignerData.Top + "px", dataSource_r3.VisualDesignerData.Left + "px", dataSource_r3.VisualDesignerData.Width ? dataSource_r3.VisualDesignerData.Width + "px" : null))("ngClass", _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵpureFunction1"](19, _c3, ctx_r3.showDataSourceDetails() && ((tmp_16_0 = ctx_r3.visQuerySvc.dataSourceConfigs()[dataSource_r3.EntityId]) == null ? null : tmp_16_0.length)));
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵadvance"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵproperty"]("title", ctx_r3.typeInfos()[dataSource_r3.EntityGuid].UiHint);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵadvance"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵtextInterpolate1"](" ", ctx_r3.typeInfos()[dataSource_r3.EntityGuid].Icon, " ");
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵadvance"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵconditional"](ctx_r3.visQuerySvc.pipelineModel().Pipeline.AllowEdit && ctx_r3.typeInfos()[dataSource_r3.EntityGuid].EnableConfig ? 5 : -1);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵadvance"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵconditional"](ctx_r3.typeInfos()[dataSource_r3.EntityGuid].HelpLink ? 6 : -1);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵconditional"](ctx_r3.visQuerySvc.pipelineModel().Pipeline.AllowEdit && !ctx_r3.isOutDataSource(dataSource_r3) ? 8 : -1);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵadvance"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵtextInterpolate"](dataSource_r3.Name || "(no name)");
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵadvance"](6);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵtextInterpolate"](dataSource_r3.Description);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵadvance"](4);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵconditional"](ctx_r3.showDataSourceDetails() && ((tmp_24_0 = ctx_r3.visQuerySvc.dataSourceConfigs()[dataSource_r3.EntityId]) == null ? null : tmp_24_0.length) ? 21 : -1);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵadvance"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵproperty"]("title", dataSource_r3.PartAssemblyAndType);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵadvance"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵtextInterpolate1"]("Type: ", ctx_r3.getTypeName(dataSource_r3.PartAssemblyAndType), "");
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵadvance"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵconditional"](ctx_r3.visQuerySvc.pipelineModel().Pipeline.AllowEdit && ctx_r3.typeInfos()[dataSource_r3.EntityGuid].DynamicOut ? 24 : -1);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵadvance"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵconditional"](ctx_r3.visQuerySvc.pipelineModel().Pipeline.AllowEdit && ctx_r3.typeInfos()[dataSource_r3.EntityGuid].DynamicIn ? 25 : -1);
  }
}
function PlumbEditorComponent_Conditional_0_Conditional_2_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵrepeaterCreate"](0, PlumbEditorComponent_Conditional_0_Conditional_2_For_1_Template, 26, 21, "div", 3, _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵrepeaterTrackByIdentity"]);
  }
  if (rf & 2) {
    const ctx_r3 = _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵnextContext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵrepeater"](ctx_r3.visQuerySvc.pipelineModel().DataSources);
  }
}
function PlumbEditorComponent_Conditional_0_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementStart"](0, "div", 2, 0);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵtemplate"](2, PlumbEditorComponent_Conditional_0_Conditional_2_Template, 2, 0);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵelementEnd"]();
  }
  if (rf & 2) {
    const ctx_r3 = _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵnextContext"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵconditional"](!ctx_r3.hardReset ? 2 : -1);
  }
}
const logSpecs = {
  all: false,
  ngAfterViewInit: false
};
const jsPlumbUrl = 'https://cdnjs.cloudflare.com/ajax/libs/jsPlumb/2.14.5/js/jsplumb.min.js';
class PlumbEditorComponent extends _shared_components_base_component__WEBPACK_IMPORTED_MODULE_1__.BaseComponent {
  #plumber;
  #scriptLoaded$;
  #queryDefinitionSvc;
  constructor(visQuerySvc,
  // Check if this not with transient better
  changeDetectorRef, matDialog, viewContainerRef) {
    super();
    this.visQuerySvc = visQuerySvc;
    this.changeDetectorRef = changeDetectorRef;
    this.matDialog = matDialog;
    this.viewContainerRef = viewContainerRef;
    this.log = (0,_shared_logging__WEBPACK_IMPORTED_MODULE_6__.classLog)({
      PlumbEditorComponent
    }, logSpecs);
    /** provide this fn to the UI */
    this.domIdOfGuid = _plumber_constants__WEBPACK_IMPORTED_MODULE_11__.domIdOfGuid;
    this.hardReset = false;
    this.#scriptLoaded$ = new rxjs__WEBPACK_IMPORTED_MODULE_14__.BehaviorSubject(false);
    this.#queryDefinitionSvc = (0,_core__WEBPACK_IMPORTED_MODULE_0__.transient)(_services_query_definition_service__WEBPACK_IMPORTED_MODULE_7__.QueryDefinitionService);
    this.showDataSourceDetails = (0,_angular_core__WEBPACK_IMPORTED_MODULE_13__.computed)(() => {
      const result = _shared_helpers_json_helpers__WEBPACK_IMPORTED_MODULE_4__.JsonHelpers.tryParse(this.visQuerySvc.pipelineModel()?.Pipeline.VisualDesignerData) ?? {};
      return result.ShowDataSourceDetails ?? false;
    });
    this.typeInfos = (0,_angular_core__WEBPACK_IMPORTED_MODULE_13__.computed)(() => (0,_plumb_editor_helpers__WEBPACK_IMPORTED_MODULE_10__.calculateTypeInfos)(this.visQuerySvc.pipelineModel()?.DataSources ?? [], this.visQuerySvc.dataSources()));
  }
  ngOnInit() {
    (0,_shared_helpers_load_scripts_helper__WEBPACK_IMPORTED_MODULE_5__.loadScripts)([{
      test: 'jsPlumb',
      src: jsPlumbUrl
    }], () => {
      this.#scriptLoaded$.next(true);
    });
    this.subscriptions.add(this.visQuerySvc.putEntityCountOnConnections$.subscribe(result => {
      this.#plumber.lineDecorator.addEntityCount(result);
    }));
    // October 2024 2dg
    // Unclear whether this workaround is still needed, when switching to signal it was commented out October 2024
    // Leave comment in until Q2 2025
    // this.viewModel$ = combineLatest([
    //   this.vsSvc.pipelineModel$,
    // ]).pipe(
    //   map(([pipelineModel]) => {
    //     if (pipelineModel == null) return;
    //     // workaround for jsPlumb not working with dom elements which it initialized on previously.
    //     // This wipes dom entirely and gives us new elements
    //     this.hardReset = true;
    //     this.changeDetectorRef.detectChanges(); // Forces the view to re-render
    //     this.hardReset = false;
    //     const viewModel: PlumbEditorViewModel = {
    //       removed: "removeLater",
    //     };
    //     return viewModel;
    //   }),
    // );
  }
  ngAfterViewInit() {
    const l = this.log.fnIf('ngAfterViewInit');
    // https://stackoverflow.com/questions/37087864/execute-a-function-when-ngfor-finished-in-angular-2/37088348#37088348
    const domDataSourcesLoaded$ = this.domDataSourcesRef.changes.pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_15__.map)(() => true));
    this.subscriptions.add((0,rxjs__WEBPACK_IMPORTED_MODULE_16__.combineLatest)([this.#scriptLoaded$, domDataSourcesLoaded$]).subscribe(([scriptLoaded, domDataSourcesLoaded]) => {
      if (!scriptLoaded || !domDataSourcesLoaded) return;
      l.a('scriptLoaded and domDataSourcesLoaded', {
        scriptLoaded,
        domDataSourcesLoaded
      });
      this.#plumber?.destroy();
      this.#plumber = new _plumber_helper__WEBPACK_IMPORTED_MODULE_12__.Plumber(this.domRootRef.nativeElement, this.visQuerySvc.pipelineModel(), this.visQuerySvc.dataSources(), () => this.onConnectionsChanged(), this.onDragend.bind(this), this.onDebugStream.bind(this), {
        matDialog: this.matDialog,
        viewContainerRef: this.viewContainerRef,
        changeDetectorRef: this.changeDetectorRef,
        onConnectionsChanged: () => this.onConnectionsChanged()
      });
    }));
    l.end();
  }
  ngOnDestroy() {
    this.#plumber?.destroy();
    this.#scriptLoaded$.complete();
    super.ngOnDestroy();
  }
  onConnectionsChanged() {
    const connections = this.#plumber.connections.getAll();
    const streamsOut = this.#plumber.getStreamsOut();
    this.visQuerySvc.changeConnections(connections, streamsOut);
  }
  onDragend(pipelineDataSourceGuid, position) {
    this.visQuerySvc.changeDataSourcePosition(pipelineDataSourceGuid, position);
  }
  onDebugStream(stream) {
    this.visQuerySvc.debugStream(stream);
  }
  configureDataSource(dataSource) {
    // ensure dataSource entity is saved
    if (dataSource.EntityGuid.includes('unsaved')) return this.visQuerySvc.saveAndRun(true, false);
    this.visQuerySvc.editDataSource(dataSource);
  }
  getTypeName(partAssemblyAndType) {
    const dataSource = (0,_datasource_helpers__WEBPACK_IMPORTED_MODULE_9__.findDefByType)(this.visQuerySvc.dataSources(), partAssemblyAndType);
    return this.#queryDefinitionSvc.typeNameFilter(dataSource?.TypeNameForUi || partAssemblyAndType, 'className');
  }
  isOutDataSource(pipelineDataSource) {
    return pipelineDataSource.PartAssemblyAndType === _shared_constants_eav_constants__WEBPACK_IMPORTED_MODULE_2__.eavConstants.pipelineDesigner.outDataSource.PartAssemblyAndType;
  }
  remove(pipelineDataSource) {
    if (!confirm(`Delete ${pipelineDataSource.Name} data source?`)) return;
    // Update UI
    this.#plumber.removeAllEndpoints(pipelineDataSource.EntityGuid);
    // Tell backend to clean up
    const connections = this.#plumber.connections.getAll();
    const streamsOut = this.#plumber.getStreamsOut();
    this.visQuerySvc.removeDataSource(pipelineDataSource.EntityGuid, connections, streamsOut);
  }
  openHelp(url) {
    window.open(url, '_blank');
  }
  editName(dataSource) {
    const newName = prompt('Rename data source', dataSource.Name)?.trim();
    if (newName == null || newName === '') return;
    this.visQuerySvc.renameDataSource(dataSource.EntityGuid, newName);
  }
  editDescription(dataSource) {
    const newDescription = prompt('Edit description', dataSource.Description)?.trim();
    if (newDescription == null) return;
    this.visQuerySvc.changeDataSourceDescription(dataSource.EntityGuid, newDescription);
  }
  static {
    this.ɵfac = function PlumbEditorComponent_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || PlumbEditorComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵdirectiveInject"](_services_visual_query_service__WEBPACK_IMPORTED_MODULE_8__.VisualQueryStateService), _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵdirectiveInject"](_angular_core__WEBPACK_IMPORTED_MODULE_13__.ChangeDetectorRef), _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵdirectiveInject"](_angular_material_dialog__WEBPACK_IMPORTED_MODULE_17__.MatDialog), _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵdirectiveInject"](_angular_core__WEBPACK_IMPORTED_MODULE_13__.ViewContainerRef));
    };
  }
  static {
    this.ɵcmp = /*@__PURE__*/_angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵdefineComponent"]({
      type: PlumbEditorComponent,
      selectors: [["app-plumb-editor"]],
      viewQuery: function PlumbEditorComponent_Query(rf, ctx) {
        if (rf & 1) {
          _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵviewQuery"](_c0, 5);
          _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵviewQuery"](_c1, 5);
        }
        if (rf & 2) {
          let _t;
          _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵqueryRefresh"](_t = _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵloadQuery"]()) && (ctx.domRootRef = _t.first);
          _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵqueryRefresh"](_t = _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵloadQuery"]()) && (ctx.domDataSourcesRef = _t);
        }
      },
      features: [_angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵInheritDefinitionFeature"]],
      decls: 1,
      vars: 1,
      consts: [["domRoot", ""], ["domDataSource", ""], ["id", "pipeline-root"], [1, "dataSource", 3, "id", "ngStyle", "ngClass"], [1, "actions", "left"], [1, "type-info", 3, "title"], ["title", "Configure data source", "appMousedownStopPropagation", "", 1, "configure"], ["title", "Help for this data source", "appMousedownStopPropagation", "", 1, "help"], [1, "actions", "right"], ["title", "Delete", "appMousedownStopPropagation", "", 1, "delete"], ["title", "Click to edit name", "appMousedownStopPropagation", "", 1, "name", 3, "click"], [1, "show-hover-inline"], ["title", "Click to edit description", "appMousedownStopPropagation", "", 1, "description", 3, "click"], [1, "typename", 3, "title"], ["title", "Drag a new Out-Connection", 1, "add-endpoint", "sourceEndpoint", "dynamic"], ["title", "This data source supports multiple In-Connections", 1, "many-in", "targetEndpoint", "dynamic"], ["title", "Configure data source", "appMousedownStopPropagation", "", 1, "configure", 3, "click"], ["title", "Help for this data source", "appMousedownStopPropagation", "", 1, "help", 3, "click"], ["title", "Delete", "appMousedownStopPropagation", "", 1, "delete", 3, "click"], [2, "margin", "0"], [1, "configs"], [1, "config"], [1, "config-name", 3, "title"], [1, "config-value", 3, "title"]],
      template: function PlumbEditorComponent_Template(rf, ctx) {
        if (rf & 1) {
          _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵtemplate"](0, PlumbEditorComponent_Conditional_0_Template, 3, 1, "div", 2);
        }
        if (rf & 2) {
          _angular_core__WEBPACK_IMPORTED_MODULE_13__["ɵɵconditional"](ctx.visQuerySvc.pipelineModel() ? 0 : -1);
        }
      },
      dependencies: [_angular_common__WEBPACK_IMPORTED_MODULE_18__.NgStyle, _angular_common__WEBPACK_IMPORTED_MODULE_18__.NgClass, _angular_material_icon__WEBPACK_IMPORTED_MODULE_19__.MatIconModule, _angular_material_icon__WEBPACK_IMPORTED_MODULE_19__.MatIcon, _shared_directives_mousedown_stop_propagation_directive__WEBPACK_IMPORTED_MODULE_3__.MousedownStopPropagationDirective],
      styles: ["[_nghost-%COMP%] { display: block; width: 100%; height: 100%; }\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBsdW1iLWVkaXRvci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsUUFBUSxjQUFjLEVBQUUsV0FBVyxFQUFFLFlBQVksRUFBRSIsImZpbGUiOiJwbHVtYi1lZGl0b3IuY29tcG9uZW50LnRzIiwic291cmNlc0NvbnRlbnQiOlsiOmhvc3QgeyBkaXNwbGF5OiBibG9jazsgd2lkdGg6IDEwMCU7IGhlaWdodDogMTAwJTsgfSJdfQ== */\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3Byb2plY3RzL2Vhdi11aS9zcmMvYXBwL3Zpc3VhbC1xdWVyeS9wbHVtYi1lZGl0b3IvcGx1bWItZWRpdG9yLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxRQUFRLGNBQWMsRUFBRSxXQUFXLEVBQUUsWUFBWSxFQUFFO0FBQ25ELG9XQUFvVyIsInNvdXJjZXNDb250ZW50IjpbIjpob3N0IHsgZGlzcGxheTogYmxvY2s7IHdpZHRoOiAxMDAlOyBoZWlnaHQ6IDEwMCU7IH0iXSwic291cmNlUm9vdCI6IiJ9 */"]
    });
  }
}

/***/ }),

/***/ 48443:
/*!***************************************************************************************!*\
  !*** ./projects/eav-ui/src/app/visual-query/plumb-editor/jsplumb-instance-manager.ts ***!
  \***************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   JsPlumbInstanceManager: () => (/* binding */ JsPlumbInstanceManager)
/* harmony export */ });
class JsPlumbInstanceManager {
  constructor(jsPlumbRoot, lineColors) {
    this.jsPlumbRoot = jsPlumbRoot;
    this.lineColors = lineColors;
    this.instance = window.jsPlumb.getInstance(this.createInstanceDefaults(this.jsPlumbRoot));
  }
  createInstanceDefaults(container) {
    const defaults = {
      Container: container,
      Connector: ['Bezier', {
        curviness: 70
      }],
      PaintStyle: this.lineColors.nextLinePaintStyle('dummy'),
      HoverPaintStyle: {
        stroke: '#216477',
        strokeWidth: 4,
        outlineStroke: 'white',
        outlineWidth: 2
      }
    };
    return defaults;
  }
  destroy() {
    this.instance.reset();
    this.instance.unbindContainer();
    this.instance = null;
  }
}

/***/ }),

/***/ 49934:
/*!***********************************************!*\
  !*** ./node_modules/lodash-es/_baseCreate.js ***!
  \***********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _isObject_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./isObject.js */ 23151);


/** Built-in value references. */
var objectCreate = Object.create;

/**
 * The base implementation of `_.create` without support for assigning
 * properties to the created object.
 *
 * @private
 * @param {Object} proto The object to inherit from.
 * @returns {Object} Returns the new object.
 */
var baseCreate = function () {
  function object() {}
  return function (proto) {
    if (!(0,_isObject_js__WEBPACK_IMPORTED_MODULE_0__["default"])(proto)) {
      return {};
    }
    if (objectCreate) {
      return objectCreate(proto);
    }
    object.prototype = proto;
    var result = new object();
    object.prototype = undefined;
    return result;
  };
}();
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (baseCreate);

/***/ }),

/***/ 51251:
/*!******************************************************************************!*\
  !*** ./projects/eav-ui/src/app/visual-query/plumb-editor/lines-decorator.ts ***!
  \******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   LinesDecorator: () => (/* binding */ LinesDecorator)
/* harmony export */ });
/* harmony import */ var _shared_logging__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../shared/logging */ 34435);
/* harmony import */ var _plumber_constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./plumber-constants */ 44051);


const logSpecs = {
  all: false,
  putEntityCountOnConnections: false
};
class LinesDecorator {
  constructor(instance, pipelineModel, onDebugStream) {
    this.instance = instance;
    this.pipelineModel = pipelineModel;
    this.onDebugStream = onDebugStream;
    this.log = (0,_shared_logging__WEBPACK_IMPORTED_MODULE_0__.classLogEnabled)({
      LinesDecorator
    }, logSpecs);
  }
  /**
   * Updates the entity count on each connections based on the provided result.
   * @param result PipelineResult
   */
  addEntityCount(result) {
    const l = this.log.fnIf('putEntityCountOnConnections');
    result.Streams?.forEach(stream => {
      const outDomId = (0,_plumber_constants__WEBPACK_IMPORTED_MODULE_1__.domIdOfGuid)(stream.Source);
      const outTargets = ['00000000-0000-0000-0000-000000000000', this.pipelineModel.Pipeline.EntityGuid];
      const inDomId = outTargets.includes(stream.Target) ? (0,_plumber_constants__WEBPACK_IMPORTED_MODULE_1__.domIdOfGuid)('Out') : (0,_plumber_constants__WEBPACK_IMPORTED_MODULE_1__.domIdOfGuid)(stream.Target);
      const fromUuid = outDomId + '_out_' + stream.SourceOut;
      const toUuid = inDomId + '_in_' + stream.TargetIn;
      const endpoint = this.instance.getEndpoint(fromUuid);
      endpoint?.connections?.filter(connection => connection.endpoints[1].getUuid() === toUuid)?.forEach(connection => {
        const label = !stream.Error ? stream.Count.toString() : '';
        const cssClass = 'streamEntitiesCount ' + (!stream.Error ? '' : 'streamEntitiesError');
        connection.setLabel({
          label,
          cssClass,
          events: {
            click: () => {
              if (!this.pipelineModel.Pipeline.AllowEdit) return;
              this.onDebugStream(stream);
            }
          }
        });
      });
    });
    l.end('done');
  }
}

/***/ }),

/***/ 53524:
/*!********************************************************************************!*\
  !*** ./projects/eav-ui/src/app/visual-query/plumb-editor/endpoints-manager.ts ***!
  \********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   EndpointsManager: () => (/* binding */ EndpointsManager)
/* harmony export */ });
/* harmony import */ var _shared_constants_eav_constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../shared/constants/eav.constants */ 50052);
/* harmony import */ var _shared_logging__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../shared/logging */ 34435);
/* harmony import */ var _datasource_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./datasource.helpers */ 9480);
/* harmony import */ var _plumber_constants__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./plumber-constants */ 44051);




const logSpecs = {
  all: false,
  addEndpoint: false,
  reOrientAllLabels: false,
  updateAfterChanges: false,
  wireHasConnection: false,
  mirrorEndpoints: false,
  fields: ['TestIn2', 'Default']
};
const endPointsWhereWeRotate = 3;
const maxLabelLengthToRotate = 30;
class EndpointsManager {
  constructor(instance, endpointDefs, connections, queryData) {
    this.instance = instance;
    this.endpointDefs = endpointDefs;
    this.connections = connections;
    this.queryData = queryData;
    this.log = (0,_shared_logging__WEBPACK_IMPORTED_MODULE_1__.classLogEnabled)({
      EndpointsManager
    }, logSpecs);
    this.#isDoingUpdate = false;
  }
  addEndpoint(domDataSource, endpointName, isIn, queryDs, extraStyling) {
    const l = this.log.fnIfInList('addEndpoint', 'fields', endpointName, {
      endpointName,
      isIn,
      queryDs
    });
    const dsDefinition = (0,_datasource_helpers__WEBPACK_IMPORTED_MODULE_2__.findDefByType)(this.queryData.dataSources, queryDs.PartAssemblyAndType);
    const connectionList = isIn ? dsDefinition.In : dsDefinition.Out;
    const hasDynamic = connectionList?.some(name => this.endpointDefs.getInfo(name, false).required === false);
    const endpointInfo = this.endpointDefs.getInfo(endpointName, hasDynamic);
    l.a(`endpointInfo`, {
      dataSource: dsDefinition,
      connectionList,
      hasDynamic,
      endpointInfo
    });
    // if (endpointName === "DEBUG") debugger;
    // Figure out additional styling based on the endpoint type
    const style = hasDynamic ? 'dynamic' // dynamic endpoints are not required
    : !endpointInfo.required ? '' // not required
    : this.#wireHasConnection(domDataSource, endpointInfo.name, isIn) ? '' : 'required'; // required - check if it's populated; otherwise make red
    const uuid = domDataSource.id + (isIn ? '_in_' : '_out_') + endpointInfo.name;
    const model = isIn ? this.endpointDefs.buildTargetDef(queryDs.EntityGuid, `${style} ${extraStyling}`) : this.endpointDefs.buildSourceDef(queryDs.EntityGuid, `${style} ${extraStyling}`);
    // Endpoints on Out-DataSource must be always enabled
    const params = {
      uuid,
      enabled: this.queryData.query.Pipeline.AllowEdit || queryDs.EntityGuid === _shared_constants_eav_constants__WEBPACK_IMPORTED_MODULE_0__.eavConstants.pipelineDesigner.outDataSource.EntityGuid
    };
    // Add endpoint and add label and css in case it must be angled
    const endpoint = this.instance.addEndpoint(domDataSource, model, params);
    const overlay = endpoint.getOverlay('endpointLabel');
    overlay.setLabel(endpointInfo.name);
    l.end("end", {
      overlay
    });
  }
  /**
   * Check if a specific endpoint has a connection
   * Note that it uses the query model to check, not the DOM.
   * So in certain cases where a change is just being made, it could be wrong.
   */
  #wireHasConnection(domDataSource, name, isIn = true) {
    const l = this.log.fnIf('wireHasConnection', {
      domDataSource,
      name,
      isIn
    });
    const wireExists = this.queryData.query.Pipeline.StreamWiring?.some(wire => isIn ? (0,_plumber_constants__WEBPACK_IMPORTED_MODULE_3__.domIdOfGuid)(wire.To) === domDataSource.id && wire.In === name : (0,_plumber_constants__WEBPACK_IMPORTED_MODULE_3__.domIdOfGuid)(wire.From) === domDataSource.id && wire.Out === name);
    return l.r(wireExists, 'wireExists' + wireExists);
  }
  #isDoingUpdate;
  updateAfterChanges() {
    const l = this.log.fnIf('updateAfterChanges', {
      query: this.queryData.query,
      isDoing: this.#isDoingUpdate
    });
    // Prevent loops
    if (this.#isDoingUpdate) return l.end('already doing update, exit');
    this.#isDoingUpdate = true;
    this.#mirrorEndpoints();
    this.#reOrientAllLabels();
    this.#isDoingUpdate = false;
    this.instance.repaintEverything();
    l.end('done');
  }
  #mirrorEndpoints() {
    const l = this.log.fnIf('mirrorEndpoints', {
      query: this.queryData.query
    });
    // Get all parts which have mirror-in mode
    const partsMirrorIn = this.queryData.query.DataSources.map(ds => {
      const def = (0,_datasource_helpers__WEBPACK_IMPORTED_MODULE_2__.findDefByType)(this.queryData.dataSources, ds.PartAssemblyAndType);
      return def.OutMode === 'mirror-in' ? {
        def,
        guid: ds.EntityGuid
      } : null;
    }).filter(d => d !== null);
    // Check if we need to mirror anything
    partsMirrorIn.forEach(ds => {
      const {
        inPoints,
        outPoints
      } = this.#getEndpointsByType(ds.guid);
      const inLabels = inPoints.map(p => ({
        point: p,
        label: (0,_datasource_helpers__WEBPACK_IMPORTED_MODULE_2__.getEndpointLabel)(p)
      }));
      const outLabels = outPoints.map(p => ({
        point: p,
        label: (0,_datasource_helpers__WEBPACK_IMPORTED_MODULE_2__.getEndpointLabel)(p)
      }));
      // Get mismatching lists of out and in
      const missingInOut = inLabels.filter(inP => !outLabels.some(outP => outP.label === inP.label));
      const outWithoutIn = outLabels.filter(outP => !inLabels.some(inP => inP.label === outP.label));
      l.a('inMissingInOut', {
        inPoints,
        outPoints,
        missingInOut,
        outWithoutIn
      });
      // Add missing labels to out
      const {
        domDataSource,
        dataSource
      } = this.queryData.findDataSourceAndDom(ds.guid);
      if (missingInOut.length) {
        missingInOut.forEach(p => this.addEndpoint(domDataSource, p.label, false, dataSource, 'mirror-in'));
      }
      // Remove excessive labels
      // Only consider the ones which have a `mirror-in` class and remove them
      outWithoutIn.forEach(p => {
        if (p.point.canvas.classList.contains('mirror-in')) {
          const hasConnection = p.point.connections?.length;
          if (!hasConnection) this.instance.deleteEndpoint(p.point);
        }
      });
    });
  }
  /**
   * Ugly way to get the endpoints by type in/out. Not elegant, but don't know a better method ATM
   */
  #getEndpointsByType(guid) {
    const endpoints = this.instance.selectEndpoints({
      element: (0,_plumber_constants__WEBPACK_IMPORTED_MODULE_3__.domIdOfGuid)(guid)
    });
    const inPoints = [];
    const outPoints = [];
    endpoints.each(ep => (ep.isTarget ? inPoints : outPoints).push(ep));
    return {
      inPoints,
      outPoints
    };
  }
  /**
   * Check all labels and if there are too many, rotate them at an angle
   */
  #reOrientAllLabels() {
    const l = this.log.fnIf('reOrientAllLabels');
    const parts = this.queryData.query.DataSources.map(ds => ds.EntityGuid);
    parts.forEach(guid => {
      const {
        inPoints,
        outPoints
      } = this.#getEndpointsByType(guid);
      this.#reorientListOfEndpoints(inPoints);
      this.#reorientListOfEndpoints(outPoints);
    });
    l.end();
  }
  #reorientListOfEndpoints(endpoints) {
    const countExceeded = endpoints.length > endPointsWhereWeRotate;
    const labels = endpoints.map(endpoint => (0,_datasource_helpers__WEBPACK_IMPORTED_MODULE_2__.getEndpointLabel)(endpoint)).join(',');
    if (countExceeded || labels.length > maxLabelLengthToRotate) endpoints.forEach(element => element.addClass('angled'));else endpoints.forEach(element => element.removeClass('angled'));
  }
  removeAllEndpoints(dataSourceGuid) {
    const elementId = (0,_plumber_constants__WEBPACK_IMPORTED_MODULE_3__.domIdOfGuid)(dataSourceGuid);
    this.connections.bulkDelete = true;
    this.instance.batch(() => {
      this.instance.selectEndpoints({
        element: elementId
      }).delete();
    });
    this.connections.bulkDelete = false;
  }
}

/***/ }),

/***/ 54372:
/*!***********************************************************************************!*\
  !*** ./projects/eav-ui/src/app/visual-query/plumb-editor/endpoint-definitions.ts ***!
  \***********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   EndpointDefinitionsService: () => (/* binding */ EndpointDefinitionsService)
/* harmony export */ });
/* harmony import */ var _shared_logging__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../shared/logging */ 34435);
/* harmony import */ var _rename_stream_rename_stream_component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./rename-stream/rename-stream.component */ 12710);


const logSpecs = {
  all: true,
  getEndpointOverlays: true,
  getEndpointInfo: true,
  buildSourceDef: true,
  buildTargetDef: true
};
/**
 * Trivial helper to get endpoint definitions and similar things
 */
class EndpointDefinitionsService {
  constructor(pipelineModel, renameDialogParts) {
    this.pipelineModel = pipelineModel;
    this.renameDialogParts = renameDialogParts;
    this.log = (0,_shared_logging__WEBPACK_IMPORTED_MODULE_0__.classLog)({
      EndpointDefinitionsService
    }, logSpecs);
  }
  #getEndpointOverlays(isSource) {
    const l = this.log.fnIf('getEndpointOverlays', {
      isSource
    });
    const result = [['Label', {
      id: 'endpointLabel',
      location: [0.5, isSource ? 0 : 1],
      label: 'Default',
      cssClass: isSource ? 'endpointSourceLabel' : 'endpointTargetLabel'
    }]];
    return l.r(result);
  }
  getInfo(endpointName, isDynamic) {
    const l = this.log.fnIf('getEndpointInfo', {
      endpointName,
      isDynamic
    });
    // let name: string;
    // let required: boolean;
    // Trim name and see if it's required - marked with a trailing '*'
    const trimmed = endpointName.trim();
    const required = trimmed.endsWith('*');
    const name = !required ? trimmed : trimmed.substring(0, trimmed.length - 1);
    if (isDynamic) return l.r({
      name,
      required: false
    }, 'isDynamic');
    return l.r({
      name,
      required
    }, 'notDynamic');
  }
  buildSourceDef(dsGuid, style) {
    const l = this.log.fnIf('buildSourceDef', {
      pipelineDataSourceGuid: dsGuid,
      style
    });
    const isSource = true;
    const sourceEndpoint = {
      paintStyle: {
        fill: 'transparent',
        radius: 10
      },
      cssClass: 'sourceEndpoint ' + (style ?? ''),
      maxConnections: -1,
      isSource,
      anchor: ['Continuous', {
        faces: ['top']
      }],
      overlays: this.#getEndpointOverlays(isSource),
      events: {
        click: endpointOrOverlay => this.onChangeLabel(endpointOrOverlay, isSource, dsGuid)
      }
    };
    return l.r(sourceEndpoint);
  }
  buildTargetDef(dsGuid, style) {
    const l = this.log.fnIf('buildTargetDef', {
      pipelineDataSourceGuid: dsGuid,
      style
    });
    const isSource = false;
    const targetEndpoint = {
      paintStyle: {
        fill: 'transparent',
        radius: 10
      },
      cssClass: 'targetEndpoint ' + (style ?? ' '),
      // + (angled ? 'angled' : ''),
      maxConnections: 1,
      isTarget: !isSource,
      anchor: ['Continuous', {
        faces: ['bottom']
      }],
      overlays: this.#getEndpointOverlays(isSource),
      dropOptions: {
        hoverClass: 'hover',
        activeClass: 'active'
      },
      events: {
        click: endpointOrOverlay => this.onChangeLabel(endpointOrOverlay, isSource, dsGuid)
      }
    };
    return l.r(targetEndpoint);
  }
  onChangeLabel(endpointOrOverlay, isSource, pipelineDataSourceGuid) {
    if (!this.pipelineModel.Pipeline.AllowEdit) return;
    debugger;
    const overlay = endpointOrOverlay?.getOverlay?.('endpointLabel') ?? endpointOrOverlay;
    this.renameDialogParts.matDialog.open(_rename_stream_rename_stream_component__WEBPACK_IMPORTED_MODULE_1__.RenameStreamComponent, {
      autoFocus: false,
      data: {
        pipelineDataSourceGuid,
        isSource,
        label: overlay.label
      },
      viewContainerRef: this.renameDialogParts.viewContainerRef,
      width: '650px'
    }).afterClosed().subscribe(newLabel => {
      if (!newLabel) return;
      overlay.setLabel(newLabel);
      setTimeout(() => this.renameDialogParts.onConnectionsChanged());
    });
    this.renameDialogParts.changeDetectorRef.markForCheck();
  }
}

/***/ }),

/***/ 55871:
/*!***********************************************************************************!*\
  !*** ./projects/eav-ui/src/app/visual-query/services/query-definition.service.ts ***!
  \***********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   QueryDefinitionService: () => (/* binding */ QueryDefinitionService)
/* harmony export */ });
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! rxjs */ 70271);
/* harmony import */ var _app_administration_services__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../app-administration/services */ 75445);
/* harmony import */ var _shared_constants_eav_constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../shared/constants/eav.constants */ 50052);
/* harmony import */ var _shared_services_http_service_base__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../shared/services/http-service-base */ 96474);
/* harmony import */ var _plumb_editor_datasource_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../plumb-editor/datasource.helpers */ 9480);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @angular/core */ 37580);






class QueryDefinitionService extends _shared_services_http_service_base__WEBPACK_IMPORTED_MODULE_2__.HttpServiceBase {
  fetchPipeline(pipelineEntityId, dataSources) {
    return this.getHttp(_app_administration_services__WEBPACK_IMPORTED_MODULE_0__.webApiQueryGet, {
      params: {
        appId: this.appId,
        id: pipelineEntityId.toString()
      }
    }).pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_4__.map)(pipelineModel => {
      // if pipeline is new, populate it with default model
      if (!pipelineModel.DataSources.length) {
        this.#buildDefaultModel(pipelineModel, dataSources);
      }
      this.#fixPipelineDataSources(pipelineModel.DataSources);
      return pipelineModel;
    }));
  }
  #buildDefaultModel(pipelineModel, dataSources) {
    const templateDataSources = _shared_constants_eav_constants__WEBPACK_IMPORTED_MODULE_1__.eavConstants.pipelineDesigner.defaultPipeline.dataSources;
    for (const templateDS of templateDataSources) {
      const dataSource = (0,_plumb_editor_datasource_helpers__WEBPACK_IMPORTED_MODULE_3__.findDefByType)(dataSources, templateDS.PartAssemblyAndType);
      const pipelineDataSource = {
        Description: '',
        EntityGuid: templateDS.EntityGuid,
        EntityId: undefined,
        Name: dataSource.Name,
        PartAssemblyAndType: templateDS.PartAssemblyAndType,
        VisualDesignerData: templateDS.VisualDesignerData
      };
      pipelineModel.DataSources.push(pipelineDataSource);
    }
    pipelineModel.Pipeline.StreamWiring = _shared_constants_eav_constants__WEBPACK_IMPORTED_MODULE_1__.eavConstants.pipelineDesigner.defaultPipeline.streamWiring;
  }
  #fixPipelineDataSources(pipelineDataSources) {
    const outDataSourceExists = pipelineDataSources.some(pipelineDS => pipelineDS.EntityGuid === _shared_constants_eav_constants__WEBPACK_IMPORTED_MODULE_1__.eavConstants.pipelineDesigner.outDataSource.EntityGuid);
    if (!outDataSourceExists) {
      const outDs = _shared_constants_eav_constants__WEBPACK_IMPORTED_MODULE_1__.eavConstants.pipelineDesigner.outDataSource;
      const outDsConst = {
        Description: outDs.Description,
        EntityGuid: outDs.EntityGuid,
        EntityId: undefined,
        Name: outDs.Name,
        PartAssemblyAndType: outDs.PartAssemblyAndType,
        VisualDesignerData: outDs.VisualDesignerData
      };
      pipelineDataSources.push(outDsConst);
    }
    for (const pipelineDataSource of pipelineDataSources) {
      pipelineDataSource.VisualDesignerData ??= {
        Top: 50,
        Left: 50
      };
    }
  }
  fetchDataSources() {
    return this.getHttp(_app_administration_services__WEBPACK_IMPORTED_MODULE_0__.webApiQueryDataSources, {
      params: {
        appid: this.appId,
        zoneId: this.zoneId
      }
    }).pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_4__.map)(dataSources => {
      // Add the final target DataSource to the list of DataSources
      dataSources.push(_shared_constants_eav_constants__WEBPACK_IMPORTED_MODULE_1__.eavConstants.pipelineDesigner.outFinalTarget);
      return dataSources;
    }));
  }
  typeNameFilter(input, format) {
    const globalParts = input.split(', ');
    switch (format) {
      case 'classFullName':
        const classFullName = globalParts[0];
        return classFullName;
      case 'className':
        const classFullNameParts = globalParts[0].split('.');
        const className = classFullNameParts[classFullNameParts.length - 1];
        return className;
      default:
        return input;
    }
  }
  /** Save the current query and reload entire definition as returned from server */
  savePipeline(pipelineModel) {
    const pipeline = pipelineModel.Pipeline;
    const dataSources = pipelineModel.DataSources;
    return this.http.post(_app_administration_services__WEBPACK_IMPORTED_MODULE_0__.webApiQuerySave, {
      pipeline,
      dataSources
    }, {
      params: {
        appId: this.appId,
        Id: pipeline.EntityId.toString()
      }
    }).pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_4__.map)(newPipelineModel => {
      this.#fixPipelineDataSources(newPipelineModel.DataSources);
      return newPipelineModel;
    }));
  }
  /** `top` - fetch first X items */
  runPipeline(id, top) {
    return this.getHttp(_app_administration_services__WEBPACK_IMPORTED_MODULE_0__.webApiQueryRun, {
      params: {
        appId: this.appId,
        id: id.toString(),
        top: top.toString()
      }
    });
  }
  /** `top` - fetch first X items */
  debugStream(id, source, sourceOut, top) {
    return this.getHttp(_app_administration_services__WEBPACK_IMPORTED_MODULE_0__.webApiQueryDebugStream, {
      params: {
        appId: this.appId,
        id: id.toString(),
        from: source,
        out: sourceOut,
        top: top.toString()
      }
    });
  }
  static {
    this.ɵfac = /*@__PURE__*/(() => {
      let ɵQueryDefinitionService_BaseFactory;
      return function QueryDefinitionService_Factory(__ngFactoryType__) {
        return (ɵQueryDefinitionService_BaseFactory || (ɵQueryDefinitionService_BaseFactory = _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵgetInheritedFactory"](QueryDefinitionService)))(__ngFactoryType__ || QueryDefinitionService);
      };
    })();
  }
  static {
    this.ɵprov = /*@__PURE__*/_angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵdefineInjectable"]({
      token: QueryDefinitionService,
      factory: QueryDefinitionService.ɵfac
    });
  }
}

/***/ }),

/***/ 56669:
/*!************************************************************************!*\
  !*** ./projects/eav-ui/src/app/visual-query/visual-query.component.ts ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   VisualQueryComponent: () => (/* binding */ VisualQueryComponent)
/* harmony export */ });
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @angular/common */ 60316);
/* harmony import */ var _angular_material_icon__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @angular/material/icon */ 93840);
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @angular/router */ 95072);
/* harmony import */ var _shared_services_context__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../shared/services/context */ 68873);
/* harmony import */ var _add_explorer_add_explorer_component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./add-explorer/add-explorer.component */ 58323);
/* harmony import */ var _plumb_editor_plumb_editor_component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./plumb-editor/plumb-editor.component */ 47709);
/* harmony import */ var _run_explorer_run_explorer_component__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./run-explorer/run-explorer.component */ 30555);
/* harmony import */ var _services_visual_query_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./services/visual-query.service */ 2628);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @angular/core */ 37580);













const _c0 = a0 => ({
  "active": a0
});
class VisualQueryComponent {
  constructor(context, route, visualQueryService) {
    this.context = context;
    this.route = route;
    this.visualQueryService = visualQueryService;
    this.explorer = {
      run: 'run',
      add: 'add'
    };
    this.activeExplorer = this.explorer.run;
    this.context.init(this.route);
  }
  ngOnInit() {
    this.visualQueryService.init();
  }
  toggleExplorer(explorer) {
    this.activeExplorer = this.activeExplorer === explorer ? null : explorer;
  }
  openHelp() {
    window.open('https://go.2sxc.org/visual-query', '_blank');
  }
  static {
    this.ɵfac = function VisualQueryComponent_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || VisualQueryComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵdirectiveInject"](_shared_services_context__WEBPACK_IMPORTED_MODULE_0__.Context), _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵdirectiveInject"](_angular_router__WEBPACK_IMPORTED_MODULE_6__.ActivatedRoute), _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵdirectiveInject"](_services_visual_query_service__WEBPACK_IMPORTED_MODULE_4__.VisualQueryStateService));
    };
  }
  static {
    this.ɵcmp = /*@__PURE__*/_angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵdefineComponent"]({
      type: VisualQueryComponent,
      selectors: [["app-visual-query"]],
      viewQuery: function VisualQueryComponent_Query(rf, ctx) {
        if (rf & 1) {
          _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵviewQuery"](_plumb_editor_plumb_editor_component__WEBPACK_IMPORTED_MODULE_2__.PlumbEditorComponent, 5);
        }
        if (rf & 2) {
          let _t;
          _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵqueryRefresh"](_t = _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵloadQuery"]()) && (ctx.plumbEditor = _t.first);
        }
      },
      features: [_angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵProvidersFeature"]([_services_visual_query_service__WEBPACK_IMPORTED_MODULE_4__.VisualQueryStateService // Shared State for the entire Visual Query, - init run here
      ])],
      decls: 16,
      vars: 8,
      consts: [[1, "editor-root"], [1, "editor-side-toolbar"], ["tippy", "Run", 1, "button", 3, "click", "ngClass"], ["tippy", "Add", 1, "button", 3, "click", "ngClass"], [1, "spacer"], ["tippy", "Help", 1, "button", 3, "click"], [3, "hidden"]],
      template: function VisualQueryComponent_Template(rf, ctx) {
        if (rf & 1) {
          _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵelement"](0, "router-outlet");
          _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵelementStart"](1, "div", 0)(2, "div", 1)(3, "div", 2);
          _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵlistener"]("click", function VisualQueryComponent_Template_div_click_3_listener() {
            return ctx.toggleExplorer(ctx.explorer.run);
          });
          _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵelementStart"](4, "mat-icon");
          _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵtext"](5, "play_arrow");
          _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵelementEnd"]()();
          _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵelementStart"](6, "div", 3);
          _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵlistener"]("click", function VisualQueryComponent_Template_div_click_6_listener() {
            return ctx.toggleExplorer(ctx.explorer.add);
          });
          _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵelementStart"](7, "mat-icon");
          _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵtext"](8, "add");
          _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵelementEnd"]()();
          _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵelement"](9, "div", 4);
          _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵelementStart"](10, "div", 5);
          _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵlistener"]("click", function VisualQueryComponent_Template_div_click_10_listener() {
            return ctx.openHelp();
          });
          _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵelementStart"](11, "mat-icon");
          _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵtext"](12, "help_outline");
          _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵelementEnd"]()()();
          _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵelement"](13, "app-run-explorer", 6)(14, "app-add-explorer", 6)(15, "app-plumb-editor");
          _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵelementEnd"]();
        }
        if (rf & 2) {
          _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵadvance"](3);
          _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵproperty"]("ngClass", _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵpureFunction1"](4, _c0, ctx.activeExplorer === ctx.explorer.run));
          _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵadvance"](3);
          _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵproperty"]("ngClass", _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵpureFunction1"](6, _c0, ctx.activeExplorer === ctx.explorer.add));
          _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵadvance"](7);
          _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵproperty"]("hidden", ctx.activeExplorer !== ctx.explorer.run);
          _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵadvance"]();
          _angular_core__WEBPACK_IMPORTED_MODULE_5__["ɵɵproperty"]("hidden", ctx.activeExplorer !== ctx.explorer.add);
        }
      },
      dependencies: [_angular_router__WEBPACK_IMPORTED_MODULE_6__.RouterOutlet, _angular_common__WEBPACK_IMPORTED_MODULE_7__.NgClass, _angular_material_icon__WEBPACK_IMPORTED_MODULE_8__.MatIconModule, _angular_material_icon__WEBPACK_IMPORTED_MODULE_8__.MatIcon, _run_explorer_run_explorer_component__WEBPACK_IMPORTED_MODULE_3__.RunExplorerComponent, _add_explorer_add_explorer_component__WEBPACK_IMPORTED_MODULE_1__.AddExplorerComponent, _plumb_editor_plumb_editor_component__WEBPACK_IMPORTED_MODULE_2__.PlumbEditorComponent],
      styles: [".editor-side-toolbar[_ngcontent-%COMP%] {\n  display: flex;\n  flex-direction: column;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInZpc3VhbC1xdWVyeS5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGFBQUE7RUFDQSxzQkFBQTtBQUNGIiwiZmlsZSI6InZpc3VhbC1xdWVyeS5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5lZGl0b3Itc2lkZS10b29sYmFyIHtcclxuICBkaXNwbGF5OiBmbGV4O1xyXG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XHJcbn1cclxuIl19 */\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3Byb2plY3RzL2Vhdi11aS9zcmMvYXBwL3Zpc3VhbC1xdWVyeS92aXN1YWwtcXVlcnkuY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxhQUFBO0VBQ0Esc0JBQUE7QUFDRjtBQUNBLGdZQUFnWSIsInNvdXJjZXNDb250ZW50IjpbIi5lZGl0b3Itc2lkZS10b29sYmFyIHtcclxuICBkaXNwbGF5OiBmbGV4O1xyXG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XHJcbn1cclxuIl0sInNvdXJjZVJvb3QiOiIifQ== */"]
    });
  }
}

/***/ }),

/***/ 58323:
/*!*************************************************************************************!*\
  !*** ./projects/eav-ui/src/app/visual-query/add-explorer/add-explorer.component.ts ***!
  \*************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AddExplorerComponent: () => (/* binding */ AddExplorerComponent)
/* harmony export */ });
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @angular/common */ 60316);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @angular/core */ 37580);
/* harmony import */ var _angular_material_icon__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @angular/material/icon */ 93840);
/* harmony import */ var _angular_material_slide_toggle__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @angular/material/slide-toggle */ 8827);
/* harmony import */ var _shared_constants_eav_constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../shared/constants/eav.constants */ 50052);
/* harmony import */ var _shared_directives_tippy_directive__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../shared/directives/tippy.directive */ 34601);
/* harmony import */ var _shared_helpers_array_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../shared/helpers/array.helpers */ 4981);
/* harmony import */ var _plumb_editor_plumb_editor_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../plumb-editor/plumb-editor.helpers */ 19727);
/* harmony import */ var _services_visual_query_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../services/visual-query.service */ 2628);
/* harmony import */ var _add_explorer_helpers__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./add-explorer.helpers */ 34697);














function AddExplorerComponent_Conditional_0_For_6_Conditional_5_For_2_Template(rf, ctx) {
  if (rf & 1) {
    const _r5 = _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementStart"](0, "div", 7);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵlistener"]("click", function AddExplorerComponent_Conditional_0_For_6_Conditional_5_For_2_Template_div_click_0_listener() {
      const dataSource_r6 = _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵrestoreView"](_r5).$implicit;
      const ctx_r1 = _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵnextContext"](4);
      return _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵresetView"](ctx_r1.addDataSource(dataSource_r6));
    });
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementStart"](1, "mat-icon");
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵtext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementStart"](3, "span");
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵtext"](4);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementEnd"]()();
  }
  if (rf & 2) {
    const dataSource_r6 = ctx.$implicit;
    const ctx_r1 = _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵnextContext"](4);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵproperty"]("tippy", dataSource_r6.UiHint || dataSource_r6.Name);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵtextInterpolate"](dataSource_r6.Icon || ctx_r1.guiTypes.Unknown.Icon);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵtextInterpolate"](dataSource_r6.Name);
  }
}
function AddExplorerComponent_Conditional_0_For_6_Conditional_5_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementStart"](0, "div", 5);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵrepeaterCreate"](1, AddExplorerComponent_Conditional_0_For_6_Conditional_5_For_2_Template, 5, 3, "div", 6, _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵcomponentInstance"]().trackDataSources, true);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementEnd"]();
  }
  if (rf & 2) {
    const group_r4 = _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵnextContext"]().$implicit;
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵadvance"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵrepeater"](group_r4.value);
  }
}
function AddExplorerComponent_Conditional_0_For_6_Template(rf, ctx) {
  if (rf & 1) {
    const _r3 = _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementStart"](0, "div", 4);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵlistener"]("click", function AddExplorerComponent_Conditional_0_For_6_Template_div_click_0_listener() {
      const group_r4 = _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵrestoreView"](_r3).$implicit;
      const ctx_r1 = _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵnextContext"](2);
      return _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵresetView"](ctx_r1.toggleItem(group_r4.key));
    });
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementStart"](1, "mat-icon");
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵtext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementStart"](3, "span");
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵtext"](4);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementEnd"]()();
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵtemplate"](5, AddExplorerComponent_Conditional_0_For_6_Conditional_5_Template, 3, 0, "div", 5);
  }
  if (rf & 2) {
    let tmp_13_0;
    const group_r4 = ctx.$implicit;
    const ctx_r1 = _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵnextContext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵproperty"]("tippy", ctx_r1.guiTypes[group_r4.key].UiHint || group_r4.key);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵtextInterpolate"](ctx_r1.guiTypes[group_r4.key].Icon || ctx_r1.guiTypes.Unknown.Icon);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵtextInterpolate"]((tmp_13_0 = (tmp_13_0 = ctx_r1.guiTypes[group_r4.key].Label) !== null && tmp_13_0 !== undefined ? tmp_13_0 : ctx_r1.guiTypes[group_r4.key].Name) !== null && tmp_13_0 !== undefined ? tmp_13_0 : group_r4.key);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵadvance"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵconditional"](ctx_r1.toggledItems.includes(group_r4.key) ? 5 : -1);
  }
}
function AddExplorerComponent_Conditional_0_Template(rf, ctx) {
  if (rf & 1) {
    const _r1 = _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementStart"](0, "div", 0)(1, "div", 1)(2, "span", 2);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵtext"](3, "Show Advanced");
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementStart"](4, "mat-slide-toggle", 3);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵlistener"]("change", function AddExplorerComponent_Conditional_0_Template_mat_slide_toggle_change_4_listener($event) {
      _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵrestoreView"](_r1);
      const ctx_r1 = _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵnextContext"]();
      return _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵresetView"](ctx_r1.toggleDifficulty($event));
    });
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementEnd"]()();
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵrepeaterCreate"](5, AddExplorerComponent_Conditional_0_For_6_Template, 6, 4, null, null, _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵcomponentInstance"]().trackGroups, true);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵpipe"](7, "keyvalue");
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵelementEnd"]();
  }
  if (rf & 2) {
    const ctx_r1 = _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵnextContext"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵadvance"](5);
    _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵrepeater"](_angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵpipeBind1"](7, 0, ctx_r1.sorted()));
  }
}
class AddExplorerComponent {
  #difficulties;
  #difficulty;
  constructor(visualQueryService) {
    this.visualQueryService = visualQueryService;
    this.toggledItems = [];
    this.guiTypes = _plumb_editor_plumb_editor_helpers__WEBPACK_IMPORTED_MODULE_3__.guiTypes;
    this.#difficulties = _shared_constants_eav_constants__WEBPACK_IMPORTED_MODULE_0__.eavConstants.pipelineDesigner.dataSourceDifficulties;
    this.#difficulty = (0,_angular_core__WEBPACK_IMPORTED_MODULE_6__.signal)(this.#difficulties.default);
    this.sorted = (0,_angular_core__WEBPACK_IMPORTED_MODULE_6__.computed)(() => (0,_add_explorer_helpers__WEBPACK_IMPORTED_MODULE_5__.filterAndSortDataSources)(this.visualQueryService.dataSources(), this.#difficulty()));
  }
  toggleDifficulty(event) {
    const difficulty = event.checked ? this.#difficulties.advanced : this.#difficulties.default;
    this.#difficulty.set(difficulty);
  }
  addDataSource(dataSource) {
    this.visualQueryService.addDataSource(dataSource);
  }
  toggleItem(item) {
    _shared_helpers_array_helpers__WEBPACK_IMPORTED_MODULE_2__.ArrayHelpers.toggleInArray(item, this.toggledItems);
  }
  trackGroups(index, type) {
    return type.key;
  }
  trackDataSources(index, dataSource) {
    return dataSource.PartAssemblyAndType;
  }
  static {
    this.ɵfac = function AddExplorerComponent_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || AddExplorerComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵdirectiveInject"](_services_visual_query_service__WEBPACK_IMPORTED_MODULE_4__.VisualQueryStateService));
    };
  }
  static {
    this.ɵcmp = /*@__PURE__*/_angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵdefineComponent"]({
      type: AddExplorerComponent,
      selectors: [["app-add-explorer"]],
      decls: 1,
      vars: 1,
      consts: [[1, "editor-active-explorer", "fancy-scrollbar-dark"], [1, "eav-show-advanced"], [1, "eav-slide-toggle-label"], ["color", "primary", 3, "change"], ["tippyShowDelay", "750", 1, "collapsible", 3, "click", "tippy"], [1, "list"], ["tippyShowDelay", "750", 1, "list-item", 3, "tippy"], ["tippyShowDelay", "750", 1, "list-item", 3, "click", "tippy"]],
      template: function AddExplorerComponent_Template(rf, ctx) {
        if (rf & 1) {
          _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵtemplate"](0, AddExplorerComponent_Conditional_0_Template, 8, 2, "div", 0);
        }
        if (rf & 2) {
          _angular_core__WEBPACK_IMPORTED_MODULE_6__["ɵɵconditional"](ctx.sorted() ? 0 : -1);
        }
      },
      dependencies: [_angular_material_slide_toggle__WEBPACK_IMPORTED_MODULE_7__.MatSlideToggleModule, _angular_material_slide_toggle__WEBPACK_IMPORTED_MODULE_7__.MatSlideToggle, _angular_material_icon__WEBPACK_IMPORTED_MODULE_8__.MatIconModule, _angular_material_icon__WEBPACK_IMPORTED_MODULE_8__.MatIcon, _angular_common__WEBPACK_IMPORTED_MODULE_9__.KeyValuePipe, _shared_directives_tippy_directive__WEBPACK_IMPORTED_MODULE_1__.TippyDirective],
      styles: [".mat-mdc-slide-toggle[_ngcontent-%COMP%] {\n  margin: 6px;\n  -webkit-user-select: none;\n          user-select: none;\n}\n\n.collapsible[_ngcontent-%COMP%] {\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n  overflow: hidden;\n  white-space: nowrap;\n  -webkit-user-select: none;\n          user-select: none;\n  padding: 3px 0;\n}\n.collapsible[_ngcontent-%COMP%]:hover {\n  background-color: rgb(42, 45, 46);\n}\n.collapsible[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%] {\n  width: 18px;\n  height: 18px;\n  font-size: 18px;\n  margin-left: 8px;\n  margin-right: 4px;\n}\n\n.list[_ngcontent-%COMP%]   .list-item[_ngcontent-%COMP%] {\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n  padding: 4px 0 4px 24px;\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  -webkit-user-select: none;\n          user-select: none;\n}\n.list[_ngcontent-%COMP%]   .list-item[_ngcontent-%COMP%]:hover {\n  background-color: rgb(42, 45, 46);\n}\n.list[_ngcontent-%COMP%]   .list-item[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%] {\n  width: 18px;\n  height: 18px;\n  font-size: 18px;\n  margin-left: 6px;\n  margin-right: 4px;\n}\n\n.eav-show-advanced[_ngcontent-%COMP%] {\n  margin-left: 8px;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkZC1leHBsb3Jlci5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLFdBQUE7RUFDQSx5QkFBQTtVQUFBLGlCQUFBO0FBQ0Y7O0FBRUE7RUFDRSxhQUFBO0VBQ0EsbUJBQUE7RUFDQSxlQUFBO0VBQ0EsZ0JBQUE7RUFDQSxtQkFBQTtFQUNBLHlCQUFBO1VBQUEsaUJBQUE7RUFDQSxjQUFBO0FBQ0Y7QUFDRTtFQUNFLGlDQUFBO0FBQ0o7QUFFRTtFQUNFLFdBQUE7RUFDQSxZQUFBO0VBQ0EsZUFBQTtFQUNBLGdCQUFBO0VBQ0EsaUJBQUE7QUFBSjs7QUFJQTtFQUNFLGFBQUE7RUFDQSxtQkFBQTtFQUNBLGVBQUE7RUFDQSx1QkFBQTtFQUNBLGdCQUFBO0VBQ0EsbUJBQUE7RUFDQSx1QkFBQTtFQUNBLHlCQUFBO1VBQUEsaUJBQUE7QUFERjtBQUdFO0VBQ0UsaUNBQUE7QUFESjtBQUlFO0VBQ0UsV0FBQTtFQUNBLFlBQUE7RUFDQSxlQUFBO0VBQ0EsZ0JBQUE7RUFDQSxpQkFBQTtBQUZKOztBQU1BO0VBQ0UsZ0JBQUE7QUFIRiIsImZpbGUiOiJhZGQtZXhwbG9yZXIuY29tcG9uZW50LnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIubWF0LW1kYy1zbGlkZS10b2dnbGUge1xyXG4gIG1hcmdpbjogNnB4O1xyXG4gIHVzZXItc2VsZWN0OiBub25lO1xyXG59XHJcblxyXG4uY29sbGFwc2libGUge1xyXG4gIGRpc3BsYXk6IGZsZXg7XHJcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICBjdXJzb3I6IHBvaW50ZXI7XHJcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcclxuICB3aGl0ZS1zcGFjZTogbm93cmFwO1xyXG4gIHVzZXItc2VsZWN0OiBub25lO1xyXG4gIHBhZGRpbmc6IDNweCAwO1xyXG5cclxuICAmOmhvdmVyIHtcclxuICAgIGJhY2tncm91bmQtY29sb3I6IHJnYig0MiwgNDUsIDQ2KTtcclxuICB9XHJcblxyXG4gIC5tYXQtaWNvbiB7XHJcbiAgICB3aWR0aDogMThweDtcclxuICAgIGhlaWdodDogMThweDtcclxuICAgIGZvbnQtc2l6ZTogMThweDtcclxuICAgIG1hcmdpbi1sZWZ0OiA4cHg7XHJcbiAgICBtYXJnaW4tcmlnaHQ6IDRweDtcclxuICB9XHJcbn1cclxuXHJcbi5saXN0IC5saXN0LWl0ZW0ge1xyXG4gIGRpc3BsYXk6IGZsZXg7XHJcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICBjdXJzb3I6IHBvaW50ZXI7XHJcbiAgcGFkZGluZzogNHB4IDAgNHB4IDI0cHg7XHJcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcclxuICB3aGl0ZS1zcGFjZTogbm93cmFwO1xyXG4gIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzO1xyXG4gIHVzZXItc2VsZWN0OiBub25lO1xyXG5cclxuICAmOmhvdmVyIHtcclxuICAgIGJhY2tncm91bmQtY29sb3I6IHJnYig0MiwgNDUsIDQ2KTtcclxuICB9XHJcblxyXG4gIC5tYXQtaWNvbiB7XHJcbiAgICB3aWR0aDogMThweDtcclxuICAgIGhlaWdodDogMThweDtcclxuICAgIGZvbnQtc2l6ZTogMThweDtcclxuICAgIG1hcmdpbi1sZWZ0OiA2cHg7XHJcbiAgICBtYXJnaW4tcmlnaHQ6IDRweDtcclxuICB9XHJcbn1cclxuXHJcbi5lYXYtc2hvdy1hZHZhbmNlZCB7XHJcbiAgbWFyZ2luLWxlZnQ6IDhweDtcclxufSJdfQ== */\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3Byb2plY3RzL2Vhdi11aS9zcmMvYXBwL3Zpc3VhbC1xdWVyeS9hZGQtZXhwbG9yZXIvYWRkLWV4cGxvcmVyLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsV0FBQTtFQUNBLHlCQUFBO1VBQUEsaUJBQUE7QUFDRjs7QUFFQTtFQUNFLGFBQUE7RUFDQSxtQkFBQTtFQUNBLGVBQUE7RUFDQSxnQkFBQTtFQUNBLG1CQUFBO0VBQ0EseUJBQUE7VUFBQSxpQkFBQTtFQUNBLGNBQUE7QUFDRjtBQUNFO0VBQ0UsaUNBQUE7QUFDSjtBQUVFO0VBQ0UsV0FBQTtFQUNBLFlBQUE7RUFDQSxlQUFBO0VBQ0EsZ0JBQUE7RUFDQSxpQkFBQTtBQUFKOztBQUlBO0VBQ0UsYUFBQTtFQUNBLG1CQUFBO0VBQ0EsZUFBQTtFQUNBLHVCQUFBO0VBQ0EsZ0JBQUE7RUFDQSxtQkFBQTtFQUNBLHVCQUFBO0VBQ0EseUJBQUE7VUFBQSxpQkFBQTtBQURGO0FBR0U7RUFDRSxpQ0FBQTtBQURKO0FBSUU7RUFDRSxXQUFBO0VBQ0EsWUFBQTtFQUNBLGVBQUE7RUFDQSxnQkFBQTtFQUNBLGlCQUFBO0FBRko7O0FBTUE7RUFDRSxnQkFBQTtBQUhGO0FBSUEsZ2tFQUFna0UiLCJzb3VyY2VzQ29udGVudCI6WyIubWF0LW1kYy1zbGlkZS10b2dnbGUge1xyXG4gIG1hcmdpbjogNnB4O1xyXG4gIHVzZXItc2VsZWN0OiBub25lO1xyXG59XHJcblxyXG4uY29sbGFwc2libGUge1xyXG4gIGRpc3BsYXk6IGZsZXg7XHJcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICBjdXJzb3I6IHBvaW50ZXI7XHJcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcclxuICB3aGl0ZS1zcGFjZTogbm93cmFwO1xyXG4gIHVzZXItc2VsZWN0OiBub25lO1xyXG4gIHBhZGRpbmc6IDNweCAwO1xyXG5cclxuICAmOmhvdmVyIHtcclxuICAgIGJhY2tncm91bmQtY29sb3I6IHJnYig0MiwgNDUsIDQ2KTtcclxuICB9XHJcblxyXG4gIC5tYXQtaWNvbiB7XHJcbiAgICB3aWR0aDogMThweDtcclxuICAgIGhlaWdodDogMThweDtcclxuICAgIGZvbnQtc2l6ZTogMThweDtcclxuICAgIG1hcmdpbi1sZWZ0OiA4cHg7XHJcbiAgICBtYXJnaW4tcmlnaHQ6IDRweDtcclxuICB9XHJcbn1cclxuXHJcbi5saXN0IC5saXN0LWl0ZW0ge1xyXG4gIGRpc3BsYXk6IGZsZXg7XHJcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICBjdXJzb3I6IHBvaW50ZXI7XHJcbiAgcGFkZGluZzogNHB4IDAgNHB4IDI0cHg7XHJcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcclxuICB3aGl0ZS1zcGFjZTogbm93cmFwO1xyXG4gIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzO1xyXG4gIHVzZXItc2VsZWN0OiBub25lO1xyXG5cclxuICAmOmhvdmVyIHtcclxuICAgIGJhY2tncm91bmQtY29sb3I6IHJnYig0MiwgNDUsIDQ2KTtcclxuICB9XHJcblxyXG4gIC5tYXQtaWNvbiB7XHJcbiAgICB3aWR0aDogMThweDtcclxuICAgIGhlaWdodDogMThweDtcclxuICAgIGZvbnQtc2l6ZTogMThweDtcclxuICAgIG1hcmdpbi1sZWZ0OiA2cHg7XHJcbiAgICBtYXJnaW4tcmlnaHQ6IDRweDtcclxuICB9XHJcbn1cclxuXHJcbi5lYXYtc2hvdy1hZHZhbmNlZCB7XHJcbiAgbWFyZ2luLWxlZnQ6IDhweDtcclxufSJdLCJzb3VyY2VSb290IjoiIn0= */"]
    });
  }
}

/***/ }),

/***/ 59117:
/*!*****************************************************************************!*\
  !*** ./projects/eav-ui/src/app/visual-query/plumb-editor/plumber.helper.ts ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Plumber: () => (/* binding */ Plumber)
/* harmony export */ });
/* harmony import */ var _shared_logging__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../shared/logging */ 34435);
/* harmony import */ var _connection_line_colors__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./connection-line-colors */ 96038);
/* harmony import */ var _connections_manager__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./connections-manager */ 72031);
/* harmony import */ var _datasource_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./datasource.helpers */ 9480);
/* harmony import */ var _endpoint_definitions__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./endpoint-definitions */ 54372);
/* harmony import */ var _endpoints_manager__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./endpoints-manager */ 53524);
/* harmony import */ var _jsplumb_instance_manager__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./jsplumb-instance-manager */ 48443);
/* harmony import */ var _lines_decorator__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./lines-decorator */ 51251);
/* harmony import */ var _plumber_constants__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./plumber-constants */ 44051);
/* harmony import */ var _query_data_manager__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./query-data-manager */ 92867);
/* harmony import */ var _wirings_helper__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./wirings.helper */ 83409);











const logSpecs = {
  all: false,
  addEndpoint: true,
  initDomDataSources: false,
  eventConnectionDetached: true,
  eventConnectionAttached: true,
  fields: ['TestIn2']
};
class Plumber {
  #instance;
  #endpointDefs;
  #instanceManager;
  constructor(jsPlumbRoot, query, dataSources, onConnectionsChangedParent, onDragend, onDebugStream, renameDialogParts) {
    this.jsPlumbRoot = jsPlumbRoot;
    this.query = query;
    this.dataSources = dataSources;
    this.onConnectionsChangedParent = onConnectionsChangedParent;
    this.onDragend = onDragend;
    this.onDebugStream = onDebugStream;
    this.log = (0,_shared_logging__WEBPACK_IMPORTED_MODULE_0__.classLogEnabled)({
      Plumber
    }, logSpecs);
    this.lineColors = new _connection_line_colors__WEBPACK_IMPORTED_MODULE_1__.ConnectionLineColors();
    this.queryData = new _query_data_manager__WEBPACK_IMPORTED_MODULE_9__.QueryDataManager(this.jsPlumbRoot, this.query, this.dataSources);
    this.#endpointDefs = new _endpoint_definitions__WEBPACK_IMPORTED_MODULE_4__.EndpointDefinitionsService(query, {
      ...renameDialogParts,
      onConnectionsChanged: () => this.#onConnectionsChanged()
    });
    this.#instanceManager = new _jsplumb_instance_manager__WEBPACK_IMPORTED_MODULE_6__.JsPlumbInstanceManager(this.jsPlumbRoot, this.lineColors);
    this.#instance = this.#instanceManager.instance;
    // requires instance, so must happen after that
    this.lineDecorator = new _lines_decorator__WEBPACK_IMPORTED_MODULE_7__.LinesDecorator(this.#instance, this.query, this.onDebugStream);
    this.connections = new _connections_manager__WEBPACK_IMPORTED_MODULE_2__.ConnectionsManager(this.#instance, this.query, this.dataSources, this.#endpointDefs, () => this.#onConnectionsChanged());
    this.endpoints = new _endpoints_manager__WEBPACK_IMPORTED_MODULE_5__.EndpointsManager(this.#instance, this.#endpointDefs, this.connections, this.queryData);
    // Suspend drawing while initializing
    this.#instance.batch(() => {
      this.#initDomDataSources();
      new _wirings_helper__WEBPACK_IMPORTED_MODULE_10__.WiringsHelper(this, this.#instance, this.queryData).initWirings();
      this.connections.setup();
      this.endpoints.updateAfterChanges();
    });
    // spm NOTE: repaint after initial paint fixes:
    // Error: <svg> attribute width: Expected length, "-Infinity".
    this.#instance.repaintEverything();
  }
  #onConnectionsChanged() {
    // After connection changes, re-check if we need to slant the labels
    this.endpoints.updateAfterChanges();
    // call the parent for storing the data etc.
    this.onConnectionsChangedParent();
  }
  destroy() {
    this.#instanceManager.destroy();
  }
  removeAllEndpoints(pipelineDataSourceGuid) {
    const elementId = (0,_plumber_constants__WEBPACK_IMPORTED_MODULE_8__.domIdOfGuid)(pipelineDataSourceGuid);
    this.connections.bulkDelete = true;
    this.#instance.batch(() => {
      this.#instance.selectEndpoints({
        element: elementId
      }).delete();
    });
    this.connections.bulkDelete = false;
  }
  getStreamsOut() {
    const streamsOut = [];
    this.#instance.selectEndpoints({
      target: (0,_plumber_constants__WEBPACK_IMPORTED_MODULE_8__.domIdOfGuid)('Out')
    }).each(endpoint => {
      streamsOut.push((0,_datasource_helpers__WEBPACK_IMPORTED_MODULE_3__.getEndpointLabel)(endpoint));
    });
    const streamsOutStr = streamsOut.join(',');
    return streamsOutStr;
  }
  /** Create sources, targets and endpoints */
  #initDomDataSources() {
    const l = this.log.fnIf('initDomDataSources');
    for (const queryDs of this.query.DataSources) {
      const {
        domDataSource: domDs,
        definition: dataSource
      } = this.queryData.findDomAndDef(queryDs.EntityGuid, queryDs.PartAssemblyAndType);
      if (!domDs) continue;
      if (this.query.Pipeline.AllowEdit) {
        // WARNING! Must happen before instance.makeSource()
        this.#instance.draggable(domDs, {
          grid: [20, 20],
          stop: event => {
            const element = event.el;
            const queryDsGuid = (0,_plumber_constants__WEBPACK_IMPORTED_MODULE_8__.guidOfDomId)(element.id);
            const position = {
              Top: event.finalPos[1],
              Left: event.finalPos[0]
            };
            setTimeout(() => this.onDragend(queryDsGuid, position));
          }
        });
      }
      // Add Out-Endpoints from Definition
      const outCount = dataSource.Out?.length ?? 0;
      l.a('dataSource.Out', {
        outCount,
        out: dataSource.Out
      });
      dataSource.Out?.forEach(name => {
        this.endpoints.addEndpoint(domDs, name, false, queryDs);
      });
      // Add dynamic Out-Endpoints (if .OutMode is not static)
      if (dataSource.OutMode != 'static') {
        const dynOut = this.#endpointDefs.buildSourceDef(queryDs.EntityGuid);
        this.#instance.makeSource(domDs, dynOut, {
          filter: '.add-endpoint'
        });
      }
      // Add In-Endpoints from Definition
      const inCount = dataSource.In?.length ?? 0;
      l.a('dataSource.In', {
        inCount,
        in: dataSource.In
      });
      dataSource.In?.forEach(name => {
        this.endpoints.addEndpoint(domDs, name, true, queryDs);
      });
      // Make DataSource a Target for new Endpoints (if .In is an Array)
      if (dataSource.In) {
        const targetEndpointUnlimited = this.#endpointDefs.buildTargetDef(queryDs.EntityGuid);
        targetEndpointUnlimited.maxConnections = -1;
        this.#instance.makeTarget(domDs, targetEndpointUnlimited);
      }
    }
    l.end();
  }
}

/***/ }),

/***/ 60453:
/*!*************************************************************************************!*\
  !*** ./projects/eav-ui/src/app/visual-query/query-result/query-result.component.ts ***!
  \*************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   QueryResultComponent: () => (/* binding */ QueryResultComponent)
/* harmony export */ });
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @angular/common */ 60316);
/* harmony import */ var _angular_material_button__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/material/button */ 84175);
/* harmony import */ var _angular_material_dialog__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/material/dialog */ 12587);
/* harmony import */ var _angular_material_icon__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @angular/material/icon */ 93840);
/* harmony import */ var _angular_material_tabs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @angular/material/tabs */ 38223);
/* harmony import */ var _services_visual_query_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../services/visual-query.service */ 2628);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ 37580);












function QueryResultComponent_Conditional_4_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](0);
  }
  if (rf & 2) {
    const ctx_r0 = _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵnextContext"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtextInterpolate2"](" for Stream: \"", ctx_r0.debugStream.name, "\" on Source: \"", ctx_r0.debugStream.sourceName, "\" ");
  }
}
function QueryResultComponent_div_13_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](0, "div", 13)(1, "span");
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](2, "Results");
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]()();
  }
}
function QueryResultComponent_Conditional_16_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](0, " Showing All results ");
  }
}
function QueryResultComponent_Conditional_17_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](0);
  }
  if (rf & 2) {
    const ctx_r0 = _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵnextContext"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtextInterpolate1"](" Showing top ", ctx_r0.top, " results ");
  }
}
function QueryResultComponent_For_20_Conditional_2_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](0, " All ");
  }
}
function QueryResultComponent_For_20_Conditional_3_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](0);
  }
  if (rf & 2) {
    const option_r3 = _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵnextContext"]().$implicit;
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtextInterpolate1"](" ", option_r3, " ");
  }
}
function QueryResultComponent_For_20_Template(rf, ctx) {
  if (rf & 1) {
    const _r2 = _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵgetCurrentView"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](0, "button", 14);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵlistener"]("click", function QueryResultComponent_For_20_Template_button_click_0_listener() {
      const option_r3 = _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵrestoreView"](_r2).$implicit;
      const ctx_r0 = _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵnextContext"]();
      return _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵresetView"](ctx_r0.show(option_r3));
    });
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](1, " Show ");
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](2, QueryResultComponent_For_20_Conditional_2_Template, 1, 0)(3, QueryResultComponent_For_20_Conditional_3_Template, 1, 1);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
  }
  if (rf & 2) {
    const option_r3 = ctx.$implicit;
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵconditional"](option_r3 === 0 ? 2 : -1);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵconditional"](option_r3 !== 0 ? 3 : -1);
  }
}
function QueryResultComponent_Conditional_24_div_1_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](0, "div", 16)(1, "span");
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](2, "Parameters");
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]()();
  }
}
function QueryResultComponent_Conditional_24_For_5_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](0, "li");
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
  }
  if (rf & 2) {
    const param_r4 = ctx.$implicit;
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtextInterpolate"](param_r4);
  }
}
function QueryResultComponent_Conditional_24_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](0, "mat-tab");
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](1, QueryResultComponent_Conditional_24_div_1_Template, 3, 0, "div", 15);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](2, "div", 11)(3, "ul");
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵrepeaterCreate"](4, QueryResultComponent_Conditional_24_For_5_Template, 2, 1, "li", null, _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵrepeaterTrackByIdentity"]);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]()()();
  }
  if (rf & 2) {
    const ctx_r0 = _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵnextContext"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](4);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵrepeater"](ctx_r0.parameters);
  }
}
function QueryResultComponent_div_26_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](0, "div", 17)(1, "span");
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](2, "Sources");
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]()();
  }
}
function QueryResultComponent_For_39_Conditional_2_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](0, "div");
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
  }
  if (rf & 2) {
    const source_r5 = _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵnextContext"]().$implicit;
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtextInterpolate"](source_r5.value.Definition == null ? null : source_r5.value.Definition.Name);
  }
}
function QueryResultComponent_For_39_For_10_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](0, "li")(1, "b");
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](3, "=");
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](4, "em");
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](5);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]()();
  }
  if (rf & 2) {
    const config_r6 = ctx.$implicit;
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtextInterpolate"](config_r6.key);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtextInterpolate"](config_r6.value);
  }
}
function QueryResultComponent_For_39_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](0, "tr")(1, "td");
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](2, QueryResultComponent_For_39_Conditional_2_Template, 2, 1, "div");
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](3, "pre");
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](4);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]()();
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](5, "td");
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](6);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](7, "td")(8, "ol");
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵrepeaterCreate"](9, QueryResultComponent_For_39_For_10_Template, 6, 2, "li", null, _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵrepeaterTrackByIdentity"]);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵpipe"](11, "keyvalue");
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]()();
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](12, "td");
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](13);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]()();
  }
  if (rf & 2) {
    const source_r5 = ctx.$implicit;
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵconditional"]((source_r5.value.Definition == null ? null : source_r5.value.Definition.Name) ? 2 : -1);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtextInterpolate"](source_r5.value.Guid);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtextInterpolate"](source_r5.value.Type);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵrepeater"](_angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵpipeBind1"](11, 4, source_r5.value.Configuration));
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](4);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtextInterpolate"](source_r5.value.Error);
  }
}
function QueryResultComponent_div_42_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](0, "div", 18)(1, "span");
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](2, "Streams");
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]()();
  }
}
function QueryResultComponent_For_55_Template(rf, ctx) {
  if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](0, "tr")(1, "td")(2, "pre");
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]()();
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](4, "td")(5, "pre");
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](6);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]()();
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](7, "td");
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](8);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](9, "td");
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](10);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]()();
  }
  if (rf & 2) {
    const stream_r7 = ctx.$implicit;
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtextInterpolate"](stream_r7.Source + ":" + stream_r7.SourceOut);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](3);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtextInterpolate"](stream_r7.Target + ":" + stream_r7.TargetIn);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtextInterpolate"](stream_r7.Count);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtextInterpolate"](stream_r7.Error);
  }
}
class QueryResultComponent {
  constructor(dialogData, dialog, visualQueryService) {
    this.dialogData = dialogData;
    this.dialog = dialog;
    this.visualQueryService = visualQueryService;
  }
  ngOnInit() {
    const pipeline = this.visualQueryService.pipelineModel().Pipeline;
    const params = (pipeline.Params?.split('\n') ?? []).filter(el => !!el);
    const testParams = (pipeline.TestParameters?.split('\n') ?? []).filter(el => !!el);
    this.parameters = [].concat(params, testParams);
    this.timeUsed = this.dialogData.result.QueryTimer.Milliseconds;
    this.ticksUsed = this.dialogData.result.QueryTimer.Ticks;
    this.top = this.dialogData.top;
    this.optionsForTop = [25, 100, 1000, 0];
    this.result = this.dialogData.result.Query;
    this.debugStream = this.dialogData.debugStream;
    this.sources = this.dialogData.result.Sources;
    this.streams = this.dialogData.result.Streams;
  }
  closeDialog() {
    this.dialog.close();
  }
  show(top) {
    if (top === this.top) return;
    if (this.debugStream) {
      this.visualQueryService.debugStream(this.debugStream.original, top);
    } else {
      this.visualQueryService.runPipeline(top);
    }
    this.closeDialog();
  }
  static {
    this.ɵfac = function QueryResultComponent_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || QueryResultComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdirectiveInject"](_angular_material_dialog__WEBPACK_IMPORTED_MODULE_2__.MAT_DIALOG_DATA), _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdirectiveInject"](_angular_material_dialog__WEBPACK_IMPORTED_MODULE_2__.MatDialogRef), _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdirectiveInject"](_services_visual_query_service__WEBPACK_IMPORTED_MODULE_0__.VisualQueryStateService));
    };
  }
  static {
    this.ɵcmp = /*@__PURE__*/_angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵdefineComponent"]({
      type: QueryResultComponent,
      selectors: [["app-query-result"]],
      decls: 56,
      vars: 11,
      consts: [[1, "eav-dialog"], [1, "eav-dialog-header"], [1, "eav-dialog-header__title"], ["mat-icon-button", "", "tippy", "Close dialog", 3, "click"], [1, "eav-dialog-content"], ["dynamicHeight", "", "color", "accent", 1, "eav-tab-group"], ["class", "mat-tab-label-box", "tippy", "Results", 4, "matTabLabel"], [1, "eav-tab-description"], ["mat-button", ""], [1, "eav-pre-scroll"], ["class", "mat-tab-label-box", "tippy", "Sources", 4, "matTabLabel"], [1, "eav-tab-content"], ["class", "mat-tab-label-box", "tippy", "Streams", 4, "matTabLabel"], ["tippy", "Results", 1, "mat-tab-label-box"], ["mat-button", "", 3, "click"], ["class", "mat-tab-label-box", "tippy", "Parameters", 4, "matTabLabel"], ["tippy", "Parameters", 1, "mat-tab-label-box"], ["tippy", "Sources", 1, "mat-tab-label-box"], ["tippy", "Streams", 1, "mat-tab-label-box"]],
      template: function QueryResultComponent_Template(rf, ctx) {
        if (rf & 1) {
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](0, "div", 0)(1, "div", 1)(2, "div", 2);
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](3, " Query Results ");
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](4, QueryResultComponent_Conditional_4_Template, 1, 2);
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](5, "button", 3);
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵlistener"]("click", function QueryResultComponent_Template_button_click_5_listener() {
            return ctx.closeDialog();
          });
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](6, "mat-icon");
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](7, "close");
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]()()();
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](8, "div", 4)(9, "p");
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](10);
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](11, "mat-tab-group", 5)(12, "mat-tab");
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](13, QueryResultComponent_div_13_Template, 3, 0, "div", 6);
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](14, "div", 7)(15, "div");
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](16, QueryResultComponent_Conditional_16_Template, 1, 0)(17, QueryResultComponent_Conditional_17_Template, 1, 1);
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](18, "div");
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵrepeaterCreate"](19, QueryResultComponent_For_20_Template, 4, 2, "button", 8, _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵrepeaterTrackByIdentity"]);
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]()();
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](21, "pre", 9);
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](22);
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵpipe"](23, "json");
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]()();
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](24, QueryResultComponent_Conditional_24_Template, 6, 0, "mat-tab");
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](25, "mat-tab");
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](26, QueryResultComponent_div_26_Template, 3, 0, "div", 10);
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](27, "div", 11)(28, "table")(29, "tr")(30, "th");
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](31, "Name and Guid");
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](32, "th");
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](33, "Type");
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](34, "th");
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](35, "Configuration");
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](36, "th");
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](37, "Error");
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]()();
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵrepeaterCreate"](38, QueryResultComponent_For_39_Template, 14, 6, "tr", null, _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵrepeaterTrackByIdentity"]);
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵpipe"](40, "keyvalue");
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]()()();
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](41, "mat-tab");
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtemplate"](42, QueryResultComponent_div_42_Template, 3, 0, "div", 12);
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](43, "div", 11)(44, "table")(45, "tr")(46, "th");
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](47, "Source");
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](48, "th");
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](49, "Target");
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](50, "th");
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](51, "Items");
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]();
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementStart"](52, "th");
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtext"](53, "Error");
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]()();
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵrepeaterCreate"](54, QueryResultComponent_For_55_Template, 11, 4, "tr", null, _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵrepeaterTrackByIdentity"]);
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵelementEnd"]()()()()()();
        }
        if (rf & 2) {
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](4);
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵconditional"](ctx.debugStream ? 4 : -1);
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](6);
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtextInterpolate2"](" The Full result was logged to the Browser Console. Further down you'll find more debug-infos. Executed in ", ctx.timeUsed, "ms (", ctx.ticksUsed, " ticks) ");
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](6);
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵconditional"](ctx.top === 0 ? 16 : -1);
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"]();
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵconditional"](ctx.top !== 0 ? 17 : -1);
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](2);
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵrepeater"](ctx.optionsForTop);
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](3);
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵtextInterpolate"](_angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵpipeBind1"](23, 7, ctx.result));
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](2);
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵconditional"]((ctx.parameters == null ? null : ctx.parameters.length) ? 24 : -1);
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](14);
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵrepeater"](_angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵpipeBind1"](40, 9, ctx.sources));
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵadvance"](16);
          _angular_core__WEBPACK_IMPORTED_MODULE_1__["ɵɵrepeater"](ctx.streams);
        }
      },
      dependencies: [_angular_material_button__WEBPACK_IMPORTED_MODULE_3__.MatButtonModule, _angular_material_button__WEBPACK_IMPORTED_MODULE_3__.MatButton, _angular_material_button__WEBPACK_IMPORTED_MODULE_3__.MatIconButton, _angular_material_icon__WEBPACK_IMPORTED_MODULE_4__.MatIconModule, _angular_material_icon__WEBPACK_IMPORTED_MODULE_4__.MatIcon, _angular_material_tabs__WEBPACK_IMPORTED_MODULE_5__.MatTabsModule, _angular_material_tabs__WEBPACK_IMPORTED_MODULE_5__.MatTabLabel, _angular_material_tabs__WEBPACK_IMPORTED_MODULE_5__.MatTab, _angular_material_tabs__WEBPACK_IMPORTED_MODULE_5__.MatTabGroup, _angular_common__WEBPACK_IMPORTED_MODULE_6__.JsonPipe, _angular_common__WEBPACK_IMPORTED_MODULE_6__.KeyValuePipe],
      styles: [".eav-dialog[_ngcontent-%COMP%] {\n  overflow: hidden;\n}\n\n.eav-tab-group[_ngcontent-%COMP%] {\n  padding: 0px;\n}\n\n.eav-tab-content[_ngcontent-%COMP%] {\n  height: calc(100vh - 268px);\n  overflow-y: auto;\n}\n\n.eav-tab-description[_ngcontent-%COMP%] {\n  display: flex;\n  justify-content: space-between;\n  align-items: baseline;\n  margin-right: 1rem;\n  padding: 1rem;\n  font-size: 16px;\n  line-height: 1.5;\n}\n\n.eav-pre-scroll[_ngcontent-%COMP%] {\n  height: calc(100vh - 268px - 80px);\n  overflow-y: auto;\n}\n\npre[_ngcontent-%COMP%] {\n  display: block;\n  padding: 9.5px;\n  margin: 0 10px 0 0;\n  font-size: 13px;\n  line-height: 1.42857143;\n  color: #333;\n  word-break: break-all;\n  word-wrap: break-word;\n  background-color: #f5f5f5;\n  border: 1px solid #ccc;\n  border-radius: 4px;\n  overflow-x: auto;\n}\n\nth[_ngcontent-%COMP%] {\n  text-align: left;\n}\n\ntd[_ngcontent-%COMP%] {\n  vertical-align: baseline;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInF1ZXJ5LXJlc3VsdC5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGdCQUFBO0FBQ0Y7O0FBRUE7RUFDRSxZQUFBO0FBQ0Y7O0FBRUE7RUFDRSwyQkFBQTtFQUNBLGdCQUFBO0FBQ0Y7O0FBRUE7RUFDRSxhQUFBO0VBQ0EsOEJBQUE7RUFDQSxxQkFBQTtFQUNBLGtCQUFBO0VBQ0EsYUFBQTtFQUNBLGVBQUE7RUFDQSxnQkFBQTtBQUNGOztBQUVBO0VBQ0Usa0NBQUE7RUFDQSxnQkFBQTtBQUNGOztBQUdBO0VBQ0UsY0FBQTtFQUNBLGNBQUE7RUFDQSxrQkFBQTtFQUNBLGVBQUE7RUFDQSx1QkFBQTtFQUNBLFdBQUE7RUFDQSxxQkFBQTtFQUNBLHFCQUFBO0VBQ0EseUJBQUE7RUFDQSxzQkFBQTtFQUNBLGtCQUFBO0VBQ0EsZ0JBQUE7QUFBRjs7QUFHQTtFQUNFLGdCQUFBO0FBQUY7O0FBR0E7RUFDRSx3QkFBQTtBQUFGIiwiZmlsZSI6InF1ZXJ5LXJlc3VsdC5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5lYXYtZGlhbG9nIHtcclxuICBvdmVyZmxvdzogaGlkZGVuO1xyXG59XHJcblxyXG4uZWF2LXRhYi1ncm91cCB7XHJcbiAgcGFkZGluZzogMHB4O1xyXG59XHJcblxyXG4uZWF2LXRhYi1jb250ZW50IHtcclxuICBoZWlnaHQ6IGNhbGMoMTAwdmggLSAyNjhweCk7XHJcbiAgb3ZlcmZsb3cteTogYXV0bztcclxufVxyXG5cclxuLmVhdi10YWItZGVzY3JpcHRpb24ge1xyXG4gIGRpc3BsYXk6IGZsZXg7XHJcbiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xyXG4gIGFsaWduLWl0ZW1zOiBiYXNlbGluZTtcclxuICBtYXJnaW4tcmlnaHQ6IDFyZW07XHJcbiAgcGFkZGluZzogMXJlbTtcclxuICBmb250LXNpemU6IDE2cHg7XHJcbiAgbGluZS1oZWlnaHQ6IDEuNTtcclxufVxyXG5cclxuLmVhdi1wcmUtc2Nyb2xsIHtcclxuICBoZWlnaHQ6IGNhbGMoMTAwdmggLSAyNjhweCAtIDgwcHgpO1xyXG4gIG92ZXJmbG93LXk6IGF1dG87XHJcblxyXG59XHJcblxyXG5wcmUge1xyXG4gIGRpc3BsYXk6IGJsb2NrO1xyXG4gIHBhZGRpbmc6IDkuNXB4O1xyXG4gIG1hcmdpbjogMCAxMHB4IDAgMDtcclxuICBmb250LXNpemU6IDEzcHg7XHJcbiAgbGluZS1oZWlnaHQ6IDEuNDI4NTcxNDM7XHJcbiAgY29sb3I6ICMzMzM7XHJcbiAgd29yZC1icmVhazogYnJlYWstYWxsO1xyXG4gIHdvcmQtd3JhcDogYnJlYWstd29yZDtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjVmNWY1O1xyXG4gIGJvcmRlcjogMXB4IHNvbGlkICNjY2M7XHJcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xyXG4gIG92ZXJmbG93LXg6IGF1dG87XHJcbn1cclxuXHJcbnRoIHtcclxuICB0ZXh0LWFsaWduOiBsZWZ0O1xyXG59XHJcblxyXG50ZCB7XHJcbiAgdmVydGljYWwtYWxpZ246IGJhc2VsaW5lO1xyXG59XHJcbiJdfQ== */\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3Byb2plY3RzL2Vhdi11aS9zcmMvYXBwL3Zpc3VhbC1xdWVyeS9xdWVyeS1yZXN1bHQvcXVlcnktcmVzdWx0LmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsZ0JBQUE7QUFDRjs7QUFFQTtFQUNFLFlBQUE7QUFDRjs7QUFFQTtFQUNFLDJCQUFBO0VBQ0EsZ0JBQUE7QUFDRjs7QUFFQTtFQUNFLGFBQUE7RUFDQSw4QkFBQTtFQUNBLHFCQUFBO0VBQ0Esa0JBQUE7RUFDQSxhQUFBO0VBQ0EsZUFBQTtFQUNBLGdCQUFBO0FBQ0Y7O0FBRUE7RUFDRSxrQ0FBQTtFQUNBLGdCQUFBO0FBQ0Y7O0FBR0E7RUFDRSxjQUFBO0VBQ0EsY0FBQTtFQUNBLGtCQUFBO0VBQ0EsZUFBQTtFQUNBLHVCQUFBO0VBQ0EsV0FBQTtFQUNBLHFCQUFBO0VBQ0EscUJBQUE7RUFDQSx5QkFBQTtFQUNBLHNCQUFBO0VBQ0Esa0JBQUE7RUFDQSxnQkFBQTtBQUFGOztBQUdBO0VBQ0UsZ0JBQUE7QUFBRjs7QUFHQTtFQUNFLHdCQUFBO0FBQUY7QUFDQSxnNURBQWc1RCIsInNvdXJjZXNDb250ZW50IjpbIi5lYXYtZGlhbG9nIHtcclxuICBvdmVyZmxvdzogaGlkZGVuO1xyXG59XHJcblxyXG4uZWF2LXRhYi1ncm91cCB7XHJcbiAgcGFkZGluZzogMHB4O1xyXG59XHJcblxyXG4uZWF2LXRhYi1jb250ZW50IHtcclxuICBoZWlnaHQ6IGNhbGMoMTAwdmggLSAyNjhweCk7XHJcbiAgb3ZlcmZsb3cteTogYXV0bztcclxufVxyXG5cclxuLmVhdi10YWItZGVzY3JpcHRpb24ge1xyXG4gIGRpc3BsYXk6IGZsZXg7XHJcbiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xyXG4gIGFsaWduLWl0ZW1zOiBiYXNlbGluZTtcclxuICBtYXJnaW4tcmlnaHQ6IDFyZW07XHJcbiAgcGFkZGluZzogMXJlbTtcclxuICBmb250LXNpemU6IDE2cHg7XHJcbiAgbGluZS1oZWlnaHQ6IDEuNTtcclxufVxyXG5cclxuLmVhdi1wcmUtc2Nyb2xsIHtcclxuICBoZWlnaHQ6IGNhbGMoMTAwdmggLSAyNjhweCAtIDgwcHgpO1xyXG4gIG92ZXJmbG93LXk6IGF1dG87XHJcblxyXG59XHJcblxyXG5wcmUge1xyXG4gIGRpc3BsYXk6IGJsb2NrO1xyXG4gIHBhZGRpbmc6IDkuNXB4O1xyXG4gIG1hcmdpbjogMCAxMHB4IDAgMDtcclxuICBmb250LXNpemU6IDEzcHg7XHJcbiAgbGluZS1oZWlnaHQ6IDEuNDI4NTcxNDM7XHJcbiAgY29sb3I6ICMzMzM7XHJcbiAgd29yZC1icmVhazogYnJlYWstYWxsO1xyXG4gIHdvcmQtd3JhcDogYnJlYWstd29yZDtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjVmNWY1O1xyXG4gIGJvcmRlcjogMXB4IHNvbGlkICNjY2M7XHJcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xyXG4gIG92ZXJmbG93LXg6IGF1dG87XHJcbn1cclxuXHJcbnRoIHtcclxuICB0ZXh0LWFsaWduOiBsZWZ0O1xyXG59XHJcblxyXG50ZCB7XHJcbiAgdmVydGljYWwtYWxpZ246IGJhc2VsaW5lO1xyXG59XHJcbiJdLCJzb3VyY2VSb290IjoiIn0= */"]
    });
  }
}

/***/ }),

/***/ 72031:
/*!**********************************************************************************!*\
  !*** ./projects/eav-ui/src/app/visual-query/plumb-editor/connections-manager.ts ***!
  \**********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ConnectionsManager: () => (/* binding */ ConnectionsManager)
/* harmony export */ });
/* harmony import */ var _shared_logging__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../shared/logging */ 34435);
/* harmony import */ var _datasource_helpers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./datasource.helpers */ 9480);
/* harmony import */ var _plumber_constants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./plumber-constants */ 44051);



const logSpecs = {
  all: false,
  eventConnectionDetached: false,
  eventConnectionAttached: false
};
class ConnectionsManager {
  constructor(instance, pipelineModel, dataSources, endpointsSvc, onConnectionsChanged) {
    this.instance = instance;
    this.pipelineModel = pipelineModel;
    this.dataSources = dataSources;
    this.endpointsSvc = endpointsSvc;
    this.onConnectionsChanged = onConnectionsChanged;
    this.log = (0,_shared_logging__WEBPACK_IMPORTED_MODULE_0__.classLogEnabled)({
      ConnectionsManager
    }, logSpecs);
    this.bulkDelete = false;
  }
  /**
   * Handle attach/detach of connections
   */
  setup() {
    this.instance.bind('connectionDetached', info => this.handleDetached(info));
    this.instance.bind('connection', info => this.handleAttached(info));
  }
  getAll() {
    const connectionInfos = this.instance.getAllConnections().map(connection => ({
      From: (0,_plumber_constants__WEBPACK_IMPORTED_MODULE_2__.guidOfDomId)(connection.sourceId),
      Out: (0,_datasource_helpers__WEBPACK_IMPORTED_MODULE_1__.getEndpointLabel)(connection.endpoints[0]),
      To: (0,_plumber_constants__WEBPACK_IMPORTED_MODULE_2__.guidOfDomId)(connection.targetId),
      In: (0,_datasource_helpers__WEBPACK_IMPORTED_MODULE_1__.getEndpointLabel)(connection.endpoints[1])
    }));
    return connectionInfos;
  }
  handleDetached(info) {
    const l = this.log.fnIf('eventConnectionDetached');
    if (this.bulkDelete) return l.end('in bulk-delete mode, exit');
    const domDataSource = info.target;
    const pipelineDataSource = this.pipelineModel.DataSources.find(pipelineDS => pipelineDS.EntityGuid === (0,_plumber_constants__WEBPACK_IMPORTED_MODULE_2__.guidOfDomId)(domDataSource.id));
    const dataSource = (0,_datasource_helpers__WEBPACK_IMPORTED_MODULE_1__.findDefByType)(this.dataSources, pipelineDataSource.PartAssemblyAndType);
    const label = (0,_datasource_helpers__WEBPACK_IMPORTED_MODULE_1__.getEndpointLabel)(info.targetEndpoint);
    const isDynamic = !dataSource.In.some(name => this.endpointsSvc.getInfo(name, false).name === label);
    if (isDynamic) this.instance.deleteEndpoint(info.targetEndpoint);
    setTimeout(() => this.onConnectionsChanged());
    l.end('done');
  }
  handleAttached(info) {
    const l = this.log.fnIf('eventConnectionAttached');
    // This seems to handle a special detach case, but ATM 2025-04-03 I can't see where it would ever hit
    if (info.sourceId === info.targetId) {
      setTimeout(() => {
        this.instance.deleteConnection(info.connection, {
          fireEvent: false
        });
        setTimeout(() => this.onConnectionsChanged());
      });
      return l.end('self-connection, will delete and exit');
    }
    const targetEndpointOverlay = info.targetEndpoint.getOverlay('endpointLabel');
    const targetLabel = targetEndpointOverlay.getLabel();
    const endpoints = this.instance.getEndpoints(info.target.id);
    const targetHasSameLabel = endpoints.some(ep => {
      const label = (0,_datasource_helpers__WEBPACK_IMPORTED_MODULE_1__.getEndpointLabel)(ep);
      return label === targetLabel && info.targetEndpoint.id !== ep.id && ep.canvas.classList.contains('targetEndpoint');
    });
    // If label already exists, create a PleaseRename label
    if (targetHasSameLabel) targetEndpointOverlay.setLabel(`PleaseRename${Math.floor(Math.random() * 99999)}`);
    setTimeout(() => this.onConnectionsChanged());
    l.end('done', {
      targetLabel,
      targetHasSameLabel
    });
  }
}

/***/ }),

/***/ 78465:
/*!***********************************************************************************!*\
  !*** ./projects/eav-ui/src/app/visual-query/run-explorer/run-explorer.helpers.ts ***!
  \***********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   calculateWarnings: () => (/* binding */ calculateWarnings)
/* harmony export */ });
/**
 * Check if there are special warnings the developer should know.
 * Typically when the test ModuleId is different from the one we're currently working on
 */
function calculateWarnings(pipelineModel, context) {
  if (!pipelineModel) return [];
  const warnings = [];
  try {
    const queryParams = pipelineModel.Pipeline.Params?.split(/\r?\n/) || [];
    const testParams = pipelineModel.Pipeline.TestParameters?.split(/\r?\n/) || [];
    queryParams.forEach(param => {
      param = param?.trim();
      if (!param) return;
      // Check if the syntax on Query Parameters is off.
      // It should contain [...]=...
      // But it's easy to forget the [ and ] brackets
      const paramSyntax = /^[a-zA-Z0-9]+=(.*)$/gmi;
      const matched = paramSyntax.test(param);
      if (!matched) {
        warnings.push(`
          A <em>Query Parameter</em> seems wrong: <br>
          <code>${param}</code> <br>
          It should use the syntax: <br>
          <code>key=value</code> <br>
          or resolve to a token like: <br>
          <code>key=[source:key]</code>
        `);
      }
    });
    testParams.forEach(param => {
      param = param?.trim();
      if (!param) return;
      // Check if the syntax on Test Parameters is off.
      // It should contain [...]=...
      // But it's easy to forget the [ and ] brackets
      const testParamSyntax = /^\[[a-zA-Z]+:[a-zA-Z0-9]+\]=(.*)$/gmi;
      const matched = testParamSyntax.test(param);
      if (!matched) {
        warnings.push(`
          A <em>Test Parameter</em> seems wrong: <br>
          <code>${param}</code> <br>
          It should use the syntax: <br>
          <code>[source:key]=value</code>
        `);
      }
      // Check if we should show the warning about the test ModuleId.
      // This is because in the old days, the ModuleId wasn't auto-filled, so people had to add it as a test value.
      // Now it's not necessary any more
      const midRegex = /^\[module:id\]=([0-9]*)$/gmi;
      const midMatch = midRegex.exec(param);
      if (midMatch) {
        const testMid = midMatch[1];
        const urlMid = context.moduleId?.toString();
        if (testMid !== urlMid) {
          warnings.push(`
            Your test ModuleId (${testMid}) is different from the current ModuleId (${urlMid}).<br>
            Note that 2sxc automatically provides the ModuleId - so you usually do not need to set it
          `);
        }
      }
      const oldMidRegex = /^\[module:moduleid\]=([0-9]*)$/gmi;
      const oldMidMatch = oldMidRegex.exec(param);
      if (oldMidMatch) {
        warnings.push(`
          You are using deprecated [Module:ModuleId] test parameter.<br>
          Please use [Module:Id]
        `);
      }
    });
  } catch (error) {
    console.error('Something went wrong in calculateWarnings for params', error);
  }
  return warnings;
}

/***/ }),

/***/ 83409:
/*!*****************************************************************************!*\
  !*** ./projects/eav-ui/src/app/visual-query/plumb-editor/wirings.helper.ts ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   WiringsHelper: () => (/* binding */ WiringsHelper)
/* harmony export */ });
/* harmony import */ var _shared_logging__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../shared/logging */ 34435);
/* harmony import */ var _plumber_constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./plumber-constants */ 44051);


const logSpecs = {
  all: false,
  initWirings: true,
  ensureWireEndpointExists: true,
  findDataSourceInDom: true,
  fields: ['TestIn2', '*']
};
class WiringsHelper {
  constructor(plumber, instance, queryData) {
    this.plumber = plumber;
    this.instance = instance;
    this.queryData = queryData;
    this.log = (0,_shared_logging__WEBPACK_IMPORTED_MODULE_0__.classLogEnabled)({
      WiringsHelper
    }, logSpecs);
  }
  initWirings() {
    const l = this.log.fnIf('initWirings');
    const wiringsRaw = this.queryData.query.Pipeline.StreamWiring;
    if (!wiringsRaw) return l.end('no wirings');
    const wirings = wiringsRaw.map(wire => {
      // read connections from Pipeline
      const outDsDomId = (0,_plumber_constants__WEBPACK_IMPORTED_MODULE_1__.domIdOfGuid)(wire.From);
      const outPointDomId = outDsDomId + '_out_' + wire.Out;
      const inDsDomId = (0,_plumber_constants__WEBPACK_IMPORTED_MODULE_1__.domIdOfGuid)(wire.To);
      const inPointDomId = inDsDomId + '_in_' + wire.In;
      return {
        outPointDomId,
        inPointDomId,
        wire
      };
    });
    l.a('wirings', {
      wireDetails: wirings
    });
    // Build all the Endpoints which don't exist yet based on the wirings
    wirings.forEach(w => {
      // Ensure Out-Endpoint exist
      this.#ensureWireEndpointExists(w.outPointDomId, w.wire.From, w.wire.Out, false);
      // Ensure In-Endpoint exist
      this.#ensureWireEndpointExists(w.inPointDomId, w.wire.To, w.wire.In, true);
    });
    // Connect all the wirings
    wirings.forEach(w => this.#connect(w.outPointDomId, w.inPointDomId));
    this.instance.repaintEverything();
    l.end();
  }
  #connect(outDomId, inDomId) {
    try {
      this.instance.connect({
        uuids: [outDomId, inDomId],
        paintStyle: this.plumber.lineColors.nextLinePaintStyle(outDomId)
      });
    } catch (e) {
      console.error({
        message: 'Connection failed',
        from: outDomId,
        to: inDomId
      });
    }
  }
  #ensureWireEndpointExists(endpointId, sourceGuid, name, isIn) {
    const l = this.log.fnIfInList('ensureWireEndpointExists', 'fields', name, {
      endpointId,
      sourceGuid,
      name,
      isIn
    });
    // Find data source infos & DOM, if not found, do nothing
    const set = this.#findDataSourceInDom(endpointId, sourceGuid, name);
    if (set == null) return l.r(set, "set null");
    // const name = isIn ? wire.In : wire.Out;
    this.plumber.endpoints.addEndpoint(set.domDataSource, name, isIn, set.dataSource);
    return l.r(set, 'ok');
  }
  #findDataSourceInDom(endpointId, sourceGuid, name) {
    const l = this.log.fnIfInList('findDataSourceInDom', 'fields', name, {
      endpointId,
      sourceGuid,
      name
    });
    // if exists, do nothing
    if (this.instance.getEndpoint(endpointId)) return l.r(null, "endpoint exists, exit");
    const result = this.queryData.findDataSourceAndDom(sourceGuid);
    return l.r(result, `found: ${result != null}`);
  }
}
// https://stackoverflow.com/questions/14446511/most-efficient-method-to-groupby-on-an-array-of-objects
const groupBy = (arr, key) => arr.reduce((groups, item) => {
  (groups[key(item)] ||= []).push(item);
  return groups;
}, {});
// 2025-04-02 2dm standardized / reduced the code old
// leave commented out portions in for a few weeks, to ensure we know what happened if something breaks
// Ensure In-Endpoint exist
// if (!this.#instance.getEndpoint(fromUuid)) {
//   const domDataSource = this.jsPlumbRoot.querySelector<HTMLElement>('#' + sourceElementId);
//   if (!domDataSource)
//     return;
//   const guid: string = domDataSource.id.replace(dataSrcIdPrefix, '');
//   const dataSource = this.pipelineModel.DataSources.find(pipeDataSource => pipeDataSource.EntityGuid === guid);
//   this.#addEndpoint(domDataSource, wire.Out, false, dataSource, outGroups[wire.From].length);
// }
// Ensure Out-Endpoint exist
// if (!this.#instance.getEndpoint(toUuid)) {
//   const domDataSource = this.jsPlumbRoot.querySelector<HTMLElement>('#' + targetElementId);
//   if (!domDataSource)
//     return;
//   const guid: string = domDataSource.id.replace(dataSrcIdPrefix, '');
//   const dataSource = this.pipelineModel.DataSources.find(pipeDataSource => pipeDataSource.EntityGuid === guid);
//   // if (wire.In === "DEBUG") debugger;
//   this.#addEndpoint(domDataSource, wire.In, true, dataSource, inGroups[wire.To].length);
// }
// this.#connect(w.outPointDomId, w.inPointDomId);

/***/ }),

/***/ 92867:
/*!*********************************************************************************!*\
  !*** ./projects/eav-ui/src/app/visual-query/plumb-editor/query-data-manager.ts ***!
  \*********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   QueryDataManager: () => (/* binding */ QueryDataManager)
/* harmony export */ });
/* harmony import */ var _shared_logging__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../shared/logging */ 34435);
/* harmony import */ var _datasource_helpers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./datasource.helpers */ 9480);
/* harmony import */ var _plumber_constants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./plumber-constants */ 44051);



const logSpecs = {
  all: false,
  findDataSourceAndDom: false
  // fields: ['TestIn2', 'Default'],
};
class QueryDataManager {
  constructor(jsPlumbRoot, query, dataSources) {
    this.jsPlumbRoot = jsPlumbRoot;
    this.query = query;
    this.dataSources = dataSources;
    this.log = (0,_shared_logging__WEBPACK_IMPORTED_MODULE_0__.classLogEnabled)({
      QueryDataManager
    }, logSpecs);
  }
  findDomAndDef(guid, partAssemblyAndType) {
    const dsSet = this.findDataSourceAndDom(guid);
    if (!dsSet) return null;
    const dsDef = (0,_datasource_helpers__WEBPACK_IMPORTED_MODULE_1__.findDefByType)(this.dataSources, partAssemblyAndType);
    if (!dsDef) return null;
    return {
      ...dsSet,
      definition: dsDef
    };
  }
  findDataSourceAndDom(sourceElementId) {
    const l = this.log.fnIf('findDataSourceAndDom', {
      sourceElementId
    });
    // if DOM doesn't exist, do nothing
    const domDataSource = this.jsPlumbRoot.querySelector('#' + (0,_plumber_constants__WEBPACK_IMPORTED_MODULE_2__.domIdOfGuid)(sourceElementId));
    if (!domDataSource) return l.r(null, "DOM not found, exit");
    const guid = (0,_plumber_constants__WEBPACK_IMPORTED_MODULE_2__.guidOfDomId)(domDataSource.id);
    const dataSource = this.query.DataSources.find(pipeDs => pipeDs.EntityGuid === guid);
    return l.r({
      domDataSource,
      dataSource
    }, "returning data source");
  }
}

/***/ }),

/***/ 96038:
/*!*************************************************************************************!*\
  !*** ./projects/eav-ui/src/app/visual-query/plumb-editor/connection-line-colors.ts ***!
  \*************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ConnectionLineColors: () => (/* binding */ ConnectionLineColors)
/* harmony export */ });
/* harmony import */ var _shared_logging__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../shared/logging */ 34435);

const logSpecs = {
  all: false
};
/**
 * Helper to manage the line colors on each connection
 */
class ConnectionLineColors {
  constructor() {
    this.log = (0,_shared_logging__WEBPACK_IMPORTED_MODULE_0__.classLog)({
      ConnectionLineColors
    }, logSpecs);
    this.#lineCount = 0;
    this.#linePaintDefault = {
      stroke: '#61B7CF',
      strokeWidth: 4,
      outlineStroke: 'white',
      outlineWidth: 2
    };
    this.#lineColors = ['#009688', '#00bcd4', '#3f51b5', '#9c27b0', '#e91e63', '#db4437', '#ff9800', '#60a917', '#60a917', '#008a00', '#00aba9', '#1ba1e2', '#0050ef', '#6a00ff', '#aa00ff', '#f472d0', '#d80073', '#a20025', '#e51400', '#fa6800', '#f0a30a', '#e3c800', '#825a2c', '#6d8764', '#647687', '#76608a', '#a0522d'];
    this.#maxCols = this.#lineColors.length - 1;
    this.#uuidColorMap = {};
  }
  #lineCount;
  #linePaintDefault;
  #lineColors;
  #maxCols;
  #uuidColorMap;
  nextLinePaintStyle(uuid) {
    return this.#uuidColorMap[uuid] ??= this.#nextLineColor();
  }
  #nextLineColor() {
    return {
      ...this.#linePaintDefault,
      stroke: this.#lineColors[this.#lineCount++ % this.#maxCols]
    };
  }
}

/***/ })

}]);
//# sourceMappingURL=projects_eav-ui_src_app_visual-query_visual-query_component_ts-node_modules_lodash-es__arrayE-b0a38f.js.map