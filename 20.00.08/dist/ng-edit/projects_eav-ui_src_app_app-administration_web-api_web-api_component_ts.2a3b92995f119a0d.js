"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_app-administration_web-api_web-api_component_ts"],{27592:(O,R,t)=>{t.r(R),t.d(R,{WebApiComponent:()=>L});var h=t(44444),C=t(64173),n=t(84175),y=t(81863),v=t(93840),g=t(31034),T=t(29658),E=t(12938),M=t(79996),A=t(76068),w=t(72871),d=t(11828),r=t(68163),s=t(60251),m=t(67037),u=t(71693),p=t(64699),b=t(89061),H=t(10261),W=t(34601),e=t(99293),x=t(29968);function F(l,_){if(1&l){const i=e.RV6();e.j41(0,"div",7),e.bIt("click",function(){h.eBV(i);const a=e.XpG();return h.Njj(a.openCode())}),e.j41(1,"mat-icon"),e.EFF(2,"code"),e.k0s()()}}function P(l,_){1&l&&(e.j41(0,"div",3)(1,"mat-icon"),e.EFF(2,"code"),e.k0s()())}function D(l,_){if(1&l){const i=e.RV6();e.j41(0,"button",8),e.bIt("click",function(){h.eBV(i);const a=e.XpG();return h.Njj(a.openRestApi())}),e.nrm(1,"mat-icon",9),e.j41(2,"span"),e.EFF(3,"REST API"),e.k0s()()}}let j=(()=>{class l{constructor(i,o){this.router=i,this.route=o}agInit(i){this.params=i,this.enableCode=this.params.enableCodeGetter()}refresh(i){return!0}openCode(){this.params.onOpenCode(this.params.data)}openRestApi(){const i=this.params.data,o=this.router.url.split("/");o[o.length-1]=H.N.routeWebApi,o.push(encodeURIComponent(i.path));const a=o.join("/");this.router.navigate([a])}static#t=this.\u0275fac=function(o){return new(o||l)(e.rXU(T.Ix),e.rXU(T.nX))};static#e=this.\u0275cmp=e.VBU({type:l,selectors:[["app-web-api-actions"]],decls:9,vars:3,consts:[["menu","matMenu"],[1,"actions-component"],["matRipple","","tippy","Code",1,"eav-grid-action-button","highlight"],[1,"eav-grid-action-button","disabled"],["matRipple","","tippy","More",1,"eav-grid-action-button","highlight",3,"matMenuTriggerFor"],[1,"grid-more-menu"],["matMenuContent",""],["matRipple","","tippy","Code",1,"eav-grid-action-button","highlight",3,"click"],["mat-menu-item","",3,"click"],["svgIcon","code-curly"]],template:function(o,a){if(1&o&&(e.j41(0,"div",1),e.nVh(1,F,3,0,"div",2),e.nVh(2,P,3,0,"div",3),e.j41(3,"div",4)(4,"mat-icon"),e.EFF(5,"more_horiz"),e.k0s()()(),e.j41(6,"mat-menu",5,0),e.DNE(8,D,4,0,"ng-template",6),e.k0s()),2&o){const c=e.sdS(7);e.R7$(),e.vxM(a.enableCode?1:-1),e.R7$(),e.vxM(a.enableCode?-1:2),e.R7$(),e.Y8G("matMenuTriggerFor",c)}},dependencies:[b.M,x.M,v.m_,v.An,g.Cn,g.kk,g.fb,g.z8,g.Cp,W.e],encapsulation:2})}return l})();var B=t(3347),I=t(29841);function S(l,_){if(1&l&&e.nrm(0,"ag-grid-angular",2),2&l){const i=e.XpG();e.Y8G("rowData",i.webApis())("gridOptions",i.gridOptions)}}let L=(()=>{class l{#t;#e;#n;constructor(i,o,a){this.snackBar=i,this.matDialog=o,this.viewContainerRef=a,this.#t=(0,E.d)(u.d),this.#e=(0,E.d)(M.F),this.refresh=(0,h.vPA)(0),this.webApis=this.#e.getWebApisLive(this.refresh),this.gridOptions=this.buildGridOptions(),this.dialogConfigSvc=(0,E.d)(p.L),this.#n={empty:{description:"<p><b>This is where you manage Web APIs</b><br>They are custom C# code which do anything you want.</p>",hint:"<p>WebApi Controllers are listed automatically. <br>Click the (+) in the bottom right corner to create your first Web API from a template file.</p>"},content:{description:"<p><b>This is where you manage Web APIs</b><br>They are custom C# code which do anything you want.</p>",hint:""}},this.uxHelpText=(0,C.EW)(()=>0===this.webApis()?.length?this.#n.empty:this.#n.content)}ngOnInit(){this.dialogConfigSvc.getCurrent$().subscribe(i=>{this.enableCode=i.Context.Enable.CodeEditor})}createController(i){this.matDialog.open(A.g,{autoFocus:!1,data:{folder:"api",global:i,purpose:"Api"},viewContainerRef:this.viewContainerRef,width:"650px"}).afterClosed().subscribe(c=>{if(c){if(c.name.endsWith("Controller.cs")){const f=c.name.substring(c.name.lastIndexOf("/")+1);if(!/^[A-Z][a-zA-Z0-9]*Controller\.cs$/g.test(f))return void this.snackBar.open(`"${f}" is invalid controller name. Should be something like "MyController.cs"`,null,{duration:5e3})}this.snackBar.open("Saving..."),this.#e.create(c.name,i,c.templateKey).subscribe(()=>{this.snackBar.open("Saved",null,{duration:2e3}),this.refresh.update(f=>++f)})}})}enableCodeGetter(){return this.enableCode}openCode(i){this.#t.openCodeFile(i.path,i.isShared)}buildGridOptions(){return{...s.C,columnDefs:[{...d.r.ItemsText,headerName:"Endpoint",field:"endpointPath",flex:2,minWidth:250},{...d.r.TextWideMin100,headerName:"Edition",field:"edition",sort:"asc"},{...d.r.TextWideMin100,headerName:"Folder",field:"folder",sort:"asc"},{...d.r.TextWide,headerName:"Name",field:"name"},{...d.r.Boolean2,headerName:"Compiled",field:"isCompiled",cellRenderer:w.J},{...d.r.ActionsPinnedRight6,cellRenderer:j,cellRendererParams:{enableCodeGetter:()=>this.enableCodeGetter(),onOpenCode:a=>this.openCode(a)}}]}}static#i=this.\u0275fac=function(o){return new(o||l)(e.rXU(B.UG),e.rXU(y.h),e.rXU(e.c1b))};static#o=this.\u0275cmp=e.VBU({type:l,selectors:[["app-web-api"]],decls:15,vars:5,consts:[["menu","matMenu"],[3,"helpText","refresh","rowLength"],[1,"ag-theme-material",3,"rowData","gridOptions"],["align","end"],["mat-fab","","mat-elevation-z24","","tippy","Create a new controller","tippyPlacement","left",1,"grid-fab",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"]],template:function(o,a){if(1&o){const c=e.RV6();e.j41(0,"app-grid-with-help",1),e.nVh(1,S,1,2,"ag-grid-angular",2),e.j41(2,"mat-dialog-actions",3)(3,"button",4)(4,"mat-icon"),e.EFF(5,"add"),e.k0s()(),e.j41(6,"mat-menu",null,0)(8,"button",5),e.bIt("click",function(){return h.eBV(c),h.Njj(a.createController(!1))}),e.j41(9,"span"),e.EFF(10,"App"),e.k0s()(),e.j41(11,"button",5),e.bIt("click",function(){return h.eBV(c),h.Njj(a.createController(!0))}),e.j41(12,"span"),e.EFF(13,"Shared (global)"),e.k0s()()()()(),e.nrm(14,"router-outlet")}if(2&o){let c,f;const G=e.sdS(7);e.Y8G("helpText",a.uxHelpText())("refresh",a.refresh())("rowLength",null==(c=a.webApis())?null:c.length),e.R7$(),e.vxM(null!=(f=a.webApis())&&f.length?1:-1),e.R7$(2),e.Y8G("matMenuTriggerFor",G)}},dependencies:[m.p,I.xs,y.M,n.Hl,n.Sr,g.Cn,g.kk,g.fb,g.Cp,v.m_,v.An,T.n3,r.v],encapsulation:2})}return l})()},68163:(O,R,t)=>{t.d(R,{v:()=>M});var h=t(29841),C=t(37580),n=t(99293),y=t(64173),v=t(81863);const g=["gridWrapper"],T=[[["","eav-dialog-header",""]],[["","eav-dialog-content",""]],[["ag-grid-angular"]],[["mat-dialog-actions"]]],E=["[eav-dialog-header]","[eav-dialog-content]","ag-grid-angular","mat-dialog-actions"];let M=(()=>{class A{constructor(){this.gridWrapper=(0,C.ebz)("gridWrapper",{read:n.aKT}),this.agGrid=(0,C.sbv)(h.xs,{read:n.aKT}),this.dialogAction=(0,C.sbv)(v.M,{read:n.aKT}),this.helpText=C.hFB.required({}),this.refresh=C.hFB.required(),this.rowLength=C.hFB.required(),this.DEFAULT_ROW_HEIGHT=47,this.GRID_HEADER_HEIGHT=64,this.HELP_CARD_BUFFER=12,(0,y.QZ)(()=>{this.refresh();const r=this.rowLength(),s=this.gridWrapper()?.nativeElement;s&&(0,y.O8)(()=>this.#t(s,r))})}#t(d,r){const s=this.agGrid()?.nativeElement,m=this.dialogAction()?.nativeElement,u=d.querySelector(".help-info-card");if(u.classList.toggle("center-center",0===r),!s||!m)return;u.style.flex="";const p=this.#e(d,s,m,u,r);s.style.flex=p.rowHeight?`0 0 ${p.agGridHeight}px`:"0px";const b=document.querySelector(".mat-sidenav-content"),H=document.querySelector(".mat-mdc-dialog-container");s.style.maxHeight=(b??H).clientHeight-p.dialogHeaderHeight-p.dialogActionHeight+(b?74:0)+"px";const F=p.helpCardHeight+p.agGridHeight+p.dialogActionHeight+p.dialogHeaderHeight>p.wrapperHeight;u.style.flex="1 1 auto",u?.classList.toggle("hidden-help-info-card",F)}#e(d,r,s,m,u){const p=r.querySelector(".ag-row")?.clientHeight??this.DEFAULT_ROW_HEIGHT;return{rowHeight:p,agGridHeight:this.GRID_HEADER_HEIGHT+u*p,helpCardHeight:m.clientHeight+this.HELP_CARD_BUFFER,dialogActionHeight:s.offsetHeight,dialogHeaderHeight:d.querySelector(".eav-dialog-header")?.clientHeight??0,wrapperHeight:d.offsetHeight}}static#n=this.\u0275fac=function(r){return new(r||A)};static#i=this.\u0275cmp=n.VBU({type:A,selectors:[["app-grid-with-help"]],contentQueries:function(r,s,m){1&r&&(n.C6U(m,s.agGrid,h.xs,5,n.aKT),n.C6U(m,s.dialogAction,v.M,5,n.aKT)),2&r&&n.NyB(2)},viewQuery:function(r,s){1&r&&n.wEZ(s.gridWrapper,g,5,n.aKT),2&r&&n.NyB()},inputs:{helpText:[1,"helpText"],refresh:[1,"refresh"],rowLength:[1,"rowLength"]},ngContentSelectors:E,decls:10,vars:2,consts:[["gridWrapper",""],[1,"grid-wrapper-dynamic"],[1,"help-info-card"],[1,"help-info-card-text"],[3,"innerHTML"]],template:function(r,s){1&r&&(n.NAR(T),n.j41(0,"div",1,0),n.SdG(2),n.SdG(3,1),n.SdG(4,2),n.j41(5,"div",2)(6,"div",3),n.nrm(7,"span",4)(8,"span",4),n.k0s()(),n.SdG(9,3),n.k0s()),2&r&&(n.R7$(7),n.Y8G("innerHTML",s.helpText().description,n.npT),n.R7$(),n.Y8G("innerHTML",s.helpText().hint,n.npT))},styles:[".grid-wrapper-dynamic[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.grid-wrapper-dynamic[_ngcontent-%COMP%]     .ag-theme-material.grid-dynamic{flex-shrink:0;flex-grow:0}.grid-wrapper-dynamic[_ngcontent-%COMP%]     .hidden-help-info-card{visibility:hidden!important;position:absolute!important}.grid-wrapper-dynamic[_ngcontent-%COMP%]     mat-dialog-actions{flex-shrink:0;margin-top:auto}.grid-wrapper-dynamic[_ngcontent-%COMP%]     mat-dialog-actions .eav-scope-dropdown{margin-top:-14px;width:350px}.help-info-card[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.help-info-card[_ngcontent-%COMP%]   .help-info-card-text[_ngcontent-%COMP%]{text-align:center;color:gray;width:30vw;max-width:400px;min-width:180px}.center-center[_ngcontent-%COMP%]{flex:1 1 auto}"]})}return A})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/20.00.08/dist/ng-edit/projects_eav-ui_src_app_app-administration_web-api_web-api_component_ts.2a3b92995f119a0d.js.map