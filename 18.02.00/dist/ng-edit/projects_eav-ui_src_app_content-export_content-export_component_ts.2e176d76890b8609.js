"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_content-export_content-export_component_ts"],{7693:(O,v,e)=>{e.d(v,{X:()=>C,g:()=>I});var M=e(271),m=e(6474),E=e(9148);const C="admin/type/",u="admin/type/scopes";let I=(()=>{class h extends m.D{retrieveContentType(t){return this.http.get(this.apiUrl("admin/type/get"),{params:{appId:this.appId,contentTypeId:t}})}retrieveContentTypes(t){return this.http.get(this.apiUrl("admin/type/list"),{params:{appId:this.appId,scope:t}})}getScopes(){return this.http.get(this.apiUrl(u),{params:{appId:this.appId}}).pipe((0,M.T)(t=>{const l=t.old;return Object.keys(l).map(x=>({name:l[x],value:x}))}))}getScopesV2(){return this.http.get(this.apiUrl(u),{params:{appId:this.appId}}).pipe((0,M.T)(t=>t.scopes))}save(t){return this.http.post(this.apiUrl("admin/type/save"),t,{params:{appid:this.appId}})}delete(t){return this.http.delete(this.apiUrl("admin/type/delete"),{params:{appid:this.appId,staticName:t.StaticName}})}import(t){const l=new FormData;for(const _ of t)l.append("File",_);return this.http.post(this.apiUrl("admin/type/import"),l,{params:{appId:this.appId,zoneId:this.zoneId}})}createGhost(t){return this.http.post(this.apiUrl("admin/type/addghost"),null,{params:{appid:this.appId,sourceStaticName:t}})}static{this.\u0275fac=(()=>{let t;return function(_){return(t||(t=E.xGo(h)))(_||h)}})()}static{this.\u0275prov=E.jDH({token:h,factory:h.\u0275fac})}}return h})()},5727:(O,v,e)=>{e.r(v),e.d(v,{ContentExportComponent:()=>T});var M=e(316),m=e(4456),E=e(4175),C=e(5060),D=e(7941),d=e(4950),u=e(3804),i=e(5175),o=e(5797),s=e(1873),c=e(2938),I=e(7693),h=e(4699),f=e(6360),t=e(9148),l=e(2159);function _(g,R){if(1&g&&(t.j41(0,"mat-option",10),t.EFF(1),t.k0s()),2&g){const r=R.$implicit;t.Y8G("value",r.NameId),t.R7$(),t.JRh(r.NameId)}}function x(g,R){if(1&g&&(t.j41(0,"mat-radio-button",15),t.EFF(1),t.k0s()),2&g){const r=t.XpG(2);t.R7$(),t.SpI(" Export selected ",r.itemIds.length," items ")}}function P(g,R){if(1&g){const r=t.RV6();t.j41(0,"form",null,0)(2,"div",4)(3,"p"),t.EFF(4," This will generate an XML file which you can edit in Excel. If you just want to import new data, use this to export the schema that you can then fill in using Excel. Please visit "),t.j41(5,"a",5),t.EFF(6,"https://2sxc.org/help"),t.k0s(),t.EFF(7," for more instructions. "),t.k0s(),t.j41(8,"div",6)(9,"div")(10,"mat-form-field",7)(11,"mat-label"),t.EFF(12,"Languages"),t.k0s(),t.j41(13,"mat-select",8),t.mxI("ngModelChange",function(n){t.eBV(r);const p=t.XpG();return t.DH7(p.formValues.language,n)||(p.formValues.language=n),t.Njj(n)}),t.j41(14,"mat-option",9),t.EFF(15,"All"),t.k0s(),t.Z7z(16,_,2,2,"mat-option",10,t.fX1),t.k0s()()(),t.j41(18,"div")(19,"p",11),t.EFF(20,"Export data"),t.k0s(),t.j41(21,"mat-radio-group",12),t.mxI("ngModelChange",function(n){t.eBV(r);const p=t.XpG();return t.DH7(p.formValues.recordExport,n)||(p.formValues.recordExport=n),t.Njj(n)}),t.j41(22,"mat-radio-button",13),t.EFF(23,"No, just export blank data schema (for new data import) "),t.k0s(),t.j41(24,"mat-radio-button",14),t.EFF(25,"Yes, export all content-items"),t.k0s(),t.DNE(26,x,2,1,"mat-radio-button",15),t.k0s()(),t.j41(27,"div")(28,"p",11),t.EFF(29,"Value references to other languages"),t.k0s(),t.j41(30,"mat-radio-group",16),t.mxI("ngModelChange",function(n){t.eBV(r);const p=t.XpG();return t.DH7(p.formValues.languageReferences,n)||(p.formValues.languageReferences=n),t.Njj(n)}),t.j41(31,"mat-radio-button",17),t.EFF(32,"Keep references to other languages (for re-import) "),t.k0s(),t.j41(33,"mat-radio-button",18),t.EFF(34,"Replace references with values"),t.k0s()()(),t.j41(35,"div")(36,"p",11),t.EFF(37,"File / page references"),t.k0s(),t.j41(38,"mat-radio-group",19),t.mxI("ngModelChange",function(n){t.eBV(r);const p=t.XpG();return t.DH7(p.formValues.resourcesReferences,n)||(p.formValues.resourcesReferences=n),t.Njj(n)}),t.j41(39,"mat-radio-button",17),t.EFF(40,"Keep references (for re-import, for example Page:4711) "),t.k0s(),t.j41(41,"mat-radio-button",18),t.EFF(42,"Replace references with real URLs (for example /Portals/0...) "),t.k0s()()()()(),t.j41(43,"mat-dialog-actions",20)(44,"button",21),t.bIt("click",function(){t.eBV(r);const n=t.XpG();return t.Njj(n.closeDialog())}),t.EFF(45,"Cancel"),t.k0s(),t.j41(46,"button",22),t.bIt("click",function(){t.eBV(r);const n=t.XpG();return t.Njj(n.exportContent())}),t.EFF(47,"Export Data"),t.k0s()()()}if(2&g){const r=t.sdS(1),a=t.XpG();t.R7$(13),t.R50("ngModel",a.formValues.language),t.R7$(3),t.Dyx(a.languages),t.R7$(5),t.R50("ngModel",a.formValues.recordExport),t.R7$(5),t.vxM(a.hasIdList?26:-1),t.R7$(4),t.R50("ngModel",a.formValues.languageReferences),t.Y8G("disabled","Blank"===a.formValues.recordExport),t.R7$(8),t.R50("ngModel",a.formValues.resourcesReferences),t.Y8G("disabled","Blank"===a.formValues.recordExport),t.R7$(8),t.Y8G("disabled",!r.form.valid)}}let T=(()=>{class g{constructor(r,a){this.dialog=r,this.route=a,this.hostClass="dialog-component",this.contentExportService=(0,c.d)(f.D),this.contentTypesService=(0,c.d)(I.g),this.dialogConfigSvc=(0,c.d)(h.L),this.hasIdList=!1,this.loading$=new o.t(!1),this.contentType$=new o.t(null),this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName");const n=this.route.snapshot.paramMap.get("selectedIds");this.hasIdList=!!n,this.hasIdList&&(this.itemIds=n.split(",").map(p=>parseInt(p,10)))}ngOnInit(){this.loading$.next(!0);const r=this.contentTypesService.retrieveContentType(this.contentTypeStaticName),a=this.dialogConfigSvc.getCurrent$();(0,s.p)([r,a]).subscribe(([n,p])=>{this.contentType$.next(n),this.languages=p.Context.Language.List,this.formValues={defaultLanguage:p.Context.Language.Primary,contentTypeStaticName:this.contentTypeStaticName,language:"",recordExport:this.hasIdList?"Selection":"All",languageReferences:"Link",resourcesReferences:"Link"},this.loading$.next(!1)})}ngOnDestroy(){this.contentType$.complete(),this.loading$.complete()}closeDialog(){this.dialog.close()}exportContent(){this.contentExportService.exportContent(this.formValues,this.hasIdList&&"Selection"===this.formValues.recordExport?this.itemIds:null)}static{this.\u0275fac=function(a){return new(a||g)(t.rXU(D.CP),t.rXU(l.nX))}}static{this.\u0275cmp=t.VBU({type:g,selectors:[["app-content-export"]],hostVars:1,hostBindings:function(a,n){2&a&&t.Mr5("className",n.hostClass)},standalone:!0,features:[t.aNF],decls:7,vars:6,consts:[["ngForm","ngForm"],[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],["href","https://2sxc.org/help","target","_blank"],[1,"dialog-form-content","fancy-scrollbar-light"],["color","accent",1,"eav-mat-form-field"],["name","Language",3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"eav-radio-group-label"],["name","RecordExport",1,"eav-radio-group",3,"ngModelChange","ngModel"],["value","Blank"],["value","All"],["value","Selection"],["name","LanguageReferences",1,"eav-radio-group",3,"ngModelChange","ngModel","disabled"],["value","Link"],["value","Resolve"],["name","ResourcesReferences",1,"eav-radio-group",3,"ngModelChange","ngModel","disabled"],["align","end"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"click","disabled"]],template:function(a,n){if(1&a&&(t.j41(0,"div",1)(1,"div",2)(2,"div",3),t.EFF(3),t.nI1(4,"async"),t.k0s()(),t.DNE(5,P,48,8,"form"),t.nI1(6,"async"),t.k0s()),2&a){let p;t.R7$(3),t.SpI("Export ",null==(p=t.bMT(4,2,n.contentType$))?null:p.Name,""),t.R7$(2),t.vxM(!1===t.bMT(6,4,n.loading$)?5:-1)}},dependencies:[m.YN,m.qT,m.BC,m.cb,m.vS,m.cV,d.RG,d.rl,d.nJ,i.Ve,i.VO,C.wT,C.Sy,u.Wk,u.VT,u._g,D.E7,E.Hl,E.$z,M.Jj],styles:[".eav-radio-group-label[_ngcontent-%COMP%]{font-size:18px;margin:24px 0 0}.eav-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:8px 0}"]})}}return g})()},6360:(O,v,e)=>{e.d(v,{D:()=>D});var M=e(7693),m=e(9234),E=e(6474),C=e(9148);let D=(()=>{class d extends E.D{exportContent(i,o){const s=o?"&selectedids="+o.join():"",c=this.apiUrl(m.gb+"Download")+"?appId="+this.appId+"&language="+i.language+"&defaultLanguage="+i.defaultLanguage+"&contentType="+i.contentTypeStaticName+"&recordExport="+i.recordExport+"&resourcesReferences="+i.resourcesReferences+"&languageReferences="+i.languageReferences+s;window.open(c,"_blank","")}exportJson(i){const o=this.apiUrl(M.X+"Json")+"?appId="+this.appId+"&name="+i;window.open(o,"_blank","")}exportEntity(i,o,s){const c=this.apiUrl(m.gb+"Json")+"?appId="+this.appId+"&id="+i+"&prefix="+o+"&withMetadata="+s;window.open(c,"_blank","")}static{this.\u0275fac=(()=>{let i;return function(s){return(i||(i=C.xGo(d)))(s||d)}})()}static{this.\u0275prov=C.jDH({token:d,factory:d.\u0275fac})}}return d})()},9234:(O,v,e)=>{e.d(v,{Gg:()=>I,Tr:()=>h,gb:()=>c});var M=e(1567),m=e(6647),E=e(6301),C=e(271),D=e(2938),d=e(4435),u=e(6474),i=e(4839),o=e(9148);const s={all:!1,getEntities:!1,getAvailableEntities:!1,delete:!1},c="admin/entity/",I="admin/entity/list";let h=(()=>{class f extends u.D{constructor(){super(...arguments),this.log=(0,d.T)({EntityService:f},s),this.queryService=(0,D.d)(i.c)}getEntities$(l){return this.log.fnIf("getEntities"),l.pipe((0,M.p)(_=>null!=_),(0,m.n)(_=>this.getAvailableEntities(_.contentTypeName).pipe((0,E.t)(1))))}getAvailableEntities(l,_){return this.log.fnIf("getAvailableEntities"),this.queryService.getEntities({contentTypes:[l],itemIds:_,fields:"Id,Guid,Title",log:"getAvailableEntities"}).pipe((0,C.T)(P=>P.Default))}delete(l,_,x,P,T,g){return this.log.fnIf("delete",{appId:l,contentType:_,entityId:x,force:P,parentId:T,parent}),this.http.delete(this.apiUrl(c+"delete"),{params:{contentType:_,id:x.toString(),appId:l,force:P.toString(),...T&&{parentId:T.toString()},...T&&g&&{parentField:g}}})}static{this.\u0275fac=(()=>{let l;return function(x){return(l||(l=o.xGo(f)))(x||f)}})()}static{this.\u0275prov=o.jDH({token:f,factory:f.\u0275fac})}}return f})()},4839:(O,v,e)=>{e.d(v,{c:()=>d});var M=e(4435),m=e(8873),E=e(9148),C=e(6443);const D={all:!1,getAvailableEntities:!1,getEntities:!1};let d=(()=>{class u{constructor(o,s){this.http=o,this.context=s,this.log=(0,M.T)({QueryService:u},D)}getFromQuery(o,s,c,I){this.log.fnIf("getAvailableEntities",{queryUrl:o,params:s,fields:c,entitiesFilter:I});const h=!!s,_=(((s?.toLocaleLowerCase()??"").includes("appid=")?"":`&appId=${this.context.appId}`)+(h?`&${s}`:"")+"&$select="+(c??"")).substring(1);return this.http.post(`app/auto/query/${o}?${_}`,{Guids:I})}getEntities({contentTypes:o,itemIds:s,fields:c,log:I}){this.log.fnIf("getEntities",{log:I,contentTypes:o,itemIds:s,fields:c});const f=("&typeNames="+(o?.join(",")??"")+`&appId=${this.context.appId}&itemIds=`+(s?.join(",")??"")+"&$select="+(c??"")).substring(1);return this.http.post(`app/auto/query/System.EntityPicker/Default?${f}`,{})}static{this.\u0275fac=function(s){return new(s||u)(E.KVO(C.Qq),E.KVO(m.o))}}static{this.\u0275prov=E.jDH({token:u,factory:u.\u0275fac})}}return u})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/18.02.00/dist/ng-edit/projects_eav-ui_src_app_content-export_content-export_component_ts.2e176d76890b8609.js.map