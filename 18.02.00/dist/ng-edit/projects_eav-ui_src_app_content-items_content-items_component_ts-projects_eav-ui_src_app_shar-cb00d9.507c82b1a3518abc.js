"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_content-items_content-items_component_ts-projects_eav-ui_src_app_shar-cb00d9"],{7693:(R,M,a)=>{a.d(M,{X:()=>u,g:()=>C});var t=a(271),_=a(6474),r=a(9148);const u="admin/type/",p="admin/type/scopes";let C=(()=>{class d extends _.D{retrieveContentType(l){return this.http.get(this.apiUrl("admin/type/get"),{params:{appId:this.appId,contentTypeId:l}})}retrieveContentTypes(l){return this.http.get(this.apiUrl("admin/type/list"),{params:{appId:this.appId,scope:l}})}getScopes(){return this.http.get(this.apiUrl(p),{params:{appId:this.appId}}).pipe((0,t.T)(l=>{const D=l.old;return Object.keys(D).map(A=>({name:D[A],value:A}))}))}getScopesV2(){return this.http.get(this.apiUrl(p),{params:{appId:this.appId}}).pipe((0,t.T)(l=>l.scopes))}save(l){return this.http.post(this.apiUrl("admin/type/save"),l,{params:{appid:this.appId}})}delete(l){return this.http.delete(this.apiUrl("admin/type/delete"),{params:{appid:this.appId,staticName:l.StaticName}})}import(l){const D=new FormData;for(const E of l)D.append("File",E);return this.http.post(this.apiUrl("admin/type/import"),D,{params:{appId:this.appId,zoneId:this.zoneId}})}createGhost(l){return this.http.post(this.apiUrl("admin/type/addghost"),null,{params:{appid:this.appId,sourceStaticName:l}})}static{this.\u0275fac=(()=>{let l;return function(E){return(l||(l=r.xGo(d)))(E||d)}})()}static{this.\u0275prov=r.jDH({token:d,factory:d.\u0275fac})}}return d})()},1475:(R,M,a)=>{a.d(M,{j:()=>u});var t=a(8624),_=a(6474),r=a(9148);let u=(()=>{class T extends _.D{getContentInfo(p){return this.http.get(this.apiUrl(t.Q+"Get"),{params:{appid:this.appId,zoneId:this.zoneId,scope:p}})}exportParts(p,g,h){const y=this.apiUrl(t.Q+"Export")+"?appId="+this.appId+"&zoneId="+this.zoneId+"&contentTypeIdsString="+p.join(";")+"&entityIdsString="+g.join(";")+"&templateIdsString="+h.join(";");window.open(y,"_blank","")}static{this.\u0275fac=(()=>{let p;return function(h){return(p||(p=r.xGo(T)))(h||T)}})()}static{this.\u0275prov=r.jDH({token:T,factory:T.\u0275fac})}}return T})()},320:(R,M,a)=>{a.d(M,{t:()=>u});var t=a(1772),_=a(6474),r=a(9148);let u=(()=>{class T extends _.D{getAppInfo(){return this.http.get(this.apiUrl(t.u+"Statistics"),{params:{appid:this.appId,zoneId:this.zoneId}})}exportAppUrl(){return`${this.apiUrl(`${t.u}Export`)}?appId=${this.appId}&zoneId=${this.zoneId}`}exportForVersionControl({includeContentGroups:p,resetAppGuid:g,withFiles:h}){return this.http.get(this.apiUrl(t.u+"SaveData"),{params:{appid:this.appId,zoneId:this.zoneId,includeContentGroups:p.toString(),resetAppGuid:g.toString(),withPortalFiles:h.toString()}})}static{this.\u0275fac=(()=>{let p;return function(h){return(p||(p=r.xGo(T)))(h||T)}})()}static{this.\u0275prov=r.jDH({token:T,factory:T.\u0275fac})}}return T})()},8624:(R,M,a)=>{a.d(M,{Q:()=>u,S:()=>T});var t=a(1772),_=a(6474),r=a(9148);const u="admin/appParts/";let T=(()=>{class c extends _.D{importAppParts(g){const h=new FormData;return h.append("File",g),this.http.post(this.apiUrl(u+"Import"),h,{params:{appId:this.appId,zoneId:this.zoneId}})}resetApp(g){return this.http.post(this.apiUrl(t.u+"Reset"),{},{params:{appId:this.appId,zoneId:this.zoneId,withPortalFiles:g.toString()}})}static{this.\u0275fac=(()=>{let g;return function(y){return(g||(g=r.xGo(c)))(y||c)}})()}static{this.\u0275prov=r.jDH({token:c,factory:c.\u0275fac})}}return c})()},5445:(R,M,a)=>{a.d(M,{Cu:()=>c.Cu,JL:()=>c.JL,Mk:()=>c.Mk,X6:()=>_.X,ei:()=>c.ei,gs:()=>_.g,tr:()=>t.t,vN:()=>c.vN,xR:()=>c.xR,y0:()=>p.y});var t=a(1479),_=a(7693),c=(a(1475),a(320),a(8624),a(6460)),p=a(2570)},6460:(R,M,a)=>{a.d(M,{Cu:()=>d,JL:()=>v,Mk:()=>P,ei:()=>C,vN:()=>l,xR:()=>D});var t=a(4600),_=a(6647),r=a(271),u=a(693),T=a(9234),c=a(6474),p=a(9148);const P="admin/query/Run",C="admin/query/DebugStream",d="admin/query/Save",v="admin/query/Get",l="admin/query/DataSources";let D=(()=>{class E extends c.D{getAll(x){return this.http.get(this.apiUrl(T.Gg),{params:{appId:this.appId,contentType:x}})}importQuery(x){return(0,t.H)((0,u.n)(x)).pipe((0,_.n)(k=>this.http.post(this.apiUrl("admin/query/import"),{AppId:this.appId,ContentBase64:k})),(0,r.T)(k=>({Success:k,Messages:[]})))}clonePipeline(x){return this.http.get(this.apiUrl("admin/query/Clone"),{params:{Id:x.toString(),appId:this.appId}})}delete(x){return this.http.delete(this.apiUrl("admin/query/Delete"),{params:{appId:this.appId,Id:x.toString()}})}static{this.\u0275fac=(()=>{let x;return function(U){return(x||(x=p.xGo(E)))(U||E)}})()}static{this.\u0275prov=p.jDH({token:E,factory:E.\u0275fac})}}return E})()},2570:(R,M,a)=>{a.d(M,{y:()=>h});var t=a(6474),_=a(9148);const r="admin/view/",u=r+"all",T=r+"delete",c=r+"import",p=r+"polymorphism",g=r+"usage";let h=(()=>{class y extends t.D{getAll(){return this.http.get(this.apiUrl(u),{params:{appId:this.appId}})}delete(C){return this.http.get(this.apiUrl(T),{params:{appId:this.appId,Id:C.toString()}})}import(C){const d=new FormData;return d.append("File",C),this.http.post(this.apiUrl(c),d,{params:{appId:this.appId,zoneId:this.zoneId}})}export(C){const d=this.apiUrl(r+"json")+"?appId="+this.appId+"&viewId="+C;window.open(d,"_blank","")}getPolymorphism(){return this.http.get(this.apiUrl(p),{params:{appId:this.appId}})}getUsage(C){return this.http.get(this.apiUrl(g),{params:{appId:this.appId,guid:C}})}static{this.\u0275fac=(()=>{let C;return function(v){return(C||(C=_.xGo(y)))(v||y)}})()}static{this.\u0275prov=_.jDH({token:y,factory:y.\u0275fac})}}return y})()},7730:(R,M,a)=>{a.r(M),a.d(M,{ContentItemsComponent:()=>Ce});var t=a(9148),_=a(4175),r=a(7941),u=a(3840),T=a(2159),c=a(5797),p=a(1567),g=a(4334),h=a(2938),y=a(7693),P=a(6360),C=a(3454),d=a(1828),v=a(1960),l=a(4456),D=a(3804),E=a(4950),A=a(7984);const x=["valueInput"];let k=(()=>{class i{constructor(){this.filter="",this.idFilterString="",this.idFilter=[]}agInit(e){this.filterParams=e}isFilterActive(){return""!==this.filter||this.idFilter.length>0}doesFilterPass(e){if(""!==this.filter){const o=this.filterParams.valueGetter({api:this.filterParams.api,colDef:this.filterParams.colDef,column:this.filterParams.column,columnApi:this.filterParams.columnApi,context:this.filterParams.context,data:e.node.data,getValue:s=>e.node.data[s],node:e.node});if(null==o||!o.some(s=>!!s&&s.includes(this.filter)))return!1}if(this.idFilter.length>0){const n=e.data[this.filterParams.colDef.headerName];if(null==n||!this.idFilter.some(o=>n.some(s=>s.Id===o)))return!1}return!0}getModel(){return this.isFilterActive()?{filterType:"entity",filter:this.filter,idFilter:this.idFilter}:void 0}setModel(e){this.filter=e?.filter??"",this.idFilter=e?.idFilter??[],this.idFilterString=e?.idFilter?.join(",")??""}afterGuiAttached(e){this.valueInputRef.nativeElement.focus()}updateIdFilter(){this.idFilter=this.idFilterString.split(",").map(e=>parseInt(e,10)).filter(e=>!isNaN(e))}filterChanged(){this.filterParams.filterChangedCallback()}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-entity-filter"]],viewQuery:function(n,o){if(1&n&&t.GBs(x,5),2&n){let s;t.mGM(s=t.lsd())&&(o.valueInputRef=s.first)}},standalone:!0,features:[t.aNF],decls:9,vars:2,consts:[["valueInput",""],["color","accent",1,"eav-mat-form-field"],["matInput","","type","text",3,"ngModelChange","ngModel"]],template:function(n,o){if(1&n){const s=t.RV6();t.j41(0,"mat-form-field",1)(1,"mat-label"),t.EFF(2,"Value"),t.k0s(),t.j41(3,"input",2,0),t.mxI("ngModelChange",function(F){return t.eBV(s),t.DH7(o.filter,F)||(o.filter=F),t.Njj(F)}),t.bIt("ngModelChange",function(){return t.eBV(s),t.Njj(o.filterChanged())}),t.k0s()(),t.j41(5,"mat-form-field",1)(6,"mat-label"),t.EFF(7,"IDs (comma separated)"),t.k0s(),t.j41(8,"input",2),t.mxI("ngModelChange",function(F){return t.eBV(s),t.DH7(o.idFilterString,F)||(o.idFilterString=F),t.Njj(F)}),t.bIt("ngModelChange",function(){return t.eBV(s),o.updateIdFilter(),t.Njj(o.filterChanged())}),t.k0s()()}2&n&&(t.R7$(3),t.R50("ngModel",o.filter),t.R7$(5),t.R50("ngModel",o.idFilterString))},dependencies:[l.YN,l.me,l.BC,l.vS,D.Wk,E.RG,E.rl,E.nJ,A.fS,A.fg],styles:["[_nghost-%COMP%]{display:block;padding:16px 12px 2px}.mat-mdc-form-field[_ngcontent-%COMP%]{display:block;width:175px}"]})}}return i})();var U=a(251),G=a(8172),st=a(4575),I=a(5699),b=a(1726),O=a(3216),B=a(4435),$=a(334),X=a(7037),Y=a(9914),rt=a(8471),lt=a(6817),pt=a(9431),N=a(5060),K=a(1034);function dt(i,m){if(1&i){const e=t.RV6();t.j41(0,"button",7),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.do("delete"))}),t.j41(1,"mat-icon"),t.EFF(2,"delete"),t.k0s(),t.j41(3,"span"),t.EFF(4,"Delete"),t.k0s()()}if(2&i){const e=t.XpG();t.Y8G("disabled",e.item._EditInfo.DisableDelete)}}let ct=(()=>{class i{agInit(e){this.params=e,this.item=e.data}refresh(e){return!0}do(e){this.params.do(e,this.item)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-content-items-actions"]],standalone:!0,features:[t.aNF],decls:13,vars:1,consts:[["menu","matMenu"],[1,"actions-component"],["matRipple","","tippy","Copy",1,"eav-grid-action-button","highlight",3,"click"],["matRipple","","tippy","Export",1,"eav-grid-action-button","highlight",3,"click"],["matRipple","","tippy","More",1,"eav-grid-action-button","highlight",3,"matMenuTriggerFor"],[1,"grid-more-menu"],["matMenuContent",""],["mat-menu-item","",3,"click","disabled"]],template:function(n,o){if(1&n){const s=t.RV6();t.j41(0,"div",1)(1,"div",2),t.bIt("click",function(){return t.eBV(s),t.Njj(o.do("clone"))}),t.j41(2,"mat-icon"),t.EFF(3,"file_copy"),t.k0s()(),t.j41(4,"div",3),t.bIt("click",function(){return t.eBV(s),t.Njj(o.do("export"))}),t.j41(5,"mat-icon"),t.EFF(6,"cloud_download"),t.k0s()(),t.j41(7,"div",4)(8,"mat-icon"),t.EFF(9,"more_horiz"),t.k0s()()(),t.j41(10,"mat-menu",5,0),t.DNE(12,dt,5,1,"ng-template",6),t.k0s()}if(2&n){const s=t.sdS(11);t.R7$(7),t.Y8G("matMenuTriggerFor",s)}},dependencies:[N.pZ,N.r6,u.m_,u.An,K.Cn,K.kk,K.fb,K.z8,K.Cp],encapsulation:2})}}return i})();var w=a(4601);function ut(i,m){if(1&i&&(t.j41(0,"span",1),t.EFF(1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.JRh(e.entities)}}let mt=(()=>{class i{agInit(e){Array.isArray(e.value)&&(this.encodedValue=this.htmlEncode(e.value.join(", ")),e.colDef.allowMultiValue&&(this.entities=e.value.length))}refresh(e){return!0}htmlEncode(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-content-items-entity"]],standalone:!0,features:[t.aNF],decls:3,vars:3,consts:[[3,"tippy"],[1,"more-entities"]],template:function(n,o){1&n&&(t.j41(0,"div",0),t.DNE(1,ut,2,1,"span",1),t.EFF(2),t.k0s()),2&n&&(t.Y8G("tippy",o.encodedValue),t.R7$(),t.vxM(o.entities?1:-1),t.R7$(),t.SpI(" ",o.encodedValue,"\n"))},dependencies:[w.e],styles:[".more-entities[_ngcontent-%COMP%]{padding:0 8px;border-radius:10px;border:1px solid rgba(29,39,61,.44);-webkit-user-select:none;user-select:none}"]})}}return i})();var J=a(6256),L=a(316);const ht=i=>({"hide-until-row-hover":i});function ft(i,m){if(1&i){const e=t.RV6();t.j41(0,"div",4),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.openMetadata())}),t.j41(1,"mat-icon",5),t.EFF(2),t.k0s()()}if(2&i){const e=t.XpG();t.Y8G("ngClass",t.eq3(5,ht,!e.metadataCount&&!e.value.metadata))("tippy",e.metadataTooltip),t.R7$(),t.Y8G("matBadge",e.metadataCount)("matBadgeHidden",!e.metadataCount),t.R7$(),t.SpI("",e.value.metadata?"loyalty":"local_offer"," ")}}function _t(i,m){if(1&i&&(t.j41(0,"div",3)(1,"mat-icon",6),t.EFF(2),t.k0s()()),2&i){const e=t.XpG();t.R7$(),t.Y8G("matBadge",e.metadataCount)("matBadgeHidden",!e.metadataCount),t.R7$(),t.SpI("",e.value.metadata?"loyalty":"local_offer"," ")}}let gt=(()=>{class i{agInit(e){this.value=e.value,this.params=e,this.item=e.data,this.disableMetadata=this.item._EditInfo.DisableMetadata,this.metadataCount=this.item.Metadata?.length??0;const n=this.item.For;this.metadataTooltip=n?`This item is metadata for:\nTarget: ${n.Target}\nTargetType: ${n.TargetType}`+(n.KeyNumber?`\nNumber: ${n.KeyNumber}`:"")+(n.KeyString?`\nString: ${n.KeyString}`:"")+(n.KeyGuid?`\nGuid: ${n.KeyGuid}`:"")+(n.Title?`\nTitle: ${n.Title}`:""):"This item is not metadata.",this.metadataTooltip+=`\n\nThis item has ${this.metadataCount>0?this.metadataCount:"no"} other metadata ${1===this.metadataCount?"item":"items"} attached to it.`}refresh(e){return!0}openMetadata(){this.params.onOpenMetadata(this.item)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-content-items-status"]],standalone:!0,features:[t.aNF],decls:6,vars:4,consts:[[1,"actions-component"],[1,"eav-grid-action-button","icon",3,"tippy"],["matRipple","",1,"eav-grid-action-button","highlight",3,"ngClass","tippy"],[1,"eav-grid-action-button","disabled"],["matRipple","",1,"eav-grid-action-button","highlight",3,"click","ngClass","tippy"],["matBadgeColor","accent","matBadgeSize","small","matBadgePosition","below after","aria-hidden","false",3,"matBadge","matBadgeHidden"],["matBadgeColor","accent","matBadgeSize","small","matBadgeDisabled","true","matBadgePosition","below after","aria-hidden","false",3,"matBadge","matBadgeHidden"]],template:function(n,o){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"mat-icon"),t.EFF(3),t.k0s()(),t.DNE(4,ft,3,7,"div",2)(5,_t,3,3,"div",3),t.k0s()),2&n&&(t.R7$(),t.Y8G("tippy",o.value.published?"Published":"Not published"),t.R7$(2),t.JRh(o.value.published?"visibility":"visibility_off"),t.R7$(),t.vxM(o.disableMetadata?-1:4),t.R7$(),t.vxM(o.disableMetadata&&(o.metadataCount||o.value.metadata)?5:-1))},dependencies:[u.m_,u.An,N.pZ,N.r6,L.YU,J.Y,J.k,w.e],styles:[".hide-until-row-hover[_ngcontent-%COMP%]{visibility:hidden}  .ag-row-hover .hide-until-row-hover{visibility:visible}"]})}}return i})();var Ct=a(4038),Z=a(5175),q=a(8827),H=a(3037),V=a(1817),vt=a(3617),tt=a(271),W=a(9999),Tt=a(5445),et=a(8857),It=a(3176),Mt=a(3758),nt=a(5858),j=a(52),Et=a(9333),Dt=a(8021),Ft=a(3826),bt=a(8873),at=a(336),Pt=a(9417);function Ot(i){return m=>{if(!m.value)return null;const e=i.controls.keyType.value,n=m.value.toString();switch(e){case j.YX.keyTypes.number:return/^[0-9]+$/.test(n)?null:{patternWholeNumber:!0};case j.YX.keyTypes.guid:const s=["{","}"].some(S=>n.includes(S)),f=n.substring(s?1:0,s?n.length-1:n.length);return(0,Pt.L)().test(f)?null:{patternGuid:!0};default:return null}}}const it=i=>({active:i});function Rt(i,m){if(1&i&&(t.j41(0,"mat-option",12),t.EFF(1),t.k0s()),2&i){const e=m.$implicit;t.Y8G("value",e.targetType),t.R7$(),t.SpI(" ",e.label," ")}}function xt(i,m){if(1&i&&(t.j41(0,"mat-option",12),t.EFF(1),t.k0s()),2&i){const e=t.XpG(2);t.Y8G("value",e.formValues.targetType),t.R7$(),t.SpI(" ",e.formValues.targetType," ")}}function At(i,m){if(1&i&&(t.j41(0,"mat-select",8),t.Z7z(1,Rt,2,2,"mat-option",12,t.fX1),t.DNE(3,xt,2,2,"mat-option",12),t.k0s()),2&i){const e=t.XpG(),n=t.XpG();t.R7$(),t.Dyx(n.targetTypeOptions),t.R7$(2),t.vxM(e.unknownTargetType?3:-1)}}function jt(i,m){1&i&&t.nrm(0,"input",9)}function kt(i,m){1&i&&(t.j41(0,"app-field-hint",10),t.EFF(1," Warning: you entered an unknown target type. This may work or may not. Please be sure you know what you're doing "),t.k0s()),2&i&&t.Y8G("isError",!1)}function St(i,m){if(1&i&&(t.j41(0,"app-field-hint",10),t.EFF(1),t.k0s()),2&i){const e=t.XpG();t.Y8G("isError",!1),t.R7$(),t.JRh(e.targetTypeHint)}}function Ut(i,m){1&i&&(t.j41(0,"app-field-hint",10),t.EFF(1," This field is required "),t.k0s()),2&i&&t.Y8G("isError",!0)}function Gt(i,m){1&i&&(t.j41(0,"app-field-hint",10),t.EFF(1," Must be a whole number "),t.k0s()),2&i&&t.Y8G("isError",!0)}function Bt(i,m){if(1&i&&(t.j41(0,"mat-option",12),t.EFF(1),t.k0s()),2&i){const e=m.$implicit;t.Y8G("value",e),t.R7$(),t.SpI(" ",e," ")}}function $t(i,m){1&i&&(t.j41(0,"app-field-hint",10),t.EFF(1," This field is required "),t.k0s()),2&i&&t.Y8G("isError",!0)}function Nt(i,m){if(1&i&&(t.j41(0,"mat-option",12),t.EFF(1),t.k0s()),2&i){const e=m.$implicit;t.Y8G("value",e.StaticName),t.R7$(),t.SpI(" ",e.Label," ")}}function Kt(i,m){if(1&i&&(t.j41(0,"mat-form-field",7)(1,"mat-label"),t.EFF(2,"Content Type"),t.k0s(),t.j41(3,"mat-select",19),t.Z7z(4,Nt,2,2,"mat-option",12,t.fX1),t.k0s()()),2&i){const e=t.XpG();t.R7$(3),t.Y8G("placeholder",e.contentTypes.length?"":"No items found"),t.R7$(),t.Dyx(e.contentTypes)}}function Lt(i,m){if(1&i&&(t.j41(0,"mat-option",12),t.EFF(1),t.k0s()),2&i){const e=m.$implicit;t.Y8G("value",e.value),t.R7$(),t.SpI(" ",e.name," ")}}function Vt(i,m){if(1&i&&(t.j41(0,"mat-form-field",7)(1,"mat-label"),t.EFF(2,"Scope"),t.k0s(),t.j41(3,"mat-select",20),t.Z7z(4,Lt,2,2,"mat-option",12,t.fX1),t.j41(6,"mat-option",12),t.EFF(7,"Other..."),t.k0s()()()),2&i){const e=t.XpG(),n=t.XpG();t.R7$(3),t.Y8G("placeholder",e.scopeOptions.length?"":"No items found"),t.R7$(),t.Dyx(e.scopeOptions),t.R7$(2),t.Y8G("value",n.dropdownInsertValue)}}function Wt(i,m){if(1&i&&(t.j41(0,"mat-option",12),t.EFF(1),t.k0s()),2&i){const e=m.$implicit;t.Y8G("value",e.Guid),t.R7$(),t.Lme(" ",e.Title," (",e.Id,") ")}}function Xt(i,m){if(1&i&&(t.j41(0,"mat-select",21),t.Z7z(1,Wt,2,3,"mat-option",12,t.fX1),t.k0s()),2&i){const e=t.XpG(3);t.Y8G("placeholder",e.contentItems.length?"":"No items found"),t.R7$(),t.Dyx(e.contentItems)}}function Yt(i,m){1&i&&t.nrm(0,"input",22)}function wt(i,m){if(1&i&&t.DNE(0,Xt,3,1,"mat-select",21)(1,Yt,1,0,"input",22),2&i){const e=t.XpG(2);t.vxM(e.guidedKey?0:1)}}function Ht(i,m){if(1&i&&(t.j41(0,"mat-option",12),t.EFF(1),t.k0s()),2&i){const e=m.$implicit;t.Y8G("value",e.StaticName),t.R7$(),t.SpI(" ",e.Label," ")}}function zt(i,m){if(1&i&&(t.j41(0,"mat-select",21),t.Z7z(1,Ht,2,2,"mat-option",12,t.fX1),t.k0s()),2&i){const e=t.XpG(3);t.Y8G("placeholder",e.contentTypes.length?"":"No items found"),t.R7$(),t.Dyx(e.contentTypes)}}function Qt(i,m){1&i&&t.nrm(0,"input",22)}function Jt(i,m){if(1&i&&t.DNE(0,zt,3,1,"mat-select",21)(1,Qt,1,0,"input",22),2&i){const e=t.XpG(2);t.vxM(e.guidedKey?0:1)}}function Zt(i,m){1&i&&t.eu8(0)}function qt(i,m){if(1&i&&t.DNE(0,Zt,1,0,"ng-container",23),2&i){t.XpG(2);const e=t.sdS(39);t.Y8G("ngTemplateOutlet",e)}}function te(i,m){if(1&i&&t.DNE(0,wt,2,1)(1,Jt,2,1)(2,qt,1,1,"ng-container"),2&i){let e;const n=t.XpG(),o=t.XpG();t.vxM((e=n.formValues.targetType)===o.eavConstants.metadata.entity.targetType?0:e===o.eavConstants.metadata.contentType.targetType?1:2)}}function ee(i,m){1&i&&t.nrm(0,"input",22)}function ne(i,m){1&i&&t.nrm(0,"input",24)}function ae(i,m){if(1&i&&t.DNE(0,ee,1,0,"input",22)(1,ne,1,0,"input",24),2&i){const e=t.XpG(),n=t.XpG();t.vxM(e.formValues.keyType!==n.eavConstants.keyTypes.number?0:-1),t.R7$(),t.vxM(e.formValues.keyType===n.eavConstants.keyTypes.number?1:-1)}}function ie(i,m){1&i&&t.nrm(0,"input",22)}function oe(i,m){1&i&&t.nrm(0,"input",24)}function se(i,m){if(1&i&&t.DNE(0,ie,1,0,"input",22)(1,oe,1,0,"input",24),2&i){const e=t.XpG(),n=t.XpG();t.vxM(e.formValues.keyType!==n.eavConstants.keyTypes.number?0:-1),t.R7$(),t.vxM(e.formValues.keyType===n.eavConstants.keyTypes.number?1:-1)}}function re(i,m){if(1&i){const e=t.RV6();t.j41(0,"div",14)(1,"button",25),t.bIt("click",function(){t.eBV(e);const o=t.XpG(2);return t.Njj(o.toggleGuidedKey(!0))}),t.j41(2,"mat-icon",26),t.EFF(3,"search"),t.k0s()(),t.j41(4,"button",27),t.bIt("click",function(){t.eBV(e);const o=t.XpG(2);return t.Njj(o.toggleGuidedKey(!1))}),t.j41(5,"mat-icon",26),t.EFF(6,"text_fields"),t.k0s()()()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("ngClass",t.eq3(2,it,e.guidedKey)),t.R7$(3),t.Y8G("ngClass",t.eq3(4,it,!e.guidedKey))}}function le(i,m){1&i&&(t.j41(0,"app-field-hint",10),t.EFF(1," This field is required "),t.k0s()),2&i&&t.Y8G("isError",!0)}function pe(i,m){1&i&&(t.j41(0,"app-field-hint",10),t.EFF(1," Must be a whole number "),t.k0s()),2&i&&t.Y8G("isError",!0)}function de(i,m){1&i&&(t.j41(0,"app-field-hint",10),t.EFF(1," Must be a valid GUID "),t.k0s()),2&i&&t.Y8G("isError",!0)}function ce(i,m){if(1&i){const e=t.RV6();t.j41(0,"div",1)(1,"div",2)(2,"div",3),t.EFF(3,"Create Metadata"),t.k0s()(),t.j41(4,"div",4)(5,"p"),t.EFF(6," This is a special operation to add an item which is metadata for another item, see "),t.j41(7,"a",5),t.EFF(8,"docs"),t.k0s(),t.EFF(9,". "),t.k0s(),t.j41(10,"form",6)(11,"mat-form-field",7)(12,"mat-label"),t.EFF(13,"Target"),t.k0s(),t.DNE(14,At,4,1,"mat-select",8)(15,jt,1,0,"input",9),t.k0s(),t.DNE(16,kt,2,1,"app-field-hint",10)(17,St,2,2,"app-field-hint",10)(18,Ut,2,1,"app-field-hint",10)(19,Gt,2,1,"app-field-hint",10),t.j41(20,"mat-form-field",7)(21,"mat-label"),t.EFF(22,"Key type"),t.k0s(),t.j41(23,"mat-select",11),t.Z7z(24,Bt,2,2,"mat-option",12,t.fX1),t.k0s()(),t.DNE(26,$t,2,1,"app-field-hint",10)(27,Kt,6,1,"mat-form-field",7)(28,Vt,8,2,"mat-form-field",7),t.j41(29,"app-field-hint"),t.EFF(30," The scope should almost never be changed - "),t.j41(31,"a",13),t.EFF(32,"see help"),t.k0s()(),t.j41(33,"mat-form-field",7)(34,"mat-label"),t.EFF(35,"Key"),t.k0s(),t.DNE(36,te,3,1)(37,ae,2,2)(38,se,2,2,"ng-template",null,0,t.C5r)(40,re,7,6,"div",14),t.k0s(),t.DNE(41,le,2,1,"app-field-hint",10)(42,pe,2,1,"app-field-hint",10)(43,de,2,1,"app-field-hint",10),t.k0s()(),t.j41(44,"mat-dialog-actions",15)(45,"mat-slide-toggle",16),t.bIt("change",function(o){t.eBV(e);const s=t.XpG();return t.Njj(s.toggleGuidedMode(o))}),t.EFF(46),t.k0s(),t.j41(47,"div")(48,"button",17),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.closeDialog())}),t.EFF(49,"Cancel"),t.k0s(),t.j41(50,"button",18),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.confirm())}),t.EFF(51," Confirm "),t.k0s()()()()}if(2&i){const e=m,n=t.XpG();t.R7$(10),t.Y8G("formGroup",n.form),t.R7$(4),t.vxM(e.guidedMode?14:-1),t.R7$(),t.vxM(e.guidedMode?-1:15),t.R7$(),t.vxM(n.form.controls.targetType.touched&&!n.form.controls.targetType.invalid&&e.unknownTargetType?16:-1),t.R7$(),t.vxM(e.targetTypeHint?17:-1),t.R7$(),t.vxM(n.form.controls.targetType.touched&&null!=n.form.controls.targetType.errors&&n.form.controls.targetType.errors.required?18:-1),t.R7$(),t.vxM(n.form.controls.targetType.touched&&null!=n.form.controls.targetType.errors&&n.form.controls.targetType.errors.pattern?19:-1),t.R7$(5),t.Dyx(e.keyTypeOptions),t.R7$(2),t.vxM(n.form.controls.keyType.touched&&null!=n.form.controls.keyType.errors&&n.form.controls.keyType.errors.required?26:-1),t.R7$(),t.vxM(e.guidedMode&&e.formValues.targetType===n.eavConstants.metadata.entity.targetType?27:-1),t.R7$(),t.vxM(!e.guidedMode||e.formValues.targetType!==n.eavConstants.metadata.entity.targetType&&e.formValues.targetType!==n.eavConstants.metadata.contentType.targetType?-1:28),t.R7$(8),t.vxM(e.guidedMode?36:37),t.R7$(4),t.vxM(e.guidedMode&&e.guidedKeyExists?40:-1),t.R7$(),t.vxM(n.form.controls.key.touched&&null!=n.form.controls.key.errors&&n.form.controls.key.errors.required?41:-1),t.R7$(),t.vxM(n.form.controls.key.touched&&null!=n.form.controls.key.errors&&n.form.controls.key.errors.patternWholeNumber?42:-1),t.R7$(),t.vxM(n.form.controls.key.touched&&null!=n.form.controls.key.errors&&n.form.controls.key.errors.patternGuid?43:-1),t.R7$(2),t.Y8G("tippy",e.guidedMode?"Guided mode helps you select options that work":"Manual mode is for advanced uses and allows you to insert any values")("checked",e.guidedMode),t.R7$(),t.SpI(" ",e.guidedMode?"Guided":"Manual"," "),t.R7$(4),t.Y8G("disabled",!n.form.valid)}}let ue=(()=>{class i extends It.${constructor(e,n){super(),this.dialog=e,this.context=n,this.hostClass="dialog-component",this.eavConstants=j.YX,this.dropdownInsertValue=nt.O,this.contentItemsService=(0,h.d)(at.F),this.contentTypesService=(0,h.d)(Tt.gs)}ngOnInit(){this.targetTypeOptions=Object.values(j.YX.metadata).map(n=>({...n})),this.keyTypeOptions=Object.values(j.YX.keyTypes),this.keyTypeOptions$=new c.t([]),this.scopeOptions$=new c.t([]),this.guidedMode$=new c.t(!0),this.contentItems$=new c.t([]),this.contentTypes$=new c.t([]),this.guidedKey$=new c.t(!0),this.fetchScopes(),this.form=new l.J3({}),this.form.addControl("targetType",new l.hs(j.YX.metadata.entity.targetType,[l.k0.required,l.k0.pattern(/^[0-9]+$/)])),this.form.addControl("keyType",new l.hs(j.YX.metadata.entity.keyType,[l.k0.required])),this.form.addControl("contentTypeForContentItems",new l.hs(null)),this.form.addControl("scopeForContentTypes",new l.hs(j.YX.scopes.default.value)),this.form.addControl("key",new l.hs(null,[l.k0.required,Ot(this.form)])),this.subscriptions.add(this.form.controls.scopeForContentTypes.valueChanges.pipe((0,H.Z)(this.form.controls.scopeForContentTypes.value),(0,V.F)()).subscribe(n=>{null!=this.form.controls.contentTypeForContentItems.value&&this.form.controls.contentTypeForContentItems.patchValue(null),n===nt.O?(n=prompt("This is an advanced feature to show content-types of another scope. Don't use this if you don't know what you're doing, as content-types of other scopes are usually hidden for a good reason.")||j.YX.scopes.default.value,this.scopeOptions$.value.some(o=>o.value===n)||this.scopeOptions$.next([{name:n,value:n},...this.scopeOptions$.value]),this.form.controls.scopeForContentTypes.patchValue(n)):this.fetchContentTypes(n)})),this.subscriptions.add((0,vt.h)(this.form.controls.targetType.valueChanges.pipe((0,V.F)()),this.form.controls.keyType.valueChanges.pipe((0,V.F)())).subscribe(()=>{this.guidedKey$.next(!0),null!=this.form.getRawValue().key&&this.form.patchValue({key:null})})),this.subscriptions.add(this.form.controls.contentTypeForContentItems.valueChanges.pipe((0,H.Z)(this.form.controls.contentTypeForContentItems.value),(0,V.F)()).subscribe(n=>{const o=this.form.getRawValue();o.targetType===j.YX.metadata.entity.targetType&&null!=o.key&&this.form.patchValue({key:null}),this.contentItemsService.getAll(n).subscribe(s=>{this.contentItems$.next(s)})}));const e=this.form.valueChanges.pipe((0,H.Z)(this.form.getRawValue()),(0,tt.T)(()=>this.form.getRawValue()),(0,Dt.A)(n=>n));this.subscriptions.add((0,W.z)([e,this.guidedMode$]).subscribe(([n,o])=>{const s=this.targetTypeOptions.find(ot=>ot.targetType===n.targetType),f=o&&s?[s.keyType]:[...this.keyTypeOptions];Ft.a.arraysEqual(f,this.keyTypeOptions$.value)||this.keyTypeOptions$.next(f);const F={};this.keyTypeOptions$.value.includes(n.keyType)||(F.keyType=this.keyTypeOptions$.value[0]);const S=o&&n.targetType===j.YX.metadata.app.targetType;S&&n.key!==this.context.appId&&(F.key=this.context.appId),Object.keys(F).length&&this.form.patchValue(F),et.a.disable(this.form.controls.keyType,o&&this.keyTypeOptions$.value.length<=1),et.a.disable(this.form.controls.key,S)})),this.viewModel$=(0,W.z)([(0,W.z)([this.guidedMode$,this.keyTypeOptions$,this.scopeOptions$,this.contentItems$,this.contentTypes$]),(0,W.z)([e,this.guidedKey$])]).pipe((0,tt.T)(([[n,o,s,f,F],[S,z]])=>({guidedMode:n,unknownTargetType:!this.targetTypeOptions.some(Q=>Q.targetType===S.targetType),targetTypeHint:n&&this.targetTypeOptions.find(Q=>Q.targetType===S.targetType)?.hint,keyTypeOptions:o,scopeOptions:s,guidedKey:z,guidedKeyExists:[j.YX.metadata.entity.targetType,j.YX.metadata.contentType.targetType].includes(S.targetType),formValues:S,contentItems:f,contentTypes:F})))}ngOnDestroy(){this.guidedMode$.complete(),this.keyTypeOptions$.complete(),this.contentItems$.complete(),this.contentTypes$.complete(),this.guidedKey$.complete(),super.ngOnDestroy()}closeDialog(e){this.dialog.close(e)}toggleGuidedKey(e){this.guidedKey$.next(e)}toggleGuidedMode(e){this.guidedMode$.next(e.checked)}confirm(){const e=this.form.getRawValue(),n={target:this.targetTypeOptions.find(o=>o.targetType===e.targetType)?.target,targetType:e.targetType,keyType:e.keyType,key:e.keyType===j.YX.keyTypes.guid?e.key.replace(/{|}/g,""):e.key.toString()};this.closeDialog(n)}fetchContentTypes(e){this.contentTypesService.retrieveContentTypes(e).subscribe(n=>{this.contentTypes$.next(n)})}fetchScopes(){this.contentTypesService.getScopes().subscribe(e=>{this.scopeOptions$.next(e)})}static{this.\u0275fac=function(n){return new(n||i)(t.rXU(r.CP),t.rXU(bt.o))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-create-metadata-dialog"]],hostVars:1,hostBindings:function(n,o){2&n&&t.Mr5("className",o.hostClass)},standalone:!0,features:[t.Vt3,t.aNF],decls:2,vars:3,consts:[["defaultKeyInput",""],[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],["href","https://go.2sxc.org/metadata","target","_blank"],[3,"formGroup"],["color","accent",2,"width","100%","margin-bottom","8px"],["formControlName","targetType","required",""],["matInput","","type","number","min","0","formControlName","targetType","required",""],[3,"isError"],["formControlName","keyType","required",""],[3,"value"],["href","https://2sxc.org/help?tag=scope","target","_blank","appClickStopPropagation",""],["matTextSuffix","",1,"eav-selection-suffix"],[1,"eav-dialog-actions"],["color","accent",3,"change","tippy","checked"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","button","color","accent",3,"click","disabled"],["formControlName","contentTypeForContentItems",3,"placeholder"],["formControlName","scopeForContentTypes",3,"placeholder"],["formControlName","key","required","",3,"placeholder"],["matInput","","type","text","formControlName","key","required",""],[4,"ngTemplateOutlet"],["matInput","","type","number","formControlName","key","required",""],["mat-icon-button","","type","button","tippy","Pick existing value",1,"eav-selection-suffix-button",3,"click","ngClass"],[1,"eav-icon"],["mat-icon-button","","type","button","tippy","Manual entry",1,"eav-selection-suffix-button",3,"click","ngClass"]],template:function(n,o){if(1&n&&(t.DNE(0,ce,52,19,"div",1),t.nI1(1,"async")),2&n){let s;t.vxM((s=t.bMT(1,1,o.viewModel$))?0:-1,s)}},dependencies:[l.YN,l.qT,l.me,l.Q0,l.BC,l.cb,l.YS,l.VZ,l.X1,l.j4,l.JD,E.RG,E.rl,E.nJ,E.yw,Z.Ve,Z.VO,N.wT,N.Sy,A.fS,A.fg,L.T3,_.Hl,_.$z,_.iY,L.YU,u.m_,u.An,r.E7,q.mV,q.sG,L.Jj,Mt.F,Et.c,w.e],encapsulation:2})}}return i})(),me=(()=>{class i{constructor(){this.published="",this.metadata="",this.hasMetadata=""}agInit(e){this.filterParams=e}isFilterActive(){return""!==this.published||""!==this.metadata||""!==this.hasMetadata}doesFilterPass(e){let n=!1,o=!1,s=!1;const F=this.filterParams.valueGetter({api:this.filterParams.api,colDef:this.filterParams.colDef,column:this.filterParams.column,columnApi:this.filterParams.columnApi,context:this.filterParams.context,data:e.node.data,getValue:S=>e.node.data[S],node:e.node});return n=""===this.published||null!=F.published&&F.published.toString()===this.published,o=""===this.metadata||null!=F.metadata&&F.metadata.toString()===this.metadata,s=""===this.hasMetadata||null!=F.hasMetadata&&F.hasMetadata.toString()===this.hasMetadata,n&&o&&s}getModel(){return this.isFilterActive()?{filterType:"pub-meta",published:this.published,metadata:this.metadata,hasMetadata:this.hasMetadata}:void 0}setModel(e){this.published=e?e.published:"",this.metadata=e?e.metadata:"",this.hasMetadata=e?e.hasMetadata:""}afterGuiAttached(e){}filterChanged(){this.filterParams.filterChangedCallback()}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-pub-meta-filter"]],standalone:!0,features:[t.aNF],decls:27,vars:3,consts:[[1,"title"],[3,"ngModelChange","ngModel"],["value",""],["value","true"],["value","false"]],template:function(n,o){1&n&&(t.j41(0,"div",0),t.EFF(1,"Published"),t.k0s(),t.j41(2,"mat-radio-group",1),t.mxI("ngModelChange",function(f){return t.DH7(o.published,f)||(o.published=f),f}),t.bIt("ngModelChange",function(){return o.filterChanged()}),t.j41(3,"mat-radio-button",2),t.EFF(4,"All"),t.k0s(),t.j41(5,"mat-radio-button",3),t.EFF(6,"Published"),t.k0s(),t.j41(7,"mat-radio-button",4),t.EFF(8,"Not published"),t.k0s()(),t.j41(9,"div",0),t.EFF(10,"Is Metadata"),t.k0s(),t.j41(11,"mat-radio-group",1),t.mxI("ngModelChange",function(f){return t.DH7(o.metadata,f)||(o.metadata=f),f}),t.bIt("ngModelChange",function(){return o.filterChanged()}),t.j41(12,"mat-radio-button",2),t.EFF(13,"All"),t.k0s(),t.j41(14,"mat-radio-button",3),t.EFF(15,"Is metadata"),t.k0s(),t.j41(16,"mat-radio-button",4),t.EFF(17,"Is not metadata"),t.k0s()(),t.j41(18,"div",0),t.EFF(19,"Has Metadata"),t.k0s(),t.j41(20,"mat-radio-group",1),t.mxI("ngModelChange",function(f){return t.DH7(o.hasMetadata,f)||(o.hasMetadata=f),f}),t.bIt("ngModelChange",function(){return o.filterChanged()}),t.j41(21,"mat-radio-button",2),t.EFF(22,"All"),t.k0s(),t.j41(23,"mat-radio-button",3),t.EFF(24,"Has metadata"),t.k0s(),t.j41(25,"mat-radio-button",4),t.EFF(26,"Has no metadata"),t.k0s()()),2&n&&(t.R7$(2),t.R50("ngModel",o.published),t.R7$(9),t.R50("ngModel",o.metadata),t.R7$(9),t.R50("ngModel",o.hasMetadata))},dependencies:[D.Wk,D.VT,D._g,l.YN,l.BC,l.vS],styles:[".title[_ngcontent-%COMP%]{padding:12px 12px 0}.mat-mdc-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;overflow:hidden;padding:12px;width:160px;height:104px}"]})}}return i})();var he=a(3347),fe=a(9841);function _e(i,m){1&i&&(t.nrm(0,"div",5),t.nI1(1,"safeHtml")),2&i&&t.Y8G("innerHTML",t.bMT(1,1,m),t.npT)}function ge(i,m){if(1&i){const e=t.RV6();t.j41(0,"button",17),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.debugFilter())}),t.j41(1,"mat-icon",11),t.EFF(2,"filter_list"),t.k0s(),t.j41(3,"span"),t.EFF(4,"Filter"),t.k0s()()}}let Ce=(()=>{class i{#a;#o;#i;#s;#e;constructor(e,n,o,s,f){this.dialog=e,this.snackBar=n,this.matDialog=o,this.viewContainerRef=s,this.changeDetectorRef=f,this.log=(0,B.T)({ContentItemsComponent:i}),this.isDebug=(0,t.WQX)(pt.B).isDebug,this.#a=(0,h.d)(lt.R),this.#o=(0,h.d)(P.D),this.#i=(0,h.d)(at.F),this.#s=(0,h.d)(y.g),this.#e=(0,h.d)(rt.c),this.contentType=(0,t.vPA)(void 0),this.items=(0,t.vPA)(void 0),this.gridOptions={...U.C},this.#n=new c.t(null),this.#t=this.#e.getParam("contentTypeStaticName")}#n;#t;ngOnInit(){this.fetchContentType(),this.fetchItems(),this.fetchColumns(),this.#e.doOnDialogClosed(()=>this.fetchItems())}ngOnDestroy(){this.#n.complete()}closeDialog(){this.dialog.close()}onGridReady(e){this.#n.next(e.api)}fetchContentType(){this.#s.retrieveContentType(this.#t).subscribe(e=>{this.contentType.set(e)})}fetchItems(){this.#i.getAll(this.#t).subscribe(e=>{this.items.set(e)})}fetchColumns(){this.#i.getColumns(this.#t).subscribe(e=>{const n=e.filter(f=>!f.IsEphemeral),o=this.buildColumnDefs(n),s=function yt(i,m){if(!i)return;let e;"="===i.charAt(i.length-1)&&(i=atob(i));try{e=JSON.parse(i)}catch{console.error("Can't parse JSON with filters from url:",i)}if(!e)return;const n={};return(e.IsPublished||e.IsMetadata)&&(n.Status={filterType:"pub-meta",published:e.IsPublished??"",metadata:e.IsMetadata??"",hasMetadata:""}),Object.entries(e).filter(([o,s])=>"IsPublished"!==o&&"IsMetadata"!==o).forEach(([o,s])=>{if(m.find(F=>F.headerName===o)?.filter!==k){if("string"==typeof s)n[o]={filterType:"text",type:"equals",filter:s};else if("number"==typeof s)n[o]={filterType:"number",type:"equals",filter:s,filterTo:null};else if("boolean"==typeof s){const F={filterType:"boolean",filter:s.toString()};n[o]=F}}else{const F={filterType:"entity",filter:"string"==typeof(s=Ct.i.tryParse(s)??s)?s:void 0,idFilter:"number"==typeof s?[s]:Array.isArray(s)?s.filter(S=>"number"==typeof S):void 0};n[o]=F}}),n}(sessionStorage.getItem(G.bo),o);this.#n.value?this.setColumnDefs(o,s):this.#n.pipe((0,p.p)(f=>null!=f),(0,g.s)(1)).subscribe(f=>{this.setColumnDefs(o,s)})})}setColumnDefs(e,n){this.#n.value.setColumnDefs(e),n&&(this.log.a("Will try to apply filter:",n),this.#n.value.setFilterModel(n))}openMetadata(e){const n=C.H.getUrlEntity(e.Guid,`Metadata for Entity: ${e._Title} (${e.Id})`,this.#t);this.#e.navRelative([n])}editItem(e){const n={items:[null==e?$.c.newFromType(this.#t):$.c.editId(e.Id)]},o=(0,O.s)(n);this.#e.navRelative([`edit/${o}`])}exportContent(){const e=this.#n.value.getFilterModel(),n=Object.keys(e).length>0,o=[];n&&this.#n.value.forEachNodeAfterFilterAndSort(s=>{o.push(s.data.Id)}),this.#e.navRelative([`export/${this.#t}${o.length>0?`/${o}`:""}`])}filesDropped(e){const n=e[0];switch(n.name.substring(n.name.lastIndexOf(".")+1).toLocaleLowerCase()){case"xml":this.importContent(e);break;case"json":this.importItem(e)}}importContent(e){this.#e.navRelative([`${this.#t}/import`],{state:{files:e}})}importItem(e){this.#e.navRelative(["import"],{state:{files:e}})}createMetadata(){this.matDialog.open(ue,{autoFocus:!1,viewContainerRef:this.viewContainerRef,width:"650px"}).afterClosed().subscribe(n=>{if(null==n)return;const o={items:[$.c.newMetadataFromInfo(this.#t,n)]},s=(0,O.s)(o);this.#e.navRelative([`edit/${s}`]),this.changeDetectorRef.markForCheck()})}debugFilter(){console.warn("Current filter:",this.#n.value.getFilterModel()),this.snackBar.open("Check console for filter information",void 0,{duration:3e3})}buildColumnDefs(e){const n=[{...d.r.IdWithDefaultRenderer,cellClass:o=>("id-action no-padding no-outline "+(o.data._EditInfo.ReadOnly?"disabled":"")).split(" "),cellRendererParams:d.r.idFieldParamsTooltipGetter()},{field:"Status",width:82,headerClass:"dense",cellClass:"secondary-action no-padding".split(" "),filter:me,valueGetter:o=>{const s=o.data;return{published:s.IsPublished,metadata:!!s.For,hasMetadata:!!s.Metadata&&s.Metadata.length>0}},cellRenderer:gt,cellRendererParams:{onOpenMetadata:s=>this.openMetadata(s)}},{...d.r.TextWidePrimary,headerName:"Item (Entity)",field:"_Title",flex:2,onCellClicked:o=>this.editItem(o.data)},{headerName:"Stats",headerTooltip:"Used by others / uses others",field:"_Used",width:70,headerClass:"dense",cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:o=>`${o.data._Used} / ${o.data._Uses}`},{...d.r.ActionsPinnedRight3,cellRenderer:ct,cellRendererParams:{do:(s,f)=>{switch(s){case"clone":this.clone(f);break;case"export":this.export(f);break;case"delete":this.delete(f)}}}}];for(const o of e){const s={headerName:o.StaticName,field:o.StaticName,flex:2,minWidth:250,cellClass:"no-outline",sortable:!0};switch(o.Type){case b.O.Entity:s.allowMultiValue=o.Metadata?.Entity?.AllowMultiValue??!0,s.cellRenderer=mt,s.valueGetter=this.valueGetterEntityField,s.filter=k;break;case b.O.DateTime:s.useTimePicker=o.Metadata?.DateTime?.UseTimePicker??!1,s.valueGetter=this.valueGetterDateTime,s.filter="agTextColumnFilter";break;case b.O.Boolean:s.valueGetter=this.valueGetterBoolean,s.filter=v.y;break;case b.O.Number:s.filter="agNumberColumnFilter";break;default:s.filter="agTextColumnFilter"}n.push(s)}return n}clone(e){const n={items:[$.c.copy(this.#t,e.Id)]},o=(0,O.s)(n);this.#e.navRelative([`edit/${o}`])}export(e){this.#o.exportEntity(e.Id,this.#t,!0)}delete(e){confirm(`Delete '${e._Title}' (${e._RepositoryId})?`)&&(this.snackBar.open("Deleting..."),this.#a.delete(this.#t,e._RepositoryId,!1).subscribe({next:()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchItems()},error:n=>{this.snackBar.dismiss(),confirm(`${n.error.ExceptionMessage}\n\nDo you want to force delete '${e._Title}' (${e._RepositoryId})?`)&&(this.snackBar.open("Deleting..."),this.#a.delete(this.#t,e._RepositoryId,!0).subscribe(()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchItems()}))}}))}valueGetterEntityField(e){const n=e.data[e.colDef.field];return 0===n.length?null:n.map(o=>o.Title)}valueGetterDateTime(e){const n=e.data[e.colDef.field];return n?e.colDef.useTimePicker?n.replace("T"," ").replace("Z",""):n.split("T")[0]:null}valueGetterBoolean(e){const n=e.data[e.colDef.field];return"boolean"!=typeof n?null:n.toString()}static{this.\u0275fac=function(n){return new(n||i)(t.rXU(r.CP),t.rXU(he.UG),t.rXU(r.bZ),t.rXU(t.c1b),t.rXU(t.gRc))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-content-items"]],standalone:!0,features:[t.aNF],decls:38,vars:6,consts:[["appToggleDebug","",1,"eav-dialog","nav-component-wrapper"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"eav-dialog-content","nav-component-wrapper"],[3,"innerHTML"],[1,"grid-wrapper"],["appDragAndDrop","",1,"ag-theme-material",3,"gridReady","filesDropped","rowData","gridOptions","allowedFileTypes"],[1,"eav-dialog-actions"],[1,"eav-dialog-actions-div"],["mat-button","","tippy","Export xml list",1,"eav-button__with-icon",3,"click"],[1,"eav-icon"],["mat-button","","tippy","Import xml list",1,"eav-button__with-icon",3,"click"],["mat-button","","tippy","Import single json item",1,"eav-button__with-icon",3,"click"],["mat-button","","tippy","Create metadata",1,"eav-button__with-icon",3,"click"],["mat-button","","color","accent","tippy","Print filter to console",1,"eav-button__with-icon"],["mat-fab","","mat-elevation-z24","","tippy","Add item",1,"grid-fab",3,"click"],["mat-button","","color","accent","tippy","Print filter to console",1,"eav-button__with-icon",3,"click"]],template:function(n,o){if(1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.EFF(3),t.k0s(),t.j41(4,"button",3),t.bIt("click",function(){return o.closeDialog()}),t.j41(5,"mat-icon"),t.EFF(6,"close"),t.k0s()()(),t.j41(7,"div",4),t.nrm(8,"router-outlet"),t.DNE(9,_e,2,3,"div",5),t.j41(10,"div",6)(11,"ag-grid-angular",7),t.bIt("gridReady",function(f){return o.onGridReady(f)})("filesDropped",function(f){return o.filesDropped(f)}),t.k0s()()(),t.j41(12,"mat-dialog-actions",8)(13,"div",9)(14,"button",10),t.bIt("click",function(){return o.exportContent()}),t.j41(15,"mat-icon",11),t.EFF(16,"cloud_download"),t.k0s(),t.j41(17,"span"),t.EFF(18,"Data"),t.k0s()(),t.j41(19,"button",12),t.bIt("click",function(){return o.importContent()}),t.j41(20,"mat-icon",11),t.EFF(21,"cloud_upload"),t.k0s(),t.j41(22,"span"),t.EFF(23,"Data"),t.k0s()(),t.j41(24,"button",13),t.bIt("click",function(){return o.importItem()}),t.j41(25,"mat-icon",11),t.EFF(26,"cloud_upload"),t.k0s(),t.j41(27,"span"),t.EFF(28,"Item"),t.k0s()(),t.j41(29,"button",14),t.bIt("click",function(){return o.createMetadata()}),t.j41(30,"mat-icon",11),t.EFF(31,"local_offer"),t.k0s(),t.j41(32,"span"),t.EFF(33,"Create Metadata"),t.k0s()(),t.DNE(34,ge,5,0,"button",15),t.k0s(),t.j41(35,"button",16),t.bIt("click",function(){return o.editItem(null)}),t.j41(36,"mat-icon"),t.EFF(37,"add"),t.k0s()()()()),2&n){let s,f;t.R7$(3),t.SpI(" ",(null==(s=o.contentType())?null:s.Label)||(null==(s=o.contentType())?null:s.Name)," Data "),t.R7$(6),t.vxM((f=null==(f=o.contentType())||null==f.Properties?null:f.Properties.ListInstructions)?9:-1,f),t.R7$(2),t.Y8G("rowData",o.items())("gridOptions",o.gridOptions)("allowedFileTypes","xml,json"),t.R7$(23),t.vxM(o.isDebug()?34:-1)}},dependencies:[_.Hl,_.$z,_.iY,_.Sr,u.m_,u.An,T.n3,r.E7,Y.$,st.S,I.V,X.p,fe.xs],encapsulation:2})}}return i})()},1772:(R,M,a)=>{a.d(M,{I:()=>p,u:()=>c});var t=a(6647),_=a(9452),r=a(3550),u=a(6474),T=a(9148);const c="admin/app/";let p=(()=>{class g extends u.D{importApp(y,P,C=!1){const d=new FormData;return d.append("File",y),d.append("Name",P??""),this.http.post(this.apiUrl(c+"Import"),d,{params:{zoneId:this.zoneId}}).pipe((0,t.n)(v=>{if(C&&v.Messages[0]?.MessageType===r.G1.Warning){const l=prompt(v.Messages[0].Text+" Would you like to install it using another folder name?");if(l)return this.importApp(y,l,!0)}return(0,_.of)(v)}))}static{this.\u0275fac=(()=>{let y;return function(C){return(y||(y=T.xGo(g)))(C||g)}})()}static{this.\u0275prov=T.jDH({token:g,factory:g.\u0275fac})}}return g})()},3758:(R,M,a)=>{a.d(M,{F:()=>P});var t=a(316),_=a(4950),r=a(9148);const u=["*"],T=C=>({"hint-box__short":C});function c(C,d){1&C&&r.eu8(0)}function p(C,d){if(1&C&&(r.j41(0,"mat-hint"),r.DNE(1,c,1,0,"ng-container",2),r.k0s()),2&C){r.XpG();const v=r.sdS(4);r.R7$(),r.Y8G("ngTemplateOutlet",v)}}function g(C,d){1&C&&r.eu8(0)}function h(C,d){if(1&C&&(r.j41(0,"mat-error"),r.DNE(1,g,1,0,"ng-container",2),r.k0s()),2&C){r.XpG();const v=r.sdS(4);r.R7$(),r.Y8G("ngTemplateOutlet",v)}}function y(C,d){1&C&&r.SdG(0)}let P=(()=>{class C{constructor(){this.isError=!1,this.isShort=!0}toggleIsShort(){this.isShort=!this.isShort}static{this.\u0275fac=function(l){return new(l||C)}}static{this.\u0275cmp=r.VBU({type:C,selectors:[["app-field-hint"]],inputs:{isError:"isError"},standalone:!0,features:[r.aNF],ngContentSelectors:u,decls:5,vars:4,consts:[["content",""],[1,"hint-box",3,"click","ngClass"],[4,"ngTemplateOutlet"]],template:function(l,D){if(1&l){const E=r.RV6();r.NAR(),r.j41(0,"div",1),r.bIt("click",function(){return r.eBV(E),r.Njj(D.toggleIsShort())}),r.DNE(1,p,2,1,"mat-hint")(2,h,2,1,"mat-error"),r.k0s(),r.DNE(3,y,1,0,"ng-template",null,0,r.C5r)}if(2&l){let E;r.Y8G("ngClass",r.eq3(2,T,D.isShort)),r.R7$(),r.vxM(!1===(E=D.isError)?1:!0===E?2:-1)}},dependencies:[_.RG,_.MV,_.TL,t.YU,t.T3],styles:[".hint-box[_ngcontent-%COMP%]{margin-top:4px}.hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{font-size:12px;display:block}.hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]})}}return C})()},5858:(R,M,a)=>{a.d(M,{O:()=>t});const t="DROPDOWN_INSERT_VALUE"},9333:(R,M,a)=>{a.d(M,{c:()=>r});var t=a(4435),_=a(9148);let r=(()=>{class u{constructor(){this.log=(0,t.T)({ClickStopPropagationDirective:u}),this.log.a("constructor")}onClick(c){this.log.a("onClick",{event:c}),c.stopPropagation()}static{this.\u0275fac=function(p){return new(p||u)}}static{this.\u0275dir=_.FsC({type:u,selectors:[["","appClickStopPropagation",""]],hostBindings:function(p,g){1&p&&_.bIt("click",function(y){return g.onClick(y)})},standalone:!0})}}return u})()},5699:(R,M,a)=>{a.d(M,{V:()=>r});var t=a(9431),_=a(9148);let r=(()=>{class u{constructor(c){this.globalConfigService=c}onClick(c){(navigator.platform.match("Mac")?c.metaKey:c.ctrlKey)&&c.shiftKey&&c.altKey&&(this.globalConfigService.toggleDebugEnabled(),window.getSelection().removeAllRanges())}static{this.\u0275fac=function(p){return new(p||u)(_.rXU(t.B))}}static{this.\u0275dir=_.FsC({type:u,selectors:[["","appToggleDebug",""]],hostBindings:function(p,g){1&p&&_.bIt("click",function(y){return g.onClick(y)})},standalone:!0})}}return u})()},5959:(R,M,a)=>{a.d(M,{h:()=>U,z:()=>T});var t=a(271),_=a(5445),r=a(6474),u=a(9148);const T="admin/field/all",v=_.X6+"SetTitle",A="admin/field/GetSharedFields";let U=(()=>{class G extends r.D{paramsAppId(I={}){return{params:{appid:this.appId,...I}}}typeListRetrieve(){return this.http.get(this.apiUrl("admin/field/DataTypes"),this.paramsAppId())}getInputTypesList(){return this.http.get(this.apiUrl("admin/field/InputTypes"),this.paramsAppId()).pipe((0,t.T)(I=>I.map(O=>({dataType:O.Type.substring(0,O.Type.indexOf("-")),inputType:O.Type,label:O.Label,description:O.Description,isDefault:O.IsDefault,isObsolete:O.IsObsolete,isRecommended:O.IsRecommended,obsoleteMessage:O.ObsoleteMessage,icon:O.IsDefault?"star":O.IsRecommended?"star_outline":null}))))}getReservedNames(){return this.http.get(this.apiUrl("admin/field/ReservedNames"))}getFields(I){return this.http.get(this.apiUrl(T),this.paramsAppId({staticName:I})).pipe((0,t.T)(b=>{if(b)for(const O of b){if(!O.Metadata)continue;const B=O.Metadata;B.merged={...B.All,...B[O.Type],...B[O.InputType]}}return b}))}getShareableFields(){return this.http.get(this.apiUrl(A),this.paramsAppId())}getShareableFieldsFor(I){return this.#a(A,I)}getAncestors(I){return this.#a("admin/field/GetAncestors",I)}getDescendants(I){return this.#a("admin/field/GetDescendants",I)}#a(I,b){return this.http.get(this.apiUrl(I),this.paramsAppId({attributeId:b}))}addInheritedField(I,b,O,B){return this.http.post(this.apiUrl("admin/field/AddInheritedField"),null,this.paramsAppId({contentTypeId:I.toString(),sourceType:b,sourceField:O,name:B}))}share(I,b=!0){return this.http.post(this.apiUrl("admin/field/Share"),null,{params:{appid:this.appId,attributeId:I.toString(),share:b}})}inherit(I,b){return this.http.post(this.apiUrl("admin/field/Inherit"),null,{params:{appid:this.appId,attributeId:I.toString(),inheritMetadataOf:b}})}reOrder(I,b){return this.http.post(this.apiUrl("admin/field/Sort"),null,{params:{appid:this.appId,contentTypeId:b.Id.toString(),order:JSON.stringify(I)}})}setTitle(I,b){return this.http.post(this.apiUrl(v),null,{params:{appid:this.appId,contentTypeId:b.Id.toString(),attributeId:I.Id.toString()}})}rename(I,b,O){return this.http.post(this.apiUrl("admin/field/Rename"),null,{params:{appid:this.appId,contentTypeId:b.toString(),attributeId:I.toString(),newName:O}})}delete(I,b){if(I.IsTitle)throw new Error("Can't delete Title");return this.http.delete(this.apiUrl("admin/field/Delete"),{params:{appid:this.appId,contentTypeId:b.Id.toString(),attributeId:I.Id.toString()}})}add(I,b){return this.http.post(this.apiUrl("admin/field/Add"),null,{params:{AppId:this.appId,ContentTypeId:b.toString(),Id:I.Id.toString(),Type:I.Type,InputType:I.InputType,StaticName:I.StaticName,IsTitle:I.IsTitle.toString(),Index:I.SortOrder.toString()}})}updateInputType(I,b,O){return this.http.post(this.apiUrl("admin/field/InputType"),null,{params:{appId:this.appId,attributeId:I,field:b,inputType:O}})}static{this.\u0275fac=(()=>{let I;return function(O){return(I||(I=u.xGo(G)))(O||G)}})()}static{this.\u0275prov=u.jDH({token:G,factory:G.\u0275fac})}}return G})()},1726:(R,M,a)=>{a.d(M,{O:()=>t});const t={Boolean:"Boolean",Custom:"Custom",DateTime:"DateTime",Empty:"Empty",Entity:"Entity",Hyperlink:"Hyperlink",Number:"Number",String:"String"}},8471:(R,M,a)=>{a.d(M,{c:()=>y});var t=a(2159),_=a(1567),r=a(3037),u=a(271),T=a(5057),c=a(4979),p=a(4435),g=a(9148);const h={doOnDialogClosed:!0};let y=(()=>{class P extends c.V{constructor(d,v){super(),this.router=d,this.route=v,this.log=(0,p.T)({DialogRoutingService:P},h)}get snapshot(){return this.route.snapshot}get url(){return this.router.url}getParam(d){return this.route.snapshot.paramMap.get(d)}getParams(d){const v=this.route.snapshot.paramMap;return d.reduce((l,D)=>(l[D]=v.get(D),l),{})}getQueryParam(d){return this.route.snapshot.queryParamMap.get(d)}getQueryParams(d){const v=this.route.snapshot.queryParamMap;return d.reduce((l,D)=>(l[D]=v.get(D),l),{})}state(){return this.router.getCurrentNavigation().extras?.state}doOnDialogClosed(d){const v=this.log.fnIf("doOnDialogClosed");this.subscriptions.add(this.childDialogClosed$().subscribe(()=>d())),v.end()}navPath(d,v){return this.router.navigate([d],v)}navRelative(d,v){return this.router.navigate(d,{...v,relativeTo:this.route})}navParentFirstChild(d,v){return this.router.navigate(d,{...v,relativeTo:this.route.parent.firstChild})}childDialogClosed$(){return this.router.events.pipe((0,_.p)(d=>d instanceof t.wF),(0,r.Z)(!!this.route.snapshot.firstChild),(0,u.T)(()=>!!this.route.snapshot.firstChild),(0,T.J)(),(0,_.p)(([d,v])=>d&&!v))}static{this.\u0275fac=function(v){return new(v||P)(g.KVO(t.Ix),g.KVO(t.nX))}}static{this.\u0275prov=g.jDH({token:P,factory:P.\u0275fac})}}return P})()},6817:(R,M,a)=>{a.d(M,{R:()=>u});var t=a(9234),_=a(6474),r=a(9148);let u=(()=>{class T extends _.D{create(p,g){return this.http.post(`app/auto/data/${p}`,g,{params:{appId:this.appId,zoneId:this.zoneId}})}update(p,g,h){return this.http.post(`app/auto/data/${p}/${g}`,h,{params:{appId:this.appId,zoneId:this.zoneId}})}delete(p,g,h){return this.http.delete(this.apiUrl(t.gb+"delete"),{params:{contentType:p,id:g.toString(),appId:this.appId,force:h.toString()}})}static{this.\u0275fac=(()=>{let p;return function(h){return(p||(p=r.xGo(T)))(h||T)}})()}static{this.\u0275prov=r.jDH({token:T,factory:T.\u0275fac})}}return T})()},9234:(R,M,a)=>{a.d(M,{Gg:()=>C,Tr:()=>d,gb:()=>P});var t=a(1567),_=a(6647),r=a(6301),u=a(271),T=a(2938),c=a(4435),p=a(6474),g=a(4839),h=a(9148);const y={all:!1,getEntities:!1,getAvailableEntities:!1,delete:!1},P="admin/entity/",C="admin/entity/list";let d=(()=>{class v extends p.D{constructor(){super(...arguments),this.log=(0,c.T)({EntityService:v},y),this.queryService=(0,T.d)(g.c)}getEntities$(D){return this.log.fnIf("getEntities"),D.pipe((0,t.p)(E=>null!=E),(0,_.n)(E=>this.getAvailableEntities(E.contentTypeName).pipe((0,r.t)(1))))}getAvailableEntities(D,E){return this.log.fnIf("getAvailableEntities"),this.queryService.getEntities({contentTypes:[D],itemIds:E,fields:"Id,Guid,Title",log:"getAvailableEntities"}).pipe((0,u.T)(x=>x.Default))}delete(D,E,A,x,k,U){return this.log.fnIf("delete",{appId:D,contentType:E,entityId:A,force:x,parentId:k,parent}),this.http.delete(this.apiUrl(P+"delete"),{params:{contentType:E,id:A.toString(),appId:D,force:x.toString(),...k&&{parentId:k.toString()},...k&&U&&{parentField:U}}})}static{this.\u0275fac=(()=>{let D;return function(A){return(D||(D=h.xGo(v)))(A||v)}})()}static{this.\u0275prov=h.jDH({token:v,factory:v.\u0275fac})}}return v})()},4839:(R,M,a)=>{a.d(M,{c:()=>c});var t=a(4435),_=a(8873),r=a(9148),u=a(6443);const T={all:!1,getAvailableEntities:!1,getEntities:!1};let c=(()=>{class p{constructor(h,y){this.http=h,this.context=y,this.log=(0,t.T)({QueryService:p},T)}getFromQuery(h,y,P,C){this.log.fnIf("getAvailableEntities",{queryUrl:h,params:y,fields:P,entitiesFilter:C});const d=!!y,E=(((y?.toLocaleLowerCase()??"").includes("appid=")?"":`&appId=${this.context.appId}`)+(d?`&${y}`:"")+"&$select="+(P??"")).substring(1);return this.http.post(`app/auto/query/${h}?${E}`,{Guids:C})}getEntities({contentTypes:h,itemIds:y,fields:P,log:C}){this.log.fnIf("getEntities",{log:C,contentTypes:h,itemIds:y,fields:P});const v=("&typeNames="+(h?.join(",")??"")+`&appId=${this.context.appId}&itemIds=`+(y?.join(",")??"")+"&$select="+(P??"")).substring(1);return this.http.post(`app/auto/query/System.EntityPicker/Default?${v}`,{})}static{this.\u0275fac=function(y){return new(y||p)(r.KVO(u.Qq),r.KVO(_.o))}}static{this.\u0275prov=r.jDH({token:p,factory:p.\u0275fac})}}return p})()},4979:(R,M,a)=>{a.d(M,{V:()=>r});var t=a(7092),_=a(9148);let r=(()=>{class u{constructor(){this.subscriptions=new t.yU}ngOnDestroy(){this.destroy()}destroy(){this.subscriptions.unsubscribe()}static{this.\u0275fac=function(p){return new(p||u)}}static{this.\u0275prov=_.jDH({token:u,factory:u.\u0275fac})}}return u})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/18.02.00/dist/ng-edit/projects_eav-ui_src_app_content-items_content-items_component_ts-projects_eav-ui_src_app_shar-cb00d9.507c82b1a3518abc.js.map