"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_apps-management_apps-list_apps-list_component_ts"],{1609:(I,h,e)=>{e.r(h),e.d(h,{AppsListComponent:()=>Z});var l=e(9509),f=e(8824),b=e(316),t=e(9148),A=e(6256),v=e(4175),C=e(7941),u=e(3840),y=e(2159),F=e(3183),d=e(2938),O=e(8713),n=e(8136),r=e(4824),g=e(6838),m=e(8991),c=e(1828),R=e(1960),S=e(251),L=e(4575),M=e(3216),j=e(4435),U=e(7037),k=e(8471),B=e(8873),$=e(3583);const W={states:{true:{tooltip:"Show this app to users",icon:"visibility"},false:{tooltip:"Hide this app from users",icon:"visibility_off"}}},G={states:{true:{clickable:!0,tooltip:"This App uses obsolete code which will cause problems on future upgrades. Click to see details.",icon:"bug_report",getUrl:o=>window.$2sxc.http.apiUrl("sys/insights/logs?key=warnings-obsolete&filter=AppId="+o.Id)},false:{tooltip:"Hide this app from users",icon:""}}};var P=e(1034),D=e(5060),N=e(1657),x=e(4601);function K(o,T){1&o&&(t.j41(0,"mat-icon"),t.EFF(1,"foundation"),t.k0s())}function Y(o,T){1&o&&(t.j41(0,"mat-icon"),t.EFF(1,"holiday_village"),t.k0s())}function V(o,T){if(1&o){const s=t.RV6();t.j41(0,"button",7),t.bIt("click",function(){t.eBV(s);const i=t.XpG();return t.Njj(i.do("flushCache"))}),t.j41(1,"mat-icon"),t.EFF(2,"cached"),t.k0s(),t.j41(3,"span"),t.EFF(4,"Flush cache"),t.k0s()(),t.j41(5,"button",8),t.bIt("click",function(){t.eBV(s);const i=t.XpG();return t.Njj(i.do("deleteApp"))}),t.j41(6,"mat-icon"),t.EFF(7,"delete"),t.k0s(),t.j41(8,"span"),t.EFF(9,"Delete"),t.k0s()()}if(2&o){const s=t.XpG();t.R7$(5),t.Y8G("disabled",!s.app.IsApp)}}let X=(()=>{class o{agInit(s){this.params=s,this.app=this.params.data}refresh(s){return!0}do(s){this.params.do(s,this.app)}static{this.\u0275fac=function(a){return new(a||o)}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["app-apps-list-actions"]],standalone:!0,features:[t.aNF],decls:11,vars:8,consts:[["menu","matMenu"],[1,"actions-component"],[1,"eav-grid-action-button","icon",3,"tippy","tippyDisabled"],[3,"lightSpeedOwner","params","lightSpeed"],["matRipple","","tippy","More",1,"eav-grid-action-button","highlight",3,"matMenuTriggerFor"],[1,"grid-more-menu"],["matMenuContent",""],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click","disabled"]],template:function(a,i){if(1&a&&(t.j41(0,"div",1)(1,"div",2),t.DNE(2,K,2,0,"mat-icon")(3,Y,2,0,"mat-icon"),t.k0s(),t.nrm(4,"app-lightspeed-action",3),t.j41(5,"div",4)(6,"mat-icon"),t.EFF(7,"more_horiz"),t.k0s()()(),t.j41(8,"mat-menu",5,0),t.DNE(10,V,10,1,"ng-template",6),t.k0s()),2&a){const p=t.sdS(9);t.R7$(),t.Y8G("tippy",i.app.IsGlobal?"This app is global":i.app.IsInherited?"This app is inherited":"")("tippyDisabled",!i.app.IsGlobal&&!i.app.IsInherited),t.R7$(),t.vxM(i.app.IsGlobal?2:-1),t.R7$(),t.vxM(i.app.IsInherited?3:-1),t.R7$(),t.Y8G("lightSpeedOwner",i.app)("params",i.params)("lightSpeed",i.app.lightSpeed),t.R7$(),t.Y8G("matMenuTriggerFor",p)}},dependencies:[x.e,u.m_,u.An,A.Y,D.pZ,D.r6,P.Cn,P.kk,P.fb,P.z8,P.Cp,N.E],encapsulation:2})}}return o})();var H=e(3347),z=e(9841);const Q=o=>({"fab-opened":o});let Z=(()=>{class o{#e;#t;constructor(s,a,i,p,E){this.snackBar=s,this.context=a,this.matDialog=i,this.viewContainerRef=p,this.changeDetectorRef=E,this.log=(0,j.T)({AppsListComponent:o}),this.fabOpen=(0,t.vPA)(!1),this.apps=(0,t.vPA)([]),this.gridOptions=this.buildGridOptions(),this.features=(0,t.WQX)(r.t),this.isAddFromFolderEnabled=this.features.isEnabled[n.T.AppSyncWithSiteFiles],this.#e=(0,d.d)($.U),this.#t=(0,d.d)(k.c),f.syG.registerModules([l.Q])}ngOnInit(){this.#s(),this.#t.doOnDialogClosed(()=>this.#s())}openChange(s){this.fabOpen.set(s)}browseCatalog(){window.open("https://2sxc.org/apps","_blank")}createApp(){this.#t.navParentFirstChild(["create"])}createInheritedApp(){this.#t.navParentFirstChild(["create-inherited"])}addFromFolder(){this.#t.navParentFirstChild(["add-app-from-folder"])}importApp(s){this.#t.navParentFirstChild(["import"],{state:{files:s}})}deleteApp(s){const a=prompt(`This cannot be undone. To really delete this app, type 'yes!' or type/paste the app-name here. Are you sure want to delete '${s.Name}' (${s.Id})?`);null!==a&&(a===s.Name||"yes!"===a?(this.snackBar.open("Deleting..."),this.#e.delete(s.Id).subscribe({error:()=>{this.snackBar.open("Delete failed. Please check console for more information",void 0,{duration:3e3}),this.#s()},next:()=>{this.snackBar.open("Deleted",void 0,{duration:2e3}),this.#s()}})):alert("Input did not match - will not delete"))}flushApp(s){confirm(`Flush the App Cache for ${s.Name} (${s.Id})?`)&&(this.snackBar.open("Flushing cache..."),this.#e.flushCache(s.Id).subscribe({error:()=>{this.snackBar.open("Cache flush failed. Please check console for more information",void 0,{duration:3e3})},next:()=>{this.snackBar.open("Cache flushed",void 0,{duration:2e3})}}))}openLightSpeed(s){const a=(0,M.s)(O.g.getLightSpeedEditParams(s.Id));this.#t.navParentFirstChild([`${this.context.zoneId}/${s.Id}/edit/${a}`])}openApp(s){this.#t.navParentFirstChild([s.Id.toString()])}openLightSpeedFeatInfo(){(0,g.j)(this.matDialog,n.T.LightSpeed,this.viewContainerRef,this.changeDetectorRef)}buildGridOptions(){return{...S.C,columnDefs:[{...c.r.IdWithDefaultRenderer,cellRendererParams:c.r.idFieldParamsTooltipGetter()},{...c.r.IconShow,cellRenderer:m.N,cellRendererParams:{settings:()=>W}},{...c.r.TextWide,field:"Name",cellClass:"apps-list-primary-action highlight".split(" "),sort:"asc",onCellClicked:a=>{this.openApp(a.data)},cellRenderer:a=>{const i=a.data;return`\n            <div class="container">\n              ${i.Thumbnail?`<img class="image logo" src="${i.Thumbnail}?w=40&h=40&mode=crop"></img>`:'<div class="image logo"><span class="material-symbols-outlined">star</span></div>'}\n              <div class="text">${a.value}</div>\n            </div>\n            `}},{...c.r.TextWide,field:"Folder"},{...c.r.Character,field:"Version",width:78},{...c.r.Number,field:"Items"},{...c.r.Boolean,field:"HasCodeWarnings",headerName:"Code",filter:R.y,cellRenderer:m.N,cellRendererParams:{settings:a=>G}},{...c.r.ActionsPinnedRight3,cellRenderer:X,cellRendererParams:{onOpenLightspeed:a=>this.openLightSpeed(a),openLightspeedFeatureInfo:()=>this.openLightSpeedFeatInfo(),do:(a,i)=>{switch(a){case"deleteApp":this.deleteApp(i);break;case"flushCache":this.flushApp(i)}}}}]}}#s(){this.#e.getAll().subscribe(s=>{this.apps.set(s)})}static{this.\u0275fac=function(a){return new(a||o)(t.rXU(H.UG),t.rXU(B.o),t.rXU(C.bZ),t.rXU(t.c1b),t.rXU(t.gRc))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["app-apps-list"]],standalone:!0,features:[t.aNF],decls:25,vars:9,consts:[[1,"grid-wrapper","mat-tab-grid-wrapper"],["appDragAndDrop","",1,"ag-theme-material",3,"filesDropped","rowData","gridOptions","allowedFileTypes"],["align","end"],[1,"eav-eco-fab-speed-dial",3,"openChange","ngClass"],[3,"spin"],["mat-fab",""],[1,"spin180"],[1,"eav-eco-fab-speed-dial-actions"],["mat-mini-fab","","label","Find more apps",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["mat-mini-fab","","label","Create inherited app",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["mat-mini-fab","","label","Add from folder",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["matBadgeColor","accent","matBadgeSize","small","matBadge","\u{1f48e}","matBadgePosition","below after","aria-hidden","false",3,"matBadgeHidden"],["mat-mini-fab","","label","Import app",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["mat-mini-fab","","label","Create app",1,"eav-eco-fab-speed-dial-action-button",3,"click"]],template:function(a,i){1&a&&(t.j41(0,"div",0)(1,"ag-grid-angular",1),t.bIt("filesDropped",function(E){return i.importApp(E)}),t.k0s(),t.j41(2,"mat-dialog-actions",2)(3,"eco-fab-speed-dial",3),t.bIt("openChange",function(E){return i.openChange(E)}),t.j41(4,"eco-fab-speed-dial-trigger",4)(5,"button",5)(6,"mat-icon",6),t.EFF(7),t.k0s()()(),t.j41(8,"eco-fab-speed-dial-actions",7)(9,"button",8),t.bIt("click",function(){return i.browseCatalog()}),t.j41(10,"mat-icon"),t.EFF(11,"search"),t.k0s()(),t.j41(12,"button",9),t.bIt("click",function(){return i.createInheritedApp()}),t.j41(13,"mat-icon"),t.EFF(14,"holiday_village"),t.k0s()(),t.j41(15,"button",10),t.bIt("click",function(){return i.addFromFolder()}),t.j41(16,"mat-icon",11),t.EFF(17," add "),t.k0s()(),t.j41(18,"button",12),t.bIt("click",function(){return i.importApp()}),t.j41(19,"mat-icon"),t.EFF(20,"cloud_upload"),t.k0s()(),t.j41(21,"button",13),t.bIt("click",function(){return i.createApp()}),t.j41(22,"mat-icon"),t.EFF(23,"add"),t.k0s()()()()()(),t.nrm(24,"router-outlet")),2&a&&(t.R7$(),t.Y8G("rowData",i.apps())("gridOptions",i.gridOptions)("allowedFileTypes","zip"),t.R7$(2),t.Y8G("ngClass",t.eq3(7,Q,i.fabOpen())),t.R7$(),t.Y8G("spin",!0),t.R7$(3),t.JRh(i.fabOpen()?"close":"add"),t.R7$(9),t.Y8G("matBadgeHidden",i.isAddFromFolderEnabled()))},dependencies:[U.p,z.xs,C.E7,F.TE,b.YU,F.p1,v.Hl,v.$0,v.Sr,u.m_,u.An,F.yf,A.Y,A.k,y.n3,L.S],encapsulation:2})}}return o})()},8136:(I,h,e)=>{e.d(h,{T:()=>l});const l={AppSyncWithSiteFiles:"AppSyncWithSiteFiles",WysiwygPasteFormatted:"WysiwygPasteFormatted",PasteImageFromClipboard:"PasteImageFromClipboard",EditUiShowNotes:"EditUiShowNotes",EditUiShowMetadataFor:"EditUiShowMetadataFor",NoSponsoredByToSic:"NoSponsoredByToSic",EditUiTranslateWithGoogle:"EditUiTranslateWithGoogle",LightSpeed:"LightSpeedOutputCache",ContentSecurityPolicy:"ContentSecurityPolicy",PermissionsByLanguage:"PermissionsByLanguage",ContentTypeFieldsReuseDefinitions:"ContentTypeFieldsReuseDefinitions",AppExportAssetsAdvanced:"AppExportAssetsAdvanced",PickerUiCheckbox:"PickerUiCheckbox",PickerUiRadio:"PickerUiRadio",PickerSourceCsv:"PickerSourceCsv",PickerSourceAppAssets:"PickerSourceAppAssets",PickerFormulas:"PickerFormulas",PickerUiMoreInfo:"PickerUiMoreInfo"}},8471:(I,h,e)=>{e.d(h,{c:()=>F});var l=e(2159),f=e(1567),b=e(3037),t=e(271),A=e(5057),v=e(4979),C=e(4435),u=e(9148);const y={doOnDialogClosed:!0};let F=(()=>{class d extends v.V{constructor(n,r){super(),this.router=n,this.route=r,this.log=(0,C.T)({DialogRoutingService:d},y)}get snapshot(){return this.route.snapshot}get url(){return this.router.url}getParam(n){return this.route.snapshot.paramMap.get(n)}getParams(n){const r=this.route.snapshot.paramMap;return n.reduce((g,m)=>(g[m]=r.get(m),g),{})}getQueryParam(n){return this.route.snapshot.queryParamMap.get(n)}getQueryParams(n){const r=this.route.snapshot.queryParamMap;return n.reduce((g,m)=>(g[m]=r.get(m),g),{})}state(){return this.router.getCurrentNavigation().extras?.state}doOnDialogClosed(n){const r=this.log.fnIf("doOnDialogClosed");this.subscriptions.add(this.childDialogClosed$().subscribe(()=>n())),r.end()}navPath(n,r){return this.router.navigate([n],r)}navRelative(n,r){return this.router.navigate(n,{...r,relativeTo:this.route})}navParentFirstChild(n,r){return this.router.navigate(n,{...r,relativeTo:this.route.parent.firstChild})}childDialogClosed$(){return this.router.events.pipe((0,f.p)(n=>n instanceof l.wF),(0,b.Z)(!!this.route.snapshot.firstChild),(0,t.T)(()=>!!this.route.snapshot.firstChild),(0,A.J)(),(0,f.p)(([n,r])=>n&&!r))}static{this.\u0275fac=function(r){return new(r||d)(u.KVO(l.Ix),u.KVO(l.nX))}}static{this.\u0275prov=u.jDH({token:d,factory:d.\u0275fac})}}return d})()},4979:(I,h,e)=>{e.d(h,{V:()=>b});var l=e(7092),f=e(9148);let b=(()=>{class t{constructor(){this.subscriptions=new l.yU}ngOnDestroy(){this.destroy()}destroy(){this.subscriptions.unsubscribe()}static{this.\u0275fac=function(C){return new(C||t)}}static{this.\u0275prov=f.jDH({token:t,factory:t.\u0275fac})}}return t})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/18.02.00/dist/ng-edit/projects_eav-ui_src_app_apps-management_apps-list_apps-list_component_ts.3119e447ae9a2000.js.map