"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_manage-content-list_manage-content-list_component_ts"],{5026:(K,v,a)=>{a.r(v),a.d(v,{ManageContentListComponent:()=>A});var _=a(6571),f=a(2275),c=a(4175),p=a(7941),M=a(3840),I=a(2159),m=a(852),g=a(2938),b=a(3620),L=a(4699),P=a(1459),D=a(4601),h=a(3216),l=a(334),O=a(8471),u=a(7993),T=a(9669),t=a(9148),R=a(3347);const k=(o,r)=>r.Index+"+"+r.Id;function B(o,r){if(1&o){const n=t.RV6();t.j41(0,"span"),t.EFF(1),t.k0s(),t.j41(2,"button",13),t.bIt("click",function(){t.eBV(n);const i=t.XpG(3);return t.Njj(i.editHeader())}),t.j41(3,"mat-icon"),t.EFF(4,"edit"),t.k0s()()}if(2&o){const n=t.XpG(3);t.R7$(),t.JRh(n.header().Title)}}function F(o,r){1&o&&(t.EFF(0),t.nI1(1,"translate")),2&o&&t.SpI(" ",t.bMT(1,1,"ManageContentList.NoHeader")," ")}function j(o,r){if(1&o&&(t.j41(0,"p"),t.EFF(1),t.nI1(2,"translate"),t.k0s(),t.j41(3,"p"),t.DNE(4,B,5,1)(5,F,2,3),t.k0s()),2&o){const n=t.XpG(2);t.R7$(),t.SpI(" ",t.bMT(2,2,"ManageContentList.Description")," "),t.R7$(3),t.vxM(n.header().Type?4:5)}}function $(o,r){if(1&o&&(t.j41(0,"p",5),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&o){let n;const e=t.XpG(2);t.R7$(),t.SpI(" ",t.bMT(2,1,"ManageContentList."+(e.reordered()?"ListHasBeenReordered":(null==(n=e.items())?null:n.length)<25?"SortItems":"SortLotsOfItems"))," ")}}function U(o,r){if(1&o){const n=t.RV6();t.j41(0,"div",7)(1,"div",14)(2,"mat-icon",15),t.EFF(3,"drag_handle"),t.k0s(),t.j41(4,"span",16),t.EFF(5),t.k0s()(),t.j41(6,"div")(7,"button",17),t.bIt("click",function(){const i=t.eBV(n).$implicit,s=t.XpG(2);return t.Njj(s.addFromExisting(i.Index))}),t.j41(8,"mat-icon"),t.EFF(9,"playlist_add"),t.k0s()(),t.j41(10,"button",18),t.bIt("click",function(){const i=t.eBV(n).$implicit,s=t.XpG(2);return t.Njj(s.addBelow(i.Index))}),t.j41(11,"mat-icon"),t.EFF(12,"add"),t.k0s()(),t.j41(13,"button",19),t.bIt("click",function(){const i=t.eBV(n).$implicit,s=t.XpG(2);return t.Njj(s.remove(i))}),t.j41(14,"mat-icon"),t.EFF(15,"remove"),t.k0s()(),t.j41(16,"button",20),t.bIt("click",function(){const i=t.eBV(n).$implicit,s=t.XpG(2);return t.Njj(s.editItem(i.Id))}),t.j41(17,"mat-icon"),t.EFF(18,"edit"),t.k0s()()()()}if(2&o){const n=r.$implicit,e=t.XpG(2);t.R7$(4),t.FCK("tippy","",n.Title," (",n.Id,")"),t.R7$(),t.Lme(" ",n.Title," (",n.Id,") "),t.R7$(2),t.Y8G("disabled",0===n.Id),t.R7$(3),t.Y8G("disabled",0===n.Id||e.reordered()),t.R7$(3),t.Y8G("disabled",e.reordered()),t.R7$(3),t.Y8G("disabled",0===n.Id)}}function y(o,r){if(1&o){const n=t.RV6();t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.EFF(3),t.nI1(4,"translate"),t.k0s()(),t.j41(5,"div",3),t.nrm(6,"router-outlet"),t.j41(7,"div",4),t.DNE(8,j,6,4)(9,$,3,3,"p",5),t.j41(10,"div",6),t.bIt("cdkDropListDropped",function(i){t.eBV(n);const s=t.XpG();return t.Njj(s.drop(i))}),t.Z7z(11,U,19,9,"div",7,k),t.k0s()()(),t.j41(13,"mat-dialog-actions",8)(14,"button",9),t.bIt("click",function(){t.eBV(n);const i=t.XpG();return t.Njj(i.closeDialog())}),t.EFF(15),t.nI1(16,"translate"),t.k0s(),t.j41(17,"button",10),t.bIt("click",function(){t.eBV(n);const i=t.XpG();return t.Njj(i.saveList())}),t.EFF(18),t.nI1(19,"translate"),t.k0s(),t.j41(20,"button",11),t.bIt("click",function(){t.eBV(n);const i=t.XpG();return t.Njj(i.saveAndCloseList())}),t.j41(21,"mat-icon",12),t.EFF(22,"done"),t.k0s()()()()}if(2&o){const n=t.XpG();t.R7$(3),t.JRh(t.bMT(4,5,"ManageContentList.Title")),t.R7$(5),t.vxM(n.header()?8:-1),t.R7$(),t.vxM(n.items()?9:-1),t.R7$(2),t.Dyx(n.items()),t.R7$(4),t.JRh(t.bMT(16,7,"General.Buttons.Cancel")),t.R7$(3),t.JRh(t.bMT(19,9,"General.Buttons.Save"))}}let A=(()=>{class o{#n;#e;#a;constructor(n,e,i){this.dialog=n,this.snackBar=e,this.translate=i,this.hostClass="dialog-component",this.#n=(0,g.d)(O.c),this.#e=(0,g.d)(T.y),this.#a=(0,g.d)(L.L),this.items=(0,u.KX)("items",null),this.header=(0,u.KX)("header",null),this.#t=(0,b.C)(this.#n.getParams(["guid","part","index"]),s=>({id:null,guid:s.guid,part:s.part,index:parseInt(s.index,10)})),this.reordered=(0,u.KX)("reordered",!1)}#t;ngOnInit(){this.#i(),this.#o(),this.#s(),this.#n.doOnDialogClosed(()=>{this.#i(!0),this.#o()})}#s(){this.#a.getCurrent$().subscribe(n=>{this.translate.setDefaultLang(n.Context.Language.Primary.split("-")[0]),this.translate.use(n.Context.Language.Current.split("-")[0])})}closeDialog(){this.dialog.close()}saveList(){this.snackBar.open("Saving..."),this.#e.saveList(this.#t,this.items()).subscribe(()=>{this.snackBar.open("Saved",null,{duration:2e3}),this.#i(),this.#o()})}saveAndCloseList(){this.snackBar.open("Saving..."),this.#e.saveList(this.#t,this.items()).subscribe(()=>{this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()})}editHeader(){const n={items:[l.c.relationship(this.#t.guid,"listcontent",0,0===this.header().Id),l.c.relationship(this.#t.guid,"listpresentation",0,0===this.header().Id)]},e=(0,h.s)(n);this.#n.navRelative([`edit/${e}`])}editItem(n){const e={items:[l.c.editId(n)]},i=(0,h.s)(e);this.#n.navRelative([`edit/${i}`])}addFromExisting(n){this.#n.navRelative([`${this.#t.guid}/${this.#t.part}/${n+1}/replace`],{queryParams:{add:!0}})}addBelow(n){const e={items:[l.c.relationship(this.#t.guid,this.#t.part,n+1,!0)]},i=(0,h.s)(e);this.#n.navRelative([`edit/${i}`])}remove(n){confirm(this.translate.instant("ManageContentList.ConfirmRemove"))&&(this.snackBar.open("Removing..."),this.#e.removeItem(this.#t,n.Index).subscribe(()=>{this.snackBar.open("Removed",null,{duration:2e3}),this.#i()}))}drop(n){const e=[...this.items()];(0,_.HD)(e,n.previousIndex,n.currentIndex),this.items.set(e),this.reordered.set(!0)}#i(n=!1){this.#e.getList(this.#t).subscribe(e=>{if(this.reordered()){const i=this.items().map(d=>d.Id);if(this.items().length===e.length&&!e.some(d=>!i.includes(d.Id))&&n){const d=this.items().map(C=>C.Index);e.sort((C,G)=>{const E=d.indexOf(C.Index),x=d.indexOf(G.Index);return-1===E||-1===x?0:E-x})}else n&&this.snackBar.open("List was changed from somewhere else. Order of items is reset",null,{duration:5e3})}this.items.set(e),this.reordered.set(!1)})}#o(){this.#e.getHeader(this.#t).subscribe(n=>this.header.set(n))}static{this.\u0275fac=function(e){return new(e||o)(t.rXU(p.CP),t.rXU(R.UG),t.rXU(m.c$))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["app-manage-content-list"]],hostVars:1,hostBindings:function(e,i){2&e&&t.Mr5("className",i.hostClass)},standalone:!0,features:[t.aNF],decls:1,vars:1,consts:[[1,"eav-dialog","eav-no-scrollbar"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],["cdkScrollable","",1,"dialog-component-content","fancy-scrollbar-light"],[1,"eav-sort-title"],["cdkDropList","",1,"eav-dnd-list",3,"cdkDropListDropped"],["cdkDrag","",1,"eav-dnd-item"],["align","end"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"click"],["mat-raised-button","","color","accent","tippyTranslate","Form.Buttons.SaveAndClose",3,"click"],[1,"eav-raised-button-icon"],["mat-icon-button","","tippy","Edit header",3,"click"],[1,"eav-dnd-item__title"],["tippy","Drag to reorder the list",1,"eav-dnd-item__title-icon"],[1,"eav-dnd-item__title-text",3,"tippy"],["mat-icon-button","","tippyTranslate","Fields.Picker.AddExistingItem","appMousedownStopPropagation","",3,"click","disabled"],["mat-icon-button","","tippyTranslate","Fields.Picker.AddItemBelow","appMousedownStopPropagation","",3,"click","disabled"],["mat-icon-button","","tippyTranslate","Fields.Picker.Remove","appMousedownStopPropagation","",3,"click","disabled"],["mat-icon-button","","tippyTranslate","Fields.Picker.Edit","appMousedownStopPropagation","",3,"click","disabled"]],template:function(e,i){1&e&&t.DNE(0,y,23,11,"div",0),2&e&&t.vxM(i.header()&&i.items()?0:-1)},dependencies:[I.n3,f.uv,c.Hl,c.$z,c.iY,M.m_,M.An,_.O7,_.T1,p.E7,m.h,m.D9,p.hM,D.e,P.z],styles:[".eav-sort-title[_ngcontent-%COMP%]{padding-top:16px}.eav-dnd-list[_ngcontent-%COMP%]{margin:16px 0;border:1px solid #ccc;border-radius:4px;overflow:hidden}.eav-dnd-item[_ngcontent-%COMP%]{cursor:move;height:40px;border-bottom:1px solid #ccc;padding:0 8px;display:flex;align-items:center;justify-content:space-between;background:#fff;box-sizing:border-box;font-size:14px}.eav-dnd-item[_ngcontent-%COMP%]:last-child{border:none}.eav-dnd-item__title[_ngcontent-%COMP%]{display:flex;align-items:center;overflow:hidden;max-width:80%}.eav-dnd-item__title-icon[_ngcontent-%COMP%]{margin-right:8px;opacity:.4}.eav-dnd-item__title-text[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.dnd-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .dnd-item[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}"]})}}return o})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/18.02.00/dist/ng-edit/projects_eav-ui_src_app_manage-content-list_manage-content-list_component_ts.a8148dc76c58b902.js.map