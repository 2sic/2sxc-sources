"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_edit_dialog_header_language-switcher_language-switcher_component_ts"],{7913:(O,d,l)=>{l.r(d),l.d(d,{LanguageSwitcherComponent:()=>E});var t=l(9148),c=l(4175),g=l(4601),p=l(4435),f=l(8265),v=l(2093),m=l(9977);class w{constructor(n,e){this.ngZone=n,this.header=e,this.moveThreshold=2,this.stopClick=!1,this.eventListeners=[],this.ngZone.runOutsideAngular(()=>{const s=i=>{this.checkIfMouseMoved(i)};document.addEventListener("mouseup",s,{passive:!0}),this.eventListeners.push({element:document,type:"mouseup",listener:s})})}lngButtonDown(n){this.ngZone.runOutsideAngular(()=>{this.saveInitialPosition(n)})}lngButtonClick(n){this.ngZone.runOutsideAngular(()=>{this.doMove(n)})}stopClickIfMouseMoved(){return this.stopClick}destroy(){this.ngZone.runOutsideAngular(()=>{this.eventListeners.forEach(({element:n,type:e,listener:s})=>{n.removeEventListener(e,s)}),this.eventListeners=null})}saveInitialPosition(n){this.stopClick=!1,this.positionX=n.pageX,this.positionY=n.pageY}checkIfMouseMoved(n){this.positionX&&this.positionY?(this.stopClick=Math.abs(this.positionX+this.positionY-(n.pageX+n.pageY))>this.moveThreshold,this.positionX=null,this.positionY=null):this.stopClick=!1}doMove(n){if(this.stopClick)return;const e=n.target,s=e.getBoundingClientRect().left,i=e.getBoundingClientRect().width,o=this.header.getBoundingClientRect().left,h=this.header.getBoundingClientRect().width;this.header.scrollLeft+=s+i/2-(o+h/2)}}function u(r){return r.substring(0,r.includes("(")?r.indexOf("(")-1:100).toLocaleUpperCase()}class b{constructor(n,e,s){this.ngZone=n,this.header=e,this.areButtonsDisabled=s,this.eventListeners=[],this.ngZone.runOutsideAngular(()=>{const i=this.registerScroll.bind(this);this.header.addEventListener("pointerdown",i,{passive:!0}),this.headerDownListener={element:this.header,type:"pointerdown",listener:i}})}destroy(){this.ngZone.runOutsideAngular(()=>{this.headerDownListener.element.removeEventListener(this.headerDownListener.type,this.headerDownListener.listener),this.headerDownListener=null,this.eventListeners.forEach(({element:n,type:e,listener:s})=>{n.removeEventListener(e,s)}),this.eventListeners=null}),this.ngZone=null,this.header=null,this.areButtonsDisabled=null}registerScroll(n){if(this.areButtonsDisabled()||0!==n.button)return;window.getSelection().removeAllRanges(),this.oldScrollBehavior=getComputedStyle(this.header).getPropertyValue("scroll-behavior"),this.header.style.scrollBehavior="auto",this.positionX=n.pageX;const s=o=>{this.doScroll(o)},i=()=>{this.removeScroll()};document.addEventListener("pointermove",s,{passive:!0}),document.addEventListener("pointerup",i,{passive:!0}),document.addEventListener("pointerleave",i,{passive:!0}),this.eventListeners.push({element:document,type:"pointermove",listener:s},{element:document,type:"pointerup",listener:i},{element:document,type:"pointerleave",listener:i})}removeScroll(){this.header.style.scrollBehavior=this.oldScrollBehavior,this.eventListeners.forEach(({element:n,type:e,listener:s})=>{n.removeEventListener(e,s)}),this.eventListeners.splice(0,this.eventListeners.length)}doScroll(n){const e=n.pageX;e<this.positionX?this.header.scrollLeft+=this.positionX-e:e>this.positionX&&(this.header.scrollLeft+=-(e-this.positionX)),this.positionX=e}}class L{constructor(n,e,s,i){this.ngZone=n,this.header=e,this.leftShadow=s,this.rightShadow=i,this.hidden="hidden",this.eventListeners=[],this.ngZone.runOutsideAngular(()=>{this.calculateShadows();const o=()=>{this.calculateShadows()};this.header.addEventListener("scroll",o,{passive:!0}),window.addEventListener("resize",o,{passive:!0}),this.eventListeners.push({element:this.header,type:"scroll",listener:o},{element:window,type:"resize",listener:o})})}destroy(){this.ngZone.runOutsideAngular(()=>{this.eventListeners.forEach(({element:n,type:e,listener:s})=>{n.removeEventListener(e,s)}),this.eventListeners=null}),this.ngZone=null,this.header=null,this.leftShadow=null,this.rightShadow=null}calculateShadows(){this.maxScrollLeft=this.header.scrollWidth-this.header.clientWidth,0===this.maxScrollLeft?this.hideBoth():0===this.header.scrollLeft?this.hideLeft():this.header.scrollLeft===this.maxScrollLeft?this.hideRight():this.showBoth()}hideBoth(){this.leftShadow.classList.add(this.hidden),this.rightShadow.classList.add(this.hidden)}hideLeft(){this.leftShadow.classList.add(this.hidden),this.rightShadow.classList.remove(this.hidden)}hideRight(){this.leftShadow.classList.remove(this.hidden),this.rightShadow.classList.add(this.hidden)}showBoth(){this.leftShadow.classList.remove(this.hidden),this.rightShadow.classList.remove(this.hidden)}}var C=l(3347),y=l(852);const B=["scrollable"],_=["leftShadow"],M=["rightShadow"];function X(r,n){if(1&r){const e=t.RV6();t.j41(0,"button",8),t.bIt("mousedown",function(i){t.eBV(e);const o=t.XpG();return t.Njj(o.lngButtonMouseDown(i))})("click",function(i){const o=t.eBV(e).$implicit,h=t.XpG();return t.Njj(h.lngButtonClick(i,o))}),t.EFF(1),t.k0s()}if(2&r){const e=n.$implicit,s=t.XpG();t.Y8G("color",s.current()===e.NameId?"accent":"white")("tippy",e.Culture)("tippyDisabled",s.disabled),t.R7$(),t.SpI(" ",e.buttonText," ")}}let E=(()=>{class r{constructor(e,s,i,o,h,a){this.languageService=e,this.languageInstanceService=s,this.ngZone=i,this.formConfig=o,this.snackBar=h,this.translate=a,this.log=(0,p.T)({LanguageSwitcherComponent:r}),this.current=(0,t.EWP)(()=>this.formConfig.language().current),this.buttons=function S(r){const n=[],e={};return r.forEach(s=>{const i=u(s.Culture);e[i]?e[i]++:e[i]=1}),r.forEach(s=>{const i=u(s.Culture);n.push({...s,buttonText:e[i]>1?`${i} (${s.NameId})`:i})}),n}(this.languageService.getAll())}ngAfterViewInit(){this.showShadowsHelper=new L(this.ngZone,this.headerRef.nativeElement,this.leftShadowRef.nativeElement,this.rightShadowRef.nativeElement),this.mouseScrollHelper=new b(this.ngZone,this.headerRef.nativeElement,this.areButtonsDisabled.bind(this)),this.centerSelectedHelper=new w(this.ngZone,this.headerRef.nativeElement)}ngOnDestroy(){this.centerSelectedHelper?.destroy(),this.mouseScrollHelper?.destroy(),this.showShadowsHelper?.destroy()}lngButtonMouseDown(e){this.centerSelectedHelper.lngButtonDown(e)}lngButtonClick(e,s){const i=this.log.fn("lngButtonClick");if(this.disabled)return this.snackBar.open(this.translate.instant("Message.CantSwitchLanguage"),null,{duration:3e3,verticalPosition:"top"}),i.end("disabled");this.centerSelectedHelper.lngButtonClick(e),this.centerSelectedHelper.stopClickIfMouseMoved()||this.languageInstanceService.setCurrent(this.formConfig.config.formId,s.NameId)}areButtonsDisabled(){return this.disabled}static{this.\u0275fac=function(s){return new(s||r)(t.rXU(m.g),t.rXU(v.A),t.rXU(t.SKi),t.rXU(f.S),t.rXU(C.UG),t.rXU(y.c$))}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-language-switcher"]],viewQuery:function(s,i){if(1&s&&(t.GBs(B,5),t.GBs(_,5),t.GBs(M,5)),2&s){let o;t.mGM(o=t.lsd())&&(i.headerRef=o.first),t.mGM(o=t.lsd())&&(i.leftShadowRef=o.first),t.mGM(o=t.lsd())&&(i.rightShadowRef=o.first)}},inputs:{disabled:"disabled"},standalone:!0,features:[t.aNF],decls:9,vars:1,consts:[["leftShadow",""],["rightShadow",""],["scrollable",""],[1,"scrollable__overlay"],[1,"scrollable__overlay--left-shadow"],[1,"scrollable__overlay--right-shadow"],["tippyTranslate","Message.CantSwitchLanguage",1,"scrollable","lang-switch",3,"tippyDisabled"],["mat-flat-button","",1,"lang-switch__button",3,"color","tippy","tippyDisabled"],["mat-flat-button","",1,"lang-switch__button",3,"mousedown","click","color","tippy","tippyDisabled"]],template:function(s,i){1&s&&(t.j41(0,"div",3),t.nrm(1,"div",4,0)(3,"div",5,1),t.j41(5,"div",6,2),t.Z7z(7,X,2,4,"button",7,t.fX1),t.k0s()()),2&s&&(t.R7$(5),t.Y8G("tippyDisabled",!i.disabled),t.R7$(2),t.Dyx(i.buttons))},dependencies:[c.Hl,c.$z,g.e],styles:['.scrollable__overlay[_ngcontent-%COMP%]{position:relative;height:100%}.scrollable__overlay--left-shadow[_ngcontent-%COMP%], .scrollable__overlay--right-shadow[_ngcontent-%COMP%]{content:"";position:absolute;top:0;display:block;z-index:1;pointer-events:none;height:100%;width:80px;background-image:linear-gradient(90deg,#fff 8px,#fff0)}@media (max-width: 600px){.scrollable__overlay--left-shadow[_ngcontent-%COMP%], .scrollable__overlay--right-shadow[_ngcontent-%COMP%]{width:24px}}.scrollable__overlay--right-shadow[_ngcontent-%COMP%]{right:0;background-image:linear-gradient(270deg,#fff 8px,#fff0)}.scrollable[_ngcontent-%COMP%]{overflow:hidden;scroll-behavior:smooth;height:100%;touch-action:none}.lang-switch[_ngcontent-%COMP%]{display:flex}.lang-switch__button[_ngcontent-%COMP%]{height:100%;flex-shrink:0;border-radius:0;margin-left:0!important;color:#0006;border-bottom:none;font-size:12px;line-height:54px;padding:0 6px;background-color:#fff!important}.lang-switch__button.mat-accent[_ngcontent-%COMP%]{color:#002753;border-bottom:2px solid #002753;background-color:inherit}.hidden[_ngcontent-%COMP%]{visibility:hidden}']})}}return r})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/18.02.00/dist/ng-edit/projects_eav-ui_src_app_edit_dialog_header_language-switcher_language-switcher_component_ts.d136e34e0684dc56.js.map