"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_app-administration_data_data_component_ts"],{7391:(pt,T,o)=>{o.r(T),o.d(T,{DataComponent:()=>lt});var t=o(9148),v=o(4456),y=o(4175),l=o(5060),P=o(7941),F=o(4950),d=o(3840),D=o(5175),x=o(3347),I=o(2159),$=o(4600),B=o(4334),j=o(1567),_=o(271),N=o(3037),u=o(2938),G=o(6360),M=o(261),A=o(3454),S=o(2437),p=o(1828),O=o(3176),V=o(251),E=o(5858),g=o(52),X=o(4575),Y=o(693),R=o(3216),C=o(334),U=o(7037),w=o(8471),z=o(8021),H=o(9431),L=o(7693),W=o(4699),f=o(6256),m=o(1034),Z=o(9417);function J(i,c){if(1&i){const e=t.RV6();t.j41(0,"div",9),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.do("createUpdateMetaData"))}),t.j41(1,"mat-icon"),t.EFF(2,"edit"),t.k0s()()}}function Q(i,c){1&i&&(t.j41(0,"div",3)(1,"mat-icon"),t.EFF(2,"edit"),t.k0s()())}function K(i,c){if(1&i){const e=t.RV6();t.j41(0,"div",10),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.do("openMetadata"))}),t.j41(1,"mat-icon",11),t.EFF(2," local_offer "),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("matBadge",e.contentType.Metadata.length)("matBadgeHidden",!e.contentType.Metadata.length)}}function q(i,c){if(1&i&&(t.j41(0,"div",3)(1,"mat-icon",12),t.EFF(2," local_offer "),t.k0s()()),2&i){const e=t.XpG();t.R7$(),t.Y8G("matBadge",e.contentType.Metadata.length)("matBadgeHidden",!e.contentType.Metadata.length)}}function tt(i,c){if(1&i){const e=t.RV6();t.j41(0,"div",13),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.do("openPermissions"))}),t.j41(1,"mat-icon",11),t.EFF(2," person"),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("matBadge",e.contentType.Permissions.Count)("matBadgeHidden",!e.contentType.Permissions.Count)}}function et(i,c){if(1&i&&(t.j41(0,"div",3)(1,"mat-icon",12),t.EFF(2," person"),t.k0s()()),2&i){const e=t.XpG();t.R7$(),t.Y8G("matBadge",e.contentType.Permissions.Count)("matBadgeHidden",!e.contentType.Permissions.Count)}}function nt(i,c){if(1&i){const e=t.RV6();t.j41(0,"button",14),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.do("editContentType"))}),t.j41(1,"mat-icon"),t.EFF(2,"settings"),t.k0s(),t.j41(3,"span"),t.EFF(4,"Rename"),t.k0s()(),t.j41(5,"button",15),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.do("openRestApi"))}),t.nrm(6,"mat-icon",16),t.j41(7,"span"),t.EFF(8,"REST API"),t.k0s()(),t.j41(9,"button",15),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.do("typeExport"))}),t.j41(10,"mat-icon"),t.EFF(11,"cloud_download"),t.k0s(),t.j41(12,"span"),t.EFF(13,"Export content type"),t.k0s()(),t.j41(14,"button",15),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.do("dataExport"))}),t.j41(15,"mat-icon"),t.EFF(16,"cloud_download"),t.k0s(),t.j41(17,"span"),t.EFF(18,"Export data"),t.k0s()(),t.j41(19,"button",15),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.do("dataImport"))}),t.j41(20,"mat-icon"),t.EFF(21,"cloud_upload"),t.k0s(),t.j41(22,"span"),t.EFF(23,"Import data"),t.k0s()(),t.j41(24,"button",14),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.do("deleteContentType"))}),t.j41(25,"mat-icon"),t.EFF(26,"delete"),t.k0s(),t.j41(27,"span"),t.EFF(28,"Delete"),t.k0s()()}if(2&i){const e=t.XpG();t.Y8G("disabled",e.contentType.EditInfo.DisableRename),t.R7$(24),t.Y8G("disabled",e.contentType.EditInfo.DisableDelete)}}let at=(()=>{class i{agInit(e){this.params=e,this.contentType=this.params.data;const n=this.params.enablePermissionsGetter();this.enablePermissions=n&&(0,Z.L)().test(this.contentType.StaticName)}refresh(e){return!0}do(e){this.params.do(e,this.contentType)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-data-actions"]],standalone:!0,features:[t.aNF],decls:13,vars:7,consts:[["menu","matMenu"],[1,"actions-component"],["matRipple","","tippy","Description and more",1,"eav-grid-action-button","highlight"],[1,"eav-grid-action-button","disabled"],["matRipple","","tippy","Metadata",1,"eav-grid-action-button","highlight"],["matRipple","","tippy","Permissions",1,"eav-grid-action-button","highlight"],["matRipple","","tippy","More",1,"eav-grid-action-button","highlight",3,"matMenuTriggerFor"],[1,"grid-more-menu"],["matMenuContent",""],["matRipple","","tippy","Description and more",1,"eav-grid-action-button","highlight",3,"click"],["matRipple","","tippy","Metadata",1,"eav-grid-action-button","highlight",3,"click"],["matBadgePosition","below after","matBadgeColor","accent","matBadgeSize","small","aria-hidden","false",3,"matBadge","matBadgeHidden"],["matBadgePosition","below after","matBadgeColor","accent","matBadgeSize","small","matBadgeDisabled","true","aria-hidden","false",3,"matBadge","matBadgeHidden"],["matRipple","","tippy","Permissions",1,"eav-grid-action-button","highlight",3,"click"],["mat-menu-item","",3,"click","disabled"],["mat-menu-item","",3,"click"],["svgIcon","code-curly"]],template:function(n,a){if(1&n&&(t.j41(0,"div",1),t.DNE(1,J,3,0,"div",2)(2,Q,3,0,"div",3)(3,K,3,2,"div",4)(4,q,3,2,"div",3)(5,tt,3,2,"div",5)(6,et,3,2,"div",3),t.j41(7,"div",6)(8,"mat-icon"),t.EFF(9,"more_horiz"),t.k0s()()(),t.j41(10,"mat-menu",7,0),t.DNE(12,nt,29,2,"ng-template",8),t.k0s()),2&n){const s=t.sdS(11);t.R7$(),t.vxM(!a.contentType.EditInfo.DisableEdit||a.contentType.Properties?1:-1),t.R7$(),t.vxM(a.contentType.EditInfo.DisableEdit&&!a.contentType.Properties?2:-1),t.R7$(),t.vxM(a.contentType.EditInfo.DisableMetadata?-1:3),t.R7$(),t.vxM(a.contentType.EditInfo.DisableMetadata?4:-1),t.R7$(),t.vxM(!a.contentType.EditInfo.DisableEdit&&a.enablePermissions?5:-1),t.R7$(),t.vxM(a.contentType.EditInfo.DisableEdit||!a.enablePermissions?6:-1),t.R7$(),t.Y8G("matMenuTriggerFor",s)}},dependencies:[l.pZ,l.r6,d.m_,d.An,f.Y,f.k,m.Cn,m.kk,m.fb,m.z8,m.Cp],encapsulation:2})}}return i})();var k=o(4601);let it=(()=>{class i{agInit(e){this.params=e,this.contentType=e.data,this.value=e.value,this.tooltip=this.contentType.EditInfo.ReadOnly?`${this.contentType.EditInfo.ReadOnlyMessage?`${this.contentType.EditInfo.ReadOnlyMessage}\n\n`:""}This ContentType shares the definition of #${this.contentType.SharedDefId} so you can't edit it here. Read 2sxc.org/help?tag=shared-types`:"Edit fields",this.icon=this.contentType.EditInfo.ReadOnly?"share":"dns"}refresh(e){return!0}editFields(){this.params.onEditFields(this.contentType)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-data-fields"]],standalone:!0,features:[t.aNF],decls:4,vars:4,consts:[[1,"actions-component"],["matRipple","",1,"eav-grid-action-button","highlight",3,"click","tippy"],["matBadgePosition","below after","matBadgeColor","accent","matBadgeSize","small","aria-hidden","false",3,"matBadge","matBadgeHidden"]],template:function(n,a){1&n&&(t.j41(0,"div",0)(1,"div",1),t.bIt("click",function(){return a.editFields()}),t.j41(2,"mat-icon",2),t.EFF(3),t.k0s()()()),2&n&&(t.R7$(),t.Y8G("tippy",a.tooltip),t.R7$(),t.Y8G("matBadge",a.value)("matBadgeHidden",!a.value),t.R7$(),t.SpI(" ",a.icon," "))},dependencies:[l.pZ,l.r6,d.m_,d.An,f.Y,f.k,k.e],encapsulation:2})}}return i})(),ot=(()=>{class i{agInit(e){this.params=e,this.contentType=e.data,this.value=e.value}refresh(e){return!0}showItems(){this.params.onShowItems(this.contentType)}addItem(){this.params.onAddItem(this.contentType)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-data-items"]],standalone:!0,features:[t.aNF],decls:7,vars:3,consts:[[1,"actions-component"],["matRipple","",1,"eav-grid-action-button","highlight",3,"click","tippy"],[1,"text-icon"],["matRipple","","tippy","Add item",1,"eav-grid-action-button","highlight",3,"click"]],template:function(n,a){1&n&&(t.j41(0,"div",0)(1,"div",1),t.bIt("click",function(){return a.showItems()}),t.j41(2,"div",2),t.EFF(3),t.k0s()(),t.j41(4,"div",3),t.bIt("click",function(){return a.addItem()}),t.j41(5,"mat-icon"),t.EFF(6,"add"),t.k0s()()()),2&n&&(t.R7$(),t.Mz_("tippy","",a.value," items"),t.R7$(2),t.JRh(a.value))},dependencies:[l.pZ,l.r6,d.m_,d.An,k.e],styles:[".text-icon[_ngcontent-%COMP%]{width:24px;height:24px;font-size:12px;line-height:22px;text-align:center;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;border:1px solid rgba(29,39,61,.44);border-radius:12px;box-sizing:border-box;background-color:#002753;color:#fff;-webkit-user-select:none;user-select:none}.text-icon[_ngcontent-%COMP%]{min-width:24px;width:initial}"]})}}return i})();var st=o(9841);function rt(i,c){if(1&i&&(t.j41(0,"mat-option",6),t.EFF(1),t.k0s()),2&i){const e=c.$implicit;t.Y8G("value",e.name),t.R7$(),t.SpI(" ","Scope: "+e.label," ")}}function ct(i,c){if(1&i){const e=t.RV6();t.j41(0,"button",11),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.createGhost())}),t.j41(1,"mat-icon",8),t.EFF(2,"share"),t.k0s(),t.j41(3,"span"),t.EFF(4,"Ghost"),t.k0s()()}}let lt=(()=>{class i extends O.${#e;#n;#i;#o;#t;constructor(){super(),this.isDebug=(0,t.WQX)(H.B).isDebug,this.#e=(0,t.WQX)(x.UG),this.#n=(0,u.d)(L.g),this.#i=(0,u.d)(G.D),this.#o=(0,u.d)(W.L),this.#t=(0,u.d)(w.c),this.contentTypes=(0,t.vPA)(void 0),this.scope=(0,t.vPA)(void 0),this.scopeOptions=(0,t.vPA)([]),this.gridOptions=this.#d(),this.dropdownInsertValue=E.O}ngOnInit(){this.#c(),this.#l(),this.#t.doOnDialogClosed(()=>this.#a()),this.#o.getCurrent$().subscribe(e=>{this.enablePermissions=e.Context.Enable.AppPermissions})}filesDropped(e){const n=e[0];switch(n.name.substring(n.name.lastIndexOf(".")+1).toLocaleLowerCase()){case"xml":(0,$.H)((0,Y.d)(e[0])).pipe((0,B.s)(1)).subscribe(s=>{const r=s.split('<Entity Type="')[1]?.split('"')[0],b=this.contentTypes().find(h=>h.Name===r);null!=b?this.#r(b,e):this.#e.open(`Cannot find Content Type named '${r}'. Please open Content Type Import dialog manually.`,null,{duration:5e3})});break;case"json":this.importType(e)}}importType(e){this.#t.navParentFirstChild(["import"],{state:{files:e}})}#s(e){this.#t.navParentFirstChild([`items/${e.StaticName}`])}editContentType(e){if(e){if(e.EditInfo.ReadOnly)return;this.#t.navParentFirstChild([`${e.StaticName}/edit`])}else this.#t.navParentFirstChild(["add"])}#a(){this.#n.retrieveContentTypes(this.scope()).subscribe(e=>{for(const n of e)n._compareLabel=n.Label.replace(new RegExp("\\p{Emoji}","gu"),"\u017e");this.contentTypes.set(e),this.scope()!==g.YX.scopes.default.value&&this.#e.open("Warning! You are in a special scope. Changing things here could easily break functionality",null,{duration:2e3})})}#c(){this.#n.getScopesV2().subscribe(e=>{const n=this.scopeOptions().filter(s=>null==e.find(r=>r.name===s.name)),a=e.map(s=>{let r=s.typesInherited?s.typesInherited==s.typesTotal?s.typesInherited+" sys types":`${s.typesTotal} types / ${s.typesInherited} system`:`${s.typesTotal} types`;return{...s,label:s.name+` - ${r}`}});this.scopeOptions.set([...a,...n])})}createGhost(){const e=window.prompt("To create a ghost content-type enter source static name / id - this is a very advanced operation - read more about it on 2sxc.org/help?tag=ghost");e&&(this.#e.open("Saving..."),this.#n.createGhost(e).subscribe(n=>{this.#e.open("Saved",null,{duration:2e3}),this.#a()}))}changeScope(e){e===E.O&&(e=prompt("This is an advanced feature to show content-types of another scope. Don't use this if you don't know what you're doing, as content-types of other scopes are usually hidden for a good reason.")||g.YX.scopes.default.value),this.#t.navRelative(["..",e])}#l(){this.subscriptions.add(this.#t.router.events.pipe((0,j.p)(e=>e instanceof I.wF),(0,_.T)(()=>this.#t.getParam("scope")),(0,N.Z)(this.#t.getParam("scope")),(0,j.p)(e=>!!e),(0,z.J)(e=>e)).subscribe(e=>{if(this.scope.set(e),!this.scopeOptions().map(n=>n.name).includes(e)){const n={name:e,label:e,typesTotal:0,typesInherited:0,typesOfApp:0};this.scopeOptions.set([...this.scopeOptions(),n])}this.#a()}))}#d(){return{...V.C,columnDefs:[{...p.r.IdWithDefaultRenderer,cellRendererParams:p.r.idFieldParamsTooltipGetter("StaticName")},{...p.r.TextWidePrimary,headerName:"ContentType",field:"Label",sort:"asc",onCellClicked:n=>{this.#s(n.data)},comparator:(n,a,s,r,b)=>s.data._compareLabel.localeCompare(r.data._compareLabel)},{...p.r.Items,field:"Items",cellRenderer:ot,cellRendererParams:{onShowItems:n=>this.#s(n),onAddItem:n=>this.#p(n)}},{...p.r.Fields,field:"Fields",cellRenderer:it,cellRendererParams:{onEditFields:n=>this.#m(n)}},{...p.r.TextWideMin100,field:"Name",cellClass:n=>(n.data.EditInfo.DisableEdit?"no-outline":"primary-action highlight").split(" "),valueGetter:n=>n.data?.Name,onCellClicked:n=>{this.editContentType(n.data)}},{...p.r.TextWideFlex3,field:"Description",valueGetter:n=>n.data?.Properties?.Description},{...p.r.ActionsPinnedRight4,cellRenderer:at,cellRendererParams:{enablePermissionsGetter:()=>this.enablePermissions,do:(a,s)=>{switch(a){case"createUpdateMetaData":this.#h(s);break;case"openPermissions":this.#u(s);break;case"editContentType":this.editContentType(s);break;case"openMetadata":this.#g(s);break;case"openRestApi":this.#f(s);break;case"typeExport":this.#v(s);break;case"dataExport":this.#y(s);break;case"dataImport":this.#r(s);break;case"deleteContentType":this.#C(s)}}}}]}}#p(e){const n={items:[C.c.newFromType(e.StaticName)]},a=(0,R.s)(n);this.#t.navParentFirstChild([`edit/${a}`])}#m(e){this.#t.navParentFirstChild([`fields/${e.StaticName}`])}#h(e){const n={items:[e.Properties?C.c.editId(e.Properties.Id):{...C.c.newMetadata(e.StaticName,g.YX.contentTypes.contentType,g.YX.metadata.contentType),Prefill:{Label:e.Name,Description:e.Description}}]},a=(0,R.s)(n);this.#t.navParentFirstChild([`edit/${a}`])}#u(e){this.#t.navParentFirstChild([S.k.getUrlContentType(e.StaticName)])}#g(e){const n=A.H.getUrlContentType(e.StaticName,`Metadata for Content Type: ${e.Name} (${e.Id})`);this.#t.navParentFirstChild([n])}#f(e){this.#t.navParentFirstChild([M.N.getUrlData(e)])}#v(e){this.#i.exportJson(e.StaticName)}#y(e){this.#t.navParentFirstChild([`export/${e.StaticName}`])}#r(e,n){this.#t.navParentFirstChild([`${e.StaticName}/import`],{state:{files:n}})}#C(e){confirm(`Are you sure you want to delete '${e.Name}' (${e.Id})?`)&&(this.#e.open("Deleting..."),this.#n.delete(e).subscribe(n=>{this.#e.open("Deleted",null,{duration:2e3}),this.#a()}))}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-data"]],standalone:!0,features:[t.Vt3,t.aNF],decls:20,vars:6,consts:[[1,"grid-wrapper","mat-tab-grid-wrapper"],["appDragAndDrop","",1,"ag-theme-material",3,"filesDropped","rowData","gridOptions","allowedFileTypes"],[1,"eav-dialog-actions"],[1,"eav-dialog-actions-div"],["color","accent",1,"eav-mat-form-field","eav-scope-dropdown"],["name","Scope",3,"ngModelChange","ngModel"],[3,"value"],["mat-button","","tippy","Import content type",1,"eav-button__with-icon",3,"click"],[1,"eav-icon"],["mat-button","","color","accent","tippy","Create a ghost content type",1,"eav-button__with-icon"],["mat-fab","","mat-elevation-z24","","tippy","Create a new content type",1,"grid-fab",3,"click"],["mat-button","","color","accent","tippy","Create a ghost content type",1,"eav-button__with-icon",3,"click"]],template:function(n,a){1&n&&(t.j41(0,"div",0)(1,"ag-grid-angular",1),t.bIt("filesDropped",function(r){return a.filesDropped(r)}),t.k0s(),t.j41(2,"mat-dialog-actions",2)(3,"div",3)(4,"mat-form-field",4)(5,"mat-select",5),t.bIt("ngModelChange",function(r){return a.changeScope(r)}),t.Z7z(6,rt,2,2,"mat-option",6,t.fX1),t.j41(8,"mat-option",6),t.EFF(9,"Scope: Other..."),t.k0s()()(),t.j41(10,"button",7),t.bIt("click",function(){return a.importType()}),t.j41(11,"mat-icon",8),t.EFF(12,"cloud_upload"),t.k0s(),t.j41(13,"span"),t.EFF(14,"Content Type"),t.k0s()(),t.DNE(15,ct,5,0,"button",9),t.k0s(),t.j41(16,"button",10),t.bIt("click",function(){return a.editContentType(null)}),t.j41(17,"mat-icon"),t.EFF(18,"add"),t.k0s()()()(),t.nrm(19,"router-outlet")),2&n&&(t.R7$(),t.Y8G("rowData",a.contentTypes())("gridOptions",a.gridOptions)("allowedFileTypes","xml,json"),t.R7$(4),t.Y8G("ngModel",a.scope()),t.R7$(),t.Dyx(a.scopeOptions()),t.R7$(2),t.Y8G("value",a.dropdownInsertValue),t.R7$(7),t.vxM(a.isDebug()?15:-1))},dependencies:[P.E7,F.RG,F.rl,D.Ve,D.VO,l.wT,v.YN,v.BC,v.vS,l.Sy,y.Hl,y.$z,y.Sr,d.m_,d.An,I.n3,U.p,st.xs,X.S],styles:[".eav-scope-dropdown[_ngcontent-%COMP%]{margin-top:-14px;width:350px}"]})}}return i})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/18.02.00/dist/ng-edit/projects_eav-ui_src_app_app-administration_data_data_component_ts.63d1418905013c6c.js.map