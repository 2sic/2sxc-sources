(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_ng-dialogs_src_app_manage-content-list_manage-content-list_component_ts"],{9542:function(t,e,n){"use strict";n.r(e),n.d(e,{ManageContentListComponent:function(){return O}});var i=n(4762),o=n(9244),r=n(1282),s=n(8512),a=n(1305),c=n(7570),d=n(9996),p=n(3835),u=n(6238),l=n(2855),g=n(2420),h=n(1785),f=n(2935),m=n(7106),v=n(3589),x=n(1116),b=n(4369),_=n(7512),Z=n(7307),y=n(2636);function k(t,e){if(1&t){var n=h.EpF();h.ynx(0),h.TgZ(1,"span"),h._uU(2),h.qZA(),h.TgZ(3,"button",12),h.NdJ("click",function(){return h.CHM(n),h.oxw(3).editHeader()}),h.TgZ(4,"mat-icon"),h._uU(5,"edit"),h.qZA(),h.qZA(),h.BQk()}if(2&t){var i=h.oxw(2).ngIf;h.xp6(2),h.Oqu(i.header.Title)}}function I(t,e){1&t&&(h.ynx(0),h._uU(1,"(this list has no header)"),h.BQk())}function C(t,e){if(1&t&&(h.ynx(0),h.TgZ(1,"p",11),h._uU(2," You can manage the list header here (if it is defined): "),h.qZA(),h.TgZ(3,"p",11),h.YNc(4,k,6,1,"ng-container",7),h.YNc(5,I,2,0,"ng-container",7),h.qZA(),h.BQk()),2&t){var n=h.oxw().ngIf;h.xp6(4),h.Q6J("ngIf",n.header.Type),h.xp6(1),h.Q6J("ngIf",!n.header.Type)}}function T(t,e){if(1&t){var n=h.EpF();h.TgZ(0,"div"),h.TgZ(1,"button",17),h.NdJ("click",function(){h.CHM(n);var t=h.oxw().$implicit;return h.oxw(2).editItem(t.Id)}),h.TgZ(2,"mat-icon"),h._uU(3,"edit"),h.qZA(),h.qZA(),h.qZA()}}function w(t,e){if(1&t&&(h.TgZ(0,"div",13),h.TgZ(1,"div",14),h.TgZ(2,"mat-icon",15),h._uU(3,"drag_handle"),h.qZA(),h.TgZ(4,"span",16),h._uU(5),h.qZA(),h.qZA(),h.YNc(6,T,4,0,"div",7),h.qZA()),2&t){var n=e.$implicit;h.xp6(4),h.hYB("tippy","",n.Title," (",n.Id,")"),h.xp6(1),h.AsE(" ",n.Title," (",n.Id,") "),h.xp6(1),h.Q6J("ngIf",0!==n.Id)}}function A(t,e){if(1&t){var n=h.EpF();h.TgZ(0,"div",6),h.YNc(1,C,6,2,"ng-container",7),h.TgZ(2,"p",8),h._uU(3,"Sort the items by dragging as you need, then save:"),h.qZA(),h.TgZ(4,"div",9),h.NdJ("cdkDropListDropped",function(t){return h.CHM(n),h.oxw().drop(t)}),h.YNc(5,w,7,5,"div",10),h.qZA(),h.qZA()}if(2&t){var i=e.ngIf,o=h.oxw();h.xp6(1),h.Q6J("ngIf",i.header),h.xp6(4),h.Q6J("ngForOf",i.items)("ngForTrackBy",o.trackByFn)}}var O=function(){function t(t,e,n,o,r){this.dialogRef=t,this.contentGroupService=e,this.route=n,this.router=o,this.snackBar=r,this.hostClass="dialog-component",this.items$=new s.X(null),this.header$=new s.X(null),this.templateVars$=(0,a.aj)([this.items$,this.header$]).pipe((0,d.U)(function(t){var e=(0,i.CR)(t,2);return{items:e[0],header:e[1]}})),this.contentGroup={id:null,guid:this.route.snapshot.paramMap.get("guid"),part:this.route.snapshot.paramMap.get("part"),index:parseInt(this.route.snapshot.paramMap.get("index"),10)},this.reordered=!1,this.subscription=new c.w}return t.prototype.ngOnInit=function(){this.fetchList(),this.fetchHeader(),this.refreshOnChildClosed()},t.prototype.ngOnDestroy=function(){this.items$.complete(),this.header$.complete(),this.subscription.unsubscribe()},t.prototype.closeDialog=function(){this.dialogRef.close()},t.prototype.saveList=function(){var t=this;this.snackBar.open("Saving..."),this.contentGroupService.saveList(this.contentGroup,this.items$.value).subscribe(function(e){t.snackBar.open("Saved"),t.closeDialog()})},t.prototype.editHeader=function(){var t=(0,g.f)({items:[{Group:{Guid:this.contentGroup.guid,Index:0,Part:"listcontent",Add:0===this.header$.value.Id}},{Group:{Guid:this.contentGroup.guid,Index:0,Part:"listpresentation",Add:0===this.header$.value.Id}}]});this.router.navigate(["edit/"+t],{relativeTo:this.route})},t.prototype.editItem=function(t){var e=(0,g.f)({items:[{EntityId:t}]});this.router.navigate(["edit/"+e],{relativeTo:this.route})},t.prototype.drop=function(t){var e=(0,i.ev)([],(0,i.CR)(this.items$.value));(0,o.bA)(e,t.previousIndex,t.currentIndex),this.items$.next(e),this.reordered=!0},t.prototype.trackByFn=function(t,e){return e.Index+"+"+e.Id},t.prototype.fetchList=function(){var t=this;this.contentGroupService.getList(this.contentGroup).subscribe(function(e){if(t.reordered){var n=t.items$.value.map(function(t){return t.Id});if(t.items$.value.length!==e.length||e.some(function(t){return!n.includes(t.Id)}))t.snackBar.open("List was changed from somewhere else. Order of items is reset",null,{duration:5e3});else{var i=t.items$.value.map(function(t){return t.Index});e.sort(function(t,e){var n=i.indexOf(t.Index),o=i.indexOf(e.Index);return-1===n||-1===o?0:n-o})}}t.items$.next(e)})},t.prototype.fetchHeader=function(){var t=this;this.contentGroupService.getHeader(this.contentGroup).subscribe(function(e){t.header$.next(e)})},t.prototype.refreshOnChildClosed=function(){var t=this;this.subscription.add(this.router.events.pipe((0,p.h)(function(t){return t instanceof r.m2}),(0,u.O)(!!this.route.snapshot.firstChild),(0,d.U)(function(){return!!t.route.snapshot.firstChild}),(0,l.G)(),(0,p.h)(function(t){var e=(0,i.CR)(t,2);return e[0]&&!e[1]})).subscribe(function(){t.fetchList(),t.fetchHeader()}))},t.\u0275fac=function(e){return new(e||t)(h.Y36(f.so),h.Y36(m.e),h.Y36(r.gz),h.Y36(r.F0),h.Y36(v.ux))},t.\u0275cmp=h.Xpm({type:t,selectors:[["app-manage-content-list"]],hostVars:1,hostBindings:function(t,e){2&t&&h.Ikx("className",e.hostClass)},decls:11,vars:3,consts:[["mat-dialog-title",""],[1,"dialog-title-box"],["class","dialog-component-content fancy-scrollbar-light",4,"ngIf"],[1,"dialog-component-actions"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"click"],[1,"dialog-component-content","fancy-scrollbar-light"],[4,"ngIf"],[1,"dialog-description","sort-title"],["cdkDropList","",1,"dnd-list",3,"cdkDropListDropped"],["class","dnd-item","cdkDrag","",4,"ngFor","ngForOf","ngForTrackBy"],[1,"dialog-description"],["mat-icon-button","","tippy","Edit header",3,"click"],["cdkDrag","",1,"dnd-item"],[1,"dnd-item__title"],["tippy","Drag to reorder the list",1,"dnd-item__title-icon"],[1,"dnd-item__title-text",3,"tippy"],["mat-icon-button","","tippy","Edit item","appMousedownStopPropagation","",3,"click"]],template:function(t,e){1&t&&(h.TgZ(0,"div",0),h.TgZ(1,"div",1),h._uU(2,"Manage content-item lists"),h.qZA(),h.qZA(),h._UZ(3,"router-outlet"),h.YNc(4,A,6,3,"div",2),h.ALo(5,"async"),h.TgZ(6,"div",3),h.TgZ(7,"button",4),h.NdJ("click",function(){return e.closeDialog()}),h._uU(8,"Cancel"),h.qZA(),h.TgZ(9,"button",5),h.NdJ("click",function(){return e.saveList()}),h._uU(10,"Save"),h.qZA(),h.qZA()),2&t&&(h.xp6(4),h.Q6J("ngIf",h.lcZ(5,1,e.templateVars$)))},directives:[f.uh,r.lC,x.O5,b.lW,o.Wj,x.sg,_.$,Z.Hw,o.Zt,y.d],pipes:[x.Ov],styles:[".sort-title[_ngcontent-%COMP%]{padding-top:16px}.dnd-list[_ngcontent-%COMP%]{margin:16px 0;border:1px solid #ccc;border-radius:4px;overflow:hidden}.dnd-item[_ngcontent-%COMP%]{cursor:move;height:40px;border-bottom:1px solid #ccc;padding:0 8px;display:flex;align-items:center;justify-content:space-between;background:#fff;box-sizing:border-box;font-size:14px}.dnd-item[_ngcontent-%COMP%]:last-child{border:none}.dnd-item__title[_ngcontent-%COMP%]{display:flex;align-items:center;overflow:hidden}.dnd-item__title-icon[_ngcontent-%COMP%]{margin-right:8px;opacity:.4}.dnd-item__title-text[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%], .dnd-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .dnd-item[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}"]}),t}()}}]);
//# sourceMappingURL=https://sources.2sxc.org/12.06.00/ng-edit/projects_ng-dialogs_src_app_manage-content-list_manage-content-list_component_ts.4f1cc371733a79b9c3b1.js.map