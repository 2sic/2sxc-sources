(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{TGEy:function(e,t,n){"use strict";n.r(t),n.d(t,"ContentImportComponent",function(){return _});var i=n("mrSG"),o=n("0IaG"),a=n("2Vo4"),c=n("itXk"),l=n("cp0P"),s=n("lJxs"),r=n("fXoL"),u=n("tyNb"),b=n("77pt"),p=n("r3uf"),f=n("uwFg"),d=n("ofXK"),g=n("pXf0"),m=n("3Pt+"),h=n("bTqV"),v=n("Qu3c"),V=n("QibW");function D(e,t){if(1&e){var n=r.Wb();r.Vb(0,"form",11,12),r.Vb(2,"div",13),r.Vb(3,"div"),r.Vb(4,"button",14),r.dc("click",function(){return r.Ac(n),r.yc(8).click()}),r.Vb(5,"span"),r.Mc(6),r.Ub(),r.Ub(),r.Vb(7,"input",15,16),r.dc("change",function(e){return r.Ac(n),r.hc(3).fileChange(e)}),r.Ub(),r.Ub(),r.Vb(9,"div"),r.Vb(10,"p",17),r.Mc(11,"References to pages / files"),r.Ub(),r.Vb(12,"mat-radio-group",18),r.dc("ngModelChange",function(e){return r.Ac(n),r.hc(3).formValues.resourcesReferences=e}),r.Vb(13,"mat-radio-button",19),r.Mc(14," Import links as written in the file (for example /Portals/...) "),r.Ub(),r.Vb(15,"mat-radio-button",20),r.Mc(16," Try to resolve paths to references "),r.Ub(),r.Ub(),r.Ub(),r.Vb(17,"div"),r.Vb(18,"p",17),r.Mc(19,"Clear all other entities"),r.Ub(),r.Vb(20,"mat-radio-group",21),r.dc("ngModelChange",function(e){return r.Ac(n),r.hc(3).formValues.clearEntities=e}),r.Vb(21,"mat-radio-button",22),r.Mc(22," Keep all entities not found in import "),r.Ub(),r.Vb(23,"mat-radio-button",23),r.Mc(24," Remove all entities not found in import "),r.Ub(),r.Ub(),r.Ub(),r.Vb(25,"p",24),r.Mc(26,"Remember to backup your DNN first!"),r.Ub(),r.Ub(),r.Vb(27,"div",25),r.Vb(28,"button",26),r.dc("click",function(){return r.Ac(n),r.hc(3).closeDialog()}),r.Mc(29,"Cancel"),r.Ub(),r.Vb(30,"button",27),r.dc("click",function(){return r.Ac(n),r.hc(3).evaluateContent()}),r.Mc(31," Preview Import "),r.Ub(),r.Ub(),r.Ub()}if(2&e){var i=r.hc(3);r.Db(6),r.Nc(i.formValues.file?i.formValues.file.name:"Select or drop file"),r.Db(6),r.nc("ngModel",i.formValues.resourcesReferences),r.Db(8),r.nc("ngModel",i.formValues.clearEntities),r.Db(10),r.nc("disabled",!i.formValues.file||!i.formValues.file.name)}}function U(e,t){1&e&&(r.Vb(0,"p",28),r.Mc(1,"Please wait while processing..."),r.Ub())}function S(e,t){if(1&e&&(r.Vb(0,"div",31),r.Vb(1,"p",32),r.Mc(2),r.Ub(),r.Vb(3,"p",32),r.Mc(4,"File contains:"),r.Ub(),r.Vb(5,"ul",33),r.Vb(6,"li"),r.Mc(7),r.Ub(),r.Vb(8,"li"),r.Mc(9),r.Ub(),r.Vb(10,"li"),r.Mc(11),r.Ub(),r.Ub(),r.Vb(12,"p",32),r.Mc(13,"If you press Import, it will:"),r.Ub(),r.Vb(14,"ul",33),r.Vb(15,"li"),r.Mc(16),r.Ub(),r.Vb(17,"li"),r.Mc(18),r.Ub(),r.Vb(19,"li"),r.Mc(20),r.Ub(),r.Vb(21,"li"),r.Mc(22),r.Ub(),r.Ub(),r.Vb(23,"p",24),r.Mc(24,"Note: The import validates much data and may take several minutes."),r.Ub(),r.Ub()),2&e){var n=r.hc(4).ngIf,i=r.hc();r.Db(2),r.Oc("Try to import file '",i.formValues.file.name,"'"),r.Db(5),r.Oc("",n.evaluationResult.Detail.DocumentElementsCount," content-items (records/entities)"),r.Db(2),r.Oc("",n.evaluationResult.Detail.LanguagesInDocumentCount," languages"),r.Db(2),r.Pc("",n.evaluationResult.Detail.AttributeNamesInDocument.length," columns: ",n.evaluationResult.Detail.AttributeNamesInDocument.join(", "),""),r.Db(5),r.Oc("Create ",n.evaluationResult.Detail.AmountOfEntitiesCreated," content-items"),r.Db(2),r.Oc("Update ",n.evaluationResult.Detail.AmountOfEntitiesUpdated," content-items"),r.Db(2),r.Oc("Delete ",n.evaluationResult.Detail.AmountOfEntitiesDeleted," content-items"),r.Db(2),r.Pc("Ignore ",n.evaluationResult.Detail.AttributeNamesNotImported.length," columns: ",n.evaluationResult.Detail.AttributeNamesNotImported.join(", "),"")}}function w(e,t){if(1&e&&(r.Vb(0,"div"),r.Vb(1,"i"),r.Mc(2),r.Ub(),r.Ub()),2&e){var n=r.hc().$implicit;r.Db(2),r.Oc("Details: ",n.ErrorDetail,"")}}function M(e,t){if(1&e&&(r.Vb(0,"div"),r.Vb(1,"i"),r.Mc(2),r.Ub(),r.Ub()),2&e){var n=r.hc().$implicit;r.Db(2),r.Oc("Line-no: ",n.LineNumber,"")}}function y(e,t){if(1&e&&(r.Vb(0,"div"),r.Vb(1,"i"),r.Mc(2),r.Ub(),r.Ub()),2&e){var n=r.hc().$implicit;r.Db(2),r.Oc("Line-details: ",n.LineDetail,"")}}function C(e,t){if(1&e&&(r.Vb(0,"li"),r.Vb(1,"div"),r.Mc(2),r.Ub(),r.Kc(3,w,3,1,"div",6),r.Kc(4,M,3,1,"div",6),r.Kc(5,y,3,1,"div",6),r.Ub()),2&e){var n=t.$implicit,i=r.hc(6);r.Db(2),r.Nc(i.errors[n.ErrorCode]),r.Db(1),r.nc("ngIf",n.ErrorDetail),r.Db(1),r.nc("ngIf",n.LineNumber),r.Db(1),r.nc("ngIf",n.LineDetail)}}function I(e,t){if(1&e&&(r.Vb(0,"div",31),r.Vb(1,"p",32),r.Mc(2),r.Ub(),r.Vb(3,"ul",33),r.Kc(4,C,6,4,"li",34),r.Ub(),r.Ub()),2&e){var n=r.hc(4).ngIf,i=r.hc();r.Db(2),r.Oc("Try to import file '",i.formValues.file.name,"'"),r.Db(2),r.nc("ngForOf",n.evaluationResult.Errors)}}function R(e,t){if(1&e){var n=r.Wb();r.Tb(0),r.Kc(1,S,25,10,"div",29),r.Kc(2,I,5,2,"div",29),r.Vb(3,"div",30),r.Vb(4,"button",26),r.dc("click",function(){return r.Ac(n),r.hc(4).back()}),r.Mc(5,"Back"),r.Ub(),r.Vb(6,"button",27),r.dc("click",function(){return r.Ac(n),r.hc(4).importContent()}),r.Mc(7," Import "),r.Ub(),r.Ub(),r.Sb()}if(2&e){var i=r.hc(3).ngIf;r.Db(1),r.nc("ngIf",i.evaluationResult.Success),r.Db(1),r.nc("ngIf",!i.evaluationResult.Success),r.Db(4),r.nc("disabled",!i.evaluationResult.Success)}}function x(e,t){if(1&e&&(r.Tb(0),r.Kc(1,R,8,3,"ng-container",6),r.Sb()),2&e){var n=r.hc(2).ngIf;r.Db(1),r.nc("ngIf",n.evaluationResult)}}function O(e,t){1&e&&(r.Vb(0,"p"),r.Mc(1,"Import done."),r.Ub())}function T(e,t){1&e&&(r.Vb(0,"p"),r.Mc(1,"Import failed."),r.Ub())}function $(e,t){if(1&e&&(r.Vb(0,"div",28),r.Kc(1,O,2,0,"p",6),r.Kc(2,T,2,0,"p",6),r.Ub()),2&e){var n=r.hc(3).ngIf;r.Db(1),r.nc("ngIf",n.importResult.Success),r.Db(1),r.nc("ngIf",!n.importResult.Success)}}function P(e,t){if(1&e){var n=r.Wb();r.Vb(0,"div"),r.Kc(1,$,3,2,"div",35),r.Vb(2,"div",30),r.Vb(3,"button",36),r.dc("click",function(){return r.Ac(n),r.hc(3).closeDialog()}),r.Mc(4,"Close"),r.Ub(),r.Ub(),r.Ub()}if(2&e){var i=r.hc(2).ngIf;r.Db(1),r.nc("ngIf",i.importResult)}}function k(e,t){if(1&e&&(r.Tb(0),r.Tb(1,7),r.Kc(2,D,32,4,"form",8),r.Kc(3,U,2,0,"p",9),r.Kc(4,x,2,1,"ng-container",10),r.Kc(5,P,5,1,"div",10),r.Sb(),r.Sb()),2&e){var n=r.hc().ngIf;r.Db(1),r.nc("ngSwitch",n.viewStateSelected),r.Db(1),r.nc("ngSwitchCase",1),r.Db(1),r.nc("ngSwitchCase",0),r.Db(1),r.nc("ngSwitchCase",2),r.Db(1),r.nc("ngSwitchCase",3)}}function N(e,t){if(1&e){var n=r.Wb();r.Vb(0,"div",1),r.dc("filesDropped",function(e){return r.Ac(n),r.hc().filesDropped(e)}),r.Vb(1,"div",2),r.Vb(2,"div",3),r.Mc(3),r.Ub(),r.Ub(),r.Vb(4,"p",4),r.Mc(5," This will import content-items into 2sxc. It requires that you already defined the content-type before you try importing, and that you created the import-file using the template provided by the Export. Please visit "),r.Vb(6,"a",5),r.Mc(7,"https://2sxc.org/help"),r.Ub(),r.Mc(8," for more instructions. "),r.Ub(),r.Kc(9,k,6,5,"ng-container",6),r.Ub()}if(2&e){var i=t.ngIf,o=r.hc();r.nc("allowedFileTypes","xml"),r.Db(3),r.Oc("",null==i.contentType?null:i.contentType.Name," Import Data"),r.Db(6),r.nc("ngIf",null!=o.formValues)}}var _=function(){function e(e,t,n,o,l,r){this.dialogData=e,this.dialogRef=t,this.route=n,this.contentImportService=o,this.appDialogConfigService=l,this.contentTypesService=r,this.hostClass="dialog-component",this.contentType$=new a.a(null),this.loading$=new a.a(!1),this.viewStates={waiting:0,default:1,evaluated:2,imported:3},this.viewStateSelected$=new a.a(this.viewStates.default),this.evaluationResult$=new a.a(null),this.importResult$=new a.a(null),this.templateVars$=Object(c.a)([this.contentType$,this.loading$,this.viewStateSelected$,this.evaluationResult$,this.importResult$]).pipe(Object(s.a)(function(e){var t=Object(i.g)(e,5);return{contentType:t[0],loading:t[1],viewStateSelected:t[2],evaluationResult:t[3],importResult:t[4]}})),this.errors={0:"Unknown error occured.",1:"Selected content-type does not exist.",2:"Document is not a valid XML file.",3:"Selected content-type does not match the content-type in the XML file.",4:"The language is not supported.",5:"The document does not specify all languages for all entities.",6:"Language reference cannot be parsed, the language is not supported.",7:"Language reference cannot be parsed, the read-write protection is not supported.",8:"Value cannot be read, because of it has an invalid format."},this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName")}return e.prototype.ngOnInit=function(){var e=this;this.loading$.next(!0);var t=this.contentTypesService.retrieveContentType(this.contentTypeStaticName),n=this.appDialogConfigService.getDialogSettings();Object(l.a)([t,n]).subscribe(function(t){var n=Object(i.g)(t,2),o=n[1];e.contentType$.next(n[0]),e.formValues={defaultLanguage:o.Context.Language.Primary,contentType:e.contentTypeStaticName,file:null!=e.dialogData.files?e.dialogData.files[0]:null,resourcesReferences:"Keep",clearEntities:"None"},e.loading$.next(!1)})},e.prototype.ngOnDestroy=function(){this.contentType$.complete(),this.loading$.complete(),this.viewStateSelected$.complete(),this.evaluationResult$.complete(),this.importResult$.complete()},e.prototype.closeDialog=function(){this.dialogRef.close()},e.prototype.evaluateContent=function(){var e=this;this.viewStateSelected$.next(this.viewStates.waiting),this.contentImportService.evaluateContent(this.formValues).subscribe(function(t){e.evaluationResult$.next(t),e.viewStateSelected$.next(e.viewStates.evaluated)})},e.prototype.importContent=function(){var e=this;this.viewStateSelected$.next(this.viewStates.waiting),this.contentImportService.importContent(this.formValues).subscribe(function(t){e.importResult$.next(t),e.viewStateSelected$.next(e.viewStates.imported)})},e.prototype.back=function(){this.viewStateSelected$.next(this.viewStates.default),this.evaluationResult$.next(null)},e.prototype.fileChange=function(e){this.formValues.file=e.target.files[0]},e.prototype.filesDropped=function(e){this.formValues.file=e[0]},e.\u0275fac=function(t){return new(t||e)(r.Pb(o.a),r.Pb(o.f),r.Pb(u.a),r.Pb(b.a),r.Pb(p.a),r.Pb(f.a))},e.\u0275cmp=r.Jb({type:e,selectors:[["app-content-import"]],hostVars:1,hostBindings:function(e,t){2&e&&r.Yb("className",t.hostClass)},decls:2,vars:3,consts:[["class","dialog-form-wrapper","appDragAndDrop","",3,"allowedFileTypes","filesDropped",4,"ngIf"],["appDragAndDrop","",1,"dialog-form-wrapper",3,"allowedFileTypes","filesDropped"],["mat-dialog-title",""],[1,"dialog-title-box"],[1,"dialog-description"],["href","https://2sxc.org/help","target","_blank"],[4,"ngIf"],[3,"ngSwitch"],["class","dialog-form",4,"ngSwitchCase"],["class","progress-message",4,"ngSwitchCase"],[4,"ngSwitchCase"],[1,"dialog-form"],["ngForm","ngForm"],[1,"dialog-form-content","fancy-scrollbar-light"],["mat-raised-button","","matTooltip","Open file browser",3,"click"],["type","file",1,"hide",3,"change"],["fileInput",""],[1,"field-label"],["name","ResourcesReferences",3,"ngModel","ngModelChange"],["value","Keep"],["value","Resolve"],["name","ClearEntities",3,"ngModel","ngModelChange"],["value","None"],["value","All"],[1,"hint"],[1,"dialog-form-actions"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click"],[1,"progress-message"],["class","dialog-component-content fancy-scrollbar-light",4,"ngIf"],[1,"dialog-component-actions"],[1,"dialog-component-content","fancy-scrollbar-light"],[1,"evaluation__title"],[1,"evaluation__content"],[4,"ngFor","ngForOf"],["class","progress-message",4,"ngIf"],["mat-raised-button","","color","accent",3,"click"]],template:function(e,t){1&e&&(r.Kc(0,N,10,3,"div",0),r.ic(1,"async")),2&e&&r.nc("ngIf",r.jc(1,1,t.templateVars$))},directives:[d.n,g.a,o.g,d.p,d.q,m.v,m.n,m.o,h.a,v.a,V.b,m.m,m.p,V.a,d.m],pipes:[d.b],styles:[".field-label[_ngcontent-%COMP%]{font-size:18px;margin:24px 0 0}.mat-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:8px 0}.mat-radio-button[_ngcontent-%COMP%]{margin:5px;font-size:14px}.hint[_ngcontent-%COMP%]{margin-top:24px;margin-bottom:16px}.hint[_ngcontent-%COMP%], .progress-message[_ngcontent-%COMP%]{font-size:18px}.evaluation__title[_ngcontent-%COMP%]{font-size:18px;margin:24px 0 0;font-weight:700}.evaluation__content[_ngcontent-%COMP%]{font-size:14px}.evaluation__content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:2px 0}"]}),e}()}}]);
//# sourceMappingURL=https://sources.2sxc.org/12.03.00/ng-edit/content-import-component.ef205c2aa10e7f5148e4.js.map