"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_metadata_metadata_component_ts","projects_eav-ui_src_app_shared_directives_click-stop-propagation_directive_ts","projects_eav-ui_src_app_app-administration_services_app-dialog-config_service_ts-_86580","projects_eav-ui_src_app_app-administration_services_app-dialog-config_service_ts-_86581"],{533:(R,g,n)=>{n.d(g,{m:()=>f});var s=n(7488),u=n(604),d=n(8600),E=n(5200),o=n(6028),c=n(4896),h=n(1332),I=n(3392),C=n(9244);let f=(()=>{class l{constructor(t,p,v,P,U){this.http=t,this.context=p,this.dnnContext=v,this.globalConfigService=P,this.dialogSettings$={},U.loadFromService(this)}getShared$(t){return t??=this.context.appId,this.dialogSettings$[t]||(this.dialogSettings$[t]=this.getDialogSettings(t).pipe((0,s.C)({refCount:!1}))),this.dialogSettings$[t]}getDialogSettings(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/dialog/settings"),{params:{appId:t??this.context.appId.toString()}}).pipe((0,u.k)(p=>(p.Context.Language.List=p.Context.Language.List.filter(v=>v.IsEnabled),p)),(0,d.y)(p=>{this.globalConfigService.allowDebug(p.Context.Enable.DebugMode)}))}static#t=this.\u0275fac=function(p){return new(p||l)(c.CoB(h.KK),c.CoB(o.e),c.CoB(I.es),c.CoB(E.Sq),c.CoB(C.E))};static#e=this.\u0275prov=c.wxM({token:l,factory:l.\u0275fac})}return l})()},6964:(R,g,n)=>{n.d(g,{M:()=>c});var s=n(6028),u=n(9644),d=n(4896),E=n(1332),o=n(3392);let c=(()=>{class h{constructor(C,m,f){this.http=C,this.context=m,this.dnnContext=f}getContentInfo(C){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(u._+"Get"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),scope:C}})}exportParts(C,m,f){const l=this.dnnContext.$2sxc.http.apiUrl(u._+"Export")+"?appId="+this.context.appId.toString()+"&zoneId="+this.context.zoneId.toString()+"&contentTypeIdsString="+C.join(";")+"&entityIdsString="+m.join(";")+"&templateIdsString="+f.join(";");window.open(l,"_blank","")}static#t=this.\u0275fac=function(m){return new(m||h)(d.CoB(E.KK),d.CoB(s.e),d.CoB(o.es))};static#e=this.\u0275prov=d.wxM({token:h,factory:h.\u0275fac})}return h})()},6503:(R,g,n)=>{n.d(g,{S:()=>c});var s=n(5343),u=n(6028),d=n(4896),E=n(1332),o=n(3392);let c=(()=>{class h{constructor(C,m,f){this.http=C,this.context=m,this.dnnContext=f}getAppInfo(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(s.i+"Statistics"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}exportApp(C,m){const f=this.dnnContext.$2sxc.http.apiUrl(s.i+"Export")+"?appId="+this.context.appId+"&zoneId="+this.context.zoneId+"&includeContentGroups="+C+"&resetAppGuid="+m;window.open(f,"_blank","")}exportForVersionControl({includeContentGroups:C,resetAppGuid:m,withFiles:f}){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(s.i+"SaveData"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),includeContentGroups:C.toString(),resetAppGuid:m.toString(),withPortalFiles:f.toString()}})}static#t=this.\u0275fac=function(m){return new(m||h)(d.CoB(E.KK),d.CoB(u.e),d.CoB(o.es))};static#e=this.\u0275prov=d.wxM({token:h,factory:h.\u0275fac})}return h})()},9644:(R,g,n)=>{n.d(g,{M:()=>h,_:()=>c});var s=n(5343),u=n(6028),d=n(4896),E=n(1332),o=n(3392);const c="admin/appParts/";let h=(()=>{class I{constructor(m,f,l){this.http=m,this.context=f,this.dnnContext=l}importAppParts(m){const f=new FormData;return f.append("File",m),this.http.post(this.dnnContext.$2sxc.http.apiUrl(c+"Import"),f,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}resetApp(m){return this.http.post(this.dnnContext.$2sxc.http.apiUrl(s.i+"Reset"),{},{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),withPortalFiles:m.toString()}})}static#t=this.\u0275fac=function(f){return new(f||I)(d.CoB(E.KK),d.CoB(u.e),d.CoB(o.es))};static#e=this.\u0275prov=d.wxM({token:I,factory:I.\u0275fac})}return I})()},8112:(R,g,n)=>{n.d(g,{K0:()=>c.K0,Xi:()=>u.X,cV:()=>c.cV,fn:()=>c.fn,kN:()=>c.kN,kX:()=>c.kX,mK:()=>s.m,ot:()=>c.ot,sj:()=>h.s});var s=n(533),u=n(692),c=(n(6964),n(6503),n(9644),n(900)),h=n(7184)},900:(R,g,n)=>{n.d(g,{K0:()=>P,cV:()=>t,fn:()=>p,kN:()=>v,kX:()=>U,ot:()=>O});var s=n(9616),u=n(9432),d=n(604),E=n(4172),o=n(616),c=n(6028),h=n(4896),I=n(1332),C=n(3392);const O="admin/query/Run",t="admin/query/DebugStream",p="admin/query/Save",v="admin/query/Get",P="admin/query/DataSources";let U=(()=>{class F{constructor(x,$,D){this.http=x,this.context=$,this.dnnContext=D}getAll(x){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(E.U1),{params:{appId:this.context.appId.toString(),contentType:x}})}importQuery(x){return(0,s.Q)((0,o.S)(x)).pipe((0,u.G)($=>this.http.post(this.dnnContext.$2sxc.http.apiUrl("admin/query/import"),{AppId:this.context.appId.toString(),ContentBase64:$})),(0,d.k)($=>({Success:$,Messages:[]})))}clonePipeline(x){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/query/Clone"),{params:{Id:x.toString(),appId:this.context.appId.toString()}})}delete(x){return this.http.delete(this.dnnContext.$2sxc.http.apiUrl("admin/query/Delete"),{params:{appId:this.context.appId.toString(),Id:x.toString()}})}static#t=this.\u0275fac=function($){return new($||F)(h.CoB(I.KK),h.CoB(c.e),h.CoB(C.es))};static#e=this.\u0275prov=h.wxM({token:F,factory:F.\u0275fac})}return F})()},7184:(R,g,n)=>{n.d(g,{s:()=>f});var s=n(6028),u=n(4896),d=n(1332),E=n(3392);const o="admin/view/",c=o+"all",h=o+"delete",I=o+"import",C=o+"polymorphism",m=o+"usage";let f=(()=>{class l{constructor(t,p,v){this.http=t,this.context=p,this.dnnContext=v}getAll(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(c),{params:{appId:this.context.appId.toString()}})}delete(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(h),{params:{appId:this.context.appId.toString(),Id:t.toString()}})}import(t){const p=new FormData;return p.append("File",t),this.http.post(this.dnnContext.$2sxc.http.apiUrl(I),p,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}export(t){const p=this.dnnContext.$2sxc.http.apiUrl(o+"json")+"?appId="+this.context.appId+"&viewId="+t;window.open(p,"_blank","")}getPolymorphism(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(C),{params:{appId:this.context.appId.toString()}})}getUsage(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(m),{params:{appId:this.context.appId.toString(),guid:t}})}static#t=this.\u0275fac=function(p){return new(p||l)(u.CoB(d.KK),u.CoB(s.e),u.CoB(E.es))};static#e=this.\u0275prov=u.wxM({token:l,factory:l.\u0275fac})}return l})()},6036:(R,g,n)=>{n.d(g,{q:()=>f});var s=n(9616),u=n(9432),d=n(604),E=n(3764),o=n(4172),c=n(616),h=n(6028),I=n(4896),C=n(1332),m=n(3392);let f=(()=>{class l{constructor(t,p,v){this.http=t,this.context=p,this.dnnContext=v}getAll(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(o.U1),{params:{appId:this.context.appId.toString(),contentType:t}})}getColumns(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(E.yK),{params:{appId:this.context.appId.toString(),staticName:t}})}importItem(t){return(0,s.Q)((0,c.S)(t)).pipe((0,u.G)(p=>this.http.post(this.dnnContext.$2sxc.http.apiUrl(o.ue+"upload"),{AppId:this.context.appId.toString(),ContentBase64:p})),(0,d.k)(p=>({Success:p,Messages:[]})))}static#t=this.\u0275fac=function(p){return new(p||l)(I.CoB(C.KK),I.CoB(h.e),I.CoB(m.es))};static#e=this.\u0275prov=I.wxM({token:l,factory:l.\u0275fac})}return l})()},3572:(R,g,n)=>{n.d(g,{I:()=>o});var s=n(4896),u=n(1332),d=n(3392);let o=(()=>{class c{constructor(I,C){this.http=I,this.dnnContext=C}getFeatureDetails(I){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/feature/details"),{params:{nameId:I}})}static#t=this.\u0275fac=function(C){return new(C||c)(s.CoB(u.KK),s.CoB(d.es))};static#e=this.\u0275prov=s.wxM({token:c,factory:c.\u0275fac})}return c})()},7008:(R,g,n)=>{n.d(g,{C:()=>$});var s=n(600),u=n(5876),d=n(604),E=n(2556),o=n(4896),c=n(4648),h=n(3572),I=n(4672),C=n(2328),m=n(8512),f=n(8200),l=n(5056),O=n(48),t=n(8752);function p(D,B){if(1&D){const _=o.KQA();o.I0R(0,"div",1)(1,"div",2),o.OEk(2,"ID:"),o.C$Y(),o.I0R(3,"div",8)(4,"span",9),o.qCj("click",function(){const G=o.usT(_),K=o.GaO(2);return o.CGJ(K.copyToClipboard(G))}),o.OEk(5),o.C$Y()()()}2&D&&(o.yG2(4),o.E7m("tippy",B),o.yG2(1),o.cNF(B))}function v(D,B){if(1&D){const _=o.KQA();o.I0R(0,"button",10),o.qCj("click",function(){const G=o.usT(_),K=o.GaO(2);return o.CGJ(K.findOutMore(G))}),o.I0R(1,"mat-icon"),o.OEk(2,"open_in_new"),o.C$Y(),o.OEk(3),o.wVc(4,"translate"),o.C$Y()}2&D&&(o.yG2(3),o.oRS(" ",o.kDX(4,1,"Features.FindOutMore")," "))}function P(D,B){if(1&D){const _=o.KQA();o.I0R(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),o.OEk(3),o.C$Y()(),o.I0R(4,"mat-card-content"),o.wR5(5,"p",0),o.wVc(6,"safeHtml"),o.I0R(7,"div",1)(8,"div",2),o.OEk(9),o.wVc(10,"translate"),o.C$Y(),o.I0R(11,"div",3)(12,"span"),o.OEk(13),o.wVc(14,"translate"),o.C$Y()()(),o.yuY(15,p,6,2,"div",4),o.C$Y(),o.I0R(16,"mat-card-actions",5),o.yuY(17,v,5,3,"button",6),o.I0R(18,"button",7),o.qCj("click",function(){o.usT(_);const S=o.GaO();return o.CGJ(S.closeDialog())}),o.OEk(19),o.wVc(20,"translate"),o.C$Y()()()}if(2&D){let _;o.yG2(3),o.cNF(B.feature.Name),o.yG2(2),o.E7m("innerHtml",o.kDX(6,7,B.feature.Description),o.E3n),o.yG2(4),o.oRS("",o.kDX(10,9,"Features.Status"),":"),o.yG2(4),o.cNF(o.kDX(14,11,B.feature.IsEnabled?"Features.Active":"Features.NotActive")),o.yG2(2),o.C0Y(15,(_=B.feature.NameId)?15:-1,_),o.yG2(2),o.C0Y(17,(_=B.feature.Link)?17:-1,_),o.yG2(2),o.oRS(" ",o.kDX(20,13,"Features.Close")," ")}}let U=(()=>{class D{constructor(_,T,S,G){this.dialogData=_,this.dialogRef=T,this.snackBar=S,this.featureDetailService=G}ngOnInit(){this.viewModel$=(0,u.E)([this.featureDetailService.getFeatureDetails(this.dialogData)]).pipe((0,d.k)(([_])=>({feature:_})))}copyToClipboard(_){(0,E.y)(_),this.snackBar.open("Copied to clipboard",null,{duration:2e3})}findOutMore(_){window.open(_,"_blank")}closeDialog(){this.dialogRef.close()}static#t=this.\u0275fac=function(T){return new(T||D)(o.GI1(s.sR),o.GI1(s.yI),o.GI1(c.yS),o.GI1(h.I))};static#e=this.\u0275cmp=o.In1({type:D,selectors:[["app-feature-info-dialog"]],decls:2,vars:3,consts:[[3,"innerHtml"],[1,"eav-info-row"],[1,"eav-info-row__label"],[1,"eav-info-row__value"],["class","eav-info-row"],["align","end"],["mat-raised-button","","color","accent","class","eav-card-action-button"],["mat-raised-button","",1,"eav-card-action-button",3,"click"],[1,"eav-info-row__value","eav_click"],[3,"tippy","click"],["mat-raised-button","","color","accent",1,"eav-card-action-button",3,"click"]],template:function(T,S){if(1&T&&(o.yuY(0,P,21,15,"mat-card"),o.wVc(1,"async")),2&T){let G;o.C0Y(0,(G=o.kDX(1,1,S.viewModel$))?0:-1,G)}},dependencies:[I.Gw,C.qL,m.SM,m.W0,m.WK,m.Uc,m.gp,f.Y,l.a,O.K,t.sD]})}return D})();var F=n(4844),b=n(9432),x=n(9244);let $=(()=>{class D{set featureNameId(_){this.featureNameId$.next(_)}set showIf(_){this.showIf$.next(1==_)}constructor(_,T,S,G){this.dialog=_,this.viewContainerRef=T,this.changeDetectorRef=S,this.featuresService=G,this.featureNameId$=new F.g(null),this.showIf$=new F.g(!1),this.feature$=this.featureNameId$.pipe((0,b.G)(K=>this.featuresService.get$(K))),this.show$=(0,u.E)([this.feature$,this.showIf$]).pipe((0,d.k)(([K,Y])=>Y==(K?.IsEnabled??!1)))}openDialog(){D.openDialog(this.dialog,this.featureNameId$.value,this.viewContainerRef,this.changeDetectorRef)}static openDialog(_,T,S,G){_.open(U,{autoFocus:!1,data:T,viewContainerRef:S,width:"400px"}),G.markForCheck()}static#t=this.\u0275fac=function(T){return new(T||D)(o.GI1(s.qW),o.GI1(o.y8U),o.GI1(o.kD9),o.GI1(x.E))};static#e=this.\u0275dir=o.Sc5({type:D,inputs:{featureNameId:"featureNameId",showIf:"showIf"}})}return D})()},5343:(R,g,n)=>{n.d(g,{i:()=>I,t:()=>C});var s=n(9432),u=n(8916),d=n(8288),E=n(6028),o=n(4896),c=n(1332),h=n(3392);const I="admin/app/";let C=(()=>{class m{constructor(l,O,t){this.http=l,this.context=O,this.dnnContext=t}importApp(l,O,t=!1){const p=new FormData;return p.append("File",l),p.append("Name",O??""),this.http.post(this.dnnContext.$2sxc.http.apiUrl(I+"Import"),p,{params:{zoneId:this.context.zoneId.toString()}}).pipe((0,s.G)(v=>{if(t&&v.Messages[0]?.MessageType===d.cB.Warning){const P=prompt(v.Messages[0].Text+" Would you like to install it using another folder name?");if(P)return this.importApp(l,P,!0)}return(0,u.of)(v)}))}static#t=this.\u0275fac=function(O){return new(O||m)(o.CoB(c.KK),o.CoB(E.e),o.CoB(h.es))};static#e=this.\u0275prov=o.wxM({token:m,factory:m.\u0275fac})}return m})()},1114:(R,g,n)=>{n.r(g),n.d(g,{MetadataComponent:()=>Et});var s=n(4844),u=n(5876),d=n(604),E=n(8600),o=n(6036),c=n(4328),h=n(2876),I=n(2816),C=n(5760),m=n(1743),f=n(9224),l=n(5396),O=n(600),t=n(4896),p=n(4672),v=n(8512),P=n(48);function U(i,y){if(1&i&&(t.wR5(0,"mat-card-subtitle",0),t.wVc(1,"safeHtml")),2&i){const e=t.GaO();t.E7m("innerHtml",t.kDX(1,1,e.dialogData.message),t.E3n)}}let F=(()=>{class i{constructor(e,a){this.dialogData=e,this.dialogRef=a,this.hostClass="dialog-component"}closeDialog(e){this.dialogRef.close(e)}static#t=this.\u0275fac=function(a){return new(a||i)(t.GI1(O.sR),t.GI1(O.yI))};static#e=this.\u0275cmp=t.In1({type:i,selectors:[["app-confirm-delete-dialog"]],hostVars:1,hostBindings:function(a,r){2&a&&t.SoX("className",r.hostClass)},decls:10,vars:3,consts:[[3,"innerHtml"],["align","end"],["mat-raised-button","",1,"eav-card-action-button",3,"click"]],template:function(a,r){1&a&&(t.I0R(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),t.OEk(3),t.C$Y(),t.yuY(4,U,2,3,"mat-card-subtitle",0),t.C$Y(),t.I0R(5,"mat-card-actions",1)(6,"button",2),t.qCj("click",function(){return r.closeDialog()}),t.OEk(7,"Cancel"),t.C$Y(),t.I0R(8,"button",2),t.qCj("click",function(){return r.closeDialog(!0)}),t.OEk(9,"Delete"),t.C$Y()()()),2&a&&(t.yG2(3),t.CAO("Delete ",r.dialogData.entityTitle," (",r.dialogData.entityId,")?"),t.yG2(1),t.C0Y(4,r.dialogData.message?4:-1))},dependencies:[p.Gw,v.SM,v.W0,v.Uc,v.uK,v.gp,P.K],styles:[".eav-card-action-button[_ngcontent-%COMP%]{margin-left:8px}"]})}return i})();var b=n(8200),x=n(2328),$=n(6176);let D=(()=>{class i{agInit(e){this.params=e}refresh(e){return!0}deleteMetadata(){this.params.onDelete(this.params.data)}static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275cmp=t.In1({type:i,selectors:[["app-metadata-actions"]],decls:4,vars:0,consts:[[1,"actions-component"],["matRipple","","tippy","Delete",1,"eav-grid-action-button","highlight",3,"click"]],template:function(a,r){1&a&&(t.I0R(0,"div",0)(1,"div",1),t.qCj("click",function(){return r.deleteMetadata()}),t.I0R(2,"mat-icon"),t.OEk(3,"delete"),t.C$Y()()())},dependencies:[b.Y,x.qL,$.UZ]})}return i})(),B=(()=>{class i{agInit(e){this.value=e.value,this.metadata=e.data}refresh(e){return!0}static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275cmp=t.In1({type:i,selectors:[["app-metadata-content-type"]],decls:2,vars:3,consts:[[1,"container",3,"tippy","tippyDisabled"]],template:function(a,r){1&a&&(t.I0R(0,"div",0),t.OEk(1),t.C$Y()),2&a&&(t.E7m("tippy",r.metadata._Type.Description)("tippyDisabled",!r.metadata._Type.Description),t.yG2(1),t.oRS(" ",r.value,"\n"))},dependencies:[b.Y],styles:[".container[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content}"]})}return i})();var _=n(1904),T=n(1792),S=n(1484),G=n(8112),K=n(420),Y=n(5056),j=n(9084),V=n(504),W=n(244),H=n(7872),z=n(2536),Q=n(3424);function X(i,y){if(1&i&&(t.I0R(0,"mat-option",14),t.OEk(1),t.C$Y()),2&i){const e=y.$implicit;t.E7m("value",e.value),t.yG2(1),t.oRS(" ",e.name," ")}}function J(i,y){if(1&i&&(t.I0R(0,"mat-form-field",2)(1,"mat-label"),t.OEk(2,"Scope"),t.C$Y(),t.I0R(3,"mat-select",13),t.c53(4,X,2,2,"mat-option",14,t.oxv),t.I0R(6,"mat-option",14),t.OEk(7,"Other..."),t.C$Y()()(),t.I0R(8,"app-field-hint"),t.OEk(9," The scope should almost never be changed - "),t.I0R(10,"a",15),t.OEk(11,"see help"),t.C$Y()()),2&i){const e=t.GaO(),a=t.GaO();t.yG2(3),t.E7m("placeholder",e.scopeOptions.length?"":"No items found"),t.yG2(1),t.oho(e.scopeOptions),t.yG2(2),t.E7m("value",a.dropdownInsertValue)}}function Z(i,y){if(1&i&&(t.I0R(0,"mat-option",14),t.OEk(1),t.C$Y()),2&i){const e=y.$implicit;t.E7m("value",e.StaticName),t.yG2(1),t.oRS(" ",e.Label," ")}}function q(i,y){if(1&i&&(t.I0R(0,"mat-select",3),t.c53(1,Z,2,2,"mat-option",14,t.oxv),t.C$Y()),2&i){const e=t.GaO();t.E7m("placeholder",e.contentTypes.length?"":"No items found"),t.yG2(1),t.oho(e.contentTypes)}}function tt(i,y){1&i&&t.wR5(0,"input",4)}function et(i,y){1&i&&(t.I0R(0,"app-field-hint",8),t.OEk(1," This field is required "),t.C$Y()),2&i&&t.E7m("isError",!0)}const w=i=>({active:i});function nt(i,y){if(1&i){const e=t.KQA();t.I0R(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),t.OEk(3,"Create Metadata"),t.C$Y(),t.I0R(4,"mat-card-subtitle"),t.OEk(5," This is a special operation to add an item which is metadata for another item, see "),t.I0R(6,"a",0),t.OEk(7,"docs"),t.C$Y(),t.OEk(8,". "),t.C$Y()(),t.I0R(9,"mat-card-content")(10,"form",1),t.yuY(11,J,12,2),t.I0R(12,"mat-form-field",2)(13,"mat-label"),t.OEk(14,"Content Type"),t.C$Y(),t.yuY(15,q,3,1,"mat-select",3)(16,tt,1,0,"input",4),t.I0R(17,"div",5)(18,"button",6),t.qCj("click",function(){t.usT(e);const r=t.GaO();return t.CGJ(r.toggleGuidedContentType(!0))}),t.I0R(19,"mat-icon"),t.OEk(20,"search"),t.C$Y()(),t.I0R(21,"button",7),t.qCj("click",function(){t.usT(e);const r=t.GaO();return t.CGJ(r.toggleGuidedContentType(!1))}),t.I0R(22,"mat-icon"),t.OEk(23,"text_fields"),t.C$Y()()()(),t.yuY(24,et,2,1,"app-field-hint",8),t.C$Y()(),t.I0R(25,"mat-card-actions",9)(26,"mat-slide-toggle",10),t.qCj("change",function(r){t.usT(e);const M=t.GaO();return t.CGJ(M.toggleAdvancedMode(r))}),t.OEk(27),t.C$Y(),t.I0R(28,"div")(29,"button",11),t.qCj("click",function(){t.usT(e);const r=t.GaO();return t.CGJ(r.closeDialog())}),t.OEk(30,"Cancel"),t.C$Y(),t.I0R(31,"button",12),t.qCj("click",function(){t.usT(e);const r=t.GaO();return t.CGJ(r.confirm())}),t.OEk(32," Confirm "),t.C$Y()()()()}if(2&i){const e=t.GaO();t.yG2(10),t.E7m("formGroup",e.form),t.yG2(1),t.C0Y(11,e.advancedMode&&e.guidedContentType?11:-1),t.yG2(4),t.C0Y(15,e.guidedContentType?15:-1),t.yG2(1),t.C0Y(16,e.guidedContentType?-1:16),t.yG2(2),t.E7m("ngClass",t.S45(10,w,e.guidedContentType)),t.yG2(3),t.E7m("ngClass",t.S45(12,w,!e.guidedContentType)),t.yG2(3),t.C0Y(24,e.form.controls.contentType.touched&&null!=e.form.controls.contentType.errors&&e.form.controls.contentType.errors.required?24:-1),t.yG2(2),t.E7m("checked",e.advancedMode),t.yG2(1),t.oRS(" ",e.advancedMode?"Advanced":"Simple"," "),t.yG2(4),t.E7m("disabled",!e.form.valid)}}let ot=(()=>{class i{constructor(e,a){this.dialogRef=e,this.contentTypesService=a,this.hostClass="dialog-component",this.dropdownInsertValue=K.M,this.guidedContentType=!0,this.advancedMode=!1}ngOnInit(){this.contentTypes$=new s.g([]),this.scopeOptions$=new s.g([]),this.buildForm(),this.fetchScopes(),this.viewModel$=(0,u.E)([this.contentTypes$,this.scopeOptions$]).pipe((0,d.k)(([e,a])=>({contentTypes:e,scopeOptions:a})))}ngOnDestroy(){this.contentTypes$.complete(),this.scopeOptions$.complete()}closeDialog(e){this.dialogRef.close(e)}toggleGuidedContentType(e){this.guidedContentType=e}toggleAdvancedMode(e){this.advancedMode=e.checked}confirm(){const e=this.form.getRawValue();this.closeDialog(e.contentType)}buildForm(){this.form=new _.k1({}),this.form.addControl("contentType",new _.yM(null,[_.AQ.required])),this.form.addControl("scope",new _.yM(f._K.scopes.default.value)),this.form.controls.scope.valueChanges.pipe((0,T.W)(this.form.controls.scope.value),(0,S.a)()).subscribe(e=>{null!=this.form.controls.contentType.value&&this.form.controls.contentType.patchValue(null),e===K.M?(e=prompt("This is an advanced feature to show content-types of another scope. Don't use this if you don't know what you're doing, as content-types of other scopes are usually hidden for a good reason.")||f._K.scopes.default.value,this.scopeOptions$.value.some(a=>a.value===e)||this.scopeOptions$.next([{name:e,value:e},...this.scopeOptions$.value]),this.form.controls.scope.patchValue(e)):this.fetchContentTypes(e)})}fetchContentTypes(e){this.contentTypesService.retrieveContentTypes(e).subscribe(a=>{this.contentTypes$.next(a)})}fetchScopes(){this.contentTypesService.getScopes().subscribe(e=>{this.scopeOptions$.next(e)})}static#t=this.\u0275fac=function(a){return new(a||i)(t.GI1(O.yI),t.GI1(G.Xi))};static#e=this.\u0275cmp=t.In1({type:i,selectors:[["app-metadata-save-dialog"]],hostVars:1,hostBindings:function(a,r){2&a&&t.SoX("className",r.hostClass)},decls:2,vars:3,consts:[["href","https://go.2sxc.org/metadata","target","_blank"],[3,"formGroup"],["color","accent",1,"eav-form-field"],["formControlName","contentType","required","",3,"placeholder"],["matInput","","type","text","formControlName","contentType","required",""],["matTextSuffix",""],["mat-icon-button","","type","button","tippy","Pick existing value",3,"ngClass","click"],["mat-icon-button","","type","button","tippy","Manual entry",3,"ngClass","click"],[3,"isError"],[1,"eav-card-actions"],["color","accent",3,"checked","change"],["mat-raised-button","",1,"eav-card-action-button",3,"click"],["mat-raised-button","","color","accent",1,"eav-card-action-button",3,"disabled","click"],["formControlName","scope",3,"placeholder"],[3,"value"],["href","https://2sxc.org/help?tag=scope","target","_blank","appClickStopPropagation",""]],template:function(a,r){if(1&a&&(t.yuY(0,nt,33,14,"mat-card"),t.wVc(1,"async")),2&a){let M;t.C0Y(0,(M=t.kDX(1,1,r.viewModel$))?0:-1,M)}},dependencies:[Y.QF,j.o,V.c,b.Y,p.Gw,p.um,x.qL,_.sz,_.ot,_.ue,_.u,_.eJ,_.uW,_.Wo,W.Up,W.w5,W.Gm,H.kX,$.I5,z.yi,Q.cP,v.SM,v.W0,v.WK,v.Uc,v.uK,v.gp,Y.a],styles:[".eav-card-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.eav-card-action-button[_ngcontent-%COMP%]{margin-left:8px}"]})}return i})();var at=n(7008),L=n(5204),it=n(4648),st=n(4072),k=n(4716),rt=n(32);function ct(i,y){1&i&&t.OEk(0," This item is not metadata for anything else. ")}function lt(i,y){if(1&i&&(t.wR5(0,"br"),t.OEk(1)),2&i){const e=t.GaO(2);t.yG2(1),t.oRS("Number: ",e.itemFor.Number," ")}}function dt(i,y){if(1&i&&(t.wR5(0,"br"),t.OEk(1)),2&i){const e=t.GaO(2);t.yG2(1),t.oRS("Guid: ",e.itemFor.Guid," ")}}function pt(i,y){if(1&i&&(t.wR5(0,"br"),t.OEk(1)),2&i){const e=t.GaO(2);t.yG2(1),t.oRS("String: ",e.itemFor.String," ")}}function mt(i,y){if(1&i&&(t.wR5(0,"br"),t.OEk(1)),2&i){const e=t.GaO(2);t.yG2(1),t.oRS("Title: ",e.itemFor.String," ")}}function _t(i,y){if(1&i&&(t.OEk(0," This item is metadata for: "),t.wR5(1,"br"),t.OEk(2),t.wR5(3,"br"),t.OEk(4),t.yuY(5,lt,2,1)(6,dt,2,1)(7,pt,2,1)(8,mt,2,1)),2&i){const e=t.GaO();t.yG2(2),t.oRS("Target: ",e.itemFor.Target," "),t.yG2(2),t.oRS("TargetType: ",e.itemFor.TargetType," "),t.yG2(1),t.C0Y(5,e.itemFor.Number?5:-1),t.yG2(1),t.C0Y(6,e.itemFor.Guid?6:-1),t.yG2(1),t.C0Y(7,e.itemFor.String?7:-1),t.yG2(1),t.C0Y(8,e.itemFor.Title?8:-1)}}function ht(i,y){if(1&i){const e=t.KQA();t.I0R(0,"button",11),t.qCj("click",function(){t.usT(e);const r=t.GaO(2);return t.CGJ(r.createMetadata())}),t.I0R(1,"mat-icon"),t.OEk(2,"add"),t.C$Y()()}}function ut(i,y){if(1&i&&(t.wR5(0,"div",20),t.wVc(1,"safeHtml")),2&i){const e=t.GaO().$implicit;t.E7m("innerHTML",t.kDX(1,2,e.Icon),t.E3n)("matBadgeHidden",e.Enabled)}}function Ct(i,y){1&i&&(t.I0R(0,"mat-icon"),t.OEk(1,"add"),t.C$Y())}function ft(i,y){if(1&i){const e=t.KQA();t.I0R(0,"button",18),t.qCj("click",function(){const M=t.usT(e).$implicit,A=t.GaO(3);return t.CGJ(A.createMetadata(M))}),t.yuY(1,ut,2,4,"div",19)(2,Ct,2,0),t.C$Y()}if(2&i){const e=y.$implicit;t.e48("label",e.Title),t.yG2(1),t.C0Y(1,e.Icon?1:2)}}const gt=i=>({"fab-opened":i});function vt(i,y){if(1&i){const e=t.KQA();t.I0R(0,"eco-fab-speed-dial",12),t.qCj("openChange",function(r){t.usT(e);const M=t.GaO(2);return t.CGJ(M.openChange(r))}),t.I0R(1,"eco-fab-speed-dial-trigger",13)(2,"button",14)(3,"mat-icon",15),t.OEk(4),t.C$Y()()(),t.I0R(5,"eco-fab-speed-dial-actions",16)(6,"button",17),t.qCj("click",function(){t.usT(e);const r=t.GaO(2);return t.CGJ(r.createMetadata())}),t.I0R(7,"mat-icon"),t.OEk(8,"search"),t.C$Y()(),t.c53(9,ft,3,2,"button",21,t.oxv),t.C$Y()()}if(2&i){const e=t.GaO();t.E7m("ngClass",t.S45(3,gt,e.fabOpen)),t.yG2(1),t.E7m("spin",!0),t.yG2(3),t.cNF(e.fabOpen?"close":"add"),t.yG2(5),t.oho(e.recommendations)}}function It(i,y){if(1&i){const e=t.KQA();t.I0R(0,"div",1)(1,"div",2)(2,"div",3),t.OEk(3),t.C$Y(),t.I0R(4,"button",4),t.qCj("click",function(){t.usT(e);const r=t.GaO();return t.CGJ(r.closeDialog())}),t.I0R(5,"mat-icon"),t.OEk(6,"close"),t.C$Y()()(),t.I0R(7,"div",5)(8,"p"),t.yuY(9,ct,1,0)(10,_t,9,6),t.C$Y(),t.wR5(11,"router-outlet"),t.I0R(12,"div",6),t.wR5(13,"ag-grid-angular",7),t.C$Y()(),t.I0R(14,"mat-dialog-actions",8),t.yuY(15,ht,3,0,"button",9)(16,vt,11,5,"eco-fab-speed-dial",10),t.C$Y()()}if(2&i){const e=t.GaO();t.yG2(3),t.oRS(" ",e.title||"Metadata"," "),t.yG2(6),t.C0Y(9,y.itemFor?-1:9),t.yG2(1),t.C0Y(10,y.itemFor?10:-1),t.yG2(3),t.E7m("rowData",y.metadata)("gridOptions",e.gridOptions),t.yG2(2),t.C0Y(15,0===y.recommendations.length?15:-1),t.yG2(1),t.C0Y(16,y.recommendations.length>0?16:-1)}}let Et=(()=>{class i extends I.K{constructor(e,a,r,M,A,N,yt,Dt,Mt,Ot){super(e,a),this.router=e,this.route=a,this.dialogRef=r,this.metadataService=M,this.snackBar=A,this.entitiesService=N,this.contentItemsService=yt,this.dialog=Dt,this.viewContainerRef=Mt,this.changeDetectorRef=Ot,this.gridOptions=this.buildGridOptions(),this.metadata$=new s.g([]),this.recommendations$=new s.g([]),this.itemFor$=new s.g(void 0),this.fabOpen$=new s.g(!1),this.targetType=parseInt(this.route.snapshot.paramMap.get("targetType"),10),this.keyType=this.route.snapshot.paramMap.get("keyType"),this.key=this.route.snapshot.paramMap.get("key"),this.title=decodeURIComponent(this.route.snapshot.paramMap.get("title")??""),this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName")}ngOnInit(){this.fetchFor(),this.fetchMetadata(),this.subscription.add(this.refreshOnChildClosedShallow().subscribe(()=>{this.fetchMetadata()}));const e=(0,u.E)([this.metadata$,this.recommendations$]).pipe((0,d.k)(([a,r])=>r.filter(M=>a.filter(A=>A._Type.Id===M.Id).length<M.Count)));this.viewModel$=(0,u.E)([this.metadata$,e,this.itemFor$,this.fabOpen$]).pipe((0,d.k)(([a,r,M,A])=>({metadata:a,recommendations:r,itemFor:M,fabOpen:A})))}ngOnDestroy(){this.metadata$.complete(),this.recommendations$.complete(),this.itemFor$.complete(),this.fabOpen$.complete(),super.ngOnDestroy()}closeDialog(){this.dialogRef.close()}openChange(e){this.fabOpen$.next(e)}createMetadata(e){if(e)return e.Enabled?void(e.CreateEmpty?(this.snackBar.open(`Creating ${e.Name}...`),this.entitiesService.create(e.Id,{For:this.calculateItemFor()}).subscribe({error:()=>{this.snackBar.open(`Creating ${e.Name} failed. Please check console for more info`,void 0,{duration:3e3}),this.fetchMetadata()},next:()=>{this.snackBar.open(`Created ${e.Name}`,void 0,{duration:3e3}),this.fetchMetadata()}})):this.createMetadataForm(e.Id)):void at.C.openDialog(this.dialog,e.MissingFeature,this.viewContainerRef,this.changeDetectorRef);this.dialog.open(ot,{autoFocus:!1,viewContainerRef:this.viewContainerRef,width:"650px"}).afterClosed().subscribe(r=>{null!=r&&this.createMetadataForm(r)})}createMetadataForm(e){const a={items:[{ContentTypeName:e,For:this.calculateItemFor()}]},r=(0,l.K)(a);this.router.navigate([`edit/${r}`],{relativeTo:this.route}),this.changeDetectorRef.markForCheck()}calculateItemFor(){return{Target:Object.values(f._K.metadata).find(a=>a.targetType===this.targetType)?.target??this.targetType.toString(),TargetType:this.targetType,...this.keyType===f._K.keyTypes.guid&&{Guid:this.key},...this.keyType===f._K.keyTypes.number&&{Number:parseInt(this.key,10)},...this.keyType===f._K.keyTypes.string&&{String:this.key}}}fetchFor(){this.contentTypeStaticName&&this.contentItemsService.getAll(this.contentTypeStaticName).subscribe(e=>{const a=e.find(r=>r.Guid===this.key);a?.For&&this.itemFor$.next(a.For)})}fetchMetadata(){this.metadataService.getMetadata(this.targetType,this.keyType,this.key).pipe((0,d.k)(e=>(e.Recommendations.forEach(a=>{a.Icon?.startsWith("base64:")&&(a.Icon=a.Icon.replace("base64:",""),a.Icon=window.atob(a.Icon),a.Icon=a.Icon.replace('fill="#000000"','fill="#ffffff"'))}),e)),(0,E.y)(e=>{this.metadata$.next(e.Items),this.recommendations$.next(e.Recommendations)})).subscribe()}editMetadata(e){const r=(0,l.K)({items:[{EntityId:e.Id}]});this.router.navigate([`edit/${r}`],{relativeTo:this.route})}deleteMetadata(e,a=!1){if(a)this.snackBar.open("Deleting..."),this.entitiesService.delete(e._Type.Id,e.Id,!1).subscribe({next:()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchMetadata()},error:()=>{this.snackBar.open("Delete failed. Please check console for more information",null,{duration:3e3})}});else{const r={entityId:e.Id,entityTitle:e.Title,message:this.recommendations$.value.find(A=>A.Id===e._Type.Id)?.DeleteWarning};this.dialog.open(F,{autoFocus:!1,data:r,viewContainerRef:this.viewContainerRef,width:"400px"}).afterClosed().subscribe(A=>{A&&this.deleteMetadata(e,!0)})}}buildGridOptions(){return{...m.A,columnDefs:[{headerName:"ID",field:"Id",width:70,headerClass:"dense",cellClass:"id-action no-padding no-outline".split(" "),sortable:!0,filter:"agNumberColumnFilter",valueGetter:a=>a.data.Id,cellRenderer:C.q,cellRendererParams:{tooltipGetter:r=>`ID: ${r.Id}\nGUID: ${r.Guid}`}},{field:"Title",flex:2,minWidth:250,cellClass:"primary-action highlight".split(" "),sortable:!0,sort:"asc",filter:"agTextColumnFilter",valueGetter:a=>a.data.Title,onCellClicked:a=>{this.editMetadata(a.data)}},{headerName:"Content Type",field:"ContentType",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:a=>{const r=a.data;return`${r._Type.Name}${r._Type.Title!==r._Type.Name?` (${r._Type.Title})`:""}`},cellRenderer:B},{width:42,cellClass:"secondary-action no-padding".split(" "),pinned:"right",cellRenderer:D,cellRendererParams:{onDelete:r=>this.deleteMetadata(r)}}]}}static#t=this.\u0275fac=function(a){return new(a||i)(t.GI1(L.E5),t.GI1(L.gV),t.GI1(O.yI),t.GI1(h.yM),t.GI1(it.yS),t.GI1(c.q),t.GI1(o.q),t.GI1(O.qW),t.GI1(t.y8U),t.GI1(t.kD9))};static#e=this.\u0275cmp=t.In1({type:i,selectors:[["app-metadata"]],features:[t.eg9],decls:2,vars:3,consts:[["class","eav-dialog nav-component-wrapper"],[1,"eav-dialog","nav-component-wrapper"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"eav-dialog-content","nav-component-wrapper"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","gridOptions"],["align","end"],["mat-fab","","mat-elevation-z24","","class","grid-fab","tippy","Create a new metadata for this item"],["class","eav-eco-fab-speed-dial",3,"ngClass"],["mat-fab","","mat-elevation-z24","","tippy","Create a new metadata for this item",1,"grid-fab",3,"click"],[1,"eav-eco-fab-speed-dial",3,"ngClass","openChange"],[3,"spin"],["mat-fab",""],[1,"spin180"],[1,"eav-eco-fab-speed-dial-actions"],["mat-mini-fab","","label","Other Content Type",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["mat-mini-fab","",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["style","color: white; fill: white;","matBadgeColor","accent","matBadgeSize","small","matBadge","\u{1f48e}","matBadgePosition","below after","aria-hidden","false",3,"innerHTML","matBadgeHidden"],["matBadgeColor","accent","matBadgeSize","small","matBadge","\u{1f48e}","matBadgePosition","below after","aria-hidden","false",2,"color","white","fill","white",3,"innerHTML","matBadgeHidden"],["mat-mini-fab","","class","eav-eco-fab-speed-dial-action-button"]],template:function(a,r){if(1&a&&(t.yuY(0,It,17,7,"div",0),t.wVc(1,"async")),2&a){let M;t.C0Y(0,(M=t.kDX(1,1,r.viewModel$))?0:-1,M)}},dependencies:[Y.QF,L.cP,b.Y,O.Yp,p.um,p.CI,p.uw,x.qL,st.U5,k.Ap,k.eC,k.q_,rt.S,Y.a,P.K],styles:["[_nghost-%COMP%]     .mat-button-wrapper div svg *:not([fill]){fill:#fff}"]})}return i})()},9084:(R,g,n)=>{n.d(g,{o:()=>f});var s=n(4896),u=n(5056),d=n(244);function E(l,O){1&l&&s.C_f(0)}function o(l,O){if(1&l&&(s.I0R(0,"mat-hint"),s.yuY(1,E,1,0,"ng-container",2),s.C$Y()),2&l){s.GaO();const t=s.Gew(4);s.yG2(1),s.E7m("ngTemplateOutlet",t)}}function c(l,O){1&l&&s.C_f(0)}function h(l,O){if(1&l&&(s.I0R(0,"mat-error"),s.yuY(1,c,1,0,"ng-container",2),s.C$Y()),2&l){s.GaO();const t=s.Gew(4);s.yG2(1),s.E7m("ngTemplateOutlet",t)}}function I(l,O){1&l&&s._Xx(0)}const C=l=>({"hint-box__short":l}),m=["*"];let f=(()=>{class l{constructor(){this.isError=!1,this.isShort=!0}toggleIsShort(){this.isShort=!this.isShort}static#t=this.\u0275fac=function(p){return new(p||l)};static#e=this.\u0275cmp=s.In1({type:l,selectors:[["app-field-hint"]],inputs:{isError:"isError"},ngContentSelectors:m,decls:5,vars:4,consts:[[1,"hint-box",3,"ngClass","click"],["content",""],[4,"ngTemplateOutlet"]],template:function(p,v){if(1&p&&(s.kPM(),s.I0R(0,"div",0),s.qCj("click",function(){return v.toggleIsShort()}),s.yuY(1,o,2,1)(2,h,2,1),s.C$Y(),s.yuY(3,I,1,0,"ng-template",null,1,s.gJz)),2&p){let P;s.E7m("ngClass",s.S45(2,C,v.isShort)),s.yG2(1),s.C0Y(1,!1===(P=v.isError)?1:!0===P?2:-1)}},dependencies:[u.QF,u.XV,d.MX,d.wJ],styles:[".hint-box[_ngcontent-%COMP%]{margin-top:4px}.hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{font-size:12px;display:block}.hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]})}return l})()},420:(R,g,n)=>{n.d(g,{M:()=>s});const s="DROPDOWN_INSERT_VALUE"},504:(R,g,n)=>{n.d(g,{c:()=>u});var s=n(4896);let u=(()=>{class d{onClick(o){o.stopPropagation()}static#t=this.\u0275fac=function(c){return new(c||d)};static#e=this.\u0275dir=s.Sc5({type:d,selectors:[["","appClickStopPropagation",""]],hostBindings:function(c,h){1&c&&s.qCj("click",function(C){return h.onClick(C)})}})}return d})()},616:(R,g,n)=>{function s(d){return new Promise((E,o)=>{const c=new FileReader;c.readAsDataURL(d),c.onload=()=>{E(c.result.split(",")[1])},c.onerror=h=>{o(h)}})}function u(d){return new Promise((E,o)=>{const c=new FileReader;c.readAsText(d),c.onload=()=>{E(c.result)},c.onerror=h=>{o(h)}})}n.d(g,{M:()=>u,S:()=>s})}}]);
//# sourceMappingURL=https://sources.2sxc.org/17.01.08/dist/ng-edit/projects_eav-ui_src_app_metadata_metadata_component_ts.5bafe24cb2031c67.js.map