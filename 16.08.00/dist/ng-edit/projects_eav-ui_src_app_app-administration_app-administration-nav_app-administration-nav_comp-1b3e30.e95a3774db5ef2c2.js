"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_app-administration_app-administration-nav_app-administration-nav_comp-1b3e30"],{9596:(pt,O,r)=>{r.r(O),r.d(O,{AppAdministrationNavComponent:()=>Qn});var m=r(91),y=r(8071),I=r(3839),q=r(4520),b=r(9736),L=r(5043),U=r(6041),l=r(196),lt=r(217);const D={App:"App",Site:"Site",Global:"Global"};var dt=r(9731),t=r(1699),k=r(6861),ut=r(40),h=r(9498),d=r(6575),v=r(895),f=r(6515),E=r(989),mt=r(6480);let gt=(()=>{var i;class s{constructor(n){this.sanitizer=n}transform(n){return this.sanitizer.bypassSecurityTrustResourceUrl(n)}}return(i=s).\u0275fac=function(n){return new(n||i)(t.Y36(mt.H7,16))},i.\u0275pipe=t.Yjl({name:"safeResourceUrl",type:i,pure:!0}),s})(),_t=(()=>{var i;class s{constructor(){}ngOnInit(){}}return(i=s).\u0275fac=function(n){return new(n||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-getting-started"]],inputs:{gettingStartedUrl:"gettingStartedUrl"},decls:2,vars:3,consts:[[1,"iframe",3,"src"]],template:function(n,e){1&n&&(t._UZ(0,"iframe",0),t.ALo(1,"safeResourceUrl")),2&n&&t.Q6J("src",t.lcZ(1,1,e.gettingStartedUrl),t.uOi)},dependencies:[gt],styles:[".iframe[_ngcontent-%COMP%]{border:none;width:100%;height:calc(100vh - 209px)}@media (max-width: 600px){.iframe[_ngcontent-%COMP%]{height:calc(100vh - 161px)}}"]}),s})();var ft=r(6253),ht=r(1527),Ct=r(3317),$=r(4323),H=r(7662),z=r(3488),P=r(3955),Q=r(8657),K=r(5253),G=r(6433),X=r(8834),vt=r(237),A=r(2957),Tt=r(5530),bt=r(3188),N=r(257),_=r(8128),M=r(5392);function xt(i,s){if(1&i){const o=t.EpF();t.TgZ(0,"div",9),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.createOrEditMetadata())}),t.TgZ(1,"mat-icon"),t._uU(2,"edit"),t.qZA()()}}function yt(i,s){1&i&&(t.TgZ(0,"div",10)(1,"mat-icon"),t._uU(2,"edit"),t.qZA()())}function At(i,s){if(1&i){const o=t.EpF();t.TgZ(0,"div",11),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.openMetadata())}),t.TgZ(1,"mat-icon",12),t._uU(2," local_offer "),t.qZA()()}if(2&i){const o=t.oxw();t.xp6(1),t.Q6J("matBadge",o.contentType.Metadata.length)("matBadgeHidden",!o.contentType.Metadata.length)}}function Zt(i,s){if(1&i&&(t.TgZ(0,"div",10)(1,"mat-icon",13),t._uU(2," local_offer "),t.qZA()()),2&i){const o=t.oxw();t.xp6(1),t.Q6J("matBadge",o.contentType.Metadata.length)("matBadgeHidden",!o.contentType.Metadata.length)}}function St(i,s){if(1&i){const o=t.EpF();t.TgZ(0,"div",14),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.openPermissions())}),t.TgZ(1,"mat-icon",12),t._uU(2," person"),t.qZA()()}if(2&i){const o=t.oxw();t.xp6(1),t.Q6J("matBadge",o.contentType.Permissions.Count)("matBadgeHidden",!o.contentType.Permissions.Count)}}function wt(i,s){if(1&i&&(t.TgZ(0,"div",10)(1,"mat-icon",13),t._uU(2," person"),t.qZA()()),2&i){const o=t.oxw();t.xp6(1),t.Q6J("matBadge",o.contentType.Permissions.Count)("matBadgeHidden",!o.contentType.Permissions.Count)}}function It(i,s){if(1&i){const o=t.EpF();t.TgZ(0,"button",15),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.editContentType())}),t.TgZ(1,"mat-icon"),t._uU(2,"settings"),t.qZA(),t.TgZ(3,"span"),t._uU(4,"Rename"),t.qZA()(),t.TgZ(5,"button",16),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.openRestApi())}),t._UZ(6,"mat-icon",17),t.TgZ(7,"span"),t._uU(8,"REST API"),t.qZA()(),t.TgZ(9,"button",16),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.exportType())}),t.TgZ(10,"mat-icon"),t._uU(11,"cloud_download"),t.qZA(),t.TgZ(12,"span"),t._uU(13,"Export content type"),t.qZA()(),t.TgZ(14,"button",16),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.openDataExport())}),t.TgZ(15,"mat-icon"),t._uU(16,"cloud_download"),t.qZA(),t.TgZ(17,"span"),t._uU(18,"Export data"),t.qZA()(),t.TgZ(19,"button",16),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.openDataImport())}),t.TgZ(20,"mat-icon"),t._uU(21,"cloud_upload"),t.qZA(),t.TgZ(22,"span"),t._uU(23,"Import data"),t.qZA()(),t.TgZ(24,"button",15),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.deleteContentType())}),t.TgZ(25,"mat-icon"),t._uU(26,"delete"),t.qZA(),t.TgZ(27,"span"),t._uU(28,"Delete"),t.qZA()()}if(2&i){const o=t.oxw();t.Q6J("disabled",o.contentType.EditInfo.DisableRename),t.xp6(24),t.Q6J("disabled",o.contentType.EditInfo.DisableDelete)}}let Ut=(()=>{var i;class s{agInit(n){this.params=n,this.contentType=this.params.data;const e=this.params.enablePermissionsGetter();this.enablePermissions=e&&(0,bt.M)().test(this.contentType.StaticName)}refresh(n){return!0}createOrEditMetadata(){this.params.onCreateOrEditMetadata(this.contentType)}openPermissions(){this.params.onOpenPermissions(this.contentType)}editContentType(){this.params.onEdit(this.contentType)}openMetadata(){this.params.onOpenMetadata(this.contentType)}openRestApi(){this.params.onOpenRestApi(this.contentType)}exportType(){this.params.onTypeExport(this.contentType)}openDataExport(){this.params.onOpenDataExport(this.contentType)}openDataImport(){this.params.onOpenDataImport(this.contentType)}deleteContentType(){this.params.onDelete(this.contentType)}}return(i=s).\u0275fac=function(n){return new(n||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-data-actions"]],decls:13,vars:7,consts:[[1,"actions-component"],["class","eav-grid-action-button highlight","matRipple","","tippy","Description and more",3,"click",4,"ngIf"],["class","eav-grid-action-button disabled",4,"ngIf"],["class","eav-grid-action-button highlight","matRipple","","tippy","Metadata",3,"click",4,"ngIf"],["class","eav-grid-action-button highlight","matRipple","","tippy","Permissions",3,"click",4,"ngIf"],["matRipple","","tippy","More",1,"eav-grid-action-button","highlight",3,"matMenuTriggerFor"],[1,"grid-more-menu"],["menu","matMenu"],["matMenuContent",""],["matRipple","","tippy","Description and more",1,"eav-grid-action-button","highlight",3,"click"],[1,"eav-grid-action-button","disabled"],["matRipple","","tippy","Metadata",1,"eav-grid-action-button","highlight",3,"click"],["matBadgePosition","below after","matBadgeColor","accent","matBadgeSize","small","aria-hidden","false",3,"matBadge","matBadgeHidden"],["matBadgePosition","below after","matBadgeColor","accent","matBadgeSize","small","matBadgeDisabled","true","aria-hidden","false",3,"matBadge","matBadgeHidden"],["matRipple","","tippy","Permissions",1,"eav-grid-action-button","highlight",3,"click"],["mat-menu-item","",3,"disabled","click"],["mat-menu-item","",3,"click"],["svgIcon","code-curly"]],template:function(n,e){if(1&n&&(t.TgZ(0,"div",0),t.YNc(1,xt,3,0,"div",1),t.YNc(2,yt,3,0,"div",2),t.YNc(3,At,3,2,"div",3),t.YNc(4,Zt,3,2,"div",2),t.YNc(5,St,3,2,"div",4),t.YNc(6,wt,3,2,"div",2),t.TgZ(7,"div",5)(8,"mat-icon"),t._uU(9,"more_horiz"),t.qZA()()(),t.TgZ(10,"mat-menu",6,7),t.YNc(12,It,29,2,"ng-template",8),t.qZA()),2&n){const a=t.MAs(11);t.xp6(1),t.Q6J("ngIf",!e.contentType.EditInfo.DisableEdit||e.contentType.Properties),t.xp6(1),t.Q6J("ngIf",e.contentType.EditInfo.DisableEdit&&!e.contentType.Properties),t.xp6(1),t.Q6J("ngIf",!e.contentType.EditInfo.DisableMetadata),t.xp6(1),t.Q6J("ngIf",e.contentType.EditInfo.DisableMetadata),t.xp6(1),t.Q6J("ngIf",!e.contentType.EditInfo.DisableEdit&&e.enablePermissions),t.xp6(1),t.Q6J("ngIf",e.contentType.EditInfo.DisableEdit||!e.enablePermissions),t.xp6(1),t.Q6J("matMenuTriggerFor",a)}},dependencies:[h.$,d.O5,f.Hw,N.wG,_.VK,_.OP,_.KA,_.p6,M.k]}),s})(),kt=(()=>{var i;class s{agInit(n){this.params=n,this.contentType=n.data,this.value=n.value,this.tooltip=this.contentType.EditInfo.ReadOnly?`${this.contentType.EditInfo.ReadOnlyMessage?`${this.contentType.EditInfo.ReadOnlyMessage}\n\n`:""}This ContentType shares the definition of #${this.contentType.SharedDefId} so you can't edit it here. Read 2sxc.org/help?tag=shared-types`:"Edit fields",this.icon=this.contentType.EditInfo.ReadOnly?"share":"dns"}refresh(n){return!0}editFields(){this.params.onEditFields(this.contentType)}}return(i=s).\u0275fac=function(n){return new(n||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-data-fields"]],decls:4,vars:4,consts:[[1,"actions-component"],["matRipple","",1,"eav-grid-action-button","highlight",3,"tippy","click"],["matBadgePosition","below after","matBadgeColor","accent","matBadgeSize","small","aria-hidden","false",3,"matBadge","matBadgeHidden"]],template:function(n,e){1&n&&(t.TgZ(0,"div",0)(1,"div",1),t.NdJ("click",function(){return e.editFields()}),t.TgZ(2,"mat-icon",2),t._uU(3),t.qZA()()()),2&n&&(t.xp6(1),t.Q6J("tippy",e.tooltip),t.xp6(1),t.Q6J("matBadge",e.value)("matBadgeHidden",!e.value),t.xp6(1),t.hij(" ",e.icon," "))},dependencies:[h.$,f.Hw,N.wG,M.k]}),s})(),Nt=(()=>{var i;class s{agInit(n){this.params=n,this.contentType=n.data,this.value=n.value}refresh(n){return!0}showItems(){this.params.onShowItems(this.contentType)}addItem(){this.params.onAddItem(this.contentType)}}return(i=s).\u0275fac=function(n){return new(n||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-data-items"]],decls:7,vars:2,consts:[[1,"actions-component"],["matRipple","",1,"eav-grid-action-button","highlight",3,"tippy","click"],[1,"text-icon"],["matRipple","","tippy","Add item",1,"eav-grid-action-button","highlight",3,"click"]],template:function(n,e){1&n&&(t.TgZ(0,"div",0)(1,"div",1),t.NdJ("click",function(){return e.showItems()}),t.TgZ(2,"div",2),t._uU(3),t.qZA()(),t.TgZ(4,"div",3),t.NdJ("click",function(){return e.addItem()}),t.TgZ(5,"mat-icon"),t._uU(6,"add"),t.qZA()()()),2&n&&(t.xp6(1),t.MGl("tippy","",e.value," items"),t.xp6(2),t.Oqu(e.value))},dependencies:[h.$,f.Hw,N.wG],styles:[".text-icon[_ngcontent-%COMP%]{width:24px;height:24px;font-size:12px;line-height:22px;text-align:center;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;border:1px solid rgba(29,39,61,.44);border-radius:12px;box-sizing:border-box;background-color:#002753;color:#fff;-webkit-user-select:none;user-select:none}.text-icon[_ngcontent-%COMP%]{min-width:24px;width:initial}"]}),s})();var J=r(9409),W=r(2849),B=r(8621),F=r(8849),Jt=r(1268),Mt=r(6355);function Dt(i,s){if(1&i&&(t.TgZ(0,"mat-option",8),t._uU(1),t.qZA()),2&i){const o=s.$implicit;t.Q6J("value",o.value),t.xp6(1),t.hij(" ","Scope: "+o.name," ")}}function Ot(i,s){if(1&i){const o=t.EpF();t.TgZ(0,"button",13),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(2);return t.KtG(e.createGhost())}),t.TgZ(1,"mat-icon",10),t._uU(2,"share"),t.qZA(),t.TgZ(3,"span"),t._uU(4,"Ghost"),t.qZA()()}}function qt(i,s){if(1&i){const o=t.EpF();t.TgZ(0,"div",1)(1,"ag-grid-angular",2),t.NdJ("filesDropped",function(e){t.CHM(o);const a=t.oxw();return t.KtG(a.filesDropped(e))}),t.qZA(),t.TgZ(2,"mat-dialog-actions",3)(3,"div",4)(4,"mat-form-field",5)(5,"mat-select",6),t.NdJ("ngModelChange",function(e){t.CHM(o);const a=t.oxw();return t.KtG(a.changeScope(e))}),t.YNc(6,Dt,2,2,"mat-option",7),t.TgZ(7,"mat-option",8),t._uU(8,"Scope: Other..."),t.qZA()()(),t.TgZ(9,"button",9),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.importType())}),t.TgZ(10,"mat-icon",10),t._uU(11,"cloud_upload"),t.qZA(),t.TgZ(12,"span"),t._uU(13,"Content Type"),t.qZA()(),t.YNc(14,Ot,5,0,"button",11),t.qZA(),t.TgZ(15,"button",12),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.editContentType(null))}),t.TgZ(16,"mat-icon"),t._uU(17,"add"),t.qZA()()()()}if(2&i){const o=s.ngIf,n=t.oxw();t.xp6(1),t.Q6J("rowData",o.contentTypes)("gridOptions",n.gridOptions)("allowedFileTypes","xml,json"),t.xp6(4),t.Q6J("ngModel",o.scope),t.xp6(1),t.Q6J("ngForOf",o.scopeOptions),t.xp6(1),t.Q6J("value",n.dropdownInsertValue),t.xp6(7),t.Q6J("ngIf",o.debugEnabled)}}let Et=(()=>{var i;class s extends U.H{constructor(n,e,a,c,p,u){super(n,e),this.router=n,this.route=e,this.contentTypesService=a,this.globalConfigService=c,this.snackBar=p,this.contentExportService=u,this.contentTypes$=new y.X(void 0),this.scope$=new y.X(void 0),this.scopeOptions$=new y.X([]),this.gridOptions=this.buildGridOptions(),this.dropdownInsertValue=X.G,this.viewModel$=(0,I.a)([this.contentTypes$,this.scope$,this.scopeOptions$,this.globalConfigService.getDebugEnabled$()]).pipe((0,b.U)(([g,x,T,V])=>({contentTypes:g,scope:x,scopeOptions:T,debugEnabled:V})))}ngOnInit(){this.fetchScopes(),this.refreshScopeOnRouteChange(),this.subscription.add(this.refreshOnChildClosedDeep().subscribe(()=>{this.fetchContentTypes()}))}ngOnDestroy(){this.contentTypes$.complete(),this.scope$.complete(),this.scopeOptions$.complete(),super.ngOnDestroy()}filesDropped(n){const e=n[0];switch(e.name.substring(e.name.lastIndexOf(".")+1).toLocaleLowerCase()){case"xml":(0,ft.D)((0,vt.B)(n[0])).pipe((0,ht.q)(1)).subscribe(c=>{const p=c.split('<Entity Type="')[1]?.split('"')[0],u=this.contentTypes$.value.find(g=>g.Name===p);null!=u?this.openDataImport(u,n):this.snackBar.open(`Cannot find Content Type named '${p}'. Please open Content Type Import dialog manually.`,null,{duration:5e3})});break;case"json":this.importType(n)}}importType(n){this.router.navigate(["import"],{relativeTo:this.route.firstChild,state:{files:n}})}showContentItems(n){this.router.navigate([`items/${n.StaticName}`],{relativeTo:this.route.firstChild})}editContentType(n){if(n){if(n.EditInfo.ReadOnly)return;this.router.navigate([`${n.StaticName}/edit`],{relativeTo:this.route.firstChild})}else this.router.navigate(["add"],{relativeTo:this.route.firstChild})}fetchContentTypes(){this.contentTypesService.retrieveContentTypes(this.scope$.value).subscribe(n=>{for(const e of n)e._compareLabel=e.Label.replace(/\p{Emoji}/gu,"\u017e");this.contentTypes$.next(n),this.scope$.value!==l.Zy.scopes.default.value&&this.snackBar.open("Warning! You are in a special scope. Changing things here could easily break functionality",null,{duration:2e3})})}fetchScopes(){this.contentTypesService.getScopes().subscribe(n=>{const e=[...this.scopeOptions$.value];n.forEach(a=>{const c=e.find(p=>p.value===a.value);c?c.name=a.name:e.push(a)}),this.scopeOptions$.next(e)})}createGhost(){const n=window.prompt("To create a ghost content-type enter source static name / id - this is a very advanced operation - read more about it on 2sxc.org/help?tag=ghost");n&&(this.snackBar.open("Saving..."),this.contentTypesService.createGhost(n).subscribe(e=>{this.snackBar.open("Saved",null,{duration:2e3}),this.fetchContentTypes()}))}changeScope(n){n===X.G&&(n=prompt("This is an advanced feature to show content-types of another scope. Don't use this if you don't know what you're doing, as content-types of other scopes are usually hidden for a good reason.")||l.Zy.scopes.default.value),this.router.navigate([`data/${n}`],{relativeTo:this.route})}enablePermissionsGetter(){return this.enablePermissions}addItem(n){const a=(0,A.f)({items:[{ContentTypeName:n.StaticName}]});this.router.navigate([`edit/${a}`],{relativeTo:this.route.firstChild})}editFields(n){this.router.navigate([`fields/${n.StaticName}`],{relativeTo:this.route.firstChild})}createOrEditMetadata(n){const a=(0,A.f)({items:[n.Properties?{EntityId:n.Properties.Id}:{ContentTypeName:l.Zy.contentTypes.contentType,For:{Target:l.Zy.metadata.contentType.target,TargetType:l.Zy.metadata.contentType.targetType,String:n.StaticName},Prefill:{Label:n.Name,Description:n.Description}}]});this.router.navigate([`edit/${a}`],{relativeTo:this.route.firstChild})}openMetadata(n){const e=P.U.getUrlContentType(n.StaticName,`Metadata for Content Type: ${n.Name} (${n.Id})`);this.router.navigate([e],{relativeTo:this.route.firstChild})}openRestApi(n){this.router.navigate([H.i.getUrlData(n)],{relativeTo:this.route.firstChild})}exportType(n){this.contentExportService.exportJson(n.StaticName)}openDataExport(n){this.router.navigate([`export/${n.StaticName}`],{relativeTo:this.route.firstChild})}openDataImport(n,e){this.router.navigate([`${n.StaticName}/import`],{relativeTo:this.route.firstChild,state:{files:e}})}openPermissions(n){this.router.navigate([Q.i.getUrlContentType(n.StaticName)],{relativeTo:this.route.firstChild})}deleteContentType(n){confirm(`Are you sure you want to delete '${n.Name}' (${n.Id})?`)&&(this.snackBar.open("Deleting..."),this.contentTypesService.delete(n).subscribe(e=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchContentTypes()}))}refreshScopeOnRouteChange(){this.subscription.add(this.router.events.pipe((0,q.h)(n=>n instanceof m.m2),(0,b.U)(()=>this.route.snapshot.firstChild.paramMap.get("scope")),(0,L.O)(this.route.snapshot.firstChild.paramMap.get("scope")),(0,q.h)(n=>!!n),(0,Ct.x)()).subscribe(n=>{this.scope$.next(n),this.scopeOptions$.value.map(e=>e.value).includes(n)||this.scopeOptions$.next([...this.scopeOptions$.value,{name:n,value:n}]),this.fetchContentTypes()}))}buildGridOptions(){return{...G.f,columnDefs:[{headerName:"ID",field:"Id",width:70,headerClass:"dense",sortable:!0,filter:"agNumberColumnFilter",cellClass:e=>("id-action no-padding no-outline "+(e.data.EditInfo.ReadOnly?"disabled":"")).split(" "),valueGetter:e=>e.data.Id,cellRenderer:K.m,cellRendererParams:{tooltipGetter:a=>`ID: ${a.Id}\nGUID: ${a.StaticName}`}},{headerName:"Content Type",field:"ContentType",flex:3,minWidth:250,cellClass:"primary-action highlight".split(" "),sortable:!0,sort:"asc",filter:"agTextColumnFilter",onCellClicked:e=>{this.showContentItems(e.data)},valueGetter:e=>e.data.Label,comparator:(e,a,c,p,u)=>c.data._compareLabel.localeCompare(p.data._compareLabel)},{field:"Items",width:102,headerClass:"dense",cellClass:"secondary-action no-padding".split(" "),sortable:!0,filter:"agNumberColumnFilter",valueGetter:e=>e.data.Items,cellRenderer:Nt,cellRendererParams:(()=>({onShowItems:a=>this.showContentItems(a),onAddItem:a=>this.addItem(a)}))()},{field:"Fields",width:94,headerClass:"dense",cellClass:"secondary-action no-padding".split(" "),sortable:!0,filter:"agNumberColumnFilter",valueGetter:e=>e.data.Fields,cellRenderer:kt,cellRendererParams:(()=>({onEditFields:a=>this.editFields(a)}))()},{field:"Name",flex:1,minWidth:100,sortable:!0,filter:"agTextColumnFilter",cellClass:e=>(e.data.EditInfo.DisableEdit?"no-outline":"primary-action highlight").split(" "),valueGetter:e=>e.data.Name,onCellClicked:e=>{this.editContentType(e.data)}},{field:"Description",flex:3,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:e=>e.data.Properties?.Description},{width:162,cellClass:"secondary-action no-padding".split(" "),pinned:"right",cellRenderer:Ut,cellRendererParams:(()=>({enablePermissionsGetter:()=>this.enablePermissionsGetter(),onCreateOrEditMetadata:a=>this.createOrEditMetadata(a),onOpenPermissions:a=>this.openPermissions(a),onEdit:a=>this.editContentType(a),onOpenRestApi:a=>this.openRestApi(a),onOpenMetadata:a=>this.openMetadata(a),onTypeExport:a=>this.exportType(a),onOpenDataExport:a=>this.openDataExport(a),onOpenDataImport:a=>this.openDataImport(a),onDelete:a=>this.deleteContentType(a)}))()}]}}}return(i=s).\u0275fac=function(n){return new(n||i)(t.Y36(m.F0),t.Y36(m.gz),t.Y36(Tt.s),t.Y36(z.bE),t.Y36(J.ux),t.Y36($.i))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-data"]],inputs:{enablePermissions:"enablePermissions"},features:[t.qOj],decls:2,vars:3,consts:[["class","grid-wrapper mat-tab-grid-wrapper",4,"ngIf"],[1,"grid-wrapper","mat-tab-grid-wrapper"],["appDragAndDrop","",1,"ag-theme-material",3,"rowData","gridOptions","allowedFileTypes","filesDropped"],[1,"eav-dialog-actions"],[1,"eav-dialog-actions-div"],["color","accent",1,"eav-form-field","eav-scope-dropdown"],["name","Scope",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["mat-button","","tippy","Import content type",1,"eav-button__with-icon",3,"click"],[1,"eav-icon"],["mat-button","","class","eav-button__with-icon","color","accent","tippy","Create a ghost content type",3,"click",4,"ngIf"],["mat-fab","","mat-elevation-z24","","tippy","Create a new content type",1,"grid-fab",3,"click"],["mat-button","","color","accent","tippy","Create a ghost content type",1,"eav-button__with-icon",3,"click"]],template:function(n,e){1&n&&(t.YNc(0,qt,18,7,"div",0),t.ALo(1,"async")),2&n&&t.Q6J("ngIf",t.lcZ(1,1,e.viewModel$))},dependencies:[W.z,h.$,k.H8,d.sg,d.O5,v.lW,v.cs,f.Hw,B.N8,F.JJ,F.On,Jt.KE,Mt.gD,N.ey,d.Ov],styles:[".eav-scope-dropdown[_ngcontent-%COMP%]{margin-top:-14px;width:200px}.eav-dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.eav-dialog-actions[_ngcontent-%COMP%]   .eav-dialog-actions-div[_ngcontent-%COMP%]{display:flex;justify-content:flex-start}.eav-dialog-actions[_ngcontent-%COMP%]   .eav-button__with-icon[_ngcontent-%COMP%]   .eav-icon[_ngcontent-%COMP%]{font-size:24px;height:24px;width:24px}"]}),s})();var R=r(7356),Pt=r(7749),Z=function(i){return i[i.Edit=0]="Edit",i[i.Metadata=1]="Metadata",i[i.Rest=2]="Rest",i[i.Clone=3]="Clone",i[i.Permissions=4]="Permissions",i[i.Export=5]="Export",i[i.Delete=6]="Delete",i}(Z||{});class Qt{agInit(s){this.params=s,this.item=this.params.data}refresh(s){return!0}}function Gt(i,s){if(1&i){const o=t.EpF();t.TgZ(0,"div",9),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.params.do(e.actions.Metadata,e.item))}),t.TgZ(1,"mat-icon",10),t._uU(2," local_offer "),t.qZA()()}if(2&i){const o=t.oxw();t.xp6(1),t.Q6J("matBadge",null==o.item.Metadata?null:o.item.Metadata.length)("matBadgeHidden",!(null!=o.item.Metadata&&o.item.Metadata.length))}}function Bt(i,s){if(1&i&&(t.TgZ(0,"div",11)(1,"mat-icon",12),t._uU(2," local_offer "),t.qZA()()),2&i){const o=t.oxw();t.xp6(1),t.Q6J("matBadge",null==o.item.Metadata?null:o.item.Metadata.length)("matBadgeHidden",!(null!=o.item.Metadata&&o.item.Metadata.length))}}function Ft(i,s){if(1&i){const o=t.EpF();t.TgZ(0,"div",13),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.params.do(e.actions.Permissions,e.item))}),t.TgZ(1,"mat-icon",10),t._uU(2," person "),t.qZA()()}if(2&i){const o=t.oxw();t.xp6(1),t.Q6J("matBadge",o.item._Permissions.Count)("matBadgeHidden",!o.item._Permissions.Count)}}function Rt(i,s){if(1&i&&(t.TgZ(0,"div",11)(1,"mat-icon",12),t._uU(2," person "),t.qZA()()),2&i){const o=t.oxw();t.xp6(1),t.Q6J("matBadge",o.item._Permissions.Count)("matBadgeHidden",!o.item._Permissions.Count)}}function Yt(i,s){if(1&i){const o=t.EpF();t.TgZ(0,"button",14),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.params.do(e.actions.Rest,e.item))}),t._UZ(1,"mat-icon",15),t.TgZ(2,"span"),t._uU(3,"REST API"),t.qZA()(),t.TgZ(4,"button",14),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.params.do(e.actions.Clone,e.item))}),t.TgZ(5,"mat-icon"),t._uU(6,"file_copy"),t.qZA(),t.TgZ(7,"span"),t._uU(8,"Copy"),t.qZA()(),t.TgZ(9,"button",14),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.params.do(e.actions.Export,e.item))}),t.TgZ(10,"mat-icon"),t._uU(11,"cloud_download"),t.qZA(),t.TgZ(12,"span"),t._uU(13,"Export"),t.qZA()(),t.TgZ(14,"button",16),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.params.do(e.actions.Delete,e.item))}),t.TgZ(15,"mat-icon"),t._uU(16,"delete"),t.qZA(),t.TgZ(17,"span"),t._uU(18,"Delete"),t.qZA()()}if(2&i){const o=t.oxw();t.xp6(14),t.Q6J("disabled",o.item._EditInfo.DisableDelete)}}let Vt=(()=>{var i;class s extends Qt{constructor(){super(...arguments),this.actions=Z}agInit(n){super.agInit(n),this.enablePermissions=this.params.getEnablePermissions()}}return(i=s).\u0275fac=function(){let o;return function(e){return(o||(o=t.n5z(i)))(e||i)}}(),i.\u0275cmp=t.Xpm({type:i,selectors:[["app-queries-actions"]],features:[t.qOj],decls:14,vars:5,consts:[[1,"actions-component"],["matRipple","","tippy","Edit",1,"eav-grid-action-button","highlight",3,"click"],["class","eav-grid-action-button highlight","matRipple","","tippy","Metadata",3,"click",4,"ngIf"],["class","eav-grid-action-button disabled",4,"ngIf"],["class","eav-grid-action-button highlight","matRipple","","tippy","Permissions",3,"click",4,"ngIf"],["matRipple","","tippy","More",1,"eav-grid-action-button","highlight",3,"matMenuTriggerFor"],[1,"grid-more-menu"],["menu","matMenu"],["matMenuContent",""],["matRipple","","tippy","Metadata",1,"eav-grid-action-button","highlight",3,"click"],["matBadgeColor","accent","matBadgeSize","small","matBadgePosition","below after","aria-hidden","false",3,"matBadge","matBadgeHidden"],[1,"eav-grid-action-button","disabled"],["matBadgeColor","accent","matBadgeSize","small","matBadgeDisabled","true","matBadgePosition","below after","aria-hidden","false",3,"matBadge","matBadgeHidden"],["matRipple","","tippy","Permissions",1,"eav-grid-action-button","highlight",3,"click"],["mat-menu-item","",3,"click"],["svgIcon","code-curly"],["mat-menu-item","",3,"disabled","click"]],template:function(n,e){if(1&n&&(t.TgZ(0,"div",0)(1,"div",1),t.NdJ("click",function(){return e.params.do(e.actions.Edit,e.item)}),t.TgZ(2,"mat-icon"),t._uU(3,"edit"),t.qZA()(),t.YNc(4,Gt,3,2,"div",2),t.YNc(5,Bt,3,2,"div",3),t.YNc(6,Ft,3,2,"div",4),t.YNc(7,Rt,3,2,"div",3),t.TgZ(8,"div",5)(9,"mat-icon"),t._uU(10,"more_horiz"),t.qZA()()(),t.TgZ(11,"mat-menu",6,7),t.YNc(13,Yt,19,1,"ng-template",8),t.qZA()),2&n){const a=t.MAs(12);t.xp6(4),t.Q6J("ngIf",!e.item._EditInfo.DisableMetadata),t.xp6(1),t.Q6J("ngIf",e.item._EditInfo.DisableMetadata),t.xp6(1),t.Q6J("ngIf",!e.item._EditInfo.DisableEdit&&e.enablePermissions),t.xp6(1),t.Q6J("ngIf",e.item._EditInfo.DisableEdit||!e.enablePermissions),t.xp6(1),t.Q6J("matMenuTriggerFor",a)}},dependencies:[h.$,d.O5,f.Hw,N.wG,_.VK,_.OP,_.KA,_.p6,M.k],encapsulation:2}),s})();function Ht(i,s){if(1&i){const o=t.EpF();t.TgZ(0,"div",1)(1,"ag-grid-angular",2),t.NdJ("filesDropped",function(e){t.CHM(o);const a=t.oxw();return t.KtG(a.importQuery(e))}),t.qZA(),t.TgZ(2,"mat-dialog-actions",3)(3,"button",4),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.importQuery())}),t.TgZ(4,"mat-icon",5),t._uU(5,"cloud_upload"),t.qZA(),t.TgZ(6,"span"),t._uU(7,"Query"),t.qZA()(),t.TgZ(8,"button",6),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.editQuery(null))}),t.TgZ(9,"mat-icon"),t._uU(10,"add"),t.qZA()()()()}if(2&i){const o=s.ngIf,n=t.oxw();t.xp6(1),t.Q6J("rowData",o.queries)("gridOptions",n.gridOptions)("allowedFileTypes","json")}}let Kt=(()=>{var i;class s extends U.H{constructor(n,e,a,c,p,u){super(n,e),this.router=n,this.route=e,this.pipelinesService=a,this.contentExportService=c,this.snackBar=p,this.dialogService=u,this.queries$=new y.X(void 0),this.gridOptions=this.buildGridOptions(),this.viewModel$=(0,I.a)([this.queries$]).pipe((0,b.U)(([g])=>({queries:g})))}ngOnInit(){this.fetchQueries(),this.subscription.add(this.refreshOnChildClosedDeep().subscribe(()=>{this.fetchQueries()}))}ngOnDestroy(){this.queries$.complete(),super.ngOnDestroy()}fetchQueries(){this.pipelinesService.getAll(l.Zy.contentTypes.query).subscribe(n=>{this.queries$.next(n)})}importQuery(n){this.router.navigate(["import"],{relativeTo:this.route.firstChild,state:{files:n}})}doMenuAction(n,e){switch(n){case Z.Edit:return this.editQuery(e);case Z.Metadata:return this.openMetadata(e);case Z.Rest:return this.router.navigate([H.i.getUrlQuery(e.Guid)],{relativeTo:this.route.firstChild});case Z.Clone:return this.cloneQuery(e);case Z.Permissions:return this.openPermissions(e);case Z.Export:return this.exportQuery(e);case Z.Delete:return this.deleteQuery(e)}}editQuery(n){const a=(0,A.f)({items:[null==n?{ContentTypeName:l.Zy.contentTypes.query,Prefill:{TestParameters:l.Zy.pipelineDesigner.testParameters}}:{EntityId:n.Id}]});this.router.navigate([`edit/${a}`],{relativeTo:this.route.firstChild})}enablePermissionsGetter(){return this.enablePermissions}openVisualQueryDesigner(n){n._EditInfo.ReadOnly||this.dialogService.openQueryDesigner(n.Id)}openMetadata(n){const e=P.U.getUrlEntity(n.Guid,`Metadata for Query: ${n.Name} (${n.Id})`);this.router.navigate([e],{relativeTo:this.route.firstChild})}cloneQuery(n){this.snackBar.open("Copying..."),this.pipelinesService.clonePipeline(n.Id).subscribe(()=>{this.snackBar.open("Copied",null,{duration:2e3}),this.fetchQueries()})}openPermissions(n){this.router.navigate([Q.i.getUrlEntity(n.Guid)],{relativeTo:this.route.firstChild})}exportQuery(n){this.contentExportService.exportEntity(n.Id,"Query",!0)}deleteQuery(n){confirm(`Delete Pipeline '${n.Name}' (${n.Id})?`)&&(this.snackBar.open("Deleting..."),this.pipelinesService.delete(n.Id).subscribe(e=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchQueries()}))}buildGridOptions(){return{...G.f,columnDefs:[{headerName:"ID",field:"Id",width:70,headerClass:"dense",sortable:!0,filter:"agNumberColumnFilter",cellClass:e=>("id-action no-padding no-outline "+(e.data._EditInfo.ReadOnly?"disabled":"")).split(" "),valueGetter:e=>e.data.Id,cellRenderer:K.m,cellRendererParams:{tooltipGetter:a=>`ID: ${a.Id}\nGUID: ${a.Guid}`}},{field:"Name",flex:2,minWidth:250,sortable:!0,sort:"asc",filter:"agTextColumnFilter",cellClass:e=>(e.data._EditInfo.DisableEdit?"no-outline":"primary-action highlight").split(" "),onCellClicked:e=>{this.openVisualQueryDesigner(e.data)},valueGetter:e=>e.data.Name},{field:"Description",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:e=>e.data.Description},{width:162,cellClass:"secondary-action no-padding".split(" "),pinned:"right",cellRenderer:Vt,cellRendererParams:(()=>({getEnablePermissions:()=>this.enablePermissionsGetter(),do:(a,c)=>this.doMenuAction(a,c)}))()}]}}}return(i=s).\u0275fac=function(n){return new(n||i)(t.Y36(m.F0),t.Y36(m.gz),t.Y36(Pt.vG),t.Y36($.i),t.Y36(J.ux),t.Y36(R.x))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-queries"]],inputs:{enablePermissions:"enablePermissions"},features:[t.qOj],decls:2,vars:3,consts:[["class","grid-wrapper mat-tab-grid-wrapper",4,"ngIf"],[1,"grid-wrapper","mat-tab-grid-wrapper"],["appDragAndDrop","",1,"ag-theme-material",3,"rowData","gridOptions","allowedFileTypes","filesDropped"],[1,"eav-dialog-actions"],["mat-button","","tippy","Import query",1,"eav-button__with-icon",3,"click"],[1,"eav-icon"],["mat-fab","","mat-elevation-z24","","tippy","Create a new query",1,"grid-fab",3,"click"]],template:function(n,e){1&n&&(t.YNc(0,Ht,11,3,"div",0),t.ALo(1,"async")),2&n&&t.Q6J("ngIf",t.lcZ(1,1,e.viewModel$))},dependencies:[W.z,h.$,k.H8,d.O5,v.lW,v.cs,f.Hw,B.N8,d.Ov],styles:[".eav-dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.eav-dialog-actions[_ngcontent-%COMP%]   .eav-button__with-icon[_ngcontent-%COMP%]   .eav-icon[_ngcontent-%COMP%]{font-size:24px;height:24px;width:24px}"]}),s})();var j=r(8730),Lt=r(6992);function $t(i,s){if(1&i){const o=t.EpF();t.TgZ(0,"div",9),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.openCode())}),t.TgZ(1,"mat-icon"),t._uU(2,"code"),t.qZA()()}}function zt(i,s){1&i&&(t.TgZ(0,"div",10)(1,"mat-icon"),t._uU(2,"code"),t.qZA()())}function Xt(i,s){if(1&i){const o=t.EpF();t.TgZ(0,"div",11),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.openMetadata())}),t.TgZ(1,"mat-icon",12),t._uU(2," local_offer "),t.qZA()()}if(2&i){const o=t.oxw();t.xp6(1),t.Q6J("matBadge",o.view.Metadata.length)("matBadgeHidden",!o.view.Metadata.length)}}function jt(i,s){if(1&i&&(t.TgZ(0,"div",10)(1,"mat-icon",13),t._uU(2," local_offer "),t.qZA()()),2&i){const o=t.oxw();t.xp6(1),t.Q6J("matBadge",o.view.Metadata.length)("matBadgeHidden",!o.view.Metadata.length)}}function te(i,s){if(1&i){const o=t.EpF();t.TgZ(0,"div",14),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.openPermissions())}),t.TgZ(1,"mat-icon",12),t._uU(2," person "),t.qZA()()}if(2&i){const o=t.oxw();t.xp6(1),t.Q6J("matBadge",o.view.Permissions.Count)("matBadgeHidden",!o.view.Permissions.Count)}}function ee(i,s){if(1&i&&(t.TgZ(0,"div",10)(1,"mat-icon",13),t._uU(2," person "),t.qZA()()),2&i){const o=t.oxw();t.xp6(1),t.Q6J("matBadge",o.view.Permissions.Count)("matBadgeHidden",!o.view.Permissions.Count)}}function ne(i,s){if(1&i){const o=t.EpF();t.TgZ(0,"button",15),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.cloneView())}),t.TgZ(1,"mat-icon"),t._uU(2,"file_copy"),t.qZA(),t.TgZ(3,"span"),t._uU(4,"Copy"),t.qZA()(),t.TgZ(5,"button",15),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.exportView())}),t.TgZ(6,"mat-icon"),t._uU(7,"cloud_download"),t.qZA(),t.TgZ(8,"span"),t._uU(9,"Export"),t.qZA()(),t.TgZ(10,"button",16),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.deleteView())}),t.TgZ(11,"mat-icon"),t._uU(12,"delete"),t.qZA(),t.TgZ(13,"span"),t._uU(14,"Delete"),t.qZA()()}if(2&i){const o=t.oxw();t.xp6(10),t.Q6J("disabled",o.view.EditInfo.DisableDelete)}}let ie=(()=>{var i;class s{agInit(n){this.params=n,this.view=this.params.data,this.enableCode=this.params.enableCodeGetter(),this.enablePermissions=this.params.enablePermissionsGetter()}refresh(n){return!0}openCode(){this.params.onOpenCode(this.view)}openPermissions(){this.params.onOpenPermissions(this.view)}openMetadata(){this.params.onOpenMetadata(this.view)}cloneView(){this.params.onClone(this.view)}exportView(){this.params.onExport(this.view)}deleteView(){this.params.onDelete(this.view)}}return(i=s).\u0275fac=function(n){return new(n||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-views-actions"]],decls:13,vars:7,consts:[[1,"actions-component"],["class","eav-grid-action-button highlight","matRipple","","tippy","Code",3,"click",4,"ngIf"],["class","eav-grid-action-button disabled",4,"ngIf"],["class","eav-grid-action-button highlight","matRipple","","tippy","Metadata",3,"click",4,"ngIf"],["class","eav-grid-action-button highlight","matRipple","","tippy","Permissions",3,"click",4,"ngIf"],["matRipple","","tippy","More",1,"eav-grid-action-button","highlight",3,"matMenuTriggerFor"],[1,"grid-more-menu"],["menu","matMenu"],["matMenuContent",""],["matRipple","","tippy","Code",1,"eav-grid-action-button","highlight",3,"click"],[1,"eav-grid-action-button","disabled"],["matRipple","","tippy","Metadata",1,"eav-grid-action-button","highlight",3,"click"],["matBadgeColor","accent","matBadgeSize","small","matBadgePosition","below after","aria-hidden","false",3,"matBadge","matBadgeHidden"],["matBadgeColor","accent","matBadgeSize","small","matBadgeDisabled","true","matBadgePosition","below after","aria-hidden","false",3,"matBadge","matBadgeHidden"],["matRipple","","tippy","Permissions",1,"eav-grid-action-button","highlight",3,"click"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"disabled","click"]],template:function(n,e){if(1&n&&(t.TgZ(0,"div",0),t.YNc(1,$t,3,0,"div",1),t.YNc(2,zt,3,0,"div",2),t.YNc(3,Xt,3,2,"div",3),t.YNc(4,jt,3,2,"div",2),t.YNc(5,te,3,2,"div",4),t.YNc(6,ee,3,2,"div",2),t.TgZ(7,"div",5)(8,"mat-icon"),t._uU(9,"more_horiz"),t.qZA()()(),t.TgZ(10,"mat-menu",6,7),t.YNc(12,ne,15,1,"ng-template",8),t.qZA()),2&n){const a=t.MAs(11);t.xp6(1),t.Q6J("ngIf",!e.view.EditInfo.DisableEdit&&e.enableCode),t.xp6(1),t.Q6J("ngIf",e.view.EditInfo.DisableEdit||!e.enableCode),t.xp6(1),t.Q6J("ngIf",!e.view.EditInfo.DisableMetadata),t.xp6(1),t.Q6J("ngIf",e.view.EditInfo.DisableMetadata),t.xp6(1),t.Q6J("ngIf",!e.view.EditInfo.DisableEdit&&e.enablePermissions),t.xp6(1),t.Q6J("ngIf",e.view.EditInfo.DisableEdit||!e.enablePermissions),t.xp6(1),t.Q6J("matMenuTriggerFor",a)}},dependencies:[h.$,d.O5,f.Hw,N.wG,_.VK,_.OP,_.KA,_.p6,M.k]}),s})(),oe=(()=>{var i;class s{agInit(n){this.value=n.value}refresh(n){return!0}}return(i=s).\u0275fac=function(n){return new(n||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-views-show"]],decls:3,vars:1,consts:[[1,"icon-container"]],template:function(n,e){1&n&&(t.TgZ(0,"div",0)(1,"mat-icon"),t._uU(2),t.qZA()()),2&n&&(t.xp6(2),t.Oqu(e.value?"visibility":"visibility_off"))},dependencies:[f.Hw]}),s})();function tt(i){let s="",o="";return i.HasQuery?(s="Data (from query)",o="filter_list"):i.List?(s="Items (list)",o="format_list_numbered"):i.ContentType||i.HasQuery?i.List||(s="Item (one)",o="looks_one"):(s="Code",o="check_box_outline_blank"),{value:s,icon:o}}function ae(i,s){1&i&&(t.TgZ(0,"div",3)(1,"mat-icon"),t._uU(2,"share"),t.qZA()())}let se=(()=>{var i;class s{agInit(n){this.value=n.value;const e=n.data,a=tt(e);this.icon=a.icon,this.isShared=e.IsShared}refresh(n){return!0}}return(i=s).\u0275fac=function(n){return new(n||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-views-type"]],decls:5,vars:3,consts:[[1,"icon-container"],[1,"eav-grid-action-button","icon",3,"tippy"],["class","eav-grid-action-button icon","tippy","View is shared",4,"ngIf"],["tippy","View is shared",1,"eav-grid-action-button","icon"]],template:function(n,e){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"mat-icon"),t._uU(3),t.qZA()(),t.YNc(4,ae,3,0,"div",2),t.qZA()),2&n&&(t.xp6(1),t.Q6J("tippy",e.value),t.xp6(2),t.Oqu(e.icon),t.xp6(1),t.Q6J("ngIf",e.isShared))},dependencies:[h.$,d.O5,f.Hw]}),s})();function re(i,s){if(1&i){const o=t.EpF();t.TgZ(0,"div",1)(1,"ag-grid-angular",2),t.NdJ("filesDropped",function(e){t.CHM(o);const a=t.oxw();return t.KtG(a.importView(e))}),t.qZA(),t.TgZ(2,"mat-dialog-actions",3)(3,"div",4)(4,"button",5),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.editPolymorphisms())}),t.TgZ(5,"span",6),t._UZ(6,"img",7),t.TgZ(7,"span"),t._uU(8),t.qZA()()(),t.TgZ(9,"button",8),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.importView())}),t.TgZ(10,"mat-icon",9),t._uU(11,"cloud_upload"),t.qZA(),t.TgZ(12,"span"),t._uU(13,"View"),t.qZA()()(),t.TgZ(14,"button",10),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.editView(null))}),t.TgZ(15,"mat-icon"),t._uU(16,"add"),t.qZA()()()()}if(2&i){const o=s.ngIf,n=t.oxw();t.xp6(1),t.Q6J("rowData",o.views)("gridOptions",n.gridOptions)("allowedFileTypes","json"),t.xp6(3),t.Q6J("disabled",n.appIsInherited),t.xp6(2),t.Q6J("src",n.polymorphLogo,t.LSH),t.xp6(2),t.hij("Polymorphism ",o.polymorphStatus,"")}}let ce=(()=>{var i;class s extends U.H{constructor(n,e,a,c,p){super(n,e),this.router=n,this.route=e,this.viewsService=a,this.snackBar=c,this.dialogService=p,this.views$=new y.X(void 0),this.polymorphStatus$=new y.X(void 0),this.polymorphLogo="data:image/png;base64,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",this.gridOptions=this.buildGridOptions()}ngOnInit(){this.fetchTemplates(),this.fetchPolymorphism(),this.subscription.add(this.refreshOnChildClosedDeep().subscribe(()=>{this.fetchTemplates(),this.fetchPolymorphism()})),this.viewModel$=(0,I.a)([this.views$,this.polymorphStatus$]).pipe((0,b.U)(([n,e])=>({views:n,polymorphStatus:e})))}ngOnDestroy(){this.views$.complete(),this.polymorphStatus$.complete(),super.ngOnDestroy()}importView(n){this.router.navigate(["import"],{relativeTo:this.route.firstChild,state:{files:n}})}fetchTemplates(){this.viewsService.getAll().subscribe(n=>{this.views$.next(n)})}fetchPolymorphism(){this.viewsService.getPolymorphism().subscribe(n=>{this.polymorphism=n,this.polymorphStatus$.next(null===n.Id?"not configured":null===n.Resolver?"disabled":"using "+n.Resolver)})}editView(n){const e={items:[null==n?{ContentTypeName:l.Zy.contentTypes.template,Prefill:{...this.appIsGlobal&&{Location:"Global"}}}:{EntityId:n.Id}]},a=(0,A.f)(e);this.router.navigate([`edit/${a}`],{relativeTo:this.route.firstChild})}editPolymorphisms(){if(!this.polymorphism)return;const e=(0,A.f)({items:[this.polymorphism.Id?{EntityId:this.polymorphism.Id}:{ContentTypeName:this.polymorphism.TypeName}]});this.router.navigate([`edit/${e}`],{relativeTo:this.route.firstChild})}enableCodeGetter(){return this.enableCode}enablePermissionsGetter(){return this.enablePermissions}openUsage(n){this.router.navigate([`usage/${n.Guid}`],{relativeTo:this.route.firstChild})}openCode(n){this.dialogService.openCodeFile(n.TemplatePath,n.IsShared,n.Id)}openPermissions(n){this.router.navigate([Q.i.getUrlEntity(n.Guid)],{relativeTo:this.route.firstChild})}openMetadata(n){const e=P.U.getUrlEntity(n.Guid,`Metadata for View: ${n.Name} (${n.Id})`);this.router.navigate([e],{relativeTo:this.route.firstChild})}cloneView(n){const a=(0,A.f)({items:[{ContentTypeName:l.Zy.contentTypes.template,DuplicateEntity:n.Id}]});this.router.navigate([`edit/${a}`],{relativeTo:this.route.firstChild})}exportView(n){this.viewsService.export(n.Id)}deleteView(n){confirm(`Delete '${n.Name}' (${n.Id})?`)&&(this.snackBar.open("Deleting..."),this.viewsService.delete(n.Id).subscribe(e=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchTemplates()}))}buildGridOptions(){return{...G.f,columnDefs:[{headerName:"ID",field:"Id",width:70,headerClass:"dense",sortable:!0,filter:"agNumberColumnFilter",cellClass:e=>("id-action no-padding no-outline "+(e.data.EditInfo.ReadOnly?"disabled":"")).split(" "),valueGetter:e=>e.data.Id,cellRenderer:K.m,cellRendererParams:{tooltipGetter:a=>`ID: ${a.Id}\nGUID: ${a.Guid}`}},{field:"Show",width:70,headerClass:"dense",cellClass:"no-outline",sortable:!0,filter:j.U,valueGetter:e=>!e.data.IsHidden,cellRenderer:oe},{field:"Name",flex:2,minWidth:250,cellClass:"primary-action highlight".split(" "),sortable:!0,sort:"asc",filter:"agTextColumnFilter",onCellClicked:e=>{this.editView(e.data)},valueGetter:e=>e.data.Name},{field:"Type",width:82,headerClass:"dense",cellClass:"no-padding no-outline".split(" "),sortable:!0,filter:"agTextColumnFilter",valueGetter:e=>tt(e.data).value,cellRenderer:se},{field:"Used",width:70,headerClass:"dense",cellClass:"primary-action highlight".split(" "),sortable:!0,filter:"agNumberColumnFilter",onCellClicked:e=>{this.openUsage(e.data)},valueGetter:e=>e.data.Used},{headerName:"Url Key",field:"UrlKey",flex:1,minWidth:150,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:e=>e.data.ViewNameInUrl},{field:"Path",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:e=>e.data.TemplatePath},{field:"Content",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:e=>e.data.ContentType.Name},{headerName:"Default",field:"ContentDemo",flex:1,minWidth:150,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:e=>{const a=e.data;return`${a.ContentType.DemoId} ${a.ContentType.DemoTitle}`}},{field:"Presentation",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:e=>e.data.PresentationType.Name},{headerName:"Default",field:"PresentationDemo",flex:1,minWidth:150,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:e=>{const a=e.data;return`${a.PresentationType.DemoId} ${a.PresentationType.DemoTitle}`}},{field:"Header",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:e=>e.data.ListContentType.Name},{headerName:"Default",field:"HeaderDemo",flex:1,minWidth:150,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:e=>{const a=e.data;return`${a.ListContentType.DemoId} ${a.ListContentType.DemoTitle}`}},{headerName:"Header Presentation",field:"HeaderPresentation",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:e=>e.data.ListPresentationType.Name},{headerName:"Default",field:"HeaderPresentationDemo",flex:1,minWidth:150,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:e=>{const a=e.data;return`${a.ListPresentationType.DemoId} ${a.ListPresentationType.DemoTitle}`}},{width:162,cellClass:"secondary-action no-padding".split(" "),pinned:"right",cellRenderer:ie,cellRendererParams:(()=>({enableCodeGetter:()=>this.enableCodeGetter(),enablePermissionsGetter:()=>this.enablePermissionsGetter(),onOpenCode:a=>this.openCode(a),onOpenPermissions:a=>this.openPermissions(a),onOpenMetadata:a=>this.openMetadata(a),onClone:a=>this.cloneView(a),onExport:a=>this.exportView(a),onDelete:a=>this.deleteView(a)}))()}]}}}return(i=s).\u0275fac=function(n){return new(n||i)(t.Y36(m.F0),t.Y36(m.gz),t.Y36(Lt.h),t.Y36(J.ux),t.Y36(R.x))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-views"]],inputs:{enableCode:"enableCode",enablePermissions:"enablePermissions",appIsGlobal:"appIsGlobal",appIsInherited:"appIsInherited"},features:[t.qOj],decls:2,vars:3,consts:[["class","grid-wrapper mat-tab-grid-wrapper",4,"ngIf"],[1,"grid-wrapper","mat-tab-grid-wrapper"],["appDragAndDrop","",1,"ag-theme-material",3,"rowData","gridOptions","allowedFileTypes","filesDropped"],[1,"eav-dialog-actions"],[1,"eav-dialog-actions-div"],["mat-button","","tippy","Configure polymorphism",1,"eav-polymorph-button",3,"disabled","click"],[1,"eav-polymorph-button-span"],[1,"eav-polymorph-logo",3,"src"],["mat-button","","tippy","Import view",1,"eav-button__with-icon",3,"click"],[1,"eav-icon"],["mat-fab","","mat-elevation-z24","","tippy","Create a new view",1,"grid-fab",3,"click"]],template:function(n,e){1&n&&(t.YNc(0,re,17,6,"div",0),t.ALo(1,"async")),2&n&&t.Q6J("ngIf",t.lcZ(1,1,e.viewModel$))},dependencies:[W.z,h.$,k.H8,d.O5,v.lW,v.cs,f.Hw,B.N8,d.Ov],styles:[".eav-dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.eav-dialog-actions[_ngcontent-%COMP%]   .eav-dialog-actions-div[_ngcontent-%COMP%]{display:flex;justify-content:flex-start}.eav-dialog-actions[_ngcontent-%COMP%]   .eav-button__with-icon[_ngcontent-%COMP%]   .eav-icon[_ngcontent-%COMP%]{font-size:24px;height:24px;width:24px}.eav-polymorph-button[_ngcontent-%COMP%]   .eav-polymorph-button-span[_ngcontent-%COMP%]{display:flex;align-items:center}.eav-polymorph-logo[_ngcontent-%COMP%]{width:24px;height:24px;margin-right:4px}.eav-polymorph-button[disabled][_ngcontent-%COMP%]   .eav-polymorph-logo[_ngcontent-%COMP%]{opacity:33%;filter:grayscale(1)}"]}),s})();var pe=r(1485),le=r(7220);function de(i,s){if(1&i){const o=t.EpF();t.TgZ(0,"div",7),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.openCode())}),t.TgZ(1,"mat-icon"),t._uU(2,"code"),t.qZA()()}}function ue(i,s){1&i&&(t.TgZ(0,"div",8)(1,"mat-icon"),t._uU(2,"code"),t.qZA()())}function me(i,s){if(1&i){const o=t.EpF();t.TgZ(0,"button",9),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.openRestApi())}),t._UZ(1,"mat-icon",10),t.TgZ(2,"span"),t._uU(3,"REST API"),t.qZA()()}}let ge=(()=>{var i;class s{agInit(n){this.params=n,this.enableCode=this.params.enableCodeGetter()}refresh(n){return!0}openCode(){this.params.onOpenCode(this.params.data)}openRestApi(){this.params.onOpenRestApi(this.params.data)}}return(i=s).\u0275fac=function(n){return new(n||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-web-api-actions"]],decls:9,vars:3,consts:[[1,"actions-component"],["class","eav-grid-action-button highlight","matRipple","","tippy","Code",3,"click",4,"ngIf"],["class","eav-grid-action-button disabled",4,"ngIf"],["matRipple","","tippy","More",1,"eav-grid-action-button","highlight",3,"matMenuTriggerFor"],[1,"grid-more-menu"],["menu","matMenu"],["matMenuContent",""],["matRipple","","tippy","Code",1,"eav-grid-action-button","highlight",3,"click"],[1,"eav-grid-action-button","disabled"],["mat-menu-item","",3,"click"],["svgIcon","code-curly"]],template:function(n,e){if(1&n&&(t.TgZ(0,"div",0),t.YNc(1,de,3,0,"div",1),t.YNc(2,ue,3,0,"div",2),t.TgZ(3,"div",3)(4,"mat-icon"),t._uU(5,"more_horiz"),t.qZA()()(),t.TgZ(6,"mat-menu",4,5),t.YNc(8,me,4,0,"ng-template",6),t.qZA()),2&n){const a=t.MAs(7);t.xp6(1),t.Q6J("ngIf",e.enableCode),t.xp6(1),t.Q6J("ngIf",!e.enableCode),t.xp6(1),t.Q6J("matMenuTriggerFor",a)}},dependencies:[h.$,d.O5,f.Hw,N.wG,_.VK,_.OP,_.KA,_.p6]}),s})();function _e(i,s){1&i&&(t.TgZ(0,"div",2)(1,"mat-icon"),t._uU(2,"share"),t.qZA()())}let fe=(()=>{var i;class s{agInit(n){this.value=n.value}refresh(n){return!0}}return(i=s).\u0275fac=function(n){return new(n||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-web-api-type"]],decls:2,vars:1,consts:[[1,"icon-container"],["class","eav-grid-action-button icon","tippy","WebApi is shared",4,"ngIf"],["tippy","WebApi is shared",1,"eav-grid-action-button","icon"]],template:function(n,e){1&n&&(t.TgZ(0,"div",0),t.YNc(1,_e,3,0,"div",1),t.qZA()),2&n&&(t.xp6(1),t.Q6J("ngIf",e.value))},dependencies:[h.$,d.O5,f.Hw]}),s})();function he(i,s){if(1&i){const o=t.EpF();t.TgZ(0,"div",1),t._UZ(1,"ag-grid-angular",2),t.TgZ(2,"mat-dialog-actions",3)(3,"button",4)(4,"mat-icon"),t._uU(5,"add"),t.qZA()(),t.TgZ(6,"mat-menu",null,5)(8,"button",6),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.createController(!1))}),t.TgZ(9,"span"),t._uU(10,"App"),t.qZA()(),t.TgZ(11,"button",6),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.createController(!0))}),t.TgZ(12,"span"),t._uU(13,"Shared (global)"),t.qZA()()()()()}if(2&i){const o=s.ngIf,n=t.MAs(7),e=t.oxw();t.xp6(1),t.Q6J("rowData",o.webApis)("gridOptions",e.gridOptions),t.xp6(2),t.Q6J("matMenuTriggerFor",n)}}let Ce=(()=>{var i;class s{constructor(n,e,a,c,p,u,g){this.sourceService=n,this.snackBar=e,this.dialogService=a,this.router=c,this.route=p,this.dialog=u,this.viewContainerRef=g,this.webApis$=new y.X(void 0),this.gridOptions=this.buildGridOptions()}ngOnInit(){this.fetchWebApis(),this.viewModel$=(0,I.a)([this.webApis$]).pipe((0,b.U)(([n])=>({webApis:n})))}ngOnDestroy(){this.webApis$.complete()}createController(n){this.dialog.open(le.UH,{autoFocus:!1,data:{folder:"api",global:n,purpose:"Api"},viewContainerRef:this.viewContainerRef,width:"650px"}).afterClosed().subscribe(c=>{if(c){if(c.name.endsWith("Controller.cs")){const p=c.name.substring(c.name.lastIndexOf("/")+1);if(!/^[A-Z][a-zA-Z0-9]*Controller\.cs$/g.test(p))return void this.snackBar.open(`"${p}" is invalid controller name. Should be something like "MyController.cs"`,null,{duration:5e3})}this.snackBar.open("Saving..."),this.sourceService.create(c.name,n,c.templateKey).subscribe(()=>{this.snackBar.open("Saved",null,{duration:2e3}),this.fetchWebApis()})}})}fetchWebApis(){this.sourceService.getWebApis().subscribe(n=>{this.webApis$.next(n)})}enableCodeGetter(){return this.enableCode}openCode(n){this.dialogService.openCodeFile(n.path,n.isShared)}openRestApi(n){this.router.navigate([H.i.getUrlWebApi(n)],{relativeTo:this.route.firstChild})}buildGridOptions(){return{...G.f,columnDefs:[{field:"Folder",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,sort:"asc",filter:"agTextColumnFilter",valueGetter:e=>e.data.folder},{field:"Name",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:e=>e.data.name},{field:"Type",flex:1,minWidth:250,cellClass:"no-outline",sortable:!0,filter:j.U,valueGetter:e=>e.data.isShared,cellRenderer:fe},{width:82,cellClass:"secondary-action no-padding".split(" "),pinned:"right",cellRenderer:ge,cellRendererParams:(()=>({enableCodeGetter:()=>this.enableCodeGetter(),onOpenCode:a=>this.openCode(a),onOpenRestApi:a=>this.openRestApi(a)}))()}]}}}return(i=s).\u0275fac=function(n){return new(n||i)(t.Y36(pe.t),t.Y36(J.ux),t.Y36(R.x),t.Y36(m.F0),t.Y36(m.gz),t.Y36(k.uw),t.Y36(t.s_b))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-web-api"]],inputs:{enableCode:"enableCode"},decls:2,vars:3,consts:[["class","grid-wrapper mat-tab-grid-wrapper",4,"ngIf"],[1,"grid-wrapper","mat-tab-grid-wrapper"],[1,"ag-theme-material",3,"rowData","gridOptions"],["align","end"],["mat-fab","","mat-elevation-z24","","tippy","Create a new controller","tippyPlacement","left",1,"grid-fab",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","",3,"click"]],template:function(n,e){1&n&&(t.YNc(0,he,14,3,"div",0),t.ALo(1,"async")),2&n&&t.Q6J("ngIf",t.lcZ(1,1,e.viewModel$))},dependencies:[h.$,k.H8,d.O5,v.cs,f.Hw,B.N8,_.VK,_.OP,_.p6,d.Ov]}),s})();var et=r(7100),nt=r(2611),ve=r(7648),Te=r(7596),it=r(1217),ot=r(7501),at=r(3379);const be={Settings:"Settings",Resources:"Resources"};var st=r(9877),Y=r(5331),xe=r(8968),C=r(8497),rt=r(9818),ye=r(4472);function Ae(i,s){1&i&&t.GkF(0)}const Se=function(){return{link:"https://docs.2sxc.org/basics/app/configuration.html"}};function we(i,s){if(1&i){const o=t.EpF();t.TgZ(0,"mat-card",2)(1,"mat-card-header",3)(2,"mat-card-title"),t._uU(3,"Configuration"),t.qZA(),t.TgZ(4,"mat-icon"),t._uU(5,"redeem"),t.qZA()(),t.TgZ(6,"mat-card-content"),t._UZ(7,"p"),t.TgZ(8,"div",4)(9,"div",5),t._uU(10,"Name:"),t.qZA(),t.TgZ(11,"div",6)(12,"span",7),t.NdJ("click",function(){const a=t.CHM(o).ngIf,c=t.oxw();return t.KtG(c.copyToClipboard(a.displayName))}),t._uU(13),t.qZA()()(),t.TgZ(14,"div",4)(15,"div",5),t._uU(16,"Folder:"),t.qZA(),t.TgZ(17,"div",6)(18,"span",7),t.NdJ("click",function(){const a=t.CHM(o).ngIf,c=t.oxw();return t.KtG(c.copyToClipboard(a.folder))}),t._uU(19),t.qZA()()(),t.TgZ(20,"div",4)(21,"div",5),t._uU(22,"Version:"),t.qZA(),t.TgZ(23,"div",6)(24,"span",7),t.NdJ("click",function(){const a=t.CHM(o).ngIf,c=t.oxw();return t.KtG(c.copyToClipboard(a.version))}),t._uU(25),t.qZA()()(),t.TgZ(26,"div",4)(27,"div",5),t._uU(28,"For"),t.qZA(),t.TgZ(29,"div",6)(30,"b"),t._uU(31,"2sxc: "),t.qZA(),t.TgZ(32,"span",7),t.NdJ("click",function(){const a=t.CHM(o).ngIf,c=t.oxw();return t.KtG(c.copyToClipboard(a.toSxc))}),t._uU(33),t.qZA(),t.TgZ(34,"b"),t._uU(35," DNN: "),t.qZA(),t.TgZ(36,"span",7),t.NdJ("click",function(){const a=t.CHM(o).ngIf,c=t.oxw();return t.KtG(c.copyToClipboard(a.dnn))}),t._uU(37),t.qZA(),t.TgZ(38,"b"),t._uU(39," Oqt: "),t.qZA(),t.TgZ(40,"span",7),t.NdJ("click",function(){const a=t.CHM(o).ngIf,c=t.oxw();return t.KtG(c.copyToClipboard(a.oqt))}),t._uU(41),t.qZA()()()(),t._UZ(42,"div",8),t.TgZ(43,"mat-card-actions",9),t.YNc(44,Ae,1,0,"ng-container",10),t.TgZ(45,"button",11),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.edit())}),t.TgZ(46,"mat-icon",12),t._uU(47,"edit"),t.qZA(),t.TgZ(48,"span"),t._uU(49,"Edit"),t.qZA()(),t.TgZ(50,"button",11),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.openMetadata())}),t.TgZ(51,"mat-icon",12),t._uU(52,"local_offer"),t.qZA(),t.TgZ(53,"span"),t._uU(54,"Metadata"),t.qZA()()()()}if(2&i){const o=s.ngIf;t.oxw();const n=t.MAs(3);t.xp6(12),t.Q6J("tippy","Click to copy to clipboard"),t.xp6(1),t.Oqu(o.displayName),t.xp6(5),t.Q6J("tippy","Click to copy to clipboard"),t.xp6(1),t.Oqu(o.folder),t.xp6(5),t.Q6J("tippy","Click to copy to clipboard"),t.xp6(1),t.Oqu(o.version),t.xp6(7),t.Q6J("tippy","Click to copy to clipboard"),t.xp6(1),t.hij(" ",o.toSxc," "),t.xp6(3),t.Q6J("tippy","Click to copy to clipboard"),t.xp6(1),t.hij(" ",o.dnn," "),t.xp6(3),t.Q6J("tippy","Click to copy to clipboard"),t.xp6(1),t.hij(" ",o.oqt," "),t.xp6(3),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.DdM(16,Se)),t.xp6(2),t.Q6J("matBadge",o.appConfigurationsCount||null),t.xp6(5),t.Q6J("matBadge",o.appMetadataCount||null)}}function Ie(i,s){if(1&i&&(t.TgZ(0,"a",13)(1,"mat-icon",14),t._uU(2),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.qZA()()),2&i){const o=s.$implicit,n=s.$implicit;let a;t.s9C("href",s.link,t.LSH),t.Q6J("tippy","online documentation"),t.xp6(2),t.Oqu(null!==(a=o)&&void 0!==a?a:"menu_book"),t.xp6(2),t.Oqu(n)}}let Ue=(()=>{var i;class s extends U.H{constructor(n,e,a,c,p,u){super(n,e),this.router=n,this.route=e,this.contentItemsService=a,this.context=c,this.snackBar=p,this.appInternalsService=u,this.appSettingsInternal$=new st.x,this.viewModel$=(0,I.a)([this.appSettingsInternal$,this.contentItemsService.getAll(l.Zy.contentTypes.appConfiguration)]).pipe((0,b.U)(([g,x])=>{const T=x[0];return{appConfigurationsCount:g.EntityLists.ToSxcContentApp.length,appMetadataCount:g.MetadataList.Items.length,displayName:T?.DisplayName??"-",folder:T?.Folder??"-",version:T?.Version??"-",toSxc:T?.RequiredVersion??"-",dnn:T?.RequiredDnnVersion??"-",oqt:T?.RequiredOqtaneVersion??"-"}}))}ngOnInit(){this.fetchSettings(),this.subscription.add(this.refreshOnChildClosedDeep().subscribe(()=>{this.fetchSettings()}))}ngOnDestroy(){this.snackBar.dismiss(),super.ngOnDestroy()}copyToClipboard(n){(0,ye.v)(n),this.snackBar.open("Copied to clipboard",null,{duration:2e3})}edit(){const n=l.Zy.contentTypes.appConfiguration;this.contentItemsService.getAll(n).subscribe(e=>{let a;if(e.length<1)throw new Error(`Found no settings for type ${n}`);if(e.length>1)throw new Error(`Found too many settings for type ${n}`);a={items:[{EntityId:e[0].Id}]};const c=(0,A.f)(a);this.router.navigate([`edit/${c}`],{relativeTo:this.route.firstChild})})}openMetadata(){const n=P.U.getUrlApp(this.context.appId,`Metadata for App: ${this.dialogSettings.Context.App.Name} (${this.context.appId})`);this.router.navigate([n],{relativeTo:this.route.firstChild})}fetchSettings(){this.appInternalsService.getAppInternals(l.Zy.metadata.app.targetType,l.Zy.metadata.app.keyType,this.context.appId).subscribe(e=>{this.appSettingsInternal$.next(e)})}}return(i=s).\u0275fac=function(n){return new(n||i)(t.Y36(m.F0),t.Y36(m.gz),t.Y36(et.l),t.Y36(nt._),t.Y36(J.ux),t.Y36(ot.l))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-app-configuration-card"]],inputs:{dialogSettings:"dialogSettings"},features:[t.qOj],decls:4,vars:3,consts:[["class","eav-card",4,"ngIf"],["docsLink",""],[1,"eav-card"],[1,"eav-card-header"],[1,"eav-info-row"],[1,"eav-info-row__label"],[1,"eav-info-row__value"],[3,"tippy","click"],[1,"eav-card-space-div"],["align","start"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["mat-button","",1,"eav-button__with-icon",3,"click"],["matBadgeColor","accent","matBadgeSize","small","matBadgePosition","below after","aria-hidden","false",1,"eav-icon",3,"matBadge"],["mat-button","","target","_blank",1,"eav-button__with-icon",3,"href","tippy"],[1,"eav-icon"]],template:function(n,e){1&n&&(t.YNc(0,we,55,17,"mat-card",0),t.ALo(1,"async"),t.YNc(2,Ie,5,4,"ng-template",null,1,t.W1O)),2&n&&t.Q6J("ngIf",t.lcZ(1,1,e.viewModel$))},dependencies:[h.$,d.O5,d.tP,v.zs,v.lW,f.Hw,C.a8,C.hq,C.dn,C.dk,C.n5,M.k,d.Ov],styles:[".eav-card-space-div[_ngcontent-%COMP%]{min-height:30px}"]}),s})();function ke(i,s){1&i&&(t.ynx(0),t._uU(1," This is the Global App. Anything configured here will affect all Sites and Apps in this installation. "),t.BQk())}function Ne(i,s){1&i&&(t.ynx(0),t._uU(1," This is the Primary App of this Site. You can also configure sitewide settings and resources here. "),t.BQk())}function Je(i,s){if(1&i&&(t.TgZ(0,"div",22),t.YNc(1,ke,2,0,"ng-container",0),t.YNc(2,Ne,2,0,"ng-container",0),t._uU(3," See "),t.TgZ(4,"a",6),t._uU(5,"docs"),t.qZA(),t._uU(6,". "),t.qZA()),2&i){const o=t.oxw(2);t.xp6(1),t.Q6J("ngIf",o.isGlobal),t.xp6(1),t.Q6J("ngIf",o.isPrimary)}}function Me(i,s){if(1&i){const o=t.EpF();t.ynx(0),t.TgZ(1,"tr")(2,"th"),t._uU(3,"Global"),t.qZA(),t.TgZ(4,"td")(5,"button",23),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(2);return t.KtG(e.edit(e.eavConstants.contentTypes.systemSettings,e.SystemSettingsScopes.App))}),t.TgZ(6,"mat-icon",24),t._uU(7,"edit"),t.qZA()()(),t.TgZ(8,"td")(9,"button",25),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(2);return t.KtG(e.fixContentType(e.eavConstants.contentTypes.customSettings,"edit"))}),t.TgZ(10,"mat-icon",24),t._uU(11,"edit"),t.qZA()(),t.TgZ(12,"button",26),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(2);return t.KtG(e.fixContentType(e.eavConstants.contentTypes.customSettings,"config"))}),t.TgZ(13,"mat-icon",24),t._uU(14,"dns"),t.qZA()()()(),t.BQk()}if(2&i){const o=t.oxw().ngIf;t.xp6(6),t.Q6J("matBadge",o.systemSettingsCount||null),t.xp6(4),t.Q6J("matBadge",o.customSettingsCount||null),t.xp6(3),t.Q6J("matBadge",o.customSettingsFieldsCount||null)}}function De(i,s){1&i&&t.GkF(0)}function Oe(i,s){if(1&i){const o=t.EpF();t.ynx(0),t.TgZ(1,"tr")(2,"th"),t._uU(3,"Site"),t.qZA(),t.TgZ(4,"td")(5,"button",27),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(2);return t.KtG(e.edit(e.eavConstants.contentTypes.systemSettings,e.SystemSettingsScopes.Site))}),t.TgZ(6,"mat-icon",24),t._uU(7,"edit"),t.qZA()()(),t.TgZ(8,"td")(9,"button",28),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(2);return t.KtG(e.fixContentType(e.eavConstants.contentTypes.customSettings,"edit"))}),t.TgZ(10,"mat-icon",24),t._uU(11,"edit"),t.qZA()(),t.TgZ(12,"button",29),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(2);return t.KtG(e.fixContentType(e.eavConstants.contentTypes.customSettings,"config"))}),t.TgZ(13,"mat-icon",24),t._uU(14,"dns"),t.qZA()()()(),t.YNc(15,De,1,0,"ng-container",30),t.BQk()}if(2&i){const o=t.oxw().ngIf,n=t.MAs(66);t.xp6(6),t.Q6J("matBadge",o.systemSettingsCount||null),t.xp6(4),t.Q6J("matBadge",o.customSettingsCount||null),t.xp6(3),t.Q6J("matBadge",o.customSettingsFieldsCount||null),t.xp6(2),t.Q6J("ngTemplateOutlet",n)}}function qe(i,s){1&i&&t.GkF(0)}function Ee(i,s){1&i&&t.GkF(0)}function Pe(i,s){if(1&i){const o=t.EpF();t.ynx(0),t.TgZ(1,"tr")(2,"th"),t._uU(3),t.qZA(),t.TgZ(4,"td")(5,"button",31),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(2);return t.KtG(e.edit(e.eavConstants.contentTypes.systemSettings,e.SystemSettingsScopes.App))}),t.TgZ(6,"mat-icon",24),t._uU(7,"edit"),t.qZA()()(),t.TgZ(8,"td")(9,"button",32),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(2);return t.KtG(e.edit(e.eavConstants.contentTypes.settings))}),t.TgZ(10,"mat-icon",24),t._uU(11,"edit"),t.qZA()(),t.TgZ(12,"button",33),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(2);return t.KtG(e.config(e.eavConstants.contentTypes.settings))}),t.TgZ(13,"mat-icon",24),t._uU(14,"dns"),t.qZA()()()(),t.YNc(15,qe,1,0,"ng-container",30),t.YNc(16,Ee,1,0,"ng-container",30),t.BQk()}if(2&i){const o=t.oxw().ngIf,n=t.MAs(68),e=t.MAs(66),a=t.oxw();t.xp6(3),t.Oqu(a.dialogSettings.Context.App.Name),t.xp6(3),t.Q6J("matBadge",o.systemSettingsCount||null),t.xp6(4),t.Q6J("matBadge",o.customSettingsCount||null),t.xp6(3),t.Q6J("matBadge",o.customSettingsFieldsCount||null),t.xp6(2),t.Q6J("ngTemplateOutlet",n),t.xp6(1),t.Q6J("ngTemplateOutlet",e)}}function Qe(i,s){1&i&&t.GkF(0)}function Ge(i,s){if(1&i){const o=t.EpF();t.ynx(0),t.TgZ(1,"tr")(2,"th"),t._uU(3,"Global"),t.qZA(),t.TgZ(4,"td")(5,"button",34),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(2);return t.KtG(e.edit(e.eavConstants.contentTypes.systemResources,e.SystemSettingsScopes.App))}),t.TgZ(6,"mat-icon",24),t._uU(7,"edit"),t.qZA()()(),t.TgZ(8,"td")(9,"button",35),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(2);return t.KtG(e.fixContentType(e.eavConstants.contentTypes.customResources,"edit"))}),t.TgZ(10,"mat-icon",24),t._uU(11,"edit"),t.qZA()(),t.TgZ(12,"button",36),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(2);return t.KtG(e.fixContentType(e.eavConstants.contentTypes.customResources,"config"))}),t.TgZ(13,"mat-icon",24),t._uU(14,"dns"),t.qZA()()()(),t.BQk()}if(2&i){const o=t.oxw().ngIf;t.xp6(6),t.Q6J("matBadge",o.systemResourcesCount||null),t.xp6(4),t.Q6J("matBadge",o.customResourcesCount||null),t.xp6(3),t.Q6J("matBadge",o.customResourcesFieldsCount||null)}}function Be(i,s){1&i&&t.GkF(0)}function Fe(i,s){if(1&i){const o=t.EpF();t.ynx(0),t.TgZ(1,"tr")(2,"th"),t._uU(3,"Site"),t.qZA(),t.TgZ(4,"td")(5,"button",37),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(2);return t.KtG(e.edit(e.eavConstants.contentTypes.systemResources,e.SystemSettingsScopes.Site))}),t.TgZ(6,"mat-icon",24),t._uU(7,"edit"),t.qZA()()(),t.TgZ(8,"td")(9,"button",38),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(2);return t.KtG(e.fixContentType(e.eavConstants.contentTypes.customResources,"edit"))}),t.TgZ(10,"mat-icon",24),t._uU(11,"edit"),t.qZA()(),t.TgZ(12,"button",39),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(2);return t.KtG(e.fixContentType(e.eavConstants.contentTypes.customResources,"config"))}),t.TgZ(13,"mat-icon",24),t._uU(14,"dns"),t.qZA()()()(),t.YNc(15,Be,1,0,"ng-container",30),t.BQk()}if(2&i){const o=t.oxw().ngIf,n=t.MAs(66);t.xp6(6),t.Q6J("matBadge",o.systemResourcesCount||null),t.xp6(4),t.Q6J("matBadge",o.customResourcesCount||null),t.xp6(3),t.Q6J("matBadge",o.customResourcesFieldsCount||null),t.xp6(2),t.Q6J("ngTemplateOutlet",n)}}function Re(i,s){1&i&&t.GkF(0)}function Ye(i,s){1&i&&t.GkF(0)}function Ve(i,s){if(1&i){const o=t.EpF();t.ynx(0),t.TgZ(1,"tr")(2,"th"),t._uU(3),t.qZA(),t.TgZ(4,"td")(5,"button",40),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(2);return t.KtG(e.edit(e.eavConstants.contentTypes.systemResources,e.SystemSettingsScopes.App))}),t.TgZ(6,"mat-icon",24),t._uU(7,"edit"),t.qZA()()(),t.TgZ(8,"td")(9,"button",41),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(2);return t.KtG(e.edit(e.eavConstants.contentTypes.resources))}),t.TgZ(10,"mat-icon",24),t._uU(11,"edit"),t.qZA()(),t.TgZ(12,"button",42),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(2);return t.KtG(e.config(e.eavConstants.contentTypes.resources))}),t.TgZ(13,"mat-icon",24),t._uU(14,"dns"),t.qZA()()()(),t.YNc(15,Re,1,0,"ng-container",30),t.YNc(16,Ye,1,0,"ng-container",30),t.BQk()}if(2&i){const o=t.oxw().ngIf,n=t.MAs(68),e=t.MAs(66),a=t.oxw();t.xp6(3),t.Oqu(a.dialogSettings.Context.App.Name),t.xp6(3),t.Q6J("matBadge",o.systemResourcesCount||null),t.xp6(4),t.Q6J("matBadge",o.customResourcesCount||null),t.xp6(3),t.Q6J("matBadge",o.customResourcesFieldsCount||null),t.xp6(2),t.Q6J("ngTemplateOutlet",n),t.xp6(1),t.Q6J("ngTemplateOutlet",e)}}function He(i,s){1&i&&t.GkF(0)}function Ke(i,s){if(1&i){const o=t.EpF();t.TgZ(0,"tr")(1,"th"),t._uU(2,"Global"),t.qZA(),t.TgZ(3,"td")(4,"button",43),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(2);return t.KtG(e.openGlobalSettings())}),t.TgZ(5,"mat-icon"),t._uU(6,"open_in_new"),t.qZA()()()()}}function We(i,s){if(1&i){const o=t.EpF();t.TgZ(0,"tr")(1,"th"),t._uU(2,"Site"),t.qZA(),t.TgZ(3,"td")(4,"button",44),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(2);return t.KtG(e.openSiteSettings())}),t.TgZ(5,"mat-icon"),t._uU(6,"open_in_new"),t.qZA()()()()}}function Le(i,s){1&i&&t.GkF(0)}function $e(i,s){1&i&&t.GkF(0)}function ze(i,s){1&i&&t.GkF(0)}function Xe(i,s){1&i&&(t.ynx(0),t._uU(1," (not on Global App) "),t.BQk())}function je(i,s){1&i&&(t.ynx(0),t._uU(1," (not on Content) "),t.BQk())}function tn(i,s){if(1&i&&(t.ynx(0),t.YNc(1,Xe,2,0,"ng-container",0),t.YNc(2,je,2,0,"ng-container",0),t.BQk()),2&i){const o=t.oxw(2);t.xp6(1),t.Q6J("ngIf",o.isGlobal),t.xp6(1),t.Q6J("ngIf",o.isApp)}}function en(i,s){1&i&&t.GkF(0)}const ct=function(){return{link:"https://go.2sxc.org/settings"}},nn=function(){return{link:"https://go.2sxc.org/lightspeed"}},on=function(){return{link:"https://go.2sxc.org/csp"}},an=function(){return{link:"https://docs.2sxc.org/basics/app/permissions.html"}},rn=function(){return{link:"https://patrons.2sxc.org/features/feat/PermissionsByLanguage"}};function cn(i,s){if(1&i){const o=t.EpF();t.ynx(0),t.YNc(1,Je,7,2,"div",2),t.TgZ(2,"div",3)(3,"mat-card",4)(4,"mat-card-header",5)(5,"mat-card-title"),t._uU(6,"Settings"),t.qZA(),t.TgZ(7,"mat-icon"),t._uU(8,"settings"),t.qZA()(),t.TgZ(9,"mat-card-content")(10,"p"),t._uU(11,' Settings are things like SQL-connection strings, default "items-to-show" numbers and similar. If necessary, settings like a link to an RSS-Feed could be different in each language. '),t.TgZ(12,"a",6),t._uU(13,"docs"),t.qZA()(),t.TgZ(14,"table",7)(15,"thead")(16,"tr"),t._UZ(17,"th"),t.TgZ(18,"th"),t._uU(19,"System Settings"),t.qZA(),t.TgZ(20,"th"),t._uU(21,"Custom Settings"),t.qZA()()(),t.TgZ(22,"tbody"),t.YNc(23,Me,15,3,"ng-container",0),t.YNc(24,Oe,16,4,"ng-container",0),t.YNc(25,Pe,17,6,"ng-container",0),t.qZA()()(),t._UZ(26,"div",8),t.TgZ(27,"mat-card-actions",9),t.YNc(28,Qe,1,0,"ng-container",10),t.TgZ(29,"button",11),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.analyze(e.AnalyzeParts.Settings))}),t.TgZ(30,"mat-icon",12),t._uU(31,"manage_search"),t.qZA(),t.TgZ(32,"span"),t._uU(33,"Analyze Combined Settings"),t.qZA()()()(),t.TgZ(34,"mat-card",4)(35,"mat-card-header",5)(36,"mat-card-title"),t._uU(37,"Language Resources (i18n)"),t.qZA(),t.TgZ(38,"mat-icon"),t._uU(39,"translate"),t.qZA()(),t.TgZ(40,"mat-card-content")(41,"p"),t._uU(42," Resources are used for labels and things like that in the App. They are usually needed to create multi-lingual views and such, and should not be used for App-Settings. "),t.TgZ(43,"a",6),t._uU(44,"docs"),t.qZA()(),t.TgZ(45,"table",7)(46,"thead")(47,"tr"),t._UZ(48,"th"),t.TgZ(49,"th"),t._uU(50,"System Resources"),t.qZA(),t.TgZ(51,"th"),t._uU(52,"Custom Resources"),t.qZA()()(),t.TgZ(53,"tbody"),t.YNc(54,Ge,15,3,"ng-container",0),t.YNc(55,Fe,16,4,"ng-container",0),t.YNc(56,Ve,17,6,"ng-container",0),t.qZA()()(),t._UZ(57,"div",8),t.TgZ(58,"mat-card-actions",9),t.YNc(59,He,1,0,"ng-container",10),t.TgZ(60,"button",13),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.analyze(e.AnalyzeParts.Resources))}),t.TgZ(61,"mat-icon",12),t._uU(62,"manage_search"),t.qZA(),t.TgZ(63,"span"),t._uU(64,"Analyze Combined Resources"),t.qZA()()()(),t.YNc(65,Ke,7,0,"ng-template",null,14,t.W1O),t.YNc(67,We,7,0,"ng-template",null,15,t.W1O),t.qZA(),t.TgZ(69,"div",3),t._UZ(70,"app-app-configuration-card",16),t.TgZ(71,"mat-card",4)(72,"mat-card-header",5)(73,"mat-card-title"),t._uU(74,"Performance"),t.qZA(),t.TgZ(75,"mat-icon"),t._uU(76,"bolt"),t.qZA()(),t.TgZ(77,"mat-card-content")(78,"p"),t._uU(79," LightSpeed Output Cache to speed up page by 50-90% "),t.qZA(),t._UZ(80,"app-feature-text-info",17),t.qZA(),t._UZ(81,"div",8),t.TgZ(82,"mat-card-actions",9),t.YNc(83,Le,1,0,"ng-container",10),t.TgZ(84,"button",18),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.openLightSpeed())}),t.TgZ(85,"mat-icon",19),t._uU(86,"bolt"),t.qZA(),t.TgZ(87,"span"),t._uU(88,"Edit LightSpeed"),t.qZA()()()(),t.TgZ(89,"mat-card",4)(90,"mat-card-header",5)(91,"mat-card-title"),t._uU(92,"Security"),t.qZA(),t.TgZ(93,"mat-icon"),t._uU(94,"local_police"),t.qZA()(),t.TgZ(95,"mat-card-content")(96,"p"),t._uU(97," ContentSecurityPolicy (CSP) features in this App - for maximum control. "),t.qZA(),t._UZ(98,"app-feature-text-info",17),t.qZA(),t._UZ(99,"div",8),t.TgZ(100,"mat-card-actions",9),t.YNc(101,$e,1,0,"ng-container",10),t.qZA()(),t.TgZ(102,"mat-card",4)(103,"mat-card-header",5)(104,"mat-card-title"),t._uU(105,"Permissions"),t.qZA(),t.TgZ(106,"mat-icon"),t._uU(107,"person"),t.qZA()(),t.TgZ(108,"mat-card-content")(109,"p"),t._uU(110," Give access to the entire app (all data). Use with care. "),t.qZA()(),t._UZ(111,"div",8),t.TgZ(112,"mat-card-actions",9),t.YNc(113,ze,1,0,"ng-container",10),t.TgZ(114,"button",18),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.openPermissions())}),t.TgZ(115,"mat-icon",19),t._uU(116,"person"),t.qZA(),t.TgZ(117,"span"),t._uU(118," Edit Permissions "),t.YNc(119,tn,3,2,"ng-container",0),t.qZA()(),t.YNc(120,en,1,0,"ng-container",10),t.TgZ(121,"button",20),t.NdJ("click",function(){const a=t.CHM(o).ngIf,c=t.oxw();return t.KtG(c.openLanguagePermissions(a.langPermsEnabled))}),t.TgZ(122,"mat-icon",21),t._uU(123," person "),t.qZA(),t.TgZ(124,"span"),t._uU(125,"Language Permissions"),t.qZA()()()()(),t.BQk()}if(2&i){const o=s.ngIf,n=t.oxw(),e=t.MAs(3);t.xp6(1),t.Q6J("ngIf",n.isGlobal||n.isPrimary),t.xp6(22),t.Q6J("ngIf",n.isGlobal),t.xp6(1),t.Q6J("ngIf",n.isPrimary),t.xp6(1),t.Q6J("ngIf",n.isApp),t.xp6(3),t.Q6J("ngTemplateOutlet",e)("ngTemplateOutletContext",t.DdM(30,ct)),t.xp6(26),t.Q6J("ngIf",n.isGlobal),t.xp6(1),t.Q6J("ngIf",n.isPrimary),t.xp6(1),t.Q6J("ngIf",n.isApp),t.xp6(3),t.Q6J("ngTemplateOutlet",e)("ngTemplateOutletContext",t.DdM(31,ct)),t.xp6(11),t.Q6J("dialogSettings",n.dialogSettings),t.xp6(10),t.Q6J("featureNameId","LightSpeedOutputCache")("asInfo",!0),t.xp6(3),t.Q6J("ngTemplateOutlet",e)("ngTemplateOutletContext",t.DdM(32,nn)),t.xp6(1),t.s9C("disabled",!o.lightSpeedEnabled),t.xp6(1),t.Q6J("matBadge",o.appLightSpeedCount||null),t.xp6(13),t.Q6J("featureNameId","ContentSecurityPolicy")("asInfo",!0),t.xp6(3),t.Q6J("ngTemplateOutlet",e)("ngTemplateOutletContext",t.DdM(33,on)),t.xp6(12),t.Q6J("ngTemplateOutlet",e)("ngTemplateOutletContext",t.DdM(34,an)),t.xp6(1),t.Q6J("disabled",!n.dialogSettings.Context.Enable.AppPermissions),t.xp6(1),t.Q6J("matBadge",n.dialogSettings.Context.App.Permissions.Count||null),t.xp6(4),t.Q6J("ngIf",!n.dialogSettings.Context.Enable.AppPermissions),t.xp6(1),t.Q6J("ngTemplateOutlet",e)("ngTemplateOutletContext",t.DdM(35,rn)),t.xp6(2),t.Q6J("matBadgeHidden",o.langPermsEnabled)}}function pn(i,s){if(1&i&&(t.TgZ(0,"a",45)(1,"mat-icon",12),t._uU(2),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.qZA()()),2&i){const o=s.$implicit,n=s.$implicit;let a;t.s9C("href",s.link,t.LSH),t.Q6J("tippy","online documentation"),t.xp6(2),t.Oqu(null!==(a=o)&&void 0!==a?a:"menu_book"),t.xp6(2),t.Oqu(n)}}let ln=(()=>{var i;class s extends U.H{constructor(n,e,a,c,p,u,g,x,T,V,Gn,Bn,Fn,Rn){super(n,e),this.router=n,this.route=e,this.contentItemsService=a,this.context=c,this.importAppPartsService=p,this.snackBar=u,this.dialogService=g,this.appInternalsService=x,this.contentTypesService=T,this.globalConfigService=V,this.dialog=Bn,this.viewContainerRef=Fn,this.changeDetectorRef=Rn,this.eavConstants=l.Zy,this.AnalyzeParts=be,this.SystemSettingsScopes=l.xB,this.AppScopes=D,this.debugEnabled$=this.globalConfigService.getDebugEnabled$(),this.appSettingsInternal$=new st.x,this.appStateAdvanced=!1,this.features=new ve.k,this.features.loadFromService(Gn),this.viewModel$=(0,I.a)([this.appSettingsInternal$,this.features.isEnabled$(Y.C.LightSpeed),this.features.isEnabled$(Y.C.ContentSecurityPolicy),this.features.isEnabled$(Y.C.PermissionsByLanguage)]).pipe((0,b.U)(([S,Yn,Vn,Hn])=>({lightSpeedEnabled:Yn,cspEnabled:Vn,langPermsEnabled:Hn,appLightSpeedCount:S.MetadataList.Items.filter(w=>w._Type.Name==l.Zy.appMetadata.LightSpeed.ContentTypeName).length,systemSettingsCount:this.isPrimary?S.EntityLists.SettingsSystem.filter(w=>w.SettingsEntityScope===l.xB.Site).length:S.EntityLists.SettingsSystem.filter(w=>!w.SettingsEntityScope).length,customSettingsCount:S.EntityLists.AppSettings?.length,customSettingsFieldsCount:S.FieldAll.AppSettings?.length,systemResourcesCount:this.isPrimary?S.EntityLists.ResourcesSystem.filter(w=>w.SettingsEntityScope===l.xB.Site).length:S.EntityLists.ResourcesSystem.filter(w=>!w.SettingsEntityScope).length,customResourcesCount:S.EntityLists.AppResources?.length,customResourcesFieldsCount:S.FieldAll.AppResources?.length})))}ngOnInit(){this.fetchSettings(),this.subscription.add(this.refreshOnChildClosedDeep().subscribe(()=>{this.fetchSettings()}))}ngOnChanges(n){if(null!=n.dialogSettings){const e=this.dialogSettings.Context.App.SettingsScope;this.isGlobal=e===D.Global,this.isPrimary=e===D.Site,this.isApp=e===D.App}}ngOnDestroy(){this.snackBar.dismiss(),super.ngOnDestroy()}edit(n,e){this.contentItemsService.getAll(n).subscribe(a=>{let c;switch(n){case l.Zy.contentTypes.systemSettings:case l.Zy.contentTypes.systemResources:const u=a.filter(T=>e===l.xB.App?!T.SettingsEntityScope:T.SettingsEntityScope===l.xB.Site);if(u.length>1)throw new Error(`Found too many settings for type ${n}`);const g=u[0];c={items:[null==g?{ContentTypeName:n,Prefill:{...e===l.xB.Site&&{SettingsEntityScope:l.xB.Site}}}:{EntityId:g.Id}]};break;case l.Zy.contentTypes.customSettings:case l.Zy.contentTypes.customResources:if(a.length>1)throw new Error(`Found too many settings for type ${n}`);const x=a[0];c={items:[null==x?{ContentTypeName:n}:{EntityId:x.Id}]};break;default:if(a.length<1)throw new Error(`Found no settings for type ${n}`);if(a.length>1)throw new Error(`Found too many settings for type ${n}`);c={items:[{EntityId:a[0].Id}]}}const p=(0,A.f)(c);this.router.navigate([`edit/${p}`],{relativeTo:this.route.firstChild})})}openLightSpeed(){const n=Te.h.getLightSpeedEditParams(this.context.appId),e=(0,A.f)(n);this.router.navigate([`edit/${e}`],{relativeTo:this.route.firstChild})}openSiteSettings(){const n=this.dialogSettings.Context.Site.PrimaryApp;this.dialogService.openAppAdministration(n.ZoneId,n.AppId,"app")}openGlobalSettings(){const n=this.dialogSettings.Context.System.PrimaryApp;this.dialogService.openAppAdministration(n.ZoneId,n.AppId,"app")}config(n){this.router.navigate([`fields/${n}`],{relativeTo:this.route.firstChild})}openPermissions(){this.router.navigate([Q.i.getUrlApp(this.context.appId)],{relativeTo:this.route.firstChild})}openLanguagePermissions(n){n?this.router.navigate(["language-permissions"],{relativeTo:this.route.firstChild}):xe.B.openDialog(this.dialog,Y.C.PermissionsByLanguage,this.viewContainerRef,this.changeDetectorRef)}analyze(n){this.router.navigate([`analyze/${n}`],{relativeTo:this.route.firstChild})}fetchSettings(){this.appInternalsService.getAppInternals(l.Zy.metadata.app.targetType,l.Zy.metadata.app.keyType,this.context.appId).subscribe(e=>{this.appSettingsInternal$.next(e)})}fixContentType(n,e){this.contentTypesService.retrieveContentTypes(l.Zy.scopes.configuration.value).subscribe(a=>{a.some(p=>p.Name===n)?"edit"===e?this.edit(n):"config"===e&&this.config(n):this.contentTypesService.save({StaticName:"",Name:n,Description:"",Scope:l.Zy.scopes.configuration.value,ChangeStaticName:!1,NewStaticName:""}).subscribe(u=>{u&&("edit"===e?this.edit(n):"config"===e&&this.config(n))})})}}return(i=s).\u0275fac=function(n){return new(n||i)(t.Y36(m.F0),t.Y36(m.gz),t.Y36(et.l),t.Y36(nt._),t.Y36(at.z),t.Y36(J.ux),t.Y36(R.x),t.Y36(ot.l),t.Y36(it.sF),t.Y36(z.bE),t.Y36(it.Kw),t.Y36(k.uw),t.Y36(t.s_b),t.Y36(t.sBO))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-app-configuration"]],inputs:{dialogSettings:"dialogSettings"},features:[t.qOj,t.TTD],decls:4,vars:3,consts:[[4,"ngIf"],["docsLink",""],["class","alert alert-info scope-info",4,"ngIf"],[1,"eav-cards-box"],[1,"eav-card"],[1,"eav-card-header"],["href","https://go.2sxc.org/settings","target","_blank"],[1,"eav-settings-and-resources-table"],[1,"eav-card-space-div"],["align","start"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["mat-button","","tippy","See the result of combining all settings",1,"eav-button__with-icon",3,"click"],[1,"eav-icon"],["mat-button","","tippy","See the result of combining all resources",1,"eav-button__with-icon",3,"click"],["goToGlobal",""],["goToSite",""],[3,"dialogSettings"],[3,"featureNameId","asInfo"],["mat-button","",1,"eav-button__with-icon",3,"disabled","click"],["matBadgeColor","accent","matBadgeSize","small","matBadgePosition","below after","aria-hidden","false",1,"eav-icon",3,"matBadge"],["mat-button","",1,"eav-button__with-icon",3,"click"],["matBadgeSize","small","matBadge","\u{1f48e}","matBadgePosition","below after","aria-hidden","false",1,"eav-icon",3,"matBadgeHidden"],[1,"alert","alert-info","scope-info"],["mat-icon-button","","tippy","Edit global system settings",3,"click"],["matBadgeColor","accent","matBadgeSize","small","matBadgePosition","below after","aria-hidden","false",3,"matBadge"],["mat-icon-button","","tippy","Edit custom global settings",3,"click"],["mat-icon-button","","tippy","Configure fields of the custom global settings",3,"click"],["mat-icon-button","","tippy","Edit site system settings",3,"click"],["mat-icon-button","","tippy","Edit custom site settings",3,"click"],["mat-icon-button","","tippy","Configure fields of the custom site settings",3,"click"],[4,"ngTemplateOutlet"],["mat-icon-button","","tippy","Edit app system settings",3,"click"],["mat-icon-button","","tippy","Edit custom app settings",3,"click"],["mat-icon-button","","tippy","Configure fields of the custom app settings",3,"click"],["mat-icon-button","","tippy","Edit global system resources",3,"click"],["mat-icon-button","","tippy","Edit custom global resources",3,"click"],["mat-icon-button","","tippy","Configure fields of the custom global resources",3,"click"],["mat-icon-button","","tippy","Edit site system resources",3,"click"],["mat-icon-button","","tippy","Edit custom site resources",3,"click"],["mat-icon-button","","tippy","Configure fields of the custom site resources",3,"click"],["mat-icon-button","","tippy","Edit app system resources",3,"click"],["mat-icon-button","","tippy","Edit custom app resources",3,"click"],["mat-icon-button","","tippy","Configure fields of the custom app resources",3,"click"],["mat-icon-button","","tippy","Go to global",3,"click"],["mat-icon-button","","tippy","Go to site",3,"click"],["mat-button","","target","_blank",1,"eav-button__with-icon",3,"href","tippy"]],template:function(n,e){1&n&&(t.YNc(0,cn,126,36,"ng-container",0),t.ALo(1,"async"),t.YNc(2,pn,5,4,"ng-template",null,1,t.W1O)),2&n&&t.Q6J("ngIf",t.lcZ(1,1,e.viewModel$))},dependencies:[h.$,d.O5,d.tP,v.zs,v.lW,v.RK,f.Hw,C.a8,C.hq,C.dn,C.dk,C.n5,M.k,rt.B,Ue,d.Ov],styles:[".eav-settings-and-resources-table[_ngcontent-%COMP%]{width:100%}.eav-settings-and-resources-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-align:center}.eav-settings-and-resources-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:left}"]}),s})();var dn=r(2091),un=r(9293);function mn(i,s){1&i&&(t.TgZ(0,"p"),t._UZ(1,"br"),t._uU(2," In Advanced mode you can also sync all the site files used by this app. They will be placed in a folder inside "),t.TgZ(3,"code"),t._uU(4,"App_Data"),t.qZA(),t._uU(5," and allow sync/restore with git or another server. "),t.qZA())}function gn(i,s){1&i&&t._UZ(0,"app-feature-text-info",11),2&i&&t.Q6J("featureNameId","AppSyncWithSiteFiles")}function _n(i,s){if(1&i){const o=t.EpF();t.ynx(0),t.TgZ(1,"button",5),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.exportAppXml(!1))}),t.TgZ(2,"mat-icon",6),t._uU(3,"more_time"),t.qZA(),t.TgZ(4,"span"),t._uU(5,"Save state"),t.qZA()(),t.TgZ(6,"button",5),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.resetApp(!1))}),t.TgZ(7,"mat-icon",6),t._uU(8,"restore"),t.qZA(),t.TgZ(9,"span"),t._uU(10,"Restore state"),t.qZA()(),t.BQk()}}function fn(i,s){if(1&i){const o=t.EpF();t.ynx(0),t.TgZ(1,"button",5),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.exportAppXml(!0))}),t.TgZ(2,"mat-icon",6),t._uU(3,"more_time"),t.qZA(),t.TgZ(4,"span"),t._uU(5,"Save with Assets"),t.qZA()(),t.TgZ(6,"button",5),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.resetApp(!0))}),t.TgZ(7,"mat-icon",6),t._uU(8,"restore"),t.qZA(),t.TgZ(9,"span"),t._uU(10,"Restore with Assets"),t.qZA()(),t.BQk()}}let hn=(()=>{var i;class s extends U.H{constructor(n,e,a,c,p){super(n,e),this.router=n,this.route=e,this.exportAppService=a,this.importAppPartsService=c,this.snackBar=p,this.appStateAdvanced=!1}ngOnInit(){}ngOnDestroy(){this.snackBar.dismiss(),super.ngOnDestroy()}exportApp(){this.router.navigate(["export"],{relativeTo:this.route.firstChild})}exportParts(){this.router.navigate(["export/parts"],{relativeTo:this.route.firstChild})}importParts(){this.router.navigate(["import/parts"],{relativeTo:this.route.firstChild})}exportAppXml(n){this.snackBar.open("Exporting..."),this.exportAppService.exportForVersionControl({includeContentGroups:!0,resetAppGuid:!1,withFiles:n}).subscribe({next:e=>{this.snackBar.open("Export completed into the 'App_Data' folder.",null,{duration:3e3})},error:e=>{this.snackBar.open("Export failed. Please check console for more information",null,{duration:3e3})}})}resetApp(n){confirm("Are you sure? All changes since last xml export will be lost")&&(this.snackBar.open("Resetting..."),this.importAppPartsService.resetApp(n).subscribe({next:e=>{this.snackBar.open("Reset worked! Since this is a complex operation, please restart the Website to ensure all caches are correct",null,{duration:3e4})},error:e=>{this.snackBar.open("Reset failed. Please check console for more information",null,{duration:3e3})}}))}}return(i=s).\u0275fac=function(n){return new(n||i)(t.Y36(m.F0),t.Y36(m.gz),t.Y36(dn.v),t.Y36(at.z),t.Y36(J.ux))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-sync-configuration"]],inputs:{dialogSettings:"dialogSettings"},features:[t.qOj],decls:73,vars:6,consts:[[1,"eav-cards-box"],[1,"eav-card"],[1,"eav-card-header"],[1,"eav-card-space-div"],["align","start"],["mat-button","",1,"eav-button__with-icon",3,"click"],[1,"eav-icon"],[1,"eav-card-header-title-toggle"],[1,"eav-card-header-toggle",3,"ngModel","ngModelChange"],[4,"ngIf"],[3,"featureNameId",4,"ngIf"],[3,"featureNameId"]],template:function(n,e){1&n&&(t.ynx(0),t.TgZ(1,"div",0)(2,"mat-card",1)(3,"mat-card-header",2)(4,"mat-card-title"),t._uU(5,"Instructions for Sync or Export/Import"),t.qZA(),t.TgZ(6,"mat-icon"),t._uU(7,"info"),t.qZA()(),t.TgZ(8,"mat-card-content")(9,"p"),t._uU(10," This section is for export/import of the entire App, for synchronizing with the file storage (eg. for Git) or to export parts of the App for re-import in another App. "),t.qZA(),t.TgZ(11,"p"),t._uU(12," To export/import Content-Types, Queries, Views or Data, use the respective tabs. "),t.qZA()()()(),t.TgZ(13,"div",0)(14,"mat-card",1)(15,"mat-card-header",2)(16,"mat-card-title"),t._uU(17,"Export this entire App"),t.qZA(),t.TgZ(18,"mat-icon"),t._uU(19,"cloud_download"),t.qZA()(),t.TgZ(20,"mat-card-content")(21,"p"),t._uU(22," Create an package (zip) which can be installed in another site. "),t.qZA()(),t._UZ(23,"div",3),t.TgZ(24,"mat-card-actions",4)(25,"button",5),t.NdJ("click",function(){return e.exportApp()}),t.TgZ(26,"mat-icon",6),t._uU(27,"cloud_download"),t.qZA(),t.TgZ(28,"span"),t._uU(29,"Export App"),t.qZA()()()(),t.TgZ(30,"mat-card",1)(31,"mat-card-header",2)(32,"mat-card-title"),t._uU(33,"Export or Import parts of this App"),t.qZA(),t.TgZ(34,"mat-icon"),t._uU(35,"import_export"),t.qZA()(),t.TgZ(36,"mat-card-content")(37,"p"),t._uU(38," Create an xml containing parts of the app, e.g. content and templates. Import parts from such an xml into this app. "),t.qZA()(),t._UZ(39,"div",3),t.TgZ(40,"mat-card-actions",4)(41,"button",5),t.NdJ("click",function(){return e.exportParts()}),t.TgZ(42,"mat-icon",6),t._uU(43,"cloud_download"),t.qZA(),t.TgZ(44,"span"),t._uU(45,"Export Parts"),t.qZA()(),t.TgZ(46,"button",5),t.NdJ("click",function(){return e.importParts()}),t.TgZ(47,"mat-icon",6),t._uU(48,"cloud_upload"),t.qZA(),t.TgZ(49,"span"),t._uU(50,"Import Parts"),t.qZA()()()()(),t.TgZ(51,"div",0)(52,"mat-card",1)(53,"mat-card-header",2)(54,"div",7)(55,"mat-card-title"),t._uU(56,"App-State Versioning"),t.qZA(),t.TgZ(57,"mat-slide-toggle",8),t.NdJ("ngModelChange",function(c){return e.appStateAdvanced=c}),t._uU(58),t.qZA()(),t.TgZ(59,"mat-icon"),t._uU(60,"history_toggle_off"),t.qZA()(),t.TgZ(61,"mat-card-content")(62,"p"),t._uU(63," You can save / restore the app with data and configuration in "),t.TgZ(64,"code"),t._uU(65,".data/app.xml"),t.qZA(),t._uU(66,". This file can then also be versioned using git. "),t.qZA(),t.YNc(67,mn,6,0,"p",9),t.qZA(),t.YNc(68,gn,1,1,"app-feature-text-info",10),t._UZ(69,"div",3),t.TgZ(70,"mat-card-actions",4),t.YNc(71,_n,11,0,"ng-container",9),t.YNc(72,fn,11,0,"ng-container",9),t.qZA()()(),t.BQk()),2&n&&(t.xp6(57),t.Q6J("ngModel",e.appStateAdvanced),t.xp6(1),t.Oqu(e.appStateAdvanced?"advanced":"basic"),t.xp6(9),t.Q6J("ngIf",e.appStateAdvanced),t.xp6(1),t.Q6J("ngIf",e.appStateAdvanced),t.xp6(3),t.Q6J("ngIf",!e.appStateAdvanced),t.xp6(1),t.Q6J("ngIf",e.appStateAdvanced))},dependencies:[d.O5,v.lW,f.Hw,F.JJ,F.On,C.a8,C.hq,C.dn,C.dk,C.n5,un.Rr,rt.B],styles:[".eav-card-header-title-toggle[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;width:100%;margin-right:8px}.eav-card-header-title-toggle[_ngcontent-%COMP%]   .eav-card-header-toggle[_ngcontent-%COMP%]{margin-left:8px;margin-top:2px}"]}),s})();function Cn(i,s){if(1&i&&t._UZ(0,"img",9),2&i){const o=t.oxw().ngIf;t.Q6J("src",(null==o.dialogSettings?null:o.dialogSettings.Context.App.Icon)+"?w=40&h=40&mode=crop",t.LSH)}}function vn(i,s){1&i&&(t.ynx(0),t._uU(1," Global "),t.BQk())}function Tn(i,s){if(1&i&&(t.ynx(0),t._uU(1),t.BQk()),2&i){const o=t.oxw().ngIf;t.xp6(1),t.hij(" ",null==o.dialogSettings?null:o.dialogSettings.Context.App.Name," ")}}function bn(i,s){1&i&&(t.TgZ(0,"div",20)(1,"mat-icon"),t._uU(2,"info"),t.qZA(),t.TgZ(3,"span"),t._uU(4,"Info"),t.qZA()())}function xn(i,s){if(1&i&&t._UZ(0,"app-getting-started",21),2&i){const o=t.oxw(2).ngIf;t.Q6J("gettingStartedUrl",o.dialogSettings.Context.App.GettingStartedUrl)}}function yn(i,s){1&i&&(t.TgZ(0,"div",22)(1,"mat-icon"),t._uU(2,"menu"),t.qZA(),t.TgZ(3,"span"),t._uU(4,"Data"),t.qZA()())}function An(i,s){if(1&i&&t._UZ(0,"app-data",23),2&i){const o=t.oxw(2).ngIf;t.Q6J("enablePermissions",o.dialogSettings.Context.Enable.AppPermissions)}}function Zn(i,s){1&i&&(t.TgZ(0,"div",25)(1,"mat-icon"),t._uU(2,"filter_list"),t.qZA(),t.TgZ(3,"span"),t._uU(4,"Queries"),t.qZA()())}function Sn(i,s){if(1&i&&t._UZ(0,"app-queries",23),2&i){const o=t.oxw(3).ngIf;t.Q6J("enablePermissions",o.dialogSettings.Context.Enable.AppPermissions)}}function wn(i,s){1&i&&(t.TgZ(0,"mat-tab"),t.YNc(1,Zn,5,0,"div",24),t.YNc(2,Sn,1,1,"app-queries",14),t.qZA())}function In(i,s){1&i&&(t.TgZ(0,"div",26)(1,"mat-icon"),t._uU(2,"layers"),t.qZA(),t.TgZ(3,"span"),t._uU(4,"Views"),t.qZA()())}function Un(i,s){if(1&i&&t._UZ(0,"app-views",27),2&i){const o=t.oxw(2).ngIf;t.Q6J("enableCode",o.dialogSettings.Context.Enable.CodeEditor)("enablePermissions",o.dialogSettings.Context.Enable.AppPermissions)("appIsGlobal",o.dialogSettings.Context.App.IsShared)("appIsInherited",o.dialogSettings.Context.App.IsInherited)}}function kn(i,s){1&i&&(t.TgZ(0,"div",30)(1,"mat-icon"),t._uU(2,"offline_bolt"),t.qZA(),t.TgZ(3,"span"),t._uU(4,"WebApi"),t.qZA()())}function Nn(i,s){if(1&i&&t._UZ(0,"app-web-api",31),2&i){const o=t.oxw(3).ngIf;t.Q6J("enableCode",o.dialogSettings.Context.Enable.CodeEditor)}}function Jn(i,s){1&i&&(t.TgZ(0,"mat-tab"),t.YNc(1,kn,5,0,"div",28),t.YNc(2,Nn,1,1,"app-web-api",29),t.qZA())}function Mn(i,s){1&i&&(t.TgZ(0,"div",32)(1,"mat-icon"),t._uU(2,"settings_applications"),t.qZA(),t.TgZ(3,"span"),t._uU(4,"App"),t.qZA()())}function Dn(i,s){if(1&i&&t._UZ(0,"app-app-configuration",33),2&i){const o=t.oxw(2).ngIf;t.Q6J("dialogSettings",o.dialogSettings)}}function On(i,s){1&i&&(t.TgZ(0,"div",34)(1,"mat-icon"),t._uU(2,"sync"),t.qZA(),t.TgZ(3,"span"),t._uU(4,"Sync"),t.qZA()())}function qn(i,s){if(1&i&&t._UZ(0,"app-sync-configuration",33),2&i){const o=t.oxw(2).ngIf;t.Q6J("dialogSettings",o.dialogSettings)}}function En(i,s){if(1&i){const o=t.EpF();t.TgZ(0,"mat-tab-group",10),t.NdJ("selectedTabChange",function(e){t.CHM(o);const a=t.oxw(2);return t.KtG(a.changeTab(e))}),t.TgZ(1,"mat-tab"),t.YNc(2,bn,5,0,"div",11),t.YNc(3,xn,1,1,"app-getting-started",12),t.qZA(),t.TgZ(4,"mat-tab"),t.YNc(5,yn,5,0,"div",13),t.YNc(6,An,1,1,"app-data",14),t.qZA(),t.YNc(7,wn,3,0,"mat-tab",5),t.TgZ(8,"mat-tab"),t.YNc(9,In,5,0,"div",15),t.YNc(10,Un,1,4,"app-views",16),t.qZA(),t.YNc(11,Jn,3,0,"mat-tab",5),t.TgZ(12,"mat-tab"),t.YNc(13,Mn,5,0,"div",17),t.YNc(14,Dn,1,1,"app-app-configuration",18),t.qZA(),t.TgZ(15,"mat-tab"),t.YNc(16,On,5,0,"div",19),t.YNc(17,qn,1,1,"app-sync-configuration",18),t.qZA()()}if(2&i){const o=t.oxw().ngIf;t.Q6J("selectedIndex",o.tabIndex),t.xp6(7),t.Q6J("ngIf",o.dialogSettings.Context.Enable.Query),t.xp6(4),t.Q6J("ngIf",o.dialogSettings.Context.Enable.Query)}}function Pn(i,s){if(1&i){const o=t.EpF();t.TgZ(0,"div",1)(1,"div",2)(2,"div",3),t.YNc(3,Cn,1,1,"img",4),t.YNc(4,vn,2,0,"ng-container",5),t.YNc(5,Tn,2,1,"ng-container",5),t._uU(6," Admin "),t.qZA(),t.TgZ(7,"button",6),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.closeDialog())}),t.TgZ(8,"mat-icon"),t._uU(9,"close"),t.qZA()()(),t.TgZ(10,"div",7),t._UZ(11,"router-outlet"),t.YNc(12,En,18,3,"mat-tab-group",8),t.qZA()()}if(2&i){const o=s.ngIf,n=t.oxw();t.xp6(3),t.Q6J("ngIf",null==o.dialogSettings?null:o.dialogSettings.Context.App.Icon),t.xp6(1),t.Q6J("ngIf",(null==o.dialogSettings?null:o.dialogSettings.Context.App.SettingsScope)===n.AppScopes.Global),t.xp6(1),t.Q6J("ngIf",(null==o.dialogSettings?null:o.dialogSettings.Context.App.SettingsScope)!==n.AppScopes.Global),t.xp6(7),t.Q6J("ngIf",o.dialogSettings&&null!=o.tabIndex)}}let Qn=(()=>{var i;class s extends U.H{constructor(n,e,a,c){super(n,e),this.router=n,this.route=e,this.dialogRef=a,this.appDialogConfigService=c,this.AppScopes=D,this.dialogSettings$=new y.X(void 0),this.tabs$=new y.X(void 0),this.tabIndex$=(0,I.a)([this.tabs$,this.router.events.pipe((0,q.h)(p=>p instanceof m.m2),(0,b.U)(()=>this.route.snapshot.firstChild.url[0].path),(0,L.O)(this.route.snapshot.firstChild.url[0].path))]).pipe((0,b.U)(([p,u])=>p?.indexOf(u)),(0,q.h)(p=>p>=0)),this.viewModel$=(0,I.a)([this.dialogSettings$,this.tabIndex$]).pipe((0,b.U)(([p,u])=>({dialogSettings:p,tabIndex:u})))}ngOnInit(){this.fetchDialogSettings(),this.subscription.add(this.refreshOnChildClosedDeep().subscribe(()=>{this.fetchDialogSettings()}))}ngOnDestroy(){this.dialogSettings$.complete(),this.tabs$.complete(),super.ngOnDestroy()}closeDialog(){this.dialogRef.close()}changeTab(n){let e=this.tabs$.value[n.index];"data"===e&&(e=`data/${l.Zy.scopes.default.value}`),this.router.navigate([e],{relativeTo:this.route})}fetchDialogSettings(){this.appDialogConfigService.getShared$().subscribe(n=>{(0,lt.X)(n.Context.App),this.dialogSettings$.next(n);let e=["home","data","queries","views","web-api","app","sync"];n.Context.Enable.Query||(e=e.filter(a=>"queries"!==a&&"web-api"!==a)),this.tabs$.next(e)})}}return(i=s).\u0275fac=function(n){return new(n||i)(t.Y36(m.F0),t.Y36(m.gz),t.Y36(k.so),t.Y36(dt.K))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-app-administration-nav"]],features:[t.qOj],decls:2,vars:3,consts:[["class","eav-dialog nav-component-wrapper eav-no-scrollbar","appToggleDebug","",4,"ngIf"],["appToggleDebug","",1,"eav-dialog","nav-component-wrapper","eav-no-scrollbar"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["class","eav-dialog-header__title__image",3,"src",4,"ngIf"],[4,"ngIf"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"eav-dialog-tab-content","nav-component-wrapper"],["class","mat-mdc-tab-group-max-height","dynamicHeight","","color","accent",3,"selectedIndex","selectedTabChange",4,"ngIf"],[1,"eav-dialog-header__title__image",3,"src"],["dynamicHeight","","color","accent",1,"mat-mdc-tab-group-max-height",3,"selectedIndex","selectedTabChange"],["class","mat-mdc-tab-label-box","tippy","App Info",4,"matTabLabel"],[3,"gettingStartedUrl",4,"matTabContent"],["class","mat-mdc-tab-label-box","tippy","Data / Content",4,"matTabLabel"],[3,"enablePermissions",4,"matTabContent"],["class","mat-mdc-tab-label-box","tippy","Views / Templates",4,"matTabLabel"],[3,"enableCode","enablePermissions","appIsGlobal","appIsInherited",4,"matTabContent"],["class","mat-mdc-tab-label-box","tippy","App Settings",4,"matTabLabel"],[3,"dialogSettings",4,"matTabContent"],["class","mat-mdc-tab-label-box","tippy","App Export / Import",4,"matTabLabel"],["tippy","App Info",1,"mat-mdc-tab-label-box"],[3,"gettingStartedUrl"],["tippy","Data / Content",1,"mat-mdc-tab-label-box"],[3,"enablePermissions"],["class","mat-mdc-tab-label-box","tippy","Queries / Visual Query Designer",4,"matTabLabel"],["tippy","Queries / Visual Query Designer",1,"mat-mdc-tab-label-box"],["tippy","Views / Templates",1,"mat-mdc-tab-label-box"],[3,"enableCode","enablePermissions","appIsGlobal","appIsInherited"],["class","mat-mdc-tab-label-box","tippy","WebApi",4,"matTabLabel"],[3,"enableCode",4,"matTabContent"],["tippy","WebApi",1,"mat-mdc-tab-label-box"],[3,"enableCode"],["tippy","App Settings",1,"mat-mdc-tab-label-box"],[3,"dialogSettings"],["tippy","App Export / Import",1,"mat-mdc-tab-label-box"]],template:function(n,e){1&n&&(t.YNc(0,Pn,13,4,"div",0),t.ALo(1,"async")),2&n&&t.Q6J("ngIf",t.lcZ(1,1,e.viewModel$))},dependencies:[m.lC,ut.D,h.$,d.O5,v.RK,f.Hw,E.Vc,E.uD,E.uX,E.SP,_t,Et,Kt,ce,Ce,ln,hn,d.Ov]}),s})()},3188:(pt,O,r)=>{function m(){return/^[a-f0-9]{8}(?:-[a-f0-9]{4}){3}-[a-f0-9]{12}$/i}r.d(O,{M:()=>m})}}]);
//# sourceMappingURL=https://sources.2sxc.org/16.08.00/dist/ng-edit/projects_eav-ui_src_app_app-administration_app-administration-nav_app-administration-nav_comp-1b3e30.e95a3774db5ef2c2.js.map