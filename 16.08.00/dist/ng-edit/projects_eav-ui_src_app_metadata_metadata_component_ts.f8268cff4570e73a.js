"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_metadata_metadata_component_ts","projects_eav-ui_src_app_shared_directives_click-stop-propagation_directive_ts","projects_eav-ui_src_app_app-administration_services_app-dialog-config_service_ts-_86580","projects_eav-ui_src_app_app-administration_services_app-dialog-config_service_ts-_86581"],{9731:(U,I,e)=>{e.d(I,{K:()=>m});var r=e(1650),u=e(9736),d=e(3738),D=e(3488),n=e(2611),l=e(1699),_=e(4860),T=e(6232),M=e(7648);let m=(()=>{var c;class C{constructor(p,f,E,Z,F){this.http=p,this.context=f,this.dnnContext=E,this.globalConfigService=Z,this.dialogSettings$={},F.loadFromService(this)}getShared$(p){return p??=this.context.appId,this.dialogSettings$[p]||(this.dialogSettings$[p]=this.getDialogSettings(p).pipe((0,r.d)({refCount:!1}))),this.dialogSettings$[p]}getDialogSettings(p){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/dialog/settings"),{params:{appId:p??this.context.appId.toString()}}).pipe((0,u.U)(f=>(f.Context.Language.List=f.Context.Language.List.filter(E=>E.IsEnabled),f)),(0,d.b)(f=>{this.globalConfigService.allowDebug(f.Context.Enable.DebugMode)}))}}return(c=C).\u0275fac=function(p){return new(p||c)(l.LFG(_.eN),l.LFG(n._),l.LFG(T._y),l.LFG(D.bE),l.LFG(M.k))},c.\u0275prov=l.Yz7({token:c,factory:c.\u0275fac}),C})()},2369:(U,I,e)=>{e.d(I,{T:()=>l});var r=e(2611),u=e(3379),d=e(1699),D=e(4860),n=e(6232);let l=(()=>{var _;class T{constructor(g,m,c){this.http=g,this.context=m,this.dnnContext=c}getContentInfo(g){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(u.v+"Get"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),scope:g}})}exportParts(g,m,c){const C=this.dnnContext.$2sxc.http.apiUrl(u.v+"Export")+"?appId="+this.context.appId.toString()+"&zoneId="+this.context.zoneId.toString()+"&contentTypeIdsString="+g.join(";")+"&entityIdsString="+m.join(";")+"&templateIdsString="+c.join(";");window.open(C,"_blank","")}}return(_=T).\u0275fac=function(g){return new(g||_)(d.LFG(D.eN),d.LFG(r._),d.LFG(n._y))},_.\u0275prov=d.Yz7({token:_,factory:_.\u0275fac}),T})()},2091:(U,I,e)=>{e.d(I,{v:()=>l});var r=e(4173),u=e(2611),d=e(1699),D=e(4860),n=e(6232);let l=(()=>{var _;class T{constructor(g,m,c){this.http=g,this.context=m,this.dnnContext=c}getAppInfo(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(r.H+"Statistics"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}exportApp(g,m){const c=this.dnnContext.$2sxc.http.apiUrl(r.H+"Export")+"?appId="+this.context.appId+"&zoneId="+this.context.zoneId+"&includeContentGroups="+g+"&resetAppGuid="+m;window.open(c,"_blank","")}exportForVersionControl({includeContentGroups:g,resetAppGuid:m,withFiles:c}){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(r.H+"SaveData"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),includeContentGroups:g.toString(),resetAppGuid:m.toString(),withPortalFiles:c.toString()}})}}return(_=T).\u0275fac=function(g){return new(g||_)(d.LFG(D.eN),d.LFG(u._),d.LFG(n._y))},_.\u0275prov=d.Yz7({token:_,factory:_.\u0275fac}),T})()},3379:(U,I,e)=>{e.d(I,{v:()=>l,z:()=>_});var r=e(4173),u=e(2611),d=e(1699),D=e(4860),n=e(6232);const l="admin/appParts/";let _=(()=>{var T;class M{constructor(m,c,C){this.http=m,this.context=c,this.dnnContext=C}importAppParts(m){const c=new FormData;return c.append("File",m),this.http.post(this.dnnContext.$2sxc.http.apiUrl(l+"Import"),c,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}resetApp(m){return this.http.post(this.dnnContext.$2sxc.http.apiUrl(r.H+"Reset"),{},{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),withPortalFiles:m.toString()}})}}return(T=M).\u0275fac=function(m){return new(m||T)(d.LFG(D.eN),d.LFG(u._),d.LFG(n._y))},T.\u0275prov=d.Yz7({token:T,factory:T.\u0275fac}),M})()},1217:(U,I,e)=>{e.d(I,{Az:()=>l.Az,Kw:()=>r.K,TB:()=>l.TB,bf:()=>l.bf,cv:()=>l.cv,h3:()=>_.h,nt:()=>l.nt,sF:()=>u.s,vG:()=>l.vG});var r=e(9731),u=e(5530),l=(e(2369),e(2091),e(3379),e(7749)),_=e(6992)},7749:(U,I,e)=>{e.d(I,{Az:()=>t,TB:()=>f,bf:()=>E,cv:()=>C,nt:()=>p,vG:()=>Z});var r=e(6253),u=e(1891),d=e(9736),D=e(400),n=e(237),l=e(2611),_=e(1699),T=e(4860),M=e(6232);const C="admin/query/Run",t="admin/query/DebugStream",p="admin/query/Save",f="admin/query/Get",E="admin/query/DataSources";let Z=(()=>{var F;class N{constructor(A,y,P){this.http=A,this.context=y,this.dnnContext=P}getAll(A){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(D.PS),{params:{appId:this.context.appId.toString(),contentType:A}})}importQuery(A){return(0,r.D)((0,n.s)(A)).pipe((0,u.w)(y=>this.http.post(this.dnnContext.$2sxc.http.apiUrl("admin/query/import"),{AppId:this.context.appId.toString(),ContentBase64:y})),(0,d.U)(y=>({Success:y,Messages:[]})))}clonePipeline(A){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/query/Clone"),{params:{Id:A.toString(),appId:this.context.appId.toString()}})}delete(A){return this.http.delete(this.dnnContext.$2sxc.http.apiUrl("admin/query/Delete"),{params:{appId:this.context.appId.toString(),Id:A.toString()}})}}return(F=N).\u0275fac=function(A){return new(A||F)(_.LFG(T.eN),_.LFG(l._),_.LFG(M._y))},F.\u0275prov=_.Yz7({token:F,factory:F.\u0275fac}),N})()},6992:(U,I,e)=>{e.d(I,{h:()=>m});var r=e(2611),u=e(1699),d=e(4860),D=e(6232);const n="admin/view/",l=n+"all",_=n+"delete",T=n+"import",M=n+"polymorphism",g=n+"usage";let m=(()=>{var c;class C{constructor(p,f,E){this.http=p,this.context=f,this.dnnContext=E}getAll(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(l),{params:{appId:this.context.appId.toString()}})}delete(p){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(_),{params:{appId:this.context.appId.toString(),Id:p.toString()}})}import(p){const f=new FormData;return f.append("File",p),this.http.post(this.dnnContext.$2sxc.http.apiUrl(T),f,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}export(p){const f=this.dnnContext.$2sxc.http.apiUrl(n+"json")+"?appId="+this.context.appId+"&viewId="+p;window.open(f,"_blank","")}getPolymorphism(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(M),{params:{appId:this.context.appId.toString()}})}getUsage(p){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(g),{params:{appId:this.context.appId.toString(),guid:p}})}}return(c=C).\u0275fac=function(p){return new(p||c)(u.LFG(d.eN),u.LFG(r._),u.LFG(D._y))},c.\u0275prov=u.Yz7({token:c,factory:c.\u0275fac}),C})()},7100:(U,I,e)=>{e.d(I,{l:()=>m});var r=e(6253),u=e(1891),d=e(9736),D=e(5807),n=e(400),l=e(237),_=e(2611),T=e(1699),M=e(4860),g=e(6232);let m=(()=>{var c;class C{constructor(p,f,E){this.http=p,this.context=f,this.dnnContext=E}getAll(p){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(n.PS),{params:{appId:this.context.appId.toString(),contentType:p}})}getColumns(p){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(D.jt),{params:{appId:this.context.appId.toString(),staticName:p}})}importItem(p){return(0,r.D)((0,l.s)(p)).pipe((0,u.w)(f=>this.http.post(this.dnnContext.$2sxc.http.apiUrl(n.Uo+"upload"),{AppId:this.context.appId.toString(),ContentBase64:f})),(0,d.U)(f=>({Success:f,Messages:[]})))}}return(c=C).\u0275fac=function(p){return new(p||c)(T.LFG(M.eN),T.LFG(_._),T.LFG(g._y))},c.\u0275prov=T.Yz7({token:c,factory:c.\u0275fac}),C})()},8737:(U,I,e)=>{e.d(I,{f:()=>n});var r=e(1699),u=e(4860),d=e(6232);let n=(()=>{var l;class _{constructor(M,g){this.http=M,this.dnnContext=g}getFeatureDetails(M){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/feature/details"),{params:{nameId:M}})}}return(l=_).\u0275fac=function(M){return new(M||l)(r.LFG(u.eN),r.LFG(d._y))},l.\u0275prov=r.Yz7({token:l,factory:l.\u0275fac}),_})()},8968:(U,I,e)=>{e.d(I,{B:()=>A});var r=e(6861),u=e(3839),d=e(9736),D=e(4472),n=e(1699),l=e(9409),_=e(8737),T=e(6575),M=e(895),g=e(6515),m=e(8497),c=e(9498),C=e(6537),t=e(1916);function p(y,P){if(1&y){const O=n.EpF();n.TgZ(0,"div",2)(1,"div",3),n._uU(2,"ID:"),n.qZA(),n.TgZ(3,"div",9)(4,"span",10),n.NdJ("click",function(){const R=n.CHM(O).ngIf,b=n.oxw(2);return n.KtG(b.copyToClipboard(R))}),n._uU(5),n.qZA()()()}if(2&y){const O=P.ngIf;n.xp6(4),n.Q6J("tippy",O),n.xp6(1),n.Oqu(O)}}function f(y,P){if(1&y){const O=n.EpF();n.TgZ(0,"button",11),n.NdJ("click",function(){const R=n.CHM(O).ngIf,b=n.oxw(2);return n.KtG(b.findOutMore(R))}),n.TgZ(1,"mat-icon"),n._uU(2,"open_in_new"),n.qZA(),n._uU(3),n.ALo(4,"translate"),n.qZA()}2&y&&(n.xp6(3),n.hij(" ",n.lcZ(4,1,"Features.FindOutMore")," "))}function E(y,P){if(1&y){const O=n.EpF();n.TgZ(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),n._uU(3),n.qZA()(),n.TgZ(4,"mat-card-content"),n._UZ(5,"p",1),n.ALo(6,"safeHtml"),n.TgZ(7,"div",2)(8,"div",3),n._uU(9),n.ALo(10,"translate"),n.qZA(),n.TgZ(11,"div",4)(12,"span"),n._uU(13),n.ALo(14,"translate"),n.qZA()()(),n.YNc(15,p,6,2,"div",5),n.qZA(),n.TgZ(16,"mat-card-actions",6),n.YNc(17,f,5,3,"button",7),n.TgZ(18,"button",8),n.NdJ("click",function(){n.CHM(O);const S=n.oxw();return n.KtG(S.closeDialog())}),n._uU(19),n.ALo(20,"translate"),n.qZA()()()}if(2&y){const O=P.ngIf;n.xp6(3),n.Oqu(O.feature.Name),n.xp6(2),n.Q6J("innerHtml",n.lcZ(6,7,O.feature.Description),n.oJD),n.xp6(4),n.hij("",n.lcZ(10,9,"Features.Status"),":"),n.xp6(4),n.Oqu(n.lcZ(14,11,O.feature.Enabled?"Features.Active":"Features.NotActive")),n.xp6(2),n.Q6J("ngIf",O.feature.NameId),n.xp6(2),n.Q6J("ngIf",O.feature.Link),n.xp6(2),n.hij(" ",n.lcZ(20,13,"Features.Close")," ")}}let Z=(()=>{var y;class P{constructor(x,S,R,b){this.dialogData=x,this.dialogRef=S,this.snackBar=R,this.featureDetailService=b}ngOnInit(){this.viewModel$=(0,u.a)([this.featureDetailService.getFeatureDetails(this.dialogData)]).pipe((0,d.U)(([x])=>({feature:x})))}copyToClipboard(x){(0,D.v)(x),this.snackBar.open("Copied to clipboard",null,{duration:2e3})}findOutMore(x){window.open(x,"_blank")}closeDialog(){this.dialogRef.close()}}return(y=P).\u0275fac=function(x){return new(x||y)(n.Y36(r.WI),n.Y36(r.so),n.Y36(l.ux),n.Y36(_.f))},y.\u0275cmp=n.Xpm({type:y,selectors:[["app-feature-info-dialog"]],decls:2,vars:3,consts:[[4,"ngIf"],[3,"innerHtml"],[1,"eav-info-row"],[1,"eav-info-row__label"],[1,"eav-info-row__value"],["class","eav-info-row",4,"ngIf"],["align","end"],["mat-raised-button","","color","accent","class","eav-card-action-button",3,"click",4,"ngIf"],["mat-raised-button","",1,"eav-card-action-button",3,"click"],[1,"eav-info-row__value","eav_click"],[3,"tippy","click"],["mat-raised-button","","color","accent",1,"eav-card-action-button",3,"click"]],template:function(x,S){1&x&&(n.YNc(0,E,21,15,"mat-card",0),n.ALo(1,"async")),2&x&&n.Q6J("ngIf",n.lcZ(1,1,S.viewModel$))},dependencies:[T.O5,M.lW,g.Hw,m.a8,m.hq,m.dn,m.dk,m.n5,c.$,T.Ov,C.z,t.X$]}),P})();var F=e(8071),N=e(1891),$=e(7648);let A=(()=>{var y;class P{set featureNameId(x){this.featureNameId$.next(x)}set showIf(x){this.showIf$.next(1==x)}constructor(x,S,R,b){this.dialog=x,this.viewContainerRef=S,this.changeDetectorRef=R,this.featuresService=b,this.featureNameId$=new F.X(null),this.showIf$=new F.X(!1),this.feature$=this.featureNameId$.pipe((0,N.w)(K=>this.featuresService.get$(K))),this.show$=(0,u.a)([this.feature$,this.showIf$]).pipe((0,d.U)(([K,W])=>W==(K?.Enabled??!1)))}openDialog(){P.openDialog(this.dialog,this.featureNameId$.value,this.viewContainerRef,this.changeDetectorRef)}static openDialog(x,S,R,b){x.open(Z,{autoFocus:!1,data:S,viewContainerRef:R,width:"400px"}),b.markForCheck()}}return(y=P).\u0275fac=function(x){return new(x||y)(n.Y36(r.uw),n.Y36(n.s_b),n.Y36(n.sBO),n.Y36($.k))},y.\u0275dir=n.lG2({type:y,inputs:{featureNameId:"featureNameId",showIf:"showIf"}}),P})()},4173:(U,I,e)=>{e.d(I,{H:()=>T,a:()=>M});var r=e(1891),u=e(4980),d=e(7503),D=e(2611),n=e(1699),l=e(4860),_=e(6232);const T="admin/app/";let M=(()=>{var g;class m{constructor(C,t,p){this.http=C,this.context=t,this.dnnContext=p}importApp(C,t,p=!1){const f=new FormData;return f.append("File",C),f.append("Name",t??""),this.http.post(this.dnnContext.$2sxc.http.apiUrl(T+"Import"),f,{params:{zoneId:this.context.zoneId.toString()}}).pipe((0,r.w)(E=>{if(p&&E.Messages[0]?.MessageType===d.DS.Warning){const Z=prompt(E.Messages[0].Text+" Would you like to install it using another folder name?");if(Z)return this.importApp(C,Z,!0)}return(0,u.of)(E)}))}}return(g=m).\u0275fac=function(C){return new(C||g)(n.LFG(l.eN),n.LFG(D._),n.LFG(_._y))},g.\u0275prov=n.Yz7({token:g,factory:g.\u0275fac}),m})()},2023:(U,I,e)=>{e.r(I),e.d(I,{MetadataComponent:()=>It});var r=e(8071),u=e(3839),d=e(9736),D=e(3738),n=e(7100),l=e(1092),_=e(8088),T=e(6041),M=e(5253),g=e(6433),m=e(196),c=e(2957),C=e(6861),t=e(1699),p=e(6575),f=e(895),E=e(8497),Z=e(6537);function F(o,v){if(1&o&&(t._UZ(0,"mat-card-subtitle",3),t.ALo(1,"safeHtml")),2&o){const i=t.oxw();t.Q6J("innerHtml",t.lcZ(1,1,i.dialogData.message),t.oJD)}}let N=(()=>{var o;class v{constructor(a,s){this.dialogData=a,this.dialogRef=s,this.hostClass="dialog-component"}closeDialog(a){this.dialogRef.close(a)}}return(o=v).\u0275fac=function(a){return new(a||o)(t.Y36(C.WI),t.Y36(C.so))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-confirm-delete-dialog"]],hostVars:1,hostBindings:function(a,s){2&a&&t.Ikx("className",s.hostClass)},decls:10,vars:3,consts:[[3,"innerHtml",4,"ngIf"],["align","end"],["mat-raised-button","",1,"eav-card-action-button",3,"click"],[3,"innerHtml"]],template:function(a,s){1&a&&(t.TgZ(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),t._uU(3),t.qZA(),t.YNc(4,F,2,3,"mat-card-subtitle",0),t.qZA(),t.TgZ(5,"mat-card-actions",1)(6,"button",2),t.NdJ("click",function(){return s.closeDialog()}),t._uU(7,"Cancel"),t.qZA(),t.TgZ(8,"button",2),t.NdJ("click",function(){return s.closeDialog(!0)}),t._uU(9,"Delete"),t.qZA()()()),2&a&&(t.xp6(3),t.AsE("Delete ",s.dialogData.entityTitle," (",s.dialogData.entityId,")?"),t.xp6(1),t.Q6J("ngIf",s.dialogData.message))},dependencies:[p.O5,f.lW,E.a8,E.hq,E.dk,E.$j,E.n5,Z.z],styles:[".eav-card-action-button[_ngcontent-%COMP%]{margin-left:8px}"]}),v})();var $=e(9498),A=e(6515),y=e(257);let P=(()=>{var o;class v{agInit(a){this.params=a}refresh(a){return!0}deleteMetadata(){this.params.onDelete(this.params.data)}}return(o=v).\u0275fac=function(a){return new(a||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-metadata-actions"]],decls:4,vars:0,consts:[[1,"actions-component"],["matRipple","","tippy","Delete",1,"eav-grid-action-button","highlight",3,"click"]],template:function(a,s){1&a&&(t.TgZ(0,"div",0)(1,"div",1),t.NdJ("click",function(){return s.deleteMetadata()}),t.TgZ(2,"mat-icon"),t._uU(3,"delete"),t.qZA()()())},dependencies:[$.$,A.Hw,y.wG]}),v})(),O=(()=>{var o;class v{agInit(a){this.value=a.value,this.metadata=a.data}refresh(a){return!0}}return(o=v).\u0275fac=function(a){return new(a||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-metadata-content-type"]],decls:2,vars:3,consts:[[1,"container",3,"tippy","tippyDisabled"]],template:function(a,s){1&a&&(t.TgZ(0,"div",0),t._uU(1),t.qZA()),2&a&&(t.Q6J("tippy",s.metadata._Type.Description)("tippyDisabled",!s.metadata._Type.Description),t.xp6(1),t.hij(" ",s.value,"\n"))},dependencies:[$.$],styles:[".container[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content}"]}),v})();var x=e(8849),S=e(5043),R=e(3317),b=e(1217),K=e(8834),W=e(9851),H=e(131),w=e(1268),j=e(6355),z=e(9674),k=e(9293);function V(o,v){if(1&o&&(t.TgZ(0,"mat-option",16),t._uU(1),t.qZA()),2&o){const i=v.$implicit;t.Q6J("value",i.value),t.xp6(1),t.hij(" ",i.name," ")}}function X(o,v){if(1&o&&(t.ynx(0),t.TgZ(1,"mat-form-field",3)(2,"mat-label"),t._uU(3,"Scope"),t.qZA(),t.TgZ(4,"mat-select",14),t.YNc(5,V,2,2,"mat-option",15),t.TgZ(6,"mat-option",16),t._uU(7,"Other..."),t.qZA()()(),t.TgZ(8,"app-field-hint"),t._uU(9," The scope should almost never be changed - "),t.TgZ(10,"a",17),t._uU(11,"see help"),t.qZA()(),t.BQk()),2&o){const i=t.oxw().ngIf,a=t.oxw();t.xp6(4),t.Q6J("placeholder",i.scopeOptions.length?"":"No items found"),t.xp6(1),t.Q6J("ngForOf",i.scopeOptions),t.xp6(1),t.Q6J("value",a.dropdownInsertValue)}}function q(o,v){if(1&o&&(t.TgZ(0,"mat-option",16),t._uU(1),t.qZA()),2&o){const i=v.$implicit;t.Q6J("value",i.StaticName),t.xp6(1),t.hij(" ",i.Label," ")}}function tt(o,v){if(1&o&&(t.TgZ(0,"mat-select",18),t.YNc(1,q,2,2,"mat-option",15),t.qZA()),2&o){const i=t.oxw().ngIf;t.Q6J("placeholder",i.contentTypes.length?"":"No items found"),t.xp6(1),t.Q6J("ngForOf",i.contentTypes)}}function et(o,v){1&o&&t._UZ(0,"input",19)}function nt(o,v){1&o&&(t.TgZ(0,"app-field-hint",20),t._uU(1," This field is required "),t.qZA()),2&o&&t.Q6J("isError",!0)}const Q=function(o){return{active:o}};function at(o,v){if(1&o){const i=t.EpF();t.TgZ(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),t._uU(3,"Create Metadata"),t.qZA(),t.TgZ(4,"mat-card-subtitle"),t._uU(5," This is a special operation to add an item which is metadata for another item, see "),t.TgZ(6,"a",1),t._uU(7,"docs"),t.qZA(),t._uU(8,". "),t.qZA()(),t.TgZ(9,"mat-card-content")(10,"form",2),t.YNc(11,X,12,3,"ng-container",0),t.TgZ(12,"mat-form-field",3)(13,"mat-label"),t._uU(14,"Content Type"),t.qZA(),t.YNc(15,tt,2,2,"mat-select",4),t.YNc(16,et,1,0,"input",5),t.TgZ(17,"div",6)(18,"button",7),t.NdJ("click",function(){t.CHM(i);const s=t.oxw();return t.KtG(s.toggleGuidedContentType(!0))}),t.TgZ(19,"mat-icon"),t._uU(20,"search"),t.qZA()(),t.TgZ(21,"button",8),t.NdJ("click",function(){t.CHM(i);const s=t.oxw();return t.KtG(s.toggleGuidedContentType(!1))}),t.TgZ(22,"mat-icon"),t._uU(23,"text_fields"),t.qZA()()()(),t.YNc(24,nt,2,1,"app-field-hint",9),t.qZA()(),t.TgZ(25,"mat-card-actions",10)(26,"mat-slide-toggle",11),t.NdJ("change",function(s){t.CHM(i);const h=t.oxw();return t.KtG(h.toggleAdvancedMode(s))}),t._uU(27),t.qZA(),t.TgZ(28,"div")(29,"button",12),t.NdJ("click",function(){t.CHM(i);const s=t.oxw();return t.KtG(s.closeDialog())}),t._uU(30,"Cancel"),t.qZA(),t.TgZ(31,"button",13),t.NdJ("click",function(){t.CHM(i);const s=t.oxw();return t.KtG(s.confirm())}),t._uU(32," Confirm "),t.qZA()()()()}if(2&o){const i=t.oxw();t.xp6(10),t.Q6J("formGroup",i.form),t.xp6(1),t.Q6J("ngIf",i.advancedMode&&i.guidedContentType),t.xp6(4),t.Q6J("ngIf",i.guidedContentType),t.xp6(1),t.Q6J("ngIf",!i.guidedContentType),t.xp6(2),t.Q6J("ngClass",t.VKq(10,Q,i.guidedContentType)),t.xp6(3),t.Q6J("ngClass",t.VKq(12,Q,!i.guidedContentType)),t.xp6(3),t.Q6J("ngIf",i.form.controls.contentType.touched&&(null==i.form.controls.contentType.errors?null:i.form.controls.contentType.errors.required)),t.xp6(2),t.Q6J("checked",i.advancedMode),t.xp6(1),t.hij(" ",i.advancedMode?"Advanced":"Simple"," "),t.xp6(4),t.Q6J("disabled",!i.form.valid)}}let ot=(()=>{var o;class v{constructor(a,s){this.dialogRef=a,this.contentTypesService=s,this.hostClass="dialog-component",this.dropdownInsertValue=K.G,this.guidedContentType=!0,this.advancedMode=!1}ngOnInit(){this.contentTypes$=new r.X([]),this.scopeOptions$=new r.X([]),this.buildForm(),this.fetchScopes(),this.viewModel$=(0,u.a)([this.contentTypes$,this.scopeOptions$]).pipe((0,d.U)(([a,s])=>({contentTypes:a,scopeOptions:s})))}ngOnDestroy(){this.contentTypes$.complete(),this.scopeOptions$.complete()}closeDialog(a){this.dialogRef.close(a)}toggleGuidedContentType(a){this.guidedContentType=a}toggleAdvancedMode(a){this.advancedMode=a.checked}confirm(){const a=this.form.getRawValue();this.closeDialog(a.contentType)}buildForm(){this.form=new x.nJ({}),this.form.addControl("contentType",new x.p4(null,[x.kI.required])),this.form.addControl("scope",new x.p4(m.Zy.scopes.default.value)),this.form.controls.scope.valueChanges.pipe((0,S.O)(this.form.controls.scope.value),(0,R.x)()).subscribe(a=>{null!=this.form.controls.contentType.value&&this.form.controls.contentType.patchValue(null),a===K.G?(a=prompt("This is an advanced feature to show content-types of another scope. Don't use this if you don't know what you're doing, as content-types of other scopes are usually hidden for a good reason.")||m.Zy.scopes.default.value,this.scopeOptions$.value.some(s=>s.value===a)||this.scopeOptions$.next([{name:a,value:a},...this.scopeOptions$.value]),this.form.controls.scope.patchValue(a)):this.fetchContentTypes(a)})}fetchContentTypes(a){this.contentTypesService.retrieveContentTypes(a).subscribe(s=>{this.contentTypes$.next(s)})}fetchScopes(){this.contentTypesService.getScopes().subscribe(a=>{this.scopeOptions$.next(a)})}}return(o=v).\u0275fac=function(a){return new(a||o)(t.Y36(C.so),t.Y36(b.sF))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-metadata-save-dialog"]],hostVars:1,hostBindings:function(a,s){2&a&&t.Ikx("className",s.hostClass)},decls:2,vars:3,consts:[[4,"ngIf"],["href","https://go.2sxc.org/metadata","target","_blank"],[3,"formGroup"],["color","accent",1,"eav-form-field"],["formControlName","contentType","required","",3,"placeholder",4,"ngIf"],["matInput","","type","text","formControlName","contentType","required","",4,"ngIf"],["matTextSuffix",""],["mat-icon-button","","type","button","tippy","Pick existing value",3,"ngClass","click"],["mat-icon-button","","type","button","tippy","Manual entry",3,"ngClass","click"],[3,"isError",4,"ngIf"],[1,"eav-card-actions"],["color","accent",3,"checked","change"],["mat-raised-button","",1,"eav-card-action-button",3,"click"],["mat-raised-button","","color","accent",1,"eav-card-action-button",3,"disabled","click"],["formControlName","scope",3,"placeholder"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["href","https://2sxc.org/help?tag=scope","target","_blank","appClickStopPropagation",""],["formControlName","contentType","required","",3,"placeholder"],["matInput","","type","text","formControlName","contentType","required",""],[3,"isError"]],template:function(a,s){1&a&&(t.YNc(0,at,33,14,"mat-card",0),t.ALo(1,"async")),2&a&&t.Q6J("ngIf",t.lcZ(1,1,s.viewModel$))},dependencies:[p.mk,p.sg,p.O5,W.Y,H.E,$.$,f.lW,f.RK,A.Hw,x._Y,x.Fj,x.JJ,x.JL,x.Q7,x.sg,x.u,w.KE,w.hX,w.R9,j.gD,y.ey,z.Nt,k.Rr,E.a8,E.hq,E.dn,E.dk,E.$j,E.n5,p.Ov],styles:[".eav-card-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.eav-card-action-button[_ngcontent-%COMP%]{margin-left:8px}"]}),v})();var it=e(8968),G=e(91),st=e(9409),rt=e(8621),J=e(77),ct=e(5392);function lt(o,v){1&o&&(t.ynx(0),t._uU(1,"This item is not metadata for anything else."),t.BQk())}function pt(o,v){if(1&o&&(t.ynx(0),t._UZ(1,"br"),t._uU(2),t.BQk()),2&o){const i=t.oxw(2).ngIf;t.xp6(2),t.hij("Number: ",i.itemFor.Number,"")}}function dt(o,v){if(1&o&&(t.ynx(0),t._UZ(1,"br"),t._uU(2),t.BQk()),2&o){const i=t.oxw(2).ngIf;t.xp6(2),t.hij("Guid: ",i.itemFor.Guid,"")}}function _t(o,v){if(1&o&&(t.ynx(0),t._UZ(1,"br"),t._uU(2),t.BQk()),2&o){const i=t.oxw(2).ngIf;t.xp6(2),t.hij("String: ",i.itemFor.String,"")}}function mt(o,v){if(1&o&&(t.ynx(0),t._UZ(1,"br"),t._uU(2),t.BQk()),2&o){const i=t.oxw(2).ngIf;t.xp6(2),t.hij("Title: ",i.itemFor.String,"")}}function gt(o,v){if(1&o&&(t.ynx(0),t._uU(1," This item is metadata for: "),t._UZ(2,"br"),t._uU(3),t._UZ(4,"br"),t._uU(5),t.YNc(6,pt,3,1,"ng-container",0),t.YNc(7,dt,3,1,"ng-container",0),t.YNc(8,_t,3,1,"ng-container",0),t.YNc(9,mt,3,1,"ng-container",0),t.BQk()),2&o){const i=t.oxw().ngIf;t.xp6(3),t.hij("Target: ",i.itemFor.Target," "),t.xp6(2),t.hij("TargetType: ",i.itemFor.TargetType," "),t.xp6(1),t.Q6J("ngIf",i.itemFor.Number),t.xp6(1),t.Q6J("ngIf",i.itemFor.Guid),t.xp6(1),t.Q6J("ngIf",i.itemFor.String),t.xp6(1),t.Q6J("ngIf",i.itemFor.Title)}}function ht(o,v){if(1&o){const i=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){t.CHM(i);const s=t.oxw(2);return t.KtG(s.createMetadata())}),t.TgZ(1,"mat-icon"),t._uU(2,"add"),t.qZA()()}}function ut(o,v){1&o&&t._UZ(0,"div")}function ft(o,v){if(1&o&&(t._UZ(0,"div",23),t.ALo(1,"safeHtml")),2&o){const i=t.oxw().$implicit;t.Q6J("innerHTML",t.lcZ(1,2,i.Icon),t.oJD)("matBadgeHidden",i.Enabled)}}function vt(o,v){1&o&&(t.TgZ(0,"mat-icon"),t._uU(1,"add"),t.qZA())}function Ct(o,v){if(1&o){const i=t.EpF();t.TgZ(0,"button",19),t.NdJ("click",function(){const h=t.CHM(i).$implicit,L=t.oxw(3);return t.KtG(L.createMetadata(h))}),t.YNc(1,ut,1,0,"div",20),t.YNc(2,ft,2,4,"ng-template",null,21,t.W1O),t.YNc(4,vt,2,0,"ng-template",null,22,t.W1O),t.qZA()}if(2&o){const i=v.$implicit,a=t.MAs(3),s=t.MAs(5);t.uIk("label",i.Title),t.xp6(1),t.Q6J("ngIf",i.Icon)("ngIfThen",a)("ngIfElse",s)}}const xt=function(o){return{"fab-opened":o}};function Tt(o,v){if(1&o){const i=t.EpF();t.TgZ(0,"eco-fab-speed-dial",12),t.NdJ("openChange",function(s){t.CHM(i);const h=t.oxw(2);return t.KtG(h.openChange(s))}),t.TgZ(1,"eco-fab-speed-dial-trigger",13)(2,"button",14)(3,"mat-icon",15),t._uU(4),t.qZA()()(),t.TgZ(5,"eco-fab-speed-dial-actions",16)(6,"button",17),t.NdJ("click",function(){t.CHM(i);const s=t.oxw(2);return t.KtG(s.createMetadata())}),t.TgZ(7,"mat-icon"),t._uU(8,"search"),t.qZA()(),t.YNc(9,Ct,6,4,"button",18),t.qZA()()}if(2&o){const i=t.oxw().ngIf;t.Q6J("ngClass",t.VKq(4,xt,i.fabOpen)),t.xp6(1),t.Q6J("spin",!0),t.xp6(3),t.Oqu(i.fabOpen?"close":"add"),t.xp6(5),t.Q6J("ngForOf",i.recommendations)}}function Dt(o,v){if(1&o){const i=t.EpF();t.ynx(0),t.TgZ(1,"div",1)(2,"div",2)(3,"div",3),t._uU(4),t.qZA(),t.TgZ(5,"button",4),t.NdJ("click",function(){t.CHM(i);const s=t.oxw();return t.KtG(s.closeDialog())}),t.TgZ(6,"mat-icon"),t._uU(7,"close"),t.qZA()()(),t.TgZ(8,"div",5)(9,"p"),t.YNc(10,lt,2,0,"ng-container",0),t.YNc(11,gt,10,6,"ng-container",0),t.qZA(),t._UZ(12,"router-outlet"),t.TgZ(13,"div",6),t._UZ(14,"ag-grid-angular",7),t.qZA()(),t.TgZ(15,"mat-dialog-actions",8),t.YNc(16,ht,3,0,"button",9),t.YNc(17,Tt,10,6,"eco-fab-speed-dial",10),t.qZA()(),t.BQk()}if(2&o){const i=v.ngIf,a=t.oxw();t.xp6(4),t.hij(" ",a.title||"Metadata"," "),t.xp6(6),t.Q6J("ngIf",!i.itemFor),t.xp6(1),t.Q6J("ngIf",i.itemFor),t.xp6(3),t.Q6J("rowData",i.metadata)("gridOptions",a.gridOptions),t.xp6(2),t.Q6J("ngIf",0===i.recommendations.length),t.xp6(1),t.Q6J("ngIf",i.recommendations.length>0)}}let It=(()=>{var o;class v extends T.H{constructor(a,s,h,L,B,Y,Mt,Et,yt,Ot){super(a,s),this.router=a,this.route=s,this.dialogRef=h,this.metadataService=L,this.snackBar=B,this.entitiesService=Y,this.contentItemsService=Mt,this.dialog=Et,this.viewContainerRef=yt,this.changeDetectorRef=Ot,this.gridOptions=this.buildGridOptions(),this.metadata$=new r.X([]),this.recommendations$=new r.X([]),this.itemFor$=new r.X(void 0),this.fabOpen$=new r.X(!1),this.targetType=parseInt(this.route.snapshot.paramMap.get("targetType"),10),this.keyType=this.route.snapshot.paramMap.get("keyType"),this.key=this.route.snapshot.paramMap.get("key"),this.title=decodeURIComponent(this.route.snapshot.paramMap.get("title")??""),this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName")}ngOnInit(){this.fetchFor(),this.fetchMetadata(),this.subscription.add(this.refreshOnChildClosedShallow().subscribe(()=>{this.fetchMetadata()}));const a=(0,u.a)([this.metadata$,this.recommendations$]).pipe((0,d.U)(([s,h])=>h.filter(L=>s.filter(B=>B._Type.Id===L.Id).length<L.Count)));this.viewModel$=(0,u.a)([this.metadata$,a,this.itemFor$,this.fabOpen$]).pipe((0,d.U)(([s,h,L,B])=>({metadata:s,recommendations:h,itemFor:L,fabOpen:B})))}ngOnDestroy(){this.metadata$.complete(),this.recommendations$.complete(),this.itemFor$.complete(),this.fabOpen$.complete(),super.ngOnDestroy()}closeDialog(){this.dialogRef.close()}openChange(a){this.fabOpen$.next(a)}createMetadata(a){if(a)return a.Enabled?void(a.CreateEmpty?(this.snackBar.open(`Creating ${a.Name}...`),this.entitiesService.create(a.Id,{For:this.calculateItemFor()}).subscribe({error:()=>{this.snackBar.open(`Creating ${a.Name} failed. Please check console for more info`,void 0,{duration:3e3}),this.fetchMetadata()},next:()=>{this.snackBar.open(`Created ${a.Name}`,void 0,{duration:3e3}),this.fetchMetadata()}})):this.createMetadataForm(a.Id)):void it.B.openDialog(this.dialog,a.MissingFeature,this.viewContainerRef,this.changeDetectorRef);this.dialog.open(ot,{autoFocus:!1,viewContainerRef:this.viewContainerRef,width:"650px"}).afterClosed().subscribe(h=>{null!=h&&this.createMetadataForm(h)})}createMetadataForm(a){const s={items:[{ContentTypeName:a,For:this.calculateItemFor()}]},h=(0,c.f)(s);this.router.navigate([`edit/${h}`],{relativeTo:this.route}),this.changeDetectorRef.markForCheck()}calculateItemFor(){return{Target:Object.values(m.Zy.metadata).find(s=>s.targetType===this.targetType)?.target??this.targetType.toString(),TargetType:this.targetType,...this.keyType===m.Zy.keyTypes.guid&&{Guid:this.key},...this.keyType===m.Zy.keyTypes.number&&{Number:parseInt(this.key,10)},...this.keyType===m.Zy.keyTypes.string&&{String:this.key}}}fetchFor(){this.contentTypeStaticName&&this.contentItemsService.getAll(this.contentTypeStaticName).subscribe(a=>{const s=a.find(h=>h.Guid===this.key);s?.For&&this.itemFor$.next(s.For)})}fetchMetadata(){this.metadataService.getMetadata(this.targetType,this.keyType,this.key).pipe((0,d.U)(a=>(a.Recommendations.forEach(s=>{s.Icon?.startsWith("base64:")&&(s.Icon=s.Icon.replace("base64:",""),s.Icon=window.atob(s.Icon),s.Icon=s.Icon.replace('fill="#000000"','fill="#ffffff"'))}),a)),(0,D.b)(a=>{this.metadata$.next(a.Items),this.recommendations$.next(a.Recommendations)})).subscribe()}editMetadata(a){const h=(0,c.f)({items:[{EntityId:a.Id}]});this.router.navigate([`edit/${h}`],{relativeTo:this.route})}deleteMetadata(a,s=!1){if(s)this.snackBar.open("Deleting..."),this.entitiesService.delete(a._Type.Id,a.Id,!1).subscribe({next:()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchMetadata()},error:()=>{this.snackBar.open("Delete failed. Please check console for more information",null,{duration:3e3})}});else{const h={entityId:a.Id,entityTitle:a.Title,message:this.recommendations$.value.find(B=>B.Id===a._Type.Id)?.DeleteWarning};this.dialog.open(N,{autoFocus:!1,data:h,viewContainerRef:this.viewContainerRef,width:"400px"}).afterClosed().subscribe(B=>{B&&this.deleteMetadata(a,!0)})}}buildGridOptions(){return{...g.f,columnDefs:[{headerName:"ID",field:"Id",width:70,headerClass:"dense",cellClass:"id-action no-padding no-outline".split(" "),sortable:!0,filter:"agNumberColumnFilter",valueGetter:s=>s.data.Id,cellRenderer:M.m,cellRendererParams:{tooltipGetter:h=>`ID: ${h.Id}\nGUID: ${h.Guid}`}},{field:"Title",flex:2,minWidth:250,cellClass:"primary-action highlight".split(" "),sortable:!0,sort:"asc",filter:"agTextColumnFilter",valueGetter:s=>s.data.Title,onCellClicked:s=>{this.editMetadata(s.data)}},{headerName:"Content Type",field:"ContentType",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:s=>{const h=s.data;return`${h._Type.Name}${h._Type.Title!==h._Type.Name?` (${h._Type.Title})`:""}`},cellRenderer:O},{width:42,cellClass:"secondary-action no-padding".split(" "),pinned:"right",cellRenderer:P,cellRendererParams:(()=>({onDelete:h=>this.deleteMetadata(h)}))()}]}}}return(o=v).\u0275fac=function(a){return new(a||o)(t.Y36(G.F0),t.Y36(G.gz),t.Y36(C.so),t.Y36(_.Do),t.Y36(st.ux),t.Y36(l.g),t.Y36(n.l),t.Y36(C.uw),t.Y36(t.s_b),t.Y36(t.sBO))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-metadata"]],features:[t.qOj],decls:2,vars:3,consts:[[4,"ngIf"],[1,"eav-dialog","nav-component-wrapper"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"eav-dialog-content","nav-component-wrapper"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","gridOptions"],["align","end"],["mat-fab","","mat-elevation-z24","","class","grid-fab","tippy","Create a new metadata for this item",3,"click",4,"ngIf"],["class","eav-eco-fab-speed-dial",3,"ngClass","openChange",4,"ngIf"],["mat-fab","","mat-elevation-z24","","tippy","Create a new metadata for this item",1,"grid-fab",3,"click"],[1,"eav-eco-fab-speed-dial",3,"ngClass","openChange"],[3,"spin"],["mat-fab",""],[1,"spin180"],[1,"eav-eco-fab-speed-dial-actions"],["mat-mini-fab","","label","Other Content Type",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["mat-mini-fab","","class","eav-eco-fab-speed-dial-action-button",3,"click",4,"ngFor","ngForOf"],["mat-mini-fab","",1,"eav-eco-fab-speed-dial-action-button",3,"click"],[4,"ngIf","ngIfThen","ngIfElse"],["svgIcon",""],["matIcon",""],["matBadgeColor","accent","matBadgeSize","small","matBadge","\u{1f48e}","matBadgePosition","below after","aria-hidden","false",2,"color","white","fill","white",3,"innerHTML","matBadgeHidden"]],template:function(a,s){1&a&&(t.YNc(0,Dt,18,7,"ng-container",0),t.ALo(1,"async")),2&a&&t.Q6J("ngIf",t.lcZ(1,1,s.viewModel$))},dependencies:[p.mk,p.sg,p.O5,G.lC,$.$,C.H8,f.RK,f.nh,f.cs,A.Hw,rt.N8,J.Lp,J.W7,J.YI,ct.k,p.Ov,Z.z],styles:["[_nghost-%COMP%]     .mat-button-wrapper div svg *:not([fill]){fill:#fff}"]}),v})()},9851:(U,I,e)=>{e.d(I,{Y:()=>m});var r=e(1699),u=e(6575),d=e(1268);function D(c,C){1&c&&r.GkF(0)}function n(c,C){if(1&c&&(r.TgZ(0,"mat-hint"),r.YNc(1,D,1,0,"ng-container",3),r.qZA()),2&c){r.oxw();const t=r.MAs(4);r.xp6(1),r.Q6J("ngTemplateOutlet",t)}}function l(c,C){1&c&&r.GkF(0)}function _(c,C){if(1&c&&(r.TgZ(0,"mat-error"),r.YNc(1,l,1,0,"ng-container",3),r.qZA()),2&c){r.oxw();const t=r.MAs(4);r.xp6(1),r.Q6J("ngTemplateOutlet",t)}}function T(c,C){1&c&&r.Hsn(0)}const M=function(c){return{"hint-box__short":c}},g=["*"];let m=(()=>{var c;class C{constructor(){this.isError=!1,this.isShort=!0}toggleIsShort(){this.isShort=!this.isShort}}return(c=C).\u0275fac=function(p){return new(p||c)},c.\u0275cmp=r.Xpm({type:c,selectors:[["app-field-hint"]],inputs:{isError:"isError"},ngContentSelectors:g,decls:5,vars:6,consts:[[1,"hint-box",3,"ngClass","ngSwitch","click"],[4,"ngSwitchCase"],["content",""],[4,"ngTemplateOutlet"]],template:function(p,f){1&p&&(r.F$t(),r.TgZ(0,"div",0),r.NdJ("click",function(){return f.toggleIsShort()}),r.YNc(1,n,2,1,"mat-hint",1),r.YNc(2,_,2,1,"mat-error",1),r.qZA(),r.YNc(3,T,1,0,"ng-template",null,2,r.W1O)),2&p&&(r.Q6J("ngClass",r.VKq(4,M,f.isShort))("ngSwitch",f.isError),r.xp6(1),r.Q6J("ngSwitchCase",!1),r.xp6(1),r.Q6J("ngSwitchCase",!0))},dependencies:[u.mk,u.tP,u.RF,u.n9,d.bx,d.TO],styles:[".hint-box[_ngcontent-%COMP%]{margin-top:4px}.hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{font-size:12px;display:block}.hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]}),C})()},131:(U,I,e)=>{e.d(I,{E:()=>u});var r=e(1699);let u=(()=>{var d;class D{onClick(l){l.stopPropagation()}}return(d=D).\u0275fac=function(l){return new(l||d)},d.\u0275dir=r.lG2({type:d,selectors:[["","appClickStopPropagation",""]],hostBindings:function(l,_){1&l&&r.NdJ("click",function(M){return _.onClick(M)})}}),D})()},237:(U,I,e)=>{function r(d){return new Promise((D,n)=>{const l=new FileReader;l.readAsDataURL(d),l.onload=()=>{D(l.result.split(",")[1])},l.onerror=_=>{n(_)}})}function u(d){return new Promise((D,n)=>{const l=new FileReader;l.readAsText(d),l.onload=()=>{D(l.result)},l.onerror=_=>{n(_)}})}e.d(I,{B:()=>u,s:()=>r})}}]);
//# sourceMappingURL=https://sources.2sxc.org/16.08.00/dist/ng-edit/projects_eav-ui_src_app_metadata_metadata_component_ts.f8268cff4570e73a.js.map