"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_app-administration_sub-dialogs_edit-content-type_edit-content-type_co-2abec4","projects_eav-ui_src_app_shared_directives_click-stop-propagation_directive_ts"],{2956:(A,f,o)=>{o.r(f),o.d(f,{EditContentTypeComponent:()=>K});var p=o(8071),v=o(3839),l=o(9736),T=o(4980),u=o(8834),m=o(196);const _=/(^[A-Za-z][A-Za-z0-9]+$)|(^@[A-Za-z][A-Za-z0-9-]*$)/;var C=o(5530),t=o(1699),$=o(6861),M=o(91),b=o(9409),O=o(9851),J=o(131),U=o(9498),x=o(6575),E=o(895),k=o(6515),r=o(8849),I=o(9674),S=o(1268),Q=o(6355),D=o(257),h=o(5787);function P(i,s){1&i&&(t.TgZ(0,"app-field-hint",24),t._uU(1,"This field is required"),t.qZA()),2&i&&t.Q6J("isError",!0)}function w(i,s){if(1&i&&(t.TgZ(0,"app-field-hint",24),t._uU(1),t.qZA()),2&i){const a=t.oxw(4);t.Q6J("isError",!0),t.xp6(1),t.Oqu(a.contentTypeNameError)}}function B(i,s){if(1&i&&(t.ynx(0),t.YNc(1,P,2,1,"app-field-hint",23),t.YNc(2,w,2,2,"app-field-hint",23),t.BQk()),2&i){t.oxw();const a=t.MAs(9);t.xp6(1),t.Q6J("ngIf",a.errors.required),t.xp6(1),t.Q6J("ngIf",a.errors.pattern)}}function Y(i,s){if(1&i&&(t.TgZ(0,"mat-option",15),t._uU(1),t.qZA()),2&i){const a=s.$implicit;t.Q6J("value",a.value),t.xp6(1),t.hij(" ",a.name," ")}}function H(i,s){if(1&i&&(t.TgZ(0,"div",8)(1,"h3"),t._uU(2,"Shared Content Type (Ghost)"),t.qZA(),t.TgZ(3,"p"),t._uU(4,"Note: this can't be edited in the UI, for now if you really know what you're doing, do it in the DB "),t.qZA(),t.TgZ(5,"p"),t._uU(6),t.qZA()()),2&i){const a=t.oxw(2).ngIf;t.xp6(6),t.hij("Uses Type Definition of: ",a.contentType.SharedDefId,"")}}function F(i,s){if(1&i){const a=t.EpF();t.TgZ(0,"form",5,6),t.NdJ("ngSubmit",function(){t.CHM(a);const e=t.oxw(2);return t.KtG(e.save())}),t.TgZ(2,"div",7)(3,"div")(4,"div",8)(5,"mat-form-field",9)(6,"mat-label"),t._uU(7,"Name"),t.qZA(),t.TgZ(8,"input",10,11),t.NdJ("ngModelChange",function(e){t.CHM(a);const c=t.oxw(2);return t.KtG(c.changeContentTypeName(e))}),t.qZA()(),t.YNc(10,B,3,2,"ng-container",0),t.qZA(),t.TgZ(11,"mat-accordion")(12,"mat-expansion-panel")(13,"mat-expansion-panel-header")(14,"mat-panel-title"),t._uU(15,"Advanced"),t.qZA(),t._UZ(16,"mat-panel-description"),t.qZA(),t.TgZ(17,"div",8)(18,"div",12)(19,"mat-form-field",9)(20,"mat-label"),t._uU(21,"Scope"),t.qZA(),t.TgZ(22,"mat-select",13),t.NdJ("ngModelChange",function(e){t.CHM(a);const c=t.oxw(2);return t.KtG(c.changeScope(e))}),t.YNc(23,Y,2,2,"mat-option",14),t.TgZ(24,"mat-option",15),t._uU(25,"Other..."),t.qZA()()(),t.TgZ(26,"button",16),t.NdJ("click",function(){t.CHM(a);const e=t.oxw(2);return t.KtG(e.unlockScope())}),t.TgZ(27,"mat-icon"),t._uU(28),t.qZA()()(),t.TgZ(29,"app-field-hint"),t._uU(30," The scope should almost never be changed - "),t.TgZ(31,"a",17),t._uU(32,"see help"),t.qZA()()(),t.TgZ(33,"div",8)(34,"mat-form-field",9)(35,"mat-label"),t._uU(36,"Static Name"),t.qZA(),t._UZ(37,"input",18),t.qZA()(),t.YNc(38,H,7,1,"div",19),t.qZA()()()(),t.TgZ(39,"mat-dialog-actions",20)(40,"button",21),t.NdJ("click",function(){t.CHM(a);const e=t.oxw(2);return t.KtG(e.closeDialog())}),t._uU(41,"Cancel"),t.qZA(),t.TgZ(42,"button",22),t._uU(43," Save "),t.qZA()()()}if(2&i){const a=t.MAs(1),n=t.MAs(9),e=t.oxw().ngIf,c=t.oxw();t.xp6(8),t.Q6J("pattern",c.contentTypeNamePattern)("ngModel",e.contentType.Name),t.xp6(2),t.Q6J("ngIf",n.touched&&n.errors),t.xp6(1),t.Q6J("@.disabled",e.disableAnimation),t.xp6(11),t.Q6J("ngModel",e.contentType.Scope)("disabled",e.lockScope),t.xp6(1),t.Q6J("ngForOf",e.scopeOptions),t.xp6(1),t.Q6J("value",c.dropdownInsertValue),t.xp6(2),t.Q6J("tippy",e.lockScope?"Unlock":"Lock"),t.xp6(2),t.hij(" ",e.lockScope?"lock":"lock_open"," "),t.xp6(9),t.Q6J("ngModel",e.contentType.StaticName),t.xp6(1),t.Q6J("ngIf",e.contentType.SharedDefId),t.xp6(4),t.Q6J("disabled",!a.form.valid||e.loading)}}function G(i,s){if(1&i&&(t.ynx(0),t.TgZ(1,"div",1)(2,"div",2)(3,"div",3),t._uU(4),t.qZA()(),t.YNc(5,F,44,13,"form",4),t.qZA(),t.BQk()),2&i){const a=s.ngIf,n=t.oxw();t.xp6(4),t.Oqu(n.contentTypeStaticName?"Edit Content Type":"New Content Type"),t.xp6(1),t.Q6J("ngIf",a.contentType)}}let K=(()=>{var i;class s{constructor(n,e,c,y){this.dialogRef=n,this.route=e,this.contentTypesService=c,this.snackBar=y,this.hostClass="dialog-component",this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName"),this.contentTypeNamePattern=_,this.contentTypeNameError="Standard letters and numbers are allowed. Must start with a letter.",this.dropdownInsertValue=u.G,this.contentType$=new p.X(null),this.lockScope$=new p.X(!0),this.scopeOptions$=new p.X(null),this.disableAnimation$=new p.X(!0),this.loading$=new p.X(!1),this.viewModel$=(0,v.a)([this.contentType$,this.lockScope$,this.scopeOptions$,this.disableAnimation$,this.loading$]).pipe((0,l.U)(([g,d,Z,j,X])=>({contentType:g,lockScope:d,scopeOptions:Z,disableAnimation:j,loading:X}))),this.scope=this.route.snapshot.parent.paramMap.get("scope")}ngOnInit(){const n=this.contentTypeStaticName?this.contentTypesService.retrieveContentType(this.contentTypeStaticName).pipe((0,l.U)(c=>({...c,ChangeStaticName:!1,NewStaticName:c.StaticName}))):(0,T.of)({StaticName:"",Name:"",Description:"",Scope:this.scope,ChangeStaticName:!1,NewStaticName:""}),e=this.contentTypesService.getScopes();(0,v.a)([n,e]).subscribe(([c,y])=>{this.contentType$.next(c);const g=[...this.scopeOptions$.value??[]];y.forEach(d=>{g.some(Z=>Z.value===d.value)||g.push(d)}),g.some(d=>d.value===this.scope)||g.push({name:this.scope,value:this.scope}),this.scopeOptions$.next(g)})}ngOnDestroy(){this.contentType$.complete(),this.lockScope$.complete(),this.scopeOptions$.complete(),this.disableAnimation$.complete(),this.loading$.complete()}ngAfterViewInit(){setTimeout(()=>this.disableAnimation$.next(!1))}closeDialog(){this.dialogRef.close()}changeContentTypeName(n){this.contentType$.next({...this.contentType$.value,Name:n})}changeScope(n){n!==u.G||(n=prompt("This is an advanced feature to show content-types of another scope. Don't use this if you don't know what you're doing, as content-types of other scopes are usually hidden for a good reason.")||m.Zy.scopes.default.value,this.scopeOptions$.value.some(e=>e.value===n))||this.scopeOptions$.next([{name:n,value:n},...this.scopeOptions$.value]),this.contentType$.next({...this.contentType$.value,Scope:n})}unlockScope(){this.lockScope$.next(!this.lockScope$.value),this.lockScope$.value&&this.contentType$.next({...this.contentType$.value,Scope:this.scope})}save(){this.loading$.next(!0),this.snackBar.open("Saving..."),this.contentTypesService.save(this.contentType$.value).subscribe(n=>{this.loading$.next(!1),this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()}),document.activeElement instanceof HTMLElement&&document.activeElement.blur()}}return(i=s).\u0275fac=function(n){return new(n||i)(t.Y36($.so),t.Y36(M.gz),t.Y36(C.s),t.Y36(b.ux))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-edit-content-type"]],hostVars:1,hostBindings:function(n,e){2&n&&t.Ikx("className",e.hostClass)},decls:2,vars:3,consts:[[4,"ngIf"],[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[3,"ngSubmit",4,"ngIf"],[3,"ngSubmit"],["ngForm","ngForm"],[1,"eav-dialog-content"],[1,"eav-edit-input"],["color","accent",1,"eav-form-field"],["matInput","","type","text","required","","name","Name",3,"pattern","ngModel","ngModelChange"],["name","ngModel"],[1,"eav-form-and-button"],["name","Scope",3,"ngModel","disabled","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["mat-icon-button","","type","button","matTextSuffix","",1,"eav-scope-button",3,"tippy","click"],["href","https://2sxc.org/help?tag=scope","target","_blank","appClickStopPropagation",""],["matInput","","type","text","name","StaticName","disabled","",3,"ngModel"],["class","eav-edit-input",4,"ngIf"],["align","end"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","submit","color","accent",3,"disabled"],[3,"isError",4,"ngIf"],[3,"isError"]],template:function(n,e){1&n&&(t.YNc(0,G,6,2,"ng-container",0),t.ALo(1,"async")),2&n&&t.Q6J("ngIf",t.lcZ(1,1,e.viewModel$))},dependencies:[O.Y,J.E,U.$,$.H8,x.sg,x.O5,E.lW,E.RK,k.Hw,r._Y,r.Fj,r.JJ,r.JL,r.Q7,r.c5,r.On,r.F,I.Nt,S.KE,S.hX,S.R9,Q.gD,D.ey,h.pp,h.ib,h.yz,h.yK,h.u4,x.Ov],styles:[".eav-edit-input[_ngcontent-%COMP%]{padding-bottom:8px}.eav-form-and-button[_ngcontent-%COMP%]{display:flex;align-items:baseline;justify-content:space-between}.eav-form-and-button[_ngcontent-%COMP%]   .eav-scope-button[_ngcontent-%COMP%]{margin-left:8px}"]}),s})()},131:(A,f,o)=>{o.d(f,{E:()=>v});var p=o(1699);let v=(()=>{var l;class T{onClick(m){m.stopPropagation()}}return(l=T).\u0275fac=function(m){return new(m||l)},l.\u0275dir=p.lG2({type:l,selectors:[["","appClickStopPropagation",""]],hostBindings:function(m,_){1&m&&p.NdJ("click",function(C){return _.onClick(C)})}}),T})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/16.08.00/dist/ng-edit/projects_eav-ui_src_app_app-administration_sub-dialogs_edit-content-type_edit-content-type_co-2abec4.a2325239ece5ceb5.js.map