"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_replace-content_replace-content_component_ts"],{4513:(x,p,n)=>{n.r(p),n.d(p,{ReplaceContentComponent:()=>L});var r=n(9771),c=n(7941),d=n(9184),u=n(5797),h=n(9999),m=n(271),v=n(9669),M=n(1735),D=n(3216),T=n(316),l=n(3840),_=n(4175),E=n(5060),O=n(2275),C=n(4456),I=n(7984),f=n(5944),$=n(5437),t=n(8559),A=n(3347);function j(s,P){if(1&s&&(t.j41(0,"mat-option",15),t.EFF(1),t.k0s()),2&s){const e=P.$implicit;t.Y8G("value",e),t.R7$(),t.JRh(e)}}function U(s,P){if(1&s){const e=t.RV6();t.j41(0,"div",1)(1,"div",2)(2,"div",3),t.EFF(3),t.k0s()(),t.j41(4,"div",4),t.nrm(5,"router-outlet"),t.j41(6,"p"),t.EFF(7),t.k0s(),t.j41(8,"div",5)(9,"mat-form-field",6)(10,"mat-label"),t.EFF(11,"Choose item"),t.k0s(),t.j41(12,"input",7),t.bIt("ngModelChange",function(o){t.eBV(e);const a=t.XpG();return t.Njj(a.setFilter(o))}),t.k0s(),t.j41(13,"mat-autocomplete",8,0),t.bIt("optionSelected",function(o){t.eBV(e);const a=t.XpG();return t.Njj(a.select(o))}),t.j41(15,"cdk-virtual-scroll-viewport",9),t.DNE(16,j,2,2,"mat-option",10),t.k0s()()(),t.j41(17,"button",11),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.copySelected())}),t.j41(18,"mat-icon"),t.EFF(19,"file_copy"),t.k0s()()()(),t.j41(20,"mat-dialog-actions",12)(21,"button",13),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.closeDialog())}),t.EFF(22,"Cancel"),t.k0s(),t.j41(23,"button",14),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.save())}),t.EFF(24,"Save"),t.k0s()()()}if(2&s){const e=P,i=t.sdS(14);t.R7$(3),t.JRh(e.isAddMode?"Add Existing Item":"Replace Content Item"),t.R7$(4),t.SpI("",e.isAddMode?"Select a content-item to add to this list.":"By replacing a content-item you can make other content appear in the slot of the original content."," "),t.R7$(5),t.Y8G("matAutocomplete",i)("ngModel",e.filterText),t.R7$(),t.Y8G("hideSingleSelectionIndicator",!0),t.R7$(2),t.xc7("height",e.filteredOptions.length<6?48*e.filteredOptions.length:240,"px"),t.R7$(),t.Y8G("cdkVirtualForOf",e.filteredOptions),t.R7$(),t.Y8G("disabled",!e.isMatch),t.R7$(6),t.Y8G("disabled",!e.isMatch)}}let L=(()=>{class s extends M.V{constructor(e,i,o,a){super(e,i),this.router=e,this.route=i,this.dialogRef=o,this.snackBar=a,this.hostClass="dialog-component",this.contentGroupService=(0,$.d)(v.y)}ngOnInit(){this.guid=this.route.snapshot.paramMap.get("guid"),this.part=this.route.snapshot.paramMap.get("part"),this.index=parseInt(this.route.snapshot.paramMap.get("index"),10),this.add=!!this.route.snapshot.queryParamMap.get("add"),this.filterText$=new u.t(""),this.options$=new u.t([]);const e=(0,h.z)([this.filterText$,this.options$]).pipe((0,m.T)(([i,o])=>o.filter(a=>a.label.toLocaleLowerCase().includes(i.toLocaleLowerCase())).map(a=>a.label)));this.viewModel$=(0,h.z)([this.filterText$,e]).pipe((0,m.T)(([i,o])=>({filterText:i,filteredOptions:o,isAddMode:this.add,isMatch:o.includes(i)}))),this.fetchConfig(!1,null),this.subscriptions.add(this.childDialogClosed$().subscribe(()=>{const o=this.router.getCurrentNavigation().extras?.state,a=o?.[Object.keys(o)[0]];this.fetchConfig(!0,a)}))}ngOnDestroy(){this.filterText$.complete(),this.options$.complete(),super.ngOnDestroy()}closeDialog(){this.dialogRef.close()}setFilter(e){this.filterText$.next(e)}select(e){this.filterText$.next(e.option.value)}copySelected(){const e=this.buildContentGroup(),o=(0,D.s)({items:[{ContentTypeName:this.contentTypeName,DuplicateEntity:e.id}]});this.router.navigate([`edit/${o}`],{relativeTo:this.route})}save(){this.snackBar.open("Saving...");const e=this.buildContentGroup();this.contentGroupService.saveItem(e).subscribe(()=>{this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()})}fetchConfig(e,i){const o=this.buildContentGroup();this.contentGroupService.getItems(o).subscribe(a=>{const W=Object.entries(a.Items).map(([g,R])=>({id:parseInt(g,10),label:`${R} (${g})`}));if(this.options$.next(W),!o.add&&!e||null!=i){const g=e?i:a.SelectedId,R=this.options$.value.find(B=>B.id===g)?.label||"";this.filterText$.next(R)}this.contentTypeName=a.ContentTypeName})}buildContentGroup(){return{id:this.options$.value.find(o=>o.label===this.filterText$.value)?.id??null,guid:this.guid,part:this.part,index:this.index,add:this.add}}static#t=this.\u0275fac=function(i){return new(i||s)(t.rXU(d.Ix),t.rXU(d.nX),t.rXU(c.CP),t.rXU(A.UG))};static#e=this.\u0275cmp=t.VBU({type:s,selectors:[["app-replace-content"]],hostVars:1,hostBindings:function(i,o){2&i&&t.Mr5("className",o.hostClass)},standalone:!0,features:[t.Vt3,t.aNF],decls:2,vars:3,consts:[["auto","matAutocomplete"],[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],[1,"eav-options-box"],["color","accent",1,"eav-mat-form-field"],["matInput","",3,"ngModelChange","matAutocomplete","ngModel"],[3,"optionSelected","hideSingleSelectionIndicator"],["itemSize","48","minBufferPx","500","maxBufferPx","1000"],[3,"value",4,"cdkVirtualFor","cdkVirtualForOf"],["mat-icon-button","","tippy","Copy",3,"click","disabled"],["align","end"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"click","disabled"],[3,"value"]],template:function(i,o){if(1&i&&(t.DNE(0,U,25,10,"div",1),t.nI1(1,"async")),2&i){let a;t.vxM(0,(a=t.bMT(1,1,o.viewModel$))?0:-1,a)}},dependencies:[d.n3,f.RG,f.rl,f.nJ,I.fS,I.fg,r.jL,r.$3,E.wT,r.pN,C.YN,C.me,C.BC,C.vS,O.d6,O.yg,O.E$,E.Sy,_.Hl,_.$z,_.iY,l.m_,l.An,c.E7,T.Jj],styles:[".eav-options-box[_ngcontent-%COMP%]{display:flex;align-items:flex-end}"]})}return s})()},1735:(x,p,n)=>{n.d(p,{V:()=>D});var r=n(9184),c=n(1567),d=n(3037),u=n(271),h=n(5057),m=n(3176),v=n(3472);class D extends m.${constructor(l,_,E){super(),this.router=l,this.route=_,this.log=E,this.log??=new v.B("BaseComponent",!1)}childDialogClosed$(){return this.router.events.pipe((0,c.p)(l=>l instanceof r.wF),(0,d.Z)(!!this.route.snapshot.firstChild),(0,u.T)(()=>!!this.route.snapshot.firstChild),(0,h.J)(),(0,c.p)(([l,_])=>l&&!_))}}}}]);
//# sourceMappingURL=https://sources.2sxc.org/18.00.01/dist/ng-edit/projects_eav-ui_src_app_replace-content_replace-content_component_ts.59a0957833999e33.js.map