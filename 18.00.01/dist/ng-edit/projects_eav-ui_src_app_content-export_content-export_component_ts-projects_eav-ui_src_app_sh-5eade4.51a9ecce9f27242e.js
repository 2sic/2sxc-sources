"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_content-export_content-export_component_ts-projects_eav-ui_src_app_sh-5eade4"],{2743:(R,f,e)=>{e.d(f,{b:()=>r});var o=e(271),M=e(6301),m=e(8764),O=e(8873),x=e(4858),D=e(4979),P=e(3472),c=e(9431),s=e(8559),d=e(6443);let r=(()=>{class C extends D.V{constructor(g,n,p,E){super(new P.B("AppDialogConfigService",!1)),this.http=g,this.context=n,this.globalConfigService=p,this.dialogSettings$={},this.log.a(`using context #${this.context.log.svcId}`),E.loadFromService(this)}ngOnDestroy(){super.destroy()}getCurrent$(){const g=this.context.appId;return this.log.a(`getCurrent$ - appId:${g}`),this.getShared$(g)}getSitePrimaryApp$(){return this.getCurrent$().pipe((0,o.T)(g=>g?.Context.Site.PrimaryApp))}getGlobalPrimaryApp$(){return this.getCurrent$().pipe((0,o.T)(g=>g?.Context.System.PrimaryApp))}getShared$(g){return this.log.a("getShared$ appId: "+g),this.dialogSettings$[g]??=this.getDialogSettings(g,"getShared$").pipe((0,M.t)({refCount:!1})),this.dialogSettings$[g]}getDialogSettings(g,n){return this.log.a("getDialogSettings",{appId:g,reqBy:n}),this.http.get("admin/dialog/settings",{params:{appId:g??this.context.appId.toString()}}).pipe((0,o.T)(p=>(p.Context.Language.List=p.Context.Language.List.filter(E=>E.IsEnabled),p)),(0,m.M)(p=>{this.globalConfigService.allowDebug(p.Context.Enable.DebugMode)}))}static#t=this.\u0275fac=function(n){return new(n||C)(s.KVO(d.Qq),s.KVO(O.o),s.KVO(c.B),s.KVO(x.D))};static#e=this.\u0275prov=s.jDH({token:C,factory:C.\u0275fac})}return C})()},7693:(R,f,e)=>{e.d(f,{X:()=>D,g:()=>C});var o=e(271),M=e(8873),m=e(8559),O=e(6443),x=e(4821);const D="admin/type/",s="admin/type/scopes";let C=(()=>{class t{constructor(n,p,E){this.http=n,this.context=p,this.dnnContext=E}apiUrl(n){return this.dnnContext.$2sxc.http.apiUrl(n)}retrieveContentType(n){return this.http.get(this.apiUrl("admin/type/get"),{params:{appId:this.context.appId.toString(),contentTypeId:n}})}retrieveContentTypes(n){return this.http.get(this.apiUrl("admin/type/list"),{params:{appId:this.context.appId.toString(),scope:n}})}getScopes(){return this.http.get(this.apiUrl(s),{params:{appId:this.context.appId.toString()}}).pipe((0,o.T)(n=>{const p=n.old;return Object.keys(p).map(v=>({name:p[v],value:v}))}))}getScopesV2(){return this.http.get(this.apiUrl(s),{params:{appId:this.context.appId.toString()}}).pipe((0,o.T)(n=>n.scopes))}save(n){return this.http.post(this.apiUrl("admin/type/save"),n,{params:{appid:this.context.appId.toString()}})}delete(n){return this.http.delete(this.apiUrl("admin/type/delete"),{params:{appid:this.context.appId.toString(),staticName:n.StaticName}})}import(n){const p=new FormData;for(const E of n)p.append("File",E);return this.http.post(this.apiUrl("admin/type/import"),p,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}createGhost(n){return this.http.post(this.apiUrl("admin/type/addghost"),null,{params:{appid:this.context.appId.toString(),sourceStaticName:n}})}static#t=this.\u0275fac=function(p){return new(p||t)(m.KVO(O.Qq),m.KVO(M.o),m.KVO(x.ob))};static#e=this.\u0275prov=m.jDH({token:t,factory:t.\u0275fac})}return t})()},5727:(R,f,e)=>{e.r(f),e.d(f,{ContentExportComponent:()=>v});var o=e(7941),M=e(5797),m=e(1873),O=e(2743),x=e(7693),D=e(6360),P=e(316),c=e(4175),s=e(3804),d=e(5060),T=e(5175),l=e(5944),r=e(4456),C=e(5437),t=e(8559),g=e(9184);function n(u,I){if(1&u&&(t.j41(0,"mat-option",10),t.EFF(1),t.k0s()),2&u){const _=I.$implicit;t.Y8G("value",_.NameId),t.R7$(),t.JRh(_.NameId)}}function p(u,I){if(1&u&&(t.j41(0,"mat-radio-button",15),t.EFF(1),t.k0s()),2&u){const _=t.XpG(2);t.R7$(),t.SpI(" Export selected ",_.itemIds.length," items ")}}function E(u,I){if(1&u){const _=t.RV6();t.j41(0,"form",null,0)(2,"div",4)(3,"p"),t.EFF(4," This will generate an XML file which you can edit in Excel. If you just want to import new data, use this to export the schema that you can then fill in using Excel. Please visit "),t.j41(5,"a",5),t.EFF(6,"https://2sxc.org/help"),t.k0s(),t.EFF(7," for more instructions. "),t.k0s(),t.j41(8,"div",6)(9,"div")(10,"mat-form-field",7)(11,"mat-label"),t.EFF(12,"Languages"),t.k0s(),t.j41(13,"mat-select",8),t.mxI("ngModelChange",function(a){t.eBV(_);const h=t.XpG();return t.DH7(h.formValues.language,a)||(h.formValues.language=a),t.Njj(a)}),t.j41(14,"mat-option",9),t.EFF(15,"All"),t.k0s(),t.Z7z(16,n,2,2,"mat-option",10,t.fX1),t.k0s()()(),t.j41(18,"div")(19,"p",11),t.EFF(20,"Export data"),t.k0s(),t.j41(21,"mat-radio-group",12),t.mxI("ngModelChange",function(a){t.eBV(_);const h=t.XpG();return t.DH7(h.formValues.recordExport,a)||(h.formValues.recordExport=a),t.Njj(a)}),t.j41(22,"mat-radio-button",13),t.EFF(23,"No, just export blank data schema (for new data import) "),t.k0s(),t.j41(24,"mat-radio-button",14),t.EFF(25,"Yes, export all content-items"),t.k0s(),t.DNE(26,p,2,1,"mat-radio-button",15),t.k0s()(),t.j41(27,"div")(28,"p",11),t.EFF(29,"Value references to other languages"),t.k0s(),t.j41(30,"mat-radio-group",16),t.mxI("ngModelChange",function(a){t.eBV(_);const h=t.XpG();return t.DH7(h.formValues.languageReferences,a)||(h.formValues.languageReferences=a),t.Njj(a)}),t.j41(31,"mat-radio-button",17),t.EFF(32,"Keep references to other languages (for re-import) "),t.k0s(),t.j41(33,"mat-radio-button",18),t.EFF(34,"Replace references with values"),t.k0s()()(),t.j41(35,"div")(36,"p",11),t.EFF(37,"File / page references"),t.k0s(),t.j41(38,"mat-radio-group",19),t.mxI("ngModelChange",function(a){t.eBV(_);const h=t.XpG();return t.DH7(h.formValues.resourcesReferences,a)||(h.formValues.resourcesReferences=a),t.Njj(a)}),t.j41(39,"mat-radio-button",17),t.EFF(40,"Keep references (for re-import, for example Page:4711) "),t.k0s(),t.j41(41,"mat-radio-button",18),t.EFF(42,"Replace references with real URLs (for example /Portals/0...) "),t.k0s()()()()(),t.j41(43,"mat-dialog-actions",20)(44,"button",21),t.bIt("click",function(){t.eBV(_);const a=t.XpG();return t.Njj(a.closeDialog())}),t.EFF(45,"Cancel"),t.k0s(),t.j41(46,"button",22),t.bIt("click",function(){t.eBV(_);const a=t.XpG();return t.Njj(a.exportContent())}),t.EFF(47," Export Data "),t.k0s()()()}if(2&u){const _=t.sdS(1),i=t.XpG();t.R7$(13),t.R50("ngModel",i.formValues.language),t.R7$(3),t.Dyx(i.languages),t.R7$(5),t.R50("ngModel",i.formValues.recordExport),t.R7$(5),t.vxM(26,i.hasIdList?26:-1),t.R7$(4),t.R50("ngModel",i.formValues.languageReferences),t.Y8G("disabled","Blank"===i.formValues.recordExport),t.R7$(8),t.R50("ngModel",i.formValues.resourcesReferences),t.Y8G("disabled","Blank"===i.formValues.recordExport),t.R7$(8),t.Y8G("disabled",!_.form.valid)}}let v=(()=>{class u{constructor(_,i){this.dialogRef=_,this.route=i,this.hostClass="dialog-component",this.contentExportService=(0,C.d)(D.D),this.contentTypesService=(0,C.d)(x.g),this.appDialogConfigService=(0,C.d)(O.b),this.hasIdList=!1,this.loading$=new M.t(!1),this.contentType$=new M.t(null),this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName");const a=this.route.snapshot.paramMap.get("selectedIds");this.hasIdList=!!a,this.hasIdList&&(this.itemIds=a.split(",").map(h=>parseInt(h,10)))}ngOnInit(){this.loading$.next(!0);const _=this.contentTypesService.retrieveContentType(this.contentTypeStaticName),i=this.appDialogConfigService.getCurrent$();(0,m.p)([_,i]).subscribe(([a,h])=>{this.contentType$.next(a),this.languages=h.Context.Language.List,this.formValues={defaultLanguage:h.Context.Language.Primary,contentTypeStaticName:this.contentTypeStaticName,language:"",recordExport:this.hasIdList?"Selection":"All",languageReferences:"Link",resourcesReferences:"Link"},this.loading$.next(!1)})}ngOnDestroy(){this.contentType$.complete(),this.loading$.complete()}closeDialog(){this.dialogRef.close()}exportContent(){this.contentExportService.exportContent(this.formValues,this.hasIdList&&"Selection"===this.formValues.recordExport?this.itemIds:null)}static#t=this.\u0275fac=function(i){return new(i||u)(t.rXU(o.CP),t.rXU(g.nX))};static#e=this.\u0275cmp=t.VBU({type:u,selectors:[["app-content-export"]],hostVars:1,hostBindings:function(i,a){2&i&&t.Mr5("className",a.hostClass)},standalone:!0,features:[t.aNF],decls:7,vars:6,consts:[["ngForm","ngForm"],[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],["href","https://2sxc.org/help","target","_blank"],[1,"dialog-form-content","fancy-scrollbar-light"],["color","accent",1,"eav-mat-form-field"],["name","Language",3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"eav-radio-group-label"],["name","RecordExport",1,"eav-radio-group",3,"ngModelChange","ngModel"],["value","Blank"],["value","All"],["value","Selection"],["name","LanguageReferences",1,"eav-radio-group",3,"ngModelChange","ngModel","disabled"],["value","Link"],["value","Resolve"],["name","ResourcesReferences",1,"eav-radio-group",3,"ngModelChange","ngModel","disabled"],["align","end"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"click","disabled"]],template:function(i,a){if(1&i&&(t.j41(0,"div",1)(1,"div",2)(2,"div",3),t.EFF(3),t.nI1(4,"async"),t.k0s()(),t.DNE(5,E,48,8,"form"),t.nI1(6,"async"),t.k0s()),2&i){let h;t.R7$(3),t.SpI("Export ",null==(h=t.bMT(4,2,a.contentType$))?null:h.Name,""),t.R7$(2),t.vxM(5,!1===t.bMT(6,4,a.loading$)?5:-1)}},dependencies:[r.YN,r.qT,r.BC,r.cb,r.vS,r.cV,l.RG,l.rl,l.nJ,T.Ve,T.VO,d.wT,d.Sy,s.Wk,s.VT,s._g,o.E7,c.Hl,c.$z,P.Jj],styles:[".eav-radio-group-label[_ngcontent-%COMP%]{font-size:18px;margin:24px 0 0}.eav-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:8px 0}"]})}return u})()},1576:(R,f,e)=>{e.d(f,{W:()=>M});var o=e(3826);class M{static#t=this.boolEquals={equal:o.a.valueEquals};static#e=this.numberEquals={equal:o.a.valueEquals};static#n=this.stringEquals={equal:o.a.valueEquals};static#a=this.objectEquals={equal:o.a.objectsEqual}}},9234:(R,f,e)=>{e.d(f,{Gg:()=>t,Tr:()=>g,gb:()=>C});var o=e(1567),M=e(6647),m=e(6301),O=e(271),x=e(4979),D=e(3472),P=e(4839),c=e(1736),s=e(5437),d=e(8559),T=e(6443),l=e(4821);const C="admin/entity/",t="admin/entity/list";let g=(()=>{class n extends x.V{constructor(E,v,u){super(new D.B("EntityService",!1)),this.http=E,this.formConfig=v,this.dnnContext=u,this.queryService=(0,s.d)(P.c)}getEntities$(E){return E.pipe((0,o.p)(v=>null!=v),(0,M.n)(v=>this.getAvailableEntities(v.contentTypeName).pipe((0,m.t)(1))))}getAvailableEntities(E,v){var u=this.log.rxTap("getEntities",{enabled:!0});return this.queryService.getEntities({contentTypes:[E],itemIds:v,fields:"Id,Guid,Title",log:"getAvailableEntities"}).pipe(u.pipe(),(0,O.T)(I=>I.Default))}delete(E,v,u,I,_){return this.http.delete(this.dnnContext.$2sxc.http.apiUrl(C+"delete"),{params:{contentType:E,id:v.toString(),appId:this.formConfig.config.appId,force:u.toString(),...I&&{parentId:I.toString()},...I&&_&&{parentField:_}}})}static#t=this.\u0275fac=function(v){return new(v||n)(d.KVO(T.Qq),d.KVO(c.S),d.KVO(l.ob))};static#e=this.\u0275prov=d.jDH({token:n,factory:n.\u0275fac})}return n})()},4858:(R,f,e)=>{e.d(f,{D:()=>s});var o=e(8559),M=e(6042),m=e(271),O=e(4979),x=e(3472),D=e(1576),P=e(3826);let s=(()=>{class d extends O.V{constructor(){super(new x.B("FeaturesService",!1)),this.dialogContext$=new M.m(1),this.dialogContextSignal=(0,o.vPA)(null)}loadFromService(l){l.getCurrent$().subscribe(r=>this.load(r.Context))}load(l){this.dialogContext$.next(l),this.dialogContextSignal.set(l)}getAll(){return(0,o.EWP)(()=>this.dialogContextSignal()?.Features??[],{equal:P.a.arraysEqual})}get$(l){return this.dialogContext$.pipe((0,m.T)(r=>r?.Features.find(C=>C.nameId===l)))}getSignal(l){return(0,o.EWP)(()=>this.dialogContextSignal()?.Features.find(r=>r.nameId===l),{equal:P.a.objectsEqual})}isEnabled$(l){return this.get$(l).pipe((0,m.T)(r=>r?.isEnabled??!1))}isEnabled(l){return(0,o.EWP)(()=>this.dialogContextSignal()?.Features.find(r=>r.nameId===l)?.isEnabled??!1,D.W.boolEquals)}static#t=this.\u0275fac=function(r){return new(r||d)};static#e=this.\u0275prov=o.jDH({token:d,factory:d.\u0275fac,providedIn:"root"})}return d})()},9431:(R,f,e)=>{e.d(f,{B:()=>x});var o=e(8559),M=e(9074),m=e(8172),O=e(3347);let x=(()=>{class D{constructor(c){this.snackBar=c,this.debugState=(0,o.vPA)(null),this.isDebug=(0,o.EWP)(()=>!!this.debugState()?.allowDebugMode&&!!this.debugState()?.debugEnabled),this.debugEnabled$=(0,M.br)(this.isDebug);const s={id:0,debugEnabled:"true"===sessionStorage.getItem(m.tn),allowDebugMode:!1};this.debugState.set(s)}allowDebug(c){const s=this.debugState();if(s.allowDebugMode===c)return;const d={...s,allowDebugMode:c};this.debugState.set(d)}toggleDebugEnabled(){const c=this.debugState();if(!c.allowDebugMode)return void this.snackBar.open("You do not have permissions to enter developer mode",null,{duration:3e3});const s={...c,debugEnabled:!c.debugEnabled};this.debugState.set(s),this.snackBar.open(s.debugEnabled?"developer mode on":"developer mode off",null,{duration:3e3})}static#t=this.\u0275fac=function(s){return new(s||D)(o.KVO(O.UG))};static#e=this.\u0275prov=o.jDH({token:D,factory:D.\u0275fac,providedIn:"root"})}return D})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/18.00.01/dist/ng-edit/projects_eav-ui_src_app_content-export_content-export_component_ts-projects_eav-ui_src_app_sh-5eade4.51a9ecce9f27242e.js.map