"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_apps-management_add-app-from-folder_add-app-from-folder_component_ts--ecd9e6"],{8242:(O,p,e)=>{e.r(p),e.d(p,{AddAppFromFolderComponent:()=>$});var t=e(8559),u=e(7941),C=e(4205),F=e(9999),d=e(3037),A=e(6647),x=e(1318),f=e(9452),y=e(1870),i=e(271),P=e(8136),r=e(3176),l=e(251),h=e(9001),m=e(3583),c=e(3840),v=e(7896);let D=(()=>{class s{agInit(n){this.name=n.value,this.tooltip=n.tooltipGetter(n.data)}refresh(n){return!0}static#t=this.\u0275fac=function(o){return new(o||s)};static#e=this.\u0275cmp=t.VBU({type:s,selectors:[["app-app-name-show"]],standalone:!0,features:[t.aNF],decls:5,vars:2,consts:[[1,"name-box"],[1,"info-icon",3,"tippy"]],template:function(o,a){1&o&&(t.j41(0,"div",0)(1,"span"),t.EFF(2),t.k0s(),t.j41(3,"mat-icon",1),t.EFF(4,"info"),t.k0s()()),2&o&&(t.R7$(2),t.JRh(a.name),t.R7$(),t.Y8G("tippy",a.tooltip))},dependencies:[c.m_,c.An,v.e],styles:[".name-box[_ngcontent-%COMP%]{display:flex;align-items:center}.info-icon[_ngcontent-%COMP%]{margin-left:7px;margin-bottom:3px}"]})}return s})(),S=(()=>{class s{agInit(n){this.params=n}refresh(n){return!0}onChange(n){this.params.onChange(this.params.data,n.currentTarget.checked)}static#t=this.\u0275fac=function(o){return new(o||s)};static#e=this.\u0275cmp=t.VBU({type:s,selectors:[["app-checkbox-cell"]],standalone:!0,features:[t.aNF],decls:2,vars:2,consts:[[1,"checkbox-box"],["type","checkbox",1,"checkbox-input",3,"change","disabled","checked"]],template:function(o,a){1&o&&(t.j41(0,"div",0)(1,"input",1),t.bIt("change",function(G){return a.onChange(G)}),t.k0s()()),2&o&&(t.R7$(),t.Y8G("disabled",a.params.isDisabled)("checked",a.params.value))},styles:[".checkbox-box[_ngcontent-%COMP%]{height:100%;display:flex;align-items:center}.checkbox-input[_ngcontent-%COMP%]{height:15px;width:15px}"]})}return s})();var T=e(316),M=e(4175),I=e(5469),b=e(7037),R=e(5437),B=e(3347),N=e(9841);function U(s,E){1&s&&(t.j41(0,"p"),t.EFF(1," Nothing to show. All apps in the 2sxc folder are already installed. "),t.k0s())}function j(s,E){if(1&s&&(t.j41(0,"div"),t.nrm(1,"ag-grid-angular",8),t.k0s()),2&s){const n=t.XpG(),o=t.XpG();t.R7$(),t.Y8G("rowData",n.pendingApps)("gridOptions",o.gridOptions)}}function W(s,E){if(1&s){const n=t.RV6();t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.EFF(3,"Add App from Folder"),t.k0s()(),t.j41(4,"div",3),t.nrm(5,"app-feature-text-info",4),t.j41(6,"p"),t.EFF(7," Select an app from the apps-folder which has been copied there (or git-cloned) but not installed yet. "),t.k0s(),t.DNE(8,U,2,0,"p")(9,j,2,2,"div"),t.k0s(),t.j41(10,"mat-dialog-actions",5)(11,"button",6),t.bIt("click",function(){t.eBV(n);const a=t.XpG();return t.Njj(a.closeDialog())}),t.EFF(12," Cancel "),t.k0s(),t.j41(13,"button",7),t.bIt("click",function(){t.eBV(n);const a=t.XpG();return t.Njj(a.install())}),t.EFF(14," Install "),t.k0s()()()}if(2&s){const n=E,o=t.XpG();t.R7$(5),t.Y8G("featureNameId","AppSyncWithSiteFiles"),t.R7$(3),t.vxM(8,0==(null==n.pendingApps?null:n.pendingApps.length)?8:-1),t.R7$(),t.vxM(9,(null==n.pendingApps?null:n.pendingApps.length)>0?9:-1),t.R7$(4),t.Y8G("disabled",0===o.pendingApps.length||o.installing)}}let $=(()=>{class s extends r.${constructor(n,o){super(),this.dialogRef=n,this.snackBar=o,this.hostClass="dialog-component",this.gridOptions=this.buildGridOptions(),this.pendingApps=[],this.installing=!1,this.refreshApps$=new C.B,this.features=(0,t.WQX)(h.D),this.isAddFromFolderEnabled=this.features.isEnabled(P.T.AppSyncWithSiteFiles),this.appsListService=(0,R.d)(m.U)}ngOnInit(){this.viewModel$=(0,F.z)([this.refreshApps$.pipe((0,d.Z)(void 0),(0,A.n)(()=>this.appsListService.getPendingApps().pipe((0,x.W)(()=>(0,f.of)(void 0)))),(0,y.u)())]).pipe((0,i.T)(([n])=>({pendingApps:n})))}ngOnDestroy(){this.refreshApps$.complete(),super.ngOnDestroy()}closeDialog(){this.dialogRef.close()}onChange(n,o){o?this.pendingApps.push(n):this.pendingApps.splice(this.pendingApps.indexOf(n),1)}install(){this.installing=!0,this.snackBar.open("Installing",void 0,{duration:2e3}),this.appsListService.installPendingApps(this.pendingApps).subscribe({error:()=>{this.installing=!1,this.snackBar.open("Failed to install app. Please check console for more information",void 0,{duration:3e3})},next:()=>{this.installing=!1,this.snackBar.open("Installed app",void 0,{duration:2e3}),this.closeDialog()}})}buildGridOptions(){return{...l.C,columnDefs:[{field:"",width:40,cellClass:"no-outline",sortable:!0,cellRenderer:S,cellRendererParams:()=>({isDisabled:!this.isAddFromFolderEnabled,onChange:(a,g)=>this.onChange(a,g)})},{field:"Name",flex:1,cellClass:"no-outline",sortable:!0,sort:"asc",filter:"agTextColumnFilter",cellRenderer:D,cellRendererParams:{tooltipGetter:a=>`Server folder: ${a.ServerFolder}\nFolder: ${a.Folder}\nVersion: ${a.Version}\nDescription: ${a.Description}`}}]}}static#t=this.\u0275fac=function(o){return new(o||s)(t.rXU(u.CP),t.rXU(B.UG))};static#e=this.\u0275cmp=t.VBU({type:s,selectors:[["app-add-app-from-folder"]],hostVars:1,hostBindings:function(o,a){2&o&&t.Mr5("className",a.hostClass)},standalone:!0,features:[t.Vt3,t.aNF],decls:2,vars:3,consts:[[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],[3,"featureNameId"],["align","end"],["type","button","mat-raised-button","",3,"click"],["type","button","mat-raised-button","","color","accent",3,"click","disabled"],[1,"ag-theme-material","eav-grid",3,"rowData","gridOptions"]],template:function(o,a){if(1&o&&(t.DNE(0,W,15,4,"div",0),t.nI1(1,"async")),2&o){let g;t.vxM(0,(g=t.bMT(1,1,a.viewModel$))?0:-1,g)}},dependencies:[u.E7,M.Hl,M.$z,T.Jj,I.L,b.p,N.xs],styles:[".eav-grid[_ngcontent-%COMP%]{height:200px;width:auto}"]})}return s})()},8136:(O,p,e)=>{e.d(p,{T:()=>t});const t={AppSyncWithSiteFiles:"AppSyncWithSiteFiles",WysiwygPasteFormatted:"WysiwygPasteFormatted",PasteImageFromClipboard:"PasteImageFromClipboard",EditUiShowNotes:"EditUiShowNotes",EditUiShowMetadataFor:"EditUiShowMetadataFor",NoSponsoredByToSic:"NoSponsoredByToSic",EditUiTranslateWithGoogle:"EditUiTranslateWithGoogle",LightSpeed:"LightSpeedOutputCache",ContentSecurityPolicy:"ContentSecurityPolicy",PermissionsByLanguage:"PermissionsByLanguage",FieldShareConfigManagement:"FieldShareConfigManagement",AppExportAssetsAdvanced:"AppExportAssetsAdvanced"}},1772:(O,p,e)=>{e.d(p,{I:()=>y,u:()=>f});var t=e(6647),u=e(9452),C=e(3550),F=e(8873),d=e(8559),A=e(6443),x=e(4821);const f="admin/app/";let y=(()=>{class i{constructor(r,l,h){this.http=r,this.context=l,this.dnnContext=h}importApp(r,l,h=!1){const m=new FormData;return m.append("File",r),m.append("Name",l??""),this.http.post(this.dnnContext.$2sxc.http.apiUrl(f+"Import"),m,{params:{zoneId:this.context.zoneId.toString()}}).pipe((0,t.n)(c=>{if(h&&c.Messages[0]?.MessageType===C.G1.Warning){const v=prompt(c.Messages[0].Text+" Would you like to install it using another folder name?");if(v)return this.importApp(r,v,!0)}return(0,u.of)(c)}))}static#t=this.\u0275fac=function(l){return new(l||i)(d.KVO(A.Qq),d.KVO(F.o),d.KVO(x.ob))};static#e=this.\u0275prov=d.jDH({token:i,factory:i.\u0275fac})}return i})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/18.00.01/dist/ng-edit/projects_eav-ui_src_app_apps-management_add-app-from-folder_add-app-from-folder_component_ts--ecd9e6.1d89cbb71aee8076.js.map