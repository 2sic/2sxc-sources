"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_app-administration_sub-dialogs_edit-content-type_edit-content-type_co-2abec4"],{8407:(H,f,o)=>{o.r(f),o.d(f,{EditContentTypeComponent:()=>Z});var y=o(7941),m=o(5797),C=o(9999),g=o(271),F=o(9452),T=o(5858),b=o(52);const S=/(^[A-Za-z][A-Za-z0-9]*$)|(^@[A-Za-z][A-Za-z0-9\-]*$)/.toString(),j=S.substring(1,S.toString().length-1);var k=o(7693),R=o(316),$=o(3840),v=o(4175),E=o(5060),N=o(5175),r=o(353),x=o(7984),h=o(5944),c=o(4456),_=o(3758),G=o(9333),O=o(7896),I=o(5437),t=o(8559),X=o(2159),A=o(3347);function D(i,p){1&i&&(t.j41(0,"app-field-hint",19),t.EFF(1,"This field is required"),t.k0s()),2&i&&t.Y8G("isError",!0)}function B(i,p){if(1&i&&(t.j41(0,"app-field-hint",19),t.EFF(1),t.k0s()),2&i){const e=t.XpG(4);t.Y8G("isError",!0),t.R7$(),t.JRh(e.contentTypeNameError)}}function Y(i,p){if(1&i&&t.DNE(0,D,2,1,"app-field-hint",19)(1,B,2,2,"app-field-hint",19),2&i){t.XpG();const e=t.sdS(9);t.vxM(0,e.errors.required?0:-1),t.R7$(),t.vxM(1,e.errors.pattern?1:-1)}}function V(i,p){if(1&i&&(t.j41(0,"mat-option",12),t.EFF(1),t.k0s()),2&i){const e=p.$implicit;t.Y8G("value",e.value),t.R7$(),t.SpI(" ",e.name," ")}}function P(i,p){if(1&i&&(t.j41(0,"div",7)(1,"h3"),t.EFF(2,"Shared Content Type (Ghost)"),t.k0s(),t.j41(3,"p"),t.EFF(4,"Note: this can't be edited in the UI, for now if you really know what you're doing, do it in the DB "),t.k0s(),t.j41(5,"p"),t.EFF(6),t.k0s()()),2&i){const e=t.XpG(2);t.R7$(6),t.SpI("Uses Type Definition of: ",e.contentType.SharedDefId,"")}}function z(i,p){if(1&i){const e=t.RV6();t.j41(0,"form",5,0),t.bIt("ngSubmit",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.save())}),t.j41(2,"div",6)(3,"div")(4,"div",7)(5,"mat-form-field",8)(6,"mat-label"),t.EFF(7,"Name"),t.k0s(),t.j41(8,"input",9,1),t.bIt("ngModelChange",function(n){t.eBV(e);const s=t.XpG(2);return t.Njj(s.changeContentTypeName(n))}),t.k0s()(),t.DNE(10,Y,2,2),t.k0s(),t.j41(11,"mat-accordion")(12,"mat-expansion-panel")(13,"mat-expansion-panel-header")(14,"mat-panel-title"),t.EFF(15,"Advanced"),t.k0s(),t.nrm(16,"mat-panel-description"),t.k0s(),t.j41(17,"div",7)(18,"div",10)(19,"mat-form-field",8)(20,"mat-label"),t.EFF(21,"Scope"),t.k0s(),t.j41(22,"mat-select",11),t.bIt("ngModelChange",function(n){t.eBV(e);const s=t.XpG(2);return t.Njj(s.changeScope(n))}),t.Z7z(23,V,2,2,"mat-option",12,t.fX1),t.j41(25,"mat-option",12),t.EFF(26,"Other..."),t.k0s()()(),t.j41(27,"button",13),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.unlockScope())}),t.j41(28,"mat-icon"),t.EFF(29),t.k0s()()(),t.j41(30,"app-field-hint"),t.EFF(31," The scope should almost never be changed - "),t.j41(32,"a",14),t.EFF(33,"see help"),t.k0s()()(),t.j41(34,"div",7)(35,"mat-form-field",8)(36,"mat-label"),t.EFF(37,"Static Name"),t.k0s(),t.nrm(38,"input",15),t.k0s()(),t.DNE(39,P,7,1,"div",7),t.k0s()()()(),t.j41(40,"mat-dialog-actions",16)(41,"button",17),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.closeDialog())}),t.EFF(42,"Cancel"),t.k0s(),t.j41(43,"button",18),t.EFF(44," Save "),t.k0s()()()}if(2&i){const e=t.sdS(1),a=t.sdS(9),n=t.XpG(),s=t.XpG();t.R7$(8),t.Y8G("pattern",s.contentTypeNamePattern)("ngModel",n.contentType.Name),t.R7$(2),t.vxM(10,a.touched&&a.errors?10:-1),t.R7$(),t.Y8G("@.disabled",n.disableAnimation),t.R7$(11),t.Y8G("ngModel",n.contentType.Scope)("disabled",n.lockScope),t.R7$(),t.Dyx(n.scopeOptions),t.R7$(2),t.Y8G("value",s.dropdownInsertValue),t.R7$(2),t.Y8G("tippy",n.lockScope?"Unlock":"Lock"),t.R7$(2),t.SpI(" ",n.lockScope?"lock":"lock_open"," "),t.R7$(9),t.Y8G("ngModel",n.contentType.StaticName),t.R7$(),t.vxM(39,n.contentType.SharedDefId?39:-1),t.R7$(4),t.Y8G("disabled",!e.form.valid||n.loading)}}function U(i,p){if(1&i&&(t.j41(0,"div",2)(1,"div",3)(2,"div",4),t.EFF(3),t.k0s()(),t.DNE(4,z,45,12,"form"),t.k0s()),2&i){const e=t.XpG();t.R7$(3),t.JRh(e.contentTypeStaticName?"Edit Content Type":"New Content Type"),t.R7$(),t.vxM(4,p.contentType?4:-1)}}let Z=(()=>{class i{constructor(e,a,n){this.dialogRef=e,this.route=a,this.snackBar=n,this.hostClass="dialog-component",this.contentTypesService=(0,I.d)(k.g),this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName"),this.contentTypeNamePattern=j,this.contentTypeNameError="Standard letters and numbers are allowed. Must start with a letter.",this.dropdownInsertValue=T.O,this.contentType$=new m.t(null),this.lockScope$=new m.t(!0),this.scopeOptions$=new m.t(null),this.disableAnimation$=new m.t(!0),this.loading$=new m.t(!1),this.viewModel$=(0,C.z)([this.contentType$,this.lockScope$,this.scopeOptions$,this.disableAnimation$,this.loading$]).pipe((0,g.T)(([s,d,l,u,J])=>({contentType:s,lockScope:d,scopeOptions:l,disableAnimation:u,loading:J}))),this.scope=this.route.snapshot.parent.paramMap.get("scope")}ngOnInit(){const e=this.contentTypeStaticName?this.contentTypesService.retrieveContentType(this.contentTypeStaticName).pipe((0,g.T)(n=>({...n,ChangeStaticName:!1,NewStaticName:n.StaticName}))):(0,F.of)({StaticName:"",Name:"",Description:"",Scope:this.scope,ChangeStaticName:!1,NewStaticName:""}),a=this.contentTypesService.getScopes();(0,C.z)([e,a]).subscribe(([n,s])=>{this.contentType$.next(n);const d=[...this.scopeOptions$.value??[]];s.forEach(l=>{d.some(u=>u.value===l.value)||d.push(l)}),d.some(l=>l.value===this.scope)||d.push({name:this.scope,value:this.scope}),this.scopeOptions$.next(d)})}ngOnDestroy(){this.contentType$.complete(),this.lockScope$.complete(),this.scopeOptions$.complete(),this.disableAnimation$.complete(),this.loading$.complete()}ngAfterViewInit(){setTimeout(()=>this.disableAnimation$.next(!1))}closeDialog(){this.dialogRef.close()}changeContentTypeName(e){this.contentType$.next({...this.contentType$.value,Name:e})}changeScope(e){e!==T.O||(e=prompt("This is an advanced feature to show content-types of another scope. Don't use this if you don't know what you're doing, as content-types of other scopes are usually hidden for a good reason.")||b.YX.scopes.default.value,this.scopeOptions$.value.some(a=>a.value===e))||this.scopeOptions$.next([{name:e,value:e},...this.scopeOptions$.value]),this.contentType$.next({...this.contentType$.value,Scope:e})}unlockScope(){this.lockScope$.next(!this.lockScope$.value),this.lockScope$.value&&this.contentType$.next({...this.contentType$.value,Scope:this.scope})}save(){this.loading$.next(!0),this.snackBar.open("Saving..."),this.contentTypesService.save(this.contentType$.value).subscribe(e=>{this.loading$.next(!1),this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()}),document.activeElement instanceof HTMLElement&&document.activeElement.blur()}static#t=this.\u0275fac=function(a){return new(a||i)(t.rXU(y.CP),t.rXU(X.nX),t.rXU(A.UG))};static#e=this.\u0275cmp=t.VBU({type:i,selectors:[["app-edit-content-type"]],hostVars:1,hostBindings:function(a,n){2&a&&t.Mr5("className",n.hostClass)},standalone:!0,features:[t.aNF],decls:2,vars:3,consts:[["ngForm","ngForm"],["name","ngModel"],[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[3,"ngSubmit"],[1,"eav-dialog-content"],[1,"eav-edit-input"],["color","accent",1,"eav-mat-form-field"],["matInput","","type","text","required","","name","Name",3,"ngModelChange","pattern","ngModel"],[1,"eav-form-and-button"],["name","Scope",3,"ngModelChange","ngModel","disabled"],[3,"value"],["mat-icon-button","","type","button","matTextSuffix","",1,"eav-scope-button",3,"click","tippy"],["href","https://2sxc.org/help?tag=scope","target","_blank","appClickStopPropagation",""],["matInput","","type","text","name","StaticName","disabled","",3,"ngModel"],["align","end"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","submit","color","accent",3,"disabled"],[3,"isError"]],template:function(a,n){if(1&a&&(t.DNE(0,U,5,2,"div",2),t.nI1(1,"async")),2&a){let s;t.vxM(0,(s=t.bMT(1,1,n.viewModel$))?0:-1,s)}},dependencies:[c.YN,c.qT,c.me,c.BC,c.cb,c.YS,c.R_,c.vS,c.cV,h.RG,h.rl,h.nJ,h.yw,x.fS,x.fg,r.MY,r.BS,r.GK,r.Z2,r.WN,r.Q6,N.Ve,N.VO,E.wT,E.Sy,v.Hl,v.$z,v.iY,$.m_,$.An,y.E7,R.Jj,_.F,G.c,O.e],styles:[".eav-edit-input[_ngcontent-%COMP%]{padding-bottom:8px}.eav-form-and-button[_ngcontent-%COMP%]{display:flex;align-items:baseline;justify-content:space-between}.eav-form-and-button[_ngcontent-%COMP%]   .eav-scope-button[_ngcontent-%COMP%]{margin-left:8px}"]})}return i})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/18.00.01/dist/ng-edit/projects_eav-ui_src_app_app-administration_sub-dialogs_edit-content-type_edit-content-type_co-2abec4.61b74d3c0da50342.js.map