"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_replace-content_replace-content_component_ts-node_modules_rxjs_dist_e-178ebb"],{4513:(B,m,n)=>{n.r(m),n.d(m,{ReplaceContentComponent:()=>L});var u=n(9771),h=n(7941),p=n(2159),E=n(5797),v=n(9999),C=n(271),M=n(9669),f=n(1735),O=n(3216),P=n(316),s=n(3840),d=n(4175),g=n(5060),r=n(2275),l=n(4456),_=n(7984),D=n(5944),$=n(5437),t=n(8559),j=n(3347);function A(c,R){if(1&c&&(t.j41(0,"mat-option",15),t.EFF(1),t.k0s()),2&c){const e=R.$implicit;t.Y8G("value",e),t.R7$(),t.JRh(e)}}function U(c,R){if(1&c){const e=t.RV6();t.j41(0,"div",1)(1,"div",2)(2,"div",3),t.EFF(3),t.k0s()(),t.j41(4,"div",4),t.nrm(5,"router-outlet"),t.j41(6,"p"),t.EFF(7),t.k0s(),t.j41(8,"div",5)(9,"mat-form-field",6)(10,"mat-label"),t.EFF(11,"Choose item"),t.k0s(),t.j41(12,"input",7),t.bIt("ngModelChange",function(o){t.eBV(e);const a=t.XpG();return t.Njj(a.setFilter(o))}),t.k0s(),t.j41(13,"mat-autocomplete",8,0),t.bIt("optionSelected",function(o){t.eBV(e);const a=t.XpG();return t.Njj(a.select(o))}),t.j41(15,"cdk-virtual-scroll-viewport",9),t.DNE(16,A,2,2,"mat-option",10),t.k0s()()(),t.j41(17,"button",11),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.copySelected())}),t.j41(18,"mat-icon"),t.EFF(19,"file_copy"),t.k0s()()()(),t.j41(20,"mat-dialog-actions",12)(21,"button",13),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.closeDialog())}),t.EFF(22,"Cancel"),t.k0s(),t.j41(23,"button",14),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.save())}),t.EFF(24,"Save"),t.k0s()()()}if(2&c){const e=R,i=t.sdS(14);t.R7$(3),t.JRh(e.isAddMode?"Add Existing Item":"Replace Content Item"),t.R7$(4),t.SpI("",e.isAddMode?"Select a content-item to add to this list.":"By replacing a content-item you can make other content appear in the slot of the original content."," "),t.R7$(5),t.Y8G("matAutocomplete",i)("ngModel",e.filterText),t.R7$(),t.Y8G("hideSingleSelectionIndicator",!0),t.R7$(2),t.xc7("height",e.filteredOptions.length<6?48*e.filteredOptions.length:240,"px"),t.R7$(),t.Y8G("cdkVirtualForOf",e.filteredOptions),t.R7$(),t.Y8G("disabled",!e.isMatch),t.R7$(6),t.Y8G("disabled",!e.isMatch)}}let L=(()=>{class c extends f.V{constructor(e,i,o,a){super(e,i),this.router=e,this.route=i,this.dialogRef=o,this.snackBar=a,this.hostClass="dialog-component",this.contentGroupService=(0,$.d)(M.y)}ngOnInit(){this.guid=this.route.snapshot.paramMap.get("guid"),this.part=this.route.snapshot.paramMap.get("part"),this.index=parseInt(this.route.snapshot.paramMap.get("index"),10),this.add=!!this.route.snapshot.queryParamMap.get("add"),this.filterText$=new E.t(""),this.options$=new E.t([]);const e=(0,v.z)([this.filterText$,this.options$]).pipe((0,C.T)(([i,o])=>o.filter(a=>a.label.toLocaleLowerCase().includes(i.toLocaleLowerCase())).map(a=>a.label)));this.viewModel$=(0,v.z)([this.filterText$,e]).pipe((0,C.T)(([i,o])=>({filterText:i,filteredOptions:o,isAddMode:this.add,isMatch:o.includes(i)}))),this.fetchConfig(!1,null),this.subscriptions.add(this.childDialogClosed$().subscribe(()=>{const o=this.router.getCurrentNavigation().extras?.state,a=o?.[Object.keys(o)[0]];this.fetchConfig(!0,a)}))}ngOnDestroy(){this.filterText$.complete(),this.options$.complete(),super.ngOnDestroy()}closeDialog(){this.dialogRef.close()}setFilter(e){this.filterText$.next(e)}select(e){this.filterText$.next(e.option.value)}copySelected(){const e=this.buildContentGroup(),o=(0,O.s)({items:[{ContentTypeName:this.contentTypeName,DuplicateEntity:e.id}]});this.router.navigate([`edit/${o}`],{relativeTo:this.route})}save(){this.snackBar.open("Saving...");const e=this.buildContentGroup();this.contentGroupService.saveItem(e).subscribe(()=>{this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()})}fetchConfig(e,i){const o=this.buildContentGroup();this.contentGroupService.getItems(o).subscribe(a=>{const W=Object.entries(a.Items).map(([T,I])=>({id:parseInt(T,10),label:`${I} (${T})`}));if(this.options$.next(W),!o.add&&!e||null!=i){const T=e?i:a.SelectedId,I=this.options$.value.find(x=>x.id===T)?.label||"";this.filterText$.next(I)}this.contentTypeName=a.ContentTypeName})}buildContentGroup(){return{id:this.options$.value.find(o=>o.label===this.filterText$.value)?.id??null,guid:this.guid,part:this.part,index:this.index,add:this.add}}static#t=this.\u0275fac=function(i){return new(i||c)(t.rXU(p.Ix),t.rXU(p.nX),t.rXU(h.CP),t.rXU(j.UG))};static#n=this.\u0275cmp=t.VBU({type:c,selectors:[["app-replace-content"]],hostVars:1,hostBindings:function(i,o){2&i&&t.Mr5("className",o.hostClass)},standalone:!0,features:[t.Vt3,t.aNF],decls:2,vars:3,consts:[["auto","matAutocomplete"],[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],[1,"eav-options-box"],["color","accent",1,"eav-mat-form-field"],["matInput","",3,"ngModelChange","matAutocomplete","ngModel"],[3,"optionSelected","hideSingleSelectionIndicator"],["itemSize","48","minBufferPx","500","maxBufferPx","1000"],[3,"value",4,"cdkVirtualFor","cdkVirtualForOf"],["mat-icon-button","","tippy","Copy",3,"click","disabled"],["align","end"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"click","disabled"],[3,"value"]],template:function(i,o){if(1&i&&(t.DNE(0,U,25,10,"div",1),t.nI1(1,"async")),2&i){let a;t.vxM(0,(a=t.bMT(1,1,o.viewModel$))?0:-1,a)}},dependencies:[p.n3,D.RG,D.rl,D.nJ,_.fS,_.fg,u.jL,u.$3,g.wT,u.pN,l.YN,l.me,l.BC,l.vS,r.d6,r.yg,r.E$,g.Sy,d.Hl,d.$z,d.iY,s.m_,s.An,h.E7,P.Jj],styles:[".eav-options-box[_ngcontent-%COMP%]{display:flex;align-items:flex-end}"]})}return c})()},1735:(B,m,n)=>{n.d(m,{V:()=>O});var u=n(2159),h=n(1567),p=n(3037),E=n(271),v=n(5057),C=n(3176),M=n(8147);class O extends C.${constructor(s,d,g){super(),this.router=s,this.route=d,this.log=g,this.log??=new M.B("BaseComponent",!1)}childDialogClosed$(){return this.router.events.pipe((0,h.p)(s=>s instanceof u.wF),(0,p.Z)(!!this.route.snapshot.firstChild),(0,E.T)(()=>!!this.route.snapshot.firstChild),(0,v.J)(),(0,h.p)(([s,d])=>s&&!d))}}},591:(B,m,n)=>{n.d(m,{c:()=>g});var u=n(8473),h=n(3513),p=n(4334),E=n(819),v=n(1687),C=n(4318),f=n(7378),O=n(1365),P=n(2645);function s(r,l){return l?_=>(0,h.x)(l.pipe((0,p.s)(1),function M(){return(0,E.N)((r,l)=>{r.subscribe((0,v._)(l,C.l))})}()),_.pipe(s(r))):(0,O.Z)((_,D)=>(0,P.Tg)(r(_,D)).pipe((0,p.s)(1),(0,f.u)(_)))}var d=n(4581);function g(r,l=u.E){const _=(0,d.O)(r,l);return s(()=>_)}}}]);
//# sourceMappingURL=https://sources.2sxc.org/18.00.01/dist/ng-edit/projects_eav-ui_src_app_replace-content_replace-content_component_ts-node_modules_rxjs_dist_e-178ebb.0f359ab0d8634347.js.map