{"version":3,"file":"projects_eav-ui_src_app_import-app_import-app_ts-projects_eav-ui_src_app_shared_components_ba-72010b.2d929f24aa70f6dc.js","mappings":"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","names":["MatFormFieldModule","static","__ngFactoryType__","i0","type","imports","ObserversModule","MatFormField","BidiModule","ImportAppComponent","constructor","dialogData","this","uploadType","UploadTypes","App","importAppService","transient","ImportAppService","title","description","allowedFileTypes","upload$","files","name","importApp","MAT_DIALOG_DATA","selectors","decls","vars","consts","template","rf","ctx","FileUploadDialogComponent","encapsulation","BaseComponent","subscriptions","Subscription","ngOnDestroy","unsubscribe","ErrorStateMatcher","isErrorState","control","form","invalid","touched","submitted","token","factory","ɵfac","providedIn","_ErrorStateTracker","_defaultMatcher","ngControl","_parentFormGroup","_parentForm","_stateChanges","errorState","matcher","updateErrorState","oldState","parent","newState","next","SafeHtmlPipe","sanitizer","transform","html","bypassSecurityTrustHtml","i1","pure","webApiAppRoot","HttpServiceBaseSignal","file","changedName","retryOnDuplicate","formData","FormData","append","http","post","apiUrl","params","zoneId","pipe","switchMap","result","Messages","MessageType","FileUploadMessageTypes","Warning","folderName","prompt","Text","of"],"ignoreList":[],"sourceRoot":"webpack:///","sources":["./node_modules/@angular/material/fesm2022/form-field.mjs","./projects/eav-ui/src/app/import-app/import-app.ts","./projects/eav-ui/src/app/import-app/import-app.html","./projects/eav-ui/src/app/shared/components/base.ts","./node_modules/@angular/material/fesm2022/_error-options-chunk.mjs","./node_modules/@angular/material/fesm2022/_error-state-chunk.mjs","./projects/eav-ui/src/app/shared/pipes/safe-html.pipe.ts","./projects/eav-ui/src/app/import-app/services/import-app.service.ts"],"sourcesContent":["import { MatFormField, MatLabel, MatError, MatHint, MatPrefix, MatSuffix } from './_form-field-chunk.mjs';\nexport { MAT_ERROR, MAT_FORM_FIELD, MAT_FORM_FIELD_DEFAULT_OPTIONS, MAT_PREFIX, MAT_SUFFIX, MatFormFieldControl, getMatFormFieldDuplicatedHintError, getMatFormFieldMissingControlError, getMatFormFieldPlaceholderConflictError } from './_form-field-chunk.mjs';\nimport { BidiModule } from '@angular/cdk/bidi';\nimport { ObserversModule } from '@angular/cdk/observers';\nimport * as i0 from '@angular/core';\nimport { NgModule } from '@angular/core';\nimport '@angular/cdk/a11y';\nimport '@angular/cdk/coercion';\nimport '@angular/cdk/platform';\nimport '@angular/common';\nimport 'rxjs';\nimport 'rxjs/operators';\nimport '@angular/cdk/observers/private';\nimport './_animation-chunk.mjs';\nimport '@angular/cdk/layout';\n\nclass MatFormFieldModule {\n  static ɵfac = i0.ɵɵngDeclareFactory({\n    minVersion: \"12.0.0\",\n    version: \"21.0.3\",\n    ngImport: i0,\n    type: MatFormFieldModule,\n    deps: [],\n    target: i0.ɵɵFactoryTarget.NgModule\n  });\n  static ɵmod = i0.ɵɵngDeclareNgModule({\n    minVersion: \"14.0.0\",\n    version: \"21.0.3\",\n    ngImport: i0,\n    type: MatFormFieldModule,\n    imports: [ObserversModule, MatFormField, MatLabel, MatError, MatHint, MatPrefix, MatSuffix],\n    exports: [MatFormField, MatLabel, MatHint, MatError, MatPrefix, MatSuffix, BidiModule]\n  });\n  static ɵinj = i0.ɵɵngDeclareInjector({\n    minVersion: \"12.0.0\",\n    version: \"21.0.3\",\n    ngImport: i0,\n    type: MatFormFieldModule,\n    imports: [ObserversModule, MatFormField, BidiModule]\n  });\n}\ni0.ɵɵngDeclareClassMetadata({\n  minVersion: \"12.0.0\",\n  version: \"21.0.3\",\n  ngImport: i0,\n  type: MatFormFieldModule,\n  decorators: [{\n    type: NgModule,\n    args: [{\n      imports: [ObserversModule, MatFormField, MatLabel, MatError, MatHint, MatPrefix, MatSuffix],\n      exports: [MatFormField, MatLabel, MatHint, MatError, MatPrefix, MatSuffix, BidiModule]\n    }]\n  }]\n});\n\nexport { MatError, MatFormField, MatFormFieldModule, MatHint, MatLabel, MatPrefix, MatSuffix };\n","import { Component, Inject } from '@angular/core';\r\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\r\nimport { transient } from '../../../../core';\r\nimport { FileUploadDialogComponent, FileUploadDialogData, UploadTypes } from '../shared/components/file-upload-dialog';\r\nimport { ImportAppService } from './services/import-app.service';\r\n\r\n@Component({\r\n    selector: 'app-import-app',\r\n    templateUrl: './import-app.html',\r\n    imports: [\r\n        FileUploadDialogComponent,\r\n    ]\r\n})\r\nexport class ImportAppComponent {\r\n\r\n  uploadType = UploadTypes.App;\r\n\r\n  private importAppService = transient(ImportAppService);\r\n\r\n  constructor(@Inject(MAT_DIALOG_DATA) dialogData: FileUploadDialogData) {\r\n    dialogData.title ??= `Import App`;\r\n    dialogData.description ??= `\r\n    Select an app package (zip) from your computer to import an app. New apps can be downloaded on\r\n    <a href=\"https://2sxc.org/apps\" target=\"_blank\">https://2sxc.org/apps</a>.\r\n    For further help visit <a href=\"https://2sxc.org/en/help?tag=import-app\" target=\"_blank\">2sxc Help</a>.\r\n    `;\r\n    dialogData.allowedFileTypes ??= 'zip';\r\n    dialogData.upload$ ??= (files, name) => this.importAppService.importApp(files[0], name, true);\r\n  }\r\n}\r\n","<app-file-upload-dialog [uploadType]=\"uploadType\"></app-file-upload-dialog>\r\n","import { Component, OnDestroy } from '@angular/core';\r\nimport { Subscription } from 'rxjs';\r\n\r\n/**\r\n * A newer base component, without Log being created / requested.\r\n * This is so it's easier to inherit than the BaseComponent,\r\n * which would make typed log with specs harder to implement.\r\n * \r\n * Note that as with time, we wish to get away from these, as we don't want to use many observables any more.\r\n */\r\n@Component({\r\n  selector: 'app-base',\r\n  template: '',\r\n})\r\n// tslint:disable-next-line:directive-class-suffix\r\nexport abstract class BaseComponent implements OnDestroy {\r\n  \r\n  /** Holds all subscriptions to be unsubscribed on destroy */\r\n  protected subscriptions = new Subscription();\r\n\r\n  ngOnDestroy() {\r\n    this.subscriptions.unsubscribe();\r\n  }\r\n\r\n}\r\n","import * as i0 from '@angular/core';\nimport { Injectable } from '@angular/core';\n\nclass ShowOnDirtyErrorStateMatcher {\n  isErrorState(control, form) {\n    return !!(control && control.invalid && (control.dirty || form && form.submitted));\n  }\n  static ɵfac = i0.ɵɵngDeclareFactory({\n    minVersion: \"12.0.0\",\n    version: \"21.0.3\",\n    ngImport: i0,\n    type: ShowOnDirtyErrorStateMatcher,\n    deps: [],\n    target: i0.ɵɵFactoryTarget.Injectable\n  });\n  static ɵprov = i0.ɵɵngDeclareInjectable({\n    minVersion: \"12.0.0\",\n    version: \"21.0.3\",\n    ngImport: i0,\n    type: ShowOnDirtyErrorStateMatcher\n  });\n}\ni0.ɵɵngDeclareClassMetadata({\n  minVersion: \"12.0.0\",\n  version: \"21.0.3\",\n  ngImport: i0,\n  type: ShowOnDirtyErrorStateMatcher,\n  decorators: [{\n    type: Injectable\n  }]\n});\nclass ErrorStateMatcher {\n  isErrorState(control, form) {\n    return !!(control && control.invalid && (control.touched || form && form.submitted));\n  }\n  static ɵfac = i0.ɵɵngDeclareFactory({\n    minVersion: \"12.0.0\",\n    version: \"21.0.3\",\n    ngImport: i0,\n    type: ErrorStateMatcher,\n    deps: [],\n    target: i0.ɵɵFactoryTarget.Injectable\n  });\n  static ɵprov = i0.ɵɵngDeclareInjectable({\n    minVersion: \"12.0.0\",\n    version: \"21.0.3\",\n    ngImport: i0,\n    type: ErrorStateMatcher,\n    providedIn: 'root'\n  });\n}\ni0.ɵɵngDeclareClassMetadata({\n  minVersion: \"12.0.0\",\n  version: \"21.0.3\",\n  ngImport: i0,\n  type: ErrorStateMatcher,\n  decorators: [{\n    type: Injectable,\n    args: [{\n      providedIn: 'root'\n    }]\n  }]\n});\n\nexport { ErrorStateMatcher, ShowOnDirtyErrorStateMatcher };\n","class _ErrorStateTracker {\n  _defaultMatcher;\n  ngControl;\n  _parentFormGroup;\n  _parentForm;\n  _stateChanges;\n  errorState = false;\n  matcher;\n  constructor(_defaultMatcher, ngControl, _parentFormGroup, _parentForm, _stateChanges) {\n    this._defaultMatcher = _defaultMatcher;\n    this.ngControl = ngControl;\n    this._parentFormGroup = _parentFormGroup;\n    this._parentForm = _parentForm;\n    this._stateChanges = _stateChanges;\n  }\n  updateErrorState() {\n    const oldState = this.errorState;\n    const parent = this._parentFormGroup || this._parentForm;\n    const matcher = this.matcher || this._defaultMatcher;\n    const control = this.ngControl ? this.ngControl.control : null;\n    const newState = matcher?.isErrorState(control, parent) ?? false;\n    if (newState !== oldState) {\n      this.errorState = newState;\n      this._stateChanges.next();\n    }\n  }\n}\n\nexport { _ErrorStateTracker };\n","import { Pipe, PipeTransform } from '@angular/core';\r\nimport { DomSanitizer } from '@angular/platform-browser';\r\n\r\n@Pipe({\r\n  name: 'safeHtml',\r\n})\r\nexport class SafeHtmlPipe implements PipeTransform {\r\n\r\n  constructor(private sanitizer: DomSanitizer) { }\r\n\r\n  transform(html: string) {\r\n    return this.sanitizer.bypassSecurityTrustHtml(html);\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { Observable, of, switchMap } from 'rxjs';\r\nimport { FileUploadMessageTypes, FileUploadResult } from '../../shared/components/file-upload-dialog';\r\nimport { HttpServiceBaseSignal } from '../../shared/services/http-service-base-signal';\r\n\r\nexport const webApiAppRoot = 'admin/app/';\r\n\r\n@Injectable()\r\nexport class ImportAppService extends HttpServiceBaseSignal {\r\n\r\n  importApp(file: File, changedName: string, retryOnDuplicate = false): Observable<FileUploadResult> {\r\n    const formData = new FormData();\r\n    formData.append('File', file);\r\n    formData.append('Name', changedName ?? '');\r\n    return this.http.post<FileUploadResult>(this.apiUrl(webApiAppRoot + 'Import'), formData, {\r\n      params: { zoneId: this.zoneId }\r\n    }).pipe(\r\n      switchMap(result => {\r\n        if (retryOnDuplicate && result.Messages[0]?.MessageType === FileUploadMessageTypes.Warning) {\r\n          const folderName = prompt(result.Messages[0].Text + ' Would you like to install it using another folder name?');\r\n          if (folderName) {\r\n            return this.importApp(file, folderName, true);\r\n          }\r\n        }\r\n        return of(result);\r\n      }),\r\n    );\r\n  }\r\n}\r\n"],"x_google_ignoreList":[0,4,5]}