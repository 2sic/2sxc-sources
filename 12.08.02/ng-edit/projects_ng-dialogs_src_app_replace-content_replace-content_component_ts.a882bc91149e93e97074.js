(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_ng-dialogs_src_app_replace-content_replace-content_component_ts"],{6757:function(t,e,n){"use strict";n.r(e),n.d(e,{ReplaceContentComponent:function(){return q}});var i=n(4762),o=n(1282),s=n(7570),a=n(8512),r=n(1305),l=n(9996),c=n(3835),u=n(6238),p=n(2855),d=n(2420),f=n(1785),h=n(2935),g=n(7106),v=n(3589),m=n(1116),x=n(3070),C=n(9550),b=n(9961),y=n(1041),Z=n(83),T=n(4369),_=n(7512),A=n(7307),M=n(7064);function k(t,e){if(1&t&&(f.TgZ(0,"mat-option",15),f._uU(1),f.qZA()),2&t){var n=e.$implicit;f.Q6J("value",n),f.xp6(1),f.Oqu(n)}}function O(t,e){if(1&t){var n=f.EpF();f.ynx(0),f.TgZ(1,"div",1),f.TgZ(2,"div",2),f._uU(3),f.qZA(),f.qZA(),f._UZ(4,"router-outlet"),f.TgZ(5,"p",3),f._uU(6),f.qZA(),f.TgZ(7,"div",4),f.TgZ(8,"mat-form-field",5),f.TgZ(9,"mat-label"),f._uU(10,"Choose item"),f.qZA(),f.TgZ(11,"input",6),f.NdJ("ngModelChange",function(t){return f.CHM(n),f.oxw().setFilter(t)}),f.qZA(),f.TgZ(12,"mat-autocomplete",7,8),f.NdJ("optionSelected",function(t){return f.CHM(n),f.oxw().select(t)}),f.TgZ(14,"cdk-virtual-scroll-viewport",9),f.YNc(15,k,2,2,"mat-option",10),f.qZA(),f.qZA(),f.qZA(),f.TgZ(16,"button",11),f.NdJ("click",function(){return f.CHM(n),f.oxw().copySelected()}),f.TgZ(17,"mat-icon"),f._uU(18,"file_copy"),f.qZA(),f.qZA(),f.qZA(),f.TgZ(19,"div",12),f.TgZ(20,"button",13),f.NdJ("click",function(){return f.CHM(n),f.oxw().closeDialog()}),f._uU(21,"Cancel"),f.qZA(),f.TgZ(22,"button",14),f.NdJ("click",function(){return f.CHM(n),f.oxw().save()}),f._uU(23,"Save"),f.qZA(),f.qZA(),f.BQk()}if(2&t){var i=e.ngIf,o=f.MAs(13);f.xp6(3),f.Oqu(i.isAddMode?"Add Existing Item":"Replace Content Item"),f.xp6(3),f.hij(" ",i.isAddMode?"Select a content-item to add to this list.":"By replacing a content-item you can make other content appear in the slot of the original content."," "),f.xp6(5),f.Q6J("matAutocomplete",o)("ngModel",i.filterText),f.xp6(3),f.Udp("height",i.filteredOptions.length<6?48*i.filteredOptions.length:240,"px"),f.xp6(1),f.Q6J("cdkVirtualForOf",i.filteredOptions),f.xp6(1),f.Q6J("disabled",!i.isMatch),f.xp6(6),f.Q6J("disabled",!i.isMatch)}}var q=function(){function t(t,e,n,i,o){this.dialogRef=t,this.contentGroupService=e,this.router=n,this.route=i,this.snackBar=o,this.hostClass="dialog-component"}return t.prototype.ngOnInit=function(){var t=this;this.guid=this.route.snapshot.paramMap.get("guid"),this.part=this.route.snapshot.paramMap.get("part"),this.index=parseInt(this.route.snapshot.paramMap.get("index"),10),this.add=!!this.route.snapshot.queryParamMap.get("add"),this.subscription=new s.w,this.filterText$=new a.X(""),this.options$=new a.X([]);var e=(0,r.aj)([this.filterText$,this.options$]).pipe((0,l.U)(function(t){var e=(0,i.CR)(t,2),n=e[0];return e[1].filter(function(t){return t.label.toLocaleLowerCase().includes(n.toLocaleLowerCase())}).map(function(t){return t.label})}));this.templateVars$=(0,r.aj)([this.filterText$,e]).pipe((0,l.U)(function(e){var n=(0,i.CR)(e,2),o=n[0],s=n[1];return{filterText:o,filteredOptions:s,isAddMode:t.add,isMatch:s.includes(o)}})),this.fetchConfig(!1,null),this.refreshOnChildClosed()},t.prototype.ngOnDestroy=function(){this.filterText$.complete(),this.options$.complete(),this.subscription.unsubscribe()},t.prototype.closeDialog=function(){this.dialogRef.close()},t.prototype.setFilter=function(t){this.filterText$.next(t)},t.prototype.select=function(t){this.filterText$.next(t.option.value)},t.prototype.copySelected=function(){var t=this.buildContentGroup(),e=(0,d.f)({items:[{ContentTypeName:this.contentTypeName,DuplicateEntity:t.id}]});this.router.navigate(["edit/"+e],{relativeTo:this.route})},t.prototype.save=function(){var t=this;this.snackBar.open("Saving...");var e=this.buildContentGroup();this.contentGroupService.saveItem(e).subscribe(function(){t.snackBar.open("Saved",null,{duration:2e3}),t.closeDialog()})},t.prototype.fetchConfig=function(t,e){var n=this,o=this.buildContentGroup();this.contentGroupService.getItems(o).subscribe(function(s){var a,r=Object.entries(s.Items).map(function(t){var e=(0,i.CR)(t,2),n=e[0],o=e[1];return{id:parseInt(n,10),label:o+" ("+n+")"}});if(n.options$.next(r),!o.add&&!t||null!=e){var l=t?e:s.SelectedId,c=(null===(a=n.options$.value.find(function(t){return t.id===l}))||void 0===a?void 0:a.label)||"";n.filterText$.next(c)}n.contentTypeName=s.ContentTypeName})},t.prototype.refreshOnChildClosed=function(){var t=this;this.subscription.add(this.router.events.pipe((0,c.h)(function(t){return t instanceof o.m2}),(0,u.O)(!!this.route.snapshot.firstChild),(0,l.U)(function(){return!!t.route.snapshot.firstChild}),(0,p.G)(),(0,c.h)(function(t){var e=(0,i.CR)(t,2);return e[0]&&!e[1]})).subscribe(function(){var e,n=null===(e=t.router.getCurrentNavigation().extras)||void 0===e?void 0:e.state,i=null==n?void 0:n[Object.keys(n)[0]];t.fetchConfig(!0,i)}))},t.prototype.buildContentGroup=function(){var t,e,n=this;return{id:null!==(e=null===(t=this.options$.value.find(function(t){return t.label===n.filterText$.value}))||void 0===t?void 0:t.id)&&void 0!==e?e:null,guid:this.guid,part:this.part,index:this.index,add:this.add}},t.\u0275fac=function(e){return new(e||t)(f.Y36(h.so),f.Y36(g.e),f.Y36(o.F0),f.Y36(o.gz),f.Y36(v.ux))},t.\u0275cmp=f.Xpm({type:t,selectors:[["app-replace-content"]],hostVars:1,hostBindings:function(t,e){2&t&&f.Ikx("className",e.hostClass)},decls:2,vars:3,consts:[[4,"ngIf"],["mat-dialog-title",""],[1,"dialog-title-box"],[1,"dialog-description"],[1,"options-box"],["appearance","standard","color","accent",1,"options-box__field"],["matInput","",3,"matAutocomplete","ngModel","ngModelChange"],[3,"optionSelected"],["auto","matAutocomplete"],["itemSize","48","minBufferPx","500","maxBufferPx","1000"],[3,"value",4,"cdkVirtualFor","cdkVirtualForOf"],["mat-icon-button","","tippy","Copy",1,"options-box__copy",3,"disabled","click"],[1,"dialog-component-actions"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click"],[3,"value"]],template:function(t,e){1&t&&(f.YNc(0,O,24,9,"ng-container",0),f.ALo(1,"async")),2&t&&f.Q6J("ngIf",f.lcZ(1,1,e.templateVars$))},directives:[m.O5,h.uh,o.lC,x.KE,x.hX,C.Nt,b.ZL,y.Fj,y.JJ,y.On,b.XC,Z.N7,Z.xd,Z.x0,T.lW,_.$,A.Hw,M.ey],pipes:[m.Ov],styles:[".options-box[_ngcontent-%COMP%]{display:flex;align-items:flex-end}.options-box__field[_ngcontent-%COMP%]{width:40%}.options-box__copy[_ngcontent-%COMP%]{margin-left:8px}"]}),t}()}}]);
//# sourceMappingURL=https://sources.2sxc.org/12.08.02/ng-edit/projects_ng-dialogs_src_app_replace-content_replace-content_component_ts.a882bc91149e93e97074.js.map