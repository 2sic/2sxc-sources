"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_content-type-fields_edit-content-type-fields_edit-content-type-fields-56a972"],{4525:(w,F,l)=>{l.r(F),l.d(F,{EditContentTypeFieldsComponent:()=>Je});var e=l(7580),r=l(4456),d=l(7941),_=l(5797),O=l(1870),k=l(6647),G=l(271),A=l(1873),y=l(9452),x=l(1567),M=l(1903),c=l(1318),T=l(5392),v=l(819);const E=(n,a)=>(n.push(a),n);function C(){return(0,v.N)((n,a)=>{(function b(n,a){return(0,v.N)((0,T.S)(n,a,arguments.length>=2,!1,!0))})(E,[])(n).subscribe(a)})}const V=/^[A-Za-z][A-Za-z0-9]+$/,X="Standard letters and numbers are allowed. Must start with a letter.";var te=l(7693),Y=l(3176),u=l(1726),U=l(4202),h=l(4007),J=l(5959);const L={Boolean:{label:(0,h.D)(u.O.Boolean),description:"Yes/no or true/false values"},Custom:{label:(0,h.D)(u.O.Custom),description:"Use for things like gps-pickers (which writes into multiple fields) or for custom-data which serializes something exotic into the db like an array, a custom json or anything"},DateTime:{label:(0,h.D)(u.O.DateTime),description:"For date, time or combined values"},Empty:{label:(0,h.D)(u.O.Empty),description:"Use to structure your form"},Entity:{label:(0,h.D)(u.O.Entity),description:"One or more other content-items"},Hyperlink:{label:(0,h.D)(u.O.Hyperlink),description:"Hyperlink or reference to a picture / file"},Number:{label:(0,h.D)(u.O.Number),description:"Any kind of number"},String:{label:(0,h.D)(u.O.String),description:"Any kind of text"}};var m=l(906),ie=l(4824),z=l(8136),oe=l(5541),D=l(852),P=l(316);let j=(()=>{class n{constructor(){this.reservedNames={}}validate(t){if(!t.value)return null;const o=t.value.toLocaleLowerCase(),i=Object.keys(this.reservedNames).find(s=>s.toLocaleLowerCase()===o);return i?{reservedNames:this.reservedNames[i]}:null}static assembleReservedNames(t,o){const i={};return o.forEach(s=>{i[s.StaticName]="Field with this name already exists"}),{...t,...i}}static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275dir=e.FsC({type:n,selectors:[["","appReservedNames",""]],inputs:{reservedNames:[e.Mj6.None,"appReservedNames","reservedNames"]},standalone:!0,features:[e.Jv_([{provide:r.cz,useExisting:n,multi:!0}])]})}return n})();var $=l(7984),S=l(5944),I=l(4175),Z=l(3777),se=l(3703),W=l(3758),B=l(5437),Q=l(3347);const ae=["ngForm"];function le(n,a){1&n&&(e.j41(0,"th",27)(1,"b"),e.EFF(2,"Content Type"),e.k0s()())}function de(n,a){if(1&n&&(e.j41(0,"td",28),e.EFF(1),e.k0s()),2&n){const t=a.$implicit;e.R7$(),e.SpI(" ",t.ContentType.Name," ")}}function re(n,a){1&n&&(e.j41(0,"th",27)(1,"b"),e.EFF(2,"Name"),e.k0s()())}function ce(n,a){if(1&n&&(e.j41(0,"td",28),e.EFF(1),e.k0s()),2&n){const t=a.$implicit;e.R7$(),e.SpI(" ",t.StaticName," ")}}function pe(n,a){1&n&&(e.j41(0,"th",27)(1,"b"),e.EFF(2,"Type"),e.k0s()())}function me(n,a){if(1&n&&(e.j41(0,"td",28),e.EFF(1),e.k0s()),2&n){const t=a.$implicit;e.R7$(),e.SpI(" ",t.Type," ")}}function he(n,a){1&n&&(e.j41(0,"th",27)(1,"b"),e.EFF(2,"Share"),e.k0s()())}function fe(n,a){if(1&n){const t=e.RV6();e.j41(0,"td",28)(1,"button",23),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.selectField(i))}),e.EFF(2,"Select"),e.k0s()()}}function ue(n,a){1&n&&e.nrm(0,"tr",29)}function ge(n,a){1&n&&e.nrm(0,"tr",30)}function _e(n,a){1&n&&(e.j41(0,"th",27)(1,"b"),e.EFF(2,"New Name"),e.k0s()())}function ve(n,a){if(1&n&&(e.j41(0,"app-field-hint",33),e.EFF(1),e.k0s()),2&n){const t=e.XpG(3);e.Y8G("isError",!0),e.R7$(),e.JRh(t.fieldNameError)}}function Ce(n,a){if(1&n&&(e.j41(0,"app-field-hint",33),e.EFF(1),e.k0s()),2&n){e.XpG(2);const t=e.sdS(5);e.Y8G("isError",!0),e.R7$(),e.SpI(" ",t.errors.reservedNames," ")}}function Fe(n,a){if(1&n&&e.DNE(0,ve,2,2,"app-field-hint",33)(1,Ce,2,2,"app-field-hint",33),2&n){e.XpG();const t=e.sdS(5);e.vxM(0,t.errors.pattern?0:-1),e.R7$(),e.vxM(1,t.errors.reservedNames?1:-1)}}function ye(n,a){if(1&n){const t=e.RV6();e.j41(0,"td",28)(1,"mat-form-field",31)(2,"mat-label"),e.EFF(3,"New Name"),e.k0s(),e.j41(4,"input",32,1),e.mxI("ngModelChange",function(i){const s=e.eBV(t).$implicit;return e.DH7(s.newName,i)||(s.newName=i),e.Njj(i)}),e.k0s()(),e.DNE(6,Fe,2,2),e.k0s()}if(2&n){const t=a.$implicit,o=a.index,i=e.sdS(5),s=e.XpG();e.R7$(4),e.Y8G("pattern",s.fieldNamePattern),e.R50("ngModel",t.newName),e.Y8G("name","StaticName"+o)("appReservedNames",s.reservedNames),e.R7$(2),e.vxM(6,i.errors?6:-1)}}function Te(n,a){1&n&&(e.j41(0,"th",27)(1,"b"),e.EFF(2,"Source"),e.k0s()())}function be(n,a){if(1&n&&(e.j41(0,"td",34),e.EFF(1),e.k0s()),2&n){const t=a.$implicit;e.R7$(),e.E5c(" ",t.field.ContentType.Name,"/",t.field.StaticName," (",t.field.Type,") ")}}function Se(n,a){1&n&&(e.j41(0,"th",27)(1,"b"),e.EFF(2,"Remove"),e.k0s()())}function Ne(n,a){if(1&n){const t=e.RV6();e.j41(0,"td",28)(1,"button",23),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.removeField(i))}),e.EFF(2,"Remove"),e.k0s()()}}function Ee(n,a){1&n&&e.nrm(0,"tr",29)}function Re(n,a){1&n&&e.nrm(0,"tr",30)}let xe=(()=>{class n extends Y.${#t;#e;#n;constructor(t,o,i,s,g,p){super(),this.dialogData=t,this.dialogRef=o,this.snackBar=i,this.dialog=s,this.viewContainerRef=g,this.changeDetectorRef=p,this.hostClass="dialog-component",this.displayedShareableFieldsColumns=["contentType","name","type","share"],this.displayedSelectedFieldsColumns=["newName","source","remove"],this.shareableFields=new m.I6([]),this.selectedFields=new m.I6([]),this.fieldNamePattern=V,this.fieldNameError=X,this.reservedNames={},this.saving$=new _.t(!1),this.#t=(0,e.WQX)(ie.t),this.#e=(0,B.d)(J.h6),this.#n=this.#t.isEnabled[z.T.FieldShareConfigManagement],this.dialogRef.disableClose=!0,this.subscriptions.add(this.dialogRef.backdropClick().subscribe(()=>{(this.form.dirty||this.selectedFields.data.length>0)&&!confirm("You have unsaved changes. Are you sure you want to close this dialog?")||this.closeDialog()}))}ngOnInit(){this.subscriptions.add(this.#e.getShareableFields().subscribe(t=>{this.shareableFields.data=t})),this.subscriptions.add(this.#e.getReservedNames().subscribe(t=>{this.reservedNames=j.assembleReservedNames(t,this.dialogData.existingFields)}))}ngOnDestroy(){this.saving$.complete(),super.ngOnDestroy()}selectField(t){const o=this.selectedFields.data;o.push({newName:t.StaticName,field:t}),this.selectedFields.data=o}removeField(t){const o=this.selectedFields.data;o.splice(o.indexOf(t),1),this.selectedFields.data=o}save(){this.#n()?(this.saving$.next(!0),this.snackBar.open("Saving..."),(0,y.of)(...this.selectedFields.data).pipe((0,x.p)(t=>!!t.newName),(0,M.H)(t=>this.#e.addInheritedField(this.dialogData.contentType.Id,t.field.ContentType.Id,t.field.Guid,t.newName).pipe((0,c.W)(o=>(0,y.of)(null)))),C()).subscribe(t=>{this.saving$.next(!1),this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()})):(0,oe.j)(this.dialog,z.T.FieldShareConfigManagement,this.viewContainerRef,this.changeDetectorRef)}closeDialog(){this.dialogRef.close()}static#i=this.\u0275fac=function(o){return new(o||n)(e.rXU(d.Vh),e.rXU(d.CP),e.rXU(Q.UG),e.rXU(d.bZ),e.rXU(e.c1b),e.rXU(e.gRc))};static#o=this.\u0275cmp=e.VBU({type:n,selectors:[["app-add-sharing-fields"]],viewQuery:function(o,i){if(1&o&&e.GBs(ae,5,r.cV),2&o){let s;e.mGM(s=e.lsd())&&(i.form=s.first)}},hostVars:1,hostBindings:function(o,i){2&o&&e.Mr5("className",i.hostClass)},standalone:!0,features:[e.Vt3,e.aNF],decls:50,vars:16,consts:[["ngForm","ngForm"],["newName","ngModel"],[1,"eav-dialog","eav-no-scrollbar"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],[1,"eav-tables-div"],[1,"eav-table-div-left"],["mat-table","",1,"eav-fields-table",3,"dataSource"],["matColumnDef","contentType"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","eav-table-cell",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","type"],["matColumnDef","share"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"eav-table-div-right"],["matColumnDef","newName"],["matColumnDef","source"],["mat-cell","","style","word-break:break-all;","class","eav-table-cell",4,"matCellDef"],["matColumnDef","remove"],["align","end"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","submit","color","accent",3,"click","disabled"],[1,"eav-button-feature"],[1,"eav-button-feature-icon",3,"featureNameId"],["mat-header-cell",""],["mat-cell","",1,"eav-table-cell"],["mat-header-row",""],["mat-row",""],["color","accent",1,"eav-mat-form-field"],["matInput","",3,"ngModelChange","pattern","ngModel","name","appReservedNames"],[3,"isError"],["mat-cell","",1,"eav-table-cell",2,"word-break","break-all"]],template:function(o,i){if(1&o){const s=e.RV6();e.j41(0,"div",2)(1,"div",3)(2,"div",4),e.EFF(3),e.nI1(4,"translate"),e.k0s()(),e.j41(5,"div",5)(6,"span"),e.EFF(7),e.nI1(8,"translate"),e.k0s(),e.j41(9,"div",6)(10,"mat-card",7)(11,"table",8),e.qex(12,9),e.DNE(13,le,3,0,"th",10)(14,de,2,1,"td",11),e.bVm(),e.qex(15,12),e.DNE(16,re,3,0,"th",10)(17,ce,2,1,"td",11),e.bVm(),e.qex(18,13),e.DNE(19,pe,3,0,"th",10)(20,me,2,1,"td",11),e.bVm(),e.qex(21,14),e.DNE(22,he,3,0,"th",10)(23,fe,3,0,"td",11),e.bVm(),e.DNE(24,ue,1,0,"tr",15)(25,ge,1,0,"tr",16),e.k0s()(),e.j41(26,"mat-card",17)(27,"form",null,0)(29,"table",8),e.qex(30,18),e.DNE(31,_e,3,0,"th",10)(32,ye,7,5,"td",11),e.bVm(),e.qex(33,19),e.DNE(34,Te,3,0,"th",10)(35,be,2,3,"td",20),e.bVm(),e.qex(36,21),e.DNE(37,Se,3,0,"th",10)(38,Ne,3,0,"td",11),e.bVm(),e.DNE(39,Ee,1,0,"tr",15)(40,Re,1,0,"tr",16),e.k0s()()()(),e.j41(41,"mat-dialog-actions",22)(42,"button",23),e.bIt("click",function(){return e.eBV(s),e.Njj(i.closeDialog())}),e.EFF(43,"Cancel"),e.k0s(),e.j41(44,"button",24),e.nI1(45,"async"),e.bIt("click",function(){return e.eBV(s),e.Njj(i.save())}),e.j41(46,"div",25)(47,"span"),e.EFF(48,"Save"),e.k0s(),e.nrm(49,"app-feature-icon-indicator",26),e.k0s()()()()()}if(2&o){const s=e.sdS(28);e.R7$(3),e.SpI(" ",e.bMT(4,10,"SharingOrInheriting.TitleAddFieldsWhichInherit")," "),e.R7$(4),e.JRh(e.bMT(8,12,"SharingOrInheriting.PickFieldsToInheritFrom")),e.R7$(4),e.Y8G("dataSource",i.shareableFields),e.R7$(13),e.Y8G("matHeaderRowDef",i.displayedShareableFieldsColumns),e.R7$(),e.Y8G("matRowDefColumns",i.displayedShareableFieldsColumns),e.R7$(4),e.Y8G("dataSource",i.selectedFields),e.R7$(10),e.Y8G("matHeaderRowDef",i.displayedSelectedFieldsColumns),e.R7$(),e.Y8G("matRowDefColumns",i.displayedSelectedFieldsColumns),e.R7$(4),e.Y8G("disabled",!s.form.valid||0==i.selectedFields.data.length||e.bMT(45,14,i.saving$)),e.R7$(5),e.Y8G("featureNameId","FieldShareConfigManagement")}},dependencies:[Z.Hu,Z.RN,m.tP,m.Zl,m.tL,m.ji,m.cC,m.YV,m.iL,m.KS,m.$R,m.YZ,m.NB,I.Hl,I.$z,r.YN,r.qT,r.me,r.BC,r.cb,r.R_,r.vS,r.cV,S.RG,S.rl,S.nJ,$.fS,$.fg,j,d.E7,P.Jj,D.h,D.D9,se.s,W.F],styles:[".eav-tables-div[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;margin-top:4px;padding-top:4px;height:400px}.eav-tables-div[_ngcontent-%COMP%]   .eav-table-div-left[_ngcontent-%COMP%]{width:50%;height:100%;margin-right:4px;overflow-y:auto;border:1px solid rgba(0,0,0,.1)}.eav-tables-div[_ngcontent-%COMP%]   .eav-table-div-right[_ngcontent-%COMP%]{width:50%;height:100%;margin-left:4px;overflow-y:auto;border:1px solid rgba(0,0,0,.1)}.eav-tables-div[_ngcontent-%COMP%]   .eav-table-div-right[_ngcontent-%COMP%]   .eav-mat-form-field[_ngcontent-%COMP%]{max-width:150px}.eav-tables-div[_ngcontent-%COMP%]   .eav-table-cell[_ngcontent-%COMP%]{border-bottom:1px solid rgba(0,0,0,.1)}.eav-tables-div[_ngcontent-%COMP%]   .mat-column-source[_ngcontent-%COMP%]{min-width:150px}.eav-button-feature[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.eav-button-feature[_ngcontent-%COMP%]   .eav-button-feature-icon[_ngcontent-%COMP%]{margin-left:4px;margin-top:6px}"]})}return n})();var K=l(5060),q=l(3840),H=l(5175),Me=l(5699),De=l(9431),je=l(2159);const $e=["ngForm"],Ie=n=>({"eav-input-obsolete":n});function Oe(n,a){1&n&&e.EFF(0," Fields ")}function ke(n,a){1&n&&e.EFF(0," Add Fields ")}function Ge(n,a){1&n&&e.EFF(0," Edit Field ")}function Ae(n,a){if(1&n&&(e.j41(0,"app-field-hint",20),e.EFF(1),e.k0s()),2&n){const t=e.XpG(4);e.Y8G("isError",!0),e.R7$(),e.JRh(t.fieldNameError)}}function Ve(n,a){if(1&n&&(e.j41(0,"app-field-hint",20),e.EFF(1),e.k0s()),2&n){e.XpG(2);const t=e.sdS(6);e.Y8G("isError",!0),e.R7$(),e.SpI(" ",t.errors.reservedNames," ")}}function Pe(n,a){if(1&n&&e.DNE(0,Ae,2,2,"app-field-hint",20)(1,Ve,2,2,"app-field-hint",20),2&n){e.XpG();const t=e.sdS(6);e.vxM(0,t.errors.pattern?0:-1),e.R7$(),e.vxM(1,t.errors.reservedNames?1:-1)}}function Be(n,a){if(1&n&&(e.j41(0,"mat-option",17)(1,"mat-icon",16),e.EFF(2),e.k0s(),e.j41(3,"span"),e.EFF(4),e.k0s()()),2&n){const t=a.$implicit;e.Y8G("value",t.name),e.R7$(2),e.JRh(t.icon),e.R7$(2),e.JRh(t.label)}}function He(n,a){if(1&n&&(e.j41(0,"mat-icon",18),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.icon)}}function we(n,a){if(1&n&&(e.j41(0,"mat-option",19)(1,"div")(2,"span"),e.EFF(3),e.k0s(),e.DNE(4,He,2,1,"mat-icon",18),e.k0s()()),2&n){const t=a.$implicit;e.Y8G("value",t.inputType)("ngClass",e.eq3(4,Ie,t.isObsolete)),e.R7$(3),e.JRh(t.label),e.R7$(),e.vxM(4,t.icon?4:-1)}}function Xe(n,a){if(1&n){const t=e.RV6();e.j41(0,"div",7)(1,"div",12)(2,"mat-form-field",13)(3,"mat-label"),e.EFF(4,"Name"),e.k0s(),e.j41(5,"input",14,1),e.mxI("ngModelChange",function(i){const s=e.eBV(t).$implicit;return e.DH7(s.StaticName,i)||(s.StaticName=i),e.Njj(i)}),e.k0s()(),e.DNE(7,Pe,2,2),e.k0s(),e.j41(8,"div",12)(9,"mat-form-field",13)(10,"mat-label"),e.EFF(11,"Data Type"),e.k0s(),e.j41(12,"mat-select",15),e.bIt("selectionChange",function(){const i=e.eBV(t).$index,s=e.XpG(2);return s.filterInputTypeOptions(i),s.resetInputType(i),e.Njj(s.calculateHints(i))}),e.mxI("ngModelChange",function(i){const s=e.eBV(t).$implicit;return e.DH7(s.Type,i)||(s.Type=i),e.Njj(i)}),e.j41(13,"mat-select-trigger")(14,"mat-icon",16),e.EFF(15),e.k0s(),e.j41(16,"span"),e.EFF(17),e.k0s()(),e.Z7z(18,Be,5,3,"mat-option",17,e.fX1),e.k0s()(),e.j41(20,"app-field-hint"),e.EFF(21),e.k0s()(),e.j41(22,"div",12)(23,"mat-form-field",13)(24,"mat-label"),e.EFF(25,"Input Type"),e.k0s(),e.j41(26,"mat-select",15),e.bIt("selectionChange",function(){const i=e.eBV(t).$index,s=e.XpG(2);return e.Njj(s.calculateHints(i))}),e.mxI("ngModelChange",function(i){const s=e.eBV(t).$implicit;return e.DH7(s.InputType,i)||(s.InputType=i),e.Njj(i)}),e.j41(27,"mat-select-trigger")(28,"span"),e.EFF(29),e.k0s(),e.j41(30,"mat-icon",18),e.EFF(31),e.k0s()(),e.Z7z(32,we,5,6,"mat-option",19,e.fX1),e.k0s()(),e.j41(34,"app-field-hint"),e.EFF(35),e.k0s()()()}if(2&n){let t,o;const i=a.$implicit,s=a.$index,g=e.sdS(6),p=e.XpG(2);e.R7$(5),e.Y8G("pattern",p.fieldNamePattern)("appReservedNames",p.reservedNames),e.R50("ngModel",i.StaticName),e.Y8G("name","StaticName"+s)("disabled","inputType"===p.editMode),e.R7$(2),e.vxM(7,g.touched&&g.errors?7:-1),e.R7$(5),e.R50("ngModel",i.Type),e.Y8G("name","Type"+s)("disabled",null!=p.editMode),e.R7$(3),e.JRh(p.findIcon(i.Type)),e.R7$(2),e.JRh(p.findLabel(i.Type)),e.R7$(),e.Dyx(p.dataTypes),e.R7$(3),e.JRh(p.dataTypeHints[s]),e.R7$(5),e.R50("ngModel",i.InputType),e.Y8G("name","InputType"+s)("disabled","name"===p.editMode),e.R7$(3),e.JRh(null==(t=p.getInputTypeOption(i.InputType))?null:t.label),e.R7$(2),e.JRh(null==(o=p.getInputTypeOption(i.InputType))?null:o.icon),e.R7$(),e.Dyx(p.filteredInputTypeOptions[s]),e.R7$(3),e.JRh(p.inputTypeHints[s])}}function Ye(n,a){if(1&n){const t=e.RV6();e.j41(0,"button",10),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.addSharedField())}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}2&n&&(e.R7$(),e.JRh(e.bMT(2,1,"SharingOrInheriting.AddSharedField")))}function Ue(n,a){if(1&n){const t=e.RV6();e.j41(0,"form",5,0),e.bIt("ngSubmit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.save())}),e.j41(2,"div",6),e.Z7z(3,Xe,36,18,"div",7,e.fX1),e.k0s(),e.j41(5,"mat-dialog-actions"),e.DNE(6,Ye,3,3,"button",8),e.nrm(7,"div",9),e.j41(8,"button",10),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.closeDialog())}),e.EFF(9,"Cancel"),e.k0s(),e.j41(10,"button",11),e.nI1(11,"async"),e.EFF(12," Save "),e.k0s()()()}if(2&n){const t=e.sdS(1),o=e.XpG();e.R7$(3),e.Dyx(o.fields),e.R7$(3),e.vxM(6,o.isDebug()?6:-1),e.R7$(4),e.Y8G("disabled",!t.form.valid||e.bMT(11,2,o.saving$))}}let Je=(()=>{class n extends Y.${constructor(t,o,i,s){super(),this.dialogRef=t,this.route=o,this.snackBar=i,this.dialog=s,this.hostClass="dialog-component",this.fields=[],this.existingFields=[],this.reservedNames={},this.filteredInputTypeOptions=[],this.dataTypeHints=[],this.inputTypeHints=[],this.fieldNamePattern=V,this.fieldNameError=X,this.findIcon=h.y,this.findLabel=h.D,this.loading$=new _.t(!0),this.saving$=new _.t(!1),this.isDebug=(0,e.WQX)(De.B).isDebug,this.contentTypesService=(0,B.d)(te.g),this.contentTypesFieldsService=(0,B.d)(J.h6),this.dialogRef.disableClose=!0,this.subscriptions.add(this.dialogRef.backdropClick().subscribe(g=>{this.form.dirty&&!confirm("You have unsaved changes. Are you sure you want to close this dialog?")||this.closeDialog()}))}ngOnInit(){this.editMode=this.route.snapshot.paramMap.get("editMode");const t=this.route.snapshot.paramMap.get("contentTypeStaticName"),o=this.contentTypesService.retrieveContentType(t).pipe((0,O.u)()),i=o.pipe((0,k.n)(N=>this.contentTypesFieldsService.getFields(N.StaticName))),s=this.contentTypesFieldsService.typeListRetrieve().pipe((0,G.T)(N=>function ne(n){const a=[];for(const t of n)a.push({name:t,label:L[t].label,icon:(0,h.y)(t),description:L[t].description});return a}(N))),g=this.contentTypesFieldsService.getInputTypesList(),p=this.contentTypesFieldsService.getReservedNames();(0,A.p)([o,i,s,g,p]).subscribe(([N,R,Le,ze,Ze])=>{if(this.contentType=N,this.dataTypes=Le,this.inputTypeOptions=ze,this.existingFields=R,this.reservedNames=j.assembleReservedNames(Ze,R),null!=this.editMode){const f=this.route.snapshot.paramMap.get("id")?parseInt(this.route.snapshot.paramMap.get("id"),10):null,ee=R.find(We=>We.Id===f);"name"===this.editMode&&delete this.reservedNames[ee.StaticName],this.fields.push(ee)}else for(let f=1;f<=8;f++)this.fields.push({Id:0,Type:u.O.String,InputType:U.u.StringDefault,StaticName:"",IsTitle:0===R.length,SortOrder:R.length+f});for(let f=0;f<this.fields.length;f++)this.filterInputTypeOptions(f),this.calculateHints(f);this.loading$.next(!1)})}ngOnDestroy(){this.loading$.complete(),this.saving$.complete(),super.ngOnDestroy()}closeDialog(){this.dialogRef.close()}filterInputTypeOptions(t){this.filteredInputTypeOptions[t]=this.inputTypeOptions.filter(o=>o.dataType===this.fields[t].Type.toLocaleLowerCase())}resetInputType(t){let o=this.fields[t].Type.toLocaleLowerCase()+U.u.DefaultSuffix;this.filteredInputTypeOptions[t].some(s=>s.inputType===o)||(o=this.filteredInputTypeOptions[t][0].inputType),this.fields[t].InputType=o}calculateHints(t){const o=this.dataTypes.find(s=>s.name===this.fields[t].Type),i=this.inputTypeOptions.find(s=>s.inputType===this.fields[t].InputType);this.dataTypeHints[t]=o?.description??"",this.inputTypeHints[t]=i?.isObsolete?`OBSOLETE - ${i.obsoleteMessage}`:i?.description??""}getInputTypeOption(t){return this.inputTypeOptions.find(o=>o.inputType===t)}addSharedField(){this.dialog.open(xe,{autoFocus:!1,width:"1600px",data:{contentType:this.contentType,existingFields:this.existingFields}})}save(){if(this.saving$.next(!0),this.snackBar.open("Saving..."),null!=this.editMode){const t=this.fields[0];"name"===this.editMode?this.contentTypesFieldsService.rename(t.Id,this.contentType.Id,t.StaticName).subscribe(()=>{this.saving$.next(!1),this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()}):"inputType"===this.editMode&&this.contentTypesFieldsService.updateInputType(t.Id,t.StaticName,t.InputType).subscribe(()=>{this.saving$.next(!1),this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()})}else(0,y.of)(...this.fields).pipe((0,x.p)(t=>!!t.StaticName),(0,M.H)(t=>this.contentTypesFieldsService.add(t,this.contentType.Id).pipe((0,c.W)(o=>(0,y.of)(null)))),C()).subscribe(t=>{this.saving$.next(!1),this.snackBar.open("Saved",null,{duration:2e3}),this.closeDialog()})}static#t=this.\u0275fac=function(o){return new(o||n)(e.rXU(d.CP),e.rXU(je.nX),e.rXU(Q.UG),e.rXU(d.bZ))};static#e=this.\u0275cmp=e.VBU({type:n,selectors:[["app-edit-content-type-fields"]],viewQuery:function(o,i){if(1&o&&e.GBs($e,5,r.cV),2&o){let s;e.mGM(s=e.lsd())&&(i.form=s.first)}},hostVars:1,hostBindings:function(o,i){2&o&&e.Mr5("className",i.hostClass)},standalone:!0,features:[e.Vt3,e.aNF],decls:8,vars:6,consts:[["ngForm","ngForm"],["staticName","ngModel"],["appToggleDebug","",1,"eav-dialog","eav-no-scrollbar"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[3,"ngSubmit"],[1,"eav-dialog-content"],[1,"eav-row-container"],["mat-raised-button","","type","button"],[1,"spacer"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","submit","color","accent",3,"disabled"],[1,"eav-edit-input"],["color","accent",1,"eav-mat-form-field"],["matInput","",3,"ngModelChange","pattern","appReservedNames","ngModel","name","disabled"],[3,"selectionChange","ngModelChange","ngModel","name","disabled"],[1,"eav-type-icon"],[3,"value"],[1,"eav-input-icon"],[3,"value","ngClass"],[3,"isError"]],template:function(o,i){1&o&&(e.j41(0,"div",2)(1,"div",3)(2,"div",4),e.DNE(3,Oe,1,0)(4,ke,1,0)(5,Ge,1,0),e.k0s()(),e.DNE(6,Ue,13,4,"form"),e.nI1(7,"async"),e.k0s()),2&o&&(e.R7$(3),e.vxM(3,void 0===i.editMode?3:-1),e.R7$(),e.vxM(4,null===i.editMode?4:-1),e.R7$(),e.vxM(5,null!=i.editMode?5:-1),e.R7$(),e.vxM(6,!1===e.bMT(7,4,i.loading$)?6:-1))},dependencies:[r.YN,r.qT,r.me,r.BC,r.cb,r.R_,r.vS,r.cV,S.RG,S.rl,S.nJ,$.fS,$.fg,j,H.Ve,H.VO,H.$2,K.wT,q.m_,q.An,K.Sy,P.YU,d.E7,I.Hl,I.$z,P.Jj,D.h,D.D9,W.F,Me.V],styles:[".eav-row-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.eav-edit-input[_ngcontent-%COMP%]{padding-bottom:8px;width:30%}.eav-type-icon[_ngcontent-%COMP%]{width:inherit;height:inherit;margin-right:8px;font-size:inherit;vertical-align:top;line-height:inherit}.eav-input-icon[_ngcontent-%COMP%]{width:inherit;height:inherit;margin-left:8px;font-size:inherit;vertical-align:top;line-height:inherit}.eav-input-obsolete[_ngcontent-%COMP%]{-webkit-text-decoration:black line-through;text-decoration:black line-through;color:#696969}"]})}return n})()},3758:(w,F,l)=>{l.d(F,{F:()=>M});var e=l(316),r=l(5944),d=l(7580);const _=["*"],O=c=>({"hint-box__short":c});function k(c,T){1&c&&d.eu8(0)}function G(c,T){if(1&c&&(d.j41(0,"mat-hint"),d.DNE(1,k,1,0,"ng-container",2),d.k0s()),2&c){d.XpG();const v=d.sdS(4);d.R7$(),d.Y8G("ngTemplateOutlet",v)}}function A(c,T){1&c&&d.eu8(0)}function y(c,T){if(1&c&&(d.j41(0,"mat-error"),d.DNE(1,A,1,0,"ng-container",2),d.k0s()),2&c){d.XpG();const v=d.sdS(4);d.R7$(),d.Y8G("ngTemplateOutlet",v)}}function x(c,T){1&c&&d.SdG(0)}let M=(()=>{class c{constructor(){this.isError=!1,this.isShort=!0}toggleIsShort(){this.isShort=!this.isShort}static#t=this.\u0275fac=function(b){return new(b||c)};static#e=this.\u0275cmp=d.VBU({type:c,selectors:[["app-field-hint"]],inputs:{isError:"isError"},standalone:!0,features:[d.aNF],ngContentSelectors:_,decls:5,vars:4,consts:[["content",""],[1,"hint-box",3,"click","ngClass"],[4,"ngTemplateOutlet"]],template:function(b,E){if(1&b){const C=d.RV6();d.NAR(),d.j41(0,"div",1),d.bIt("click",function(){return d.eBV(C),d.Njj(E.toggleIsShort())}),d.DNE(1,G,2,1)(2,y,2,1),d.k0s(),d.DNE(3,x,1,0,"ng-template",null,0,d.C5r)}if(2&b){let C;d.Y8G("ngClass",d.eq3(2,O,E.isShort)),d.R7$(),d.vxM(1,!1===(C=E.isError)?1:!0===C?2:-1)}},dependencies:[r.RG,r.MV,r.TL,e.YU,e.T3],styles:[".hint-box[_ngcontent-%COMP%]{margin-top:4px}.hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{font-size:12px;display:block}.hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]})}return c})()},519:(w,F,l)=>{function e(r){const d=document.createElement("textarea");d.value=r,d.setAttribute("readonly",""),d.style.position="absolute",d.style.left="-9999px",document.body.appendChild(d);const _=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);d.select(),document.execCommand("copy"),document.body.removeChild(d),_&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(_))}l.d(F,{l:()=>e})}}]);
//# sourceMappingURL=https://sources.2sxc.org/18.01.00/dist/ng-edit/projects_eav-ui_src_app_content-type-fields_edit-content-type-fields_edit-content-type-fields-56a972.a620f81d546d8fe5.js.map