{"version":3,"file":"projects_eav-ui_src_app_apps-management_create-inherited-app_create-inherited-app_component_t-b7baef.fb414445bf2358ec.js","mappings":"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","names":["i0","app_r1","Id","Name","CreateInheritedAppComponent","constructor","dialogRef","snackBar","this","hostClass","loading","signal","inheritableApps","undefined","appsListService","transient","AppsListService","form","buildForm","ngOnInit","fetchInheritedApps","closeDialog","close","create","disable","set","inheritId","controls","value","name","find","app","open","subscribe","error","enable","duration","next","getInheritable","UntypedFormGroup","UntypedFormControl","Validators","required","static","t","i1","i2","_angular_core__WEBPACK_IMPORTED_MODULE_1__","VBU","selectors","hostVars","hostBindings","rf","ctx","CreateInheritedAppComponent_For_14_Template","CreateInheritedAppComponent_Conditional_15_Template","length","touched","errors","valid","RouterOutlet","FormsModule","i3","ReactiveFormsModule","MatFormFieldModule","i4","MatSelectModule","i5","i6","MatOptionModule","MatDialogActions","MatButtonModule","i7","FieldHintComponent","webApiAppRoot","ImportAppService","HttpServiceBase","importApp","file","changedName","retryOnDuplicate","formData","FormData","append","http","post","apiUrl","params","zoneId","pipe","switchMap","result","Messages","MessageType","FileUploadMessageTypes","Warning","folderName","prompt","Text","of","_angular_core__WEBPACK_IMPORTED_MODULE_4__","jDH","factory","Éµfac","FieldHintComponent_Case_1_ng_container_1_Template","content_r2","FieldHintComponent_Case_2_ng_container_1_Template","isError","isShort","toggleIsShort","_angular_core__WEBPACK_IMPORTED_MODULE_0__","inputs","standalone","features","ngContentSelectors","_c0","decls","vars","consts","template","_r1","FieldHintComponent_Case_1_Template","FieldHintComponent_Case_2_Template","FieldHintComponent_ng_template_3_Template","_c1","tmp_2_0","NgClass","NgTemplateOutlet","styles"],"ignoreList":[],"sourceRoot":"webpack:///","sources":["./projects/eav-ui/src/app/apps-management/create-inherited-app/create-inherited-app.component.html","./projects/eav-ui/src/app/apps-management/create-inherited-app/create-inherited-app.component.ts","./projects/eav-ui/src/app/import-app/services/import-app.service.ts","./projects/eav-ui/src/app/shared/components/field-hint/field-hint.component.html","./projects/eav-ui/src/app/shared/components/field-hint/field-hint.component.ts"],"sourcesContent":["<div class=\"eav-dialog\">\r\n  <div class=\"eav-dialog-header\">\r\n    <div class=\"eav-dialog-header__title\">Create inherited App</div>\r\n  </div>\r\n  <div class=\"eav-dialog-content\">\r\n    <router-outlet></router-outlet>\r\n    <p>\r\n      Create an App which inherits everything (data, views, queries) from a global App. Only Apps which were\r\n      specifically\r\n      marked for this will be listed here, and these apps must already have been loaded into Cache. If you don't see the\r\n      App you expect, make sure that has happened.\r\n    </p>\r\n    <form [formGroup]=\"form\">\r\n      <mat-form-field color=\"accent\" class=\"eav-mat-form-field\">\r\n        <mat-label>Inherit App</mat-label>\r\n        <mat-select formControlName=\"inheritId\"\r\n          [placeholder]=\"inheritableApps() === undefined ? 'Loading...' : inheritableApps() === null || inheritableApps().length === 0 ? 'No inheritable apps found' : ''\">\r\n          @for (app of inheritableApps(); track app) {\r\n          <mat-option [value]=\"app.Id\">\r\n            {{ app.Name }}\r\n          </mat-option>\r\n          }\r\n        </mat-select>\r\n      </mat-form-field>\r\n      @if (form.controls.inheritId.touched && form.controls.inheritId.errors?.required) {\r\n      <app-field-hint [isError]=\"true\">\r\n        Required\r\n      </app-field-hint>\r\n      }\r\n    </form>\r\n  </div>\r\n  <mat-dialog-actions align=\"end\">\r\n    <button type=\"button\" mat-raised-button [disabled]=\"loading()\" (click)=\"closeDialog()\">\r\n      Cancel\r\n    </button>\r\n    <button type=\"button\" mat-raised-button color=\"accent\" [disabled]=\"loading() || !form.valid\" (click)=\"create()\">\r\n      Create\r\n    </button>\r\n  </mat-dialog-actions>\r\n</div>\r\n","import { Component, HostBinding, OnInit, signal } from '@angular/core';\r\nimport { UntypedFormControl, UntypedFormGroup, Validators, FormsModule, ReactiveFormsModule } from '@angular/forms';\r\nimport { MatDialogRef, MatDialogActions } from '@angular/material/dialog';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { App } from '../models/app.model';\r\nimport { AppsListService } from '../services/apps-list.service';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatOptionModule } from '@angular/material/core';\r\nimport { MatSelectModule } from '@angular/material/select';\r\nimport { MatFormFieldModule } from '@angular/material/form-field';\r\nimport { RouterOutlet } from '@angular/router';\r\nimport { FieldHintComponent } from '../../shared/components/field-hint/field-hint.component';\r\nimport { transient } from '../../core';\r\n\r\n@Component({\r\n  selector: 'app-create-inherited-app',\r\n  templateUrl: './create-inherited-app.component.html',\r\n  styleUrls: ['./create-inherited-app.component.scss'],\r\n  standalone: true,\r\n  imports: [\r\n    RouterOutlet,\r\n    FormsModule,\r\n    ReactiveFormsModule,\r\n    MatFormFieldModule,\r\n    MatSelectModule,\r\n    MatOptionModule,\r\n    MatDialogActions,\r\n    MatButtonModule,\r\n    FieldHintComponent\r\n  ],\r\n})\r\nexport class CreateInheritedAppComponent implements OnInit{\r\n  @HostBinding('className') hostClass = 'dialog-component';\r\n\r\n  form: UntypedFormGroup;\r\n\r\n  loading = signal<boolean>(false);\r\n  inheritableApps = signal<App[] | undefined>(undefined);\r\n\r\n  private appsListService = transient(AppsListService);\r\n\r\n  constructor(\r\n    private dialogRef: MatDialogRef<CreateInheritedAppComponent>,\r\n    private snackBar: MatSnackBar,\r\n  ) {\r\n    this.form = this.buildForm();\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.fetchInheritedApps();\r\n\r\n  }\r\n\r\n  closeDialog(): void {\r\n    this.dialogRef.close();\r\n  }\r\n\r\n  create(): void {\r\n    this.form.disable();\r\n    this.loading.set(true);\r\n    const inheritId = this.form.controls.inheritId.value;\r\n    // TODO:: remove after test\r\n    // const name = this.inheritableApps$.value.find(app => app.Id === inheritId).Name;\r\n    const name = this.inheritableApps().find(app => app.Id === inheritId).Name;\r\n    this.snackBar.open('Creating inherited app...');\r\n    this.appsListService.create(name, inheritId).subscribe({\r\n      error: () => {\r\n        this.form.enable();\r\n    this.loading.set(false);\r\n\r\n        this.snackBar.open('Failed to create inherited app. Please check console for more information', undefined, { duration: 3000 });\r\n      },\r\n      next: () => {\r\n        this.form.enable();\r\n        this.snackBar.open('Created inherited app', undefined, { duration: 2000 });\r\n        this.closeDialog();\r\n      },\r\n    });\r\n  }\r\n\r\n  private fetchInheritedApps(): void {\r\n    this.appsListService.getInheritable().subscribe({\r\n      error: () => {\r\n        this.inheritableApps.set(null);\r\n      },\r\n      next: (inheritableApps) => {\r\n        this.inheritableApps.set(inheritableApps);\r\n      },\r\n    });\r\n  }\r\n\r\n  private buildForm(): UntypedFormGroup {\r\n    const form = new UntypedFormGroup({\r\n      inheritId: new UntypedFormControl(null, [Validators.required]),\r\n    });\r\n    return form;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { Observable, of, switchMap } from 'rxjs';\r\nimport { FileUploadMessageTypes, FileUploadResult } from '../../shared/components/file-upload-dialog';\r\nimport { HttpServiceBase } from '../../shared/services/http-service-base';\r\n\r\nexport const webApiAppRoot = 'admin/app/';\r\n\r\n@Injectable()\r\nexport class ImportAppService extends HttpServiceBase {\r\n\r\n  importApp(file: File, changedName: string, retryOnDuplicate = false): Observable<FileUploadResult> {\r\n    const formData = new FormData();\r\n    formData.append('File', file);\r\n    formData.append('Name', changedName ?? '');\r\n    return this.http.post<FileUploadResult>(this.apiUrl(webApiAppRoot + 'Import'), formData, {\r\n      params: { zoneId: this.zoneId }\r\n    }).pipe(\r\n      switchMap(result => {\r\n        if (retryOnDuplicate && result.Messages[0]?.MessageType === FileUploadMessageTypes.Warning) {\r\n          const folderName = prompt(result.Messages[0].Text + ' Would you like to install it using another folder name?');\r\n          if (folderName) {\r\n            return this.importApp(file, folderName, true);\r\n          }\r\n        }\r\n        return of(result);\r\n      }),\r\n    );\r\n  }\r\n}\r\n","<div class=\"hint-box\" (click)=\"toggleIsShort()\" [ngClass]=\"{ 'hint-box__short': isShort }\">\r\n  @switch (isError) {\r\n    @case (false) {\r\n      <mat-hint>\r\n        <ng-container *ngTemplateOutlet=\"content\"></ng-container>\r\n      </mat-hint>\r\n    }\r\n    @case (true) {\r\n      <mat-error>\r\n        <ng-container *ngTemplateOutlet=\"content\"></ng-container>\r\n      </mat-error>\r\n    }\r\n  }\r\n</div>\r\n\r\n<ng-template #content>\r\n  <ng-content></ng-content>\r\n</ng-template>\r\n","import { NgClass, NgTemplateOutlet } from '@angular/common';\r\nimport { Component, Input } from '@angular/core';\r\nimport { MatFormFieldModule } from '@angular/material/form-field';\r\n\r\n@Component({\r\n  selector: 'app-field-hint',\r\n  templateUrl: './field-hint.component.html',\r\n  styleUrls: ['./field-hint.component.scss'],\r\n  standalone: true,\r\n  imports: [\r\n    MatFormFieldModule,\r\n    NgClass,\r\n    NgTemplateOutlet\r\n  ]\r\n})\r\nexport class FieldHintComponent {\r\n  @Input() isError = false;\r\n  isShort = true;\r\n\r\n  constructor() { }\r\n\r\n  toggleIsShort() {\r\n    this.isShort = !this.isShort;\r\n  }\r\n}\r\n"],"x_google_ignoreList":[]}