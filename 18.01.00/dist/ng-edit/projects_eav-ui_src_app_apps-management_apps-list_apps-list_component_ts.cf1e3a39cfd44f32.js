"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_apps-management_apps-list_apps-list_component_ts"],{1609:(P,h,e)=>{e.r(h),e.d(h,{AppsListComponent:()=>Q});var t=e(7580),f=e(2159),v=e(8136),p=e(1960),E=e(251),F=e(3216),C=e(8873),b=e(4824),I=e(3583),m=e(1034),d=e(5060),y=e(6256),n=e(3840),r=e(1657),u=e(7896);function g(o,L){1&o&&(t.j41(0,"mat-icon"),t.EFF(1,"foundation"),t.k0s())}function M(o,L){1&o&&(t.j41(0,"mat-icon"),t.EFF(1,"holiday_village"),t.k0s())}function j(o,L){if(1&o){const a=t.RV6();t.j41(0,"button",7),t.bIt("click",function(){t.eBV(a);const i=t.XpG();return t.Njj(i.do("flushCache"))}),t.j41(1,"mat-icon"),t.EFF(2,"cached"),t.k0s(),t.j41(3,"span"),t.EFF(4,"Flush cache"),t.k0s()(),t.j41(5,"button",8),t.bIt("click",function(){t.eBV(a);const i=t.XpG();return t.Njj(i.do("deleteApp"))}),t.j41(6,"mat-icon"),t.EFF(7,"delete"),t.k0s(),t.j41(8,"span"),t.EFF(9,"Delete"),t.k0s()()}if(2&o){const a=t.XpG();t.R7$(5),t.Y8G("disabled",!a.app.IsApp)}}let U=(()=>{class o{agInit(a){this.params=a,this.app=this.params.data}refresh(a){return!0}do(a){this.params.do(a,this.app)}static#e=this.\u0275fac=function(s){return new(s||o)};static#t=this.\u0275cmp=t.VBU({type:o,selectors:[["app-apps-list-actions"]],standalone:!0,features:[t.aNF],decls:11,vars:8,consts:[["menu","matMenu"],[1,"actions-component"],[1,"eav-grid-action-button","icon",3,"tippy","tippyDisabled"],[3,"lightSpeedOwner","params","lightSpeed"],["matRipple","","tippy","More",1,"eav-grid-action-button","highlight",3,"matMenuTriggerFor"],[1,"grid-more-menu"],["matMenuContent",""],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click","disabled"]],template:function(s,i){if(1&s&&(t.j41(0,"div",1)(1,"div",2),t.DNE(2,g,2,0,"mat-icon")(3,M,2,0,"mat-icon"),t.k0s(),t.nrm(4,"app-lightspeed-action",3),t.j41(5,"div",4)(6,"mat-icon"),t.EFF(7,"more_horiz"),t.k0s()()(),t.j41(8,"mat-menu",5,0),t.DNE(10,j,10,1,"ng-template",6),t.k0s()),2&s){const l=t.sdS(9);t.R7$(),t.Y8G("tippy",i.app.IsGlobal?"This app is global":i.app.IsInherited?"This app is inherited":"")("tippyDisabled",!i.app.IsGlobal&&!i.app.IsInherited),t.R7$(),t.vxM(2,i.app.IsGlobal?2:-1),t.R7$(),t.vxM(3,i.app.IsInherited?3:-1),t.R7$(),t.Y8G("lightSpeedOwner",i.app)("params",i.params)("lightSpeed",i.app.lightSpeed),t.R7$(),t.Y8G("matMenuTriggerFor",l)}},dependencies:[u.e,n.m_,n.An,y.Y,d.pZ,d.r6,m.Cn,m.kk,m.fb,m.z8,m.Cp,r.E],encapsulation:2})}return o})();var k=e(5541),O=e(7941),B=e(8713);const $={states:{true:{tooltip:"Show this app to users",icon:"visibility"},false:{tooltip:"Hide this app from users",icon:"visibility_off"}}},W={states:{true:{clickable:!0,tooltip:"This App uses obsolete code which will cause problems on future upgrades. Click to see details.",icon:"bug_report",getUrl:o=>window.$2sxc.http.apiUrl("sys/insights/logs?key=warnings-obsolete&filter=AppId="+o.Id)},false:{tooltip:"Hide this app from users",icon:""}}};var R=e(8991),D=e(4175),G=e(316),T=e(3183),N=e(8824),x=e(9509),c=e(1828),K=e(4575),Y=e(7037),S=e(5437),_=e(8471),V=e(4435),X=e(3347),H=e(9841);const z=o=>({"fab-opened":o});let Q=(()=>{class o{#e;#t;constructor(a,s,i,l,A){this.snackBar=a,this.context=s,this.dialog=i,this.viewContainerRef=l,this.changeDetectorRef=A,this.log=(0,V.T)({AppsListComponent:o}),this.fabOpen=(0,t.vPA)(!1),this.apps=(0,t.vPA)([]),this.gridOptions=this.buildGridOptions(),this.features=(0,t.WQX)(b.t),this.isAddFromFolderEnabled=this.features.isEnabled[v.T.AppSyncWithSiteFiles],this.#e=(0,S.d)(I.U),this.#t=(0,S.d)(_.c),N.syG.registerModules([x.Q])}ngOnInit(){this.#a(),this.#t.doOnDialogClosed(()=>this.#a())}openChange(a){this.fabOpen.set(a)}browseCatalog(){window.open("https://2sxc.org/apps","_blank")}createApp(){this.#t.navParentFirstChild(["create"])}createInheritedApp(){this.#t.navParentFirstChild(["create-inherited"])}addFromFolder(){this.#t.navParentFirstChild(["add-app-from-folder"])}importApp(a){this.#t.navParentFirstChild(["import"],{state:{files:a}})}deleteApp(a){const s=prompt(`This cannot be undone. To really delete this app, type 'yes!' or type/paste the app-name here. Are you sure want to delete '${a.Name}' (${a.Id})?`);null!==s&&(s===a.Name||"yes!"===s?(this.snackBar.open("Deleting..."),this.#e.delete(a.Id).subscribe({error:()=>{this.snackBar.open("Delete failed. Please check console for more information",void 0,{duration:3e3}),this.#a()},next:()=>{this.snackBar.open("Deleted",void 0,{duration:2e3}),this.#a()}})):alert("Input did not match - will not delete"))}flushApp(a){confirm(`Flush the App Cache for ${a.Name} (${a.Id})?`)&&(this.snackBar.open("Flushing cache..."),this.#e.flushCache(a.Id).subscribe({error:()=>{this.snackBar.open("Cache flush failed. Please check console for more information",void 0,{duration:3e3})},next:()=>{this.snackBar.open("Cache flushed",void 0,{duration:2e3})}}))}openLightSpeed(a){const s=(0,F.s)(B.g.getLightSpeedEditParams(a.Id));this.#t.navParentFirstChild([`${this.context.zoneId}/${a.Id}/edit/${s}`])}openApp(a){this.#t.navParentFirstChild([a.Id.toString()])}openLightSpeedFeatInfo(){(0,k.j)(this.dialog,v.T.LightSpeed,this.viewContainerRef,this.changeDetectorRef)}buildGridOptions(){return{...E.C,columnDefs:[{...c.r.IdWithDefaultRenderer,cellRendererParams:c.r.idFieldParamsTooltipGetter()},{...c.r.IconShow,cellRenderer:R.N,cellRendererParams:{settings:()=>$}},{...c.r.TextWide,field:"Name",cellClass:"apps-list-primary-action highlight".split(" "),sort:"asc",onCellClicked:s=>{this.openApp(s.data)},cellRenderer:s=>{const i=s.data;return`\n            <div class="container">\n              ${i.Thumbnail?`<img class="image logo" src="${i.Thumbnail}?w=40&h=40&mode=crop"></img>`:'<div class="image logo"><span class="material-symbols-outlined">star</span></div>'}\n              <div class="text">${s.value}</div>\n            </div>\n            `}},{...c.r.TextWide,field:"Folder"},{...c.r.Character,field:"Version",width:78},{...c.r.Number,field:"Items"},{...c.r.Boolean,field:"HasCodeWarnings",headerName:"Code",filter:p.y,cellRenderer:R.N,cellRendererParams:{settings:s=>W}},{...c.r.ActionsPinnedRight3,cellRenderer:U,cellRendererParams:{onOpenLightspeed:s=>this.openLightSpeed(s),openLightspeedFeatureInfo:()=>this.openLightSpeedFeatInfo(),do:(s,i)=>{switch(s){case"deleteApp":this.deleteApp(i);break;case"flushCache":this.flushApp(i)}}}}]}}#a(){this.#e.getAll().subscribe(a=>{console.log("apps",a),this.apps.set(a)})}static#i=this.\u0275fac=function(s){return new(s||o)(t.rXU(X.UG),t.rXU(C.o),t.rXU(O.bZ),t.rXU(t.c1b),t.rXU(t.gRc))};static#s=this.\u0275cmp=t.VBU({type:o,selectors:[["app-apps-list"]],standalone:!0,features:[t.aNF],decls:25,vars:9,consts:[[1,"grid-wrapper","mat-tab-grid-wrapper"],["appDragAndDrop","",1,"ag-theme-material",3,"filesDropped","rowData","gridOptions","allowedFileTypes"],["align","end"],[1,"eav-eco-fab-speed-dial",3,"openChange","ngClass"],[3,"spin"],["mat-fab",""],[1,"spin180"],[1,"eav-eco-fab-speed-dial-actions"],["mat-mini-fab","","label","Find more apps",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["mat-mini-fab","","label","Create inherited app",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["mat-mini-fab","","label","Add from folder",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["matBadgeColor","accent","matBadgeSize","small","matBadge","\u{1f48e}","matBadgePosition","below after","aria-hidden","false",3,"matBadgeHidden"],["mat-mini-fab","","label","Import app",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["mat-mini-fab","","label","Create app",1,"eav-eco-fab-speed-dial-action-button",3,"click"]],template:function(s,i){1&s&&(t.j41(0,"div",0)(1,"ag-grid-angular",1),t.bIt("filesDropped",function(A){return i.importApp(A)}),t.k0s(),t.j41(2,"mat-dialog-actions",2)(3,"eco-fab-speed-dial",3),t.bIt("openChange",function(A){return i.openChange(A)}),t.j41(4,"eco-fab-speed-dial-trigger",4)(5,"button",5)(6,"mat-icon",6),t.EFF(7),t.k0s()()(),t.j41(8,"eco-fab-speed-dial-actions",7)(9,"button",8),t.bIt("click",function(){return i.browseCatalog()}),t.j41(10,"mat-icon"),t.EFF(11,"search"),t.k0s()(),t.j41(12,"button",9),t.bIt("click",function(){return i.createInheritedApp()}),t.j41(13,"mat-icon"),t.EFF(14,"holiday_village"),t.k0s()(),t.j41(15,"button",10),t.bIt("click",function(){return i.addFromFolder()}),t.j41(16,"mat-icon",11),t.EFF(17," add "),t.k0s()(),t.j41(18,"button",12),t.bIt("click",function(){return i.importApp()}),t.j41(19,"mat-icon"),t.EFF(20,"cloud_upload"),t.k0s()(),t.j41(21,"button",13),t.bIt("click",function(){return i.createApp()}),t.j41(22,"mat-icon"),t.EFF(23,"add"),t.k0s()()()()()(),t.nrm(24,"router-outlet")),2&s&&(t.R7$(),t.Y8G("rowData",i.apps())("gridOptions",i.gridOptions)("allowedFileTypes","zip"),t.R7$(2),t.Y8G("ngClass",t.eq3(7,z,i.fabOpen())),t.R7$(),t.Y8G("spin",!0),t.R7$(3),t.JRh(i.fabOpen()?"close":"add"),t.R7$(9),t.Y8G("matBadgeHidden",i.isAddFromFolderEnabled()))},dependencies:[Y.p,H.xs,O.E7,T.TE,G.YU,T.p1,D.Hl,D.$0,D.Sr,n.m_,n.An,T.yf,y.Y,y.k,f.n3,K.S]})}return o})()},8136:(P,h,e)=>{e.d(h,{T:()=>t});const t={AppSyncWithSiteFiles:"AppSyncWithSiteFiles",WysiwygPasteFormatted:"WysiwygPasteFormatted",PasteImageFromClipboard:"PasteImageFromClipboard",EditUiShowNotes:"EditUiShowNotes",EditUiShowMetadataFor:"EditUiShowMetadataFor",NoSponsoredByToSic:"NoSponsoredByToSic",EditUiTranslateWithGoogle:"EditUiTranslateWithGoogle",LightSpeed:"LightSpeedOutputCache",ContentSecurityPolicy:"ContentSecurityPolicy",PermissionsByLanguage:"PermissionsByLanguage",FieldShareConfigManagement:"FieldShareConfigManagement",AppExportAssetsAdvanced:"AppExportAssetsAdvanced",PickerUiCheckbox:"PickerUiCheckbox",PickerUiRadio:"PickerUiRadio",PickerSourceCsv:"PickerSourceCsv",PickerFormulas:"PickerFormulas",PickerUiMoreInfo:"PickerUiMoreInfo"}},8471:(P,h,e)=>{e.d(h,{c:()=>m});var t=e(2159),f=e(1567),v=e(3037),p=e(271),E=e(5057),F=e(4979),C=e(4435),b=e(7580);const I={doOnDialogClosed:!0};let m=(()=>{class d extends F.V{constructor(n,r){super(),this.router=n,this.route=r,this.log=(0,C.T)({DialogRoutingService:d},I)}get snapshot(){return this.route.snapshot}get url(){return this.router.url}getParam(n){return this.route.snapshot.paramMap.get(n)}getParams(n){const r=this.route.snapshot.paramMap;return n.reduce((u,g)=>(u[g]=r.get(g),u),{})}getQueryParam(n){return this.route.snapshot.queryParamMap.get(n)}getQueryParams(n){const r=this.route.snapshot.queryParamMap;return n.reduce((u,g)=>(u[g]=r.get(g),u),{})}state(){return this.router.getCurrentNavigation().extras?.state}doOnDialogClosed(n){const r=this.log.fnIf("doOnDialogClosed");this.subscriptions.add(this.childDialogClosed$().subscribe(()=>n())),r.end()}navPath(n,r){return this.router.navigate([n],r)}navRelative(n,r){return this.router.navigate(n,{...r,relativeTo:this.route})}navParentFirstChild(n,r){return this.router.navigate(n,{...r,relativeTo:this.route.parent.firstChild})}childDialogClosed$(){return this.router.events.pipe((0,f.p)(n=>n instanceof t.wF),(0,v.Z)(!!this.route.snapshot.firstChild),(0,p.T)(()=>!!this.route.snapshot.firstChild),(0,E.J)(),(0,f.p)(([n,r])=>n&&!r))}static#e=this.\u0275fac=function(r){return new(r||d)(b.KVO(t.Ix),b.KVO(t.nX))};static#t=this.\u0275prov=b.jDH({token:d,factory:d.\u0275fac})}return d})()},4979:(P,h,e)=>{e.d(h,{V:()=>v});var t=e(7092),f=e(7580);let v=(()=>{class p{constructor(){this.subscriptions=new t.yU}ngOnDestroy(){this.destroy()}destroy(){this.subscriptions.unsubscribe()}static#e=this.\u0275fac=function(C){return new(C||p)};static#t=this.\u0275prov=f.jDH({token:p,factory:p.\u0275fac})}return p})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/18.01.00/dist/ng-edit/projects_eav-ui_src_app_apps-management_apps-list_apps-list_component_ts.cf1e3a39cfd44f32.js.map