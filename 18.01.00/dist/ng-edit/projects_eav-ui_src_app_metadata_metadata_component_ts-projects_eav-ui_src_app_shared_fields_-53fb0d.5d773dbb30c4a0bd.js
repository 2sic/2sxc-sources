"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_metadata_metadata_component_ts-projects_eav-ui_src_app_shared_fields_-53fb0d","projects_eav-ui_src_app_permissions_permissions_routing_ts"],{7693:(D,u,e)=>{e.d(u,{X:()=>_,g:()=>s});var t=e(271),m=e(6474),i=e(7580);const _="admin/type/",h="admin/type/scopes";let s=(()=>{class l extends m.D{retrieveContentType(g){return this.http.get(this.apiUrl("admin/type/get"),{params:{appId:this.appId,contentTypeId:g}})}retrieveContentTypes(g){return this.http.get(this.apiUrl("admin/type/list"),{params:{appId:this.appId,scope:g}})}getScopes(){return this.http.get(this.apiUrl(h),{params:{appId:this.appId}}).pipe((0,t.T)(g=>{const E=g.old;return Object.keys(E).map(O=>({name:E[O],value:O}))}))}getScopesV2(){return this.http.get(this.apiUrl(h),{params:{appId:this.appId}}).pipe((0,t.T)(g=>g.scopes))}save(g){return this.http.post(this.apiUrl("admin/type/save"),g,{params:{appid:this.appId}})}delete(g){return this.http.delete(this.apiUrl("admin/type/delete"),{params:{appid:this.appId,staticName:g.StaticName}})}import(g){const E=new FormData;for(const y of g)E.append("File",y);return this.http.post(this.apiUrl("admin/type/import"),E,{params:{appId:this.appId,zoneId:this.zoneId}})}createGhost(g){return this.http.post(this.apiUrl("admin/type/addghost"),null,{params:{appid:this.appId,sourceStaticName:g}})}static#t=this.\u0275fac=(()=>{let g;return function(y){return(g||(g=i.xGo(l)))(y||l)}})();static#e=this.\u0275prov=i.jDH({token:l,factory:l.\u0275fac})}return l})()},1475:(D,u,e)=>{e.d(u,{j:()=>_});var t=e(8624),m=e(6474),i=e(7580);let _=(()=>{class p extends m.D{getContentInfo(h){return this.http.get(this.apiUrl(t.Q+"Get"),{params:{appid:this.appId,zoneId:this.zoneId,scope:h}})}exportParts(h,v,f){const C=this.apiUrl(t.Q+"Export")+"?appId="+this.appId+"&zoneId="+this.zoneId+"&contentTypeIdsString="+h.join(";")+"&entityIdsString="+v.join(";")+"&templateIdsString="+f.join(";");window.open(C,"_blank","")}static#t=this.\u0275fac=(()=>{let h;return function(f){return(h||(h=i.xGo(p)))(f||p)}})();static#e=this.\u0275prov=i.jDH({token:p,factory:p.\u0275fac})}return p})()},320:(D,u,e)=>{e.d(u,{t:()=>_});var t=e(1772),m=e(6474),i=e(7580);let _=(()=>{class p extends m.D{getAppInfo(){return this.http.get(this.apiUrl(t.u+"Statistics"),{params:{appid:this.appId,zoneId:this.zoneId}})}exportAppUrl(){return`${this.apiUrl(`${t.u}Export`)}?appId=${this.appId}&zoneId=${this.zoneId}`}exportForVersionControl({includeContentGroups:h,resetAppGuid:v,withFiles:f}){return this.http.get(this.apiUrl(t.u+"SaveData"),{params:{appid:this.appId,zoneId:this.zoneId,includeContentGroups:h.toString(),resetAppGuid:v.toString(),withPortalFiles:f.toString()}})}static#t=this.\u0275fac=(()=>{let h;return function(f){return(h||(h=i.xGo(p)))(f||p)}})();static#e=this.\u0275prov=i.jDH({token:p,factory:p.\u0275fac})}return p})()},8624:(D,u,e)=>{e.d(u,{Q:()=>_,S:()=>p});var t=e(1772),m=e(6474),i=e(7580);const _="admin/appParts/";let p=(()=>{class d extends m.D{importAppParts(v){const f=new FormData;return f.append("File",v),this.http.post(this.apiUrl(_+"Import"),f,{params:{appId:this.appId,zoneId:this.zoneId}})}resetApp(v){return this.http.post(this.apiUrl(t.u+"Reset"),{},{params:{appId:this.appId,zoneId:this.zoneId,withPortalFiles:v.toString()}})}static#t=this.\u0275fac=(()=>{let v;return function(C){return(v||(v=i.xGo(d)))(C||d)}})();static#e=this.\u0275prov=i.jDH({token:d,factory:d.\u0275fac})}return d})()},5445:(D,u,e)=>{e.d(u,{Cu:()=>d.Cu,JL:()=>d.JL,Mk:()=>d.Mk,ei:()=>d.ei,gs:()=>m.g,tr:()=>t.t,vN:()=>d.vN,xR:()=>d.xR,y0:()=>h.y});var t=e(1479),m=e(7693),d=(e(1475),e(320),e(8624),e(6460)),h=e(2570)},6460:(D,u,e)=>{e.d(u,{Cu:()=>l,JL:()=>T,Mk:()=>c,ei:()=>s,vN:()=>g,xR:()=>E});var t=e(4600),m=e(6647),i=e(271),_=e(693),p=e(9234),d=e(6474),h=e(7580);const c="admin/query/Run",s="admin/query/DebugStream",l="admin/query/Save",T="admin/query/Get",g="admin/query/DataSources";let E=(()=>{class y extends d.D{getAll(R){return this.http.get(this.apiUrl(p.Gg),{params:{appId:this.appId,contentType:R}})}importQuery(R){return(0,t.H)((0,_.n)(R)).pipe((0,m.n)(S=>this.http.post(this.apiUrl("admin/query/import"),{AppId:this.appId,ContentBase64:S})),(0,i.T)(S=>({Success:S,Messages:[]})))}clonePipeline(R){return this.http.get(this.apiUrl("admin/query/Clone"),{params:{Id:R.toString(),appId:this.appId}})}delete(R){return this.http.delete(this.apiUrl("admin/query/Delete"),{params:{appId:this.appId,Id:R.toString()}})}static#t=this.\u0275fac=(()=>{let R;return function(B){return(R||(R=h.xGo(y)))(B||y)}})();static#e=this.\u0275prov=h.jDH({token:y,factory:y.\u0275fac})}return y})()},2570:(D,u,e)=>{e.d(u,{y:()=>f});var t=e(6474),m=e(7580);const i="admin/view/",_=i+"all",p=i+"delete",d=i+"import",h=i+"polymorphism",v=i+"usage";let f=(()=>{class C extends t.D{getAll(){return this.http.get(this.apiUrl(_),{params:{appId:this.appId}})}delete(s){return this.http.get(this.apiUrl(p),{params:{appId:this.appId,Id:s.toString()}})}import(s){const l=new FormData;return l.append("File",s),this.http.post(this.apiUrl(d),l,{params:{appId:this.appId,zoneId:this.zoneId}})}export(s){const l=this.apiUrl(i+"json")+"?appId="+this.appId+"&viewId="+s;window.open(l,"_blank","")}getPolymorphism(){return this.http.get(this.apiUrl(h),{params:{appId:this.appId}})}getUsage(s){return this.http.get(this.apiUrl(v),{params:{appId:this.appId,guid:s}})}static#t=this.\u0275fac=(()=>{let s;return function(T){return(s||(s=m.xGo(C)))(T||C)}})();static#e=this.\u0275prov=m.jDH({token:C,factory:C.\u0275fac})}return C})()},4305:(D,u,e)=>{e.r(u),e.d(u,{MetadataComponent:()=>Dt});var t=e(7580),m=e(7941),i=e(2159),_=e(4334),p=e(271),d=e(336),h=e(6817),v=e(4096),f=e(251),C=e(3216),c=e(334),s=e(4175),l=e(3777),T=e(9914);function g(n,I){if(1&n&&(t.nrm(0,"mat-card-subtitle",0),t.nI1(1,"safeHtml")),2&n){const a=t.XpG();t.Y8G("innerHtml",t.bMT(1,1,a.dialogData.message),t.npT)}}let E=(()=>{class n{constructor(a,r){this.dialogData=a,this.dialogRef=r,this.hostClass="dialog-component"}closeDialog(a){this.dialogRef.close(a)}static#t=this.\u0275fac=function(r){return new(r||n)(t.rXU(m.Vh),t.rXU(m.CP))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-confirm-delete-dialog"]],hostVars:1,hostBindings:function(r,o){2&r&&t.Mr5("className",o.hostClass)},standalone:!0,features:[t.aNF],decls:10,vars:3,consts:[[3,"innerHtml"],["align","end"],["mat-raised-button","",1,"eav-card-action-button",3,"click"]],template:function(r,o){1&r&&(t.j41(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),t.EFF(3),t.k0s(),t.DNE(4,g,2,3,"mat-card-subtitle",0),t.k0s(),t.j41(5,"mat-card-actions",1)(6,"button",2),t.bIt("click",function(){return o.closeDialog()}),t.EFF(7,"Cancel"),t.k0s(),t.j41(8,"button",2),t.bIt("click",function(){return o.closeDialog(!0)}),t.EFF(9,"Delete"),t.k0s()()()),2&r&&(t.R7$(3),t.Lme("Delete ",o.dialogData.entityTitle," (",o.dialogData.entityId,")?"),t.R7$(),t.vxM(4,o.dialogData.message?4:-1))},dependencies:[l.Hu,l.RN,l.YY,l.MM,l.Lc,l.dh,s.Hl,s.$z,T.$],styles:[".eav-card-action-button[_ngcontent-%COMP%]{margin-left:8px}"]})}return n})();var y=e(3840),O=e(5060);let R=(()=>{class n{agInit(a){this.params=a}refresh(a){return!0}deleteMetadata(){this.params.onDelete(this.params.data)}static#t=this.\u0275fac=function(r){return new(r||n)};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-metadata-actions"]],standalone:!0,features:[t.aNF],decls:4,vars:0,consts:[[1,"actions-component"],["matRipple","","tippy","Delete",1,"eav-grid-action-button","highlight",3,"click"]],template:function(r,o){1&r&&(t.j41(0,"div",0)(1,"div",1),t.bIt("click",function(){return o.deleteMetadata()}),t.j41(2,"mat-icon"),t.EFF(3,"delete"),t.k0s()()())},dependencies:[O.pZ,O.r6,y.m_,y.An]})}return n})();var S=e(7896);let B=(()=>{class n{agInit(a){this.value=a.value,this.metadata=a.data}refresh(a){return!0}static#t=this.\u0275fac=function(r){return new(r||n)};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-metadata-content-type"]],standalone:!0,features:[t.aNF],decls:2,vars:3,consts:[[1,"container",3,"tippy","tippyDisabled"]],template:function(r,o){1&r&&(t.j41(0,"div",0),t.EFF(1),t.k0s()),2&r&&(t.Y8G("tippy",o.metadata._Type.Description)("tippyDisabled",!o.metadata._Type.Description),t.R7$(),t.SpI(" ",o.value,"\n"))},dependencies:[S.e],styles:[".container[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content}"]})}return n})();var F=e(4456),G=e(8827),V=e(3037),H=e(1817),z=e(5445),$=e(5858),L=e(52),N=e(316),K=e(7984),k=e(5175),j=e(5944),Q=e(3758),J=e(9333),U=e(5437);const W=n=>({active:n});function Z(n,I){if(1&n&&(t.j41(0,"mat-option",14),t.EFF(1),t.k0s()),2&n){const a=I.$implicit;t.Y8G("value",a.value),t.R7$(),t.SpI(" ",a.name," ")}}function w(n,I){if(1&n&&(t.j41(0,"mat-form-field",2)(1,"mat-label"),t.EFF(2,"Scope"),t.k0s(),t.j41(3,"mat-select",13),t.Z7z(4,Z,2,2,"mat-option",14,t.fX1),t.j41(6,"mat-option",14),t.EFF(7,"Other..."),t.k0s()()(),t.j41(8,"app-field-hint"),t.EFF(9," The scope should almost never be changed - "),t.j41(10,"a",15),t.EFF(11,"see help"),t.k0s()()),2&n){const a=t.XpG();t.R7$(3),t.Y8G("placeholder",a.scopeOptions().length?"":"No items found"),t.R7$(),t.Dyx(a.scopeOptions()),t.R7$(2),t.Y8G("value",a.dropdownInsertValue)}}function q(n,I){if(1&n&&(t.j41(0,"mat-option",14),t.EFF(1),t.k0s()),2&n){const a=I.$implicit;t.Y8G("value",a.StaticName),t.R7$(),t.SpI(" ",a.Label," ")}}function tt(n,I){if(1&n&&(t.j41(0,"mat-select",3),t.Z7z(1,q,2,2,"mat-option",14,t.fX1),t.k0s()),2&n){const a=t.XpG();t.Y8G("placeholder",a.contentTypes().length?"":"No items found"),t.R7$(),t.Dyx(a.contentTypes())}}function et(n,I){1&n&&t.nrm(0,"input",4)}function at(n,I){1&n&&(t.j41(0,"app-field-hint",8),t.EFF(1," This field is required "),t.k0s()),2&n&&t.Y8G("isError",!0)}let nt=(()=>{class n{constructor(a){this.dialogRef=a,this.hostClass="dialog-component",this.dropdownInsertValue=$.O,this.guidedContentType=!0,this.advancedMode=!1,this.contentTypes=(0,t.vPA)([]),this.scopeOptions=(0,t.vPA)([]),this.contentTypesService=(0,U.d)(z.gs)}ngOnInit(){this.buildForm(),this.fetchScopes()}closeDialog(a){this.dialogRef.close(a)}toggleGuidedContentType(a){this.guidedContentType=a}toggleAdvancedMode(a){this.advancedMode=a.checked}confirm(){const a=this.form.getRawValue();this.closeDialog(a.contentType)}buildForm(){this.form=new F.J3({}),this.form.addControl("contentType",new F.hs(null,[F.k0.required])),this.form.addControl("scope",new F.hs(L.YX.scopes.default.value)),this.form.controls.scope.valueChanges.pipe((0,V.Z)(this.form.controls.scope.value),(0,H.F)()).subscribe(a=>{null!=this.form.controls.contentType.value&&this.form.controls.contentType.patchValue(null),a===$.O?(a=prompt("This is an advanced feature to show content-types of another scope. Don't use this if you don't know what you're doing, as content-types of other scopes are usually hidden for a good reason.")||L.YX.scopes.default.value,this.scopeOptions().some(r=>r.value===a)||this.scopeOptions.set([{name:a,value:a},...this.scopeOptions()]),this.form.controls.scope.patchValue(a)):this.fetchContentTypes(a)})}fetchContentTypes(a){this.contentTypesService.retrieveContentTypes(a).subscribe(r=>{this.contentTypes.set(r)})}fetchScopes(){this.contentTypesService.getScopes().subscribe(a=>{this.scopeOptions.set(a)})}static#t=this.\u0275fac=function(r){return new(r||n)(t.rXU(m.CP))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-metadata-save-dialog"]],hostVars:1,hostBindings:function(r,o){2&r&&t.Mr5("className",o.hostClass)},standalone:!0,features:[t.aNF],decls:33,vars:14,consts:[["href","https://go.2sxc.org/metadata","target","_blank"],[3,"formGroup"],["color","accent",1,"eav-mat-form-field"],["formControlName","contentType","required","",3,"placeholder"],["matInput","","type","text","formControlName","contentType","required",""],["matTextSuffix",""],["mat-icon-button","","type","button","tippy","Pick existing value",3,"click","ngClass"],["mat-icon-button","","type","button","tippy","Manual entry",3,"click","ngClass"],[3,"isError"],[1,"eav-card-actions"],["color","accent",3,"change","checked"],["mat-raised-button","",1,"eav-card-action-button",3,"click"],["mat-raised-button","","color","accent",1,"eav-card-action-button",3,"click","disabled"],["formControlName","scope",3,"placeholder"],[3,"value"],["href","https://2sxc.org/help?tag=scope","target","_blank","appClickStopPropagation",""]],template:function(r,o){1&r&&(t.j41(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),t.EFF(3,"Create Metadata"),t.k0s(),t.j41(4,"mat-card-subtitle"),t.EFF(5," This is a special operation to add an item which is metadata for another item, see "),t.j41(6,"a",0),t.EFF(7,"docs"),t.k0s(),t.EFF(8,". "),t.k0s()(),t.j41(9,"mat-card-content")(10,"form",1),t.DNE(11,w,12,2),t.j41(12,"mat-form-field",2)(13,"mat-label"),t.EFF(14,"Content Type"),t.k0s(),t.DNE(15,tt,3,1,"mat-select",3)(16,et,1,0,"input",4),t.j41(17,"div",5)(18,"button",6),t.bIt("click",function(){return o.toggleGuidedContentType(!0)}),t.j41(19,"mat-icon"),t.EFF(20,"search"),t.k0s()(),t.j41(21,"button",7),t.bIt("click",function(){return o.toggleGuidedContentType(!1)}),t.j41(22,"mat-icon"),t.EFF(23,"text_fields"),t.k0s()()()(),t.DNE(24,at,2,1,"app-field-hint",8),t.k0s()(),t.j41(25,"mat-card-actions",9)(26,"mat-slide-toggle",10),t.bIt("change",function(P){return o.toggleAdvancedMode(P)}),t.EFF(27),t.k0s(),t.j41(28,"div")(29,"button",11),t.bIt("click",function(){return o.closeDialog()}),t.EFF(30,"Cancel"),t.k0s(),t.j41(31,"button",12),t.bIt("click",function(){return o.confirm()}),t.EFF(32," Confirm "),t.k0s()()()()),2&r&&(t.R7$(10),t.Y8G("formGroup",o.form),t.R7$(),t.vxM(11,o.advancedMode&&o.guidedContentType?11:-1),t.R7$(4),t.vxM(15,o.guidedContentType?15:-1),t.R7$(),t.vxM(16,o.guidedContentType?-1:16),t.R7$(2),t.Y8G("ngClass",t.eq3(10,W,o.guidedContentType)),t.R7$(3),t.Y8G("ngClass",t.eq3(12,W,!o.guidedContentType)),t.R7$(3),t.vxM(24,o.form.controls.contentType.touched&&null!=o.form.controls.contentType.errors&&o.form.controls.contentType.errors.required?24:-1),t.R7$(2),t.Y8G("checked",o.advancedMode),t.R7$(),t.SpI(" ",o.advancedMode?"Advanced":"Simple"," "),t.R7$(4),t.Y8G("disabled",!o.form.valid))},dependencies:[l.Hu,l.RN,l.YY,l.m2,l.MM,l.Lc,l.dh,F.YN,F.qT,F.me,F.BC,F.cb,F.YS,F.X1,F.j4,F.JD,j.RG,j.rl,j.nJ,j.yw,k.Ve,k.VO,O.wT,O.Sy,K.fS,K.fg,s.Hl,s.$z,s.iY,N.YU,y.m_,y.An,G.mV,G.sG,Q.F,J.c],styles:[".eav-card-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.eav-card-action-button[_ngcontent-%COMP%]{margin-left:8px}"]})}return n})();var it=e(5541),Y=e(6256),x=e(3183),ot=e(7037),A=e(1828),st=e(1897),rt=e(8471),pt=e(4435),lt=e(3347),dt=e(9841);const ct=n=>({"fab-opened":n});function mt(n,I){1&n&&t.EFF(0," This item is not metadata for anything else. ")}function ht(n,I){if(1&n&&(t.nrm(0,"br"),t.EFF(1)),2&n){const a=t.XpG(2);t.R7$(),t.SpI("Key Number: ",a.itemFor().KeyNumber," ")}}function ut(n,I){if(1&n&&(t.nrm(0,"br"),t.EFF(1)),2&n){const a=t.XpG(2);t.R7$(),t.SpI("Key Guid: ",a.itemFor().KeyGuid," ")}}function _t(n,I){if(1&n&&(t.nrm(0,"br"),t.EFF(1)),2&n){const a=t.XpG(2);t.R7$(),t.SpI("Key String: ",a.itemFor().KeyString," ")}}function ft(n,I){if(1&n&&(t.nrm(0,"br"),t.EFF(1)),2&n){const a=t.XpG(2);t.R7$(),t.SpI("Title: ",a.itemFor().Title," ")}}function gt(n,I){if(1&n&&(t.EFF(0," This item is metadata for: "),t.nrm(1,"br"),t.EFF(2),t.nrm(3,"br"),t.EFF(4),t.DNE(5,ht,2,1)(6,ut,2,1)(7,_t,2,1)(8,ft,2,1)),2&n){const a=t.XpG();t.R7$(2),t.SpI("Target: ",a.itemFor().Target," "),t.R7$(2),t.SpI("TargetType: ",a.itemFor().TargetType," "),t.R7$(),t.vxM(5,a.itemFor().KeyNumber?5:-1),t.R7$(),t.vxM(6,a.itemFor().KeyGuid?6:-1),t.R7$(),t.vxM(7,a.itemFor().KeyString?7:-1),t.R7$(),t.vxM(8,a.itemFor().Title?8:-1)}}function vt(n,I){if(1&n){const a=t.RV6();t.j41(0,"button",10),t.bIt("click",function(){t.eBV(a);const o=t.XpG();return t.Njj(o.createMetadata())}),t.j41(1,"mat-icon"),t.EFF(2,"add"),t.k0s()()}}function yt(n,I){if(1&n&&(t.nrm(0,"div",19),t.nI1(1,"safeHtml")),2&n){const a=t.XpG().$implicit;t.Y8G("innerHTML",t.bMT(1,2,a.Icon),t.npT)("matBadgeHidden",a.Enabled)}}function Ct(n,I){1&n&&(t.j41(0,"mat-icon"),t.EFF(1,"add"),t.k0s())}function Tt(n,I){if(1&n){const a=t.RV6();t.j41(0,"button",18),t.bIt("click",function(){const o=t.eBV(a).$implicit,M=t.XpG(2);return t.Njj(M.createMetadata(o))}),t.DNE(1,yt,2,4,"div",19)(2,Ct,2,0),t.k0s()}if(2&n){const a=I.$implicit;t.BMQ("label",a.Title),t.R7$(),t.vxM(1,a.Icon?1:2)}}function It(n,I){if(1&n){const a=t.RV6();t.j41(0,"eco-fab-speed-dial",11),t.bIt("openChange",function(o){t.eBV(a);const M=t.XpG();return t.Njj(M.openChange(o))}),t.j41(1,"eco-fab-speed-dial-trigger",12)(2,"button",13)(3,"mat-icon",14),t.EFF(4),t.k0s()()(),t.j41(5,"eco-fab-speed-dial-actions",15)(6,"button",16),t.bIt("click",function(){t.eBV(a);const o=t.XpG();return t.Njj(o.createMetadata())}),t.j41(7,"mat-icon"),t.EFF(8,"search"),t.k0s()(),t.Z7z(9,Tt,3,2,"button",17,t.fX1),t.k0s()()}if(2&n){const a=t.XpG();t.Y8G("ngClass",t.eq3(3,ct,a.fabOpen())),t.R7$(),t.Y8G("spin",!0),t.R7$(3),t.JRh(a.fabOpen()?"close":"add"),t.R7$(5),t.Dyx(a.recommendations())}}let Dt=(()=>{class n{#t;#e;#o;#n;constructor(a,r,o,M,P){this.dialogRef=a,this.snackBar=r,this.dialog=o,this.viewContainerRef=M,this.changeDetectorRef=P,this.log=(0,pt.T)({MetadataComponent:n}),this.#t=(0,U.d)(h.R),this.#e=(0,U.d)(v.TI),this.#o=(0,U.d)(d.F),this.#n=(0,U.d)(rt.c),this.gridOptions=this.#l(),this.fabOpen=(0,t.vPA)(!1),this.itemFor=(0,t.vPA)(void 0),this.metadataSet=(0,t.vPA)({Items:[],Recommendations:[]}),this.recommendations=(0,t.EWP)(()=>{const b=this.metadataSet();return b.Recommendations.filter(X=>b.Items.filter(Et=>Et._Type.Id===X.Id).length<X.Count)}),this.#a=(0,st.C)(this.#n.getParams(["targetType","keyType","key","title","contentTypeStaticName"]),b=>({targetType:parseInt(b.targetType,10),keyType:b.keyType,key:b.key,contentTypeStaticName:b.contentTypeStaticName})),this.title=decodeURIComponent(this.#n.getParam("title")??"")}#a;ngOnInit(){this.#r(),this.#i(),this.#n.doOnDialogClosed(()=>this.#i())}closeDialog(){this.dialogRef.close()}openChange(a){this.fabOpen.set(a)}createMetadata(a){if(a)return a.Enabled?void(a.CreateEmpty?(this.snackBar.open(`Creating ${a.Name}...`),this.#t.create(a.Id,{For:this.calculateItemFor("dummy").For}).subscribe({error:()=>{this.snackBar.open(`Creating ${a.Name} failed. Please check console for more info`,void 0,{duration:3e3}),this.#i()},next:()=>{this.snackBar.open(`Created ${a.Name}`,void 0,{duration:3e3}),this.#i()}})):this.createMetadataForm(a.Id)):void(0,it.j)(this.dialog,a.MissingFeature,this.viewContainerRef,this.changeDetectorRef);this.dialog.open(nt,{autoFocus:!1,viewContainerRef:this.viewContainerRef,width:"650px"}).afterClosed().subscribe(o=>{null!=o&&this.createMetadataForm(o)})}createMetadataForm(a){const r={items:[this.calculateItemFor(a)]},o=(0,C.s)(r);this.#n.navRelative([`edit/${o}`]),this.changeDetectorRef.markForCheck()}calculateItemFor(a){const r=c.c.constructMetadataInfo(this.#a.targetType,this.#a.keyType,this.#a.key);return c.c.newMetadataFromInfo(a,r)}#r(){this.#a.contentTypeStaticName&&this.#o.getAll(this.#a.contentTypeStaticName).subscribe(a=>{const r=a.find(o=>o.Guid===this.#a.key);r?.For&&this.itemFor.set(r.For)})}#i(){const a=this.log.rxTap("getMetadata");this.#e.getMetadata(this.#a.targetType,this.#a.keyType,this.#a.key).pipe(a.pipe(),(0,_.s)(1),(0,p.T)(r=>(r.Recommendations.forEach(o=>{o.Icon?.startsWith("base64:")&&(o.Icon=o.Icon.replace("base64:",""),o.Icon=window.atob(o.Icon),o.Icon=o.Icon.replace('fill="#000000"','fill="#ffffff"'))}),r)),a.map()).subscribe(r=>{this.metadataSet.set(r)})}#p(a){const r={items:[c.c.editId(a.Id)]},o=(0,C.s)(r);this.#n.navRelative([`edit/${o}`])}#s(a,r=!1){if(r)this.snackBar.open("Deleting..."),this.#t.delete(a._Type.Id,a.Id,!1).subscribe({next:()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.#i()},error:()=>{this.snackBar.open("Delete failed. Please check console for more information",null,{duration:3e3})}});else{const o={entityId:a.Id,entityTitle:a.Title,message:this.metadataSet().Recommendations.find(P=>P.Id===a._Type.Id)?.DeleteWarning};this.dialog.open(E,{autoFocus:!1,data:o,viewContainerRef:this.viewContainerRef,width:"400px"}).afterClosed().subscribe(P=>{P&&this.#s(a,!0)})}}#l(){return{...f.C,columnDefs:[{...A.r.IdWithDefaultRenderer,cellRendererParams:A.r.idFieldParamsTooltipGetter()},{...A.r.TextWide,field:"Title",onCellClicked:r=>this.#p(r.data)},{...A.r.TextWide,headerName:"Content Type",field:"ContentType",valueGetter:r=>`${r.data._Type.Name}${r.data._Type.Title!==r.data._Type.Name?` (${r.data._Type.Title})`:""}`,cellRenderer:B},{...A.r.ActionsPinnedRight1,cellRenderer:R,cellRendererParams:{onDelete:r=>this.#s(r)}}]}}static#d=this.\u0275fac=function(r){return new(r||n)(t.rXU(m.CP),t.rXU(lt.UG),t.rXU(m.bZ),t.rXU(t.c1b),t.rXU(t.gRc))};static#c=this.\u0275cmp=t.VBU({type:n,selectors:[["app-metadata"]],standalone:!0,features:[t.aNF],decls:17,vars:6,consts:[[1,"eav-dialog","nav-component-wrapper"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"eav-dialog-content","nav-component-wrapper"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","gridOptions"],["align","end"],["mat-fab","","mat-elevation-z24","","tippy","Create a new metadata for this item",1,"grid-fab"],[1,"eav-eco-fab-speed-dial",3,"ngClass"],["mat-fab","","mat-elevation-z24","","tippy","Create a new metadata for this item",1,"grid-fab",3,"click"],[1,"eav-eco-fab-speed-dial",3,"openChange","ngClass"],[3,"spin"],["mat-fab",""],[1,"spin180"],[1,"eav-eco-fab-speed-dial-actions"],["mat-mini-fab","","label","Other Content Type",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["mat-mini-fab","",1,"eav-eco-fab-speed-dial-action-button"],["mat-mini-fab","",1,"eav-eco-fab-speed-dial-action-button",3,"click"],["matBadgeColor","accent","matBadgeSize","small","matBadge","\u{1f48e}","matBadgePosition","below after","aria-hidden","false",2,"color","white","fill","white",3,"innerHTML","matBadgeHidden"]],template:function(r,o){1&r&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.EFF(3),t.k0s(),t.j41(4,"button",3),t.bIt("click",function(){return o.closeDialog()}),t.j41(5,"mat-icon"),t.EFF(6,"close"),t.k0s()()(),t.j41(7,"div",4)(8,"p"),t.DNE(9,mt,1,0)(10,gt,9,6),t.k0s(),t.nrm(11,"router-outlet"),t.j41(12,"div",5),t.nrm(13,"ag-grid-angular",6),t.k0s()(),t.j41(14,"mat-dialog-actions",7),t.DNE(15,vt,3,0,"button",8)(16,It,11,5,"eco-fab-speed-dial",9),t.k0s()()),2&r&&(t.R7$(3),t.SpI(" ",o.title||"Metadata"," "),t.R7$(6),t.vxM(9,o.itemFor()?10:9),t.R7$(4),t.Y8G("rowData",o.metadataSet().Items)("gridOptions",o.gridOptions),t.R7$(2),t.vxM(15,0===o.recommendations().length?15:-1),t.R7$(),t.vxM(16,o.recommendations().length>0?16:-1))},dependencies:[s.Hl,s.iY,s.$0,s.Sr,y.m_,y.An,i.n3,ot.p,dt.xs,m.E7,x.TE,N.YU,x.p1,x.yf,Y.Y,Y.k,T.$],styles:["[_nghost-%COMP%]     .mat-button-wrapper div svg *:not([fill]){fill:#fff}"]})}return n})()},2437:(D,u,e)=>{e.d(u,{k:()=>m});var t=e(52);let m=(()=>{class i{static#t=this.route={path:"permissions/:targetType/:keyType/:key",loadChildren:()=>e.e("projects_eav-ui_src_app_permissions_permissions_routing_ts").then(e.bind(e,3516)).then(p=>p.permissionRoutes),data:{title:"Permissions"}};static getUrl(p,d,h){return`permissions/${p}/${d}/${h}`}static getUrlApp(p){return this.getUrl(t.YX.metadata.app.targetType,t.YX.metadata.app.keyType,p.toString())}static getUrlAttribute(p){return this.getUrl(t.YX.metadata.attribute.targetType,t.YX.metadata.attribute.keyType,p.toString())}static getUrlContentType(p){return this.getUrlEntity(p)}static getUrlEntity(p){return this.getUrl(t.YX.metadata.entity.targetType,t.YX.metadata.entity.keyType,p)}static getUrlLanguage(p){return this.getUrl(t.YX.metadata.language.targetType,t.YX.metadata.language.keyType,p)}}return i})()},4096:(D,u,e)=>{e.d(u,{Kn:()=>d.K,TI:()=>p.T,k4:()=>t.k});var t=e(2437),p=(e(2365),e(3516),e(2458),e(401)),d=e(4900)},2365:(D,u,e)=>{e.d(u,{v:()=>m});var t=e(9204);const m={name:"SET_PERMISSIONS_DIALOG",initContext:!0,panelSize:"large",panelClass:null,getComponent:()=>(0,t.A)(function*(){const{PermissionsComponent:i}=yield Promise.all([e.e("default-node_modules_angular_forms_fesm2022_forms_mjs"),e.e("default-projects_eav-ui_src_app_shared_directives_tippy_directive_ts"),e.e("default-node_modules_angular_material_fesm2022_radio_mjs"),e.e("default-projects_eav-ui_src_app_shared_ag-grid_column-definitions_ts-projects_eav-ui_src_app_-3cb379"),e.e("default-projects_eav-ui_src_app_permissions_permissions_component_ts")]).then(e.bind(e,2458));return i})()}},3516:(D,u,e)=>{e.r(u),e.d(u,{permissionRoutes:()=>_});var t=e(5544),m=e(2365),i=e(1195);const _=[{path:"",component:t.DialogEntryComponent,data:{dialog:m.v},children:i.RD}]},3758:(D,u,e)=>{e.d(u,{F:()=>c});var t=e(316),m=e(5944),i=e(7580);const _=["*"],p=s=>({"hint-box__short":s});function d(s,l){1&s&&i.eu8(0)}function h(s,l){if(1&s&&(i.j41(0,"mat-hint"),i.DNE(1,d,1,0,"ng-container",2),i.k0s()),2&s){i.XpG();const T=i.sdS(4);i.R7$(),i.Y8G("ngTemplateOutlet",T)}}function v(s,l){1&s&&i.eu8(0)}function f(s,l){if(1&s&&(i.j41(0,"mat-error"),i.DNE(1,v,1,0,"ng-container",2),i.k0s()),2&s){i.XpG();const T=i.sdS(4);i.R7$(),i.Y8G("ngTemplateOutlet",T)}}function C(s,l){1&s&&i.SdG(0)}let c=(()=>{class s{constructor(){this.isError=!1,this.isShort=!0}toggleIsShort(){this.isShort=!this.isShort}static#t=this.\u0275fac=function(g){return new(g||s)};static#e=this.\u0275cmp=i.VBU({type:s,selectors:[["app-field-hint"]],inputs:{isError:"isError"},standalone:!0,features:[i.aNF],ngContentSelectors:_,decls:5,vars:4,consts:[["content",""],[1,"hint-box",3,"click","ngClass"],[4,"ngTemplateOutlet"]],template:function(g,E){if(1&g){const y=i.RV6();i.NAR(),i.j41(0,"div",1),i.bIt("click",function(){return i.eBV(y),i.Njj(E.toggleIsShort())}),i.DNE(1,h,2,1)(2,f,2,1),i.k0s(),i.DNE(3,C,1,0,"ng-template",null,0,i.C5r)}if(2&g){let y;i.Y8G("ngClass",i.eq3(2,p,E.isShort)),i.R7$(),i.vxM(1,!1===(y=E.isError)?1:!0===y?2:-1)}},dependencies:[m.RG,m.MV,m.TL,t.YU,t.T3],styles:[".hint-box[_ngcontent-%COMP%]{margin-top:4px}.hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{font-size:12px;display:block}.hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-hint[_ngcontent-%COMP%], .hint-box__short[_ngcontent-%COMP%]   .mat-mdc-form-field-error[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]})}return s})()},5858:(D,u,e)=>{e.d(u,{O:()=>t});const t="DROPDOWN_INSERT_VALUE"},9333:(D,u,e)=>{e.d(u,{c:()=>i});var t=e(4435),m=e(7580);let i=(()=>{class _{constructor(){this.log=(0,t.T)({ClickStopPropagationDirective:_}),this.log.a("constructor")}onClick(d){this.log.a("onClick",{event:d}),d.stopPropagation(),d.preventDefault()}static#t=this.\u0275fac=function(h){return new(h||_)};static#e=this.\u0275dir=m.FsC({type:_,selectors:[["","appClickStopPropagation",""]],hostBindings:function(h,v){1&h&&m.bIt("click",function(C){return v.onClick(C)})},standalone:!0})}return _})()},5959:(D,u,e)=>{e.d(u,{h6:()=>v,zZ:()=>d});var t=e(271),m=e(7693),i=e(6474),_=e(7580);const p="admin/field/",d="admin/field/all",h="admin/field/GetSharedFields";let v=(()=>{class f extends i.D{typeListRetrieve(){return this.http.get(this.apiUrl(p+"DataTypes"),{params:{appid:this.appId}})}getInputTypesList(){return this.http.get(this.apiUrl(p+"InputTypes"),{params:{appid:this.appId}}).pipe((0,t.T)(c=>c.map(l=>({dataType:l.Type.substring(0,l.Type.indexOf("-")),inputType:l.Type,label:l.Label,description:l.Description,isDefault:l.IsDefault,isObsolete:l.IsObsolete,isRecommended:l.IsRecommended,obsoleteMessage:l.ObsoleteMessage,icon:l.IsDefault?"star":l.IsRecommended?"star_outline":null}))))}getReservedNames(){return this.http.get(this.apiUrl(p+"ReservedNames"))}getFields(c){return this.http.get(this.apiUrl(d),{params:{appid:this.appId,staticName:c}}).pipe((0,t.T)(s=>{if(s)for(const l of s){if(!l.Metadata)continue;const T=l.Metadata;T.merged={...T.All,...T[l.Type],...T[l.InputType]}}return s}))}getShareableFields(){return this.http.get(this.apiUrl(h),{params:{appid:this.appId}})}getShareableFieldsFor(c){return this.http.get(this.apiUrl(h),{params:{appid:this.appId,attributeId:c.toString()}})}addInheritedField(c,s,l,T){return this.http.post(this.apiUrl(p+"AddInheritedField"),null,{params:{AppId:this.appId,ContentTypeId:c.toString(),SourceType:s,SourceField:l,name:T}})}share(c,s=!0){return this.http.post(this.apiUrl(p+"Share"),null,{params:{appid:this.appId,attributeId:c.toString(),share:s}})}inherit(c,s){return this.http.post(this.apiUrl(p+"Inherit"),null,{params:{appid:this.appId,attributeId:c.toString(),inheritMetadataOf:s}})}reOrder(c,s){return this.http.post(this.apiUrl(p+"Sort"),null,{params:{appid:this.appId,contentTypeId:s.Id.toString(),order:JSON.stringify(c)}})}setTitle(c,s){return this.http.post(this.apiUrl(m.X+"SetTitle"),null,{params:{appid:this.appId,contentTypeId:s.Id.toString(),attributeId:c.Id.toString()}})}rename(c,s,l){return this.http.post(this.apiUrl(p+"Rename"),null,{params:{appid:this.appId,contentTypeId:s.toString(),attributeId:c.toString(),newName:l}})}delete(c,s){if(c.IsTitle)throw new Error("Can't delete Title");return this.http.delete(this.apiUrl(p+"Delete"),{params:{appid:this.appId,contentTypeId:s.Id.toString(),attributeId:c.Id.toString()}})}add(c,s){return this.http.post(this.apiUrl(p+"Add"),null,{params:{AppId:this.appId,ContentTypeId:s.toString(),Id:c.Id.toString(),Type:c.Type,InputType:c.InputType,StaticName:c.StaticName,IsTitle:c.IsTitle.toString(),Index:c.SortOrder.toString()}})}updateInputType(c,s,l){return this.http.post(this.apiUrl(p+"InputType"),null,{params:{appId:this.appId,attributeId:c.toString(),field:s,inputType:l}})}static#t=this.\u0275fac=(()=>{let c;return function(l){return(c||(c=_.xGo(f)))(l||f)}})();static#e=this.\u0275prov=_.jDH({token:f,factory:f.\u0275fac})}return f})()},693:(D,u,e)=>{function t(i){return new Promise((_,p)=>{const d=new FileReader;d.readAsDataURL(i),d.onload=()=>{_(d.result.split(",")[1])},d.onerror=h=>{p(h)}})}function m(i){return new Promise((_,p)=>{const d=new FileReader;d.readAsText(i),d.onload=()=>{_(d.result)},d.onerror=h=>{p(h)}})}e.d(u,{d:()=>m,n:()=>t})}}]);
//# sourceMappingURL=https://sources.2sxc.org/18.01.00/dist/ng-edit/projects_eav-ui_src_app_metadata_metadata_component_ts-projects_eav-ui_src_app_shared_fields_-53fb0d.5d773dbb30c4a0bd.js.map