"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_apps-management_licence-info_license-info_component_ts"],{6243:(L,f,s)=>{s.r(f),s.d(f,{LicenseInfoComponent:()=>lt});var h=s(9841),d=s(7941),F=s(2159),u=s(5797),P=s(4205),b=s(3037),D=s(6647),x=s(1318),T=s(9452),$=s(8764),p=s(271),U=s(1870),r=s(1873),c=s(4581),g=s(1960),m=s(6378),k=s(251),B=s(519),v=s(3840),M=s(4175),C=s(3777),O=s(7896),N=s(9914),t=s(7580),A=s(3347);function H(a,l){if(1&a){const e=t.RV6();t.j41(0,"div",1)(1,"div",5),t.EFF(2,"ID:"),t.k0s(),t.j41(3,"div",6)(4,"span",7),t.bIt("click",function(){const i=t.eBV(e),o=t.XpG();return t.Njj(o.copyToClipboard(i))}),t.EFF(5),t.k0s()()()}if(2&a){const e=l;t.R7$(4),t.Y8G("tippy",e),t.R7$(),t.JRh(e)}}function W(a,l){if(1&a){const e=t.RV6();t.j41(0,"div",1)(1,"div",5),t.EFF(2,"GUID:"),t.k0s(),t.j41(3,"div",8)(4,"span",7),t.bIt("click",function(){const i=t.eBV(e),o=t.XpG();return t.Njj(o.copyToClipboard(i))}),t.EFF(5),t.k0s()()()}if(2&a){const e=l;t.R7$(4),t.Y8G("tippy",e),t.R7$(),t.JRh(e)}}function S(a,l){1&a&&(t.j41(0,"div",1)(1,"div",5),t.EFF(2,"Security Rating:"),t.k0s(),t.j41(3,"div",6)(4,"span"),t.EFF(5),t.k0s()()()),2&a&&(t.R7$(5),t.JRh(l))}let V=(()=>{class a{constructor(e,n,i){this.dialogData=e,this.dialogRef=n,this.snackBar=i}closeDialog(){this.dialogRef.close()}findOutMore(e){window.open(e,"_blank")}copyToClipboard(e){(0,B.l)(e),this.snackBar.open("Copied to clipboard",null,{duration:2e3})}static#t=this.\u0275fac=function(n){return new(n||a)(t.rXU(d.Vh),t.rXU(d.CP),t.rXU(A.UG))};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["app-feature-details-dialog"]],standalone:!0,features:[t.aNF],decls:17,vars:7,consts:[[3,"innerHtml"],[1,"eav-info-row"],["align","end"],["mat-raised-button","","color","accent",1,"eav-card-action-button",3,"click"],["mat-raised-button","",1,"eav-card-action-button",3,"click"],[1,"eav-info-row__label"],[1,"eav-info-row__value"],[3,"click","tippy"],[1,"eav-info-row__value","eav_click"]],template:function(n,i){if(1&n&&(t.j41(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),t.EFF(3),t.k0s()(),t.j41(4,"mat-card-content"),t.nrm(5,"p",0),t.nI1(6,"safeHtml"),t.DNE(7,H,6,2,"div",1)(8,W,6,2,"div",1)(9,S,6,1,"div",1),t.k0s(),t.j41(10,"mat-card-actions",2)(11,"button",3),t.bIt("click",function(){return i.findOutMore(i.dialogData.feature.link)}),t.j41(12,"mat-icon"),t.EFF(13,"open_in_new"),t.k0s(),t.EFF(14," Find out more "),t.k0s(),t.j41(15,"button",4),t.bIt("click",function(){return i.closeDialog()}),t.EFF(16," Close "),t.k0s()()()),2&n){let o,I,w;t.R7$(3),t.JRh(i.dialogData.feature.name),t.R7$(2),t.Y8G("innerHtml",t.bMT(6,5,i.dialogData.feature.description),t.npT),t.R7$(2),t.vxM(7,(o=i.dialogData.feature.nameId)?7:-1,o),t.R7$(),t.vxM(8,(I=i.dialogData.feature.guid)?8:-1,I),t.R7$(),t.vxM(9,(w=i.dialogData.feature.security.Impact+": "+i.dialogData.feature.security.Message)?9:-1,w)}},dependencies:[C.Hu,C.RN,C.YY,C.m2,C.MM,C.dh,M.Hl,M.$z,v.m_,v.An,O.e,N.$]})}return a})(),J=(()=>{class a{agInit(e){this.value=e.value,this.feature=e.data}refresh(e){return!0}static#t=this.\u0275fac=function(n){return new(n||a)};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["app-features-list-enabled-reason"]],standalone:!0,features:[t.aNF],decls:2,vars:2,consts:[[3,"tippy"]],template:function(n,i){1&n&&(t.j41(0,"div",0),t.EFF(1),t.k0s()),2&n&&(t.Y8G("tippy",i.feature.enabledReasonDetailed),t.R7$(),t.JRh(i.value))},dependencies:[O.e]})}return a})(),K=(()=>{class a{agInit(e){this.value=e.value}refresh(e){return!0}static#t=this.\u0275fac=function(n){return new(n||a)};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["app-features-list-enabled"]],standalone:!0,features:[t.aNF],decls:3,vars:1,consts:[[1,"icon-container"]],template:function(n,i){1&n&&(t.j41(0,"div",0)(1,"mat-icon"),t.EFF(2),t.k0s()()),2&n&&(t.R7$(2),t.JRh(i.value?"check_box":"check_box_outline_blank"))},dependencies:[v.m_,v.An]})}return a})();var j=s(316),_=s(8827);const Y=(a,l)=>({"toggle-false":a,"toggle-null":l});let X=(()=>{class a{agInit(e){this.params=e,this.value=e.value,this.disabled=e.isDisabled(e.data),this.tooltip=e.tooltipGetter(e.data)}refresh(e){return this.disabled=this.params.isDisabled(this.params.data),!0}toggle(){const e=this.params.data;let n;switch(this.value){case!1:n=null;break;case null:n=!0;break;case!0:n=!1}this.value=n,this.params.onToggle(e,n)}static#t=this.\u0275fac=function(n){return new(n||a)};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["app-features-status"]],standalone:!0,features:[t.aNF],decls:1,vars:7,consts:[[3,"change","checked","tippy","disabled","ngClass"]],template:function(n,i){1&n&&(t.j41(0,"mat-slide-toggle",0),t.bIt("change",function(){return i.toggle()}),t.k0s()),2&n&&t.Y8G("checked",i.value)("tippy",i.tooltip)("disabled",i.disabled)("ngClass",t.l_i(4,Y,!1===i.value,null===i.value))},dependencies:[_.mV,_.sG,j.YU,O.e],styles:["[_nghost-%COMP%]{height:100%;display:flex;padding-left:12px;padding-right:12px;align-items:center}.mat-mdc-slide-toggle[_ngcontent-%COMP%]{padding-top:0}  .toggle-false.mat-mdc-slide-toggle:not(.mat-mdc-slide-toggle-checked):not(.mat-disabled) .mdc-switch__track:before{background-color:orange!important}  .toggle-null .mdc-switch__handle{margin-left:8px}"]})}return a})();class E{static expandFeature(l){return{...l,...E.getExpiration(l?.expiration)}}static expandLicense(l){try{const e=l?.Features?.map(i=>i.expiration).sort()[0];return null==e?l:{...l,...E.getExpiration(e)}}catch{return l}}static getExpiration(l){const e=(o,I)=>({ExpMessage:(null!=o?o+" ":"")+I,ExpIcon:o,ExpWarningIcon:"\u2705"!=o?o:null}),n=l?.split("T")[0];if(null==n)return e(null,null);if(n.startsWith("9999"))return e("\u2705","never");const i=new Date(n);return i<new Date?e("\u{1f6d1}","expired"):i.toDateString()===(new Date).toDateString()?e("\u26a0\ufe0f","today"):i.toDateString()===new Date((new Date).setDate((new Date).getDate()+1)).toDateString()?e("\u26a0\ufe0f","tomorrow"):i<new Date((new Date).setDate((new Date).getDate()+30))?e("\u26a0\ufe0f",n):n.endsWith("12-31")?e("\u2705",`EOY ${n.split("-")[0]}`):e("\u2753",n)}}let z=(()=>{class a{transform(e){return`${e.Features.filter(n=>n.isEnabled).length}/${e.Features.length}`}static#t=this.\u0275fac=function(n){return new(n||a)};static#e=this.\u0275pipe=t.EJ8({name:"activeFeaturesCount",type:a,pure:!0,standalone:!0})}return a})(),Q=(()=>{class a{transform(e){return Array.isArray(e)?[...e].sort((i,o)=>i.Priority<o.Priority?-1:i.Priority>o.Priority?1:0):e}static#t=this.\u0275fac=function(n){return new(n||a)};static#e=this.\u0275pipe=t.EJ8({name:"licensesOrder",type:a,pure:!0,standalone:!0})}return a})(),Z=(()=>{class a{constructor(e){this.itemsCount=0,this.headerHeight=32,this.rowHeight=48,this.maxRows=100,this.extraHeight=2,this.element=e.nativeElement}ngOnChanges(e){null!=e.itemsCount&&(this.element.style.height=`${this.headerHeight+(0===this.itemsCount?2:this.itemsCount>this.maxRows?this.maxRows:this.itemsCount)*this.rowHeight+this.extraHeight}px`)}static#t=this.\u0275fac=function(n){return new(n||a)(t.rXU(t.aKT))};static#e=this.\u0275dir=t.FsC({type:a,selectors:[["","appAgGridHeight",""]],inputs:{itemsCount:"itemsCount",headerHeight:"headerHeight",rowHeight:"rowHeight",maxRows:"maxRows"},standalone:!0,features:[t.OA$]})}return a})();var R=s(353),q=s(3992),tt=s(8824),et=s(9509),y=s(1828),nt=s(7037),G=s(5437),at=s(8471);const it=a=>({expanded:a});function st(a,l){if(1&a&&t.nrm(0,"ag-grid-angular",9),2&a){const e=t.XpG().$implicit,n=t.XpG(2);t.Y8G("rowData",e.Features)("gridOptions",n.gridOptions)("itemsCount",null==e.Features?null:e.Features.length)}}function ot(a,l){if(1&a&&(t.j41(0,"mat-expansion-panel",null,0)(2,"mat-expansion-panel-header")(3,"mat-panel-title")(4,"mat-icon",5),t.EFF(5),t.k0s(),t.j41(6,"div")(7,"div",6)(8,"span"),t.EFF(9),t.k0s(),t.j41(10,"span",7),t.EFF(11),t.nI1(12,"activeFeaturesCount"),t.k0s(),t.j41(13,"span"),t.EFF(14),t.k0s()(),t.j41(15,"div",8),t.EFF(16),t.k0s()()()(),t.DNE(17,st,1,3,"ag-grid-angular",9),t.k0s()),2&a){const e=l.$implicit,n=t.sdS(1);t.R7$(4),t.Y8G("tippy",e.IsEnabled?"License is active":"License is not active"),t.R7$(),t.JRh(e.IsEnabled?"check_circle_outline":"cancel"),t.R7$(4),t.JRh(e.Name),t.R7$(2),t.JRh(t.bMT(12,8,e)),t.R7$(3),t.SpI(" ",e.ExpWarningIcon,""),t.R7$(),t.Y8G("ngClass",t.eq3(10,it,n.expanded)),t.R7$(),t.SpI(" ",e.Description," "),t.R7$(),t.vxM(17,n.expanded?17:-1)}}function rt(a,l){1&a&&(t.j41(0,"mat-accordion",1),t.Z7z(1,ot,18,12,"mat-expansion-panel",null,t.BUC().trackLicenses,!0),t.nI1(3,"licensesOrder"),t.k0s()),2&a&&(t.R7$(),t.Dyx(t.bMT(3,0,l.licenses)))}let lt=(()=>{class a{#t;#e;#n;constructor(e,n,i){this.dialog=e,this.viewContainerRef=n,this.changeDetectorRef=i,this.disabled$=new u.t(!1),this.gridOptions=this.#s(),this.#t=new P.B,this.#e=(0,G.d)(q.b),this.#n=(0,G.d)(at.c),tt.syG.registerModules([et.Q])}ngOnInit(){this.#n.doOnDialogClosed(()=>this.#t.next()),this.viewModel$=this.#t.pipe((0,b.Z)(void 0),(0,D.n)(()=>this.#e.getLicenses().pipe((0,x.W)(()=>(0,T.of)(void 0)))),(0,$.M)(()=>this.disabled$.next(!1)),(0,p.T)(e=>e.map(n=>({...E.expandLicense(n),Features:n.Features.map(i=>E.expandFeature(i))}))),(0,U.u)()).pipe((0,p.T)(e=>({licenses:e})))}ngOnDestroy(){this.disabled$.complete()}trackLicenses(e,n){return n.Guid}openRegistration(){const e=this.#n.router;e.navigate([e.url.replace("license","")+"/registration"])}#a(e){this.dialog.open(V,{autoFocus:!1,data:{feature:e},viewContainerRef:this.viewContainerRef,width:"600px"}),this.changeDetectorRef.markForCheck()}#i(e,n){this.disabled$.next(!0),(0,r.p)([this.#e.saveFeatures([{FeatureGuid:e.guid,Enabled:n}]),(0,c.O)(100)]).subscribe({error:()=>{this.#t.next()},next:()=>{this.#t.next()}})}#s(){return{...k.C,columnDefs:[{...y.r.ItemsText,headerName:"ID",field:"nameId",width:200,cellClass:"no-outline",cellRenderer:m.L,cellRendererParams:{tooltipGetter:i=>i.nameId}},{...y.r.TextWideFlex3,headerName:"Name",field:"name",cellClass:"primary-action highlight".split(" "),onCellClicked:n=>{this.#a(n.data)}},{headerName:"Enabled",field:"isEnabled",width:80,cellClass:"no-outline",headerClass:"dense",sortable:!0,filter:g.y,cellRenderer:K},{...y.r.TextNarrow,headerName:"Reason",field:"enabledReason",cellRenderer:J},{...y.r.ItemsText,headerName:"Expiration",field:"ExpMessage",sortable:!1,width:120,tooltipValueGetter:n=>n.data?.expiration},{...y.r.ActionsPinnedRight7,headerName:"",field:"enabledInConfiguration",cellRenderer:X,cellRendererParams:()=>({isDisabled:i=>!i.isConfigurable||this.disabled$.value,onToggle:(i,o)=>this.#i(i,o),tooltipGetter:i=>i.isConfigurable?"Toggle off | default | on":"This feature can't be configured"})}]}}static#o=this.\u0275fac=function(n){return new(n||a)(t.rXU(d.bZ),t.rXU(t.c1b),t.rXU(t.gRc))};static#r=this.\u0275cmp=t.VBU({type:a,selectors:[["app-license-info"]],viewQuery:function(n,i){if(1&n&&t.GBs(h.xs,5),2&n){let o;t.mGM(o=t.lsd())&&(i.gridRef=o.first)}},standalone:!0,features:[t.aNF],decls:9,vars:3,consts:[["panel",""],["multi",""],["align","start"],["mat-button","","tippy","Registration",1,"eav-button__with-icon",3,"click"],[1,"eav-icon"],[1,"panel-icon",3,"tippy"],[1,"panel-title"],[1,"active-features-count"],[1,"panel-description",3,"ngClass"],["appAgGridHeight","",1,"ag-theme-material",3,"rowData","gridOptions","itemsCount"]],template:function(n,i){if(1&n&&(t.DNE(0,rt,4,2,"mat-accordion",1),t.nI1(1,"async"),t.j41(2,"mat-dialog-actions",2)(3,"button",3),t.bIt("click",function(){return i.openRegistration()}),t.j41(4,"mat-icon",4),t.EFF(5,"app_registration"),t.k0s(),t.j41(6,"span"),t.EFF(7,"Registration"),t.k0s()()(),t.nrm(8,"router-outlet")),2&n){let o;t.vxM(0,(o=t.bMT(1,1,i.viewModel$))?0:-1,o)}},dependencies:[R.MY,R.BS,R.GK,R.Z2,R.WN,v.m_,v.An,j.YU,nt.p,h.xs,Z,d.E7,M.Hl,M.$z,F.n3,j.Jj,Q,z,O.e],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;padding-top:20px;box-sizing:border-box;position:relative}.mat-expansion-panel-header[_ngcontent-%COMP%]{padding-top:4px;padding-bottom:4px}.mat-expansion-panel-header[_ngcontent-%COMP%]     .mat-content{max-height:100%}.panel-icon[_ngcontent-%COMP%]{margin-right:16px}.panel-title[_ngcontent-%COMP%]{font-size:14px}.active-features-count[_ngcontent-%COMP%]{display:inline-block;margin-left:8px;color:#fff;font-size:12px;border-radius:12px;padding:2px 6px;background-color:#002753;border:1px solid rgba(29,39,61,.44);box-sizing:border-box;-webkit-user-select:none;user-select:none;white-space:nowrap}.panel-description[_ngcontent-%COMP%]{padding-top:4px;font-size:12px;color:#0000008a;overflow:hidden;text-overflow:ellipsis;max-height:1em;line-height:1em}.panel-description.expanded[_ngcontent-%COMP%]{max-height:3em}.eav-button__with-icon[_ngcontent-%COMP%]   .eav-icon[_ngcontent-%COMP%]{font-size:24px;height:24px;width:24px}"]})}return a})()},8471:(L,f,s)=>{s.d(f,{c:()=>$});var h=s(2159),d=s(1567),F=s(3037),u=s(271),P=s(5057),b=s(4979),D=s(4435),x=s(7580);const T={doOnDialogClosed:!0};let $=(()=>{class p extends b.V{constructor(r,c){super(),this.router=r,this.route=c,this.log=(0,D.T)({DialogRoutingService:p},T)}get snapshot(){return this.route.snapshot}get url(){return this.router.url}getParam(r){return this.route.snapshot.paramMap.get(r)}getParams(r){const c=this.route.snapshot.paramMap;return r.reduce((g,m)=>(g[m]=c.get(m),g),{})}getQueryParam(r){return this.route.snapshot.queryParamMap.get(r)}getQueryParams(r){const c=this.route.snapshot.queryParamMap;return r.reduce((g,m)=>(g[m]=c.get(m),g),{})}state(){return this.router.getCurrentNavigation().extras?.state}doOnDialogClosed(r){const c=this.log.fnIf("doOnDialogClosed");this.subscriptions.add(this.childDialogClosed$().subscribe(()=>r())),c.end()}navPath(r,c){return this.router.navigate([r],c)}navRelative(r,c){return this.router.navigate(r,{...c,relativeTo:this.route})}navParentFirstChild(r,c){return this.router.navigate(r,{...c,relativeTo:this.route.parent.firstChild})}childDialogClosed$(){return this.router.events.pipe((0,d.p)(r=>r instanceof h.wF),(0,F.Z)(!!this.route.snapshot.firstChild),(0,u.T)(()=>!!this.route.snapshot.firstChild),(0,P.J)(),(0,d.p)(([r,c])=>r&&!c))}static#t=this.\u0275fac=function(c){return new(c||p)(x.KVO(h.Ix),x.KVO(h.nX))};static#e=this.\u0275prov=x.jDH({token:p,factory:p.\u0275fac})}return p})()},4979:(L,f,s)=>{s.d(f,{V:()=>F});var h=s(7092),d=s(7580);let F=(()=>{class u{constructor(){this.subscriptions=new h.yU}ngOnDestroy(){this.destroy()}destroy(){this.subscriptions.unsubscribe()}static#t=this.\u0275fac=function(D){return new(D||u)};static#e=this.\u0275prov=d.jDH({token:u,factory:u.\u0275fac})}return u})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/18.01.00/dist/ng-edit/projects_eav-ui_src_app_apps-management_licence-info_license-info_component_ts.c9ab9b5551879a49.js.map