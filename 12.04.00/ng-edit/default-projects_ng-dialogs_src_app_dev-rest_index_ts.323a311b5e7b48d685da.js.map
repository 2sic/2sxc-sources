{"version":3,"sources":["./projects/ng-dialogs/src/app/app-administration/services/app-dialog-config.service.ts","./projects/ng-dialogs/src/app/app-administration/services/content-types.service.ts","./projects/ng-dialogs/src/app/app-administration/services/export-app-parts.service.ts","./projects/ng-dialogs/src/app/app-administration/services/export-app.service.ts","./projects/ng-dialogs/src/app/app-administration/services/import-app-parts.service.ts","./projects/ng-dialogs/src/app/app-administration/services/pipelines.service.ts","./projects/ng-dialogs/src/app/app-administration/services/views.service.ts","./projects/ng-dialogs/src/app/app-administration/services/web-apis.service.ts","./projects/ng-dialogs/src/app/content-items/services/entities.service.ts","./projects/ng-dialogs/src/app/dev-rest/dev-rest-base.component.ts","./projects/ng-dialogs/src/app/dev-rest/go-to-dev-rest.ts","./projects/ng-dialogs/src/app/dev-rest/scenarios/all-scenarios.ts","./projects/ng-dialogs/src/app/dev-rest/examples/api-call.ts","./projects/ng-dialogs/src/app/dev-rest/examples/code-sample.ts","./projects/ng-dialogs/src/app/dev-rest/examples/generate-samples.ts","./projects/ng-dialogs/src/app/dev-rest/examples/index.ts","./projects/ng-dialogs/src/app/dev-rest/help-popup/help-popup.component.html","./projects/ng-dialogs/src/app/dev-rest/help-popup/help-popup.component.ts","./projects/ng-dialogs/src/app/dev-rest/routing-helpers.ts","./projects/ng-dialogs/src/app/dev-rest/info-box/hint.ts","./projects/ng-dialogs/src/app/dev-rest/selector-with-help/selector-with-help.component.html","./projects/ng-dialogs/src/app/dev-rest/selector-with-help/selector-with-help.component.ts","./projects/ng-dialogs/src/app/permissions/go-to-permissions.ts","./projects/ng-dialogs/src/app/permissions/permissions-dialog.config.ts","./projects/ng-dialogs/src/app/permissions/permissions-routing.module.ts","./projects/ng-dialogs/src/app/permissions/ag-grid-components/permissions-actions/permissions-actions.component.ts","./projects/ng-dialogs/src/app/permissions/ag-grid-components/permissions-actions/permissions-actions.component.html","./projects/ng-dialogs/src/app/permissions/permissions.component.ts","./projects/ng-dialogs/src/app/permissions/permissions.component.html","./projects/ng-dialogs/src/app/permissions/permissions.module.ts","./projects/ng-dialogs/src/app/permissions/services/metadata.service.ts","./projects/ng-dialogs/src/app/permissions/services/permissions.service.ts","./projects/ng-dialogs/src/app/shared/components/id-field/id-field.component.ts","./projects/ng-dialogs/src/app/shared/components/id-field/id-field.component.html","./projects/ng-dialogs/src/app/shared/helpers/copy-to-clipboard.helper.ts","./projects/ng-dialogs/src/app/shared/helpers/file-to-base64.helper.ts"],"names":["http","context","dnnContext","getDialogSettings","this","get","$2sxc","apiUrl","webApiDialogRoot","params","appid","appId","toString","AppDialogConfigService","webApiTypeRoot","name","retrieveContentType","staticName","contentTypeId","retrieveContentTypes","scope","getScopes","pipe","scopes","Object","keys","map","key","value","save","contentType","post","delete","StaticName","import","files","formData","FormData","append","zoneId","createGhost","sourceStaticName","ContentTypesService","getContentInfo","exportParts","contentTypeIds","entityIds","templateIds","url","join","window","open","ExportAppPartsService","getAppInfo","exportApp","includeContentGroups","resetAppGuid","exportForVersionControl","ExportAppService","webApiAppPartsRoot","importAppParts","file","resetApp","ImportAppPartsService","webApiQueryRun","webApiQueryRoot","webApiQueryDebugStream","webApiQuerySave","webApiQueryGet","webApiQueryDataSources","getAll","importQuery","fileBase64","AppId","ContentBase64","clonePipeline","id","Id","PipelinesService","webApiViewRoot","export","getPolymorphism","getUsage","guid","ViewsService","global","path","mask","withSubfolders","paths","splitIndex","lastIndexOf","fileExtIndex","folder","substring","create","purpose","details","apiPath","WebApisService","type","tryForce","force","EntitiesService","appDialogConfigService","dialogRef","router","route","permissionsService","subscription","scenarios","scenario$","dialogSettings$","buildPermissionStream","routeTargetName","paramMap","pm","rootBasedOnScenario","root","scenario","domainPrefix","document","location","protocol","host","useVirtual","inSameSite","buildBaseTemplateVars","identity","diag","permissions","apiCalls","currentScenario","encodeURI","Context","App","Folder","moduleId","permissionsHasAnonymous","filter","p","Condition","indexOf","length","permissionTarget","changeScenario","next","ngOnDestroy","complete","unsubscribe","closeDialog","close","DevRestBase","base","GoToDevRest","routeData","paramTypeName","paramQuery","paramApiPath","goToData","goToQuery","queryGuid","goToWebApi","api","encodeURIComponent","loadChildren","then","m","DevRestModule","AllScenarios","in2sxc","inSameContext","description","notes","needsAnonymous","virtual","verb","teaser","instructions","enableButton","code","browseUrl","title","runInConsole","hints","trim","generateApiCalls","startsWith","withId","contextParams","tabId","directUrl","directWId","ApiCall","snippetsGet","snippetsCreate","snippetsUpdate","snippetsDelete","list","pathWithContext","push","CodeSample","hint$2sxc","endPointGetter","endPointGetWithParams","warningExternal","warningSimpleSampleOnly","dialogData","ngOnInit","HelpPopupComponent","fireOnStartAndWhenSubDialogCloses","events","event","startWith","snapshot","firstChild","pairwise","infoBoxIconMap","alert","info","tip","warning","message","link","icon","dialog","valueChange","selectionChange","items","find","item","emit","showHelp","autoFocus","data","body","width","SelectorWithHelpComponent","GoToPermissions","go","targetType","keyType","goEntity","goContentType","goAttribute","goApp","PermissionsModule","permissionsDialog","initContext","panelSize","panelClass","getComponent","routes","component","children","matcher","EditModule","RefreshEditModule","PermissionsRoutingModule","agInit","refresh","deletePermission","onDelete","PermissionsActionsComponent","snackBar","permissions$","BehaviorSubject","modules","gridOptions","frameworkComponents","idFieldComponent","permissionsActionsComponent","columnDefs","headerName","field","headerClass","cellClass","cellRenderer","sortable","cellRendererParams","tooltipGetter","paramsData","Guid","flex","minWidth","sort","onCellClicked","editPermission","bind","pinned","Subscription","parseInt","fetchPermissions","refreshOnChildClosed","subscribe","form","target","values","metaValue","ContentTypeName","For","Target","Number","String","EntityId","formUrl","navigate","relativeTo","permission","confirm","Title","duration","add","PermissionsComponent","getMetadata","typeId","contentTypeName","MetadataService","metadataService","entitiesService","PermissionsService","tooltip","copy","IdFieldComponent","copyToClipboard","str","el","createElement","setAttribute","style","position","left","appendChild","selected","getSelection","rangeCount","getRangeAt","select","execCommand","removeChild","removeAllRanges","addRange","toBase64","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","split","onerror","error","readAsText"],"mappings":"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","file":"default-projects_ng-dialogs_src_app_dev-rest_index_ts.323a311b5e7b48d685da.js","sourcesContent":["import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { Context } from '../../shared/services/context';\r\nimport { DialogSettings } from '../models/dialog-settings.model';\r\n\r\nconst webApiDialogRoot = 'admin/dialog/';\r\n\r\n@Injectable()\r\nexport class AppDialogConfigService {\r\n  constructor(private http: HttpClient, private context: Context, private dnnContext: DnnContext) { }\r\n\r\n  getDialogSettings() {\r\n    return this.http.get<DialogSettings>(this.dnnContext.$2sxc.http.apiUrl(webApiDialogRoot + 'settings'), {\r\n      params: { appid: this.context.appId.toString() },\r\n    });\r\n  }\r\n}\r\n","import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { map } from 'rxjs/operators';\r\nimport { ImportAppResult } from '../../import-app/models/import-app-result.model';\r\nimport { EavScopeOption } from '../../shared/constants/eav.constants';\r\nimport { Context } from '../../shared/services/context';\r\nimport { ContentType, ContentTypeEdit } from '../models/content-type.model';\r\n\r\nexport const webApiTypeRoot = 'admin/type/';\r\n\r\n@Injectable()\r\nexport class ContentTypesService {\r\n  constructor(private http: HttpClient, private context: Context, private dnnContext: DnnContext) { }\r\n\r\n  private apiUrl(name: string) {\r\n    return this.dnnContext.$2sxc.http.apiUrl(name);\r\n  }\r\n\r\n  retrieveContentType(staticName: string) {\r\n    return this.http.get<ContentType>(this.apiUrl(webApiTypeRoot + 'get'), {\r\n      params: { appId: this.context.appId.toString(), contentTypeId: staticName }\r\n    });\r\n  }\r\n\r\n  retrieveContentTypes(scope: string) {\r\n    return this.http.get<ContentType[]>(this.apiUrl(webApiTypeRoot + 'list'), {\r\n      params: { appId: this.context.appId.toString(), scope }\r\n    });\r\n  }\r\n\r\n  getScopes() {\r\n    return this.http.get<Record<string, string>>(this.apiUrl(webApiTypeRoot + 'scopes'), {\r\n      params: { appId: this.context.appId.toString() }\r\n    }).pipe(\r\n      map(scopes => {\r\n        const scopeOptions: EavScopeOption[] = Object.keys(scopes).map(key => ({ name: scopes[key], value: key }));\r\n        return scopeOptions;\r\n      }),\r\n    );\r\n  }\r\n\r\n  save(contentType: ContentTypeEdit) {\r\n    return this.http.post<boolean>(this.apiUrl(webApiTypeRoot + 'save'), contentType, {\r\n      params: { appid: this.context.appId.toString() },\r\n    });\r\n  }\r\n\r\n  delete(contentType: ContentType) {\r\n    return this.http.delete<boolean>(this.apiUrl(webApiTypeRoot + 'delete'), {\r\n      params: { appid: this.context.appId.toString(), staticName: contentType.StaticName },\r\n    });\r\n  }\r\n\r\n  import(files: File[]) {\r\n    const formData = new FormData();\r\n    for (const file of files) {\r\n      formData.append('File', file);\r\n    }\r\n    return this.http.post<ImportAppResult>(this.apiUrl(webApiTypeRoot + 'import'), formData, {\r\n      params: { appId: this.context.appId.toString(), zoneId: this.context.zoneId.toString() }\r\n    });\r\n  }\r\n\r\n  createGhost(sourceStaticName: string) {\r\n    return this.http.post<boolean>(this.apiUrl(webApiTypeRoot + 'addghost'), null, {\r\n      params: { appid: this.context.appId.toString(), sourceStaticName },\r\n    });\r\n  }\r\n}\r\n","import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { Context } from '../../shared/services/context';\r\nimport { ContentInfo } from '../models/content-info.model';\r\nimport { webApiAppPartsRoot } from './import-app-parts.service';\r\n\r\n@Injectable()\r\nexport class ExportAppPartsService {\r\n  constructor(private http: HttpClient, private context: Context, private dnnContext: DnnContext) { }\r\n\r\n  getContentInfo(scope: string) {\r\n    return this.http.get<ContentInfo>(this.dnnContext.$2sxc.http.apiUrl(webApiAppPartsRoot + 'Get'), {\r\n      params: { appid: this.context.appId.toString(), zoneId: this.context.zoneId.toString(), scope },\r\n    });\r\n  }\r\n\r\n  exportParts(contentTypeIds: number[], entityIds: number[], templateIds: number[]) {\r\n    const url = this.dnnContext.$2sxc.http.apiUrl(webApiAppPartsRoot + 'Export')\r\n      + '?appId=' + this.context.appId.toString()\r\n      + '&zoneId=' + this.context.zoneId.toString()\r\n      + '&contentTypeIdsString=' + contentTypeIds.join(';')\r\n      + '&entityIdsString=' + entityIds.join(';')\r\n      + '&templateIdsString=' + templateIds.join(';');\r\n\r\n    window.open(url, '_blank', '');\r\n  }\r\n}\r\n","import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { webApiAppRoot } from '../../import-app/services/import-app.service';\r\nimport { Context } from '../../shared/services/context';\r\nimport { AppInfo } from '../models/app-info.model';\r\n\r\n@Injectable()\r\nexport class ExportAppService {\r\n  constructor(private http: HttpClient, private context: Context, private dnnContext: DnnContext) { }\r\n\r\n  getAppInfo() {\r\n    return this.http.get<AppInfo>(this.dnnContext.$2sxc.http.apiUrl(webApiAppRoot + 'Statistics'), {\r\n      params: { appid: this.context.appId.toString(), zoneId: this.context.zoneId.toString() },\r\n    });\r\n  }\r\n\r\n  exportApp(includeContentGroups: boolean, resetAppGuid: boolean) {\r\n    const url = this.dnnContext.$2sxc.http.apiUrl(webApiAppRoot + 'Export')\r\n      + '?appId=' + this.context.appId\r\n      + '&zoneId=' + this.context.zoneId\r\n      + '&includeContentGroups=' + includeContentGroups\r\n      + '&resetAppGuid=' + resetAppGuid;\r\n\r\n    window.open(url, '_blank', '');\r\n  }\r\n\r\n  exportForVersionControl(includeContentGroups: boolean, resetAppGuid: boolean) {\r\n    return this.http.get<boolean>(this.dnnContext.$2sxc.http.apiUrl(webApiAppRoot + 'SaveData'), {\r\n      params: {\r\n        appid: this.context.appId.toString(),\r\n        zoneId: this.context.zoneId.toString(),\r\n        includeContentGroups: includeContentGroups.toString(),\r\n        resetAppGuid: resetAppGuid.toString(),\r\n      },\r\n    });\r\n  }\r\n}\r\n","import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { ImportAppResult } from '../../import-app/models/import-app-result.model';\r\nimport { webApiAppRoot } from '../../import-app/services/import-app.service';\r\nimport { Context } from '../../shared/services/context';\r\n\r\nexport const webApiAppPartsRoot = 'admin/appParts/';\r\n\r\n@Injectable()\r\nexport class ImportAppPartsService {\r\n  constructor(private http: HttpClient, private context: Context, private dnnContext: DnnContext) { }\r\n\r\n  importAppParts(file: File) {\r\n    const formData = new FormData();\r\n    formData.append('File', file);\r\n    return this.http.post<ImportAppResult>(this.dnnContext.$2sxc.http.apiUrl(webApiAppPartsRoot + 'Import'), formData, {\r\n      params: { appId: this.context.appId.toString(), zoneId: this.context.zoneId.toString() }\r\n    });\r\n  }\r\n\r\n  /** Reset the App back to the state it was in the last xml export */\r\n  resetApp() {\r\n    return this.http.post<ImportAppResult>(this.dnnContext.$2sxc.http.apiUrl(webApiAppRoot + 'Reset'), {}, {\r\n      params: { appId: this.context.appId.toString(), zoneId: this.context.zoneId.toString() }\r\n    });\r\n  }\r\n}\r\n","import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { from } from 'rxjs';\r\nimport { mergeMap } from 'rxjs/operators';\r\nimport { webApiEntityList } from '../../../../../edit/shared/services';\r\nimport { toBase64 } from '../../shared/helpers/file-to-base64.helper';\r\nimport { Context } from '../../shared/services/context';\r\nimport { Query } from '../models/query.model';\r\n\r\nconst webApiQueryRoot = 'admin/query/';\r\nconst webApiQueryImport = webApiQueryRoot + 'import';\r\nconst webApiQueryClone = webApiQueryRoot + 'Clone';\r\nconst webApiQueryDelete = webApiQueryRoot + 'Delete';\r\nexport const webApiQueryRun = webApiQueryRoot + 'Run';\r\nexport const webApiQueryDebugStream = webApiQueryRoot + 'DebugStream';\r\nexport const webApiQuerySave = webApiQueryRoot + 'Save';\r\nexport const webApiQueryGet = webApiQueryRoot + 'Get';\r\nexport const webApiQueryDataSources = webApiQueryRoot + 'DataSources';\r\n\r\n@Injectable()\r\nexport class PipelinesService {\r\n  constructor(private http: HttpClient, private context: Context, private dnnContext: DnnContext) { }\r\n\r\n  getAll(contentType: string) {\r\n    return this.http.get<Query[]>(this.dnnContext.$2sxc.http.apiUrl(webApiEntityList), {\r\n      params: { appId: this.context.appId.toString(), contentType }\r\n    });\r\n  }\r\n\r\n  importQuery(file: File) {\r\n    return from(toBase64(file)).pipe(\r\n      mergeMap(fileBase64 => {\r\n        return this.http.post<boolean>(this.dnnContext.$2sxc.http.apiUrl(webApiQueryImport), {\r\n          AppId: this.context.appId.toString(),\r\n          ContentBase64: fileBase64,\r\n        });\r\n      })\r\n    );\r\n  }\r\n\r\n  clonePipeline(id: number) {\r\n    return this.http.get<null>(this.dnnContext.$2sxc.http.apiUrl(webApiQueryClone), {\r\n      params: { Id: id.toString(), appId: this.context.appId.toString() }\r\n    });\r\n  }\r\n\r\n  delete(id: number) {\r\n    return this.http.delete<boolean>(this.dnnContext.$2sxc.http.apiUrl(webApiQueryDelete), {\r\n      params: { appId: this.context.appId.toString(), Id: id.toString() },\r\n    });\r\n  }\r\n}\r\n","import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { ImportAppResult } from '../../import-app/models/import-app-result.model';\r\nimport { Context } from '../../shared/services/context';\r\nimport { Polymorphism } from '../models/polymorphism.model';\r\nimport { ViewUsage } from '../models/view-usage.model';\r\nimport { View } from '../models/view.model';\r\n\r\nconst webApiViewRoot = 'admin/view/';\r\nconst webApiViews = webApiViewRoot + 'all';\r\nconst webApiViewDelete = webApiViewRoot + 'delete';\r\nconst webApiViewImport = webApiViewRoot + 'import';\r\nconst webApiViewPolymorph = webApiViewRoot + 'polymorphism';\r\nconst webApiViewUsage = webApiViewRoot + 'usage';\r\n\r\n@Injectable()\r\nexport class ViewsService {\r\n  constructor(private http: HttpClient, private context: Context, private dnnContext: DnnContext) { }\r\n\r\n  getAll() {\r\n    return this.http.get<View[]>(this.dnnContext.$2sxc.http.apiUrl(webApiViews), {\r\n      params: { appId: this.context.appId.toString() }\r\n    });\r\n  }\r\n\r\n  delete(id: number) {\r\n    return this.http.get<boolean>(this.dnnContext.$2sxc.http.apiUrl(webApiViewDelete), {\r\n      params: { appId: this.context.appId.toString(), Id: id.toString() },\r\n    });\r\n  }\r\n\r\n  import(file: File) {\r\n    const formData = new FormData();\r\n    formData.append('File', file);\r\n    return this.http.post<ImportAppResult>(this.dnnContext.$2sxc.http.apiUrl(webApiViewImport), formData, {\r\n      params: { appId: this.context.appId.toString(), zoneId: this.context.zoneId.toString() }\r\n    });\r\n  }\r\n\r\n  export(id: number) {\r\n    const url = this.dnnContext.$2sxc.http.apiUrl(webApiViewRoot + 'json')\r\n      + '?appId=' + this.context.appId\r\n      + '&viewId=' + id;\r\n\r\n    window.open(url, '_blank', '');\r\n  }\r\n\r\n  getPolymorphism() {\r\n    return this.http.get<Polymorphism>(this.dnnContext.$2sxc.http.apiUrl(webApiViewPolymorph), {\r\n      params: { appId: this.context.appId.toString() }\r\n    });\r\n  }\r\n\r\n  getUsage(guid: string) {\r\n    return this.http.get<ViewUsage[]>(this.dnnContext.$2sxc.http.apiUrl(webApiViewUsage), {\r\n      params: { appId: this.context.appId.toString(), guid }\r\n    });\r\n  }\r\n}\r\n","import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { map } from 'rxjs/operators';\r\nimport { webApiAppFileCreate, webApiAppFilesAll, webApiExplorer } from '../../../../../edit/shared/services';\r\nimport { Context } from '../../shared/services/context';\r\nimport { WebApi, WebApiDetails } from '../models';\r\n\r\n@Injectable()\r\nexport class WebApisService {\r\n  constructor(private http: HttpClient, private context: Context, private dnnContext: DnnContext) { }\r\n\r\n  getAll() {\r\n    return this.http.get<string[]>(this.dnnContext.$2sxc.http.apiUrl(webApiAppFilesAll), {\r\n      params: { appId: this.context.appId.toString(), global: 'false', path: '', mask: '*Controller.cs', withSubfolders: 'true' },\r\n    }).pipe(\r\n      map(paths => {\r\n        const webApis: WebApi[] = paths.map(path => {\r\n          const splitIndex = path.lastIndexOf('/');\r\n          const fileExtIndex = path.lastIndexOf('.');\r\n          const folder = path.substring(0, splitIndex);\r\n          const name = path.substring(splitIndex + 1, fileExtIndex);\r\n          const webApi: WebApi = { path, folder, name };\r\n          return webApi;\r\n        });\r\n        return webApis;\r\n      }),\r\n    );\r\n  }\r\n\r\n  create(name: string) {\r\n    return this.http.post<boolean>(this.dnnContext.$2sxc.http.apiUrl(webApiAppFileCreate), {}, {\r\n      params: { appId: this.context.appId.toString(), purpose: 'api', global: 'false', path: `api/${name}` },\r\n    });\r\n  }\r\n\r\n  details(apiPath: string) {\r\n    return this.http.get<WebApiDetails>(this.dnnContext.$2sxc.http.apiUrl(webApiExplorer), {\r\n      params: { path: apiPath },\r\n    });\r\n  }\r\n}\r\n","import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { webApiEntityRoot } from '../../../../../edit/shared/services';\r\nimport { Context } from '../../shared/services/context';\r\n\r\n@Injectable()\r\nexport class EntitiesService {\r\n  constructor(private http: HttpClient, private context: Context, private dnnContext: DnnContext) { }\r\n\r\n  delete(type: string, id: number, tryForce: boolean) {\r\n    return this.http.delete<null>(this.dnnContext.$2sxc.http.apiUrl(webApiEntityRoot + 'delete'), {\r\n      params: { contentType: type, id: id.toString(), appId: this.context.appId.toString(), force: tryForce.toString() },\r\n    });\r\n  }\r\n}\r\n","import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { Component, OnDestroy } from '@angular/core';\r\nimport { MatDialogRef } from '@angular/material/dialog';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { BehaviorSubject, combineLatest, Observable, Subscription } from 'rxjs';\r\nimport { map, share, switchMap } from 'rxjs/operators';\r\nimport { AllScenarios, DevRestBaseTemplateVars, fireOnStartAndWhenSubDialogCloses, Scenario } from '.';\r\nimport { DialogSettings } from '../app-administration/models';\r\nimport { AppDialogConfigService } from '../app-administration/services';\r\nimport { Permission, PermissionsService } from '../permissions';\r\nimport { eavConstants } from '../shared/constants/eav.constants';\r\nimport { Context } from '../shared/services/context';\r\n\r\n@Component({\r\n  selector: 'app-dev-rest-base',\r\n  template: ''\r\n})\r\n// tslint:disable-next-line:component-class-suffix\r\nexport class DevRestBase<TemplateVarType> implements OnDestroy {\r\n\r\n  /** Template variables for the HTML template */\r\n  public templateVars$: Observable<TemplateVarType>;\r\n\r\n  /** Subscription Sink */\r\n  subscription = new Subscription();\r\n\r\n  /** List of scenarios */\r\n  scenarios = AllScenarios;\r\n\r\n  /** Currently selected scenario */\r\n  scenario$ = new BehaviorSubject<Scenario>(AllScenarios[0]);\r\n\r\n  permissions$: Observable<Permission[]>;\r\n  dialogSettings$: Observable<DialogSettings>;\r\n\r\n  // Shared Constructor for things all the Dev-REST things will need\r\n  constructor(\r\n    appDialogConfigService: AppDialogConfigService,\r\n    /** Context for this dialog. Used for appId, zoneId, tabId, etc. */\r\n    private context: Context,\r\n    private dialogRef: MatDialogRef<any>,\r\n    /** dnn-sxc-angular context. Used to resolve urls */\r\n    private dnnContext: DnnContext,\r\n    protected router: Router,\r\n    protected route: ActivatedRoute,\r\n    private permissionsService: PermissionsService,\r\n  ) {\r\n\r\n    // Build Dialog Settings Stream\r\n    // Note: this is probably already loaded somewhere, so I'm not sure why we're getting it again\r\n    this.dialogSettings$ = appDialogConfigService.getDialogSettings().pipe(share());\r\n\r\n  }\r\n\r\n  buildPermissionStream(routeTargetName: string) {\r\n    // Build Permissions Stream\r\n    // This is triggered on start and everything a sub-dialog closes\r\n    return combineLatest([\r\n      fireOnStartAndWhenSubDialogCloses(this.router, this.route),\r\n      this.route.paramMap.pipe(map(pm => pm.get(routeTargetName))),\r\n    ]).pipe(\r\n      switchMap(([_, permissionTarget]) => {\r\n        // TODO: 2dm - something looks wrong here, we're getting Entity-metadata for content-type!\r\n        return this.permissionsService.getAll(eavConstants.metadata.entity.type, eavConstants.keyTypes.guid, permissionTarget);\r\n      }),\r\n      share()\r\n    );\r\n  }\r\n\r\n  rootBasedOnScenario(root: string, scenario: Scenario): string {\r\n    const domainPrefix = document.location.protocol + '//' + document.location.host;\r\n    return scenario.useVirtual\r\n      ? root\r\n      : (scenario.inSameSite ? '' : domainPrefix) + this.dnnContext.$2sxc.http.apiUrl(root);\r\n  }\r\n\r\n  buildBaseTemplateVars(name: string, identity: string, diag: DialogSettings, permissions: Permission[], root: string,\r\n    scenario: Scenario): DevRestBaseTemplateVars {\r\n    return {\r\n      apiCalls: null,\r\n      name,\r\n      currentScenario: scenario,\r\n      folder: encodeURI(diag.Context.App.Folder),\r\n      moduleId: this.context.moduleId,\r\n      root,\r\n      scenario,\r\n      permissions,\r\n      permissionsHasAnonymous: permissions?.filter(p => p.Condition.indexOf('.Anonymous') > 0).length > 0,\r\n      permissionTarget: identity,\r\n    };\r\n  }\r\n\r\n  changeScenario(scenario: Scenario) {\r\n    this.scenario$.next(scenario);\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.scenario$.complete();\r\n    this.subscription.unsubscribe();\r\n  }\r\n\r\n  closeDialog() {\r\n    this.dialogRef.close();\r\n  }\r\n\r\n}\r\n","import { Route } from '@angular/router';\r\nimport { ContentType, WebApi } from '../app-administration/models';\r\n\r\nconst base = 'restapi';\r\n\r\nexport const GoToDevRest = {\r\n  routeData: 'data',\r\n  paramTypeName: 'contentTypeStaticName',\r\n  paramQuery: 'queryGuid',\r\n  paramApiPath: 'webApiPath',\r\n\r\n  goToData(contentType: ContentType) {\r\n    return `${base}/data/${contentType.StaticName}`;\r\n  },\r\n\r\n  goToQuery(queryGuid: string) {\r\n    return `${base}/query/${queryGuid}`;\r\n  },\r\n\r\n  goToWebApi(api: WebApi) {\r\n    return `${base}/custom/${encodeURIComponent(api.path)}`;\r\n  },\r\n\r\n  /**\r\n   * The route definition for use in all routing components which can route to this dialog\r\n   */\r\n  route: {\r\n    path: base,\r\n    loadChildren: () => import('./dev-rest.module').then(m => m.DevRestModule)\r\n  } as Route,\r\n};\r\n","import { Scenario } from './scenario';\r\n\r\nexport const AllScenarios: Array<Scenario> = [\r\n  {\r\n    key: 'internal',\r\n    in2sxc: true,\r\n    useVirtual: true,\r\n    inSameSite: true,\r\n    inSameContext: true,\r\n    name: 'JS in this App on a page (easiest)',\r\n    description: `Internal access means that your JS code is running in a 2sxc-module on a DNN-page.\r\n    This is the default access.\r\n    In this scenario, various headers are included in the request,\r\n    incl. the module it\\'s coming from, which allows various automatic things to happen.\r\n    This results in simpler REST requests.`,\r\n    notes: `This mode makes it easy to re-distribute your app, as you can perform API calls relative to the module that\\'s hosting it.\r\n    This means, that even if you export/import the app to another system, the API-calls stay the same.`,\r\n  },\r\n  {\r\n    key: 'internal2',\r\n    in2sxc: true,\r\n    useVirtual: true,\r\n    inSameSite: true,\r\n    inSameContext: false,\r\n    name: 'JS in a DIFFERENT 2sxc App on the SAME site',\r\n    description: `When using JS from another app, you cannot auto-detect of the app, so the path is slightly different.`,\r\n    notes: '',\r\n  },\r\n  // {\r\n  //   key: 'external1',\r\n  //   in2sxc: false,\r\n  //   useVirtual: false,\r\n  //   inSameSite: false,\r\n  //   inSameContext: false,\r\n  //   name: 'JS from a DIFFERENT site',\r\n  // tslint:disable-next-line:max-line-length\r\n  //   description: `When coding from another site, the path needs to be complete (not virtual), since auto-detection of site etc. can't work.\r\n  //   In addition, most DNN-headers cause trouble because they tell the server a context which isn't actually true. `,\r\n  //   notes: '',\r\n  // },\r\n  {\r\n    key: 'external',\r\n    in2sxc: false,\r\n    useVirtual: false,\r\n    inSameSite: false,\r\n    inSameContext: false,\r\n    needsAnonymous: true,\r\n    name: 'External (other website, mobile device, etc.)',\r\n    description: `External access means that the JS code could be on another page / module in DNN (which is not the same app),\r\n    or it could be coming from a mobile App, or another website altogether.\r\n    In this case, automatic app-detection can\\'t work, as various headers are missing, and you must access the endpoint more explicitly.`,\r\n    notes: `This mode requires you to define the exact, full URL, so if you create copies of this app on another system,\r\n    the URL must be updated to access that system specifically.\r\n    Note that our samples are in JS, you'll have to figure it out yourself for other programming languages.`,\r\n  },\r\n];\r\n","import { CodeSample } from './code-sample';\r\n\r\nexport class ApiCall {\r\n  constructor(\r\n    public virtual: boolean,\r\n    public verb: 'GET' | 'POST' | 'DELETE',\r\n    public url: string,\r\n    public teaser: string,\r\n    public instructions: string,\r\n    public enableButton: boolean,\r\n    public code: CodeSample[] = [],\r\n    public browseUrl: string = null,\r\n  ) { }\r\n}\r\n","import { Hint } from '../info-box/hint';\r\n\r\nexport class CodeSample {\r\n  constructor(\r\n    public title: string,\r\n    public description: string,\r\n    public code: string,\r\n    public runInConsole: boolean,\r\n    public hints: Hint[] = [],\r\n    // public warning = '',\r\n  ) {\r\n    // the code often has a leading new-line - so we'll trim this\r\n    this.code = this.code.trim();\r\n  }\r\n}\r\n","import { SxcRoot } from '@2sic.com/2sxc-typings';\r\nimport { ApiCall, CodeSample, hint$2sxc, Scenario, warningExternal, warningSimpleSampleOnly } from '..';\r\nimport { Context } from '../../shared/services/context';\r\n// tslint:disable: curly\r\n\r\nexport function generateApiCalls($2sxc: SxcRoot, scenario: Scenario, context: Context, root: string, id: number) {\r\n  const virtual = root[0] !== '/' && !root.startsWith('http');\r\n  root = root + '/';\r\n  const withId = root + id;\r\n  const contextParams = virtual ? `?PageId=${context.tabId}&ModuleId=${context.moduleId}` : '';\r\n  const directUrl = $2sxc.http.apiUrl(root) + contextParams;\r\n  const directWId = $2sxc.http.apiUrl(withId) + contextParams;\r\n\r\n  return [\r\n    new ApiCall(virtual, 'GET', root, 'read all', 'Read list of all items', true, snippetsGet(scenario, root, context),\r\n      directUrl),\r\n    new ApiCall(virtual, 'GET', withId, 'read one', 'Read a single item #' + id, true, snippetsGet(scenario, withId, context),\r\n      directWId),\r\n    new ApiCall(virtual, 'POST', root, 'create', 'Create an item', false, snippetsCreate(scenario, root, context.moduleId)),\r\n    new ApiCall(virtual, 'POST', withId, 'update', 'Update the item #' + id, false, snippetsUpdate(scenario, withId, context.moduleId)),\r\n    new ApiCall(virtual, 'DELETE', withId, 'delete', 'Delete item #' + id, false, snippetsDelete(scenario, withId, context.moduleId)),\r\n  ];\r\n}\r\n\r\nfunction snippetsGet(scenario: Scenario, path: string, context: Context): CodeSample[] {\r\n  const moduleId = context.moduleId;\r\n  const virtual = path[0] !== '/';\r\n  const list: CodeSample[] = [];\r\n  const pathWithContext = `${path}?PageId=${context.tabId}&ModuleId=${context.moduleId}`;\r\n\r\n  if (scenario.inSameContext)\r\n    list.push(new CodeSample('Example with global $2sxc and event-context',\r\n      'This example finds the context information from the HTML where an action started.',\r\n      `\r\n<button onclick=\"$2sxc(this).webApi.get('${path}').then(data => console.log(data))\">\r\n  get it\r\n</button>`, false, [hint$2sxc]));\r\n\r\n  if (scenario.in2sxc)\r\n    list.push(new CodeSample(`Example with global $2sxc and a Module-Id ${moduleId}`,\r\n      `This is how you get the context when your code doesn't start with a DOM context, so you need the moduleId.`,\r\n      `\r\n// get the sxc-controller for this module\r\nvar sxc = $2sxc(${moduleId});\r\n// now get the data in the promise\r\nsxc.webApi.get('${path}')\r\n  .then(data => {\r\n    console.log(data)\r\n  });`,\r\n      false, [hint$2sxc]),\r\n      new CodeSample(`Same example as one-liner`,\r\n        'This is the same as above, but as a one-liner so you can run it directly in the F12 console right now.',\r\n        `$2sxc(${moduleId}).webApi.get('${path}').then(data => console.log('just got:', data));`, true));\r\n\r\n  if (scenario.in2sxc && scenario.inSameContext)\r\n    list.push(new CodeSample('Example where you get the Module-Id from Razor',\r\n      `This example doesn't use a fixed moduleId but let's the Razor add the current moduleId when the page is rendered.`,\r\n      `\r\n// this will be replaced on the server with the ID\r\nvar moduleId = @Dnn.Module.ModuleID;\r\nvar sxc = $2sxc(moduleId);\r\nvar promise = sxc.webApi.get('${path}');`, false, [hint$2sxc]));\r\n\r\n  // jquery examples, they differ based on the scenario\r\n  const endPointGetter = virtual ? `$2sxc.http.apiUrl('${path}')` : `'${path}'`;\r\n  const endPointGetWithParams = virtual ? `$2sxc.http.apiUrl('${pathWithContext}')` : `'${pathWithContext}'`;\r\n  if (scenario.inSameSite) {\r\n    // jQuery using setModuleHeaders\r\n    list.push(new CodeSample('Using jQuery inside DNN',\r\n      `This example uses jQuery instead of the $2sxc to do the AJAX call.\r\n      It shows you how to resolve the virtual path for use in other ways.`,\r\n      `\r\nvar endpoint = ${endPointGetter};\r\n$.ajax({\r\n  url:endpoint,\r\n  beforeSend: $.dnnSF(${moduleId}).setModuleHeaders\r\n}).then(data => {\r\n  console.log('Got this data:', data);\r\n})`, false, []));\r\n\r\n    // jQuery Single-Liner\r\n    list.push(new CodeSample('Using jQuery as single-liner',\r\n      `The same example as above, just as single-liner so you can test it directly in the F12 console.\r\n      This will only work if you're on a DNN page with this module.`,\r\n      `$.ajax({url: ${endPointGetter}, beforeSend: $.dnnSF(${moduleId}).setModuleHeaders }).then(data => console.log(data))`,\r\n      false, []));\r\n\r\n    // jQuery without setModuleHeaders\r\n    list.push(new CodeSample('Using jQuery and add Context in URL',\r\n      `This example uses jQuery instead of the $2sxc to do the AJAX call.\r\n      But instead of using the DNN Services Framework it adds relevant headers to the url.`,\r\n      `\r\n$.ajax(${endPointGetWithParams}).then(data => {\r\n  console.log('Got this data:', data);\r\n})`, false, []));\r\n\r\n    // jQuery Single-Liner without SetModuleHeaders\r\n    list.push(new CodeSample('Using jQuery with url-context as single-liner',\r\n      `The same example as above, just as single-liner so you can test it directly in the F12 console.\r\n      This will work on a DNN page which has jQuery activated. `,\r\n      `$.ajax(${endPointGetWithParams}).then(data => console.log(data))`,\r\n      false, []));\r\n\r\n  } else {\r\n    // jQuery External\r\n    list.push(new CodeSample('Using jQuery in another Site or External',\r\n      `This example uses jQuery and doesn't use $2sxc or the DNN ServicesFramework,\r\n      because they would be either missing, or give wrong context-headers.`,\r\n      `\r\n$.ajax('${path}').then(data => {\r\n  console.log('Got this data:', data);\r\n})`, false, [warningExternal]));\r\n\r\n    // jQuery External with Context\r\n    list.push(new CodeSample('Using jQuery with Context in URL',\r\n      `This example uses jQuery and includes a module-context. This is unusual for external access, but may be needed sometime.`,\r\n      `\r\n$.ajax('${pathWithContext}').then(data => {\r\n  console.log('Got this data:', data);\r\n})`, false, [warningExternal]));\r\n  }\r\n  // return generated snippets\r\n  return list;\r\n}\r\n\r\n/** Snippets for basic Post-Create */\r\nfunction snippetsCreate(scenario: Scenario, path: string, moduleId: number): CodeSample[] {\r\n  const showWarning = !scenario.inSameContext;\r\n  return [\r\n    new CodeSample('Basic Example',\r\n      `This example uses the ModuleId to get the context information.\r\nTo see other ways to get the context and headers, check out the GET examples.\r\nNote that this snippet doesn't use real names of properties to add.`,\r\n      `// get the sxc-controller for this module\r\nvar sxc = $2sxc(${moduleId});\r\n\r\n// The object we'll send to get created. It's just a simple object with properties\r\nvar newThing = {\r\n  property1: 17,\r\n  property2: 'Some Text',\r\n  // related items like tags can be assigned with IDs\r\n  // which you would usually get from somewhere first\r\n  propertyPointingToOtherIds: [74,50203],\r\n};\r\n\r\n// now create it and get the id back\r\nsxc.webApi.post('${path}', newThing)\r\n  .then(data => {\r\n    console.log('Got this ID information: ', data)\r\n  });`,\r\n      false,\r\n      showWarning ? [warningSimpleSampleOnly] : []),\r\n  ];\r\n}\r\n\r\n/** Snippets for basic Post-Update */\r\nfunction snippetsUpdate(scenario: Scenario, path: string, moduleId: number): CodeSample[] {\r\n  const showWarning = !scenario.inSameContext;\r\n  return [\r\n    new CodeSample('Basic Example',\r\n      `This example uses the ModuleId to get the context information.\r\nTo see other ways to get the context and headers, check out the GET examples.\r\nNote that this snippet doesn't use real names of properties to add.`,\r\n      `// get the sxc-controller for this module\r\nvar sxc = $2sxc(${moduleId});\r\n\r\n// The object we'll send to update the data. It's just a simple object with properties\r\nvar updateProperty1And2 = {\r\n  property1: 2742,\r\n  property2: 'Changed Text',\r\n};\r\n\r\n// now update the item\r\nsxc.webApi.post('${path}', updateProperty1And2)\r\n  .then(data => {\r\n    console.log('Update completed', data)\r\n  });`,\r\n      false,\r\n      showWarning ? [warningSimpleSampleOnly] : []),\r\n  ];\r\n}\r\n\r\n/** Snippets for basic Post-Update */\r\nfunction snippetsDelete(scenario: Scenario, path: string, moduleId: number): CodeSample[] {\r\n  const showWarning = !scenario.inSameContext;\r\n  return [\r\n    new CodeSample('Basic Example',\r\n      `This example uses the ModuleId to get the context information.\r\nTo see other ways to get the context and headers, check out the GET examples.\r\nNote that this snippet doesn't use real names of properties to add.`,\r\n      `// get the sxc-controller for this module\r\nvar sxc = $2sxc(${moduleId});\r\n\r\n// delete the item\r\nsxc.webApi.delete('${path}')\r\n  .then(data => {\r\n    console.log('Delete completed', data)\r\n  });`,\r\n      false,\r\n      showWarning ? [warningSimpleSampleOnly] : []),\r\n  ];\r\n}\r\n","\r\nexport * from '../info-box/hint';\r\nexport * from './api-call';\r\nexport * from './code-sample';\r\nexport * from './generate-samples';\r\n\r\nimport { Hint } from '../info-box/hint';\r\nexport const hint$2sxc = new Hint('tip', `The <code>$2sxc</code> is a helper JS from 2sxc. It's always included for super-users (hosts).\r\nBut if you need normal visitors to use the API, you must request it in your Razor using @Edit.Enable(...).\r\n<a href=\"https://r.2sxc.org/js-2sxc-root\" target=\"_blank\">see docs</a>`);\r\n\r\nexport const warningSimpleSampleOnly = new Hint('warning', `WARNING: We only prepared the basic example running in the same app. You can of course also run this elsewhere,\r\nbut you'll have to compare it with the GET examples to be sure you have the right headers etc. `, '');\r\n\r\nexport const warningExternal = new Hint('alert', 'IMPORTANT: This will only work if you set anonymous permissions on the content-type.');\r\n","<div mat-dialog-title>\r\n  <div class=\"dialog-title-box\">\r\n    <div>{{ dialogData.name }}</div>\r\n    <button mat-icon-button tippy=\"Close dialog\" (click)=\"closeDialog()\">\r\n      <mat-icon>close</mat-icon>\r\n    </button>\r\n  </div>\r\n</div>\r\n\r\n<div class=\"dialog-component-content fancy-scrollbar-light\">\r\n  <p class=\"dialog-description\">\r\n    {{ dialogData.body }}\r\n  </p>\r\n\r\n  <p class=\"dialog-description\" *ngIf=\"dialogData.notes\">\r\n    <em>{{ dialogData.notes }}</em>\r\n  </p>\r\n</div>\r\n","import { Component, Inject, OnInit } from '@angular/core';\r\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\r\nimport { HelpPopupData } from './help-popup.models';\r\n\r\n@Component({\r\n  selector: 'app-help-popup',\r\n  templateUrl: './help-popup.component.html',\r\n})\r\nexport class HelpPopupComponent implements OnInit {\r\n\r\n  constructor(private dialogRef: MatDialogRef<HelpPopupComponent>, @Inject(MAT_DIALOG_DATA) public dialogData: HelpPopupData) { }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  closeDialog() {\r\n    this.dialogRef.close();\r\n  }\r\n}\r\n","import { ActivatedRoute, NavigationEnd, Route, Router } from '@angular/router';\r\nimport { filter, map, pairwise, startWith } from 'rxjs/operators';\r\n\r\n// This observable fires when a sub-dialog was openend and closed again\r\nexport function fireOnStartAndWhenSubDialogCloses(\r\n  router: Router,\r\n  route: ActivatedRoute\r\n) {\r\n  return router.events.pipe(\r\n    filter((event) => event instanceof NavigationEnd),\r\n    startWith(!!route.snapshot.firstChild),\r\n    map(() => !!route.snapshot.firstChild),\r\n    pairwise(),\r\n    filter(([prevHadChild, newHasChild]) => prevHadChild && !newHasChild),\r\n    startWith([]) // this ensures it fires once in the beginning\r\n  );\r\n}\r\n","export type InfoBoxType = 'alert' | 'info' | 'tip' | 'warning';\r\n\r\nexport const infoBoxIconMap: { [name in InfoBoxType]: string } = {\r\n  alert: 'warning',\r\n  info: 'menu_book',\r\n  tip: 'star',\r\n  warning: 'warning',\r\n};\r\n\r\nexport class Hint {\r\n  public icon: string;\r\n\r\n  constructor(public type: InfoBoxType, public message: string, public link = '') {\r\n    this.icon = infoBoxIconMap[type];\r\n  }\r\n}\r\n","<div class=\"selector\">\r\n  <mat-form-field color=\"accent\" class=\"selector__dropdown\">\r\n    <mat-label>{{ label }}</mat-label>\r\n    <mat-select [value]=\"value\" (selectionChange)=\"selectionChange($event.value)\">\r\n      <mat-option *ngFor=\"let item of items\" [value]=\"item.key\">{{ item.name }}</mat-option>\r\n    </mat-select>\r\n  </mat-form-field>\r\n\r\n  <button mat-icon-button (click)=\"showHelp()\" tippy=\"Show help\">\r\n    <mat-icon>help_outline</mat-icon>\r\n  </button>\r\n</div>\r\n","import { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { HelpPopupComponent } from '..';\r\nimport { HelpPopupData } from '../help-popup/help-popup.models';\r\nimport { Scenario } from '../scenarios';\r\n\r\n@Component({\r\n  selector: 'app-selector-with-help',\r\n  templateUrl: './selector-with-help.component.html',\r\n  styleUrls: ['../header-selector.scss'],\r\n})\r\nexport class SelectorWithHelpComponent implements OnInit {\r\n  @Input() label: string;\r\n  @Input() items: Scenario[];\r\n  @Input() value: string;\r\n  @Output() private valueChange = new EventEmitter<Scenario>();\r\n\r\n  constructor(private dialog: MatDialog) { }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  selectionChange(key: string) {\r\n    this.value = key;\r\n    const scenario = this.items.find(item => item.key === this.value);\r\n    this.valueChange.emit(scenario);\r\n  }\r\n\r\n  showHelp() {\r\n    const scenario = this.items.find(item => item.key === this.value);\r\n    const data: HelpPopupData = {\r\n      name: scenario.name,\r\n      body: scenario.description,\r\n      notes: scenario.notes,\r\n    };\r\n\r\n    this.dialog.open(HelpPopupComponent, {\r\n      autoFocus: false,\r\n      data,\r\n      width: '500px',\r\n    });\r\n  }\r\n}\r\n","import { Route } from '@angular/router';\r\nimport { eavConstants } from '../shared/constants/eav.constants';\r\n\r\n/**\r\n * Navigation system to access permissions dialogs as sub-dialogs for many use cases\r\n */\r\nexport const GoToPermissions = {\r\n\r\n  go(targetType: number, keyType: string, key: string) {\r\n    return `permissions/${targetType}/${keyType}/${key}`;\r\n  },\r\n\r\n  /** Go to edit permissions for entity */\r\n  goEntity(key: string) {\r\n    return this.go(eavConstants.metadata.entity.type, eavConstants.keyTypes.guid, key);\r\n  },\r\n\r\n  /** Go to edit permissions for content-type. For historic reasons, it's the same as Entity */\r\n  goContentType(key: string) {\r\n    return this.goEntity(key);\r\n  },\r\n\r\n  goAttribute(id: number) {\r\n    return this.go(eavConstants.metadata.attribute.type, eavConstants.keyTypes.number, id);\r\n  },\r\n\r\n  goApp(appId: number) {\r\n    return this.go(eavConstants.metadata.app.type, eavConstants.keyTypes.number, appId);\r\n  },\r\n\r\n  /**\r\n   * The route definition for use in all routing components which can route to this dialog\r\n   */\r\n  route: {\r\n    path: 'permissions/:type/:keyType/:key',\r\n    loadChildren: () => import('./permissions.module').then(m => m.PermissionsModule),\r\n    data: { title: 'Permission' },\r\n  } as Route,\r\n};\r\n","import { DialogConfig } from '../shared/models/dialog-config.model';\r\n\r\nexport const permissionsDialog: DialogConfig = {\r\n  name: 'SET_PERMISSIONS_DIALOG',\r\n  initContext: true,\r\n  panelSize: 'large',\r\n  panelClass: null,\r\n\r\n  async getComponent() {\r\n    const { PermissionsComponent } = await import('./permissions.component');\r\n    return PermissionsComponent;\r\n  }\r\n};\r\n","import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { edit, refreshEdit } from '../../../../edit/edit.matcher';\r\nimport { DialogEntryComponent } from '../shared/components/dialog-entry/dialog-entry.component';\r\nimport { permissionsDialog } from './permissions-dialog.config';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '', component: DialogEntryComponent, data: { dialog: permissionsDialog }, children: [\r\n      {\r\n        matcher: edit,\r\n        loadChildren: () => import('../../../../edit/edit.module').then(m => m.EditModule)\r\n      },\r\n      {\r\n        matcher: refreshEdit,\r\n        loadChildren: () => import('../../../../edit/refresh-edit.module').then(m => m.RefreshEditModule)\r\n      },\r\n    ]\r\n  },\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class PermissionsRoutingModule { }\r\n","import { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { Component } from '@angular/core';\r\nimport { Permission } from '../../models/permission.model';\r\nimport { PermissionsActionsParams } from './permissions-actions.models';\r\n\r\n@Component({\r\n  selector: 'app-permissions-actions',\r\n  templateUrl: './permissions-actions.component.html',\r\n  styleUrls: ['./permissions-actions.component.scss'],\r\n})\r\nexport class PermissionsActionsComponent implements ICellRendererAngularComp {\r\n  private params: PermissionsActionsParams;\r\n\r\n  agInit(params: PermissionsActionsParams) {\r\n    this.params = params;\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n\r\n  deletePermission() {\r\n    const permission: Permission = this.params.data;\r\n    this.params.onDelete(permission);\r\n  }\r\n}\r\n","<div class=\"actions-component\">\r\n  <div class=\"like-button highlight\" matRipple tippy=\"Delete\" (click)=\"deletePermission()\">\r\n    <mat-icon>delete</mat-icon>\r\n  </div>\r\n</div>\r\n","import { AllCommunityModules, CellClickedEvent, GridOptions } from '@ag-grid-community/all-modules';\r\nimport { Component, OnDestroy, OnInit } from '@angular/core';\r\nimport { MatDialogRef } from '@angular/material/dialog';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { ActivatedRoute, NavigationEnd, Router } from '@angular/router';\r\nimport { BehaviorSubject, Subscription } from 'rxjs';\r\nimport { filter, map, pairwise, startWith } from 'rxjs/operators';\r\nimport { IdFieldComponent } from '../shared/components/id-field/id-field.component';\r\nimport { IdFieldParams } from '../shared/components/id-field/id-field.models';\r\nimport { defaultGridOptions } from '../shared/constants/default-grid-options.constants';\r\nimport { eavConstants } from '../shared/constants/eav.constants';\r\nimport { convertFormToUrl } from '../shared/helpers/url-prep.helper';\r\nimport { EditForm } from '../shared/models/edit-form.model';\r\nimport { PermissionsActionsComponent } from './ag-grid-components/permissions-actions/permissions-actions.component';\r\nimport { PermissionsActionsParams } from './ag-grid-components/permissions-actions/permissions-actions.models';\r\nimport { Permission } from './models/permission.model';\r\nimport { PermissionsService } from './services/permissions.service';\r\n\r\n@Component({\r\n  selector: 'app-permissions',\r\n  templateUrl: './permissions.component.html',\r\n  styleUrls: ['./permissions.component.scss'],\r\n})\r\nexport class PermissionsComponent implements OnInit, OnDestroy {\r\n  permissions$ = new BehaviorSubject<Permission[]>(null);\r\n\r\n  modules = AllCommunityModules;\r\n  gridOptions: GridOptions = {\r\n    ...defaultGridOptions,\r\n    frameworkComponents: {\r\n      idFieldComponent: IdFieldComponent,\r\n      permissionsActionsComponent: PermissionsActionsComponent,\r\n    },\r\n    columnDefs: [\r\n      {\r\n        headerName: 'ID', field: 'Id', width: 70, headerClass: 'dense', cellClass: 'id-action no-padding no-outline',\r\n        cellRenderer: 'idFieldComponent', sortable: true, filter: 'agTextColumnFilter',\r\n        cellRendererParams: {\r\n          tooltipGetter: (paramsData: Permission) => `ID: ${paramsData.Id}\\nGUID: ${paramsData.Guid}`,\r\n        } as IdFieldParams,\r\n      },\r\n      {\r\n        headerName: 'Name', field: 'Title', flex: 2, minWidth: 250, cellClass: 'primary-action highlight',\r\n        sortable: true, sort: 'asc', filter: 'agTextColumnFilter', onCellClicked: this.editPermission.bind(this),\r\n      },\r\n      {\r\n        headerName: 'Identity', field: 'Identity', flex: 2, minWidth: 250, cellClass: 'no-outline', sortable: true,\r\n        filter: 'agTextColumnFilter',\r\n      },\r\n      {\r\n        headerName: 'Condition', field: 'Condition', flex: 2, minWidth: 250, cellClass: 'no-outline', sortable: true,\r\n        filter: 'agTextColumnFilter',\r\n      },\r\n      {\r\n        headerName: 'Grant', field: 'Grant', width: 70, headerClass: 'dense', cellClass: 'no-outline',\r\n        sortable: true, filter: 'agTextColumnFilter',\r\n      },\r\n      {\r\n        width: 40, cellClass: 'secondary-action no-padding', cellRenderer: 'permissionsActionsComponent', pinned: 'right',\r\n        cellRendererParams: {\r\n          onDelete: this.deletePermission.bind(this),\r\n        } as PermissionsActionsParams,\r\n      },\r\n    ],\r\n  };\r\n\r\n  private subscription = new Subscription();\r\n  private targetType = parseInt(this.route.snapshot.paramMap.get('type'), 10);\r\n  private keyType = this.route.snapshot.paramMap.get('keyType');\r\n  private key = this.route.snapshot.paramMap.get('key');\r\n\r\n  constructor(\r\n    private dialogRef: MatDialogRef<PermissionsComponent>,\r\n    private router: Router,\r\n    private route: ActivatedRoute,\r\n    private permissionsService: PermissionsService,\r\n    private snackBar: MatSnackBar,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.fetchPermissions();\r\n    this.refreshOnChildClosed();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.permissions$.complete();\r\n    this.subscription.unsubscribe();\r\n  }\r\n\r\n  closeDialog() {\r\n    this.dialogRef.close();\r\n  }\r\n\r\n  private fetchPermissions() {\r\n    this.permissionsService.getAll(this.targetType, this.keyType, this.key).subscribe(permissions => {\r\n      this.permissions$.next(permissions);\r\n    });\r\n  }\r\n\r\n  editPermission(params: CellClickedEvent) {\r\n    let form: EditForm;\r\n    if (params == null) {\r\n      const target = Object.values(eavConstants.metadata).find(metaValue => metaValue.type === this.targetType)?.target;\r\n      form = {\r\n        items: [{\r\n          ContentTypeName: eavConstants.contentTypes.permissions,\r\n          For: {\r\n            Target: target,\r\n            ...(this.keyType === eavConstants.keyTypes.guid && { Guid: this.key }),\r\n            ...(this.keyType === eavConstants.keyTypes.number && { Number: parseInt(this.key, 10) }),\r\n            ...(this.keyType === eavConstants.keyTypes.string && { String: this.key }),\r\n          }\r\n        }],\r\n      };\r\n    } else {\r\n      const permission: Permission = params.data;\r\n      form = {\r\n        items: [{ EntityId: permission.Id }],\r\n      };\r\n    }\r\n    const formUrl = convertFormToUrl(form);\r\n    this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route });\r\n  }\r\n\r\n  private deletePermission(permission: Permission) {\r\n    if (!confirm(`Delete '${permission.Title}' (${permission.Id})?`)) { return; }\r\n    this.snackBar.open('Deleting...');\r\n    this.permissionsService.delete(permission.Id).subscribe(() => {\r\n      this.snackBar.open('Deleted', null, { duration: 2000 });\r\n      this.fetchPermissions();\r\n    });\r\n  }\r\n\r\n  private refreshOnChildClosed() {\r\n    this.subscription.add(\r\n      this.router.events.pipe(\r\n        filter(event => event instanceof NavigationEnd),\r\n        startWith(!!this.route.snapshot.firstChild),\r\n        map(() => !!this.route.snapshot.firstChild),\r\n        pairwise(),\r\n        filter(([hadChild, hasChild]) => hadChild && !hasChild),\r\n      ).subscribe(() => {\r\n        this.fetchPermissions();\r\n      })\r\n    );\r\n  }\r\n\r\n}\r\n","<div class=\"nav-component-wrapper\">\r\n  <div mat-dialog-title>\r\n    <div class=\"dialog-title-box\">\r\n      <div>Permissions</div>\r\n      <button mat-icon-button tippy=\"Close dialog\" (click)=\"closeDialog()\">\r\n        <mat-icon>close</mat-icon>\r\n      </button>\r\n    </div>\r\n  </div>\r\n\r\n  <router-outlet></router-outlet>\r\n\r\n  <div class=\"grid-wrapper\">\r\n    <ag-grid-angular class=\"ag-theme-material\" [rowData]=\"permissions$ | async\" [modules]=\"modules\"\r\n      [gridOptions]=\"gridOptions\">\r\n    </ag-grid-angular>\r\n\r\n    <div class=\"grid-more-actions-box\"></div>\r\n\r\n    <button mat-fab mat-elevation-z24 class=\"grid-fab\" tippy=\"Create a new permission\" (click)=\"editPermission(null)\">\r\n      <mat-icon>add</mat-icon>\r\n    </button>\r\n  </div>\r\n</div>\r\n","import { AgGridModule } from '@ag-grid-community/angular';\r\nimport { CommonModule } from '@angular/common';\r\nimport { NgModule } from '@angular/core';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatRippleModule } from '@angular/material/core';\r\nimport { MatDialogModule } from '@angular/material/dialog';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatSnackBarModule } from '@angular/material/snack-bar';\r\nimport { EntitiesService } from '../content-items/services/entities.service';\r\nimport { Context } from '../shared/services/context';\r\nimport { SharedComponentsModule } from '../shared/shared-components.module';\r\nimport { PermissionsActionsComponent } from './ag-grid-components/permissions-actions/permissions-actions.component';\r\nimport { PermissionsRoutingModule } from './permissions-routing.module';\r\nimport { PermissionsComponent } from './permissions.component';\r\nimport { MetadataService } from './services/metadata.service';\r\nimport { PermissionsService } from './services/permissions.service';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    PermissionsComponent,\r\n    PermissionsActionsComponent,\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    PermissionsRoutingModule,\r\n    SharedComponentsModule,\r\n    MatDialogModule,\r\n    MatButtonModule,\r\n    MatIconModule,\r\n    AgGridModule.withComponents([]),\r\n    MatRippleModule,\r\n    MatSnackBarModule,\r\n  ],\r\n  providers: [\r\n    Context,\r\n    PermissionsService,\r\n    MetadataService,\r\n    EntitiesService,\r\n  ]\r\n})\r\nexport class PermissionsModule { }\r\n","import { Context as DnnContext } from '@2sic.com/dnn-sxc-angular';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { Context } from '../../shared/services/context';\r\n\r\nconst webApiRoot = 'admin/metadata/get';\r\n\r\n@Injectable()\r\nexport class MetadataService {\r\n  constructor(private http: HttpClient, private context: Context, private dnnContext: DnnContext) { }\r\n\r\n  /**\r\n   * Fetches metadata for given key in metadata content type\r\n   * @param typeId metadataOf something. For more info checkout out eavConstants file\r\n   * @param keyType e.g. for keyType === guid, key === contentTypeStaticName\r\n   * @param key key of content type for which we search for permissions. Key is connected with keyType\r\n   * @param contentTypeName name of content type where permissions are stored\r\n   */\r\n  getMetadata<T>(typeId: number, keyType: string, key: string, contentTypeName: string) {\r\n    return this.http.get<T>(this.dnnContext.$2sxc.http.apiUrl(webApiRoot), {\r\n      params: {\r\n        appId: this.context.appId.toString(),\r\n        targetType: typeId.toString(),\r\n        keyType,\r\n        key,\r\n        contentType: contentTypeName,\r\n      },\r\n    });\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { EntitiesService } from '../../content-items/services/entities.service';\r\nimport { eavConstants } from '../../shared/constants/eav.constants';\r\nimport { Permission } from '../models/permission.model';\r\nimport { MetadataService } from './metadata.service';\r\n\r\n@Injectable()\r\nexport class PermissionsService {\r\n  constructor(private metadataService: MetadataService, private entitiesService: EntitiesService) { }\r\n\r\n  getAll(targetType: number, keyType: string, key: string) {\r\n    return this.metadataService.getMetadata<Permission[]>(targetType, keyType, key, eavConstants.contentTypes.permissions);\r\n  }\r\n\r\n  delete(id: number) {\r\n    return this.entitiesService.delete(eavConstants.contentTypes.permissions, id, false);\r\n  }\r\n}\r\n","import { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { Component } from '@angular/core';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { copyToClipboard } from '../../helpers/copy-to-clipboard.helper';\r\nimport { IdFieldParams } from './id-field.models';\r\n\r\n@Component({\r\n  selector: 'app-id-field',\r\n  templateUrl: './id-field.component.html',\r\n  styleUrls: ['./id-field.component.scss'],\r\n})\r\nexport class IdFieldComponent implements ICellRendererAngularComp {\r\n  id: number | string;\r\n  tooltip: string;\r\n\r\n  constructor(private snackBar: MatSnackBar) { }\r\n\r\n  agInit(params: IdFieldParams) {\r\n    this.id = params.value;\r\n    this.tooltip = params.tooltipGetter(params.data);\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n\r\n  copy() {\r\n    copyToClipboard(this.tooltip);\r\n    this.snackBar.open('Copied to clipboard', null, { duration: 2000 });\r\n  }\r\n}\r\n","<div matRipple class=\"id-box highlight\" [tippy]=\"tooltip\" (click)=\"copy()\">\r\n  <span class=\"id\">{{ id }}</span>\r\n  <mat-icon class=\"icon\">file_copy</mat-icon>\r\n</div>\r\n","/** https://hackernoon.com/copying-text-to-clipboard-with-javascript-df4d4988697f */\r\nexport function copyToClipboard(str: string) {\r\n  const el = document.createElement('textarea');  // Create a <textarea> element\r\n  el.value = str;                                 // Set its value to the string that you want copied\r\n  el.setAttribute('readonly', '');                // Make it readonly to be tamper-proof\r\n  el.style.position = 'absolute';\r\n  el.style.left = '-9999px';                      // Move outside the screen to make it invisible\r\n  document.body.appendChild(el);                  // Append the <textarea> element to the HTML document\r\n  const selected =\r\n    document.getSelection().rangeCount > 0        // Check if there is any content selected previously\r\n      ? document.getSelection().getRangeAt(0)     // Store selection if found\r\n      : false;                                    // Mark as false to know no selection existed before\r\n  el.select();                                    // Select the <textarea> content\r\n  document.execCommand('copy');                   // Copy - only works as a result of a user action (e.g. click events)\r\n  document.body.removeChild(el);                  // Remove the <textarea> element\r\n  if (selected) {                                 // If a selection existed before copying\r\n    document.getSelection().removeAllRanges();    // Unselect everything on the HTML document\r\n    document.getSelection().addRange(selected);   // Restore the original selection\r\n  }\r\n}\r\n","export function toBase64(file: File): Promise<string> {\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    reader.readAsDataURL(file);\r\n    reader.onload = () => {\r\n      resolve((reader.result as string).split(',')[1]);\r\n    };\r\n    reader.onerror = error => {\r\n      reject(error);\r\n    };\r\n  });\r\n}\r\n\r\nexport function toString(file: File): Promise<string> {\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    reader.readAsText(file);\r\n    reader.onload = () => {\r\n      resolve(reader.result as string);\r\n    };\r\n    reader.onerror = error => {\r\n      reject(error);\r\n    };\r\n  });\r\n}\r\n"],"sourceRoot":"webpack:///"}