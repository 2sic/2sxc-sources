{"version":3,"file":"default-projects_eav-ui_src_app_shared_components_file-upload-dialog_index_ts.9c8fff33825caa86.js","mappings":"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","names":["BaseDirective","constructor","this","subscriptions","Subscription","ngOnDestroy","unsubscribe","MessagesFrom2sxc","moduleId","alreadyProcessing","messages$","fromEvent","window","pipe","tap","d","console","log","filter","evt","origin","map","JSON","parse","data","e","error","Number","AppInstallSettingsService","http","installSettingsSubject","Subject","settings$","asObservable","startWith","subscribe","loadGettingStarted","isContentApp","get","json","next","i0","i1","factory","Éµfac","nodeEventEmitterMethods","eventTargetMethods","jqueryMethods","target","eventName","options","resultSelector","isFunction","undefined","mapOneOrManyArgs","add","remove","isEventTarget","addEventListener","removeEventListener","methodName","handler","isNodeStyleEventEmitter","addListener","removeListener","toCommonHandlerRegistry","isJQueryStyleEventEmitter","on","off","isArrayLike","mergeMap","subTarget","innerFrom","TypeError","Observable","subscriber","args","length","DragAndDropDirective","elementRef","zone","snackBar","super","markStyle","input","allowedFileTypes","filesDropped","output","dropAreaClass","markStyleClass","signal","dragClass","timeouts","element","nativeElement","ngOnInit","set","classList","runOutsideAngular","event","preventDefault","stopPropagation","clearTimeouts","push","setTimeout","onDrop","files","Array","from","dataTransfer","filterTypes","emit","timeout","clearTimeout","allowedTypes","split","type","toLocaleLowerCase","filtered","file","extIndex","name","lastIndexOf","ext","substring","includes","allowedTypesString","replace","open","duration","selectors","hostBindings","rf","ctx","$event","InstallerService","installPackages","packages","step","reduce","t","c","switchMap","url","post","of","ImportModeValues","importOriginal","importAsTemplate","FileUploadMessageTypes","Warning","Success","Error","UploadTypes","App","AppPart","ContentType","ContentItem","Query","View","ImportParts","Extension","_r2","ctx_r2","closeDialog","dialogData","title","FileUploadDialogComponent_Conditional_7_Conditional_7_Template","FileUploadDialogComponent_Conditional_7_Conditional_8_Template","importForm","importModeValues","tmp_5_0","value","file_r5","_r6","toggleShowAppCatalog","uploading","invalid","_r7","upload","result","_r8","_r9","cleanUpload","FileUploadDialogComponent_Conditional_17_Conditional_1_Conditional_2_Template","FileUploadDialogComponent_Conditional_17_Conditional_1_Conditional_3_Template","uploadType","_r10","_r11","FileUploadDialogComponent_Conditional_17_Conditional_2_Conditional_2_Template","FileUploadDialogComponent_Conditional_17_Conditional_2_Conditional_3_Template","_c2","message_r12","MessageType","Text","FileUploadDialogComponent_Conditional_17_Conditional_1_Template","FileUploadDialogComponent_Conditional_17_Conditional_2_Template","FileUploadDialogComponent_Conditional_17_For_4_Template","Messages","remoteInstallerUrl","currentPackage","displayName","FileUploadDialogComponent_Conditional_18_Conditional_0_Template","FileUploadDialogComponent_Conditional_18_Conditional_1_Template","ready","showProgress","FileUploadDialogComponent","BaseComponent","#installerService","#installSettingsService","#appsListService","#fb","dialog","sanitizer","changeDetectorRef","hostClass","showAppCatalog","urlChangeImportMode","transient","AppsListService","inject","FormBuilder","group","importMode","Validators","required","context","Context","messages","settings","remoteUrl","bypassSecurityTrustResourceUrl","#setupConditionalValidation","valueChanges","mode","isTemplate","action","winFrame","installerWindow","specsMsg","installedApps","rules","app","appGuid","guid","specsJson","stringify","contentWindow","postMessage","Object","values","msg","confirm","detectChanges","createTemplate","p","alert","top","location","reload","catchError","Message","message","refresh","close","nameControl","setValidators","updateValueAndValidity","#setFiles","filesChanged","upload$","take","multiple","slice","MAT_DIALOG_DATA","i2","i3","viewQuery","_r1","FileUploadDialogComponent_Conditional_1_Template","FileUploadDialogComponent_Conditional_3_Template","FileUploadDialogComponent_Conditional_4_Template","FileUploadDialogComponent_Conditional_7_Template","fileInput_r4","click","FileUploadDialogComponent_Conditional_10_Template","FileUploadDialogComponent_For_12_Template","FileUploadDialogComponent_Conditional_15_Template","FileUploadDialogComponent_Conditional_16_Template","FileUploadDialogComponent_Conditional_17_Template","FileUploadDialogComponent_Conditional_18_Template","_c1","description","valid","NgClass","MatDialogModule","MatProgressSpinnerModule","i4","MatButtonModule","i5","MatIconModule","i6","MatRadioModule","i7","MatInputModule","i8","i9","ReactiveFormsModule","i10","SafeHtmlPipe","styles","webApiAppRootApp","HttpServiceBaseSignal","getAllLive","httpResource","apiUrl","params","zoneId","getInheritable","getPendingApps","create","inheritAppId","templateId","newName","encodedName","encodeURIComponent","installPendingApps","pendingApps","delete","appId","toString","flushCache","_this","_asyncToGenerator","getStatusPromise","__ngFactoryType__"],"ignoreList":[],"sourceRoot":"webpack:///","sources":["./projects/eav-ui/src/app/shared/directives/base.directive.ts","./projects/eav-ui/src/app/shared/components/file-upload-dialog/messages-from-2sxc.ts","./projects/eav-ui/src/app/shared/services/getting-started.service.ts","./node_modules/rxjs/dist/esm/internal/observable/fromEvent.js","./projects/eav-ui/src/app/shared/directives/drag-and-drop.directive.ts","./projects/eav-ui/src/app/shared/services/installer.service.ts","./projects/eav-ui/src/app/shared/components/file-upload-dialog/file-upload-dialog.models.ts","./projects/eav-ui/src/app/shared/components/file-upload-dialog/file-upload-dialog.html","./projects/eav-ui/src/app/shared/components/file-upload-dialog/file-upload-dialog.ts","./projects/eav-ui/src/app/apps-management/services/apps-list.service.ts"],"sourcesContent":["import { Directive, OnDestroy } from '@angular/core';\r\nimport { Subscription } from 'rxjs';\r\n\r\n@Directive()\r\n// tslint:disable-next-line:directive-class-suffix\r\nexport abstract class BaseDirective implements OnDestroy {\r\n  /** Holds all subscriptions to be unsubscribed on destroy */\r\n  protected subscriptions = new Subscription();\r\n\r\n  constructor() {\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.subscriptions.unsubscribe();\r\n  }\r\n}\r\n","import { filter, fromEvent, map, tap } from \"rxjs\";\r\nimport { CrossWindowMessage } from \"../../models/installer-models\";\r\n\r\n/**\r\n * Helper to listen to messages from 2sxc.org for installation purposes\r\n * Copied from 2sxc-ui app/installer\r\n * Note that it listens to all windows messages, and must filter\r\n * the ones from 2sxc.org with the correct moduleId\r\n */\r\nexport class MessagesFrom2sxc {\r\n\r\n  constructor(private moduleId: number) {}\r\n\r\n  alreadyProcessing = false;\r\n  // copied from 2sxc-ui app/installer\r\n  // Initial Observable to monitor messages\r\n  messages$ = fromEvent(window, 'message')\r\n  .pipe(\r\n    tap(d => console.log('debug: received window message', d, this.moduleId)),\r\n    // Ensure only one installation is processed.\r\n    filter(() => !this.alreadyProcessing),\r\n    filter((evt: MessageEvent) => evt.origin === \"https://2sxc.org\"),\r\n    // Get data from event.\r\n    map((evt: MessageEvent) => {\r\n     try {\r\n        return JSON.parse(evt.data) as CrossWindowMessage;\r\n      } catch (e) {\r\n        console.error('error procesing message. Message was ' + evt.data, e);\r\n        return void 0;\r\n      }\r\n    }),\r\n    // Check if data is valid and the moduleID matches\r\n    filter(data => data && Number(data.moduleId) === this.moduleId),\r\n    tap(data => console.log('debug: processed 2sxc.org message', data))\r\n  );\r\n}","\r\nimport { startWith, map, tap } from 'rxjs/operators';\r\nimport { Injectable } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Subject, Observable } from 'rxjs';\r\nimport { InstallSettings } from '../models/installer-models';\r\n\r\n// copied from 2sxc-ui app/installer\r\n@Injectable()\r\nexport class AppInstallSettingsService {\r\n\r\n  private installSettingsSubject: Subject<InstallSettings> = new Subject<InstallSettings>();\r\n  settings$: Observable<InstallSettings> = this.installSettingsSubject.asObservable();\r\n\r\n  constructor(private http: HttpClient) {\r\n    const ready$ = this.settings$.pipe(\r\n      map(() => true),\r\n      startWith(false));\r\n\r\n    ready$.subscribe();\r\n  }\r\n\r\n  public loadGettingStarted(isContentApp: boolean): void {\r\n    this.http.get<InstallSettings>(`sys/install/InstallSettings?isContentApp=${isContentApp}`)\r\n      .subscribe(json => this.installSettingsSubject.next(json));\r\n  }\r\n}\r\n","import { innerFrom } from '../observable/innerFrom';\nimport { Observable } from '../Observable';\nimport { mergeMap } from '../operators/mergeMap';\nimport { isArrayLike } from '../util/isArrayLike';\nimport { isFunction } from '../util/isFunction';\nimport { mapOneOrManyArgs } from '../util/mapOneOrManyArgs';\nconst nodeEventEmitterMethods = ['addListener', 'removeListener'];\nconst eventTargetMethods = ['addEventListener', 'removeEventListener'];\nconst jqueryMethods = ['on', 'off'];\nexport function fromEvent(target, eventName, options, resultSelector) {\n    if (isFunction(options)) {\n        resultSelector = options;\n        options = undefined;\n    }\n    if (resultSelector) {\n        return fromEvent(target, eventName, options).pipe(mapOneOrManyArgs(resultSelector));\n    }\n    const [add, remove] = isEventTarget(target)\n        ? eventTargetMethods.map((methodName) => (handler) => target[methodName](eventName, handler, options))\n        :\n            isNodeStyleEventEmitter(target)\n                ? nodeEventEmitterMethods.map(toCommonHandlerRegistry(target, eventName))\n                : isJQueryStyleEventEmitter(target)\n                    ? jqueryMethods.map(toCommonHandlerRegistry(target, eventName))\n                    : [];\n    if (!add) {\n        if (isArrayLike(target)) {\n            return mergeMap((subTarget) => fromEvent(subTarget, eventName, options))(innerFrom(target));\n        }\n    }\n    if (!add) {\n        throw new TypeError('Invalid event target');\n    }\n    return new Observable((subscriber) => {\n        const handler = (...args) => subscriber.next(1 < args.length ? args : args[0]);\n        add(handler);\n        return () => remove(handler);\n    });\n}\nfunction toCommonHandlerRegistry(target, eventName) {\n    return (methodName) => (handler) => target[methodName](eventName, handler);\n}\nfunction isNodeStyleEventEmitter(target) {\n    return isFunction(target.addListener) && isFunction(target.removeListener);\n}\nfunction isJQueryStyleEventEmitter(target) {\n    return isFunction(target.on) && isFunction(target.off);\n}\nfunction isEventTarget(target) {\n    return isFunction(target.addEventListener) && isFunction(target.removeEventListener);\n}\n","import { Directive, ElementRef, HostListener, input, NgZone, OnDestroy, OnInit, output, signal } from '@angular/core';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { fromEvent } from 'rxjs';\r\nimport { BaseDirective } from './base.directive';\r\n\r\n@Directive({\r\n  selector: '[appDragAndDrop]',\r\n})\r\nexport class DragAndDropDirective extends BaseDirective implements OnInit, OnDestroy {\r\n  markStyle = input<'outline' | 'fill' | 'shadow'>('outline');\r\n  /** Comma separated file types, e.g. 'txt,doc,docx' */\r\n  allowedFileTypes = input<string>('');\r\n  protected filesDropped = output<File[]>();\r\n\r\n  private element: HTMLElement;\r\n  private dropAreaClass = 'eav-droparea';\r\n  private markStyleClass = signal<string>('');\r\n  private dragClass = 'eav-dragover';\r\n  private timeouts: number[] = [];\r\n\r\n  constructor(elementRef: ElementRef, private zone: NgZone, private snackBar: MatSnackBar) {\r\n    super();\r\n    this.element = elementRef.nativeElement;\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.markStyleClass.set(`eav-droparea-${this.markStyle()}`);\r\n    this.element.classList.add(this.dropAreaClass, this.markStyleClass());\r\n    this.zone.runOutsideAngular(() => {\r\n      this.subscriptions.add(\r\n        fromEvent<DragEvent>(this.element, 'dragover').subscribe(event => {\r\n          event.preventDefault();\r\n          event.stopPropagation();\r\n          this.clearTimeouts();\r\n          this.element.classList.add(this.dragClass);\r\n        })\r\n      );\r\n      this.subscriptions.add(\r\n        fromEvent<DragEvent>(this.element, 'dragleave').subscribe(event => {\r\n          event.preventDefault();\r\n          event.stopPropagation();\r\n          this.timeouts.push(\r\n            window.setTimeout(() => { this.element.classList.remove(this.dragClass); }, 50)\r\n          );\r\n        })\r\n      );\r\n    });\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.clearTimeouts();\r\n    this.element.classList.remove(this.dropAreaClass, this.markStyleClass(), this.dragClass);\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  @HostListener('drop', ['$event'])\r\n  onDrop(event: DragEvent) {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n    this.clearTimeouts();\r\n    this.element.classList.remove(this.dragClass);\r\n    const fileList = event.dataTransfer.files;\r\n    let files = Array.from(fileList);\r\n    files = this.filterTypes(files, this.allowedFileTypes());\r\n    if (files.length > 0) {\r\n      this.filesDropped.emit(files);\r\n    }\r\n  }\r\n\r\n  private clearTimeouts() {\r\n    for (const timeout of this.timeouts) {\r\n      clearTimeout(timeout);\r\n    }\r\n    this.timeouts = [];\r\n  }\r\n\r\n  private filterTypes(files: File[], allowedFileTypes: string) {\r\n    if (allowedFileTypes === '') { return files; }\r\n\r\n    const allowedTypes = allowedFileTypes.split(',').map(type => type.toLocaleLowerCase());\r\n    const filtered = files.filter(file => {\r\n      const extIndex = file.name.lastIndexOf('.');\r\n      if (extIndex <= 0) { return false; }\r\n      const ext = file.name.substring(extIndex + 1).toLocaleLowerCase();\r\n      const allowed = allowedTypes.includes(ext);\r\n      return allowed;\r\n    });\r\n\r\n    if (files.length !== filtered.length) {\r\n      const allowedTypesString = this.allowedFileTypes().replace(/\\,/g, ', ');\r\n      const message = filtered.length\r\n        ? 'Some files were filtered out. This drop location only accepts file types: ' + allowedTypesString\r\n        : 'This drop location only accepts file types: ' + allowedTypesString;\r\n      this.snackBar.open(message, null, { duration: 5000 });\r\n    }\r\n    return filtered;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { Observable, of, switchMap } from 'rxjs';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { InstallPackage } from '../models/installer-models';\r\n\r\n// copied from 2sxc-ui app/installer\r\n@Injectable()\r\nexport class InstallerService {\r\n\r\n  constructor(private http: HttpClient) { }\r\n\r\n  installPackages(packages: InstallPackage[], step: (p: InstallPackage) => void): Observable<any> {\r\n    return packages.reduce(\r\n      (t: Observable<Response>, c) => t.pipe(\r\n        switchMap(() => {\r\n          if (!c.url) return of(true);\r\n          step(c);\r\n          return <Observable<any>>this.http.post(`sys/install/RemotePackage?packageUrl=${c.url}`, {});\r\n        })),\r\n      of(true));\r\n  }\r\n}\r\n","import { Observable } from 'rxjs';\r\nimport { Of } from '../../../../../../core';\r\n\r\nexport interface FileUploadDialogData {\r\n  title?: string;\r\n  description?: string;\r\n  allowedFileTypes?: string;\r\n  files?: File[];\r\n  multiple?: boolean;\r\n  // upload$?(files: File[]): Observable<FileUploadResult>;\r\n  upload$?(files: File[], name?: string): Observable<FileUploadResult>;\r\n}\r\n\r\nexport enum ImportModeValues {\r\n  importOriginal = 'importOriginal',\r\n  importAsTemplate = 'importAsTemplate',\r\n}\r\n\r\nexport interface FileUploadResult {\r\n  Messages: FileUploadResultMessage[];\r\n  Success: boolean;\r\n}\r\n\r\nexport interface FileUploadResultMessage {\r\n  MessageType: Of<typeof FileUploadMessageTypes>;\r\n  Text: string;\r\n}\r\n\r\nexport const FileUploadMessageTypes = {\r\n  Warning: 0,\r\n  Success: 1,\r\n  Error: 2,\r\n} as const /* the as const ensures that the keys/values can be strictly checked */;\r\n\r\nexport const UploadTypes = {\r\n  App: 0,\r\n  AppPart: 1,\r\n  ContentType: 2,\r\n  ContentItem: 3,\r\n  Query: 4,\r\n  View: 5,\r\n  ImportParts: 6,\r\n  Extension: 7,\r\n} as const /* the as const ensures that the keys/values can be strictly checked */;\r\n","<div\r\n  class=\"eav-dialog\"\r\n  style=\"margin-bottom: 12px\"\r\n  appDragAndDrop\r\n  [allowedFileTypes]=\"dialogData.allowedFileTypes\"\r\n  (filesDropped)=\"filesDropped($event)\"\r\n>\r\n  @if (uploadType() != UploadTypes.ImportParts) {\r\n    <div class=\"eav-dialog-header\">\r\n      <div\r\n        class=\"eav-dialog-header__title\"\r\n        [innerHtml]=\"dialogData.title | safeHtml\"\r\n      ></div>\r\n      <button mat-icon-button tippy=\"Close dialog\" (click)=\"closeDialog()\">\r\n        <mat-icon>close</mat-icon>\r\n      </button>\r\n    </div>\r\n  }\r\n\r\n  <div\r\n    [ngClass]=\"{\r\n      'outer-container-app': uploadType() === UploadTypes.ImportParts,\r\n      'eav-dialog-content': uploadType() !== UploadTypes.ImportParts,\r\n    }\"\r\n  >\r\n    @if (uploadType() == UploadTypes.ImportParts) {\r\n      <h3 [innerHtml]=\"dialogData.title | safeHtml\"></h3>\r\n    }\r\n\r\n    @if (uploading()) {\r\n      <mat-spinner mode=\"indeterminate\" diameter=\"20\"></mat-spinner>\r\n    }\r\n\r\n    <p [innerHtml]=\"dialogData.description | safeHtml\"></p>\r\n\r\n    @if (uploadType() == UploadTypes.App) {\r\n      <form [formGroup]=\"importForm\">\r\n        <mat-radio-group formControlName=\"importMode\" aria-label=\"Select import mode\">\r\n          <mat-radio-button [value]=\"importModeValues.importOriginal\">\r\n            Import App(s)\r\n          </mat-radio-button>\r\n          <mat-radio-button [value]=\"importModeValues.importAsTemplate\">\r\n            Import and Rename / Reset\r\n          </mat-radio-button>\r\n        </mat-radio-group>\r\n        <br />\r\n\r\n        @if (importForm.get('importMode')?.value === importModeValues.importOriginal) {\r\n          <span>\r\n            The app will be imported as is, using the original name and folder.\r\n          </span>\r\n          <span>\r\n            If you already have the same app installed, it will prevent you from overwriting it.\r\n          </span>\r\n        } @else if (\r\n          importForm.get('importMode')?.value === importModeValues.importAsTemplate\r\n        ) {\r\n          <span>\r\n            The app will be imported using a new name / folder.\r\n          </span>\r\n          <span>\r\n            This allows you to create multiple isolated copies of the same app or to create something very different using this app as a\r\n            template.\r\n          </span>\r\n          <br />\r\n          <mat-form-field\r\n            color=\"accent\"\r\n            class=\"eav-mat-form-field\"\r\n            style=\"max-width: 300px\"\r\n          >\r\n            <mat-label>Name</mat-label>\r\n            <input\r\n              matInput\r\n              type=\"text\"\r\n              formControlName=\"name\"\r\n            />\r\n          </mat-form-field>\r\n        }\r\n      </form>\r\n      <br />\r\n    }\r\n\r\n    <div>\r\n      <button\r\n        mat-raised-button\r\n        tippy=\"Open file browser\"\r\n        [disabled]=\"uploading() || importForm.invalid\"\r\n        (click)=\"fileInput.click()\"\r\n      >\r\n        @if (!files().length) {\r\n          <div>Select or drop file</div>\r\n        }\r\n        @for (file of files(); track file) {\r\n          <div>{{ file.name }}</div>\r\n        }\r\n      </button>\r\n\r\n      <input\r\n        #fileInput\r\n        type=\"file\"\r\n        multiple\r\n        (change)=\"filesChanged($event)\"\r\n        class=\"hide\"\r\n      />\r\n\r\n      @if (uploadType() == UploadTypes.App && !files().length) {\r\n        <button\r\n          mat-raised-button\r\n          class=\"eav-app-catalog-button eav-action-button\"\r\n          [disabled]=\"uploading() || importForm.invalid\"\r\n          tippy=\"Open app catalog\"\r\n          (click)=\"toggleShowAppCatalog()\"\r\n        >\r\n          Get recommended Apps from Catalog\r\n        </button>\r\n      }\r\n\r\n      @if (files().length) {\r\n        <button\r\n          class=\"eav-action-button\"\r\n          style=\"margin-left: 12px\"\r\n          mat-raised-button\r\n          [disabled]=\"\r\n            !files().length ||\r\n            uploading() ||\r\n            !!result() ||\r\n            importForm.invalid\"\r\n          (click)=\"upload()\"\r\n        >\r\n          Upload\r\n        </button>\r\n      }\r\n    </div>\r\n    @if (result()) {\r\n      <div class=\"eav-result-container\">\r\n        @if (result().Success) {\r\n          <div class=\"sxc-message sxc-message-info\">\r\n            Upload succeeded. See the messages below for more information.\r\n            @if (uploadType() != UploadTypes.ImportParts) {\r\n              <a href=\"javascript:void(0)\" (click)=\"closeDialog(true)\">Close</a>\r\n            } @else {\r\n              <a href=\"javascript:void(0)\" (click)=\"cleanUpload()\">Clean</a>\r\n            }\r\n          </div>\r\n        }\r\n        @if (!result().Success) {\r\n          <div class=\"sxc-message sxc-message-error\">\r\n            Upload failed. See the messages below for more information.\r\n            @if (uploadType() != UploadTypes.ImportParts) {\r\n              <a href=\"javascript:void(0)\" (click)=\"closeDialog(true)\">Close</a>\r\n            } @else {\r\n              <a href=\"javascript:void(0)\" (click)=\"cleanUpload()\">Clean</a>\r\n            }\r\n          </div>\r\n        }\r\n        @for (message of result().Messages; track message) {\r\n          <div\r\n            class=\"sxc-message\"\r\n            [ngClass]=\"{\r\n              'sxc-message-warning': message.MessageType === FileUploadMessageTypes.Warning,\r\n              'sxc-message-success': message.MessageType === FileUploadMessageTypes.Success,\r\n              'sxc-message-error': message.MessageType === FileUploadMessageTypes.Error,\r\n            }\"\r\n          >\r\n            {{ message.Text }}\r\n          </div>\r\n        }\r\n      </div>\r\n    }\r\n    @if (\r\n      uploadType() == UploadTypes.App\r\n        && showAppCatalog()\r\n        && !files().length\r\n        && importForm.valid\r\n      ) {\r\n      @if (ready) {\r\n        <iframe\r\n          #installerWindow\r\n          class=\"eav-app-catalog-iframe\"\r\n          [src]=\"remoteInstallerUrl\"\r\n        ></iframe>\r\n      }\r\n      @if (showProgress) {\r\n        <div class=\"eav-progress\">\r\n          <mat-progress-spinner [mode]=\"'indeterminate'\"\r\n          ></mat-progress-spinner>\r\n          <span>\r\n            Installing {{ currentPackage?.displayName }}..\r\n          </span>\r\n        </div>\r\n      }\r\n    }\r\n  </div>\r\n</div>\r\n","import { NgClass } from '@angular/common';\r\nimport { ChangeDetectorRef, Component, ElementRef, HostBinding, inject, Inject, input, OnDestroy, OnInit, signal, ViewChild } from '@angular/core';\r\nimport { FormBuilder, FormGroup, ReactiveFormsModule, Validators } from '@angular/forms';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MAT_DIALOG_DATA, MatDialogModule, MatDialogRef } from '@angular/material/dialog';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatInputModule } from '@angular/material/input';\r\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\r\nimport { MatRadioModule } from '@angular/material/radio';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { DomSanitizer } from '@angular/platform-browser';\r\nimport { catchError, filter, map, of, switchMap, take, tap } from 'rxjs';\r\nimport { Of, transient } from '../../../../../../core';\r\nimport { AppsListService } from '../../../apps-management/services/apps-list.service';\r\nimport { DragAndDropDirective } from '../../directives/drag-and-drop.directive';\r\nimport { InstallPackage, InstallSettings, SpecsForInstaller } from '../../models/installer-models';\r\nimport { SafeHtmlPipe } from '../../pipes/safe-html.pipe';\r\nimport { Context } from '../../services/context';\r\nimport { AppInstallSettingsService } from '../../services/getting-started.service';\r\nimport { InstallerService } from '../../services/installer.service';\r\nimport { BaseComponent } from '../base';\r\nimport { FileUploadDialogData, FileUploadMessageTypes, FileUploadResult, ImportModeValues, UploadTypes } from './file-upload-dialog.models';\r\nimport { MessagesFrom2sxc } from './messages-from-2sxc';\r\n\r\n@Component({\r\n  selector: 'app-file-upload-dialog',\r\n  templateUrl: './file-upload-dialog.html',\r\n  styleUrls: ['./file-upload-dialog.scss'],\r\n  imports: [\r\n    NgClass,\r\n    MatDialogModule,\r\n    MatProgressSpinnerModule,\r\n    SafeHtmlPipe,\r\n    DragAndDropDirective,\r\n    MatButtonModule,\r\n    MatIconModule,\r\n    MatRadioModule,\r\n    MatInputModule,\r\n    ReactiveFormsModule\r\n  ]\r\n})\r\nexport class FileUploadDialogComponent extends BaseComponent implements OnInit, OnDestroy {\r\n  @HostBinding('className') hostClass = 'dialog-component';\r\n\r\n  uploadType = input<Of<typeof UploadTypes>>();\r\n\r\n  @ViewChild('installerWindow') installerWindow: ElementRef;\r\n\r\n  uploading = signal(false);\r\n  showAppCatalog = signal(false);\r\n  result = signal<FileUploadResult>(undefined);\r\n  files = signal<File[]>([]);\r\n\r\n  FileUploadMessageTypes = FileUploadMessageTypes;\r\n  UploadTypes = UploadTypes;\r\n  importModeValues = ImportModeValues;\r\n\r\n  showProgress: boolean = false;\r\n  currentPackage: InstallPackage;\r\n  remoteInstallerUrl = '';\r\n  urlChangeImportMode = \"\"\r\n  ready = false;\r\n  settings: InstallSettings;\r\n\r\n  #installerService = transient(InstallerService);\r\n  #installSettingsService = transient(AppInstallSettingsService);\r\n  #appsListService = transient(AppsListService);\r\n  #fb = inject(FormBuilder);\r\n\r\n  importForm: FormGroup = this.#fb.group({\r\n    importMode: [this.importModeValues.importOriginal, Validators.required],\r\n    name: ['']\r\n  });\r\n\r\n  private context = inject(Context);\r\n\r\n  messages = new MessagesFrom2sxc(this.context.moduleId);\r\n\r\n  constructor(\r\n    @Inject(MAT_DIALOG_DATA) public dialogData: FileUploadDialogData,\r\n    private dialog: MatDialogRef<FileUploadDialogComponent>,\r\n    private snackBar: MatSnackBar,\r\n    private sanitizer: DomSanitizer,\r\n    private changeDetectorRef: ChangeDetectorRef,\r\n  ) {\r\n    super();\r\n\r\n    // copied from 2sxc-ui app/installer\r\n    this.subscriptions.add(\r\n      this.#installSettingsService.settings$.subscribe(settings => {\r\n        this.settings = settings;\r\n        this.urlChangeImportMode = settings.remoteUrl\r\n        this.remoteInstallerUrl = <string>this.sanitizer.bypassSecurityTrustResourceUrl(settings.remoteUrl);\r\n        this.ready = true;\r\n      })\r\n    );\r\n\r\n    this.#setupConditionalValidation();\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    // Update the remote installer URL based on the import mode\r\n    // Show multiple select or single select based on import mode\r\n    this.importForm.get('importMode')?.valueChanges.subscribe((mode) => {\r\n      const isTemplate = mode === this.importModeValues.importAsTemplate;\r\n      const url = this.urlChangeImportMode + (this.urlChangeImportMode.includes('?') ? '&' : '?') + `selectOnlyMode=${isTemplate}`;\r\n      this.remoteInstallerUrl = <string>this.sanitizer.bypassSecurityTrustResourceUrl(url);\r\n    });\r\n\r\n    if (this.dialogData.files != null)\r\n      this.filesDropped(this.dialogData.files);\r\n\r\n    // copied from 2sxc-ui\r\n    this.#installSettingsService.loadGettingStarted(false); // Passed as input from 2sxc-ui\r\n\r\n    this.subscriptions.add(this.messages.messages$\r\n      // Verify it's for this action\r\n      .pipe(\r\n        filter(data => data.action === 'specs'),\r\n      )\r\n      // Send message to iframe\r\n      .subscribe(() => {\r\n        const winFrame = this.installerWindow.nativeElement as HTMLIFrameElement;\r\n        const specsMsg: SpecsForInstaller = {\r\n          action: 'specs',\r\n          data: {\r\n            //currently not used\r\n            installedApps: this.settings.installedApps,//.map(app => ((app as InstalledApp).guid)),\r\n            //currently used to forbid already installed apps\r\n            rules: this.settings.installedApps.map(app => ({ target: 'guid', appGuid: app.guid, mode: 'f', url: '' })),//this.settings.rules,\r\n          },\r\n        };\r\n        const specsJson = JSON.stringify(specsMsg);\r\n        winFrame.contentWindow.postMessage(specsJson, '*');\r\n        console.log('debug: just sent specs message #2:' + specsJson, specsMsg, winFrame);\r\n      })\r\n    );\r\n\r\n    // copied from 2sxc-ui app/installer\r\n    // Subscription to listen to 'install' messages\r\n    this.subscriptions.add(this.messages.messages$.pipe(\r\n      filter(data => data.action === 'install'),\r\n      // Get packages from data.\r\n      map(data => Object.values(data.packages)),\r\n      // Show confirm dialog.\r\n      filter(packages => {\r\n        const packagesDisplayNames = packages\r\n          .reduce((t, c) => `${t} - ${c.displayName}\\n`, '');\r\n\r\n        const msg = `Do you want to install these packages?\r\n\r\n${packagesDisplayNames}\r\nThis takes about 10 seconds per package. Don't reload the page while it's installing.`;\r\n        return confirm(msg);\r\n      }),\r\n      // Install the packages one at a time\r\n      switchMap(packages => {\r\n        this.messages.alreadyProcessing = true;\r\n        this.showProgress = true;\r\n        this.changeDetectorRef.detectChanges(); //without this spinner is not shown\r\n        // If import mode is 'importAsTemplate', create a Install template with Url and new Name\r\n        if (this.importForm.get('importMode')?.value === this.importModeValues.importAsTemplate) {\r\n          return this.#appsListService.createTemplate(packages[0].url, this.importForm.get('name')?.value);\r\n        } else {\r\n          // Otherwise, install the packages normally\r\n          return this.#installerService.installPackages(packages, p => this.currentPackage = p);\r\n        }\r\n      }),\r\n      tap(() => {\r\n        this.showProgress = false;\r\n        this.changeDetectorRef.detectChanges(); //without this spinner is not removed (though window reload will remove it anyway) so maybe unnecessary\r\n        alert('Installation complete ðŸ‘');\r\n        window.top.location.reload();\r\n        this.closeDialog(true);\r\n      }),\r\n      catchError(error => {\r\n        console.error('Error: ', error);\r\n        this.showProgress = false;\r\n        this.messages.alreadyProcessing = false;\r\n        this.changeDetectorRef.detectChanges(); //without this spinner is not removed\r\n        const errorMsg = `An error occurred: Package ${this.currentPackage.displayName}\r\n\r\n${error.error?.Message ?? error.error?.message ?? ''}\r\n\r\n${error.message}\r\n\r\nPlease try again later or check how to manually install content-templates: https://azing.org/2sxc/r/0O4OymoA`;\r\n        alert(errorMsg);\r\n        return of(error);\r\n      }),\r\n    ).subscribe());\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  closeDialog(refresh?: boolean): void {\r\n    this.dialog.close(refresh);\r\n  }\r\n\r\n  cleanUpload(): void {\r\n    this.result.set(undefined);\r\n    this.files.set([]);\r\n    this.uploading.set(false);\r\n  }\r\n\r\n  #setupConditionalValidation(): void {\r\n    const nameControl = this.importForm.get('name');\r\n    this.importForm.get('importMode')?.valueChanges.subscribe(mode => {\r\n      const isTemplate = mode === this.importModeValues.importAsTemplate;\r\n      nameControl?.setValidators(isTemplate ? [Validators.required] : null);\r\n      nameControl?.updateValueAndValidity();\r\n    });\r\n  }\r\n\r\n  filesDropped(files: File[]): void {\r\n    this.#setFiles(files);\r\n  }\r\n\r\n  filesChanged(event: Event): void {\r\n    const fileList = (event.target as HTMLInputElement).files;\r\n    const files = Array.from(fileList);\r\n    this.#setFiles(files);\r\n  }\r\n\r\n  upload(): void {\r\n    this.uploading.set(true);\r\n    const name = this.importForm.get('name')?.value as string;\r\n    this.subscriptions.add(\r\n      this.dialogData.upload$(this.files(), name).pipe(take(1)).subscribe({\r\n        next: (result) => {\r\n          this.uploading.set(false);\r\n          this.result.set(result);\r\n        },\r\n        error: () => {\r\n          this.uploading.set(false);\r\n          this.result.set(undefined);\r\n          this.snackBar.open('Upload failed. Please check console for more information', undefined, { duration: 3000 });\r\n        },\r\n      }),\r\n    );\r\n  }\r\n\r\n  toggleShowAppCatalog(): void {\r\n    this.showAppCatalog.set(!this.showAppCatalog());\r\n  }\r\n\r\n  #setFiles(files: File[]): void {\r\n    if (!this.dialogData.multiple)\r\n      files = files.slice(0, 1);\r\n\r\n    this.files.set(files);\r\n  }\r\n}\r\n\r\n","import { httpResource } from '@angular/common/http';\r\nimport { Injectable, Signal } from '@angular/core';\r\nimport { Observable } from 'rxjs';\r\nimport { HttpServiceBaseSignal } from '../../shared/services/http-service-base-signal';\r\nimport { App, PendingApp } from '../models/app.model';\r\n\r\nconst webApiAppRootList = 'admin/app/list';\r\nconst webApiAppRootInheritableApps = 'admin/app/InheritableApps';\r\nconst webApiAppRootPendingApps = 'admin/app/GetPendingApps';\r\nconst webApiAppRootApp = 'admin/app/app';\r\nconst webApiAppRootInstallPendingApps = 'admin/app/InstallPendingApps';\r\nconst webApiAppRootFlushcache = 'admin/app/flushcache';\r\n\r\n@Injectable()\r\nexport class AppsListService extends HttpServiceBaseSignal {\r\n\r\n  // clean way to create a new resource every time if refresh change\r\n  getAllLive(refresh: Signal<unknown>) {\r\n    return httpResource<App[]>(() => {\r\n      refresh();\r\n      return ({\r\n        url: this.apiUrl(webApiAppRootList),\r\n        params: { zoneId: this.zoneId }\r\n      });\r\n    });\r\n  }\r\n\r\n  getInheritable() {\r\n    return httpResource<App[]>(() => ({\r\n      url: this.apiUrl(webApiAppRootInheritableApps),\r\n      params: { zoneId: this.zoneId }\r\n    }));\r\n  }\r\n\r\n  getPendingApps() {\r\n    return httpResource<PendingApp[]>(() => ({\r\n      url: this.apiUrl(webApiAppRootPendingApps),\r\n      params: { zoneId: this.zoneId },\r\n    }));\r\n  }\r\n\r\n  create(name: string, inheritAppId?: number, templateId?: number) {\r\n    return this.http.post<null>(this.apiUrl(webApiAppRootApp), {}, {\r\n      params: {\r\n        zoneId: this.zoneId,\r\n        name,\r\n        ...(inheritAppId != null && { inheritAppId }),\r\n        ...(templateId != null && { templateId }),\r\n      },\r\n    });\r\n  }\r\n\r\n  createTemplate(url: string, newName: string) {\r\n    const encodedName = encodeURIComponent(newName);\r\n    return <Observable<any>>this.http.post(`sys/install/RemotePackage?packageUrl=${url}&newName=${encodedName}`, {});\r\n  }\r\n\r\n  installPendingApps(pendingApps: PendingApp[]) {\r\n    return this.http.post<null>(this.apiUrl(webApiAppRootInstallPendingApps), pendingApps, {\r\n      params: {\r\n        zoneId: this.zoneId,\r\n      },\r\n    });\r\n  }\r\n\r\n  delete(appId: number) {\r\n    return this.http.delete<null>(this.apiUrl(webApiAppRootApp), {\r\n      params: { zoneId: this.zoneId, appId: appId.toString() },\r\n    });\r\n  }\r\n\r\n  async flushCache(appId: number): Promise<number> {\r\n    return this.getStatusPromise(webApiAppRootFlushcache, {\r\n      params: { zoneId: this.zoneId, appId: appId.toString() },\r\n    });\r\n  }\r\n\r\n}\r\n"],"x_google_ignoreList":[3]}