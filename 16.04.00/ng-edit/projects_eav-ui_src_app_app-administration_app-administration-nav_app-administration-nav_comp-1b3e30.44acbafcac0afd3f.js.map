{"version":3,"mappings":"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","names":["AppScopes","App","Site","Global","SafeResourceUrlPipe","constructor","sanitizer","transform","resourceUrl","this","bypassSecurityTrustResourceUrl","i0","pure","GettingStartedComponent","ngOnInit","selectors","ctx_r8","ctx_r10","ctx_r12","ctx_r14","ctx_r16","ctx_r17","ctx_r18","ctx_r19","ctx_r20","DataActionsComponent","agInit","params","contentType","data","enablePermissions","enablePermissionsGetter","guidRegex","test","StaticName","refresh","createOrEditMetadata","onCreateOrEditMetadata","openPermissions","onOpenPermissions","editContentType","onEdit","openMetadata","onOpenMetadata","openRestApi","onOpenRestApi","exportType","onTypeExport","openDataExport","onOpenDataExport","openDataImport","onOpenDataImport","deleteContentType","onDelete","DataFieldsComponent","value","tooltip","EditInfo","ReadOnly","ReadOnlyMessage","SharedDefId","icon","editFields","onEditFields","ctx","DataItemsComponent","showItems","onShowItems","addItem","onAddItem","ctx_r5","ctx_r7","ctx_r9","ctx_r11","DataComponent","BaseComponent","router","route","contentTypesService","globalConfigService","snackBar","contentExportService","super","BehaviorSubject","undefined","buildGridOptions","dropdownInsertValue","combineLatest","contentTypes$","scope$","scopeOptions$","getDebugEnabled$","pipe","map","contentTypes","scope","scopeOptions","debugEnabled","fetchScopes","refreshScopeOnRouteChange","subscription","add","refreshOnChildClosedDeep","subscribe","fetchContentTypes","ngOnDestroy","complete","filesDropped","files","importFile","name","substring","lastIndexOf","toLocaleLowerCase","from","toString","take","fileString","contentTypeName","c","split","_a","find","ct","Name","open","duration","importType","navigate","relativeTo","firstChild","state","showContentItems","retrieveContentTypes","_compareLabel","Label","replace","next","eavConstants","getScopes","newScopes","forEach","scopeOption","existing","push","createGhost","sourceName","window","prompt","res","changeScope","newScope","formUrl","convertFormToUrl","items","ContentTypeName","Properties","EntityId","Id","For","Target","TargetType","String","Prefill","Description","url","GoToMetadata","GoToDevRest","exportJson","GoToPermissions","confirm","delete","result","events","filter","event","NavigationEnd","snapshot","paramMap","get","startWith","distinctUntilChanged","option","includes","Object","defaultGridOptions","columnDefs","headerName","field","width","headerClass","sortable","cellClass","valueGetter","cellRenderer","IdFieldComponent","cellRendererParams","tooltipGetter","flex","minWidth","sort","onCellClicked","comparator","valueA","valueB","nodeA","nodeB","isInverted","localeCompare","Items","Fields","o","pinned","QueryActions","ctx_r6","ctx_r13","QueriesActionsComponent","item","getEnablePermissions","t","ctx_r2","ctx_r4","QueriesComponent","pipelinesService","dialogService","queries$","queries","fetchQueries","getAll","importQuery","doMenuAction","action","query","editQuery","Guid","cloneQuery","exportQuery","deleteQuery","TestParameters","openVisualQueryDesigner","_EditInfo","openQueryDesigner","clonePipeline","exportEntity","do","ViewsActionsComponent","view","enableCode","enableCodeGetter","openCode","onOpenCode","cloneView","onClone","exportView","onExport","deleteView","ViewsShowComponent","HasQuery","List","ContentType","ViewsTypeComponent","type","calculateViewType","isShared","IsShared","ViewsComponent","viewsService","fetchTemplates","fetchPolymorphism","viewModel$","views$","polymorphStatus$","views","polymorphStatus","importView","getPolymorphism","polymorphism","Resolver","editView","form","appIsGlobal","Location","editPolymorphisms","TypeName","openUsage","openCodeFile","TemplatePath","DuplicateEntity","export","BooleanFilterComponent","IsHidden","Used","ViewNameInUrl","DemoId","DemoTitle","PresentationType","ListContentType","ListPresentationType","WebApiActionsComponent","WebApiTypeComponent","WebApiComponent","sourceService","dialog","viewContainerRef","fetchWebApis","webApis$","webApis","createController","global","CreateFileDialogComponent","autoFocus","folder","purpose","afterClosed","endsWith","fileName","create","templateKey","FileLocationDialogComponent","getWebApis","api","path","AnalyzeParts","Settings","Resources","oxw","AppConfigurationCardComponent","contentItemsService","context","appInternalsService","Subject","appSettingsInternal$","settings","contentItems","contentItem","appConfigurationsCount","EntityLists","ToSxcContentApp","length","appMetadataCount","MetadataList","displayName","y","l","DisplayName","N","Folder","_b","version","q","Version","_c","toSxc","M","RequiredVersion","_d","dnn","Q","RequiredDnnVersion","_e","oqt","E","RequiredOqtaneVersion","_f","fetchSettings","dismiss","copyToClipboard","text","edit","staticName","Error","appId","dialogSettings","Context","getAppInternals","x","ctx_r24","ctx_r26","ctx_r27","ctx_r30","ctx_r32","ctx_r33","ctx_r37","ctx_r39","ctx_r40","ctx_r42","ctx_r44","ctx_r45","ctx_r48","ctx_r50","ctx_r51","ctx_r55","ctx_r57","ctx_r58","ctx_r60","ctx_r62","ctx_r66","ctx_r68","ctx_r69","ctx_r70","ctx_r71","AppConfigurationComponent","importAppPartsService","appDialogConfigService","changeDetectorRef","SystemSettingsScopes","FeaturesService","features","loadFromService","isEnabled$","FeatureNames","lightSpeedEnabled","cspEnabled","langPermsEnabled","appLightSpeedCount","i","_Type","systemSettingsCount","isPrimary","SettingsSystem","SettingsEntityScope","customSettingsCount","X","AppSettings","customSettingsFieldsCount","j","FieldAll","systemResourcesCount","ResourcesSystem","customResourcesCount","tt","AppResources","customResourcesFieldsCount","et","ngOnChanges","changes","appScope","SettingsScope","isGlobal","isApp","systemSettingsScope","systemSettingsEntities","systemSettingsEntity","customSettingsEntity","openLightSpeed","AppAdminHelpers","openSiteSettings","sitePrimaryApp","PrimaryApp","openAppAdministration","ZoneId","AppId","openGlobalSettings","globalPrimaryApp","System","config","openLanguagePermissions","enabled","FeatureComponentBase","analyze","part","fixContentType","some","save","Scope","ChangeStaticName","NewStaticName","success","SyncConfigurationComponent","exportAppService","exportApp","exportParts","importParts","exportAppXml","withFiles","exportForVersionControl","includeContentGroups","resetAppGuid","error","resetApp","ctx_r29","AppAdministrationNavComponent","dialogRef","tabs$","tabs","indexOf","tabIndex","dialogSettings$","tabIndex$","fetchDialogSettings","closeDialog","close","changeTab","index","getShared$","UpdateEnvVarsFromDialogSettings","Enable","Query","tab"],"sources":["./projects/eav-ui/src/app/shared/models/dialog-context.models.ts","./projects/eav-ui/src/app/shared/pipes/safe-resource-url.ts","./projects/eav-ui/src/app/app-administration/getting-started/getting-started.component.ts","./projects/eav-ui/src/app/app-administration/getting-started/getting-started.component.html","./projects/eav-ui/src/app/app-administration/data/data-actions/data-actions.component.html","./projects/eav-ui/src/app/app-administration/data/data-actions/data-actions.component.ts","./projects/eav-ui/src/app/app-administration/data/data-fields/data-fields.component.ts","./projects/eav-ui/src/app/app-administration/data/data-fields/data-fields.component.html","./projects/eav-ui/src/app/app-administration/data/data-items/data-items.component.ts","./projects/eav-ui/src/app/app-administration/data/data-items/data-items.component.html","./projects/eav-ui/src/app/app-administration/data/data.component.html","./projects/eav-ui/src/app/app-administration/data/data.component.ts","./projects/eav-ui/src/app/app-administration/queries/queries-actions/queries-actions.ts","./projects/eav-ui/src/app/app-administration/queries/queries-actions/queries-actions.component.html","./projects/eav-ui/src/app/app-administration/queries/queries-actions/queries-actions.component.ts","./projects/eav-ui/src/app/app-administration/queries/ag-actions/ag-actions-component.ts","./projects/eav-ui/src/app/app-administration/queries/queries.component.html","./projects/eav-ui/src/app/app-administration/queries/queries.component.ts","./projects/eav-ui/src/app/app-administration/views/views-actions/views-actions.component.html","./projects/eav-ui/src/app/app-administration/views/views-actions/views-actions.component.ts","./projects/eav-ui/src/app/app-administration/views/views-show/views-show.component.ts","./projects/eav-ui/src/app/app-administration/views/views-show/views-show.component.html","./projects/eav-ui/src/app/app-administration/views/views.helpers.ts","./projects/eav-ui/src/app/app-administration/views/views-type/views-type.component.html","./projects/eav-ui/src/app/app-administration/views/views-type/views-type.component.ts","./projects/eav-ui/src/app/app-administration/views/views.component.html","./projects/eav-ui/src/app/app-administration/views/views.component.ts","./projects/eav-ui/src/app/app-administration/views/polymorph-logo.png","./projects/eav-ui/src/app/app-administration/web-api/web-api-actions/web-api-actions.component.html","./projects/eav-ui/src/app/app-administration/web-api/web-api-actions/web-api-actions.component.ts","./projects/eav-ui/src/app/app-administration/web-api/web-api-type/web-api-type.component.html","./projects/eav-ui/src/app/app-administration/web-api/web-api-type/web-api-type.component.ts","./projects/eav-ui/src/app/app-administration/web-api/web-api.component.html","./projects/eav-ui/src/app/app-administration/web-api/web-api.component.ts","./projects/eav-ui/src/app/app-administration/sub-dialogs/analyze-settings/analyze-settings.models.ts","./projects/eav-ui/src/app/app-administration/app-configuration/app-configuration-card/app-configuration-card.component.html","./projects/eav-ui/src/app/app-administration/app-configuration/app-configuration-card/app-configuration-card.component.ts","./projects/eav-ui/src/app/app-administration/app-configuration/app-configuration.component.html","./projects/eav-ui/src/app/app-administration/app-configuration/app-configuration.component.ts","./projects/eav-ui/src/app/app-administration/sync-configuration/sync-configuration.component.html","./projects/eav-ui/src/app/app-administration/sync-configuration/sync-configuration.component.ts","./projects/eav-ui/src/app/app-administration/app-administration-nav/app-administration-nav.component.html","./projects/eav-ui/src/app/app-administration/app-administration-nav/app-administration-nav.component.ts","./projects/eav-ui/src/app/shared/constants/guid.constants.ts"],"sourcesContent":["import { PermissionsCount } from '../../app-administration/models/permissions-count.model';\r\nimport { Language } from '../../edit/shared/models';\r\n\r\nexport interface DialogContextApp {\r\n  /** Root for app APIs and content/query */\r\n  Api: string;\r\n  Folder: string;\r\n  GettingStartedUrl: string;\r\n  Id: number;\r\n  Identifier: string;\r\n  IsContentApp: boolean;\r\n  IsGlobalApp: boolean;\r\n  IsInherited: boolean;\r\n  IsShared: boolean;\r\n  IsSiteApp: boolean;\r\n  Name: string;\r\n  Permissions: PermissionsCount;\r\n  SettingsScope: AppScope;\r\n  Url: string;\r\n  SharedUrl: string;\r\n}\r\n\r\nexport interface ApiKeySpecs {\r\n  NameId: string;\r\n  ApiKey: string;\r\n  IsDemo: boolean;\r\n}\r\n\r\nexport const AppScopes = {\r\n  App: 'App',\r\n  Site: 'Site',\r\n  Global: 'Global',\r\n} as const;\r\nexport type AppScope = typeof AppScopes[keyof typeof AppScopes];\r\n\r\nexport interface DialogContextEnable {\r\n  /** Determines if app admin should show app-permissions (true for Apps, false for Content and Global) */\r\n  AppPermissions?: boolean;\r\n  /** Determines if Code editing should be enabled (true for super-users) */\r\n  CodeEditor?: boolean;\r\n  DebugMode: boolean;\r\n  /** True if saving of formulas should be enabled (for edit-ui) */\r\n  FormulaSave?: boolean;\r\n  /** While debug is enabled, this allows some Edit Ui actions even when they are disabled in fields settings */\r\n  OverrideEditRestrictions?: boolean;\r\n  /** Determines if Queries should be enabled (true for Apps) */\r\n  Query?: boolean;\r\n}\r\n\r\nexport interface DialogContextLanguage {\r\n  Current: string;\r\n  List: Language[];\r\n  Primary: string;\r\n}\r\n\r\nexport interface DialogContextPage {\r\n  Id: number;\r\n}\r\n\r\nexport interface DialogContextSite {\r\n  DefaultApp: DialogContextSiteApp;\r\n  Id: number;\r\n  PrimaryApp: DialogContextSiteApp;\r\n  Url: string;\r\n}\r\n\r\nexport interface DialogContextSystem {\r\n  DefaultApp: DialogContextSiteApp;\r\n  PrimaryApp: DialogContextSiteApp;\r\n  Url: string;\r\n}\r\n\r\nexport interface DialogContextSiteApp {\r\n  ZoneId: number;\r\n  AppId: number;\r\n}\r\n\r\nexport interface DialogContextUser {\r\n  Email: string;\r\n  Id: number;\r\n  Guid: string;\r\n  IsAnonymous: boolean;\r\n  IsSiteAdmin: boolean;\r\n  IsContentAdmin: boolean;\r\n  IsSystemAdmin: boolean;\r\n  Name: string;\r\n  Username: string;\r\n}\r\n\r\n// export interface DialogContextFeature {\r\n//   NameId: string;\r\n//   Enabled: boolean;\r\n// }\r\n","import { Pipe, PipeTransform } from '@angular/core';\r\nimport { DomSanitizer } from '@angular/platform-browser';\r\n\r\n@Pipe({ name: 'safeResourceUrl' })\r\nexport class SafeResourceUrlPipe implements PipeTransform {\r\n\r\n  constructor(private sanitizer: DomSanitizer) { }\r\n\r\n  transform(resourceUrl: string) {\r\n    return this.sanitizer.bypassSecurityTrustResourceUrl(resourceUrl);\r\n  }\r\n}\r\n","import { Component, Input, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-getting-started',\r\n  templateUrl: './getting-started.component.html',\r\n  styleUrls: ['./getting-started.component.scss'],\r\n})\r\nexport class GettingStartedComponent implements OnInit {\r\n  @Input() gettingStartedUrl: string;\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n}\r\n","<iframe class=\"iframe\" [src]=\"gettingStartedUrl | safeResourceUrl\"></iframe>\r\n","<div class=\"actions-component\">\r\n  <div class=\"like-button highlight\" matRipple *ngIf=\"!contentType.EditInfo.ReadOnly || contentType.Properties\"\r\n    tippy=\"Description and more\" (click)=\"createOrEditMetadata()\">\r\n    <mat-icon>edit</mat-icon>\r\n  </div>\r\n  <div class=\"like-button disabled\" *ngIf=\"contentType.EditInfo.ReadOnly && !contentType.Properties\">\r\n    <mat-icon>edit</mat-icon>\r\n  </div>\r\n\r\n  <div class=\"like-button highlight\" matRipple *ngIf=\"!contentType.EditInfo.ReadOnly\" tippy=\"Metadata\"\r\n    (click)=\"openMetadata()\">\r\n    <mat-icon [matBadge]=\"contentType.Metadata.length\" matBadgePosition=\"below after\" matBadgeColor=\"accent\"\r\n      matBadgeSize=\"small\" [matBadgeHidden]=\"!contentType.Metadata.length\">local_offer</mat-icon>\r\n  </div>\r\n  <div class=\"like-button disabled\" *ngIf=\"contentType.EditInfo.ReadOnly\">\r\n    <mat-icon [matBadge]=\"contentType.Metadata.length\" matBadgePosition=\"below after\" matBadgeColor=\"accent\"\r\n      matBadgeSize=\"small\" matBadgeDisabled=\"true\" [matBadgeHidden]=\"!contentType.Metadata.length\">local_offer\r\n    </mat-icon>\r\n  </div>\r\n\r\n  <div class=\"like-button highlight\" matRipple *ngIf=\"!contentType.EditInfo.ReadOnly && enablePermissions\"\r\n    tippy=\"Permissions\" (click)=\"openPermissions()\">\r\n    <mat-icon [matBadge]=\"contentType.Permissions.Count\" matBadgePosition=\"below after\" matBadgeColor=\"accent\"\r\n      matBadgeSize=\"small\" [matBadgeHidden]=\"!contentType.Permissions.Count\">person</mat-icon>\r\n  </div>\r\n  <div class=\"like-button disabled\" *ngIf=\"contentType.EditInfo.ReadOnly || !enablePermissions\">\r\n    <mat-icon [matBadge]=\"contentType.Permissions.Count\" matBadgePosition=\"below after\" matBadgeColor=\"accent\"\r\n      matBadgeSize=\"small\" matBadgeDisabled=\"true\" [matBadgeHidden]=\"!contentType.Permissions.Count\">person</mat-icon>\r\n  </div>\r\n\r\n  <div class=\"like-button highlight\" matRipple tippy=\"More\" [matMenuTriggerFor]=\"menu\">\r\n    <mat-icon>more_horiz</mat-icon>\r\n  </div>\r\n</div>\r\n\r\n<mat-menu #menu=\"matMenu\" class=\"grid-more-menu\">\r\n  <ng-template matMenuContent>\r\n    <button mat-menu-item [disabled]=\"contentType.EditInfo.ReadOnly\" (click)=\"editContentType()\">\r\n      <mat-icon>settings</mat-icon>\r\n      <span>Rename</span>\r\n    </button>\r\n    <button mat-menu-item (click)=\"openRestApi()\">\r\n      <mat-icon svgIcon=\"code-curly\"></mat-icon>\r\n      <span>REST API</span>\r\n    </button>\r\n    <button mat-menu-item (click)=\"exportType()\">\r\n      <mat-icon>cloud_download</mat-icon>\r\n      <span>Export content type</span>\r\n    </button>\r\n    <button mat-menu-item (click)=\"openDataExport()\">\r\n      <mat-icon>cloud_download</mat-icon>\r\n      <span>Export data</span>\r\n    </button>\r\n    <button mat-menu-item (click)=\"openDataImport()\">\r\n      <mat-icon>cloud_upload</mat-icon>\r\n      <span>Import data</span>\r\n    </button>\r\n    <button mat-menu-item [disabled]=\"contentType.EditInfo.ReadOnly\" (click)=\"deleteContentType()\">\r\n      <mat-icon>delete</mat-icon>\r\n      <span>Delete</span>\r\n    </button>\r\n  </ng-template>\r\n</mat-menu>","import { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { ICellRendererParams } from '@ag-grid-community/core';\r\nimport { Component } from '@angular/core';\r\nimport { guidRegex } from '../../../shared/constants/guid.constants';\r\nimport { ContentType } from '../../models/content-type.model';\r\nimport { DataActionsParams } from './data-actions.models';\r\n\r\n@Component({\r\n  selector: 'app-data-actions',\r\n  templateUrl: './data-actions.component.html',\r\n  styleUrls: ['./data-actions.component.scss'],\r\n})\r\nexport class DataActionsComponent implements ICellRendererAngularComp {\r\n  contentType: ContentType;\r\n  enablePermissions: boolean;\r\n  private params: ICellRendererParams & DataActionsParams;\r\n\r\n  agInit(params: ICellRendererParams & DataActionsParams): void {\r\n    this.params = params;\r\n    this.contentType = this.params.data;\r\n    const enablePermissions = this.params.enablePermissionsGetter();\r\n    this.enablePermissions = enablePermissions && guidRegex().test(this.contentType.StaticName);\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n\r\n  createOrEditMetadata(): void {\r\n    this.params.onCreateOrEditMetadata(this.contentType);\r\n  }\r\n\r\n  openPermissions(): void {\r\n    this.params.onOpenPermissions(this.contentType);\r\n  }\r\n\r\n  editContentType(): void {\r\n    this.params.onEdit(this.contentType);\r\n  }\r\n\r\n  openMetadata(): void {\r\n    this.params.onOpenMetadata(this.contentType);\r\n  }\r\n\r\n  openRestApi(): void {\r\n    this.params.onOpenRestApi(this.contentType);\r\n  }\r\n\r\n  exportType(): void {\r\n    this.params.onTypeExport(this.contentType);\r\n  }\r\n\r\n  openDataExport(): void {\r\n    this.params.onOpenDataExport(this.contentType);\r\n  }\r\n\r\n  openDataImport(): void {\r\n    this.params.onOpenDataImport(this.contentType);\r\n  }\r\n\r\n  deleteContentType(): void {\r\n    this.params.onDelete(this.contentType);\r\n  }\r\n}\r\n","import { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { ICellRendererParams } from '@ag-grid-community/core';\r\nimport { Component } from '@angular/core';\r\nimport { ContentType } from '../../models/content-type.model';\r\nimport { DataFieldsParams } from './data-fields.models';\r\n\r\n@Component({\r\n  selector: 'app-data-fields',\r\n  templateUrl: './data-fields.component.html',\r\n  styleUrls: ['./data-fields.component.scss'],\r\n})\r\nexport class DataFieldsComponent implements ICellRendererAngularComp {\r\n  value: number;\r\n  tooltip: string;\r\n  icon: string;\r\n\r\n  private params: ICellRendererParams & DataFieldsParams;\r\n  private contentType: ContentType;\r\n\r\n  agInit(params: ICellRendererParams & DataFieldsParams): void {\r\n    this.params = params;\r\n    this.contentType = params.data;\r\n    this.value = params.value;\r\n    this.tooltip = !this.contentType.EditInfo.ReadOnly\r\n      ? 'Edit fields'\r\n      : `${this.contentType.EditInfo.ReadOnlyMessage ? `${this.contentType.EditInfo.ReadOnlyMessage}\\n\\n` : ''}This ContentType shares the definition of #${this.contentType.SharedDefId} so you can't edit it here. Read 2sxc.org/help?tag=shared-types`;\r\n    this.icon = !this.contentType.EditInfo.ReadOnly ? 'dns' : 'share';\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n\r\n  editFields(): void {\r\n    this.params.onEditFields(this.contentType);\r\n  }\r\n}\r\n","<div class=\"actions-component\">\r\n  <div class=\"like-button highlight\" matRipple [tippy]=\"tooltip\" (click)=\"editFields()\">\r\n    <mat-icon [matBadge]=\"value\" matBadgePosition=\"below after\" matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadgeHidden]=\"!value\">\r\n      {{icon}}\r\n    </mat-icon>\r\n  </div>\r\n</div>\r\n","import { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { ICellRendererParams } from '@ag-grid-community/core';\r\nimport { Component } from '@angular/core';\r\nimport { ContentType } from '../../models';\r\nimport { DataItemsParams } from './data-items.models';\r\n\r\n@Component({\r\n  selector: 'app-data-items',\r\n  templateUrl: './data-items.component.html',\r\n  styleUrls: ['./data-items.component.scss'],\r\n})\r\nexport class DataItemsComponent implements ICellRendererAngularComp {\r\n  value: number;\r\n  private params: DataItemsParams;\r\n  private contentType: ContentType;\r\n\r\n  agInit(params: ICellRendererParams & DataItemsParams): void {\r\n    this.params = params;\r\n    this.contentType = params.data;\r\n    this.value = params.value;\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n\r\n  showItems(): void {\r\n    this.params.onShowItems(this.contentType);\r\n  }\r\n\r\n  addItem(): void {\r\n    this.params.onAddItem(this.contentType);\r\n  }\r\n}\r\n","<div class=\"actions-component\">\r\n  <div class=\"like-button highlight\" matRipple tippy=\"{{ value }} items\" (click)=\"showItems()\">\r\n    <div class=\"text-icon\">{{ value }}</div>\r\n  </div>\r\n\r\n  <div class=\"like-button highlight\" matRipple tippy=\"Add item\" (click)=\"addItem()\">\r\n    <mat-icon>add</mat-icon>\r\n  </div>\r\n</div>","<div class=\"grid-wrapper mat-tab-grid-wrapper\" *ngIf=\"viewModel$ | async as vm\">\r\n  <ag-grid-angular class=\"ag-theme-material\" [rowData]=\"vm.contentTypes\" [gridOptions]=\"gridOptions\"\r\n    appDragAndDrop [allowedFileTypes]=\"'xml,json'\" (filesDropped)=\"filesDropped($event)\">\r\n  </ag-grid-angular>\r\n\r\n  <div class=\"grid-more-actions-box\">\r\n    <mat-form-field appearance=\"standard\" color=\"accent\" class=\"scope-dropdown\">\r\n      <mat-select [ngModel]=\"vm.scope\" name=\"Scope\" (ngModelChange)=\"changeScope($event)\">\r\n        <mat-option *ngFor=\"let scopeOption of (vm.scopeOptions)\" [value]=\"scopeOption.value\">\r\n          {{ 'Scope: ' + scopeOption.name }}\r\n        </mat-option>\r\n        <mat-option [value]=\"dropdownInsertValue\">Scope: Other...</mat-option>\r\n      </mat-select>\r\n    </mat-form-field>\r\n\r\n    <button mat-button tippy=\"Import content type\" (click)=\"importType()\">\r\n      <mat-icon>cloud_upload</mat-icon>\r\n      <span>Content Type</span>\r\n    </button>\r\n\r\n    <button mat-button color=\"accent\" tippy=\"Create a ghost content type\" *ngIf=\"vm.debugEnabled\"\r\n      (click)=\"createGhost()\">\r\n      <mat-icon>share</mat-icon>\r\n      <span>Ghost</span>\r\n    </button>\r\n  </div>\r\n\r\n  <button mat-fab mat-elevation-z24 class=\"grid-fab\" tippy=\"Create a new content type\" (click)=\"editContentType(null)\">\r\n    <mat-icon>add</mat-icon>\r\n  </button>\r\n</div>","import { GridOptions } from '@ag-grid-community/core';\r\nimport { Component, Input, OnDestroy, OnInit } from '@angular/core';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { ActivatedRoute, NavigationEnd, Router } from '@angular/router';\r\nimport { BehaviorSubject, combineLatest, distinctUntilChanged, filter, from, map, startWith, take } from 'rxjs';\r\nimport { ContentExportService } from '../../content-export/services/content-export.service';\r\nimport { ContentImportDialogData } from '../../content-import/content-import-dialog.config';\r\nimport { GoToDevRest } from '../../dev-rest/go-to-dev-rest';\r\nimport { GlobalConfigService } from '../../edit/shared/store/ngrx-data';\r\nimport { GoToMetadata } from '../../metadata';\r\nimport { GoToPermissions } from '../../permissions/go-to-permissions';\r\nimport { BaseComponent } from '../../shared/components/base-component/base.component';\r\nimport { FileUploadDialogData } from '../../shared/components/file-upload-dialog';\r\nimport { IdFieldComponent } from '../../shared/components/id-field/id-field.component';\r\nimport { IdFieldParams } from '../../shared/components/id-field/id-field.models';\r\nimport { defaultGridOptions } from '../../shared/constants/default-grid-options.constants';\r\nimport { dropdownInsertValue } from '../../shared/constants/dropdown-insert-value.constant';\r\nimport { eavConstants, ScopeOption } from '../../shared/constants/eav.constants';\r\nimport { toString } from '../../shared/helpers/file-to-base64.helper';\r\nimport { convertFormToUrl } from '../../shared/helpers/url-prep.helper';\r\nimport { EditForm } from '../../shared/models/edit-form.model';\r\nimport { ContentType } from '../models/content-type.model';\r\nimport { ContentTypesService } from '../services/content-types.service';\r\nimport { DataActionsComponent } from './data-actions/data-actions.component';\r\nimport { DataActionsParams } from './data-actions/data-actions.models';\r\nimport { DataFieldsComponent } from './data-fields/data-fields.component';\r\nimport { DataFieldsParams } from './data-fields/data-fields.models';\r\nimport { DataItemsComponent } from './data-items/data-items.component';\r\nimport { DataItemsParams } from './data-items/data-items.models';\r\n\r\n@Component({\r\n  selector: 'app-data',\r\n  templateUrl: './data.component.html',\r\n  styleUrls: ['./data.component.scss'],\r\n})\r\nexport class DataComponent extends BaseComponent implements OnInit, OnDestroy {\r\n  @Input() enablePermissions: boolean;\r\n\r\n  contentTypes$ = new BehaviorSubject<ContentType[]>(undefined);\r\n  scope$ = new BehaviorSubject<string>(undefined);\r\n  scopeOptions$ = new BehaviorSubject<ScopeOption[]>([]);\r\n  gridOptions = this.buildGridOptions();\r\n  dropdownInsertValue = dropdownInsertValue;\r\n\r\n  viewModel$ = combineLatest([this.contentTypes$, this.scope$, this.scopeOptions$, this.globalConfigService.getDebugEnabled$()]).pipe(\r\n    map(([contentTypes, scope, scopeOptions, debugEnabled]) =>\r\n      ({ contentTypes, scope, scopeOptions, debugEnabled })),\r\n  );\r\n\r\n  constructor(\r\n    protected router: Router,\r\n    protected route: ActivatedRoute,\r\n    private contentTypesService: ContentTypesService,\r\n    private globalConfigService: GlobalConfigService,\r\n    private snackBar: MatSnackBar,\r\n    private contentExportService: ContentExportService,\r\n  ) { \r\n    super(router, route);\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.fetchScopes();\r\n    this.refreshScopeOnRouteChange();\r\n    this.subscription.add(this.refreshOnChildClosedDeep().subscribe(() => { this.fetchContentTypes(); }));\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.contentTypes$.complete();\r\n    this.scope$.complete();\r\n    this.scopeOptions$.complete();\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  filesDropped(files: File[]) {\r\n    const importFile = files[0];\r\n    const ext = importFile.name.substring(importFile.name.lastIndexOf('.') + 1).toLocaleLowerCase();\r\n    switch (ext) {\r\n      case 'xml':\r\n        from(toString(files[0])).pipe(take(1)).subscribe(fileString => {\r\n          const contentTypeName = fileString.split('<Entity Type=\"')[1]?.split('\"')[0];\r\n          const contentType = this.contentTypes$.value.find(ct => ct.Name === contentTypeName);\r\n          if (contentType == null) {\r\n            const message = `Cannot find Content Type named '${contentTypeName}'. Please open Content Type Import dialog manually.`;\r\n            this.snackBar.open(message, null, { duration: 5000 });\r\n            return;\r\n          }\r\n          this.openDataImport(contentType, files);\r\n        });\r\n        break;\r\n      case 'json':\r\n        this.importType(files);\r\n        break;\r\n    }\r\n  }\r\n\r\n  importType(files?: File[]) {\r\n    const dialogData: FileUploadDialogData = { files };\r\n    this.router.navigate(['import'], { relativeTo: this.route.firstChild, state: dialogData });\r\n  }\r\n\r\n  private showContentItems(contentType: ContentType) {\r\n    this.router.navigate([`items/${contentType.StaticName}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  editContentType(contentType: ContentType) {\r\n    if (!contentType) {\r\n      this.router.navigate(['add'], { relativeTo: this.route.firstChild });\r\n    } else {\r\n      if (contentType.EditInfo.ReadOnly) { return; }\r\n      this.router.navigate([`${contentType.StaticName}/edit`], { relativeTo: this.route.firstChild });\r\n    }\r\n  }\r\n\r\n  private fetchContentTypes() {\r\n    this.contentTypesService.retrieveContentTypes(this.scope$.value).subscribe(contentTypes => {\r\n      for (const contentType of contentTypes) {\r\n        contentType._compareLabel = contentType.Label.replace(/\\p{Emoji}/gu, 'ž');\r\n      }\r\n      this.contentTypes$.next(contentTypes);\r\n      if (this.scope$.value !== eavConstants.scopes.default.value) {\r\n        const message = 'Warning! You are in a special scope. Changing things here could easily break functionality';\r\n        this.snackBar.open(message, null, { duration: 2000 });\r\n      }\r\n    });\r\n  }\r\n\r\n  private fetchScopes() {\r\n    this.contentTypesService.getScopes().subscribe(scopeOptions => {\r\n      const newScopes = [...this.scopeOptions$.value];\r\n      scopeOptions.forEach(scopeOption => {\r\n        const existing = newScopes.find(scope => scope.value === scopeOption.value);\r\n        if (existing) {\r\n          existing.name = scopeOption.name;\r\n        } else {\r\n          newScopes.push(scopeOption);\r\n        }\r\n      });\r\n      this.scopeOptions$.next(newScopes);\r\n    });\r\n  }\r\n\r\n  createGhost() {\r\n    const sourceName = window.prompt('To create a ghost content-type enter source static name / id - this is a very advanced operation - read more about it on 2sxc.org/help?tag=ghost');\r\n    if (!sourceName) { return; }\r\n    this.snackBar.open('Saving...');\r\n    this.contentTypesService.createGhost(sourceName).subscribe(res => {\r\n      this.snackBar.open('Saved', null, { duration: 2000 });\r\n      this.fetchContentTypes();\r\n    });\r\n  }\r\n\r\n  changeScope(newScope: string) {\r\n    if (newScope === dropdownInsertValue) {\r\n      newScope = prompt('This is an advanced feature to show content-types of another scope. Don\\'t use this if you don\\'t know what you\\'re doing, as content-types of other scopes are usually hidden for a good reason.') || eavConstants.scopes.default.value;\r\n    }\r\n    this.router.navigate([`data/${newScope}`], { relativeTo: this.route });\r\n  }\r\n\r\n  private enablePermissionsGetter() {\r\n    return this.enablePermissions;\r\n  }\r\n\r\n  private addItem(contentType: ContentType) {\r\n    const form: EditForm = {\r\n      items: [{ ContentTypeName: contentType.StaticName }],\r\n    };\r\n    const formUrl = convertFormToUrl(form);\r\n    this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private editFields(contentType: ContentType) {\r\n    this.router.navigate([`fields/${contentType.StaticName}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private createOrEditMetadata(contentType: ContentType) {\r\n    const form: EditForm = {\r\n      items: [\r\n        !contentType.Properties\r\n          ? {\r\n            ContentTypeName: eavConstants.contentTypes.contentType,\r\n            For: {\r\n              Target: eavConstants.metadata.contentType.target,\r\n              TargetType: eavConstants.metadata.contentType.targetType,\r\n              String: contentType.StaticName,\r\n            },\r\n            Prefill: { Label: contentType.Name, Description: contentType.Description },\r\n          }\r\n          : { EntityId: contentType.Properties.Id }\r\n      ],\r\n    };\r\n    const formUrl = convertFormToUrl(form);\r\n    this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private openMetadata(contentType: ContentType) {\r\n    const url = GoToMetadata.getUrlContentType(\r\n      contentType.StaticName,\r\n      `Metadata for Content Type: ${contentType.Name} (${contentType.Id})`,\r\n    );\r\n    this.router.navigate([url], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private openRestApi(contentType: ContentType) {\r\n    this.router.navigate([GoToDevRest.getUrlData(contentType)], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private exportType(contentType: ContentType) {\r\n    this.contentExportService.exportJson(contentType.StaticName);\r\n  }\r\n\r\n  private openDataExport(contentType: ContentType) {\r\n    this.router.navigate([`export/${contentType.StaticName}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private openDataImport(contentType: ContentType, files?: File[]) {\r\n    const contentImportData: ContentImportDialogData = { files };\r\n    this.router.navigate([`${contentType.StaticName}/import`], { relativeTo: this.route.firstChild, state: contentImportData });\r\n  }\r\n\r\n  private openPermissions(contentType: ContentType) {\r\n    this.router.navigate([GoToPermissions.getUrlContentType(contentType.StaticName)], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private deleteContentType(contentType: ContentType) {\r\n    if (!confirm(`Are you sure you want to delete '${contentType.Name}' (${contentType.Id})?`)) { return; }\r\n    this.snackBar.open('Deleting...');\r\n    this.contentTypesService.delete(contentType).subscribe(result => {\r\n      this.snackBar.open('Deleted', null, { duration: 2000 });\r\n      this.fetchContentTypes();\r\n    });\r\n  }\r\n\r\n  private refreshScopeOnRouteChange() {\r\n    this.subscription.add(\r\n      this.router.events.pipe(\r\n        filter(event => event instanceof NavigationEnd),\r\n        map(() => this.route.snapshot.firstChild.paramMap.get('scope')),\r\n        startWith(this.route.snapshot.firstChild.paramMap.get('scope')),\r\n        filter(scope => !!scope),\r\n        distinctUntilChanged(),\r\n      ).subscribe(scope => {\r\n        this.scope$.next(scope);\r\n        if (!this.scopeOptions$.value.map(option => option.value).includes(scope)) {\r\n          const newScopeOption: ScopeOption = {\r\n            name: scope,\r\n            value: scope,\r\n          };\r\n          this.scopeOptions$.next([...this.scopeOptions$.value, newScopeOption]);\r\n        }\r\n        this.fetchContentTypes();\r\n      })\r\n    );\r\n  }\r\n\r\n  private buildGridOptions(): GridOptions {\r\n    const gridOptions: GridOptions = {\r\n      ...defaultGridOptions,\r\n      columnDefs: [\r\n        {\r\n          headerName: 'ID',\r\n          field: 'Id',\r\n          width: 70,\r\n          headerClass: 'dense',\r\n          sortable: true,\r\n          filter: 'agNumberColumnFilter',\r\n          cellClass: (params) => {\r\n            const contentType: ContentType = params.data;\r\n            return `id-action no-padding no-outline ${contentType.EditInfo.ReadOnly ? 'disabled' : ''}`.split(' ');\r\n          },\r\n          valueGetter: (params) => {\r\n            const contentType: ContentType = params.data;\r\n            return contentType.Id;\r\n          },\r\n          cellRenderer: IdFieldComponent,\r\n          cellRendererParams: (() => {\r\n            const params: IdFieldParams<ContentType> = {\r\n              tooltipGetter: (contentType) => `ID: ${contentType.Id}\\nGUID: ${contentType.StaticName}`,\r\n            };\r\n            return params;\r\n          })(),\r\n        },\r\n        {\r\n          headerName: 'Content Type',\r\n          field: 'ContentType',\r\n          flex: 3,\r\n          minWidth: 250,\r\n          cellClass: 'primary-action highlight'.split(' '),\r\n          sortable: true,\r\n          sort: 'asc',\r\n          filter: 'agTextColumnFilter',\r\n          onCellClicked: (params) => {\r\n            const contentType: ContentType = params.data;\r\n            this.showContentItems(contentType);\r\n          },\r\n          valueGetter: (params) => {\r\n            const contentType: ContentType = params.data;\r\n            return contentType.Label;\r\n          },\r\n          comparator: (valueA, valueB, nodeA, nodeB, isInverted) => {\r\n            const contentTypeA: ContentType = nodeA.data;\r\n            const contentTypeB: ContentType = nodeB.data;\r\n            return contentTypeA._compareLabel.localeCompare(contentTypeB._compareLabel);\r\n          },\r\n        },\r\n        {\r\n          field: 'Items',\r\n          width: 102,\r\n          headerClass: 'dense',\r\n          cellClass: 'secondary-action no-padding'.split(' '),\r\n          sortable: true,\r\n          filter: 'agNumberColumnFilter',\r\n          valueGetter: (params) => {\r\n            const contentType: ContentType = params.data;\r\n            return contentType.Items;\r\n          },\r\n          cellRenderer: DataItemsComponent,\r\n          cellRendererParams: (() => {\r\n            const params: DataItemsParams = {\r\n              onShowItems: (contentType) => this.showContentItems(contentType),\r\n              onAddItem: (contentType) => this.addItem(contentType),\r\n            };\r\n            return params;\r\n          })(),\r\n        },\r\n        {\r\n          field: 'Fields',\r\n          width: 94,\r\n          headerClass: 'dense',\r\n          cellClass: 'secondary-action no-padding'.split(' '),\r\n          sortable: true,\r\n          filter: 'agNumberColumnFilter',\r\n          valueGetter: (params) => {\r\n            const contentType: ContentType = params.data;\r\n            return contentType.Fields;\r\n          },\r\n          cellRenderer: DataFieldsComponent,\r\n          cellRendererParams: (() => {\r\n            const params: DataFieldsParams = {\r\n              onEditFields: (contentType) => this.editFields(contentType),\r\n            };\r\n            return params;\r\n          })(),\r\n        },\r\n        {\r\n          field: 'Name',\r\n          flex: 1,\r\n          minWidth: 100,\r\n          sortable: true,\r\n          filter: 'agTextColumnFilter',\r\n          cellClass: (params) => {\r\n            const contentType: ContentType = params.data;\r\n            return `${contentType.EditInfo.ReadOnly ? 'no-outline' : 'primary-action highlight'}`.split(' ');\r\n          },\r\n          valueGetter: (params) => {\r\n            const contentType: ContentType = params.data;\r\n            return contentType.Name;\r\n          },\r\n          onCellClicked: (params) => {\r\n            const contentType: ContentType = params.data;\r\n            this.editContentType(contentType);\r\n          },\r\n        },\r\n        {\r\n          field: 'Description',\r\n          flex: 3,\r\n          minWidth: 250,\r\n          cellClass: 'no-outline',\r\n          sortable: true,\r\n          filter: 'agTextColumnFilter',\r\n          valueGetter: (params) => {\r\n            const contentType: ContentType = params.data;\r\n            return contentType.Properties?.Description;\r\n          },\r\n        },\r\n        {\r\n          width: 162,\r\n          cellClass: 'secondary-action no-padding'.split(' '),\r\n          pinned: 'right',\r\n          cellRenderer: DataActionsComponent,\r\n          cellRendererParams: (() => {\r\n            const params: DataActionsParams = {\r\n              enablePermissionsGetter: () => this.enablePermissionsGetter(),\r\n              onCreateOrEditMetadata: (contentType) => this.createOrEditMetadata(contentType),\r\n              onOpenPermissions: (contentType) => this.openPermissions(contentType),\r\n              onEdit: (contentType) => this.editContentType(contentType),\r\n              onOpenRestApi: (contentType) => this.openRestApi(contentType),\r\n              onOpenMetadata: (contentType) => this.openMetadata(contentType),\r\n              onTypeExport: (contentType) => this.exportType(contentType),\r\n              onOpenDataExport: (contentType) => this.openDataExport(contentType),\r\n              onOpenDataImport: (contentType) => this.openDataImport(contentType),\r\n              onDelete: (contentType) => this.deleteContentType(contentType),\r\n            };\r\n            return params;\r\n          })(),\r\n        },\r\n      ],\r\n    };\r\n    return gridOptions;\r\n  }\r\n}\r\n","import { Query } from '../../models/query.model';\r\nimport { IAgActions } from '../ag-actions';\r\n\r\n// Test 2dm 2020-11-20 - I believe the current model has way too much ceremony\r\n// I need to change ca. 10 places just to get one more action to work\r\n// that's not great\r\nexport enum QueryActions {\r\n  Edit,\r\n  Metadata,\r\n  Rest,\r\n  Clone,\r\n  Permissions,\r\n  Export,\r\n  Delete,\r\n}\r\n\r\nexport interface QueriesActionsParams extends IAgActions<QueryActions, Query> {\r\n  getEnablePermissions(): boolean;\r\n}\r\n","<div class=\"actions-component\">\r\n  <div class=\"like-button highlight\" matRipple tippy=\"Edit\" (click)=\"params.do(actions.Edit, item)\">\r\n    <mat-icon>edit</mat-icon>\r\n  </div>\r\n\r\n  <div class=\"like-button highlight\" matRipple *ngIf=\"!item._EditInfo.ReadOnly\" tippy=\"Metadata\"\r\n    (click)=\"params.do(actions.Metadata, item)\">\r\n    <mat-icon [matBadge]=\"item.Metadata?.length\" matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n      [matBadgeHidden]=\"!item.Metadata?.length\" matBadgePosition=\"below after\">local_offer</mat-icon>\r\n  </div>\r\n  <div class=\"like-button disabled\" *ngIf=\"item._EditInfo.ReadOnly\">\r\n    <mat-icon [matBadge]=\"item.Metadata?.length\" matBadgeColor=\"accent\" matBadgeSize=\"small\" matBadgeDisabled=\"true\"\r\n      [matBadgeHidden]=\"!item.Metadata?.length\" matBadgePosition=\"below after\">local_offer</mat-icon>\r\n  </div>\r\n\r\n  <div class=\"like-button highlight\" matRipple *ngIf=\"!item._EditInfo.ReadOnly && enablePermissions\" tippy=\"Permissions\"\r\n    (click)=\"params.do(actions.Permissions, item)\">\r\n    <mat-icon [matBadge]=\"item._Permissions.Count\" matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n      [matBadgeHidden]=\"!item._Permissions.Count\" matBadgePosition=\"below after\">person</mat-icon>\r\n  </div>\r\n  <div class=\"like-button disabled\" *ngIf=\"item._EditInfo.ReadOnly || !enablePermissions\">\r\n    <mat-icon [matBadge]=\"item._Permissions.Count\" matBadgeColor=\"accent\" matBadgeSize=\"small\" matBadgeDisabled=\"true\"\r\n      [matBadgeHidden]=\"!item._Permissions.Count\" matBadgePosition=\"below after\">person</mat-icon>\r\n  </div>\r\n\r\n  <div class=\"like-button highlight\" matRipple tippy=\"More\" [matMenuTriggerFor]=\"menu\">\r\n    <mat-icon>more_horiz</mat-icon>\r\n  </div>\r\n</div>\r\n\r\n<mat-menu #menu=\"matMenu\" class=\"grid-more-menu\">\r\n  <ng-template matMenuContent>\r\n    <button mat-menu-item (click)=\"params.do(actions.Rest, item)\">\r\n      <mat-icon svgIcon=\"code-curly\"></mat-icon>\r\n      <span>REST API</span>\r\n    </button>\r\n    <button mat-menu-item (click)=\"params.do(actions.Clone, item)\">\r\n      <mat-icon>file_copy</mat-icon>\r\n      <span>Copy</span>\r\n    </button>\r\n    <button mat-menu-item (click)=\" params.do(actions.Export, item)\">\r\n      <mat-icon>cloud_download</mat-icon>\r\n      <span>Export</span>\r\n    </button>\r\n    <button mat-menu-item [disabled]=\"item._EditInfo.ReadOnly\" (click)=\"params.do(actions.Delete, item)\">\r\n      <mat-icon>delete</mat-icon>\r\n      <span>Delete</span>\r\n    </button>\r\n  </ng-template>\r\n</mat-menu>","import { ICellRendererParams } from '@ag-grid-community/core';\r\nimport { Component } from '@angular/core';\r\nimport { Query } from '../../models/query.model';\r\nimport { AgActionsComponent } from '../ag-actions';\r\nimport { QueriesActionsParams, QueryActions } from './queries-actions';\r\n\r\n@Component({\r\n  selector: 'app-queries-actions',\r\n  templateUrl: './queries-actions.component.html',\r\n})\r\nexport class QueriesActionsComponent extends AgActionsComponent<ICellRendererParams & QueriesActionsParams, Query> {\r\n  enablePermissions: boolean;\r\n  actions = QueryActions;\r\n\r\n  agInit(params: ICellRendererParams & QueriesActionsParams): void {\r\n    super.agInit(params);\r\n    this.enablePermissions = this.params.getEnablePermissions();\r\n  }\r\n}\r\n","import { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { ICellRendererParams } from '@ag-grid-community/core';\r\n\r\nexport class AgActionsComponent<TParams extends ICellRendererParams, TData> implements ICellRendererAngularComp {\r\n  item: TData;\r\n  params: TParams;\r\n\r\n  agInit(params: TParams): void {\r\n    this.params = params;\r\n    this.item = this.params.data;\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n}\r\n","<div class=\"grid-wrapper mat-tab-grid-wrapper\" *ngIf=\"viewModel$ | async as vm\">\r\n  <ag-grid-angular class=\"ag-theme-material\" [rowData]=\"vm.queries\" [gridOptions]=\"gridOptions\" appDragAndDrop\r\n    [allowedFileTypes]=\"'json'\" (filesDropped)=\"importQuery($event)\">\r\n  </ag-grid-angular>\r\n\r\n  <div class=\"grid-more-actions-box\">\r\n    <button mat-button tippy=\"Import query\" (click)=\"importQuery()\">\r\n      <mat-icon>cloud_upload</mat-icon>\r\n      <span>Query</span>\r\n    </button>\r\n  </div>\r\n\r\n  <button mat-fab mat-elevation-z24 class=\"grid-fab\" tippy=\"Create a new query\" (click)=\"editQuery(null)\">\r\n    <mat-icon>add</mat-icon>\r\n  </button>\r\n</div>","import { GridOptions } from '@ag-grid-community/core';\r\nimport { Component, Input, OnDestroy, OnInit } from '@angular/core';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { BehaviorSubject, combineLatest, map } from 'rxjs';\r\nimport { ContentExportService } from '../../content-export/services/content-export.service';\r\nimport { GoToDevRest } from '../../dev-rest/go-to-dev-rest';\r\nimport { GoToMetadata } from '../../metadata';\r\nimport { GoToPermissions } from '../../permissions/go-to-permissions';\r\nimport { BaseComponent } from '../../shared/components/base-component/base.component';\r\nimport { FileUploadDialogData } from '../../shared/components/file-upload-dialog';\r\nimport { IdFieldComponent } from '../../shared/components/id-field/id-field.component';\r\nimport { IdFieldParams } from '../../shared/components/id-field/id-field.models';\r\nimport { defaultGridOptions } from '../../shared/constants/default-grid-options.constants';\r\nimport { eavConstants } from '../../shared/constants/eav.constants';\r\nimport { convertFormToUrl } from '../../shared/helpers/url-prep.helper';\r\nimport { EditForm } from '../../shared/models/edit-form.model';\r\nimport { DialogService } from '../../shared/services/dialog.service';\r\nimport { Query } from '../models/query.model';\r\nimport { PipelinesService } from '../services/pipelines.service';\r\nimport { QueriesActionsParams, QueryActions } from './queries-actions/queries-actions';\r\nimport { QueriesActionsComponent } from './queries-actions/queries-actions.component';\r\n\r\n@Component({\r\n  selector: 'app-queries',\r\n  templateUrl: './queries.component.html',\r\n  styleUrls: ['./queries.component.scss'],\r\n})\r\nexport class QueriesComponent extends BaseComponent implements OnInit, OnDestroy {\r\n  @Input() enablePermissions: boolean;\r\n\r\n  queries$ = new BehaviorSubject<Query[]>(undefined);\r\n  gridOptions = this.buildGridOptions();\r\n\r\n  viewModel$ = combineLatest([this.queries$]).pipe(\r\n    map(([queries]) => ({ queries }))\r\n  );\r\n\r\n  constructor(\r\n    protected router: Router,\r\n    protected route: ActivatedRoute,\r\n    private pipelinesService: PipelinesService,\r\n    private contentExportService: ContentExportService,\r\n    private snackBar: MatSnackBar,\r\n    private dialogService: DialogService,\r\n  ) {\r\n    super(router, route);\r\n   }\r\n\r\n  ngOnInit() {\r\n    this.fetchQueries();\r\n    this.subscription.add(this.refreshOnChildClosedDeep().subscribe(() => { this.fetchQueries(); }));\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.queries$.complete();\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  private fetchQueries() {\r\n    this.pipelinesService.getAll(eavConstants.contentTypes.query).subscribe((queries: Query[]) => {\r\n      this.queries$.next(queries);\r\n    });\r\n  }\r\n\r\n  importQuery(files?: File[]) {\r\n    const dialogData: FileUploadDialogData = { files };\r\n    this.router.navigate(['import'], { relativeTo: this.route.firstChild, state: dialogData });\r\n  }\r\n\r\n  /**\r\n   * Experiment by 2dm 2020-11-20 - trying to reduce the ceremony around menus\r\n   * Once this works, we would then remove all the 3-line functions below, as they\r\n   * would just be added here (if that's the only place they are used)\r\n   */\r\n  private doMenuAction(action: QueryActions, query: Query) {\r\n    switch (action) {\r\n      case QueryActions.Edit:\r\n        return this.editQuery(query);\r\n      case QueryActions.Metadata:\r\n        return this.openMetadata(query);\r\n      case QueryActions.Rest:\r\n        return this.router.navigate([GoToDevRest.getUrlQuery(query.Guid)], { relativeTo: this.route.firstChild });\r\n      case QueryActions.Clone:\r\n        return this.cloneQuery(query);\r\n      case QueryActions.Permissions:\r\n        return this.openPermissions(query);\r\n      case QueryActions.Export:\r\n        return this.exportQuery(query);\r\n      case QueryActions.Delete:\r\n        return this.deleteQuery(query);\r\n    }\r\n  }\r\n\r\n  editQuery(query: Query) {\r\n    const form: EditForm = {\r\n      items: [\r\n        query == null\r\n          ? {\r\n            ContentTypeName: eavConstants.contentTypes.query,\r\n            Prefill: { TestParameters: eavConstants.pipelineDesigner.testParameters }\r\n          }\r\n          : { EntityId: query.Id }\r\n      ],\r\n    };\r\n    const formUrl = convertFormToUrl(form);\r\n    this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private enablePermissionsGetter() {\r\n    return this.enablePermissions;\r\n  }\r\n\r\n  private openVisualQueryDesigner(query: Query) {\r\n    if (query._EditInfo.ReadOnly) { return; }\r\n    this.dialogService.openQueryDesigner(query.Id);\r\n  }\r\n\r\n  private openMetadata(query: Query) {\r\n    const url = GoToMetadata.getUrlEntity(\r\n      query.Guid,\r\n      `Metadata for Query: ${query.Name} (${query.Id})`,\r\n    );\r\n    this.router.navigate([url], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private cloneQuery(query: Query) {\r\n    this.snackBar.open('Copying...');\r\n    this.pipelinesService.clonePipeline(query.Id).subscribe(() => {\r\n      this.snackBar.open('Copied', null, { duration: 2000 });\r\n      this.fetchQueries();\r\n    });\r\n  }\r\n\r\n  private openPermissions(query: Query) {\r\n    this.router.navigate([GoToPermissions.getUrlEntity(query.Guid)], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private exportQuery(query: Query) {\r\n    this.contentExportService.exportEntity(query.Id, 'Query', true);\r\n  }\r\n\r\n  private deleteQuery(query: Query) {\r\n    if (!confirm(`Delete Pipeline '${query.Name}' (${query.Id})?`)) { return; }\r\n    this.snackBar.open('Deleting...');\r\n    this.pipelinesService.delete(query.Id).subscribe(res => {\r\n      this.snackBar.open('Deleted', null, { duration: 2000 });\r\n      this.fetchQueries();\r\n    });\r\n  }\r\n\r\n  private buildGridOptions(): GridOptions {\r\n    const gridOptions: GridOptions = {\r\n      ...defaultGridOptions,\r\n      columnDefs: [\r\n        {\r\n          headerName: 'ID',\r\n          field: 'Id',\r\n          width: 70,\r\n          headerClass: 'dense',\r\n          sortable: true,\r\n          filter: 'agNumberColumnFilter',\r\n          cellClass: (params) => {\r\n            const query: Query = params.data;\r\n            return `id-action no-padding no-outline ${query._EditInfo.ReadOnly ? 'disabled' : ''}`.split(' ');\r\n          },\r\n          valueGetter: (params) => {\r\n            const query: Query = params.data;\r\n            return query.Id;\r\n          },\r\n          cellRenderer: IdFieldComponent,\r\n          cellRendererParams: (() => {\r\n            const params: IdFieldParams<Query> = {\r\n              tooltipGetter: (query) => `ID: ${query.Id}\\nGUID: ${query.Guid}`,\r\n            };\r\n            return params;\r\n          })(),\r\n        },\r\n        {\r\n          field: 'Name',\r\n          flex: 2,\r\n          minWidth: 250,\r\n          sortable: true,\r\n          sort: 'asc',\r\n          filter: 'agTextColumnFilter',\r\n          cellClass: (params) => {\r\n            const query: Query = params.data;\r\n            return `${query._EditInfo.ReadOnly ? 'no-outline' : 'primary-action highlight'}`.split(' ');\r\n          },\r\n          onCellClicked: (params) => {\r\n            const query: Query = params.data;\r\n            this.openVisualQueryDesigner(query);\r\n          },\r\n          valueGetter: (params) => {\r\n            const query: Query = params.data;\r\n            return query.Name;\r\n          },\r\n        },\r\n        {\r\n          field: 'Description',\r\n          flex: 2,\r\n          minWidth: 250,\r\n          cellClass: 'no-outline',\r\n          sortable: true,\r\n          filter: 'agTextColumnFilter',\r\n          valueGetter: (params) => {\r\n            const query: Query = params.data;\r\n            return query.Description;\r\n          },\r\n        },\r\n        {\r\n          width: 162,\r\n          cellClass: 'secondary-action no-padding'.split(' '),\r\n          pinned: 'right',\r\n          cellRenderer: QueriesActionsComponent,\r\n          cellRendererParams: (() => {\r\n            const params: QueriesActionsParams = {\r\n              getEnablePermissions: () => this.enablePermissionsGetter(),\r\n              do: (action, query) => this.doMenuAction(action, query),\r\n            };\r\n            return params;\r\n          })(),\r\n        },\r\n      ],\r\n    };\r\n    return gridOptions;\r\n  }\r\n}\r\n","<div class=\"actions-component\">\r\n  <div class=\"like-button highlight\" matRipple *ngIf=\"!view.EditInfo.ReadOnly && enableCode\" tippy=\"Code\"\r\n    (click)=\"openCode()\">\r\n    <mat-icon>code</mat-icon>\r\n  </div>\r\n  <div class=\"like-button disabled\" *ngIf=\"view.EditInfo.ReadOnly || !enableCode\">\r\n    <mat-icon>code</mat-icon>\r\n  </div>\r\n\r\n  <div class=\"like-button highlight\" matRipple *ngIf=\"!view.EditInfo.ReadOnly\" tippy=\"Metadata\"\r\n    (click)=\"openMetadata()\">\r\n    <mat-icon [matBadge]=\"view.Metadata.length\" matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n      [matBadgeHidden]=\"!view.Metadata.length\" matBadgePosition=\"below after\">local_offer</mat-icon>\r\n  </div>\r\n  <div class=\"like-button disabled\" *ngIf=\"view.EditInfo.ReadOnly\">\r\n    <mat-icon [matBadge]=\"view.Metadata.length\" matBadgeColor=\"accent\" matBadgeSize=\"small\" matBadgeDisabled=\"true\"\r\n      [matBadgeHidden]=\"!view.Metadata.length\" matBadgePosition=\"below after\">local_offer</mat-icon>\r\n  </div>\r\n\r\n  <div class=\"like-button highlight\" matRipple *ngIf=\"!view.EditInfo.ReadOnly && enablePermissions\" tippy=\"Permissions\"\r\n    (click)=\"openPermissions()\">\r\n    <mat-icon [matBadge]=\"view.Permissions.Count\" matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n      [matBadgeHidden]=\"!view.Permissions.Count\" matBadgePosition=\"below after\">person</mat-icon>\r\n  </div>\r\n  <div class=\"like-button disabled\" *ngIf=\"view.EditInfo.ReadOnly || !enablePermissions\">\r\n    <mat-icon [matBadge]=\"view.Permissions.Count\" matBadgeColor=\"accent\" matBadgeSize=\"small\" matBadgeDisabled=\"true\"\r\n      [matBadgeHidden]=\"!view.Permissions.Count\" matBadgePosition=\"below after\">person</mat-icon>\r\n  </div>\r\n\r\n  <div class=\"like-button highlight\" matRipple tippy=\"More\" [matMenuTriggerFor]=\"menu\">\r\n    <mat-icon>more_horiz</mat-icon>\r\n  </div>\r\n</div>\r\n\r\n<mat-menu #menu=\"matMenu\" class=\"grid-more-menu\">\r\n  <ng-template matMenuContent>\r\n    <button mat-menu-item (click)=\"cloneView()\">\r\n      <mat-icon>file_copy</mat-icon>\r\n      <span>Copy</span>\r\n    </button>\r\n    <button mat-menu-item (click)=\" exportView()\">\r\n      <mat-icon>cloud_download</mat-icon>\r\n      <span>Export</span>\r\n    </button>\r\n    <button mat-menu-item [disabled]=\"view.EditInfo.ReadOnly\" (click)=\"deleteView()\">\r\n      <mat-icon>delete</mat-icon>\r\n      <span>Delete</span>\r\n    </button>\r\n  </ng-template>\r\n</mat-menu>","import { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { ICellRendererParams } from '@ag-grid-community/core';\r\nimport { Component } from '@angular/core';\r\nimport { View } from '../../models/view.model';\r\nimport { ViewActionsParams } from './views-actions.models';\r\n\r\n@Component({\r\n  selector: 'app-views-actions',\r\n  templateUrl: './views-actions.component.html',\r\n  styleUrls: ['./views-actions.component.scss'],\r\n})\r\nexport class ViewsActionsComponent implements ICellRendererAngularComp {\r\n  view: View;\r\n  enableCode: boolean;\r\n  enablePermissions: boolean;\r\n  private params: ICellRendererParams & ViewActionsParams;\r\n\r\n  agInit(params: ICellRendererParams & ViewActionsParams): void {\r\n    this.params = params;\r\n    this.view = this.params.data;\r\n    this.enableCode = this.params.enableCodeGetter();\r\n    this.enablePermissions = this.params.enablePermissionsGetter();\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n\r\n  openCode(): void {\r\n    this.params.onOpenCode(this.view);\r\n  }\r\n\r\n  openPermissions(): void {\r\n    this.params.onOpenPermissions(this.view);\r\n  }\r\n\r\n  openMetadata(): void {\r\n    this.params.onOpenMetadata(this.view);\r\n  }\r\n\r\n  cloneView(): void {\r\n    this.params.onClone(this.view);\r\n  }\r\n\r\n  exportView(): void {\r\n    this.params.onExport(this.view);\r\n  }\r\n\r\n  deleteView(): void {\r\n    this.params.onDelete(this.view);\r\n  }\r\n}\r\n","import { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { ICellRendererParams } from '@ag-grid-community/core';\r\nimport { Component } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-views-show',\r\n  templateUrl: './views-show.component.html',\r\n  styleUrls: ['./views-show.component.scss'],\r\n})\r\nexport class ViewsShowComponent implements ICellRendererAngularComp {\r\n  value: boolean;\r\n\r\n  agInit(params: ICellRendererParams) {\r\n    this.value = params.value;\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n}\r\n","<div class=\"icon-container\">\r\n  <mat-icon>{{ value ? 'visibility' : 'visibility_off' }}</mat-icon>\r\n</div>\r\n","import { View } from '../models/view.model';\r\n\r\nexport function calculateViewType(view: View) {\r\n  let value = '';\r\n  let icon = '';\r\n  if (view.HasQuery) {\r\n    value = 'Data (from query)';\r\n    icon = 'filter_list';\r\n  } else if (view.List) {\r\n    value = 'Items (list)';\r\n    icon = 'format_list_numbered';\r\n  } else if (!view.ContentType && !view.HasQuery) {\r\n    value = 'Code';\r\n    icon = 'check_box_outline_blank';\r\n  } else if (!view.List) {\r\n    value = 'Item (one)';\r\n    icon = 'looks_one';\r\n  }\r\n  return { value, icon };\r\n}\r\n","<div class=\"icon-container\">\r\n  <div class=\"like-button icon\" [tippy]=\"value\">\r\n    <mat-icon>{{ icon }}</mat-icon>\r\n  </div>\r\n  <div class=\"like-button icon\" tippy=\"View is shared\" *ngIf=\"isShared\">\r\n    <mat-icon>share</mat-icon>\r\n  </div>\r\n</div>","import { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { ICellRendererParams } from '@ag-grid-community/core';\r\nimport { Component } from '@angular/core';\r\nimport { View } from '../../models';\r\nimport { calculateViewType } from '../views.helpers';\r\n\r\n@Component({\r\n  selector: 'app-views-type',\r\n  templateUrl: './views-type.component.html',\r\n  styleUrls: ['./views-type.component.scss'],\r\n})\r\nexport class ViewsTypeComponent implements ICellRendererAngularComp {\r\n  value: string;\r\n  icon: string;\r\n  isShared: boolean;\r\n\r\n  agInit(params: ICellRendererParams) {\r\n    this.value = params.value;\r\n    const view: View = params.data;\r\n    const type = calculateViewType(view);\r\n    this.icon = type.icon;\r\n    this.isShared = view.IsShared;\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n}\r\n","<div class=\"grid-wrapper mat-tab-grid-wrapper\" *ngIf=\"viewModel$ | async as vm\">\r\n  <ag-grid-angular class=\"ag-theme-material\" [rowData]=\"vm.views\" [gridOptions]=\"gridOptions\" appDragAndDrop\r\n    [allowedFileTypes]=\"'json'\" (filesDropped)=\"importView($event)\">\r\n  </ag-grid-angular>\r\n\r\n  <div class=\"grid-more-actions-box\">\r\n    <button mat-button class=\"polymorph-button\" tippy=\"Configure polymorphism\" [disabled]=\"appIsInherited\"\r\n      (click)=\"editPolymorphisms()\">\r\n      <img class=\"polymorph-logo\" [src]=\"polymorphLogo\">\r\n      <span>Polymorphism {{ vm.polymorphStatus }}</span>\r\n    </button>\r\n\r\n    <button mat-button tippy=\"Import view\" (click)=\"importView()\">\r\n      <mat-icon>cloud_upload</mat-icon>\r\n      <span>View</span>\r\n    </button>\r\n  </div>\r\n\r\n  <button mat-fab mat-elevation-z24 class=\"grid-fab\" tippy=\"Create a new view\" (click)=\"editView(null)\">\r\n    <mat-icon>add</mat-icon>\r\n  </button>\r\n</div>","import polymorphLogo from '!url-loader!./polymorph-logo.png';\r\nimport { GridOptions } from '@ag-grid-community/core';\r\nimport { Component, Input, OnDestroy, OnInit } from '@angular/core';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { BehaviorSubject, Observable, combineLatest, map } from 'rxjs';\r\nimport { GoToMetadata } from '../../metadata';\r\nimport { GoToPermissions } from '../../permissions/go-to-permissions';\r\nimport { BaseComponent } from '../../shared/components/base-component/base.component';\r\nimport { BooleanFilterComponent } from '../../shared/components/boolean-filter/boolean-filter.component';\r\nimport { FileUploadDialogData } from '../../shared/components/file-upload-dialog';\r\nimport { IdFieldComponent } from '../../shared/components/id-field/id-field.component';\r\nimport { IdFieldParams } from '../../shared/components/id-field/id-field.models';\r\nimport { defaultGridOptions } from '../../shared/constants/default-grid-options.constants';\r\nimport { eavConstants } from '../../shared/constants/eav.constants';\r\nimport { convertFormToUrl } from '../../shared/helpers/url-prep.helper';\r\nimport { EditForm } from '../../shared/models/edit-form.model';\r\nimport { DialogService } from '../../shared/services/dialog.service';\r\nimport { Polymorphism } from '../models/polymorphism.model';\r\nimport { View } from '../models/view.model';\r\nimport { ViewsService } from '../services/views.service';\r\nimport { ViewsActionsComponent } from './views-actions/views-actions.component';\r\nimport { ViewActionsParams } from './views-actions/views-actions.models';\r\nimport { ViewsShowComponent } from './views-show/views-show.component';\r\nimport { ViewsTypeComponent } from './views-type/views-type.component';\r\nimport { calculateViewType } from './views.helpers';\r\n\r\n@Component({\r\n  selector: 'app-views',\r\n  templateUrl: './views.component.html',\r\n  styleUrls: ['./views.component.scss'],\r\n})\r\nexport class ViewsComponent extends BaseComponent implements OnInit, OnDestroy {\r\n  @Input() enableCode: boolean;\r\n  @Input() enablePermissions: boolean;\r\n  @Input() appIsGlobal: boolean;\r\n  @Input() appIsInherited: boolean;\r\n\r\n  views$ = new BehaviorSubject<View[]>(undefined);\r\n  polymorphStatus$ = new BehaviorSubject(undefined);\r\n  polymorphLogo = polymorphLogo;\r\n  gridOptions = this.buildGridOptions();\r\n\r\n  private polymorphism: Polymorphism;\r\n  \r\n  viewModel$: Observable<ViewsViewModel>;\r\n\r\n  constructor(\r\n    protected router: Router,\r\n    protected route: ActivatedRoute,\r\n    private viewsService: ViewsService,\r\n    private snackBar: MatSnackBar,\r\n    private dialogService: DialogService,\r\n  ) {\r\n    super(router, route);\r\n   }\r\n\r\n  ngOnInit() {\r\n    this.fetchTemplates();\r\n    this.fetchPolymorphism();\r\n    this.subscription.add(this.refreshOnChildClosedDeep().subscribe(() => { \r\n      this.fetchTemplates();\r\n      this.fetchPolymorphism();\r\n    }));\r\n    this.viewModel$ = combineLatest([this.views$, this.polymorphStatus$]).pipe(\r\n      map(([views, polymorphStatus]) => ({ views, polymorphStatus }))\r\n    );\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.views$.complete();\r\n    this.polymorphStatus$.complete();\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  importView(files?: File[]) {\r\n    const dialogData: FileUploadDialogData = { files };\r\n    this.router.navigate(['import'], { relativeTo: this.route.firstChild, state: dialogData });\r\n  }\r\n\r\n  private fetchTemplates() {\r\n    this.viewsService.getAll().subscribe(views => {\r\n      this.views$.next(views);\r\n    });\r\n  }\r\n\r\n  private fetchPolymorphism() {\r\n    this.viewsService.getPolymorphism().subscribe(polymorphism => {\r\n      this.polymorphism = polymorphism;\r\n      const polymorphStatus = (polymorphism.Id === null)\r\n        ? 'not configured'\r\n        : (polymorphism.Resolver === null ? 'disabled' : 'using ' + polymorphism.Resolver);\r\n      this.polymorphStatus$.next(polymorphStatus);\r\n    });\r\n  }\r\n\r\n  editView(view?: View) {\r\n    const form: EditForm = {\r\n      items: [\r\n        view == null\r\n          ? {\r\n            ContentTypeName: eavConstants.contentTypes.template,\r\n            Prefill: {\r\n              ...(this.appIsGlobal && { Location: 'Global' }),\r\n            },\r\n          }\r\n          : { EntityId: view.Id }\r\n      ],\r\n    };\r\n    const formUrl = convertFormToUrl(form);\r\n    this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  editPolymorphisms() {\r\n    if (!this.polymorphism) { return; }\r\n\r\n    const form: EditForm = {\r\n      items: [\r\n        !this.polymorphism.Id\r\n          ? { ContentTypeName: this.polymorphism.TypeName }\r\n          : { EntityId: this.polymorphism.Id }\r\n      ],\r\n    };\r\n    const formUrl = convertFormToUrl(form);\r\n    this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private enableCodeGetter() {\r\n    return this.enableCode;\r\n  }\r\n\r\n  private enablePermissionsGetter() {\r\n    return this.enablePermissions;\r\n  }\r\n\r\n  private openUsage(view: View) {\r\n    this.router.navigate([`usage/${view.Guid}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private openCode(view: View) {\r\n    this.dialogService.openCodeFile(view.TemplatePath, view.IsShared, view.Id);\r\n  }\r\n\r\n  private openPermissions(view: View) {\r\n    this.router.navigate([GoToPermissions.getUrlEntity(view.Guid)], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private openMetadata(view: View) {\r\n    const url = GoToMetadata.getUrlEntity(\r\n      view.Guid,\r\n      `Metadata for View: ${view.Name} (${view.Id})`,\r\n    );\r\n    this.router.navigate([url], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private cloneView(view: View) {\r\n    const form: EditForm = {\r\n      items: [{ ContentTypeName: eavConstants.contentTypes.template, DuplicateEntity: view.Id }],\r\n    };\r\n    const formUrl = convertFormToUrl(form);\r\n    this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private exportView(view: View) {\r\n    this.viewsService.export(view.Id);\r\n  }\r\n\r\n  private deleteView(view: View) {\r\n    if (!confirm(`Delete '${view.Name}' (${view.Id})?`)) { return; }\r\n    this.snackBar.open('Deleting...');\r\n    this.viewsService.delete(view.Id).subscribe(res => {\r\n      this.snackBar.open('Deleted', null, { duration: 2000 });\r\n      this.fetchTemplates();\r\n    });\r\n  }\r\n\r\n  private buildGridOptions(): GridOptions {\r\n    const gridOptions: GridOptions = {\r\n      ...defaultGridOptions,\r\n      columnDefs: [\r\n        {\r\n          headerName: 'ID',\r\n          field: 'Id',\r\n          width: 70,\r\n          headerClass: 'dense',\r\n          sortable: true,\r\n          filter: 'agNumberColumnFilter',\r\n          cellClass: (params) => {\r\n            const view: View = params.data;\r\n            return `id-action no-padding no-outline ${view.EditInfo.ReadOnly ? 'disabled' : ''}`.split(' ');\r\n          },\r\n          valueGetter: (params) => {\r\n            const view: View = params.data;\r\n            return view.Id;\r\n          },\r\n          cellRenderer: IdFieldComponent,\r\n          cellRendererParams: (() => {\r\n            const params: IdFieldParams<View> = {\r\n              tooltipGetter: (view) => `ID: ${view.Id}\\nGUID: ${view.Guid}`,\r\n            };\r\n            return params;\r\n          })(),\r\n        },\r\n        {\r\n          field: 'Show',\r\n          width: 70,\r\n          headerClass: 'dense',\r\n          cellClass: 'no-outline',\r\n          sortable: true,\r\n          filter: BooleanFilterComponent,\r\n          valueGetter: (params) => {\r\n            const view: View = params.data;\r\n            return !view.IsHidden;\r\n          },\r\n          cellRenderer: ViewsShowComponent,\r\n        },\r\n        {\r\n          field: 'Name',\r\n          flex: 2,\r\n          minWidth: 250,\r\n          cellClass: 'primary-action highlight'.split(' '),\r\n          sortable: true,\r\n          sort: 'asc',\r\n          filter: 'agTextColumnFilter',\r\n          onCellClicked: (params) => {\r\n            const view: View = params.data;\r\n            this.editView(view);\r\n          },\r\n          valueGetter: (params) => {\r\n            const view: View = params.data;\r\n            return view.Name;\r\n          },\r\n        },\r\n        {\r\n          field: 'Type',\r\n          width: 82,\r\n          headerClass: 'dense',\r\n          cellClass: 'no-padding no-outline'.split(' '),\r\n          sortable: true,\r\n          filter: 'agTextColumnFilter',\r\n          valueGetter: (params) => {\r\n            const view: View = params.data;\r\n            const type = calculateViewType(view);\r\n            return type.value;\r\n          },\r\n          cellRenderer: ViewsTypeComponent,\r\n        },\r\n        {\r\n          field: 'Used',\r\n          width: 70,\r\n          headerClass: 'dense',\r\n          cellClass: 'primary-action highlight'.split(' '),\r\n          sortable: true,\r\n          filter: 'agNumberColumnFilter',\r\n          onCellClicked: (params) => {\r\n            const view: View = params.data;\r\n            this.openUsage(view);\r\n          },\r\n          valueGetter: (params) => {\r\n            const view: View = params.data;\r\n            return view.Used;\r\n          },\r\n        },\r\n        {\r\n          headerName: 'Url Key',\r\n          field: 'UrlKey',\r\n          flex: 1,\r\n          minWidth: 150,\r\n          cellClass: 'no-outline',\r\n          sortable: true,\r\n          filter: 'agTextColumnFilter',\r\n          valueGetter: (params) => {\r\n            const view: View = params.data;\r\n            return view.ViewNameInUrl;\r\n          },\r\n        },\r\n        {\r\n          field: 'Path',\r\n          flex: 2,\r\n          minWidth: 250,\r\n          cellClass: 'no-outline',\r\n          sortable: true,\r\n          filter: 'agTextColumnFilter',\r\n          valueGetter: (params) => {\r\n            const view: View = params.data;\r\n            return view.TemplatePath;\r\n          },\r\n        },\r\n        {\r\n          field: 'Content',\r\n          flex: 2,\r\n          minWidth: 250,\r\n          cellClass: 'no-outline',\r\n          sortable: true,\r\n          filter: 'agTextColumnFilter',\r\n          valueGetter: (params) => {\r\n            const view: View = params.data;\r\n            return view.ContentType.Name;\r\n          },\r\n        },\r\n        {\r\n          headerName: 'Default',\r\n          field: 'ContentDemo',\r\n          flex: 1,\r\n          minWidth: 150,\r\n          cellClass: 'no-outline',\r\n          sortable: true,\r\n          filter: 'agTextColumnFilter',\r\n          valueGetter: (params) => {\r\n            const view: View = params.data;\r\n            return `${view.ContentType.DemoId} ${view.ContentType.DemoTitle}`;\r\n          },\r\n        },\r\n        {\r\n          field: 'Presentation',\r\n          flex: 2,\r\n          minWidth: 250,\r\n          cellClass: 'no-outline',\r\n          sortable: true,\r\n          filter: 'agTextColumnFilter',\r\n          valueGetter: (params) => {\r\n            const view: View = params.data;\r\n            return view.PresentationType.Name;\r\n          },\r\n        },\r\n        {\r\n          headerName: 'Default',\r\n          field: 'PresentationDemo',\r\n          flex: 1,\r\n          minWidth: 150,\r\n          cellClass: 'no-outline',\r\n          sortable: true,\r\n          filter: 'agTextColumnFilter',\r\n          valueGetter: (params) => {\r\n            const view: View = params.data;\r\n            return `${view.PresentationType.DemoId} ${view.PresentationType.DemoTitle}`;\r\n          },\r\n        },\r\n        {\r\n          field: 'Header',\r\n          flex: 2,\r\n          minWidth: 250,\r\n          cellClass: 'no-outline',\r\n          sortable: true,\r\n          filter: 'agTextColumnFilter',\r\n          valueGetter: (params) => {\r\n            const view: View = params.data;\r\n            return view.ListContentType.Name;\r\n          },\r\n        },\r\n        {\r\n          headerName: 'Default',\r\n          field: 'HeaderDemo',\r\n          flex: 1,\r\n          minWidth: 150,\r\n          cellClass: 'no-outline',\r\n          sortable: true,\r\n          filter: 'agTextColumnFilter',\r\n          valueGetter: (params) => {\r\n            const view: View = params.data;\r\n            return `${view.ListContentType.DemoId} ${view.ListContentType.DemoTitle}`;\r\n          },\r\n        },\r\n        {\r\n          headerName: 'Header Presentation',\r\n          field: 'HeaderPresentation',\r\n          flex: 2,\r\n          minWidth: 250,\r\n          cellClass: 'no-outline',\r\n          sortable: true,\r\n          filter: 'agTextColumnFilter',\r\n          valueGetter: (params) => {\r\n            const view: View = params.data;\r\n            return view.ListPresentationType.Name;\r\n          },\r\n        },\r\n        {\r\n          headerName: 'Default',\r\n          field: 'HeaderPresentationDemo',\r\n          flex: 1,\r\n          minWidth: 150,\r\n          cellClass: 'no-outline',\r\n          sortable: true,\r\n          filter: 'agTextColumnFilter',\r\n          valueGetter: (params) => {\r\n            const view: View = params.data;\r\n            return `${view.ListPresentationType.DemoId} ${view.ListPresentationType.DemoTitle}`;\r\n          },\r\n        },\r\n        {\r\n          width: 162,\r\n          cellClass: 'secondary-action no-padding'.split(' '),\r\n          pinned: 'right',\r\n          cellRenderer: ViewsActionsComponent,\r\n          cellRendererParams: (() => {\r\n            const params: ViewActionsParams = {\r\n              enableCodeGetter: () => this.enableCodeGetter(),\r\n              enablePermissionsGetter: () => this.enablePermissionsGetter(),\r\n              onOpenCode: (view) => this.openCode(view),\r\n              onOpenPermissions: (view) => this.openPermissions(view),\r\n              onOpenMetadata: (view) => this.openMetadata(view),\r\n              onClone: (view) => this.cloneView(view),\r\n              onExport: (view) => this.exportView(view),\r\n              onDelete: (view) => this.deleteView(view),\r\n            };\r\n            return params;\r\n          })(),\r\n        },\r\n      ],\r\n    };\r\n    return gridOptions;\r\n  }\r\n}\r\n\r\ninterface ViewsViewModel {\r\n  views: View[];\r\n  polymorphStatus: any;\r\n}\r\n","export default \"data:image/png;base64,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\"","<div class=\"actions-component\">\r\n  <div class=\"like-button highlight\" matRipple *ngIf=\"enableCode\" tippy=\"Code\" (click)=\"openCode()\">\r\n    <mat-icon>code</mat-icon>\r\n  </div>\r\n  <div class=\"like-button disabled\" *ngIf=\"!enableCode\">\r\n    <mat-icon>code</mat-icon>\r\n  </div>\r\n\r\n  <div class=\"like-button highlight\" matRipple tippy=\"More\" [matMenuTriggerFor]=\"menu\">\r\n    <mat-icon>more_horiz</mat-icon>\r\n  </div>\r\n</div>\r\n\r\n<mat-menu #menu=\"matMenu\" class=\"grid-more-menu\">\r\n  <ng-template matMenuContent>\r\n    <button mat-menu-item (click)=\"openRestApi()\">\r\n      <mat-icon svgIcon=\"code-curly\"></mat-icon>\r\n      <span>REST API</span>\r\n    </button>\r\n  </ng-template>\r\n</mat-menu>","import { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { ICellRendererParams } from '@ag-grid-community/core';\r\nimport { Component } from '@angular/core';\r\nimport { WebApi } from '../../models/web-api.model';\r\nimport { WebApiActionsParams } from './web-api-actions.models';\r\n\r\n@Component({\r\n  selector: 'app-web-api-actions',\r\n  templateUrl: './web-api-actions.component.html',\r\n  styleUrls: ['./web-api-actions.component.scss'],\r\n})\r\nexport class WebApiActionsComponent implements ICellRendererAngularComp {\r\n  enableCode: boolean;\r\n  private params: ICellRendererParams & WebApiActionsParams;\r\n\r\n  agInit(params: ICellRendererParams & WebApiActionsParams): void {\r\n    this.params = params;\r\n    this.enableCode = this.params.enableCodeGetter();\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n\r\n  openCode(): void {\r\n    const api: WebApi = this.params.data;\r\n    this.params.onOpenCode(api);\r\n  }\r\n\r\n  openRestApi(): void {\r\n    const api: WebApi = this.params.data;\r\n    this.params.onOpenRestApi(api);\r\n  }\r\n}\r\n","<div class=\"icon-container\">\r\n  <div class=\"like-button icon\" tippy=\"WebApi is shared\" *ngIf=\"value\">\r\n    <mat-icon>share</mat-icon>\r\n  </div>\r\n</div>","import { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { ICellRendererParams } from '@ag-grid-community/core';\r\nimport { Component } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-web-api-type',\r\n  templateUrl: './web-api-type.component.html',\r\n  styleUrls: ['./web-api-type.component.scss'],\r\n})\r\nexport class WebApiTypeComponent implements ICellRendererAngularComp {\r\n  value: boolean;\r\n\r\n  agInit(params: ICellRendererParams) {\r\n    this.value = params.value;\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n}\r\n","<div class=\"grid-wrapper mat-tab-grid-wrapper\"  *ngIf=\"viewModel$ | async as vm\">\r\n  <ag-grid-angular class=\"ag-theme-material\" [rowData]=\"vm.webApis\" [gridOptions]=\"gridOptions\">\r\n  </ag-grid-angular>\r\n\r\n  <div class=\"grid-more-actions-box\"></div>\r\n\r\n  <button mat-fab mat-elevation-z24 class=\"grid-fab\" tippy=\"Create a new controller\" (click)=\"createController()\">\r\n    <mat-icon>add</mat-icon>\r\n  </button>\r\n</div>","import { GridOptions } from '@ag-grid-community/core';\r\nimport { Component, Input, OnDestroy, OnInit, ViewContainerRef } from '@angular/core';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { BehaviorSubject, Observable, combineLatest, map } from 'rxjs';\r\nimport { SourceService } from '../../code-editor/services/source.service';\r\nimport { CreateFileDialogComponent, CreateFileDialogData, CreateFileDialogResult, FileLocationDialogComponent } from '../../create-file-dialog';\r\nimport { GoToDevRest } from '../../dev-rest/go-to-dev-rest';\r\nimport { BooleanFilterComponent } from '../../shared/components/boolean-filter/boolean-filter.component';\r\nimport { defaultGridOptions } from '../../shared/constants/default-grid-options.constants';\r\nimport { DialogService } from '../../shared/services/dialog.service';\r\nimport { WebApi } from '../models/web-api.model';\r\nimport { WebApiActionsComponent } from './web-api-actions/web-api-actions.component';\r\nimport { WebApiActionsParams } from './web-api-actions/web-api-actions.models';\r\nimport { WebApiTypeComponent } from './web-api-type/web-api-type.component';\r\n\r\n@Component({\r\n  selector: 'app-web-api',\r\n  templateUrl: './web-api.component.html',\r\n  styleUrls: ['./web-api.component.scss'],\r\n})\r\nexport class WebApiComponent implements OnInit, OnDestroy {\r\n  @Input() enableCode: boolean;\r\n\r\n  webApis$ = new BehaviorSubject<WebApi[]>(undefined);\r\n  gridOptions = this.buildGridOptions();\r\n\r\n  viewModel$: Observable<WebApiViewModel>;\r\n\r\n  constructor(\r\n    private sourceService: SourceService,\r\n    private snackBar: MatSnackBar,\r\n    private dialogService: DialogService,\r\n    private router: Router,\r\n    private route: ActivatedRoute,\r\n    private dialog: MatDialog,\r\n    private viewContainerRef: ViewContainerRef,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.fetchWebApis();\r\n    this.viewModel$ = combineLatest([this.webApis$]).pipe(\r\n      map(([webApis]) => ({ webApis }))\r\n    );\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.webApis$.complete();\r\n  }\r\n\r\n  createController(global?: boolean): void {\r\n    if (global == null) {\r\n      const fileLocationDialogRef = this.dialog.open(FileLocationDialogComponent, {\r\n        autoFocus: false,\r\n        viewContainerRef: this.viewContainerRef,\r\n        width: '650px',\r\n      });\r\n      fileLocationDialogRef.afterClosed().subscribe((isShared?: boolean) => {\r\n        if (isShared == null) { return; }\r\n        this.createController(isShared);\r\n      });\r\n      return;\r\n    }\r\n\r\n    const createFileDialogData: CreateFileDialogData = {\r\n      folder: 'api',\r\n      global,\r\n      purpose: 'Api',\r\n    };\r\n    const createFileDialogRef = this.dialog.open(CreateFileDialogComponent, {\r\n      autoFocus: false,\r\n      data: createFileDialogData,\r\n      viewContainerRef: this.viewContainerRef,\r\n      width: '650px',\r\n    });\r\n\r\n    createFileDialogRef.afterClosed().subscribe((result?: CreateFileDialogResult) => {\r\n      if (!result) { return; }\r\n\r\n      if (result.name.endsWith('Controller.cs')) {\r\n        const fileName = result.name.substring(result.name.lastIndexOf('/') + 1);\r\n        if (!/^[A-Z][a-zA-Z0-9]*Controller\\.cs$/g.test(fileName)) {\r\n          const message = `\"${fileName}\" is invalid controller name. Should be something like \"MyController.cs\"`;\r\n          this.snackBar.open(message, null, { duration: 5000 });\r\n          return;\r\n        }\r\n      }\r\n\r\n      this.snackBar.open('Saving...');\r\n      this.sourceService.create(result.name, global, result.templateKey).subscribe(() => {\r\n        this.snackBar.open('Saved', null, { duration: 2000 });\r\n        this.fetchWebApis();\r\n      });\r\n    });\r\n  }\r\n\r\n  private fetchWebApis() {\r\n    this.sourceService.getWebApis().subscribe(webApis => {\r\n      this.webApis$.next(webApis);\r\n    });\r\n  }\r\n\r\n  private enableCodeGetter() {\r\n    return this.enableCode;\r\n  }\r\n\r\n  private openCode(api: WebApi) {\r\n    this.dialogService.openCodeFile(api.path, api.isShared);\r\n  }\r\n\r\n  private openRestApi(api: WebApi) {\r\n    this.router.navigate([GoToDevRest.getUrlWebApi(api)], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private buildGridOptions(): GridOptions {\r\n    const gridOptions: GridOptions = {\r\n      ...defaultGridOptions,\r\n      columnDefs: [\r\n        {\r\n          field: 'Folder',\r\n          flex: 2,\r\n          minWidth: 250,\r\n          cellClass: 'no-outline',\r\n          sortable: true,\r\n          sort: 'asc',\r\n          filter: 'agTextColumnFilter',\r\n          valueGetter: (params) => {\r\n            const api: WebApi = params.data;\r\n            return api.folder;\r\n          },\r\n        },\r\n        {\r\n          field: 'Name',\r\n          flex: 2,\r\n          minWidth: 250,\r\n          cellClass: 'no-outline',\r\n          sortable: true,\r\n          filter: 'agTextColumnFilter',\r\n          valueGetter: (params) => {\r\n            const api: WebApi = params.data;\r\n            return api.name;\r\n          },\r\n        },\r\n        {\r\n          field: 'Type',\r\n          flex: 1,\r\n          minWidth: 250,\r\n          cellClass: 'no-outline',\r\n          sortable: true,\r\n          filter: BooleanFilterComponent,\r\n          valueGetter: (params) => {\r\n            const api: WebApi = params.data;\r\n            return api.isShared;\r\n          },\r\n          cellRenderer: WebApiTypeComponent,\r\n        },\r\n        {\r\n          width: 82,\r\n          cellClass: 'secondary-action no-padding'.split(' '),\r\n          pinned: 'right',\r\n          cellRenderer: WebApiActionsComponent,\r\n          cellRendererParams: (() => {\r\n            const params: WebApiActionsParams = {\r\n              enableCodeGetter: () => this.enableCodeGetter(),\r\n              onOpenCode: (api) => this.openCode(api),\r\n              onOpenRestApi: (api) => this.openRestApi(api),\r\n            };\r\n            return params;\r\n          })(),\r\n        },\r\n      ],\r\n    };\r\n    return gridOptions;\r\n  }\r\n}\r\n\r\ninterface WebApiViewModel { \r\n  webApis: WebApi[];\r\n}\r\n","import { View } from '../../models';\r\n\r\nexport const AnalyzeParts = {\r\n  Settings: 'Settings',\r\n  Resources: 'Resources',\r\n} as const;\r\nexport type AnalyzePart = typeof AnalyzeParts[keyof typeof AnalyzeParts];\r\n\r\nexport interface AnalyzeSettingsViewModel {\r\n  views: View[];\r\n  selectedView: string;\r\n  stack: SettingsStackItem[];\r\n}\r\n\r\nexport interface SettingsStackItem {\r\n  Path: string;\r\n  Priority: number;\r\n  Source: string;\r\n  TotalResults: number;\r\n  Type: string;\r\n  Value: string;\r\n  _value: string;\r\n}\r\n","<ng-container *ngIf=\"viewModel$ | async as vm\">\r\n\r\n  <!-- App Config -->\r\n  <mat-card class=\"mat-elevation-z2\">\r\n    <mat-card-header>\r\n      <mat-card-title>Configuration</mat-card-title>\r\n      <div class=\"mat-card-header-icon\">\r\n        <mat-icon>redeem</mat-icon>\r\n      </div>\r\n    </mat-card-header>\r\n    <mat-card-content>\r\n      <table>\r\n        <td>\r\n          <tr><b>Name:</b></tr>\r\n          <tr><b>Folder:</b></tr>\r\n          <tr><b>Version:</b></tr>\r\n          <tr><b>For</b></tr>\r\n        </td>\r\n        <td>\r\n          <tr><span [tippy]=\"'Click to copy to clipboard'\" (click)=\"copyToClipboard(vm.displayName)\">{{vm.displayName}}</span></tr>\r\n          <tr><span [tippy]=\"'Click to copy to clipboard'\" (click)=\"copyToClipboard(vm.folder)\">{{vm.folder}}</span></tr>\r\n          <tr><span [tippy]=\"'Click to copy to clipboard'\" (click)=\"copyToClipboard(vm.version)\">{{vm.version}}</span></tr>\r\n          <tr>\r\n            <b>2sxc: </b><span [tippy]=\"'Click to copy to clipboard'\" \r\n              (click)=\"copyToClipboard(vm.toSxc)\"> {{vm.toSxc}} </span>\r\n            <b> DNN: </b><span [tippy]=\"'Click to copy to clipboard'\"\r\n              (click)=\"copyToClipboard(vm.dnn)\"> {{vm.dnn}} </span>\r\n            <b> Oqt: </b><span [tippy]=\"'Click to copy to clipboard'\"\r\n              (click)=\"copyToClipboard(vm.oqt)\"> {{vm.oqt}} </span>\r\n          </tr>\r\n        </td>\r\n      </table>\r\n    </mat-card-content>\r\n    <mat-card-actions>\r\n      <ng-container *ngTemplateOutlet=\"docsLink; context: { link: 'https://docs.2sxc.org/basics/app/configuration.html' }\"></ng-container>\r\n      <button mat-button (click)=\"edit()\">\r\n        <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"vm.appConfigurationsCount || null\"\r\n          matBadgePosition=\"below after\">edit</mat-icon>\r\n        <span>Edit</span>\r\n      </button>\r\n      <button mat-button (click)=\"openMetadata()\">\r\n        <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"vm.appMetadataCount || null\"\r\n          matBadgePosition=\"below after\">local_offer</mat-icon>\r\n        <span>Metadata</span>\r\n      </button>\r\n    </mat-card-actions>\r\n  </mat-card>\r\n\r\n</ng-container>\r\n\r\n<ng-template #docsLink let-icon let-label let-link=\"link\">\r\n  <a mat-button href=\"{{link}}\" target=\"_blank\" [tippy]=\"'online documentation'\">\r\n    <mat-icon>{{ icon ?? \"menu_book\" }}</mat-icon>\r\n    <span>{{ label }}</span>\r\n  </a>\r\n</ng-template>","import { Component, Input, OnDestroy, OnInit } from '@angular/core';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { ContentItemsService } from '../../../content-items/services/content-items.service';\r\nimport { GoToMetadata } from '../../../metadata';\r\nimport { BaseComponent } from '../../../shared/components/base-component/base.component';\r\nimport { eavConstants } from '../../../shared/constants/eav.constants';\r\nimport { convertFormToUrl } from '../../../shared/helpers/url-prep.helper';\r\nimport { DialogSettings } from '../../../shared/models/dialog-settings.model';\r\nimport { EditForm } from '../../../shared/models/edit-form.model';\r\nimport { Context } from '../../../shared/services/context';\r\nimport { AppInternalsService } from '../../services/app-internals.service';\r\nimport { Subject, Observable, combineLatest, map } from 'rxjs';\r\nimport { AppInternals } from '../../models/app-internals.model';\r\nimport { copyToClipboard } from '../../../shared/helpers/copy-to-clipboard.helper';\r\n\r\n@Component({\r\n  selector: 'app-app-configuration-card',\r\n  templateUrl: './app-configuration-card.component.html',\r\n  styleUrls: ['./app-configuration-card.component.scss'],\r\n})\r\nexport class AppConfigurationCardComponent extends BaseComponent implements OnInit, OnDestroy {\r\n  @Input() dialogSettings: DialogSettings;\r\n\r\n  // More proper ViewModel\r\n  appSettingsInternal$ = new Subject<AppInternals>();\r\n  viewModel$: Observable<ViewModel>;\r\n\r\n  constructor(\r\n    protected router: Router,\r\n    protected route: ActivatedRoute,\r\n    private contentItemsService: ContentItemsService,\r\n    private context: Context,\r\n    private snackBar: MatSnackBar,\r\n    private appInternalsService: AppInternalsService) {\r\n    super(router, route);\r\n\r\n    // New with proper ViewModel\r\n    this.viewModel$ = combineLatest([\r\n      this.appSettingsInternal$,\r\n      this.contentItemsService.getAll(eavConstants.contentTypes.appConfiguration),\r\n    ]).pipe(map(([settings, contentItems]) => {\r\n      const contentItem = contentItems[0];\r\n      const result: ViewModel = {\r\n        appConfigurationsCount: settings.EntityLists.ToSxcContentApp.length,\r\n        appMetadataCount: settings.MetadataList.Items.length,\r\n        displayName: contentItem?.DisplayName ?? '-',\r\n        folder: contentItem?.Folder ?? '-',\r\n        version: contentItem?.Version ?? '-',\r\n        toSxc: contentItem?.RequiredVersion ?? '-',\r\n        dnn: contentItem?.RequiredDnnVersion ?? '-',\r\n        oqt: contentItem?.RequiredOqtaneVersion ?? '-',\r\n      }\r\n      return result;\r\n    }));\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.fetchSettings();\r\n    this.subscription.add(this.refreshOnChildClosedDeep().subscribe(() => { this.fetchSettings(); }));\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.snackBar.dismiss();\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  copyToClipboard(text: string): void {\r\n    copyToClipboard(text);\r\n    this.snackBar.open('Copied to clipboard', null, { duration: 2000 });\r\n  }\r\n\r\n  edit() {\r\n    const staticName = eavConstants.contentTypes.appConfiguration;\r\n    this.contentItemsService.getAll(staticName).subscribe(contentItems => {\r\n      let form: EditForm;\r\n      \r\n      if (contentItems.length < 1) throw new Error(`Found no settings for type ${staticName}`);\r\n      if (contentItems.length > 1) throw new Error(`Found too many settings for type ${staticName}`);\r\n      form = {\r\n        items: [{ EntityId: contentItems[0].Id }],\r\n      };\r\n\r\n      const formUrl = convertFormToUrl(form);\r\n      this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route.firstChild });\r\n    });\r\n  }\r\n\r\n  openMetadata() {\r\n    const url = GoToMetadata.getUrlApp(\r\n      this.context.appId,\r\n      `Metadata for App: ${this.dialogSettings.Context.App.Name} (${this.context.appId})`,\r\n    );\r\n    this.router.navigate([url], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private fetchSettings() {\r\n    const getObservable = this.appInternalsService.getAppInternals(eavConstants.metadata.app.targetType, eavConstants.metadata.app.keyType, this.context.appId);\r\n    getObservable.subscribe(x => {\r\n      // 2dm - New mode for Reactive UI\r\n      this.appSettingsInternal$.next(x);\r\n      });\r\n  }\r\n}\r\n\r\nclass ViewModel {\r\n  appConfigurationsCount: number;\r\n  appMetadataCount: number;\r\n  displayName: string;\r\n  folder: string;\r\n  version: string;\r\n  toSxc: string;\r\n  dnn: string;\r\n  oqt: string;\r\n}","<ng-container *ngIf=\"viewModel$ | async as vm\">\r\n\r\n  <div class=\"alert alert-info scope-info\" *ngIf=\"isGlobal || isPrimary\">\r\n    <ng-container *ngIf=\"isGlobal\">\r\n      This is the Global App. Anything configured here will affect all Sites and Apps in this installation.\r\n    </ng-container>\r\n    <ng-container *ngIf=\"isPrimary\">\r\n      This is the Primary App of this Site. You can also configure sitewide settings and resources here.\r\n    </ng-container>\r\n    See <a href=\"https://go.2sxc.org/settings\" target=\"_blank\">docs</a>.\r\n  </div>\r\n\r\n  <div class=\"cards-box\">\r\n    <!-- Settings -->\r\n    <mat-card class=\"mat-elevation-z2\">\r\n      <mat-card-header>\r\n        <mat-card-title>Settings</mat-card-title>\r\n        <div class=\"mat-card-header-icon\">\r\n          <mat-icon>settings</mat-icon>\r\n        </div>\r\n      </mat-card-header>\r\n      <mat-card-content>\r\n        <p>\r\n          Settings are things like SQL-connection strings, default \"items-to-show\" numbers and similar.\r\n          If necessary, settings like a link to an RSS-Feed could be different in each language.\r\n          <a href=\"https://go.2sxc.org/settings\" target=\"_blank\">docs</a>\r\n        </p>\r\n\r\n        <table class=\"settings\">\r\n          <thead>\r\n            <tr>\r\n              <th></th>\r\n              <th>System Settings</th>\r\n              <th>Custom Settings</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <!-- Settings for Global App -->\r\n            <ng-container *ngIf=\"isGlobal\">\r\n              <tr>\r\n                <th>Global</th>\r\n                <td>\r\n                  <button mat-button (click)=\"edit(eavConstants.contentTypes.systemSettings, SystemSettingsScopes.App)\"\r\n                    tippy=\"Edit global system settings\">\r\n                    <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"vm.systemSettingsCount || null\"\r\n                      matBadgePosition=\"below after\">edit</mat-icon>\r\n                  </button>\r\n                </td>\r\n                <td>\r\n                  <button mat-button (click)=\"fixContentType(eavConstants.contentTypes.customSettings, 'edit')\"\r\n                    tippy=\"Edit custom global settings\">\r\n                    <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"vm.customSettingsCount || null\"\r\n                      matBadgePosition=\"below after\">edit</mat-icon>\r\n                  </button>\r\n                  <button mat-button (click)=\"fixContentType(eavConstants.contentTypes.customSettings, 'config')\"\r\n                    tippy=\"Configure fields of the custom global settings\">\r\n                    <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"vm.customSettingsFieldsCount || null\"\r\n                      matBadgePosition=\"below after\">dns</mat-icon>\r\n                  </button>\r\n                </td>\r\n            </ng-container>\r\n            <!-- Settings for Primary App -->\r\n            <ng-container *ngIf=\"isPrimary\">\r\n              <tr>\r\n                <th>Site</th>\r\n                <td>\r\n                  <button mat-button (click)=\"edit(eavConstants.contentTypes.systemSettings, SystemSettingsScopes.Site)\"\r\n                    tippy=\"Edit site system settings\">\r\n                    <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"vm.systemSettingsCount || null\"\r\n                      matBadgePosition=\"below after\">edit</mat-icon>\r\n                  </button>\r\n                </td>\r\n                <td>\r\n                  <button mat-button (click)=\"fixContentType(eavConstants.contentTypes.customSettings, 'edit')\"\r\n                    tippy=\"Edit custom site settings\">\r\n                    <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"vm.customSettingsCount || null\"\r\n                      matBadgePosition=\"below after\">edit</mat-icon>\r\n                  </button>\r\n                  <button mat-button (click)=\"fixContentType(eavConstants.contentTypes.customSettings, 'config')\"\r\n                    tippy=\"Configure fields of the custom site settings\">\r\n                    <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"vm.customSettingsFieldsCount || null\"\r\n                      matBadgePosition=\"below after\">dns</mat-icon>\r\n                  </button>\r\n                </td>\r\n              </tr>\r\n              <ng-container *ngTemplateOutlet=\"goToGlobal\"></ng-container>\r\n            </ng-container>\r\n            <!-- Settings for App and Content -->\r\n            <ng-container *ngIf=\"isApp\">\r\n              <tr>\r\n                <th>{{ dialogSettings.Context.App.Name }}</th>\r\n                <td>\r\n                  <button mat-button (click)=\"edit(eavConstants.contentTypes.systemSettings, SystemSettingsScopes.App)\"\r\n                    tippy=\"Edit app system settings\">\r\n                    <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"vm.systemSettingsCount || null\"\r\n                      matBadgePosition=\"below after\">edit</mat-icon>\r\n                  </button>\r\n                </td>\r\n                <td>\r\n                  <button mat-button (click)=\"edit(eavConstants.contentTypes.settings)\" tippy=\"Edit custom app settings\">\r\n                    <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"vm.customSettingsCount || null\"\r\n                      matBadgePosition=\"below after\">edit</mat-icon>\r\n                  </button>\r\n                  <button mat-button (click)=\"config(eavConstants.contentTypes.settings)\"\r\n                    tippy=\"Configure fields of the custom app settings\">\r\n                    <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"vm.customSettingsFieldsCount || null\"\r\n                      matBadgePosition=\"below after\">dns</mat-icon>\r\n                  </button>\r\n                </td>\r\n              </tr>\r\n              <ng-container *ngTemplateOutlet=\"goToSite\"></ng-container>\r\n              <ng-container *ngTemplateOutlet=\"goToGlobal\"></ng-container>\r\n            </ng-container>\r\n          </tbody>\r\n        </table>\r\n      </mat-card-content>\r\n\r\n      <mat-card-actions>\r\n        <div class=\"actions-row\">\r\n          <ng-container *ngTemplateOutlet=\"docsLink; context: { link: 'https://go.2sxc.org/settings' }\"></ng-container>\r\n          <button mat-button (click)=\"analyze(AnalyzeParts.Settings)\" tippy=\"See the result of combining all settings\">\r\n            <mat-icon>manage_search</mat-icon>\r\n            <span>Analyze Combined Settings</span>\r\n          </button>\r\n        </div>\r\n      </mat-card-actions>\r\n    </mat-card>\r\n\r\n    <!-- Resources -->\r\n    <mat-card class=\"mat-elevation-z2\">\r\n      <mat-card-header>\r\n        <mat-card-title>Language Resources (i18n)</mat-card-title>\r\n        <div class=\"mat-card-header-icon\">\r\n          <mat-icon>translate</mat-icon>\r\n        </div>\r\n      </mat-card-header>\r\n      <mat-card-content>\r\n        <p>\r\n          Resources are used for labels and things like that in the App.\r\n          They are usually needed to create multi-lingual views and such, and should not be used for App-Settings.\r\n          <a href=\"https://go.2sxc.org/settings\" target=\"_blank\">docs</a>\r\n        </p>\r\n\r\n        <table class=\"settings\">\r\n          <thead>\r\n            <tr>\r\n              <th></th>\r\n              <th>System Resources</th>\r\n              <th>Custom Resources</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <!-- Resources for Global App -->\r\n            <ng-container *ngIf=\"isGlobal\">\r\n              <tr>\r\n                <th>Global</th>\r\n                <td>\r\n                  <button mat-button (click)=\"edit(eavConstants.contentTypes.systemResources, SystemSettingsScopes.App)\"\r\n                    tippy=\"Edit global system resources\">\r\n                    <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"vm.systemResourcesCount || null\"\r\n                      matBadgePosition=\"below after\">edit</mat-icon>\r\n                  </button>\r\n                </td>\r\n                <td>\r\n                  <button mat-button (click)=\"fixContentType(eavConstants.contentTypes.customResources, 'edit')\"\r\n                    tippy=\"Edit custom global resources\">\r\n                    <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"vm.customResourcesCount || null\"\r\n                      matBadgePosition=\"below after\">edit</mat-icon>\r\n                  </button>\r\n                  <button mat-button (click)=\"fixContentType(eavConstants.contentTypes.customResources, 'config')\"\r\n                    tippy=\"Configure fields of the custom global resources\">\r\n                    <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"vm.customResourcesFieldsCount || null\"\r\n                      matBadgePosition=\"below after\">dns</mat-icon>\r\n                  </button>\r\n                </td>\r\n              </tr>\r\n            </ng-container>\r\n            <!-- Resources for Primary App -->\r\n            <ng-container *ngIf=\"isPrimary\">\r\n              <tr>\r\n                <th>Site</th>\r\n                <td>\r\n                  <button mat-button (click)=\"edit(eavConstants.contentTypes.systemResources, SystemSettingsScopes.Site)\"\r\n                    tippy=\"Edit site system resources\">\r\n                    <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"vm.systemResourcesCount || null\"\r\n                      matBadgePosition=\"below after\">edit</mat-icon>\r\n                  </button>\r\n                </td>\r\n                <td>\r\n                  <button mat-button (click)=\"fixContentType(eavConstants.contentTypes.customResources, 'edit')\"\r\n                    tippy=\"Edit custom site resources\">\r\n                    <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"vm.customResourcesCount || null\"\r\n                      matBadgePosition=\"below after\">edit</mat-icon>\r\n                  </button>\r\n                  <button mat-button (click)=\"fixContentType(eavConstants.contentTypes.customResources, 'config')\"\r\n                    tippy=\"Configure fields of the custom site resources\">\r\n                    <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"vm.customResourcesFieldsCount || null\"\r\n                      matBadgePosition=\"below after\">dns</mat-icon>\r\n                  </button>\r\n                </td>\r\n              </tr>\r\n              <ng-container *ngTemplateOutlet=\"goToGlobal\"></ng-container>\r\n            </ng-container>\r\n            <!-- Resources for App and Content -->\r\n            <ng-container *ngIf=\"isApp\">\r\n              <tr>\r\n                <th>{{ dialogSettings.Context.App.Name }}</th>\r\n                <td>\r\n                  <button mat-button (click)=\"edit(eavConstants.contentTypes.systemResources, SystemSettingsScopes.App)\"\r\n                    tippy=\"Edit app system resources\">\r\n                    <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"vm.systemResourcesCount || null\"\r\n                      matBadgePosition=\"below after\">edit</mat-icon>\r\n                  </button>\r\n                </td>\r\n                <td>\r\n                  <button mat-button (click)=\"edit(eavConstants.contentTypes.resources)\"\r\n                    tippy=\"Edit custom app resources\">\r\n                    <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"vm.customResourcesCount || null\"\r\n                      matBadgePosition=\"below after\">edit</mat-icon>\r\n                  </button>\r\n                  <button mat-button (click)=\"config(eavConstants.contentTypes.resources)\"\r\n                    tippy=\"Configure fields of the custom app resources\">\r\n                    <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"vm.customResourcesFieldsCount || null\"\r\n                      matBadgePosition=\"below after\">dns</mat-icon>\r\n                  </button>\r\n                </td>\r\n              </tr>\r\n              <ng-container *ngTemplateOutlet=\"goToSite\"></ng-container>\r\n              <ng-container *ngTemplateOutlet=\"goToGlobal\"></ng-container>\r\n            </ng-container>\r\n          </tbody>\r\n        </table>\r\n      </mat-card-content>\r\n      <mat-card-actions>\r\n        <div class=\"actions-row\">\r\n          <ng-container *ngTemplateOutlet=\"docsLink; context: { link: 'https://go.2sxc.org/settings' }\"></ng-container>\r\n          <button mat-button (click)=\"analyze(AnalyzeParts.Resources)\" tippy=\"See the result of combining all resources\">\r\n            <mat-icon>manage_search</mat-icon>\r\n            <span>Analyze Combined Resources</span>\r\n          </button>\r\n        </div>\r\n      </mat-card-actions>\r\n    </mat-card>\r\n\r\n    <!-- Templates which are re-used in the table above -->\r\n    <ng-template #goToGlobal>\r\n      <tr>\r\n        <th>Global</th>\r\n        <td>\r\n          <button mat-button (click)=\"openGlobalSettings()\" tippy=\"Go to global\">\r\n            <mat-icon>open_in_new</mat-icon>\r\n          </button>\r\n        </td>\r\n      </tr>\r\n    </ng-template>\r\n\r\n    <ng-template #goToSite>\r\n      <tr>\r\n        <th>Site</th>\r\n        <td>\r\n          <button mat-button (click)=\"openSiteSettings()\" tippy=\"Go to site\">\r\n            <mat-icon>open_in_new</mat-icon>\r\n          </button>\r\n        </td>\r\n      </tr>\r\n    </ng-template>\r\n\r\n  </div>\r\n\r\n  <div class=\"cards-box\">\r\n    \r\n    <app-app-configuration-card [dialogSettings]=\"dialogSettings\">\r\n    </app-app-configuration-card>\r\n\r\n    <!-- LightSpeed -->\r\n    <mat-card class=\"mat-elevation-z2\">\r\n      <mat-card-header>\r\n        <mat-card-title>Performance</mat-card-title>\r\n        <div class=\"mat-card-header-icon\">\r\n          <mat-icon>bolt</mat-icon>\r\n        </div>\r\n      </mat-card-header>\r\n      <mat-card-content>\r\n        LightSpeed Output Cache to speed up page by 50-90%\r\n\r\n        <app-feature-text-info [featureNameId]=\"'LightSpeedOutputCache'\" [asInfo]=\"true\"></app-feature-text-info>\r\n      </mat-card-content>\r\n      <mat-card-actions>\r\n        <ng-container *ngTemplateOutlet=\"docsLink; context: { link: 'https://go.2sxc.org/lightspeed' }\"></ng-container>\r\n        <button mat-button (click)=\"openLightSpeed()\" disabled=\"{{!vm.lightSpeedEnabled}}\">\r\n          <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"vm.appLightSpeedCount || null\"\r\n            matBadgePosition=\"below after\">bolt</mat-icon>\r\n          <span>Edit LightSpeed</span>\r\n        </button>\r\n      </mat-card-actions>\r\n    </mat-card>\r\n\r\n    <!-- Security / CSP -->\r\n    <mat-card class=\"mat-elevation-z2\">\r\n      <mat-card-header>\r\n        <mat-card-title>Security</mat-card-title>\r\n        <div class=\"mat-card-header-icon\">\r\n          <mat-icon>local_police</mat-icon>\r\n        </div>\r\n      </mat-card-header>\r\n      <mat-card-content>\r\n        ContentSecurityPolicy features in this App - for maximum control.\r\n\r\n        <app-feature-text-info [featureNameId]=\"'ContentSecurityPolicy'\" [asInfo]=\"true\"></app-feature-text-info>\r\n      </mat-card-content>\r\n      <mat-card-actions>\r\n        <ng-container *ngTemplateOutlet=\"docsLink; context: { link: 'https://go.2sxc.org/csp' }\"></ng-container>\r\n      </mat-card-actions>\r\n    </mat-card>\r\n    \r\n    <!-- Permissions -->\r\n    <mat-card class=\"mat-elevation-z2\">\r\n      <mat-card-header>\r\n        <mat-card-title>Permissions</mat-card-title>\r\n        <div class=\"mat-card-header-icon\">\r\n          <mat-icon>person</mat-icon>\r\n        </div>\r\n      </mat-card-header>\r\n      <mat-card-content>\r\n        Give access to the entire app (all data). Use with care.\r\n      </mat-card-content>\r\n      <mat-card-actions>\r\n        <div class=\"actions-row\">\r\n          <ng-container *ngTemplateOutlet=\"docsLink; context: { link: 'https://docs.2sxc.org/basics/app/permissions.html' }\"></ng-container>\r\n          <button mat-button [disabled]=\"!dialogSettings.Context.Enable.AppPermissions\" (click)=\"openPermissions()\">\r\n            <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" matBadgePosition=\"below after\"\r\n              [matBadge]=\"dialogSettings.Context.App.Permissions.Count || null\">person</mat-icon>\r\n            <span>\r\n              Edit Permissions\r\n              <ng-container *ngIf=\"!dialogSettings.Context.Enable.AppPermissions\">\r\n                <ng-container *ngIf=\"isGlobal\">\r\n                  (not on Global App)\r\n                </ng-container>\r\n                <ng-container *ngIf=\"isApp\">\r\n                  (not on Content)\r\n                </ng-container>\r\n              </ng-container>\r\n            </span>\r\n          </button>\r\n        </div>\r\n        <div class=\"actions-row\">\r\n          <ng-container *ngTemplateOutlet=\"docsLink; context: { link: 'https://patrons.2sxc.org/features/feat/PermissionsByLanguage' }\"></ng-container>\r\n          <button mat-button (click)=\"openLanguagePermissions(vm.langPermsEnabled)\">\r\n            <mat-icon [matBadgeHidden]=\"vm.langPermsEnabled\" matBadgeSize=\"small\" matBadge=\"💎\" matBadgePosition=\"below after\">\r\n              person\r\n            </mat-icon>\r\n            <span>Language Permissions</span>\r\n          </button>\r\n        </div>\r\n      </mat-card-actions>\r\n    </mat-card>\r\n  </div>\r\n\r\n</ng-container>\r\n\r\n<ng-template #docsLink let-icon let-label let-link=\"link\">\r\n  <a mat-button href=\"{{link}}\" target=\"_blank\" [tippy]=\"'online documentation'\">\r\n    <mat-icon>{{ icon ?? \"menu_book\" }}</mat-icon>\r\n    <span>{{ label }}</span>\r\n  </a>\r\n</ng-template>","import { ChangeDetectorRef, Component, Input, OnChanges, OnDestroy, OnInit, SimpleChanges, ViewContainerRef } from '@angular/core';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { ContentItemsService } from '../../content-items/services/content-items.service';\r\nimport { GlobalConfigService } from '../../edit/shared/store/ngrx-data';\r\nimport { GoToPermissions } from '../../permissions/go-to-permissions';\r\nimport { BaseComponent } from '../../shared/components/base-component/base.component';\r\nimport { eavConstants, SystemSettingsScope, SystemSettingsScopes } from '../../shared/constants/eav.constants';\r\nimport { convertFormToUrl } from '../../shared/helpers/url-prep.helper';\r\nimport { AppScopes } from '../../shared/models/dialog-context.models';\r\nimport { DialogSettings } from '../../shared/models/dialog-settings.model';\r\nimport { EditForm } from '../../shared/models/edit-form.model';\r\nimport { Context } from '../../shared/services/context';\r\nimport { DialogService } from '../../shared/services/dialog.service';\r\nimport { FeaturesService } from '../../shared/services/features.service';\r\nimport { AppAdminHelpers } from '../app-admin-helpers';\r\nimport { ContentTypeEdit } from '../models';\r\nimport { AppDialogConfigService, ContentTypesService } from '../services';\r\nimport { AppInternalsService } from '../services/app-internals.service';\r\nimport { ImportAppPartsService } from '../services/import-app-parts.service';\r\nimport { AnalyzePart, AnalyzeParts } from '../sub-dialogs/analyze-settings/analyze-settings.models';\r\nimport { Subject, Observable, combineLatest, map } from 'rxjs';\r\nimport { AppInternals } from '../models/app-internals.model';\r\nimport { FeatureNames } from '../../features/feature-names';\r\nimport { FeatureComponentBase } from '../../features/shared/base-feature.component';\r\nimport { MatDialog } from '@angular/material/dialog';\r\n\r\n@Component({\r\n  selector: 'app-app-configuration',\r\n  templateUrl: './app-configuration.component.html',\r\n  styleUrls: ['./app-configuration.component.scss'],\r\n})\r\nexport class AppConfigurationComponent extends BaseComponent implements OnInit, OnChanges, OnDestroy {\r\n  @Input() dialogSettings: DialogSettings;\r\n\r\n  eavConstants = eavConstants;\r\n  AnalyzeParts = AnalyzeParts;\r\n  SystemSettingsScopes = SystemSettingsScopes;\r\n  AppScopes = AppScopes;\r\n  isGlobal: boolean;\r\n  isPrimary: boolean;\r\n  isApp: boolean;\r\n  debugEnabled$ = this.globalConfigService.getDebugEnabled$();\r\n\r\n  // More proper ViewModel\r\n  appSettingsInternal$ = new Subject<AppInternals>();\r\n  viewModel$: Observable<AppConfigurationViewModel>;\r\n\r\n  public appStateAdvanced = false;\r\n\r\n  public features: FeaturesService = new FeaturesService();\r\n\r\n  constructor(\r\n    protected router: Router,\r\n    protected route: ActivatedRoute,\r\n    private contentItemsService: ContentItemsService,\r\n    private context: Context,\r\n    private importAppPartsService: ImportAppPartsService,\r\n    private snackBar: MatSnackBar,\r\n    private dialogService: DialogService,\r\n    private appInternalsService: AppInternalsService,\r\n    private contentTypesService: ContentTypesService,\r\n    private globalConfigService: GlobalConfigService,\r\n    appDialogConfigService: AppDialogConfigService,\r\n    private dialog: MatDialog,\r\n    private viewContainerRef: ViewContainerRef,\r\n    private changeDetectorRef: ChangeDetectorRef\r\n  ) {\r\n    super(router, route);\r\n    this.features.loadFromService(appDialogConfigService);\r\n\r\n    // New with proper ViewModel\r\n    this.viewModel$ = combineLatest([\r\n      this.appSettingsInternal$,\r\n      this.features.isEnabled$(FeatureNames.LightSpeed),\r\n      this.features.isEnabled$(FeatureNames.ContentSecurityPolicy),\r\n      this.features.isEnabled$(FeatureNames.PermissionsByLanguage),\r\n    ]).pipe(map(([settings, lightSpeedEnabled, cspEnabled, langPermsEnabled]) => {\r\n      const result: AppConfigurationViewModel = {\r\n        lightSpeedEnabled,\r\n        cspEnabled,\r\n        langPermsEnabled,\r\n        appLightSpeedCount: settings.MetadataList.Items.filter(i => i._Type.Name == eavConstants.appMetadata.LightSpeed.ContentTypeName).length,\r\n        systemSettingsCount: this.isPrimary\r\n          ? settings.EntityLists.SettingsSystem.filter(i => i.SettingsEntityScope === SystemSettingsScopes.Site).length\r\n          : settings.EntityLists.SettingsSystem.filter(i => !i.SettingsEntityScope).length,\r\n        customSettingsCount: settings.EntityLists.AppSettings?.length,\r\n        customSettingsFieldsCount: settings.FieldAll.AppSettings?.length,\r\n        systemResourcesCount: this.isPrimary\r\n          ? settings.EntityLists.ResourcesSystem.filter(i => i.SettingsEntityScope === SystemSettingsScopes.Site).length\r\n          : settings.EntityLists.ResourcesSystem.filter(i => !i.SettingsEntityScope).length,\r\n        customResourcesCount: settings.EntityLists.AppResources?.length,\r\n        customResourcesFieldsCount: settings.FieldAll.AppResources?.length,\r\n      }\r\n      return result;\r\n    }));\r\n  }\r\n\r\n\r\n  ngOnInit() {\r\n    this.fetchSettings();\r\n    this.subscription.add(this.refreshOnChildClosedDeep().subscribe(() => { this.fetchSettings(); }));\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (changes.dialogSettings != null) {\r\n      const appScope = this.dialogSettings.Context.App.SettingsScope;\r\n      this.isGlobal = appScope === AppScopes.Global;\r\n      this.isPrimary = appScope === AppScopes.Site;\r\n      this.isApp = appScope === AppScopes.App;\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.snackBar.dismiss();\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  edit(staticName: string, systemSettingsScope?: SystemSettingsScope) {\r\n    this.contentItemsService.getAll(staticName).subscribe(contentItems => {\r\n      let form: EditForm;\r\n\r\n      switch (staticName) {\r\n        case eavConstants.contentTypes.systemSettings:\r\n        case eavConstants.contentTypes.systemResources:\r\n          const systemSettingsEntities = contentItems.filter(i => systemSettingsScope === SystemSettingsScopes.App\r\n            ? !i.SettingsEntityScope\r\n            : i.SettingsEntityScope === SystemSettingsScopes.Site);\r\n          if (systemSettingsEntities.length > 1) {\r\n            throw new Error(`Found too many settings for type ${staticName}`);\r\n          }\r\n          const systemSettingsEntity = systemSettingsEntities[0];\r\n          form = {\r\n            items: [\r\n              systemSettingsEntity == null\r\n                ? {\r\n                  ContentTypeName: staticName,\r\n                  Prefill: {\r\n                    ...(systemSettingsScope === SystemSettingsScopes.Site && { SettingsEntityScope: SystemSettingsScopes.Site }),\r\n                  }\r\n                }\r\n                : { EntityId: systemSettingsEntity.Id }\r\n            ],\r\n          };\r\n          break;\r\n        case eavConstants.contentTypes.customSettings:\r\n        case eavConstants.contentTypes.customResources:\r\n          if (contentItems.length > 1) {\r\n            throw new Error(`Found too many settings for type ${staticName}`);\r\n          }\r\n          const customSettingsEntity = contentItems[0];\r\n          form = {\r\n            items: [\r\n              customSettingsEntity == null\r\n                ? { ContentTypeName: staticName }\r\n                : { EntityId: customSettingsEntity.Id }\r\n            ],\r\n          };\r\n          break;\r\n        default:\r\n          if (contentItems.length < 1) throw new Error(`Found no settings for type ${staticName}`);\r\n          if (contentItems.length > 1) throw new Error(`Found too many settings for type ${staticName}`);\r\n          form = {\r\n            items: [{ EntityId: contentItems[0].Id }],\r\n          };\r\n      }\r\n\r\n      const formUrl = convertFormToUrl(form);\r\n      this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route.firstChild });\r\n    });\r\n  }\r\n\r\n  openLightSpeed() {\r\n    const form = AppAdminHelpers.getLightSpeedEditParams(this.context.appId);\r\n    const formUrl = convertFormToUrl(form);\r\n    this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  openSiteSettings() {\r\n    const sitePrimaryApp = this.dialogSettings.Context.Site.PrimaryApp;\r\n    this.dialogService.openAppAdministration(sitePrimaryApp.ZoneId, sitePrimaryApp.AppId, 'app');\r\n  }\r\n\r\n  openGlobalSettings() {\r\n    const globalPrimaryApp = this.dialogSettings.Context.System.PrimaryApp;\r\n    this.dialogService.openAppAdministration(globalPrimaryApp.ZoneId, globalPrimaryApp.AppId, 'app');\r\n  }\r\n\r\n  config(staticName: string) {\r\n    this.router.navigate([`fields/${staticName}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  openPermissions() {\r\n    this.router.navigate([GoToPermissions.getUrlApp(this.context.appId)], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  openLanguagePermissions(enabled: boolean) {\r\n    if (enabled)\r\n      this.router.navigate(['language-permissions'], { relativeTo: this.route.firstChild });\r\n    else\r\n      FeatureComponentBase.openDialog(this.dialog, FeatureNames.PermissionsByLanguage, this.viewContainerRef, this.changeDetectorRef);\r\n  }\r\n\r\n  analyze(part: AnalyzePart) {\r\n    this.router.navigate([`analyze/${part}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private fetchSettings() {\r\n    const getObservable = this.appInternalsService.getAppInternals(eavConstants.metadata.app.targetType, eavConstants.metadata.app.keyType, this.context.appId);\r\n    getObservable.subscribe(x => {\r\n      // 2dm - New mode for Reactive UI\r\n      this.appSettingsInternal$.next(x);\r\n      });\r\n  }\r\n\r\n  fixContentType(staticName: string, action: 'edit' | 'config') {\r\n    this.contentTypesService.retrieveContentTypes(eavConstants.scopes.configuration.value).subscribe(contentTypes => {\r\n      const contentTypeExists = contentTypes.some(ct => ct.Name === staticName);\r\n      if (contentTypeExists) {\r\n        if (action === 'edit') {\r\n          this.edit(staticName);\r\n        } else if (action === 'config') {\r\n          this.config(staticName);\r\n        }\r\n      } else {\r\n        const newContentType = {\r\n          StaticName: '',\r\n          Name: staticName,\r\n          Description: '',\r\n          Scope: eavConstants.scopes.configuration.value,\r\n          ChangeStaticName: false,\r\n          NewStaticName: '',\r\n        } as ContentTypeEdit;\r\n        this.contentTypesService.save(newContentType).subscribe(success => {\r\n          if (!success) { return; }\r\n\r\n          if (action === 'edit') {\r\n            this.edit(staticName);\r\n          } else if (action === 'config') {\r\n            this.config(staticName);\r\n          }\r\n        });\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nclass AppConfigurationViewModel {\r\n  // Lightspeed\r\n  lightSpeedEnabled: boolean;\r\n  appLightSpeedCount: number;\r\n\r\n  // CSP\r\n  cspEnabled: boolean;\r\n\r\n  // Language Permissions\r\n  langPermsEnabled: boolean;\r\n\r\n  systemSettingsCount: number;\r\n  customSettingsCount: number;\r\n  customSettingsFieldsCount: number;\r\n  systemResourcesCount: number;\r\n  customResourcesCount: number;\r\n  customResourcesFieldsCount: number;\r\n}","<ng-container>\r\n  <div class=\"cards-box\">\r\n    <mat-card class=\"mat-elevation-z2\">\r\n      <mat-card-header>\r\n        <mat-card-title>Instructions for Sync or Export/Import</mat-card-title>\r\n        <div class=\"mat-card-header-icon\">\r\n          <mat-icon>info</mat-icon>\r\n        </div>\r\n      </mat-card-header>\r\n      <mat-card-content>\r\n        <p>\r\n          This section is for export/import of the entire App,\r\n          for synchronizing with the file storage (eg. for Git)\r\n          or to export parts of the App for re-import in another App.\r\n        </p>\r\n        <p>\r\n          To export/import Content-Types, Queries, Views or Data, use the respective tabs.\r\n        </p>\r\n      </mat-card-content>\r\n    </mat-card>\r\n  </div>\r\n  <div class=\"cards-box\">\r\n    <mat-card class=\"mat-elevation-z2\">\r\n      <mat-card-header>\r\n        <mat-card-title>Export this entire App</mat-card-title>\r\n        <div class=\"mat-card-header-icon\">\r\n          <mat-icon>cloud_download</mat-icon>\r\n        </div>\r\n      </mat-card-header>\r\n      <mat-card-content>\r\n        Create an package (zip) which can be installed in another site.\r\n      </mat-card-content>\r\n      <mat-card-actions>\r\n        <button mat-button (click)=\"exportApp()\">\r\n          <mat-icon>cloud_download</mat-icon>\r\n          <span>Export App</span>\r\n        </button>\r\n      </mat-card-actions>\r\n    </mat-card>\r\n\r\n    <mat-card class=\"mat-elevation-z2\">\r\n      <mat-card-header>\r\n        <mat-card-title>Export or Import parts of this App</mat-card-title>\r\n        <div class=\"mat-card-header-icon\">\r\n          <mat-icon>import_export</mat-icon>\r\n        </div>\r\n      </mat-card-header>\r\n      <mat-card-content>\r\n        Create an xml containing parts of the app, e.g. content and templates.\r\n        Import parts from such an xml into this app.\r\n      </mat-card-content>\r\n      <mat-card-actions>\r\n        <button mat-button (click)=\"exportParts()\">\r\n          <mat-icon>cloud_download</mat-icon>\r\n          <span>Export Parts</span>\r\n        </button>\r\n        <button mat-button (click)=\"importParts()\">\r\n          <mat-icon>cloud_upload</mat-icon>\r\n          <span>Import Parts</span>\r\n        </button>\r\n      </mat-card-actions>\r\n    </mat-card>\r\n  </div>\r\n\r\n  <div class=\"cards-box\">\r\n    <mat-card class=\"mat-elevation-z2\">\r\n      <mat-card-header>\r\n        <mat-card-title>App-State Versioning</mat-card-title>\r\n        <mat-slide-toggle [(ngModel)]=\"appStateAdvanced\">{{ appStateAdvanced ? \"advanced\" : \"basic\" }}</mat-slide-toggle>\r\n        <div class=\"mat-card-header-icon\">\r\n          <mat-icon>history_toggle_off</mat-icon>\r\n        </div>\r\n      </mat-card-header>\r\n      <mat-card-content>\r\n        You can save / restore the app with data and configuration in <code>.data/app.xml</code>.\r\n        This file can then also be versioned using git.\r\n        <div *ngIf=\"appStateAdvanced\">\r\n          <br>\r\n          In Advanced mode you can also sync all the site files used by this app.\r\n          They will be placed in a folder inside <code>App_Data</code> and allow sync/restore with git or another server.\r\n        </div>\r\n      </mat-card-content>\r\n      <app-feature-text-info *ngIf=\"appStateAdvanced\" [featureNameId]=\"'AppSyncWithSiteFiles'\"></app-feature-text-info>\r\n      <mat-card-actions>\r\n        <ng-container *ngIf=\"!appStateAdvanced\">\r\n          <button mat-button (click)=\"exportAppXml(false)\">\r\n            <mat-icon>more_time</mat-icon>\r\n            <span>Save state</span>\r\n          </button>\r\n          <button mat-button (click)=\"resetApp(false)\">\r\n            <mat-icon>restore</mat-icon>\r\n            <span>Restore state</span>\r\n          </button>\r\n        </ng-container>\r\n        <ng-container *ngIf=\"appStateAdvanced\">\r\n          <button mat-button (click)=\"exportAppXml(true)\">\r\n            <mat-icon>more_time</mat-icon>\r\n            <span>Save with Assets</span>\r\n          </button>\r\n          <button mat-button (click)=\"resetApp(true)\">\r\n            <mat-icon>restore</mat-icon>\r\n            <span>Restore with Assets</span>\r\n          </button>\r\n        </ng-container>\r\n\r\n      </mat-card-actions>\r\n    </mat-card>\r\n  </div>\r\n</ng-container>\r\n","import { HttpErrorResponse } from '@angular/common/http';\r\nimport { Component, Input, OnDestroy, OnInit } from '@angular/core';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { BaseComponent } from '../../shared/components/base-component/base.component';\r\nimport { DialogSettings } from '../../shared/models/dialog-settings.model';\r\nimport { ExportAppService } from '../services/export-app.service';\r\nimport { ImportAppPartsService } from '../services/import-app-parts.service';\r\n\r\n@Component({\r\n  selector: 'app-sync-configuration',\r\n  templateUrl: './sync-configuration.component.html',\r\n  styleUrls: ['./sync-configuration.component.scss'],\r\n})\r\nexport class SyncConfigurationComponent extends BaseComponent implements OnInit, OnDestroy {\r\n  @Input() dialogSettings: DialogSettings;\r\n\r\n  public appStateAdvanced = false;\r\n\r\n  constructor(\r\n    protected router: Router,\r\n    protected route: ActivatedRoute,\r\n    private exportAppService: ExportAppService,\r\n    private importAppPartsService: ImportAppPartsService,\r\n    private snackBar: MatSnackBar,\r\n  ) {\r\n    super(router, route);\r\n  }\r\n\r\n  ngOnInit() {}\r\n\r\n  ngOnDestroy() {\r\n    this.snackBar.dismiss();\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  exportApp() {\r\n    this.router.navigate([`export`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  exportParts() {\r\n    this.router.navigate([`export/parts`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  importParts() {\r\n    this.router.navigate([`import/parts`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  exportAppXml(withFiles: boolean) {\r\n    this.snackBar.open('Exporting...');\r\n    this.exportAppService.exportForVersionControl({ includeContentGroups: true, resetAppGuid: false, withFiles }).subscribe({\r\n      next: result => {\r\n        this.snackBar.open('Export completed into the \\'App_Data\\' folder.', null, { duration: 3000 });\r\n      },\r\n      error: (error: HttpErrorResponse) => {\r\n        this.snackBar.open('Export failed. Please check console for more information', null, { duration: 3000 });\r\n      },\r\n    });\r\n  }\r\n\r\n  resetApp(withFiles: boolean) {\r\n    if (!confirm('Are you sure? All changes since last xml export will be lost')) { return; }\r\n    this.snackBar.open('Resetting...');\r\n    this.importAppPartsService.resetApp(withFiles).subscribe({\r\n      next: result => {\r\n        this.snackBar.open(\r\n          'Reset worked! Since this is a complex operation, please restart the Website to ensure all caches are correct',\r\n          null,\r\n          { duration: 30000 },\r\n        );\r\n      },\r\n      error: (error: HttpErrorResponse) => {\r\n        this.snackBar.open('Reset failed. Please check console for more information', null, { duration: 3000 });\r\n      },\r\n    });\r\n  }\r\n}","<div class=\"nav-component-wrapper\" appToggleDebug *ngIf=\"viewModel$ | async as vm\">\r\n  <div mat-dialog-title>\r\n    <div class=\"dialog-title-box\">\r\n      <div>\r\n        <ng-container *ngIf=\"vm.dialogSettings?.Context.App.SettingsScope === AppScopes.Global\">\r\n          Global\r\n        </ng-container>\r\n        <ng-container *ngIf=\"vm.dialogSettings?.Context.App.SettingsScope !== AppScopes.Global\">\r\n          {{ vm.dialogSettings?.Context.App.Name }}\r\n        </ng-container>\r\n        Admin\r\n      </div>\r\n      <button mat-icon-button tippy=\"Close dialog\" (click)=\"closeDialog()\">\r\n        <mat-icon>close</mat-icon>\r\n      </button>\r\n    </div>\r\n  </div>\r\n\r\n  <router-outlet></router-outlet>\r\n\r\n  <!-- spm NOTE: we use mat-tab-group because mat-tab-nav-bar doesn't have animations and doesn't look pretty -->\r\n  <mat-tab-group class=\"mat-tab-group-max-height\" dynamicHeight color=\"accent\"\r\n    *ngIf=\"vm.dialogSettings && vm.tabIndex != null\" (selectedTabChange)=\"changeTab($event)\"\r\n    [selectedIndex]=\"vm.tabIndex\">\r\n    <mat-tab>\r\n      <div *matTabLabel class=\"mat-tab-label-box\" tippy=\"App Info\">\r\n        <mat-icon>info</mat-icon>\r\n        <span>Info</span>\r\n      </div>\r\n      <app-getting-started *matTabContent [gettingStartedUrl]=\"vm.dialogSettings.Context.App.GettingStartedUrl\">\r\n      </app-getting-started>\r\n    </mat-tab>\r\n\r\n    <mat-tab>\r\n      <div *matTabLabel class=\"mat-tab-label-box\" tippy=\"Data / Content\">\r\n        <mat-icon>menu</mat-icon>\r\n        <span>Data</span>\r\n      </div>\r\n      <app-data *matTabContent [enablePermissions]=\"vm.dialogSettings.Context.Enable.AppPermissions\"></app-data>\r\n    </mat-tab>\r\n\r\n    <mat-tab *ngIf=\"vm.dialogSettings.Context.Enable.Query\">\r\n      <div *matTabLabel class=\"mat-tab-label-box\" tippy=\"Queries / Visual Query Designer\">\r\n        <mat-icon>filter_list</mat-icon>\r\n        <span>Queries</span>\r\n      </div>\r\n      <app-queries *matTabContent [enablePermissions]=\"vm.dialogSettings.Context.Enable.AppPermissions\">\r\n      </app-queries>\r\n    </mat-tab>\r\n\r\n    <mat-tab>\r\n      <div *matTabLabel class=\"mat-tab-label-box\" tippy=\"Views / Templates\">\r\n        <mat-icon>layers</mat-icon>\r\n        <span>Views</span>\r\n      </div>\r\n      <app-views *matTabContent [enableCode]=\"vm.dialogSettings.Context.Enable.CodeEditor\"\r\n        [enablePermissions]=\"vm.dialogSettings.Context.Enable.AppPermissions\"\r\n        [appIsGlobal]=\"vm.dialogSettings.Context.App.IsShared\"\r\n        [appIsInherited]=\"vm.dialogSettings.Context.App.IsInherited\">\r\n      </app-views>\r\n    </mat-tab>\r\n\r\n    <mat-tab *ngIf=\"vm.dialogSettings.Context.Enable.Query\">\r\n      <div *matTabLabel class=\"mat-tab-label-box\" tippy=\"WebApi\">\r\n        <mat-icon>offline_bolt</mat-icon>\r\n        <span>WebApi</span>\r\n      </div>\r\n      <app-web-api *matTabContent [enableCode]=\"vm.dialogSettings.Context.Enable.CodeEditor\">\r\n      </app-web-api>\r\n    </mat-tab>\r\n\r\n    <mat-tab>\r\n      <div *matTabLabel class=\"mat-tab-label-box\" tippy=\"App Settings\">\r\n        <mat-icon>settings_applications</mat-icon>\r\n        <span>App</span>\r\n      </div>\r\n      <app-app-configuration *matTabContent [dialogSettings]=\"vm.dialogSettings\">\r\n      </app-app-configuration>\r\n    </mat-tab>\r\n\r\n    <mat-tab>\r\n      <div *matTabLabel class=\"mat-tab-label-box\" tippy=\"App Export / Import\">\r\n        <mat-icon>sync</mat-icon>\r\n        <span>Sync</span>\r\n      </div>\r\n      <app-sync-configuration *matTabContent [dialogSettings]=\"vm.dialogSettings\">\r\n      </app-sync-configuration>\r\n    </mat-tab>\r\n  </mat-tab-group>\r\n</div>","import { Component, OnDestroy, OnInit } from '@angular/core';\r\nimport { MatDialogRef } from '@angular/material/dialog';\r\nimport { MatTabChangeEvent } from '@angular/material/tabs';\r\nimport { ActivatedRoute, NavigationEnd, Router } from '@angular/router';\r\nimport { BehaviorSubject, combineLatest, filter, map, startWith } from 'rxjs';\r\nimport { BaseComponent } from '../../shared/components/base-component/base.component';\r\nimport { eavConstants } from '../../shared/constants/eav.constants';\r\nimport { UpdateEnvVarsFromDialogSettings } from '../../shared/helpers/update-env-vars-from-dialog-settings.helper';\r\nimport { AppScopes } from '../../shared/models/dialog-context.models';\r\nimport { DialogSettings } from '../../shared/models/dialog-settings.model';\r\nimport { AppDialogConfigService } from '../services/app-dialog-config.service';\r\n\r\n@Component({\r\n  selector: 'app-app-administration-nav',\r\n  templateUrl: './app-administration-nav.component.html',\r\n  styleUrls: ['./app-administration-nav.component.scss'],\r\n})\r\nexport class AppAdministrationNavComponent extends BaseComponent implements OnInit, OnDestroy {\r\n  AppScopes = AppScopes;\r\n\r\n  private dialogSettings$ = new BehaviorSubject<DialogSettings>(undefined);\r\n  private tabs$ = new BehaviorSubject<string[]>(undefined);\r\n  private tabIndex$ = combineLatest([\r\n    this.tabs$,\r\n    this.router.events.pipe(\r\n      filter(event => event instanceof NavigationEnd),\r\n      map(() => this.route.snapshot.firstChild.url[0].path),\r\n      startWith(this.route.snapshot.firstChild.url[0].path),\r\n    )\r\n  ]).pipe(\r\n    map(([tabs, path]) => {\r\n      if (tabs == null) { return; }\r\n      const tabIndex = tabs.indexOf(path);\r\n      return tabIndex;\r\n    }),\r\n    filter(tabIndex => tabIndex >= 0),\r\n  );\r\n  viewModel$ = combineLatest([this.dialogSettings$, this.tabIndex$]).pipe(\r\n    map(([dialogSettings, tabIndex]) => ({ dialogSettings, tabIndex })),\r\n  );\r\n\r\n  constructor(\r\n    protected router: Router,\r\n    protected route: ActivatedRoute,\r\n    private dialogRef: MatDialogRef<AppAdministrationNavComponent>,\r\n    private appDialogConfigService: AppDialogConfigService,\r\n  ) { \r\n    super(router, route);\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.fetchDialogSettings();\r\n    this.subscription.add(this.refreshOnChildClosedDeep().subscribe(() => { this.fetchDialogSettings(); }));\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.dialogSettings$.complete();\r\n    this.tabs$.complete();\r\n    super.ngOnDestroy();\r\n  }\r\n\r\n  closeDialog() {\r\n    this.dialogRef.close();\r\n  }\r\n\r\n  changeTab(event: MatTabChangeEvent) {\r\n    let path = this.tabs$.value[event.index];\r\n    if (path === 'data') {\r\n      path = `data/${eavConstants.scopes.default.value}`;\r\n    }\r\n    this.router.navigate([path], { relativeTo: this.route });\r\n  }\r\n\r\n  private fetchDialogSettings() {\r\n    this.appDialogConfigService.getShared$()/*.getDialogSettings()*/.subscribe(dialogSettings => {\r\n      UpdateEnvVarsFromDialogSettings(dialogSettings.Context.App);\r\n      this.dialogSettings$.next(dialogSettings);\r\n\r\n      let tabs = ['home', 'data', 'queries', 'views', 'web-api', 'app', 'sync']; // tabs order has to match template\r\n      if (!dialogSettings.Context.Enable.Query) {\r\n        tabs = tabs.filter(tab => tab !== 'queries' && tab !== 'web-api');\r\n      }\r\n      this.tabs$.next(tabs);\r\n    });\r\n  }\r\n}\r\n","/**\r\n * Do not reuse regex:\r\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/test#using_test_on_a_regex_with_the_global_flag\r\n */\r\nexport function guidRegex(): RegExp {\r\n  return /^[a-f0-9]{8}(?:-[a-f0-9]{4}){3}-[a-f0-9]{12}$/i;\r\n}\r\n"],"sourceRoot":"webpack:///","file":"projects_eav-ui_src_app_app-administration_app-administration-nav_app-administration-nav_comp-1b3e30.44acbafcac0afd3f.js"}