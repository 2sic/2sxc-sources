{"version":3,"sources":["./src/app/replace-content/replace-content.component.html","./src/app/replace-content/replace-content.component.ts"],"names":["dialogRef","contentGroupService","router","route","snackBar","subscription","this","hasChild","snapshot","firstChild","item","id","guid","paramMap","get","part","index","parseInt","ngOnInit","getConfig","refreshOnChildClosed","ngOnDestroy","unsubscribe","save","open","saveItem","subscribe","duration","closeDialog","copySelected","navigate","JSON","stringify","items","ContentTypeName","contentTypeName","DuplicateEntity","relativeTo","close","getItems","replaceConfig","itemKeys","Object","keys","Items","options","nKey","push","label","value","SelectedId","add","events","pipe","event","hadChild","editResult","getCurrentNavigation","extras","state","ReplaceContentComponent"],"mappings":"0XAcM,wBAAkE,QAAkB,Q,uBAAzC,sBAAuB,uBCFxE,iBAaE,WACUA,EACAC,EACAC,EACAC,EACAC,GAJA,KAAAJ,YACA,KAAAC,sBACA,KAAAC,SACA,KAAAC,QACA,KAAAC,WARF,KAAAC,aAAe,IAAI,IAUzBC,KAAKC,WAAaD,KAAKH,MAAMK,SAASC,WACtCH,KAAKI,KAAO,CACVC,GAAI,KACJC,KAAMN,KAAKH,MAAMK,SAASK,SAASC,IAAI,QACvCC,KAAMT,KAAKH,MAAMK,SAASK,SAASC,IAAI,QACvCE,MAAOC,SAASX,KAAKH,MAAMK,SAASK,SAASC,IAAI,SAAU,K,OAI/D,YAAAI,SAAA,WACEZ,KAAKa,YACLb,KAAKc,wBAGP,YAAAC,YAAA,WACEf,KAAKD,aAAaiB,cAClBhB,KAAKD,aAAe,MAGtB,YAAAkB,KAAA,sBACEjB,KAAKF,SAASoB,KAAK,aACnBlB,KAAKL,oBAAoBwB,SAASnB,KAAKI,MAAMgB,WAAU,WACrD,EAAKtB,SAASoB,KAAK,QAAS,KAAM,CAAEG,SAAU,MAC9C,EAAKC,kBAIT,YAAAC,aAAA,WAIEvB,KAAKJ,OAAO4B,SAAS,CAAC,QAAQC,KAAKC,UAHZ,CACrBC,MAAO,CAAC,CAAEC,gBAAiB5B,KAAK6B,gBAAiBC,gBAAiB9B,KAAKI,KAAKC,QAEvB,CAAE0B,WAAY/B,KAAKH,SAG5E,YAAAyB,YAAA,WACEtB,KAAKN,UAAUsC,SAGT,YAAAnB,UAAR,sBACEb,KAAKL,oBAAoBsC,SAASjC,KAAKI,MAAMgB,WAAU,SAAAc,G,QAC/CC,EAAWC,OAAOC,KAAKH,EAAcI,OAC3C,EAAKC,QAAU,G,IACf,IAAkB,kBAAAJ,GAAQ,8BAAE,CAAvB,IACGK,EAAO7B,SADD,QACe,IAE3B,EAAK4B,QAAQE,KAAK,CAAEC,MADHR,EAAcI,MAAME,GACC,KAAKA,EAAI,IAAKG,MAAOH,K,iGAExD,EAAKpC,KAAKC,KACb,EAAKD,KAAKC,GAAK6B,EAAcU,YAE1B,EAAKf,kBACR,EAAKA,gBAAkBK,EAAcN,qBAKnC,YAAAd,qBAAR,sBACEd,KAAKD,aAAa8C,IAChB7C,KAAKJ,OAAOkD,OAAOC,KAAK,aAAO,SAAAC,GAAS,OAAAA,aAAiB,QAAgB5B,WAAU,SAAC4B,G,MAC5EC,EAAW,EAAKhD,SAEtB,GADA,EAAKA,WAAa,EAAKJ,MAAMK,SAASC,YACjC,EAAKF,UAAYgD,EAAU,CAC9B,EAAKpC,YACL,IACMqC,EAA8B,QAApB,EADG,EAAKtD,OAAOuD,uBACDC,cAAM,eAAEC,MAClCH,IACF,EAAK9C,KAAKC,GAAK6C,EAAWd,OAAOC,KAAKa,GAAY,W,sCAjFjDI,GAAuB,oD,uBAAvBA,EAAuB,6gBDjBpC,gBACE,gBAA8B,+BAAoB,OACpD,OAEA,wBAEA,cACE,kHACF,OAEA,gBACE,2BACE,oBAAW,sBAAW,OACtB,wBAAY,wDACV,8BACF,OACF,OACA,oBAAoE,gCAAS,EAAA/B,kBAC3E,oBAAU,qBAAS,OACrB,OACF,OAEA,iBACE,oBAA0B,gCAAS,EAAAD,iBAAe,kBAAM,OACxD,qBAAyC,gCAAS,EAAAL,UAAQ,gBAAI,OAChE,Q,MAZgB,mCACE,oC,sPCFlB","file":"45.js","sourcesContent":["<div mat-dialog-title>\r\n  <div class=\"dialog-title-box\">Replace Content Item</div>\r\n</div>\r\n\r\n<router-outlet></router-outlet>\r\n\r\n<p class=\"dialog-description\">\r\n  By replacing a content-item you can make a other content appear in the slot of the original content.\r\n</p>\r\n\r\n<div class=\"options-box\">\r\n  <mat-form-field class=\"options-box__field\" appearance=\"standard\" color=\"accent\">\r\n    <mat-label>Choose item</mat-label>\r\n    <mat-select [(ngModel)]=\"item.id\" name=\"Language\">\r\n      <mat-option *ngFor=\"let option of options\" [value]=\"option.value\">{{ option.label }}</mat-option>\r\n    </mat-select>\r\n  </mat-form-field>\r\n  <button mat-icon-button class=\"options-box__copy\" matTooltip=\"Copy\" (click)=\"copySelected()\">\r\n    <mat-icon>file_copy</mat-icon>\r\n  </button>\r\n</div>\r\n\r\n<div class=\"dialog-actions-box\">\r\n  <button mat-raised-button (click)=\"closeDialog()\">Cancel</button>\r\n  <button mat-raised-button color=\"accent\" (click)=\"save()\">Save</button>\r\n</div>\r\n","import { Component, OnInit, OnDestroy } from '@angular/core';\r\nimport { Router, ActivatedRoute, NavigationEnd } from '@angular/router';\r\nimport { Subscription } from 'rxjs';\r\nimport { filter } from 'rxjs/operators';\r\nimport { MatDialogRef } from '@angular/material/dialog';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\n\r\nimport { ContentGroupService } from '../manage-content-list/services/content-group.service';\r\nimport { ReplaceOption } from './models/replace-option.model';\r\nimport { ContentGroup } from '../manage-content-list/models/content-group.model';\r\nimport { EditForm } from '../app-administration/shared/models/edit-form.model';\r\n\r\n@Component({\r\n  selector: 'app-replace-content',\r\n  templateUrl: './replace-content.component.html',\r\n  styleUrls: ['./replace-content.component.scss']\r\n})\r\nexport class ReplaceContentComponent implements OnInit, OnDestroy {\r\n  options: ReplaceOption[];\r\n  item: ContentGroup;\r\n  contentTypeName: string;\r\n\r\n  private subscription = new Subscription();\r\n  private hasChild: boolean;\r\n\r\n  constructor(\r\n    private dialogRef: MatDialogRef<ReplaceContentComponent>,\r\n    private contentGroupService: ContentGroupService,\r\n    private router: Router,\r\n    private route: ActivatedRoute,\r\n    private snackBar: MatSnackBar,\r\n  ) {\r\n    this.hasChild = !!this.route.snapshot.firstChild;\r\n    this.item = {\r\n      id: null,\r\n      guid: this.route.snapshot.paramMap.get('guid'),\r\n      part: this.route.snapshot.paramMap.get('part'),\r\n      index: parseInt(this.route.snapshot.paramMap.get('index'), 10),\r\n    };\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.getConfig();\r\n    this.refreshOnChildClosed();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.subscription.unsubscribe();\r\n    this.subscription = null;\r\n  }\r\n\r\n  save() {\r\n    this.snackBar.open('Saving...');\r\n    this.contentGroupService.saveItem(this.item).subscribe(() => {\r\n      this.snackBar.open('Saved', null, { duration: 2000 });\r\n      this.closeDialog();\r\n    });\r\n  }\r\n\r\n  copySelected() {\r\n    const form: EditForm = {\r\n      items: [{ ContentTypeName: this.contentTypeName, DuplicateEntity: this.item.id }],\r\n    };\r\n    this.router.navigate([`edit/${JSON.stringify(form)}`], { relativeTo: this.route });\r\n  }\r\n\r\n  closeDialog() {\r\n    this.dialogRef.close();\r\n  }\r\n\r\n  private getConfig() {\r\n    this.contentGroupService.getItems(this.item).subscribe(replaceConfig => {\r\n      const itemKeys = Object.keys(replaceConfig.Items);\r\n      this.options = [];\r\n      for (const key of itemKeys) {\r\n        const nKey = parseInt(key, 10);\r\n        const itemName = replaceConfig.Items[nKey];\r\n        this.options.push({ label: `${itemName} (${nKey})`, value: nKey });\r\n      }\r\n      if (!this.item.id) {\r\n        this.item.id = replaceConfig.SelectedId;\r\n      }\r\n      if (!this.contentTypeName) {\r\n        this.contentTypeName = replaceConfig.ContentTypeName;\r\n      }\r\n    });\r\n  }\r\n\r\n  private refreshOnChildClosed() {\r\n    this.subscription.add(\r\n      this.router.events.pipe(filter(event => event instanceof NavigationEnd)).subscribe((event: NavigationEnd) => {\r\n        const hadChild = this.hasChild;\r\n        this.hasChild = !!this.route.snapshot.firstChild;\r\n        if (!this.hasChild && hadChild) {\r\n          this.getConfig();\r\n          const navigation = this.router.getCurrentNavigation();\r\n          const editResult = navigation.extras?.state;\r\n          if (editResult) {\r\n            this.item.id = editResult[Object.keys(editResult)[0]];\r\n          }\r\n        }\r\n      })\r\n    );\r\n  }\r\n\r\n}\r\n"],"sourceRoot":"webpack:///"}