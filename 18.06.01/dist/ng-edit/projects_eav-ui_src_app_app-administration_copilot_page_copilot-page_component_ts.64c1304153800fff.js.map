{"version":3,"file":"projects_eav-ui_src_app_app-administration_copilot_page_copilot-page_component_ts.64c1304153800fff.js","mappings":"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","names":["CopilotService","this","webApiEditions","webApiGeneratedCode","constructor","http","context","log","classLog","specs","#getCopilotSpecs","getEditions","pipe","map","data","editions","getDefaultEdition","find","e","isDefault","getGenerators","generators","get","_a","params","appId","toString","defaultOrFirst","#findDefaultEdition","d","description","label","name","replace","shareReplay","i0","i1","i2","factory","ɵfac","generator_r3","version","ctx","descriptionHtml","$event","_r1","ctx_r1","selectedGenerator","CopilotGeneratorComponent_Conditional_9_For_7_Template","CopilotGeneratorComponent_Conditional_9_Conditional_8_Template","sort","tmp_5_0","selectedGenerator$","edition_r5","_r4","selectedEdition","CopilotGeneratorComponent_Conditional_12_For_5_Template","CopilotGeneratorComponent","snackBar","outputType","input","title","copilotSvc","transient","editions$","generators$","gens","filter","g","ngOnInit","take","subscribe","autoGeneratedCode","edition","generator","console","open","message","timeTaken","duration","i3","selectors","inputs","standalone","features","decls","vars","consts","template","rf","CopilotGeneratorComponent_Conditional_9_Template","CopilotGeneratorComponent_Conditional_12_Template","tmp_1_0","tmp_2_0","MatSelectModule","i4","i5","i6","MatButtonModule","i7","MatCardModule","i8","MatIconModule","i9","CommonModule","i10","encapsulation","CopilotPageComponent","activatedRoute","snapshot","heading","intro","styles"],"ignoreList":[],"sourceRoot":"webpack:///","sources":["./projects/eav-ui/src/app/app-administration/copilot/copilot-service.ts","./projects/eav-ui/src/app/app-administration/copilot/copilot-generator.component.html","./projects/eav-ui/src/app/app-administration/copilot/copilot-generator.component.ts","./projects/eav-ui/src/app/app-administration/copilot/page/copilot-page.component.ts","./projects/eav-ui/src/app/app-administration/copilot/page/copilot-page.component.html"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Context } from '../../shared/services/context';\r\nimport { EditionData, EditionDataDto } from './edition-data';\r\nimport { map, shareReplay } from 'rxjs';\r\nimport { Edition, EditionDto } from './edition';\r\nimport { classLog } from '../../shared/logging';\r\n\r\n@Injectable()\r\nexport class CopilotService {\r\n  \r\n  log = classLog({CopilotService});\r\n\r\n  static webApiEditions: string = 'admin/code/getEditions';\r\n  static webApiGeneratedCode: string = 'admin/code/generateDataModels';\r\n\r\n  public specs = this.#getCopilotSpecs();\r\n\r\n  constructor(private http: HttpClient, private context: Context) { }\r\n\r\n  getEditions() {\r\n    return this.specs.pipe(map(data => data.editions));\r\n  }\r\n\r\n  getDefaultEdition() {\r\n    return this.specs.pipe(map(data => data.editions.find(e => e.isDefault)));\r\n  }\r\n\r\n  getGenerators() {\r\n    return this.specs.pipe(map(data => data.generators));\r\n  }\r\n\r\n  #getCopilotSpecs() {\r\n    return this.http.get<EditionDataDto>(CopilotService.webApiEditions, {\r\n      params: {\r\n        appId: this.context.appId.toString()\r\n      }\r\n    }).pipe(\r\n      map((data) => {\r\n        const defaultOrFirst = this.#findDefaultEdition(data.editions);\r\n        const editions = data.editions.map(d => {\r\n          const isDefault = d == defaultOrFirst;\r\n          return {\r\n            ...d,\r\n            isDefault,\r\n            description: (d.description || \"no description provided\") + (isDefault ? ' ✅' : ''),\r\n            label: `/${d.name}/AppCode/Data`.replace(/\\/\\//g, '/'),\r\n          } as Edition;\r\n        });\r\n\r\n        return { ...data, editions } as EditionData;\r\n      }),\r\n      shareReplay(1),\r\n    );\r\n  }\r\n\r\n  #findDefaultEdition(editions: EditionDto[]): EditionDto {\r\n    return editions.find(d => d.isDefault) ?? editions.find(d => d.name === '') ?? editions[0];\r\n  }\r\n\r\n}","<div class=\"eav-cards-box\">\r\n  <mat-card class=\"eav-card\">\r\n    <mat-card-header class=\"eav-card-header\">\r\n      <mat-card-title>{{ title() }}</mat-card-title>\r\n      <mat-icon>support_agent</mat-icon>\r\n    </mat-card-header>\r\n    <mat-card-content>\r\n\r\n      <br>\r\n      <!-- Generator select -->\r\n      @if (generators$ | async; as generators) {\r\n        <mat-form-field color=\"accent\" class=\"eav-mat-form-field\">\r\n          <mat-label>Generator</mat-label>\r\n          <mat-select required [(value)]=\"selectedGenerator\">\r\n            <mat-select-trigger>\r\n              {{ selectedGenerator }}\r\n            </mat-select-trigger>\r\n              @for (generator of generators.sort() ; track generator) {\r\n                <mat-option [value]=\"generator.name\">\r\n                  <strong>{{ generator.name }} v{{ generator.version }}</strong><br>\r\n                  {{ generator.description }}\r\n                </mat-option>\r\n              }\r\n          </mat-select>\r\n          @if (selectedGenerator$ | async; as selectedGenerator) {\r\n            <mat-hint [innerHTML]=\"selectedGenerator.descriptionHtml\"></mat-hint>\r\n          }\r\n        </mat-form-field>\r\n        <br>\r\n      }\r\n\r\n      <br>\r\n      <!-- Edition select -->\r\n      @if (editions$ | async; as editions) {\r\n        <mat-form-field color=\"accent\" class=\"eav-mat-form-field\">\r\n          <mat-label>Select an Edition to generate code for</mat-label>\r\n          <mat-select required [(value)]=\"selectedEdition\">\r\n              @for (edition of editions.sort() ; track edition) {\r\n                <mat-option [value]=\"edition.name\">\r\n                  <strong>{{ edition.label }}</strong> ({{ edition.description }})\r\n                </mat-option>\r\n              }\r\n          </mat-select>\r\n          <mat-hint>\r\n            Editions are managed in the <code>/App_Data/app.json</code> file.\r\n            See <a href=\"https://go.2sxc.org/app-json\" target=\"_blank\">docs</a>.\r\n          </mat-hint>\r\n        </mat-form-field>\r\n      }\r\n\r\n    </mat-card-content>\r\n    <div class=\"eav-card-space-div\"></div>\r\n    <mat-card-actions align=\"end\">\r\n      <button mat-button class=\"eav-button__with-icon\" (click)=\"autoGeneratedCode()\">\r\n        <mat-icon class=\"eav-icon\">code</mat-icon>\r\n        <span>Generate Code</span>\r\n      </button>\r\n    </mat-card-actions>\r\n  </mat-card>\r\n</div>\r\n","import { CommonModule } from '@angular/common';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Component, input } from '@angular/core';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatCardModule } from '@angular/material/card';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatSelectModule } from '@angular/material/select';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { map, take } from 'rxjs';\r\nimport { transient } from '../../../../../core';\r\nimport { RichResult } from '../../shared/models/rich-result';\r\nimport { Context } from '../../shared/services/context';\r\nimport { CopilotService } from './copilot-service';\r\n\r\n@Component({\r\n  selector: 'app-copilot-generator',\r\n  standalone: true,\r\n\r\n  templateUrl: './copilot-generator.component.html',\r\n  imports: [\r\n    MatSelectModule,\r\n    MatButtonModule,\r\n    MatCardModule,\r\n    MatIconModule,\r\n    CommonModule,\r\n  ]\r\n})\r\nexport class CopilotGeneratorComponent {\r\n\r\n  outputType = input<string>();\r\n  title? = input<string>('Copilot Generator');\r\n  private copilotSvc = transient(CopilotService);\r\n\r\n  webApiGeneratedCode: string = 'admin/code/generateDataModels';\r\n  editions$ = this.copilotSvc.getEditions();\r\n\r\n  generators$ = this.copilotSvc.getGenerators()\r\n    .pipe(\r\n      map((gens) => gens.filter(g => g.outputType === this.outputType()))\r\n    );\r\n\r\n  selectedGenerator$ = this.generators$.pipe(map(gens => gens.find(g => g.name === this.selectedGenerator)));\r\n\r\n  selectedGenerator = '';\r\n  selectedEdition = '';\r\n\r\n  constructor(\r\n    private http: HttpClient,\r\n    private context: Context,\r\n    private snackBar: MatSnackBar,\r\n  ) { }\r\n\r\n  ngOnInit(): void {\r\n    this.generators$.pipe(take(1)).subscribe(gens => {\r\n      this.selectedGenerator = gens[0]?.name ?? '';\r\n    });\r\n    this.copilotSvc.specs.pipe(take(1)).subscribe(specs => {\r\n      // this.selectedGenerator = specs.generators[0]?.name ?? '';\r\n      this.selectedEdition = specs.editions.find(e => e.isDefault)?.name ?? '';\r\n    });\r\n  }\r\n\r\n  autoGeneratedCode() {\r\n    this.http.get<RichResult>(this.webApiGeneratedCode, {\r\n      params: {\r\n        appId: this.context.appId.toString(),\r\n        edition: this.selectedEdition,\r\n        generator: this.selectedGenerator,\r\n      }\r\n    }).subscribe(d => {\r\n      console.log(d);\r\n      this.snackBar.open(d.message + `\\n (this took ${d.timeTaken}ms)`, null, { duration: 5000, });\r\n    });\r\n  }\r\n\r\n}\r\n","import { Component } from '@angular/core';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { CopilotSpec } from '../copilot-specs';\r\nimport { CopilotGeneratorComponent } from '../copilot-generator.component';\r\n\r\n@Component({\r\n  selector: 'app-data-copilot',\r\n  standalone: true,\r\n  templateUrl: './copilot-page.component.html',\r\n  styleUrl: './copilot-page.component.scss',\r\n  imports: [\r\n    CopilotGeneratorComponent\r\n  ]\r\n})\r\nexport class CopilotPageComponent {\r\n\r\n  data: CopilotSpec;\r\n\r\n  constructor(activatedRoute: ActivatedRoute) {\r\n    this.data = activatedRoute.snapshot.data as CopilotSpec;\r\n  }\r\n\r\n}\r\n","<div class=\"outer-container\">\r\n  <h1>{{data.heading}}</h1>\r\n  <p>\r\n    {{data.intro}}\r\n  </p>\r\n</div>\r\n\r\n<app-copilot-generator [outputType]=\"data.outputType\" [title]=\"data.title\"></app-copilot-generator>\r\n"],"x_google_ignoreList":[]}