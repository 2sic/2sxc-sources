(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{TpGC:function(e,t,n){"use strict";n.r(t);var i=n("8AiQ"),o=n("r4gC"),a=n("Qc/f"),r=n("9HSk"),c=n("F7GT"),s=n("2pW/"),l=n("BLjT"),u=n("5/c3"),p=n("D57K"),d=n("LiEJ"),b=n("LR82"),f=n("3riI"),h=n("Jg5f"),v=n("1/u/"),g=function(){function e(e,t,n,i,o,a){var r=this;this.jsPlumbRoot=e,this.pipelineModel=t,this.dataSources=n,this.onConnectionsChanged=i,this.onDragend=o,this.plumbInits=a,this.lineCount=0,this.linePaintDefault={stroke:"#61B7CF",strokeWidth:4,outlineStroke:"white",outlineWidth:2},this.lineColors=["#009688","#00bcd4","#3f51b5","#9c27b0","#e91e63","#db4437","#ff9800","#60a917","#60a917","#008a00","#00aba9","#1ba1e2","#0050ef","#6a00ff","#aa00ff","#f472d0","#d80073","#a20025","#e51400","#fa6800","#f0a30a","#e3c800","#825a2c","#6d8764","#647687","#76608a","#a0522d"],this.maxCols=this.lineColors.length-1,this.uuidColorMap={},this.bulkDelete=!1,this.instance=jsPlumb.getInstance(this.getInstanceDefaults(this.jsPlumbRoot)),this.instance.batch((function(){r.initDomDataSources(),r.initWirings(),r.bindEvents()})),this.instance.repaintEverything()}return e.prototype.destroy=function(){this.instance.reset()},e.prototype.removeEndpointsOnDataSource=function(e){var t=this,n="dataSource_"+e;this.bulkDelete=!0,this.instance.batch((function(){t.instance.selectEndpoints({element:n}).delete()})),this.bulkDelete=!1},e.prototype.getAllConnections=function(){return this.instance.getAllConnections().map((function(e){return{From:e.sourceId.replace("dataSource_",""),Out:e.endpoints[0].getOverlay("endpointLabel").label,To:e.targetId.replace("dataSource_",""),In:e.endpoints[1].getOverlay("endpointLabel").label}}))},e.prototype.getStreamsOut=function(){var e=[];return this.instance.selectEndpoints({target:"dataSource_Out"}).each((function(t){e.push(t.getOverlay("endpointLabel").label)})),e.join(",")},e.prototype.putEntityCountOnConnections=function(e){var t,n=this;null===(t=e.Streams)||void 0===t||t.forEach((function(e){var t,i="dataSource_"+e.Source,o=(["00000000-0000-0000-0000-000000000000",n.pipelineModel.Pipeline.EntityGuid].includes(e.Target)?"dataSource_Out":"dataSource_"+e.Target)+"_in_"+e.TargetIn,a=n.instance.getEndpoint(i+"_out_"+e.SourceOut);null===(t=null==a?void 0:a.connections)||void 0===t||t.forEach((function(t){t.endpoints[1].getUuid()===o&&t.setLabel({label:e.Count.toString(),cssClass:"streamEntitiesCount"})}))}))},e.prototype.nextLinePaintStyle=function(e){return this.uuidColorMap[e]||(this.uuidColorMap[e]=Object.assign({},this.linePaintDefault,{stroke:this.lineColors[this.lineCount++%this.maxCols]}))},e.prototype.getInstanceDefaults=function(e){return{Container:e,Connector:["Bezier",{curviness:70}],PaintStyle:this.nextLinePaintStyle("dummy"),HoverPaintStyle:{stroke:"#216477",strokeWidth:4,outlineStroke:"white",outlineWidth:2}}},e.prototype.initDomDataSources=function(){var e,t,n,i,o=this,a=function(e){var t=r.jsPlumbRoot.querySelector("#dataSource_"+e.EntityGuid),a=r.dataSources.find((function(t){return t.PartAssemblyAndType===e.PartAssemblyAndType}));if(!a)return"continue";if(r.pipelineModel.Pipeline.AllowEdit&&r.instance.draggable(t,{grid:[20,20],stop:function(e){var t=e.el.id.replace("dataSource_",""),n={Top:e.finalPos[1],Left:e.finalPos[0]};setTimeout((function(){o.onDragend(t,n)}))}}),null===(n=a.Out)||void 0===n||n.forEach((function(n){o.addEndpoint(t,n,!1,e)})),null===(i=a.In)||void 0===i||i.forEach((function(n){o.addEndpoint(t,n,!0,e)})),a.In){var c=r.buildTargetEndpoint();c.maxConnections=-1,r.instance.makeTarget(t,c)}a.DynamicOut&&r.instance.makeSource(t,r.buildSourceEndpoint(),{filter:".add-endpoint .new-connection"})},r=this;try{for(var c=Object(p.i)(this.pipelineModel.DataSources),s=c.next();!s.done;s=c.next())a(s.value)}catch(l){e={error:l}}finally{try{s&&!s.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}},e.prototype.initWirings=function(){var e,t=this;null===(e=this.pipelineModel.Pipeline.StreamWiring)||void 0===e||e.forEach((function(e){var n="dataSource_"+e.From,i=n+"_out_"+e.Out,o="dataSource_"+e.To,a=o+"_in_"+e.In;if(!t.instance.getEndpoint(i)){var r=(s=t.jsPlumbRoot.querySelector("#"+n)).id.replace("dataSource_",""),c=t.pipelineModel.DataSources.find((function(e){return e.EntityGuid===r}));t.addEndpoint(s,e.Out,!1,c)}if(!t.instance.getEndpoint(a)){var s,l=(s=t.jsPlumbRoot.querySelector("#"+o)).id.replace("dataSource_","");c=t.pipelineModel.DataSources.find((function(e){return e.EntityGuid===l})),t.addEndpoint(s,e.In,!0,c)}try{t.instance.connect({uuids:[i,a],paintStyle:t.nextLinePaintStyle(i)})}catch(u){console.error({message:"Connection failed",from:i,to:a})}}))},e.prototype.addEndpoint=function(e,t,n,i){var o=e.id+(n?"_in_":"_out_")+t,a=n?this.buildTargetEndpoint():this.buildSourceEndpoint();this.instance.addEndpoint(e,a,{uuid:o,enabled:this.pipelineModel.Pipeline.AllowEdit||"Out"===i.EntityGuid}).getOverlay("endpointLabel").setLabel(t)},e.prototype.buildSourceEndpoint=function(){return{paintStyle:{fill:"transparent",radius:10},cssClass:"sourceEndpoint",maxConnections:-1,isSource:!0,anchor:["Continuous",{faces:["top"]}],overlays:this.getEndpointOverlays(!0)}},e.prototype.buildTargetEndpoint=function(){return{paintStyle:{fill:"transparent",radius:10},cssClass:"targetEndpoint",maxConnections:1,isTarget:!0,anchor:["Continuous",{faces:["bottom"]}],overlays:this.getEndpointOverlays(!1),dropOptions:{hoverClass:"hover",activeClass:"active"}}},e.prototype.getEndpointOverlays=function(e){var t=this;return[["Label",{id:"endpointLabel",location:[.5,e?0:1],label:"Default",cssClass:"noselect "+(e?"endpointSourceLabel":"endpointTargetLabel"),events:{dblclick:function(e){if(t.pipelineModel.Pipeline.AllowEdit&&(null==e.dblClickCounter||e.dblClickCounter>=t.plumbInits?e.dblClickCounter=1:e.dblClickCounter++,!(e.dblClickCounter>1))){var n=prompt("Rename stream",e.label);n&&(e.setLabel(n),setTimeout((function(){t.onConnectionsChanged()})))}}}}]]},e.prototype.bindEvents=function(){var e=this;this.instance.bind("connectionDetached",(function(t){if(!e.bulkDelete){var n=t.target,i=e.pipelineModel.DataSources.find((function(e){return e.EntityGuid===n.id.replace("dataSource_","")})),o=e.dataSources.find((function(e){return e.PartAssemblyAndType===i.PartAssemblyAndType})).In,a=t.targetEndpoint.getOverlay("endpointLabel").label;o.includes(a)?setTimeout((function(){e.onConnectionsChanged()})):(e.instance.deleteEndpoint(t.targetEndpoint),setTimeout((function(){e.onConnectionsChanged()})))}})),this.instance.bind("connection",(function(t){var n=t.targetEndpoint.getOverlay("endpointLabel"),i=n.getLabel();e.instance.getEndpoints(t.target.id).some((function(e){return e.getOverlay("endpointLabel").getLabel()===i&&t.targetEndpoint.id!==e.id&&e.canvas.classList.contains("targetEndpoint")}))&&n.setLabel("PleaseRename"+Math.floor(99999*Math.random())),setTimeout((function(){e.onConnectionsChanged()}))}))},e}(),y={Cache:{name:"Cache",icon:"history",notes:"Caching of data"},Filter:{name:"Filter",icon:"filter_list",notes:"Filter data - usually returning less items than came in"},Logic:{name:"Logic",icon:"share",notes:"Logic operations - usually choosing between different streams"},Lookup:{name:"Lookup",icon:"search",notes:"Lookup operation - usually looking for other data based on a criteria"},Modify:{name:"Modify",icon:"star_half",notes:"Modify data - usually changing, adding or removing values"},Security:{name:"Security",icon:"account_circle",notes:"Security - usually limit what the user sees based on his identity"},Sort:{name:"Sort",icon:"sort",notes:"Sort the items"},Source:{name:"Source",icon:"cloud_upload",notes:"Source of new data - usually SQL, CSV or similar"},Target:{name:"Target",icon:"adjust",notes:"Target - usually just a destination of data"},Unknown:{name:"Unknown",icon:"fiber_manual_record",notes:"Unknown type"}};function m(e,t){var n,i,o={},a=function(e){var n=void 0,i=t.find((function(t){return t.PartAssemblyAndType===e.PartAssemblyAndType}));i&&(n=Object(p.a)({},i.PrimaryType?y[i.PrimaryType]:y.Unknown),i.Icon&&(n.icon=i.Icon),i.DynamicOut&&(n.dynamicOut=!0),i.HelpLink&&(n.helpLink=i.HelpLink),i.EnableConfig&&(n.config=i.EnableConfig)),n||(n=y.Unknown),o[e.EntityGuid]=n};try{for(var r=Object(p.i)(e),c=r.next();!c.done;c=r.next())a(c.value)}catch(s){n={error:s}}finally{try{c&&!c.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}return o}var O=n("1C3z"),P=n("fQLH"),S=n("iUUs"),D=n("z5yO"),C=n("W/Ou"),M=n("QagP"),U=n("9RHM"),w=n("uuTa");function k(e,t){if(1&e&&(O.Vb(0,"li"),O.Oc(1),O.Ub()),2&e){var n=t.$implicit;O.Bb(1),O.Pc(n)}}function x(e,t){if(1&e&&(O.Vb(0,"li"),O.Vb(1,"b"),O.Oc(2),O.Ub(),O.Oc(3,"="),O.Vb(4,"em"),O.Oc(5),O.Ub(),O.Ub()),2&e){var n=t.$implicit;O.Bb(2),O.Pc(n.key),O.Bb(3),O.Pc(n.value)}}function V(e,t){if(1&e&&(O.Vb(0,"tr"),O.Vb(1,"td"),O.Vb(2,"pre"),O.Oc(3),O.Ub(),O.Ub(),O.Vb(4,"td"),O.Oc(5),O.Ub(),O.Vb(6,"td"),O.Vb(7,"ol"),O.Mc(8,x,6,2,"li",5),O.ic(9,"keyvalue"),O.Ub(),O.Ub(),O.Vb(10,"td"),O.Oc(11),O.Ub(),O.Ub()),2&e){var n=t.$implicit;O.Bb(3),O.Pc(n.value.Guid),O.Bb(2),O.Pc(n.value.Type),O.Bb(3),O.nc("ngForOf",O.jc(9,4,n.value.Configuration)),O.Bb(3),O.Pc(n.value.Error)}}function E(e,t){if(1&e&&(O.Vb(0,"tr"),O.Vb(1,"td"),O.Vb(2,"pre"),O.Oc(3),O.Ub(),O.Ub(),O.Vb(4,"td"),O.Vb(5,"pre"),O.Oc(6),O.Ub(),O.Ub(),O.Vb(7,"td"),O.Oc(8),O.Ub(),O.Vb(9,"td"),O.Oc(10),O.Ub(),O.Ub()),2&e){var n=t.$implicit;O.Bb(3),O.Pc(n.Source+":"+n.SourceOut),O.Bb(3),O.Pc(n.Target+":"+n.TargetIn),O.Bb(2),O.Pc(n.Count),O.Bb(2),O.Pc(n.Error)}}var I=function(){function e(e,t){this.data=e,this.dialogRef=t}return e.prototype.ngOnInit=function(){this.testParameters=this.data.testParameters,this.timeUsed=this.data.result.QueryTimer.Milliseconds,this.ticksUsed=this.data.result.QueryTimer.Ticks,this.result=this.data.result.Query,this.sources=this.data.result.Sources,this.streams=this.data.result.Streams},e.prototype.closeDialog=function(){this.dialogRef.close()},e.\u0275fac=function(t){return new(t||e)(O.Pb(l.a),O.Pb(l.g))},e.\u0275cmp=O.Jb({type:e,selectors:[["app-query-result"]],decls:55,vars:10,consts:[["mat-dialog-title",""],[1,"dialog-title-box"],["mat-icon-button","","matTooltip","Close dialog",3,"click"],[1,"dialog-description"],[1,"description"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(O.Vb(0,"div",0),O.Vb(1,"div",1),O.Vb(2,"div"),O.Oc(3,"Query Results"),O.Ub(),O.Vb(4,"button",2),O.dc("click",(function(){return t.closeDialog()})),O.Vb(5,"mat-icon"),O.Oc(6,"close"),O.Ub(),O.Ub(),O.Ub(),O.Ub(),O.Vb(7,"p",3),O.Oc(8," The Full result was logged to the Browser Console. Further down you'll find more debug-infos.\n"),O.Ub(),O.Qb(9,"br"),O.Vb(10,"div",0),O.Vb(11,"div",1),O.Oc(12,"Parameters & Statistics"),O.Ub(),O.Ub(),O.Vb(13,"p",4),O.Oc(14),O.Ub(),O.Vb(15,"ul",4),O.Mc(16,k,2,1,"li",5),O.Ub(),O.Qb(17,"br"),O.Vb(18,"div",0),O.Vb(19,"div",1),O.Oc(20,"Query Results"),O.Ub(),O.Ub(),O.Vb(21,"pre"),O.Oc(22),O.ic(23,"json"),O.Ub(),O.Qb(24,"br"),O.Vb(25,"div",0),O.Vb(26,"div",1),O.Oc(27,"Sources"),O.Ub(),O.Ub(),O.Vb(28,"table",4),O.Vb(29,"tr"),O.Vb(30,"th"),O.Oc(31,"Guid"),O.Ub(),O.Vb(32,"th"),O.Oc(33,"Type"),O.Ub(),O.Vb(34,"th"),O.Oc(35,"Configuration"),O.Ub(),O.Vb(36,"th"),O.Oc(37,"Error"),O.Ub(),O.Ub(),O.Mc(38,V,12,6,"tr",5),O.ic(39,"keyvalue"),O.Ub(),O.Qb(40,"br"),O.Vb(41,"div",0),O.Vb(42,"div",1),O.Oc(43,"Streams"),O.Ub(),O.Ub(),O.Vb(44,"table",4),O.Vb(45,"tr"),O.Vb(46,"th"),O.Oc(47,"Source"),O.Ub(),O.Vb(48,"th"),O.Oc(49,"Target"),O.Ub(),O.Vb(50,"th"),O.Oc(51,"Items"),O.Ub(),O.Vb(52,"th"),O.Oc(53,"Error"),O.Ub(),O.Ub(),O.Mc(54,E,11,4,"tr",5),O.Ub()),2&e&&(O.Bb(14),O.Rc(" Executed in ",t.timeUsed,"ms (",t.ticksUsed," ticks)\n"),O.Bb(2),O.nc("ngForOf",null==t.testParameters?null:t.testParameters.split("\n")),O.Bb(6),O.Qc("  ",O.jc(23,6,t.result),"\n"),O.Bb(16),O.nc("ngForOf",O.jc(39,8,t.sources)),O.Bb(16),O.nc("ngForOf",t.streams))},directives:[l.h,r.a,a.a,o.a,i.l],pipes:[i.f,i.g],styles:[".description[_ngcontent-%COMP%]{font-size:14px}pre[_ngcontent-%COMP%]{display:block;padding:9.5px;margin:0 0 10px;font-size:13px;line-height:1.42857143;color:#333;word-break:break-all;word-wrap:break-word;background-color:#f5f5f5;border:1px solid #ccc;border-radius:4px;overflow-x:auto}th[_ngcontent-%COMP%]{text-align:left}"],changeDetection:0}),e}(),T=n("o9tz"),_=n("t5c9"),$=n("Iv+g"),j=n("dkRO"),Q=function(){function e(e,t,n){this.http=e,this.context=t,this.dnnContext=n}return e.prototype.fetchPipeline=function(e){var t=this;return this.http.get(this.dnnContext.$2sxc.http.apiUrl("eav/PipelineDesigner/GetPipeline"),{params:{appId:this.context.appId.toString(),id:e.toString()}}).pipe(Object(h.a)((function(e){return e.DataSources.length||t.buildDefaultModel(e),t.fixPipelineDataSources(e.DataSources),e})))},e.prototype.buildDefaultModel=function(e){var t,n,i=T.a.pipelineDesigner.defaultPipeline.dataSources;try{for(var o=Object(p.i)(i),a=o.next();!a.done;a=o.next()){var r=a.value;null==r.visualDesignerData&&(r.visualDesignerData={Top:100,Left:100});var c={Description:"",EntityGuid:r.entityGuid||"unsaved"+(e.DataSources.length+1),EntityId:void 0,Name:this.typeNameFilter(r.partAssemblyAndType,"className"),PartAssemblyAndType:r.partAssemblyAndType,VisualDesignerData:r.visualDesignerData};e.DataSources.push(c)}}catch(s){t={error:s}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}e.Pipeline.StreamWiring=T.a.pipelineDesigner.defaultPipeline.streamWiring},e.prototype.fixPipelineDataSources=function(e){var t,n;if(!e.some((function(e){return"Out"===e.EntityGuid}))){var i=T.a.pipelineDesigner.outDataSource;e.push({Description:i.description,EntityGuid:"Out",EntityId:void 0,Name:i.name,PartAssemblyAndType:i.className,VisualDesignerData:i.visualDesignerData})}try{for(var o=Object(p.i)(e),a=o.next();!a.done;a=o.next()){var r=a.value;r.VisualDesignerData=r.VisualDesignerData||{Top:50,Left:50}}}catch(c){t={error:c}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}},e.prototype.fetchDataSources=function(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("eav/PipelineDesigner/GetInstalledDataSources")).pipe(Object(h.a)((function(e){var t=T.a.pipelineDesigner.outDataSource;return e.push({ContentType:void 0,Difficulty:100,DynamicOut:!1,EnableConfig:void 0,HelpLink:void 0,Icon:void 0,In:t.in,Name:t.name||t.className,Out:void 0,PartAssemblyAndType:t.className,PrimaryType:"Target",UiHint:void 0,allowNew:!1}),e})))},e.prototype.typeNameFilter=function(e,t){var n=e.split(", ");switch(t){case"classFullName":return n[0];case"className":var i=n[0].split(".");return i[i.length-1]}return e},e.prototype.savePipeline=function(e){var t=this,n=e.Pipeline,i=e.DataSources;return this.http.post(this.dnnContext.$2sxc.http.apiUrl("eav/PipelineDesigner/SavePipeline"),{pipeline:n,dataSources:i},{params:{appId:this.context.appId.toString(),Id:n.EntityId.toString()}}).pipe(Object(h.a)((function(e){return t.fixPipelineDataSources(e.DataSources),e})))},e.prototype.runPipeline=function(e){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("eav/PipelineDesigner/QueryPipeline"),{params:{appId:this.context.appId.toString(),id:e.toString()}})},e.\u0275fac=function(t){return new(t||e)(O.Zb(_.b),O.Zb($.a),O.Zb(j.a))},e.\u0275prov=O.Lb({token:e,factory:e.\u0275fac}),e}(),B=n("Ata6"),A=n("ykZ8"),L=n("S36y"),R=function(){function e(e,t,n,i,o,a,r,c,s,l){this.router=e,this.route=t,this.queryDefinitionService=n,this.titleService=i,this.snackBar=o,this.dialog=a,this.viewContainerRef=r,this.zone=c,this.metadataService=s,this.contentTypesService=l,this.pipelineModel$=new d.a(null),this.dataSources$=new d.a(null),this.putEntityCountOnConnections$=new P.a,this.pipelineId=parseInt(this.route.snapshot.paramMap.get("pipelineId"),10),this.doRefresh=!1,this.subscription=new b.a}return e.prototype.ngOnDestroy=function(){this.pipelineModel$.complete(),this.dataSources$.complete(),this.putEntityCountOnConnections$.complete(),this.subscription.unsubscribe()},e.prototype.init=function(){this.fetchPipeline(),this.fetchDataSources(),this.attachKeyboardSave(),this.refreshOnChildClosed()},e.prototype.editPipelineEntity=function(){var e=this;this.savePipeline((function(){var t={items:[{EntityId:e.pipelineModel$.value.Pipeline.EntityId}]},n=Object(w.a)(t);e.doRefresh=!0,e.router.navigate(["edit/"+n],{relativeTo:e.route})}))},e.prototype.saveAndRun=function(e,t){var n=this;e&&t?this.savePipeline((function(){n.runPipeline()})):e?this.savePipeline():t&&this.runPipeline()},e.prototype.addDataSource=function(e){var t=Object(U.a)(this.pipelineModel$.value),n={Description:"",EntityGuid:"unsaved"+(t.DataSources.length+1),EntityId:void 0,Name:this.queryDefinitionService.typeNameFilter(e.PartAssemblyAndType,"className"),PartAssemblyAndType:e.PartAssemblyAndType,VisualDesignerData:{Top:100,Left:100}};t.DataSources.push(n),this.pipelineModel$.next(t),this.savePipeline()},e.prototype.removeDataSource=function(e,t,n){var i=Object(U.a)(this.pipelineModel$.value);i.DataSources=i.DataSources.filter((function(t){return t.EntityGuid!==e})),i.Pipeline.StreamWiring=t,i.Pipeline.StreamsOut=n,this.pipelineModel$.next(i)},e.prototype.renameDataSource=function(e,t){var n=Object(U.a)(this.pipelineModel$.value);n.DataSources.find((function(t){return t.EntityGuid===e})).Name=t,this.pipelineModel$.next(n)},e.prototype.changeDataSourceDescription=function(e,t){var n=Object(U.a)(this.pipelineModel$.value);n.DataSources.find((function(t){return t.EntityGuid===e})).Description=t,this.pipelineModel$.next(n)},e.prototype.changeConnections=function(e,t){var n=Object(U.a)(this.pipelineModel$.value);n.Pipeline.StreamWiring=e,n.Pipeline.StreamsOut=t,this.pipelineModel$.next(n)},e.prototype.changeDataSourcePosition=function(e,t){var n=Object(U.a)(this.pipelineModel$.value),i=n.DataSources.find((function(t){return t.EntityGuid===e}));i.VisualDesignerData=Object(p.a)(Object(p.a)({},i.VisualDesignerData),t),this.pipelineModel$.next(n)},e.prototype.editDataSource=function(e){var t=this,n=this.dataSources$.value.find((function(t){return t.PartAssemblyAndType===e.PartAssemblyAndType})),i=(null==n?void 0:n.ContentType)?n.ContentType:"|Config "+this.queryDefinitionService.typeNameFilter(e.PartAssemblyAndType,"classFullName"),o=e.EntityGuid;this.metadataService.getMetadata(T.a.metadata.entity.type,T.a.keyTypes.guid,o,i).subscribe((function(e){if(e.length){var n={items:[{EntityId:e[0].Id}]},a=Object(w.a)(n);t.router.navigate(["edit/"+a],{relativeTo:t.route})}else t.contentTypesService.getDetails(i,{ignoreErrors:"true"}).subscribe({next:function(e){var n={items:[{ContentTypeName:i,For:{Target:T.a.metadata.entity.target,Guid:o}}]},a=Object(w.a)(n);t.router.navigate(["edit/"+a],{relativeTo:t.route})},error:function(e){alert("Server reports error - this usually means that this data-source doesn't have any configuration")}})}))},e.prototype.savePipeline=function(e){var t=this;this.snackBar.open("Saving..."),this.queryDefinitionService.savePipeline(this.pipelineModel$.value).subscribe({next:function(n){t.snackBar.open("Saved",null,{duration:2e3}),t.pipelineModel$.next(n),null!=e&&e()},error:function(e){t.snackBar.open("Save Pipeline failed",null,{duration:2e3})}})},e.prototype.runPipeline=function(){var e=this;this.snackBar.open("Running query..."),this.queryDefinitionService.runPipeline(this.pipelineModel$.value.Pipeline.EntityId).subscribe({next:function(t){e.snackBar.open("Query worked",null,{duration:2e3}),e.dialog.open(I,{data:{testParameters:e.pipelineModel$.value.Pipeline.TestParameters,result:t},backdropClass:"dialog-backdrop",panelClass:["dialog-panel","dialog-panel-medium","no-scrollbar"],viewContainerRef:e.viewContainerRef,autoFocus:!1,closeOnNavigation:!1,position:{top:"0"}}),console.warn(t),setTimeout((function(){e.putEntityCountOnConnections$.next(t)}))},error:function(t){e.snackBar.open("Query failed",null,{duration:2e3})}})},e.prototype.fetchPipeline=function(e){var t=this;void 0===e&&(e=!1),e&&this.snackBar.open("Reloading query, please wait..."),this.queryDefinitionService.fetchPipeline(this.pipelineId).subscribe((function(n){e&&t.snackBar.open("Query reloaded",null,{duration:2e3}),t.pipelineModel$.next(n),t.titleService.setTitle(n.Pipeline.Name+" - Visual Query")}))},e.prototype.fetchDataSources=function(){var e=this;this.queryDefinitionService.fetchDataSources().subscribe((function(t){e.dataSources$.next(t)}))},e.prototype.attachKeyboardSave=function(){var e=this;this.zone.runOutsideAngular((function(){e.subscription.add(Object(S.a)(window,"keydown").pipe(Object(D.a)((function(){return!e.route.snapshot.firstChild})),Object(D.a)((function(e){return(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)&&83===e.keyCode}))).subscribe((function(t){t.preventDefault(),e.zone.run((function(){e.savePipeline()}))})))}))},e.prototype.refreshOnChildClosed=function(){var e=this;this.subscription.add(this.router.events.pipe(Object(D.a)((function(e){return e instanceof u.b})),Object(C.a)(!!this.route.snapshot.firstChild),Object(h.a)((function(){return!!e.route.snapshot.firstChild})),Object(M.a)(),Object(D.a)((function(e){var t=Object(p.f)(e,2);return t[0]&&!t[1]})),Object(D.a)((function(){var t=e.doRefresh;return e.doRefresh=!1,t}))).subscribe((function(){e.fetchPipeline(!0)})))},e.\u0275fac=function(t){return new(t||e)(O.Zb(u.c),O.Zb(u.a),O.Zb(Q),O.Zb(B.d),O.Zb(s.b),O.Zb(l.b),O.Zb(O.O),O.Zb(O.z),O.Zb(A.a),O.Zb(L.a))},e.\u0275prov=O.Lb({token:e,factory:e.\u0275fac}),e}(),F=n("kVtj"),N=["domRoot"],G=["domDataSource"];function W(e,t){if(1&e){var n=O.Wb();O.Vb(0,"div",16),O.dc("click",(function(){O.Dc(n);var e=O.hc().$implicit;return O.hc(3).configureDataSource(e)})),O.Vb(1,"mat-icon",17),O.Oc(2,"settings"),O.Ub(),O.Ub()}}function q(e,t){1&e&&(O.Vb(0,"div",18),O.Vb(1,"mat-icon",19),O.Oc(2,"arrow_drop_up"),O.Ub(),O.Ub())}function H(e,t){if(1&e){var n=O.Wb();O.Vb(0,"mat-icon",20),O.dc("click",(function(){O.Dc(n);var e=O.hc().$implicit;return O.hc(3).remove(e)})),O.Oc(1," delete "),O.Ub()}}function z(e,t){if(1&e&&(O.Vb(0,"a",21),O.Vb(1,"mat-icon"),O.Oc(2,"help_outline"),O.Ub(),O.Ub()),2&e){var n=O.hc().$implicit,i=O.hc(2).ngIf;O.nc("href",i.typeInfos[n.EntityGuid].helpLink,O.Gc)}}var Z=function(e,t,n){return{top:e,left:t,"min-width":n}};function J(e,t){if(1&e){var n=O.Wb();O.Vb(0,"div",5,6),O.Mc(2,W,3,0,"div",7),O.Vb(3,"mat-icon",8),O.Oc(4),O.Ub(),O.Vb(5,"div",9),O.dc("click",(function(){O.Dc(n);var e=t.$implicit,i=O.hc(2).ngIf,o=O.hc();return i.allowEdit&&o.editName(e)})),O.Vb(6,"span"),O.Oc(7),O.Ub(),O.Vb(8,"mat-icon",10),O.Oc(9,"edit"),O.Ub(),O.Ub(),O.Qb(10,"br"),O.Vb(11,"div",11),O.dc("click",(function(){O.Dc(n);var e=t.$implicit,i=O.hc(2).ngIf,o=O.hc();return i.allowEdit&&o.editDescription(e)})),O.Vb(12,"span"),O.Oc(13),O.Ub(),O.Vb(14,"mat-icon",10),O.Oc(15,"edit"),O.Ub(),O.Ub(),O.Qb(16,"br"),O.Vb(17,"div",12),O.Oc(18),O.Ub(),O.Mc(19,q,3,0,"div",13),O.Mc(20,H,2,0,"mat-icon",14),O.Mc(21,z,3,1,"a",15),O.Ub()}if(2&e){var i=t.$implicit,o=O.hc(2).ngIf,a=O.hc();O.nc("id",a.dataSrcIdPrefix+i.EntityGuid)("ngStyle",O.tc(12,Z,i.VisualDesignerData.Top+"px",i.VisualDesignerData.Left+"px",i.VisualDesignerData.Width?i.VisualDesignerData.Width+"px":null)),O.Bb(2),O.nc("ngIf",o.allowEdit&&o.typeInfos[i.EntityGuid].config),O.Bb(1),O.nc("title",o.typeInfos[i.EntityGuid].notes),O.Bb(1),O.Qc(" ",o.typeInfos[i.EntityGuid].icon," "),O.Bb(3),O.Pc(i.Name||"(no name)"),O.Bb(6),O.Pc(i.Description),O.Bb(4),O.nc("title",i.PartAssemblyAndType),O.Bb(1),O.Qc(" Type: ",a.typeNameFilter(i.PartAssemblyAndType,"className")," "),O.Bb(1),O.nc("ngIf",o.allowEdit&&o.typeInfos[i.EntityGuid].dynamicOut),O.Bb(1),O.nc("ngIf",o.allowEdit),O.Bb(1),O.nc("ngIf",o.typeInfos[i.EntityGuid].helpLink)}}function K(e,t){if(1&e&&(O.Tb(0),O.Mc(1,J,22,16,"div",4),O.Sb()),2&e){var n=O.hc().ngIf;O.Bb(1),O.nc("ngForOf",n.pipelineDataSources)}}function X(e,t){if(1&e&&(O.Vb(0,"div",1,2),O.Mc(2,K,2,1,"ng-container",3),O.Ub()),2&e){var n=O.hc();O.Bb(2),O.nc("ngIf",!n.hardReset)}}var Y=function(){function e(e,t,n){this.visualQueryService=e,this.queryDefinitionService=t,this.cd=n,this.dataSrcIdPrefix="dataSource_",this.hardReset=!1,this.scriptLoaded$=new d.a(!1),this.subscription=new b.a,this.plumbInits=0}return e.prototype.ngOnInit=function(){var e=this;Object(v.a)([{test:"jsPlumb",src:"https://cdnjs.cloudflare.com/ajax/libs/jsPlumb/2.14.5/js/jsplumb.min.js"}],(function(){e.scriptLoaded$.next(!0)})),this.subscription.add(this.visualQueryService.putEntityCountOnConnections$.subscribe((function(t){e.plumber.putEntityCountOnConnections(t)}))),this.templateModel$=Object(f.a)([this.visualQueryService.pipelineModel$,this.visualQueryService.dataSources$]).pipe(Object(h.a)((function(t){var n=Object(p.f)(t,2),i=n[0],o=n[1];if(null!=i&&null!=o)return e.hardReset=!0,e.cd.detectChanges(),e.hardReset=!1,{pipelineDataSources:i.DataSources,typeInfos:m(i.DataSources,o),allowEdit:i.Pipeline.AllowEdit}})))},e.prototype.ngAfterViewInit=function(){var e=this,t=this.domDataSourcesRef.changes.pipe(Object(h.a)((function(){return!0})));this.subscription.add(Object(f.a)([this.scriptLoaded$,t]).subscribe((function(t){var n,i=Object(p.f)(t,2);i[0]&&i[1]&&(null===(n=e.plumber)||void 0===n||n.destroy(),e.plumber=new g(e.domRootRef.nativeElement,e.visualQueryService.pipelineModel$.value,e.visualQueryService.dataSources$.value,e.onConnectionsChanged.bind(e),e.onDragend.bind(e),++e.plumbInits))})))},e.prototype.ngOnDestroy=function(){var e;null===(e=this.plumber)||void 0===e||e.destroy(),this.scriptLoaded$.complete(),this.subscription.unsubscribe()},e.prototype.onConnectionsChanged=function(){var e=this.plumber.getAllConnections(),t=this.plumber.getStreamsOut();this.visualQueryService.changeConnections(e,t)},e.prototype.onDragend=function(e,t){this.visualQueryService.changeDataSourcePosition(e,t)},e.prototype.configureDataSource=function(e){e.EntityGuid.includes("unsaved")?this.visualQueryService.saveAndRun(!0,!1):this.visualQueryService.editDataSource(e)},e.prototype.typeNameFilter=function(e,t){return this.queryDefinitionService.typeNameFilter(e,t)},e.prototype.remove=function(e){if(confirm("Delete "+e.Name+" data source?")){this.plumber.removeEndpointsOnDataSource(e.EntityGuid);var t=this.plumber.getAllConnections(),n=this.plumber.getStreamsOut();this.visualQueryService.removeDataSource(e.EntityGuid,t,n)}},e.prototype.editName=function(e){var t,n=null===(t=prompt("Rename data source",e.Name))||void 0===t?void 0:t.trim();null!=n&&""!==n&&this.visualQueryService.renameDataSource(e.EntityGuid,n)},e.prototype.editDescription=function(e){var t,n=null===(t=prompt("Edit description",e.Description))||void 0===t?void 0:t.trim();null!=n&&this.visualQueryService.changeDataSourceDescription(e.EntityGuid,n)},e.\u0275fac=function(t){return new(t||e)(O.Pb(R),O.Pb(Q),O.Pb(O.h))},e.\u0275cmp=O.Jb({type:e,selectors:[["app-plumb-editor"]],viewQuery:function(e,t){var n;1&e&&(O.Uc(N,!0),O.Uc(G,!0)),2&e&&(O.Ac(n=O.ec())&&(t.domRootRef=n.first),O.Ac(n=O.ec())&&(t.domDataSourcesRef=n))},decls:2,vars:3,consts:[["id","pipeline-root",4,"ngIf"],["id","pipeline-root"],["domRoot",""],[4,"ngIf"],["class","dataSource",3,"id","ngStyle",4,"ngFor","ngForOf"],[1,"dataSource",3,"id","ngStyle"],["domDataSource",""],["class","configure","title","Configure data source","appMousedownStopPropagation","",3,"click",4,"ngIf"],[1,"type-info",3,"title"],["title","Click to edit name","appMousedownStopPropagation","",1,"name","noselect",3,"click"],[1,"show-hover-inline","eav-icon-pencil"],["title","Click to edit description","appMousedownStopPropagation","",1,"description","noselect",3,"click"],[1,"typename",3,"title"],["class","add-endpoint","title","Drag a new Out-Connection",4,"ngIf"],["class","delete eav-icon-cancel","title","Delete","appMousedownStopPropagation","",3,"click",4,"ngIf"],["class","help eav-icon-help-circled","title","Help for this data source","target","_blank","appMousedownStopPropagation","",3,"href",4,"ngIf"],["title","Configure data source","appMousedownStopPropagation","",1,"configure",3,"click"],[1,"eav-icon-settings"],["title","Drag a new Out-Connection",1,"add-endpoint"],[1,"new-connection","eav-icon-up-dir"],["title","Delete","appMousedownStopPropagation","",1,"delete","eav-icon-cancel",3,"click"],["title","Help for this data source","target","_blank","appMousedownStopPropagation","",1,"help","eav-icon-help-circled",3,"href"]],template:function(e,t){1&e&&(O.Mc(0,X,3,1,"div",0),O.ic(1,"async")),2&e&&O.nc("ngIf",O.jc(1,1,t.templateModel$))},directives:[i.m,i.l,i.n,o.a,F.a],pipes:[i.b],styles:["","[_nghost-%COMP%] { display: block; width: 100%; height: 100%; }"],changeDetection:0}),e}();function ee(e,t){if(1&e&&(O.Vb(0,"li"),O.Oc(1),O.Ub()),2&e){var n=t.$implicit;O.Bb(1),O.Qc(" ",n," ")}}function te(e,t){if(1&e&&(O.Vb(0,"ul",13),O.Mc(1,ee,2,1,"li",14),O.Ub()),2&e){var n=O.hc().ngIf;O.Bb(1),O.nc("ngForOf",null==n.Pipeline.Params?null:n.Pipeline.Params.split("\n"))}}function ne(e,t){if(1&e&&(O.Vb(0,"li"),O.Oc(1),O.Ub()),2&e){var n=t.$implicit;O.Bb(1),O.Qc(" ",n," ")}}function ie(e,t){if(1&e&&(O.Vb(0,"ul",13),O.Mc(1,ne,2,1,"li",14),O.Ub()),2&e){var n=O.hc().ngIf;O.Bb(1),O.nc("ngForOf",null==n.Pipeline.TestParameters?null:n.Pipeline.TestParameters.split("\n"))}}function oe(e,t){if(1&e&&(O.Vb(0,"li"),O.Oc(1),O.Ub()),2&e){var n=t.$implicit;O.Bb(1),O.Qc(" ",n," ")}}function ae(e,t){if(1&e&&(O.Vb(0,"div",16),O.Vb(1,"div",7),O.Vb(2,"span"),O.Oc(3,"Warnings"),O.Ub(),O.Vb(4,"mat-icon",17),O.Oc(5,"warning"),O.Ub(),O.Ub(),O.Vb(6,"ol",13),O.Mc(7,oe,2,1,"li",14),O.Ub(),O.Ub()),2&e){var n=O.hc().ngIf;O.Bb(7),O.nc("ngForOf",n)}}function re(e,t){if(1&e&&(O.Tb(0),O.Mc(1,ae,8,1,"div",15),O.Sb()),2&e){var n=t.ngIf;O.Bb(1),O.nc("ngIf",n.length)}}function ce(e,t){if(1&e&&(O.Vb(0,"div",18),O.Vb(1,"div",7),O.Oc(2,"Query Description"),O.Ub(),O.Vb(3,"div"),O.Oc(4),O.Ub(),O.Ub()),2&e){var n=O.hc().ngIf;O.Bb(4),O.Pc(n.Pipeline.Description)}}function se(e,t){if(1&e){var n=O.Wb();O.Vb(0,"div",1),O.Vb(1,"div",2),O.Vb(2,"div",3),O.Vb(3,"button",4),O.dc("click",(function(){return O.Dc(n),O.hc().saveAndRunQuery(!0,!0)})),O.Oc(4," Save and run "),O.Ub(),O.Vb(5,"button",5),O.dc("click",(function(){return O.Dc(n),O.hc().saveAndRunQuery(!1,!0)})),O.Oc(6," Run "),O.Ub(),O.Vb(7,"button",5),O.dc("click",(function(){return O.Dc(n),O.hc().saveAndRunQuery(!0,!1)})),O.Oc(8," Save "),O.Ub(),O.Ub(),O.Vb(9,"div",6),O.Vb(10,"div",7),O.Vb(11,"div"),O.Oc(12,"Parameters"),O.Ub(),O.Vb(13,"div"),O.Vb(14,"button",8),O.dc("click",(function(){return O.Dc(n),O.hc().editPipeline()})),O.Vb(15,"mat-icon"),O.Oc(16,"edit"),O.Ub(),O.Ub(),O.Vb(17,"button",9),O.dc("click",(function(){return O.Dc(n),O.hc().openParamsHelp()})),O.Vb(18,"mat-icon"),O.Oc(19,"info"),O.Ub(),O.Ub(),O.Ub(),O.Ub(),O.Mc(20,te,2,1,"ul",10),O.Ub(),O.Vb(21,"div",6),O.Vb(22,"div",7),O.Oc(23,"Test Parameters"),O.Ub(),O.Mc(24,ie,2,1,"ul",10),O.Ub(),O.Mc(25,re,2,1,"ng-container",11),O.ic(26,"async"),O.Mc(27,ce,5,1,"div",12),O.Ub(),O.Ub()}if(2&e){var i=t.ngIf,o=O.hc();O.Bb(20),O.nc("ngIf",null==i.Pipeline.Params?null:i.Pipeline.Params.length),O.Bb(4),O.nc("ngIf",null==i.Pipeline.TestParameters?null:i.Pipeline.TestParameters.length),O.Bb(1),O.nc("ngIf",O.jc(26,4,o.warnings$)),O.Bb(2),O.nc("ngIf",i.Pipeline.Description)}}var le=function(){function e(e,t){this.context=e,this.visualQueryService=t}return e.prototype.ngOnInit=function(){var e=this;this.pipelineModel$=this.visualQueryService.pipelineModel$,this.warnings$=this.visualQueryService.pipelineModel$.pipe(Object(h.a)((function(t){return function(e,t){var n=[];try{var i=/^\[module:moduleid\]=([0-9]*)$/gim.exec(e.Pipeline.TestParameters)[1],o=t.moduleId.toString();i!==o&&n.push("Your test moduleid ("+i+") is different from the current moduleid ("+o+"). Note that 2sxc 9.33 automatically provides the moduleid - so you usually do not need to set it any more.")}catch(a){}return n}(t,e.context)})))},e.prototype.editPipeline=function(){this.visualQueryService.editPipelineEntity()},e.prototype.openParamsHelp=function(){window.open("https://r.2sxc.org/QueryParams","_blank")},e.prototype.saveAndRunQuery=function(e,t){this.visualQueryService.saveAndRun(e,t)},e.\u0275fac=function(t){return new(t||e)(O.Pb($.a),O.Pb(R))},e.\u0275cmp=O.Jb({type:e,selectors:[["app-run-explorer"]],decls:2,vars:3,consts:[["class","editor-active-explorer fancy-scrollbar-dark",4,"ngIf"],[1,"editor-active-explorer","fancy-scrollbar-dark"],[1,"wrapper"],[1,"actions"],["mat-raised-button","","color","accent",1,"action",3,"click"],["mat-raised-button","",1,"action",3,"click"],[1,"parameters"],[1,"title"],["mat-icon-button","","matTooltip","Edit parameters",3,"click"],["mat-icon-button","","matTooltip","Query Params Docs",3,"click"],["class","values",4,"ngIf"],[4,"ngIf"],["class","description",4,"ngIf"],[1,"values"],[4,"ngFor","ngForOf"],["class","warnings",4,"ngIf"],[1,"warnings"],[2,"color","red"],[1,"description"]],template:function(e,t){1&e&&(O.Mc(0,se,28,6,"div",0),O.ic(1,"async")),2&e&&O.nc("ngIf",O.jc(1,1,t.pipelineModel$))},directives:[i.m,r.a,a.a,o.a,i.l],pipes:[i.b],styles:[".wrapper[_ngcontent-%COMP%]{padding:24px}.actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding-bottom:32px}.actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]:not(:last-of-type){margin-bottom:8px}.description[_ngcontent-%COMP%], .parameters[_ngcontent-%COMP%], .warnings[_ngcontent-%COMP%]{margin:16px 0}.description[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .parameters[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .warnings[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{height:40px;display:flex;align-items:center;justify-content:space-between;font-size:14px}.description[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], .parameters[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], .warnings[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.parameters[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%], .warnings[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]{margin:0;padding-left:16px}.parameters[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   li[_ngcontent-%COMP%], .warnings[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:1px 0}"],changeDetection:0}),e}();function ue(e,t){if(1&e){var n=O.Wb();O.Vb(0,"div",8),O.dc("click",(function(){O.Dc(n);var e=t.$implicit;return O.hc(4).addDataSource(e)})),O.Oc(1),O.Ub()}if(2&e){var i=t.$implicit;O.nc("matTooltip",i.Name),O.Bb(1),O.Qc(" ",i.Name," ")}}function pe(e,t){if(1&e&&(O.Vb(0,"div",6),O.Mc(1,ue,2,2,"div",7),O.Ub()),2&e){var n=O.hc().$implicit;O.Bb(1),O.nc("ngForOf",n.value)}}function de(e,t){if(1&e){var n=O.Wb();O.Tb(0),O.Vb(1,"div",4),O.dc("click",(function(){O.Dc(n);var e=t.$implicit;return O.hc(2).toggleItem(e.key)})),O.Vb(2,"mat-icon"),O.Oc(3),O.Ub(),O.Vb(4,"span"),O.Oc(5),O.Ub(),O.Ub(),O.Mc(6,pe,2,1,"div",5),O.Sb()}if(2&e){var i=t.$implicit,o=O.hc(2);O.Bb(1),O.nc("matTooltip",i.key),O.Bb(2),O.Pc(o.toggledItems.includes(i.key)?"keyboard_arrow_down":"keyboard_arrow_right"),O.Bb(2),O.Pc(i.key),O.Bb(1),O.nc("ngIf",o.toggledItems.includes(i.key))}}function be(e,t){if(1&e){var n=O.Wb();O.Vb(0,"div",1),O.Vb(1,"mat-slide-toggle",2),O.dc("change",(function(e){return O.Dc(n),O.hc().toggleDifficulty(e)})),O.Oc(2," Show Advanced "),O.Ub(),O.Mc(3,de,7,4,"ng-container",3),O.ic(4,"keyvalue"),O.Ub()}if(2&e){var i=t.ngIf;O.Bb(3),O.nc("ngForOf",O.jc(4,1,i))}}var fe=function(){function e(e){this.visualQueryService=e,this.toggledItems=[],this.difficulties={default:100,advanced:200},this.difficulty$=new d.a(this.difficulties.default)}return e.prototype.ngOnInit=function(){this.sorted$=Object(f.a)([this.visualQueryService.dataSources$,this.difficulty$]).pipe(Object(h.a)((function(e){var t=Object(p.f)(e,2),n=t[0];if(null!=n)return function(e,t){var n,i,o=Object(U.a)(e).filter((function(e){return e.Difficulty<=t&&null==e.allowNew}));o.sort((function(e,t){return e.Name.toLocaleLowerCase().localeCompare(t.Name.toLocaleLowerCase())}));var a={};try{for(var r=Object(p.i)(o),c=r.next();!c.done;c=r.next()){var s=c.value,l=s.PrimaryType;a[l]?a[l].push(s):a[l]=[s]}}catch(u){n={error:u}}finally{try{c&&!c.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}return a}(n,t[1])})))},e.prototype.ngOnDestroy=function(){this.difficulty$.complete()},e.prototype.toggleDifficulty=function(e){this.difficulty$.next(e.checked?this.difficulties.advanced:this.difficulties.default)},e.prototype.addDataSource=function(e){this.visualQueryService.addDataSource(e)},e.prototype.toggleItem=function(e){!function(e,t){var n=t.indexOf(e);-1===n?t.push(e):t.splice(n,1)}(e,this.toggledItems)},e.\u0275fac=function(t){return new(t||e)(O.Pb(R))},e.\u0275cmp=O.Jb({type:e,selectors:[["app-add-explorer"]],decls:2,vars:3,consts:[["class","editor-active-explorer fancy-scrollbar-dark",4,"ngIf"],[1,"editor-active-explorer","fancy-scrollbar-dark"],["labelPosition","before",3,"change"],[4,"ngFor","ngForOf"],["matTooltipShowDelay","750",1,"collapsible",3,"matTooltip","click"],["class","list",4,"ngIf"],[1,"list"],["class","list-item","matTooltipShowDelay","750",3,"matTooltip","click",4,"ngFor","ngForOf"],["matTooltipShowDelay","750",1,"list-item",3,"matTooltip","click"]],template:function(e,t){1&e&&(O.Mc(0,be,5,3,"div",0),O.ic(1,"async")),2&e&&O.nc("ngIf",O.jc(1,1,t.sorted$))},directives:[i.m,c.a,i.l,a.a,o.a],pipes:[i.b,i.g],styles:[".mat-slide-toggle[_ngcontent-%COMP%]{margin:6px}.collapsible[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer;overflow:hidden;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;padding:3px 0}.collapsible[_ngcontent-%COMP%]:hover{background-color:#2a2d2e}.collapsible[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{width:18px;height:18px;font-size:18px}.list[_ngcontent-%COMP%]   .list-item[_ngcontent-%COMP%]{cursor:pointer;padding:4px 0 4px 24px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.list[_ngcontent-%COMP%]   .list-item[_ngcontent-%COMP%]:hover{background-color:#2a2d2e}"],changeDetection:0}),e}(),he=function(e){return{active:e}},ve=[{path:"",component:function(){function e(e,t,n){this.context=e,this.route=t,this.visualQueryService=n,this.explorer={run:"run",add:"add"},this.activeExplorer=this.explorer.run,this.context.init(this.route)}return e.prototype.ngOnInit=function(){this.visualQueryService.init()},e.prototype.toggleExplorer=function(e){this.activeExplorer=this.activeExplorer===e?null:e},e.prototype.openHelp=function(){window.open("http://2sxc.org/help","_blank")},e.\u0275fac=function(t){return new(t||e)(O.Pb($.a),O.Pb(u.a),O.Pb(R))},e.\u0275cmp=O.Jb({type:e,selectors:[["app-visual-query"]],viewQuery:function(e,t){var n;1&e&&O.Uc(Y,!0),2&e&&O.Ac(n=O.ec())&&(t.plumbEditor=n.first)},features:[O.Ab([R])],decls:16,vars:8,consts:[[1,"editor-root"],[1,"editor-side-toolbar"],["matTooltip","Run",1,"button",3,"ngClass","click"],["matTooltip","Add",1,"button",3,"ngClass","click"],[1,"spacer"],["matTooltip","Help",1,"button",3,"click"],[3,"hidden"]],template:function(e,t){1&e&&(O.Qb(0,"router-outlet"),O.Vb(1,"div",0),O.Vb(2,"div",1),O.Vb(3,"div",2),O.dc("click",(function(){return t.toggleExplorer(t.explorer.run)})),O.Vb(4,"mat-icon"),O.Oc(5,"play_arrow"),O.Ub(),O.Ub(),O.Vb(6,"div",3),O.dc("click",(function(){return t.toggleExplorer(t.explorer.add)})),O.Vb(7,"mat-icon"),O.Oc(8,"add"),O.Ub(),O.Ub(),O.Qb(9,"div",4),O.Vb(10,"div",5),O.dc("click",(function(){return t.openHelp()})),O.Vb(11,"mat-icon"),O.Oc(12,"help_outline"),O.Ub(),O.Ub(),O.Ub(),O.Qb(13,"app-run-explorer",6),O.Qb(14,"app-add-explorer",6),O.Qb(15,"app-plumb-editor"),O.Ub()),2&e&&(O.Bb(3),O.nc("ngClass",O.rc(4,he,t.activeExplorer===t.explorer.run)),O.Bb(3),O.nc("ngClass",O.rc(6,he,t.activeExplorer===t.explorer.add)),O.Bb(7),O.nc("hidden",t.activeExplorer!==t.explorer.run),O.Bb(1),O.nc("hidden",t.activeExplorer!==t.explorer.add))},directives:[u.e,a.a,i.k,o.a,le,fe,Y],styles:[".editor-side-toolbar[_ngcontent-%COMP%]{display:flex;flex-direction:column}.editor-side-toolbar[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]{flex-grow:1}"],changeDetection:0}),e}(),children:[{matcher:n("it7M").a,loadChildren:function(){return Promise.all([n.e(1),n.e(2),n.e(3),n.e(7),n.e(10),n.e(8),n.e(0),n.e(26)]).then(n.bind(null,"B+J5")).then((function(e){return e.EditModule}))}}]}],ge=function(){function e(){}return e.\u0275mod=O.Nb({type:e}),e.\u0275inj=O.Mb({factory:function(t){return new(t||e)},imports:[[u.d.forChild(ve)],u.d]}),e}(),ye=n("O6Xb");n.d(t,"VisualQueryModule",(function(){return me}));var me=function(){function e(){}return e.\u0275mod=O.Nb({type:e}),e.\u0275inj=O.Mb({factory:function(t){return new(t||e)},providers:[$.a,Q,A.a,L.a],imports:[[i.c,ye.a,ge,o.b,a.b,r.b,c.b,s.c,l.f]]}),e}()}}]);
//# sourceMappingURL=https://sources.2sxc.org/11.06.00/ng-edit/visual-query-visual-query-module.829c781726f5b2765dba.js.map