(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{"87pQ":function(e,t,n){"use strict";n.r(t),n.d(t,"EditContentTypeFieldsComponent",(function(){return _}));var i=n("D57K"),a=n("nIj0"),o=n("C05f"),c=n("bwdy"),r=n("P4Xx"),s=n("ROBh"),l=n("7ntQ"),p=n("cJ9h"),d=n("YtkY"),u=n("xVbo"),b=n("5uDM"),f=n("4e/d"),g=n("SrNW"),h=n("A8kH"),m=n("iqFP"),y=n("Ti3e");function v(e,t,n){return 0===n?[t]:(e.push(t),e)}var S=n("ZHmz"),T=n("DGvA"),O=n("nsG0"),k=n("DOM6"),R={Boolean:{label:"Boolean (yes/no)",description:"Yes/no or true/false values"},Custom:{label:"Custom - ui-tools or custom types",description:"Use for things like gps-pickers (which writes into multiple fields) or for custom-data which serializes something exotic into the db like an array, a custom json or anything"},DateTime:{label:"Date and/or time",description:"For date, time or combined values"},Empty:{label:"Empty - for form-titles etc.",description:"Use to structure your form"},Entity:{label:"Entity (other content-items)",description:"One or more other content-items"},Hyperlink:{label:"Link / file reference",description:"Hyperlink or reference to a picture / file"},Number:{label:"Number",description:"Any kind of number"},String:{label:"Text / string",description:"Any kind of text"}},I=n("EM62"),A=n("OZ4H"),M=n("sEIs"),N=n("S36y"),w=n("/Foi"),C=n("W1gw"),F=n("2kYt"),j=n("PBFl"),x=n("29Wa"),H=n("Cd2c"),D=n("R7+U"),$=n("bFHC"),L=n("Uk43"),E=n("mFH5"),P=["ngForm"];function B(e,t){1&e&&(I.Qb(0),I.Nc(1,"Fields"),I.Pb())}function Q(e,t){1&e&&(I.Qb(0),I.Nc(1,"Edit Field"),I.Pb())}function Y(e,t){1&e&&(I.Qb(0),I.Nc(1,"Add Fields"),I.Pb())}function U(e,t){if(1&e&&(I.Sb(0,"app-field-hint",22),I.Nc(1),I.Rb()),2&e){var n=I.ec(4);I.kc("isError",!0),I.Ab(1),I.Oc(n.fieldNameError)}}function z(e,t){if(1&e&&(I.Qb(0),I.Lc(1,U,2,2,"app-field-hint",21),I.Pb()),2&e){I.ec();var n=I.yc(6);I.Ab(1),I.kc("ngIf",n.errors.pattern)}}function G(e,t){if(1&e&&(I.Sb(0,"mat-option",23),I.Sb(1,"mat-icon"),I.Nc(2),I.Rb(),I.Sb(3,"span"),I.Nc(4),I.Rb(),I.Rb()),2&e){var n=t.$implicit;I.kc("value",n.name),I.Ab(2),I.Oc(n.icon),I.Ab(2),I.Oc(n.label)}}function J(e,t){if(1&e&&(I.Sb(0,"mat-option",23),I.Nc(1),I.Rb()),2&e){var n=t.$implicit;I.kc("value",n.inputType),I.Ab(1),I.Pc(" ",n.label,"")}}function V(e,t){if(1&e){var n=I.Tb();I.Sb(0,"div",11),I.Sb(1,"div",12),I.Sb(2,"mat-form-field",13),I.Sb(3,"mat-label"),I.Nc(4,"Name"),I.Rb(),I.Sb(5,"input",14,15),I.ac("ngModelChange",(function(e){return I.Ac(n),t.$implicit.StaticName=e})),I.Rb(),I.Rb(),I.Lc(7,z,2,1,"ng-container",16),I.Rb(),I.Sb(8,"div",12),I.Sb(9,"mat-form-field",13),I.Sb(10,"mat-label"),I.Nc(11,"Data Type"),I.Rb(),I.Sb(12,"mat-select",17),I.ac("selectionChange",(function(){I.Ac(n);var e=t.index,i=I.ec(2);return i.resetInputType(e),i.calculateInputTypeOptions(e),i.calculateHints(e)}))("ngModelChange",(function(e){return I.Ac(n),t.$implicit.Type=e})),I.Sb(13,"mat-select-trigger"),I.Sb(14,"mat-icon",18),I.Nc(15),I.Rb(),I.Sb(16,"span"),I.Nc(17),I.Rb(),I.Rb(),I.Lc(18,G,5,3,"mat-option",19),I.Rb(),I.Rb(),I.Sb(19,"app-field-hint"),I.Nc(20),I.Rb(),I.Rb(),I.Sb(21,"div",12),I.Sb(22,"mat-form-field",13),I.Sb(23,"mat-label"),I.Nc(24,"Input Type"),I.Rb(),I.Sb(25,"mat-select",20),I.ac("selectionChange",(function(){I.Ac(n);var e=t.index;return I.ec(2).calculateHints(e)}))("ngModelChange",(function(e){return I.Ac(n),t.$implicit.InputType=e})),I.Lc(26,J,2,2,"mat-option",19),I.Rb(),I.Rb(),I.Sb(27,"app-field-hint"),I.Nc(28),I.Rb(),I.Rb(),I.Rb()}if(2&e){var i=t.$implicit,a=t.index,o=I.yc(6),c=I.ec(2);I.Ab(5),I.kc("pattern",c.fieldNamePattern)("ngModel",i.StaticName)("name","StaticName"+a)("disabled",c.editMode),I.Ab(2),I.kc("ngIf",o.touched&&o.errors),I.Ab(5),I.kc("ngModel",i.Type)("name","Type"+a)("disabled",c.editMode),I.Ab(3),I.Oc(c.findIcon(i.Type)),I.Ab(2),I.Oc(i.Type),I.Ab(1),I.kc("ngForOf",c.dataTypes),I.Ab(2),I.Oc(c.dataTypeHints[a]),I.Ab(5),I.kc("ngModel",i.InputType)("name","InputType"+a),I.Ab(1),I.kc("ngForOf",c.filteredInputTypeOptions[a]),I.Ab(2),I.Oc(c.inputTypeHints[a])}}function W(e,t){if(1&e){var n=I.Tb();I.Sb(0,"form",4,5),I.ac("ngSubmit",(function(){return I.Ac(n),I.ec().save()})),I.Sb(2,"div",6),I.Lc(3,V,29,16,"div",7),I.Rb(),I.Sb(4,"div",8),I.Sb(5,"button",9),I.ac("click",(function(){return I.Ac(n),I.ec().closeDialog()})),I.Nc(6,"Cancel"),I.Rb(),I.Sb(7,"button",10),I.fc(8,"async"),I.Nc(9," Save "),I.Rb(),I.Rb(),I.Rb()}if(2&e){var i=I.yc(1),a=I.ec();I.Ab(3),I.kc("ngForOf",a.fields),I.Ab(4),I.kc("disabled",!i.form.valid||I.gc(8,2,a.saving$))}}var _=function(){function e(e,t,n,i,a){var r=this;this.dialogRef=e,this.route=t,this.contentTypesService=n,this.contentTypesFieldsService=i,this.snackBar=a,this.hostClass="dialog-component",this.fields=[],this.filteredInputTypeOptions=[],this.dataTypeHints=[],this.inputTypeHints=[],this.fieldNamePattern=S.b,this.fieldNameError=S.a,this.findIcon=k.a,this.loading$=new o.a(!0),this.saving$=new o.a(!1),this.subscription=new c.a,this.dialogRef.disableClose=!0,this.subscription.add(this.dialogRef.backdropClick().subscribe((function(e){r.form.dirty&&!confirm("You have unsaved changes. Are you sure you want to close this dialog?")||r.closeDialog()})))}return e.prototype.ngOnInit=function(){var e=this,t=this.route.snapshot.paramMap.get("contentTypeStaticName"),n=this.route.snapshot.paramMap.get("id")?parseInt(this.route.snapshot.paramMap.get("id"),10):null;this.editMode=null!==n;var a=this.contentTypesService.retrieveContentType(t).pipe(Object(l.a)()),o=a.pipe(Object(p.a)((function(t){return e.contentTypesFieldsService.getFields(t)}))),c=this.contentTypesFieldsService.typeListRetrieve().pipe(Object(d.a)((function(e){return function(e){var t,n,a=[];try{for(var o=Object(i.h)(e),c=o.next();!c.done;c=o.next()){var r=c.value;a.push({name:r,label:R[r].label,icon:Object(k.a)(r),description:R[r].description})}}catch(s){t={error:s}}finally{try{c&&!c.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return a}(e)}))),s=this.contentTypesFieldsService.getInputTypesList();Object(r.a)([a,o,c,s]).subscribe((function(t){var a=Object(i.f)(t,4),o=a[1],c=a[2],r=a[3];e.contentType=a[0];var s=o;if(e.dataTypes=c,e.inputTypeOptions=r,e.editMode){var l=s.find((function(e){return e.Id===n}));e.fields.push(l)}else for(var p=1;p<=8;p++)e.fields.push({Id:0,Type:T.a.String,InputType:O.a.StringDefault,StaticName:"",IsTitle:0===s.length,SortOrder:s.length+p});for(p=0;p<e.fields.length;p++)e.calculateInputTypeOptions(p),e.calculateHints(p);e.loading$.next(!1)}))},e.prototype.ngOnDestroy=function(){this.loading$.complete(),this.saving$.complete(),this.subscription.unsubscribe()},e.prototype.closeDialog=function(){this.dialogRef.close()},e.prototype.resetInputType=function(e){this.fields[e].InputType=this.fields[e].Type.toLowerCase()+O.a.DefaultSuffix},e.prototype.calculateInputTypeOptions=function(e){var t=this;this.filteredInputTypeOptions[e]=this.inputTypeOptions.filter((function(n){return n.dataType===t.fields[e].Type.toLowerCase()}))},e.prototype.calculateHints=function(e){var t=this,n=this.dataTypes.find((function(n){return n.name===t.fields[e].Type})),i=this.inputTypeOptions.find((function(n){return n.inputType===t.fields[e].InputType}));this.dataTypeHints[e]=n?n.description:"",this.inputTypeHints[e]=i?i.description:""},e.prototype.save=function(){var e=this;if(this.saving$.next(!0),this.snackBar.open("Saving..."),this.editMode){var t=this.fields[0];this.contentTypesFieldsService.updateInputType(t.Id,t.StaticName,t.InputType).subscribe((function(t){e.saving$.next(!1),e.snackBar.open("Saved",null,{duration:2e3}),e.closeDialog()}))}else s.a.apply(void 0,Object(i.g)(this.fields)).pipe(Object(u.a)((function(e){return!!e.StaticName})),Object(b.a)((function(t){return e.contentTypesFieldsService.add(t,e.contentType.Id).pipe(Object(f.a)((function(e){return Object(s.a)(null)})))})),function(e,t){return arguments.length>=2?function(n){return Object(y.a)(Object(g.a)(e,t),Object(h.a)(1),Object(m.a)(t))(n)}:function(t){return Object(y.a)(Object(g.a)((function(t,n,i){return e(t,n,i+1)})),Object(h.a)(1))(t)}}(v,[])).subscribe((function(t){e.saving$.next(!1),e.snackBar.open("Saved",null,{duration:2e3}),e.closeDialog()}))},e.\u0275fac=function(t){return new(t||e)(I.Mb(A.g),I.Mb(M.a),I.Mb(N.a),I.Mb(w.a),I.Mb(C.b))},e.\u0275cmp=I.Gb({type:e,selectors:[["app-edit-content-type-fields"]],viewQuery:function(e,t){var n;1&e&&I.Sc(P,!0,a.o),2&e&&I.xc(n=I.bc())&&(t.form=n.first)},hostVars:1,hostBindings:function(e,t){2&e&&I.Vb("className",t.hostClass)},decls:7,vars:7,consts:[["mat-dialog-title",""],[1,"dialog-title-box",3,"ngSwitch"],[4,"ngSwitchCase"],["class","dialog-form",3,"ngSubmit",4,"ngIf"],[1,"dialog-form",3,"ngSubmit"],["ngForm","ngForm"],[1,"dialog-form-content","fancy-scrollbar-light"],["class","row-container",4,"ngFor","ngForOf"],[1,"dialog-form-actions"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","submit","color","accent",3,"disabled"],[1,"row-container"],[1,"edit-input"],["appearance","standard","color","accent"],["matInput","",3,"pattern","ngModel","name","disabled","ngModelChange"],["staticName","ngModel"],[4,"ngIf"],[3,"ngModel","name","disabled","selectionChange","ngModelChange"],[1,"type-icon"],[3,"value",4,"ngFor","ngForOf"],[3,"ngModel","name","selectionChange","ngModelChange"],[3,"isError",4,"ngIf"],[3,"isError"],[3,"value"]],template:function(e,t){1&e&&(I.Sb(0,"div",0),I.Sb(1,"div",1),I.Lc(2,B,2,0,"ng-container",2),I.Lc(3,Q,2,0,"ng-container",2),I.Lc(4,Y,2,0,"ng-container",2),I.Rb(),I.Rb(),I.Lc(5,W,10,4,"form",3),I.fc(6,"async")),2&e&&(I.Ab(1),I.kc("ngSwitch",t.editMode),I.Ab(1),I.kc("ngSwitchCase",void 0),I.Ab(1),I.kc("ngSwitchCase",!0),I.Ab(1),I.kc("ngSwitchCase",!1),I.Ab(1),I.kc("ngIf",!1===I.gc(6,5,t.loading$)))},directives:[A.h,F.o,F.p,F.m,a.v,a.n,a.o,F.l,j.a,x.c,x.g,H.b,a.c,a.r,a.m,a.p,D.a,D.c,$.a,L.a,E.l],pipes:[F.b],styles:[".row-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.edit-input[_ngcontent-%COMP%]{padding-bottom:8px;width:30%}.type-icon[_ngcontent-%COMP%]{width:inherit;height:inherit;margin-right:8px;font-size:inherit;vertical-align:top;line-height:inherit}"],changeDetection:0}),e}()}}]);
//# sourceMappingURL=https://sources.2sxc.org/11.07.02/ng-edit/edit-content-type-fields-component.aa803b239b8c816be727.js.map