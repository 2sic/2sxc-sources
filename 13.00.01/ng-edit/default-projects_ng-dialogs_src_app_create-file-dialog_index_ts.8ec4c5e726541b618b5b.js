(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["default-projects_ng-dialogs_src_app_create-file-dialog_index_ts"],{9137:function(t,e,i){"use strict";i.d(e,{tk:function(){return c}});var n=i(4762),o=i(9996),l=i(1407),a=i(5549),r=i(1785),s=i(2693),p=i(3582),u=i(2837),c=function(){function t(t,e,i){var n;this.http=t,this.context=e,this.dnnContext=i,this.isShared=null!==(n=sessionStorage.getItem(a.PH))&&void 0!==n?n:(!1).toString()}return t.prototype.get=function(t,e){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(l.pJ),{params:(0,n.pi)({appId:this.context.appId.toString(),global:this.isShared},this.templateIdOrPath(t,e))}).pipe((0,o.U)(function(t){if("auto"===t.Type.toLocaleLowerCase())switch(t.Extension.toLocaleLowerCase()){case".cs":case".cshtml":t.Type="Razor";break;case".html":case".css":case".js":t.Type="Token"}return t}))},t.prototype.save=function(t,e,i){return this.http.post(this.dnnContext.$2sxc.http.apiUrl(l.pJ),e,{params:(0,n.pi)({appId:this.context.appId.toString(),global:this.isShared},this.templateIdOrPath(t,i))})},t.prototype.getTemplates=function(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(l.nu),{params:{appId:this.context.appId.toString(),global:this.isShared,withSubfolders:"true"}})},t.prototype.getPredefinedTemplates=function(t,e){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/appfiles/GetTemplates"),{params:(0,n.pi)((0,n.pi)({},t&&{purpose:t}),e&&{type:e})})},t.prototype.getPreview=function(t,e){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/appfiles/preview"),{params:{appId:this.context.appId.toString(),path:t,templateKey:e,global:this.isShared}})},t.prototype.createTemplate=function(t,e){return this.http.post(this.dnnContext.$2sxc.http.apiUrl(l.yE),{},{params:{appId:this.context.appId.toString(),global:this.isShared,purpose:"auto",path:t,templateKey:e}})},t.prototype.templateIdOrPath=function(t,e){var i;if(/^[0-9]*$/g.test(t)){var o=null===(i=e.find(function(e){var i;return(null===(i=e.EntityId)||void 0===i?void 0:i.toString())===t}))||void 0===i?void 0:i.Path;return(0,n.pi)({templateId:t},null!=o&&{path:o})}return{path:t}},t.\u0275fac=function(e){return new(e||t)(r.LFG(s.eN),r.LFG(p._),r.LFG(u._y))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t}()},3263:function(t,e,i){"use strict";i.d(e,{U:function(){return R},q:function(){return B}});var n=i(4762),o=i(1041),l=i(2935),a=i(7570),r=i(8512),s=i(1305),p=i(8569),u=i(878),c=i(3148),d=i(1110),f=i(6238),h=i(8720),g=i(9996),m=i(6599),v=i(8784),x=i(2250),b=i(1112),Z=i(1998),w=i(6673),y=(i(6882),{leading:!0,trailing:!1}),_=function(){function t(e,i,n,o){(0,b.Z)(this,t),this.duration=e,this.scheduler=i,this.leading=n,this.trailing=o}return(0,Z.Z)(t,[{key:"call",value:function(t,e){return e.subscribe(new C(t,this.duration,this.scheduler,this.leading,this.trailing))}}]),t}(),C=function(t){(0,v.Z)(i,t);var e=(0,x.Z)(i);function i(t,n,o,l,a){var r;return(0,b.Z)(this,i),(r=e.call(this,t)).duration=n,r.scheduler=o,r.leading=l,r.trailing=a,r._hasTrailingValue=!1,r._trailingValue=null,r}return(0,Z.Z)(i,[{key:"_next",value:function(t){this.throttled?this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(T,this.duration,{subscriber:this})),this.leading?this.destination.next(t):this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0))}},{key:"_complete",value:function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()}},{key:"clearThrottle",value:function(){var t=this.throttled;t&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),t.unsubscribe(),this.remove(t),this.throttled=null)}}]),i}(w.L);function T(t){t.subscriber.clearThrottle()}var P=i(4689),q=i(447),O=i(1785),I=i(9137),A=i(1116),k=i(3070),N=i(3841),U=i(9550),V=i(4369),$=i(7064),K=i(7110),J=i(7672);function M(t,e){if(1&t&&(O.TgZ(0,"mat-option",20),O._uU(1),O.qZA()),2&t){var i=e.$implicit;O.Q6J("value",i),O.xp6(1),O.hij(" ",i," ")}}function S(t,e){if(1&t&&(O.TgZ(0,"mat-option",20),O._uU(1),O.qZA()),2&t){var i=e.$implicit;O.Q6J("value",i),O.xp6(1),O.hij(" ",i," ")}}function Q(t,e){if(1&t&&(O.TgZ(0,"mat-option",20),O._uU(1),O.qZA()),2&t){var i=e.$implicit;O.Q6J("value",i.Key),O.xp6(1),O.hij(" ",i.Name," ")}}function j(t,e){1&t&&(O.TgZ(0,"app-field-hint",21),O._uU(1," This field is required "),O.qZA()),2&t&&O.Q6J("isError",!0)}function E(t,e){1&t&&(O.ynx(0),O._UZ(1,"mat-spinner",22),O._UZ(2,"div",23),O.BQk())}var D=function(t){return{disabled:t}};function Y(t,e){if(1&t&&(O.ynx(0),O.TgZ(1,"div",24),O.TgZ(2,"label",25),O._uU(3,"Preview"),O.qZA(),O.qZA(),O.TgZ(4,"pre",26),O._uU(5),O.qZA(),O.BQk()),2&t){var i=O.oxw().ngIf;O.xp6(2),O.Q6J("ngClass",O.VKq(3,D,i.loadingPreview)),O.xp6(2),O.Q6J("ngClass",O.VKq(5,D,i.loadingPreview)),O.xp6(1),O.Oqu(i.preview)}}function F(t,e){if(1&t&&(O.TgZ(0,"div",27),O._uU(1),O.qZA()),2&t){var i=O.oxw().ngIf;O.xp6(1),O.hij(" ",i.previewError," ")}}function L(t,e){if(1&t){var i=O.EpF();O.ynx(0),O.TgZ(1,"div",1),O.TgZ(2,"div",2),O.TgZ(3,"span"),O._uU(4,"Create"),O.qZA(),O.TgZ(5,"span",3),O._uU(6),O.qZA(),O.qZA(),O.qZA(),O.TgZ(7,"form",4),O.TgZ(8,"div",5),O.TgZ(9,"div",6),O.TgZ(10,"div",7),O.TgZ(11,"mat-form-field",8),O.TgZ(12,"mat-label"),O._uU(13,"Platform"),O.qZA(),O.TgZ(14,"mat-select",9),O.YNc(15,M,2,2,"mat-option",10),O.qZA(),O.qZA(),O.qZA(),O.TgZ(16,"div",7),O.TgZ(17,"mat-form-field",8),O.TgZ(18,"mat-label"),O._uU(19,"Purpose"),O.qZA(),O.TgZ(20,"mat-select",11),O.YNc(21,S,2,2,"mat-option",10),O.qZA(),O.qZA(),O.qZA(),O.qZA(),O.TgZ(22,"div",12),O.TgZ(23,"mat-form-field",8),O.TgZ(24,"mat-label"),O._uU(25,"Template"),O.qZA(),O.TgZ(26,"mat-select",13),O.YNc(27,Q,2,2,"mat-option",10),O.qZA(),O.qZA(),O.qZA(),O.TgZ(28,"div",12),O.TgZ(29,"mat-form-field",8),O.TgZ(30,"mat-label"),O._uU(31,"Name"),O.qZA(),O._UZ(32,"input",14),O.qZA(),O.YNc(33,j,2,1,"app-field-hint",15),O.qZA(),O.qZA(),O.TgZ(34,"div",16),O.YNc(35,E,3,0,"ng-container",0),O.TgZ(36,"button",17),O.NdJ("click",function(){return O.CHM(i),O.oxw().closeDialog()}),O._uU(37,"Cancel"),O.qZA(),O.TgZ(38,"button",18),O.NdJ("click",function(){return O.CHM(i),O.oxw().confirm()}),O._uU(39," Create "),O.qZA(),O.qZA(),O.YNc(40,Y,6,7,"ng-container",0),O.YNc(41,F,2,1,"div",19),O.qZA(),O.BQk()}if(2&t){var n=e.ngIf,o=O.oxw();O.xp6(6),O.Oqu(o.controls.finalName.value||(o.controls.folder.value?o.controls.folder.value.trim()+"/":"")),O.xp6(1),O.Q6J("formGroup",o.form),O.xp6(8),O.Q6J("ngForOf",n.platforms),O.xp6(6),O.Q6J("ngForOf",n.purposes),O.xp6(6),O.Q6J("ngForOf",n.templates),O.xp6(6),O.Q6J("ngIf",o.controls.name.touched&&(null==o.controls.name.errors?null:o.controls.name.errors.required)),O.xp6(2),O.Q6J("ngIf",n.loadingPreview),O.xp6(3),O.Q6J("disabled",!o.form.valid||n.loadingPreview||!n.previewValid),O.xp6(2),O.Q6J("ngIf",n.preview),O.xp6(1),O.Q6J("ngIf",!n.loadingPreview&&n.previewError)}}var R=function(){function t(t,e,i){this.dialogData=t,this.dialogRef=e,this.sourceService=i,this.hostClass="dialog-component",this.all="All"}return t.prototype.ngOnInit=function(){this.subscription=new a.w,this.templates$=new r.X([]),this.loadingPreview$=new r.X(!1),this.buildForm(),this.fetchTemplates(),this.buildTemplateVars()},t.prototype.ngOnDestroy=function(){this.templates$.complete(),this.loadingPreview$.complete(),this.subscription.unsubscribe()},t.prototype.closeDialog=function(t){this.dialogRef.close(t)},t.prototype.confirm=function(){var t=this.form.getRawValue();this.closeDialog({name:t.finalName,templateKey:t.templateKey})},t.prototype.fetchTemplates=function(){var t=this;this.sourceService.getPredefinedTemplates(this.dialogData.purpose,this.dialogData.type).subscribe(function(e){t.controls.templateKey.value!==e.Default&&t.controls.templateKey.patchValue(e.Default),t.templates$.next(e.Templates)})},t.prototype.buildForm=function(){var t,e,i=this;this.form=new o.cw({platform:new o.NI(this.all),purpose:new o.NI({value:null!==(t=this.dialogData.purpose)&&void 0!==t?t:this.all,disabled:null!=this.dialogData.purpose}),templateKey:new o.NI(null,o.kI.required),name:new o.NI(null,o.kI.required),finalName:new o.NI({value:null,disabled:!0}),folder:new o.NI({value:null!==(e=this.dialogData.folder)&&void 0!==e?e:"",disabled:!0})}),this.controls=this.form.controls,this.subscription.add((0,s.aj)([this.templates$,this.controls.templateKey.valueChanges.pipe((0,f.O)(this.controls.templateKey.value),(0,h.x)())]).subscribe(function(t){var e,o=(0,n.CR)(t,2),l=o[1],a=o[0].find(function(t){return t.Key===l}),r=null!==(e=null==a?void 0:a.SuggestedFileName)&&void 0!==e?e:null;i.controls.name.value!==r&&i.controls.name.patchValue(r)})),this.subscription.add((0,s.aj)([this.templates$,this.controls.templateKey.valueChanges.pipe((0,f.O)(this.controls.templateKey.value),(0,h.x)()),this.controls.name.valueChanges.pipe((0,f.O)(this.controls.name.value),(0,h.x)()),this.controls.folder.valueChanges.pipe((0,f.O)(this.controls.folder.value),(0,h.x)())]).subscribe(function(t){var e,o,l,a=(0,n.CR)(t,4),r=a[1],s=a[2],p=a[3],u=a[0].find(function(t){return t.Key===r}),c=null;s&&(p=p.trim(),s=q.vl.sanitizePath(s.trim()),c=((p?p+"/":"")+(s=""+(null!==(e=null==u?void 0:u.Prefix)&&void 0!==e?e:"")+s+(null!==(o=null==u?void 0:u.Suffix)&&void 0!==o?o:"")+(null!==(l=null==u?void 0:u.Extension)&&void 0!==l?l:""))).replace(/\/{2,}/g,"/")),i.controls.finalName.value!==c&&i.controls.finalName.patchValue(c)}))},t.prototype.buildTemplateVars=function(){var t=this,e=this.templates$.pipe((0,g.U)(function(e){var i,n=((i={})[t.all]=t.all,i);return e.forEach(function(t){var e;null===(e=t.Platforms)||void 0===e||e.forEach(function(t){n[t]=t})}),Object.keys(n)})),i=this.templates$.pipe((0,g.U)(function(e){var i,n=((i={})[t.all]=t.all,i);return e.forEach(function(t){n[t.Purpose]=t.Purpose}),Object.keys(n)})),o=(0,s.aj)([this.templates$,this.controls.platform.valueChanges.pipe((0,f.O)(this.controls.platform.value),(0,h.x)()),this.controls.purpose.valueChanges.pipe((0,f.O)(this.controls.purpose.value),(0,h.x)())]).pipe((0,g.U)(function(e){var i=(0,n.CR)(e,3),o=i[1],l=i[2];return i[0].filter(function(e){var i,n;return(o===t.all||null!==(n=null===(i=e.Platforms)||void 0===i?void 0:i.includes(o))&&void 0!==n&&n)&&(l===t.all||e.Purpose===l)})}),(0,m.b)(function(e){var i,n;if(!e.some(function(e){return e.Key===t.controls.templateKey.value})){var o=null!==(n=null===(i=e[0])||void 0===i?void 0:i.Key)&&void 0!==n?n:null;t.controls.templateKey.value!==o&&t.controls.templateKey.patchValue(o)}})),l=(0,s.aj)([this.controls.finalName.valueChanges.pipe((0,f.O)(this.controls.finalName.value),(0,h.x)()),this.controls.templateKey.valueChanges.pipe((0,f.O)(this.controls.templateKey.value),(0,h.x)())]).pipe(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p.P,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y;return function(n){return n.lift(new _(t,e,i.leading,i.trailing))}}(100,p.z,{leading:!0,trailing:!0}),(0,m.b)(function(){t.loadingPreview$.next(!0)}),(0,P.w)(function(e){var i=(0,n.CR)(e,2),o=i[0],l=i[1];return o&&l?(0,c.D)([t.sourceService.getPreview(o,l),(0,d.H)(500)]).pipe((0,g.U)(function(t){return(0,n.CR)(t,1)[0]})):(0,u.of)(void 0)}),(0,m.b)(function(){t.loadingPreview$.next(!1)}));this.templateVars$=(0,s.aj)([e,i,o,l,this.loadingPreview$]).pipe((0,g.U)(function(t){var e,i=(0,n.CR)(t,5),o=i[3];return{platforms:i[0],purposes:i[1],templates:i[2],loadingPreview:i[4],preview:null==o?void 0:o.Preview,previewValid:null!==(e=null==o?void 0:o.IsValid)&&void 0!==e&&e,previewError:null==o?void 0:o.Error}}))},t.\u0275fac=function(e){return new(e||t)(O.Y36(l.WI),O.Y36(l.so),O.Y36(I.tk))},t.\u0275cmp=O.Xpm({type:t,selectors:[["app-create-file-dialog"]],hostVars:1,hostBindings:function(t,e){2&t&&O.Ikx("className",e.hostClass)},decls:2,vars:3,consts:[[4,"ngIf"],["mat-dialog-title",""],[1,"dialog-title-box","hide-scrollbar"],[1,"file-name"],[1,"dialog-form",3,"formGroup"],[1,"dialog-form-content","fancy-scrollbar-light"],[1,"field-container","multiple"],[1,"multiple-field"],["appearance","standard","color","accent"],["formControlName","platform"],[3,"value",4,"ngFor","ngForOf"],["formControlName","purpose"],[1,"field-container"],["formControlName","templateKey"],["matInput","","type","text","formControlName","name","required",""],[3,"isError",4,"ngIf"],[1,"dialog-form-actions"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],["class","preview-error",4,"ngIf"],[3,"value"],[3,"isError"],["mode","indeterminate","diameter","20","color","accent"],[1,"spacer"],[1,"preview-label-box"],[1,"preview-label",3,"ngClass"],[1,"fancy-scrollbar-light",3,"ngClass"],[1,"preview-error"]],template:function(t,e){1&t&&(O.YNc(0,L,42,10,"ng-container",0),O.ALo(1,"async")),2&t&&O.Q6J("ngIf",O.lcZ(1,1,e.templateVars$))},directives:[A.O5,o._Y,o.JL,o.sg,k.KE,k.hX,N.gD,o.JJ,o.u,A.sg,U.Nt,o.Fj,o.Q7,V.lW,$.ey,K.Y,J.$g,A.mk],pipes:[A.Ov],styles:[".dialog-title-box[_ngcontent-%COMP%]{justify-content:flex-start;align-items:baseline;line-height:normal;white-space:nowrap;overflow-x:auto}.dialog-title-box[_ngcontent-%COMP%]   .file-name[_ngcontent-%COMP%]{font-size:20px;margin-left:8px;background-color:#d3d3d3}.field-container[_ngcontent-%COMP%]:not(:first-of-type){margin-top:8px}.field-container.multiple[_ngcontent-%COMP%]{display:flex}.field-container.multiple[_ngcontent-%COMP%]   .multiple-field[_ngcontent-%COMP%]{flex:1}.field-container.multiple[_ngcontent-%COMP%]   .multiple-field[_ngcontent-%COMP%]:not(:first-of-type){margin-left:8px}.dialog-form-actions[_ngcontent-%COMP%], .dialog-form-content[_ngcontent-%COMP%]{flex-shrink:0}pre[_ngcontent-%COMP%]{flex-grow:1;flex-shrink:1;font-family:monospace}pre.disabled[_ngcontent-%COMP%]{color:rgba(29,39,61,.24)}.preview-label-box[_ngcontent-%COMP%]{position:relative}.preview-label-box[_ngcontent-%COMP%]   .preview-label[_ngcontent-%COMP%]{position:absolute;top:-20px;left:0;font-size:12px;color:rgba(0,0,0,.6);pointer-events:none}.preview-label-box[_ngcontent-%COMP%]   .preview-label.disabled[_ngcontent-%COMP%]{color:rgba(29,39,61,.44)}.preview-error[_ngcontent-%COMP%]{margin-bottom:10px;font-size:14px;color:red}pre[_ngcontent-%COMP%]{display:block;padding:9.5px;margin:0 0 10px;font-size:13px;line-height:1.42857143;color:#333;word-break:break-all;word-wrap:break-word;background-color:#f5f5f5;border:1px solid #ccc;border-radius:4px;overflow-x:auto}"]}),t}(),z=i(3582),G=i(2677),B=function(){function t(){}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=O.oAB({type:t}),t.\u0275inj=O.cJS({providers:[z._,I.tk],imports:[[A.ez,G.q,V.ot,N.LD,o.UX,k.lN,U.c,J.Cq]]}),t}()}}]);
//# sourceMappingURL=https://sources.2sxc.org/13.00.01/ng-edit/default-projects_ng-dialogs_src_app_create-file-dialog_index_ts.8ec4c5e726541b618b5b.js.map