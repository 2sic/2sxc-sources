"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_permissions_permissions_component_ts"],{724:(P,u,e)=>{e.r(u),e.d(u,{PermissionsComponent:()=>x});var p=e(4844),o=e(5876),l=e(604),C=e(2816),y=e(5760),f=e(1743),m=e(9224),h=e(5396),t=e(4896),r=e(8200),O=e(2328),a=e(6176);let d=(()=>{class c{agInit(s){this.params=s}refresh(s){return!0}deletePermission(){this.params.onDelete(this.params.data)}static#t=this.\u0275fac=function(n){return new(n||c)};static#e=this.\u0275cmp=t.In1({type:c,selectors:[["app-permissions-actions"]],decls:4,vars:0,consts:[[1,"actions-component"],["matRipple","","tippy","Delete",1,"eav-grid-action-button","highlight",3,"click"]],template:function(n,i){1&n&&(t.I0R(0,"div",0)(1,"div",1),t.qCj("click",function(){return i.deletePermission()}),t.I0R(2,"mat-icon"),t.OEk(3,"delete"),t.C$Y()()())},dependencies:[r.Y,O.qL,a.UZ]})}return c})();var g=e(896),_=e(5204),I=e(600),E=e(4648),T=e(4672),D=e(4072),M=e(5056);function R(c,G){if(1&c){const s=t.KQA();t.I0R(0,"div",1)(1,"div",2)(2,"div",3),t.OEk(3,"Permissions"),t.C$Y(),t.I0R(4,"button",4),t.qCj("click",function(){t.usT(s);const i=t.GaO();return t.CGJ(i.closeDialog())}),t.I0R(5,"mat-icon"),t.OEk(6,"close"),t.C$Y()()(),t.I0R(7,"div",5),t.wR5(8,"router-outlet"),t.I0R(9,"div",6),t.wR5(10,"ag-grid-angular",7),t.C$Y(),t.I0R(11,"mat-dialog-actions",8)(12,"button",9),t.qCj("click",function(){t.usT(s);const i=t.GaO();return t.CGJ(i.editPermission(null))}),t.I0R(13,"mat-icon"),t.OEk(14,"add"),t.C$Y()()()()()}if(2&c){const s=t.GaO();t.yG2(10),t.E7m("rowData",G.permissions)("gridOptions",s.gridOptions)}}let x=(()=>{class c extends C.K{constructor(s,n,i,v,A){super(s,n),this.router=s,this.route=n,this.dialogRef=i,this.permissionsService=v,this.snackBar=A,this.permissions$=new p.g(void 0),this.gridOptions=this.buildGridOptions(),this.targetType=parseInt(this.route.snapshot.paramMap.get("targetType"),10),this.keyType=this.route.snapshot.paramMap.get("keyType"),this.key=this.route.snapshot.paramMap.get("key"),this.prefills={[m._K.metadata.language.targetType]:{PermissionType:"language"}}}ngOnInit(){this.fetchPermissions(),this.subscription.add(this.refreshOnChildClosedShallow().subscribe(()=>{this.fetchPermissions()})),this.viewModel$=(0,o.E)([this.permissions$]).pipe((0,l.k)(([s])=>({permissions:s})))}ngOnDestroy(){this.permissions$.complete(),super.ngOnDestroy()}closeDialog(){this.dialogRef.close()}fetchPermissions(){this.permissionsService.getAll(this.targetType,this.keyType,this.key).subscribe(s=>{this.permissions$.next(s)})}editPermission(s){let n;n=null==s?{items:[{ContentTypeName:m._K.contentTypes.permissions,For:{Target:Object.values(m._K.metadata).find(v=>v.targetType===this.targetType)?.target??this.targetType.toString(),TargetType:this.targetType,...this.keyType===m._K.keyTypes.guid&&{Guid:this.key},...this.keyType===m._K.keyTypes.number&&{Number:parseInt(this.key,10)},...this.keyType===m._K.keyTypes.string&&{String:this.key}},...this.prefills[this.targetType]&&{Prefill:this.prefills[this.targetType]}}]}:{items:[{EntityId:s.Id}]};const i=(0,h.K)(n);this.router.navigate([`edit/${i}`],{relativeTo:this.route})}deletePermission(s){confirm(`Delete '${s.Title}' (${s.Id})?`)&&(this.snackBar.open("Deleting..."),this.permissionsService.delete(s.Id).subscribe(()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.fetchPermissions()}))}buildGridOptions(){return{...f.A,columnDefs:[{headerName:"ID",field:"Id",width:70,headerClass:"dense",cellClass:"id-action no-padding no-outline".split(" "),sortable:!0,filter:"agNumberColumnFilter",valueGetter:n=>n.data.Id,cellRenderer:y.q,cellRendererParams:{tooltipGetter:i=>`ID: ${i.Id}\nGUID: ${i.Guid}`}},{field:"Name",flex:2,minWidth:250,cellClass:"primary-action highlight".split(" "),sortable:!0,sort:"asc",filter:"agTextColumnFilter",onCellClicked:n=>{this.editPermission(n.data)},valueGetter:n=>n.data.Title},{field:"Identity",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:n=>n.data.Identity},{field:"Condition",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:n=>n.data.Condition},{field:"Grant",width:70,headerClass:"dense",cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:n=>n.data.Grant},{width:42,cellClass:"secondary-action no-padding".split(" "),pinned:"right",cellRenderer:d,cellRendererParams:{onDelete:i=>this.deletePermission(i)}}]}}static#t=this.\u0275fac=function(n){return new(n||c)(t.GI1(_.E5),t.GI1(_.gV),t.GI1(I.yI),t.GI1(g.W),t.GI1(E.yS))};static#e=this.\u0275cmp=t.In1({type:c,selectors:[["app-permissions"]],features:[t.eg9],decls:2,vars:3,consts:[["class","eav-dialog nav-component-wrapper"],[1,"eav-dialog","nav-component-wrapper"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"eav-dialog-content","nav-component-wrapper"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","gridOptions"],["align","end"],["mat-fab","","mat-elevation-z24","","tippy","Create a new permission",1,"grid-fab",3,"click"]],template:function(n,i){if(1&n&&(t.yuY(0,R,15,2,"div",0),t.wVc(1,"async")),2&n){let v;t.C0Y(0,(v=t.kDX(1,1,i.viewModel$))?0:-1,v)}},dependencies:[_.cP,r.Y,I.Yp,T.um,T.uw,O.qL,D.U5,M.a]})}return c})()},2816:(P,u,e)=>{e.d(u,{K:()=>t});var p=e(5204),o=e(6560),l=e(1792),C=e(604),y=e(6536),f=e(6884),m=e(2376),h=e(4896);let t=(()=>{class r extends f.C{constructor(a,d,g){super(),this.router=a,this.route=d,this.log=g,this.log??=new m.W("BaseComponent",!1)}ngOnDestroy(){super.ngOnDestroy()}refreshOnChildClosedShallow(){return this.router.events.pipe((0,o.I)(a=>a instanceof p.cf),(0,l.W)(!!this.route.snapshot.firstChild),(0,C.k)(()=>!!this.route.snapshot.firstChild),(0,y.c)(),(0,o.I)(([a,d])=>a&&!d))}static#t=this.\u0275fac=function(d){return new(d||r)(h.GI1(p.E5),h.GI1(p.gV),h.GI1(m.W))};static#e=this.\u0275dir=h.Sc5({type:r,features:[h.eg9]})}return r})()},5760:(P,u,e)=>{e.d(u,{q:()=>t});var p=e(2556),o=e(4896),l=e(4648),C=e(5056),y=e(6176),f=e(2328),m=e(8200);const h=(r,O)=>({"align-start":r,"align-end":O});let t=(()=>{class r{constructor(a){this.snackBar=a}agInit(a){this.id=a.value,this.align="number"==typeof this.id?"end":"start",this.tooltip=a.tooltipGetter(a.data)}refresh(a){return!0}copy(){(0,p.y)(this.tooltip),this.snackBar.open("Copied to clipboard",null,{duration:2e3})}static#t=this.\u0275fac=function(d){return new(d||r)(o.GI1(l.yS))};static#e=this.\u0275cmp=o.In1({type:r,selectors:[["app-id-field"]],decls:5,vars:6,consts:[["matRipple","",1,"id-box","highlight",3,"tippy","ngClass","click"],[1,"id"],[1,"icon"]],template:function(d,g){1&d&&(o.I0R(0,"div",0),o.qCj("click",function(){return g.copy()}),o.I0R(1,"span",1),o.OEk(2),o.C$Y(),o.I0R(3,"mat-icon",2),o.OEk(4,"file_copy"),o.C$Y()()),2&d&&(o.E7m("tippy",g.tooltip)("ngClass",o.IBC(3,h,"start"===g.align,"end"===g.align)),o.yG2(2),o.cNF(g.id))},dependencies:[C.QF,y.UZ,f.qL,m.Y],styles:[".id-box[_ngcontent-%COMP%]{padding:0 8px;height:100%;display:flex;align-items:center}.id-box.align-start[_ngcontent-%COMP%]{justify-content:flex-start}.id-box.align-end[_ngcontent-%COMP%]{justify-content:flex-end}.id-box[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{max-width:100%;text-overflow:ellipsis;overflow:hidden}.id-box[_ngcontent-%COMP%]:hover{text-decoration:none}.id-box[_ngcontent-%COMP%]:hover   .id[_ngcontent-%COMP%]{display:none}.id-box[_ngcontent-%COMP%]:not(:hover)   .icon[_ngcontent-%COMP%]{display:none}"]})}return r})()},1743:(P,u,e)=>{e.d(u,{A:()=>p});const p={accentedSort:!0,animateRows:!0,enableCellTextSelection:!0,headerHeight:32,suppressScrollOnNewData:!0,valueCache:!0,defaultColDef:{filterParams:{newRowsAction:"keep"}},tooltipShowDelay:0,tooltipHideDelay:1e5,suppressMovableColumns:!0}},2556:(P,u,e)=>{function p(o){const l=document.createElement("textarea");l.value=o,l.setAttribute("readonly",""),l.style.position="absolute",l.style.left="-9999px",document.body.appendChild(l);const C=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);l.select(),document.execCommand("copy"),document.body.removeChild(l),C&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(C))}e.d(u,{y:()=>p})}}]);
//# sourceMappingURL=https://sources.2sxc.org/17.05.01/dist/ng-edit/projects_eav-ui_src_app_permissions_permissions_component_ts.3a6ba461eb87ea50.js.map