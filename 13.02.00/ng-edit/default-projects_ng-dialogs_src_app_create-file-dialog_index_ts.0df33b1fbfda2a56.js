"use strict";(self.webpackChunkng_dialogs=self.webpackChunkng_dialogs||[]).push([["default-projects_ng-dialogs_src_app_create-file-dialog_index_ts"],{1183:function(X,V,a){a.d(V,{t:function(){return Q}});var E=a(8069),N=a(8047),c=a(635),e=a(8598),F=a(7133),M=a(8784),S=a(2425),O="admin/AppFiles/asset",Q=function(){var P=function(){function w(x,s,f){(0,E.Z)(this,w),this.http=x,this.context=s,this.dnnContext=f}return(0,N.Z)(w,[{key:"get",value:function(s,f,g){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(O),{params:Object.assign({appId:this.context.appId,global:f},this.templateIdOrPath(s,f,g))}).pipe((0,c.U)(function(h){if("auto"===h.Type.toLocaleLowerCase())switch(h.Extension.toLocaleLowerCase()){case".cs":case".cshtml":h.Type="Razor";break;case".html":case".css":case".js":h.Type="Token"}return h}))}},{key:"save",value:function(s,f,g,h){return this.http.post(this.dnnContext.$2sxc.http.apiUrl(O),g,{params:Object.assign({appId:this.context.appId,global:f},this.templateIdOrPath(s,f,h))})}},{key:"getAll",value:function(s){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/AppFiles/AppFiles"),{params:Object.assign({appId:this.context.appId},s&&{mask:s})}).pipe((0,c.U)(function(f){var g=f.Files;return g.forEach(function(h){var D;null!==(D=h.Shared)&&void 0!==D||(h.Shared=!1)}),g}))}},{key:"getWebApis",value:function(){return this.getAll("*Controller.cs").pipe((0,c.U)(function(s){return s.map(function(g){var h=g.Path.lastIndexOf("/"),D=g.Path.lastIndexOf("."),I=g.Path.substring(0,h),y=g.Path.substring(h+1,D);return{path:g.Path,folder:I,name:y,isShared:g.Shared}})}))}},{key:"getWebApiDetails",value:function(s){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/ApiExplorer/inspect"),{params:{appId:this.context.appId,zoneId:this.context.zoneId,path:s}})}},{key:"getPredefinedTemplates",value:function(s,f){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/AppFiles/GetTemplates"),{params:Object.assign(Object.assign({},s&&{purpose:s}),f&&{type:f})})}},{key:"getPreview",value:function(s,f,g){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/AppFiles/preview"),{params:{appId:this.context.appId,path:s,templateKey:g,global:f}})}},{key:"create",value:function(s,f,g){return this.http.post(this.dnnContext.$2sxc.http.apiUrl("admin/AppFiles/create"),{},{params:{appId:this.context.appId,global:f,purpose:"auto",path:s,templateKey:g}})}},{key:"templateIdOrPath",value:function(s,f,g){var h;if(/^[0-9]*$/g.test(s)){var D=null===(h=g.find(function(I){var y;return(null===(y=I.EntityId)||void 0===y?void 0:y.toString())===s&&I.IsShared===f}))||void 0===h?void 0:h.Path;return Object.assign({templateId:s},null!=D&&{path:D})}return{path:s}}}]),w}();return P.\u0275fac=function(x){return new(x||P)(F.LFG(M.eN),F.LFG(e._),F.LFG(S._y))},P.\u0275prov=F.Yz7({token:P,factory:P.\u0275fac}),P}()},5260:function(X,V,a){a.d(V,{UH:function(){return ge},qH:function(){return Ce},i6:function(){return j}});var E=a(8069),N=a(8047),c=a(587),e=a(7133),F=a(5758),M=a(4770),S=a(1434),$=a(1130),O=a(6362),J=a(7317),L=a(3135);function k(o,i){1&o&&(e.TgZ(0,"app-field-hint",11),e._uU(1," This field is required "),e.qZA()),2&o&&e.Q6J("isError",!0)}var j=function(){var o=function(){function i(n){(0,E.Z)(this,i),this.dialogRef=n,this.hostClass="dialog-component"}return(0,N.Z)(i,[{key:"ngOnInit",value:function(){this.form=new c.cw({isShared:new c.NI(null,c.kI.required)})}},{key:"closeDialog",value:function(t){this.dialogRef.close(t)}},{key:"confirm",value:function(){var t=this.form.getRawValue();this.closeDialog(t.isShared)}}]),i}();return o.\u0275fac=function(n){return new(n||o)(e.Y36(F.so))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-file-location-dialog"]],hostVars:1,hostBindings:function(n,t){2&n&&e.Ikx("className",t.hostClass)},decls:19,vars:5,consts:[["mat-dialog-title",""],[1,"dialog-title-box"],[1,"dialog-form",3,"formGroup"],[1,"dialog-form-content","fancy-scrollbar-light"],["appearance","standard","color","accent"],["formControlName","isShared"],[3,"value"],[3,"isError",4,"ngIf"],[1,"dialog-form-actions"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],[3,"isError"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e._uU(2,"New file location"),e.qZA(),e.qZA(),e.TgZ(3,"form",2),e.TgZ(4,"div",3),e.TgZ(5,"mat-form-field",4),e.TgZ(6,"mat-label"),e._uU(7,"Location"),e.qZA(),e.TgZ(8,"mat-select",5),e.TgZ(9,"mat-option",6),e._uU(10,"App"),e.qZA(),e.TgZ(11,"mat-option",6),e._uU(12,"Shared (global)"),e.qZA(),e.qZA(),e.qZA(),e.YNc(13,k,2,1,"app-field-hint",7),e.TgZ(14,"div",8),e.TgZ(15,"button",9),e.NdJ("click",function(){return t.closeDialog()}),e._uU(16,"Cancel"),e.qZA(),e.TgZ(17,"button",10),e.NdJ("click",function(){return t.confirm()}),e._uU(18," Confirm "),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&n&&(e.xp6(3),e.Q6J("formGroup",t.form),e.xp6(6),e.Q6J("value",!1),e.xp6(2),e.Q6J("value",!0),e.xp6(2),e.Q6J("ngIf",t.form.controls.isShared.touched&&(null==t.form.controls.isShared.errors?null:t.form.controls.isShared.errors.required)),e.xp6(4),e.Q6J("disabled",!t.form.valid))},directives:[c._Y,c.JL,c.sg,M.KE,M.hX,S.gD,c.JJ,c.u,$.ey,O.O5,J.lW,L.Y],styles:[""]}),o}(),Q=a(7797),P=a(2090),w=a(7714),x=a(6317),s=a(6562),f=a(6936),g=a(745),h=a(1640),D=a(8947),I=a(4874),y=a(8977),U=a(635),q=a(9337),ee=a(1944),R=a(3945),te=a(4987),W={leading:!0,trailing:!1};function ne(o){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:W,n=i.leading,t=i.trailing;return(0,ee.e)(function(u,A){var b=!1,_=null,l=null,r=!1,v=function(){null==l||l.unsubscribe(),l=null,t&&(m(),r&&A.complete())},p=function(){l=null,r&&A.complete()},d=function(Z){return l=(0,te.Xf)(o(Z)).subscribe(new R.Q(A,v,p))},m=function(){if(b){b=!1;var Z=_;_=null,A.next(Z),!r&&d(Z)}};u.subscribe(new R.Q(A,function(C){b=!0,_=C,(!l||l.closed)&&(n?m():d(C))},function(){r=!0,(!(t&&b&&l)||l.closed)&&A.complete()}))})}var ae=a(2673),ie=a(5656),z=a(1183),B=a(4683),le=function(){var o=function(){function i(n,t){(0,E.Z)(this,i),this.matInput=n,this.elementRef=t,this.autofocusSelectValue=!1}return(0,N.Z)(i,[{key:"ngOnInit",value:function(){var t=this;setTimeout(function(){t.matInput.focus(),t.toBoolean(t.autofocusSelectValue)&&t.elementRef.nativeElement.setSelectionRange(0,t.matInput.value.length)})}},{key:"toBoolean",value:function(t){if("boolean"==typeof t)return t;if("string"==typeof t){var u=t.toLocaleLowerCase();return"true"===u||"false"!==u&&void 0}return null==t?t:void 0}}]),i}();return o.\u0275fac=function(n){return new(n||o)(e.Y36(B.Nt),e.Y36(e.SBq))},o.\u0275dir=e.lG2({type:o,selectors:[["","appMatInputAutofocus",""]],inputs:{autofocusSelectValue:"autofocusSelectValue"}}),o}(),G=a(4742);function re(o,i){if(1&o&&(e.TgZ(0,"mat-option",20),e._uU(1),e.qZA()),2&o){var n=i.$implicit;e.Q6J("value",n),e.xp6(1),e.hij(" ",n," ")}}function se(o,i){if(1&o&&(e.TgZ(0,"mat-option",20),e._uU(1),e.qZA()),2&o){var n=i.$implicit;e.Q6J("value",n),e.xp6(1),e.hij(" ",n," ")}}function ce(o,i){if(1&o&&(e.TgZ(0,"mat-option",20),e._uU(1),e.qZA()),2&o){var n=i.$implicit;e.Q6J("value",n.Key),e.xp6(1),e.hij(" ",n.Name," ")}}function ue(o,i){1&o&&(e.TgZ(0,"app-field-hint",21),e._uU(1," This field is required "),e.qZA()),2&o&&e.Q6J("isError",!0)}function pe(o,i){1&o&&(e.ynx(0),e._UZ(1,"mat-spinner",22),e._UZ(2,"div",23),e.BQk())}var H=function(i){return{disabled:i}};function fe(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"div",24),e.TgZ(2,"label",25),e._uU(3,"Preview"),e.qZA(),e.qZA(),e.TgZ(4,"pre",26),e._uU(5),e.qZA(),e.BQk()),2&o){var n=e.oxw().ngIf;e.xp6(2),e.Q6J("ngClass",e.VKq(3,H,n.loadingPreview)),e.xp6(2),e.Q6J("ngClass",e.VKq(5,H,n.loadingPreview)),e.xp6(1),e.Oqu(n.preview)}}function de(o,i){if(1&o&&(e.TgZ(0,"div",27),e._uU(1),e.qZA()),2&o){var n=e.oxw().ngIf;e.xp6(1),e.hij(" ",n.previewError," ")}}function me(o,i){if(1&o){var n=e.EpF();e.ynx(0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"span"),e._uU(4,"Create"),e.qZA(),e.TgZ(5,"span",3),e._uU(6),e.qZA(),e.qZA(),e.qZA(),e.TgZ(7,"form",4),e.TgZ(8,"div",5),e.TgZ(9,"div",6),e.TgZ(10,"div",7),e.TgZ(11,"mat-form-field",8),e.TgZ(12,"mat-label"),e._uU(13,"Platform"),e.qZA(),e.TgZ(14,"mat-select",9),e.YNc(15,re,2,2,"mat-option",10),e.qZA(),e.qZA(),e.qZA(),e.TgZ(16,"div",7),e.TgZ(17,"mat-form-field",8),e.TgZ(18,"mat-label"),e._uU(19,"Purpose"),e.qZA(),e.TgZ(20,"mat-select",11),e.YNc(21,se,2,2,"mat-option",10),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(22,"div",12),e.TgZ(23,"mat-form-field",8),e.TgZ(24,"mat-label"),e._uU(25,"Template"),e.qZA(),e.TgZ(26,"mat-select",13),e.YNc(27,ce,2,2,"mat-option",10),e.qZA(),e.qZA(),e.qZA(),e.TgZ(28,"div",12),e.TgZ(29,"mat-form-field",8),e.TgZ(30,"mat-label"),e._uU(31,"Name"),e.qZA(),e._UZ(32,"input",14),e.qZA(),e.YNc(33,ue,2,1,"app-field-hint",15),e.qZA(),e.qZA(),e.TgZ(34,"div",16),e.YNc(35,pe,3,0,"ng-container",0),e.TgZ(36,"button",17),e.NdJ("click",function(){return e.CHM(n),e.oxw().closeDialog()}),e._uU(37,"Cancel"),e.qZA(),e.TgZ(38,"button",18),e.NdJ("click",function(){return e.CHM(n),e.oxw().confirm()}),e._uU(39," Create "),e.qZA(),e.qZA(),e.YNc(40,fe,6,7,"ng-container",0),e.YNc(41,de,2,1,"div",19),e.qZA(),e.BQk()}if(2&o){var t=i.ngIf,u=e.oxw();e.xp6(6),e.Oqu(u.controls.finalName.value||(u.controls.folder.value?u.controls.folder.value.trim()+"/":"")),e.xp6(1),e.Q6J("formGroup",u.form),e.xp6(8),e.Q6J("ngForOf",t.platforms),e.xp6(6),e.Q6J("ngForOf",t.purposes),e.xp6(6),e.Q6J("ngForOf",t.templates),e.xp6(6),e.Q6J("ngIf",u.controls.name.touched&&(null==u.controls.name.errors?null:u.controls.name.errors.required)),e.xp6(2),e.Q6J("ngIf",t.loadingPreview),e.xp6(3),e.Q6J("disabled",!u.form.valid||t.loadingPreview||!t.previewValid),e.xp6(2),e.Q6J("ngIf",t.preview),e.xp6(1),e.Q6J("ngIf",!t.loadingPreview&&t.previewError)}}var ge=function(){var o=function(){function i(n,t,u){(0,E.Z)(this,i),this.dialogData=n,this.dialogRef=t,this.sourceService=u,this.hostClass="dialog-component",this.all="All"}return(0,N.Z)(i,[{key:"ngOnInit",value:function(){this.subscription=new w.w0,this.templates$=new x.X([]),this.loadingPreview$=new x.X(!1),this.buildForm(),this.fetchTemplates(),this.buildTemplateVars()}},{key:"ngOnDestroy",value:function(){this.templates$.complete(),this.loadingPreview$.complete(),this.subscription.unsubscribe()}},{key:"closeDialog",value:function(t){this.dialogRef.close(t)}},{key:"confirm",value:function(){var t=this.form.getRawValue();this.closeDialog({name:t.finalName,templateKey:t.templateKey})}},{key:"fetchTemplates",value:function(){var t=this;this.sourceService.getPredefinedTemplates(this.dialogData.purpose,this.dialogData.type).subscribe(function(u){t.controls.templateKey.value!==u.Default&&t.controls.templateKey.patchValue(u.Default),t.templates$.next(u.Templates)})}},{key:"buildForm",value:function(){var u,A,b,t=this;this.form=new c.cw({platform:new c.NI(this.all),purpose:new c.NI({value:null!==(u=this.dialogData.purpose)&&void 0!==u?u:this.all,disabled:null!=this.dialogData.purpose}),templateKey:new c.NI(null,c.kI.required),name:new c.NI(null!==(A=this.dialogData.name)&&void 0!==A?A:null,c.kI.required),finalName:new c.NI({value:null,disabled:!0}),folder:new c.NI({value:null!==(b=this.dialogData.folder)&&void 0!==b?b:"",disabled:!0})}),this.controls=this.form.controls,this.subscription.add((0,s.a)([this.templates$,this.controls.templateKey.valueChanges.pipe((0,I.O)(this.controls.templateKey.value),(0,y.x)())]).subscribe(function(_){var p,l=(0,P.Z)(_,2),v=l[1],d=l[0].find(function(C){return C.Key===v}),m=t.dialogData.name?t.controls.name.value||t.dialogData.name:null!==(p=null==d?void 0:d.SuggestedFileName)&&void 0!==p?p:null;t.controls.name.value!==m&&t.controls.name.patchValue(m)})),this.subscription.add((0,s.a)([this.templates$,this.controls.templateKey.valueChanges.pipe((0,I.O)(this.controls.templateKey.value),(0,y.x)()),this.controls.name.valueChanges.pipe((0,I.O)(this.controls.name.value),(0,y.x)()),this.controls.folder.valueChanges.pipe((0,I.O)(this.controls.folder.value),(0,y.x)())]).subscribe(function(_){var m,C,Z,l=(0,P.Z)(_,4),v=l[1],p=l[2],d=l[3],T=l[0].find(function(Y){return Y.Key===v}),K=null;p&&(d=d.trim(),p=ie.vl.sanitizePath(p.trim()),p="".concat(null!==(m=null==T?void 0:T.Prefix)&&void 0!==m?m:"").concat(p).concat(null!==(C=null==T?void 0:T.Suffix)&&void 0!==C?C:"").concat(null!==(Z=null==T?void 0:T.Extension)&&void 0!==Z?Z:""),K="".concat(d?"".concat(d,"/"):"").concat(p).replace(/\/{2,}/g,"/")),t.controls.finalName.value!==K&&t.controls.finalName.patchValue(K)}))}},{key:"buildTemplateVars",value:function(){var t=this,u=this.templates$.pipe((0,U.U)(function(l){var r=(0,Q.Z)({},t.all,t.all);return l.forEach(function(v){var p;null===(p=v.Platforms)||void 0===p||p.forEach(function(d){r[d]=d})}),Object.keys(r)})),A=this.templates$.pipe((0,U.U)(function(l){var r=(0,Q.Z)({},t.all,t.all);return l.forEach(function(v){r[v.Purpose]=v.Purpose}),Object.keys(r)})),b=(0,s.a)([this.templates$,this.controls.platform.valueChanges.pipe((0,I.O)(this.controls.platform.value),(0,y.x)()),this.controls.purpose.valueChanges.pipe((0,I.O)(this.controls.purpose.value),(0,y.x)())]).pipe((0,U.U)(function(l){var r=(0,P.Z)(l,3),p=r[1],d=r[2];return r[0].filter(function(C){var Z,T;return(p===t.all||null!==(T=null===(Z=C.Platforms)||void 0===Z?void 0:Z.includes(p))&&void 0!==T&&T)&&(d===t.all||C.Purpose===d)})}),(0,q.b)(function(l){var r,v;if(!l.some(function(d){return d.Key===t.controls.templateKey.value})){var p=null!==(v=null===(r=l[0])||void 0===r?void 0:r.Key)&&void 0!==v?v:null;t.controls.templateKey.value!==p&&t.controls.templateKey.patchValue(p)}})),_=(0,s.a)([this.controls.finalName.valueChanges.pipe((0,I.O)(this.controls.finalName.value),(0,y.x)()),this.controls.templateKey.valueChanges.pipe((0,I.O)(this.controls.templateKey.value),(0,y.x)())]).pipe(function oe(o){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:W,t=(0,D.H)(o,arguments.length>1&&void 0!==arguments[1]?arguments[1]:f.z);return ne(function(){return t},n)}(100,f.z,{leading:!0,trailing:!0}),(0,q.b)(function(){t.loadingPreview$.next(!0)}),(0,ae.w)(function(l){var r=(0,P.Z)(l,2),v=r[0],p=r[1];return v&&p?(0,h.D)([t.sourceService.getPreview(v,t.dialogData.global,p),(0,D.H)(500)]).pipe((0,U.U)(function(d){return(0,P.Z)(d,1)[0]})):(0,g.of)(void 0)}),(0,q.b)(function(){t.loadingPreview$.next(!1)}));this.templateVars$=(0,s.a)([u,A,b,_,this.loadingPreview$]).pipe((0,U.U)(function(l){var Z,r=(0,P.Z)(l,5),m=r[3];return{platforms:r[0],purposes:r[1],templates:r[2],loadingPreview:r[4],preview:null==m?void 0:m.Preview,previewValid:null!==(Z=null==m?void 0:m.IsValid)&&void 0!==Z&&Z,previewError:null==m?void 0:m.Error}}))}}]),i}();return o.\u0275fac=function(n){return new(n||o)(e.Y36(F.WI),e.Y36(F.so),e.Y36(z.t))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-create-file-dialog"]],hostVars:1,hostBindings:function(n,t){2&n&&e.Ikx("className",t.hostClass)},decls:2,vars:3,consts:[[4,"ngIf"],["mat-dialog-title",""],[1,"dialog-title-box","hide-scrollbar"],[1,"file-name"],[1,"dialog-form",3,"formGroup"],[1,"dialog-form-content","fancy-scrollbar-light"],[1,"field-container","multiple"],[1,"multiple-field"],["appearance","standard","color","accent"],["formControlName","platform"],[3,"value",4,"ngFor","ngForOf"],["formControlName","purpose"],[1,"field-container"],["formControlName","templateKey"],["matInput","","type","text","formControlName","name","required","","appMatInputAutofocus","","autofocusSelectValue","true"],[3,"isError",4,"ngIf"],[1,"dialog-form-actions"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],["class","preview-error",4,"ngIf"],[3,"value"],[3,"isError"],["mode","indeterminate","diameter","20","color","accent"],[1,"spacer"],[1,"preview-label-box"],[1,"preview-label",3,"ngClass"],[1,"fancy-scrollbar-light",3,"ngClass"],[1,"preview-error"]],template:function(n,t){1&n&&(e.YNc(0,me,42,10,"ng-container",0),e.ALo(1,"async")),2&n&&e.Q6J("ngIf",e.lcZ(1,1,t.templateVars$))},directives:[O.O5,c._Y,c.JL,c.sg,M.KE,M.hX,S.gD,c.JJ,c.u,O.sg,B.Nt,c.Fj,c.Q7,le,J.lW,$.ey,L.Y,G.$g,O.mk],pipes:[O.Ov],styles:[".dialog-title-box[_ngcontent-%COMP%]{justify-content:flex-start;align-items:baseline;line-height:normal;white-space:nowrap;overflow-x:auto}.dialog-title-box[_ngcontent-%COMP%]   .file-name[_ngcontent-%COMP%]{font-size:20px;margin-left:8px;background-color:#d3d3d3}.field-container[_ngcontent-%COMP%]:not(:first-of-type){margin-top:8px}.field-container.multiple[_ngcontent-%COMP%]{display:flex}.field-container.multiple[_ngcontent-%COMP%]   .multiple-field[_ngcontent-%COMP%]{flex:1}.field-container.multiple[_ngcontent-%COMP%]   .multiple-field[_ngcontent-%COMP%]:not(:first-of-type){margin-left:8px}.dialog-form-content[_ngcontent-%COMP%], .dialog-form-actions[_ngcontent-%COMP%]{flex-shrink:0}pre[_ngcontent-%COMP%]{flex-grow:1;flex-shrink:1;font-family:monospace}pre.disabled[_ngcontent-%COMP%]{color:#1d273d3d}.preview-label-box[_ngcontent-%COMP%]{position:relative}.preview-label-box[_ngcontent-%COMP%]   .preview-label[_ngcontent-%COMP%]{position:absolute;top:-20px;left:0px;font-size:12px;color:#0009;pointer-events:none}.preview-label-box[_ngcontent-%COMP%]   .preview-label.disabled[_ngcontent-%COMP%]{color:#1d273d70}.preview-error[_ngcontent-%COMP%]{margin-bottom:10px;font-size:14px;color:red}pre[_ngcontent-%COMP%]{display:block;padding:9.5px;margin:0 0 10px;font-size:13px;line-height:1.42857143;color:#333;word-break:break-all;word-wrap:break-word;background-color:#f5f5f5;border:1px solid #ccc;border-radius:4px;overflow-x:auto}"]}),o}(),ve=a(8598),he=a(8450),Ce=function(){var o=(0,N.Z)(function i(){(0,E.Z)(this,i)});return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[ve._,z.t],imports:[[O.ez,he.q,J.ot,S.LD,c.UX,M.lN,B.c,G.Cq]]}),o}()}}]);
//# sourceMappingURL=https://sources.2sxc.org/13.02.00/ng-edit/default-projects_ng-dialogs_src_app_create-file-dialog_index_ts.0df33b1fbfda2a56.js.map