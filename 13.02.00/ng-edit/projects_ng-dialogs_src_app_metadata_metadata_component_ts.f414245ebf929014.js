"use strict";(self.webpackChunkng_dialogs=self.webpackChunkng_dialogs||[]).push([["projects_ng-dialogs_src_app_metadata_metadata_component_ts","projects_ng-dialogs_src_app_shared_directives_click-stop-propagation_directive_ts","projects_ng-dialogs_src_app_app-administration_services_app-dialog-config_service_ts-_ad200","projects_ng-dialogs_src_app_app-administration_services_app-dialog-config_service_ts-_ad201"],{6886:function(A,E,e){e.d(E,{K:function(){return d}});var D=e(8069),M=e(8047),i=e(635),v=e(8598),p=e(7133),c=e(8784),m=e(2425),d=function(){var f=function(){function u(h,g,l){(0,D.Z)(this,u),this.http=h,this.context=g,this.dnnContext=l}return(0,M.Z)(u,[{key:"getDialogSettings",value:function(g){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/dialog/settings"),{params:{appId:null!=g?g:this.context.appId.toString()}}).pipe((0,i.U)(function(l){return l.Context.Language.List=l.Context.Language.List.filter(function(T){return T.IsEnabled}),l}))}}]),u}();return f.\u0275fac=function(h){return new(h||f)(p.LFG(c.eN),p.LFG(v._),p.LFG(m._y))},f.\u0275prov=p.Yz7({token:f,factory:f.\u0275fac}),f}()},1025:function(A,E,e){e.d(E,{T:function(){return C}});var D=e(8069),M=e(8047),i=e(8598),v=e(7003),p=e(7133),c=e(8784),m=e(2425),C=function(){var d=function(){function f(u,h,g){(0,D.Z)(this,f),this.http=u,this.context=h,this.dnnContext=g}return(0,M.Z)(f,[{key:"getContentInfo",value:function(h){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(v.v+"Get"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),scope:h}})}},{key:"exportParts",value:function(h,g,l){var T=this.dnnContext.$2sxc.http.apiUrl(v.v+"Export")+"?appId="+this.context.appId.toString()+"&zoneId="+this.context.zoneId.toString()+"&contentTypeIdsString="+h.join(";")+"&entityIdsString="+g.join(";")+"&templateIdsString="+l.join(";");window.open(T,"_blank","")}}]),f}();return d.\u0275fac=function(u){return new(u||d)(p.LFG(c.eN),p.LFG(i._),p.LFG(m._y))},d.\u0275prov=p.Yz7({token:d,factory:d.\u0275fac}),d}()},2372:function(A,E,e){e.d(E,{v:function(){return C}});var D=e(8069),M=e(8047),i=e(8854),v=e(8598),p=e(7133),c=e(8784),m=e(2425),C=function(){var d=function(){function f(u,h,g){(0,D.Z)(this,f),this.http=u,this.context=h,this.dnnContext=g}return(0,M.Z)(f,[{key:"getAppInfo",value:function(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(i.H+"Statistics"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}},{key:"exportApp",value:function(h,g){var l=this.dnnContext.$2sxc.http.apiUrl(i.H+"Export")+"?appId="+this.context.appId+"&zoneId="+this.context.zoneId+"&includeContentGroups="+h+"&resetAppGuid="+g;window.open(l,"_blank","")}},{key:"exportForVersionControl",value:function(h,g){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(i.H+"SaveData"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),includeContentGroups:h.toString(),resetAppGuid:g.toString()}})}}]),f}();return d.\u0275fac=function(u){return new(u||d)(p.LFG(c.eN),p.LFG(v._),p.LFG(m._y))},d.\u0275prov=p.Yz7({token:d,factory:d.\u0275fac}),d}()},7003:function(A,E,e){e.d(E,{v:function(){return C},z:function(){return d}});var D=e(8069),M=e(8047),i=e(8854),v=e(8598),p=e(7133),c=e(8784),m=e(2425),C="admin/appParts/",d=function(){var f=function(){function u(h,g,l){(0,D.Z)(this,u),this.http=h,this.context=g,this.dnnContext=l}return(0,M.Z)(u,[{key:"importAppParts",value:function(g){var l=new FormData;return l.append("File",g),this.http.post(this.dnnContext.$2sxc.http.apiUrl(C+"Import"),l,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}},{key:"resetApp",value:function(){return this.http.post(this.dnnContext.$2sxc.http.apiUrl(i.H+"Reset"),{},{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}}]),u}();return f.\u0275fac=function(h){return new(h||f)(p.LFG(c.eN),p.LFG(v._),p.LFG(m._y))},f.\u0275prov=p.Yz7({token:f,factory:f.\u0275fac}),f}()},7854:function(A,E,e){e.d(E,{Kw:function(){return D.K},sF:function(){return M.s},vG:function(){return c.vG},bf:function(){return c.bf},Az:function(){return c.Az},TB:function(){return c.TB},cv:function(){return c.cv},nt:function(){return c.nt},h3:function(){return m.h}});var D=e(6886),M=e(5005),c=(e(1025),e(2372),e(7003),e(6805)),m=e(6559)},6805:function(A,E,e){e.d(E,{cv:function(){return T},Az:function(){return y},nt:function(){return I},TB:function(){return P},bf:function(){return N},vG:function(){return t}});var D=e(8069),M=e(8047),i=e(7400),v=e(9525),p=e(7368),c=e(7396),m=e(8598),C=e(7133),d=e(8784),f=e(2425),u="admin/query/",T=u+"Run",y=u+"DebugStream",I=u+"Save",P=u+"Get",N=u+"DataSources",t=function(){var L=function(){function B(U,S,k){(0,D.Z)(this,B),this.http=U,this.context=S,this.dnnContext=k}return(0,M.Z)(B,[{key:"getAll",value:function(S){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(p.PS),{params:{appId:this.context.appId.toString(),contentType:S}})}},{key:"importQuery",value:function(S){var k=this;return(0,i.D)((0,c.s)(S)).pipe((0,v.z)(function(R){return k.http.post(k.dnnContext.$2sxc.http.apiUrl("admin/query/import"),{AppId:k.context.appId.toString(),ContentBase64:R})}))}},{key:"clonePipeline",value:function(S){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/query/Clone"),{params:{Id:S.toString(),appId:this.context.appId.toString()}})}},{key:"delete",value:function(S){return this.http.delete(this.dnnContext.$2sxc.http.apiUrl("admin/query/Delete"),{params:{appId:this.context.appId.toString(),Id:S.toString()}})}}]),B}();return L.\u0275fac=function(U){return new(U||L)(C.LFG(d.eN),C.LFG(m._),C.LFG(f._y))},L.\u0275prov=C.Yz7({token:L,factory:L.\u0275fac}),L}()},6559:function(A,E,e){e.d(E,{h:function(){return g}});var D=e(8069),M=e(8047),i=e(8598),v=e(7133),p=e(8784),c=e(2425),g=function(){var l=function(){function T(y,I,P){(0,D.Z)(this,T),this.http=y,this.context=I,this.dnnContext=P}return(0,M.Z)(T,[{key:"getAll",value:function(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/view/all"),{params:{appId:this.context.appId.toString()}})}},{key:"delete",value:function(I){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/view/delete"),{params:{appId:this.context.appId.toString(),Id:I.toString()}})}},{key:"import",value:function(I){var P=new FormData;return P.append("File",I),this.http.post(this.dnnContext.$2sxc.http.apiUrl("admin/view/import"),P,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})}},{key:"export",value:function(I){var P=this.dnnContext.$2sxc.http.apiUrl("admin/view/json")+"?appId="+this.context.appId+"&viewId="+I;window.open(P,"_blank","")}},{key:"getPolymorphism",value:function(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/view/polymorphism"),{params:{appId:this.context.appId.toString()}})}},{key:"getUsage",value:function(I){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/view/usage"),{params:{appId:this.context.appId.toString(),guid:I}})}}]),T}();return l.\u0275fac=function(y){return new(y||l)(v.LFG(p.eN),v.LFG(i._),v.LFG(c._y))},l.\u0275prov=v.Yz7({token:l,factory:l.\u0275fac}),l}()},803:function(A,E,e){e.d(E,{l:function(){return h}});var D=e(8069),M=e(8047),i=e(7400),v=e(9525),p=e(7368),c=e(4722),m=e(7396),C=e(8598),d=e(7133),f=e(8784),u=e(2425),h=function(){var g=function(){function l(T,y,I){(0,D.Z)(this,l),this.http=T,this.context=y,this.dnnContext=I}return(0,M.Z)(l,[{key:"getAll",value:function(y){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(p.PS),{params:{appId:this.context.appId.toString(),contentType:y}})}},{key:"getColumns",value:function(y){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(c.jt),{params:{appId:this.context.appId.toString(),staticName:y}})}},{key:"importItem",value:function(y){var I=this;return(0,i.D)((0,m.s)(y)).pipe((0,v.z)(function(P){return I.http.post(I.dnnContext.$2sxc.http.apiUrl(p.Uo+"upload"),{AppId:I.context.appId.toString(),ContentBase64:P})}))}}]),l}();return g.\u0275fac=function(T){return new(T||g)(d.LFG(f.eN),d.LFG(C._),d.LFG(u._y))},g.\u0275prov=d.Yz7({token:g,factory:g.\u0275fac}),g}()},8854:function(A,E,e){e.d(E,{H:function(){return m},a:function(){return C}});var D=e(8069),M=e(8047),i=e(8598),v=e(7133),p=e(8784),c=e(2425),m="admin/app/",C=function(){var d=function(){function f(u,h,g){(0,D.Z)(this,f),this.http=u,this.context=h,this.dnnContext=g}return(0,M.Z)(f,[{key:"importApp",value:function(h,g){var l=new FormData;return l.append("File",h),l.append("Name",g||""),this.http.post(this.dnnContext.$2sxc.http.apiUrl(m+"Import"),l,{params:{zoneId:this.context.zoneId.toString()}})}}]),f}();return d.\u0275fac=function(u){return new(u||d)(v.LFG(p.eN),v.LFG(i._),v.LFG(c._y))},d.\u0275prov=v.Yz7({token:d,factory:d.\u0275fac}),d}()},969:function(A,E,e){e.r(E),e.d(E,{MetadataComponent:function(){return Zt}});var D=e(2090),M=e(8069),i=e(8047),v=e(1276),p=e(2977),c=e(6317),m=e(7714),C=e(6562),d=e(635),f=e(116),u=e(4874),h=e(679),g=e(803),l=e(8130),T=e(6307),y=e(5578),I=e(9119),P=e(1825),N=e(5137),t=e(7133),L=e(1130),B=e(785),U=e(5590),S=function(){var a=function(){function s(){(0,M.Z)(this,s)}return(0,i.Z)(s,[{key:"agInit",value:function(n){this.params=n}},{key:"refresh",value:function(n){return!0}},{key:"deleteMetadata",value:function(){this.params.onDelete(this.params.data)}}]),s}();return a.\u0275fac=function(o){return new(o||a)},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-metadata-actions"]],decls:4,vars:0,consts:[[1,"actions-component"],["matRipple","","tippy","Delete",1,"like-button","highlight",3,"click"]],template:function(o,n){1&o&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.NdJ("click",function(){return n.deleteMetadata()}),t.TgZ(2,"mat-icon"),t._uU(3,"delete"),t.qZA(),t.qZA(),t.qZA())},directives:[L.wG,B.$,U.Hw],styles:[""]}),a}(),k=function(){var a=function(){function s(){(0,M.Z)(this,s)}return(0,i.Z)(s,[{key:"agInit",value:function(n){this.value=n.value,this.metadata=n.data}},{key:"refresh",value:function(n){return!0}}]),s}();return a.\u0275fac=function(o){return new(o||a)},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-metadata-content-type"]],decls:2,vars:3,consts:[[1,"container",3,"tippy","tippyDisabled"]],template:function(o,n){1&o&&(t.TgZ(0,"div",0),t._uU(1),t.qZA()),2&o&&(t.Q6J("tippy",n.metadata._Type.Description)("tippyDisabled",!n.metadata._Type.Description),t.xp6(1),t.hij(" ",n.value,"\n"))},directives:[B.$],styles:[".container[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content}"]}),a}(),R=e(5758),W=e(6362),G=e(7317),X=e(845);function q(a,s){if(1&a&&(t._UZ(0,"div",6),t.ALo(1,"safeHtml")),2&a){var o=t.oxw();t.Q6J("innerHtml",t.lcZ(1,1,o.dialogData.message),t.oJD)}}var tt=function(){var a=function(){function s(o,n){(0,M.Z)(this,s),this.dialogData=o,this.dialogRef=n,this.hostClass="dialog-component"}return(0,i.Z)(s,[{key:"closeDialog",value:function(n){this.dialogRef.close(n)}}]),s}();return a.\u0275fac=function(o){return new(o||a)(t.Y36(R.WI),t.Y36(R.so))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-confirm-delete-dialog"]],hostVars:1,hostBindings:function(o,n){2&o&&t.Ikx("className",n.hostClass)},decls:9,vars:3,consts:[["mat-dialog-title",""],[1,"dialog-title-box"],["class","dialog-component-content fancy-scrollbar-light",3,"innerHtml",4,"ngIf"],[1,"dialog-component-actions"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"click"],[1,"dialog-component-content","fancy-scrollbar-light",3,"innerHtml"]],template:function(o,n){1&o&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t._uU(2),t.qZA(),t.qZA(),t.YNc(3,q,2,3,"div",2),t.TgZ(4,"div",3),t.TgZ(5,"button",4),t.NdJ("click",function(){return n.closeDialog()}),t._uU(6,"Cancel"),t.qZA(),t.TgZ(7,"button",5),t.NdJ("click",function(){return n.closeDialog(!0)}),t._uU(8,"Delete"),t.qZA(),t.qZA()),2&o&&(t.xp6(2),t.AsE("Delete ",n.dialogData.entityTitle," (",n.dialogData.entityId,")?"),t.xp6(1),t.Q6J("ngIf",n.dialogData.message))},directives:[R.uh,W.O5,G.lW],pipes:[X.z],styles:[".dialog-component-content[_ngcontent-%COMP%]{font-size:14px}"]}),a}(),et=e(6170),F=e(587),nt=e(8977),ot=e(7854),z=e(9670),Q=e(4770),at=e(6623),it=e(1434),rt=e(3135),st=e(491),ct=e(4683);function lt(a,s){if(1&a&&(t.TgZ(0,"mat-option",21),t._uU(1),t.qZA()),2&a){var o=s.$implicit;t.Q6J("value",o.value),t.xp6(1),t.hij(" ",o.name," ")}}function _t(a,s){if(1&a&&(t.ynx(0),t.TgZ(1,"mat-form-field",7),t.TgZ(2,"mat-label"),t._uU(3,"Scope"),t.qZA(),t.TgZ(4,"mat-select",19),t.YNc(5,lt,2,2,"mat-option",20),t.TgZ(6,"mat-option",21),t._uU(7,"Other..."),t.qZA(),t.qZA(),t.qZA(),t.TgZ(8,"app-field-hint"),t._uU(9," The scope should almost never be changed - "),t.TgZ(10,"a",22),t._uU(11,"see help"),t.qZA(),t.qZA(),t.BQk()),2&a){var o=t.oxw().ngIf,n=t.oxw();t.xp6(4),t.Q6J("placeholder",o.scopeOptions.length?"":"No items found"),t.xp6(1),t.Q6J("ngForOf",o.scopeOptions),t.xp6(1),t.Q6J("value",n.dropdownInsertValue)}}function pt(a,s){if(1&a&&(t.TgZ(0,"mat-option",21),t._uU(1),t.qZA()),2&a){var o=s.$implicit;t.Q6J("value",o.StaticName),t.xp6(1),t.hij(" ",o.Label," ")}}function ut(a,s){if(1&a&&(t.TgZ(0,"mat-select",23),t.YNc(1,pt,2,2,"mat-option",20),t.qZA()),2&a){var o=t.oxw().ngIf;t.Q6J("placeholder",o.contentTypes.length?"":"No items found"),t.xp6(1),t.Q6J("ngForOf",o.contentTypes)}}function dt(a,s){1&a&&t._UZ(0,"input",24)}function mt(a,s){1&a&&(t.TgZ(0,"app-field-hint",25),t._uU(1," This field is required "),t.qZA()),2&a&&t.Q6J("isError",!0)}var V=function(s){return{active:s}};function ft(a,s){if(1&a){var o=t.EpF();t.ynx(0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t._uU(3,"Create Metadata"),t.qZA(),t.qZA(),t.TgZ(4,"p",3),t._uU(5," This is a special operation to add an item which is metadata for another item, see "),t.TgZ(6,"a",4),t._uU(7,"docs"),t.qZA(),t._uU(8,". "),t.qZA(),t.TgZ(9,"form",5),t.TgZ(10,"div",6),t.YNc(11,_t,12,3,"ng-container",0),t.TgZ(12,"mat-form-field",7),t.TgZ(13,"mat-label"),t._uU(14,"Content Type"),t.qZA(),t.YNc(15,ut,2,2,"mat-select",8),t.YNc(16,dt,1,0,"input",9),t.TgZ(17,"div",10),t.TgZ(18,"button",11),t.NdJ("click",function(){return t.CHM(o),t.oxw().toggleGuidedContentType(!0)}),t.TgZ(19,"mat-icon"),t._uU(20,"search"),t.qZA(),t.qZA(),t.TgZ(21,"button",12),t.NdJ("click",function(){return t.CHM(o),t.oxw().toggleGuidedContentType(!1)}),t.TgZ(22,"mat-icon"),t._uU(23,"text_fields"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(24,mt,2,1,"app-field-hint",13),t.qZA(),t.TgZ(25,"div",14),t.TgZ(26,"mat-slide-toggle",15),t.NdJ("change",function(_){return t.CHM(o),t.oxw().toggleAdvancedMode(_)}),t._uU(27),t.qZA(),t._UZ(28,"div",16),t.TgZ(29,"button",17),t.NdJ("click",function(){return t.CHM(o),t.oxw().closeDialog()}),t._uU(30,"Cancel"),t.qZA(),t.TgZ(31,"button",18),t.NdJ("click",function(){return t.CHM(o),t.oxw().confirm()}),t._uU(32," Confirm "),t.qZA(),t.qZA(),t.qZA(),t.BQk()}if(2&a){var n=t.oxw();t.xp6(9),t.Q6J("formGroup",n.form),t.xp6(2),t.Q6J("ngIf",n.advancedMode&&n.guidedContentType),t.xp6(4),t.Q6J("ngIf",n.guidedContentType),t.xp6(1),t.Q6J("ngIf",!n.guidedContentType),t.xp6(2),t.Q6J("ngClass",t.VKq(10,V,n.guidedContentType)),t.xp6(3),t.Q6J("ngClass",t.VKq(12,V,!n.guidedContentType)),t.xp6(3),t.Q6J("ngIf",n.form.controls.contentType.touched&&(null==n.form.controls.contentType.errors?null:n.form.controls.contentType.errors.required)),t.xp6(2),t.Q6J("checked",n.advancedMode),t.xp6(1),t.hij(" ",n.advancedMode?"Advanced":"Simple"," "),t.xp6(4),t.Q6J("disabled",!n.form.valid)}}var gt=function(){var a=function(){function s(o,n){(0,M.Z)(this,s),this.dialogRef=o,this.contentTypesService=n,this.hostClass="dialog-component",this.dropdownInsertValue=z.G,this.guidedContentType=!0,this.advancedMode=!1}return(0,i.Z)(s,[{key:"ngOnInit",value:function(){this.contentTypes$=new c.X([]),this.scopeOptions$=new c.X([]),this.buildForm(),this.fetchScopes(),this.templateVars$=(0,C.a)([this.contentTypes$,this.scopeOptions$]).pipe((0,d.U)(function(n){var r=(0,D.Z)(n,2);return{contentTypes:r[0],scopeOptions:r[1]}}))}},{key:"ngOnDestroy",value:function(){this.contentTypes$.complete(),this.scopeOptions$.complete()}},{key:"closeDialog",value:function(n){this.dialogRef.close(n)}},{key:"toggleGuidedContentType",value:function(n){this.guidedContentType=n}},{key:"toggleAdvancedMode",value:function(n){this.advancedMode=n.checked}},{key:"confirm",value:function(){var n=this.form.getRawValue();this.closeDialog(n.contentType)}},{key:"buildForm",value:function(){var n=this;this.form=new F.cw({}),this.form.addControl("contentType",new F.NI(null,[F.kI.required])),this.form.addControl("scope",new F.NI(P.Z.scopes.default.value)),this.form.controls.scope.valueChanges.pipe((0,u.O)(this.form.controls.scope.value),(0,nt.x)()).subscribe(function(r){null!=n.form.controls.contentType.value&&n.form.controls.contentType.patchValue(null),r===z.G?(r=prompt("This is an advanced feature to show content-types of another scope. Don't use this if you don't know what you're doing, as content-types of other scopes are usually hidden for a good reason.")||P.Z.scopes.default.value,n.scopeOptions$.value.some(function(x){return x.value===r})||n.scopeOptions$.next([{name:r,value:r}].concat((0,et.Z)(n.scopeOptions$.value))),n.form.controls.scope.patchValue(r)):n.fetchContentTypes(r)})}},{key:"fetchContentTypes",value:function(n){var r=this;this.contentTypesService.retrieveContentTypes(n).subscribe(function(_){r.contentTypes$.next(_)})}},{key:"fetchScopes",value:function(){var n=this;this.contentTypesService.getScopes().subscribe(function(r){n.scopeOptions$.next(r)})}}]),s}();return a.\u0275fac=function(o){return new(o||a)(t.Y36(R.so),t.Y36(ot.sF))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-metadata-save-dialog"]],hostVars:1,hostBindings:function(o,n){2&o&&t.Ikx("className",n.hostClass)},decls:2,vars:3,consts:[[4,"ngIf"],["mat-dialog-title",""],[1,"dialog-title-box"],[1,"dialog-description"],["href","http://r.2sxc.org/metadata","target","_blank"],[1,"dialog-form",3,"formGroup"],[1,"dialog-form-content","fancy-scrollbar-light"],["appearance","standard","color","accent"],["formControlName","contentType","required","",3,"placeholder",4,"ngIf"],["matInput","","type","text","formControlName","contentType","required","",4,"ngIf"],["matSuffix","",1,"selection-suffix"],["mat-icon-button","","type","button","tippy","Pick existing value",3,"ngClass","click"],["mat-icon-button","","type","button","tippy","Manual entry",3,"ngClass","click"],[3,"isError",4,"ngIf"],[1,"dialog-form-actions"],["color","accent",3,"checked","change"],[1,"spacer"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],["formControlName","scope",3,"placeholder"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["href","https://2sxc.org/help?tag=scope","target","_blank","appClickStopPropagation",""],["formControlName","contentType","required","",3,"placeholder"],["matInput","","type","text","formControlName","contentType","required",""],[3,"isError"]],template:function(o,n){1&o&&(t.YNc(0,ft,33,14,"ng-container",0),t.ALo(1,"async")),2&o&&t.Q6J("ngIf",t.lcZ(1,1,n.templateVars$))},directives:[W.O5,R.uh,F._Y,F.JL,F.sg,Q.KE,Q.hX,Q.R9,G.lW,B.$,W.mk,U.Hw,at.Rr,it.gD,F.JJ,F.u,W.sg,L.ey,rt.Y,st.E,F.Q7,ct.Nt,F.Fj],pipes:[W.Ov],styles:[".dialog-form-content[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]:not(:first-of-type){margin-top:8px}"]}),a}(),vt=e(2528),ht=e(1350),J=e(5718);function Ct(a,s){1&a&&(t.ynx(0),t._uU(1,"This item is not metadata for anything else."),t.BQk())}function Tt(a,s){if(1&a&&(t.ynx(0),t._UZ(1,"br"),t._uU(2),t.BQk()),2&a){var o=t.oxw(2).ngIf;t.xp6(2),t.hij("Number: ",o.itemFor.Number,"")}}function xt(a,s){if(1&a&&(t.ynx(0),t._UZ(1,"br"),t._uU(2),t.BQk()),2&a){var o=t.oxw(2).ngIf;t.xp6(2),t.hij("Guid: ",o.itemFor.Guid,"")}}function Mt(a,s){if(1&a&&(t.ynx(0),t._UZ(1,"br"),t._uU(2),t.BQk()),2&a){var o=t.oxw(2).ngIf;t.xp6(2),t.hij("String: ",o.itemFor.String,"")}}function yt(a,s){if(1&a&&(t.ynx(0),t._UZ(1,"br"),t._uU(2),t.BQk()),2&a){var o=t.oxw(2).ngIf;t.xp6(2),t.hij("Title: ",o.itemFor.String,"")}}function Dt(a,s){if(1&a&&(t.ynx(0),t._uU(1," This item is metadata for: "),t._UZ(2,"br"),t._uU(3),t._UZ(4,"br"),t._uU(5),t.YNc(6,Tt,3,1,"ng-container",0),t.YNc(7,xt,3,1,"ng-container",0),t.YNc(8,Mt,3,1,"ng-container",0),t.YNc(9,yt,3,1,"ng-container",0),t.BQk()),2&a){var o=t.oxw().ngIf;t.xp6(3),t.hij("Target: ",o.itemFor.Target," "),t.xp6(2),t.hij("TargetType: ",o.itemFor.TargetType," "),t.xp6(1),t.Q6J("ngIf",o.itemFor.Number),t.xp6(1),t.Q6J("ngIf",o.itemFor.Guid),t.xp6(1),t.Q6J("ngIf",o.itemFor.String),t.xp6(1),t.Q6J("ngIf",o.itemFor.Title)}}function Et(a,s){if(1&a){var o=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){return t.CHM(o),t.oxw(2).createMetadata()}),t.TgZ(1,"mat-icon"),t._uU(2,"add"),t.qZA(),t.qZA()}}function It(a,s){if(1&a){var o=t.EpF();t.TgZ(0,"button",18),t.NdJ("click",function(){var x=t.CHM(o).$implicit;return t.oxw(3).createMetadata(x)}),t.TgZ(1,"mat-icon"),t._uU(2),t.qZA(),t.qZA()}if(2&a){var n=s.$implicit;t.uIk("label",n.Title),t.xp6(2),t.Oqu(n.Icon||"add")}}var Pt=function(s){return{"fab-opened":s}};function Ot(a,s){if(1&a){var o=t.EpF();t.TgZ(0,"eco-fab-speed-dial",12),t.NdJ("openChange",function(_){return t.CHM(o),t.oxw(2).openChange(_)}),t.TgZ(1,"eco-fab-speed-dial-trigger",13),t.TgZ(2,"button",14),t.TgZ(3,"mat-icon",15),t._uU(4),t.qZA(),t.qZA(),t.qZA(),t.TgZ(5,"eco-fab-speed-dial-actions"),t.TgZ(6,"button",16),t.NdJ("click",function(){return t.CHM(o),t.oxw(2).createMetadata()}),t.TgZ(7,"mat-icon"),t._uU(8,"search"),t.qZA(),t.qZA(),t.YNc(9,It,3,2,"button",17),t.qZA(),t.qZA()}if(2&a){var n=t.oxw().ngIf;t.Q6J("ngClass",t.VKq(4,Pt,n.fabOpen)),t.xp6(1),t.Q6J("spin",!0),t.xp6(3),t.Oqu(n.fabOpen?"close":"add"),t.xp6(5),t.Q6J("ngForOf",n.recommendations)}}function At(a,s){if(1&a){var o=t.EpF();t.ynx(0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"div",3),t.TgZ(4,"div"),t._uU(5),t.qZA(),t.TgZ(6,"button",4),t.NdJ("click",function(){return t.CHM(o),t.oxw().closeDialog()}),t.TgZ(7,"mat-icon"),t._uU(8,"close"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(9,"p",5),t.YNc(10,Ct,2,0,"ng-container",0),t.YNc(11,Dt,10,6,"ng-container",0),t.qZA(),t._UZ(12,"router-outlet"),t.TgZ(13,"div",6),t._UZ(14,"ag-grid-angular",7),t._UZ(15,"div",8),t.YNc(16,Et,3,0,"button",9),t.YNc(17,Ot,10,6,"eco-fab-speed-dial",10),t.qZA(),t.qZA(),t.BQk()}if(2&a){var n=s.ngIf,r=t.oxw();t.xp6(5),t.Oqu(r.title||"Metadata"),t.xp6(5),t.Q6J("ngIf",!n.itemFor),t.xp6(1),t.Q6J("ngIf",n.itemFor),t.xp6(3),t.Q6J("rowData",n.metadata)("modules",r.modules)("gridOptions",r.gridOptions),t.xp6(2),t.Q6J("ngIf",0===n.recommendations.length),t.xp6(1),t.Q6J("ngIf",n.recommendations.length>0)}}var Zt=function(){var a=function(){function s(o,n,r,_,x,O,K,b,Y,Ut){var H,w=this;(0,M.Z)(this,s),this.dialogRef=o,this.router=n,this.route=r,this.metadataService=_,this.snackBar=x,this.entitiesService=O,this.contentItemsService=K,this.dialog=b,this.viewContainerRef=Y,this.changeDetectorRef=Ut,this.modules=v.F$,this.gridOptions=Object.assign(Object.assign({},I.f),{frameworkComponents:{idFieldComponent:y.m,metadataContentTypeComponent:k,metadataActionsComponent:S},columnDefs:[{field:"ID",width:70,headerClass:"dense",cellClass:"id-action no-padding no-outline",cellRenderer:"idFieldComponent",sortable:!0,filter:"agNumberColumnFilter",valueGetter:function(Z){return Z.data.Id},cellRendererParams:{tooltipGetter:function(Z){return"ID: ".concat(Z.Id,"\nGUID: ").concat(Z.Guid)}}},{field:"Title",flex:2,minWidth:250,cellClass:"primary-action highlight",valueGetter:function(Z){return Z.data.Title},sortable:!0,sort:"asc",filter:"agTextColumnFilter",onCellClicked:function(Z){return w.editMetadata(Z.data)}},{field:"Content Type",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,cellRenderer:"metadataContentTypeComponent",filter:"agTextColumnFilter",valueGetter:function(Z){var $=Z.data;return"".concat($._Type.Name).concat($._Type.Title!==$._Type.Name?" (".concat($._Type.Title,")"):"")}},{width:42,cellClass:"secondary-action no-padding",cellRenderer:"metadataActionsComponent",pinned:"right",cellRendererParams:{onDelete:function(Z){return w.deleteMetadata(Z)}}}]}),this.metadata$=new c.X([]),this.recommendations$=new c.X([]),this.itemFor$=new c.X(void 0),this.fabOpen$=new c.X(!1),this.subscription=new m.w0,this.targetType=parseInt(this.route.snapshot.paramMap.get("targetType"),10),this.keyType=this.route.snapshot.paramMap.get("keyType"),this.key=this.route.snapshot.paramMap.get("key"),this.title=decodeURIComponent(null!==(H=this.route.snapshot.paramMap.get("title"))&&void 0!==H?H:""),this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName")}return(0,i.Z)(s,[{key:"ngOnInit",value:function(){this.fetchFor(),this.fetchMetadata(),this.refreshOnChildClosed();var n=(0,C.a)([this.metadata$,this.recommendations$]).pipe((0,d.U)(function(r){var _=(0,D.Z)(r,2),x=_[0];return _[1].filter(function(K){return 1===K.Count&&!x.some(function(b){return b._Type.Id===K.Id})})}));this.templateVars$=(0,C.a)([this.metadata$,n,this.itemFor$,this.fabOpen$]).pipe((0,d.U)(function(r){var _=(0,D.Z)(r,4);return{metadata:_[0],recommendations:_[1],itemFor:_[2],fabOpen:_[3]}}))}},{key:"ngOnDestroy",value:function(){this.metadata$.complete(),this.recommendations$.complete(),this.itemFor$.complete(),this.fabOpen$.complete(),this.subscription.unsubscribe()}},{key:"closeDialog",value:function(){this.dialogRef.close()}},{key:"openChange",value:function(n){this.fabOpen$.next(n)}},{key:"createMetadata",value:function(n){var r=this;n?n.CreateEmpty?(this.snackBar.open("Creating ".concat(n.Name,"...")),this.entitiesService.create(n.Id,{For:this.calculateItemFor()}).subscribe({error:function(){r.snackBar.open("Creating ".concat(n.Name," failed. Please check console for more info"),void 0,{duration:3e3}),r.fetchMetadata()},next:function(){r.snackBar.open("Created ".concat(n.Name),void 0,{duration:3e3}),r.fetchMetadata()}})):this.createMetadataForm(n.Id):this.dialog.open(gt,{autoFocus:!1,viewContainerRef:this.viewContainerRef,width:"650px"}).afterClosed().subscribe(function(x){null!=x&&r.createMetadataForm(x)})}},{key:"createMetadataForm",value:function(n){var r={items:[{ContentTypeName:n,For:this.calculateItemFor()}]},_=(0,N.f)(r);this.router.navigate(["edit/".concat(_)],{relativeTo:this.route}),this.changeDetectorRef.markForCheck()}},{key:"calculateItemFor",value:function(){var r,_,n=this;return Object.assign(Object.assign(Object.assign({Target:null!==(_=null===(r=Object.values(P.Z.metadata).find(function(O){return O.targetType===n.targetType}))||void 0===r?void 0:r.target)&&void 0!==_?_:this.targetType.toString(),TargetType:this.targetType},this.keyType===P.Z.keyTypes.guid&&{Guid:this.key}),this.keyType===P.Z.keyTypes.number&&{Number:parseInt(this.key,10)}),this.keyType===P.Z.keyTypes.string&&{String:this.key})}},{key:"fetchFor",value:function(){var n=this;!this.contentTypeStaticName||this.contentItemsService.getAll(this.contentTypeStaticName).subscribe(function(r){var _=r.find(function(x){return x.Guid===n.key});(null==_?void 0:_.For)&&n.itemFor$.next(_.For)})}},{key:"fetchMetadata",value:function(){var n=this;this.metadataService.getMetadata(this.targetType,this.keyType,this.key).subscribe(function(r){n.metadata$.next(r.Items),n.recommendations$.next(r.Recommendations)})}},{key:"editMetadata",value:function(n){var _=(0,N.f)({items:[{EntityId:n.Id}]});this.router.navigate(["edit/".concat(_)],{relativeTo:this.route})}},{key:"deleteMetadata",value:function(n){var x,r=this,_=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(_)this.snackBar.open("Deleting..."),this.entitiesService.delete(n._Type.Id,n.Id,!1).subscribe({next:function(){r.snackBar.open("Deleted",null,{duration:2e3}),r.fetchMetadata()},error:function(){r.snackBar.open("Delete failed. Please check console for more information",null,{duration:3e3})}});else{var O={entityId:n.Id,entityTitle:n.Title,message:null===(x=this.recommendations$.value.find(function(b){return b.Id===n._Type.Id}))||void 0===x?void 0:x.DeleteWarning},K=this.dialog.open(tt,{autoFocus:!1,data:O,viewContainerRef:this.viewContainerRef,width:"650px"});K.afterClosed().subscribe(function(b){b&&r.deleteMetadata(n,!0)})}}},{key:"refreshOnChildClosed",value:function(){var n=this;this.subscription.add(this.router.events.pipe((0,f.h)(function(r){return r instanceof p.m2}),(0,u.O)(!!this.route.snapshot.firstChild),(0,d.U)(function(){return!!n.route.snapshot.firstChild}),(0,h.G)(),(0,f.h)(function(r){var _=(0,D.Z)(r,2);return _[0]&&!_[1]})).subscribe(function(){n.fetchMetadata()}))}}]),s}();return a.\u0275fac=function(o){return new(o||a)(t.Y36(R.so),t.Y36(p.F0),t.Y36(p.gz),t.Y36(T.Do),t.Y36(vt.ux),t.Y36(l.g),t.Y36(g.l),t.Y36(R.uw),t.Y36(t.s_b),t.Y36(t.sBO))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-metadata"]],decls:2,vars:3,consts:[[4,"ngIf"],[1,"nav-component-wrapper"],["mat-dialog-title",""],[1,"dialog-title-box"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"dialog-description"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","modules","gridOptions"],[1,"grid-more-actions-box"],["mat-fab","","mat-elevation-z24","","class","grid-fab","tippy","Create a new metadata for this item",3,"click",4,"ngIf"],["class","grid-fab",3,"ngClass","openChange",4,"ngIf"],["mat-fab","","mat-elevation-z24","","tippy","Create a new metadata for this item",1,"grid-fab",3,"click"],[1,"grid-fab",3,"ngClass","openChange"],[3,"spin"],["mat-fab",""],[1,"spin180"],["mat-mini-fab","","label","Other Content Type",3,"click"],["mat-mini-fab","",3,"click",4,"ngFor","ngForOf"],["mat-mini-fab","",3,"click"]],template:function(o,n){1&o&&(t.YNc(0,At,18,8,"ng-container",0),t.ALo(1,"async")),2&o&&t.Q6J("ngIf",t.lcZ(1,1,n.templateVars$))},directives:[W.O5,R.uh,G.lW,B.$,U.Hw,p.lC,ht.N8,J.W7,W.mk,J.YI,J.Lp,W.sg],pipes:[W.Ov],styles:[""]}),a}()},3135:function(A,E,e){e.d(E,{Y:function(){return g}});var D=e(8069),M=e(8047),i=e(7133),v=e(6362),p=e(4770);function c(l,T){1&l&&i.GkF(0)}function m(l,T){if(1&l&&(i.TgZ(0,"mat-hint"),i.YNc(1,c,1,0,"ng-container",3),i.qZA()),2&l){i.oxw();var y=i.MAs(4);i.xp6(1),i.Q6J("ngTemplateOutlet",y)}}function C(l,T){1&l&&i.GkF(0)}function d(l,T){if(1&l&&(i.TgZ(0,"mat-error"),i.YNc(1,C,1,0,"ng-container",3),i.qZA()),2&l){i.oxw();var y=i.MAs(4);i.xp6(1),i.Q6J("ngTemplateOutlet",y)}}function f(l,T){1&l&&i.Hsn(0)}var u=function(T){return{"hint-box__short":T}},h=["*"],g=function(){var l=function(){function T(){(0,D.Z)(this,T),this.isError=!1,this.isShort=!0}return(0,M.Z)(T,[{key:"toggleIsShort",value:function(){this.isShort=!this.isShort}}]),T}();return l.\u0275fac=function(y){return new(y||l)},l.\u0275cmp=i.Xpm({type:l,selectors:[["app-field-hint"]],inputs:{isError:"isError"},ngContentSelectors:h,decls:5,vars:6,consts:[[1,"hint-box",3,"ngClass","ngSwitch","click"],[4,"ngSwitchCase"],["content",""],[4,"ngTemplateOutlet"]],template:function(y,I){1&y&&(i.F$t(),i.TgZ(0,"div",0),i.NdJ("click",function(){return I.toggleIsShort()}),i.YNc(1,m,2,1,"mat-hint",1),i.YNc(2,d,2,1,"mat-error",1),i.qZA(),i.YNc(3,f,1,0,"ng-template",null,2,i.W1O)),2&y&&(i.Q6J("ngClass",i.VKq(4,u,I.isShort))("ngSwitch",I.isError),i.xp6(1),i.Q6J("ngSwitchCase",!1),i.xp6(1),i.Q6J("ngSwitchCase",!0))},directives:[v.mk,v.RF,v.n9,p.bx,v.tP,p.TO],styles:[".hint-box[_ngcontent-%COMP%]{margin-top:4px}.hint-box[_ngcontent-%COMP%]   .mat-hint[_ngcontent-%COMP%], .hint-box[_ngcontent-%COMP%]   .mat-error[_ngcontent-%COMP%]{font-size:12px;display:block}.hint-box__short[_ngcontent-%COMP%]   .mat-hint[_ngcontent-%COMP%], .hint-box__short[_ngcontent-%COMP%]   .mat-error[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]}),l}()},491:function(A,E,e){e.d(E,{E:function(){return v}});var D=e(8069),M=e(8047),i=e(7133),v=function(){var p=function(){function c(){(0,D.Z)(this,c)}return(0,M.Z)(c,[{key:"onClick",value:function(C){C.stopPropagation()}}]),c}();return p.\u0275fac=function(m){return new(m||p)},p.\u0275dir=i.lG2({type:p,selectors:[["","appClickStopPropagation",""]],hostBindings:function(m,C){1&m&&i.NdJ("click",function(f){return C.onClick(f)})}}),p}()},7396:function(A,E,e){function D(i){return new Promise(function(v,p){var c=new FileReader;c.readAsDataURL(i),c.onload=function(){v(c.result.split(",")[1])},c.onerror=function(m){p(m)}})}function M(i){return new Promise(function(v,p){var c=new FileReader;c.readAsText(i),c.onload=function(){v(c.result)},c.onerror=function(m){p(m)}})}e.d(E,{s:function(){return D},B:function(){return M}})},845:function(A,E,e){e.d(E,{z:function(){return p}});var D=e(8069),M=e(8047),i=e(7133),v=e(318),p=function(){var c=function(){function m(C){(0,D.Z)(this,m),this.sanitizer=C}return(0,M.Z)(m,[{key:"transform",value:function(d){return this.sanitizer.bypassSecurityTrustHtml(d)}}]),m}();return c.\u0275fac=function(C){return new(C||c)(i.Y36(v.H7,16))},c.\u0275pipe=i.Yjl({name:"safeHtml",type:c,pure:!0}),c}()}}]);
//# sourceMappingURL=https://sources.2sxc.org/13.02.00/ng-edit/projects_ng-dialogs_src_app_metadata_metadata_component_ts.f414245ebf929014.js.map