var $2sxcInpage;(()=>{var t,e,n={98:function(t,e){var n="undefined"!=typeof self?self:this,o=function(){function t(){this.fetch=!1,this.DOMException=n.DOMException}return t.prototype=n,new t}();!function(t){!function(e){var n="URLSearchParams"in t,o="Symbol"in t&&"iterator"in Symbol,r="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),i="FormData"in t,s="ArrayBuffer"in t;if(s)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],l=ArrayBuffer.isView||function(t){return t&&a.indexOf(Object.prototype.toString.call(t))>-1};function c(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function u(t){return"string"!=typeof t&&(t=String(t)),t}function d(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return o&&(e[Symbol.iterator]=function(){return e}),e}function p(t){this.map={},t instanceof p?t.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function h(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function f(t){return new Promise((function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function g(t){var e=new FileReader,n=f(e);return e.readAsArrayBuffer(t),n}function m(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function b(){return this.bodyUsed=!1,this._initBody=function(t){var e;this._bodyInit=t,t?"string"==typeof t?this._bodyText=t:r&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:i&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:n&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():s&&r&&(e=t)&&DataView.prototype.isPrototypeOf(e)?(this._bodyArrayBuffer=m(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(t)||l(t))?this._bodyArrayBuffer=m(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},r&&(this.blob=function(){var t=h(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?h(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(g)}),this.text=function(){var t,e,n,o=h(this);if(o)return o;if(this._bodyBlob)return t=this._bodyBlob,n=f(e=new FileReader),e.readAsText(t),n;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),n=new Array(e.length),o=0;o<e.length;o++)n[o]=String.fromCharCode(e[o]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},i&&(this.formData=function(){return this.text().then(w)}),this.json=function(){return this.text().then(JSON.parse)},this}p.prototype.append=function(t,e){t=c(t),e=u(e);var n=this.map[t];this.map[t]=n?n+", "+e:e},p.prototype.delete=function(t){delete this.map[c(t)]},p.prototype.get=function(t){return t=c(t),this.has(t)?this.map[t]:null},p.prototype.has=function(t){return this.map.hasOwnProperty(c(t))},p.prototype.set=function(t,e){this.map[c(t)]=u(e)},p.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},p.prototype.keys=function(){var t=[];return this.forEach((function(e,n){t.push(n)})),d(t)},p.prototype.values=function(){var t=[];return this.forEach((function(e){t.push(e)})),d(t)},p.prototype.entries=function(){var t=[];return this.forEach((function(e,n){t.push([n,e])})),d(t)},o&&(p.prototype[Symbol.iterator]=p.prototype.entries);var y=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function v(t,e){var n,o,r=(e=e||{}).body;if(t instanceof v){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new p(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,r||null==t._bodyInit||(r=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new p(e.headers)),this.method=(o=(n=e.method||this.method||"GET").toUpperCase(),y.indexOf(o)>-1?o:n),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function w(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var n=t.split("="),o=n.shift().replace(/\+/g," "),r=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(o),decodeURIComponent(r))}})),e}function x(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new p(e.headers),this.url=e.url||"",this._initBody(t)}v.prototype.clone=function(){return new v(this,{body:this._bodyInit})},b.call(v.prototype),b.call(x.prototype),x.prototype.clone=function(){return new x(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},x.error=function(){var t=new x(null,{status:0,statusText:""});return t.type="error",t};var O=[301,302,303,307,308];x.redirect=function(t,e){if(-1===O.indexOf(e))throw new RangeError("Invalid status code");return new x(null,{status:e,headers:{location:t}})},e.DOMException=t.DOMException;try{new e.DOMException}catch(t){e.DOMException=function(t,e){this.message=t,this.name=e;var n=Error(t);this.stack=n.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function k(t,n){return new Promise((function(o,i){var s=new v(t,n);if(s.signal&&s.signal.aborted)return i(new e.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function l(){a.abort()}a.onload=function(){var t,e,n={status:a.status,statusText:a.statusText,headers:(t=a.getAllResponseHeaders()||"",e=new p,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(t){var n=t.split(":"),o=n.shift().trim();if(o){var r=n.join(":").trim();e.append(o,r)}})),e)};n.url="responseURL"in a?a.responseURL:n.headers.get("X-Request-URL");var r="response"in a?a.response:a.responseText;o(new x(r,n))},a.onerror=function(){i(new TypeError("Network request failed"))},a.ontimeout=function(){i(new TypeError("Network request failed"))},a.onabort=function(){i(new e.DOMException("Aborted","AbortError"))},a.open(s.method,s.url,!0),"include"===s.credentials?a.withCredentials=!0:"omit"===s.credentials&&(a.withCredentials=!1),"responseType"in a&&r&&(a.responseType="blob"),s.headers.forEach((function(t,e){a.setRequestHeader(e,t)})),s.signal&&(s.signal.addEventListener("abort",l),a.onreadystatechange=function(){4===a.readyState&&s.signal.removeEventListener("abort",l)}),a.send(void 0===s._bodyInit?null:s._bodyInit)}))}k.polyfill=!0,t.fetch||(t.fetch=k,t.Headers=p,t.Request=v,t.Response=x),e.Headers=p,e.Request=v,e.Response=x,e.fetch=k,Object.defineProperty(e,"__esModule",{value:!0})}({})}(o),o.fetch.ponyfill=!0,delete o.fetch.polyfill;var r=o;(e=r.fetch).default=r.fetch,e.fetch=r.fetch,e.Headers=r.Headers,e.Request=r.Request,e.Response=r.Response,t.exports=e},34:(t,e)=>{"use strict";var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},o={selectorAttr:"data-i18n",targetAttr:"i18n-target",optionsAttr:"i18n-options",useOptionsAttr:!1,parseDefaultValueFromContent:!0,document};e.default={init:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=n({},o,e);var r=function(t,o){return e.parseDefaultValueFromContent?n({},t,{defaultValue:o}):t};function i(e,n,o){var i="text";if(0==n.indexOf("[")){var s=n.split("]");n=s[1],i=s[0].substr(1,s[0].length-1)}if(n=n.indexOf(";")==n.length-1?n.substr(0,n.length-2):n,"html"===i)e.innerHTML=t.t(n,r(o,e.innerHTML));else if("text"===i)e.textContent=t.t(n,r(o,e.textContent));else if("prepend"===i){var a=e.innerHTML.indexOf("<loc-i18n>"),l=e.innerHTML.indexOf("</loc-i18n>")+11;a>-1&&l>6&&(e.innerHTML=[e.innerHTML.substring(0,a),e.innerHTML.slice(l)].join("")),e.innerHTML=["<loc-i18n>",t.t(n,r(o,e.innerHTML)),"</loc-i18n>",e.innerHTML].join("")}else if("append"===i){var c=e.innerHTML.indexOf("<loc-i18n>"),u=e.innerHTML.indexOf("</loc-i18n>")+11;c>-1&&u>6&&(e.innerHTML=[e.innerHTML.substring(0,c),e.innerHTML.slice(u)].join("")),e.innerHTML=[e.innerHTML,"<loc-i18n>",t.t(n,r(o,e.innerHTML),"</loc-i18n>")].join("")}else if(0===i.indexOf("data-")){var d=i.substr("data-".length),p=t.t(n,r(o,e.getAttribute(d)));e.setAttribute(d,p),e.setAttribute(i,p)}else e.setAttribute(i,t.t(n,r(o,e.getAttribute(i))))}function s(t){return JSON.parse(t.replace(/:\s*"([^"]*)"/g,(function(t,e){return': "'+e.replace(/:/g,"@colon@")+'"'})).replace(/:\s*'([^']*)'/g,(function(t,e){return': "'+e.replace(/:/g,"@colon@")+'"'})).replace(/(['"])?([a-z0-9A-Z_]+)(['"])?\s*:/g,'"$2": ').replace(/@colon@/g,":"))}function a(t,o){var r=t.getAttribute(e.selectorAttr);if(r){var a=t,l=t.getAttribute(e.targetAttr);if(null!=l&&(a=t.querySelector(l)||t),o||!0!==e.useOptionsAttr||(o=s(t.getAttribute(e.optionsAttr)||"{}")),o=o||{},r.indexOf(";")>=0)for(var c=r.split(";"),u=0,d=c.length;u<d;u++)""!=c[u]&&i(a,c[u],o);else i(a,r,o);if(!0===e.useOptionsAttr){var p={};delete(p=n({clone:p},o)).lng,t.setAttribute(e.optionsAttr,JSON.stringify(p))}}}function l(t,n){for(var o=e.document.querySelectorAll(t),r=0;r<o.length;r++){for(var i=o[r],s=i.querySelectorAll("["+e.selectorAttr+"]"),l=s.length-1;l>-1;l--)a(s[l],n);a(i,n)}}return l}}},837:(t,e,n)=>{t.exports=n(34).default},936:(t,e,n)=>{"use strict";n.r(e)},144:(t,e,n)=>{"use strict";n.r(e)},249:function(t,e,n){var o;!function(r,i){void 0===(o=function(){return function(t,e){"use strict";function n(n){if(this.hasDeviceMotion="ondevicemotion"in t,this.options={threshold:15,timeout:1e3},"object"==typeof n)for(var o in n)n.hasOwnProperty(o)&&(this.options[o]=n[o]);if(this.lastTime=new Date,this.lastX=null,this.lastY=null,this.lastZ=null,"function"==typeof e.CustomEvent)this.event=new e.CustomEvent("shake",{bubbles:!0,cancelable:!0});else{if("function"!=typeof e.createEvent)return!1;this.event=e.createEvent("Event"),this.event.initEvent("shake",!0,!0)}}return n.prototype.reset=function(){this.lastTime=new Date,this.lastX=null,this.lastY=null,this.lastZ=null},n.prototype.start=function(){this.reset(),this.hasDeviceMotion&&t.addEventListener("devicemotion",this,!1)},n.prototype.stop=function(){this.hasDeviceMotion&&t.removeEventListener("devicemotion",this,!1),this.reset()},n.prototype.devicemotion=function(e){var n,o,r,i=e.accelerationIncludingGravity;if(null===this.lastX&&null===this.lastY&&null===this.lastZ)return this.lastX=i.x,this.lastY=i.y,void(this.lastZ=i.z);n=Math.abs(this.lastX-i.x),o=Math.abs(this.lastY-i.y),r=Math.abs(this.lastZ-i.z),(n>this.options.threshold&&o>this.options.threshold||n>this.options.threshold&&r>this.options.threshold||o>this.options.threshold&&r>this.options.threshold)&&(new Date).getTime()-this.lastTime.getTime()>this.options.timeout&&(t.dispatchEvent(this.event),this.lastTime=new Date),this.lastX=i.x,this.lastY=i.y,this.lastZ=i.z},n.prototype.handleEvent=function(t){if("function"==typeof this[t.type])return this[t.type](t)},n}(r,r.document)}.call(e,n,e,t))||(t.exports=o)}("undefined"!=typeof window?window:this)},79:()=>{"use strict";(()=>{if(null==window.$)return;const t=window.$.fn.attr;window.$.fn.attr=function(){const e=t.apply(this,arguments);return"class"!==arguments[0]||"string"!=typeof e||-1===e.search("DnnModule-2sxc ")?e:e.replace("DnnModule-2sxc ","")+" DnnModule-2sxc"}})()},154:(t,e,n)=>{var o;if("function"==typeof fetch&&(void 0!==n.g&&n.g.fetch?o=n.g.fetch:"undefined"!=typeof window&&window.fetch&&(o=window.fetch)),"undefined"==typeof window||void 0===window.document){var r=o||n(98);r.default&&(r=r.default),e.default=r,t.exports=e.default}}},o={};function r(t){var e=o[t];if(void 0!==e)return e.exports;var i=o[t]={exports:{}};return n[t].call(i.exports,i,i.exports,r),i.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,r.t=function(n,o){if(1&o&&(n=this(n)),8&o)return n;if("object"==typeof n&&n){if(4&o&&n.__esModule)return n;if(16&o&&"function"==typeof n.then)return n}var i=Object.create(null);r.r(i);var s={};t=t||[null,e({}),e([]),e(e)];for(var a=2&o&&n;"object"==typeof a&&!~t.indexOf(a);a=e(a))Object.getOwnPropertyNames(a).forEach((t=>s[t]=()=>n[t]));return s.default=()=>n,r.d(i,s),i},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var i={};(()=>{"use strict";function t(t){if(null==t)return window;if("[object Window]"!==t.toString()){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function e(e){return e instanceof t(e).Element||e instanceof Element}function n(e){return e instanceof t(e).HTMLElement||e instanceof HTMLElement}function o(e){return"undefined"!=typeof ShadowRoot&&(e instanceof t(e).ShadowRoot||e instanceof ShadowRoot)}r.r(i),r.d(i,{Actions:()=>Wi,CmdParHlp:()=>zn,CmsEngine:()=>Rs,Command:()=>dn,Commands:()=>pn,ContentListActionParams:()=>ms,ModifierBase:()=>mn,ModifierContentBlock:()=>Ti,ModifierDnnModule:()=>Ei,ModifierDnnModuleInternal:()=>Li,PositionCoordinates:()=>Ii,Positioning:()=>Mi,QeSelectors:()=>Hi,QuickE:()=>Ui,QuickEClipboard:()=>Ni,QuickEditConfig:()=>xn,QuickEditConfigButtons:()=>wn,QuickEditConfigEnableAuto:()=>vn,QuickEditConfigRoot:()=>On,QuickEditOverlay:()=>yn,RunParamsHelpers:()=>vs,Selection:()=>gn,SharedLogic:()=>hn,SxcCmsReal:()=>Hs,SxcGlobalCms:()=>Fs,SxcTools:()=>qe,ToolbarWorkflowManager:()=>Bn,WorkflowCommands:()=>bs,WorkflowHelper:()=>jn,WorkflowPhases:()=>Hn,WorkflowStepCodeArguments:()=>Fn,WorkflowStepHelper:()=>_n,iconPrefix:()=>ln,tlbI18nPrefix:()=>cn});var s=Math.max,a=Math.min,l=Math.round;function c(){var t=navigator.userAgentData;return null!=t&&t.brands?t.brands.map((function(t){return t.brand+"/"+t.version})).join(" "):navigator.userAgent}function u(){return!/^((?!chrome|android).)*safari/i.test(c())}function d(o,r,i){void 0===r&&(r=!1),void 0===i&&(i=!1);var s=o.getBoundingClientRect(),a=1,c=1;r&&n(o)&&(a=o.offsetWidth>0&&l(s.width)/o.offsetWidth||1,c=o.offsetHeight>0&&l(s.height)/o.offsetHeight||1);var d=(e(o)?t(o):window).visualViewport,p=!u()&&i,h=(s.left+(p&&d?d.offsetLeft:0))/a,f=(s.top+(p&&d?d.offsetTop:0))/c,g=s.width/a,m=s.height/c;return{width:g,height:m,top:f,right:h+g,bottom:f+m,left:h,x:h,y:f}}function p(e){var n=t(e);return{scrollLeft:n.pageXOffset,scrollTop:n.pageYOffset}}function h(t){return t?(t.nodeName||"").toLowerCase():null}function f(t){return((e(t)?t.ownerDocument:t.document)||window.document).documentElement}function g(t){return d(f(t)).left+p(t).scrollLeft}function m(e){return t(e).getComputedStyle(e)}function b(t){var e=m(t),n=e.overflow,o=e.overflowX,r=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+r+o)}function y(e,o,r){void 0===r&&(r=!1);var i,s,a=n(o),c=n(o)&&function(t){var e=t.getBoundingClientRect(),n=l(e.width)/t.offsetWidth||1,o=l(e.height)/t.offsetHeight||1;return 1!==n||1!==o}(o),u=f(o),m=d(e,c,r),y={scrollLeft:0,scrollTop:0},v={x:0,y:0};return(a||!a&&!r)&&(("body"!==h(o)||b(u))&&(y=(i=o)!==t(i)&&n(i)?{scrollLeft:(s=i).scrollLeft,scrollTop:s.scrollTop}:p(i)),n(o)?((v=d(o,!0)).x+=o.clientLeft,v.y+=o.clientTop):u&&(v.x=g(u))),{x:m.left+y.scrollLeft-v.x,y:m.top+y.scrollTop-v.y,width:m.width,height:m.height}}function v(t){var e=d(t),n=t.offsetWidth,o=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:o}}function w(t){return"html"===h(t)?t:t.assignedSlot||t.parentNode||(o(t)?t.host:null)||f(t)}function x(t){return["html","body","#document"].indexOf(h(t))>=0?t.ownerDocument.body:n(t)&&b(t)?t:x(w(t))}function O(e,n){var o;void 0===n&&(n=[]);var r=x(e),i=r===(null==(o=e.ownerDocument)?void 0:o.body),s=t(r),a=i?[s].concat(s.visualViewport||[],b(r)?r:[]):r,l=n.concat(a);return i?l:l.concat(O(w(a)))}function k(t){return["table","td","th"].indexOf(h(t))>=0}function C(t){return n(t)&&"fixed"!==m(t).position?t.offsetParent:null}function S(e){for(var r=t(e),i=C(e);i&&k(i)&&"static"===m(i).position;)i=C(i);return i&&("html"===h(i)||"body"===h(i)&&"static"===m(i).position)?r:i||function(t){var e=/firefox/i.test(c());if(/Trident/i.test(c())&&n(t)&&"fixed"===m(t).position)return null;var r=w(t);for(o(r)&&(r=r.host);n(r)&&["html","body"].indexOf(h(r))<0;){var i=m(r);if("none"!==i.transform||"none"!==i.perspective||"paint"===i.contain||-1!==["transform","perspective"].indexOf(i.willChange)||e&&"filter"===i.willChange||e&&i.filter&&"none"!==i.filter)return r;r=r.parentNode}return null}(e)||r}var A="top",T="bottom",I="right",E="left",P="auto",L=[A,T,I,E],D="start",M="end",$="viewport",R="popper",j=L.reduce((function(t,e){return t.concat([e+"-"+D,e+"-"+M])}),[]),B=[].concat(L,[P]).reduce((function(t,e){return t.concat([e,e+"-"+D,e+"-"+M])}),[]),N=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function F(t){var e=new Map,n=new Set,o=[];function r(t){n.add(t.name),[].concat(t.requires||[],t.requiresIfExists||[]).forEach((function(t){if(!n.has(t)){var o=e.get(t);o&&r(o)}})),o.push(t)}return t.forEach((function(t){e.set(t.name,t)})),t.forEach((function(t){n.has(t.name)||r(t)})),o}var H={placement:"bottom",modifiers:[],strategy:"absolute"};function _(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some((function(t){return!(t&&"function"==typeof t.getBoundingClientRect)}))}function q(t){void 0===t&&(t={});var n=t,o=n.defaultModifiers,r=void 0===o?[]:o,i=n.defaultOptions,s=void 0===i?H:i;return function(t,n,o){void 0===o&&(o=s);var i,a,l={placement:"bottom",orderedModifiers:[],options:Object.assign({},H,s),modifiersData:{},elements:{reference:t,popper:n},attributes:{},styles:{}},c=[],u=!1,d={state:l,setOptions:function(o){var i="function"==typeof o?o(l.options):o;p(),l.options=Object.assign({},s,l.options,i),l.scrollParents={reference:e(t)?O(t):t.contextElement?O(t.contextElement):[],popper:O(n)};var a,u,h=function(t){var e=F(t);return N.reduce((function(t,n){return t.concat(e.filter((function(t){return t.phase===n})))}),[])}((a=[].concat(r,l.options.modifiers),u=a.reduce((function(t,e){var n=t[e.name];return t[e.name]=n?Object.assign({},n,e,{options:Object.assign({},n.options,e.options),data:Object.assign({},n.data,e.data)}):e,t}),{}),Object.keys(u).map((function(t){return u[t]}))));return l.orderedModifiers=h.filter((function(t){return t.enabled})),l.orderedModifiers.forEach((function(t){var e=t.name,n=t.options,o=void 0===n?{}:n,r=t.effect;if("function"==typeof r){var i=r({state:l,name:e,instance:d,options:o});c.push(i||function(){})}})),d.update()},forceUpdate:function(){if(!u){var t=l.elements,e=t.reference,n=t.popper;if(_(e,n)){l.rects={reference:y(e,S(n),"fixed"===l.options.strategy),popper:v(n)},l.reset=!1,l.placement=l.options.placement,l.orderedModifiers.forEach((function(t){return l.modifiersData[t.name]=Object.assign({},t.data)}));for(var o=0;o<l.orderedModifiers.length;o++)if(!0!==l.reset){var r=l.orderedModifiers[o],i=r.fn,s=r.options,a=void 0===s?{}:s,c=r.name;"function"==typeof i&&(l=i({state:l,options:a,name:c,instance:d})||l)}else l.reset=!1,o=-1}}},update:(i=function(){return new Promise((function(t){d.forceUpdate(),t(l)}))},function(){return a||(a=new Promise((function(t){Promise.resolve().then((function(){a=void 0,t(i())}))}))),a}),destroy:function(){p(),u=!0}};if(!_(t,n))return d;function p(){c.forEach((function(t){return t()})),c=[]}return d.setOptions(o).then((function(t){!u&&o.onFirstUpdate&&o.onFirstUpdate(t)})),d}}var U={passive:!0};const V={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var n=e.state,o=e.instance,r=e.options,i=r.scroll,s=void 0===i||i,a=r.resize,l=void 0===a||a,c=t(n.elements.popper),u=[].concat(n.scrollParents.reference,n.scrollParents.popper);return s&&u.forEach((function(t){t.addEventListener("scroll",o.update,U)})),l&&c.addEventListener("resize",o.update,U),function(){s&&u.forEach((function(t){t.removeEventListener("scroll",o.update,U)})),l&&c.removeEventListener("resize",o.update,U)}},data:{}};function z(t){return t.split("-")[0]}function W(t){return t.split("-")[1]}function G(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function J(t){var e,n=t.reference,o=t.element,r=t.placement,i=r?z(r):null,s=r?W(r):null,a=n.x+n.width/2-o.width/2,l=n.y+n.height/2-o.height/2;switch(i){case A:e={x:a,y:n.y-o.height};break;case T:e={x:a,y:n.y+n.height};break;case I:e={x:n.x+n.width,y:l};break;case E:e={x:n.x-o.width,y:l};break;default:e={x:n.x,y:n.y}}var c=i?G(i):null;if(null!=c){var u="y"===c?"height":"width";switch(s){case D:e[c]=e[c]-(n[u]/2-o[u]/2);break;case M:e[c]=e[c]+(n[u]/2-o[u]/2)}}return e}var K={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Q(e){var n,o=e.popper,r=e.popperRect,i=e.placement,s=e.variation,a=e.offsets,c=e.position,u=e.gpuAcceleration,d=e.adaptive,p=e.roundOffsets,h=e.isFixed,g=a.x,b=void 0===g?0:g,y=a.y,v=void 0===y?0:y,w="function"==typeof p?p({x:b,y:v}):{x:b,y:v};b=w.x,v=w.y;var x=a.hasOwnProperty("x"),O=a.hasOwnProperty("y"),k=E,C=A,P=window;if(d){var L=S(o),D="clientHeight",$="clientWidth";L===t(o)&&"static"!==m(L=f(o)).position&&"absolute"===c&&(D="scrollHeight",$="scrollWidth"),(i===A||(i===E||i===I)&&s===M)&&(C=T,v-=(h&&L===P&&P.visualViewport?P.visualViewport.height:L[D])-r.height,v*=u?1:-1),i!==E&&(i!==A&&i!==T||s!==M)||(k=I,b-=(h&&L===P&&P.visualViewport?P.visualViewport.width:L[$])-r.width,b*=u?1:-1)}var R,j=Object.assign({position:c},d&&K),B=!0===p?function(t){var e=t.x,n=t.y,o=window.devicePixelRatio||1;return{x:l(e*o)/o||0,y:l(n*o)/o||0}}({x:b,y:v}):{x:b,y:v};return b=B.x,v=B.y,u?Object.assign({},j,((R={})[C]=O?"0":"",R[k]=x?"0":"",R.transform=(P.devicePixelRatio||1)<=1?"translate("+b+"px, "+v+"px)":"translate3d("+b+"px, "+v+"px, 0)",R)):Object.assign({},j,((n={})[C]=O?v+"px":"",n[k]=x?b+"px":"",n.transform="",n))}const X={name:"applyStyles",enabled:!0,phase:"write",fn:function(t){var e=t.state;Object.keys(e.elements).forEach((function(t){var o=e.styles[t]||{},r=e.attributes[t]||{},i=e.elements[t];n(i)&&h(i)&&(Object.assign(i.style,o),Object.keys(r).forEach((function(t){var e=r[t];!1===e?i.removeAttribute(t):i.setAttribute(t,!0===e?"":e)})))}))},effect:function(t){var e=t.state,o={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,o.popper),e.styles=o,e.elements.arrow&&Object.assign(e.elements.arrow.style,o.arrow),function(){Object.keys(e.elements).forEach((function(t){var r=e.elements[t],i=e.attributes[t]||{},s=Object.keys(e.styles.hasOwnProperty(t)?e.styles[t]:o[t]).reduce((function(t,e){return t[e]="",t}),{});n(r)&&h(r)&&(Object.assign(r.style,s),Object.keys(i).forEach((function(t){r.removeAttribute(t)})))}))}},requires:["computeStyles"]};var Y={left:"right",right:"left",bottom:"top",top:"bottom"};function Z(t){return t.replace(/left|right|bottom|top/g,(function(t){return Y[t]}))}var tt={start:"end",end:"start"};function et(t){return t.replace(/start|end/g,(function(t){return tt[t]}))}function nt(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&o(n)){var r=e;do{if(r&&t.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function ot(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function rt(n,o,r){return o===$?ot(function(e,n){var o=t(e),r=f(e),i=o.visualViewport,s=r.clientWidth,a=r.clientHeight,l=0,c=0;if(i){s=i.width,a=i.height;var d=u();(d||!d&&"fixed"===n)&&(l=i.offsetLeft,c=i.offsetTop)}return{width:s,height:a,x:l+g(e),y:c}}(n,r)):e(o)?function(t,e){var n=d(t,!1,"fixed"===e);return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}(o,r):ot(function(t){var e,n=f(t),o=p(t),r=null==(e=t.ownerDocument)?void 0:e.body,i=s(n.scrollWidth,n.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),a=s(n.scrollHeight,n.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),l=-o.scrollLeft+g(t),c=-o.scrollTop;return"rtl"===m(r||n).direction&&(l+=s(n.clientWidth,r?r.clientWidth:0)-i),{width:i,height:a,x:l,y:c}}(f(n)))}function it(t){return Object.assign({},{top:0,right:0,bottom:0,left:0},t)}function st(t,e){return e.reduce((function(e,n){return e[n]=t,e}),{})}function at(t,o){void 0===o&&(o={});var r=o,i=r.placement,l=void 0===i?t.placement:i,c=r.strategy,u=void 0===c?t.strategy:c,p=r.boundary,g=void 0===p?"clippingParents":p,b=r.rootBoundary,y=void 0===b?$:b,v=r.elementContext,x=void 0===v?R:v,k=r.altBoundary,C=void 0!==k&&k,E=r.padding,P=void 0===E?0:E,D=it("number"!=typeof P?P:st(P,L)),M=x===R?"reference":R,j=t.rects.popper,B=t.elements[C?M:x],N=function(t,o,r,i){var l="clippingParents"===o?function(t){var o=O(w(t)),r=["absolute","fixed"].indexOf(m(t).position)>=0&&n(t)?S(t):t;return e(r)?o.filter((function(t){return e(t)&&nt(t,r)&&"body"!==h(t)})):[]}(t):[].concat(o),c=[].concat(l,[r]),u=c[0],d=c.reduce((function(e,n){var o=rt(t,n,i);return e.top=s(o.top,e.top),e.right=a(o.right,e.right),e.bottom=a(o.bottom,e.bottom),e.left=s(o.left,e.left),e}),rt(t,u,i));return d.width=d.right-d.left,d.height=d.bottom-d.top,d.x=d.left,d.y=d.top,d}(e(B)?B:B.contextElement||f(t.elements.popper),g,y,u),F=d(t.elements.reference),H=J({reference:F,element:j,strategy:"absolute",placement:l}),_=ot(Object.assign({},j,H)),q=x===R?_:F,U={top:N.top-q.top+D.top,bottom:q.bottom-N.bottom+D.bottom,left:N.left-q.left+D.left,right:q.right-N.right+D.right},V=t.modifiersData.offset;if(x===R&&V){var z=V[l];Object.keys(U).forEach((function(t){var e=[I,T].indexOf(t)>=0?1:-1,n=[A,T].indexOf(t)>=0?"y":"x";U[t]+=z[n]*e}))}return U}function lt(t,e,n){return s(t,a(e,n))}function ct(t,e,n){return void 0===n&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function ut(t){return[A,I,T,E].some((function(e){return t[e]>=0}))}var dt=q({defaultModifiers:[V,{name:"popperOffsets",enabled:!0,phase:"read",fn:function(t){var e=t.state,n=t.name;e.modifiersData[n]=J({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(t){var e=t.state,n=t.options,o=n.gpuAcceleration,r=void 0===o||o,i=n.adaptive,s=void 0===i||i,a=n.roundOffsets,l=void 0===a||a,c={placement:z(e.placement),variation:W(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:r,isFixed:"fixed"===e.options.strategy};null!=e.modifiersData.popperOffsets&&(e.styles.popper=Object.assign({},e.styles.popper,Q(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:l})))),null!=e.modifiersData.arrow&&(e.styles.arrow=Object.assign({},e.styles.arrow,Q(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})},data:{}},X,{name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(t){var e=t.state,n=t.options,o=t.name,r=n.offset,i=void 0===r?[0,0]:r,s=B.reduce((function(t,n){return t[n]=function(t,e,n){var o=z(t),r=[E,A].indexOf(o)>=0?-1:1,i="function"==typeof n?n(Object.assign({},e,{placement:t})):n,s=i[0],a=i[1];return s=s||0,a=(a||0)*r,[E,I].indexOf(o)>=0?{x:a,y:s}:{x:s,y:a}}(n,e.rects,i),t}),{}),a=s[e.placement],l=a.x,c=a.y;null!=e.modifiersData.popperOffsets&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[o]=s}},{name:"flip",enabled:!0,phase:"main",fn:function(t){var e=t.state,n=t.options,o=t.name;if(!e.modifiersData[o]._skip){for(var r=n.mainAxis,i=void 0===r||r,s=n.altAxis,a=void 0===s||s,l=n.fallbackPlacements,c=n.padding,u=n.boundary,d=n.rootBoundary,p=n.altBoundary,h=n.flipVariations,f=void 0===h||h,g=n.allowedAutoPlacements,m=e.options.placement,b=z(m),y=l||(b!==m&&f?function(t){if(z(t)===P)return[];var e=Z(t);return[et(t),e,et(e)]}(m):[Z(m)]),v=[m].concat(y).reduce((function(t,n){return t.concat(z(n)===P?function(t,e){void 0===e&&(e={});var n=e,o=n.placement,r=n.boundary,i=n.rootBoundary,s=n.padding,a=n.flipVariations,l=n.allowedAutoPlacements,c=void 0===l?B:l,u=W(o),d=u?a?j:j.filter((function(t){return W(t)===u})):L,p=d.filter((function(t){return c.indexOf(t)>=0}));0===p.length&&(p=d);var h=p.reduce((function(e,n){return e[n]=at(t,{placement:n,boundary:r,rootBoundary:i,padding:s})[z(n)],e}),{});return Object.keys(h).sort((function(t,e){return h[t]-h[e]}))}(e,{placement:n,boundary:u,rootBoundary:d,padding:c,flipVariations:f,allowedAutoPlacements:g}):n)}),[]),w=e.rects.reference,x=e.rects.popper,O=new Map,k=!0,C=v[0],S=0;S<v.length;S++){var M=v[S],$=z(M),R=W(M)===D,N=[A,T].indexOf($)>=0,F=N?"width":"height",H=at(e,{placement:M,boundary:u,rootBoundary:d,altBoundary:p,padding:c}),_=N?R?I:E:R?T:A;w[F]>x[F]&&(_=Z(_));var q=Z(_),U=[];if(i&&U.push(H[$]<=0),a&&U.push(H[_]<=0,H[q]<=0),U.every((function(t){return t}))){C=M,k=!1;break}O.set(M,U)}if(k)for(var V=function(t){var e=v.find((function(e){var n=O.get(e);if(n)return n.slice(0,t).every((function(t){return t}))}));if(e)return C=e,"break"},G=f?3:1;G>0&&"break"!==V(G);G--);e.placement!==C&&(e.modifiersData[o]._skip=!0,e.placement=C,e.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}},{name:"preventOverflow",enabled:!0,phase:"main",fn:function(t){var e=t.state,n=t.options,o=t.name,r=n.mainAxis,i=void 0===r||r,l=n.altAxis,c=void 0!==l&&l,u=n.boundary,d=n.rootBoundary,p=n.altBoundary,h=n.padding,f=n.tether,g=void 0===f||f,m=n.tetherOffset,b=void 0===m?0:m,y=at(e,{boundary:u,rootBoundary:d,padding:h,altBoundary:p}),w=z(e.placement),x=W(e.placement),O=!x,k=G(w),C="x"===k?"y":"x",P=e.modifiersData.popperOffsets,L=e.rects.reference,M=e.rects.popper,$="function"==typeof b?b(Object.assign({},e.rects,{placement:e.placement})):b,R="number"==typeof $?{mainAxis:$,altAxis:$}:Object.assign({mainAxis:0,altAxis:0},$),j=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,B={x:0,y:0};if(P){if(i){var N,F="y"===k?A:E,H="y"===k?T:I,_="y"===k?"height":"width",q=P[k],U=q+y[F],V=q-y[H],J=g?-M[_]/2:0,K=x===D?L[_]:M[_],Q=x===D?-M[_]:-L[_],X=e.elements.arrow,Y=g&&X?v(X):{width:0,height:0},Z=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},tt=Z[F],et=Z[H],nt=lt(0,L[_],Y[_]),ot=O?L[_]/2-J-nt-tt-R.mainAxis:K-nt-tt-R.mainAxis,rt=O?-L[_]/2+J+nt+et+R.mainAxis:Q+nt+et+R.mainAxis,it=e.elements.arrow&&S(e.elements.arrow),st=it?"y"===k?it.clientTop||0:it.clientLeft||0:0,ct=null!=(N=null==j?void 0:j[k])?N:0,ut=q+rt-ct,dt=lt(g?a(U,q+ot-ct-st):U,q,g?s(V,ut):V);P[k]=dt,B[k]=dt-q}if(c){var pt,ht="x"===k?A:E,ft="x"===k?T:I,gt=P[C],mt="y"===C?"height":"width",bt=gt+y[ht],yt=gt-y[ft],vt=-1!==[A,E].indexOf(w),wt=null!=(pt=null==j?void 0:j[C])?pt:0,xt=vt?bt:gt-L[mt]-M[mt]-wt+R.altAxis,Ot=vt?gt+L[mt]+M[mt]-wt-R.altAxis:yt,kt=g&&vt?function(t,e,n){var o=lt(t,e,n);return o>n?n:o}(xt,gt,Ot):lt(g?xt:bt,gt,g?Ot:yt);P[C]=kt,B[C]=kt-gt}e.modifiersData[o]=B}},requiresIfExists:["offset"]},{name:"arrow",enabled:!0,phase:"main",fn:function(t){var e,n=t.state,o=t.name,r=t.options,i=n.elements.arrow,s=n.modifiersData.popperOffsets,a=z(n.placement),l=G(a),c=[E,I].indexOf(a)>=0?"height":"width";if(i&&s){var u=function(t,e){return it("number"!=typeof(t="function"==typeof t?t(Object.assign({},e.rects,{placement:e.placement})):t)?t:st(t,L))}(r.padding,n),d=v(i),p="y"===l?A:E,h="y"===l?T:I,f=n.rects.reference[c]+n.rects.reference[l]-s[l]-n.rects.popper[c],g=s[l]-n.rects.reference[l],m=S(i),b=m?"y"===l?m.clientHeight||0:m.clientWidth||0:0,y=f/2-g/2,w=u[p],x=b-d[c]-u[h],O=b/2-d[c]/2+y,k=lt(w,O,x),C=l;n.modifiersData[o]=((e={})[C]=k,e.centerOffset=k-O,e)}},effect:function(t){var e=t.state,n=t.options.element,o=void 0===n?"[data-popper-arrow]":n;null!=o&&("string"!=typeof o||(o=e.elements.popper.querySelector(o)))&&nt(e.elements.popper,o)&&(e.elements.arrow=o)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]},{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(t){var e=t.state,n=t.name,o=e.rects.reference,r=e.rects.popper,i=e.modifiersData.preventOverflow,s=at(e,{elementContext:"reference"}),a=at(e,{altBoundary:!0}),l=ct(s,o),c=ct(a,r,i),u=ut(l),d=ut(c);e.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:d},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}}]}),pt="tippy-content",ht="tippy-arrow",ft="tippy-svg-arrow",gt={passive:!0,capture:!0},mt=function(){return document.body};function bt(t,e,n){if(Array.isArray(t)){var o=t[e];return null==o?Array.isArray(n)?n[e]:n:o}return t}function yt(t,e){var n={}.toString.call(t);return 0===n.indexOf("[object")&&n.indexOf(e+"]")>-1}function vt(t,e){return"function"==typeof t?t.apply(void 0,e):t}function wt(t,e){return 0===e?t:function(o){clearTimeout(n),n=setTimeout((function(){t(o)}),e)};var n}function xt(t){return[].concat(t)}function Ot(t,e){-1===t.indexOf(e)&&t.push(e)}function kt(t){return[].slice.call(t)}function Ct(t){return Object.keys(t).reduce((function(e,n){return void 0!==t[n]&&(e[n]=t[n]),e}),{})}function St(){return document.createElement("div")}function At(t){return["Element","Fragment"].some((function(e){return yt(t,e)}))}function Tt(t,e){t.forEach((function(t){t&&(t.style.transitionDuration=e+"ms")}))}function It(t,e){t.forEach((function(t){t&&t.setAttribute("data-state",e)}))}function Et(t,e,n){var o=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach((function(e){t[o](e,n)}))}function Pt(t,e){for(var n=e;n;){var o;if(t.contains(n))return!0;n=null==n.getRootNode||null==(o=n.getRootNode())?void 0:o.host}return!1}var Lt={isTouch:!1},Dt=0;function Mt(){Lt.isTouch||(Lt.isTouch=!0,window.performance&&document.addEventListener("mousemove",$t))}function $t(){var t=performance.now();t-Dt<20&&(Lt.isTouch=!1,document.removeEventListener("mousemove",$t)),Dt=t}function Rt(){var t,e=document.activeElement;if((t=e)&&t._tippy&&t._tippy.reference===t){var n=e._tippy;e.blur&&!n.state.isVisible&&e.blur()}}var jt=!("undefined"==typeof window||"undefined"==typeof document||!window.msCrypto),Bt=Object.assign({appendTo:mt,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},{animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},{allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999}),Nt=Object.keys(Bt);function Ft(t){var e=(t.plugins||[]).reduce((function(e,n){var o,r=n.name,i=n.defaultValue;return r&&(e[r]=void 0!==t[r]?t[r]:null!=(o=Bt[r])?o:i),e}),{});return Object.assign({},t,e)}function Ht(t,e){var n=Object.assign({},e,{content:vt(e.content,[t])},e.ignoreAttributes?{}:function(t,e){return(e?Object.keys(Ft(Object.assign({},Bt,{plugins:e}))):Nt).reduce((function(e,n){var o=(t.getAttribute("data-tippy-"+n)||"").trim();if(!o)return e;if("content"===n)e[n]=o;else try{e[n]=JSON.parse(o)}catch(t){e[n]=o}return e}),{})}(t,e.plugins));return n.aria=Object.assign({},Bt.aria,n.aria),n.aria={expanded:"auto"===n.aria.expanded?e.interactive:n.aria.expanded,content:"auto"===n.aria.content?e.interactive?null:"describedby":n.aria.content},n}function _t(t,e){t.innerHTML=e}function qt(t){var e=St();return!0===t?e.className=ht:(e.className=ft,At(t)?e.appendChild(t):_t(e,t)),e}function Ut(t,e){At(e.content)?(_t(t,""),t.appendChild(e.content)):"function"!=typeof e.content&&(e.allowHTML?_t(t,e.content):t.textContent=e.content)}function Vt(t){var e=t.firstElementChild,n=kt(e.children);return{box:e,content:n.find((function(t){return t.classList.contains(pt)})),arrow:n.find((function(t){return t.classList.contains(ht)||t.classList.contains(ft)})),backdrop:n.find((function(t){return t.classList.contains("tippy-backdrop")}))}}function zt(t){var e=St(),n=St();n.className="tippy-box",n.setAttribute("data-state","hidden"),n.setAttribute("tabindex","-1");var o=St();function r(n,o){var r=Vt(e),i=r.box,s=r.content,a=r.arrow;o.theme?i.setAttribute("data-theme",o.theme):i.removeAttribute("data-theme"),"string"==typeof o.animation?i.setAttribute("data-animation",o.animation):i.removeAttribute("data-animation"),o.inertia?i.setAttribute("data-inertia",""):i.removeAttribute("data-inertia"),i.style.maxWidth="number"==typeof o.maxWidth?o.maxWidth+"px":o.maxWidth,o.role?i.setAttribute("role",o.role):i.removeAttribute("role"),n.content===o.content&&n.allowHTML===o.allowHTML||Ut(s,t.props),o.arrow?a?n.arrow!==o.arrow&&(i.removeChild(a),i.appendChild(qt(o.arrow))):i.appendChild(qt(o.arrow)):a&&i.removeChild(a)}return o.className=pt,o.setAttribute("data-state","hidden"),Ut(o,t.props),e.appendChild(n),n.appendChild(o),r(t.props,t.props),{popper:e,onUpdate:r}}zt.$$tippy=!0;var Wt=1,Gt=[],Jt=[];function Kt(t,e){var n,o,r,i,s,a,l,c=Ht(t,Object.assign({},Bt,Ft(Ct(e)))),u=!1,d=!1,p=!1,h=!1,f=[],g=wt(W,c.interactiveDebounce),m=Wt++,b=function(t){return t.filter((function(e,n){return t.indexOf(e)===n}))}(c.plugins),y={id:m,reference:t,popper:St(),popperInstance:null,props:c,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},plugins:b,clearDelayTimeouts:function(){clearTimeout(n),clearTimeout(o),cancelAnimationFrame(r)},setProps:function(e){if(!y.state.isDestroyed){D("onBeforeUpdate",[y,e]),V();var n=y.props,o=Ht(t,Object.assign({},n,Ct(e),{ignoreAttributes:!0}));y.props=o,U(),n.interactiveDebounce!==o.interactiveDebounce&&(R(),g=wt(W,o.interactiveDebounce)),n.triggerTarget&&!o.triggerTarget?xt(n.triggerTarget).forEach((function(t){t.removeAttribute("aria-expanded")})):o.triggerTarget&&t.removeAttribute("aria-expanded"),$(),L(),x&&x(n,o),y.popperInstance&&(Q(),Y().forEach((function(t){requestAnimationFrame(t._tippy.popperInstance.forceUpdate)}))),D("onAfterUpdate",[y,e])}},setContent:function(t){y.setProps({content:t})},show:function(){var t=y.state.isVisible,e=y.state.isDestroyed,n=!y.state.isEnabled,o=Lt.isTouch&&!y.props.touch,r=bt(y.props.duration,0,Bt.duration);if(!(t||e||n||o||T().hasAttribute("disabled")||(D("onShow",[y],!1),!1===y.props.onShow(y)))){if(y.state.isVisible=!0,A()&&(w.style.visibility="visible"),L(),F(),y.state.isMounted||(w.style.transition="none"),A()){var i=E();Tt([i.box,i.content],0)}var s,l,c;a=function(){var t;if(y.state.isVisible&&!h){if(h=!0,w.offsetHeight,w.style.transition=y.props.moveTransition,A()&&y.props.animation){var e=E(),n=e.box,o=e.content;Tt([n,o],r),It([n,o],"visible")}M(),$(),Ot(Jt,y),null==(t=y.popperInstance)||t.forceUpdate(),D("onMount",[y]),y.props.animation&&A()&&function(t,e){_(t,(function(){y.state.isShown=!0,D("onShown",[y])}))}(r)}},l=y.props.appendTo,c=T(),(s=y.props.interactive&&l===mt||"parent"===l?c.parentNode:vt(l,[c])).contains(w)||s.appendChild(w),y.state.isMounted=!0,Q()}},hide:function(){var t=!y.state.isVisible,e=y.state.isDestroyed,n=!y.state.isEnabled,o=bt(y.props.duration,1,Bt.duration);if(!(t||e||n)&&(D("onHide",[y],!1),!1!==y.props.onHide(y))){if(y.state.isVisible=!1,y.state.isShown=!1,h=!1,u=!1,A()&&(w.style.visibility="hidden"),R(),H(),L(!0),A()){var r=E(),i=r.box,s=r.content;y.props.animation&&(Tt([i,s],o),It([i,s],"hidden"))}M(),$(),y.props.animation?A()&&function(t,e){_(t,(function(){!y.state.isVisible&&w.parentNode&&w.parentNode.contains(w)&&e()}))}(o,y.unmount):y.unmount()}},hideWithInteractivity:function(t){I().addEventListener("mousemove",g),Ot(Gt,g),g(t)},enable:function(){y.state.isEnabled=!0},disable:function(){y.hide(),y.state.isEnabled=!1},unmount:function(){y.state.isVisible&&y.hide(),y.state.isMounted&&(X(),Y().forEach((function(t){t._tippy.unmount()})),w.parentNode&&w.parentNode.removeChild(w),Jt=Jt.filter((function(t){return t!==y})),y.state.isMounted=!1,D("onHidden",[y]))},destroy:function(){y.state.isDestroyed||(y.clearDelayTimeouts(),y.unmount(),V(),delete t._tippy,y.state.isDestroyed=!0,D("onDestroy",[y]))}};if(!c.render)return y;var v=c.render(y),w=v.popper,x=v.onUpdate;w.setAttribute("data-tippy-root",""),w.id="tippy-"+y.id,y.popper=w,t._tippy=y,w._tippy=y;var O=b.map((function(t){return t.fn(y)})),k=t.hasAttribute("aria-expanded");return U(),$(),L(),D("onCreate",[y]),c.showOnCreate&&Z(),w.addEventListener("mouseenter",(function(){y.props.interactive&&y.state.isVisible&&y.clearDelayTimeouts()})),w.addEventListener("mouseleave",(function(){y.props.interactive&&y.props.trigger.indexOf("mouseenter")>=0&&I().addEventListener("mousemove",g)})),y;function C(){var t=y.props.touch;return Array.isArray(t)?t:[t,0]}function S(){return"hold"===C()[0]}function A(){var t;return!(null==(t=y.props.render)||!t.$$tippy)}function T(){return l||t}function I(){var t,e,n=T().parentNode;return n?null!=(e=xt(n)[0])&&null!=(t=e.ownerDocument)&&t.body?e.ownerDocument:document:document}function E(){return Vt(w)}function P(t){return y.state.isMounted&&!y.state.isVisible||Lt.isTouch||i&&"focus"===i.type?0:bt(y.props.delay,t?0:1,Bt.delay)}function L(t){void 0===t&&(t=!1),w.style.pointerEvents=y.props.interactive&&!t?"":"none",w.style.zIndex=""+y.props.zIndex}function D(t,e,n){var o;void 0===n&&(n=!0),O.forEach((function(n){n[t]&&n[t].apply(n,e)})),n&&(o=y.props)[t].apply(o,e)}function M(){var e=y.props.aria;if(e.content){var n="aria-"+e.content,o=w.id;xt(y.props.triggerTarget||t).forEach((function(t){var e=t.getAttribute(n);if(y.state.isVisible)t.setAttribute(n,e?e+" "+o:o);else{var r=e&&e.replace(o,"").trim();r?t.setAttribute(n,r):t.removeAttribute(n)}}))}}function $(){!k&&y.props.aria.expanded&&xt(y.props.triggerTarget||t).forEach((function(t){y.props.interactive?t.setAttribute("aria-expanded",y.state.isVisible&&t===T()?"true":"false"):t.removeAttribute("aria-expanded")}))}function R(){I().removeEventListener("mousemove",g),Gt=Gt.filter((function(t){return t!==g}))}function j(e){if(!Lt.isTouch||!p&&"mousedown"!==e.type){var n=e.composedPath&&e.composedPath()[0]||e.target;if(!y.props.interactive||!Pt(w,n)){if(xt(y.props.triggerTarget||t).some((function(t){return Pt(t,n)}))){if(Lt.isTouch)return;if(y.state.isVisible&&y.props.trigger.indexOf("click")>=0)return}else D("onClickOutside",[y,e]);!0===y.props.hideOnClick&&(y.clearDelayTimeouts(),y.hide(),d=!0,setTimeout((function(){d=!1})),y.state.isMounted||H())}}}function B(){p=!0}function N(){p=!1}function F(){var t=I();t.addEventListener("mousedown",j,!0),t.addEventListener("touchend",j,gt),t.addEventListener("touchstart",N,gt),t.addEventListener("touchmove",B,gt)}function H(){var t=I();t.removeEventListener("mousedown",j,!0),t.removeEventListener("touchend",j,gt),t.removeEventListener("touchstart",N,gt),t.removeEventListener("touchmove",B,gt)}function _(t,e){var n=E().box;function o(t){t.target===n&&(Et(n,"remove",o),e())}if(0===t)return e();Et(n,"remove",s),Et(n,"add",o),s=o}function q(e,n,o){void 0===o&&(o=!1),xt(y.props.triggerTarget||t).forEach((function(t){t.addEventListener(e,n,o),f.push({node:t,eventType:e,handler:n,options:o})}))}function U(){var t;S()&&(q("touchstart",z,{passive:!0}),q("touchend",G,{passive:!0})),(t=y.props.trigger,t.split(/\s+/).filter(Boolean)).forEach((function(t){if("manual"!==t)switch(q(t,z),t){case"mouseenter":q("mouseleave",G);break;case"focus":q(jt?"focusout":"blur",J);break;case"focusin":q("focusout",J)}}))}function V(){f.forEach((function(t){var e=t.node,n=t.eventType,o=t.handler,r=t.options;e.removeEventListener(n,o,r)})),f=[]}function z(t){var e,n=!1;if(y.state.isEnabled&&!K(t)&&!d){var o="focus"===(null==(e=i)?void 0:e.type);i=t,l=t.currentTarget,$(),!y.state.isVisible&&yt(t,"MouseEvent")&&Gt.forEach((function(e){return e(t)})),"click"===t.type&&(y.props.trigger.indexOf("mouseenter")<0||u)&&!1!==y.props.hideOnClick&&y.state.isVisible?n=!0:Z(t),"click"===t.type&&(u=!n),n&&!o&&tt(t)}}function W(t){var e=t.target,n=T().contains(e)||w.contains(e);if("mousemove"!==t.type||!n){var o=Y().concat(w).map((function(t){var e,n=null==(e=t._tippy.popperInstance)?void 0:e.state;return n?{popperRect:t.getBoundingClientRect(),popperState:n,props:c}:null})).filter(Boolean);(function(t,e){var n=e.clientX,o=e.clientY;return t.every((function(t){var e=t.popperRect,r=t.popperState,i=t.props.interactiveBorder,s=r.placement.split("-")[0],a=r.modifiersData.offset;if(!a)return!0;var l="bottom"===s?a.top.y:0,c="top"===s?a.bottom.y:0,u="right"===s?a.left.x:0,d="left"===s?a.right.x:0,p=e.top-o+l>i,h=o-e.bottom-c>i,f=e.left-n+u>i,g=n-e.right-d>i;return p||h||f||g}))})(o,t)&&(R(),tt(t))}}function G(t){K(t)||y.props.trigger.indexOf("click")>=0&&u||(y.props.interactive?y.hideWithInteractivity(t):tt(t))}function J(t){y.props.trigger.indexOf("focusin")<0&&t.target!==T()||y.props.interactive&&t.relatedTarget&&w.contains(t.relatedTarget)||tt(t)}function K(t){return!!Lt.isTouch&&S()!==t.type.indexOf("touch")>=0}function Q(){X();var e=y.props,n=e.popperOptions,o=e.placement,r=e.offset,i=e.getReferenceClientRect,s=e.moveTransition,l=A()?Vt(w).arrow:null,c=i?{getBoundingClientRect:i,contextElement:i.contextElement||T()}:t,u=[{name:"offset",options:{offset:r}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!s}},{name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(t){var e=t.state;if(A()){var n=E().box;["placement","reference-hidden","escaped"].forEach((function(t){"placement"===t?n.setAttribute("data-placement",e.placement):e.attributes.popper["data-popper-"+t]?n.setAttribute("data-"+t,""):n.removeAttribute("data-"+t)})),e.attributes.popper={}}}}];A()&&l&&u.push({name:"arrow",options:{element:l,padding:3}}),u.push.apply(u,(null==n?void 0:n.modifiers)||[]),y.popperInstance=dt(c,w,Object.assign({},n,{placement:o,onFirstUpdate:a,modifiers:u}))}function X(){y.popperInstance&&(y.popperInstance.destroy(),y.popperInstance=null)}function Y(){return kt(w.querySelectorAll("[data-tippy-root]"))}function Z(t){y.clearDelayTimeouts(),t&&D("onTrigger",[y,t]),F();var e=P(!0),o=C(),r=o[0],i=o[1];Lt.isTouch&&"hold"===r&&i&&(e=i),e?n=setTimeout((function(){y.show()}),e):y.show()}function tt(t){if(y.clearDelayTimeouts(),D("onUntrigger",[y,t]),y.state.isVisible){if(!(y.props.trigger.indexOf("mouseenter")>=0&&y.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(t.type)>=0&&u)){var e=P(!1);e?o=setTimeout((function(){y.state.isVisible&&y.hide()}),e):r=requestAnimationFrame((function(){y.hide()}))}}else H()}}function Qt(t,e){void 0===e&&(e={});var n=Bt.plugins.concat(e.plugins||[]);document.addEventListener("touchstart",Mt,gt),window.addEventListener("blur",Rt);var o,r=Object.assign({},e,{plugins:n}),i=(o=t,At(o)?[o]:function(t){return yt(t,"NodeList")}(o)?kt(o):Array.isArray(o)?o:kt(document.querySelectorAll(o))).reduce((function(t,e){var n=e&&Kt(e,r);return n&&t.push(n),t}),[]);return At(t)?i[0]:i}Qt.defaultProps=Bt,Qt.setDefaultProps=function(t){Object.keys(t).forEach((function(e){Bt[e]=t[e]}))},Qt.currentInput=Lt,Object.assign({},X,{effect:function(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow)}}),Qt.setDefaultProps({render:zt});const Xt=Qt,Yt="2sxc",Zt="20.00.04",te=["app","app-sys","app-api","app-query","app-content","eav","view","dnn"],ee={InstanceId:"data-cb-instance",Context:"data-edit-context",ContentBlockId:"data-cb-id"},ne={Attributes:ee,Sel:{SxcDivs:`div[${ee.Context}]`}};var oe;!function(t){t.log="log",t.warn="warn",t.error="error",t.throw="throw"}(oe||(oe={}));class re{log;constructor(t,e,n){this.initLogInternal(t,e,n)}initLog=(t,e,n)=>this.initLogInternal(t,e,n);initLogInternal(t,e,n){null!=this.log?(this.log.rename(t),this.log.linkLog(e),null!=n&&this.log.add(n)):this.log=new le(t,e,n)}}const ie="Q-E.Clpbrd",se={isDevBuild:!0,cms:{autoDump:!1,run:!0},log(...t){console.log(...t)},parts:{commandInfo:!1,ToolbarConfigLoaderV10:!1,RuleManager:!1,CommandTippy:!1,[ie]:!1,"Rnd.Rndrer":!1,"QDl.IfBrig":!1,"Cmd.Exec":!1,"Cms.Api":!1,"Q-E.Main":!1,debugObservables:!1,"Sys.Bootst":!1,"Bts.Module":!1}},ae=-1!==location.search.indexOf("debug=true");class le{entries=new Array;depth=0;callDepths=[];startTime;maxEntries=1e3;constructor(t,e,n){if(this.rename(t),this.linkLog(e),se.isDevBuild){const e=se.parts[t];null!=e&&(this.liveDump=e,this.keepData=e)}this.startTime=(new Date).getTime(),null!=n&&this.add(n)}liveDump=!1;_parentHasLiveDump=!1;keepData=ae;_parentHasKeepData=!1;fullIdentifier=()=>`${this.parent?this.parent.fullIdentifier():""}${this.identifier()}`;rename(t){try{const e=t.indexOf(".");this.scope=e>0?t.substr(0,Math.min(e,3))+".":"";const n=e>0?t.substr(e+1):t;this.name=n.substr(0,Math.min(n.length,6)),this.name=this.name.substr(0,Math.min(this.name.length,6))}catch(t){}}linkLog=t=>{this.parent=t||this.parent,this.parent&&(this._parentHasLiveDump=this.parent.liveDump||this.parent._parentHasLiveDump,this._parentHasKeepData=this.parent.keepData||this.parent._parentHasKeepData)};add(t,e){if(this.entries.length>this.maxEntries)return this._prepareMessage(t);this.entries.length===this.maxEntries&&this._addEntry(this._prepareEntry("Maximum amount of entries added to log, will stop adding more"));const n=this._prepareEntry(t,e);return this._addEntry(n),n.message}addData(t,e){this.logData()&&this.add(t,e)}logData(){return this.keepData||this._parentHasKeepData}_prepareEntry(t,e){const n=this._prepareMessage(t),o=(new Date).getTime()-this.startTime;return new pe(this,n,this.depth,o,e)}_prepareMessage(t){if(t instanceof Function)try{return t()}catch(t){return"err: message undefined"}return t.toString()}call(t,e,n,o){return new ce(this,t,e,n,o)}_callDepthAdd(t){this.depth++,this.callDepths.push(t)}_callDepthRemove(t){this.depth--;const e=this.callDepths.pop();e!==t&&console.warn(`log: call depth reduced by '${t}' but last was '${e}'`)}dump(t=null,e=" - "){t?this.dumpOne(0,t,e):this.dumpList()}dumpList(t=0,e){let n=t;this.entries.slice(t,e?t+e:void 0).forEach((t=>this.dumpOne(n++,t)))}dumpOne(t,e,n=" - "){const o=e.result?" ="+e.result:"",r=("0000"+t).slice(-4)+" "+e.source()+n+"..".repeat(e.depth)+e.message+o;e.data?console.log(r,e.data):console.log(r)}_addEntry(t){this.liveDump&&this.dump(t),this.entries.push(t),this.parent&&this.parent._addEntry(t)}randomString(t){const e="0123456789abcdefghiklmnopqrstuvwxyz";let n="";for(let o=0;o<t;o++){const t=Math.floor(Math.random()*e.length);n+=e.substring(t,t+1)}return n}parent;scope="tdo";name="unknwn";id=()=>this.idCache||(this.idCache=this.randomString(2));idCache;identifier=()=>`${this.scope}${this.name}(${this.id()})`}class ce{log;name;initialEntry;constructor(t,e,n,o,r){if(this.log=t,this.name=e,this.initialEntry=this.log._prepareEntry(e+"("+(n||"")+")"),this.log._callDepthAdd(e),this.log._addEntry(this.initialEntry),"string"==typeof o&&this.add(o),r)for(let t in r)this.data("initial:"+t,r[t])}lastMessage;add(t,e,n){this.lastMessage=t,this.log.add(t,e),n&&this.processExtraBehavior(n,t,e)}onlyAddIfNew(t,e){this.lastMessage!==t&&this.add(t),e&&this.processExtraBehavior(e,t,void 0)}data(t,e){this.log.addData(t,e)}done(t,e){this.return(null,t||"👍",e)}return(t,e,n){return e=e||"👍",this.initialEntry.result=e,this.log._callDepthRemove(this.name),this.initialEntry.data=t,(this.log.liveDump||this.log._parentHasLiveDump)&&this.add(this.name+" = "+e,t),n&&this.processExtraBehavior(n,e,t),t}processExtraBehavior(t,e,n){if(t===oe.log&&console.log(e,n),t===oe.warn&&console.warn(e,n),t!==oe.error&&t!==oe.throw||console.error(e,n),t===oe.throw)throw e}}class ue{static TypeSafeAssign(...t){t.reduce(((t,e)=>Object.keys(e).reduce(((t,n)=>(t[n]=e[n],t)),t)),t[0])}static DeepClone(t,e=!1){if(null==t)return t;const n=e?JSON.stringify(t,de):JSON.stringify(t);return null==n?t:JSON.parse(n)}}const de=()=>{const t=new WeakSet;return(e,n)=>{if("object"==typeof n&&null!==n){if(t.has(n))return;t.add(n)}return n}};class pe{log;message;depth;time;result;get data(){return this._data}set data(t){void 0!==t&&this.log.logData()&&(this._data=ue.DeepClone(t,!0))}_data;source=()=>this.log.fullIdentifier();constructor(t,e,n,o,r){this.log=t,this.message=e,this.depth=n,this.time=o,r&&(this.data=r)}}class he{name;logs=[];constructor(t){this.name=t}}const fe=window.$2sxc&&window.$2sxc._insights||new class extends re{constructor(){super("Sys.Insght"),this.add("system","insights",this.log),this.log.add("this log is usually empty, as it's just a helper tool")}history={};add(t,e,n){t in this.history||(this.history[t]=new he(t)),this.history[t].logs.push({key:e,log:n})}show(t,e,n,o){if(!t){const t=Object.keys(this.history);return void console.log(`This is the $2sxc JS Insights - see https://go.2sxc.org/insights \nAdd ?debug=true to the url to log more data. \nCopy/paste code lines below to see details. \n----------------------------------------------------------------------\n${t.length} insights-sections found: \n`+t.map((t=>`$2sxc.insights('${t}');`)).join("\n"))}const r=this.history[t];if(!r)return void console.error(`part '${t}' not found`);if(void 0===e){let e=0;const n=r.logs.map((n=>`$2sxc.insights('${t}', ${e++}); - will show for '${n.key}'`)).join("\n");return void console.log(`'${t}' contains ${r.logs.length} entries. Copy/paste the code to to see the logs: \n`+n)}const i=r.logs.length>=e&&r.logs[e];if(!i)return void console.error(`index ${e} not found in part '${t}'`);if(!i.log)return void console.error(`found index ${e} on part '${t}' but it has no logs`);console.log(`Will dump the log for ${t}[${e}] '${i.key}'`);let s=!1;void 0===n&&(s=!0,n=0,o=25),i.log.dumpList(n||0,o),s&&i.log.entries.length>o&&console.warn(`Only showing ${o} of ${i.log.entries.length} logs. To show all, add start param '..., 0)' or start/length '..., 0, 100)'`)}},ge=fe;function me(t){return t.replace(/(\/+)/g,"/")}class be{static runScripts(t,e){const n=t[0],o=t.slice(1);if(null==n)return void e?.();const r=document.createElement("script");if(Array.from(n.attributes).forEach((t=>{r.setAttribute(t.nodeName,t.nodeValue)})),r.textContent=n.textContent,r.type&&r.src){const t=()=>{r.onload=null,r.onerror=null,document.head.removeChild(r),this.runScripts(o,e)};return r.onload=t,r.onerror=t,void document.head.appendChild(r)}setTimeout((()=>{document.head.appendChild(r),document.head.removeChild(r),this.runScripts(o,e)}))}}class ye{static ready(t){"complete"===document.readyState?t():document.addEventListener("DOMContentLoaded",(()=>t()),{once:!0})}static param(t){return Object.entries(t).map((([t,e])=>`${encodeURIComponent(t)}=${null==e?"":"string"==typeof e?encodeURIComponent(e):encodeURIComponent(JSON.stringify(e))}`)).join("&")}static domFromString(t){const e=document.createElement("div");e.insertAdjacentHTML("afterbegin",t),Array.from(e.querySelectorAll("script")).forEach((t=>{const e=document.createElement("script");Array.from(t.attributes).forEach((t=>{e.setAttribute(t.nodeName,t.nodeValue)})),e.textContent=t.textContent,ye.replaceWith(t,e,!1)}));const n=Array.from(e.children);return n.forEach((t=>{e.removeChild(t)})),n}static offset(t){const e=t.getBoundingClientRect();return{top:e.top+window.scrollY,left:e.left+window.scrollX}}static width(t){const e=getComputedStyle(t);return 0===t.offsetWidth?0:t.offsetWidth-(parseInt(e.getPropertyValue("border-left-width"),10)+parseInt(e.getPropertyValue("border-right-width"),10))-(parseInt(e.getPropertyValue("padding-left"),10)+parseInt(e.getPropertyValue("padding-right"),10))}static height(t){const e=getComputedStyle(t);return 0===t.offsetHeight?0:t.offsetHeight-(parseInt(e.getPropertyValue("border-top-width"),10)+parseInt(e.getPropertyValue("border-bottom-width"),10))-(parseInt(e.getPropertyValue("padding-top"),10)+parseInt(e.getPropertyValue("padding-bottom"),10))}static empty(t){Array.from(t.childNodes).forEach((e=>{t.removeChild(e)}))}static replaceWith(t,e,n){const o=t.parentElement,r=Array.from(e.querySelectorAll("script")),i=[];r.forEach((t=>{i.push({script:t,type:t.type}),t.type=null})),o.replaceChild(e,t),i.forEach((t=>{t.script.type=t.type})),n&&be.runScripts(r,void 0)}static append(t,e,n){const o=[];e.forEach((e=>{if("script"===e.tagName.toLocaleLowerCase()){const n=e,r=n.type;n.type=null,t.appendChild(n),n.type=r,o.push(n)}else t.appendChild(e)})),n&&o.length>0&&be.runScripts(o,void 0)}}const ve="/desktopmodules/ToSic.Sxc/",we="RequestVerificationToken",xe="You must inject the jsApi parameters to prevent auto-detection.";class Oe extends re{env;constructor(t){super("Env.DnnLdr",t.log),this.env=t}dnnSfFallback(){const t=this.log.call("dnnSfFallback");ye.ready((()=>this.dnnSfLoadWhenDocumentReady())),t.done("started dom-ready watcher")}dnnSfLoadWhenDocumentReady(){const t=this.log.call("dnnSfLoadWhenDocumentReady");if(void 0===window.$)throw t.done("error"),`Can't load pageid, moduleid, etc. and $ is not available. \n ${xe}`;const e=window.$.ServicesFramework;if(void 0===e)throw t.done("error"),`Can't load pageid, moduleid etc. and DNN SF is not available. \n ${xe}`;const n=e(0);var o=n.getServiceRoot("2sxc"),r={page:n.getTabId(),root:"unknown",api:o,appApi:o,rvtHeader:we,rvt:n.getAntiForgeryValue(),uiRoot:ve,platform:"dnn"};this.env.load(r,"dnn SF"),t.done()}}const ke="input[name=__RequestVerificationToken]";class Ce{mainLoader;log;constructor(t){this.mainLoader=t,this.log=new le("ldr.dynmic",t.log)}startMetaTagObserver(t){this.observer||(this.observer=new MutationObserver((e=>{for(const n of e)"attributes"===n.type&&n.attributeName===t&&this.mainLoader.updateEnv(JSON.parse(this.mainLoader.getMetaContent()))})),this.log.add("start observing meta tag"),this.observer.observe(this.mainLoader.getJsApiMetaTag(),{attributes:!0,childList:!1,subtree:!1}))}observer;startInputRvtObserver(){if(this.inputRvtObserver)return;this.inputRvtObserver=new MutationObserver((t=>{for(const e of t)"attributes"===e.type&&"value"===e.attributeName&&this.loadRvtFromHiddenInput(e.target)})),this.log.add("start observing Rvt Input");const t=document.querySelector(ke);null!=t?(this.loadRvtFromHiddenInput(t),this.inputRvtObserver.observe(t,{attributes:!0,childList:!1,subtree:!1})):console.log(`Can't find Oqtane RVT field with selector ${ke}\nSo we cannot watch it for changes.\nThis will probably cause the $2sxc to fail.`)}inputRvtObserver;loadRvtFromHiddenInput(t){this.log.add("Input Rvt updated"),t&&t.value&&this.mainLoader.env.updateRvt(t.value)}}const Se="content";class Ae extends re{env;retries=0;dynamicPageHelper;constructor(t){super("Env.MetaLd",t.log),this.env=t,this.dynamicPageHelper=new Ce(this)}loadMetaFromHeader(t=!1){const e=this.log.call("loadMetaFromHeader",`${t}`);if(this.env.ready)return e.done("loadMeta - ready");this.log.add("loadMetaFromHeader: start, retry:"+this.retries+", force fallback: "+t);const n=this.getMetaContent();if(!n)return this.retries++,t||this.retries>=100?(new Oe(this.env).dnnSfFallback(),e.done()):(setTimeout((()=>{this.loadMetaFromHeader()}),10),e.done("will retry"));this.updateEnv(JSON.parse(n)),this.dynamicPageHelper.startMetaTagObserver(Se),e.done()}updateEnv(t){this.log.add("meta env info updated"),this.env.load(t,"meta header"),"oqtane"===t.platform&&this.dynamicPageHelper.startInputRvtObserver()}getMetaContent(){const t=this.getJsApiMetaTag();return t?t.getAttribute(Se):null}getJsApiMetaTag(){return document.querySelector("meta[name=_jsApi]")}startMetaTagObserver(){this.observer||(this.observer=new MutationObserver((t=>{for(const e of t)"attributes"===e.type&&e.attributeName===Se&&this.updateEnv(JSON.parse(this.getMetaContent()))})),this.log.add("start observing meta tag"),this.observer.observe(this.getJsApiMetaTag(),{attributes:!0,childList:!1,subtree:!1}))}observer}class Te extends re{header;ready=!1;source="";metaLoader;constructor(){super("Environment",null,"starting"),this.log.keepData=!0,ge.add("system","environment",this.log),this.metaLoader=new Ae(this),"undefined"!=typeof _jsApi?(this.log.add("found _jsApi, will use"),this.load(_jsApi,"global variable _jsApi")):(this.log.add("will start initializing"),this.metaLoader.loadMetaFromHeader())}load(t,e){const n=this.log.call("load");if(t.root&&!t.api){n.add("root provided, api missing, will auto-complete");const e=t.root.endsWith("/")?"":"/";t.api=`${t.root}${e}desktopmodules/2sxc/api/`}this.header=t,this.replacedRvt&&(this.header.rvt=this.replacedRvt),this.ready=!0,this.source=e||"external/unknown"+(this.replacedRvt?"+rvt":""),n.return(t,"loaded from "+this.source)}replacedRvt;updateRvt(t){t&&(this.replacedRvt=t,this.header.rvt=t)}api(){return this.ensureReadyOrThrow("api"),this.header.api}appApi(){return this.ensureReadyOrThrow("appApi"),this.header.appApi}page(){return this.ensureReadyOrThrow("page"),this.header.page}rvtHeader(){return this.ensureReadyOrThrow("rvtHeader"),this.header.rvtHeader||we}rvt(){return this.ensureReadyOrThrow("rvt"),this.header.rvt}uiRoot(){return this.ensureReadyOrThrow("uiRoot"),this.header.uiRoot||ve}platform(){return this.ensureReadyOrThrow("platform"),this.header.platform||"dnn"}dialogQuery(){return this.header.dialogQuery??null}publicKey(){return this.header.publicKey??null}ensureReadyOrThrow(t){if(!this.ready&&(this.log.add("ensureReady - force last attempt to load MetaHeader for "+t),this.metaLoader.loadMetaFromHeader(!0),!this.ready))throw`Can't find ${t} - something went wrong, pls contact 2sxc.org`}}class Ie{api;sxc;constructor(t,e){this.api=t,this.sxc=e}makePromise(t){var e=this.api.headers();if(null==window.$)throw new Error("JQuery is now removed from 2sxc installation. Please use newer api like fetch or include JQuery in your project");const n=window.$.ajax({async:!0,dataType:t.dataType||"json",data:JSON.stringify(t.data),contentType:"application/json",type:t.method,url:this.getActionUrl(t),beforeSend(t){for(var n in e)e.hasOwnProperty(n)&&t.setRequestHeader(n,e[n])}});return t.preventAutoFail||n.fail(this.sxc.showDetailedHttpError),n}getActionUrl(t){var e=t.url||"app/auto/api/"+t.controller+"/"+t.action;return this.sxc.http.apiUrl(e,t.endpoint)+(t.params?"?"+ye.param(t.params):"")}}class Ee{version;data;key;iv;constructor(t,e,n){this.version=1,this.data=t,this.key=e,this.iv=n}}class Pe{sxc;encryptBody;encryptShowErrorToUser;throwIfFails;constructor(t,e){this.sxc=t,this.encryptBody=e.encryptBody??e.encrypt??"auto",this.throwIfFails=1==e.encryptBody||"force"==e.encryptBody,this.encryptShowErrorToUser=e.encryptShowErrorToUser??!1}async encryptData(t){if(!1===this.encryptBody)return t;const e=this.sxc.env.publicKey();if(!e)return this.handleOrThrowError("Encryption is not available. Public key is missing."),t;if(!window.crypto.subtle)return this.handleOrThrowError("Encryption is not available because 'window.crypto.subtle' is unavailable. Check if page is on HTTPS."),t;const n=await this.importPublicKey(e),o=await window.crypto.subtle.generateKey({name:"AES-CBC",length:256},!0,["encrypt","decrypt"]),r=await window.crypto.subtle.exportKey("raw",o),i=await window.crypto.subtle.encrypt({name:"RSA-OAEP"},n,r),s=window.crypto.getRandomValues(new Uint8Array(16)),a=new TextEncoder,l=JSON.stringify(t??""),c=a.encode(l),u=await window.crypto.subtle.encrypt({name:"AES-CBC",iv:s},o,c),d=this.arrayBufferToBase64(i),p=this.arrayBufferToBase64(u),h=this.arrayBufferToBase64(s.buffer);return new Ee(p,d,h)}handleOrThrowError(t){if(this.encryptShowErrorToUser&&alert(t),this.throwIfFails)throw new Error(t)}getSpkiDer(t){const e=window.atob(t);return this.str2ab(e)}async importPublicKey(t){return await window.crypto.subtle.importKey("spki",this.getSpkiDer(t),{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"])}str2ab(t){const e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);return e}arrayBufferToBase64(t){const e=new Uint8Array(t);let n="";for(let t=0;t<e.byteLength;t++)n+=String.fromCharCode(e[t]);return window.btoa(n)}}class Le{sxc;constructor(t){this.sxc=t}get(t,e,n,o){return this.request(t,e,n,o,"GET")}post(t,e,n,o){return this.request(t,e,n,o,"POST")}delete(t,e,n,o){return this.request(t,e,n,o,"DELETE")}put(t,e,n,o){return this.request(t,e,n,o,"PUT")}request(t,e,n,o,r){if("object"!=typeof e&&void 0!==e&&(e={id:e}),"string"==typeof t){const r=t.split("/"),i=r[0],s=r[1];""!==i&&""!==s||console.warn("Error: controller or action not defined. Will continue with likely errors."),t={controller:i,action:s,params:e,data:n,url:r.length>2?t:null,preventAutoFail:o}}const i={method:null===r?"POST":r,params:null,preventAutoFail:!1};var s=new Ie(this,this.sxc);return t=Object.assign({},i,t),s.makePromise(t)}async fetchRaw(t,e,n){const o={},r=this.sxc.ctx,i=t.toLocaleLowerCase();r?._autoAppIdsInUrl&&i.includes("app/auto/")&&(r.appId&&!i.includes("appid=")&&(o.appId=r.appId),r.zoneId&&!i.includes("zoneid=")&&(o.zoneId=r.zoneId)),t=this.url(t,o);const s=this.prepareOptions(n,e),a=this.headers(s.method);if("POST"==s.method&&(e=await new Pe(this.sxc,s).encryptData(e)),e)try{JSON.parse(e)}catch{e=JSON.stringify(e)}return fetch(t,{headers:a,method:s.method,...e&&{body:e}})}prepareOptions(t,e){const n={method:e?"POST":"GET",encrypt:"auto",encryptBody:"auto"};return"string"==typeof t?{...n,method:t}:"object"==typeof t?{...t,method:t.method||n.method,encrypt:t.encrypt??n.encrypt,encryptBody:t.encryptBody??t.encrypt??n.encryptBody}:n}async fetch(t,e,n){return console.warn("You are calling 'fetch' on the sxc.webApi. This is deprecated will stop in 2sxc v15, please use fetchRaw(...) or fetchJson(...) instead."),this.fetchJson(t,e,n)}async fetchJson(t,e,n){return this.fetchRaw(t,e,n).then((t=>t.json()))}headers(t){const e=this.sxc.http.headers(this.sxc.id,this.sxc.cbid,this.sxc.ctx);return t?("GET"===t.toLocaleUpperCase()?e.Accept="application/json":(e.Accept="application/json",e["Content-Type"]="application/json"),e):e}url(t,e){if(null==t)return t;const n=t.split("#")[0].split("?"),o=(t=n[0]).split("/");return 2===o.length&&o[0]&&o[1]&&(t=`app/auto/api/${o[0]}/${o[1]}`),[t=this.sxc.http.apiUrl(t),e=`${n[1]||""}&${e?"string"==typeof e?e:ye.param(e):""}`.split("&").filter((t=>!!t)).join("&")].filter((t=>!!t)).join("?")}}var De;!function(t){t[t.Undefined=0]="Undefined",t[t.None=1]="None",t[t.Attribute=2]="Attribute",t[t.App=3]="App",t[t.Entity=4]="Entity",t[t.ContentType=5]="ContentType",t[t.Zone=6]="Zone",t[t.CmsItem=10]="CmsItem",t[t.System=11]="System",t[t.Site=12]="Site",t[t.SiteVariant=13]="SiteVariant",t[t.Page=14]="Page",t[t.PageVariant=15]="PageVariant",t[t.Module=16]="Module",t[t.ModuleVariant=17]="ModuleVariant",t[t.User=18]="User",t[t.Custom=90]="Custom",t[t.Custom1=91]="Custom1",t[t.Custom2=92]="Custom2",t[t.Custom3=93]="Custom3",t[t.Custom4=94]="Custom4",t[t.Custom5=95]="Custom5",t[t.Custom6=96]="Custom6",t[t.Custom7=97]="Custom7",t[t.Custom8=98]="Custom8",t[t.Custom9=99]="Custom9"}(De||(De={}));class Me{sxc;partName;constructor(t,e){this.sxc=t,this.partName=e}}class $e extends Me{name;webApi;constructor(t,e,n){if(super(t,"data"),this.name=e,this.webApi=t.webApi,n+=" name ",null==e)throw n+"is empty";if(-1!=e.indexOf("/")||-1!=e.indexOf("\\"))throw n+"has slashes - not allowed";if(-1!=e.indexOf("?"))throw n+'has "?" - not allowed'}}class Re extends $e{name;constructor(t,e){super(t,e,"ContentType"),this.name=e}getAll(){return this.getInternal()}getOne(t){return this.getInternal(t)}getMany(t,e){throw"not implemented - probably v13.5 or something"}getInternal(t,e){let n=`app/auto/data/${this.name}`;return!t||"string"!=typeof t&&"number"!=typeof t||(n+="/"+t),this.webApi.fetchJson(this.webApi.url(n,e))}create(t,e){const n=`app/auto/data/${this.name}`;if(null!=e){"string"==typeof e&&(e={Target:De.Entity,Guid:e});try{t.For=e}catch{}}return this.webApi.fetchJson(this.webApi.url(n),t,"POST")}update(t,e){const n=`app/auto/data/${this.name}/${t}`;return this.webApi.fetchJson(this.webApi.url(n),e,"POST")}delete(t){const e=`app/auto/data/${this.name}/${t}`;return this.webApi.fetchRaw(this.webApi.url(e),void 0,"DELETE").then((t=>null))}}class je extends $e{name;constructor(t,e){super(t,e,"Query"),this.name=e}getAll(t,e){return this.getInternal(void 0,t,e)}getStream(t,e,n){if(-1!==t.indexOf(","))throw"parameter 'stream' can only contain one stream name for 'getStream'";return this.getInternal(t,e,n).then((e=>null!=e&&e.hasOwnProperty(t)?e[t]:[]))}getStreams(t,e,n){return this.getInternal(t,e,n)}getInternal(t,e,n){let o="app/auto/query/"+this.name;return t&&"string"==typeof t&&(o+="?stream="+t),this.webApi.fetchJson(this.webApi.url(o,e),n)}}class Be extends Me{constructor(t){super(t,"cms")}run(t){throw'cms.run() requires editing to be on, or page-feature "2sxc.JsCms" to be enabled to work'}}class Ne extends re{env;constructor(t){super("Sxc.Http"),this.env=t}headers(t,e,n){const o=this.log.call("headers",`${t}, ${e}`),r={},i=(n?.pageId??this.env.page()).toString();return t=n?.moduleId??t,e=n?.blockId??e,n?._noContextInHttpHeaders||(t&&(r.ModuleId=t.toString()),e&&(r.ContentBlockId=e.toString()),r.TabId=i,r.PageId=i),r[this.env.rvtHeader()]=this.env.rvt(),o.return(r,`headers(id:${t}, cbid:${e})`)}apiRoot(t){const e=this.log.call("apiRoot");var n=this.env.api().replace("e.x.t",t);return e.return(n,`apiRoot('${t}')`)}appApiRoot(){const t=this.log.call("appApiRoot");var e=this.env.appApi()??this.apiRoot(Yt);return t.return(e,"appApiRoot()")}apiUrl(t,e){const n=this.log.call("apiUrl");if(this.log.add(`apiUrl(url:'${t}', endpointName:'${e}')`),null==t)return t;if(!t||0==t.indexOf("http:")||0==t.indexOf("https:")||0==t.indexOf("//"))return n.return(t);if(!e&&(0==t.indexOf("/")||0==t.indexOf(".")))return n.return(t);var o=t.toLocaleLowerCase().startsWith("app")?this.appApiRoot():this.apiRoot(e||Yt);return"/"!=o[o.length-1]&&(o+="/"),"/"==t[0]&&(t=t.slice(1)),n.return(o+t)}}class Fe{static getContext(t,e){const n=e?Fe.getContainerTag(e):Fe.getTag(t);return Fe.getContextOfTag(n)}static getContextOfTag(t){const e=t?.getAttribute(ne.Attributes.Context);return JSON.parse(e||"{ }")}static getContainerTag(t){return t.closest(ne.Sel.SxcDivs)}static getTag(t){return document.querySelector(`div[${ne.Attributes.ContentBlockId}='${t.cbid}']`)}}class He extends re{id;cbid;cacheKey;root;ctx;_isSxcInstance=!0;webApi;manage=null;cms=new Be(this);constructor(t,e,n,o,r){super("SxcInstance",null,"Generating for "+t+":"+e),this.id=t,this.cbid=e,this.cacheKey=n,this.root=o,this.ctx=r;try{o._manage&&o._manage.initInstance(this)}catch(t){console.error("error in 2sxc - will only log but not throw",t)}const i=this.loadEnv(o);var s;this.env=i.env,this.http=i.http,this.webApi=new Le(this),(s=this.data).on||(s.on=()=>{throw _e},Object.defineProperty(s,"sourceUrl",{get:function(){throw _e}})),o._translateInit&&this.manage?.context?.app?.currentLanguage&&o._translateInit(this.manage)}loadEnv(t){let e=this.manage?.editContext?.jsApi??Fe.getContext(this)?.jsApi;if(!e)return{env:t.env,http:t.http};const n=t.env.headers,o=e?{...n,...e}:n,r=new Te;return r.load(o,"sxc-instance"),{env:r,http:new Ne(r)}}env;http;static is(t){return t._isSxcInstance}data(t){return new Re(this,t)}query(t){return new je(this,t)}resolveServiceUrl(t){const e=t.split("/")[0].toLowerCase();return-1===te.indexOf(e)?t:this.http.apiRoot(Yt)+e+"/"+t.substring(t.indexOf("/")+1)}showDetailedHttpError(t){if(window.console&&console.log(t),404===t.status&&t.config&&t.config.url&&t.config.url.indexOf("/dist/i18n/")>-1)return window.console&&console.log("just fyi: failed to load language resource; will have to use default"),t;if(0===t.status||-1===t.status)return t;let e="Had an error talking to the server (status "+t.status+").";const n=t.responseText?JSON.parse(t.responseText):t.data;if(n){const t=n.Message;t&&(e+="\nMessage: "+t);const o=n.MessageDetail||n.ExceptionMessage;o&&(e+="\nDetail: "+o),o&&0===o.indexOf("No action was found")&&(o.indexOf("that matches the name")>0?e+="\n\nTip from 2sxc: you probably got the action-name wrong in your JS.":o.indexOf("that matches the request.")>0&&(e+="\n\nTip from 2sxc: Seems like the parameters are the wrong amount or type.")),t&&0===t.indexOf("Controller")&&t.indexOf("not found")>0&&(e+="\n\nTip from 2sxc: you probably spelled the controller name wrong or forgot to remove the word 'controller' from the call in JS. To call a controller called 'DemoController' only use 'Demo'.")}return e+="\n\nif you are an advanced user you can learn more about what went wrong - discover how on 2sxc.org/help?tag=debug",alert(e),t}isEditMode(){return!0===this.manage?._isEditMode()}recreate(t){return t&&delete this.root._controllers[this.cacheKey],this.root(this.id,this.cbid)}}const _e='Warning Obsolete Feature on 2sxc JS: the .data has been obsolete for a long time and is repurposed. \nIf you are calling ".data.on(...)" or ".data.sourceUrl" you are running very old code. \nGuidance to fix this: https://go.2sxc.org/brc-13-id.';class qe{static getEditContext(t,e){return Fe.getContext(t,e)}}var Ue;!function(t){t.quickDialog="dist/quick-dialog/",t.eavUi="dist/ng-edit/"}(Ue||(Ue={}));const Ve={cls:{scMenu:"sc-menu"},attr:{toolbar:"toolbar",toolbarData:"data-toolbar",settings:"settings",settingsData:"data-settings"},publishAllowed:"DraftOptional",sel:{scMenu:".sc-menu",tagScMenu:"ul.sc-menu"}},ze={InstanceId:"data-cb-instance",Context:"data-edit-context",ContentBlockId:"data-cb-id"},We={ContentBlock:class{static cViewWithoutContent="_LayoutElement";static UseExistingTemplate=-1},DialogPaths:Ue,IDs:Ve,AttrNames:ze,ClsNames:{UnInitialized:"sc-uninitialized",UnAvailable:"sc-unavailable"},Toolbar:{attrToMarkInitalized:"2sxc-tagtoolbar",attr:{full:"sxc-toolbar",hover:"sxc-toolbar-hover",disable:"data-disable-toolbar"},classes:{oldHover:"sc-element"},selectors:{ofOldHover:".sc-element"},eventNames:{onInit:"toolbar-init"}},Cb:{classes:{name:"sc-content-block"},selectors:{ofName:".sc-content-block"}},Debug:se,Sel:{SxcDivs:`div[${ze.Context}]`}};class Ge{id;isEditable=!1;allowPublish=!0;sxcVersion=Zt;parameters=null;sxcRootUrl="";constructor(t,e){t.Environment&&(this.id=t.Environment.InstanceId,this.isEditable=t.Environment.IsEditable??!1,this.sxcVersion=t.Environment.SxcVersion??Zt,this.parameters=t.Environment.parameters,this.sxcRootUrl=t.Environment.SxcRootUrl??""),this.id||(this.id=e?.ctx?.moduleId??-2742),t.contentBlockReference&&(this.allowPublish=t.contentBlockReference.publishingMode===We.IDs.publishAllowed)}}class Je{id;constructor(t,e){t.Environment&&(this.id=t.Environment.PageId),this.id=this.id??e?.ctx?.pageId??window.$2sxc.env.page()??-2742}}class Ke{error;problems;constructor(t){this.problems=t.error?.problems,t.error&&(this.error=t.error.type)}}class Qe{constructor(t){t.Environment}}class Xe{publishingMode=Ve.publishAllowed;id=2742e8;parentGuid=null;parentField=null;parentIndex=0;partOfPage=!1;constructor(t){Object.assign(this,t)}}class Ye extends class{CanDevelop;CanAdmin;canSwitchEdition}{constructor(t){super(),t&&t.User&&(this.CanDevelop=t.User.CanDevelop,this.CanAdmin=t.User.CanAdmin,this.canSwitchEdition=t.User.canSwitchEdition)}}class Ze extends class{appName}{isContent=!0;settingsId=null;resourcesId=null;appPath;hasContent;supportsAjax=!1;zoneId;id;currentLanguage;primaryLanguage;allLanguages;constructor(t,e){if(super(),t.contentBlock){const e=t.contentBlock;this.id=e.AppId,this.isContent=e.IsContent??!0,this.resourcesId=e.AppResourcesId??null,this.settingsId=e.AppSettingsId??null,this.appPath=e.AppUrl,this.hasContent=e.HasContent,this.supportsAjax=e.SupportsAjax??!1,this.zoneId=e.ZoneId,this.appName=e.appName}e&&e.ctx&&(this.id=this.id??e.ctx.appId,this.zoneId=this.id??e.ctx.zoneId),t.Language&&(this.currentLanguage=t.Language.Current,this.primaryLanguage=t.Language.Primary,this.allLanguages=t.Language.All)}}class tn{autoToolbar;constructor(t){t.Ui&&(this.autoToolbar=t.Ui.AutoToolbar)}}class en{sxc;instance;app;ui;page;system;tenant;user;_isContext=!0;constructor(t,e){this.app=new Ze(t,e),this.instance=new Ge(t,e),this.user=new Ye(t),this.page=new Je(t,e),this.system=new Ke(t),this.tenant=new Qe(t),this.ui=new tn(t)}static is(t){const e=t;return void 0!==e.sxc&&void 0!==e.instance}}class nn extends class{templateIsShared;viewName;renderMs;renderLightspeed;viewSwitchDisabled}{isCreated;isList;queryId;queryName;queryInfo;templateId;contentTypeId;contentGroupId;templatePath;edition;editions;constructor(t){super();const e=t.contentBlock;e&&(this.isCreated=e.IsCreated,this.isList=e.IsList,this.queryId=e.QueryId,this.queryName=e.queryName,this.queryInfo=e.queryInfo,this.templateId=e.TemplateId,this.templatePath=e.TemplatePath,this.templateIsShared=e.templateIsShared,this.edition=e.Edition??null,this.editions=e.editions??null,this.contentTypeId=e.ContentTypeName,this.contentGroupId=e.Guid,this.viewName=e.viewName,this.renderMs=e.renderMs,this.renderLightspeed=e.renderLightspeed,this.viewSwitchDisabled=e.viewSwitchDisabled)}}class on{constructor(t){}}class rn extends en{item;contentBlockReference;contentBlock;constructor(t,e){super(t,e),this.item=new on(t),this.contentBlockReference=new Xe(t.contentBlockReference),this.contentBlock=new nn(t)}}class sn extends rn{toolbar;constructor(t,e){super(t,e)}forButton(t){const e={...this};return e.button=t,e}}class an extends sn{_isCtxComplete=!0;button;static getRule(t){return t.toolbar?.settings?._rules?.find(t.button.id)}commandWorkflow;constructor(t,e){super(t,e)}static expandContext(t,e){let n,o=null;He.is(t)?n=t:"number"==typeof t?n=window.$2sxc(t,e):(n=window.$2sxc(t),o=Fe.getContainerTag(t));const r=an.getContextInstance(n,o);return r.sxc=n,r}static contextCopy(t,e){const n=an.expandContext(t,e);n.sxc=null;const o=ue.DeepClone(n);return n.sxc=window.$2sxc(t),o}static getContextInstance(t,e){const n=qe.getEditContext(t,e);return new an(n,t)}static is(t){return t._isCtxComplete}}const ln="icon-sxc-",cn="Toolbar.",un=se.parts.CommandTippy;class dn{name;constructor(t){this.name=t}buttonDefaults;mergeDefaults(t,e,n,o,r){if("boolean"!=typeof o)throw"partOfPage in commands not provided, order will be wrong!";this.buttonDefaults={icon:()=>`${ln}${e}`,title:()=>`${cn}${t}`,uiActionOnly:()=>n,partOfPage:()=>o,color:()=>{},tippy:(t,e)=>{const n=an.getRule(t)?.ui;let o=n?.note;if(!o&&r.notes){var i=r.notes(t);i&&i.length>0&&(o=i[0])}if(!o?.note)return;const s=o?.asHtml??!1;let a={content:o.note,theme:"light",arrow:!0,delay:[o.delay,o.linger],allowHTML:s,onMount:t=>{const e=t.popper.querySelector(".tippy-content");o.isSystem&&(e.style.background="#DFC2F2"),o?.background&&(e.style.background=o.background)}};o.interactive&&(a=this.tippyMakeInteractive(a)),a=this.tippyAddLinks(a,o),un&&console.log("Command-Tippy",o,a),Xt(e,a),o.delay>100&&(e.classList.add("note-delayed"),o.isSystem&&e.classList.add("note-system"))},...r}}tippyAddLinks(t,e){if(!e.links||0===e.links.length)return t;const n=e.links.map((t=>`<a class="tippy-button ${t.primary?"tippy-button-primary":""}" href="${t.url}" target="_blank">${t.label??"🔗 more"}</a>`));return{...this.tippyMakeInteractive(t),allowHTML:!0,content:`<div>${e.note}<div>\n      <br>\n      <div class="tippy-buttons">${n}</div>`}}tippyMakeInteractive(t){return{...t,interactive:!0,appendTo:()=>document.body}}static build(t,e,n,o,r,i){const s=new dn(t);return s.mergeDefaults(e,n,o,r,i),s}static clone(t,e){const n=new dn(e);return n.buttonDefaults=t.buttonDefaults,n}}class pn extends re{static singleton(){return this.#t??(this.#t=new pn)}static#t;static add(t,e,n,o,r,i){return this.singleton().add(t,e,n,o,r,i)}static addCommand(t){return this.singleton().addCommand(t)}#e=[];list={};constructor(){super("Cmd.Catlog"),ge.add("system","command-catalog",this.log)}get=t=>this.list[t];add(t,e,n,o,r,i){const s=this.#n(dn.build(t,e,n,o,r,i));return this.log.add(`add command '${t}'`,s),s}addCommand(t){const e=this.#n(t);this.log.add(`add command '${e.name}'`,e)}#n(t){return this.list[t.name]?this.list[t.name]!==t&&(this.list[t.name]=t):(this.#e.push(t),this.list[t.name]=t),t}}class hn{static isPartOfBlockList(t){return!(!t.contentBlock.isList||!t.button.command.params.useModuleList||-1===zn.getIndex(t))}static isBlockReference(t){return!!t.button.command.params.useModuleList}static isFieldList(t){const e=t.button?.command.params;return!(!e?.fields||!e?.parent)}static isList(t){return this.isPartOfBlockList(t)||this.isFieldList(t)}static isReferencedItem(t){return this.isBlockReference(t)||this.isFieldList(t)}}class fn{static disable(t){t.setAttribute(We.Toolbar.attr.disable,"true")}static isDisabled(t){return!!Fe.getTag(t).getAttribute(We.Toolbar.attr.disable)}static getFirstAttribute(t,e,n){return fn.tryGetAttrText(t,e)||fn.tryGetAttrText(t,n)||"{}"}static tryGetAttrText(t,e){const n=t.attributes.getNamedItem(e);return n&&n.textContent}static addClasses(t,e){if(!e)return;e.indexOf(",")&&(e=e.replace(","," "));const n=e.split(" ");for(let e=0;e<n.length;e++)n[e]&&t.classList.add(n[e])}}class gn{parent;parentGuid;field;list;item;index;type}class mn extends re{constructor(t){super(t)}}const bn=ln;var yn;!function(t){t.setButtonActivationClasses=function(t,e){for(const[t,n]of Object.entries(new wn))e.forEach((e=>{e.classList.remove(`enable-${t}`,`disable-${t}`)}));for(const[n,o]of Object.entries(t))e.forEach((t=>{t.classList.add(`${o?"enable":"disable"}-${n}`)}))},t.btn=function(t,e,n,o,r,i){return`<a class='sc-content-block-menu-btn sc-cb-action ${bn}${e} ${o?" sc-invisible ":""}${r?` ${We.ClsNames.UnAvailable} `:""}${i}' data-action='${t}' data-i18n='[title]QuickInsertMenu.${n}'></a>`},t.selectedOverlay=ye.domFromString('<div class="sc-content-block-menu sc-content-block-selected-menu sc-i18n"></div>').map((e=>(e.append(ye.domFromString(t.btn("delete","trash-empty","Delete"))[0],ye.domFromString(t.btn("sendToPane","move","Move",null,null,"sc-cb-mod-only"))[0],ye.domFromString('<div id="paneList"></div>')[0]),e)))[0]}(yn||(yn={})),yn.selectedOverlay.toggleOverlay=(t,e)=>{if(t){const n=Mi.get(t);n.yh=n.y+20,Mi.positionAndAlign(yn.selectedOverlay,n),yn.selectedOverlay.target=t,yn.setButtonActivationClasses(e,Array.from(yn.selectedOverlay.querySelectorAll("a")))}else yn.selectedOverlay.style.display="none"};const vn="auto";class wn{addContent=!0;addApp=!0;select=!0;paste=!0;delete=!0;move=!0}class xn{enable="auto";buttons}class On extends xn{innerBlocks;modules;static getDefault(){return{enable:!0,buttons:new wn,innerBlocks:{enable:vn},modules:{enable:vn}}}}class kn{parent;parentGuid;field;type;guid;apps;max;appList;static getFromDom(t){const e=JSON.parse(t.getAttribute(Hi.blocks.cb.context)||null)||{};return e.appList=[],null!=e&&"string"==typeof e.apps&&e.apps.length>1&&(e.appList=e.apps.split(",").map((t=>t.trim())).filter((t=>!!t))),e}}const Cn="end",Sn="start",An="auto",Tn="never",In="right",En="left",Pn="hover",Ln="default",Dn="always",Mn="scroll";class $n{autoAddMore=An;hover=In;show=Pn;delayShow=0;follow=Ln;classes="";class="";color="";_rules;constructor(t){null!=t&&Object.keys(this).forEach((e=>{let n=e;t[n]&&(this[e]=t[n])})),this.follow===Ln&&(this.follow="none")}static dropEmptyProperties(t){const e={...t};return e.autoAddMore||delete e.autoAddMore,e.classes||delete e.classes,e}static getDefaults=()=>new $n({autoAddMore:An,hover:In,show:Pn,follow:Ln});static getForEmpty=()=>new $n({autoAddMore:An,hover:En,show:Pn,follow:Ln});static getForEmptyAsRule=()=>"settings&autoAddMore=auto&hover=left&show=hover&follow=default";static bestAddMorePos(t){const e=t?.autoAddMore??An;return e===An?t?.hover?.startsWith(En)?Sn:Cn:e===Cn||e===Sn||e===Tn?e:"right"===e||!0===e?Cn:e}}let Rn;class jn{static getWorkflow(t){if(!t)return jn.getDummyManager();let e=0,n=t;for(;n&&e++<100;){const t=n.commandWorkflow;if(t)return t;n=n.parentElement}return jn.getDummyManager()}static getDummyManager(){return Rn||(Rn=new Bn(null,!0)),Rn}static isCancelled(t){return this._isCancelled(t)}static _isCancelled(t){return null!=t&&(!1===t||!0===t.cancel)}}class Bn extends re{isDummy;steps=[];constructor(t,e=!1){super("Cmd.Wrkflw",t,"constructor"),this.isDummy=e}add(t){t&&(Array.isArray(t)?t.forEach((t=>this.addOne(t))):this.addOne(t))}addOne(t){t=_n.initDefaults(t);const e=this.log.call("add",`'${t.name}' for '${t.command}'-'${t.phase}'`);if(!t){const t="Trying to add workflow step but didn't get anything";throw e.add(t),t}this.steps.push(t),e.done()}run(t){const e=this.log.call("run",`'${t.command}' for '${t.phase}'`);if(this.isDummy)return e.done("Dummy workflow, nothing to run, will return a resolved promise"),Nn(t);const n=this.steps.filter((e=>e.command===t.command||e.command===bs.all)).filter((e=>e.phase===t.phase||e.phase===Hn.all)).filter((t=>t.code)).sort((t=>t.priority));return 0===n.length?(e.done("no steps found for this command / phase, will return a resolved promise"),Nn(t)):new Promise(((e,o)=>{let r=Promise.resolve(t);for(let e=0;e<n.length;e++){const o=n[e];r=r.then((e=>this.runNextPromiseIfNotCancelled(e,t,o.code)))}r.then((t=>{e(t)})),r.catch(o)}))}attach(t,e){const n=this.log.call("attach");t&&(t.commandWorkflow=this,ge.add("workflow",e.toolbar?.identifier,this.log),n.done())}runNextPromiseIfNotCancelled(t,e,n){const o=jn.isCancelled(t);return(t=t&&"boolean"!=typeof t?t:{...e}).cancel=o,o?Nn(t):n(t)}}function Nn(t){return Promise.resolve(t)}class Fn{command;phase;context;result;constructor(t,e,n,o=null){this.command=t,this.phase=e,this.context=n,this.result=o}cancel=!1}var Hn;!function(t){t.all="all",t.before="before",t.after="after"}(Hn||(Hn={}));class _n{static initDefaults(t){if(t.name=t.name??"",t.command=t.command??bs.all,t.phase=t.phase??Hn.before,t.priority=t.priority??1,!t.code||"function"!=typeof t.code)throw"Tried preparing a workflow step, but the promise either doesn't exist or is not a promise factory";return t}}class qn{static raiseToolbarInitEvent(t,e,n){const o=new Bn(null);o.attach(t,n);const r=new CustomEvent(We.Toolbar.eventNames.onInit,{bubbles:!0,detail:{element:t,identifier:n.toolbar?.identifier,workflow:o}});e?.dispatchEvent(r)}}class Un{hoverTag;context;translator;toolbarElement=null;initialized=!1;follow;alwaysShow=!1;delayShow=0;constructor(t,e,n){this.hoverTag=t,this.context=e,this.translator=n;const o=e.toolbar.settings;this.follow=o.follow,this.alwaysShow="always"===o.show,this.delayShow=o.delayShow??0,this.addMouseEvents(t),this.alwaysShow&&this.showPermanently()}addMouseEvents(t){t.addEventListener("mouseenter",(()=>{0==this.delayShow?this.show():this.delayShowTimeout=setTimeout((()=>{this.show()}),this.delayShow)})),this.alwaysShow||t.addEventListener("mouseleave",(t=>{this.delayShowTimeout&&clearTimeout(this.delayShowTimeout),this.initializeIfNecessary();const e=t.relatedTarget;this.toolbarElement.contains(e)||this.toolbarElement===e||this.hide()}))}delayShowTimeout=null;initializeIfNecessary(){if(this.initialized)return;const t=Vn.getNextToolbarId(),e=`${this.context.instance.id}-${this.context.contentBlockReference.id}-${t}`;this.toolbarElement=new eo(this.context).generate(),this.alwaysShow||this.toolbarElement.addEventListener("mouseleave",(t=>{const e=t.relatedTarget;this.hoverTag.contains(e)||this.hoverTag===e||this.hide()})),document.body.append(this.toolbarElement),this.toolbarElement.setAttribute(Vn.TagToolbarForAttr,e),this.hoverTag.setAttribute(Vn.TagToolbarAttr,e);const n=this.toolbarElement.style;n.position="absolute",this.alwaysShow||(n.display="none",n.transition="top 0.5s ease-out"),this.translator?.autoTranslateMenus(),this.initialized=!0,qn.raiseToolbarInitEvent(this.toolbarElement,this.hoverTag,this.context)}updatePosition(t){const e={top:"auto",left:"auto",right:"auto",viewportOffset:this.hoverTag.getBoundingClientRect().top,bodyOffset:Vn.getBodyScrollOffset(),tagScrollOffset:0,tagOffset:ye.offset(this.hoverTag),tagWidth:this.hoverTag.offsetWidth,tagHeight:this.hoverTag.offsetHeight,mousePos:Vn.mousePosition,win:{scrollY:window.scrollY,width:document.documentElement.clientWidth},padding:4};e.tagScrollOffset=Math.min(e.viewportOffset-e.bodyOffset.top,0),e.top=e.tagOffset.top+4-e.bodyOffset.top;const n=this.follow===Dn||"initial"===this.follow&&t||this.follow===Mn&&0!==e.tagScrollOffset,o=this.toolbarElement.classList;n?e.top=e.mousePos.y+e.win.scrollY-e.bodyOffset.top-10:o.contains("sc-tb-hover-middle")&&(e.top=e.top+e.tagHeight/2-20),o.contains("sc-tb-hover-right")?e.right=e.win.width-e.tagOffset.left-e.tagWidth+0-e.bodyOffset.left:e.left=e.tagOffset.left+4+e.bodyOffset.left;const r=this.toolbarElement.style;r.top="number"==typeof e.top?`${e.top}px`:e.top,r.left="number"==typeof e.left?`${e.left}px`:e.left,r.right="number"==typeof e.right?`${e.right}px`:e.right}hide(){this.alwaysShow||(this.toolbarElement.style.display="none",this.disableScrollWatcher())}show(){this.initializeIfNecessary(),this.toolbarElement.style.display="inline-flex",this.updatePosition(!0),this.activateScrollWatcher()}showPermanently(){this.show(),window.addEventListener("load",this.updateFn),document.addEventListener("readystatechange",this.updateFn),window.addEventListener("resize",this.updateFn)}watcherActive=!1;updateFn=()=>this.updatePosition(!1);activateScrollWatcher(){this.watcherActive||(this.follow===Mn||this.follow===Dn)&&(window.addEventListener("scroll",this.updateFn),this.follow===Dn&&window.addEventListener("mousemove",this.updateFn),this.watcherActive=!0)}disableScrollWatcher(){this.watcherActive&&(window.removeEventListener("scroll",this.updateFn),window.removeEventListener("mousemove",this.updateFn),this.watcherActive=!1)}}class Vn{static TagToolbarAttr="data-tagtoolbar";static TagToolbarForAttr="data-tagtoolbar-for";static mousePosition={x:0,y:0};static getNextToolbarId(){return Vn.lastMenuId++}static lastMenuId=0;static getBodyScrollOffset(){const t=document.body.style.position,e=document.body;if("relative"===t||"absolute"===t){const t=ye.offset(e);return{top:t.top,left:t.left}}return{top:0,left:0}}static cleanupOrphanedToolbars(){document.querySelectorAll(`[${Vn.TagToolbarForAttr}]`).forEach((t=>{const e=t.getAttribute(Vn.TagToolbarForAttr);document.querySelectorAll(`[${Vn.TagToolbarAttr}="${e}"]`).length||t.remove()}))}}window.addEventListener("mousemove",(t=>{Vn.mousePosition.x=t.clientX,Vn.mousePosition.y=t.clientY}));class zn{static getIndex(t){const e=an.is(t)?t.button.command.params:t;return e.index??e.sortOrder}}class Wn{name;params;command;constructor(t,e){this.name=t,this.params=e,e||(this.params={}),this.command=pn.singleton().get(t)}static mergeAdditionalParams(t,e){let n={};return t&&(t.name&&(n.action=t.name),t.params&&(n={...n,...t.params,...e})),t.params=n,n}}class Gn{id;command;classes="";constructor(t,e){this.command=t;const n=Gn.splitName(e);this.id=n.id,t?.command?.buttonDefaults&&ue.TypeSafeAssign(this,t.command.buttonDefaults)}static splitName(t){const e=t.split("=");return{id:e[0],name:e[1]||t}}configureLinkGenerator;tweakGeneratedUrlParameters;dialog;fullScreen;disabled;dynamicClasses;icon;inlineWindow=()=>!1;newWindow;showCondition;title;partOfPage;code;color;tippy;parameters;uiActionOnly;notes;noItems;static is(t){return void 0!==t.command}static isArray(t){return t.length&&Gn.is(t[0])}static isPropGen(t){return"function"==typeof t}}class Jn{button;context;constructor(t,e){this.button=t,this.context=e}action=()=>this.button.command;classes=()=>this.button.classes||"";color=()=>Kn(this.button.color,this.context,void 0);dialog=()=>Kn(this.button.dialog,this.context,this.button.command.name);disabled=()=>Kn(this.button.disabled,this.context,!1);dynamicClasses=()=>Kn(this.button.dynamicClasses,this.context,"");fullScreen=()=>Kn(this.button.fullScreen,this.context,!1);icon=()=>Kn(this.button.icon,this.context,"");inlineWindow=()=>Kn(this.button.inlineWindow,this.context,!1);newWindow=()=>Kn(this.button.newWindow,this.context,!1);parameters=()=>Kn(this.button.parameters,this.context,{});partOfPage=()=>Kn(this.button.partOfPage,this.context,!1);showCondition=()=>Kn(this.button.showCondition,this.context,!0);tippy=(t,e)=>this.button.tippy?.(t,e);title=()=>Kn(this.button.title,this.context,"unknown-title");uiActionOnly=()=>Kn(this.button.uiActionOnly,this.context,!0);noItems=()=>Kn(this.button.noItems,this.context,!1)}function Kn(t,e,n){if(null==t)return n;const o=Gn.isPropGen(t)?t(e):t;return void 0===o?n:o}class Qn{identifier;groups=[];settings;params;debug=!1;defaults;constructor(){this.identifier=Qn.createIdentifier()}static createIdentifier(){return"Toolbar"+Math.floor(99999*Math.random())}}class Xn extends re{parent;constructor(t,e){super(e,t.log),this.parent=t}}class Yn extends Xn{constructor(t){super(t,"Rnd.Button")}render(t,e){const n=this.log.call("render",`context: obj, group: ${e}, btn: ${t.button.id}/${t.button.command?.name}`),o=new Jn(t.button,t),r=an.getRule(t);r&&n.data("rule found, will try to merge params",r);let i=Wn.mergeAdditionalParams(o.action(),r?.params);r?.settings&&(i={...i,settings:r.settings});const s=t.toolbar?.groups?.[e],a=s?.name,l=document.createElement("a"),c=o.disabled();if(!c){const e=this.generateRunJs(r,t,i);l.setAttribute("onclick",e)}const u=(c?" disabled":"")+(o.action()?` sc-${o.action().name}`:"")+` in-group-${e}`+(a?` in-group-${a}`:"")+" "+(r?.ui.class??"")+" "+(r?.ui.classes??"")+" "+o.classes()+" "+o.dynamicClasses();n.add("classes: "+u),fn.addClasses(l,u),this.setTitle(r,l,o);const d=document.createElement("div");return d.appendChild(this.iconTag(o,r)),l.appendChild(d),this.processColorRules(o,r,t,d),o.tippy(t,l),n.return(l)}setTitle(t,e,n){const o=this.log.call("setTitles"),r=t?.ui?.title;if(r)if(0===r.indexOf("i18n:")){const t=r.substring(5);o.add(`i18nTitle: ${t}`),e.setAttribute("data-i18n",`[title]${t}`)}else o.add(`uiTitle: ${r}`),e.setAttribute("title",r);else{const t=n.title();o.add(`i18nTitle: ${t}`),t&&e.setAttribute("data-i18n",`[title]${t}`)}o.done()}processColorRules(t,e,n,o){const r=this.log.call("processColorRules");let i=e?.ui?.color??t.color()??n.toolbar.settings.color;if(i&&"number"==typeof i&&(i=i.toString()),i&&"string"==typeof i){const t=i.split(",");t[0]&&(o.style.background=Zn(t[0])),t[1]&&(o.style.color=Zn(t[1]))}return r.done(i??"no color")}generateRunJs(t,e,n){let o=t?.context;o=o&&0!==Object.keys(o).length?{...o,complete:!0}:void 0;const r=o?JSON.stringify(o):`${e.instance.id}, ${e.contentBlockReference.id}`;if("code"===n?.action){const{action:t,...e}=n,o={action:n.action,params:e};return`$2sxc(${r}).cms.run(${JSON.stringify(o)}, event);`}return`$2sxc(${r}).manage.run(${JSON.stringify(n)}, event);`}iconTag(t,e){const n=this.log.call("iconTag"),o=e?.ui?.icon||t.icon();if(o.indexOf("<svg")>-1){const t=document.createElement("template");return t.innerHTML=o,n.return(t.content.firstChild,o)}{const t=document.createElement("i");return fn.addClasses(t,o),t.setAttribute("aria-hidden","true"),n.return(t,o)}}}function Zn(t){return t&&t.match("^([A-Fa-f0-9]{6,8})$")?"#"+t:t}class to extends Xn{constructor(t){super(t,"Rnd.Groups")}generate(t){const e=this.log.call("generate");let n=[];const o=t.toolbar.groups;for(let e=0;e<o.length;e++)n=n.concat(this.generateGroup(o[e],t,e));return e.return(n,`total tags: ${n.length}`)}generateGroup(t,e,n){const o=this.log.call("generateGroup",`group #${n}`),r=[],i=t.buttons;for(let t=0;t<i.length;t++){const o=e.forButton(i[t]),s=this.parent.button.render(o,n),a=document.createElement("li");a.appendChild(s),r.push(a)}return o.return(r,`tags: ${r.length}`)}}class eo extends re{context;groups;button;constructor(t){super("Rnd.Toolbr"),this.context=t,ge.add("toolbar-render",t.toolbar?.identifier||"",this.log),this.groups=new to(this),this.button=new Yn(this)}render(){return this.log.call("render").return(this.generate().outerHTML)}generate(){const t=this.log.call("generate"),e=this.context;t.data("toolbar config",e.toolbar);const n=this.groups.generate(e),o=document.createElement("ul");o.setAttribute("toolbar-identifier",e.toolbar?.identifier),o.classList.add(Ve.cls.scMenu),o.classList.add("group-0");const r=e.toolbar.settings,i=r.hover?.split("-");i?.forEach((t=>o.classList.add(`sc-tb-hover-${t}`))),o.classList.add(`sc-tb-show-${r.show}`),-1===zn.getIndex(e.toolbar.params)&&o.classList.add("listContent"),e.toolbar.params.fields&&o.classList.add("sc-sublist"),fn.addClasses(o,r.class||r.classes),o.setAttribute("group-count",e.toolbar.groups.length.toString());for(let t=0;t<n.length;t++)o.appendChild(n[t]);return t.return(o,"done")}}function no(t){return no="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},no(t)}function oo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ro(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function io(t,e,n){return e&&ro(t.prototype,e),n&&ro(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function so(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ao(t,e){return ao=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ao(t,e)}function lo(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ao(t,e)}function co(t,e){if(e&&("object"===no(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return so(t)}function uo(t){return uo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},uo(t)}function po(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ho(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function fo(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function go(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?fo(Object(n),!0).forEach((function(e){po(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):fo(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var mo={type:"logger",log:function(t){this.output("log",t)},warn:function(t){this.output("warn",t)},error:function(t){this.output("error",t)},output:function(t,e){console&&console[t]&&console[t].apply(console,e)}},bo=new(function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};oo(this,t),this.init(e,n)}return io(t,[{key:"init",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=e.prefix||"i18next:",this.logger=t||mo,this.options=e,this.debug=e.debug}},{key:"setDebug",value:function(t){this.debug=t}},{key:"log",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"log","",!0)}},{key:"warn",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"warn","",!0)}},{key:"error",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"error","")}},{key:"deprecate",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}},{key:"forward",value:function(t,e,n,o){return o&&!this.debug?null:("string"==typeof t[0]&&(t[0]="".concat(n).concat(this.prefix," ").concat(t[0])),this.logger[e](t))}},{key:"create",value:function(e){return new t(this.logger,go(go({},{prefix:"".concat(this.prefix,":").concat(e,":")}),this.options))}}]),t}()),yo=function(){function t(){oo(this,t),this.observers={}}return io(t,[{key:"on",value:function(t,e){var n=this;return t.split(" ").forEach((function(t){n.observers[t]=n.observers[t]||[],n.observers[t].push(e)})),this}},{key:"off",value:function(t,e){this.observers[t]&&(e?this.observers[t]=this.observers[t].filter((function(t){return t!==e})):delete this.observers[t])}},{key:"emit",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];if(this.observers[t]){var r=[].concat(this.observers[t]);r.forEach((function(t){t.apply(void 0,n)}))}if(this.observers["*"]){var i=[].concat(this.observers["*"]);i.forEach((function(e){e.apply(e,[t].concat(n))}))}}}]),t}();function vo(){var t,e,n=new Promise((function(n,o){t=n,e=o}));return n.resolve=t,n.reject=e,n}function wo(t){return null==t?"":""+t}function xo(t,e,n){t.forEach((function(t){e[t]&&(n[t]=e[t])}))}function Oo(t,e,n){function o(t){return t&&t.indexOf("###")>-1?t.replace(/###/g,"."):t}function r(){return!t||"string"==typeof t}for(var i="string"!=typeof e?[].concat(e):e.split(".");i.length>1;){if(r())return{};var s=o(i.shift());!t[s]&&n&&(t[s]=new n),t=Object.prototype.hasOwnProperty.call(t,s)?t[s]:{}}return r()?{}:{obj:t,k:o(i.shift())}}function ko(t,e,n){var o=Oo(t,e,Object);o.obj[o.k]=n}function Co(t,e){var n=Oo(t,e),o=n.obj,r=n.k;if(o)return o[r]}function So(t,e,n){var o=Co(t,n);return void 0!==o?o:Co(e,n)}function Ao(t,e,n){for(var o in e)"__proto__"!==o&&"constructor"!==o&&(o in t?"string"==typeof t[o]||t[o]instanceof String||"string"==typeof e[o]||e[o]instanceof String?n&&(t[o]=e[o]):Ao(t[o],e[o],n):t[o]=e[o]);return t}function To(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var Io={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function Eo(t){return"string"==typeof t?t.replace(/[&<>"'\/]/g,(function(t){return Io[t]})):t}var Po="undefined"!=typeof window&&window.navigator&&void 0===window.navigator.userAgentData&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("MSIE")>-1,Lo=[" ",",","?","!",";"];function Do(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Mo(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Do(Object(n),!0).forEach((function(e){po(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Do(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function $o(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(t){if(t[e])return t[e];for(var o=e.split(n),r=t,i=0;i<o.length;++i){if(!r)return;if("string"==typeof r[o[i]]&&i+1<o.length)return;if(void 0===r[o[i]]){for(var s=2,a=o.slice(i,i+s).join(n),l=r[a];void 0===l&&o.length>i+s;)s++,l=r[a=o.slice(i,i+s).join(n)];if(void 0===l)return;if(null===l)return null;if(e.endsWith(a)){if("string"==typeof l)return l;if(a&&"string"==typeof l[a])return l[a]}var c=o.slice(i+s).join(n);return c?$o(l,c,n):void 0}r=r[o[i]]}return r}}var Ro=function(t){lo(r,t);var e,n,o=(e=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,o=uo(e);if(n){var r=uo(this).constructor;t=Reflect.construct(o,arguments,r)}else t=o.apply(this,arguments);return co(this,t)});function r(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};return oo(this,r),e=o.call(this),Po&&yo.call(so(e)),e.data=t||{},e.options=n,void 0===e.options.keySeparator&&(e.options.keySeparator="."),void 0===e.options.ignoreJSONStructure&&(e.options.ignoreJSONStructure=!0),e}return io(r,[{key:"addNamespaces",value:function(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}},{key:"removeNamespaces",value:function(t){var e=this.options.ns.indexOf(t);e>-1&&this.options.ns.splice(e,1)}},{key:"getResource",value:function(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=void 0!==o.keySeparator?o.keySeparator:this.options.keySeparator,i=void 0!==o.ignoreJSONStructure?o.ignoreJSONStructure:this.options.ignoreJSONStructure,s=[t,e];n&&"string"!=typeof n&&(s=s.concat(n)),n&&"string"==typeof n&&(s=s.concat(r?n.split(r):n)),t.indexOf(".")>-1&&(s=t.split("."));var a=Co(this.data,s);return a||!i||"string"!=typeof n?a:$o(this.data&&this.data[t]&&this.data[t][e],n,r)}},{key:"addResource",value:function(t,e,n,o){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1},i=this.options.keySeparator;void 0===i&&(i=".");var s=[t,e];n&&(s=s.concat(i?n.split(i):n)),t.indexOf(".")>-1&&(o=e,e=(s=t.split("."))[1]),this.addNamespaces(e),ko(this.data,s,o),r.silent||this.emit("added",t,e,n,o)}},{key:"addResources",value:function(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(var r in n)"string"!=typeof n[r]&&"[object Array]"!==Object.prototype.toString.apply(n[r])||this.addResource(t,e,r,n[r],{silent:!0});o.silent||this.emit("added",t,e,n)}},{key:"addResourceBundle",value:function(t,e,n,o,r){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1},s=[t,e];t.indexOf(".")>-1&&(o=n,n=e,e=(s=t.split("."))[1]),this.addNamespaces(e);var a=Co(this.data,s)||{};o?Ao(a,n,r):a=Mo(Mo({},a),n),ko(this.data,s,a),i.silent||this.emit("added",t,e,n)}},{key:"removeResourceBundle",value:function(t,e){this.hasResourceBundle(t,e)&&delete this.data[t][e],this.removeNamespaces(e),this.emit("removed",t,e)}},{key:"hasResourceBundle",value:function(t,e){return void 0!==this.getResource(t,e)}},{key:"getResourceBundle",value:function(t,e){return e||(e=this.options.defaultNS),"v1"===this.options.compatibilityAPI?Mo(Mo({},{}),this.getResource(t,e)):this.getResource(t,e)}},{key:"getDataByLanguage",value:function(t){return this.data[t]}},{key:"hasLanguageSomeTranslations",value:function(t){var e=this.getDataByLanguage(t);return!!(e&&Object.keys(e)||[]).find((function(t){return e[t]&&Object.keys(e[t]).length>0}))}},{key:"toJSON",value:function(){return this.data}}]),r}(yo),jo={processors:{},addPostProcessor:function(t){this.processors[t.name]=t},handle:function(t,e,n,o,r){var i=this;return t.forEach((function(t){i.processors[t]&&(e=i.processors[t].process(e,n,o,r))})),e}};function Bo(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function No(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Bo(Object(n),!0).forEach((function(e){po(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Bo(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Fo={},Ho=function(t){lo(r,t);var e,n,o=(e=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,o=uo(e);if(n){var r=uo(this).constructor;t=Reflect.construct(o,arguments,r)}else t=o.apply(this,arguments);return co(this,t)});function r(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return oo(this,r),e=o.call(this),Po&&yo.call(so(e)),xo(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],t,so(e)),e.options=n,void 0===e.options.keySeparator&&(e.options.keySeparator="."),e.logger=bo.create("translator"),e}return io(r,[{key:"changeLanguage",value:function(t){t&&(this.language=t)}},{key:"exists",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};if(null==t)return!1;var n=this.resolve(t,e);return n&&void 0!==n.res}},{key:"extractFromKey",value:function(t,e){var n=void 0!==e.nsSeparator?e.nsSeparator:this.options.nsSeparator;void 0===n&&(n=":");var o=void 0!==e.keySeparator?e.keySeparator:this.options.keySeparator,r=e.ns||this.options.defaultNS||[],i=n&&t.indexOf(n)>-1,s=!(this.options.userDefinedKeySeparator||e.keySeparator||this.options.userDefinedNsSeparator||e.nsSeparator||function(t,e,n){e=e||"",n=n||"";var o=Lo.filter((function(t){return e.indexOf(t)<0&&n.indexOf(t)<0}));if(0===o.length)return!0;var r=new RegExp("(".concat(o.map((function(t){return"?"===t?"\\?":t})).join("|"),")")),i=!r.test(t);if(!i){var s=t.indexOf(n);s>0&&!r.test(t.substring(0,s))&&(i=!0)}return i}(t,n,o));if(i&&!s){var a=t.match(this.interpolator.nestingRegexp);if(a&&a.length>0)return{key:t,namespaces:r};var l=t.split(n);(n!==o||n===o&&this.options.ns.indexOf(l[0])>-1)&&(r=l.shift()),t=l.join(o)}return"string"==typeof r&&(r=[r]),{key:t,namespaces:r}}},{key:"translate",value:function(t,e,n){var o=this;if("object"!==no(e)&&this.options.overloadTranslationOptionHandler&&(e=this.options.overloadTranslationOptionHandler(arguments)),e||(e={}),null==t)return"";Array.isArray(t)||(t=[String(t)]);var i=void 0!==e.returnDetails?e.returnDetails:this.options.returnDetails,s=void 0!==e.keySeparator?e.keySeparator:this.options.keySeparator,a=this.extractFromKey(t[t.length-1],e),l=a.key,c=a.namespaces,u=c[c.length-1],d=e.lng||this.language,p=e.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(d&&"cimode"===d.toLowerCase()){if(p){var h=e.nsSeparator||this.options.nsSeparator;return i?(f.res="".concat(u).concat(h).concat(l),f):"".concat(u).concat(h).concat(l)}return i?(f.res=l,f):l}var f=this.resolve(t,e),g=f&&f.res,m=f&&f.usedKey||l,b=f&&f.exactUsedKey||l,y=Object.prototype.toString.apply(g),v=["[object Number]","[object Function]","[object RegExp]"],w=void 0!==e.joinArrays?e.joinArrays:this.options.joinArrays,x=!this.i18nFormat||this.i18nFormat.handleAsObject,O="string"!=typeof g&&"boolean"!=typeof g&&"number"!=typeof g;if(x&&g&&O&&v.indexOf(y)<0&&("string"!=typeof w||"[object Array]"!==y)){if(!e.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");var k=this.options.returnedObjectHandler?this.options.returnedObjectHandler(m,g,No(No({},e),{},{ns:c})):"key '".concat(l," (").concat(this.language,")' returned an object instead of string.");return i?(f.res=k,f):k}if(s){var C="[object Array]"===y,S=C?[]:{},A=C?b:m;for(var T in g)if(Object.prototype.hasOwnProperty.call(g,T)){var I="".concat(A).concat(s).concat(T);S[T]=this.translate(I,No(No({},e),{joinArrays:!1,ns:c})),S[T]===I&&(S[T]=g[T])}g=S}}else if(x&&"string"==typeof w&&"[object Array]"===y)(g=g.join(w))&&(g=this.extendTranslation(g,t,e,n));else{var E=!1,P=!1,L=void 0!==e.count&&"string"!=typeof e.count,D=r.hasDefaultValue(e),M=L?this.pluralResolver.getSuffix(d,e.count,e):"",$=e["defaultValue".concat(M)]||e.defaultValue;!this.isValidLookup(g)&&D&&(E=!0,g=$),this.isValidLookup(g)||(P=!0,g=l);var R=e.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey,j=R&&P?void 0:g,B=D&&$!==g&&this.options.updateMissing;if(P||E||B){if(this.logger.log(B?"updateKey":"missingKey",d,u,l,B?$:g),s){var N=this.resolve(l,No(No({},e),{},{keySeparator:!1}));N&&N.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}var F=[],H=this.languageUtils.getFallbackCodes(this.options.fallbackLng,e.lng||this.language);if("fallback"===this.options.saveMissingTo&&H&&H[0])for(var _=0;_<H.length;_++)F.push(H[_]);else"all"===this.options.saveMissingTo?F=this.languageUtils.toResolveHierarchy(e.lng||this.language):F.push(e.lng||this.language);var q=function(t,n,r){var i=D&&r!==g?r:j;o.options.missingKeyHandler?o.options.missingKeyHandler(t,u,n,i,B,e):o.backendConnector&&o.backendConnector.saveMissing&&o.backendConnector.saveMissing(t,u,n,i,B,e),o.emit("missingKey",t,u,n,g)};this.options.saveMissing&&(this.options.saveMissingPlurals&&L?F.forEach((function(t){o.pluralResolver.getSuffixes(t,e).forEach((function(n){q([t],l+n,e["defaultValue".concat(n)]||$)}))})):q(F,l,$))}g=this.extendTranslation(g,t,e,f,n),P&&g===l&&this.options.appendNamespaceToMissingKey&&(g="".concat(u,":").concat(l)),(P||E)&&this.options.parseMissingKeyHandler&&(g="v1"!==this.options.compatibilityAPI?this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?"".concat(u,":").concat(l):l,E?g:void 0):this.options.parseMissingKeyHandler(g))}return i?(f.res=g,f):g}},{key:"extendTranslation",value:function(t,e,n,o,r){var i=this;if(this.i18nFormat&&this.i18nFormat.parse)t=this.i18nFormat.parse(t,No(No({},this.options.interpolation.defaultVariables),n),o.usedLng,o.usedNS,o.usedKey,{resolved:o});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init(No(No({},n),{interpolation:No(No({},this.options.interpolation),n.interpolation)}));var s,a="string"==typeof t&&(n&&n.interpolation&&void 0!==n.interpolation.skipOnVariables?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);if(a){var l=t.match(this.interpolator.nestingRegexp);s=l&&l.length}var c=n.replace&&"string"!=typeof n.replace?n.replace:n;if(this.options.interpolation.defaultVariables&&(c=No(No({},this.options.interpolation.defaultVariables),c)),t=this.interpolator.interpolate(t,c,n.lng||this.language,n),a){var u=t.match(this.interpolator.nestingRegexp);s<(u&&u.length)&&(n.nest=!1)}!1!==n.nest&&(t=this.interpolator.nest(t,(function(){for(var t=arguments.length,o=new Array(t),s=0;s<t;s++)o[s]=arguments[s];return r&&r[0]===o[0]&&!n.context?(i.logger.warn("It seems you are nesting recursively key: ".concat(o[0]," in key: ").concat(e[0])),null):i.translate.apply(i,o.concat([e]))}),n)),n.interpolation&&this.interpolator.reset()}var d=n.postProcess||this.options.postProcess,p="string"==typeof d?[d]:d;return null!=t&&p&&p.length&&!1!==n.applyPostProcessor&&(t=jo.handle(p,t,e,this.options&&this.options.postProcessPassResolved?No({i18nResolved:o},n):n,this)),t}},{key:"resolve",value:function(t){var e,n,o,r,i,s=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"==typeof t&&(t=[t]),t.forEach((function(t){if(!s.isValidLookup(e)){var l=s.extractFromKey(t,a),c=l.key;n=c;var u=l.namespaces;s.options.fallbackNS&&(u=u.concat(s.options.fallbackNS));var d=void 0!==a.count&&"string"!=typeof a.count,p=d&&!a.ordinal&&0===a.count&&s.pluralResolver.shouldUseIntlApi(),h=void 0!==a.context&&("string"==typeof a.context||"number"==typeof a.context)&&""!==a.context,f=a.lngs?a.lngs:s.languageUtils.toResolveHierarchy(a.lng||s.language,a.fallbackLng);u.forEach((function(t){s.isValidLookup(e)||(i=t,!Fo["".concat(f[0],"-").concat(t)]&&s.utils&&s.utils.hasLoadedNamespace&&!s.utils.hasLoadedNamespace(i)&&(Fo["".concat(f[0],"-").concat(t)]=!0,s.logger.warn('key "'.concat(n,'" for languages "').concat(f.join(", "),'" won\'t get resolved as namespace "').concat(i,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),f.forEach((function(n){if(!s.isValidLookup(e)){r=n;var i,l=[c];if(s.i18nFormat&&s.i18nFormat.addLookupKeys)s.i18nFormat.addLookupKeys(l,c,n,t,a);else{var u;d&&(u=s.pluralResolver.getSuffix(n,a.count,a));var f="".concat(s.options.pluralSeparator,"zero");if(d&&(l.push(c+u),p&&l.push(c+f)),h){var g="".concat(c).concat(s.options.contextSeparator).concat(a.context);l.push(g),d&&(l.push(g+u),p&&l.push(g+f))}}for(;i=l.pop();)s.isValidLookup(e)||(o=i,e=s.getResource(n,t,i,a))}})))}))}})),{res:e,usedKey:n,exactUsedKey:o,usedLng:r,usedNS:i}}},{key:"isValidLookup",value:function(t){return!(void 0===t||!this.options.returnNull&&null===t||!this.options.returnEmptyString&&""===t)}},{key:"getResource",value:function(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(t,e,n,o):this.resourceStore.getResource(t,e,n,o)}}],[{key:"hasDefaultValue",value:function(t){var e="defaultValue";for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e===n.substring(0,e.length)&&void 0!==t[n])return!0;return!1}}]),r}(yo);function _o(t){return t.charAt(0).toUpperCase()+t.slice(1)}var qo=function(){function t(e){oo(this,t),this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=bo.create("languageUtils")}return io(t,[{key:"getScriptPartFromCode",value:function(t){if(!t||t.indexOf("-")<0)return null;var e=t.split("-");return 2===e.length?null:(e.pop(),"x"===e[e.length-1].toLowerCase()?null:this.formatLanguageCode(e.join("-")))}},{key:"getLanguagePartFromCode",value:function(t){if(!t||t.indexOf("-")<0)return t;var e=t.split("-");return this.formatLanguageCode(e[0])}},{key:"formatLanguageCode",value:function(t){if("string"==typeof t&&t.indexOf("-")>-1){var e=["hans","hant","latn","cyrl","cans","mong","arab"],n=t.split("-");return this.options.lowerCaseLng?n=n.map((function(t){return t.toLowerCase()})):2===n.length?(n[0]=n[0].toLowerCase(),n[1]=n[1].toUpperCase(),e.indexOf(n[1].toLowerCase())>-1&&(n[1]=_o(n[1].toLowerCase()))):3===n.length&&(n[0]=n[0].toLowerCase(),2===n[1].length&&(n[1]=n[1].toUpperCase()),"sgn"!==n[0]&&2===n[2].length&&(n[2]=n[2].toUpperCase()),e.indexOf(n[1].toLowerCase())>-1&&(n[1]=_o(n[1].toLowerCase())),e.indexOf(n[2].toLowerCase())>-1&&(n[2]=_o(n[2].toLowerCase()))),n.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}},{key:"isSupportedCode",value:function(t){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}},{key:"getBestMatchFromCodes",value:function(t){var e,n=this;return t?(t.forEach((function(t){if(!e){var o=n.formatLanguageCode(t);n.options.supportedLngs&&!n.isSupportedCode(o)||(e=o)}})),!e&&this.options.supportedLngs&&t.forEach((function(t){if(!e){var o=n.getLanguagePartFromCode(t);if(n.isSupportedCode(o))return e=o;e=n.options.supportedLngs.find((function(t){if(0===t.indexOf(o))return t}))}})),e||(e=this.getFallbackCodes(this.options.fallbackLng)[0]),e):null}},{key:"getFallbackCodes",value:function(t,e){if(!t)return[];if("function"==typeof t&&(t=t(e)),"string"==typeof t&&(t=[t]),"[object Array]"===Object.prototype.toString.apply(t))return t;if(!e)return t.default||[];var n=t[e];return n||(n=t[this.getScriptPartFromCode(e)]),n||(n=t[this.formatLanguageCode(e)]),n||(n=t[this.getLanguagePartFromCode(e)]),n||(n=t.default),n||[]}},{key:"toResolveHierarchy",value:function(t,e){var n=this,o=this.getFallbackCodes(e||this.options.fallbackLng||[],t),r=[],i=function(t){t&&(n.isSupportedCode(t)?r.push(t):n.logger.warn("rejecting language code not found in supportedLngs: ".concat(t)))};return"string"==typeof t&&t.indexOf("-")>-1?("languageOnly"!==this.options.load&&i(this.formatLanguageCode(t)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&i(this.getScriptPartFromCode(t)),"currentOnly"!==this.options.load&&i(this.getLanguagePartFromCode(t))):"string"==typeof t&&i(this.formatLanguageCode(t)),o.forEach((function(t){r.indexOf(t)<0&&i(n.formatLanguageCode(t))})),r}}]),t}(),Uo=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],Vo={1:function(t){return Number(t>1)},2:function(t){return Number(1!=t)},3:function(t){return 0},4:function(t){return Number(t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2)},5:function(t){return Number(0==t?0:1==t?1:2==t?2:t%100>=3&&t%100<=10?3:t%100>=11?4:5)},6:function(t){return Number(1==t?0:t>=2&&t<=4?1:2)},7:function(t){return Number(1==t?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2)},8:function(t){return Number(1==t?0:2==t?1:8!=t&&11!=t?2:3)},9:function(t){return Number(t>=2)},10:function(t){return Number(1==t?0:2==t?1:t<7?2:t<11?3:4)},11:function(t){return Number(1==t||11==t?0:2==t||12==t?1:t>2&&t<20?2:3)},12:function(t){return Number(t%10!=1||t%100==11)},13:function(t){return Number(0!==t)},14:function(t){return Number(1==t?0:2==t?1:3==t?2:3)},15:function(t){return Number(t%10==1&&t%100!=11?0:t%10>=2&&(t%100<10||t%100>=20)?1:2)},16:function(t){return Number(t%10==1&&t%100!=11?0:0!==t?1:2)},17:function(t){return Number(1==t||t%10==1&&t%100!=11?0:1)},18:function(t){return Number(0==t?0:1==t?1:2)},19:function(t){return Number(1==t?0:0==t||t%100>1&&t%100<11?1:t%100>10&&t%100<20?2:3)},20:function(t){return Number(1==t?0:0==t||t%100>0&&t%100<20?1:2)},21:function(t){return Number(t%100==1?1:t%100==2?2:t%100==3||t%100==4?3:0)},22:function(t){return Number(1==t?0:2==t?1:(t<0||t>10)&&t%10==0?2:3)}},zo=["v1","v2","v3"],Wo={zero:0,one:1,two:2,few:3,many:4,other:5};function Go(){var t={};return Uo.forEach((function(e){e.lngs.forEach((function(n){t[n]={numbers:e.nr,plurals:Vo[e.fc]}}))})),t}var Jo=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};oo(this,t),this.languageUtils=e,this.options=n,this.logger=bo.create("pluralResolver"),this.options.compatibilityJSON&&"v4"!==this.options.compatibilityJSON||"undefined"!=typeof Intl&&Intl.PluralRules||(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=Go()}return io(t,[{key:"addRule",value:function(t,e){this.rules[t]=e}},{key:"getRule",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.shouldUseIntlApi())try{return new Intl.PluralRules(t,{type:e.ordinal?"ordinal":"cardinal"})}catch(t){return}return this.rules[t]||this.rules[this.languageUtils.getLanguagePartFromCode(t)]}},{key:"needsPlural",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getRule(t,e);return this.shouldUseIntlApi()?n&&n.resolvedOptions().pluralCategories.length>1:n&&n.numbers.length>1}},{key:"getPluralFormsOfKey",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.getSuffixes(t,n).map((function(t){return"".concat(e).concat(t)}))}},{key:"getSuffixes",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=this.getRule(t,n);return o?this.shouldUseIntlApi()?o.resolvedOptions().pluralCategories.sort((function(t,e){return Wo[t]-Wo[e]})).map((function(t){return"".concat(e.options.prepend).concat(t)})):o.numbers.map((function(o){return e.getSuffix(t,o,n)})):[]}},{key:"getSuffix",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=this.getRule(t,n);return o?this.shouldUseIntlApi()?"".concat(this.options.prepend).concat(o.select(e)):this.getSuffixRetroCompatible(o,e):(this.logger.warn("no plural rule found for: ".concat(t)),"")}},{key:"getSuffixRetroCompatible",value:function(t,e){var n=this,o=t.noAbs?t.plurals(e):t.plurals(Math.abs(e)),r=t.numbers[o];this.options.simplifyPluralSuffix&&2===t.numbers.length&&1===t.numbers[0]&&(2===r?r="plural":1===r&&(r=""));var i=function(){return n.options.prepend&&r.toString()?n.options.prepend+r.toString():r.toString()};return"v1"===this.options.compatibilityJSON?1===r?"":"number"==typeof r?"_plural_".concat(r.toString()):i():"v2"===this.options.compatibilityJSON||this.options.simplifyPluralSuffix&&2===t.numbers.length&&1===t.numbers[0]?i():this.options.prepend&&o.toString()?this.options.prepend+o.toString():o.toString()}},{key:"shouldUseIntlApi",value:function(){return!zo.includes(this.options.compatibilityJSON)}}]),t}();function Ko(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Qo(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ko(Object(n),!0).forEach((function(e){po(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ko(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Xo=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};oo(this,t),this.logger=bo.create("interpolator"),this.options=e,this.format=e.interpolation&&e.interpolation.format||function(t){return t},this.init(e)}return io(t,[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.interpolation||(t.interpolation={escapeValue:!0});var e=t.interpolation;this.escape=void 0!==e.escape?e.escape:Eo,this.escapeValue=void 0===e.escapeValue||e.escapeValue,this.useRawValueToEscape=void 0!==e.useRawValueToEscape&&e.useRawValueToEscape,this.prefix=e.prefix?To(e.prefix):e.prefixEscaped||"{{",this.suffix=e.suffix?To(e.suffix):e.suffixEscaped||"}}",this.formatSeparator=e.formatSeparator?e.formatSeparator:e.formatSeparator||",",this.unescapePrefix=e.unescapeSuffix?"":e.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":e.unescapeSuffix||"",this.nestingPrefix=e.nestingPrefix?To(e.nestingPrefix):e.nestingPrefixEscaped||To("$t("),this.nestingSuffix=e.nestingSuffix?To(e.nestingSuffix):e.nestingSuffixEscaped||To(")"),this.nestingOptionsSeparator=e.nestingOptionsSeparator?e.nestingOptionsSeparator:e.nestingOptionsSeparator||",",this.maxReplaces=e.maxReplaces?e.maxReplaces:1e3,this.alwaysFormat=void 0!==e.alwaysFormat&&e.alwaysFormat,this.resetRegExp()}},{key:"reset",value:function(){this.options&&this.init(this.options)}},{key:"resetRegExp",value:function(){var t="".concat(this.prefix,"(.+?)").concat(this.suffix);this.regexp=new RegExp(t,"g");var e="".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix);this.regexpUnescape=new RegExp(e,"g");var n="".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix);this.nestingRegexp=new RegExp(n,"g")}},{key:"interpolate",value:function(t,e,n,o){var r,i,s,a=this,l=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function c(t){return t.replace(/\$/g,"$$$$")}var u=function(t){if(t.indexOf(a.formatSeparator)<0){var r=So(e,l,t);return a.alwaysFormat?a.format(r,void 0,n,Qo(Qo(Qo({},o),e),{},{interpolationkey:t})):r}var i=t.split(a.formatSeparator),s=i.shift().trim(),c=i.join(a.formatSeparator).trim();return a.format(So(e,l,s),c,n,Qo(Qo(Qo({},o),e),{},{interpolationkey:s}))};this.resetRegExp();var d=o&&o.missingInterpolationHandler||this.options.missingInterpolationHandler,p=o&&o.interpolation&&void 0!==o.interpolation.skipOnVariables?o.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:function(t){return c(t)}},{regex:this.regexp,safeValue:function(t){return a.escapeValue?c(a.escape(t)):c(t)}}].forEach((function(e){for(s=0;r=e.regex.exec(t);){var n=r[1].trim();if(void 0===(i=u(n)))if("function"==typeof d){var l=d(t,r,o);i="string"==typeof l?l:""}else if(o&&o.hasOwnProperty(n))i="";else{if(p){i=r[0];continue}a.logger.warn("missed to pass in variable ".concat(n," for interpolating ").concat(t)),i=""}else"string"==typeof i||a.useRawValueToEscape||(i=wo(i));var c=e.safeValue(i);if(t=t.replace(r[0],c),p?(e.regex.lastIndex+=i.length,e.regex.lastIndex-=r[0].length):e.regex.lastIndex=0,++s>=a.maxReplaces)break}})),t}},{key:"nest",value:function(t,e){var n,o,r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=Qo({},i);function a(t,e){var n=this.nestingOptionsSeparator;if(t.indexOf(n)<0)return t;var o=t.split(new RegExp("".concat(n,"[ ]*{"))),r="{".concat(o[1]);t=o[0],r=(r=this.interpolate(r,s)).replace(/'/g,'"');try{s=JSON.parse(r),e&&(s=Qo(Qo({},e),s))}catch(e){return this.logger.warn("failed parsing options string in nesting for key ".concat(t),e),"".concat(t).concat(n).concat(r)}return delete s.defaultValue,t}for(s.applyPostProcessor=!1,delete s.defaultValue;n=this.nestingRegexp.exec(t);){var l=[],c=!1;if(-1!==n[0].indexOf(this.formatSeparator)&&!/{.*}/.test(n[1])){var u=n[1].split(this.formatSeparator).map((function(t){return t.trim()}));n[1]=u.shift(),l=u,c=!0}if((o=e(a.call(this,n[1].trim(),s),s))&&n[0]===t&&"string"!=typeof o)return o;"string"!=typeof o&&(o=wo(o)),o||(this.logger.warn("missed to resolve ".concat(n[1]," for nesting ").concat(t)),o=""),c&&(o=l.reduce((function(t,e){return r.format(t,e,i.lng,Qo(Qo({},i),{},{interpolationkey:n[1].trim()}))}),o.trim())),t=t.replace(n[0],o),this.regexp.lastIndex=0}return t}}]),t}();function Yo(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Zo(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Yo(Object(n),!0).forEach((function(e){po(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Yo(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var tr=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};oo(this,t),this.logger=bo.create("formatter"),this.options=e,this.formats={number:function(t,e,n){return new Intl.NumberFormat(e,n).format(t)},currency:function(t,e,n){return new Intl.NumberFormat(e,Zo(Zo({},n),{},{style:"currency"})).format(t)},datetime:function(t,e,n){return new Intl.DateTimeFormat(e,Zo({},n)).format(t)},relativetime:function(t,e,n){return new Intl.RelativeTimeFormat(e,Zo({},n)).format(t,n.range||"day")},list:function(t,e,n){return new Intl.ListFormat(e,Zo({},n)).format(t)}},this.init(e)}return io(t,[{key:"init",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}},n=e.interpolation;this.formatSeparator=n.formatSeparator?n.formatSeparator:n.formatSeparator||","}},{key:"add",value:function(t,e){this.formats[t.toLowerCase().trim()]=e}},{key:"format",value:function(t,e,n,o){var r=this;return e.split(this.formatSeparator).reduce((function(t,e){var i=function(t){var e=t.toLowerCase().trim(),n={};if(t.indexOf("(")>-1){var o=t.split("(");e=o[0].toLowerCase().trim();var r=o[1].substring(0,o[1].length-1);"currency"===e&&r.indexOf(":")<0?n.currency||(n.currency=r.trim()):"relativetime"===e&&r.indexOf(":")<0?n.range||(n.range=r.trim()):r.split(";").forEach((function(t){if(t){var e=function(t){return function(t){if(Array.isArray(t))return t}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return ho(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ho(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t.split(":")),o=e[0],r=e.slice(1).join(":").trim().replace(/^'+|'+$/g,"");n[o.trim()]||(n[o.trim()]=r),"false"===r&&(n[o.trim()]=!1),"true"===r&&(n[o.trim()]=!0),isNaN(r)||(n[o.trim()]=parseInt(r,10))}}))}return{formatName:e,formatOptions:n}}(e),s=i.formatName,a=i.formatOptions;if(r.formats[s]){var l=t;try{var c=o&&o.formatParams&&o.formatParams[o.interpolationkey]||{},u=c.locale||c.lng||o.locale||o.lng||n;l=r.formats[s](t,u,Zo(Zo(Zo({},a),o),c))}catch(t){r.logger.warn(t)}return l}return r.logger.warn("there was no format function for ".concat(s)),t}),t)}}]),t}();function er(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function nr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?er(Object(n),!0).forEach((function(e){po(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):er(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var or=function(t){lo(r,t);var e,n,o=(e=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,o=uo(e);if(n){var r=uo(this).constructor;t=Reflect.construct(o,arguments,r)}else t=o.apply(this,arguments);return co(this,t)});function r(t,e,n){var i,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return oo(this,r),i=o.call(this),Po&&yo.call(so(i)),i.backend=t,i.store=e,i.services=n,i.languageUtils=n.languageUtils,i.options=s,i.logger=bo.create("backendConnector"),i.waitingReads=[],i.maxParallelReads=s.maxParallelReads||10,i.readingCalls=0,i.maxRetries=s.maxRetries>=0?s.maxRetries:5,i.retryTimeout=s.retryTimeout>=1?s.retryTimeout:350,i.state={},i.queue=[],i.backend&&i.backend.init&&i.backend.init(n,s.backend,s),i}return io(r,[{key:"queueLoad",value:function(t,e,n,o){var r=this,i={},s={},a={},l={};return t.forEach((function(t){var o=!0;e.forEach((function(e){var a="".concat(t,"|").concat(e);!n.reload&&r.store.hasResourceBundle(t,e)?r.state[a]=2:r.state[a]<0||(1===r.state[a]?void 0===s[a]&&(s[a]=!0):(r.state[a]=1,o=!1,void 0===s[a]&&(s[a]=!0),void 0===i[a]&&(i[a]=!0),void 0===l[e]&&(l[e]=!0)))})),o||(a[t]=!0)})),(Object.keys(i).length||Object.keys(s).length)&&this.queue.push({pending:s,pendingCount:Object.keys(s).length,loaded:{},errors:[],callback:o}),{toLoad:Object.keys(i),pending:Object.keys(s),toLoadLanguages:Object.keys(a),toLoadNamespaces:Object.keys(l)}}},{key:"loaded",value:function(t,e,n){var o=t.split("|"),r=o[0],i=o[1];e&&this.emit("failedLoading",r,i,e),n&&this.store.addResourceBundle(r,i,n),this.state[t]=e?-1:2;var s={};this.queue.forEach((function(n){var o,a,l,c,u;o=n.loaded,a=i,(c=(l=Oo(o,[r],Object)).obj)[u=l.k]=c[u]||[],c[u].push(a),function(t,e){void 0!==t.pending[e]&&(delete t.pending[e],t.pendingCount--)}(n,t),e&&n.errors.push(e),0!==n.pendingCount||n.done||(Object.keys(n.loaded).forEach((function(t){s[t]||(s[t]={});var e=n.loaded[t];e.length&&e.forEach((function(e){void 0===s[t][e]&&(s[t][e]=!0)}))})),n.done=!0,n.errors.length?n.callback(n.errors):n.callback())})),this.emit("loaded",s),this.queue=this.queue.filter((function(t){return!t.done}))}},{key:"read",value:function(t,e,n){var o=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.retryTimeout,s=arguments.length>5?arguments[5]:void 0;return t.length?this.readingCalls>=this.maxParallelReads?void this.waitingReads.push({lng:t,ns:e,fcName:n,tried:r,wait:i,callback:s}):(this.readingCalls++,this.backend[n](t,e,(function(a,l){if(o.readingCalls--,o.waitingReads.length>0){var c=o.waitingReads.shift();o.read(c.lng,c.ns,c.fcName,c.tried,c.wait,c.callback)}a&&l&&r<o.maxRetries?setTimeout((function(){o.read.call(o,t,e,n,r+1,2*i,s)}),i):s(a,l)}))):s(null,{})}},{key:"prepareLoading",value:function(t,e){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),r&&r();"string"==typeof t&&(t=this.languageUtils.toResolveHierarchy(t)),"string"==typeof e&&(e=[e]);var i=this.queueLoad(t,e,o,r);if(!i.toLoad.length)return i.pending.length||r(),null;i.toLoad.forEach((function(t){n.loadOne(t)}))}},{key:"load",value:function(t,e,n){this.prepareLoading(t,e,{},n)}},{key:"reload",value:function(t,e,n){this.prepareLoading(t,e,{reload:!0},n)}},{key:"loadOne",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=t.split("|"),r=o[0],i=o[1];this.read(r,i,"read",void 0,void 0,(function(o,s){o&&e.logger.warn("".concat(n,"loading namespace ").concat(i," for language ").concat(r," failed"),o),!o&&s&&e.logger.log("".concat(n,"loaded namespace ").concat(i," for language ").concat(r),s),e.loaded(t,o,s)}))}},{key:"saveMissing",value:function(t,e,n,o,r){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(e)?this.logger.warn('did not save key "'.concat(n,'" as the namespace "').concat(e,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!"):null!=n&&""!==n&&(this.backend&&this.backend.create&&this.backend.create(t,e,n,o,null,nr(nr({},i),{},{isUpdate:r})),t&&t[0]&&this.store.addResource(t[0],e,n,o))}}]),r}(yo);function rr(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(t){var e={};if("object"===no(t[1])&&(e=t[1]),"string"==typeof t[1]&&(e.defaultValue=t[1]),"string"==typeof t[2]&&(e.tDescription=t[2]),"object"===no(t[2])||"object"===no(t[3])){var n=t[3]||t[2];Object.keys(n).forEach((function(t){e[t]=n[t]}))}return e},interpolation:{escapeValue:!0,format:function(t,e,n,o){return t},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}}function ir(t){return"string"==typeof t.ns&&(t.ns=[t.ns]),"string"==typeof t.fallbackLng&&(t.fallbackLng=[t.fallbackLng]),"string"==typeof t.fallbackNS&&(t.fallbackNS=[t.fallbackNS]),t.supportedLngs&&t.supportedLngs.indexOf("cimode")<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),t}function sr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ar(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?sr(Object(n),!0).forEach((function(e){po(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):sr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function lr(){}function cr(t){Object.getOwnPropertyNames(Object.getPrototypeOf(t)).forEach((function(e){"function"==typeof t[e]&&(t[e]=t[e].bind(t))}))}var ur=function(t){lo(r,t);var e,n,o=(e=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,o=uo(e);if(n){var r=uo(this).constructor;t=Reflect.construct(o,arguments,r)}else t=o.apply(this,arguments);return co(this,t)});function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;if(oo(this,r),t=o.call(this),Po&&yo.call(so(t)),t.options=ir(e),t.services={},t.logger=bo,t.modules={external:[]},cr(so(t)),n&&!t.isInitialized&&!e.isClone){if(!t.options.initImmediate)return t.init(e,n),co(t,so(t));setTimeout((function(){t.init(e,n)}),0)}return t}return io(r,[{key:"init",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;"function"==typeof e&&(n=e,e={}),!e.defaultNS&&!1!==e.defaultNS&&e.ns&&("string"==typeof e.ns?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));var o=rr();function r(t){return t?"function"==typeof t?new t:t:null}if(this.options=ar(ar(ar({},o),this.options),ir(e)),"v1"!==this.options.compatibilityAPI&&(this.options.interpolation=ar(ar({},o.interpolation),this.options.interpolation)),void 0!==e.keySeparator&&(this.options.userDefinedKeySeparator=e.keySeparator),void 0!==e.nsSeparator&&(this.options.userDefinedNsSeparator=e.nsSeparator),!this.options.isClone){var i;this.modules.logger?bo.init(r(this.modules.logger),this.options):bo.init(null,this.options),this.modules.formatter?i=this.modules.formatter:"undefined"!=typeof Intl&&(i=tr);var s=new qo(this.options);this.store=new Ro(this.options.resources,this.options);var a=this.services;a.logger=bo,a.resourceStore=this.store,a.languageUtils=s,a.pluralResolver=new Jo(s,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),!i||this.options.interpolation.format&&this.options.interpolation.format!==o.interpolation.format||(a.formatter=r(i),a.formatter.init(a,this.options),this.options.interpolation.format=a.formatter.format.bind(a.formatter)),a.interpolator=new Xo(this.options),a.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},a.backendConnector=new or(r(this.modules.backend),a.resourceStore,a,this.options),a.backendConnector.on("*",(function(e){for(var n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];t.emit.apply(t,[e].concat(o))})),this.modules.languageDetector&&(a.languageDetector=r(this.modules.languageDetector),a.languageDetector.init(a,this.options.detection,this.options)),this.modules.i18nFormat&&(a.i18nFormat=r(this.modules.i18nFormat),a.i18nFormat.init&&a.i18nFormat.init(this)),this.translator=new Ho(this.services,this.options),this.translator.on("*",(function(e){for(var n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];t.emit.apply(t,[e].concat(o))})),this.modules.external.forEach((function(e){e.init&&e.init(t)}))}if(this.format=this.options.interpolation.format,n||(n=lr),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){var l=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);l.length>0&&"dev"!==l[0]&&(this.options.lng=l[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined");var c=["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"];c.forEach((function(e){t[e]=function(){var n;return(n=t.store)[e].apply(n,arguments)}}));var u=["addResource","addResources","addResourceBundle","removeResourceBundle"];u.forEach((function(e){t[e]=function(){var n;return(n=t.store)[e].apply(n,arguments),t}}));var d=vo(),p=function(){var e=function(e,o){t.isInitialized&&!t.initializedStoreOnce&&t.logger.warn("init: i18next is already initialized. You should call init just once!"),t.isInitialized=!0,t.options.isClone||t.logger.log("initialized",t.options),t.emit("initialized",t.options),d.resolve(o),n(e,o)};if(t.languages&&"v1"!==t.options.compatibilityAPI&&!t.isInitialized)return e(null,t.t.bind(t));t.changeLanguage(t.options.lng,e)};return this.options.resources||!this.options.initImmediate?p():setTimeout(p,0),d}},{key:"loadResources",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:lr,o=n,r="string"==typeof t?t:this.language;if("function"==typeof t&&(o=t),!this.options.resources||this.options.partialBundledLanguages){if(r&&"cimode"===r.toLowerCase())return o();var i=[],s=function(t){t&&e.services.languageUtils.toResolveHierarchy(t).forEach((function(t){i.indexOf(t)<0&&i.push(t)}))};if(r)s(r);else{var a=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);a.forEach((function(t){return s(t)}))}this.options.preload&&this.options.preload.forEach((function(t){return s(t)})),this.services.backendConnector.load(i,this.options.ns,(function(t){t||e.resolvedLanguage||!e.language||e.setResolvedLanguage(e.language),o(t)}))}else o(null)}},{key:"reloadResources",value:function(t,e,n){var o=vo();return t||(t=this.languages),e||(e=this.options.ns),n||(n=lr),this.services.backendConnector.reload(t,e,(function(t){o.resolve(),n(t)})),o}},{key:"use",value:function(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===t.type&&(this.modules.backend=t),("logger"===t.type||t.log&&t.warn&&t.error)&&(this.modules.logger=t),"languageDetector"===t.type&&(this.modules.languageDetector=t),"i18nFormat"===t.type&&(this.modules.i18nFormat=t),"postProcessor"===t.type&&jo.addPostProcessor(t),"formatter"===t.type&&(this.modules.formatter=t),"3rdParty"===t.type&&this.modules.external.push(t),this}},{key:"setResolvedLanguage",value:function(t){if(t&&this.languages&&!(["cimode","dev"].indexOf(t)>-1))for(var e=0;e<this.languages.length;e++){var n=this.languages[e];if(!(["cimode","dev"].indexOf(n)>-1)&&this.store.hasLanguageSomeTranslations(n)){this.resolvedLanguage=n;break}}}},{key:"changeLanguage",value:function(t,e){var n=this;this.isLanguageChangingTo=t;var o=vo();this.emit("languageChanging",t);var r=function(t){n.language=t,n.languages=n.services.languageUtils.toResolveHierarchy(t),n.resolvedLanguage=void 0,n.setResolvedLanguage(t)},i=function(i){t||i||!n.services.languageDetector||(i=[]);var s="string"==typeof i?i:n.services.languageUtils.getBestMatchFromCodes(i);s&&(n.language||r(s),n.translator.language||n.translator.changeLanguage(s),n.services.languageDetector&&n.services.languageDetector.cacheUserLanguage(s)),n.loadResources(s,(function(t){!function(t,i){i?(r(i),n.translator.changeLanguage(i),n.isLanguageChangingTo=void 0,n.emit("languageChanged",i),n.logger.log("languageChanged",i)):n.isLanguageChangingTo=void 0,o.resolve((function(){return n.t.apply(n,arguments)})),e&&e(t,(function(){return n.t.apply(n,arguments)}))}(t,s)}))};return t||!this.services.languageDetector||this.services.languageDetector.async?!t&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect(i):i(t):i(this.services.languageDetector.detect()),o}},{key:"getFixedT",value:function(t,e,n){var o=this,r=function t(e,r){var i;if("object"!==no(r)){for(var s=arguments.length,a=new Array(s>2?s-2:0),l=2;l<s;l++)a[l-2]=arguments[l];i=o.options.overloadTranslationOptionHandler([e,r].concat(a))}else i=ar({},r);i.lng=i.lng||t.lng,i.lngs=i.lngs||t.lngs,i.ns=i.ns||t.ns,i.keyPrefix=i.keyPrefix||n||t.keyPrefix;var c=o.options.keySeparator||".",u=i.keyPrefix?"".concat(i.keyPrefix).concat(c).concat(e):e;return o.t(u,i)};return"string"==typeof t?r.lng=t:r.lngs=t,r.ns=e,r.keyPrefix=n,r}},{key:"t",value:function(){var t;return this.translator&&(t=this.translator).translate.apply(t,arguments)}},{key:"exists",value:function(){var t;return this.translator&&(t=this.translator).exists.apply(t,arguments)}},{key:"setDefaultNamespace",value:function(t){this.options.defaultNS=t}},{key:"hasLoadedNamespace",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;var o=this.resolvedLanguage||this.languages[0],r=!!this.options&&this.options.fallbackLng,i=this.languages[this.languages.length-1];if("cimode"===o.toLowerCase())return!0;var s=function(t,n){var o=e.services.backendConnector.state["".concat(t,"|").concat(n)];return-1===o||2===o};if(n.precheck){var a=n.precheck(this,s);if(void 0!==a)return a}return!(!this.hasResourceBundle(o,t)&&this.services.backendConnector.backend&&(!this.options.resources||this.options.partialBundledLanguages)&&(!s(o,t)||r&&!s(i,t)))}},{key:"loadNamespaces",value:function(t,e){var n=this,o=vo();return this.options.ns?("string"==typeof t&&(t=[t]),t.forEach((function(t){n.options.ns.indexOf(t)<0&&n.options.ns.push(t)})),this.loadResources((function(t){o.resolve(),e&&e(t)})),o):(e&&e(),Promise.resolve())}},{key:"loadLanguages",value:function(t,e){var n=vo();"string"==typeof t&&(t=[t]);var o=this.options.preload||[],r=t.filter((function(t){return o.indexOf(t)<0}));return r.length?(this.options.preload=o.concat(r),this.loadResources((function(t){n.resolve(),e&&e(t)})),n):(e&&e(),Promise.resolve())}},{key:"dir",value:function(t){return t||(t=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),t?["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf(this.services.languageUtils.getLanguagePartFromCode(t))>-1||t.toLowerCase().indexOf("-arab")>1?"rtl":"ltr":"rtl"}},{key:"cloneInstance",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:lr,o=ar(ar(ar({},this.options),e),{isClone:!0}),i=new r(o),s=["store","services","language"];return s.forEach((function(e){i[e]=t[e]})),i.services=ar({},this.services),i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i.translator=new Ho(i.services,i.options),i.translator.on("*",(function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];i.emit.apply(i,[t].concat(n))})),i.init(o,n),i.translator.options=i.options,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}},{key:"toJSON",value:function(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}]),r}(yo);po(ur,"createInstance",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;return new ur(t,e)}));var dr=ur.createInstance();dr.createInstance=ur.createInstance,dr.createInstance,dr.init,dr.loadResources,dr.reloadResources,dr.use,dr.changeLanguage,dr.getFixedT,dr.t,dr.exists,dr.setDefaultNamespace,dr.hasLoadedNamespace,dr.loadNamespaces,dr.loadLanguages;const pr=dr;function hr(t){return hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hr(t)}var fr=[],gr=fr.forEach,mr=fr.slice;function br(t){return gr.call(mr.call(arguments,1),(function(e){if(e)for(var n in e)void 0===t[n]&&(t[n]=e[n])})),t}function yr(){return"function"==typeof XMLHttpRequest||"object"===("undefined"==typeof XMLHttpRequest?"undefined":hr(XMLHttpRequest))}var vr,wr,xr,Or=r(154),kr=r.t(Or,2);function Cr(t){return Cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cr(t)}"function"==typeof fetch&&("undefined"!=typeof global&&global.fetch?vr=global.fetch:"undefined"!=typeof window&&window.fetch&&(vr=window.fetch)),yr()&&("undefined"!=typeof global&&global.XMLHttpRequest?wr=global.XMLHttpRequest:"undefined"!=typeof window&&window.XMLHttpRequest&&(wr=window.XMLHttpRequest)),"function"==typeof ActiveXObject&&("undefined"!=typeof global&&global.ActiveXObject?xr=global.ActiveXObject:"undefined"!=typeof window&&window.ActiveXObject&&(xr=window.ActiveXObject)),vr||!kr||wr||xr||(vr=Or||kr),"function"!=typeof vr&&(vr=void 0);var Sr=function(t,e){if(e&&"object"===Cr(e)){var n="";for(var o in e)n+="&"+encodeURIComponent(o)+"="+encodeURIComponent(e[o]);if(!n)return t;t=t+(-1!==t.indexOf("?")?"&":"?")+n.slice(1)}return t};const Ar=function(t,e,n,o){return"function"==typeof n&&(o=n,n=void 0),o=o||function(){},vr?function(t,e,n,o){t.queryStringParams&&(e=Sr(e,t.queryStringParams));var r=br({},"function"==typeof t.customHeaders?t.customHeaders():t.customHeaders);n&&(r["Content-Type"]="application/json"),vr(e,br({method:n?"POST":"GET",body:n?t.stringify(n):void 0,headers:r},"function"==typeof t.requestOptions?t.requestOptions(n):t.requestOptions)).then((function(t){if(!t.ok)return o(t.statusText||"Error",{status:t.status});t.text().then((function(e){o(null,{status:t.status,data:e})})).catch(o)})).catch(o)}(t,e,n,o):yr()||"function"==typeof ActiveXObject?function(t,e,n,o){n&&"object"===Cr(n)&&(n=Sr("",n).slice(1)),t.queryStringParams&&(e=Sr(e,t.queryStringParams));try{var r;(r=wr?new wr:new xr("MSXML2.XMLHTTP.3.0")).open(n?"POST":"GET",e,1),t.crossDomain||r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.withCredentials=!!t.withCredentials,n&&r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.overrideMimeType&&r.overrideMimeType("application/json");var i=t.customHeaders;if(i="function"==typeof i?i():i)for(var s in i)r.setRequestHeader(s,i[s]);r.onreadystatechange=function(){r.readyState>3&&o(r.status>=400?r.statusText:null,{status:r.status,data:r.responseText})},r.send(n)}catch(t){console&&console.log(t)}}(t,e,n,o):void 0};function Tr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ir(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var Er=function(){return{loadPath:"/locales/{{lng}}/{{ns}}.json",addPath:"/locales/add/{{lng}}/{{ns}}",allowMultiLoading:!1,parse:function(t){return JSON.parse(t)},stringify:JSON.stringify,parsePayload:function(t,e,n){return function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},e,n||"")},request:Ar,reloadInterval:"undefined"==typeof window&&36e5,customHeaders:{},queryStringParams:{},crossDomain:!1,withCredentials:!1,overrideMimeType:!1,requestOptions:{mode:"cors",credentials:"same-origin",cache:"default"}}},Pr=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Tr(this,t),this.services=e,this.options=n,this.allOptions=o,this.type="backend",this.init(e,n,o)}var e,n;return e=t,n=[{key:"init",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.services=t,this.options=br(n,this.options||{},Er()),this.allOptions=o,this.services&&this.options.reloadInterval&&setInterval((function(){return e.reload()}),this.options.reloadInterval)}},{key:"readMulti",value:function(t,e,n){this._readAny(t,t,e,e,n)}},{key:"read",value:function(t,e,n){this._readAny([t],t,[e],e,n)}},{key:"_readAny",value:function(t,e,n,o,r){var i,s=this,a=this.options.loadPath;"function"==typeof this.options.loadPath&&(a=this.options.loadPath(t,n)),(a=function(t){return!!t&&"function"==typeof t.then}(i=a)?i:Promise.resolve(i)).then((function(i){if(!i)return r(null,{});var a=s.services.interpolator.interpolate(i,{lng:t.join("+"),ns:n.join("+")});s.loadUrl(a,r,e,o)}))}},{key:"loadUrl",value:function(t,e,n,o){var r=this;this.options.request(this.options,t,void 0,(function(i,s){if(s&&(s.status>=500&&s.status<600||!s.status))return e("failed loading "+t+"; status code: "+s.status,!0);if(s&&s.status>=400&&s.status<500)return e("failed loading "+t+"; status code: "+s.status,!1);if(!s&&i&&i.message&&i.message.indexOf("Failed to fetch")>-1)return e("failed loading "+t+": "+i.message,!0);if(i)return e(i,!1);var a,l;try{a="string"==typeof s.data?r.options.parse(s.data,n,o):s.data}catch(e){l="failed parsing "+t+" to json"}if(l)return e(l,!1);e(null,a)}))}},{key:"create",value:function(t,e,n,o,r){var i=this;if(this.options.addPath){"string"==typeof t&&(t=[t]);var s=this.options.parsePayload(e,n,o),a=0,l=[],c=[];t.forEach((function(n){var o=i.options.addPath;"function"==typeof i.options.addPath&&(o=i.options.addPath(n,e));var u=i.services.interpolator.interpolate(o,{lng:n,ns:e});i.options.request(i.options,u,s,(function(e,n){a+=1,l.push(e),c.push(n),a===t.length&&r&&r(l,c)}))}))}}},{key:"reload",value:function(){var t=this,e=this.services,n=e.backendConnector,o=e.languageUtils,r=e.logger,i=n.language;if(!i||"cimode"!==i.toLowerCase()){var s=[],a=function(t){o.toResolveHierarchy(t).forEach((function(t){s.indexOf(t)<0&&s.push(t)}))};a(i),this.allOptions.preload&&this.allOptions.preload.forEach((function(t){return a(t)})),s.forEach((function(e){t.allOptions.ns.forEach((function(t){n.read(e,t,"read",null,null,(function(o,i){o&&r.warn("loading namespace ".concat(t," for language ").concat(e," failed"),o),!o&&i&&r.log("loaded namespace ".concat(t," for language ").concat(e),i),n.loaded("".concat(e,"|").concat(t),o,i)}))}))}))}}}],n&&Ir(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();Pr.type="backend";const Lr=Pr;var Dr=r(837),Mr=r.n(Dr);function $r(t){return jr.translate(t)}let Rr;const jr=new class extends re{i18n;locReady=!1;initialized=!1;constructor(){super("Sys.Trnslt"),ge.add("system","translator",this.log),this.i18n=pr}translate(t){return this.initialized&&this.i18n.isInitialized&&this.i18n.t(t)||t}initManager(t){const e=this.log.call("initManager");if(this.initialized)return e.done("already initialized");const n=t.context||this.tryToFindAContext();e.add("will initialize");const o=window.$2sxc.env.uiRoot();this.i18n.use(Lr).init({lng:n.app.currentLanguage.substr(0,2),fallbackLng:"en",preload:["en"],backend:{loadPath:me(o+"dist/inpage/i18n/{{lng}}.js")}},(()=>this.initLoc())),this.initialized=!0,e.done()}tryToFindAContext(){const t=this.log.call("tryToFindAContext");t.add("no context found, will seek");const e=document.querySelector("div[data-cb-id]");this.initialized=!0;const n=window.$2sxc(e);this.initialized=!1;const o=qe.getEditContext(n),r=new an(o,n);return r.sxc=n,t.return(r)}initLoc(){const t=this.log.call("initLoc");Rr=Mr().init(pr),this.locReady=!0,this.autoTranslateMenus(),t.done()}autoTranslateMenus(){const t=this.log.call("autoTranslateMenus");if(!this.locReady)return t.done("loc not ready");const e=document.querySelectorAll(Ve.sel.tagScMenu);Rr(Ve.sel.tagScMenu);const n=document.querySelectorAll(".sc-i18n");Rr(".sc-i18n"),t.add(`found ${e.length} menus and ${n.length} buttons`),t.done()}},Br=`.sc-menu[toolbar],.sc-menu[data-toolbar],[${We.Toolbar.attr.full}]`;class Nr extends re{tlbManager;constructor(t){super("Tlb.Buildr",t.log),this.tlbManager=t}buildDnnModule(t){const e=this.log.call("buildDnnModule");if(t.getAttribute(We.Toolbar.attr.disable))return e.done("disabled");let n=this.findChildTagsWithConfig(t);if(0===n.length&&(n=function(t){const e=t.classList.contains(We.Cb.classes.name)?t:t.querySelector(`div${We.Cb.selectors.ofName}`);return!1===an.expandContext(e).ui.autoToolbar?null:(e.setAttribute(We.Toolbar.attr.full,JSON.stringify({toolbar:[$n.getForEmptyAsRule()]})),[e])}(t),null==n))return e.done("toolbars=null");n.forEach((t=>this.loadConfigAndInitialize(t))),jr.autoTranslateMenus(),e.done()}build(t){!t.matches(Br)||t.closest(We.Sel.SxcDivs)?null!=t.closest(We.Cb.selectors.ofName)&&(t.matches(Br)&&this.loadConfigAndInitialize(t),t.querySelectorAll(Br).forEach((t=>this.loadConfigAndInitialize(t)))):this.loadConfigAndInitialize(t)}findChildTagsWithConfig(t){return Array.from(t.querySelectorAll(Br)).filter((e=>e.closest(We.Cb.selectors.ofName)===t))}loadConfigAndInitialize(t){const e=this.log.call("loadConfigAndInitialize");if(t.getAttribute(`data-${We.Toolbar.attrToMarkInitalized}`))return e.done("already initialized");const n=class{toolbar;settings;static loadFromTag(t){try{const e=fn.tryGetAttrText(t,We.Toolbar.attr.full);if(e){const t=JSON.parse(e);return Array.isArray(t)?{toolbar:t}:t}{const e=We.IDs.attr,n=fn.getFirstAttribute(t,e.toolbar,e.toolbarData),o=fn.getFirstAttribute(t,e.settings,e.settingsData);return{toolbar:JSON.parse(n),settings:JSON.parse(o)}}}catch(e){return console.error('error in settings JSON - probably invalid - make sure you quote properties like "name": ...',t,e),null}}}.loadFromTag(t);if(null!=n)try{this.convertConfigToToolbars(t,n)}catch(t){console.error("error creating toolbar - will skip this one",t)}e.done()}convertConfigToToolbars(t,e){const n=this.log.call("convertConfigToToolbars");n.data("tag",t),n.data("config",e);const o=an.expandContext(t);if(o.toolbar=this.tlbManager.loadConfig(o,e),t.getAttribute(We.Toolbar.attr.full)){n.add("V2 TagToolbar detected");const e=new Un(t,o,jr);return t.setAttribute(`data-${We.Toolbar.attrToMarkInitalized}`,`${null!=e}`),this.addHoverAttributeToTag(t),n.done()}const r=new eo(o).generate(),i=t.closest(We.Toolbar.selectors.ofOldHover);n.data("parentTag",i),t.replaceWith(r),i&&(n.add("V1 hover-toolbar and parents found - will add attribute"),this.addHoverAttributeToTag(i)),qn.raiseToolbarInitEvent(r,r,o),n.done()}addHoverAttributeToTag(t){const e=this.log.call("addHoverAttributeToTag");if(!t)return e.done("no tag found");t.hasAttribute(We.Toolbar.attr.hover)||(e.add("will add attribute "+We.Toolbar.attr.hover),t.setAttribute(We.Toolbar.attr.hover,"")),e.done()}}class Fr{command;title;icon;classes;disabled;partOfPage;uiActionOnly;dialog;newWindow;inlineWindow;fullScreen;_expanded;static is(t){return void 0!==t.command||void 0!==t.action}static isArray(t){return t.length>0&&Fr.is(t[0])}static toButton(t){const e={};return t.classes&&(e.classes=t.classes),t.dialog&&(e.dialog=t.dialog),t.disabled&&(e.disabled=t.disabled),t.icon&&(e.icon=t.icon),t.fullScreen&&(e.fullScreen=Hr(t.fullScreen)),t.icon&&(e.icon=Hr(t.icon)),t.inlineWindow&&(e.inlineWindow=Hr(t.inlineWindow)),t.newWindow&&(e.newWindow=Hr(t.newWindow)),t.partOfPage&&(e.partOfPage=Hr(t.partOfPage)),t.title&&(e.title=Hr(t.title)),e}}function Hr(t){return null==t?null:"function"==typeof t?t:()=>t}class _r{action;entityId;contentType;useModuleList;sortOrder;modify;parent;fields;static hasActions(t){return"string"==typeof t.action}static hasModify(t){return!!t.modify}static noAction(t){return delete t.action,t}}class qr extends re{toolbar;constructor(t){super("Tlb.BtCfBl",t.log),this.toolbar=t}normalize(t){const e=this.log.call("normalize");e.data("initial",t);const n=t;if(n._expanded||n.command)return e.return(n,"already expanded, won't modify");if("string"==typeof t)return e.return(this.btnConfigStructure(t,{}),"found name, use that");if(_r.hasActions(t))return e.add("action found, will move down to .command",t),t.action&&(t.action=t.action.trim()),e.return({command:t,_expanded:!0},"had actions, convert to commands");throw"can't expand InPageButtonConfiguration - unexpected type signature encountered"}btnConfigStructure(t,e){return this.log.call("getFromName",t).return({command:{action:t.trim(),params:e},_expanded:!0},`name "${t}" found, will re-map to .command.action`)}removeDisableButtons(t,e){const n=this.log.call("removeDisableButtons",`length of groups: ${e.groups.length}`),o=e.groups;for(let e=0;e<o.length;e++){const r=o[e].buttons;this.removeUnfitButtons(t,r),n.add("will disable appropriate buttons"),(0===r.length||1===r.length&&"more"===r[0].command.name)&&(n.add('found no more buttons except for the "more" - will remove that group'),o.splice(e--,1))}n.return(null)}addDefaultBtnSettings(t,e,n,o){const r=this.log.call("addDefaultBtnSettings","",`for ${()=>t.command.name}`);for(let r=0;r<Ur.length;r++)Vr(t,e,n,o,Ur[r]);r.return(null)}removeUnfitButtons(t,e){const n=this.log.call("removeUnfitButtons");let o="";for(let i=0;i<e.length;i++){const s=e[i];if(s.command){t.button=s;const a=this.toolbar.toolbarV10.rules.find(s.id||s.command.name);let l=a?.overrideShow();if(null==l){var r=new Jn(s,t);Wn.mergeAdditionalParams(r.action(),a?.params),l=r.showCondition()}!1===l&&(o+=`#${i} "${s.command.name}"; `,e.splice(i--,1)),n.add(`btn '${s.command.name}' show ${l}`)}}o&&n.add(`removed buttons: ${o}`),n.return(null)}}const Ur=["classes","icon","title","dynamicClasses","showCondition","disabled"];function Vr(t,e,n,o,r){const i=t;if(!i[r]){if(e&&e[r])return i[r]=e[r];if(n&&n[r])return i[r]=n[r];if(t.command&&t.command.name){const e=o.get(t.command.name);if(e&&e.buttonDefaults){const t=e.buttonDefaults;if(t[r])return i[r]=t[r]}}}}class zr extends re{toolbar;constructor(t){super("Tlb.CmdLdr",t.log),this.toolbar=t}updateToV9(t){if(!t.entity||!t.entity._2sxcEditInformation)return t;const e=t.entity._2sxcEditInformation;return void 0!==e.sortOrder&&(t.useModuleList=!0),void 0!==e.sortOrder&&(t.sortOrder=e.sortOrder),void 0!==t.entity.EntityId&&(t.entityId=t.entity.EntityId),delete t.entity,t}}const Wr="default",Gr="default",Jr="list",Kr="edit-advanced";class Qr extends re{toolbar;constructor(t){super("Tlb.GrpCnf",t.log),this.toolbar=t}expandButtonGroups(t){const e=this.log.call("expandButtonGroups");e.add(`will expand groups - found ${t.groups.length} items`);for(let n=0;n<t.groups.length;n++){const o=t.groups[n],r=o.defaults,i=this.expandButtonList(o,t.settings),s=[];if(Array.isArray(i)){e.add(`will process ${i.length} buttons`);for(let e=0;e<i.length;e++)s.push(this.convertToButton(i[e],t.params,t.defaults,r))}else e.add("no button array found, won't do a.nything");o.buttons=s}const n=t;return this.dropMoreIfOnlyOneGroup(n),e.return(n)}convertToButton(t,e,n,o){let r=t.command;const i=r.action,s=Gn.splitName(i).name;pn.singleton().get(s)||(this.log.add(`couldn't find action ${s} - show warning`),console.warn("warning: toolbar-button with unknown action-name:",s));const a=r.params||_r.noAction(r);r=this.toolbar.command.updateToV9(r);const l={...a,...e},c=new Wn(s,l);let u=new Gn(c,i);return u={...u,...Fr.toButton(t)},this.toolbar.button.addDefaultBtnSettings(u,o,n,pn.singleton()),u}expandButtonList(t,e){const n=this.log.call("expandButtonList");n.add("initial",t);const o=t.buttons;let r=[];if(Array.isArray(o)){n.add(`detected array of btns (${o.length}), will ensure it's an object`);for(let t=0;t<o.length;t++){const e=o[t],i=e.action;n.add(`will process actions: '${i}' for `,e),"string"==typeof i&&i.indexOf(",")>-1?(n.add(`actionNames has mult values: '${i}'`),this.expandButtonAndAddToList(r,e,i)):(n.add("actionNames has 1 value",e),r.push(e))}}else"string"==typeof o?(n.add(`detected that it is a string "${o}", will split by "," and ...`),this.expandButtonAndAddToList(r,{},o)):(n.add("no special case detected, will use the buttons-object as is"),r=o);n.add(`after check, found ${r.length} buttons`,r),this.addMoreButton(e,r);const i=r.map((t=>this.toolbar.button.normalize(t)));return n.return(i,"done")}expandButtonAndAddToList(t,e,n){const o=this.log.call("expandButtonAndAddToList",`..., ..., '${n}'`,`button def "${e} is string of mult names, will expand into array with action-properties"`),r=n.length?n.split(","):[],i={...e};delete i.action;for(let e=0;e<r.length;e++){const n=this.toolbar.button.btnConfigStructure(r[e],i);o.data("commandPart",n),t.push(n)}o.return(t)}addMoreButton(t,e){const n=this.log.call("addMoreButtons"),o=$n.bestAddMorePos(t);if(o&&o!==Tn){this.log.add(`will add a more "..." button to ${o}`);const t=this.toolbar.button.btnConfigStructure("more",{});o===Cn?e.push(t):e.unshift(t)}else this.log.add('will not add more "..." button');n.return(e)}dropMoreIfOnlyOneGroup(t){const e=this.log.call("dropMoreIfOnlyOneGroup");if(1!==t.groups.length)return e.done("not just 1 group");e.add("exactly one group found, will remove more");const n=t.groups[0].buttons,o=n.findIndex((t=>"more"===t.command?.name));if(-1===o)return e.done("no 'more' button found");n.splice(o,1),e.done("more removed")}}const Xr="none";var Yr,Zr;!function(t){t.add="+",t.addAuto="±",t.remove="-",t.system="$",t.modify="%"}(Yr||(Yr={})),function(t){t.toolbar="toolbar",t.group="group",t.button="button",t.params="params",t.settings="settings"}(Zr||(Zr={}));const ti="prefill:",ei="filter:";class ni{static processParams(t,e){const n=e.call("processParams"),o=ni.extractSubKeys(t,ti,e);o&&(t.prefill=o);const r=ni.extractSubKeys(t,ei,e);r&&(t.filters=r);const i=ni.extractSubKeys(t,"form:",e);i&&(t.form=i);const s=ni.extractSubKeys(t,"dialog:",e),a=ni.extractSubKeys(t,"context:",e);return t.metadata&&(delete t.metadata,n.add("params had additional metadata - invalid, will remove. Use 'for' instead",null,oe.error)),t.for&&(t.metadata=ni.processMetadata(t,e)),n.return({params:t,context:a,settings:s})}static processMetadata(t,e){const n=e.call("processMetadata"),o=t.for;if(!o)return n.return(void 0,"no metadata");if(delete t.for,-1===o.indexOf(","))return n.return({key:o},"only has key");const r=o.split(",").map((t=>t.trim()));if(3!==r.length)return n.return(void 0,`error: metadata-for parts count expected 3: ${r.length}`,oe.error);const i=+r[0];if(isNaN(i))return n.return(void 0,`error: first key part is not number - got ${i}`,oe.error);const s=r[1];if("string"!==s&&"guid"!==s&&"number"!==s)return n.return(void 0,`error: key is not known type, should be string, guid or number, but got ${s}`,oe.error);const a=r[2];return null==a||""===a?n.return(void 0,`error: key strange value: '${a}'`,oe.error):t.contentType&&null!=t.entityId?n.return({key:a,targetType:i,keyType:s}):n.return(void 0,"error: contentType and entityId missing",oe.error)}static extractSubKeys(t,e,n){const o=n.call("processSubMultiKeys");if(!t)return o.return(void 0,"no params");const r=Object.keys(t).filter((t=>0===t.indexOf(e)));if(!r||0===r.length)return o.return(void 0,`no speciall '${e}' keys`);const i=e.length,s={};return r.forEach((n=>{let o=t[n];!0===o||!1===o?o=o.toString():e===ei?o=ni.filterValues(o):e===ti&&(o=ni.prefillValues(o)),s[n.substring(i)]=o,delete t[n]})),o.return(s,"got list of multi-keys")}static filterValues(t){if("string"==typeof t&&t.length>0&&"["===t[0]&&"]"===t[t.length-1])try{return JSON.parse(t)}catch{console.warn(`filter:[] value is not a valid JSON array: ${t}`)}return t}static prefillValues(t){if(!t||"string"!=typeof t)return t;if(-1===t.indexOf(","))return t;if(t.indexOf('"')>=0||t.indexOf("'")>=0)return t;const e=t.split(",").map((t=>t.trim())),n=e.filter((t=>null!==t.match(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-5][0-9a-f]{3}-[089ab][0-9a-f]{3}-[0-9a-f]{12}$/i)));return n&&n.length===e.length?e:t}}const oi="base64:",ri="json64:",ii={name:"empty",groups:[{name:Gr,buttons:""}],defaults:{},params:{},settings:{},_isToolbarTemplate:!0},si={name:Wr,groups:[{name:Gr,buttons:["edit","new","metadata","publish","layout"].join(",")},{name:Jr,buttons:["add","add-existing","replace","remove","moveup","movedown","list"].join(",")},{name:Kr,buttons:["delete"].join(",")},{name:"view",buttons:["template","view","data","query","fields"].join(","),defaults:{classes:"group-pro"}},{name:"app",buttons:["app","app-settings","app-resources","system","insights"].join(","),defaults:{classes:"group-pro"}}],defaults:{},params:{},settings:{},_isToolbarTemplate:!0},ai={name:"sublist",groups:[{name:Gr,buttons:"edit,new,publish",defaults:{classes:"group-inlist"}},{name:Jr,buttons:"add-existing,replace,remove,moveup,movedown,instance-list",defaults:{classes:"group-inlist"}},{name:Kr,buttons:"delete",defaults:{classes:"group-inlist"}}],defaults:{},params:{},settings:{},_isToolbarTemplate:!0};class li extends re{static singleton(){return this._singleton??(this._singleton=new li)}static _singleton;configTemplateList=[];list={};constructor(){super("Tlb.TmpMan",null,"build"),ge.add("system","toolbar-template-manager",this.log),this.add(ii),this.add(si),this.add(ai)}copy(t){return ue.DeepClone(this.findOrShowError(t))}findOrShowError(t){const e=this.list[t];if(e)return e;throw`try to find toolbar template '${t}' but not found`}add(t){this.list[t.name]=t}}class ci{name;groups=[];defaults={};params={};settings={};debug;_isToolbarTemplate;_insertCursor;static is(t){return t._isToolbarTemplate}static hasGroups(t){return Array.isArray(t.groups)}}class ui{name="unknown";buttons="";defaults={};_insertCursor;static is(t){return void 0!==t.buttons}}class di extends re{toolbar;constructor(t){super("Tlb.TplEdt",t.log),this.toolbar=t}addButton(t,e,n,o,r){const i=r>=0;r=Math.abs(r)-(i?0:1);const s=this.log.call("addButton",`..., ${e}, ${n}, ${o}, ${i?"+":"-"}${r}, ${i}`);if(!t)return s.done("no template");let a=this.findGroupOrDefault(t,e);a||(a=this.addGroup(t,e,1e3));const l=a.buttons?.split(",")??[],c=n===o?o:`${n}=${o}`,u=this.correctPosStartEnd(l,r,i),d=i?this.findInsertPosition(a,u):u;s.add(`pos: ${r}, startEnd: ${u}, insert:${d}`),l.splice(d,0,c),a.buttons=l.filter((t=>t.length)).join(","),s.done()}findInsertPosition(t,e){return t._insertCursor=t._insertCursor||0,0===e&&(e=t._insertCursor++),e}correctPosStartEnd(t,e,n){return n||(e=t.length-e)>=0?e:t.length}add(t,e){e.forEach((e=>{e.step===Zr.group?this.addGroup(t,e.name,e.pos):this.addButton(t,e.group,e.id,e.name,e.pos)}))}addGroup(t,e,n){const o=n>=0;n=Math.abs(n)-(o?0:1);const r=this.log.call("addGroup",`..., ${e}, ${o?"+":"-"}${n}`);this.ensureGroups(t);const i=this.findGroup(t,e);if(i)return r.return(i,"already exists");const s=new ui;s.name=e;const a=this.correctPosStartEnd(t.groups,n,o),l=o?this.findInsertPosition(t,a):a;return t.groups.splice(l,0,s),r.return(s,"created")}removeGroup(t,e){const n=this.findGroup(t,e);if(!n)return;const o=t.groups.indexOf(n);o<0||t.groups.splice(o,1)}ensureGroups=t=>{t.groups||(t.groups=[])};findGroup=(t,e)=>t.groups.find((t=>t.name===e));findGroupOrDefault(t,e){const n=this.log.call("findGroup",e);if(this.ensureGroups(t),0===t.groups.length)return n.return(null,"no groups");const o=this.findGroup(t,e);return o?n.return(o,"found"):n.return(t.groups[0],"not found, return first)")}}class pi extends re{ruleString;id;name;step;operator;group=Wr;pos=0;params={};ui={};context={};settings;constructor(t,e){super("Tlb.BdRule",e),this.ruleString=t,t?this.load():this.log.add("rule is empty")}static Create({name:t,ui:e,params:n,pos:o,log:r}){var i=new pi("",r);return i.name=t,i.ui=e??{},i.operator=Yr.add,i.setIdBasedOnOperation(i.name),i.params=n??{},o&&(i.pos=o),i}overrideShow(){return this.operator!==Yr.remove&&(this.operator===Yr.add||(this.operator!==Yr.addAuto&&this.operator===Yr.modify?this.ui?.show:void 0))}load(){const t=this.log.call("load",this.ruleString),e=function(t){const e=/^([^\/?#]*)?([^?#]*)(\?([^#]*))?(#(.*))?/i.exec(t);return e&&null!==e?{key:e[1],params:e[4],button:e[6]}:void 0}(this.ruleString);if(!e.key)return t.done("no key, won't load");if(this.loadHeader(e.key),e.params){const t=this.loadParamsAndPrefill(e.params);this.params=t.params,this.context=t.context,this.settings=t.settings}return t.done()}loadHeader(t){const e=this.log.call("loadHeader",t),n=this.splitParamsArray(t);let o=n?.[0]?.[0]||Xr,r=o[0];const i=Object.values(Yr).includes(r);i||(r=o===Zr.params||o===Zr.settings||o===Zr.toolbar?Yr.system:Yr.add),this.operator=r,e.add(`name part '${o}', firstChar '${r}'`),o=i?o.substring(1):o;const s=Object.values(Zr).includes(o);return this.step=s?o:Zr.button,this.setIdBasedOnOperation(o),this.name=n?.[0]?.[1]||o,n.length>1&&this.leadHeaderAndUi(o,n.slice(1)),e.done()}setIdBasedOnOperation(t){this.id=this.operator===Yr.add||this.operator===Yr.addAuto?"rndId"+Math.floor(99999*Math.random()):t}leadHeaderAndUi(t,e){const n=this.log.call("loadHeaderParts");if(!e.length)return n.done("nothing to load");const o=this.dicToArray(e);return o.id&&(this.id=o.id),o.name&&(this.name=o.name),"string"==typeof o.group&&(this.group=o.group,delete o.group),null!=o.pos&&(this.pos=Number(o.pos),Object.is(this.pos,-0)&&(this.pos=-1)),t!==Zr.settings&&t!==Zr.toolbar&&"string"==typeof o.show&&(o.show="true"===o.show),this.ui=o,n.return(this.ui,"button rules")}loadParamsAndPrefill(t){const e=this.log.call("loadParams",t),n=this.splitParamsDic(t);e.data("params",n);const o=ni.processParams(n,this.log);return e.return(o)}dicToArray(t){return t.reduce(((t,e)=>(t[e[0]]=e[1],t)),{})}splitParamsDic(t){return this.dicToArray(this.splitParamsArray(t))}splitParamsArray(t){return t?t.split("&").map((t=>{let e=t.indexOf("=");e<0&&(e=t.length);const n=[t.slice(0,e),t.slice(e+1)],o=n[0];let r=n[1];if(r?.indexOf("%")>-1&&(r=decodeURIComponent(r)),"True"===r||"true"===r)return[o,!0];if("False"===r||"false"===r)return[o,!1];if(!isNaN(+r))return[o,Number(r)];if("string"==typeof r&&r.startsWith(oi)){const t=r.split(oi)[1];return[o,window.atob(t)]}if("string"==typeof r&&r.startsWith(ri)){const t=r.split(ri)[1];return[o,JSON.parse(window.atob(t))]}return[o,r]})):[]}}class hi{constructor(t){t&&Object.assign(this,t)}note;type;links;background;asHtml;interactive;delay;linger;isSystem;static toJson64String(t){return`json64:${window.btoa(JSON.stringify(t))}`}}function fi(t){return window.$2sxc.http.apiUrl(`sys/insights/${t}`)}const gi=dn.build("insights","Insights","speed",!0,!1,{dialog:t=>"insights-server",showCondition:t=>t.user.CanDevelop,code(t,e){const n=fi(t.button.command.params?.part??"logs");return new Promise((t=>(window.open(n,"_blank"),t())))},noItems:!0});pn.addCommand(gi),pn.addCommand(dn.clone(gi,"insights-server"));const mi={color:"orange",icon:'<svg xmlns="http://www.w3.org/2000/svg" height="48" viewBox="0 -960 960 960" width="48"><path d="M480-120q-65 0-121-31t-83-89H160v-60h92q-7-26-7-52.5V-406h-86v-60h86q0-29 .5-57.5T254-580h-94v-60h120q14-28 37-49t51-35l-77-76 40-40 94 94q28-10 56.5-10t56.5 10l94-94 40 40-76 76q28 14 49.5 35.5T683-640h118v60h-95q9 28 8.5 56.5T714-466h87v60h-87q0 27 .5 53.5T708-300h93v60H685q-26 59-82.5 89.5T480-120Zm0-60q72 0 123-50.5T654-353v-167q0-72-51-122.5T480-693q-72 0-123 50.5T306-520v167q0 72 51 122.5T480-180Zm-80-140h160v-60H400v60Zm0-173h160v-60H400v60Zm80 57h.5-.5.5-.5.5-.5.5-.5Z"/></svg>',note:{note:"<strong>Obsolete Code detected in this thing-to-replace</strong>\n    <br>\n    This uses obsolete code which will be removed soon. You should fix the code so it won't break on a future update.",allowHtml:!0}},bi="obsolete",yi="obsolete-app";function vi(t,e,n,o){return pi.Create({name:"insights",ui:{...mi,color:o??mi.color,note:{...mi.note,links:[{url:fi(`logs?key=warnings-obsolete&filter=AppId=${e}`),label:"Obsolete this App",primary:!0},{url:fi("logs?key=warnings-obsolete"),label:"all obsolete",primary:!1}],note:mi.note.note.replace("thing-to-replace",n)}},params:{part:"Logs?&key=warnings-obsolete"},pos:11,log:t})}const wi=se.parts.RuleManager;class xi extends re{rules=[];ruleManagerId=Math.floor(99999*Math.random());constructor(t){super("Tlb.RlMngr",t.log,"constructor"),this.log.add("tempId:"+this.ruleManagerId)}load(t){const e=this.log.call("load",`${()=>t.length}`);return Array.isArray(t)?(t.forEach((t=>{if("string"==typeof t)try{this.rules.push(new pi(t,this.log))}catch(t){throw t}else console.error("tried to parse a toolbar rule and expected a string, but got something else")})),e.return(this.rules,"final rules")):e.return([],"raw is empty")}addDeveloperInfos(t){if(this.debugAdded)return;if(t.system.error){const t=new hi({note:"<strong>Server Insights Logs</strong> can help <br> you debug server errors.",asHtml:!0});this.rules.push(pi.Create({name:"insights",ui:{note:t,color:"red"},pos:10,log:this.log}))}let e=t.system.problems;if(!(e?.length>0))return;const[n,o]=function(t,e,n){var o=[];return void 0!==e.find((t=>t.code===bi))?o.push(vi(t,n,"Razor","red")):void 0!==e.find((t=>t.code===yi))&&o.push(vi(t,n,"App",null)),[e.filter((t=>t.code!==bi&&t.code!=yi)),o]}(this.log,e,t.app.id);e=n,o.forEach((t=>this.rules.push(t))),wi&&console.log("2dm - has problems",e);const r=e.map(((t,e)=>{const n=new hi({type:t.severity,note:t.message?.replace("\n","<br>"),asHtml:!0,interactive:!0});return t.link&&(n.links=[{url:t.link,label:"see docs",primary:!0}]),pi.Create({name:"info",ui:{note:n},params:{link:t.link},pos:20+e,log:this.log})}));wi&&console.log("2dm - rules",r),r.forEach((t=>this.rules.push(t)))}debugAdded=!1;find(t){return this.rules.find((e=>e.id===t))}filter(t){return this.rules.filter(t)}getSettings(){const t=this.getSystemRuleS(Zr.settings)||[],e=Object.assign({},...t.slice(0,1).map((t=>t?.params))),n=this.getToolbar();return n&&t.unshift(n),{ui:Object.assign({},...t.map((t=>t?.ui))),params:e}}getParams=()=>this.getSystemRule(Zr.params)||this.getToolbar();getToolbar=()=>this.getSystemRule(Zr.toolbar);getAdd=()=>this.filter((t=>t.operator===Yr.add||t.operator===Yr.addAuto));getRemoveGroups=()=>this.filter((t=>t.operator===Yr.remove&&t.step===Zr.group));getSystemRule(t){return this.rules.find((e=>e.operator===Yr.system&&e.step===t))}getSystemRuleS(t){return this.rules.filter((e=>e.operator===Yr.system&&e.step===t))}}class Oi extends re{configLoader;rules;constructor(t){super("Tlb.TlbV09",t.log),this.configLoader=t,this.rules=new xi(t)}loadV9(t,e){const n=this.log.call("loadV9");let o=e.settings;Object.keys(e.toolbar).length>0&&o==={}&&(n.add("no data or settings, will use default settings for empty"),o=$n.getForEmpty());const r=this.getTemplateIfNoButtonsSpecified(t,e.toolbar);n.data("after template check",r);const i=this.buildFullDefinition(t,r,o);return n.return(i,"ok")}getTemplateIfNoButtonsSpecified(t,e){const n=this.log.call("getTemplateIfNoButtonsSpecified");if(n.add("initial",e),_r.hasActions(e))return n.return(e,"has actions, keep raw");if(ci.hasGroups(e))return n.return(e,"has groups, keep raw");if(ui.is(e))return n.return(e,"is group, keep raw");if(Array.isArray(e))return n.return(e,"is array, keep raw");n.add("no toolbar structure specified, will use standard toolbar template");const o=e.fields?ai.name:si.name,r=this.configLoader.templates.copy(o);r.params=Array.isArray(e)&&e[0]||e,this.rules.addDeveloperInfos(t);const i=this.rules.getAdd();return this.configLoader.templateEditor.add(r,i),n.return(r,"use template")}buildFullDefinition(t,e,n){const o=this.log.call("buildFullDefinition"),r=this.ensureDefinitionTree(e,n);ci.is(e)&&e.debug&&console.log("toolbar: detailed debug on; start build full Def");const i=this.configLoader.buildTreeAndModifyAccordingToRules(t,r);return i.settings._rules=this.rules,o.return(i)}ensureDefinitionTree(t,e){const n=this.log.call("ensureDefinitionTree");if(!t)throw`preparing toolbar, with nothing to work on: ${t}`;const o=new Qn;o.groups=this.findGroups(t);const r=t;return o.params=r.params||{},o.settings={...$n.getDefaults(),...r.settings,...$n.dropEmptyProperties(e)},o.debug=r.debug||!1,o.defaults=r.defaults||{},n.return(o)}findGroups(t){const e=this.log.call("findGroups");return e.data("initial",t),t&&0!==Object.getOwnPropertyNames(t).length?(e.add("will detect what initial structure was given"),Array.isArray(t)?(e.add("Case 2: is array"),0===t.length?e.return([],"2a: empty array"):Gn.isArray(t)?e.return([{buttons:t}],"2b: array of groups"):Fr.is(t[0])?e.return([{buttons:t}],"2b: is list of buttons, return 1 group"):(console.warn("error detecting groups in this toolbar"),e.return([],"2x: error, it's array but can't detect type, use []"))):(e.add("Case 3: not array"),Fr.is(t)?e.return([{buttons:[t]}],"Case 3a: not array, but has action/buttons properties, will wrap config into array"):(e.add('Case 3: not array and no "action", will return it or blank'),ci.hasGroups(t)?e.return(t.groups,"4: found groups"):(e.add("can't detect what this is - show warning"),console.warn("toolbar tried to build toolbar but couldn't detect type of this:",[]),e.return([],"warning"))))):e.return([],"case 0: empty object, use []")}}se.parts.ToolbarConfigLoaderV10;class ki extends re{configLoader;rules;constructor(t){super("Tlb.TlbV10",t.log,"constructor"),this.configLoader=t,this.rules=new xi(t)}loadV10(t,e,n){const o=this.log.call("loadV10");this.rules.load(n);const r=this.rules.getSettings();let i=r?.ui;0===Object.keys(i||{}).length&&(i=r?.params);const s=new $n(i),a=this.rules.getToolbar(),l=this.rules.getParams(),c=e.toolbar.fields||l?.params?.fields?ai.name:si.name,u=a?.name??c;let d=this.configLoader.templates.copy(u);d.settings=s,l&&(d.params=l.params),this.rules.getRemoveGroups().forEach((t=>this.configLoader.templateEditor.removeGroup(d,t.name))),this.rules.addDeveloperInfos(t);const p=this.rules.getAdd();this.configLoader.templateEditor.add(d,p);const h=this.configLoader.buildTreeAndModifyAccordingToRules(t,d);return h.identifier||(h.identifier=Qn.createIdentifier()),h.settings._rules=this.rules,o.return(h,"ok")}}class Ci extends re{toolbarV09;toolbarV10;groups;button;command;templates=li.singleton();templateEditor;logs;constructor(t){super("Tlb.TlbCnf")}setLoggingAndCreateHelpers(t){let e=t&&t.debug;void 0===e&&Array.isArray(t)&&t.length&&(e=t[0].debug),e=e||!1,e&&(this.log.keepData=!0,"live"===e.toString()&&(this.log.liveDump=!0),this.log.add(`found debug=${e}, will enable intense logging`)),this.toolbarV09=new Oi(this),this.toolbarV10=new ki(this),this.groups=new Qr(this),this.button=new qr(this),this.command=new zr(this),this.templateEditor=new di(this)}load(t,e){const n=this.log.call("load","","expand start",{context:t,config:e}),o=e.toolbar=e.toolbar||{};return this.setLoggingAndCreateHelpers(o),Array.isArray(o)&&o.length>=0&&"string"==typeof o[0]?n.return(this.toolbarV10.loadV10(t,e,o),"v10 done"):n.return(this.toolbarV09.loadV9(t,e),"V9 done")}buildTreeAndModifyAccordingToRules(t,e){const n=this.log.call("buildFullDefinition"),o=this.groups.expandButtonGroups(e);return this.button.removeDisableButtons(t,o),n.return(o)}}class Si extends re{static singleton(){return this._singleton??(this._singleton=new Si)}static _singleton;toolbarFinder;constructor(){super("Tlb.Mngr",null,"init"),ge.add("system","toolbar-manager",this.log),this.toolbarFinder=new Nr(this)}buildModule(t){this.toolbarFinder.buildDnnModule(t)}build(t){this.toolbarFinder.build(t)}loadConfig(t,e){return this.getLoader(JSON.stringify(e.toolbar||"")).load(t,e)}getLoader(t){const e=new Ci(this);return ge.add("toolbar",t,e.log),e}}class Ai extends re{sxcInstance;constructor(t,e){super("QE.MdCbIn",t.log),this.sxcInstance=e}create(t,e,n,o,r,i){if(!r)return alert("can't add content-block as we couldn't find the list"),Promise.resolve();const s=r.querySelectorAll("div.sc-content-block");n>s.length&&(n=s.length);const a={parentId:t,field:e,index:n,app:o,guid:i},l=this.sxcInstance.webApi.fetchJson(this.sxcInstance.webApi.url("cms/block/block",a),void 0,"POST").then((t=>{const e=ye.domFromString(t)[0];s.length>0&&n>0?s[s.length>n-1?n-1:s.length-1].after(e):r.prepend(e),window.$2sxc(e),Si.singleton().buildModule(e)}));return Promise.resolve(l)}move(t,e,n,o){const r={parent:t,fields:e,index:n,toIndex:o},i=this.sxcInstance.webApi.fetchRaw(this.sxcInstance.webApi.url("cms/list/move",r),void 0,"POST").then((()=>{console.log("done moving!"),window.location.reload()}));return Promise.resolve(i)}delete(t){if(!confirm($r("QuickInsertMenu.ConfirmDelete")))return null;const e={parent:t.parentGuid,fields:t.field,index:t.index},n=this.sxcInstance.webApi.fetchRaw(this.sxcInstance.webApi.url("cms/list/Delete",e),void 0,"DELETE").then((()=>{console.log("done deleting!"),window.location.reload()}));return Promise.resolve(n)}}class Ti extends mn{constructor(){super("QE.CntBlk")}getInstanceModifier(t){const e=window.$2sxc(t);return new Ai(this,e)}delete(t){return this.getInstanceModifier(t.list).delete(t)}create(t,e,n,o,r,i){return this.getInstanceModifier(r).create(t,e,n,o,r,i)}move(t,e){const n=this.findClipListIndex(t),o=this.findClipListIndex(e);this.getInstanceModifier(t.list).move(e.parentGuid,e.field,n,o)}isRealMove(t,e){return this.findClipListIndex(t)+1!==this.findClipListIndex(e)}findClipListIndex(t){return this.findListIndex(t.item,t.index)}findListIndex(t,e){return Fe.getContextOfTag(t)?.contentBlockReference?.parentIndex??e}static onCbButtonClick(){const t=Ui.singleton().main.activeContentBlock,e=Hi.blocks.cb.findClosestList(t),n=e.querySelectorAll(Hi.blocks.cb.selector),o=kn.getFromDom(e),r=o.guid||null,i=t.classList.contains(Hi.blocks.cb.class)?Array.from(n).indexOf(t)+1:0,s=this.getAttribute("data-action");if(s)return Ni.singleton().do(s,e,i,Hi.blocks.cb.id);const a=Ni.singleton().modCb.findListIndex(t,i-1)+1,l=this.getAttribute("data-type");return Ni.singleton().modCb.create(o.parent,o.field,a,l,e,r)}}class Ii{x;y;w;yh;element;constructor(t,e){this.x=t,this.y=e}}class Ei extends mn{modInternal;constructor(){super("QE.DnnMod"),this.modInternal=new Li(this)}delete(t){if(!confirm("are you sure?"))return;const e=this.modInternal.getModuleId(t.item.className);this.modInternal.delete(e)}move(t,e){t.index;const n=e.index,o=this.modInternal.getModuleId(t.item.className),r=this.modInternal.getPaneName(e.list);this.modInternal.move(o,r,n)}isRealMove(t,e){return this.modInternal.getPaneName(t.list)!==this.modInternal.getPaneName(e.list)||t.index!==e.index}showSendToPane(){const t=Ui.singleton(),e=Hi.blocks.mod.findClosestList(t.main.activeModule);if(!e)return;const n=t.selected.querySelector("#paneList");n.matches(":empty")||ye.empty(n),n.append(this.modInternal.getMoveButtons(this.modInternal.getPaneName(e)))}static onModuleButtonClick(){const t=this.getAttribute("data-type"),e=Ui.singleton().main.activeModule,n=Hi.blocks.mod.findClosestList(e);let o=0;e.classList.contains("DnnModule")&&(o=Array.from(n.querySelectorAll(".DnnModule")).indexOf(e)+1);const r=this.getAttribute("data-action");if(r)return Ni.singleton().do(r,n,o,Hi.blocks.mod.id);const i=Ni.singleton().modDnn.modInternal;return i.create(i.getPaneName(n),o,t)}}const Pi=t=>window.$.dnnSF(t);class Li extends re{constructor(t){super("QE.ModMng",t.log)}delete(t){const e=Pi(t).getTabId();return Di({modId:t,url:Pi().getServiceRoot("2sxc")+"dnn/module/delete",method:"GET",data:{tabId:e,modId:t},success:()=>window.location.reload()})}create(t,e,n){return Di({modId:null,url:Pi().getServiceRoot("internalservices")+"controlbar/GetPortalDesktopModules",method:"GET",data:"category=All&loadingStartIndex=0&loadingPageSize=100&searchTerm=",success:o=>{const r="Default"===n?" Content":" App";let i=null;return o.forEach(((t,e)=>{t.ModuleName===r&&(i=t)})),i?function(t,e,n){const o={Module:n,Page:"",Pane:t,Position:-1,Sort:e,Visibility:0,AddExistingModule:!1,CopyModule:!1};return Di({modId:null,url:Pi().getServiceRoot("internalservices")+"controlbar/AddModule",method:"POST",data:o,success:()=>window.location.reload()})}(t,e,i.ModuleID):alert(r+" module not found.")}})}move(t,e,n){const o={TabId:Pi(t).getTabId(),ModuleId:t,Pane:e,ModuleOrder:2*n+0};Di({modId:t,url:Pi(t).getServiceRoot("internalservices")+"ModuleService/MoveModule",method:"POST",data:o,success:()=>window.location.reload()})}getPaneName(t){return t.getAttribute("id").replace("dnn_","")}getModuleId(t){const e=t.match(/DnnModule-([0-9]+)(?:\W|$)/);return e&&2===e.length?Number(e[1]):null}getMoveButtons(t){const e=Ui.singleton().cachedPanes,n=ye.domFromString("<div></div>")[0];for(let o=0;o<e.length;o++){const r=this.getPaneName(e[o]);if(""==(t===r?" selected ":"")){const t=ye.domFromString(`<a data='${r}'>${r}</a>`)[0];n.append(t)}}const o=this;return n.querySelectorAll("a").forEach((t=>{t.addEventListener("click",(function(){const t=Ni.singleton().clipboard,e=o.getModuleId(t.item.className),n=this.getAttribute("data");o.move(e,n,0)}))})),n}}function Di(t){const e={},n={setRequestHeader(t,n){e[t]=n}};Pi(t.modId).setModuleHeaders(n);const o={headers:{"X-Requested-With":"XMLHttpRequest",...e},method:t.method};let r=t.url;if(t.data)switch(t.method){case"GET":r+="string"==typeof t.data?`?${t.data}`:`?${ye.param(t.data)}`;break;case"POST":o.body=new URLSearchParams(ye.param(t.data)),o.headers["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8"}const i=t.success;return fetch(r,o).then((t=>{if(t.status>=200&&t.status<300)return t.text();throw new Error(t.statusText)})).then((t=>{let e;try{e=JSON.parse(t)}catch{e=t}return i?.(e),e})).catch((t=>{alert(`Error while talking to server: ${t.message}`)}))}class Mi{static positionAndAlign=Ri;static refresh=ji;static get(t){return{element:t,x:ye.offset(t).left,w:ye.width(t),y:ye.offset(t).top,yh:ye.offset(t).top+(t.matches(Hi.eitherCbOrMod)?ye.height(t):0)}}static getBodyPosition(){const t=document.body.style.position,e=Ui.singleton();return"relative"===t||"absolute"===t?new Ii(ye.offset(e.body).left,ye.offset(e.body).top):new Ii(0,0)}}let $i;function Ri(t,e){const n=Ui.singleton();return t.style.left=e.x-n.bodyOffset.x+"px",t.style.top=e.yh-n.bodyOffset.y+"px",t.style.width=`${ye.width(e.element)}px`,t.style.display="inline-flex",t}function ji(t){const e="sc-cb-highlight-for-insert",n=new Date;(!$i||n.getTime()-$i.getTime()>1e3)&&($i=n,function(){const t=Ui.singleton();if(t.bodyOffset=Mi.getBodyPosition(),t.config.innerBlocks.enable){const e=Hi.blocks.cb.findAllLists().filter((t=>t.matches(`:not(.${Hi.blocks.cb.singleItem}), :empty`))),n=[];e.forEach((t=>{n.push(...Array.from(t.querySelectorAll(Hi.blocks.cb.selector)))})),t.contentBlocks=[...e,...n]}if(t.config.modules.enable){const e=t.cachedPanes,n=[];e.forEach((t=>{n.push(...Array.from(t.querySelectorAll(Hi.blocks.mod.selector)))})),t.modules=[...e,...n]}}());const o=new Ii(t.clientX,t.clientY),r=Ui.singleton();r.config.innerBlocks.enable&&r.contentBlocks&&(r.nearestCb=Bi(r.contentBlocks,o)),r.config.modules.enable&&r.modules&&(r.nearestMod=Bi(r.modules,o)),r.modActions.forEach((t=>{t.classList.toggle("sc-invisible",null===r.nearestMod)})),r.cbActions.forEach((t=>{t.classList.toggle("sc-invisible",null===r.nearestCb)}));const i=r.main._parentNode;if(null!==r.nearestCb||null!==r.nearestMod){const t=r.nearestCb||r.nearestMod,n=Hi.blocks.mod.findClosestList(t.element),o=Hi.blocks.cb.findClosestList(t.element)??n;if(function(t){const e=kn.getFromDom(t);let n=!0,o=!0;e.appList.length>0&&(n=e.appList.indexOf("Content")>-1,o=e.appList.length-(n?1:0)>0),Ui.singleton().cbActions.forEach((t=>{t.classList.toggle("hide-content",!n),t.classList.toggle("hide-app",!o)}))}(o),n){let t=n.getAttribute("id")||"";t.length>4&&(t=t.substr(4)),r.modActions.filter((t=>t.matches("[titleTemplate]"))).forEach((e=>{e.setAttribute("title",e.getAttribute("titleTemplate").replace("{0}",t))}))}Ri(r.main,t),r.main.activeContentBlock=r.nearestCb?r.nearestCb.element:null,r.main.activeModule=r.nearestMod?r.nearestMod.element:null,r.main._parentNode=o,o.classList.add(e)}else r.main._parentNode=null,r.main.style.display="none";i&&i!==r.main._parentNode&&i.classList.remove(e)}function Bi(t,e){let n=null,o=30;const r=e.x+window.scrollX,i=e.y+window.scrollY;return t.forEach((t=>{const e=Mi.get(t);if(r<e.x||r>e.x+e.w)return;const s=Math.abs(i-e.yh);s<30&&s<o&&(n=e,o=s)})),n}class Ni extends re{static singleton(){return this._singleton??(this._singleton=new Ni)}static _singleton;clipboard=new gn;mods={};modDnn;modCb;constructor(){super(ie),ge.add("Q-E","clipboard",this.log),this.mods.cb=this.modCb=new Ti,this.mods.mod=this.modDnn=new Ei,ye.ready((()=>this.initializeSecondaryButtons()))}initializeSecondaryButtons(){const t=this.log.call("initializeSecondaryButtons"),e=this;Ui.singleton().selected.querySelectorAll("a").forEach((t=>{t.addEventListener("click",(function(){const t=this.getAttribute("data-action");switch(t){case"delete":return e.mods[e.clipboard.type].delete(e.clipboard);case"sendToPane":return e.modDnn.showSendToPane();default:throw new Error(`unexpected action: ${t}`)}}))})),t.done()}do(t,e,n,o){const r=this.log.call("do",`${t}, domIndex: ${n}, typed: ${o}`),i=this.createSpecs(o,e,n);switch(t){case"select":this.mark(i);break;case"paste":const t=this.clipboard.index,e=i.index;if(this.clipboard.type!==i.type)return alert("can't move module-to-block; move only works from module-to-module or block-to-block");if(isNaN(t)||isNaN(e))return this.clearUi();const n=i.type===Hi.blocks.cb.id?this.modCb:this.modDnn;if(!n.isRealMove(this.clipboard,i))return this.clearUi();n.move(this.clipboard,i),this.clearUi()}return r.return(null)}mark(t){const e=this.log.call("mark");if(e.data("specs",t),t){if(this.clipboard&&this.clipboard.item===t.item)return e.return(this.clearUi());this.clipboard=t}if(this.removeSelectionMarker(),!this.clipboard.item)return e.done();const n=this.clipboard.item;n.classList.add(Hi.selected),n.previousElementSibling?.matches("iframe")&&n.previousElementSibling.classList.add(Hi.selected),this.setSecondaryActionsState(!0);const o=Ui.singleton(),r=this.clipboard?.type===Hi.blocks.cb.id?o.config.innerBlocks.buttons:o.config.modules.buttons;o.selected.toggleOverlay(n,r),e.done()}clearUi(){const t=this.log.call("clearUi");this.removeSelectionMarker(),this.clipboard=null,this.setSecondaryActionsState(!1),Ui.singleton().selected.toggleOverlay(!1),t.done()}removeSelectionMarker(){document.querySelectorAll(`.${Hi.selected}`).forEach((t=>t.classList.remove(Hi.selected)))}setSecondaryActionsState(t){const e=this.log.call("setSecondaryActionsState");let n=Array.from(document.querySelectorAll("a.sc-content-block-menu-btn"));n=n.filter((t=>t.classList.contains("icon-sxc-paste"))),n.forEach((e=>e.classList.toggle(We.ClsNames.UnAvailable,!t))),e.done()}createSpecs(t,e,n){const o=this.log.call("createSpecs",`${t}, ..., ${n}`),r=e.querySelectorAll(Hi.blocks[t].selector),i=n>=r.length?r[r.length-1]:r[n],s=kn.getFromDom(e)||{parent:"dnn",field:e.id,parentGuid:null};return o.return({parent:s.parent,parentGuid:s.parentGuid,field:s.field,list:e,item:i,index:n,type:t})}}const Fi={cb:{id:"cb",class:"sc-content-block",selector:".sc-content-block",findAllLists:()=>Array.from(document.querySelectorAll(".sc-content-block-list")),findClosestList:t=>t.closest(".sc-content-block-list"),context:"data-list-context",singleItem:"single-item"},mod:{id:"mod",class:"DnnModule",selector:".DnnModule",findAllLists:()=>{const t=[],e=document.querySelectorAll("*");for(let n=0;n<e.length;n++){const o=e[n];if(o.matches(".DNNEmptyPane, .dnnDropEmptyPanes")){t.push(o);continue}const r=o.children;for(let e=0;e<r.length;e++)if(r[e].matches(".DnnModule")){t.push(o);break}}return t},findClosestList:t=>{if(!t)return null;if(t.matches(".DNNEmptyPane, .dnnDropEmptyPanes"))return t;for(let e=0;e<t.children.length;e++)if(t.children[e].matches(".DnnModule"))return t;return Fi.mod.findClosestList(t.parentElement)},context:null}},Hi={blocks:Fi,eitherCbOrMod:".DnnModule, .sc-content-block",selected:"sc-cb-is-selected"},_i=(r(936),"quick-edit-config"),qi=ln;class Ui extends re{static singleton(){return this._singleton??=window.$quickE??new Ui}static _singleton;body=document.body;main=ye.domFromString('<div class="sc-content-block-menu sc-content-block-quick-insert sc-i18n"></div>')[0];template=`<a class='sc-content-block-menu-btn sc-cb-action ${qi}content sc-content-block-menu-addcontent sc-invisible' data-type='Default' data-i18n='[titleTemplate]QuickInsertMenu.AddBlockContent'></a><a class='sc-content-block-menu-btn sc-cb-action ${qi}app sc-content-block-menu-addapp sc-invisible' data-type='' data-i18n='[titleTemplate]QuickInsertMenu.AddBlockApp'></a>${yn.btn("select","ok","Select",!0)}${yn.btn("paste","paste","Paste",!0,!0)}`;selected=yn.selectedOverlay;contentBlocks=null;cachedPanes=null;modules=null;nearestCb=null;nearestMod=null;cbActions=ye.domFromString(this.template);modActions=ye.domFromString(this.template.replace(/QuickInsertMenu.AddBlock/g,"QuickInsertMenu.AddModule")).map((t=>(t.setAttribute("data-context","module"),t.classList.add("sc-content-block-menu-module"),t)));config=On.getDefault();bodyOffset;constructor(){super("Q-E.Main"),ge.add("Q-E","manager",this.log),this.modActions.forEach((t=>{t.addEventListener("click",Ei.onModuleButtonClick)})),this.cbActions.forEach((t=>{t.addEventListener("click",Ti.onCbButtonClick)}))}start(){const t=this.log.call("start");try{this.loadPageConfig(),this.body&&this.config.enable&&(this.bodyOffset=Mi.getBodyPosition(),this.enable(),this.initWatchMouse())}catch(t){console.error("couldn't start quick-edit",t)}t.done()}reset(){const t=this.log.call("reset");this.loadPageConfig(),t.done()}loadPageConfig(){const t=this.log.call("loadPageConfig",null,null,{config:this.config});this.logConfig();const e=document.querySelectorAll(`[${_i}]`);let n;if(e?.length>0){t.add("found configs",e);let o={};for(let r=e.length;r>=0;r--){n=e[0].getAttribute(_i);try{const e=JSON.parse(n);t.data("additional config",e),o={...o,...e},t.data("merged config",o)}catch(e){t.add("had trouble with json"),console.warn("had trouble with json",e)}}const r=On.getDefault();this.config={...r,...o,buttons:{...r.buttons,...o.buttons}}}else t.add("no configs found, will use exiting");this.config.innerBlocks.buttons={...this.config?.buttons,...this.config?.innerBlocks?.buttons},this.config.modules.buttons={...this.config?.buttons,...this.config?.modules?.buttons},this.logConfig(),this.detectWhichMenusToActivate(),t.done()}detectWhichMenusToActivate(){const t=this.config,e=this.log.call("detectWhichMenusToActivate"),n=Hi.blocks.cb.findAllLists(),o=n.length>0;e.add(`has Content Blocks: ${o}`,n),null!==t.modules.enable&&t.modules.enable!==vn||(t.modules.enable=!o),null!==t.innerBlocks.enable&&t.innerBlocks.enable!==vn||(t.innerBlocks.enable=o),e.add(`module.enable: ${t.modules.enable}`),e.add(`innerBlocks.enable: ${t.innerBlocks.enable}`),e.done()}enable(){const t=this.log.call("enable");this.prepareToolbarInDom(),this.initPanes(),t.done()}prepareToolbarInDom(){const t=this.log.call("prepareToolbarInDom");this.body.append(this.main),this.body.append(this.selected),this.cbActions.forEach((t=>this.main.append(t))),this.modActions.forEach((t=>this.main.append(t))),yn.setButtonActivationClasses(this.config.innerBlocks.buttons,this.cbActions),yn.setButtonActivationClasses(this.config.modules.buttons,this.modActions),t.done()}initPanes(){const t=this.log.call("initPanes");this.cachedPanes=Hi.blocks.mod.findAllLists(),this.cachedPanes.forEach((t=>{t.classList.add("sc-cb-pane-glow")})),t.done()}initWatchMouse(){const t=this.log.call("initWatchMouse");let e=null;document.body.addEventListener("mousemove",(t=>{null===e&&(e=window.setTimeout((()=>{requestAnimationFrame((()=>{Mi.refresh(t),e=null}))}),20))})),t.done()}logConfig(){this.log.add(`config enabled: ${this.config.enable}, mod: ${this.config.modules.enable}, cb: ${this.config.innerBlocks.enable}. ${JSON.stringify(this.config)})`)}}class Vi extends re{static singleton(){return this._singleton??(this._singleton=new Vi)}static _singleton;constructor(){super("Sys.CbEdit"),ge.add("system","cb-editor-api",this.log)}prepareToAddContent(t,e){const n=this.log.call("prepareToAddContent");if(t.contentBlock.isCreated||!e)return n.return(Promise.resolve());const o=this.updateTemplate(t,t.contentBlock.templateId,!0);return n.return(o,"ok")}updateTemplateFromDia(t,e){const n=this.log.call("updateTemplateFromDia",`..., ${e}`),o=fn.isDisabled(t.sxc);n.add(`wasShowingPreview: ${o}`);const r=this.updateTemplate(t,e,!1).then((()=>{o&&zi.reloadAndReInitialize(t,"contentBlockEditor.updateTemplateFromDia")}));return n.return(r)}getPreviewWithTemplate(t,e){const n=this.log.call("getPreviewWithTemplate",`..., ${e}`),o={templateId:e=e||We.ContentBlock.UseExistingTemplate,lang:t.app.currentLanguage,cbid:t.contentBlockReference.id,originalparameters:JSON.stringify(t.instance.parameters),edition:t.contentBlock.edition};n.data("params",o);const r=t.sxc.webApi.fetchRaw(t.sxc.webApi.url("cms/block/render",o)).then((t=>t.text()));return n.return(r)}updateTemplate(t,e,n){const o=this.log.call("updateTemplate"),r=this.saveTemplate(t,e,n).then((e=>{if(!e)return null;const n=e.replace(/[\",\']/g,"");return console&&console.log(`created content group {${n}}`),t.contentBlock.contentGroupId=n})).catch((()=>alert("error - result not ok, was not able to create ContentGroup")));return o.return(r)}saveTemplate(t,e,n){const o=this.log.call("saveTemplate"),r={templateId:e,forceCreateContentGroup:n,newTemplateChooserState:!1};o.data("params",r);const i=t.sxc.webApi.fetchJson(t.sxc.webApi.url("cms/block/template",r),void 0,"POST");return o.return(i)}}const zi=new class extends re{constructor(){super("Rnd.Rndrer"),ge.add("system","renderer",this.log),this.log.add("constructor")}showMessage(t,e){Fe.getTag(t.sxc).innerHTML=e}reloadAndReInitialize(t,e,n,o){const r=this.log.call("reloadAndReInitialize",`..., triggeredBy: ${e}, forceAjax: ${n}, preview: ${o}`,null,{context:t});return(t.commandWorkflow??jn.getDummyManager()).run(new Fn(bs.refresh,Hn.before,t)).then((e=>{if(jn.isCancelled(e))return r.add("Workflow return false, will cancel and not refresh."),Promise.resolve();var i=!1;const s=window;return s.ToSic?.Sxc?.Oqtane&&s.ToSic.Sxc.Oqtane.reloadModule(t.sxc.id).then((t=>(i=t,t?r.add("Oqtane Interactive, use full page reload"):r.add("Oqtane Static, use ajaxLoad"),Promise.resolve()))).catch((t=>{console.error("Error in Oqtane.reloadModule:",t)})),!n&&!t.app.supportsAjax||i?(r.done("not ajax - reloading page"),window.location.reload(),Promise.resolve()):(r.add("is ajax, calling ajaxReload"),this.ajaxLoad(t,We.ContentBlock.UseExistingTemplate,o,"render.reloadAndReInitialize").then((t=>{if(window.dnn_tabVersioningEnabled){r.add("system is using tabVersioning - will inform DNN");try{window.dnn.ContentEditorManager.triggerChangeOnPageContentEvent()}catch(t){}}return r.return(t)})).catch((t=>console.log("Error in reloadAndReInitialize",t))))}))}ajaxLoad(t,e,n,o){const r=this.log.call("ajaxLoad",`triggeredBy: ${o}`);return r.add("starting promise chain"),Vi.singleton().getPreviewWithTemplate(t,e).then((e=>{r.add("get preview done, let's replace the content"),this.replaceContentBlock(t,e,n)})).then((()=>{r.add("replace done, resetting quickE"),Ui.singleton().reset(),r.done()}))}replaceContentBlock(t,e,n){const o=this.log.call("replaceContentBlock");try{try{const o=JSON.parse(e),r=o.Resources.map((t=>"js"===t.Type?`<script type="text/javascript" src="${t.Url}"><\/script>`:"css"===t.Type?`<link rel="stylesheet" href="${t.Url}">`:void 0)).filter((t=>null!=t)).join("\n"),i=ye.domFromString(r),s=ye.domFromString(o.Html)[0];ye.append(document.head,i,!1),n&&fn.disable(s),ye.replaceWith(Fe.getTag(t.sxc),s,!1);const a=[...i.filter((t=>"script"===t.tagName.toLocaleLowerCase())),...Array.from(s.querySelectorAll("script"))];be.runScripts(a,void 0)}catch{const o=ye.domFromString(e)[0];n&&fn.disable(o),ye.replaceWith(Fe.getTag(t.sxc),o,!0)}t.sxc.recreate(!0)}catch(t){console.log("Error while rendering template:",t)}o.done()}},Wi=new class{addItem(t,e){return Gi(t,"cms/block/item",{index:e},"post")}removeFromList(t){const e=t.button.command.params;return Gi(t,"cms/list/delete",{index:zn.getIndex(e),parent:e.parent,fields:e.fields},"delete")}changeOrder(t,e,n){const o=t.button.command.params;return Gi(t,"cms/list/move",{parent:o.parent,fields:o.fields,index:e,toIndex:n},"post")}publish(t,e,n){return Gi(t,"cms/block/publish",{part:e,index:n},"post")}publishId(t,e){return Gi(t,"cms/edit/publish",{id:e},"post")}};function Gi(t,e,n,o="get"){return("post"===o?t.sxc.webApi.fetchRaw(t.sxc.webApi.url(e,n),null,"POST"):"delete"===o?t.sxc.webApi.fetchRaw(t.sxc.webApi.url(e,n),void 0,"DELETE"):t.sxc.webApi.fetchJson(t.sxc.webApi.url(e,n))).then((()=>{zi.reloadAndReInitialize(t,"doAndReload")}))}pn.add("add","AddDemo","plus-circled",!1,!0,{showCondition:t=>hn.isList(t),code:t=>Wi.addItem(t,zn.getIndex(t)+1)}),pn.add("add-existing","AddExisting","add-existing",!1,!0,{dialog:t=>"replace",showCondition:t=>hn.isList(t),configureLinkGenerator:(t,e)=>{if(hn.isFieldList(t)){const n=t.button.command.params;e.items=[{Add:!0,Index:zn.getIndex(n)+1,Parent:n.parent,Field:n.fields}]}else if(hn.isPartOfBlockList(t)){const t=e.items[0];t.Add=!0,t.Index++,e.items=[t]}}}),pn.add("app","App","settings",!0,!1,{showCondition:t=>t.user.CanAdmin,noItems:!0}),pn.add("app-import","Dashboard","",!0,!1,{noItems:!0}),pn.add("app-resources","AppResources","translate",!0,!1,{dialog:t=>"edit",disabled:t=>null===t.app.resourcesId,title:t=>`${cn}AppResources${null===t.app.resourcesId?"Disabled":""}`,showCondition:t=>!!t.user.CanAdmin,configureLinkGenerator:(t,e)=>{e.items=[{EntityId:t.app.resourcesId}]},dynamicClasses:t=>null!==t.app.resourcesId?"":"empty",noItems:!1}),pn.add("app-settings","AppSettings","sliders",!0,!1,{dialog:()=>"edit",disabled:t=>null===t.app.settingsId,title:t=>"Toolbar.AppSettings"+(null===t.app.settingsId?"Disabled":""),showCondition:t=>t.user.CanAdmin,configureLinkGenerator:(t,e)=>{e.items=[{EntityId:t.app.settingsId}]},dynamicClasses:t=>null!==t.app.settingsId?"":"empty",noItems:!1}),pn.add("apps","Zone","manage",!0,!1,{showCondition:t=>!!t.user.CanAdmin,noItems:!0});const Ji=dn.build("fields","ContentType","fields",!0,!1,{dialog:t=>"contenttype",parameters:Ki,showCondition:t=>!!t.user.CanDevelop&&!!Ki(t).contentType,noItems:!0});function Ki(t){return{contentType:t.button.command.params.contentType||t.contentBlock.contentTypeId}}pn.addCommand(Ji),pn.addCommand(dn.clone(Ji,"contenttype"));const Qi=dn.build("data","ContentItems","table",!0,!1,{dialog:t=>"contentitems",parameters:Ki,showCondition:t=>!!t.user.CanAdmin&&!!Ki(t).contentType,tweakGeneratedUrlParameters:(t,e)=>{const n=t.button.command.params.filters;if(!n)return e;let o=JSON.stringify(n);return o.indexOf("+")>-1&&(o=btoa(o)),{...e,filters:o}},noItems:!0});pn.addCommand(Qi),pn.addCommand(dn.clone(Qi,"contentitems")),pn.add("copy","Copy","copy",!1,!0,{dialog:t=>"edit",showCondition:t=>!!t.button.command.params.entityId,configureLinkGenerator:(t,e)=>{const n=t.button.command.params.entityId,o=Ki(t).contentType;if(!o)throw new Error("can't copy: missing contentType");e.items=[{DuplicateEntity:n,ContentTypeName:o}]}});const Xi="Running 'code' command, ",Yi=`${Xi}but no 'call' found to run - see console for debug info.`,Zi=`${Xi}but 'call' doesn't seem to be a string.`,ts=dn.build("code","Custom","bomb",!0,!1,{code:(t,e)=>new Promise(((n,o)=>{const r=t.button.command.params;function i(t){console.warn(t,r),alert(t+"\n See console for details."),n()}let s=r.call;if(!s)return i(Yi);if("string"!=typeof s)return i(Zi);if(-1!==s.indexOf("(")||-1!==s.indexOf(" "))return i(`${Xi}but 'call' contained '(' or ' ' characters - not allowed.`);s+="(params, context, event)";const a={};Object.entries(r).forEach((([t,e])=>{"function"!=typeof e&&(a[t]=e)}));const{action:l,call:c,...u}=a;try{const o=new Function("params","context","event",s);n(o(u,t,e))}catch(t){console.error("error in custom button-code: ",r),o(t)}}))});pn.addCommand(ts);const es="Trying to run Custom-Code action, but no 'call' (v10+, recommended) or 'customCode' (v9, old) found to run - see console for debug info.";pn.add("custom","Custom","bomb",!0,!1,{code:(t,e)=>new Promise(((n,o)=>{const r=t.button.command.params;let i=r.customCode;i||(i=r.call,"string"==typeof i&&-1===i.indexOf(" ")&&-1===i.indexOf("(")&&(i+="(context, event)")),i||(console.warn(es,r),alert(es),n());try{n(new Function("context","event",i)(t,e))}catch(t){console.error("error in custom button-code: ",r),o(t)}}))});function ns(t,e){const n=t.contentBlock.edition;return e||t.user.CanDevelop||t.user.canSwitchEdition?`<button onclick="$2sxc(${t.sxc.id,t.sxc.id}).cms.run({ action:'edition'})">${n}</button>`:n}pn.add("delete","Delete","cancel",!0,!1,{showCondition(t){const e=t.button.command.params;return!(e.useModuleList||!e.entityId||!e.entityGuid||!e.entityTitle)},code(t){const e=t.button.command.params,n=e.title||e.entityTitle;return((t,e,n,o)=>{if(!confirm($r("Delete.Confirm").replace("{id}",String(e)).replace("{title}",o)))return Promise.resolve();const r={zoneId:t.app.zoneId,appId:t.app.id};return t.sxc.webApi.fetchRaw(t.sxc.webApi.url(`app/auto/content/any/${n}`,r),void 0,"DELETE").then((t=>{if(t.status>=200&&t.status<300)location.reload();else if(t.status>=400&&t.status<500){const e=$r("Delete.ErrCheckConsole");401===t.status&&alert($r("Delete.ErrPermission")+e),400===t.status&&alert($r("Delete.ErrInUse")+e)}})).catch((t=>{console.log(t)}))})(t,e.entityId,e.entityGuid,n)}}),pn.add("edit","Edit","pencil",!1,!0,{parameters:t=>({mode:"edit"}),showCondition(t){const e=t.button.command.params;return!!e.entityId||!!e.useModuleList}}),pn.add("edition","Edition","edition",!0,!1,{code(t,e){const n=t.contentBlock.edition;return $2sxc(t.sxc.id,t.sxc.id).cms.run({action:"new",params:{contentType:"b535b6aa-d0a1-40c1-b996-b7e8461efc0c",edition:n,settings:{save:"false"}}})},notes(t){const e=t.contentBlock.edition,n=ns(t,!0),o=`\n    View: <strong>${t.contentBlock.viewName}</strong> - ${e?"edition: "+n:""}<br>\n    `;return[new hi({type:"info",note:`<strong>View / Edition</strong> <br>\n    ${o}`,asHtml:!0,delay:0,interactive:!0,isSystem:!0})]},noItems:!0});const os=se.parts.commandInfo,rs={info:"Info",warning:"Warning",error:"Error",help:"Help",link:"Link"},is={info:"info",warning:"warning",error:"warning",help:"Help",link:"Link"},ss={info:"gray",warning:"orange",error:"red"};function as(t){os&&console.log("2dm - note: ctx-ui",t?.ui);const e=an.getRule(t)?.ui?.note??{};return e.type=e.type??"info",os&&console.log("2dm - note",e),e}pn.add("info","Info","info",!0,!1,{icon:t=>ln+(is[as(t).type]??"info"),title:t=>cn+(rs[as(t).type]??"Info"),color:t=>ss[as(t)?.type??"info"],code(t,e){os&&console.log("2dm - info-button code",t);const n=t.button.command.params,o=n?.link,r=n?.target;return os&&console.log("2dm - info-button code - link",o),o?(Rs.applyLinkToButton(e,o,r)||window.open(o,r??"_blank"),Promise.resolve()):(console.log("info-button clicked, but nothing will happen, because no link was specified in the params. This may be expected/ok."),Promise.resolve())},noItems:!0});const ls=dn.build("list","Sort","list-numbered",!1,!0,{dialog:t=>"instance-list",showCondition:t=>hn.isList(t),configureLinkGenerator:(t,e)=>{if(!hn.isFieldList(t))return;const n=t.button.command.params;e.items=[{Add:!1,Index:zn.getIndex(n),Parent:n.parent,Field:n.fields}]},noItems:!1});pn.addCommand(ls),pn.addCommand(dn.clone(ls,"instance-list"));const cs="ChangeLayout";pn.add("layout",cs,"glasses",!0,!0,{inlineWindow:t=>!0,code(t,e){const n="["+Hi.blocks.cb.context+"]",o=Fe.getTag(t.sxc).closest(n);if(o){const e=kn.getFromDom(o);t.button.command.params.apps=e.apps}return Rs.openDialog(t,e,"commandLayout.add")},disabled:t=>!!t.contentBlock.viewSwitchDisabled,title:t=>cn+cs+(t.contentBlock.viewSwitchDisabled?"Disabled":""),notes(t){const e=t.app,n=t.contentBlock,o=n.edition,r='<a href="https://go.2sxc.org/lightspeed" target="_blank">⚡ LightSpeed Cache</a>',i=n.renderLightspeed?`<strike>${n.renderMs}ms</strike> 0ms using ${r}`:`${n.renderMs}ms (no ${r})`,s=n.queryName?`Query: ${n.queryName} <br>${n.queryInfo}<br>`:"",a=ns(t,!1),l=`\n    App: <strong>${e.appName}</strong> <br>\n    View: <strong>${n.viewName}</strong> - ${o?"edition: "+a:""}<br>\n    ${s}\n    Page: ${t.page.id}, Module: ${t.instance.id} <br>\n    ⌛ ${i} <br>\n    `;return[new hi({type:"info",note:`<strong>Layout</strong> <br>\n    ${l}`,asHtml:!0,delay:500,interactive:!0,isSystem:!0})]},noItems:!0}),pn.add("log","Log","bomb",!0,!1,{code:(t,e)=>(console.log("command: log (message/context)",t.button.command.params.message,t),new Promise(((t,e)=>{}))),noItems:!0});const us=dn.build("metadata","Metadata","tag",!1,!1,{parameters:t=>({mode:"new"}),dialog:t=>"edit",dynamicClasses:t=>t.button.command.params.entityId?"":"empty",showCondition:t=>!!t.button.command.params.metadata,configureLinkGenerator(t,e){const n={Metadata:{keyType:"string",targetType:10,...e.context.button.command.params.metadata}};e.items[0]={...e.items[0],...n}},noItems:!1}),ds=dn.build("image","Image","focus",!1,!1,{parameters:us.buttonDefaults.parameters,dialog:us.buttonDefaults.dialog,classes:"single-field",dynamicClasses:us.buttonDefaults.dynamicClasses,showCondition:us.buttonDefaults.showCondition,configureLinkGenerator:us.buttonDefaults.configureLinkGenerator});pn.addCommand(us),pn.addCommand(ds),pn.add("more","MoreActions","options btn-mode",!0,!1,{code:(t,e)=>new Promise(((t,n)=>{const o=e.target.closest(Ve.sel.tagScMenu),r=Number(o.getAttribute("data-state")||0),i=(r+1)%Number(o.getAttribute("group-count"));o.classList.remove(`group-${r}`),o.classList.add(`group-${i}`),o.setAttribute("data-state",String(i)),e.preventDefault();const s=o.closest("."+We.Toolbar.classes.oldHover);s&&"true"!==o.getAttribute("listener")&&(s.addEventListener("mouseenter",(function(t){o.style.opacity="1"})),s.addEventListener("mouseleave",(function(t){0!==t.screenX&&0!==t.screenY?o.style.opacity="0":(o.style.opacity="1",console.warn("workaround for toolbar hide onmouseleave issue",t.screenX,t.screenY,t.target))})),o.setAttribute("listener","true")),t()}))}),pn.add("movedown","MoveDown","move-down",!1,!0,{showCondition:t=>hn.isList(t),code(t){const e=zn.getIndex(t);return Wi.changeOrder(t,e,e+1)}}),pn.add("moveup","MoveUp","move-up",!1,!0,{showCondition:t=>!(!hn.isList(t)||0===zn.getIndex(t)),code(t){const e=zn.getIndex(t);return Wi.changeOrder(t,e,Math.max(e-1,0))}}),pn.add("new","New","plus",!1,!0,{parameters:t=>({mode:"new"}),dialog:t=>"edit",showCondition:t=>!!t.button.command.params.contentType||hn.isList(t),code(t,e){const n=t.button.command.params;return n.index=zn.getIndex(n)+1,n.entityId&&0!==n.entityId&&(delete n.entityId,delete n.entityGuid),n.useModuleList&&n.contentType&&delete n.useModuleList,Rs.openDialog(t,e,"commandNew.add")}}),pn.add("publish","Unpublished","eye-off",!1,!1,{showCondition:t=>!1===t.button.command.params.isPublished,disabled:t=>!t.instance.allowPublish||!1!==t.button.command.params.isPublished,code(t,e){const n=t.button.command.params;return new Promise(((e,o)=>{if(n.isPublished)return alert($r("Toolbar.AlreadyPublished")),e();if(n.entityId)return Wi.publishId(t,n.entityId);const r=zn.getIndex(t),i=-1===r?"listcontent":"content",s=-1===r?0:r;return Wi.publish(t,i,s)}))}}),pn.add("remove","Remove","minus-circled",!1,!0,{showCondition:t=>hn.isList(t),code:t=>new Promise(((e,n)=>confirm($r("Toolbar.ConfirmRemove"))?Wi.removeFromList(t):e()))}),pn.add("replace","Replace","replace",!1,!0,{showCondition:t=>hn.isReferencedItem(t),configureLinkGenerator:(t,e)=>{if(!hn.isFieldList(t))return;const n=t.button.command.params;e.items=[{Add:!1,Index:zn.getIndex(n),Parent:n.parent,Field:n.fields}]}});const ps=dn.build("template","Develop","code",!0,!1,{newWindow:t=>!0,dialog:t=>"develop",showCondition:t=>!!t.user.CanDevelop,configureLinkGenerator:(t,e)=>{const n=t.contentBlock,o={EntityId:n.templateId};n.templatePath&&(o.Path=n.templatePath),n.edition&&(o.Edition=n.edition),e.items=[o]},parameters:t=>({isshared:t.contentBlock.templateIsShared}),noItems:!1});pn.addCommand(ps),pn.addCommand(dn.clone(ps,"template-develop"));const hs=dn.build("query","QueryEdit","filter",!0,!1,{dialog:t=>"pipeline-designer",parameters:t=>({pipelineId:t.contentBlock.queryId}),newWindow:t=>!0,disabled:t=>null===t.app.settingsId||!t.contentBlock.queryId,title:t=>`${cn}QueryEdit${null===t.contentBlock.queryId?"Disabled":""}`,showCondition:t=>!!t.user.CanDevelop&&!t.app.isContent,dynamicClasses:t=>t.contentBlock.queryId?"":"empty",noItems:!0});pn.addCommand(hs),pn.addCommand(dn.clone(hs,"template-query"));const fs=dn.build("view","TemplateSettings","sliders",!0,!1,{dialog:t=>"edit",showCondition:t=>!!t.user.CanDevelop&&!t.app.isContent,configureLinkGenerator:(t,e)=>{e.items=[{EntityId:t.contentBlock.templateId}]},noItems:!1});pn.addCommand(fs),pn.addCommand(dn.clone(fs,"template-settings"));const gs=dn.build("system","Zone","manage",!0,!1,{dialog:t=>"zone",showCondition:t=>!!t.user.CanAdmin,noItems:!0});pn.addCommand(gs),pn.addCommand(dn.clone(gs,"zone"));class ms{id;part;parent;fields;index;toIndex}const bs={all:"all",refresh:"refresh"};class ys{zoneId;appId;pageId;moduleId;_noContextInHttpHeaders;_autoAppIdsInUrl;complete;blockId;static is(t){const e=t;return void 0!==e.zoneId&&void 0!==e.appId}static ensureCompleteOrThrow(t){if(t.zoneId&&t.appId)return t;const e="It looks like the id given is a ContextIdentifier, but it's missing either zoneId or appId.";throw console.error(e,t),e}static toCacheKey(t){return this.ensureCompleteOrThrow(t),`${t.zoneId}/${t.appId}/${t.pageId}/${t.moduleId}/${t.blockId}`}}class vs extends re{constructor(t){super("Cmd.RunPrm",t,"start")}getParamsFromNameOrParams(t){const e=this.log.call("getParamsFromNameOrParams",`${t}`),n="string"==typeof t;e.add(`adapting settings; name string: ${n}; name = ${t}`);const o=n?{action:t}:t;return e.return(o)}expandParamsWithDefaults(t){const e=this.log.call("expandParamsWithDefaults"),n=t.action;e.add(`will add defaults for ${n} from buttonConfig`);const o=pn.singleton().get(n).buttonDefaults;return e.data("defaults to merge",o),e.return({...o,...t})}static is$sxcRunParams(t){const e=t;return(null!=e.tag||null!=e.context&&(ys.is(e.context)||He.is(e.context)))&&vs.isRunParamsInstance(e)}static isRunParamsInstance(t){const e=t;return null!=e.action||null!=e.params}static ensureRunParamsInstanceOrError(t){if(!vs.isRunParamsInstance(t))throw`${xs} with at least ${ws}`;if(t.context)throw`${xs} without 'context' since it already provides the context`}}const ws="'action' and/or 'params'",xs="sxc instance run() expects runParams";class Os{appId;isContent;isInnerContent;hasContent;isList;templateId;contentTypeId;supportsAjax;debug;static fromContext(t){const e=new Os;return e.appId=t.app.id,e.isContent=t.app.isContent,e.isInnerContent=t.instance.id!==t.contentBlockReference.id,e.hasContent=t.app.hasContent,e.isList=t.contentBlock.isList,e.templateId=t.contentBlock.templateId,e.contentTypeId=t.contentBlock.contentTypeId,e.supportsAjax=t.app.supportsAjax,e.debug=window.$2sxc.debug.load,e}}class ks extends re{constructor(t){super("QDl.IfBrig",t.log)}sxcCacheKey;dialogName;instanceSxc;tagModule;uncachedSxc(){if(!this.instanceSxc)throw"can't find sxc-instance of IFrame, probably it wasn't initialized yet";return this.instanceSxc.recreate(!0)}getContext(){return this.log.call("getContext").return(an.expandContext(this.uncachedSxc()))}getAdditionalDashboardConfig(){return this.log.call("getAdditionalDashboardConfig").return(Os.fromContext(this.getContext()))}hide(){Ds.singleton().setVisible(!1)}run(t){this.uncachedSxc().manage.run(t,void 0,void 0,"iframeBridge.run")}cancel(){Ds.singleton().cancel(this)}showMessage(t){const e=this.log.call("showMessage");zi.showMessage(this.getContext(),`<p class="no-live-preview-available">${t}</p>`),this.scrollToTarget(this.tagModule),e.done()}reloadAndReInit(){const t=this.log.call("reloadAndReInit");return this.changed=!1,t.done(),zi.reloadAndReInitialize(this.getContext(),"iframeBridge.reloadAndReInit",!0,!0).then((()=>(t.add("scrollToTarget"),this.scrollToTarget(this.tagModule)))).then((()=>(t.add("getAdditionalDashboardConfig"),Promise.resolve(this.getAdditionalDashboardConfig()))))}setTemplate(t,e,n){const o=this.log.call("setTemplate",`tid: ${t}, tname: ${e}, final: ${n}`);this.changed=!0;const r=this.getAdditionalDashboardConfig(),i=this.getContext(),s=r.isContent||r.supportsAjax;s||this.showMessage(`refreshing <b>${e}</b>...`);let a=n||!s?Vi.singleton().updateTemplateFromDia(i,t):zi.ajaxLoad(i,t,!0,"iframeBridge.setTemplate");return n&&(a=a.then((()=>Ds.singleton().setVisible(!1)))),a=s?a.then((()=>this.scrollToTarget(this.tagModule))):a.then((()=>window.parent.location.reload())),o.return(a.then((()=>s)))}changed=!1;setup(t,e){const n=this.log.call("setup");n.data("rewire with sxc: ",t),n.data("dialogName: ",e),this.changed=!1,this.instanceSxc=t;const o=Fe.getTag(t);n.data("tag: ",o),this.tagModule=o?.parentElement,this.sxcCacheKey=t.cacheKey,e&&(this.dialogName=e),n.done()}isConfiguredFor(t,e){const n=this.log.call("isConfiguredFor",`id:${t}, dialog:${e}`),o=this.sxcCacheKey===t&&this.dialogName===e;return n.return(o)}scrollToTarget(t){const e=this.log.call("scrollToTarget");ye.offset(t).top,e.done()}}class Cs extends re{key;constructor(t){super("Ses.State"),this.key=t,ge.add("system","session-state "+t,this.log)}set(t){this.log.add(`state '${this.key}' set(${t})`);try{sessionStorage.setItem(this.key,t)}catch{}}remove(){this.log.add(`state '${this.key}' remove()`);try{sessionStorage.removeItem(this.key)}catch{}}get(){const t=function(t){try{const e=sessionStorage.getItem(t);return JSON.parse(e)}catch{return null}}(this.key);this.log.add(`state '${this.key}' get() = '${t}'`);try{return t}catch{}}}let Ss=new Cs("dia-cbid"),As=new Cs("cancelled-dialog");r(144);const Ts="inpage-frame-wrapper",Is="iframe",Es=`<div class="${Ts}"><div class="inpage-frame"></div></div>`;class Ps extends re{constructor(t){super("QDl.Contnr",t.log)}isFullscreen=!1;resizeWatcher=null;getOrCreate(){return document.querySelector(`.${Ts}`)??this.buildContainerAndIFrame()}buildContainerAndIFrame(){const t=this.log.call("buildContainerAndIFrame"),e=ye.domFromString(Es)[0];document.querySelectorAll("#personaBar-iframe").length>0&&e.classList.add("persona-bar-visible");const n=document.createElement(Is);n.style.cssText="color-scheme: auto;";const o=function(t,e){const n=e.log.call("build");n.data("prototype",ks.prototype);const o=t;return o.bridge=new ks(e),n.data("extensions",o.bridge),n.return(o)}(n,this);return e.querySelector(".inpage-frame").append(o),document.body.append(e),this.watchForResize(e),t.return(e,"ok")}getIFrame(t){return t||(t=this.getOrCreate()),t.querySelector(Is)}setSize(t){const e=this.log.call("setSize");this.getOrCreate().style.minHeight=t?"100%":"225px",this.isFullscreen=t,e.done()}watchForResize(t){if(this.resizeWatcher)return;const e=this.log.call("watchForResize");this.resizeWatcher=window.setInterval((()=>{try{const n=this.getIFrame(t);if(!n)return void e.onlyAddIfNew("no iframe");const o=n.contentDocument.body.offsetHeight;if(n.previousHeight===o)return void e.onlyAddIfNew("no height change");n.style.minHeight=t.style.minHeight,n.style.height=o+"px",n.previousHeight=o,this.isFullscreen&&(n.style.height="100%",n.style.position="absolute"),e.onlyAddIfNew("changed to "+o)}catch(t){e.add("error",t)}}),200),e.return(null,"watcher added")}}let Ls=null;class Ds extends re{static singleton(){return this._singleton??(this._singleton=new Ds)}static _singleton;container;constructor(){super("Qdl.Managr"),ge.add("quick-dialog","manager",this.log),this.container=new Ps(this)}isVisible(){return null!=Ls}setVisible(t){const e=this.log.call("setVisible"),n=this.container.getOrCreate();n.classList.toggle("dia-select",t),this.rememberDialogState(this.container.getIFrame(n),t),Ls=t?this.container.getIFrame():null,e.done()}showOrToggleFromToolbar(t,e,n,o){const r=this.log.call("showOrToggleFromToolbar",`ctx, url: '${e}', isFullScreen:${n}, name:'${o}'`);this.container.setSize(n);const i=this.container.getIFrame();if(this.isVisible()){r.add("is already visible");const e=o&&Ls&&Ls.bridge.isConfiguredFor(t.sxc.cacheKey,o)?this.promise:null;if(this.cancel(Ls.bridge),e)return r.return(e,"just toggle off")}const s=this.setUrlToQuickDialog(e);return i.bridge.setup(t.sxc,o),i.setAttribute("src",s),i.contentWindow&&i.contentWindow.reboot&&i.contentWindow.reboot(),this.setVisible(!0),r.return(this.promiseRestart(),"restart")}cancel(t){const e=this.log.call("cancel");this.setVisible(!1),As.set("true"),this.resolvePromise(t.changed),e.done()}rememberDialogState(t,e){const n=this.log.call("rememberDialogState");if(n.add(`qDialog persistDia(..., ${e})`),e){const e=t.bridge.getContext().contentBlockReference.id.toString();return n.add(`contentBlockId: ${e})`),n.return(Ss.set(e))}return n.return(Ss.remove(),"remove")}promise;resolvePromise;promiseRestart(){return this.promise=new Promise((t=>this.resolvePromise=t)),this.promise}setUrlToQuickDialog(t){const e=this.log.call("setUrlToQuickDialog",t);return t=t.replace(We.DialogPaths.eavUi,We.DialogPaths.quickDialog),e.return(t)}}class Ms{zoneId;appId;mid;cbid;partOfPage;publishing;apps;settings;constructor(t,e){const n=t.sxc?.ctx;if(!0===n?.complete){this.zoneId=n.zoneId,this.appId=n.appId,null!=n.moduleId&&(this.mid=n.moduleId);const t=n?.blockId??this.mid;t&&(this.cbid=t)}else this.zoneId=n?.zoneId??t.app.zoneId,this.appId=n?.appId??t.app.id,this.mid=n?.moduleId??t.instance.id,this.cbid=n?.blockId??t.contentBlockReference.id;this.partOfPage=e,e&&(this.publishing=t.contentBlockReference.publishingMode),t.button?.command?.params?.apps&&(this.apps=t.button.command.params.apps),this.settings=t.button?.command?.params?.settings,this.settings||delete this.settings}}class $s extends re{buttonSafe;context;items;constructor(t,e,n){super("Cmd.LnkGen",n),this.buttonSafe=t,this.context=e;const o=this.log.call("constructor"),r=t.action();this.items=r.params.items||[],o.data("items",this.items),this.#o(t),e.button.configureLinkGenerator&&e.button.configureLinkGenerator(e,this),o.done()}#r(){const t=this.log.call("constructor"),e=this.buttonSafe.dialog(),{items:n,...o}=this.buttonSafe.parameters(),r={dialog:e||this.buttonSafe.action().name,...o};return t.data("urlParams",r),r}#o(t){t.action().params.useModuleList?this.#i(!0):t.action().params.parent?this.#s():this.#a()}getLink(){const t=this.context,e=new Jn(t.button,t),n=e.action().params,o=t.button.tweakGeneratedUrlParameters?t.button.tweakGeneratedUrlParameters(t,this.#r()):this.#r();if(n.prefill)for(let t=0;t<this.items.length;t++)this.#l(this.items[t],n);delete o.prefill,e.noItems()||(o.items=JSON.stringify(this.items));const r=e.partOfPage(),i=new Ms(t,r),s=this.#c(t),a=window.$2sxc.urlParams.get("debug")?"&debug=true":"";return`${s}#${ye.param(i).replace(/%2F/g,"/")}&${ye.param(o)}${a}`}#c(t){const e=t.sxc?.env??window.$2sxc.env;let n=e.dialogQuery();return n&&!n.startsWith("&")&&(n="&"+n),`${me(`${e.uiRoot()}${We.DialogPaths.eavUi}`)}?pageId=${e.page()}&wpk=${this.#u(e)}&sxcver=${t.instance.sxcVersion}${n}`}#u(t){return null!==t.publicKey()}#a(){const t={},e=this.context.button.command.params,n=e.contentType||e.attributeSetName;e.entityId&&(t.EntityId=e.entityId),n&&(t.ContentTypeName=n),(t.EntityId||t.ContentTypeName)&&this.items.push(this.#l(t,e))}#l(t,e){if(null==e)return t;const n=t;return e.prefill&&(n.Prefill=e.prefill),e.uifields&&(n.UiFields=e.uifields),e.form&&(n.Parameters=e.form),t}#i(t){const e=this.log.call("addContentGroupItems",`${t}`),n=zn.getIndex(this.context),o=-1!==n?n:0,r="new"===this.context.button.command.name,i=this.context.contentBlock.contentGroupId,s=this.context.button.command.params,a=[this.#d(!0)];t&&a.push(this.#d(!1)),a.map((t=>this.#p(i,o,t,r,s))),e.done()}#p(t,e,n,o,r){const i=this.log.call("addContentGroupItem",`${t}, ${e}, ${n}, ${o}`),s={Add:o,Index:e,Parent:t,Field:n.toLocaleLowerCase()};this.items.push(this.#l(s,r)),i.done()}#s(){const t=this.context.button.command.params,e=zn.getIndex(t),n="new"===this.context.button.command.name,o=t.parent;t.fields&&t.fields.split(",").map((r=>{const i={EntityId:n?0:t.entityId,Field:r,Parent:o,Add:n,Index:e};this.items.push(this.#l(i,t))}))}#d(t){return(-1!==zn.getIndex(this.context)?"":"List")+(t?"Content":"Presentation")}}class Rs extends re{runParamsHelper;constructor(t){super("Cmd.Exec",t,"start"),this.runParamsHelper=new vs(this.log)}detectParamsAndRun(t,e,n,o){const r=this.log.call("detectParamsAndRun",`${arguments.length} params`);let i;const s=!o&&n&&void 0!==n.altKey;r.add(`might cycle parameters. third is event=${s}`),s?(r.add("cycling params; event missing & eventOrSettings seems to be an event; settings assumed empty"),o=n,i=this.runParamsHelper.getParamsFromNameOrParams(e)):i={...n||{},...this.runParamsHelper.getParamsFromNameOrParams(e)},o=o||window.event;const a=this.run(t,i,o,void 0,"sxcGlobalCms.detectParamsAndRun");return r.return(a)}run(t,e,n,o,r){const i=this.log.call("run<T>",`triggeredBy: ${r}`,void 0,{context:t}),s=this.runParamsHelper.expandParamsWithDefaults(e),a=n,l=s.action;i.add(`run command '${l}'`);const c=new Wn(l,s),u={...new Gn(c,c.name),...Fr.toButton(s)};let d;t.button=u,i.data("button",t.button),o?.workflows?(d=new Bn(this.log),d.add(o.workflows)):d=jn.getWorkflow(a?.target),t.commandWorkflow=d;const p=d.run(new Fn(l,Hn.before,t));let h,f=u.code;f||(i.add("button, no code - generating code to open standard dialog"),f=Rs.openDialog),new Jn(u,t).uiActionOnly()?(i.add("UI command, no pre-flight to ensure content-block"),h=p.then((e=>jn.isCancelled(e)?Promise.resolve(null):f(t,a,"cmsEngine.run#UI command")))):(i.add("command might change data, wrap in pre-flight to ensure content-block"),h=p.then((e=>jn.isCancelled(e)?Promise.resolve(null):Vi.singleton().prepareToAddContent(t,s.useModuleList).then((()=>f(t,a,"cmsEngine.run#non UI command"))))));const g=h.then((t=>d.run(new Fn(l,Hn.after,null,t)).then((()=>t))));return i.return(g)}static openDialog(t,e,n){const o=new le("Cms.OpnDlg",null,`triggeredBy: ${n}`);ge.add("cms","open-dialog",o);const r=new Jn(t.button,t),i=new $s(r,t,o).getLink(),s=e||window.event;return new Promise((e=>{const n=()=>{e(t),zi.reloadAndReInitialize(t,"cmsEngine.openDialog")};if(r.inlineWindow())return void Ds.singleton().showOrToggleFromToolbar(t,i,r.fullScreen(),r.dialog()).then((t=>{t&&n()}));const o=r.newWindow();if(o||s?.ctrlKey||s?.shiftKey)return e(t),Rs.applyLinkToButton(s,i,o?"_blank":null)?void 0:void window.open(i);window.$2sxc.totalPopup.open(i,n)}))}static applyLinkToButton(t,e,n){let o=t?.target;for(;null!=o&&"A"!==o.tagName;)o=o.parentElement;if(null==o)return!1;const r=o,i=r.href,s=r.target;return r.href=e,n&&(r.target=n),setTimeout((()=>{i?r.href=i:r.removeAttribute("href"),s?r.target=s:r.removeAttribute("target")}),100),!0}}const js="viewBox";class Bs extends re{constructor(){super("Sys.Bootst",null,"Building Bootstrapper"),ge.add("system","bootstrap",this.log)}initializedInstances=[];openedTemplatePickerOnce=!1;diagCancelStateOnStart=As.get();initialize(){const t=this.log.call("initialize");this.diagCancelStateOnStart&&As.remove(),this.initAllInstances(!0),this.watchDomChanges(),new MutationObserver((t=>{document.querySelectorAll(`${Ve.sel.scMenu} svg:not([viewBox])`).forEach((t=>{!function(t){if(t.getAttribute(js))return;const{xMin:e,xMax:n,yMin:o,yMax:r}=[...t.children].reduce(((t,e)=>{const{x:n,y:o,width:r,height:i}=e.getBBox();return(!t.xMin||n<t.xMin)&&(t.xMin=n),(!t.xMax||n+r>t.xMax)&&(t.xMax=n+r),(!t.yMin||o<t.yMin)&&(t.yMin=o),(!t.yMax||o+i>t.yMax)&&(t.yMax=o+i),t}),{}),i=`${e} ${o} ${n-e} ${r-o}`;t.setAttribute(js,i)}(t)}))})).observe(document.body,{attributes:!1,childList:!0,subtree:!0}),t.return("done")}initAllInstances(t){const e=this.log.call("initAllInstances"),n=Array.from(document.querySelectorAll(Br)).filter((t=>!t.closest(We.Sel.SxcDivs)));this.log.add(`Found ${n.length} toolbars outside of 2sxc modules`),n.forEach((t=>{Si.singleton().build(t)}));const o=document.querySelectorAll(We.Sel.SxcDivs);this.log.add(`Found ${o.length} toolbars inside 2sxc modules`),o.forEach((e=>{this.initInstance(e,t)})),t&&this.tryShowTemplatePicker(),e.return("initAllInstances done")}watchDomChanges(){const t=this.log.call("watchDomChanges");new MutationObserver((t=>{window.$2sxc.stats.watchDomChanges++;let e=0;t.forEach((t=>{t.addedNodes.forEach((t=>{if(null==t.matches)return;const n=t;n.matches(We.IDs.cls.scMenu)||(e++,n.matches(We.Sel.SxcDivs)?(this.initInstance(n,!1),Ds.singleton().isVisible()||this.tryShowTemplatePicker()):n.matches(":not(.active-module)")&&n.querySelectorAll(We.Sel.SxcDivs).length>0?n.querySelectorAll(We.Sel.SxcDivs).forEach((t=>{this.initInstance(t,!1)})):Si.singleton().build(n))}))})),e&&Vn.cleanupOrphanedToolbars()})).observe(document.body,{attributes:!1,childList:!0,subtree:!0}),t.return("watchDomChanges done")}tryShowTemplatePicker(){const t=this.log.call("tryShowTemplatePicker");let e;const n=Ss.get();if(n){const t=document.querySelectorAll(`[${We.AttrNames.ContentBlockId}="${n}"]`);if(t.length)if(n<0){const o=Number(t[0].attributes.getNamedItem(We.AttrNames.InstanceId).value);e=window.$2sxc(o,n)}else e=window.$2sxc(n)}if(!e){const n=document.querySelectorAll(`.${We.ClsNames.UnInitialized}`);if(this.diagCancelStateOnStart||this.openedTemplatePickerOnce)return t.return(!1,"cancelled");if(Ds.singleton().isVisible())return t.return(!1,"should be invisible");if(1!==n.length)return t.return(!1,"has un-init modules");const o=Array.from(n).find((t=>t.parentElement.matches(We.Sel.SxcDivs)))?.parentElement;e=window.$2sxc(o)}return e&&(e.manage.run("layout"),this.openedTemplatePickerOnce=!0),t.return(!0,"tryShowTemplatePicker() done")}initInstance(t,e){const n=this.log.call("initInstance",`isFirstRun: ${e}) initialized: ${this.initializedInstances} module: obj`,null,{module:t});if(this.initializedInstances.find((e=>e===t)))return;this.initializedInstances.push(t);let o=window.$2sxc(t);e||(o=o.recreate(!0));const r=this.showGlassesButtonIfUninitialized(o);!e&&r||(new le("Bts.Module"),Si.singleton().buildModule(t)),n.done()}showGlassesButtonIfUninitialized(t){const e=this.log.call("showGlassesButtonIfUninitialized","sxci:",null,{sxci:t});if(this.isInitialized(t))return e.return(!1,"is initialized");const n=Fe.getTag(t);if(0!==n.querySelectorAll(`.${We.ClsNames.UnInitialized}`).length)return e.return(!1,"already has button");const o=ye.domFromString(`<div class="${We.ClsNames.UnInitialized}" onmouseover="this.title = $2sxc.translate(this.title)" title="InPage.NewElement"><div class="${ln}glasses"></div></div>`)[0];return o.addEventListener("click",(()=>t.manage.run("layout"))),n.append(o),e.return(!0,"ok")}isInitialized(t){const e=t?.manage,n=e?.editContext,o=n?.contentBlock,r=!o&&null!=n?.jsApi;return o&&0!==o.TemplateId||r}}const Ns="Cms.Api";class Fs extends re{autoDump=We.Debug.cms.autoDump;constructor(){super(Ns,null)}resetLog(){this.log=new le(Ns,null,"log was reset"),ge.add("cms","run",this.log)}run(t,e,n,o){return this.runInternal(t,e,n,o,"sxcGlobalCms.run")}runInternal(t,e,n,o,r){const i=this.log.call("run<T>2",`triggeredBy: ${r}`),s=new Rs(this.log);if(vs.is$sxcRunParams(t)){const e=ys.is(t.context)||He.is(t.context)?window.$2sxc(t.context):window.$2sxc(t.tag),n={...t,context:e};return this.runClean(n)}const a=en.is(t)?t:an.expandContext(t),l=this.do((()=>s.detectParamsAndRun(a,e,n,o)));return i.return(l,"ok")}runClean(t){const e=this.log.call("runClean<T>",`triggeredBy: ${t.triggeredBy}`),n=an.expandContext(t.context);t.params={action:t.action,...t.params};const o=this.do((()=>new Rs(this.log).run(n,t.params,t.event,t,`${t.triggeredBy} - sxcGlobalCms.runInternal`)));return e.return(o,"ok")}do(t){const e=this.log.call("do");this.resetLog();const n=t();return this.autoDump&&this.log.dump(),e.return(n)}}class Hs extends Be{constructor(t){super(t)}run(t){return vs.ensureRunParamsInstanceOrError(t),(new Fs).runClean({...t,context:this.sxc,triggeredBy:"sxcCmsReal.run"})}}class _s extends re{editContext;context;constructor(t,e,n){super("Edit.Mng",n,"start"),this.editContext=t,this.context=e}run(t,e,n,o){const r=this.log.call("run<T>",`triggeredBy: ${o}`);if(t.context||t.workflows)throw"You are calling '.manage.run(...)' with a parameter 'context' or workflows. You should probably be calling the new '.cms.run(...)' instead.";const i=an.expandContext(this.context.sxc);return r.done(),(new Fs).runInternal(i,t,e,n,"editManager.run")}getButton(t,e){return this.context.button=Si.singleton().getLoader("getButton").groups.convertToButton(t,{},{},{}),new eo(this.context).button.render(this.context,e).outerHTML}getToolbar(t,e){const n=Array.isArray(t)?t:{...t},o={settings:{...t.settings,...e},toolbar:n},r=Si.singleton().loadConfig(this.context,o);return this.context.toolbar=r,new eo(this.context).render()}_isEditMode=()=>this.editContext.Environment.IsEditable??!1;_updateContentGroupGuid(t,e){t.contentBlock.contentGroupId=e,this.editContext.contentBlock.Guid=e}}const qs=r(249);ye.ready((()=>{new qs({callback:function(){document.body.classList.toggle("sc-tb-show-all")}}).start()})),r(79);const Us=window.$2sxc,Vs=!!Us._manage;Us.context??=an.expandContext,Us._translateInit??=t=>jr.initManager(t),Us.translate??=$r,Us._manage??=new class{initInstance(t){try{const e=an.expandContext(t),n=qe.getEditContext(t);t.manage=new _s(n,e),t.cms=new Hs(t)}catch(t){console.error("error in 2sxc - will log but not throw",t)}}_toolbarManager=Si.singleton()},Us.cms??=new Fs,Us.system??=new class{finishUpgrade(t){window.$2sxc(t).webApi.fetchRaw("sys/install/resume").then((()=>{alert("Upgrade ok, restarting the CMS and reloading..."),location.reload()})),alert("starting upgrade. This could take a few minutes. You'll see an 'ok' when it's done. Please wait...")}},window.$quickE??=Ui.singleton(),Vs?ye.ready((()=>window.$quickE.start())):ye.ready((function(){(new Bs).initialize(),Ui.singleton().start()}))})(),$2sxcInpage=i})();
//# sourceMappingURL=https://sources.2sxc.org/20.00.04/dist/inpage/inpage.min.js.map