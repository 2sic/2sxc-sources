{"version":3,"file":"projects_eav-ui_src_app_content-export_content-export_component_ts.fed78cdd18155394.js","mappings":"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","names":["webApiTypeRoot","webApiTypeGet","webApiTypes","webApiTypeScopes","ContentTypesService","HttpServiceBase","retrieveContentType","nameId","this","getHttpApiUrl","params","appId","contentTypeId","getType","httpResource","url","apiUrl","getTypes","scope","defaultValue","retrieveContentTypesPromise","fetchPromise","getScopesPromise","then","scopesData","scopes","old","Object","keys","map","key","name","value","getScopesSig","scopesSignal","appid","computed","getScopesV2Promise","save","contentType","http","post","delete","staticName","NameId","import","files","formData","FormData","file","append","zoneId","createGhost","sourceNameId","static","__ngFactoryType__","_angular_core__WEBPACK_IMPORTED_MODULE_4__","jDH","factory","Éµfac","ContentExportService","HttpServiceBaseSignal","exportContent","values","selectedIds","selectedIdsString","join","language","defaultLanguage","contentTypeStaticName","recordExport","resourcesReferences","languageReferences","window","open","exportJson","typeName","exportEntity","id","prefix","metadata","_angular_core__WEBPACK_IMPORTED_MODULE_2__","i0","lang_r3","ctx_r1","itemIds","length","$event","_r1","formValues","ContentExportComponent_Conditional_5_For_17_Template","ContentExportComponent_Conditional_5_Conditional_26_Template","closeDialog","languages","hasIdList","ngForm_r4","form","valid","ContentExportComponent","constructor","dialog","route","hostClass","contentExportService","transient","contentTypesService","dialogConfigSvc","DialogConfigAppService","loading$","BehaviorSubject","contentType$","snapshot","paramMap","get","split","parseInt","ngOnInit","next","dialogSettings$","getCurrent$","forkJoin","subscribe","dialogSettings","Context","Language","List","Primary","ngOnDestroy","complete","close","i1","i2","_angular_core__WEBPACK_IMPORTED_MODULE_3__","VBU","selectors","hostVars","hostBindings","rf","ctx","ContentExportComponent_Conditional_5_Template","tmp_0_0","Name","FormsModule","i3","MatFormFieldModule","i4","MatSelectModule","i5","MatOptionModule","MatRadioModule","i6","MatDialogActions","MatButtonModule","i7","AsyncPipe","styles"],"ignoreList":[],"sourceRoot":"webpack:///","sources":["./projects/eav-ui/src/app/app-administration/services/content-types.service.ts","./projects/eav-ui/src/app/content-export/services/content-export.service.ts","./projects/eav-ui/src/app/content-export/content-export.component.html","./projects/eav-ui/src/app/content-export/content-export.component.ts"],"sourcesContent":["import { httpResource } from '@angular/common/http';\r\nimport { computed, Injectable, Signal } from '@angular/core';\r\nimport { FileUploadResult } from '../../shared/components/file-upload-dialog';\r\nimport { ScopeOption } from '../../shared/constants/eav.constants';\r\nimport { HttpServiceBase } from '../../shared/services/http-service-base';\r\nimport { ContentType, ContentTypeEdit } from '../models/content-type.model';\r\nimport { ScopeDetailsDto } from '../models/scopedetails.dto';\r\n\r\n// We should list all the \"full\" paths here, so it's easier to find when searching for API calls\r\nexport const webApiTypeRoot = 'admin/type/';\r\nconst webApiTypeGet = 'admin/type/get';\r\nconst webApiTypes = 'admin/type/list';\r\nconst webApiTypeScopes = 'admin/type/scopes';\r\nconst webApiTypeSave = 'admin/type/save';\r\nconst webApiTypeDelete = 'admin/type/delete';\r\nconst webApiTypeImport = 'admin/type/import';\r\nconst webApiTypeAddGhost = 'admin/type/addghost';\r\n@Injectable()\r\nexport class ContentTypesService extends HttpServiceBase {\r\n\r\n  // TODO: @2dg, ask 2dm \r\n  // content-export.component.ts\r\n  // content-import.component.ts\r\n  // data.component.ts\r\n  retrieveContentType(nameId: string) {\r\n    return this.getHttpApiUrl<ContentType>(webApiTypeGet, {\r\n      params: { appId: this.appId, contentTypeId: nameId }\r\n    });\r\n  }\r\n\r\n  getType(nameId: string) {\r\n    return httpResource<ContentType>(() => ({\r\n      url: this.apiUrl(webApiTypeGet),\r\n      params: { appId: this.appId, contentTypeId: nameId }\r\n    }));\r\n  }\r\n\r\n  getTypes(scope: Signal<string>) {\r\n    return httpResource<ContentType[]>(() => ({\r\n      url: this.apiUrl(webApiTypes),\r\n      params: { appId: this.appId, scope: scope() }\r\n    }), {defaultValue: []});\r\n  }\r\n\r\n  retrieveContentTypesPromise(scope: string): Promise<ContentType[]> {\r\n    return this.fetchPromise<ContentType[]>(webApiTypes, {\r\n      params: { appId: this.appId, scope }\r\n    });\r\n  }\r\n\r\n  getScopesPromise(): Promise<ScopeOption[]> {\r\n    return this.fetchPromise<{ old: Record<string, string>, scopes: ScopeDetailsDto[] }>(webApiTypeScopes, {\r\n      params: { appId: this.appId }\r\n    }).then(scopesData => {\r\n      const scopes = scopesData.old;\r\n      const scopeOptions: ScopeOption[] = Object.keys(scopes).map(key => ({\r\n        name: scopes[key],\r\n        value: key,\r\n      }));\r\n      return scopeOptions;\r\n    });\r\n  }\r\n\r\n  getScopesSig() {\r\n    const scopesSignal = httpResource<{ old: Record<string, string>, scopes: ScopeDetailsDto[] }>(() => ({\r\n      url: this.apiUrl(webApiTypeScopes),\r\n      params: { appid: this.appId },\r\n    }));\r\n\r\n    const scopeOptionsSignal = computed(() => {\r\n      // Access the value property directly without calling scopesSignal as a function\r\n      const value = scopesSignal.value;\r\n      const scopesData = value();\r\n\r\n      // Add null/undefined check here\r\n      if (!scopesData || !scopesData.old) {\r\n        return []; // Return an empty array or handle this case as appropriate\r\n      }\r\n\r\n      const scopes = scopesData.old;\r\n      return Object.keys(scopes).map(key => ({ name: scopes[key], value: key }));\r\n    });\r\n\r\n    return scopeOptionsSignal;\r\n  }\r\n\r\n  getScopesV2Promise(): Promise<ScopeDetailsDto[]> {\r\n    return this.fetchPromise<{ old: Record<string, string>, scopes: ScopeDetailsDto[] }>(webApiTypeScopes, {\r\n      params: { appId: this.appId }\r\n    }).then(scopesData => scopesData.scopes);\r\n  }\r\n\r\n  save(contentType: ContentTypeEdit) {\r\n    return this.http.post<boolean>(this.apiUrl(webApiTypeSave), contentType, {\r\n      params: { appid: this.appId },\r\n    });\r\n  }\r\n\r\n  delete(contentType: ContentType) {\r\n    return this.http.delete<boolean>(this.apiUrl(webApiTypeDelete), {\r\n      params: { appid: this.appId, staticName: contentType.NameId }, // TODO: @2pp - replace staticName with NameId\r\n    });\r\n  }\r\n\r\n  import(files: File[]) {\r\n    const formData = new FormData();\r\n    for (const file of files) {\r\n      formData.append('File', file);\r\n    }\r\n    return this.http.post<FileUploadResult>(this.apiUrl(webApiTypeImport), formData, {\r\n      params: { appId: this.appId, zoneId: this.zoneId },\r\n    });\r\n  }\r\n\r\n  createGhost(sourceNameId: string) {\r\n    return this.http.post<boolean>(this.apiUrl(webApiTypeAddGhost), null, {\r\n      params: { appid: this.appId, sourceNameId },\r\n    });\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { HttpServiceBaseSignal } from '../../shared/services/http-service-base-signal';\r\nimport { ContentExport } from '../models/content-export.model';\r\n\r\nconst webApiEntityRootDownload = 'admin/entity/Download';\r\nconst webApiEntityRootJson = 'admin/entity/Json';\r\nconst webApiTypeRootJson = 'admin/type/Json';\r\n\r\n\r\n@Injectable()\r\nexport class ContentExportService extends HttpServiceBaseSignal {\r\n\r\n  exportContent(values: ContentExport, selectedIds: number[]) {\r\n    const selectedIdsString = selectedIds ? '&selectedids=' + selectedIds.join() : '';\r\n    const url = this.apiUrl(webApiEntityRootDownload)\r\n      + '?appId=' + this.appId\r\n      + '&language=' + values.language\r\n      + '&defaultLanguage=' + values.defaultLanguage\r\n      + '&contentType=' + values.contentTypeStaticName\r\n      + '&recordExport=' + values.recordExport\r\n      + '&resourcesReferences=' + values.resourcesReferences\r\n      + '&languageReferences=' + values.languageReferences\r\n      + selectedIdsString;\r\n\r\n    window.open(url, '_blank', '');\r\n  }\r\n\r\n  exportJson(typeName: string) {\r\n    const url = this.apiUrl(webApiTypeRootJson)\r\n      + '?appId=' + this.appId\r\n      + '&name=' + typeName;\r\n\r\n    window.open(url, '_blank', '');\r\n  }\r\n\r\n  exportEntity(id: number, prefix: string, metadata: boolean) {\r\n    const url = this.apiUrl(webApiEntityRootJson)\r\n      + '?appId=' + this.appId\r\n      + '&id=' + id\r\n      + '&prefix=' + prefix\r\n      + '&withMetadata=' + metadata;\r\n\r\n    window.open(url, '_blank', '');\r\n  }\r\n\r\n}\r\n","<div class=\"eav-dialog\">\r\n  <div class=\"eav-dialog-header\">\r\n    <div class=\"eav-dialog-header__title\">Export {{ (contentType$ | async)?.Name }}</div>\r\n  </div>\r\n  @if ((loading$ | async) === false) {\r\n    <form #ngForm=\"ngForm\">\r\n      <div class=\"eav-dialog-content\">\r\n        <p>\r\n          This will generate an XML file which you can edit in Excel. If you just want to import new data, use this to export the schema\r\n          that you can then fill in using Excel. Please visit\r\n          <a href=\"https://2sxc.org/help\" target=\"_blank\">https://2sxc.org/help</a> for more instructions.\r\n        </p>\r\n        <div class=\"dialog-form-content fancy-scrollbar-light\">\r\n          <div>\r\n            <mat-form-field color=\"accent\" class=\"eav-mat-form-field\">\r\n              <mat-label>Languages</mat-label>\r\n              <mat-select [(ngModel)]=\"formValues.language\" name=\"Language\">\r\n                <mat-option value=\"\">All</mat-option>\r\n                @for (lang of languages; track lang) {\r\n                  <mat-option [value]=\"lang.NameId\">{{ lang.NameId }}</mat-option>\r\n                }\r\n              </mat-select>\r\n            </mat-form-field>\r\n          </div>\r\n          <div>\r\n            <p class=\"eav-radio-group-label\">Export data</p>\r\n            <mat-radio-group [(ngModel)]=\"formValues.recordExport\" name=\"RecordExport\" class=\"eav-radio-group\">\r\n              <mat-radio-button value=\"Blank\">No, just export blank data schema (for new data import) </mat-radio-button>\r\n              <mat-radio-button value=\"All\">Yes, export all content-items</mat-radio-button>\r\n              @if (hasIdList) {\r\n                <mat-radio-button value=\"Selection\"> Export selected {{ itemIds.length }} items </mat-radio-button>\r\n              }\r\n            </mat-radio-group>\r\n          </div>\r\n          <div>\r\n            <p class=\"eav-radio-group-label\">Value references to other languages</p>\r\n            <mat-radio-group\r\n              [(ngModel)]=\"formValues.languageReferences\"\r\n              name=\"LanguageReferences\"\r\n              [disabled]=\"formValues.recordExport === 'Blank'\"\r\n              class=\"eav-radio-group\"\r\n            >\r\n              <mat-radio-button value=\"Link\">Keep references to other languages (for re-import) </mat-radio-button>\r\n              <mat-radio-button value=\"Resolve\">Replace references with values</mat-radio-button>\r\n            </mat-radio-group>\r\n          </div>\r\n          <div>\r\n            <p class=\"eav-radio-group-label\">File / page references</p>\r\n            <mat-radio-group\r\n              [(ngModel)]=\"formValues.resourcesReferences\"\r\n              name=\"ResourcesReferences\"\r\n              [disabled]=\"formValues.recordExport === 'Blank'\"\r\n              class=\"eav-radio-group\"\r\n            >\r\n              <mat-radio-button value=\"Link\">Keep references (for re-import, for example Page:4711) </mat-radio-button>\r\n              <mat-radio-button value=\"Resolve\">Replace references with real URLs (for example /Portals/0...) </mat-radio-button>\r\n            </mat-radio-group>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <mat-dialog-actions align=\"end\">\r\n        <button mat-raised-button (click)=\"closeDialog()\">Cancel</button>\r\n        <button mat-raised-button color=\"accent\" [disabled]=\"!ngForm.form.valid\" (click)=\"exportContent()\">Export Data</button>\r\n      </mat-dialog-actions>\r\n    </form>\r\n  }\r\n</div>\r\n","import { AsyncPipe } from '@angular/common';\r\nimport { Component, HostBinding, OnDestroy, OnInit } from '@angular/core';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatOptionModule } from '@angular/material/core';\r\nimport { MatDialogActions, MatDialogRef } from '@angular/material/dialog';\r\nimport { MatFormFieldModule } from '@angular/material/form-field';\r\nimport { MatRadioModule } from '@angular/material/radio';\r\nimport { MatSelectModule } from '@angular/material/select';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { BehaviorSubject, forkJoin } from 'rxjs';\r\nimport { transient } from '../../../../core';\r\nimport { ContentType } from '../app-administration/models/content-type.model';\r\nimport { ContentTypesService } from '../app-administration/services/content-types.service';\r\nimport { DialogConfigAppService } from '../app-administration/services/dialog-config-app.service';\r\nimport { Language } from '../shared/models/language.model';\r\nimport { ContentExport } from './models/content-export.model';\r\nimport { ContentExportService } from './services/content-export.service';\r\n\r\n@Component({\r\n    selector: 'app-content-export',\r\n    templateUrl: './content-export.component.html',\r\n    styleUrls: ['./content-export.component.scss'],\r\n    imports: [\r\n        FormsModule,\r\n        MatFormFieldModule,\r\n        MatSelectModule,\r\n        MatOptionModule,\r\n        MatRadioModule,\r\n        MatDialogActions,\r\n        MatButtonModule,\r\n        AsyncPipe,\r\n    ]\r\n})\r\nexport class ContentExportComponent implements OnInit, OnDestroy {\r\n  @HostBinding('className') hostClass = 'dialog-component';\r\n\r\n  private contentExportService = transient(ContentExportService);\r\n  private contentTypesService = transient(ContentTypesService);\r\n  private dialogConfigSvc = transient(DialogConfigAppService);\r\n\r\n  formValues: ContentExport;\r\n  languages: Language[];\r\n  itemIds: number[];\r\n  hasIdList = false;\r\n  loading$ = new BehaviorSubject(false);\r\n  contentType$ = new BehaviorSubject<ContentType>(null);\r\n\r\n  private contentTypeStaticName = this.route.snapshot.paramMap.get('contentTypeStaticName');\r\n\r\n  constructor(\r\n    private dialog: MatDialogRef<ContentExportComponent>,\r\n    private route: ActivatedRoute,\r\n  ) {\r\n    const selectedIds = this.route.snapshot.paramMap.get('selectedIds');\r\n    this.hasIdList = !!selectedIds;\r\n    if (this.hasIdList) {\r\n      this.itemIds = selectedIds.split(',').map(id => parseInt(id, 10));\r\n    }\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.loading$.next(true);\r\n    const contentType$ = this.contentTypesService.retrieveContentType(this.contentTypeStaticName);\r\n    const dialogSettings$ = this.dialogConfigSvc.getCurrent$();\r\n    forkJoin([contentType$, dialogSettings$]).subscribe(([contentType, dialogSettings]) => {\r\n      this.contentType$.next(contentType);\r\n      this.languages = dialogSettings.Context.Language.List;\r\n\r\n      this.formValues = {\r\n        defaultLanguage: dialogSettings.Context.Language.Primary,\r\n        contentTypeStaticName: this.contentTypeStaticName,\r\n        language: '',\r\n        recordExport: this.hasIdList ? 'Selection' : 'All',\r\n        languageReferences: 'Link',\r\n        resourcesReferences: 'Link',\r\n      };\r\n      this.loading$.next(false);\r\n    });\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.contentType$.complete();\r\n    this.loading$.complete();\r\n  }\r\n\r\n  closeDialog() {\r\n    this.dialog.close();\r\n  }\r\n\r\n  exportContent() {\r\n    this.contentExportService.exportContent(this.formValues,\r\n      this.hasIdList && this.formValues.recordExport === 'Selection' ? this.itemIds : null);\r\n  }\r\n}\r\n"],"x_google_ignoreList":[]}