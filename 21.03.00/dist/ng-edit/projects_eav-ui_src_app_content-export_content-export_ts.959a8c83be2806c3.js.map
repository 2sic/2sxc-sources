{"version":3,"file":"projects_eav-ui_src_app_content-export_content-export_ts.959a8c83be2806c3.js","mappings":"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","names":["i0","lang_r3","NameId","ctx_r1","itemIds","length","$event","_r1","formValues","language","ContentExportComponent_Conditional_8_For_17_Template","recordExport","ContentExportComponent_Conditional_8_Conditional_26_Template","languageReferences","resourcesReferences","exportContent","languages","hasIdList","ngForm_r4","form","valid","ContentExportComponent","constructor","dialog","route","this","hostClass","contentExportService","transient","ContentExportService","contentTypesService","ContentTypesService","dialogConfigSvc","DialogConfigAppService","loading$","BehaviorSubject","contentType$","contentTypeStaticName","snapshot","paramMap","get","selectedIds","split","map","id","parseInt","ngOnInit","#watchKeyboardShortcuts","next","retrieveContentType","dialogSettings$","getCurrent$","forkJoin","subscribe","contentType","dialogSettings","Context","Language","List","defaultLanguage","Primary","ngOnDestroy","complete","closeDialog","close","keydownEvents","event","isCtrlEnter","preventDefault","i1","i2","selectors","hostVars","hostBindings","rf","ctx","ContentExportComponent_Conditional_8_Template","tmp_0_0","Name","FormsModule","i3","MatFormFieldModule","i4","MatIconModule","i5","MatSelectModule","i6","i7","MatOptionModule","MatRadioModule","i8","MatDialogActions","MatButtonModule","i9","AsyncPipe","styles","webApiTypeRoot","webApiTypeGet","webApiTypes","webApiTypeScopes","HttpServiceBase","nameId","getHttpApiUrl","params","appId","contentTypeId","getType","httpResource","url","apiUrl","getTypes","scope","defaultValue","retrieveContentTypesPromise","fetchPromise","getScopesPromise","then","scopesData","scopes","old","Object","keys","key","name","value","getScopesSig","scopesSignal","appid","computed","getScopesV2Promise","save","http","post","delete","staticName","import","files","formData","FormData","file","append","zoneId","createGhost","sourceNameId","__ngFactoryType__","factory","Éµfac","isEscape","isCtrlS","ctrlKey","metaKey","HttpServiceBaseSignal","values","selectedIdsString","join","window","open","exportJson","typeName","exportEntity","prefix","metadata"],"ignoreList":[],"sourceRoot":"webpack:///","sources":["./projects/eav-ui/src/app/content-export/content-export.html","./projects/eav-ui/src/app/content-export/content-export.ts","./projects/eav-ui/src/app/app-administration/services/content-types.service.ts","./projects/eav-ui/src/app/edit/dialog/main/keyboard-shortcuts.ts","./projects/eav-ui/src/app/content-export/services/content-export.service.ts"],"sourcesContent":["<div class=\"eav-dialog\">\r\n  <div class=\"eav-dialog-header\">\r\n    <div class=\"eav-dialog-header__title\">\r\n      Export {{ (contentType$ | async)?.Name }}\r\n    </div>\r\n    <button mat-icon-button tippy=\"Close dialog\" (click)=\"closeDialog()\">\r\n      <mat-icon>close</mat-icon>\r\n    </button>\r\n  </div>\r\n  @if ((loading$ | async) === false) {\r\n    <form #ngForm=\"ngForm\">\r\n      <div class=\"eav-dialog-content\">\r\n        <p>\r\n          This will generate an XML file which you can edit in Excel. If you just want to import new data, use this to export the schema\r\n          that you can then fill in using Excel. Please visit\r\n          <a href=\"https://2sxc.org/help\" target=\"_blank\">https://2sxc.org/help</a> for more instructions.\r\n        </p>\r\n        <div class=\"dialog-form-content fancy-scrollbar-light\">\r\n          <div>\r\n            <mat-form-field color=\"accent\" class=\"eav-mat-form-field\">\r\n              <mat-label>Languages</mat-label>\r\n              <mat-select [(ngModel)]=\"formValues.language\" name=\"Language\">\r\n                <mat-option value=\"\">All</mat-option>\r\n                @for (lang of languages; track lang) {\r\n                  <mat-option [value]=\"lang.NameId\">{{ lang.NameId }}</mat-option>\r\n                }\r\n              </mat-select>\r\n            </mat-form-field>\r\n          </div>\r\n          <div>\r\n            <p class=\"eav-radio-group-label\">Export data</p>\r\n            <mat-radio-group [(ngModel)]=\"formValues.recordExport\" name=\"RecordExport\" class=\"eav-radio-group\">\r\n              <mat-radio-button value=\"Blank\">No, just export blank data schema (for new data import) </mat-radio-button>\r\n              <mat-radio-button value=\"All\">Yes, export all content-items</mat-radio-button>\r\n              @if (hasIdList) {\r\n                <mat-radio-button value=\"Selection\"> Export selected {{ itemIds.length }} items </mat-radio-button>\r\n              }\r\n            </mat-radio-group>\r\n          </div>\r\n          <div>\r\n            <p class=\"eav-radio-group-label\">Value references to other languages</p>\r\n            <mat-radio-group\r\n              [(ngModel)]=\"formValues.languageReferences\"\r\n              name=\"LanguageReferences\"\r\n              [disabled]=\"formValues.recordExport === 'Blank'\"\r\n              class=\"eav-radio-group\"\r\n            >\r\n              <mat-radio-button value=\"Link\">Keep references to other languages (for re-import) </mat-radio-button>\r\n              <mat-radio-button value=\"Resolve\">Replace references with values</mat-radio-button>\r\n            </mat-radio-group>\r\n          </div>\r\n          <div>\r\n            <p class=\"eav-radio-group-label\">File / page references</p>\r\n            <mat-radio-group\r\n              [(ngModel)]=\"formValues.resourcesReferences\"\r\n              name=\"ResourcesReferences\"\r\n              [disabled]=\"formValues.recordExport === 'Blank'\"\r\n              class=\"eav-radio-group\"\r\n            >\r\n              <mat-radio-button value=\"Link\">Keep references (for re-import, for example Page:4711) </mat-radio-button>\r\n              <mat-radio-button value=\"Resolve\">Replace references with real URLs (for example /Portals/0...) </mat-radio-button>\r\n            </mat-radio-group>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <mat-dialog-actions align=\"end\">\r\n        <button\r\n          mat-raised-button\r\n          class=\"eav-action-button\"\r\n          [disabled]=\"!ngForm.form.valid\"\r\n          (click)=\"exportContent()\"\r\n        >\r\n          Export Data\r\n        </button>\r\n      </mat-dialog-actions>\r\n    </form>\r\n  }\r\n</div>\r\n","import { AsyncPipe } from '@angular/common';\r\nimport { Component, HostBinding, OnDestroy, OnInit } from '@angular/core';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatOptionModule } from '@angular/material/core';\r\nimport { MatDialogActions, MatDialogRef } from '@angular/material/dialog';\r\nimport { MatFormFieldModule } from '@angular/material/form-field';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatRadioModule } from '@angular/material/radio';\r\nimport { MatSelectModule } from '@angular/material/select';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { BehaviorSubject, forkJoin } from 'rxjs';\r\nimport { transient } from '../../../../core';\r\nimport { ContentType } from '../app-administration/models/content-type.model';\r\nimport { ContentTypesService } from '../app-administration/services/content-types.service';\r\nimport { DialogConfigAppService } from '../app-administration/services/dialog-config-app.service';\r\nimport { isCtrlEnter } from '../edit/dialog/main/keyboard-shortcuts';\r\nimport { Language } from '../shared/models/language.model';\r\nimport { ContentExport } from './models/content-export.model';\r\nimport { ContentExportService } from './services/content-export.service';\r\n\r\n@Component({\r\n    selector: 'app-content-export',\r\n    templateUrl: './content-export.html',\r\n    styleUrls: ['./content-export.scss'],\r\n    imports: [\r\n        FormsModule,\r\n        MatFormFieldModule,\r\n        MatIconModule,\r\n        MatSelectModule,\r\n        MatOptionModule,\r\n        MatRadioModule,\r\n        MatDialogActions,\r\n        MatButtonModule,\r\n        AsyncPipe,\r\n    ]\r\n})\r\nexport class ContentExportComponent implements OnInit, OnDestroy {\r\n  @HostBinding('className') hostClass = 'dialog-component';\r\n\r\n  private contentExportService = transient(ContentExportService);\r\n  private contentTypesService = transient(ContentTypesService);\r\n  private dialogConfigSvc = transient(DialogConfigAppService);\r\n\r\n  formValues: ContentExport;\r\n  languages: Language[];\r\n  itemIds: number[];\r\n  hasIdList = false;\r\n  loading$ = new BehaviorSubject(false);\r\n  contentType$ = new BehaviorSubject<ContentType>(null);\r\n\r\n  private contentTypeStaticName = this.route.snapshot.paramMap.get('contentTypeStaticName');\r\n\r\n  constructor(\r\n    private dialog: MatDialogRef<ContentExportComponent>,\r\n    private route: ActivatedRoute,\r\n  ) {\r\n    const selectedIds = this.route.snapshot.paramMap.get('selectedIds');\r\n    this.hasIdList = !!selectedIds;\r\n    if (this.hasIdList) {\r\n      this.itemIds = selectedIds.split(',').map(id => parseInt(id, 10));\r\n    }\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.#watchKeyboardShortcuts();\r\n    \r\n    this.loading$.next(true);\r\n    const contentType$ = this.contentTypesService.retrieveContentType(this.contentTypeStaticName);\r\n    const dialogSettings$ = this.dialogConfigSvc.getCurrent$();\r\n    forkJoin([contentType$, dialogSettings$]).subscribe(([contentType, dialogSettings]) => {\r\n      this.contentType$.next(contentType);\r\n      this.languages = dialogSettings.Context.Language.List;\r\n\r\n      this.formValues = {\r\n        defaultLanguage: dialogSettings.Context.Language.Primary,\r\n        contentTypeStaticName: this.contentTypeStaticName,\r\n        language: '',\r\n        recordExport: this.hasIdList ? 'Selection' : 'All',\r\n        languageReferences: 'Link',\r\n        resourcesReferences: 'Link',\r\n      };\r\n      this.loading$.next(false);\r\n    });\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.contentType$.complete();\r\n    this.loading$.complete();\r\n  }\r\n\r\n  closeDialog() {\r\n    this.dialog.close();\r\n  }\r\n\r\n  exportContent() {\r\n    this.contentExportService.exportContent(this.formValues,\r\n      this.hasIdList && this.formValues.recordExport === 'Selection' ? this.itemIds : null);\r\n  }\r\n  \r\n  #watchKeyboardShortcuts(): void {\r\n    this.dialog.keydownEvents().subscribe(event => {\r\n      if (isCtrlEnter(event)) {\r\n        event.preventDefault();\r\n        this.exportContent();\r\n      }\r\n    });\r\n  }\r\n}\r\n","import { httpResource } from '@angular/common/http';\r\nimport { computed, Injectable, Signal } from '@angular/core';\r\nimport { FileUploadResult } from '../../shared/components/file-upload-dialog';\r\nimport { ScopeOption } from '../../shared/constants/eav.constants';\r\nimport { HttpServiceBase } from '../../shared/services/http-service-base';\r\nimport { ContentType, ContentTypeEdit } from '../models/content-type.model';\r\nimport { ScopeDetailsDto } from '../models/scopedetails.dto';\r\n\r\n// We should list all the \"full\" paths here, so it's easier to find when searching for API calls\r\nexport const webApiTypeRoot = 'admin/type/';\r\nconst webApiTypeGet = 'admin/type/get';\r\nconst webApiTypes = 'admin/type/list';\r\nconst webApiTypeScopes = 'admin/type/scopes';\r\nconst webApiTypeSave = 'admin/type/save';\r\nconst webApiTypeDelete = 'admin/type/delete';\r\nconst webApiTypeImport = 'admin/type/import';\r\nconst webApiTypeAddGhost = 'admin/type/addghost';\r\n@Injectable()\r\nexport class ContentTypesService extends HttpServiceBase {\r\n\r\n  // TODO: @2dg, ask 2dm \r\n  // content-export.component.ts\r\n  // content-import.component.ts\r\n  // data.component.ts\r\n  retrieveContentType(nameId: string) {\r\n    return this.getHttpApiUrl<ContentType>(webApiTypeGet, {\r\n      params: { appId: this.appId, contentTypeId: nameId }\r\n    });\r\n  }\r\n\r\n  getType(nameId: string) {\r\n    return httpResource<ContentType>(() => ({\r\n      url: this.apiUrl(webApiTypeGet),\r\n      params: { appId: this.appId, contentTypeId: nameId }\r\n    }));\r\n  }\r\n\r\n  getTypes(scope: Signal<string>) {\r\n    return httpResource<ContentType[]>(() => ({\r\n      url: this.apiUrl(webApiTypes),\r\n      params: { appId: this.appId, scope: scope() }\r\n    }), {defaultValue: []});\r\n  }\r\n\r\n  retrieveContentTypesPromise(scope: string): Promise<ContentType[]> {\r\n    return this.fetchPromise<ContentType[]>(webApiTypes, {\r\n      params: { appId: this.appId, scope }\r\n    });\r\n  }\r\n\r\n  getScopesPromise(): Promise<ScopeOption[]> {\r\n    return this.fetchPromise<{ old: Record<string, string>, scopes: ScopeDetailsDto[] }>(webApiTypeScopes, {\r\n      params: { appId: this.appId }\r\n    }).then(scopesData => {\r\n      const scopes = scopesData.old;\r\n      const scopeOptions: ScopeOption[] = Object.keys(scopes).map(key => ({\r\n        name: scopes[key],\r\n        value: key,\r\n      }));\r\n      return scopeOptions;\r\n    });\r\n  }\r\n\r\n  getScopesSig() {\r\n    const scopesSignal = httpResource<{ old: Record<string, string>, scopes: ScopeDetailsDto[] }>(() => ({\r\n      url: this.apiUrl(webApiTypeScopes),\r\n      params: { appid: this.appId },\r\n    }));\r\n\r\n    const scopeOptionsSignal = computed(() => {\r\n      // Access the value property directly without calling scopesSignal as a function\r\n      const value = scopesSignal.value;\r\n      const scopesData = value();\r\n\r\n      // Add null/undefined check here\r\n      if (!scopesData || !scopesData.old) {\r\n        return []; // Return an empty array or handle this case as appropriate\r\n      }\r\n\r\n      const scopes = scopesData.old;\r\n      return Object.keys(scopes).map(key => ({ name: scopes[key], value: key }));\r\n    });\r\n\r\n    return scopeOptionsSignal;\r\n  }\r\n\r\n  getScopesV2Promise(): Promise<ScopeDetailsDto[]> {\r\n    return this.fetchPromise<{ old: Record<string, string>, scopes: ScopeDetailsDto[] }>(webApiTypeScopes, {\r\n      params: { appId: this.appId }\r\n    }).then(scopesData => scopesData.scopes);\r\n  }\r\n\r\n  save(contentType: ContentTypeEdit) {\r\n    return this.http.post<boolean>(this.apiUrl(webApiTypeSave), contentType, {\r\n      params: { appid: this.appId },\r\n    });\r\n  }\r\n\r\n  delete(contentType: ContentType) {\r\n    return this.http.delete<boolean>(this.apiUrl(webApiTypeDelete), {\r\n      params: { appid: this.appId, staticName: contentType.NameId }, // TODO: @2pp - replace staticName with NameId\r\n    });\r\n  }\r\n\r\n  import(files: File[]) {\r\n    const formData = new FormData();\r\n    for (const file of files) {\r\n      formData.append('File', file);\r\n    }\r\n    return this.http.post<FileUploadResult>(this.apiUrl(webApiTypeImport), formData, {\r\n      params: { appId: this.appId, zoneId: this.zoneId },\r\n    });\r\n  }\r\n\r\n  createGhost(sourceNameId: string) {\r\n    return this.http.post<boolean>(this.apiUrl(webApiTypeAddGhost), null, {\r\n      params: { appid: this.appId, sourceNameId },\r\n    });\r\n  }\r\n}\r\n","/**\r\n * Checks if the keyboard event is triggered by the Escape key.\r\n * @param event KeyboardEvent\r\n * @returns boolean\r\n */\r\nexport function isEscape(event: KeyboardEvent): boolean {\r\n  return event.key === 'Escape';\r\n}\r\n\r\n/**\r\n * Checks if the keyboard event is triggered by Ctrl + S (or Cmd + S on Mac).\r\n * @param event KeyboardEvent\r\n * @returns boolean\r\n */\r\nexport function isCtrlS(event: KeyboardEvent): boolean {\r\n  return (event.key === 's' || event.key === 'S') && (event.ctrlKey || event.metaKey);\r\n}\r\n\r\n/**\r\n * Checks if the keyboard event is triggered by Ctrl + Enter (or Cmd + Enter on Mac).\r\n * @param event KeyboardEvent\r\n * @returns boolean\r\n */\r\nexport function isCtrlEnter(event: KeyboardEvent): boolean {\r\n  return event.key === 'Enter' && (event.ctrlKey || event.metaKey);\r\n}","import { Injectable } from '@angular/core';\r\nimport { HttpServiceBaseSignal } from '../../shared/services/http-service-base-signal';\r\nimport { ContentExport } from '../models/content-export.model';\r\n\r\nconst webApiEntityRootDownload = 'admin/entity/Download';\r\nconst webApiEntityRootJson = 'admin/entity/Json';\r\nconst webApiTypeRootJson = 'admin/type/Json';\r\n\r\n\r\n@Injectable()\r\nexport class ContentExportService extends HttpServiceBaseSignal {\r\n\r\n  exportContent(values: ContentExport, selectedIds: number[]) {\r\n    const selectedIdsString = selectedIds ? '&selectedids=' + selectedIds.join() : '';\r\n    const url = this.apiUrl(webApiEntityRootDownload)\r\n      + '?appId=' + this.appId\r\n      + '&language=' + values.language\r\n      + '&defaultLanguage=' + values.defaultLanguage\r\n      + '&contentType=' + values.contentTypeStaticName\r\n      + '&recordExport=' + values.recordExport\r\n      + '&resourcesReferences=' + values.resourcesReferences\r\n      + '&languageReferences=' + values.languageReferences\r\n      + selectedIdsString;\r\n\r\n    window.open(url, '_blank', '');\r\n  }\r\n\r\n  exportJson(typeName: string) {\r\n    const url = this.apiUrl(webApiTypeRootJson)\r\n      + '?appId=' + this.appId\r\n      + '&name=' + typeName;\r\n\r\n    window.open(url, '_blank', '');\r\n  }\r\n\r\n  exportEntity(id: number, prefix: string, metadata: boolean) {\r\n    const url = this.apiUrl(webApiEntityRootJson)\r\n      + '?appId=' + this.appId\r\n      + '&id=' + id\r\n      + '&prefix=' + prefix\r\n      + '&withMetadata=' + metadata;\r\n\r\n    window.open(url, '_blank', '');\r\n  }\r\n\r\n}\r\n"],"x_google_ignoreList":[]}