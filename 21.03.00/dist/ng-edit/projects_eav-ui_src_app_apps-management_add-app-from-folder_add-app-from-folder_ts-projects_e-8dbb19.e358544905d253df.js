"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_eav-ui_src_app_apps-management_add-app-from-folder_add-app-from-folder_ts-projects_e-8dbb19"],{69914(_,u,e){e.d(u,{$:()=>f});var g=e(36124),p=e(80436);let f=(()=>{class d{constructor(l){this.sanitizer=l}transform(l){return this.sanitizer.bypassSecurityTrustHtml(l)}static{this.\u0275fac=function(A){return new(A||d)(g.rXU(p.up,16))}}static{this.\u0275pipe=g.EJ8({name:"safeHtml",type:d,pure:!0})}}return d})()},74247(_,u,e){e.r(u),e.d(u,{AddAppFromFolderComponent:()=>R});var g=e(56884),p=e(84175),f=e(87941),d=e(12938),b=e(66184),l=e(28136),A=e(9001),I=e(11828),v=e(60251),P=e(67037),y=e(83583),C=e(93840),c=e(34601),t=e(36124);let o=(()=>{class i{agInit(s){this.name=s.value,this.tooltip=s.tooltipGetter(s.data)}refresh(s){return!0}static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-app-name-show"]],decls:5,vars:2,consts:[[1,"name-box"],[1,"info-icon",3,"tippy"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"span"),t.EFF(2),t.k0s(),t.j41(3,"mat-icon",1),t.EFF(4,"info"),t.k0s()()),2&a&&(t.R7$(2),t.JRh(n.name),t.R7$(),t.Y8G("tippy",n.tooltip))},dependencies:[C.m_,C.An,c.e],styles:[".name-box[_ngcontent-%COMP%]{display:flex;align-items:center}.info-icon[_ngcontent-%COMP%]{margin-left:7px;margin-bottom:3px}"]})}}return i})(),r=(()=>{class i{agInit(s){this.params=s}refresh(s){return!0}onChange(s){this.params.onChange(this.params.data,s.currentTarget.checked)}static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-checkbox-cell"]],decls:2,vars:2,consts:[[1,"checkbox-box"],["type","checkbox",1,"checkbox-input",3,"change","disabled","checked"]],template:function(a,n){1&a&&(t.rj2(0,"div",0)(1,"input",1),t.VwU("change",function(F){return n.onChange(F)}),t.eux()()),2&a&&(t.R7$(),t.Avn("disabled",n.params.isDisabled)("checked",n.params.value))},styles:[".checkbox-box[_ngcontent-%COMP%]{height:100%;display:flex;align-items:center}.checkbox-input[_ngcontent-%COMP%]{height:15px;width:15px}"]})}}return i})();var h=e(3347),E=e(58857);function x(i,D){1&i&&(t.j41(0,"p"),t.EFF(1," Nothing to show. All apps in the 2sxc folder are already installed. "),t.k0s())}function O(i,D){if(1&i&&(t.j41(0,"div"),t.nrm(1,"ag-grid-angular",8),t.k0s()),2&i){const s=t.XpG();t.R7$(),t.Y8G("rowData",s.pendingApps())("gridOptions",s.gridOptions)}}let R=(()=>{class i{#e;#t;constructor(s,a){this.dialog=s,this.snackBar=a,this.hostClass="dialog-component",this.gridOptions=this.buildGridOptions(),this.installing=!1,this.features=(0,g.WQX)(A.D),this.#e=this.features.isEnabled[l.T.AppSyncWithSiteFiles],this.#t=(0,d.d)(y.U),this.AppSyncWithSiteFiles=l.T.AppSyncWithSiteFiles,this.pendingApps=this.#t.getPendingApps().value}closeDialog(){this.dialog.close()}onChange(s,a){const n=this.pendingApps();a?n.push(s):n.splice(n.indexOf(s),1),this.pendingApps.set(n)}install(){this.installing=!0,this.snackBar.open("Installing",void 0,{duration:2e3}),this.#t.installPendingApps(this.pendingApps()).subscribe({error:()=>{this.installing=!1,this.snackBar.open("Failed to install app. Please check console for more information",void 0,{duration:3e3})},next:()=>{this.installing=!1,this.snackBar.open("Installed app",void 0,{duration:2e3}),this.closeDialog()}})}buildGridOptions(){return{...v.C,columnDefs:[{field:"",width:40,cellClass:"no-outline",sortable:!0,cellRenderer:r,cellRendererParams:()=>({isDisabled:!this.#e(),onChange:(n,m)=>this.onChange(n,m)})},{...I.r.ItemsText,field:"Name",flex:1,sort:"asc",cellRenderer:o,cellRendererParams:{tooltipGetter:n=>`Server folder: ${n.ServerFolder}\nFolder: ${n.Folder}\nVersion: ${n.Version}\nDescription: ${n.Description}`}}]}}static{this.\u0275fac=function(a){return new(a||i)(t.rXU(f.CP),t.rXU(h.UG))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-add-app-from-folder"]],hostVars:1,hostBindings:function(a,n){2&a&&t.Avn("className",n.hostClass)},decls:15,vars:4,consts:[[1,"eav-dialog"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],[1,"eav-dialog-content"],[3,"featureNameId"],["align","end"],["type","button","mat-raised-button","",3,"click"],["type","button","mat-raised-button","",1,"eav-action-button",3,"click","disabled"],[1,"ag-theme-material","eav-grid",3,"rowData","gridOptions"]],template:function(a,n){if(1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.EFF(3,"Add App from Folder"),t.k0s()(),t.j41(4,"div",3),t.nrm(5,"app-feature-info-box",4),t.j41(6,"p"),t.EFF(7," Select an app from the apps-folder which has been copied there (or git-cloned) but not installed yet. "),t.k0s(),t.nVh(8,x,2,0,"p"),t.nVh(9,O,2,2,"div"),t.k0s(),t.j41(10,"mat-dialog-actions",5)(11,"button",6),t.bIt("click",function(){return n.closeDialog()}),t.EFF(12," Cancel "),t.k0s(),t.j41(13,"button",7),t.bIt("click",function(){return n.install()}),t.EFF(14," Install "),t.k0s()()()),2&a){let m,F;t.R7$(5),t.Y8G("featureNameId",n.AppSyncWithSiteFiles),t.R7$(3),t.vxM(0==(null==(m=n.pendingApps())?null:m.length)?8:-1),t.R7$(),t.vxM((null==(F=n.pendingApps())?null:F.length)>0?9:-1),t.R7$(4),t.Y8G("disabled",0===n.pendingApps().length||n.installing)}},dependencies:[f.E7,p.Hl,p.$z,b.b,P.p,E.xs],styles:[".eav-grid[_ngcontent-%COMP%]{height:200px;width:auto}"]})}}return i})()},83583(_,u,e){e.d(u,{U:()=>C});var g=e(89204),p=e(46443),f=e(24467),d=e(56884),b=e(36124);const v="admin/app/app";let C=(()=>{class c extends f.B{getAllLive(o){return(0,p.fx)(()=>(o(),{url:this.apiUrl("admin/app/list"),params:{zoneId:this.zoneId}}))}getInheritable(){return(0,p.fx)(()=>({url:this.apiUrl("admin/app/InheritableApps"),params:{zoneId:this.zoneId}}))}getPendingApps(){return(0,p.fx)(()=>({url:this.apiUrl("admin/app/GetPendingApps"),params:{zoneId:this.zoneId}}))}create(o,r,h){return this.http.post(this.apiUrl(v),{},{params:{zoneId:this.zoneId,name:o,...null!=r&&{inheritAppId:r},...null!=h&&{templateId:h}}})}createTemplate(o,r){const h=encodeURIComponent(r);return this.http.post(`sys/install/RemotePackage?packageUrl=${o}&newName=${h}`,{})}installPendingApps(o){return this.http.post(this.apiUrl("admin/app/InstallPendingApps"),o,{params:{zoneId:this.zoneId}})}delete(o){return this.http.delete(this.apiUrl(v),{params:{zoneId:this.zoneId,appId:o.toString()}})}flushCache(o){var r=this;return(0,g.A)(function*(){return r.getStatusPromise("admin/app/flushcache",{params:{zoneId:r.zoneId,appId:o.toString()}})})()}static{this.\u0275fac=(()=>{let o;return function(h){return(o||(o=b.xGo(c)))(h||c)}})()}static{this.\u0275prov=d.jDH({token:c,factory:c.\u0275fac})}}return c})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/21.03.00/dist/ng-edit/projects_eav-ui_src_app_apps-management_add-app-from-folder_add-app-from-folder_ts-projects_e-8dbb19.e358544905d253df.js.map