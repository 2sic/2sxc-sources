{"version":3,"file":"projects_eav-ui_src_app_app-administration_copilot_page_copilot-page_ts.a4575b0702b19233.js","mappings":"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","names":["CopilotActionsComponent","agInit","params","this","item","data","refresh","do","verb","selectors","decls","vars","consts","template","rf","ctx","i0","MatRippleModule","i1","MatIconModule","i2","TippyDirective","encapsulation","ctx_r0","dataSourceData","gridOptions","CopilotGeneratorComponent_Conditional_7_Conditional_0_Template","CopilotGeneratorComponent_Conditional_7_Conditional_1_Template","length","generator_r2","name","version","description","descriptionHtml","edition_r4","label","$event","_r3","selectedEdition","CopilotGeneratorComponent_Conditional_26_For_5_Template","sort","CopilotGeneratorComponent","constructor","buildGridOptions","signal","outputType","input","title","#entitySvc","transient","EntityService","#dialogRouter","DialogRoutingService","#matDialog","MatDialog","#snackBar","MatSnackBar","#context","Context","#http","HttpClient","#dataSvc","SysDataService","#contentItemsSvc","ContentItemsService","#viewContainerRef","inject","ViewContainerRef","#copilotConfigurationGuid","#webApiGeneratedCode","displayedColumns","#data","getMany","source","computed","$filter","streams","generators","value","default","filter","g","#generators$","toObservable","selectedGeneratorName","linkedSignal","selectedGenerator","gens","selected","find","#editions","get","editions","map","e","replace","isDefault","showConfigurationDropdown","defaultGridOptions","columnDefs","ColumnDefinitions","TextWideMin100","headerName","field","flex","cellRenderer","ActionsPinnedRight5","cellRendererParams","generateForConfiguration","deleteConfiguration","onCellClicked","event","colDef","editConfig","target","dataset","action","ngOnInit","fetchEntities","doOnDialogClosed","entities$","subscribe","set","allEntities$","from","getAllPromise","combineLatest","pipe","currentGenerators","entities","generatorNames","Set","has","CodeGenerator","entity","selectedEntity","form","items","ItemIdHelper","editId","Id","newFromType","OutputType","url","convertFormToUrl","navRelative","open","ConfirmDeleteDialogComponent","autoFocus","entityId","entityTitle","Title","message","hasDeleteSnackbar","viewContainerRef","width","afterClosed","isConfirmed","delete","appId","next","duration","undefined","error","console","edition","generator","configurationId","result","timeTaken","autoGeneratedCode","toggleConfigurationDropdown","update","inputs","CopilotGeneratorComponent_Conditional_7_Template","CopilotGeneratorComponent_For_23_Template","CopilotGeneratorComponent_Conditional_24_Template","CopilotGeneratorComponent_Conditional_26_Template","tmp_0_0","tmp_1_0","tmp_5_0","tmp_6_0","CommonModule","FormsModule","MatButtonModule","MatCardModule","i3","MatSelectModule","i4","i5","i6","MatTableModule","RouterOutlet","SxcGridModule","i7","i8","styles","CopilotPageComponent","activatedRoute","snapshot","heading","intro"],"ignoreList":[],"sourceRoot":"webpack:///","sources":["./projects/eav-ui/src/app/app-administration/copilot/copilot-actions/copilot-actions.ts","./projects/eav-ui/src/app/app-administration/copilot/copilot-actions/copilot-actions.html","./projects/eav-ui/src/app/app-administration/copilot/copilot-generator.html","./projects/eav-ui/src/app/app-administration/copilot/copilot-generator.ts","./projects/eav-ui/src/app/app-administration/copilot/page/copilot-page.ts","./projects/eav-ui/src/app/app-administration/copilot/page/copilot-page.html"],"sourcesContent":["import { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { ICellRendererParams } from '@ag-grid-community/core';\r\nimport { Component } from '@angular/core';\r\nimport { MatRippleModule } from '@angular/material/core';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { TippyDirective } from '../../../shared/directives/tippy.directive';\r\nimport { CopilotActionsParams, CopilotActionsType } from './copilot-actions.models';\r\n\r\n@Component({\r\n  selector: 'app-copilot-actions',\r\n  templateUrl: './copilot-actions.html',\r\n  imports: [MatRippleModule, MatIconModule, TippyDirective],\r\n})\r\nexport class CopilotActionsComponent implements ICellRendererAngularComp {\r\n  item: any;\r\n  private params: ICellRendererParams & CopilotActionsParams;\r\n\r\n  agInit(params: ICellRendererParams & CopilotActionsParams): void {\r\n    this.params = params;\r\n    this.item = params.data;\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n\r\n  do(verb: CopilotActionsType) {\r\n    this.params.do(verb, this.item);\r\n  }\r\n}\r\n","<div class=\"actions-component\" style=\"display: flex; align-items: center; justify-content: center; gap: 12px; height: 100%;\">\r\n  <div class=\"eav-grid-action-button highlight\" matRipple tippy=\"Generate Code\" (click)=\"do('generate')\" style=\"display: flex; align-items: center; gap: 2px; white-space: nowrap; min-width: 120px; justify-content: center;\">\r\n    <mat-icon>code</mat-icon>\r\n    <span style=\"padding-left: 2px;\">Generate Code</span>\r\n  </div>\r\n  <div class=\"eav-grid-action-button highlight\" matRipple tippy=\"Delete\" (click)=\"do('delete')\" style=\"display: flex; align-items: center; justify-content: center;\">\r\n    <mat-icon>delete</mat-icon>\r\n  </div>\r\n</div>\r\n","<div style=\"display: flex; align-items: center; justify-content: space-between; gap: 8px; padding: 0 16px\">\r\n  <h3 class=\"mat-subtitle-1\">Configurations ({{ (entities$ | async)?.length || 0 }})</h3>\r\n  <button mat-fab mat-elevation-z24 class=\"grid-fab\" tippy=\"Add Configuration\" tippyPlacement=\"left\" (click)=\"editConfig()\">\r\n    <mat-icon>add</mat-icon>\r\n  </button>\r\n</div>\r\n\r\n@if (entities$ | async; as entities) { \r\n  @if (entities.length === 0) {\r\n    <p class=\"mat-body-1\">No configurations yet. Click + to create one.</p>\r\n  } @else {\r\n    <div style=\"padding: 0 16px\">\r\n      <ag-grid-angular\r\n        class=\"ag-theme-material\"\r\n        style=\"width: 100%\"\r\n        [rowData]=\"dataSourceData()\"\r\n        [gridOptions]=\"gridOptions\"\r\n        domLayout=\"autoHeight\"\r\n      ></ag-grid-angular>\r\n    </div>\r\n  } \r\n}\r\n\r\n<div style=\"max-width: 400px; margin-top: 24px; margin-left: 16px\">\r\n  <mat-card>\r\n    <mat-card-content>\r\n      <h3 class=\"mat-subtitle-1\">Quick Generate</h3>\r\n      <br />\r\n\r\n      <div style=\"max-width: 400px\">\r\n        <mat-form-field color=\"accent\" class=\"eav-mat-form-field\">\r\n          <mat-label>Generator</mat-label>\r\n          <mat-select required [(value)]=\"selectedGeneratorName\">\r\n            <mat-select-trigger> {{ selectedGeneratorName() }} </mat-select-trigger>\r\n            @for (generator of generators().sort(); track generator) {\r\n              <mat-option [value]=\"generator.name\">\r\n                <strong>{{ generator.name }} v{{ generator.version }}</strong>\r\n                <br />\r\n                {{ generator.description }}\r\n              </mat-option>\r\n            }\r\n          </mat-select>\r\n          @if (selectedGenerator(); as selectedGenerator) {\r\n            <ng-container>\r\n              <mat-hint [innerHTML]=\"selectedGenerator.descriptionHtml\"></mat-hint>\r\n            </ng-container>\r\n          }\r\n        </mat-form-field>\r\n        \r\n        <br />\r\n\r\n        @if (editions(); as editions) {\r\n          <mat-form-field color=\"accent\" class=\"eav-mat-form-field\">\r\n            <mat-label>Select an Edition to generate code for</mat-label>\r\n            <mat-select required [(value)]=\"selectedEdition\">\r\n              @for (edition of editions.sort(); track edition) {\r\n                <mat-option [value]=\"edition.name\"> <strong>{{ edition.label }}</strong> ({{ edition.description }}) </mat-option>\r\n              }\r\n            </mat-select>\r\n            <mat-hint>\r\n              Editions are managed in the <code>/App_Data/app.json</code> file. See\r\n              <a href=\"https://go.2sxc.org/app-json\" target=\"_blank\">docs</a>.\r\n            </mat-hint>\r\n          </mat-form-field>\r\n        }\r\n\r\n        <br />\r\n        <div style=\"display: flex; justify-content: flex-end\">\r\n          <button mat-button class=\"eav-button__with-icon\" (click)=\"autoGeneratedCode()\">\r\n            <mat-icon class=\"eav-icon\">code</mat-icon>\r\n            <span>Generate Code</span>\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </mat-card-content>\r\n  </mat-card>\r\n</div>\r\n\r\n<router-outlet></router-outlet>\r\n","import { GridOptions } from '@ag-grid-community/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Component, computed, inject, input, linkedSignal, signal, ViewContainerRef } from '@angular/core';\r\nimport { toObservable } from '@angular/core/rxjs-interop';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatCardModule } from '@angular/material/card';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatSelectModule } from '@angular/material/select';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { MatTableModule } from '@angular/material/table';\r\nimport { RouterOutlet } from '@angular/router';\r\nimport { combineLatest, from, map, Observable } from 'rxjs';\r\nimport { transient } from '../../../../../core';\r\nimport { ContentItemsService } from '../../content-items/services/content-items.service';\r\nimport { FeatureSummary } from '../../features/models';\r\nimport { ColumnDefinitions } from '../../shared/ag-grid/column-definitions';\r\nimport { defaultGridOptions } from '../../shared/constants/default-grid-options.constants';\r\nimport { TippyDirective } from '../../shared/directives/tippy.directive';\r\nimport { convertFormToUrl } from '../../shared/helpers/url-prep.helper';\r\nimport { EditForm } from '../../shared/models/edit-form.model';\r\nimport { ItemIdHelper } from '../../shared/models/item-id-helper';\r\nimport { RichResult } from '../../shared/models/rich-result';\r\nimport { SxcGridModule } from '../../shared/modules/sxc-grid-module/sxc-grid.module';\r\nimport { DialogRoutingService } from '../../shared/routing/dialog-routing.service';\r\nimport { Context } from '../../shared/services/context';\r\nimport { EntityService } from '../../shared/services/entity.service';\r\nimport { SysDataService } from '../../shared/services/sys-data.service';\r\nimport { ConfirmDeleteDialogComponent } from '../sub-dialogs/confirm-delete-dialog/confirm-delete-dialog';\r\nimport { ConfirmDeleteDialogData } from '../sub-dialogs/confirm-delete-dialog/confirm-delete-dialog.models';\r\nimport { CodeGenerator } from './code-generator';\r\nimport { CopilotActionsComponent } from './copilot-actions/copilot-actions';\r\n\r\ntype DataCopilotConfiguration = {\r\n  Guid: string;\r\n  Id: number;\r\n  Title?: string;\r\n  CodeGenerator?: string;\r\n};\r\n\r\n@Component({\r\n  selector: 'app-copilot-generator',\r\n  templateUrl: './copilot-generator.html',\r\n  styleUrls: ['./copilot-generator.scss'],\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    MatButtonModule,\r\n    MatCardModule,\r\n    MatIconModule,\r\n    MatSelectModule,\r\n    MatTableModule,\r\n    RouterOutlet,\r\n    TippyDirective,\r\n    SxcGridModule,\r\n  ]\r\n})\r\nexport class CopilotGeneratorComponent {\r\n\r\n  gridOptions: GridOptions = this.buildGridOptions();\r\n  dataSourceData = signal<DataCopilotConfiguration[]>([]);\r\n\r\n  private buildGridOptions(): GridOptions {\r\n    return {\r\n      ...defaultGridOptions,\r\n      columnDefs: [\r\n        {\r\n          ...ColumnDefinitions.TextWideMin100,\r\n          headerName: 'Name',\r\n          field: 'Title',\r\n          flex: 2,\r\n          cellRenderer: (params: any) => `<a class='default-link' href='javascript:void(0)'>${params.value || '(Untitled)'}</a>`\r\n        },\r\n        {\r\n          ...ColumnDefinitions.TextWideMin100,\r\n          headerName: 'Generator',\r\n          field: 'CodeGenerator',\r\n        },\r\n        {\r\n          ...ColumnDefinitions.ActionsPinnedRight5,\r\n          headerName: 'Actions',\r\n          cellRenderer: CopilotActionsComponent,\r\n          cellRendererParams: {\r\n            do: (verb: 'generate' | 'delete', item: any) => {\r\n              switch (verb) {\r\n                case 'generate': \r\n                this.generateForConfiguration(item); break;\r\n                \r\n                case 'delete': \r\n                this.deleteConfiguration(item); break;\r\n              }\r\n            }\r\n          }\r\n        },\r\n      ],\r\n      onCellClicked: (event: any) => {\r\n        if (event.colDef.headerName === 'Name') {\r\n          this.editConfig(event.data);\r\n        }\r\n        if (event.colDef.headerName === 'Actions') {\r\n\r\n          if (event.event.target?.dataset?.action === 'generate') \r\n            this.generateForConfiguration(event.data);\r\n          \r\n          if (event.event.target?.dataset?.action === 'delete') \r\n            this.deleteConfiguration(event.data);\r\n        }\r\n      },\r\n    };\r\n  }\r\n  outputType = input<string>();\r\n  title = input<string>('Copilot Generator');\r\n\r\n  #entitySvc = transient(EntityService);\r\n  #dialogRouter = transient(DialogRoutingService);\r\n  #matDialog = transient(MatDialog);\r\n  #snackBar = transient(MatSnackBar);\r\n  #context = transient(Context);\r\n  #http = transient(HttpClient);\r\n  #dataSvc = transient(SysDataService);\r\n  #contentItemsSvc = transient(ContentItemsService);\r\n  #viewContainerRef = inject(ViewContainerRef);\r\n\r\n  readonly #copilotConfigurationGuid = 'b08dcd23-2eb0-4a5e-a3d0-3178d2aae451';\r\n  readonly #webApiGeneratedCode = 'admin/code/generateDataModels';\r\n\r\n  entities$: Observable<DataCopilotConfiguration[]>;\r\n  displayedColumns = ['title', 'generator', 'actions'];\r\n\r\n  // Get the data from multiple streams in one go.\r\n  // Note that it's an httpResource, so it may still be loading, and the value may be null at the beginning\r\n  #data = this.#dataSvc.getMany<{ default: CodeGenerator[], outputType: { name: string }[], feature: FeatureSummary[] }>({\r\n    source: 'f512e44b-5b34-4a32-bfe3-d46d46800a7f', // Code Generators DataSource internal ID\r\n    // Note 2dm: params temporarily turned off, as it affects all streams (accidentally) hiding the OutputType stream\r\n    params: computed(() => ({\r\n      '$filter': `OutputType eq '${this.outputType()}'`,\r\n    })),\r\n    streams: '*', // All streams\r\n  });\r\n  \r\n  generators = computed(() => \r\n    // 2dm: had to temporarily move the outputType filter to here, as we can't use OData till I fix something\r\n    this.#data.value()?.default.filter(g => g.outputType === this.outputType())\r\n      ?? []  // may still be loading...\r\n  );\r\n\r\n  // generators = this.#dataSvc.get<CodeGenerator>({\r\n  //   source: 'f512e44b-5b34-4a32-bfe3-d46d46800a7f', // Code Generators DataSource internal ID\r\n  //   params: computed(() => ({\r\n  //     '$filter': `OutputType eq '${this.outputType()}'`,\r\n  //   })),\r\n  //   streams: 'Default,OutputType',\r\n  // });\r\n\r\n  #generators$ = toObservable(this.generators);\r\n\r\n  selectedGeneratorName = linkedSignal(() => this.generators()?.[0]?.name ?? '');\r\n\r\n  selectedGenerator = computed(() => {\r\n    const gens = this.generators();\r\n    const selected = this.selectedGeneratorName();\r\n    return gens.find(g => g.name === selected);\r\n  });\r\n\r\n  #editions = this.#dataSvc.get<{ name: string; label: string; description: string, isDefault: boolean }>({\r\n    source: 'ToSic.Sxc.DataSources.AppEditions',\r\n  });\r\n\r\n  editions = computed(() => this.#editions().map(e => ({\r\n    name: e.name,\r\n    label: `/${e.name}/AppCode/Data`.replace(/\\/\\//g, '/'),\r\n    description: (e.description || 'no description provided') + (e.isDefault ? ' âœ…' : '')\r\n  })));\r\n\r\n  selectedEdition = linkedSignal(() => this.#editions().find(e => e.isDefault)?.name ?? '');\r\n\r\n  selectedEntity?: DataCopilotConfiguration;\r\n  showConfigurationDropdown = signal(false);\r\n\r\n  ngOnInit(): void {\r\n    this.fetchEntities();\r\n    this.#dialogRouter.doOnDialogClosed(() => this.fetchEntities());\r\n    // Update dataSourceData when entities$ emits\r\n    if (this.entities$) {\r\n      this.entities$.subscribe(data => this.dataSourceData.set(data ?? []));\r\n    }\r\n  }\r\n\r\n  fetchEntities(): void {\r\n    const allEntities$ = from(this.#contentItemsSvc.getAllPromise(this.#copilotConfigurationGuid));\r\n    this.entities$ = combineLatest([allEntities$, this.#generators$]).pipe(\r\n      map(([data, currentGenerators]) => {\r\n        const entities = data as DataCopilotConfiguration[];\r\n        const generatorNames = new Set(currentGenerators.map(g => g.name));\r\n        // Only show configurations that match one of the current generators\r\n        return entities.filter(e => generatorNames.has(e.CodeGenerator));\r\n      })\r\n    );\r\n    // Update dataSourceData when fetchEntities is called\r\n    if (this.entities$) {\r\n      this.entities$.subscribe(data => this.dataSourceData.set(data ?? []));\r\n    }\r\n  }\r\n\r\n  editConfig(entity?: DataCopilotConfiguration): void {\r\n    const target = entity ?? this.selectedEntity;\r\n    const form: EditForm = {\r\n      items: [target\r\n        ? ItemIdHelper.editId(target.Id)\r\n        : ItemIdHelper.newFromType(this.#copilotConfigurationGuid, {\r\n            CodeGenerator: this.selectedGeneratorName(),\r\n            OutputType: this.outputType()\r\n          })\r\n      ]\r\n    };\r\n    const url = convertFormToUrl(form);\r\n    this.#dialogRouter.navRelative([`edit/${url}`]);\r\n  }\r\n\r\n  deleteConfiguration(entity?: DataCopilotConfiguration): void {\r\n    const target = entity ?? this.selectedEntity;\r\n    if (!target) {\r\n      return;\r\n    }\r\n    const data: ConfirmDeleteDialogData = {\r\n      entityId: target.Id,\r\n      entityTitle: target.Title,\r\n      message: 'Are you sure you want to delete?',\r\n      hasDeleteSnackbar: true\r\n    };\r\n\r\n    this.#matDialog.open(ConfirmDeleteDialogComponent, {\r\n      autoFocus: false,\r\n      data,\r\n      viewContainerRef: this.#viewContainerRef,\r\n      width: '400px',\r\n    }).afterClosed().subscribe((isConfirmed: boolean) => {\r\n      if (isConfirmed) {\r\n        this.#entitySvc.delete(\r\n          this.#context.appId,\r\n          this.#copilotConfigurationGuid,\r\n            target.Id,\r\n          false\r\n        ).subscribe({\r\n          next: () => {\r\n            this.#snackBar.open('Deleted', null, { duration: 2000 });\r\n              if (this.selectedEntity?.Id === target.Id) {\r\n                this.selectedEntity = undefined;\r\n              }\r\n            this.fetchEntities();\r\n          },\r\n          error: (error) => {\r\n            console.error('Error deleting configuration:', error);\r\n            this.#snackBar.open('Error deleting configuration', null, { duration: 3000 });\r\n          }\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  generateForConfiguration(entity: DataCopilotConfiguration): void {\r\n    this.#http.get<RichResult>(this.#webApiGeneratedCode, {\r\n      params: {\r\n        appId: this.#context.appId,\r\n        edition: this.selectedEdition(),\r\n        generator: this.selectedGeneratorName(),\r\n        configurationId: entity.Id,\r\n      }\r\n    }).subscribe(result => {\r\n      this.#snackBar.open(`${result.message} (took ${result.timeTaken}ms)`, null, { duration: 5000 });\r\n    });\r\n  }\r\n\r\n  autoGeneratedCode(): void {\r\n    const params: Record<string, string | number> = {\r\n      appId: this.#context.appId,\r\n      edition: this.selectedEdition(),\r\n      generator: this.selectedGeneratorName(),\r\n    };\r\n\r\n    if (this.selectedEntity) {\r\n      params.configurationId = this.selectedEntity.Id;\r\n    }\r\n\r\n    this.#http.get<RichResult>(this.#webApiGeneratedCode, { params }).subscribe(result => {\r\n      this.#snackBar.open(`${result.message} (took ${result.timeTaken}ms)`, null, { duration: 5000 });\r\n    });\r\n  }\r\n\r\n  toggleConfigurationDropdown(): void {\r\n    this.showConfigurationDropdown.update(value => !value);\r\n  }\r\n}\r\n","import { Component } from '@angular/core';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { ActivatedRoute, RouterOutlet } from '@angular/router';\r\nimport { CopilotGeneratorComponent } from '../copilot-generator';\r\nimport { CopilotSpec } from '../copilot-specs';\r\n\r\n@Component({\r\n  selector: 'app-data-copilot',\r\n  templateUrl: './copilot-page.html',\r\n  styleUrl: './copilot-page.scss',\r\n  imports: [\r\n    CopilotGeneratorComponent,\r\n    RouterOutlet,\r\n    MatIconModule,\r\n  ]\r\n})\r\nexport class CopilotPageComponent {\r\n\r\n  data: CopilotSpec;\r\n\r\n  constructor(activatedRoute: ActivatedRoute) {\r\n    this.data = activatedRoute.snapshot.data as CopilotSpec;\r\n  }\r\n}\r\n","<div class=\"outer-container\" style=\"margin-bottom: 0;\">\r\n  <div style=\"display: flex; align-items: center; justify-content: space-between; width: 100%;\">\r\n    <h1>{{ data.heading }}</h1>\r\n    <mat-icon style=\"font-size: 55px; width: 64px; height: 64px;\">support_agent</mat-icon>\r\n  </div>\r\n  <p style=\"margin-bottom: 0;\">\r\n    {{ data.intro }}\r\n  </p>\r\n</div>\r\n\r\n<app-copilot-generator\r\n  [outputType]=\"data.outputType\"\r\n  [title]=\"data.title\"\r\n></app-copilot-generator>\r\n\r\n<router-outlet></router-outlet>"],"x_google_ignoreList":[]}