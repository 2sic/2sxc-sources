(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{LDtw:function(t,e,n){"use strict";n.r(e),n.d(e,"ReplaceContentComponent",function(){return S});var i=n("mrSG"),o=n("tyNb"),c=n("quSY"),a=n("2Vo4"),r=n("itXk"),s=n("lJxs"),l=n("pLZG"),u=n("JX91"),p=n("Zy1z"),d=n("X9FW"),b=n("fXoL"),f=n("0IaG"),h=n("n63V"),m=n("dNgK"),g=n("ofXK"),v=n("kmnG"),x=n("qFsG"),y=n("/1cH"),C=n("3Pt+"),O=n("vxfF"),M=n("bTqV"),V=n("Qu3c"),k=n("NFeN"),T=n("FKr1");function j(t,e){if(1&t&&(b.Vb(0,"mat-option",15),b.Mc(1),b.Ub()),2&t){var n=e.$implicit;b.nc("value",n),b.Db(1),b.Nc(n)}}function $(t,e){if(1&t){var n=b.Wb();b.Tb(0),b.Vb(1,"div",1),b.Vb(2,"div",2),b.Mc(3),b.Ub(),b.Ub(),b.Qb(4,"router-outlet"),b.Vb(5,"p",3),b.Mc(6),b.Ub(),b.Vb(7,"div",4),b.Vb(8,"mat-form-field",5),b.Vb(9,"mat-label"),b.Mc(10,"Choose item"),b.Ub(),b.Vb(11,"input",6),b.dc("ngModelChange",function(t){return b.Ac(n),b.hc().setFilter(t)}),b.Ub(),b.Vb(12,"mat-autocomplete",7,8),b.dc("optionSelected",function(t){return b.Ac(n),b.hc().select(t)}),b.Vb(14,"cdk-virtual-scroll-viewport",9),b.Kc(15,j,2,2,"mat-option",10),b.Ub(),b.Ub(),b.Ub(),b.Vb(16,"button",11),b.dc("click",function(){return b.Ac(n),b.hc().copySelected()}),b.Vb(17,"mat-icon"),b.Mc(18,"file_copy"),b.Ub(),b.Ub(),b.Ub(),b.Vb(19,"div",12),b.Vb(20,"button",13),b.dc("click",function(){return b.Ac(n),b.hc().closeDialog()}),b.Mc(21,"Cancel"),b.Ub(),b.Vb(22,"button",14),b.dc("click",function(){return b.Ac(n),b.hc().save()}),b.Mc(23,"Save"),b.Ub(),b.Ub(),b.Sb()}if(2&t){var i=e.ngIf,o=b.yc(13);b.Db(3),b.Nc(i.isAddMode?"Add Existing Item":"Replace Content Item"),b.Db(3),b.Oc(" ",i.isAddMode?"Select a content-item to add to this list.":"By replacing a content-item you can make other content appear in the slot of the original content."," "),b.Db(5),b.nc("matAutocomplete",o)("ngModel",i.filterText),b.Db(3),b.Hc("height",i.filteredOptions.length<6?48*i.filteredOptions.length:240,"px"),b.Db(1),b.nc("cdkVirtualForOf",i.filteredOptions),b.Db(1),b.nc("disabled",!i.isMatch),b.Db(6),b.nc("disabled",!i.isMatch)}}var S=function(){function t(t,e,n,i,o){this.dialogRef=t,this.contentGroupService=e,this.router=n,this.route=i,this.snackBar=o,this.hostClass="dialog-component"}return t.prototype.ngOnInit=function(){var t=this;this.guid=this.route.snapshot.paramMap.get("guid"),this.part=this.route.snapshot.paramMap.get("part"),this.index=parseInt(this.route.snapshot.paramMap.get("index"),10),this.add=!!this.route.snapshot.queryParamMap.get("add"),this.subscription=new c.a,this.filterText$=new a.a(""),this.options$=new a.a([]);var e=Object(r.a)([this.filterText$,this.options$]).pipe(Object(s.a)(function(t){var e=Object(i.g)(t,2),n=e[0];return e[1].filter(function(t){return t.label.toLocaleLowerCase().includes(n.toLocaleLowerCase())}).map(function(t){return t.label})}));this.templateVars$=Object(r.a)([this.filterText$,e]).pipe(Object(s.a)(function(e){var n=Object(i.g)(e,2),o=n[0],c=n[1];return{filterText:o,filteredOptions:c,isAddMode:t.add,isMatch:c.includes(o)}})),this.fetchConfig(!1,null),this.refreshOnChildClosed()},t.prototype.ngOnDestroy=function(){this.filterText$.complete(),this.options$.complete(),this.subscription.unsubscribe()},t.prototype.closeDialog=function(){this.dialogRef.close()},t.prototype.setFilter=function(t){this.filterText$.next(t)},t.prototype.select=function(t){this.filterText$.next(t.option.value)},t.prototype.copySelected=function(){var t=this.buildContentGroup(),e={items:[{ContentTypeName:this.contentTypeName,DuplicateEntity:t.id}]},n=Object(d.a)(e);this.router.navigate(["edit/"+n],{relativeTo:this.route})},t.prototype.save=function(){var t=this;this.snackBar.open("Saving...");var e=this.buildContentGroup();this.contentGroupService.saveItem(e).subscribe(function(){t.snackBar.open("Saved",null,{duration:2e3}),t.closeDialog()})},t.prototype.fetchConfig=function(t,e){var n=this,o=this.buildContentGroup();this.contentGroupService.getItems(o).subscribe(function(c){var a,r=Object.entries(c.Items).map(function(t){var e=Object(i.g)(t,2),n=e[0],o=e[1];return{id:parseInt(n,10),label:o+" ("+n+")"}});if(n.options$.next(r),!o.add&&!t||null!=e){var s=t?e:c.SelectedId,l=(null===(a=n.options$.value.find(function(t){return t.id===s}))||void 0===a?void 0:a.label)||"";n.filterText$.next(l)}n.contentTypeName=c.ContentTypeName})},t.prototype.refreshOnChildClosed=function(){var t=this;this.subscription.add(this.router.events.pipe(Object(l.a)(function(t){return t instanceof o.b}),Object(u.a)(!!this.route.snapshot.firstChild),Object(s.a)(function(){return!!t.route.snapshot.firstChild}),Object(p.a)(),Object(l.a)(function(t){var e=Object(i.g)(t,2);return e[0]&&!e[1]})).subscribe(function(){var e,n=null===(e=t.router.getCurrentNavigation().extras)||void 0===e?void 0:e.state,i=null==n?void 0:n[Object.keys(n)[0]];t.fetchConfig(!0,i)}))},t.prototype.buildContentGroup=function(){var t,e,n=this;return{id:null!==(e=null===(t=this.options$.value.find(function(t){return t.label===n.filterText$.value}))||void 0===t?void 0:t.id)&&void 0!==e?e:null,guid:this.guid,part:this.part,index:this.index,add:this.add}},t.\u0275fac=function(e){return new(e||t)(b.Pb(f.f),b.Pb(h.a),b.Pb(o.c),b.Pb(o.a),b.Pb(m.b))},t.\u0275cmp=b.Jb({type:t,selectors:[["app-replace-content"]],hostVars:1,hostBindings:function(t,e){2&t&&b.Yb("className",e.hostClass)},decls:2,vars:3,consts:[[4,"ngIf"],["mat-dialog-title",""],[1,"dialog-title-box"],[1,"dialog-description"],[1,"options-box"],["appearance","standard","color","accent",1,"options-box__field"],["matInput","",3,"matAutocomplete","ngModel","ngModelChange"],[3,"optionSelected"],["auto","matAutocomplete"],["itemSize","48","minBufferPx","500","maxBufferPx","1000"],[3,"value",4,"cdkVirtualFor","cdkVirtualForOf"],["mat-icon-button","","matTooltip","Copy",1,"options-box__copy",3,"disabled","click"],[1,"dialog-component-actions"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click"],[3,"value"]],template:function(t,e){1&t&&(b.Kc(0,$,24,9,"ng-container",0),b.ic(1,"async")),2&t&&b.nc("ngIf",b.jc(1,1,e.templateVars$))},directives:[g.n,f.g,o.e,v.c,v.g,x.b,y.c,C.c,C.m,C.p,y.a,O.d,O.a,O.c,M.a,V.a,k.a,T.k],pipes:[g.b],styles:[".options-box[_ngcontent-%COMP%]{display:flex;align-items:flex-end}.options-box__field[_ngcontent-%COMP%]{width:40%}.options-box__copy[_ngcontent-%COMP%]{margin-left:8px}"],changeDetection:0}),t}()}}]);
//# sourceMappingURL=https://sources.2sxc.org/12.02.00/ng-edit/replace-content-component.c8236078ba9afd6170cb.js.map