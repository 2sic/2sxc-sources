(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{XAsQ:function(t,e,n){"use strict";n.r(e),n.d(e,"EditContentTypeFieldsComponent",function(){return X});var i=n("mrSG"),o=n("3Pt+"),a=n("2Vo4"),c=n("quSY"),r=n("cp0P"),s=n("LRne"),l=n("w1tV"),p=n("5+tZ"),d=n("lJxs"),u=n("pLZG"),b=n("bOdf"),f=n("JIr8"),h=n("Kqap"),g=n("BFxc"),y=n("xbPD"),m=n("mCNh");function v(t,e,n){return 0===n?[e]:(t.push(e),t)}var T=n("OAPY"),O=n("bv8H"),M=n("3btq"),S=n("8gzK"),I={Boolean:{label:"Boolean (yes/no)",description:"Yes/no or true/false values"},Custom:{label:"Custom - ui-tools or custom types",description:"Use for things like gps-pickers (which writes into multiple fields) or for custom-data which serializes something exotic into the db like an array, a custom json or anything"},DateTime:{label:"Date and/or time",description:"For date, time or combined values"},Empty:{label:"Empty - for form-titles etc.",description:"Use to structure your form"},Entity:{label:"Entity (other content-items)",description:"One or more other content-items"},Hyperlink:{label:"Link / file reference",description:"Hyperlink or reference to a picture / file"},Number:{label:"Number",description:"Any kind of number"},String:{label:"Text / string",description:"Any kind of text"}},D=n("fXoL"),V=n("0IaG"),U=n("tyNb"),w=n("uwFg"),C=n("spPA"),N=n("dNgK"),F=n("ofXK"),j=n("bTqV"),x=n("kmnG"),k=n("qFsG"),P=n("d3UM"),$=n("NFeN"),K=n("PRNy"),H=n("FKr1"),A=["ngForm"];function E(t,e){1&t&&(D.Tb(0),D.Mc(1,"Fields"),D.Sb())}function L(t,e){1&t&&(D.Tb(0),D.Mc(1,"Edit Field"),D.Sb())}function B(t,e){1&t&&(D.Tb(0),D.Mc(1,"Add Fields"),D.Sb())}function R(t,e){if(1&t&&(D.Vb(0,"app-field-hint",22),D.Mc(1),D.Ub()),2&t){var n=D.hc(4);D.nc("isError",!0),D.Db(1),D.Nc(n.fieldNameError)}}function q(t,e){if(1&t&&(D.Tb(0),D.Kc(1,R,2,2,"app-field-hint",21),D.Sb()),2&t){D.hc();var n=D.yc(6);D.Db(1),D.nc("ngIf",n.errors.pattern)}}function G(t,e){if(1&t&&(D.Vb(0,"mat-option",23),D.Vb(1,"mat-icon"),D.Mc(2),D.Ub(),D.Vb(3,"span"),D.Mc(4),D.Ub(),D.Ub()),2&t){var n=e.$implicit;D.nc("value",n.name),D.Db(2),D.Nc(n.icon),D.Db(2),D.Nc(n.label)}}function J(t,e){if(1&t&&(D.Vb(0,"mat-option",23),D.Mc(1),D.Ub()),2&t){var n=e.$implicit;D.nc("value",n.inputType),D.Db(1),D.Oc(" ",n.label,"")}}function Y(t,e){if(1&t){var n=D.Wb();D.Vb(0,"div",11),D.Vb(1,"div",12),D.Vb(2,"mat-form-field",13),D.Vb(3,"mat-label"),D.Mc(4,"Name"),D.Ub(),D.Vb(5,"input",14,15),D.dc("ngModelChange",function(t){return e.$implicit.StaticName=t}),D.Ub(),D.Ub(),D.Kc(7,q,2,1,"ng-container",16),D.Ub(),D.Vb(8,"div",12),D.Vb(9,"mat-form-field",13),D.Vb(10,"mat-label"),D.Mc(11,"Data Type"),D.Ub(),D.Vb(12,"mat-select",17),D.dc("selectionChange",function(){D.Ac(n);var t=e.index,i=D.hc(2);return i.calculateInputTypeOptions(t),i.resetInputType(t),i.calculateHints(t)})("ngModelChange",function(t){return e.$implicit.Type=t}),D.Vb(13,"mat-select-trigger"),D.Vb(14,"mat-icon",18),D.Mc(15),D.Ub(),D.Vb(16,"span"),D.Mc(17),D.Ub(),D.Ub(),D.Kc(18,G,5,3,"mat-option",19),D.Ub(),D.Ub(),D.Vb(19,"app-field-hint"),D.Mc(20),D.Ub(),D.Ub(),D.Vb(21,"div",12),D.Vb(22,"mat-form-field",13),D.Vb(23,"mat-label"),D.Mc(24,"Input Type"),D.Ub(),D.Vb(25,"mat-select",20),D.dc("selectionChange",function(){D.Ac(n);var t=e.index;return D.hc(2).calculateHints(t)})("ngModelChange",function(t){return e.$implicit.InputType=t}),D.Kc(26,J,2,2,"mat-option",19),D.Ub(),D.Ub(),D.Vb(27,"app-field-hint"),D.Mc(28),D.Ub(),D.Ub(),D.Ub()}if(2&t){var i=e.$implicit,o=e.index,a=D.yc(6),c=D.hc(2);D.Db(5),D.nc("pattern",c.fieldNamePattern)("ngModel",i.StaticName)("name","StaticName"+o)("disabled",c.editMode),D.Db(2),D.nc("ngIf",a.touched&&a.errors),D.Db(5),D.nc("ngModel",i.Type)("name","Type"+o)("disabled",c.editMode),D.Db(3),D.Nc(c.findIcon(i.Type)),D.Db(2),D.Nc(i.Type),D.Db(1),D.nc("ngForOf",c.dataTypes),D.Db(2),D.Nc(c.dataTypeHints[o]),D.Db(5),D.nc("ngModel",i.InputType)("name","InputType"+o),D.Db(1),D.nc("ngForOf",c.filteredInputTypeOptions[o]),D.Db(2),D.Nc(c.inputTypeHints[o])}}function z(t,e){if(1&t){var n=D.Wb();D.Vb(0,"form",4,5),D.dc("ngSubmit",function(){return D.Ac(n),D.hc().save()}),D.Vb(2,"div",6),D.Kc(3,Y,29,16,"div",7),D.Ub(),D.Vb(4,"div",8),D.Vb(5,"button",9),D.dc("click",function(){return D.Ac(n),D.hc().closeDialog()}),D.Mc(6,"Cancel"),D.Ub(),D.Vb(7,"button",10),D.ic(8,"async"),D.Mc(9," Save "),D.Ub(),D.Ub(),D.Ub()}if(2&t){var i=D.yc(1),o=D.hc();D.Db(3),D.nc("ngForOf",o.fields),D.Db(4),D.nc("disabled",!i.form.valid||D.jc(8,2,o.saving$))}}var X=function(){function t(t,e,n,i,o){var r=this;this.dialogRef=t,this.route=e,this.contentTypesService=n,this.contentTypesFieldsService=i,this.snackBar=o,this.hostClass="dialog-component",this.fields=[],this.filteredInputTypeOptions=[],this.dataTypeHints=[],this.inputTypeHints=[],this.fieldNamePattern=T.b,this.fieldNameError=T.a,this.findIcon=S.a,this.loading$=new a.a(!0),this.saving$=new a.a(!1),this.subscription=new c.a,this.dialogRef.disableClose=!0,this.subscription.add(this.dialogRef.backdropClick().subscribe(function(t){r.form.dirty&&!confirm("You have unsaved changes. Are you sure you want to close this dialog?")||r.closeDialog()}))}return t.prototype.ngOnInit=function(){var t=this,e=this.route.snapshot.paramMap.get("contentTypeStaticName"),n=this.route.snapshot.paramMap.get("id")?parseInt(this.route.snapshot.paramMap.get("id"),10):null;this.editMode=null!==n;var o=this.contentTypesService.retrieveContentType(e).pipe(Object(l.a)()),a=o.pipe(Object(p.a)(function(e){return t.contentTypesFieldsService.getFields(e)})),c=this.contentTypesFieldsService.typeListRetrieve().pipe(Object(d.a)(function(t){return function(t){var e,n,o=[];try{for(var a=Object(i.i)(t),c=a.next();!c.done;c=a.next()){var r=c.value;o.push({name:r,label:I[r].label,icon:Object(S.a)(r),description:I[r].description})}}catch(s){e={error:s}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return o}(t)})),s=this.contentTypesFieldsService.getInputTypesList();Object(r.a)([o,a,c,s]).subscribe(function(e){var o=Object(i.g)(e,4),a=o[1],c=o[2],r=o[3];t.contentType=o[0];var s=a;if(t.dataTypes=c,t.inputTypeOptions=r,t.editMode){var l=s.find(function(t){return t.Id===n});t.fields.push(l)}else for(var p=1;p<=8;p++)t.fields.push({Id:0,Type:O.a.String,InputType:M.a.StringDefault,StaticName:"",IsTitle:0===s.length,SortOrder:s.length+p});for(p=0;p<t.fields.length;p++)t.calculateInputTypeOptions(p),t.calculateHints(p);t.loading$.next(!1)})},t.prototype.ngOnDestroy=function(){this.loading$.complete(),this.saving$.complete(),this.subscription.unsubscribe()},t.prototype.closeDialog=function(){this.dialogRef.close()},t.prototype.calculateInputTypeOptions=function(t){var e=this;this.filteredInputTypeOptions[t]=this.inputTypeOptions.filter(function(n){return n.dataType===e.fields[t].Type.toLocaleLowerCase()})},t.prototype.resetInputType=function(t){var e=this.fields[t].Type.toLocaleLowerCase()+M.a.DefaultSuffix;this.filteredInputTypeOptions[t].some(function(t){return t.inputType===e})||(e=this.filteredInputTypeOptions[t][0].inputType),this.fields[t].InputType=e},t.prototype.calculateHints=function(t){var e,n,i=this,o=this.dataTypes.find(function(e){return e.name===i.fields[t].Type}),a=this.inputTypeOptions.find(function(e){return e.inputType===i.fields[t].InputType});this.dataTypeHints[t]=null!==(e=null==o?void 0:o.description)&&void 0!==e?e:"",this.inputTypeHints[t]=null!==(n=null==a?void 0:a.description)&&void 0!==n?n:""},t.prototype.save=function(){var t=this;if(this.saving$.next(!0),this.snackBar.open("Saving..."),this.editMode){var e=this.fields[0];this.contentTypesFieldsService.updateInputType(e.Id,e.StaticName,e.InputType).subscribe(function(e){t.saving$.next(!1),t.snackBar.open("Saved",null,{duration:2e3}),t.closeDialog()})}else s.a.apply(void 0,Object(i.h)(this.fields)).pipe(Object(u.a)(function(t){return!!t.StaticName}),Object(b.a)(function(e){return t.contentTypesFieldsService.add(e,t.contentType.Id).pipe(Object(f.a)(function(t){return Object(s.a)(null)}))}),function(t,e){return arguments.length>=2?function(n){return Object(m.a)(Object(h.a)(t,e),Object(g.a)(1),Object(y.a)(e))(n)}:function(e){return Object(m.a)(Object(h.a)(function(e,n,i){return t(e,n,i+1)}),Object(g.a)(1))(e)}}(v,[])).subscribe(function(e){t.saving$.next(!1),t.snackBar.open("Saved",null,{duration:2e3}),t.closeDialog()})},t.\u0275fac=function(e){return new(e||t)(D.Pb(V.f),D.Pb(U.a),D.Pb(w.a),D.Pb(C.a),D.Pb(N.b))},t.\u0275cmp=D.Jb({type:t,selectors:[["app-edit-content-type-fields"]],viewQuery:function(t,e){var n;1&t&&D.Rc(A,1,o.o),2&t&&D.xc(n=D.ec())&&(e.form=n.first)},hostVars:1,hostBindings:function(t,e){2&t&&D.Yb("className",e.hostClass)},decls:7,vars:7,consts:[["mat-dialog-title",""],[1,"dialog-title-box",3,"ngSwitch"],[4,"ngSwitchCase"],["class","dialog-form",3,"ngSubmit",4,"ngIf"],[1,"dialog-form",3,"ngSubmit"],["ngForm","ngForm"],[1,"dialog-form-content","fancy-scrollbar-light"],["class","row-container",4,"ngFor","ngForOf"],[1,"dialog-form-actions"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","submit","color","accent",3,"disabled"],[1,"row-container"],[1,"edit-input"],["appearance","standard","color","accent"],["matInput","",3,"pattern","ngModel","name","disabled","ngModelChange"],["staticName","ngModel"],[4,"ngIf"],[3,"ngModel","name","disabled","selectionChange","ngModelChange"],[1,"type-icon"],[3,"value",4,"ngFor","ngForOf"],[3,"ngModel","name","selectionChange","ngModelChange"],[3,"isError",4,"ngIf"],[3,"isError"],[3,"value"]],template:function(t,e){1&t&&(D.Vb(0,"div",0),D.Vb(1,"div",1),D.Kc(2,E,2,0,"ng-container",2),D.Kc(3,L,2,0,"ng-container",2),D.Kc(4,B,2,0,"ng-container",2),D.Ub(),D.Ub(),D.Kc(5,z,10,4,"form",3),D.ic(6,"async")),2&t&&(D.Db(1),D.nc("ngSwitch",e.editMode),D.Db(1),D.nc("ngSwitchCase",void 0),D.Db(1),D.nc("ngSwitchCase",!0),D.Db(1),D.nc("ngSwitchCase",!1),D.Db(1),D.nc("ngIf",!1===D.jc(6,5,e.loading$)))},directives:[V.g,F.p,F.q,F.n,o.v,o.n,o.o,F.m,j.a,x.c,x.g,k.b,o.c,o.r,o.m,o.p,P.a,P.c,$.a,K.a,H.k],pipes:[F.b],styles:[".row-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.edit-input[_ngcontent-%COMP%]{padding-bottom:8px;width:30%}.type-icon[_ngcontent-%COMP%]{width:inherit;height:inherit;margin-right:8px;font-size:inherit;vertical-align:top;line-height:inherit}"],changeDetection:0}),t}()}}]);
//# sourceMappingURL=https://sources.2sxc.org/12.01.01/ng-edit/edit-content-type-fields-component.b1087727c844359b130c.js.map