"use strict";(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["default-projects_eav-ui_src_app_permissions_index_ts","projects_eav-ui_src_app_permissions_permissions_routing_ts"],{401:(P,o,t)=>{t.d(o,{T:()=>d});var e=t(6474),a=t(1659);let d=(()=>{class s extends e.D{getMetadata(l,i,h,g){return this.getHttp("admin/metadata/get",{params:{appId:this.appId,targetType:l.toString(),keyType:i,key:h.toString(),...g&&{contentType:g}}})}static{this.\u0275fac=(()=>{let l;return function(h){return(l||(l=a.xGo(s)))(h||s)}})()}static{this.\u0275prov=a.jDH({token:s,factory:s.\u0275fac})}}return s})()},2365:(P,o,t)=>{t.d(o,{v:()=>a});var e=t(9204);const a={name:"SET_PERMISSIONS_DIALOG",initContext:!0,panelSize:"large",panelClass:null,getComponent:()=>(0,e.A)(function*(){const{PermissionsComponent:r}=yield Promise.all([t.e("default-node_modules_angular_forms_fesm2022_forms_mjs"),t.e("default-projects_eav-ui_src_app_shared_directives_tippy_directive_ts"),t.e("default-node_modules_angular_material_fesm2022_radio_mjs"),t.e("default-projects_eav-ui_src_app_shared_ag-grid_column-definitions_ts-projects_eav-ui_src_app_-3cb379"),t.e("projects_eav-ui_src_app_permissions_permissions_component_ts")]).then(t.bind(t,2458));return r})()}},2437:(P,o,t)=>{t.d(o,{k:()=>a});var e=t(52);let a=(()=>{class r{static{this.route={path:"permissions/:targetType/:keyType/:key",loadChildren:()=>t.e("projects_eav-ui_src_app_permissions_permissions_routing_ts").then(t.bind(t,3516)).then(s=>s.permissionRoutes),data:{title:"Permissions"}}}static getUrl(s,_,l){return`permissions/${s}/${_}/${l}`}static getUrlApp(s){return this.getUrl(e.YX.metadata.app.targetType,e.YX.metadata.app.keyType,s.toString())}static getUrlAttribute(s){return this.getUrl(e.YX.metadata.attribute.targetType,e.YX.metadata.attribute.keyType,s.toString())}static getUrlContentType(s){return this.getUrlEntity(s)}static getUrlEntity(s){return this.getUrl(e.YX.metadata.entity.targetType,e.YX.metadata.entity.keyType,s)}static getUrlLanguage(s){return this.getUrl(e.YX.metadata.language.targetType,e.YX.metadata.language.keyType,s)}}return r})()},2458:(P,o,t)=>{t.r(o),t.d(o,{PermissionsComponent:()=>U});var e=t(1659),a=t(4175),r=t(7941),d=t(3840),s=t(2159),_=t(2938),l=t(3620),i=t(1828),h=t(251),g=t(52),v=t(3216),y=t(334),n=t(7037),c=t(8471),E=t(4646),T=t(4601);let f=(()=>{class D{agInit(p){this.params=p}refresh(p){return!0}deletePermission(){this.params.onDelete(this.params.data)}static{this.\u0275fac=function(m){return new(m||D)}}static{this.\u0275cmp=e.VBU({type:D,selectors:[["app-permissions-actions"]],decls:4,vars:0,consts:[[1,"actions-component"],["matRipple","","tippy","Delete",1,"eav-grid-action-button","highlight",3,"click"]],template:function(m,u){1&m&&(e.j41(0,"div",0)(1,"div",1),e.bIt("click",function(){return u.deletePermission()}),e.j41(2,"mat-icon"),e.EFF(3,"delete"),e.k0s()()())},dependencies:[E.pZ,E.r6,d.m_,d.An,T.e],encapsulation:2})}}return D})();var M=t(4900),C=t(3347),I=t(9841);let U=(()=>{class D{#s;#e;#t;#i;constructor(p,m){this.dialog=p,this.snackBar=m,this.gridOptions=this.buildGridOptions(),this.permissions=(0,e.vPA)([]),this.#s=(0,_.d)(M.K),this.#e=(0,_.d)(c.c),this.#t=(0,l.C)(this.#e.getParams(["targetType","keyType","key"]),u=>({targetType:parseInt(u.targetType,10),keyType:u.keyType,key:u.key})),this.#i={[g.YX.metadata.language.targetType]:{PermissionType:"language"}}}ngOnInit(){this.#n(),this.#e.doOnDialogClosed(()=>this.#n())}closeDialog(){this.dialog.close()}#n(){this.#s.getAll(this.#t.targetType,this.#t.keyType,this.#t.key).subscribe(p=>{this.permissions.set(p)})}editPermission(p){let m;m=null==p?{items:[{...y.c.newMetadataFromInfo(g.YX.contentTypes.permissions,y.c.constructMetadataInfo(this.#t.targetType,this.#t.keyType,this.#t.key)),...this.#i[this.#t.targetType]&&{Prefill:this.#i[this.#t.targetType]}}]}:{items:[y.c.editId(p.Id)]};const u=(0,v.s)(m);this.#e.navRelative([`edit/${u}`])}deletePermission(p){confirm(`Delete '${p.Title}' (${p.Id})?`)&&(this.snackBar.open("Deleting..."),this.#s.delete(p.Id).subscribe(()=>{this.snackBar.open("Deleted",null,{duration:2e3}),this.#n()}))}buildGridOptions(){return{...h.C,columnDefs:[{...i.r.Id,cellRendererParams:i.r.idFieldParamsTooltipGetter()},{...i.r.TextWide,headerName:"Name",field:"Title",sort:"asc",onCellClicked:m=>{this.editPermission(m.data)}},{...i.r.TextWide,field:"Identity"},{...i.r.TextWide,field:"Condition"},{...i.r.Character,field:"Grant"},{...i.r.ActionsPinnedRight1,cellRenderer:f,cellRendererParams:{onDelete:u=>this.deletePermission(u)}}]}}static{this.\u0275fac=function(m){return new(m||D)(e.rXU(r.CP),e.rXU(C.UG))}}static{this.\u0275cmp=e.VBU({type:D,selectors:[["app-permissions"]],decls:15,vars:2,consts:[[1,"eav-dialog","nav-component-wrapper"],[1,"eav-dialog-header"],[1,"eav-dialog-header__title"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"eav-dialog-content","nav-component-wrapper"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","gridOptions"],["align","end"],["mat-fab","","mat-elevation-z24","","tippy","Create a new permission",1,"grid-fab",3,"click"]],template:function(m,u){1&m&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2),e.EFF(3,"Permissions"),e.k0s(),e.j41(4,"button",3),e.bIt("click",function(){return u.closeDialog()}),e.j41(5,"mat-icon"),e.EFF(6,"close"),e.k0s()()(),e.j41(7,"div",4),e.nrm(8,"router-outlet"),e.j41(9,"div",5),e.nrm(10,"ag-grid-angular",6),e.k0s(),e.j41(11,"mat-dialog-actions",7)(12,"button",8),e.bIt("click",function(){return u.editPermission(null)}),e.j41(13,"mat-icon"),e.EFF(14,"add"),e.k0s()()()()()),2&m&&(e.R7$(10),e.Y8G("rowData",u.permissions())("gridOptions",u.gridOptions))},dependencies:[a.Hl,a.iY,a.Sr,d.m_,d.An,s.n3,r.E7,n.p,I.xs],encapsulation:2})}}return D})()},3516:(P,o,t)=>{t.r(o),t.d(o,{permissionRoutes:()=>d});var e=t(5544),a=t(2365),r=t(1195);const d=[{path:"",component:e.DialogEntryComponent,data:{dialog:a.v},children:r.RD}]},3620:(P,o,t)=>{function e(r,d){return d(r)}function a(r,d){return d(r)}t.d(o,{C:()=>e,z:()=>a})},4096:(P,o,t)=>{t.d(o,{Kn:()=>_.K,TI:()=>s.T,k4:()=>e.k});var e=t(2437),s=(t(2365),t(3516),t(2458),t(401)),_=t(4900)},4900:(P,o,t)=>{t.d(o,{K:()=>l});var e=t(271),a=t(2938),r=t(52),d=t(6817),s=t(401),_=t(1659);let l=(()=>{class i{constructor(){this.metadataService=(0,a.d)(s.T),this.entitiesService=(0,a.d)(d.R)}getAll(g,v,y){return this.metadataService.getMetadata(g,v,y,r.YX.contentTypes.permissions).pipe((0,e.T)(n=>n.Items))}delete(g){return this.entitiesService.delete(r.YX.contentTypes.permissions,g,!1)}static{this.\u0275fac=function(v){return new(v||i)}}static{this.\u0275prov=_.jDH({token:i,factory:i.\u0275fac})}}return i})()},6817:(P,o,t)=>{t.d(o,{R:()=>d});var e=t(9234),a=t(6474),r=t(1659);let d=(()=>{class s extends a.D{create(l,i){return this.http.post(`app/auto/data/${l}`,i,{params:{appId:this.appId,zoneId:this.zoneId}})}update(l,i,h){return this.http.post(`app/auto/data/${l}/${i}`,h,{params:{appId:this.appId,zoneId:this.zoneId}})}delete(l,i,h){return this.http.delete(this.apiUrl(e.gb+"delete"),{params:{contentType:l,id:i.toString(),appId:this.appId,force:h.toString()}})}static{this.\u0275fac=(()=>{let l;return function(h){return(l||(l=r.xGo(s)))(h||s)}})()}static{this.\u0275prov=r.jDH({token:s,factory:s.\u0275fac})}}return s})()},8471:(P,o,t)=>{t.d(o,{c:()=>g});var e=t(2159),a=t(1567),r=t(3037),d=t(271),s=t(5057),_=t(4435),l=t(4979),i=t(1659);const h={doOnDialogClosed:!0};let g=(()=>{class v extends l.V{constructor(n,c){super(),this.router=n,this.route=c,this.log=(0,_.Tq)({DialogRoutingService:v},h)}get snapshot(){return this.route.snapshot}get url(){return this.router.url}get urlSegments(){return this.router.url.split("/")}getParam(n){return this.route.snapshot.paramMap.get(n)}getParams(n){const c=this.route.snapshot.paramMap;return n.reduce((E,T)=>(E[T]=c.get(T),E),{})}getQueryParam(n){return this.route.snapshot.queryParamMap.get(n)}getQueryParams(n){const c=this.route.snapshot.queryParamMap;return n.reduce((E,T)=>(E[T]=c.get(T),E),{})}state(){return this.router.getCurrentNavigation().extras?.state}doOnDialogClosed(n){const c=this.log.fnIf("doOnDialogClosed");this.subscriptions.add(this.childDialogClosed$().subscribe(()=>n())),c.end()}urlSubRoute(n){const c=this.router.createUrlTree([n],{relativeTo:this.route});return this.router.serializeUrl(c)}navPath(n,c){return this.router.navigate([n],c)}navRelative(n,c){return this.router.navigate(n,{...c,relativeTo:this.route})}childDialogClosed$(){return this.router.events.pipe((0,a.p)(n=>n instanceof e.wF),(0,r.Z)(!!this.route.snapshot.firstChild),(0,d.T)(()=>!!this.route.snapshot.firstChild),(0,s.J)(),(0,a.p)(([n,c])=>n&&!c))}static{this.\u0275fac=function(c){return new(c||v)(i.KVO(e.Ix),i.KVO(e.nX))}}static{this.\u0275prov=i.jDH({token:v,factory:v.\u0275fac})}}return v})()}}]);
//# sourceMappingURL=https://sources.2sxc.org/19.03.05/dist/ng-edit/default-projects_eav-ui_src_app_permissions_index_ts.d0bf5396b0981697.js.map