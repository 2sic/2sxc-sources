{"version":3,"mappings":"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","names":["AppScopes","App","Site","Global","SafeResourceUrlPipe","sanitizer","this","resourceUrl","bypassSecurityTrustResourceUrl","a","i0","pure","GettingStartedComponent","selectors","ctx_r7","ctx_r9","ctx_r11","DataActionsComponent","params","contentType","data","enablePermissions","enablePermissionsGetter","guidRegex","test","StaticName","onCreateOrEditMetadata","onOpenPermissions","onEdit","onOpenMetadata","onOpenRestApi","onTypeExport","onOpenDataExport","onOpenDataImport","onDelete","ctx","DataFieldsComponent","value","tooltip","EditInfo","ReadOnly","ReadOnlyMessage","SharedDefId","icon","onEditFields","DataItemsComponent","onShowItems","onAddItem","ctx_r3","DataComponent","router","route","contentTypesService","globalConfigService","snackBar","contentExportService","BehaviorSubject","getDebugEnabled$","AllCommunityModules","Object","defaultGridOptions","frameworkComponents","idFieldComponent","IdFieldComponent","dataItemsComponent","dataFieldsComponent","dataActionsComponent","columnDefs","headerName","field","width","headerClass","cellClass","cellRenderer","sortable","filter","valueGetter","Id","cellRendererParams","tooltipGetter","flex","minWidth","sort","onCellClicked","d","showContentItems","Label","comparator","valueA","valueB","nodeA","nodeB","isInverted","_compareLabel","localeCompare","Items","addItem","Fields","editFields","Name","event","editContentType","g","Properties","_a","Description","pinned","createOrEditMetadata","openPermissions","openRestApi","openMetadata","exportType","openDataExport","openDataImport","deleteContentType","dropdownInsertValue","Subscription","fetchScopes","refreshScopeOnRouteChange","refreshOnChildClosed","contentTypes$","complete","scope$","scopeOptions$","subscription","unsubscribe","files","importFile","name","substring","lastIndexOf","toLocaleLowerCase","ext","from","toString","pipe","take","subscribe","contentTypeName","split","o","find","ct","message","open","duration","importType","navigate","relativeTo","firstChild","state","retrieveContentTypes","contentTypes","p","replace","r","e","next","eavConstants","getScopes","newScopes","scopeOptions","forEach","existing","scope","scopeOption","push","sourceName","window","prompt","createGhost","fetchContentTypes","newScope","formUrl","convertFormToUrl","items","ContentTypeName","EntityId","For","Target","TargetType","String","Prefill","url","GoToMetadata","GoToDevRest","exportJson","contentImportData","GoToPermissions","confirm","delete","add","events","NavigationEnd","map","snapshot","paramMap","get","startWith","distinctUntilChanged","option","includes","newScopeOption","pairwise","QueryActions","AgActionsComponent","item","i","ctx_r5","QueriesActionsComponent","actions","getEnablePermissions","t","QueriesComponent","pipelinesService","dialogService","queriesActionsComponent","_EditInfo","query","Guid","openVisualQueryDesigner","do","action","doMenuAction","fetchQueries","queries$","getAll","queries","editQuery","cloneQuery","exportQuery","deleteQuery","TestParameters","openQueryDesigner","clonePipeline","exportEntity","ViewsActionsComponent","view","enableCode","enableCodeGetter","onOpenCode","onClone","onExport","ViewsShowComponent","HasQuery","List","ContentType","ViewsTypeComponent","type","calculateViewType","isShared","IsShared","ViewsComponent","viewsService","booleanFilterComponent","BooleanFilterComponent","viewsTypeComponent","viewsShowComponent","viewsActionsComponent","showValueGetter","c","editView","typeValueGetter","openUsage","Used","ViewNameInUrl","TemplatePath","contentDemoValueGetter","PresentationType","presentationDemoValueGetter","ListContentType","headerDemoValueGetter","ListPresentationType","headerPresDemoValueGetter","openCode","cloneView","exportView","deleteView","fetchTemplates","fetchPolymorphism","views$","polymorphStatus$","views","getPolymorphism","polymorphism","Resolver","form","appIsGlobal","Location","TypeName","IsHidden","DemoId","DemoTitle","openCodeFile","DuplicateEntity","export","WebApiActionsComponent","WebApiTypeComponent","WebApiComponent","sourceService","dialog","viewContainerRef","webApiActions","webApiTypeComponent","folder","api","fetchWebApis","webApis$","global","CreateFileDialogComponent","autoFocus","purpose","afterClosed","result","endsWith","fileName","create","templateKey","FileLocationDialogComponent","createController","getWebApis","webApis","path","AnalyzeParts","Settings","Resources","ctx_r15","ctx_r17","ctx_r18","ctx_r20","ctx_r22","ctx_r23","ctx_r26","ctx_r28","ctx_r29","ctx_r30","ctx_r32","ctx_r33","ctx_r35","ctx_r37","ctx_r38","ctx_r41","ctx_r43","ctx_r44","ctx_r45","ctx_r47","ctx_r51","AppConfigurationComponent","contentItemsService","context","exportAppService","importAppPartsService","changeDetectorRef","contentTypesFieldsService","metadataService","SystemSettingsScopes","fetchSettings","changes","dialogSettings","isGlobal","Context","SettingsScope","isPrimary","isApp","dismiss","staticName","systemSettingsScope","systemSettingsEntities","contentItems","SettingsEntityScope","length","Error","systemSettingsEntity","customSettingsEntity","s","appId","sitePrimaryApp","PrimaryApp","openAppAdministration","ZoneId","AppId","globalPrimaryApp","System","exportForVersionControl","error","resetApp","part","settingsCustomExists","some","resourcesCustomExists","forkJoin","of","undefined","getFields","getMetadata","systemSettingsItems","customSettingsItems","customSettingsFields","systemResourcesItems","F","customResourcesItems","customResourcesFields","appConfigurations","mt","appMetadata","systemSettingsCount","customSettingsCount","customSettingsFieldsCount","k","systemResourcesCount","customResourcesCount","M","customResourcesFieldsCount","V","appConfigurationsCount","appMetadataCount","markForCheck","edit","config","save","Scope","ChangeStaticName","NewStaticName","success","AppAdministrationNavComponent","dialogRef","appDialogConfigService","combineLatest","tabs$","tabs","indexOf","tabIndex","dialogSettings$","tabIndex$","fetchDialogSettings","close","index","getDialogSettings","UpdateEnvVarsFromDialogSettings","Enable","Query","tab","ToggleDebugDirective","navigator","platform","match","metaKey","ctrlKey","shiftKey","altKey","toggleDebugEnabled","getSelection","removeAllRanges","x"],"sources":["./projects/ng-dialogs/src/app/shared/models/dialog-context.models.ts","./projects/ng-dialogs/src/app/shared/pipes/safe-resource-url.ts","./projects/ng-dialogs/src/app/app-administration/getting-started/getting-started.component.ts","./projects/ng-dialogs/src/app/app-administration/getting-started/getting-started.component.html","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/data-actions/data-actions.component.html","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/data-actions/data-actions.component.ts","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/data-fields/data-fields.component.ts","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/data-fields/data-fields.component.html","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/data-items/data-items.component.ts","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/data-items/data-items.component.html","./projects/ng-dialogs/src/app/app-administration/data/data.component.html","./projects/ng-dialogs/src/app/app-administration/data/data.component.ts","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/queries-actions/queries-actions.ts","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/ag-actions/ag-actions-component.ts","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/queries-actions/queries-actions.component.html","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/queries-actions/queries-actions.component.ts","./projects/ng-dialogs/src/app/app-administration/queries/queries.component.ts","./projects/ng-dialogs/src/app/app-administration/queries/queries.component.html","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/views-actions/views-actions.component.html","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/views-actions/views-actions.component.ts","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/views-show/views-show.component.html","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/views-show/views-show.component.ts","./projects/ng-dialogs/src/app/app-administration/views/views.helpers.ts","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/views-type/views-type.component.html","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/views-type/views-type.component.ts","./projects/ng-dialogs/src/app/app-administration/views/views.component.ts","./projects/ng-dialogs/src/app/app-administration/views/polymorph-logo.png","./projects/ng-dialogs/src/app/app-administration/views/views.component.html","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/web-api-actions/web-api-actions.component.html","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/web-api-actions/web-api-actions.component.ts","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/web-api-type/web-api-type.component.html","./projects/ng-dialogs/src/app/app-administration/ag-grid-components/web-api-type/web-api-type.component.ts","./projects/ng-dialogs/src/app/app-administration/web-api/web-api.component.ts","./projects/ng-dialogs/src/app/app-administration/web-api/web-api.component.html","./projects/ng-dialogs/src/app/app-administration/sub-dialogs/analyze-settings/analyze-settings.models.ts","./projects/ng-dialogs/src/app/app-administration/app-configuration/app-configuration.component.html","./projects/ng-dialogs/src/app/app-administration/app-configuration/app-configuration.component.ts","./projects/ng-dialogs/src/app/app-administration/app-administration-nav/app-administration-nav.component.html","./projects/ng-dialogs/src/app/app-administration/app-administration-nav/app-administration-nav.component.ts","./projects/ng-dialogs/src/app/shared/constants/guid.constants.ts","./projects/ng-dialogs/src/app/shared/directives/toggle-debug.directive.ts"],"sourcesContent":["import { Language } from '../../../../../edit/shared/models';\r\nimport { PermissionsCount } from '../../app-administration/models/permissions-count.model';\r\n\r\nexport interface DialogContextApp {\r\n  /** Root for app APIs and content/query */\r\n  Api: string;\r\n  Folder: string;\r\n  GettingStartedUrl: string;\r\n  Id: number;\r\n  Identifier: string;\r\n  IsGlobal: boolean;\r\n  IsInherited: boolean;\r\n  Name: string;\r\n  Permissions: PermissionsCount;\r\n  SettingsScope: AppScope;\r\n  Url: string;\r\n}\r\n\r\nexport const AppScopes = {\r\n  App: 'App',\r\n  Site: 'Site',\r\n  Global: 'Global',\r\n} as const;\r\nexport type AppScope = typeof AppScopes[keyof typeof AppScopes];\r\n\r\nexport interface DialogContextEnable {\r\n  /** Determines if app admin should show app-permissions (true for Apps, false for Content and Global) */\r\n  AppPermissions?: boolean;\r\n  /** Determines if Code editing should be enabled (true for super-users) */\r\n  CodeEditor?: boolean;\r\n  /** Determines if Queries should be enabled (true for Apps) */\r\n  Query?: boolean;\r\n  /** True if saving of formulas should be enabled (for edit-ui) */\r\n  FormulaSave?: boolean;\r\n}\r\n\r\nexport interface DialogContextLanguage {\r\n  Current: string;\r\n  List: Language[];\r\n  Primary: string;\r\n}\r\n\r\nexport interface DialogContextPage {\r\n  Id: number;\r\n}\r\n\r\nexport interface DialogContextSite {\r\n  DefaultApp: DialogContextSiteApp;\r\n  Id: number;\r\n  PrimaryApp: DialogContextSiteApp;\r\n  Url: string;\r\n}\r\n\r\nexport interface DialogContextSystem {\r\n  DefaultApp: DialogContextSiteApp;\r\n  PrimaryApp: DialogContextSiteApp;\r\n  Url: string;\r\n}\r\n\r\nexport interface DialogContextSiteApp {\r\n  ZoneId: number;\r\n  AppId: number;\r\n}\r\n","import { Pipe, PipeTransform } from '@angular/core';\r\nimport { DomSanitizer } from '@angular/platform-browser';\r\n\r\n@Pipe({ name: 'safeResourceUrl' })\r\nexport class SafeResourceUrlPipe implements PipeTransform {\r\n\r\n  constructor(private sanitizer: DomSanitizer) { }\r\n\r\n  transform(resourceUrl: string) {\r\n    return this.sanitizer.bypassSecurityTrustResourceUrl(resourceUrl);\r\n  }\r\n}\r\n","import { Component, Input, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-getting-started',\r\n  templateUrl: './getting-started.component.html',\r\n  styleUrls: ['./getting-started.component.scss'],\r\n})\r\nexport class GettingStartedComponent implements OnInit {\r\n  @Input() gettingStartedUrl: string;\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n}\r\n","<iframe class=\"iframe\" [src]=\"gettingStartedUrl | safeResourceUrl\"></iframe>\r\n","<div class=\"actions-component\">\r\n  <div class=\"like-button highlight\" matRipple *ngIf=\"!contentType.EditInfo.ReadOnly || contentType.Properties\"\r\n    tippy=\"Description and more\" (click)=\"createOrEditMetadata()\">\r\n    <mat-icon>edit</mat-icon>\r\n  </div>\r\n  <div class=\"like-button disabled\" *ngIf=\"contentType.EditInfo.ReadOnly && !contentType.Properties\">\r\n    <mat-icon>edit</mat-icon>\r\n  </div>\r\n\r\n  <div class=\"like-button highlight\" matRipple *ngIf=\"!contentType.EditInfo.ReadOnly\" tippy=\"Metadata\"\r\n    (click)=\"openMetadata()\">\r\n    <mat-icon [matBadge]=\"contentType.Metadata.length\" matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n      [matBadgeHidden]=\"!contentType.Metadata.length\">\r\n      local_offer\r\n    </mat-icon>\r\n  </div>\r\n  <div class=\"like-button disabled\" *ngIf=\"contentType.EditInfo.ReadOnly\">\r\n    <mat-icon [matBadge]=\"contentType.Metadata.length\" matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n      matBadgeDisabled=\"true\" [matBadgeHidden]=\"!contentType.Metadata.length\">\r\n      local_offer\r\n    </mat-icon>\r\n  </div>\r\n\r\n  <div class=\"like-button highlight\" matRipple *ngIf=\"!contentType.EditInfo.ReadOnly && enablePermissions\"\r\n    tippy=\"Permissions\" (click)=\"openPermissions()\">\r\n    <mat-icon [matBadge]=\"contentType.Permissions.Count\" matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n      [matBadgeHidden]=\"!contentType.Permissions.Count\">\r\n      person\r\n    </mat-icon>\r\n  </div>\r\n  <div class=\"like-button disabled\" *ngIf=\"contentType.EditInfo.ReadOnly || !enablePermissions\">\r\n    <mat-icon [matBadge]=\"contentType.Permissions.Count\" matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n      matBadgeDisabled=\"true\" [matBadgeHidden]=\"!contentType.Permissions.Count\">\r\n      person\r\n    </mat-icon>\r\n  </div>\r\n\r\n  <div class=\"like-button highlight\" matRipple tippy=\"More\" [matMenuTriggerFor]=\"menu\">\r\n    <mat-icon>more_horiz</mat-icon>\r\n  </div>\r\n</div>\r\n\r\n<mat-menu #menu=\"matMenu\" class=\"grid-more-menu\">\r\n  <button mat-menu-item [disabled]=\"contentType.EditInfo.ReadOnly\" (click)=\"editContentType()\">\r\n    <mat-icon>settings</mat-icon>\r\n    <span>Rename</span>\r\n  </button>\r\n  <button mat-menu-item (click)=\"openRestApi()\">\r\n    <mat-icon svgIcon=\"code-curly\"></mat-icon>\r\n    <span>REST API</span>\r\n  </button>\r\n  <button mat-menu-item (click)=\"exportType()\">\r\n    <mat-icon>cloud_download</mat-icon>\r\n    <span>Export content type</span>\r\n  </button>\r\n  <button mat-menu-item (click)=\"openDataExport()\">\r\n    <mat-icon>cloud_download</mat-icon>\r\n    <span>Export data</span>\r\n  </button>\r\n  <button mat-menu-item (click)=\"openDataImport()\">\r\n    <mat-icon>cloud_upload</mat-icon>\r\n    <span>Import data</span>\r\n  </button>\r\n  <button mat-menu-item [disabled]=\"contentType.EditInfo.ReadOnly\" (click)=\"deleteContentType()\">\r\n    <mat-icon>delete</mat-icon>\r\n    <span>Delete</span>\r\n  </button>\r\n</mat-menu>\r\n","import { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { Component } from '@angular/core';\r\nimport { guidRegex } from '../../../shared/constants/guid.constants';\r\nimport { ContentType } from '../../models/content-type.model';\r\nimport { DataActionsParams } from './data-actions.models';\r\n\r\n@Component({\r\n  selector: 'app-data-actions',\r\n  templateUrl: './data-actions.component.html',\r\n  styleUrls: ['./data-actions.component.scss'],\r\n})\r\nexport class DataActionsComponent implements ICellRendererAngularComp {\r\n  contentType: ContentType;\r\n  enablePermissions: boolean;\r\n  private params: DataActionsParams;\r\n\r\n  constructor() { }\r\n\r\n  agInit(params: DataActionsParams) {\r\n    this.params = params;\r\n    this.contentType = this.params.data;\r\n    const enablePermissions = this.params.enablePermissionsGetter();\r\n    this.enablePermissions = enablePermissions && guidRegex().test(this.contentType.StaticName);\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n\r\n  createOrEditMetadata() {\r\n    this.params.onCreateOrEditMetadata(this.contentType);\r\n  }\r\n\r\n  openPermissions() {\r\n    this.params.onOpenPermissions(this.contentType);\r\n  }\r\n\r\n  editContentType() {\r\n    this.params.onEdit(this.contentType);\r\n  }\r\n\r\n  openMetadata() {\r\n    this.params.onOpenMetadata(this.contentType);\r\n  }\r\n\r\n  openRestApi() {\r\n    this.params.onOpenRestApi(this.contentType);\r\n  }\r\n\r\n  exportType() {\r\n    this.params.onTypeExport(this.contentType);\r\n  }\r\n\r\n  openDataExport() {\r\n    this.params.onOpenDataExport(this.contentType);\r\n  }\r\n\r\n  openDataImport() {\r\n    this.params.onOpenDataImport(this.contentType);\r\n  }\r\n\r\n  deleteContentType() {\r\n    this.params.onDelete(this.contentType);\r\n  }\r\n}\r\n","import { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { Component } from '@angular/core';\r\nimport { ContentType } from '../../models/content-type.model';\r\nimport { DataFieldsParams } from './data-fields.models';\r\n\r\n@Component({\r\n  selector: 'app-data-fields',\r\n  templateUrl: './data-fields.component.html',\r\n  styleUrls: ['./data-fields.component.scss'],\r\n})\r\nexport class DataFieldsComponent implements ICellRendererAngularComp {\r\n  value: number;\r\n  tooltip: string;\r\n  icon: string;\r\n\r\n  private params: DataFieldsParams;\r\n  private contentType: ContentType;\r\n\r\n  agInit(params: DataFieldsParams): void {\r\n    this.params = params;\r\n    this.contentType = params.data;\r\n    this.value = params.value;\r\n    this.tooltip = !this.contentType.EditInfo.ReadOnly\r\n      ? 'Edit fields'\r\n      : `${this.contentType.EditInfo.ReadOnlyMessage ? `${this.contentType.EditInfo.ReadOnlyMessage}\\n\\n` : ''}This ContentType shares the definition of #${this.contentType.SharedDefId} so you can't edit it here. Read 2sxc.org/help?tag=shared-types`;\r\n    this.icon = !this.contentType.EditInfo.ReadOnly ? 'dns' : 'share';\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n\r\n  editFields(): void {\r\n    this.params.onEditFields(this.contentType);\r\n  }\r\n}\r\n","<div class=\"actions-component\">\r\n  <div class=\"like-button highlight\" matRipple [tippy]=\"tooltip\" (click)=\"editFields()\">\r\n    <mat-icon [matBadge]=\"value\" matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadgeHidden]=\"!value\">\r\n      {{ icon }}\r\n    </mat-icon>\r\n  </div>\r\n</div>\r\n","import { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { Component } from '@angular/core';\r\nimport { ContentType } from '../../models';\r\nimport { DataItemsParams } from './data-items.models';\r\n\r\n@Component({\r\n  selector: 'app-data-items',\r\n  templateUrl: './data-items.component.html',\r\n  styleUrls: ['./data-items.component.scss'],\r\n})\r\nexport class DataItemsComponent implements ICellRendererAngularComp {\r\n  value: number;\r\n  private params: DataItemsParams;\r\n  private contentType: ContentType;\r\n\r\n  agInit(params: DataItemsParams): void {\r\n    this.params = params;\r\n    this.contentType = params.data;\r\n    this.value = params.value;\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n\r\n  showItems(): void {\r\n    this.params.onShowItems(this.contentType);\r\n  }\r\n\r\n  addItem(): void {\r\n    this.params.onAddItem(this.contentType);\r\n  }\r\n}\r\n","<div class=\"actions-component\">\r\n  <div class=\"like-button highlight\" matRipple tippy=\"{{ value }} items\" (click)=\"showItems()\">\r\n    <div class=\"text-icon\">{{ value }}</div>\r\n  </div>\r\n\r\n  <div class=\"like-button highlight\" matRipple tippy=\"Add item\" (click)=\"addItem()\">\r\n    <mat-icon>add</mat-icon>\r\n  </div>\r\n</div>\r\n","<div class=\"grid-wrapper mat-tab-grid-wrapper\">\r\n  <ag-grid-angular class=\"ag-theme-material\" [rowData]=\"contentTypes$ | async\" [modules]=\"modules\"\r\n    [gridOptions]=\"gridOptions\" appDragAndDrop [allowedFileTypes]=\"'xml,json'\" (filesDropped)=\"filesDropped($event)\">\r\n  </ag-grid-angular>\r\n\r\n  <div class=\"grid-more-actions-box\">\r\n    <mat-form-field appearance=\"standard\" color=\"accent\" class=\"scope-dropdown\">\r\n      <mat-select [ngModel]=\"scope$ | async\" name=\"Scope\" (ngModelChange)=\"changeScope($event)\">\r\n        <mat-option *ngFor=\"let scopeOption of (scopeOptions$ | async)\" [value]=\"scopeOption.value\">\r\n          {{ 'Scope: ' + scopeOption.name }}\r\n        </mat-option>\r\n        <mat-option [value]=\"dropdownInsertValue\">Scope: Other...</mat-option>\r\n      </mat-select>\r\n    </mat-form-field>\r\n\r\n    <button mat-button tippy=\"Import content type\" (click)=\"importType()\">\r\n      <mat-icon>cloud_upload</mat-icon>\r\n      <span>Content Type</span>\r\n    </button>\r\n\r\n    <button mat-button color=\"accent\" tippy=\"Create a ghost content type\" *ngIf=\"debugEnabled$ | async\"\r\n      (click)=\"createGhost()\">\r\n      <mat-icon>share</mat-icon>\r\n      <span>Ghost</span>\r\n    </button>\r\n  </div>\r\n\r\n  <button mat-fab mat-elevation-z24 class=\"grid-fab\" tippy=\"Create a new content type\" (click)=\"editContentType(null)\">\r\n    <mat-icon>add</mat-icon>\r\n  </button>\r\n</div>\r\n","import { AllCommunityModules, GridOptions } from '@ag-grid-community/all-modules';\r\nimport { Component, Input, OnDestroy, OnInit } from '@angular/core';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { ActivatedRoute, NavigationEnd, Router } from '@angular/router';\r\nimport { BehaviorSubject, from, Subscription } from 'rxjs';\r\nimport { distinctUntilChanged, filter, map, pairwise, startWith, take } from 'rxjs/operators';\r\nimport { GlobalConfigService } from '../../../../../edit/shared/store/ngrx-data';\r\nimport { ContentExportService } from '../../content-export/services/content-export.service';\r\nimport { ContentImportDialogData } from '../../content-import/content-import-dialog.config';\r\nimport { GoToDevRest } from '../../dev-rest/go-to-dev-rest';\r\nimport { GoToMetadata } from '../../metadata';\r\nimport { GoToPermissions } from '../../permissions/go-to-permissions';\r\nimport { IdFieldComponent } from '../../shared/components/id-field/id-field.component';\r\nimport { IdFieldParams } from '../../shared/components/id-field/id-field.models';\r\nimport { defaultGridOptions } from '../../shared/constants/default-grid-options.constants';\r\nimport { dropdownInsertValue } from '../../shared/constants/dropdown-insert-value.constant';\r\nimport { eavConstants, ScopeOption } from '../../shared/constants/eav.constants';\r\nimport { toString } from '../../shared/helpers/file-to-base64.helper';\r\nimport { convertFormToUrl } from '../../shared/helpers/url-prep.helper';\r\nimport { EditForm } from '../../shared/models/edit-form.model';\r\nimport { DataActionsComponent } from '../ag-grid-components/data-actions/data-actions.component';\r\nimport { DataActionsParams } from '../ag-grid-components/data-actions/data-actions.models';\r\nimport { DataFieldsComponent } from '../ag-grid-components/data-fields/data-fields.component';\r\nimport { DataFieldsParams } from '../ag-grid-components/data-fields/data-fields.models';\r\nimport { DataItemsComponent } from '../ag-grid-components/data-items/data-items.component';\r\nimport { DataItemsParams } from '../ag-grid-components/data-items/data-items.models';\r\nimport { ContentType } from '../models/content-type.model';\r\nimport { ContentTypesService } from '../services/content-types.service';\r\nimport { ImportContentTypeDialogData } from '../sub-dialogs/import-content-type/import-content-type-dialog.config';\r\n\r\n@Component({\r\n  selector: 'app-data',\r\n  templateUrl: './data.component.html',\r\n  styleUrls: ['./data.component.scss'],\r\n})\r\nexport class DataComponent implements OnInit, OnDestroy {\r\n  @Input() enablePermissions: boolean;\r\n\r\n  contentTypes$ = new BehaviorSubject<ContentType[]>(null);\r\n  scope$ = new BehaviorSubject<string>(null);\r\n  scopeOptions$ = new BehaviorSubject<ScopeOption[]>([]);\r\n  debugEnabled$ = this.globalConfigService.getDebugEnabled$();\r\n\r\n  modules = AllCommunityModules;\r\n  gridOptions: GridOptions = {\r\n    ...defaultGridOptions,\r\n    frameworkComponents: {\r\n      idFieldComponent: IdFieldComponent,\r\n      dataItemsComponent: DataItemsComponent,\r\n      dataFieldsComponent: DataFieldsComponent,\r\n      dataActionsComponent: DataActionsComponent,\r\n    },\r\n    columnDefs: [\r\n      {\r\n        headerName: 'ID', field: 'Id', width: 70, headerClass: 'dense',\r\n        cellClass: (params) => `${(params.data as ContentType).EditInfo.ReadOnly ? 'disabled' : ''} id-action no-padding no-outline`,\r\n        cellRenderer: 'idFieldComponent', sortable: true, filter: 'agNumberColumnFilter',\r\n        valueGetter: (params) => (params.data as ContentType).Id,\r\n        cellRendererParams: {\r\n          tooltipGetter: (contentType: ContentType) => `ID: ${contentType.Id}\\nGUID: ${contentType.StaticName}`,\r\n        } as IdFieldParams,\r\n      },\r\n      {\r\n        headerName: 'Content Type', field: 'ContentType', flex: 3, minWidth: 250, cellClass: 'primary-action highlight', sortable: true,\r\n        sort: 'asc', filter: 'agTextColumnFilter', onCellClicked: (params) => this.showContentItems(params.data as ContentType),\r\n        valueGetter: (params) => (params.data as ContentType).Label,\r\n        comparator: (valueA, valueB, nodeA, nodeB, isInverted) => {\r\n          const a = (nodeA.data as ContentType)._compareLabel;\r\n          const b = (nodeB.data as ContentType)._compareLabel;\r\n          return a.localeCompare(b);\r\n        },\r\n      },\r\n      {\r\n        field: 'Items', width: 102, headerClass: 'dense', cellClass: 'secondary-action no-padding',\r\n        sortable: true, filter: 'agNumberColumnFilter', cellRenderer: 'dataItemsComponent',\r\n        valueGetter: (params) => (params.data as ContentType).Items,\r\n        cellRendererParams: {\r\n          onShowItems: (contentType) => this.showContentItems(contentType),\r\n          onAddItem: (contentType) => this.addItem(contentType),\r\n        } as DataItemsParams,\r\n      },\r\n      {\r\n        field: 'Fields', width: 94, headerClass: 'dense', cellClass: 'secondary-action no-padding',\r\n        sortable: true, filter: 'agNumberColumnFilter', cellRenderer: 'dataFieldsComponent',\r\n        valueGetter: (params) => (params.data as ContentType).Fields,\r\n        cellRendererParams: {\r\n          onEditFields: (contentType) => this.editFields(contentType),\r\n        } as DataFieldsParams,\r\n      },\r\n      {\r\n        field: 'Name', flex: 1, minWidth: 100,\r\n        cellClass: (params) => (params.data as ContentType).EditInfo.ReadOnly ? 'no-outline' : 'primary-action highlight',\r\n        valueGetter: (params) => (params.data as ContentType).Name,\r\n        sortable: true, filter: 'agTextColumnFilter', onCellClicked: (event) => this.editContentType(event.data as ContentType),\r\n      },\r\n      {\r\n        field: 'Description', flex: 3, minWidth: 250, cellClass: 'no-outline',\r\n        sortable: true, filter: 'agTextColumnFilter',\r\n        valueGetter: (params) => (params.data as ContentType).Properties?.Description,\r\n      },\r\n      {\r\n        width: 162, cellClass: 'secondary-action no-padding', cellRenderer: 'dataActionsComponent', pinned: 'right',\r\n        cellRendererParams: {\r\n          enablePermissionsGetter: () => this.enablePermissionsGetter(),\r\n          onCreateOrEditMetadata: (contentType) => this.createOrEditMetadata(contentType),\r\n          onOpenPermissions: (contentType) => this.openPermissions(contentType),\r\n          onEdit: (contentType) => this.editContentType(contentType),\r\n          onOpenRestApi: (contentType) => this.openRestApi(contentType),\r\n          onOpenMetadata: (contentType) => this.openMetadata(contentType),\r\n          onTypeExport: (contentType) => this.exportType(contentType),\r\n          onOpenDataExport: (contentType) => this.openDataExport(contentType),\r\n          onOpenDataImport: (contentType) => this.openDataImport(contentType),\r\n          onDelete: (contentType) => this.deleteContentType(contentType),\r\n        } as DataActionsParams,\r\n      },\r\n    ],\r\n  };\r\n\r\n  dropdownInsertValue = dropdownInsertValue;\r\n  private subscription = new Subscription();\r\n\r\n  constructor(\r\n    private router: Router,\r\n    private route: ActivatedRoute,\r\n    private contentTypesService: ContentTypesService,\r\n    private globalConfigService: GlobalConfigService,\r\n    private snackBar: MatSnackBar,\r\n    private contentExportService: ContentExportService,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.fetchScopes();\r\n    this.refreshScopeOnRouteChange();\r\n    this.refreshOnChildClosed();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.contentTypes$.complete();\r\n    this.scope$.complete();\r\n    this.scopeOptions$.complete();\r\n    this.subscription.unsubscribe();\r\n  }\r\n\r\n  filesDropped(files: File[]) {\r\n    const importFile = files[0];\r\n    const ext = importFile.name.substring(importFile.name.lastIndexOf('.') + 1).toLocaleLowerCase();\r\n    switch (ext) {\r\n      case 'xml':\r\n        from(toString(files[0])).pipe(take(1)).subscribe(fileString => {\r\n          const contentTypeName = fileString.split('<Entity Type=\"')[1]?.split('\"')[0];\r\n          const contentType = this.contentTypes$.value.find(ct => ct.Name === contentTypeName);\r\n          if (contentType == null) {\r\n            const message = `Cannot find Content Type named '${contentTypeName}'. Please open Content Type Import dialog manually.`;\r\n            this.snackBar.open(message, null, { duration: 5000 });\r\n            return;\r\n          }\r\n          this.openDataImport(contentType, files);\r\n        });\r\n        break;\r\n      case 'json':\r\n        this.importType(files);\r\n        break;\r\n    }\r\n  }\r\n\r\n  importType(files?: File[]) {\r\n    const importContentTypeData: ImportContentTypeDialogData = { files };\r\n    this.router.navigate(['import'], { relativeTo: this.route.firstChild, state: importContentTypeData });\r\n  }\r\n\r\n  private showContentItems(contentType: ContentType) {\r\n    this.router.navigate([`items/${contentType.StaticName}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  editContentType(contentType: ContentType) {\r\n    if (!contentType) {\r\n      this.router.navigate(['add'], { relativeTo: this.route.firstChild });\r\n    } else {\r\n      if (contentType.EditInfo.ReadOnly) { return; }\r\n      this.router.navigate([`${contentType.StaticName}/edit`], { relativeTo: this.route.firstChild });\r\n    }\r\n  }\r\n\r\n  private fetchContentTypes() {\r\n    this.contentTypesService.retrieveContentTypes(this.scope$.value).subscribe(contentTypes => {\r\n      for (const contentType of contentTypes) {\r\n        contentType._compareLabel = contentType.Label.replace(/\\p{Emoji}/gu, '');\r\n      }\r\n      this.contentTypes$.next(contentTypes);\r\n      if (this.scope$.value !== eavConstants.scopes.default.value) {\r\n        const message = 'Warning! You are in a special scope. Changing things here could easily break functionality';\r\n        this.snackBar.open(message, null, { duration: 2000 });\r\n      }\r\n    });\r\n  }\r\n\r\n  private fetchScopes() {\r\n    this.contentTypesService.getScopes().subscribe(scopeOptions => {\r\n      const newScopes = [...this.scopeOptions$.value];\r\n      scopeOptions.forEach(scopeOption => {\r\n        const existing = newScopes.find(scope => scope.value === scopeOption.value);\r\n        if (existing) {\r\n          existing.name = scopeOption.name;\r\n        } else {\r\n          newScopes.push(scopeOption);\r\n        }\r\n      });\r\n      this.scopeOptions$.next(newScopes);\r\n    });\r\n  }\r\n\r\n  createGhost() {\r\n    const sourceName = window.prompt('To create a ghost content-type enter source static name / id - this is a very advanced operation - read more about it on 2sxc.org/help?tag=ghost');\r\n    if (!sourceName) { return; }\r\n    this.snackBar.open('Saving...');\r\n    this.contentTypesService.createGhost(sourceName).subscribe(res => {\r\n      this.snackBar.open('Saved', null, { duration: 2000 });\r\n      this.fetchContentTypes();\r\n    });\r\n  }\r\n\r\n  changeScope(newScope: string) {\r\n    if (newScope === dropdownInsertValue) {\r\n      newScope = prompt('This is an advanced feature to show content-types of another scope. Don\\'t use this if you don\\'t know what you\\'re doing, as content-types of other scopes are usually hidden for a good reason.') || eavConstants.scopes.default.value;\r\n    }\r\n    this.router.navigate([`data/${newScope}`], { relativeTo: this.route });\r\n  }\r\n\r\n  private enablePermissionsGetter() {\r\n    return this.enablePermissions;\r\n  }\r\n\r\n  private addItem(contentType: ContentType) {\r\n    const form: EditForm = {\r\n      items: [{ ContentTypeName: contentType.StaticName }],\r\n    };\r\n    const formUrl = convertFormToUrl(form);\r\n    this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private editFields(contentType: ContentType) {\r\n    this.router.navigate([`fields/${contentType.StaticName}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private createOrEditMetadata(contentType: ContentType) {\r\n    const form: EditForm = {\r\n      items: [\r\n        !contentType.Properties\r\n          ? {\r\n            ContentTypeName: eavConstants.contentTypes.contentType,\r\n            For: {\r\n              Target: eavConstants.metadata.contentType.target,\r\n              TargetType: eavConstants.metadata.contentType.targetType,\r\n              String: contentType.StaticName,\r\n            },\r\n            Prefill: { Label: contentType.Name, Description: contentType.Description },\r\n          }\r\n          : { EntityId: contentType.Properties.Id }\r\n      ],\r\n    };\r\n    const formUrl = convertFormToUrl(form);\r\n    this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private openMetadata(contentType: ContentType) {\r\n    const url = GoToMetadata.getUrlContentType(\r\n      contentType.StaticName,\r\n      `Metadata for Content Type: ${contentType.Name} (${contentType.Id})`,\r\n    );\r\n    this.router.navigate([url], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private openRestApi(contentType: ContentType) {\r\n    this.router.navigate([GoToDevRest.getUrlData(contentType)], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private exportType(contentType: ContentType) {\r\n    this.contentExportService.exportJson(contentType.StaticName);\r\n  }\r\n\r\n  private openDataExport(contentType: ContentType) {\r\n    this.router.navigate([`export/${contentType.StaticName}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private openDataImport(contentType: ContentType, files?: File[]) {\r\n    const contentImportData: ContentImportDialogData = { files };\r\n    this.router.navigate([`${contentType.StaticName}/import`], { relativeTo: this.route.firstChild, state: contentImportData });\r\n  }\r\n\r\n  private openPermissions(contentType: ContentType) {\r\n    this.router.navigate([GoToPermissions.getUrlContentType(contentType.StaticName)], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private deleteContentType(contentType: ContentType) {\r\n    if (!confirm(`Are you sure you want to delete '${contentType.Name}' (${contentType.Id})?`)) { return; }\r\n    this.snackBar.open('Deleting...');\r\n    this.contentTypesService.delete(contentType).subscribe(result => {\r\n      this.snackBar.open('Deleted', null, { duration: 2000 });\r\n      this.fetchContentTypes();\r\n    });\r\n  }\r\n\r\n  private refreshScopeOnRouteChange() {\r\n    this.subscription.add(\r\n      this.router.events.pipe(\r\n        filter(event => event instanceof NavigationEnd),\r\n        map(() => this.route.snapshot.firstChild.paramMap.get('scope')),\r\n        startWith(this.route.snapshot.firstChild.paramMap.get('scope')),\r\n        filter(scope => !!scope),\r\n        distinctUntilChanged(),\r\n      ).subscribe(scope => {\r\n        this.scope$.next(scope);\r\n        if (!this.scopeOptions$.value.map(option => option.value).includes(scope)) {\r\n          const newScopeOption: ScopeOption = {\r\n            name: scope,\r\n            value: scope,\r\n          };\r\n          this.scopeOptions$.next([...this.scopeOptions$.value, newScopeOption]);\r\n        }\r\n        this.fetchContentTypes();\r\n      })\r\n    );\r\n  }\r\n\r\n  private refreshOnChildClosed() {\r\n    this.subscription.add(\r\n      this.router.events.pipe(\r\n        filter(event => event instanceof NavigationEnd),\r\n        startWith(!!this.route.snapshot.firstChild.firstChild),\r\n        map(() => !!this.route.snapshot.firstChild.firstChild),\r\n        pairwise(),\r\n        filter(([hadChild, hasChild]) => hadChild && !hasChild),\r\n      ).subscribe(() => {\r\n        this.fetchContentTypes();\r\n      })\r\n    );\r\n  }\r\n\r\n}\r\n","import { Query } from '../../models/query.model';\r\nimport { IAgActions } from '../ag-actions';\r\n\r\n// Test 2dm 2020-11-20 - I believe the current model has way too much ceremony\r\n// I need to change ca. 10 places just to get one more action to work\r\n// that's not great\r\nexport enum QueryActions {\r\n  Edit,\r\n  Metadata,\r\n  Rest,\r\n  Clone,\r\n  Permissions,\r\n  Export,\r\n  Delete,\r\n}\r\n\r\nexport interface QueriesActionsParams extends IAgActions<QueryActions, Query> {\r\n  getEnablePermissions(): boolean;\r\n}\r\n","import { ICellRendererParams } from '@ag-grid-community/all-modules';\r\nimport { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\n\r\nexport class AgActionsComponent<TParams extends ICellRendererParams, TData> implements ICellRendererAngularComp {\r\n  public item: TData;\r\n  public params: TParams;\r\n\r\n  constructor() { }\r\n\r\n  agInit(params: TParams) {\r\n    this.params = params;\r\n    this.item = this.params.data;\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n\r\n}\r\n","<div class=\"actions-component\">\r\n  <div class=\"like-button highlight\" matRipple tippy=\"Edit\" (click)=\"params.do(actions.Edit, item)\">\r\n    <mat-icon>edit</mat-icon>\r\n  </div>\r\n\r\n  <div class=\"like-button highlight\" matRipple *ngIf=\"!item._EditInfo.ReadOnly\" tippy=\"Metadata\"\r\n    (click)=\"params.do(actions.Metadata, item)\">\r\n    <mat-icon [matBadge]=\"item.Metadata?.length\" matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n      [matBadgeHidden]=\"!item.Metadata?.length\">\r\n      local_offer\r\n    </mat-icon>\r\n  </div>\r\n  <div class=\"like-button disabled\" *ngIf=\"item._EditInfo.ReadOnly\">\r\n    <mat-icon [matBadge]=\"item.Metadata?.length\" matBadgeColor=\"accent\" matBadgeSize=\"small\" matBadgeDisabled=\"true\"\r\n      [matBadgeHidden]=\"!item.Metadata?.length\">\r\n      local_offer\r\n    </mat-icon>\r\n  </div>\r\n\r\n  <div class=\"like-button highlight\" matRipple *ngIf=\"!item._EditInfo.ReadOnly && enablePermissions\" tippy=\"Permissions\"\r\n    (click)=\"params.do(actions.Permissions, item)\">\r\n    <mat-icon [matBadge]=\"item._Permissions.Count\" matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n      [matBadgeHidden]=\"!item._Permissions.Count\">\r\n      person\r\n    </mat-icon>\r\n  </div>\r\n  <div class=\"like-button disabled\" *ngIf=\"item._EditInfo.ReadOnly || !enablePermissions\">\r\n    <mat-icon [matBadge]=\"item._Permissions.Count\" matBadgeColor=\"accent\" matBadgeSize=\"small\" matBadgeDisabled=\"true\"\r\n      [matBadgeHidden]=\"!item._Permissions.Count\">\r\n      person\r\n    </mat-icon>\r\n  </div>\r\n\r\n  <div class=\"like-button highlight\" matRipple tippy=\"More\" [matMenuTriggerFor]=\"menu\">\r\n    <mat-icon>more_horiz</mat-icon>\r\n  </div>\r\n</div>\r\n\r\n<mat-menu #menu=\"matMenu\" class=\"grid-more-menu\">\r\n  <button mat-menu-item (click)=\"params.do(actions.Rest, item)\">\r\n    <mat-icon svgIcon=\"code-curly\"></mat-icon>\r\n    <span>REST API</span>\r\n  </button>\r\n  <button mat-menu-item (click)=\"params.do(actions.Clone, item)\">\r\n    <mat-icon>file_copy</mat-icon>\r\n    <span>Copy</span>\r\n  </button>\r\n  <button mat-menu-item (click)=\"params.do(actions.Export, item)\">\r\n    <mat-icon>cloud_download</mat-icon>\r\n    <span>Export</span>\r\n  </button>\r\n  <button mat-menu-item [disabled]=\"item._EditInfo.ReadOnly\" (click)=\"params.do(actions.Delete, item)\">\r\n    <mat-icon>delete</mat-icon>\r\n    <span>Delete</span>\r\n  </button>\r\n</mat-menu>\r\n","import { Component } from '@angular/core';\r\nimport { Query } from '../../models/query.model';\r\nimport { AgActionsComponent } from '../ag-actions';\r\nimport { QueriesActionsParams, QueryActions } from './queries-actions';\r\n\r\n@Component({\r\n  selector: 'app-queries-actions',\r\n  templateUrl: './queries-actions.component.html',\r\n})\r\nexport class QueriesActionsComponent extends AgActionsComponent<QueriesActionsParams, Query> {\r\n  enablePermissions: boolean;\r\n\r\n  public actions = QueryActions;\r\n\r\n  agInit(params: QueriesActionsParams) {\r\n    super.agInit(params);\r\n    this.enablePermissions = this.params.getEnablePermissions();\r\n  }\r\n}\r\n","import { AllCommunityModules, GridOptions } from '@ag-grid-community/all-modules';\r\nimport { Component, Input, OnDestroy, OnInit } from '@angular/core';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { ActivatedRoute, NavigationEnd, Router } from '@angular/router';\r\nimport { BehaviorSubject, Subscription } from 'rxjs';\r\nimport { filter, map, pairwise, startWith } from 'rxjs/operators';\r\nimport { ContentExportService } from '../../content-export/services/content-export.service';\r\nimport { GoToDevRest } from '../../dev-rest/go-to-dev-rest';\r\nimport { GoToMetadata } from '../../metadata';\r\nimport { GoToPermissions } from '../../permissions/go-to-permissions';\r\nimport { IdFieldComponent } from '../../shared/components/id-field/id-field.component';\r\nimport { IdFieldParams } from '../../shared/components/id-field/id-field.models';\r\nimport { defaultGridOptions } from '../../shared/constants/default-grid-options.constants';\r\nimport { eavConstants } from '../../shared/constants/eav.constants';\r\nimport { convertFormToUrl } from '../../shared/helpers/url-prep.helper';\r\nimport { EditForm } from '../../shared/models/edit-form.model';\r\nimport { DialogService } from '../../shared/services/dialog.service';\r\nimport { QueriesActionsParams, QueryActions } from '../ag-grid-components/queries-actions/queries-actions';\r\nimport { QueriesActionsComponent } from '../ag-grid-components/queries-actions/queries-actions.component';\r\nimport { Query } from '../models/query.model';\r\nimport { PipelinesService } from '../services/pipelines.service';\r\nimport { ImportQueryDialogData } from '../sub-dialogs/import-query/import-query-dialog.config';\r\n\r\n@Component({\r\n  selector: 'app-queries',\r\n  templateUrl: './queries.component.html',\r\n  styleUrls: ['./queries.component.scss'],\r\n})\r\nexport class QueriesComponent implements OnInit, OnDestroy {\r\n  @Input() enablePermissions: boolean;\r\n\r\n  queries$ = new BehaviorSubject<Query[]>(null);\r\n  modules = AllCommunityModules;\r\n  gridOptions: GridOptions = {\r\n    ...defaultGridOptions,\r\n    frameworkComponents: {\r\n      idFieldComponent: IdFieldComponent,\r\n      queriesActionsComponent: QueriesActionsComponent,\r\n    },\r\n    columnDefs: [\r\n      {\r\n        headerName: 'ID', field: 'Id', width: 70, headerClass: 'dense',\r\n        cellClass: (params) => `${(params.data as Query)._EditInfo.ReadOnly ? 'disabled' : ''} id-action no-padding no-outline`,\r\n        cellRenderer: 'idFieldComponent', sortable: true, filter: 'agNumberColumnFilter',\r\n        valueGetter: (params) => (params.data as Query).Id,\r\n        cellRendererParams: {\r\n          tooltipGetter: (query: Query) => `ID: ${query.Id}\\nGUID: ${query.Guid}`,\r\n        } as IdFieldParams,\r\n      },\r\n      {\r\n        field: 'Name', flex: 2, minWidth: 250, sortable: true,\r\n        cellClass: (params) => (params.data as Query)._EditInfo.ReadOnly ? 'no-outline' : 'primary-action highlight',\r\n        sort: 'asc', filter: 'agTextColumnFilter', onCellClicked: (params) => this.openVisualQueryDesigner(params.data as Query),\r\n        valueGetter: (params) => (params.data as Query).Name,\r\n      },\r\n      {\r\n        field: 'Description', flex: 2, minWidth: 250, cellClass: 'no-outline', sortable: true,\r\n        filter: 'agTextColumnFilter', valueGetter: (params) => (params.data as Query).Description,\r\n      },\r\n      {\r\n        width: 162, cellClass: 'secondary-action no-padding', pinned: 'right',\r\n        cellRenderer: 'queriesActionsComponent', cellRendererParams: {\r\n          getEnablePermissions: () => this.enablePermissionsGetter(),\r\n          do: (action, query) => this.doMenuAction(action, query),\r\n        } as QueriesActionsParams,\r\n      },\r\n    ],\r\n  };\r\n\r\n  private subscription = new Subscription();\r\n\r\n  constructor(\r\n    private router: Router,\r\n    private route: ActivatedRoute,\r\n    private pipelinesService: PipelinesService,\r\n    private contentExportService: ContentExportService,\r\n    private snackBar: MatSnackBar,\r\n    private dialogService: DialogService,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.fetchQueries();\r\n    this.refreshOnChildClosed();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.queries$.complete();\r\n    this.subscription.unsubscribe();\r\n  }\r\n\r\n  private fetchQueries() {\r\n    this.pipelinesService.getAll(eavConstants.contentTypes.query).subscribe((queries: Query[]) => {\r\n      this.queries$.next(queries);\r\n    });\r\n  }\r\n\r\n  importQuery(files?: File[]) {\r\n    const dialogData: ImportQueryDialogData = { files };\r\n    this.router.navigate(['import'], { relativeTo: this.route.firstChild, state: dialogData });\r\n  }\r\n\r\n  /**\r\n   * Experiment by 2dm 2020-11-20 - trying to reduce the ceremony around menus\r\n   * Once this works, we would then remove all the 3-line functions below, as they\r\n   * would just be added here (if that's the only place they are used)\r\n   */\r\n  private doMenuAction(action: QueryActions, query: Query) {\r\n    switch (action) {\r\n      case QueryActions.Edit:\r\n        return this.editQuery(query);\r\n      case QueryActions.Metadata:\r\n        return this.openMetadata(query);\r\n      case QueryActions.Rest:\r\n        return this.router.navigate([GoToDevRest.getUrlQuery(query.Guid)], { relativeTo: this.route.firstChild });\r\n      case QueryActions.Clone:\r\n        return this.cloneQuery(query);\r\n      case QueryActions.Permissions:\r\n        return this.openPermissions(query);\r\n      case QueryActions.Export:\r\n        return this.exportQuery(query);\r\n      case QueryActions.Delete:\r\n        return this.deleteQuery(query);\r\n    }\r\n  }\r\n\r\n  editQuery(query: Query) {\r\n    const form: EditForm = {\r\n      items: [\r\n        query == null\r\n          ? {\r\n            ContentTypeName: eavConstants.contentTypes.query,\r\n            Prefill: { TestParameters: eavConstants.pipelineDesigner.testParameters }\r\n          }\r\n          : { EntityId: query.Id }\r\n      ],\r\n    };\r\n    const formUrl = convertFormToUrl(form);\r\n    this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private enablePermissionsGetter() {\r\n    return this.enablePermissions;\r\n  }\r\n\r\n  private openVisualQueryDesigner(query: Query) {\r\n    if (query._EditInfo.ReadOnly) { return; }\r\n    this.dialogService.openQueryDesigner(query.Id);\r\n  }\r\n\r\n  private openMetadata(query: Query) {\r\n    const url = GoToMetadata.getUrlEntity(\r\n      query.Guid,\r\n      `Metadata for Query: ${query.Name} (${query.Id})`,\r\n    );\r\n    this.router.navigate([url], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private cloneQuery(query: Query) {\r\n    this.snackBar.open('Copying...');\r\n    this.pipelinesService.clonePipeline(query.Id).subscribe(() => {\r\n      this.snackBar.open('Copied', null, { duration: 2000 });\r\n      this.fetchQueries();\r\n    });\r\n  }\r\n\r\n  private openPermissions(query: Query) {\r\n    this.router.navigate([GoToPermissions.getUrlEntity(query.Guid)], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private exportQuery(query: Query) {\r\n    this.contentExportService.exportEntity(query.Id, 'Query', true);\r\n  }\r\n\r\n  private deleteQuery(query: Query) {\r\n    if (!confirm(`Delete Pipeline '${query.Name}' (${query.Id})?`)) { return; }\r\n    this.snackBar.open('Deleting...');\r\n    this.pipelinesService.delete(query.Id).subscribe(res => {\r\n      this.snackBar.open('Deleted', null, { duration: 2000 });\r\n      this.fetchQueries();\r\n    });\r\n  }\r\n\r\n  private refreshOnChildClosed() {\r\n    this.subscription.add(\r\n      this.router.events.pipe(\r\n        filter(event => event instanceof NavigationEnd),\r\n        startWith(!!this.route.snapshot.firstChild.firstChild),\r\n        map(() => !!this.route.snapshot.firstChild.firstChild),\r\n        pairwise(),\r\n        filter(([hadChild, hasChild]) => hadChild && !hasChild),\r\n      ).subscribe(() => {\r\n        this.fetchQueries();\r\n      })\r\n    );\r\n  }\r\n\r\n}\r\n","<div class=\"grid-wrapper mat-tab-grid-wrapper\">\r\n  <ag-grid-angular class=\"ag-theme-material\" [rowData]=\"queries$ | async\" [modules]=\"modules\"\r\n    [gridOptions]=\"gridOptions\" appDragAndDrop [allowedFileTypes]=\"'json'\" (filesDropped)=\"importQuery($event)\">\r\n  </ag-grid-angular>\r\n\r\n  <div class=\"grid-more-actions-box\">\r\n    <button mat-button tippy=\"Import query\" (click)=\"importQuery()\">\r\n      <mat-icon>cloud_upload</mat-icon>\r\n      <span>Query</span>\r\n    </button>\r\n  </div>\r\n\r\n  <button mat-fab mat-elevation-z24 class=\"grid-fab\" tippy=\"Create a new query\" (click)=\"editQuery(null)\">\r\n    <mat-icon>add</mat-icon>\r\n  </button>\r\n</div>\r\n","<div class=\"actions-component\">\r\n  <div class=\"like-button highlight\" matRipple *ngIf=\"!view.EditInfo.ReadOnly && enableCode\" tippy=\"Code\"\r\n    (click)=\"openCode()\">\r\n    <mat-icon>code</mat-icon>\r\n  </div>\r\n  <div class=\"like-button disabled\" *ngIf=\"view.EditInfo.ReadOnly || !enableCode\">\r\n    <mat-icon>code</mat-icon>\r\n  </div>\r\n\r\n  <div class=\"like-button highlight\" matRipple *ngIf=\"!view.EditInfo.ReadOnly\" tippy=\"Metadata\"\r\n    (click)=\"openMetadata()\">\r\n    <mat-icon [matBadge]=\"view.Metadata.length\" matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n      [matBadgeHidden]=\"!view.Metadata.length\">\r\n      local_offer\r\n    </mat-icon>\r\n  </div>\r\n  <div class=\"like-button disabled\" *ngIf=\"view.EditInfo.ReadOnly\">\r\n    <mat-icon [matBadge]=\"view.Metadata.length\" matBadgeColor=\"accent\" matBadgeSize=\"small\" matBadgeDisabled=\"true\"\r\n      [matBadgeHidden]=\"!view.Metadata.length\">\r\n      local_offer\r\n    </mat-icon>\r\n  </div>\r\n\r\n  <div class=\"like-button highlight\" matRipple *ngIf=\"!view.EditInfo.ReadOnly && enablePermissions\" tippy=\"Permissions\"\r\n    (click)=\"openPermissions()\">\r\n    <mat-icon [matBadge]=\"view.Permissions.Count\" matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n      [matBadgeHidden]=\"!view.Permissions.Count\">\r\n      person\r\n    </mat-icon>\r\n  </div>\r\n  <div class=\"like-button disabled\" *ngIf=\"view.EditInfo.ReadOnly || !enablePermissions\">\r\n    <mat-icon [matBadge]=\"view.Permissions.Count\" matBadgeColor=\"accent\" matBadgeSize=\"small\" matBadgeDisabled=\"true\"\r\n      [matBadgeHidden]=\"!view.Permissions.Count\">\r\n      person\r\n    </mat-icon>\r\n  </div>\r\n\r\n  <div class=\"like-button highlight\" matRipple tippy=\"More\" [matMenuTriggerFor]=\"menu\">\r\n    <mat-icon>more_horiz</mat-icon>\r\n  </div>\r\n</div>\r\n\r\n<mat-menu #menu=\"matMenu\" class=\"grid-more-menu\">\r\n  <button mat-menu-item (click)=\"cloneView()\">\r\n    <mat-icon>file_copy</mat-icon>\r\n    <span>Copy</span>\r\n  </button>\r\n  <button mat-menu-item (click)=\"exportView()\">\r\n    <mat-icon>cloud_download</mat-icon>\r\n    <span>Export</span>\r\n  </button>\r\n  <button mat-menu-item [disabled]=\"view.EditInfo.ReadOnly\" (click)=\"deleteView()\">\r\n    <mat-icon>delete</mat-icon>\r\n    <span>Delete</span>\r\n  </button>\r\n</mat-menu>\r\n","import { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { Component } from '@angular/core';\r\nimport { View } from '../../models/view.model';\r\nimport { ViewActionsParams } from './views-actions.models';\r\n\r\n@Component({\r\n  selector: 'app-views-actions',\r\n  templateUrl: './views-actions.component.html',\r\n  styleUrls: ['./views-actions.component.scss'],\r\n})\r\nexport class ViewsActionsComponent implements ICellRendererAngularComp {\r\n  view: View;\r\n  enableCode: boolean;\r\n  enablePermissions: boolean;\r\n  private params: ViewActionsParams;\r\n\r\n  constructor() { }\r\n\r\n  agInit(params: ViewActionsParams) {\r\n    this.params = params;\r\n    this.view = this.params.data;\r\n    this.enableCode = this.params.enableCodeGetter();\r\n    this.enablePermissions = this.params.enablePermissionsGetter();\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n\r\n  openCode() {\r\n    this.params.onOpenCode(this.view);\r\n  }\r\n\r\n  openPermissions() {\r\n    this.params.onOpenPermissions(this.view);\r\n  }\r\n\r\n  openMetadata() {\r\n    this.params.onOpenMetadata(this.view);\r\n  }\r\n\r\n  cloneView() {\r\n    this.params.onClone(this.view);\r\n  }\r\n\r\n  exportView() {\r\n    this.params.onExport(this.view);\r\n  }\r\n\r\n  deleteView() {\r\n    this.params.onDelete(this.view);\r\n  }\r\n}\r\n","<div class=\"icon-container\">\r\n  <mat-icon *ngIf=\"value\">visibility</mat-icon>\r\n  <mat-icon *ngIf=\"!value\">visibility_off</mat-icon>\r\n</div>\r\n","import { ICellRendererParams } from '@ag-grid-community/all-modules';\r\nimport { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { Component } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-views-show',\r\n  templateUrl: './views-show.component.html',\r\n  styleUrls: ['./views-show.component.scss'],\r\n})\r\nexport class ViewsShowComponent implements ICellRendererAngularComp {\r\n  value: boolean;\r\n\r\n  agInit(params: ICellRendererParams) {\r\n    this.value = params.value;\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n}\r\n","import { View } from '../models/view.model';\r\n\r\nexport function calculateViewType(view: View) {\r\n  let value = '';\r\n  let icon = '';\r\n  if (view.HasQuery) {\r\n    value = 'Data (from query)';\r\n    icon = 'filter_list';\r\n  } else if (view.List) {\r\n    value = 'Items (list)';\r\n    icon = 'format_list_numbered';\r\n  } else if (!view.ContentType && !view.HasQuery) {\r\n    value = 'Code';\r\n    icon = 'check_box_outline_blank';\r\n  } else if (!view.List) {\r\n    value = 'Item (one)';\r\n    icon = 'looks_one';\r\n  }\r\n  return { value, icon };\r\n}\r\n","<div class=\"icon-container\">\r\n  <div class=\"like-button icon\" [tippy]=\"value\">\r\n    <mat-icon>{{ icon }}</mat-icon>\r\n  </div>\r\n  <div class=\"like-button icon\" tippy=\"View is shared\" *ngIf=\"isShared\">\r\n    <mat-icon>share</mat-icon>\r\n  </div>\r\n</div>\r\n","import { ICellRendererParams } from '@ag-grid-community/all-modules';\r\nimport { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { Component } from '@angular/core';\r\nimport { View } from '../../models';\r\nimport { calculateViewType } from '../../views/views.helpers';\r\n\r\n@Component({\r\n  selector: 'app-views-type',\r\n  templateUrl: './views-type.component.html',\r\n  styleUrls: ['./views-type.component.scss'],\r\n})\r\nexport class ViewsTypeComponent implements ICellRendererAngularComp {\r\n  value: string;\r\n  icon: string;\r\n  isShared: boolean;\r\n\r\n  agInit(params: ICellRendererParams) {\r\n    this.value = params.value;\r\n    const view: View = params.data;\r\n    const type = calculateViewType(view);\r\n    this.icon = type.icon;\r\n    this.isShared = view.IsShared;\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n}\r\n","import polymorphLogo from '!url-loader!./polymorph-logo.png';\r\nimport { AllCommunityModules, GridOptions, ValueGetterParams } from '@ag-grid-community/all-modules';\r\nimport { Component, Input, OnDestroy, OnInit } from '@angular/core';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { ActivatedRoute, NavigationEnd, Router } from '@angular/router';\r\nimport { BehaviorSubject, Subscription } from 'rxjs';\r\nimport { filter, map, pairwise, startWith } from 'rxjs/operators';\r\nimport { GoToMetadata } from '../../metadata';\r\nimport { GoToPermissions } from '../../permissions/go-to-permissions';\r\nimport { BooleanFilterComponent } from '../../shared/components/boolean-filter/boolean-filter.component';\r\nimport { IdFieldComponent } from '../../shared/components/id-field/id-field.component';\r\nimport { IdFieldParams } from '../../shared/components/id-field/id-field.models';\r\nimport { defaultGridOptions } from '../../shared/constants/default-grid-options.constants';\r\nimport { eavConstants } from '../../shared/constants/eav.constants';\r\nimport { convertFormToUrl } from '../../shared/helpers/url-prep.helper';\r\nimport { EditForm } from '../../shared/models/edit-form.model';\r\nimport { DialogService } from '../../shared/services/dialog.service';\r\nimport { ViewsActionsComponent } from '../ag-grid-components/views-actions/views-actions.component';\r\nimport { ViewActionsParams } from '../ag-grid-components/views-actions/views-actions.models';\r\nimport { ViewsShowComponent } from '../ag-grid-components/views-show/views-show.component';\r\nimport { ViewsTypeComponent } from '../ag-grid-components/views-type/views-type.component';\r\nimport { Polymorphism } from '../models/polymorphism.model';\r\nimport { View } from '../models/view.model';\r\nimport { ViewsService } from '../services/views.service';\r\nimport { ImportViewDialogData } from '../sub-dialogs/import-view/import-view-dialog.config';\r\nimport { calculateViewType } from './views.helpers';\r\n\r\n@Component({\r\n  selector: 'app-views',\r\n  templateUrl: './views.component.html',\r\n  styleUrls: ['./views.component.scss'],\r\n})\r\nexport class ViewsComponent implements OnInit, OnDestroy {\r\n  @Input() enableCode: boolean;\r\n  @Input() enablePermissions: boolean;\r\n  @Input() appIsGlobal: boolean;\r\n  @Input() appIsInherited: boolean;\r\n\r\n  views$ = new BehaviorSubject<View[]>(null);\r\n  polymorphStatus$ = new BehaviorSubject('');\r\n  polymorphLogo = polymorphLogo;\r\n\r\n  modules = AllCommunityModules;\r\n  gridOptions: GridOptions = {\r\n    ...defaultGridOptions,\r\n    frameworkComponents: {\r\n      idFieldComponent: IdFieldComponent,\r\n      booleanFilterComponent: BooleanFilterComponent,\r\n      viewsTypeComponent: ViewsTypeComponent,\r\n      viewsShowComponent: ViewsShowComponent,\r\n      viewsActionsComponent: ViewsActionsComponent,\r\n    },\r\n    columnDefs: [\r\n      {\r\n        headerName: 'ID', field: 'Id', width: 70, headerClass: 'dense',\r\n        cellClass: (params) => `${(params.data as View).EditInfo.ReadOnly ? 'disabled' : ''} id-action no-padding no-outline`,\r\n        cellRenderer: 'idFieldComponent', sortable: true, filter: 'agNumberColumnFilter',\r\n        valueGetter: (params) => (params.data as View).Id,\r\n        cellRendererParams: {\r\n          tooltipGetter: (view: View) => `ID: ${view.Id}\\nGUID: ${view.Guid}`,\r\n        } as IdFieldParams,\r\n      },\r\n      {\r\n        field: 'Show', width: 70, headerClass: 'dense', cellClass: 'no-outline', cellRenderer: 'viewsShowComponent',\r\n        sortable: true, filter: 'booleanFilterComponent', valueGetter: this.showValueGetter,\r\n      },\r\n      {\r\n        field: 'Name', flex: 2, minWidth: 250, cellClass: 'primary-action highlight',\r\n        sortable: true, sort: 'asc', filter: 'agTextColumnFilter', onCellClicked: (event) => this.editView(event.data as View),\r\n        valueGetter: (params) => (params.data as View).Name,\r\n      },\r\n      {\r\n        field: 'Type', width: 82, headerClass: 'dense', cellClass: 'no-padding no-outline',\r\n        sortable: true, filter: 'agTextColumnFilter', cellRenderer: 'viewsTypeComponent', valueGetter: this.typeValueGetter,\r\n      },\r\n      {\r\n        field: 'Used', width: 70, headerClass: 'dense', cellClass: 'primary-action highlight',\r\n        sortable: true, filter: 'agNumberColumnFilter', onCellClicked: (event) => this.openUsage(event.data as View),\r\n        valueGetter: (params) => (params.data as View).Used,\r\n      },\r\n      {\r\n        headerName: 'Url Key', field: 'UrlKey', flex: 1, minWidth: 150, cellClass: 'no-outline',\r\n        sortable: true, filter: 'agTextColumnFilter', valueGetter: (params) => (params.data as View).ViewNameInUrl,\r\n      },\r\n      {\r\n        field: 'Path', flex: 2, minWidth: 250, cellClass: 'no-outline',\r\n        sortable: true, filter: 'agTextColumnFilter', valueGetter: (params) => (params.data as View).TemplatePath,\r\n      },\r\n      {\r\n        field: 'Content', flex: 2, minWidth: 250, cellClass: 'no-outline',\r\n        sortable: true, filter: 'agTextColumnFilter', valueGetter: (params) => (params.data as View).ContentType.Name,\r\n      },\r\n      {\r\n        headerName: 'Default', field: 'ContentDemo', flex: 1, minWidth: 150, cellClass: 'no-outline',\r\n        sortable: true, filter: 'agTextColumnFilter', valueGetter: this.contentDemoValueGetter,\r\n      },\r\n      {\r\n        field: 'Presentation', flex: 2, minWidth: 250, cellClass: 'no-outline',\r\n        sortable: true, filter: 'agTextColumnFilter', valueGetter: (params) => (params.data as View).PresentationType.Name,\r\n      },\r\n      {\r\n        headerName: 'Default', field: 'PresentationDemo', flex: 1, minWidth: 150, cellClass: 'no-outline',\r\n        sortable: true, filter: 'agTextColumnFilter', valueGetter: this.presentationDemoValueGetter,\r\n      },\r\n      {\r\n        field: 'Header', flex: 2, minWidth: 250, cellClass: 'no-outline',\r\n        sortable: true, filter: 'agTextColumnFilter', valueGetter: (params) => (params.data as View).ListContentType.Name,\r\n      },\r\n      {\r\n        headerName: 'Default', field: 'HeaderDemo', flex: 1, minWidth: 150, cellClass: 'no-outline',\r\n        sortable: true, filter: 'agTextColumnFilter', valueGetter: this.headerDemoValueGetter,\r\n      },\r\n      {\r\n        headerName: 'Header Presentation', field: 'HeaderPresentation', flex: 2, minWidth: 250, cellClass: 'no-outline',\r\n        sortable: true, filter: 'agTextColumnFilter', valueGetter: (params) => (params.data as View).ListPresentationType.Name,\r\n      },\r\n      {\r\n        headerName: 'Default', field: 'HeaderPresentationDemo', flex: 1, minWidth: 150, cellClass: 'no-outline',\r\n        sortable: true, filter: 'agTextColumnFilter', valueGetter: this.headerPresDemoValueGetter,\r\n      },\r\n      {\r\n        width: 162, cellClass: 'secondary-action no-padding', cellRenderer: 'viewsActionsComponent', pinned: 'right',\r\n        cellRendererParams: {\r\n          enableCodeGetter: () => this.enableCodeGetter(),\r\n          enablePermissionsGetter: () => this.enablePermissionsGetter(),\r\n          onOpenCode: (view) => this.openCode(view),\r\n          onOpenPermissions: (view) => this.openPermissions(view),\r\n          onOpenMetadata: (view) => this.openMetadata(view),\r\n          onClone: (view) => this.cloneView(view),\r\n          onExport: (view) => this.exportView(view),\r\n          onDelete: (view) => this.deleteView(view),\r\n        } as ViewActionsParams,\r\n      },\r\n    ],\r\n  };\r\n\r\n  private subscription = new Subscription();\r\n  private polymorphism: Polymorphism;\r\n\r\n  constructor(\r\n    private viewsService: ViewsService,\r\n    private router: Router,\r\n    private route: ActivatedRoute,\r\n    private snackBar: MatSnackBar,\r\n    private dialogService: DialogService,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.fetchTemplates();\r\n    this.fetchPolymorphism();\r\n    this.refreshOnChildClosed();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.views$.complete();\r\n    this.polymorphStatus$.complete();\r\n    this.subscription.unsubscribe();\r\n  }\r\n\r\n  importView(files?: File[]) {\r\n    const importViewData: ImportViewDialogData = { files };\r\n    this.router.navigate(['import'], { relativeTo: this.route.firstChild, state: importViewData });\r\n  }\r\n\r\n  private fetchTemplates() {\r\n    this.viewsService.getAll().subscribe(views => {\r\n      this.views$.next(views);\r\n    });\r\n  }\r\n\r\n  private fetchPolymorphism() {\r\n    this.viewsService.getPolymorphism().subscribe(polymorphism => {\r\n      this.polymorphism = polymorphism;\r\n      const polymorphStatus = (polymorphism.Id === null)\r\n        ? 'not configured'\r\n        : (polymorphism.Resolver === null ? 'disabled' : 'using ' + polymorphism.Resolver);\r\n      this.polymorphStatus$.next(polymorphStatus);\r\n    });\r\n  }\r\n\r\n  editView(view?: View) {\r\n    const form: EditForm = {\r\n      items: [\r\n        view == null\r\n          ? {\r\n            ContentTypeName: eavConstants.contentTypes.template,\r\n            Prefill: {\r\n              ...(this.appIsGlobal && { Location: 'Global' }),\r\n            },\r\n          }\r\n          : { EntityId: view.Id }\r\n      ],\r\n    };\r\n    const formUrl = convertFormToUrl(form);\r\n    this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  editPolymorphisms() {\r\n    if (!this.polymorphism) { return; }\r\n\r\n    const form: EditForm = {\r\n      items: [\r\n        !this.polymorphism.Id\r\n          ? { ContentTypeName: this.polymorphism.TypeName }\r\n          : { EntityId: this.polymorphism.Id }\r\n      ],\r\n    };\r\n    const formUrl = convertFormToUrl(form);\r\n    this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private showValueGetter(params: ValueGetterParams) {\r\n    const view: View = params.data;\r\n    return !view.IsHidden;\r\n  }\r\n\r\n  private typeValueGetter(params: ValueGetterParams) {\r\n    const view: View = params.data;\r\n    const type = calculateViewType(view);\r\n    return type.value;\r\n  }\r\n\r\n  private enableCodeGetter() {\r\n    return this.enableCode;\r\n  }\r\n\r\n  private enablePermissionsGetter() {\r\n    return this.enablePermissions;\r\n  }\r\n\r\n  private contentDemoValueGetter(params: ValueGetterParams) {\r\n    const view: View = params.data;\r\n    return `${view.ContentType.DemoId} ${view.ContentType.DemoTitle}`;\r\n  }\r\n\r\n  private presentationDemoValueGetter(params: ValueGetterParams) {\r\n    const view: View = params.data;\r\n    return `${view.PresentationType.DemoId} ${view.PresentationType.DemoTitle}`;\r\n  }\r\n\r\n  private headerDemoValueGetter(params: ValueGetterParams) {\r\n    const view: View = params.data;\r\n    return `${view.ListContentType.DemoId} ${view.ListContentType.DemoTitle}`;\r\n  }\r\n\r\n  private headerPresDemoValueGetter(params: ValueGetterParams) {\r\n    const view: View = params.data;\r\n    return `${view.ListPresentationType.DemoId} ${view.ListPresentationType.DemoTitle}`;\r\n  }\r\n\r\n  private openUsage(view: View) {\r\n    this.router.navigate([`usage/${view.Guid}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private openCode(view: View) {\r\n    this.dialogService.openCodeFile(view.TemplatePath, view.IsShared, view.Id);\r\n  }\r\n\r\n  private openPermissions(view: View) {\r\n    this.router.navigate([GoToPermissions.getUrlEntity(view.Guid)], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private openMetadata(view: View) {\r\n    const url = GoToMetadata.getUrlEntity(\r\n      view.Guid,\r\n      `Metadata for View: ${view.Name} (${view.Id})`,\r\n    );\r\n    this.router.navigate([url], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private cloneView(view: View) {\r\n    const form: EditForm = {\r\n      items: [{ ContentTypeName: eavConstants.contentTypes.template, DuplicateEntity: view.Id }],\r\n    };\r\n    const formUrl = convertFormToUrl(form);\r\n    this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private exportView(view: View) {\r\n    this.viewsService.export(view.Id);\r\n  }\r\n\r\n  private deleteView(view: View) {\r\n    if (!confirm(`Delete '${view.Name}' (${view.Id})?`)) { return; }\r\n    this.snackBar.open('Deleting...');\r\n    this.viewsService.delete(view.Id).subscribe(res => {\r\n      this.snackBar.open('Deleted', null, { duration: 2000 });\r\n      this.fetchTemplates();\r\n    });\r\n  }\r\n\r\n  private refreshOnChildClosed() {\r\n    this.subscription.add(\r\n      this.router.events.pipe(\r\n        filter(event => event instanceof NavigationEnd),\r\n        startWith(!!this.route.snapshot.firstChild.firstChild),\r\n        map(() => !!this.route.snapshot.firstChild.firstChild),\r\n        pairwise(),\r\n        filter(([hadChild, hasChild]) => hadChild && !hasChild),\r\n      ).subscribe(() => {\r\n        this.fetchTemplates();\r\n        this.fetchPolymorphism();\r\n      })\r\n    );\r\n  }\r\n}\r\n","export default \"data:image/png;base64,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\"","<div class=\"grid-wrapper mat-tab-grid-wrapper\">\r\n  <ag-grid-angular class=\"ag-theme-material\" [rowData]=\"views$ | async\" [modules]=\"modules\" [gridOptions]=\"gridOptions\"\r\n    appDragAndDrop [allowedFileTypes]=\"'json'\" (filesDropped)=\"importView($event)\">\r\n  </ag-grid-angular>\r\n\r\n  <div class=\"grid-more-actions-box\">\r\n    <button mat-button class=\"polymorph-button\" tippy=\"Configure polymorphism\" [disabled]=\"appIsInherited\"\r\n      (click)=\"editPolymorphisms()\">\r\n      <img class=\"polymorph-logo\" [src]=\"polymorphLogo\">\r\n      <span>Polymorphism {{ polymorphStatus$ | async }}</span>\r\n    </button>\r\n\r\n    <button mat-button tippy=\"Import view\" (click)=\"importView()\">\r\n      <mat-icon>cloud_upload</mat-icon>\r\n      <span>View</span>\r\n    </button>\r\n  </div>\r\n\r\n  <button mat-fab mat-elevation-z24 class=\"grid-fab\" tippy=\"Create a new view\" (click)=\"editView(null)\">\r\n    <mat-icon>add</mat-icon>\r\n  </button>\r\n</div>\r\n","<div class=\"actions-component\">\r\n  <div class=\"like-button highlight\" matRipple *ngIf=\"enableCode\" tippy=\"Code\" (click)=\"openCode()\">\r\n    <mat-icon>code</mat-icon>\r\n  </div>\r\n  <div class=\"like-button disabled\" *ngIf=\"!enableCode\">\r\n    <mat-icon>code</mat-icon>\r\n  </div>\r\n\r\n  <div class=\"like-button highlight\" matRipple tippy=\"More\" [matMenuTriggerFor]=\"menu\">\r\n    <mat-icon>more_horiz</mat-icon>\r\n  </div>\r\n</div>\r\n\r\n<mat-menu #menu=\"matMenu\" class=\"grid-more-menu\">\r\n  <button mat-menu-item (click)=\"openRestApi()\">\r\n    <mat-icon svgIcon=\"code-curly\"></mat-icon>\r\n    <span>REST API</span>\r\n  </button>\r\n</mat-menu>\r\n","import { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { Component } from '@angular/core';\r\nimport { WebApi } from '../../models/web-api.model';\r\nimport { WebApiActionsParams } from './web-api-actions.models';\r\n\r\n@Component({\r\n  selector: 'app-web-api-actions',\r\n  templateUrl: './web-api-actions.component.html',\r\n  styleUrls: ['./web-api-actions.component.scss'],\r\n})\r\nexport class WebApiActionsComponent implements ICellRendererAngularComp {\r\n  enableCode: boolean;\r\n  private params: WebApiActionsParams;\r\n\r\n  agInit(params: WebApiActionsParams) {\r\n    this.params = params;\r\n    this.enableCode = this.params.enableCodeGetter();\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n\r\n  openCode() {\r\n    const api: WebApi = this.params.data;\r\n    this.params.onOpenCode(api);\r\n  }\r\n\r\n  openRestApi() {\r\n    const api: WebApi = this.params.data;\r\n    this.params.onOpenRestApi(api);\r\n  }\r\n}\r\n","<div class=\"icon-container\">\r\n  <div class=\"like-button icon\" tippy=\"WebApi is shared\" *ngIf=\"value\">\r\n    <mat-icon>share</mat-icon>\r\n  </div>\r\n</div>\r\n","import { ICellRendererParams } from '@ag-grid-community/all-modules';\r\nimport { ICellRendererAngularComp } from '@ag-grid-community/angular';\r\nimport { Component } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-web-api-type',\r\n  templateUrl: './web-api-type.component.html',\r\n  styleUrls: ['./web-api-type.component.scss'],\r\n})\r\nexport class WebApiTypeComponent implements ICellRendererAngularComp {\r\n  value: boolean;\r\n\r\n  agInit(params: ICellRendererParams) {\r\n    this.value = params.value;\r\n  }\r\n\r\n  refresh(params?: any): boolean {\r\n    return true;\r\n  }\r\n}\r\n","import { AllCommunityModules, GridOptions } from '@ag-grid-community/all-modules';\r\nimport { Component, Input, OnDestroy, OnInit, ViewContainerRef } from '@angular/core';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { BehaviorSubject } from 'rxjs';\r\nimport { SourceService } from '../../code-editor/services/source.service';\r\nimport { CreateFileDialogComponent, CreateFileDialogData, CreateFileDialogResult, FileLocationDialogComponent } from '../../create-file-dialog';\r\nimport { GoToDevRest } from '../../dev-rest/go-to-dev-rest';\r\nimport { BooleanFilterComponent } from '../../shared/components/boolean-filter/boolean-filter.component';\r\nimport { defaultGridOptions } from '../../shared/constants/default-grid-options.constants';\r\nimport { DialogService } from '../../shared/services/dialog.service';\r\nimport { WebApiActionsComponent } from '../ag-grid-components/web-api-actions/web-api-actions.component';\r\nimport { WebApiActionsParams } from '../ag-grid-components/web-api-actions/web-api-actions.models';\r\nimport { WebApiTypeComponent } from '../ag-grid-components/web-api-type/web-api-type.component';\r\nimport { WebApi } from '../models/web-api.model';\r\n\r\n@Component({\r\n  selector: 'app-web-api',\r\n  templateUrl: './web-api.component.html',\r\n  styleUrls: ['./web-api.component.scss'],\r\n})\r\nexport class WebApiComponent implements OnInit, OnDestroy {\r\n  @Input() enableCode: boolean;\r\n\r\n  webApis$ = new BehaviorSubject<WebApi[]>(null);\r\n  modules = AllCommunityModules;\r\n  gridOptions: GridOptions = {\r\n    ...defaultGridOptions,\r\n    frameworkComponents: {\r\n      webApiActions: WebApiActionsComponent,\r\n      booleanFilterComponent: BooleanFilterComponent,\r\n      webApiTypeComponent: WebApiTypeComponent,\r\n    },\r\n    columnDefs: [\r\n      {\r\n        field: 'Folder', flex: 2, minWidth: 250, cellClass: 'no-outline',\r\n        sortable: true, sort: 'asc', filter: 'agTextColumnFilter',\r\n        valueGetter: (params) => (params.data as WebApi).folder,\r\n      },\r\n      {\r\n        field: 'Name', flex: 2, minWidth: 250, cellClass: 'no-outline',\r\n        sortable: true, filter: 'agTextColumnFilter',\r\n        valueGetter: (params) => (params.data as WebApi).name,\r\n      },\r\n      {\r\n        field: 'Type', flex: 1, minWidth: 250, cellClass: 'no-outline',\r\n        sortable: true, filter: 'booleanFilterComponent', cellRenderer: 'webApiTypeComponent',\r\n        valueGetter: (params) => (params.data as WebApi).isShared,\r\n      },\r\n      {\r\n        width: 82, cellClass: 'secondary-action no-padding', cellRenderer: 'webApiActions', pinned: 'right',\r\n        cellRendererParams: {\r\n          enableCodeGetter: () => this.enableCodeGetter(),\r\n          onOpenCode: (api) => this.openCode(api),\r\n          onOpenRestApi: (api) => this.openRestApi(api),\r\n        } as WebApiActionsParams,\r\n      },\r\n    ],\r\n  };\r\n\r\n  constructor(\r\n    private sourceService: SourceService,\r\n    private snackBar: MatSnackBar,\r\n    private dialogService: DialogService,\r\n    private router: Router,\r\n    private route: ActivatedRoute,\r\n    private dialog: MatDialog,\r\n    private viewContainerRef: ViewContainerRef,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.fetchWebApis();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.webApis$.complete();\r\n  }\r\n\r\n  createController(global?: boolean): void {\r\n    if (global == null) {\r\n      const fileLocationDialogRef = this.dialog.open(FileLocationDialogComponent, {\r\n        autoFocus: false,\r\n        viewContainerRef: this.viewContainerRef,\r\n        width: '650px',\r\n      });\r\n      fileLocationDialogRef.afterClosed().subscribe((isShared?: boolean) => {\r\n        if (isShared == null) { return; }\r\n        this.createController(isShared);\r\n      });\r\n      return;\r\n    }\r\n\r\n    const createFileDialogData: CreateFileDialogData = {\r\n      folder: 'api',\r\n      global,\r\n      purpose: 'Api',\r\n    };\r\n    const createFileDialogRef = this.dialog.open(CreateFileDialogComponent, {\r\n      autoFocus: false,\r\n      data: createFileDialogData,\r\n      viewContainerRef: this.viewContainerRef,\r\n      width: '650px',\r\n    });\r\n\r\n    createFileDialogRef.afterClosed().subscribe((result?: CreateFileDialogResult) => {\r\n      if (!result) { return; }\r\n\r\n      if (result.name.endsWith('Controller.cs')) {\r\n        const fileName = result.name.substring(result.name.lastIndexOf('/') + 1);\r\n        if (!/^[A-Z][a-zA-Z0-9]*Controller\\.cs$/g.test(fileName)) {\r\n          const message = `\"${fileName}\" is invalid controller name. Should be something like \"MyController.cs\"`;\r\n          this.snackBar.open(message, null, { duration: 5000 });\r\n          return;\r\n        }\r\n      }\r\n\r\n      this.snackBar.open('Saving...');\r\n      this.sourceService.create(result.name, global, result.templateKey).subscribe(() => {\r\n        this.snackBar.open('Saved', null, { duration: 2000 });\r\n        this.fetchWebApis();\r\n      });\r\n    });\r\n  }\r\n\r\n  private fetchWebApis() {\r\n    this.sourceService.getWebApis().subscribe(webApis => {\r\n      this.webApis$.next(webApis);\r\n    });\r\n  }\r\n\r\n  private enableCodeGetter() {\r\n    return this.enableCode;\r\n  }\r\n\r\n  private openCode(api: WebApi) {\r\n    this.dialogService.openCodeFile(api.path, api.isShared);\r\n  }\r\n\r\n  private openRestApi(api: WebApi) {\r\n    this.router.navigate([GoToDevRest.getUrlWebApi(api)], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n}\r\n","<div class=\"grid-wrapper mat-tab-grid-wrapper\">\r\n  <ag-grid-angular class=\"ag-theme-material\" [rowData]=\"webApis$ | async\" [modules]=\"modules\"\r\n    [gridOptions]=\"gridOptions\">\r\n  </ag-grid-angular>\r\n\r\n  <div class=\"grid-more-actions-box\"></div>\r\n\r\n  <button mat-fab mat-elevation-z24 class=\"grid-fab\" tippy=\"Create a new controller\" (click)=\"createController()\">\r\n    <mat-icon>add</mat-icon>\r\n  </button>\r\n</div>\r\n","import { View } from '../../models';\r\n\r\nexport const AnalyzeParts = {\r\n  Settings: 'Settings',\r\n  Resources: 'Resources',\r\n} as const;\r\nexport type AnalyzePart = typeof AnalyzeParts[keyof typeof AnalyzeParts];\r\n\r\nexport interface AnalyzeSettingsTemplateVars {\r\n  views: View[];\r\n  selectedView: string;\r\n  stack: SettingsStackItem[];\r\n}\r\n\r\nexport interface SettingsStackItem {\r\n  Path: string;\r\n  Priority: number;\r\n  Source: string;\r\n  TotalResults: number;\r\n  Type: string;\r\n  Value: string;\r\n  _value: string;\r\n}\r\n","<div class=\"alert alert-info scope-info\" *ngIf=\"isGlobal || isPrimary\">\r\n  <ng-container *ngIf=\"isGlobal\">\r\n    This is the Global App. Anything configured here will affect all Sites and Apps in this installation.\r\n  </ng-container>\r\n  <ng-container *ngIf=\"isPrimary\">\r\n    This is the Primary App of this Site. You can also configure sitewide settings and resources here.\r\n  </ng-container>\r\n  See <a href=\"http://r.2sxc.org/settings\" target=\"_blank\">docs</a>.\r\n</div>\r\n\r\n<div class=\"cards-box\">\r\n  <mat-card class=\"mat-elevation-z2\">\r\n    <mat-card-header>\r\n      <mat-card-title>Settings</mat-card-title>\r\n      <div class=\"mat-card-header-icon\">\r\n        <mat-icon>settings</mat-icon>\r\n      </div>\r\n    </mat-card-header>\r\n    <mat-card-content>\r\n      <p>\r\n        Settings are things like SQL-connection strings, default \"items-to-show\" numbers and similar.\r\n        If necessary, settings like a link to an RSS-Feed could be different in each language.\r\n        <a href=\"http://r.2sxc.org/settings\" target=\"_blank\">docs</a>\r\n      </p>\r\n\r\n      <table class=\"settings\">\r\n        <thead>\r\n          <tr>\r\n            <th></th>\r\n            <th>System Settings</th>\r\n            <th>Custom Settings</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <!-- Settings for Global App -->\r\n          <ng-container *ngIf=\"isGlobal\">\r\n            <tr>\r\n              <th>Global</th>\r\n              <td>\r\n                <button mat-button (click)=\"edit(eavConstants.contentTypes.systemSettings, SystemSettingsScopes.App)\"\r\n                  tippy=\"Edit global system settings\">\r\n                  <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"systemSettingsCount || null\">\r\n                    edit\r\n                  </mat-icon>\r\n                </button>\r\n              </td>\r\n              <td>\r\n                <button mat-button (click)=\"fixContentType(eavConstants.contentTypes.customSettings, 'edit')\"\r\n                  tippy=\"Edit custom global settings\">\r\n                  <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"customSettingsCount || null\">\r\n                    edit\r\n                  </mat-icon>\r\n                </button>\r\n                <button mat-button (click)=\"fixContentType(eavConstants.contentTypes.customSettings, 'config')\"\r\n                  tippy=\"Configure fields of the custom global settings\">\r\n                  <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"customSettingsFieldsCount || null\">\r\n                    dns\r\n                  </mat-icon>\r\n                </button>\r\n              </td>\r\n          </ng-container>\r\n          <!-- Settings for Primary App -->\r\n          <ng-container *ngIf=\"isPrimary\">\r\n            <tr>\r\n              <th>Site</th>\r\n              <td>\r\n                <button mat-button (click)=\"edit(eavConstants.contentTypes.systemSettings, SystemSettingsScopes.Site)\"\r\n                  tippy=\"Edit site system settings\">\r\n                  <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"systemSettingsCount || null\">\r\n                    edit\r\n                  </mat-icon>\r\n                </button>\r\n              </td>\r\n              <td>\r\n                <button mat-button (click)=\"fixContentType(eavConstants.contentTypes.customSettings, 'edit')\"\r\n                  tippy=\"Edit custom site settings\">\r\n                  <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"customSettingsCount || null\">\r\n                    edit\r\n                  </mat-icon>\r\n                </button>\r\n                <button mat-button (click)=\"fixContentType(eavConstants.contentTypes.customSettings, 'config')\"\r\n                  tippy=\"Configure fields of the custom site settings\">\r\n                  <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"customSettingsFieldsCount || null\">\r\n                    dns\r\n                  </mat-icon>\r\n                </button>\r\n              </td>\r\n            </tr>\r\n            <ng-container *ngTemplateOutlet=\"goToGlobal\"></ng-container>\r\n          </ng-container>\r\n          <!-- Settings for App and Content -->\r\n          <ng-container *ngIf=\"isApp\">\r\n            <tr>\r\n              <th>{{ dialogSettings.Context.App.Name }}</th>\r\n              <td>\r\n                <button mat-button (click)=\"edit(eavConstants.contentTypes.systemSettings, SystemSettingsScopes.App)\"\r\n                  tippy=\"Edit app system settings\">\r\n                  <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"systemSettingsCount || null\">\r\n                    edit\r\n                  </mat-icon>\r\n                </button>\r\n              </td>\r\n              <td>\r\n                <button mat-button (click)=\"edit(eavConstants.contentTypes.settings)\" tippy=\"Edit custom app settings\">\r\n                  <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"customSettingsCount || null\">\r\n                    edit\r\n                  </mat-icon>\r\n                </button>\r\n                <button mat-button (click)=\"config(eavConstants.contentTypes.settings)\"\r\n                  tippy=\"Configure fields of the custom app settings\">\r\n                  <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"customSettingsFieldsCount || null\">\r\n                    dns\r\n                  </mat-icon>\r\n                </button>\r\n              </td>\r\n            </tr>\r\n            <ng-container *ngTemplateOutlet=\"goToSite\"></ng-container>\r\n            <ng-container *ngTemplateOutlet=\"goToGlobal\"></ng-container>\r\n          </ng-container>\r\n        </tbody>\r\n      </table>\r\n    </mat-card-content>\r\n\r\n    <mat-card-actions>\r\n      <div class=\"actions-row\">\r\n        <button mat-button (click)=\"analyze(AnalyzeParts.Settings)\" tippy=\"See the result of combining all settings\">\r\n          <mat-icon>manage_search</mat-icon>\r\n          <span>Analyze Combined Settings</span>\r\n        </button>\r\n      </div>\r\n    </mat-card-actions>\r\n  </mat-card>\r\n\r\n  <mat-card class=\"mat-elevation-z2\">\r\n    <mat-card-header>\r\n      <mat-card-title>Language Resources (i18n)</mat-card-title>\r\n      <div class=\"mat-card-header-icon\">\r\n        <mat-icon>translate</mat-icon>\r\n      </div>\r\n    </mat-card-header>\r\n    <mat-card-content>\r\n      <p>\r\n        Resources are used for labels and things like that in the App.\r\n        They are usually needed to create multi-lingual views and such, and should not be used for App-Settings.\r\n        <a href=\"http://r.2sxc.org/settings\" target=\"_blank\">docs</a>\r\n      </p>\r\n\r\n      <table class=\"settings\">\r\n        <thead>\r\n          <tr>\r\n            <th></th>\r\n            <th>System Resources</th>\r\n            <th>Custom Resources</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <!-- Resources for Global App -->\r\n          <ng-container *ngIf=\"isGlobal\">\r\n            <tr>\r\n              <th>Global</th>\r\n              <td>\r\n                <button mat-button (click)=\"edit(eavConstants.contentTypes.systemResources, SystemSettingsScopes.App)\"\r\n                  tippy=\"Edit global system resources\">\r\n                  <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"systemResourcesCount || null\">\r\n                    edit\r\n                  </mat-icon>\r\n                </button>\r\n              </td>\r\n              <td>\r\n                <button mat-button (click)=\"fixContentType(eavConstants.contentTypes.customResources, 'edit')\"\r\n                  tippy=\"Edit custom global resources\">\r\n                  <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"customResourcesCount || null\">\r\n                    edit\r\n                  </mat-icon>\r\n                </button>\r\n                <button mat-button (click)=\"fixContentType(eavConstants.contentTypes.customResources, 'config')\"\r\n                  tippy=\"Configure fields of the custom global resources\">\r\n                  <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"customResourcesFieldsCount || null\">\r\n                    dns\r\n                  </mat-icon>\r\n                </button>\r\n              </td>\r\n            </tr>\r\n          </ng-container>\r\n          <!-- Resources for Primary App -->\r\n          <ng-container *ngIf=\"isPrimary\">\r\n            <tr>\r\n              <th>Site</th>\r\n              <td>\r\n                <button mat-button (click)=\"edit(eavConstants.contentTypes.systemResources, SystemSettingsScopes.Site)\"\r\n                  tippy=\"Edit site system resources\">\r\n                  <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"systemResourcesCount || null\">\r\n                    edit\r\n                  </mat-icon>\r\n                </button>\r\n              </td>\r\n              <td>\r\n                <button mat-button (click)=\"fixContentType(eavConstants.contentTypes.customResources, 'edit')\"\r\n                  tippy=\"Edit custom site resources\">\r\n                  <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"customResourcesCount || null\">\r\n                    edit\r\n                  </mat-icon>\r\n                </button>\r\n                <button mat-button (click)=\"fixContentType(eavConstants.contentTypes.customResources, 'config')\"\r\n                  tippy=\"Configure fields of the custom site resources\">\r\n                  <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"customResourcesFieldsCount || null\">\r\n                    dns\r\n                  </mat-icon>\r\n                </button>\r\n              </td>\r\n            </tr>\r\n            <ng-container *ngTemplateOutlet=\"goToGlobal\"></ng-container>\r\n          </ng-container>\r\n          <!-- Resources for App and Content -->\r\n          <ng-container *ngIf=\"isApp\">\r\n            <tr>\r\n              <th>{{ dialogSettings.Context.App.Name }}</th>\r\n              <td>\r\n                <button mat-button (click)=\"edit(eavConstants.contentTypes.systemResources, SystemSettingsScopes.App)\"\r\n                  tippy=\"Edit app system resources\">\r\n                  <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"systemResourcesCount || null\">\r\n                    edit\r\n                  </mat-icon>\r\n                </button>\r\n              </td>\r\n              <td>\r\n                <button mat-button (click)=\"edit(eavConstants.contentTypes.resources)\"\r\n                  tippy=\"Edit custom app resources\">\r\n                  <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"customResourcesCount || null\">\r\n                    edit\r\n                  </mat-icon>\r\n                </button>\r\n                <button mat-button (click)=\"config(eavConstants.contentTypes.resources)\"\r\n                  tippy=\"Configure fields of the custom app resources\">\r\n                  <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"customResourcesFieldsCount || null\">\r\n                    dns\r\n                  </mat-icon>\r\n                </button>\r\n              </td>\r\n            </tr>\r\n            <ng-container *ngTemplateOutlet=\"goToSite\"></ng-container>\r\n            <ng-container *ngTemplateOutlet=\"goToGlobal\"></ng-container>\r\n          </ng-container>\r\n        </tbody>\r\n      </table>\r\n    </mat-card-content>\r\n    <mat-card-actions>\r\n      <div class=\"actions-row\">\r\n        <button mat-button (click)=\"analyze(AnalyzeParts.Resources)\" tippy=\"See the result of combining all resources\">\r\n          <mat-icon>manage_search</mat-icon>\r\n          <span>Analyze Combined Resources</span>\r\n        </button>\r\n      </div>\r\n    </mat-card-actions>\r\n  </mat-card>\r\n\r\n  <!-- Templates which are re-used in the table above -->\r\n  <ng-template #goToGlobal>\r\n    <tr>\r\n      <th>Global</th>\r\n      <td>\r\n        <button mat-button (click)=\"openGlobalSettings()\" tippy=\"Go to global\">\r\n          <mat-icon>open_in_new</mat-icon>\r\n        </button>\r\n      </td>\r\n    </tr>\r\n  </ng-template>\r\n\r\n  <ng-template #goToSite>\r\n    <tr>\r\n      <th>Site</th>\r\n      <td>\r\n        <button mat-button (click)=\"openSiteSettings()\" tippy=\"Go to site\">\r\n          <mat-icon>open_in_new</mat-icon>\r\n        </button>\r\n      </td>\r\n    </tr>\r\n  </ng-template>\r\n\r\n</div>\r\n\r\n<div class=\"cards-box\">\r\n  <mat-card class=\"mat-elevation-z2\">\r\n    <mat-card-header>\r\n      <mat-card-title>App Configuration</mat-card-title>\r\n      <div class=\"mat-card-header-icon\">\r\n        <mat-icon>redeem</mat-icon>\r\n      </div>\r\n    </mat-card-header>\r\n    <mat-card-content>\r\n      App name, folder, version and more.\r\n    </mat-card-content>\r\n    <mat-card-actions>\r\n      <button mat-button (click)=\"edit(eavConstants.contentTypes.appConfiguration)\">\r\n        <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"appConfigurationsCount || null\">\r\n          edit\r\n        </mat-icon>\r\n        <span>Edit Configuration</span>\r\n      </button>\r\n      <button mat-button (click)=\"openMetadata()\">\r\n        <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\" [matBadge]=\"appMetadataCount || null\">\r\n          local_offer\r\n        </mat-icon>\r\n        <span>Metadata</span>\r\n      </button>\r\n    </mat-card-actions>\r\n  </mat-card>\r\n\r\n  <mat-card class=\"mat-elevation-z2\">\r\n    <mat-card-header>\r\n      <mat-card-title>App Permissions</mat-card-title>\r\n      <div class=\"mat-card-header-icon\">\r\n        <mat-icon>person</mat-icon>\r\n      </div>\r\n    </mat-card-header>\r\n    <mat-card-content>\r\n      Give access to the entire app (all data). Use with care.\r\n    </mat-card-content>\r\n    <mat-card-actions>\r\n      <button mat-button [disabled]=\"!dialogSettings.Context.Enable.AppPermissions\" (click)=\"openPermissions()\">\r\n        <mat-icon matBadgeColor=\"accent\" matBadgeSize=\"small\"\r\n          [matBadge]=\"dialogSettings.Context.App.Permissions.Count || null\">\r\n          person\r\n        </mat-icon>\r\n        <span>\r\n          Edit Permissions\r\n          <ng-container *ngIf=\"!dialogSettings.Context.Enable.AppPermissions\">\r\n            <ng-container *ngIf=\"isGlobal\">\r\n              (not available on Global App)\r\n            </ng-container>\r\n            <ng-container *ngIf=\"isApp\">\r\n              (not available on Content App)\r\n            </ng-container>\r\n          </ng-container>\r\n        </span>\r\n      </button>\r\n      <button mat-button *ngIf=\"debugEnabled$ | async\" (click)=\"openLanguagePermissions()\">\r\n        <mat-icon>person</mat-icon>\r\n        <span>Language Permissions</span>\r\n      </button>\r\n    </mat-card-actions>\r\n  </mat-card>\r\n</div>\r\n\r\n<div class=\"cards-box\">\r\n  <mat-card class=\"mat-elevation-z2\">\r\n    <mat-card-header>\r\n      <mat-card-title>Export this entire App</mat-card-title>\r\n      <div class=\"mat-card-header-icon\">\r\n        <mat-icon>cloud_download</mat-icon>\r\n      </div>\r\n    </mat-card-header>\r\n    <mat-card-content>\r\n      Create an package (zip) which can be installed in another site.\r\n    </mat-card-content>\r\n    <mat-card-actions>\r\n      <button mat-button (click)=\"exportApp()\">\r\n        <mat-icon>cloud_download</mat-icon>\r\n        <span>Export App</span>\r\n      </button>\r\n    </mat-card-actions>\r\n  </mat-card>\r\n\r\n  <mat-card class=\"mat-elevation-z2\">\r\n    <mat-card-header>\r\n      <mat-card-title>Export or Import parts of this App</mat-card-title>\r\n      <div class=\"mat-card-header-icon\">\r\n        <mat-icon>import_export</mat-icon>\r\n      </div>\r\n    </mat-card-header>\r\n    <mat-card-content>\r\n      Create an xml containing parts of the app, e.g. content and templates.\r\n      Import parts from such an xml into this app.\r\n    </mat-card-content>\r\n    <mat-card-actions>\r\n      <button mat-button (click)=\"exportParts()\">\r\n        <mat-icon>cloud_download</mat-icon>\r\n        <span>Export Parts</span>\r\n      </button>\r\n      <button mat-button (click)=\"importParts()\">\r\n        <mat-icon>cloud_upload</mat-icon>\r\n        <span>Import Parts</span>\r\n      </button>\r\n    </mat-card-actions>\r\n  </mat-card>\r\n</div>\r\n\r\n<div class=\"cards-box\">\r\n  <mat-card class=\"mat-elevation-z2\">\r\n    <mat-card-header>\r\n      <mat-card-title>App-State Versioning</mat-card-title>\r\n      <div class=\"mat-card-header-icon\">\r\n        <mat-icon>history_toggle_off</mat-icon>\r\n      </div>\r\n    </mat-card-header>\r\n    <mat-card-content>\r\n      You can save / restore the app with data and configuration in <code>.data/app.xml</code>.\r\n      This file can then also be versioned using git.\r\n    </mat-card-content>\r\n    <mat-card-actions>\r\n      <button mat-button (click)=\"exportAppXml()\">\r\n        <mat-icon>more_time</mat-icon>\r\n        <span>Save state</span>\r\n      </button>\r\n      <button mat-button (click)=\"resetApp()\">\r\n        <mat-icon>restore</mat-icon>\r\n        <span>Restore state</span>\r\n      </button>\r\n    </mat-card-actions>\r\n  </mat-card>\r\n</div>\r\n","import { HttpErrorResponse } from '@angular/common/http';\r\nimport { ChangeDetectorRef, Component, Input, OnChanges, OnDestroy, OnInit, SimpleChanges } from '@angular/core';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { ActivatedRoute, NavigationEnd, Router } from '@angular/router';\r\nimport { forkJoin, of, Subscription } from 'rxjs';\r\nimport { filter, map, pairwise, startWith } from 'rxjs/operators';\r\nimport { GlobalConfigService } from '../../../../../edit/shared/store/ngrx-data';\r\nimport { ContentItemsService } from '../../content-items/services/content-items.service';\r\nimport { ContentTypesFieldsService } from '../../content-type-fields/services/content-types-fields.service';\r\nimport { GoToMetadata } from '../../metadata';\r\nimport { MetadataService } from '../../permissions';\r\nimport { GoToPermissions } from '../../permissions/go-to-permissions';\r\nimport { eavConstants, SystemSettingsScope, SystemSettingsScopes } from '../../shared/constants/eav.constants';\r\nimport { convertFormToUrl } from '../../shared/helpers/url-prep.helper';\r\nimport { AppScopes } from '../../shared/models/dialog-context.models';\r\nimport { EditForm } from '../../shared/models/edit-form.model';\r\nimport { Context } from '../../shared/services/context';\r\nimport { DialogService } from '../../shared/services/dialog.service';\r\nimport { ContentTypeEdit } from '../models';\r\nimport { DialogSettings } from '../models/dialog-settings.model';\r\nimport { ContentTypesService } from '../services';\r\nimport { ExportAppService } from '../services/export-app.service';\r\nimport { ImportAppPartsService } from '../services/import-app-parts.service';\r\nimport { AnalyzePart, AnalyzeParts } from '../sub-dialogs/analyze-settings/analyze-settings.models';\r\n\r\n@Component({\r\n  selector: 'app-app-configuration',\r\n  templateUrl: './app-configuration.component.html',\r\n  styleUrls: ['./app-configuration.component.scss'],\r\n})\r\nexport class AppConfigurationComponent implements OnInit, OnChanges, OnDestroy {\r\n  @Input() dialogSettings: DialogSettings;\r\n\r\n  eavConstants = eavConstants;\r\n  AnalyzeParts = AnalyzeParts;\r\n  SystemSettingsScopes = SystemSettingsScopes;\r\n  AppScopes = AppScopes;\r\n  isGlobal: boolean;\r\n  isPrimary: boolean;\r\n  isApp: boolean;\r\n  systemSettingsCount: number;\r\n  customSettingsCount: number;\r\n  customSettingsFieldsCount: number;\r\n  systemResourcesCount: number;\r\n  customResourcesCount: number;\r\n  customResourcesFieldsCount: number;\r\n  appConfigurationsCount: number;\r\n  appMetadataCount: number;\r\n  debugEnabled$ = this.globalConfigService.getDebugEnabled$();\r\n\r\n  private subscription: Subscription;\r\n\r\n  constructor(\r\n    private contentItemsService: ContentItemsService,\r\n    private router: Router,\r\n    private route: ActivatedRoute,\r\n    private context: Context,\r\n    private exportAppService: ExportAppService,\r\n    private importAppPartsService: ImportAppPartsService,\r\n    private snackBar: MatSnackBar,\r\n    private dialogService: DialogService,\r\n    private changeDetectorRef: ChangeDetectorRef,\r\n    private contentTypesFieldsService: ContentTypesFieldsService,\r\n    private metadataService: MetadataService,\r\n    private contentTypesService: ContentTypesService,\r\n    private globalConfigService: GlobalConfigService,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.subscription = new Subscription();\r\n    this.fetchSettings();\r\n    this.refreshOnChildClosed();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (changes.dialogSettings != null) {\r\n      this.isGlobal = this.dialogSettings.Context.App.SettingsScope === AppScopes.Global;\r\n      this.isPrimary = this.dialogSettings.Context.App.SettingsScope === AppScopes.Site;\r\n      this.isApp = this.dialogSettings.Context.App.SettingsScope === AppScopes.App;\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.snackBar.dismiss();\r\n    this.subscription.unsubscribe();\r\n  }\r\n\r\n  edit(staticName: string, systemSettingsScope?: SystemSettingsScope) {\r\n    this.contentItemsService.getAll(staticName).subscribe(contentItems => {\r\n      let form: EditForm;\r\n\r\n      switch (staticName) {\r\n        case eavConstants.contentTypes.systemSettings:\r\n        case eavConstants.contentTypes.systemResources:\r\n          const systemSettingsEntities = contentItems.filter(i => systemSettingsScope === SystemSettingsScopes.App\r\n            ? !i.SettingsEntityScope\r\n            : i.SettingsEntityScope === SystemSettingsScopes.Site);\r\n          if (systemSettingsEntities.length > 1) {\r\n            throw new Error(`Found too many settings for type ${staticName}`);\r\n          }\r\n          const systemSettingsEntity = systemSettingsEntities[0];\r\n          form = {\r\n            items: [\r\n              systemSettingsEntity == null\r\n                ? {\r\n                  ContentTypeName: staticName,\r\n                  Prefill: {\r\n                    ...(systemSettingsScope === SystemSettingsScopes.Site && { SettingsEntityScope: SystemSettingsScopes.Site }),\r\n                  }\r\n                }\r\n                : { EntityId: systemSettingsEntity.Id }\r\n            ],\r\n          };\r\n          break;\r\n        case eavConstants.contentTypes.customSettings:\r\n        case eavConstants.contentTypes.customResources:\r\n          if (contentItems.length > 1) {\r\n            throw new Error(`Found too many settings for type ${staticName}`);\r\n          }\r\n          const customSettingsEntity = contentItems[0];\r\n          form = {\r\n            items: [\r\n              customSettingsEntity == null\r\n                ? { ContentTypeName: staticName }\r\n                : { EntityId: customSettingsEntity.Id }\r\n            ],\r\n          };\r\n          break;\r\n        default:\r\n          if (contentItems.length < 1) {\r\n            throw new Error(`Found no settings for type ${staticName}`);\r\n          }\r\n          if (contentItems.length > 1) {\r\n            throw new Error(`Found too many settings for type ${staticName}`);\r\n          }\r\n          form = {\r\n            items: [{ EntityId: contentItems[0].Id }],\r\n          };\r\n      }\r\n\r\n      const formUrl = convertFormToUrl(form);\r\n      this.router.navigate([`edit/${formUrl}`], { relativeTo: this.route.firstChild });\r\n    });\r\n  }\r\n\r\n  openMetadata() {\r\n    const url = GoToMetadata.getUrlApp(\r\n      this.context.appId,\r\n      `Metadata for App: ${this.dialogSettings.Context.App.Name} (${this.context.appId})`,\r\n    );\r\n    this.router.navigate([url], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  openSiteSettings() {\r\n    const sitePrimaryApp = this.dialogSettings.Context.Site.PrimaryApp;\r\n    this.dialogService.openAppAdministration(sitePrimaryApp.ZoneId, sitePrimaryApp.AppId, 'app');\r\n  }\r\n\r\n  openGlobalSettings() {\r\n    const globalPrimaryApp = this.dialogSettings.Context.System.PrimaryApp;\r\n    this.dialogService.openAppAdministration(globalPrimaryApp.ZoneId, globalPrimaryApp.AppId, 'app');\r\n  }\r\n\r\n  config(staticName: string) {\r\n    this.router.navigate([`fields/${staticName}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  openPermissions() {\r\n    this.router.navigate([GoToPermissions.getUrlApp(this.context.appId)], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  openLanguagePermissions() {\r\n    this.router.navigate(['language-permissions'], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  exportApp() {\r\n    this.router.navigate([`export`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  exportParts() {\r\n    this.router.navigate([`export/parts`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  importParts() {\r\n    this.router.navigate([`import/parts`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  exportAppXml() {\r\n    this.snackBar.open('Exporting...');\r\n    this.exportAppService.exportForVersionControl(true, false).subscribe({\r\n      next: result => {\r\n        this.snackBar.open('Export done. Please check your \\'.data\\' folder', null, { duration: 3000 });\r\n      },\r\n      error: (error: HttpErrorResponse) => {\r\n        this.snackBar.open('Export failed. Please check console for more information', null, { duration: 3000 });\r\n      },\r\n    });\r\n  }\r\n\r\n  resetApp() {\r\n    if (!confirm('Are you sure? All changes since last xml export will be lost')) { return; }\r\n    this.snackBar.open('Resetting...');\r\n    this.importAppPartsService.resetApp().subscribe({\r\n      next: result => {\r\n        this.snackBar.open(\r\n          'Reset worked! Since this is a complex operation, please restart the Website to ensure all caches are correct',\r\n          null,\r\n          { duration: 30000 },\r\n        );\r\n      },\r\n      error: (error: HttpErrorResponse) => {\r\n        this.snackBar.open('Reset failed. Please check console for more information', null, { duration: 3000 });\r\n      },\r\n    });\r\n  }\r\n\r\n  analyze(part: AnalyzePart) {\r\n    this.router.navigate([`analyze/${part}`], { relativeTo: this.route.firstChild });\r\n  }\r\n\r\n  private fetchSettings() {\r\n    this.contentTypesService.retrieveContentTypes(eavConstants.scopes.configuration.value).subscribe(contentTypes => {\r\n      const settingsCustomExists = contentTypes.some(ct => ct.Name === eavConstants.contentTypes.customSettings);\r\n      const resourcesCustomExists = contentTypes.some(ct => ct.Name === eavConstants.contentTypes.customResources);\r\n\r\n      forkJoin([\r\n        forkJoin([\r\n          this.contentItemsService.getAll(eavConstants.contentTypes.systemSettings),\r\n          this.isGlobal || this.isPrimary\r\n            ? settingsCustomExists\r\n              ? this.contentItemsService.getAll(eavConstants.contentTypes.customSettings) : of(undefined)\r\n            : this.contentItemsService.getAll(eavConstants.contentTypes.settings),\r\n          this.isGlobal || this.isPrimary\r\n            ? settingsCustomExists\r\n              ? this.contentTypesFieldsService.getFields(eavConstants.contentTypes.customSettings) : of(undefined)\r\n            : this.contentTypesFieldsService.getFields(eavConstants.contentTypes.settings),\r\n        ]),\r\n        forkJoin([\r\n          this.contentItemsService.getAll(eavConstants.contentTypes.systemResources),\r\n          this.isGlobal || this.isPrimary\r\n            ? resourcesCustomExists\r\n              ? this.contentItemsService.getAll(eavConstants.contentTypes.customResources) : of(undefined)\r\n            : this.contentItemsService.getAll(eavConstants.contentTypes.resources),\r\n          this.isGlobal || this.isPrimary\r\n            ? resourcesCustomExists\r\n              ? this.contentTypesFieldsService.getFields(eavConstants.contentTypes.customResources) : of(undefined)\r\n            : this.contentTypesFieldsService.getFields(eavConstants.contentTypes.resources),\r\n        ]),\r\n        forkJoin([\r\n          this.contentItemsService.getAll(eavConstants.contentTypes.appConfiguration),\r\n          this.metadataService.getMetadata(eavConstants.metadata.app.targetType, eavConstants.metadata.app.keyType, this.context.appId),\r\n        ]),\r\n      ]).subscribe(([\r\n        [\r\n          systemSettingsItems,\r\n          customSettingsItems,\r\n          customSettingsFields,\r\n        ],\r\n        [\r\n          systemResourcesItems,\r\n          customResourcesItems,\r\n          customResourcesFields,\r\n        ],\r\n        [\r\n          appConfigurations,\r\n          appMetadata,\r\n        ],\r\n      ]) => {\r\n        this.systemSettingsCount = this.isPrimary\r\n          ? systemSettingsItems.filter(i => i.SettingsEntityScope === SystemSettingsScopes.Site).length\r\n          : systemSettingsItems.filter(i => !i.SettingsEntityScope).length;\r\n        this.customSettingsCount = customSettingsItems?.length;\r\n        this.customSettingsFieldsCount = customSettingsFields?.length;\r\n        this.systemResourcesCount = this.isPrimary\r\n          ? systemResourcesItems.filter(i => i.SettingsEntityScope === SystemSettingsScopes.Site).length\r\n          : systemResourcesItems.filter(i => !i.SettingsEntityScope).length;\r\n        this.customResourcesCount = customResourcesItems?.length;\r\n        this.customResourcesFieldsCount = customResourcesFields?.length;\r\n        this.appConfigurationsCount = appConfigurations.length;\r\n        this.appMetadataCount = appMetadata.Items.length;\r\n\r\n        this.changeDetectorRef.markForCheck();\r\n      });\r\n    });\r\n  }\r\n\r\n  private refreshOnChildClosed() {\r\n    this.subscription.add(\r\n      this.router.events.pipe(\r\n        filter(event => event instanceof NavigationEnd),\r\n        startWith(!!this.route.snapshot.firstChild.firstChild),\r\n        map(() => !!this.route.snapshot.firstChild.firstChild),\r\n        pairwise(),\r\n        filter(([hadChild, hasChild]) => hadChild && !hasChild),\r\n      ).subscribe(() => {\r\n        this.fetchSettings();\r\n      })\r\n    );\r\n  }\r\n\r\n  fixContentType(staticName: string, action: 'edit' | 'config') {\r\n    this.contentTypesService.retrieveContentTypes(eavConstants.scopes.configuration.value).subscribe(contentTypes => {\r\n      const contentTypeExists = contentTypes.some(ct => ct.Name === staticName);\r\n      if (contentTypeExists) {\r\n        if (action === 'edit') {\r\n          this.edit(staticName);\r\n        } else if (action === 'config') {\r\n          this.config(staticName);\r\n        }\r\n      } else {\r\n        const newContentType = {\r\n          StaticName: '',\r\n          Name: staticName,\r\n          Description: '',\r\n          Scope: eavConstants.scopes.configuration.value,\r\n          ChangeStaticName: false,\r\n          NewStaticName: '',\r\n        } as ContentTypeEdit;\r\n        this.contentTypesService.save(newContentType).subscribe(success => {\r\n          if (!success) { return; }\r\n\r\n          if (action === 'edit') {\r\n            this.edit(staticName);\r\n          } else if (action === 'config') {\r\n            this.config(staticName);\r\n          }\r\n        });\r\n      }\r\n    });\r\n  }\r\n}\r\n","<div class=\"nav-component-wrapper\" appToggleDebug *ngIf=\"(templateVars$ | async) as data\">\r\n  <div mat-dialog-title>\r\n    <div class=\"dialog-title-box\">\r\n      <div>\r\n        <ng-container *ngIf=\"data.dialogSettings?.Context.App.SettingsScope === AppScopes.Global\">\r\n          Global\r\n        </ng-container>\r\n        <ng-container *ngIf=\"data.dialogSettings?.Context.App.SettingsScope !== AppScopes.Global\">\r\n          {{ data.dialogSettings?.Context.App.Name }}\r\n        </ng-container>\r\n        Admin\r\n      </div>\r\n      <button mat-icon-button tippy=\"Close dialog\" (click)=\"closeDialog()\">\r\n        <mat-icon>close</mat-icon>\r\n      </button>\r\n    </div>\r\n  </div>\r\n\r\n  <router-outlet></router-outlet>\r\n\r\n  <!-- spm NOTE: we use mat-tab-group because mat-tab-nav-bar doesn't have animations and doesn't look pretty -->\r\n  <mat-tab-group class=\"mat-tab-group-max-height\" dynamicHeight color=\"accent\"\r\n    *ngIf=\"data.dialogSettings && data.tabIndex != null\" (selectedTabChange)=\"changeTab($event)\"\r\n    [selectedIndex]=\"data.tabIndex\">\r\n    <mat-tab>\r\n      <div *matTabLabel class=\"mat-tab-label-box\" tippy=\"App Info\">\r\n        <mat-icon>info</mat-icon>\r\n        <span>Info</span>\r\n      </div>\r\n      <app-getting-started *matTabContent [gettingStartedUrl]=\"data.dialogSettings.Context.App.GettingStartedUrl\">\r\n      </app-getting-started>\r\n    </mat-tab>\r\n\r\n    <mat-tab>\r\n      <div *matTabLabel class=\"mat-tab-label-box\" tippy=\"Data / Content\">\r\n        <mat-icon>menu</mat-icon>\r\n        <span>Data</span>\r\n      </div>\r\n      <app-data *matTabContent [enablePermissions]=\"data.dialogSettings.Context.Enable.AppPermissions\"></app-data>\r\n    </mat-tab>\r\n\r\n    <mat-tab *ngIf=\"data.dialogSettings.Context.Enable.Query\">\r\n      <div *matTabLabel class=\"mat-tab-label-box\" tippy=\"Queries / Visual Query Designer\">\r\n        <mat-icon>filter_list</mat-icon>\r\n        <span>Queries</span>\r\n      </div>\r\n      <app-queries *matTabContent [enablePermissions]=\"data.dialogSettings.Context.Enable.AppPermissions\">\r\n      </app-queries>\r\n    </mat-tab>\r\n\r\n    <mat-tab>\r\n      <div *matTabLabel class=\"mat-tab-label-box\" tippy=\"Views / Templates\">\r\n        <mat-icon>layers</mat-icon>\r\n        <span>Views</span>\r\n      </div>\r\n      <app-views *matTabContent [enableCode]=\"data.dialogSettings.Context.Enable.CodeEditor\"\r\n        [enablePermissions]=\"data.dialogSettings.Context.Enable.AppPermissions\"\r\n        [appIsGlobal]=\"data.dialogSettings.Context.App.IsGlobal\"\r\n        [appIsInherited]=\"data.dialogSettings.Context.App.IsInherited\">\r\n      </app-views>\r\n    </mat-tab>\r\n\r\n    <mat-tab *ngIf=\"data.dialogSettings.Context.Enable.Query\">\r\n      <div *matTabLabel class=\"mat-tab-label-box\" tippy=\"WebApi\">\r\n        <mat-icon>offline_bolt</mat-icon>\r\n        <span>WebApi</span>\r\n      </div>\r\n      <app-web-api *matTabContent [enableCode]=\"data.dialogSettings.Context.Enable.CodeEditor\">\r\n      </app-web-api>\r\n    </mat-tab>\r\n\r\n    <mat-tab>\r\n      <div *matTabLabel class=\"mat-tab-label-box\" tippy=\"App Settings\">\r\n        <mat-icon>settings_applications</mat-icon>\r\n        <span>App</span>\r\n      </div>\r\n      <app-app-configuration *matTabContent [dialogSettings]=\"data.dialogSettings\">\r\n      </app-app-configuration>\r\n    </mat-tab>\r\n  </mat-tab-group>\r\n</div>\r\n","import { Component, OnDestroy, OnInit } from '@angular/core';\r\nimport { MatDialogRef } from '@angular/material/dialog';\r\nimport { MatTabChangeEvent } from '@angular/material/tabs';\r\nimport { ActivatedRoute, NavigationEnd, Router } from '@angular/router';\r\nimport { BehaviorSubject, combineLatest, Subscription } from 'rxjs';\r\nimport { filter, map, pairwise, startWith } from 'rxjs/operators';\r\nimport { eavConstants } from '../../shared/constants/eav.constants';\r\nimport { UpdateEnvVarsFromDialogSettings } from '../../shared/helpers/update-env-vars-from-dialog-settings.helper';\r\nimport { AppScopes } from '../../shared/models/dialog-context.models';\r\nimport { DialogSettings } from '../models/dialog-settings.model';\r\nimport { AppDialogConfigService } from '../services/app-dialog-config.service';\r\n\r\n@Component({\r\n  selector: 'app-app-administration-nav',\r\n  templateUrl: './app-administration-nav.component.html',\r\n  styleUrls: ['./app-administration-nav.component.scss'],\r\n})\r\nexport class AppAdministrationNavComponent implements OnInit, OnDestroy {\r\n  AppScopes = AppScopes;\r\n\r\n  private dialogSettings$ = new BehaviorSubject<DialogSettings>(null);\r\n  private tabs$ = new BehaviorSubject<string[]>(null);\r\n  private tabIndex$ = combineLatest([\r\n    this.tabs$,\r\n    this.router.events.pipe(\r\n      filter(event => event instanceof NavigationEnd),\r\n      map(() => this.route.snapshot.firstChild.url[0].path),\r\n      startWith(this.route.snapshot.firstChild.url[0].path),\r\n    )\r\n  ]).pipe(\r\n    map(([tabs, path]) => {\r\n      if (tabs == null) { return; }\r\n      const tabIndex = tabs.indexOf(path);\r\n      return tabIndex;\r\n    }),\r\n    filter(tabIndex => tabIndex >= 0),\r\n  );\r\n  templateVars$ = combineLatest([this.dialogSettings$, this.tabIndex$]).pipe(\r\n    map(([dialogSettings, tabIndex]) => ({ dialogSettings, tabIndex })),\r\n  );\r\n\r\n  private subscription = new Subscription();\r\n\r\n  constructor(\r\n    private dialogRef: MatDialogRef<AppAdministrationNavComponent>,\r\n    private appDialogConfigService: AppDialogConfigService,\r\n    private router: Router,\r\n    private route: ActivatedRoute,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.fetchDialogSettings();\r\n    this.refreshOnChildClosed();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.dialogSettings$.complete();\r\n    this.tabs$.complete();\r\n    this.subscription.unsubscribe();\r\n  }\r\n\r\n  closeDialog() {\r\n    this.dialogRef.close();\r\n  }\r\n\r\n  changeTab(event: MatTabChangeEvent) {\r\n    let path = this.tabs$.value[event.index];\r\n    if (path === 'data') {\r\n      path = `data/${eavConstants.scopes.default.value}`;\r\n    }\r\n    this.router.navigate([path], { relativeTo: this.route });\r\n  }\r\n\r\n  private fetchDialogSettings() {\r\n    this.appDialogConfigService.getDialogSettings().subscribe(dialogSettings => {\r\n      UpdateEnvVarsFromDialogSettings(dialogSettings.Context.App);\r\n      this.dialogSettings$.next(dialogSettings);\r\n\r\n      let tabs = ['home', 'data', 'queries', 'views', 'web-api', 'app']; // tabs order has to match template\r\n      if (!dialogSettings.Context.Enable.Query) {\r\n        tabs = tabs.filter(tab => tab !== 'queries' && tab !== 'web-api');\r\n      }\r\n      this.tabs$.next(tabs);\r\n    });\r\n  }\r\n\r\n  private refreshOnChildClosed() {\r\n    this.subscription.add(\r\n      this.router.events.pipe(\r\n        filter(event => event instanceof NavigationEnd),\r\n        startWith(!!this.route.snapshot.firstChild.firstChild),\r\n        map(() => !!this.route.snapshot.firstChild.firstChild),\r\n        pairwise(),\r\n        filter(([hadChild, hasChild]) => hadChild && !hasChild),\r\n      ).subscribe(() => {\r\n        this.fetchDialogSettings();\r\n      })\r\n    );\r\n  }\r\n}\r\n","/**\r\n * Do not reuse regex:\r\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/test#using_test_on_a_regex_with_the_global_flag\r\n */\r\nexport function guidRegex(): RegExp {\r\n  return /^[a-f0-9]{8}(?:-[a-f0-9]{4}){3}-[a-f0-9]{12}$/i;\r\n}\r\n","import { Directive, HostListener } from '@angular/core';\r\nimport { GlobalConfigService } from '../../../../../edit/shared/store/ngrx-data';\r\n\r\n@Directive({ selector: '[appToggleDebug]' })\r\nexport class ToggleDebugDirective {\r\n\r\n  constructor(private globalConfigService: GlobalConfigService) { }\r\n\r\n  @HostListener('click', ['$event'])\r\n  onClick(event: MouseEvent): void {\r\n    const CTRL_SHIFT_ALT_CLICK = (navigator.platform.match('Mac') ? event.metaKey : event.ctrlKey) && event.shiftKey && event.altKey;\r\n    if (CTRL_SHIFT_ALT_CLICK) {\r\n      this.globalConfigService.toggleDebugEnabled();\r\n      window.getSelection().removeAllRanges();\r\n    }\r\n  }\r\n}\r\n"],"sourceRoot":"webpack:///","file":"projects_ng-dialogs_src_app_app-administration_app-administration-nav_app-administration-nav_-8dd6e3.89b1c8edcf2c06ae.js"}