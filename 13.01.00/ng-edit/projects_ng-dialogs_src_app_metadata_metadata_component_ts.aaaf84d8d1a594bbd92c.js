(self.webpackChunkeav_ui=self.webpackChunkeav_ui||[]).push([["projects_ng-dialogs_src_app_metadata_metadata_component_ts","projects_ng-dialogs_src_app_shared_directives_click-stop-propagation_directive_ts","projects_ng-dialogs_src_app_app-administration_services_app-dialog-config_service_ts-_31ae0","projects_ng-dialogs_src_app_app-administration_services_app-dialog-config_service_ts-_31ae1"],{2887:function(t,n,e){"use strict";e.d(n,{K:function(){return p}});var o=e(1785),i=e(2693),r=e(3582),a=e(2837),p=function(){function t(t,n,e){this.http=t,this.context=n,this.dnnContext=e}return t.prototype.getDialogSettings=function(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/dialog/settings"),{params:{appId:null!=t?t:this.context.appId.toString()}})},t.\u0275fac=function(n){return new(n||t)(o.LFG(i.eN),o.LFG(r._),o.LFG(a._y))},t.\u0275prov=o.Yz7({token:t,factory:t.\u0275fac}),t}()},3466:function(t,n,e){"use strict";e.d(n,{T:function(){return s}});var o=e(3475),i=e(1785),r=e(2693),a=e(3582),p=e(2837),s=function(){function t(t,n,e){this.http=t,this.context=n,this.dnnContext=e}return t.prototype.getContentInfo=function(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(o.v+"Get"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),scope:t}})},t.prototype.exportParts=function(t,n,e){var i=this.dnnContext.$2sxc.http.apiUrl(o.v+"Export")+"?appId="+this.context.appId.toString()+"&zoneId="+this.context.zoneId.toString()+"&contentTypeIdsString="+t.join(";")+"&entityIdsString="+n.join(";")+"&templateIdsString="+e.join(";");window.open(i,"_blank","")},t.\u0275fac=function(n){return new(n||t)(i.LFG(r.eN),i.LFG(a._),i.LFG(p._y))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t}()},271:function(t,n,e){"use strict";e.d(n,{v:function(){return s}});var o=e(6466),i=e(1785),r=e(2693),a=e(3582),p=e(2837),s=function(){function t(t,n,e){this.http=t,this.context=n,this.dnnContext=e}return t.prototype.getAppInfo=function(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(o.H+"Statistics"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})},t.prototype.exportApp=function(t,n){var e=this.dnnContext.$2sxc.http.apiUrl(o.H+"Export")+"?appId="+this.context.appId+"&zoneId="+this.context.zoneId+"&includeContentGroups="+t+"&resetAppGuid="+n;window.open(e,"_blank","")},t.prototype.exportForVersionControl=function(t,n){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(o.H+"SaveData"),{params:{appid:this.context.appId.toString(),zoneId:this.context.zoneId.toString(),includeContentGroups:t.toString(),resetAppGuid:n.toString()}})},t.\u0275fac=function(n){return new(n||t)(i.LFG(r.eN),i.LFG(a._),i.LFG(p._y))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t}()},3475:function(t,n,e){"use strict";e.d(n,{v:function(){return s},z:function(){return c}});var o=e(6466),i=e(1785),r=e(2693),a=e(3582),p=e(2837),s="admin/appParts/",c=function(){function t(t,n,e){this.http=t,this.context=n,this.dnnContext=e}return t.prototype.importAppParts=function(t){var n=new FormData;return n.append("File",t),this.http.post(this.dnnContext.$2sxc.http.apiUrl(s+"Import"),n,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})},t.prototype.resetApp=function(){return this.http.post(this.dnnContext.$2sxc.http.apiUrl(o.H+"Reset"),{},{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})},t.\u0275fac=function(n){return new(n||t)(i.LFG(r.eN),i.LFG(a._),i.LFG(p._y))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t}()},5151:function(t,n,e){"use strict";e.d(n,{Kw:function(){return o.K},sF:function(){return i.s},vG:function(){return r.vG},bf:function(){return r.bf},Az:function(){return r.Az},TB:function(){return r.TB},cv:function(){return r.cv},nt:function(){return r.nt},h3:function(){return a.h}});var o=e(2887),i=e(2832),r=(e(3466),e(271),e(3475),e(2394)),a=e(1916);e(7915)},2394:function(t,n,e){"use strict";e.d(n,{cv:function(){return d},Az:function(){return l},nt:function(){return f},TB:function(){return h},bf:function(){return g},vG:function(){return m}});var o=e(9764),i=e(3982),r=e(1407),a=e(8442),p=e(1785),s=e(2693),c=e(3582),u=e(2837),d="admin/query/Run",l="admin/query/DebugStream",f="admin/query/Save",h="admin/query/Get",g="admin/query/DataSources",m=function(){function t(t,n,e){this.http=t,this.context=n,this.dnnContext=e}return t.prototype.getAll=function(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(r.PS),{params:{appId:this.context.appId.toString(),contentType:t}})},t.prototype.importQuery=function(t){var n=this;return(0,o.D)((0,a.s)(t)).pipe((0,i.zg)(function(t){return n.http.post(n.dnnContext.$2sxc.http.apiUrl("admin/query/import"),{AppId:n.context.appId.toString(),ContentBase64:t})}))},t.prototype.clonePipeline=function(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/query/Clone"),{params:{Id:t.toString(),appId:this.context.appId.toString()}})},t.prototype.delete=function(t){return this.http.delete(this.dnnContext.$2sxc.http.apiUrl("admin/query/Delete"),{params:{appId:this.context.appId.toString(),Id:t.toString()}})},t.\u0275fac=function(n){return new(n||t)(p.LFG(s.eN),p.LFG(c._),p.LFG(u._y))},t.\u0275prov=p.Yz7({token:t,factory:t.\u0275fac}),t}()},1916:function(t,n,e){"use strict";e.d(n,{h:function(){return p}});var o=e(1785),i=e(2693),r=e(3582),a=e(2837),p=function(){function t(t,n,e){this.http=t,this.context=n,this.dnnContext=e}return t.prototype.getAll=function(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/view/all"),{params:{appId:this.context.appId.toString()}})},t.prototype.delete=function(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/view/delete"),{params:{appId:this.context.appId.toString(),Id:t.toString()}})},t.prototype.import=function(t){var n=new FormData;return n.append("File",t),this.http.post(this.dnnContext.$2sxc.http.apiUrl("admin/view/import"),n,{params:{appId:this.context.appId.toString(),zoneId:this.context.zoneId.toString()}})},t.prototype.export=function(t){var n=this.dnnContext.$2sxc.http.apiUrl("admin/view/json")+"?appId="+this.context.appId+"&viewId="+t;window.open(n,"_blank","")},t.prototype.getPolymorphism=function(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/view/polymorphism"),{params:{appId:this.context.appId.toString()}})},t.prototype.getUsage=function(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl("admin/view/usage"),{params:{appId:this.context.appId.toString(),guid:t}})},t.\u0275fac=function(n){return new(n||t)(o.LFG(i.eN),o.LFG(r._),o.LFG(a._y))},t.\u0275prov=o.Yz7({token:t,factory:t.\u0275fac}),t}()},7915:function(t,n,e){"use strict";e.d(n,{n:function(){return c}});var o=e(9996),i=e(1407),r=e(1785),a=e(2693),p=e(3582),s=e(2837),c=function(){function t(t,n,e){this.http=t,this.context=n,this.dnnContext=e}return t.prototype.getAll=function(){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(i.nu),{params:{appId:this.context.appId.toString(),global:"false",path:"",mask:"*Controller.cs",withSubfolders:"true"}}).pipe((0,o.U)(function(t){return t.map(function(t){var n=t.lastIndexOf("/"),e=t.lastIndexOf("."),o=t.substring(0,n),i=t.substring(n+1,e);return{path:t,folder:o,name:i}})}))},t.prototype.create=function(t,n){return this.http.post(this.dnnContext.$2sxc.http.apiUrl(i.yE),{},{params:{appId:this.context.appId.toString(),global:"false",purpose:"auto",path:t,templateKey:n}})},t.prototype.details=function(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(i.BQ),{params:{path:t}})},t.\u0275fac=function(n){return new(n||t)(r.LFG(a.eN),r.LFG(p._),r.LFG(s._y))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t}()},5223:function(t,n,e){"use strict";e.d(n,{l:function(){return l}});var o=e(9764),i=e(3982),r=e(1407),a=e(7093),p=e(8442),s=e(1785),c=e(2693),u=e(3582),d=e(2837),l=function(){function t(t,n,e){this.http=t,this.context=n,this.dnnContext=e}return t.prototype.getAll=function(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(r.PS),{params:{appId:this.context.appId.toString(),contentType:t}})},t.prototype.getColumns=function(t){return this.http.get(this.dnnContext.$2sxc.http.apiUrl(a.jt),{params:{appId:this.context.appId.toString(),staticName:t}})},t.prototype.importItem=function(t){var n=this;return(0,o.D)((0,p.s)(t)).pipe((0,i.zg)(function(t){return n.http.post(n.dnnContext.$2sxc.http.apiUrl(r.Uo+"upload"),{AppId:n.context.appId.toString(),ContentBase64:t})}))},t.\u0275fac=function(n){return new(n||t)(s.LFG(c.eN),s.LFG(u._),s.LFG(d._y))},t.\u0275prov=s.Yz7({token:t,factory:t.\u0275fac}),t}()},6466:function(t,n,e){"use strict";e.d(n,{H:function(){return p},a:function(){return s}});var o=e(1785),i=e(2693),r=e(3582),a=e(2837),p="admin/app/",s=function(){function t(t,n,e){this.http=t,this.context=n,this.dnnContext=e}return t.prototype.importApp=function(t,n){var e=new FormData;return e.append("File",t),e.append("Name",n||""),this.http.post(this.dnnContext.$2sxc.http.apiUrl(p+"Import"),e,{params:{zoneId:this.context.zoneId.toString()}})},t.\u0275fac=function(n){return new(n||t)(o.LFG(i.eN),o.LFG(r._),o.LFG(a._y))},t.\u0275prov=o.Yz7({token:t,factory:t.\u0275fac}),t}()},3235:function(t,n,e){"use strict";e.r(n),e.d(n,{MetadataComponent:function(){return pt}});var o=e(4762),i=e(9206),r=e(1282),a=e(8512),p=e(7570),s=e(1305),c=e(9996),u=e(3835),d=e(6238),l=e(2855),f=e(6085),h=e(8579),g=e(5803),m=e(2420),x=e(1785),y=e(7064),v=e(7512),C=e(7307),I=function(){function t(){}return t.prototype.agInit=function(t){this.params=t},t.prototype.refresh=function(t){return!0},t.prototype.deleteMetadata=function(){this.params.onDelete(this.params.data)},t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-metadata-actions"]],decls:4,vars:0,consts:[[1,"actions-component"],["matRipple","","tippy","Delete",1,"like-button","highlight",3,"click"]],template:function(t,n){1&t&&(x.TgZ(0,"div",0),x.TgZ(1,"div",1),x.NdJ("click",function(){return n.deleteMetadata()}),x.TgZ(2,"mat-icon"),x._uU(3,"delete"),x.qZA(),x.qZA(),x.qZA())},directives:[y.wG,v.$,C.Hw],styles:[""]}),t}(),T=e(1041),_=e(8720),b=e(9529),Z=e(2935),w=e(5151),k=e(1116),F=e(3070),S=e(4369),A=e(9572),N=e(3841),U=e(7110),q=e(1271),$=e(9550);function O(t,n){if(1&t&&(x.TgZ(0,"mat-option",21),x._uU(1),x.qZA()),2&t){var e=n.$implicit;x.Q6J("value",e.value),x.xp6(1),x.hij(" ",e.name," ")}}function M(t,n){if(1&t&&(x.ynx(0),x.TgZ(1,"mat-form-field",7),x.TgZ(2,"mat-label"),x._uU(3,"Scope"),x.qZA(),x.TgZ(4,"mat-select",19),x.YNc(5,O,2,2,"mat-option",20),x.TgZ(6,"mat-option",21),x._uU(7,"Other..."),x.qZA(),x.qZA(),x.qZA(),x.TgZ(8,"app-field-hint"),x._uU(9," The scope should almost never be changed - "),x.TgZ(10,"a",22),x._uU(11,"see help"),x.qZA(),x.qZA(),x.BQk()),2&t){var e=x.oxw().ngIf,o=x.oxw();x.xp6(4),x.Q6J("placeholder",e.scopeOptions.length?"":"No items found"),x.xp6(1),x.Q6J("ngForOf",e.scopeOptions),x.xp6(1),x.Q6J("value",o.dropdownInsertValue)}}function G(t,n){if(1&t&&(x.TgZ(0,"mat-option",21),x._uU(1),x.qZA()),2&t){var e=n.$implicit;x.Q6J("value",e.StaticName),x.xp6(1),x.hij(" ",e.Label," ")}}function J(t,n){if(1&t&&(x.TgZ(0,"mat-select",23),x.YNc(1,G,2,2,"mat-option",20),x.qZA()),2&t){var e=x.oxw().ngIf;x.Q6J("placeholder",e.contentTypes.length?"":"No items found"),x.xp6(1),x.Q6J("ngForOf",e.contentTypes)}}function Q(t,n){1&t&&x._UZ(0,"input",24)}function Y(t,n){1&t&&(x.TgZ(0,"app-field-hint",25),x._uU(1," This field is required "),x.qZA()),2&t&&x.Q6J("isError",!0)}var D=function(t){return{active:t}};function z(t,n){if(1&t){var e=x.EpF();x.ynx(0),x.TgZ(1,"div",1),x.TgZ(2,"div",2),x._uU(3,"Create Metadata"),x.qZA(),x.qZA(),x.TgZ(4,"p",3),x._uU(5," This is a special operation to add an item which is metadata for another item, see "),x.TgZ(6,"a",4),x._uU(7,"docs"),x.qZA(),x._uU(8,". "),x.qZA(),x.TgZ(9,"form",5),x.TgZ(10,"div",6),x.YNc(11,M,12,3,"ng-container",0),x.TgZ(12,"mat-form-field",7),x.TgZ(13,"mat-label"),x._uU(14,"Content Type"),x.qZA(),x.YNc(15,J,2,2,"mat-select",8),x.YNc(16,Q,1,0,"input",9),x.TgZ(17,"div",10),x.TgZ(18,"button",11),x.NdJ("click",function(){return x.CHM(e),x.oxw().toggleGuidedContentType(!0)}),x.TgZ(19,"mat-icon"),x._uU(20,"search"),x.qZA(),x.qZA(),x.TgZ(21,"button",12),x.NdJ("click",function(){return x.CHM(e),x.oxw().toggleGuidedContentType(!1)}),x.TgZ(22,"mat-icon"),x._uU(23,"text_fields"),x.qZA(),x.qZA(),x.qZA(),x.qZA(),x.YNc(24,Y,2,1,"app-field-hint",13),x.qZA(),x.TgZ(25,"div",14),x.TgZ(26,"mat-slide-toggle",15),x.NdJ("change",function(t){return x.CHM(e),x.oxw().toggleAdvancedMode(t)}),x._uU(27),x.qZA(),x._UZ(28,"div",16),x.TgZ(29,"button",17),x.NdJ("click",function(){return x.CHM(e),x.oxw().closeDialog()}),x._uU(30,"Cancel"),x.qZA(),x.TgZ(31,"button",18),x.NdJ("click",function(){return x.CHM(e),x.oxw().confirm()}),x._uU(32," Confirm "),x.qZA(),x.qZA(),x.qZA(),x.BQk()}if(2&t){var o=x.oxw();x.xp6(9),x.Q6J("formGroup",o.form),x.xp6(2),x.Q6J("ngIf",o.advancedMode&&o.guidedContentType),x.xp6(4),x.Q6J("ngIf",o.guidedContentType),x.xp6(1),x.Q6J("ngIf",!o.guidedContentType),x.xp6(2),x.Q6J("ngClass",x.VKq(10,D,o.guidedContentType)),x.xp6(3),x.Q6J("ngClass",x.VKq(12,D,!o.guidedContentType)),x.xp6(3),x.Q6J("ngIf",o.form.controls.contentType.touched&&(null==o.form.controls.contentType.errors?null:o.form.controls.contentType.errors.required)),x.xp6(2),x.Q6J("checked",o.advancedMode),x.xp6(1),x.hij(" ",o.advancedMode?"Advanced":"Simple"," "),x.xp6(4),x.Q6J("disabled",!o.form.valid)}}var L=function(){function t(t,n){this.dialogRef=t,this.contentTypesService=n,this.hostClass="dialog-component",this.dropdownInsertValue=b.G,this.guidedContentType=!0,this.advancedMode=!1}return t.prototype.ngOnInit=function(){this.contentTypes$=new a.X([]),this.scopeOptions$=new a.X([]),this.buildForm(),this.fetchScopes(),this.templateVars$=(0,s.aj)([this.contentTypes$,this.scopeOptions$]).pipe((0,c.U)(function(t){var n=(0,o.CR)(t,2);return{contentTypes:n[0],scopeOptions:n[1]}}))},t.prototype.ngOnDestroy=function(){this.contentTypes$.complete(),this.scopeOptions$.complete()},t.prototype.closeDialog=function(t){this.dialogRef.close(t)},t.prototype.toggleGuidedContentType=function(t){this.guidedContentType=t},t.prototype.toggleAdvancedMode=function(t){this.advancedMode=t.checked},t.prototype.confirm=function(){var t=this.form.getRawValue();this.closeDialog(t.contentType)},t.prototype.buildForm=function(){var t=this;this.form=new T.cw({}),this.form.addControl("contentType",new T.NI(null,[T.kI.required])),this.form.addControl("scope",new T.NI(g.Z.scopes.default.value)),this.form.controls.scope.valueChanges.pipe((0,d.O)(this.form.controls.scope.value),(0,_.x)()).subscribe(function(n){null!=t.form.controls.contentType.value&&t.form.controls.contentType.patchValue(null),n===b.G?(n=prompt("This is an advanced feature to show content-types of another scope. Don't use this if you don't know what you're doing, as content-types of other scopes are usually hidden for a good reason.")||g.Z.scopes.default.value,t.scopeOptions$.value.some(function(t){return t.value===n})||t.scopeOptions$.next((0,o.ev)([{name:n,value:n}],(0,o.CR)(t.scopeOptions$.value))),t.form.controls.scope.patchValue(n)):t.fetchContentTypes(n)})},t.prototype.fetchContentTypes=function(t){var n=this;this.contentTypesService.retrieveContentTypes(t).subscribe(function(t){n.contentTypes$.next(t)})},t.prototype.fetchScopes=function(){var t=this;this.contentTypesService.getScopes().subscribe(function(n){t.scopeOptions$.next(n)})},t.\u0275fac=function(n){return new(n||t)(x.Y36(Z.so),x.Y36(w.sF))},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-metadata-save-dialog"]],hostVars:1,hostBindings:function(t,n){2&t&&x.Ikx("className",n.hostClass)},decls:2,vars:3,consts:[[4,"ngIf"],["mat-dialog-title",""],[1,"dialog-title-box"],[1,"dialog-description"],["href","http://r.2sxc.org/metadata","target","_blank"],[1,"dialog-form",3,"formGroup"],[1,"dialog-form-content","fancy-scrollbar-light"],["appearance","standard","color","accent"],["formControlName","contentType","required","",3,"placeholder",4,"ngIf"],["matInput","","type","text","formControlName","contentType","required","",4,"ngIf"],["matSuffix","",1,"selection-suffix"],["mat-icon-button","","type","button","tippy","Pick existing value",3,"ngClass","click"],["mat-icon-button","","type","button","tippy","Manual entry",3,"ngClass","click"],[3,"isError",4,"ngIf"],[1,"dialog-form-actions"],["color","accent",3,"checked","change"],[1,"spacer"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],["formControlName","scope",3,"placeholder"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["href","https://2sxc.org/help?tag=scope","target","_blank","appClickStopPropagation",""],["formControlName","contentType","required","",3,"placeholder"],["matInput","","type","text","formControlName","contentType","required",""],[3,"isError"]],template:function(t,n){1&t&&(x.YNc(0,z,33,14,"ng-container",0),x.ALo(1,"async")),2&t&&x.Q6J("ngIf",x.lcZ(1,1,n.templateVars$))},directives:[k.O5,Z.uh,T._Y,T.JL,T.sg,F.KE,F.hX,F.R9,S.lW,v.$,k.mk,C.Hw,A.Rr,N.gD,T.JJ,T.u,k.sg,y.ey,U.Y,q.E,T.Q7,$.Nt,T.Fj],pipes:[k.Ov],styles:[".dialog-form-content[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]:not(:first-of-type){margin-top:8px}"]}),t}(),P=e(4380),R=e(3589),B=e(7553),j=e(5223),E=e(9825),H=e(2881);function V(t,n){1&t&&(x.ynx(0),x._uU(1,"This item is not metadata for anything else."),x.BQk())}function X(t,n){if(1&t&&(x.ynx(0),x._UZ(1,"br"),x._uU(2),x.BQk()),2&t){var e=x.oxw(2).ngIf;x.xp6(2),x.hij("Number: ",e.itemFor.Number,"")}}function K(t,n){if(1&t&&(x.ynx(0),x._UZ(1,"br"),x._uU(2),x.BQk()),2&t){var e=x.oxw(2).ngIf;x.xp6(2),x.hij("Guid: ",e.itemFor.Guid,"")}}function W(t,n){if(1&t&&(x.ynx(0),x._UZ(1,"br"),x._uU(2),x.BQk()),2&t){var e=x.oxw(2).ngIf;x.xp6(2),x.hij("String: ",e.itemFor.String,"")}}function tt(t,n){if(1&t&&(x.ynx(0),x._UZ(1,"br"),x._uU(2),x.BQk()),2&t){var e=x.oxw(2).ngIf;x.xp6(2),x.hij("Title: ",e.itemFor.String,"")}}function nt(t,n){if(1&t&&(x.ynx(0),x._uU(1," This item is metadata for: "),x._UZ(2,"br"),x._uU(3),x.YNc(4,X,3,1,"ng-container",0),x.YNc(5,K,3,1,"ng-container",0),x.YNc(6,W,3,1,"ng-container",0),x.YNc(7,tt,3,1,"ng-container",0),x.BQk()),2&t){var e=x.oxw().ngIf;x.xp6(3),x.hij("Target: ",e.itemFor.Target," "),x.xp6(1),x.Q6J("ngIf",e.itemFor.Number),x.xp6(1),x.Q6J("ngIf",e.itemFor.Guid),x.xp6(1),x.Q6J("ngIf",e.itemFor.String),x.xp6(1),x.Q6J("ngIf",e.itemFor.Title)}}function et(t,n){if(1&t){var e=x.EpF();x.TgZ(0,"button",11),x.NdJ("click",function(){return x.CHM(e),x.oxw(2).createMetadata()}),x.TgZ(1,"mat-icon"),x._uU(2,"add"),x.qZA(),x.qZA()}}function ot(t,n){if(1&t){var e=x.EpF();x.TgZ(0,"button",18),x.NdJ("click",function(){var t=x.CHM(e).$implicit;return x.oxw(3).createMetadata(t)}),x.TgZ(1,"mat-icon"),x._uU(2),x.qZA(),x.qZA()}if(2&t){var o=n.$implicit;x.uIk("label",o.Title),x.xp6(2),x.Oqu(o.Icon||"add")}}var it=function(t){return{"fab-opened":t}};function rt(t,n){if(1&t){var e=x.EpF();x.TgZ(0,"eco-fab-speed-dial",12),x.NdJ("openChange",function(t){return x.CHM(e),x.oxw(2).openChange(t)}),x.TgZ(1,"eco-fab-speed-dial-trigger",13),x.TgZ(2,"button",14),x.TgZ(3,"mat-icon",15),x._uU(4),x.qZA(),x.qZA(),x.qZA(),x.TgZ(5,"eco-fab-speed-dial-actions"),x.TgZ(6,"button",16),x.NdJ("click",function(){return x.CHM(e),x.oxw(2).createMetadata()}),x.TgZ(7,"mat-icon"),x._uU(8,"search"),x.qZA(),x.qZA(),x.YNc(9,ot,3,2,"button",17),x.qZA(),x.qZA()}if(2&t){var o=x.oxw().ngIf;x.Q6J("ngClass",x.VKq(4,it,o.fabOpen)),x.xp6(1),x.Q6J("spin",!0),x.xp6(3),x.Oqu(o.fabOpen?"close":"add"),x.xp6(5),x.Q6J("ngForOf",o.recommendations)}}function at(t,n){if(1&t){var e=x.EpF();x.ynx(0),x.TgZ(1,"div",1),x.TgZ(2,"div",2),x.TgZ(3,"div",3),x.TgZ(4,"div"),x._uU(5),x.qZA(),x.TgZ(6,"button",4),x.NdJ("click",function(){return x.CHM(e),x.oxw().closeDialog()}),x.TgZ(7,"mat-icon"),x._uU(8,"close"),x.qZA(),x.qZA(),x.qZA(),x.qZA(),x.TgZ(9,"p",5),x.YNc(10,V,2,0,"ng-container",0),x.YNc(11,nt,8,5,"ng-container",0),x.qZA(),x._UZ(12,"router-outlet"),x.TgZ(13,"div",6),x._UZ(14,"ag-grid-angular",7),x._UZ(15,"div",8),x.YNc(16,et,3,0,"button",9),x.YNc(17,rt,10,6,"eco-fab-speed-dial",10),x.qZA(),x.qZA(),x.BQk()}if(2&t){var o=n.ngIf,i=x.oxw();x.xp6(5),x.Oqu(i.title||"Metadata"),x.xp6(5),x.Q6J("ngIf",!o.itemFor),x.xp6(1),x.Q6J("ngIf",o.itemFor),x.xp6(3),x.Q6J("rowData",o.metadata)("modules",i.modules)("gridOptions",i.gridOptions),x.xp6(2),x.Q6J("ngIf",0===o.recommendations.length),x.xp6(1),x.Q6J("ngIf",o.recommendations.length>0)}}var pt=function(){function t(t,n,e,r,s,c,u,d,l,g){var m;this.dialogRef=t,this.router=n,this.route=e,this.metadataService=r,this.snackBar=s,this.entitiesService=c,this.contentItemsService=u,this.dialog=d,this.viewContainerRef=l,this.changeDetectorRef=g,this.modules=i.F$,this.gridOptions=(0,o.pi)((0,o.pi)({},h.f),{frameworkComponents:{idFieldComponent:f.m,metadataActionsComponent:I},columnDefs:[{headerName:"ID",field:"Id",width:70,headerClass:"dense",cellClass:"id-action no-padding no-outline",cellRenderer:"idFieldComponent",sortable:!0,filter:"agTextColumnFilter",cellRendererParams:{tooltipGetter:function(t){return"ID: "+t.Id+"\nGUID: "+t.Guid}}},{headerName:"Title",field:"Title",flex:2,minWidth:250,cellClass:"primary-action highlight",sortable:!0,sort:"asc",filter:"agTextColumnFilter",onCellClicked:this.editMetadata.bind(this)},{headerName:"Content Type",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter",valueGetter:function(t){var n=t.data;return n._Type.Name+(n._Type.Description?" ("+n._Type.Description+")":"")}},{width:42,cellClass:"secondary-action no-padding",cellRenderer:"metadataActionsComponent",pinned:"right",cellRendererParams:{onDelete:this.deleteMetadata.bind(this)}}]}),this.metadata$=new a.X([]),this.recommendations$=new a.X([]),this.itemFor$=new a.X(void 0),this.fabOpen$=new a.X(!1),this.subscription=new p.w,this.targetType=parseInt(this.route.snapshot.paramMap.get("type"),10),this.keyType=this.route.snapshot.paramMap.get("keyType"),this.key=this.route.snapshot.paramMap.get("key"),this.title=decodeURIComponent(null!==(m=this.route.snapshot.paramMap.get("title"))&&void 0!==m?m:""),this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName")}return t.prototype.ngOnInit=function(){this.fetchFor(),this.fetchMetadata(),this.refreshOnChildClosed(),this.templateVars$=(0,s.aj)([this.metadata$,this.recommendations$,this.itemFor$,this.fabOpen$]).pipe((0,c.U)(function(t){var n=(0,o.CR)(t,4);return{metadata:n[0],recommendations:n[1],itemFor:n[2],fabOpen:n[3]}}))},t.prototype.ngOnDestroy=function(){this.metadata$.complete(),this.recommendations$.complete(),this.itemFor$.complete(),this.fabOpen$.complete(),this.subscription.unsubscribe()},t.prototype.closeDialog=function(){this.dialogRef.close()},t.prototype.openChange=function(t){this.fabOpen$.next(t)},t.prototype.createMetadata=function(t){var n=this;t?t.CreateEmpty?(this.snackBar.open("Creating "+t.Name+"..."),this.entitiesService.create(t.Id,{For:this.calculateItemFor()}).subscribe({error:function(){n.snackBar.open("Creating "+t.Name+" failed. Please check console for more info",void 0,{duration:3e3}),n.fetchMetadata()},next:function(){n.snackBar.open("Created "+t.Name,void 0,{duration:3e3}),n.fetchMetadata()}})):this.createMetadataForm(t.Id):this.dialog.open(L,{autoFocus:!1,viewContainerRef:this.viewContainerRef,width:"650px"}).afterClosed().subscribe(function(t){null!=t&&n.createMetadataForm(t)})},t.prototype.createMetadataForm=function(t){var n={items:[{ContentTypeName:t,For:this.calculateItemFor()}]},e=(0,m.f)(n);this.router.navigate(["edit/"+e],{relativeTo:this.route}),this.changeDetectorRef.markForCheck()},t.prototype.calculateItemFor=function(){var t,n,e=this;return(0,o.pi)((0,o.pi)((0,o.pi)({Target:null!==(n=null===(t=Object.values(g.Z.metadata).find(function(t){return t.type===e.targetType}))||void 0===t?void 0:t.target)&&void 0!==n?n:this.targetType.toString()},this.keyType===g.Z.keyTypes.guid&&{Guid:this.key}),this.keyType===g.Z.keyTypes.number&&{Number:parseInt(this.key,10)}),this.keyType===g.Z.keyTypes.string&&{String:this.key})},t.prototype.fetchFor=function(){var t=this;this.contentTypeStaticName&&this.contentItemsService.getAll(this.contentTypeStaticName).subscribe(function(n){var e=n.find(function(n){return n.Guid===t.key});(null==e?void 0:e.For)&&t.itemFor$.next(e.For)})},t.prototype.fetchMetadata=function(){var t=this;this.metadataService.getMetadata(this.targetType,this.keyType,this.key).subscribe(function(n){t.metadata$.next(n.Items);var e=n.Recommendations.filter(function(t){return 1===t.Count&&!n.Items.some(function(n){return n._Type.Id===t.Id})});t.recommendations$.next(e)})},t.prototype.editMetadata=function(t){var n=(0,m.f)({items:[{EntityId:t.data.Id}]});this.router.navigate(["edit/"+n],{relativeTo:this.route})},t.prototype.deleteMetadata=function(t){var n,e=this,o=(null===(n=this.recommendations$.value.find(function(n){return n.Id===t._Type.Id}))||void 0===n?void 0:n.DeleteWarning)||"";o=o?o+"\n\nAre you sure you want to delete '"+t.Title+"' ("+t.Id+")?":"Delete '"+t.Title+"' ("+t.Id+")?",confirm(o)&&(this.snackBar.open("Deleting..."),this.entitiesService.delete(t._Type.Id,t.Id,!1).subscribe({next:function(){e.snackBar.open("Deleted",null,{duration:2e3}),e.fetchMetadata()},error:function(){e.snackBar.open("Delete failed. Please check console for more information",null,{duration:3e3})}}))},t.prototype.refreshOnChildClosed=function(){var t=this;this.subscription.add(this.router.events.pipe((0,u.h)(function(t){return t instanceof r.m2}),(0,d.O)(!!this.route.snapshot.firstChild),(0,c.U)(function(){return!!t.route.snapshot.firstChild}),(0,l.G)(),(0,u.h)(function(t){var n=(0,o.CR)(t,2);return n[0]&&!n[1]})).subscribe(function(){t.fetchMetadata()}))},t.\u0275fac=function(n){return new(n||t)(x.Y36(Z.so),x.Y36(r.F0),x.Y36(r.gz),x.Y36(P.Do),x.Y36(R.ux),x.Y36(B.g),x.Y36(j.l),x.Y36(Z.uw),x.Y36(x.s_b),x.Y36(x.sBO))},t.\u0275cmp=x.Xpm({type:t,selectors:[["app-metadata"]],decls:2,vars:3,consts:[[4,"ngIf"],[1,"nav-component-wrapper"],["mat-dialog-title",""],[1,"dialog-title-box"],["mat-icon-button","","tippy","Close dialog",3,"click"],[1,"dialog-description"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","modules","gridOptions"],[1,"grid-more-actions-box"],["mat-fab","","mat-elevation-z24","","class","grid-fab","tippy","Create a new metadata for this item",3,"click",4,"ngIf"],["class","grid-fab",3,"ngClass","openChange",4,"ngIf"],["mat-fab","","mat-elevation-z24","","tippy","Create a new metadata for this item",1,"grid-fab",3,"click"],[1,"grid-fab",3,"ngClass","openChange"],[3,"spin"],["mat-fab",""],[1,"spin180"],["mat-mini-fab","","label","Other Content Type",3,"click"],["mat-mini-fab","",3,"click",4,"ngFor","ngForOf"],["mat-mini-fab","",3,"click"]],template:function(t,n){1&t&&(x.YNc(0,at,18,8,"ng-container",0),x.ALo(1,"async")),2&t&&x.Q6J("ngIf",x.lcZ(1,1,n.templateVars$))},directives:[k.O5,Z.uh,S.lW,v.$,C.Hw,r.lC,E.N8,H.W7,k.mk,H.YI,H.Lp,k.sg],pipes:[k.Ov],styles:[""]}),t}()},7110:function(t,n,e){"use strict";e.d(n,{Y:function(){return f}});var o=e(1785),i=e(1116),r=e(3070);function a(t,n){1&t&&o.GkF(0)}function p(t,n){if(1&t&&(o.TgZ(0,"mat-hint"),o.YNc(1,a,1,0,"ng-container",3),o.qZA()),2&t){o.oxw();var e=o.MAs(4);o.xp6(1),o.Q6J("ngTemplateOutlet",e)}}function s(t,n){1&t&&o.GkF(0)}function c(t,n){if(1&t&&(o.TgZ(0,"mat-error"),o.YNc(1,s,1,0,"ng-container",3),o.qZA()),2&t){o.oxw();var e=o.MAs(4);o.xp6(1),o.Q6J("ngTemplateOutlet",e)}}function u(t,n){1&t&&o.Hsn(0)}var d=function(t){return{"hint-box__short":t}},l=["*"],f=function(){function t(){this.isError=!1,this.isShort=!0}return t.prototype.toggleIsShort=function(){this.isShort=!this.isShort},t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-field-hint"]],inputs:{isError:"isError"},ngContentSelectors:l,decls:5,vars:6,consts:[[1,"hint-box",3,"ngClass","ngSwitch","click"],[4,"ngSwitchCase"],["content",""],[4,"ngTemplateOutlet"]],template:function(t,n){1&t&&(o.F$t(),o.TgZ(0,"div",0),o.NdJ("click",function(){return n.toggleIsShort()}),o.YNc(1,p,2,1,"mat-hint",1),o.YNc(2,c,2,1,"mat-error",1),o.qZA(),o.YNc(3,u,1,0,"ng-template",null,2,o.W1O)),2&t&&(o.Q6J("ngClass",o.VKq(4,d,n.isShort))("ngSwitch",n.isError),o.xp6(1),o.Q6J("ngSwitchCase",!1),o.xp6(1),o.Q6J("ngSwitchCase",!0))},directives:[i.mk,i.RF,i.n9,r.bx,i.tP,r.TO],styles:[".hint-box[_ngcontent-%COMP%]{margin-top:4px}.hint-box[_ngcontent-%COMP%]   .mat-error[_ngcontent-%COMP%], .hint-box[_ngcontent-%COMP%]   .mat-hint[_ngcontent-%COMP%]{font-size:12px;display:block}.hint-box__short[_ngcontent-%COMP%]   .mat-error[_ngcontent-%COMP%], .hint-box__short[_ngcontent-%COMP%]   .mat-hint[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]}),t}()},1271:function(t,n,e){"use strict";e.d(n,{E:function(){return i}});var o=e(1785),i=function(){function t(){}return t.prototype.onClick=function(t){t.stopPropagation()},t.\u0275fac=function(n){return new(n||t)},t.\u0275dir=o.lG2({type:t,selectors:[["","appClickStopPropagation",""]],hostBindings:function(t,n){1&t&&o.NdJ("click",function(t){return n.onClick(t)})}}),t}()},8442:function(t,n,e){"use strict";function o(t){return new Promise(function(n,e){var o=new FileReader;o.readAsDataURL(t),o.onload=function(){n(o.result.split(",")[1])},o.onerror=function(t){e(t)}})}function i(t){return new Promise(function(n,e){var o=new FileReader;o.readAsText(t),o.onload=function(){n(o.result)},o.onerror=function(t){e(t)}})}e.d(n,{s:function(){return o},B:function(){return i}})}}]);
//# sourceMappingURL=https://sources.2sxc.org/13.00.01/ng-edit/projects_ng-dialogs_src_app_metadata_metadata_component_ts.aaaf84d8d1a594bbd92c.js.map