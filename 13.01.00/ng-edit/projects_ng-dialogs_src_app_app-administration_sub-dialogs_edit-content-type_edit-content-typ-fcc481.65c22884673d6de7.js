"use strict";(self.webpackChunkng_dialogs=self.webpackChunkng_dialogs||[]).push([["projects_ng-dialogs_src_app_app-administration_sub-dialogs_edit-content-type_edit-content-typ-fcc481","projects_ng-dialogs_src_app_shared_directives_click-stop-propagation_directive_ts"],{8493:function(M,C,n){n.r(C),n.d(C,{EditContentTypeComponent:function(){return w}});var Z=n(6170),_=n(2090),x=n(8069),A=n(8047),l=n(6317),g=n(6562),v=n(745),h=n(635),N=n(9670),E=n(1825),I=/(^[A-Za-z][A-Za-z0-9]+$)|(^@[A-Za-z][A-Za-z0-9-]*$)/,J=n(5005),t=n(7133),b=n(5758),D=n(2977),P=n(2528),$=n(6362),m=n(587),O=n(4770),Q=n(4683),T=n(6531),j=n(1434),B=n(1130),Y=n(7317),H=n(785),F=n(5590),q=n(491),L=n(3135);function V(i,c){1&i&&(t.TgZ(0,"app-field-hint",23),t._uU(1,"This field is required"),t.qZA()),2&i&&t.Q6J("isError",!0)}function X(i,c){if(1&i&&(t.TgZ(0,"app-field-hint",23),t._uU(1),t.qZA()),2&i){var e=t.oxw(4);t.Q6J("isError",!0),t.xp6(1),t.Oqu(e.contentTypeNameError)}}function z(i,c){if(1&i&&(t.ynx(0),t.YNc(1,V,2,1,"app-field-hint",22),t.YNc(2,X,2,2,"app-field-hint",22),t.BQk()),2&i){t.oxw();var e=t.MAs(8);t.xp6(1),t.Q6J("ngIf",e.errors.required),t.xp6(1),t.Q6J("ngIf",e.errors.pattern)}}function R(i,c){if(1&i&&(t.TgZ(0,"mat-option",13),t._uU(1),t.qZA()),2&i){var e=c.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",e.name," ")}}function K(i,c){if(1&i&&(t.TgZ(0,"div",7),t.TgZ(1,"h3"),t._uU(2,"Shared Content Type (Ghost)"),t.qZA(),t.TgZ(3,"p"),t._uU(4,"Note: this can't be edited in the UI, for now if you really know what you're doing, do it in the DB"),t.qZA(),t.TgZ(5,"p"),t._uU(6),t.qZA(),t.qZA()),2&i){var e=t.oxw(2).ngIf;t.xp6(6),t.hij("Uses Type Definition of: ",e.contentType.SharedDefId,"")}}function G(i,c){if(1&i){var e=t.EpF();t.TgZ(0,"form",4,5),t.NdJ("ngSubmit",function(){return t.CHM(e),t.oxw(2).save()}),t.TgZ(2,"div",6),t.TgZ(3,"div",7),t.TgZ(4,"mat-form-field",8),t.TgZ(5,"mat-label"),t._uU(6,"Name"),t.qZA(),t.TgZ(7,"input",9,10),t.NdJ("ngModelChange",function(p){return t.CHM(e),t.oxw(2).changeContentTypeName(p)}),t.qZA(),t.qZA(),t.YNc(9,z,3,2,"ng-container",2),t.qZA(),t.TgZ(10,"mat-accordion"),t.TgZ(11,"mat-expansion-panel"),t.TgZ(12,"mat-expansion-panel-header"),t.TgZ(13,"mat-panel-title"),t._uU(14,"Advanced"),t.qZA(),t._UZ(15,"mat-panel-description"),t.qZA(),t.TgZ(16,"div",7),t.TgZ(17,"mat-form-field",8),t.TgZ(18,"mat-label"),t._uU(19,"Scope"),t.qZA(),t.TgZ(20,"mat-select",11),t.NdJ("ngModelChange",function(p){return t.CHM(e),t.oxw(2).changeScope(p)}),t.YNc(21,R,2,2,"mat-option",12),t.TgZ(22,"mat-option",13),t._uU(23,"Other..."),t.qZA(),t.qZA(),t.TgZ(24,"button",14),t.TgZ(25,"mat-icon",15),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).unlockScope()}),t._uU(26),t.qZA(),t.qZA(),t.qZA(),t.TgZ(27,"app-field-hint"),t._uU(28," The scope should almost never be changed - "),t.TgZ(29,"a",16),t._uU(30,"see help"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(31,"div",7),t.TgZ(32,"mat-form-field",8),t.TgZ(33,"mat-label"),t._uU(34,"Static Name"),t.qZA(),t._UZ(35,"input",17),t.qZA(),t.qZA(),t.YNc(36,K,7,1,"div",18),t.qZA(),t.qZA(),t.qZA(),t.TgZ(37,"div",19),t.TgZ(38,"button",20),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).closeDialog()}),t._uU(39,"Cancel"),t.qZA(),t.TgZ(40,"button",21),t._uU(41," Save "),t.qZA(),t.qZA(),t.qZA()}if(2&i){var o=t.MAs(1),r=t.MAs(8),a=t.oxw().ngIf,d=t.oxw();t.xp6(7),t.Q6J("pattern",d.contentTypeNamePattern)("ngModel",a.contentType.Name),t.xp6(2),t.Q6J("ngIf",r.touched&&r.errors),t.xp6(1),t.Q6J("@.disabled",a.disableAnimation),t.xp6(10),t.Q6J("ngModel",a.contentType.Scope)("disabled",a.lockScope),t.xp6(1),t.Q6J("ngForOf",a.scopeOptions),t.xp6(1),t.Q6J("value",d.dropdownInsertValue),t.xp6(2),t.Q6J("tippy",a.lockScope?"Unlock":"Lock"),t.xp6(2),t.hij(" ",a.lockScope?"lock":"lock_open"," "),t.xp6(9),t.Q6J("ngModel",a.contentType.StaticName),t.xp6(1),t.Q6J("ngIf",a.contentType.SharedDefId),t.xp6(4),t.Q6J("disabled",!o.form.valid||a.loading)}}function W(i,c){if(1&i&&(t.ynx(0),t.YNc(1,G,42,13,"form",3),t.BQk()),2&i){var e=c.ngIf;t.xp6(1),t.Q6J("ngIf",e.contentType)}}var w=function(){var i=function(){function c(e,o,r,a){(0,x.Z)(this,c),this.dialogRef=e,this.route=o,this.contentTypesService=r,this.snackBar=a,this.hostClass="dialog-component",this.contentTypeStaticName=this.route.snapshot.paramMap.get("contentTypeStaticName"),this.contentTypeNamePattern=I,this.contentTypeNameError="Standard letters and numbers are allowed. Must start with a letter.",this.dropdownInsertValue=N.G,this.contentType$=new l.X(null),this.lockScope$=new l.X(!0),this.scopeOptions$=new l.X(null),this.disableAnimation$=new l.X(!0),this.loading$=new l.X(!1),this.templateVars$=(0,g.a)([this.contentType$,this.lockScope$,this.scopeOptions$,this.disableAnimation$,this.loading$]).pipe((0,h.U)(function(d){var s=(0,_.Z)(d,5);return{contentType:s[0],lockScope:s[1],scopeOptions:s[2],disableAnimation:s[3],loading:s[4]}})),this.scope=this.route.snapshot.parent.paramMap.get("scope")}return(0,A.Z)(c,[{key:"ngOnInit",value:function(){var o=this,r=this.contentTypeStaticName?this.contentTypesService.retrieveContentType(this.contentTypeStaticName).pipe((0,h.U)(function(d){return Object.assign(Object.assign({},d),{ChangeStaticName:!1,NewStaticName:d.StaticName})})):(0,v.of)({StaticName:"",Name:"",Description:"",Scope:this.scope,ChangeStaticName:!1,NewStaticName:""}),a=this.contentTypesService.getScopes();(0,g.a)([r,a]).subscribe(function(d){var y,s=(0,_.Z)(d,2),u=s[1];o.contentType$.next(s[0]);var f=(0,Z.Z)(null!==(y=o.scopeOptions$.value)&&void 0!==y?y:[]);u.forEach(function(S){f.some(function(tt){return tt.value===S.value})||f.push(S)}),f.some(function(S){return S.value===o.scope})||f.push({name:o.scope,value:o.scope}),o.scopeOptions$.next(f)})}},{key:"ngOnDestroy",value:function(){this.contentType$.complete(),this.lockScope$.complete(),this.scopeOptions$.complete(),this.disableAnimation$.complete(),this.loading$.complete()}},{key:"ngAfterViewInit",value:function(){var o=this;setTimeout(function(){return o.disableAnimation$.next(!1)})}},{key:"closeDialog",value:function(){this.dialogRef.close()}},{key:"changeContentTypeName",value:function(o){this.contentType$.next(Object.assign(Object.assign({},this.contentType$.value),{Name:o}))}},{key:"changeScope",value:function(o){o!==N.G||(o=prompt("This is an advanced feature to show content-types of another scope. Don't use this if you don't know what you're doing, as content-types of other scopes are usually hidden for a good reason.")||E.Z.scopes.default.value,this.scopeOptions$.value.some(function(a){return a.value===o}))||this.scopeOptions$.next([{name:o,value:o}].concat((0,Z.Z)(this.scopeOptions$.value))),this.contentType$.next(Object.assign(Object.assign({},this.contentType$.value),{Scope:o}))}},{key:"unlockScope",value:function(){this.lockScope$.next(!this.lockScope$.value),this.lockScope$.value&&this.contentType$.next(Object.assign(Object.assign({},this.contentType$.value),{Scope:this.scope}))}},{key:"save",value:function(){var o=this;this.loading$.next(!0),this.snackBar.open("Saving..."),this.contentTypesService.save(this.contentType$.value).subscribe(function(r){o.loading$.next(!1),o.snackBar.open("Saved",null,{duration:2e3}),o.closeDialog()}),document.activeElement instanceof HTMLElement&&document.activeElement.blur()}}]),c}();return i.\u0275fac=function(e){return new(e||i)(t.Y36(b.so),t.Y36(D.gz),t.Y36(J.s),t.Y36(P.ux))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-edit-content-type"]],hostVars:1,hostBindings:function(e,o){2&e&&t.Ikx("className",o.hostClass)},decls:5,vars:4,consts:[["mat-dialog-title",""],[1,"dialog-title-box"],[4,"ngIf"],["class","dialog-form",3,"ngSubmit",4,"ngIf"],[1,"dialog-form",3,"ngSubmit"],["ngForm","ngForm"],[1,"dialog-form-content","fancy-scrollbar-light"],[1,"edit-input"],["appearance","standard","color","accent"],["matInput","","type","text","required","","name","Name",3,"pattern","ngModel","ngModelChange"],["name","ngModel"],["name","Scope",3,"ngModel","disabled","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["mat-icon-button","","type","button","matSuffix","",3,"tippy"],["appClickStopPropagation","",3,"click"],["href","https://2sxc.org/help?tag=scope","target","_blank","appClickStopPropagation",""],["matInput","","type","text","name","StaticName","disabled","",3,"ngModel"],["class","edit-input",4,"ngIf"],[1,"dialog-form-actions"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","submit","color","accent",3,"disabled"],[3,"isError",4,"ngIf"],[3,"isError"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t._uU(2),t.qZA(),t.qZA(),t.YNc(3,W,2,1,"ng-container",2),t.ALo(4,"async")),2&e&&(t.xp6(2),t.Oqu(o.contentTypeStaticName?"Edit Content Type":"New Content Type"),t.xp6(1),t.Q6J("ngIf",t.lcZ(4,2,o.templateVars$)))},directives:[b.uh,$.O5,m._Y,m.JL,m.F,O.KE,O.hX,Q.Nt,m.Fj,m.Q7,m.c5,m.JJ,m.On,T.pp,T.ib,T.yz,T.yK,T.u4,j.gD,$.sg,B.ey,Y.lW,O.R9,H.$,F.Hw,q.E,L.Y],pipes:[$.Ov],styles:[".edit-input[_ngcontent-%COMP%]{padding-bottom:8px}.mat-accordion[_ngcontent-%COMP%]{padding-bottom:8px;display:block}"]}),i}()},491:function(M,C,n){n.d(C,{E:function(){return A}});var Z=n(8069),_=n(8047),x=n(7133),A=function(){var l=function(){function g(){(0,Z.Z)(this,g)}return(0,_.Z)(g,[{key:"onClick",value:function(h){h.stopPropagation()}}]),g}();return l.\u0275fac=function(v){return new(v||l)},l.\u0275dir=x.lG2({type:l,selectors:[["","appClickStopPropagation",""]],hostBindings:function(v,h){1&v&&x.NdJ("click",function(E){return h.onClick(E)})}}),l}()}}]);
//# sourceMappingURL=https://sources.2sxc.org/13.01.00/ng-edit/projects_ng-dialogs_src_app_app-administration_sub-dialogs_edit-content-type_edit-content-typ-fcc481.65c22884673d6de7.js.map